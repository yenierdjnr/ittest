{
  "description": "In this series, we will show you how to extend an on-premises Active Directory to Microsoft Azure. Extending Active Directory in Azure can be used for disaster recovery and supporting branch offices, to name a few. We will start at the beginning, by setting up our on-premises network, including Active Directory, DNS, and Routing and Remote Access. We will use the RRAS server as our VPN endpoint, which we will use to establish a site-to-site VPN tunnel to Azure. Then we will create our virtual network in Azure, including defining subnets, creating a gateway, and provisioning public IP addresses. Then we will create our Azure resources, including a virtual domain controller, storage accounts, and availability sets. Then we will verify that Active Directory is replicating properly. We will demonstrate using three different methods, with the classic portal, with the new portal and with Azure PowerShell.",
  "descriptionMD": "",
  "length": "33681",
  "name": "Active Directory in Azure",
  "practiceExam": false,
  "subtitle": "Cloud based directory and identity management",
  "tagUrl": "legacy",
  "topics": [
    {
      "episodes": [
        {
          "description": "In this segment, Daniel and Mike give a general overview of what you can expect in the upcoming episodes. They cover what the show's about, the target audience, what will be covered overall, and other topics.",
          "length": "240",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-0-0-overview-022316-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-0-0-overview-022316-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-0-0-overview-022316-1-sm.jpg",
          "title": "Overview",
          "transcript": "WEBVTT\n\n1\n00:00:00.025 --> 00:00:09.673\n[MUSIC]\n\n2\n00:00:09.673 --> 00:00:14.576\n>> In this segment, we're gonna walk you\nthrough an overview of our upcoming active\n\n3\n00:00:14.576 --> 00:00:16.400\ndirectory in Azure series.\n\n4\n00:00:16.400 --> 00:00:20.236\nNow the first thing we'd like\nto dispel is is this Azure AD.\n\n5\n00:00:20.236 --> 00:00:21.709\nMike, that's a great question.\n\n6\n00:00:21.709 --> 00:00:22.789\nIs this Azure AD?\n\n7\n00:00:22.789 --> 00:00:25.018\n>> It is great question and\nthe answer is no, it is not.\n\n8\n00:00:25.018 --> 00:00:26.237\nThey are two different things.\n\n9\n00:00:26.237 --> 00:00:31.341\nThey do sound very similar, but Azure AD\nis more of an identity solution that\n\n10\n00:00:31.341 --> 00:00:36.390\nwe can use with things like Office 365 and\nenabling that single sign on.\n\n11\n00:00:36.390 --> 00:00:40.575\nWhat we're going to be doing\nis Active Directory in Azure.\n\n12\n00:00:40.575 --> 00:00:44.060\nSo, we're gonna flip those words around\nand it does change the meaning completely.\n\n13\n00:00:44.060 --> 00:00:48.807\nWhat we're talking about is extending our\non premises Active Directory out into\n\n14\n00:00:48.807 --> 00:00:52.994\nAzure, so that we're running full\nblown copies of Active Directory,\n\n15\n00:00:52.994 --> 00:00:57.271\nreplicating with our on-premises\nmain controllers, the whole nine.\n\n16\n00:00:57.271 --> 00:01:00.411\n>> Now that we understand\nthat this isn't Azure AD,\n\n17\n00:01:00.411 --> 00:01:03.870\nwhat can we expect in\nthese upcoming episodes?\n\n18\n00:01:03.870 --> 00:01:06.629\n>> Well, what we're gonna do is we're\ngonna basically walk you through\n\n19\n00:01:06.629 --> 00:01:07.479\nthe entire process.\n\n20\n00:01:07.479 --> 00:01:11.656\nWe're gonna start by setting up\nour on-premises Active Directory.\n\n21\n00:01:11.656 --> 00:01:16.056\nCreating our on-premises network and then\nwe're gonna move on out in the Azure where\n\n22\n00:01:16.056 --> 00:01:19.312\nwe're going to create our virtual\nnetwork out there in Azure.\n\n23\n00:01:19.312 --> 00:01:23.666\nWe're gonna create a site to site VPN\nbetween our on-premises network and\n\n24\n00:01:23.666 --> 00:01:28.088\nour Azure network and then we're gonna\nrole out some virtual machines, and\n\n25\n00:01:28.088 --> 00:01:30.368\ninstall active directory on them, and\n\n26\n00:01:30.368 --> 00:01:34.470\nverify that we have replication going\non across that site to site VPN.\n\n27\n00:01:34.470 --> 00:01:35.029\n>> Very good.\n\n28\n00:01:35.029 --> 00:01:37.271\nNow to hone it down just\na little bit farther,\n\n29\n00:01:37.271 --> 00:01:41.050\nwhat are some of the specific topics\nthat we might encounter in this series?\n\n30\n00:01:41.050 --> 00:01:44.049\n>> Well, we're gonna go through several\ndifferent ways to accomplish the task that\n\n31\n00:01:44.049 --> 00:01:44.749\nI just mentioned.\n\n32\n00:01:44.749 --> 00:01:47.093\nBecause as of the filming\nof these episodes,\n\n33\n00:01:47.093 --> 00:01:51.590\nthere's really three different ways we\ncan do what we're talking about doing.\n\n34\n00:01:51.590 --> 00:01:54.873\nWe've got the classic portal, which\nif you've been working with Azure for\n\n35\n00:01:54.873 --> 00:01:57.452\nany length of time,\nyou're probably familiar with that.\n\n36\n00:01:57.452 --> 00:02:02.120\nIt's a web-based portal that we can go\nthrough and we can manage our resources,\n\n37\n00:02:02.120 --> 00:02:05.417\ncreate our VMs and\nour virtual networks and the like, but\n\n38\n00:02:05.417 --> 00:02:09.855\nthen we also wanna dive into the new\nportal that's been released recently.\n\n39\n00:02:09.855 --> 00:02:11.031\nIt's the same thing.\n\n40\n00:02:11.031 --> 00:02:15.984\nWe're dealing with Azure out there in\nMicrosoft's Cloud, but it's a new portal\n\n41\n00:02:15.984 --> 00:02:21.180\nand it's a different way of going about\ncreating and managing these resources.\n\n42\n00:02:21.180 --> 00:02:24.367\nAnd then we're also gonna take\na look at Azure PowerShell,\n\n43\n00:02:24.367 --> 00:02:26.674\nbecause as we get more and\nmore into Azure.\n\n44\n00:02:26.674 --> 00:02:30.868\nPutting more, more resources out there,\nwe're gonna find the need to start\n\n45\n00:02:30.868 --> 00:02:35.240\nautomating certain tasks, especially\nsome of the more repetitive tasks.\n\n46\n00:02:35.240 --> 00:02:39.367\nSo we're gonna go through the whole\nprocess using Azure PowerShell, as well.\n\n47\n00:02:39.367 --> 00:02:42.722\nSo, we'll end up doing the same\ntasks three different times.\n\n48\n00:02:42.722 --> 00:02:46.805\nOnce with the classic portal,\nonce again with the new portal and\n\n49\n00:02:46.805 --> 00:02:49.084\nthen again with Azure PowerShell.\n\n50\n00:02:49.084 --> 00:02:49.792\n>> Excellent stuff.\n\n51\n00:02:49.792 --> 00:02:52.915\nIt really sounds like it's\nsomething to look forward to.\n\n52\n00:02:52.915 --> 00:02:56.503\nNow, who is the intended audience for\nthis specific series?\n\n53\n00:02:56.503 --> 00:02:59.961\n>> These are really geared towards those\nof you that are getting ready to roll\n\n54\n00:02:59.961 --> 00:03:03.270\nout into Azure,\nlike you've got your on-premises network.\n\n55\n00:03:03.270 --> 00:03:06.355\nAnd now, you're looking to extend\nthat out into the cloud and\n\n56\n00:03:06.355 --> 00:03:08.739\nmaybe you're doing it for\ndisaster recovery.\n\n57\n00:03:08.739 --> 00:03:12.562\nSo that if your on-premises network\ndisappears for some reason,\n\n58\n00:03:12.562 --> 00:03:16.180\nyou still have copies of\nActive Directory out there in Azure and\n\n59\n00:03:16.180 --> 00:03:19.270\nthen recovering from that\ndisaster becomes easier.\n\n60\n00:03:19.270 --> 00:03:23.841\nBecause now, you have to setup your local\nnetwork again, recreate your site side\n\n61\n00:03:23.841 --> 00:03:27.501\nVPN, replication kicks in and\nwe're right backup and running.\n\n62\n00:03:27.501 --> 00:03:31.702\nOr if you're looking at taking some\nof the Windows Server 2012 exams,\n\n63\n00:03:31.702 --> 00:03:35.371\nthis isn't geared specifically\ntowards one of those exams, but\n\n64\n00:03:35.371 --> 00:03:39.508\na lot of these concepts and topics\nabout getting familiar with Azure could\n\n65\n00:03:39.508 --> 00:03:42.872\ndefinitely help you in your\nstudy process for those exams.\n\n66\n00:03:42.872 --> 00:03:44.173\n>> Excellent stuff.\n\n67\n00:03:44.173 --> 00:03:47.464\nWell, if that sounds like something\nthat's either gonna be useful or\n\n68\n00:03:47.464 --> 00:03:51.336\njust interesting to you, we look forward\nto seeing you in the upcoming episodes.\n\n69\n00:03:51.336 --> 00:04:00.369\n[MUSIC]\n\n",
          "vimeoId": "156556217"
        },
        {
          "description": "In this episode, Daniel and Mike give a basic explanation of using Active Directory services in an Azure environment. They start by explaining the difference between Azure AD and AD in Azure. Next they explore some of the reasons why you would implement AD in Azure. This includes reasons like disaster recovery site and AD for mobile users. They also talk briefly about security in regards to an AD in Azure deployment.",
          "length": "1380",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-1-introduction-020816-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-1-introduction-020816-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-1-introduction-020816-1-sm.jpg",
          "title": "Introduction",
          "transcript": "WEBVTT\n\n1\n00:00:00.360 --> 00:00:10.360\n[MUSIC]\n\n2\n00:00:12.160 --> 00:00:16.490\nAll right, greetings everyone, and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.490 --> 00:00:18.120\nI'm your host Daniel Lowrie.\n\n4\n00:00:18.120 --> 00:00:22.690\nAnd in today's episode, well, we're\nkicking off our series here with Azure and\n\n5\n00:00:22.690 --> 00:00:25.275\nActive Directory or\nActive Directory in Azure.\n\n6\n00:00:25.275 --> 00:00:28.195\nWe'll clear that up a little\nbit as we go on, but\n\n7\n00:00:28.195 --> 00:00:30.580\nthat's the main gist of the story there.\n\n8\n00:00:30.580 --> 00:00:34.660\nAnd joining me in the studio today to\nhelp walk us down this lovely road of\n\n9\n00:00:34.660 --> 00:00:38.030\nknowledge and intellect is none other\nthan our good friend, Mr. Mike Rodrick.\n\n10\n00:00:38.030 --> 00:00:38.790\nMike, welcome to the show.\n\n11\n00:00:38.790 --> 00:00:39.530\nHow you doing today, sir?\n\n12\n00:00:39.530 --> 00:00:40.160\n>> I'm doing great.\n\n13\n00:00:40.160 --> 00:00:41.150\nThanks for having me here.\n\n14\n00:00:41.150 --> 00:00:45.587\nAnd you're exactly right, it is a little\nbit confusing when we talk about Azure and\n\n15\n00:00:45.587 --> 00:00:49.040\nAD, AD Azure cuz you're\ngonna hear both of them and\n\n16\n00:00:49.040 --> 00:00:52.640\nthe reason is not because people\nlike to call it different things.\n\n17\n00:00:52.640 --> 00:00:56.340\nThere are two different things, and we\nneed to be able to differentiate between\n\n18\n00:00:56.340 --> 00:01:00.820\nthose and probably now is a good time to\ndo before we get too far down the road.\n\n19\n00:01:00.820 --> 00:01:02.160\nSo, let's talk about that.\n\n20\n00:01:02.160 --> 00:01:09.420\nWhen we talk about Azure AD, right,\nAzure AD is an identity management server.\n\n21\n00:01:09.420 --> 00:01:13.830\nIt's a software as a service,\nwhere I go out to Azure and\n\n22\n00:01:13.830 --> 00:01:18.090\nI can sign up for their Azure AD,\nand I can do identity management.\n\n23\n00:01:18.090 --> 00:01:22.450\nAnd I can provide single sign-on\nsolutions through the cloud.\n\n24\n00:01:22.450 --> 00:01:26.860\nI've got my Active Directory running\ninternally or on-premise, Microsoft's\n\n25\n00:01:27.920 --> 00:01:33.070\ngot their active directory,\ntheir Azure AD, running out in the cloud.\n\n26\n00:01:33.070 --> 00:01:37.370\nI can synchronize my identities\nup there with Azure AD and\n\n27\n00:01:37.370 --> 00:01:39.790\nI can then provide\na single sign-on solution.\n\n28\n00:01:39.790 --> 00:01:45.000\nSo that if I've got users that are outside\nthe organization, they can still do that.\n\n29\n00:01:45.000 --> 00:01:48.340\nThey can connect to Office 365,\nthings like that.\n\n30\n00:01:48.340 --> 00:01:49.030\nHeck, we can set up,\n\n31\n00:01:49.030 --> 00:01:52.810\nMicrosoft has federations with several,\nseveral different organizations out there.\n\n32\n00:01:52.810 --> 00:01:57.390\nSo if I want to set up single sign-on with\norganizations like Facebook and places\n\n33\n00:01:57.390 --> 00:02:03.050\nlike that, we can do that through that\nidentity management solution Azure AD,\n\n34\n00:02:03.050 --> 00:02:08.210\nbut we have to understand that that is\nnot full blown active directory, right?\n\n35\n00:02:08.210 --> 00:02:10.150\nWe have identities up there but\n\n36\n00:02:10.150 --> 00:02:13.700\nwe don't have the full user account\nwith all of its properties,\n\n37\n00:02:13.700 --> 00:02:18.730\nwe don't have groups, we don't have group\npolicy, and all the things we think\n\n38\n00:02:18.730 --> 00:02:23.680\nof when we talk about active directory\nrunning it internally on premise.\n\n39\n00:02:23.680 --> 00:02:27.310\nSo what we're gonna be focused\nhere on this series of videos\n\n40\n00:02:27.310 --> 00:02:31.550\nIs going to be\nthe Active Directory in Azure.\n\n41\n00:02:31.550 --> 00:02:33.150\nAll I did was flip the words around,\nright?\n\n42\n00:02:33.150 --> 00:02:36.840\nAzureAD, AD in Azure\ncompletely different meaning.\n\n43\n00:02:36.840 --> 00:02:40.430\nWhen we talk about\nActive Directory in Azure,\n\n44\n00:02:40.430 --> 00:02:43.470\nnow we're talking about\ninfrastructure as a service.\n\n45\n00:02:43.470 --> 00:02:48.750\nI'm gonna go out to Azure and\nI'm gonna create some virtual machines.\n\n46\n00:02:48.750 --> 00:02:51.430\nThey're not pre-built,\nI don't get them made for me.\n\n47\n00:02:51.430 --> 00:02:52.840\nThis is infrastructure as a service.\n\n48\n00:02:52.840 --> 00:02:58.130\nThey're providing the underlying\nhypervisor for me to create these VMs.\n\n49\n00:02:58.130 --> 00:03:01.470\nAnd then once I create that VM, I'm\ngoing to install Active Directory on it.\n\n50\n00:03:01.470 --> 00:03:05.602\nJust like I would a machine here on my\nphysical network or on premises, right?\n\n51\n00:03:05.602 --> 00:03:07.980\nI'm gonna install\nActive Directory up there, and\n\n52\n00:03:07.980 --> 00:03:09.960\nthen I'm gonna have to set up replication.\n\n53\n00:03:09.960 --> 00:03:14.920\nI've got to create a site-to-site\nVPN with our corporate office and\n\n54\n00:03:14.920 --> 00:03:19.640\nwith Azure so that my domain controllers\ncan talk to each other and replicate.\n\n55\n00:03:19.640 --> 00:03:23.530\nIt really becomes almost like another\nsite in your active directory.\n\n56\n00:03:23.530 --> 00:03:27.100\nBut we're gonna take advantage,\nwe're gonna get a lot more features.\n\n57\n00:03:27.100 --> 00:03:31.800\nWe're gonna have group policy,\nwe're gonna have location of services,\n\n58\n00:03:31.800 --> 00:03:37.090\nyou know DNS, things like that,\nas well as being able to authenticate.\n\n59\n00:03:37.090 --> 00:03:38.490\nSo big difference there.\n\n60\n00:03:38.490 --> 00:03:41.330\nAzure AD is software as a service.\n\n61\n00:03:41.330 --> 00:03:43.950\nWhat we're doing,\nActive Directory in Azure,\n\n62\n00:03:43.950 --> 00:03:46.390\nis going to be\ninfrastructure as a service.\n\n63\n00:03:46.390 --> 00:03:49.140\n>> All right, Mike,\nI think I'm following you here.\n\n64\n00:03:49.140 --> 00:03:50.740\n[LAUGH] Let's see if I can get this right.\n\n65\n00:03:50.740 --> 00:03:54.110\nAzure AD,\nI'm really thinking one-trick pony.\n\n66\n00:03:54.110 --> 00:03:56.680\nIt gives me the ability to\nconnect things like Office 365.\n\n67\n00:03:56.680 --> 00:04:01.750\nIt's a federated service that gives\nme single sign-on services throughout\n\n68\n00:04:01.750 --> 00:04:04.030\nwhatever it'll give me that function to.\n\n69\n00:04:04.030 --> 00:04:09.190\nWhereas in Active Directory in Azure,\nis the whole kit and caboodle.\n\n70\n00:04:09.190 --> 00:04:13.080\nI get all the Active Directory features\nbecause I'm actually making servers,\n\n71\n00:04:13.080 --> 00:04:14.130\nvirtual servers,\n\n72\n00:04:14.130 --> 00:04:17.920\nup in the cloud that are installed\nwith Microsoft's Active Directory.\n\n73\n00:04:17.920 --> 00:04:18.950\n>> Absolutely right.\n\n74\n00:04:18.950 --> 00:04:22.830\nAnd we get to take advantage of,\nwith Azure AD, it's a little bit,\n\n75\n00:04:22.830 --> 00:04:25.276\nI would say easy to set up,\nbut we know it's not.\n\n76\n00:04:25.276 --> 00:04:26.640\n>> [LAUGH] That's true.\n>> [LAUGH] We've been there,\n\n77\n00:04:26.640 --> 00:04:27.390\ndone that, right?\n\n78\n00:04:27.390 --> 00:04:29.190\nYou guys hopefully have\nwatched those episodes.\n\n79\n00:04:29.190 --> 00:04:30.230\nThere's a lot to it.\n\n80\n00:04:30.230 --> 00:04:33.320\nBut it is simple in the fact that\nthere's really only a couple of\n\n81\n00:04:33.320 --> 00:04:34.450\nports we're dealing with.\n\n82\n00:04:34.450 --> 00:04:39.490\nTypically, port 80 or port 443,\nit's all basically web traffic.\n\n83\n00:04:39.490 --> 00:04:43.140\nWhen we set up Active Directory in\nAzure I need all my ports, right?\n\n84\n00:04:43.140 --> 00:04:47.760\nI need all my L-dap ports so that I\ncan replicate, we need our Kerberos,\n\n85\n00:04:47.760 --> 00:04:50.440\nall of those different protocols\nthat we would normally talk to.\n\n86\n00:04:50.440 --> 00:04:53.970\nWith Azure AD, we're not using\nall those different protocols,\n\n87\n00:04:53.970 --> 00:04:57.200\nwe're just using HTTP or HTTPS.\n\n88\n00:04:57.200 --> 00:04:59.600\nWhen we set up Active Directory in Azure,\n\n89\n00:04:59.600 --> 00:05:01.870\nI've got all those protocols\nto think about, right?\n\n90\n00:05:01.870 --> 00:05:05.070\nBut we are getting, again,\na much more robust solution.\n\n91\n00:05:05.070 --> 00:05:09.130\nAnd there's several different\nreasons you might want to go\n\n92\n00:05:09.130 --> 00:05:11.650\nto Active Directory in Azure.\n\n93\n00:05:11.650 --> 00:05:14.240\nAnd probably, Daniel,\nwe were talking about it before the show,\n\n94\n00:05:14.240 --> 00:05:18.370\nthe number one reason for going to\nActive Directory in Azure or Azure,\n\n95\n00:05:18.370 --> 00:05:21.440\nif I can say that, is disaster recovery.\n\n96\n00:05:21.440 --> 00:05:22.730\n>> Yeah, that's exactly right.\n\n97\n00:05:22.730 --> 00:05:24.970\nThe first thing that pops\ninto my mind when I think,\n\n98\n00:05:24.970 --> 00:05:29.300\nI can take a copy of my Active Directory\nand I'm gonna stick out in the cloud.\n\n99\n00:05:29.300 --> 00:05:31.510\nWell, probably you're gonna\nget some I don't know.\n\n100\n00:05:31.510 --> 00:05:33.180\nYou're talking about my Active Directory.\n\n101\n00:05:33.180 --> 00:05:35.800\nThis is a very important\npart of my infrastructure.\n\n102\n00:05:35.800 --> 00:05:38.540\nAnd you're telling me I'm gonna\nchunk this out in the cloud and\n\n103\n00:05:38.540 --> 00:05:40.030\ngive it access to the internet?\n\n104\n00:05:40.030 --> 00:05:44.780\nCuz that's how you access stuff in the\ncloud is through an internet connectivity.\n\n105\n00:05:44.780 --> 00:05:46.500\nSo that's what you want me to do?\n\n106\n00:05:46.500 --> 00:05:50.580\nOkay, but obviously,\nlet's take a step back here.\n\n107\n00:05:50.580 --> 00:05:53.650\nI'm gonna stick it out there so that I can\naccess it when I need it, but otherwise,\n\n108\n00:05:53.650 --> 00:05:54.900\nit's gonna be shut off, right.\n\n109\n00:05:54.900 --> 00:05:56.900\nWe're just gonna keep it there,\nkeep it replicating,\n\n110\n00:05:56.900 --> 00:06:01.220\nso has a current copy it's more if this\ncopy of Active Directory gets blown away,\n\n111\n00:06:01.220 --> 00:06:05.950\nall my backups get blown away, I have\na DR site that I can just flip a switch,\n\n112\n00:06:05.950 --> 00:06:08.430\nsay, hey, start going to this ip address.\n\n113\n00:06:08.430 --> 00:06:11.720\nTurn that on, open it up and\nthen we're back in business.\n\n114\n00:06:11.720 --> 00:06:14.270\nThat's normally what people are gonna\nwanna do, at least at first.\n\n115\n00:06:14.270 --> 00:06:15.080\n>> Absolutely.\n\n116\n00:06:15.080 --> 00:06:16.590\nAnd it's a great way to set this up.\n\n117\n00:06:16.590 --> 00:06:20.490\nIf you've got a full copy of\nActive Directory out there in the cloud,\n\n118\n00:06:20.490 --> 00:06:24.810\nwhat better disaster recovery do I need\nthan hosting it on Microsoft sites?\n\n119\n00:06:24.810 --> 00:06:28.380\nThey've got great redundancy built in.\n\n120\n00:06:28.380 --> 00:06:29.390\nI know they're not gonna go down.\n\n121\n00:06:29.390 --> 00:06:34.190\nIf my corporate network gets blown away\nsomehow, I still have Active Directory.\n\n122\n00:06:34.190 --> 00:06:37.940\nAll I have to do is set everything\nback up, let replication do its job,\n\n123\n00:06:37.940 --> 00:06:40.050\nand I can be back up and running.\n\n124\n00:06:40.050 --> 00:06:43.550\nBranch offices that were relying on\nconnectivity at the corporate office for\n\n125\n00:06:43.550 --> 00:06:48.450\nauthentication and things like that, well,\nif they're using my Active Directory in\n\n126\n00:06:48.450 --> 00:06:52.180\nAzure, if the corporate office goes away,\nthey can still function.\n\n127\n00:06:52.180 --> 00:06:55.550\nBecause I've got a full copy of\nActive Directory out there in the cloud.\n\n128\n00:06:55.550 --> 00:06:58.960\nSo it's a great way to provide\nthat disaster recovery.\n\n129\n00:06:58.960 --> 00:07:02.410\n>> Yeah, and one of the cool\nbenefits about using the cloud and\n\n130\n00:07:02.410 --> 00:07:04.380\nActive Directory out there in Azure,\n\n131\n00:07:04.380 --> 00:07:07.910\nthe cloud service, is that I didn't\nhave to buy any infrastructure.\n\n132\n00:07:07.910 --> 00:07:09.160\nNormally, what would you have to do?\n\n133\n00:07:09.160 --> 00:07:11.050\nI'd have to go to a local utilities or\n\n134\n00:07:11.050 --> 00:07:14.340\nsomeone that does that kind of\nproviding of a disaster recovery area.\n\n135\n00:07:14.340 --> 00:07:15.900\nRemember, this has got to be off-site.\n\n136\n00:07:15.900 --> 00:07:20.563\nTypically outside of the boundaries, the\n[CROSSTALK] physically and geographically,\n\n137\n00:07:20.563 --> 00:07:23.595\nyou want it out of the way in\ncase something happens here.\n\n138\n00:07:23.595 --> 00:07:25.735\nThat's the whole purpose of a DR, right?\n\n139\n00:07:25.735 --> 00:07:27.180\nSo that's what we wanna have happen.\n\n140\n00:07:27.180 --> 00:07:29.635\nI gotta go there, then I've gotta\npurchase servers, I gotta purchase time,\n\n141\n00:07:29.635 --> 00:07:30.945\nI gotta purchase internet connectivity.\n\n142\n00:07:30.945 --> 00:07:33.595\nDon't forget backups,\ndon't forget physical security.\n\n143\n00:07:33.595 --> 00:07:38.345\nAll the bells and whistles that goes along\nwith an actual disaster recovery site,\n\n144\n00:07:38.345 --> 00:07:41.775\nsomething that if I flip a switch\nit's all there waiting and\n\n145\n00:07:41.775 --> 00:07:43.060\neverything starts to work.\n\n146\n00:07:43.060 --> 00:07:46.345\nThat's a lot of money outlay,\nright out of the gate,\n\n147\n00:07:46.345 --> 00:07:48.467\nI'm having to put that money out.\n\n148\n00:07:48.467 --> 00:07:52.517\nWith cloud, though, I get the benefit\nof a much-reduced cost with still\n\n149\n00:07:52.517 --> 00:07:54.688\nthe exact same functionality really.\n\n150\n00:07:54.688 --> 00:07:55.323\n>> Absolutely.\n\n151\n00:07:55.323 --> 00:07:59.392\nMost small organisations cannot afford\nto do what you were just saying,\n\n152\n00:07:59.392 --> 00:08:03.005\nhave a warm site or a hot site and\nbarely have a cold site, right.\n\n153\n00:08:03.005 --> 00:08:07.320\nAnd now we can enjoy those benefits\nof having that site that's up and\n\n154\n00:08:07.320 --> 00:08:10.890\nrunning and\nis just waiting in case something happens.\n\n155\n00:08:10.890 --> 00:08:14.190\nSo, a great reason to do this is\njust simply disaster recovery,\n\n156\n00:08:14.190 --> 00:08:15.670\nthat might be your only reason.\n\n157\n00:08:15.670 --> 00:08:19.270\nAnd really in my opinion,\nit's good enough, right?\n\n158\n00:08:19.270 --> 00:08:21.761\nIt's not that expensive to set up,\n\n159\n00:08:21.761 --> 00:08:26.671\nit's easy to maintain once you get\nit setup, it's just a no brainer.\n\n160\n00:08:26.671 --> 00:08:29.582\nAnd then there's other\nbenefits of doing or\n\n161\n00:08:29.582 --> 00:08:33.131\nother reasons we might do\nActive Directory in Azure.\n\n162\n00:08:33.131 --> 00:08:36.218\nI mentioned a branch office,\nright, well, let's think about it,\n\n163\n00:08:36.218 --> 00:08:37.825\nif we take Azure out of the picture.\n\n164\n00:08:37.825 --> 00:08:41.359\nWe're a corporate office, we've got all\nour server sitting here at the corporate\n\n165\n00:08:41.359 --> 00:08:44.070\nnetwork, I've got that server closet,\nit's all locked up.\n\n166\n00:08:44.070 --> 00:08:48.340\nIt's where my domain controllers are and\nall of my servers are in there.\n\n167\n00:08:48.340 --> 00:08:50.330\nWe wanna open up a branch office, well,\n\n168\n00:08:50.330 --> 00:08:54.230\nwhat kinda things do we have to think\nabout when we open up a branch office?\n\n169\n00:08:54.230 --> 00:08:57.400\nWe're gonna put users out there,\nthey're gonna be part of the domain.\n\n170\n00:08:57.400 --> 00:09:01.680\nI want their computers to authenticate,\nI want them to get a group policy,\n\n171\n00:09:01.680 --> 00:09:03.240\nI want user accounts.\n\n172\n00:09:03.240 --> 00:09:07.180\nSo from that branch office I need\nconnectivity back to the corporate office.\n\n173\n00:09:07.180 --> 00:09:11.980\nSo that usually means setting up a site\nto site and then if that's slow or\n\n174\n00:09:11.980 --> 00:09:12.980\nunreliable.\n\n175\n00:09:12.980 --> 00:09:15.680\nThat means my users out there at\nthe branch office have to deal with that\n\n176\n00:09:15.680 --> 00:09:16.230\nall the time.\n\n177\n00:09:16.230 --> 00:09:19.650\nA lot of times they don't\nhave the bandwidth to do\n\n178\n00:09:19.650 --> 00:09:21.630\nconnections out to the Internet.\n\n179\n00:09:21.630 --> 00:09:24.860\nIf one user's doing anything\nthat's bandwidth intensive,\n\n180\n00:09:24.860 --> 00:09:27.550\nthe other bandwidth obviously suffers.\n\n181\n00:09:27.550 --> 00:09:29.620\nSo we've got solutions for that, right?\n\n182\n00:09:29.620 --> 00:09:31.160\nWe've done it in our server classes.\n\n183\n00:09:31.160 --> 00:09:33.960\nWe've talked about putting in domain\ncontroller out there at the branch\n\n184\n00:09:33.960 --> 00:09:35.030\noffice, right?\n\n185\n00:09:35.030 --> 00:09:38.410\nBut I don't have the same physical\nsecurity at the branch office and\n\n186\n00:09:38.410 --> 00:09:41.120\nI don't have the manpower, right?\n\n187\n00:09:41.120 --> 00:09:44.840\nThe people that can maintain that\nserver out there at the branch office.\n\n188\n00:09:44.840 --> 00:09:45.476\nOkay, well,\n\n189\n00:09:45.476 --> 00:09:49.110\nI hear a bunch of you out there saying\nread-only domain controllers, right?\n\n190\n00:09:49.110 --> 00:09:50.800\nRead-only domain controllers.\n\n191\n00:09:50.800 --> 00:09:51.300\nYeah, exactly.\n\n192\n00:09:51.300 --> 00:09:54.140\nSo that's probably what we would end\nup doing is putting a read-only domain\n\n193\n00:09:54.140 --> 00:09:55.090\ncontroller out there.\n\n194\n00:09:55.090 --> 00:09:58.990\nThat way I don't have to worry as much\nabout the physical security because if\n\n195\n00:09:58.990 --> 00:10:01.462\nsomebody compromises\nthat domain controller.\n\n196\n00:10:01.462 --> 00:10:02.110\nIt's read-only,\n\n197\n00:10:02.110 --> 00:10:05.810\nthey can't make changes that are gonna\nreplicate back to the corporate office.\n\n198\n00:10:05.810 --> 00:10:10.200\nI can have a local administrator on\nthat server, that's not a domain admin.\n\n199\n00:10:10.200 --> 00:10:14.500\nSo they can do updates, install print\ndrivers, cuz it's probably doing more than\n\n200\n00:10:14.500 --> 00:10:17.740\njust Active Directory is the only\nserver at that branch office.\n\n201\n00:10:17.740 --> 00:10:23.220\nSo read-only domain controller does\nsolve some of those problems, right?\n\n202\n00:10:23.220 --> 00:10:25.560\nBut it is still an investment in a server.\n\n203\n00:10:25.560 --> 00:10:28.200\nI've gotta put that server out\nthere at that branch office.\n\n204\n00:10:29.260 --> 00:10:31.920\nWe've gotta make data,\nwe've gotta power it.\n\n205\n00:10:31.920 --> 00:10:35.560\nGotta worry a little bit about physical\nsecurity, whether it's read-only or not.\n\n206\n00:10:35.560 --> 00:10:37.880\nI don't wanna leave it in the lobby,\nright?\n\n207\n00:10:37.880 --> 00:10:40.510\nSo I've got to make sure\nwe're trying to secure it.\n\n208\n00:10:40.510 --> 00:10:45.340\nWell, again, this Active Directory\nin Azure can replace that need.\n\n209\n00:10:45.340 --> 00:10:47.959\nBecause my branch office\nhas Internet connectivity.\n\n210\n00:10:47.959 --> 00:10:51.450\nBut what if I just put a domain\ncontroller out there in the cloud?\n\n211\n00:10:51.450 --> 00:10:53.400\nNow they can connect to that and\n\n212\n00:10:53.400 --> 00:10:56.450\nthey can authenticate,\nthey can retrieve group policy.\n\n213\n00:10:56.450 --> 00:10:59.560\nAnd just like that domain controller\nwas sitting there at the branch office.\n\n214\n00:10:59.560 --> 00:11:02.930\nAnd I can open up three,\nfour, five branch offices.\n\n215\n00:11:02.930 --> 00:11:04.825\nAnd not have to buy three, four,\n\n216\n00:11:04.825 --> 00:11:08.561\nfive servers to put RODCs in each\none of those locations, right?\n\n217\n00:11:08.561 --> 00:11:10.330\nI've got users that travel.\n\n218\n00:11:10.330 --> 00:11:11.965\nWell, when they're out there on the road,\n\n219\n00:11:11.965 --> 00:11:15.810\nthey can authenticate to\nActive Directory in Azure, right?\n\n220\n00:11:15.810 --> 00:11:18.970\nThey can get DNS resolution to resources\n\n221\n00:11:18.970 --> 00:11:23.120\nback on my corporate network while\nthey're out there in the cloud.\n\n222\n00:11:23.120 --> 00:11:27.730\nSo a lot of advantages of doing\nthis Active Directory in Azure.\n\n223\n00:11:27.730 --> 00:11:31.360\nI think it's something that one,\nwe're gonna see more of.\n\n224\n00:11:31.360 --> 00:11:35.930\nThis hybrid type environment where I've\ngot the on-premise Active Directory.\n\n225\n00:11:35.930 --> 00:11:40.115\nAnd now I'm gonna put a copy of\nthat Active Directory, excuse me,\n\n226\n00:11:40.115 --> 00:11:41.252\nout in the cloud.\n\n227\n00:11:41.252 --> 00:11:45.183\nNow Daniel, I'll tell you one of\nthe things I hear people say a lot when we\n\n228\n00:11:45.183 --> 00:11:47.730\nstart talking about this is security.\n\n229\n00:11:47.730 --> 00:11:51.870\nAnd security is a concern and it should\nbe and it always will be a concern.\n\n230\n00:11:52.950 --> 00:11:58.735\nBut I will tell you that I find that most\nof the concerns are just unwarranted,\n\n231\n00:11:58.735 --> 00:11:59.359\nright?\n\n232\n00:11:59.359 --> 00:12:01.461\nBut they hear the word cloud and\nthey think, gosh,\n\n233\n00:12:01.461 --> 00:12:03.720\nI'm putting Active Directory\nout in the cloud.\n\n234\n00:12:03.720 --> 00:12:05.070\nActive Directory is everything.\n\n235\n00:12:05.070 --> 00:12:10.090\nIt's a record of every one of my machines,\nall of my users, all of my groups.\n\n236\n00:12:10.090 --> 00:12:14.070\nThere's a lot of proprietary\nimportant confidential information\n\n237\n00:12:14.070 --> 00:12:16.240\nstored in that Active Directory database.\n\n238\n00:12:16.240 --> 00:12:17.920\nI don't want to put it out in the cloud.\n\n239\n00:12:18.985 --> 00:12:24.230\nWell, if we think about the security\ninvolved in Microsoft Azure,\n\n240\n00:12:24.230 --> 00:12:28.180\nmy guess is they've got better security\non their end than I do on mine.\n\n241\n00:12:28.180 --> 00:12:30.550\n>> I would have to agree with\nyou on that there, Mike.\n\n242\n00:12:30.550 --> 00:12:35.430\nTo think about it this way, how much\nmoney does Microsoft have in total?\n\n243\n00:12:35.430 --> 00:12:39.260\nA lot, I can't count that high, I'm not\ngreat at math, they have a ton of money.\n\n244\n00:12:39.260 --> 00:12:42.460\nThey are not in the business of losing it,\nthey're in the business of making it.\n\n245\n00:12:42.460 --> 00:12:47.220\nThem being insecure, solution for you to\ngo to, is not a viable option for them.\n\n246\n00:12:47.220 --> 00:12:49.380\nThey are gonna lose clients left and\nright.\n\n247\n00:12:49.380 --> 00:12:51.540\nNo one's gonna use this Azure\nproduct if it's nothing but\n\n248\n00:12:51.540 --> 00:12:53.150\na huge gaping security hall.\n\n249\n00:12:53.150 --> 00:12:57.220\nYou might say Microsoft has been known for\nhaving huge gaping security holes.\n\n250\n00:12:57.220 --> 00:13:01.132\nThey have, but they have also been really\ngood at patching their systems as well.\n\n251\n00:13:01.132 --> 00:13:02.770\nAnd they're doing the same thing here.\n\n252\n00:13:02.770 --> 00:13:05.601\nYou've got to think of it when they\nhave a data center they open up,\n\n253\n00:13:05.601 --> 00:13:06.626\nwhat are they gonna do?\n\n254\n00:13:06.626 --> 00:13:08.740\nThey're gonna have physical\nsecurity around it I guarantee.\n\n255\n00:13:08.740 --> 00:13:10.130\nThat's gonna be well above and\n\n256\n00:13:10.130 --> 00:13:15.200\nbeyond anything that most small to\nmedium businesses can afford at all.\n\n257\n00:13:15.200 --> 00:13:17.250\nEven some large businesses\nare gonna be like,\n\n258\n00:13:17.250 --> 00:13:19.510\nare we gonna spend that\nmuch on armed guards?\n\n259\n00:13:19.510 --> 00:13:20.610\nProbably not.\n\n260\n00:13:20.610 --> 00:13:22.710\nMaybe, if they've got the money to do so.\n\n261\n00:13:22.710 --> 00:13:26.180\nThere's a lot of,\njust on the physical side of it and\n\n262\n00:13:26.180 --> 00:13:30.480\nthat's not to mention what they're going\nthrough on the actual digital side of it.\n\n263\n00:13:30.480 --> 00:13:31.610\nRight, Mike?\n>> Absolutely,\n\n264\n00:13:31.610 --> 00:13:34.060\nyou think about they've got\nredundancy when it comes to\n\n265\n00:13:34.060 --> 00:13:37.840\nsupplying power to those data centers\nwhere all these servers are stored.\n\n266\n00:13:37.840 --> 00:13:41.050\nThey've got generous,\nyou know Microsoft is going to.\n\n267\n00:13:41.050 --> 00:13:45.480\nThey have to be able to provide level of\nuptime that the customers are demanding.\n\n268\n00:13:45.480 --> 00:13:48.050\nSo and you're not their only customer,\nright?\n\n269\n00:13:48.050 --> 00:13:49.730\nSo they're gonna provide that.\n\n270\n00:13:49.730 --> 00:13:51.270\n>> Probably not the biggest\ncustomer either.\n\n271\n00:13:51.270 --> 00:13:52.029\n>> Probably not.\n\n272\n00:13:52.029 --> 00:13:54.600\n>> [LAUGH]\n>> So I think\n\n273\n00:13:54.600 --> 00:13:58.380\nsometimes we get a little hung up on\nthe fact that look, it's out on the cloud.\n\n274\n00:13:58.380 --> 00:14:01.640\nEverybody has access to it,\nit can't be secure.\n\n275\n00:14:01.640 --> 00:14:05.600\nAnd it couldn't be, I don't think it could\nbe in my opinion, further from the truth.\n\n276\n00:14:05.600 --> 00:14:08.580\nI think I can probably get\nmore security out of that,\n\n277\n00:14:08.580 --> 00:14:10.740\nlike I said, than what I do here.\n\n278\n00:14:10.740 --> 00:14:14.690\nHere, my physical location, we've got\npeople coming in off the street, right?\n\n279\n00:14:14.690 --> 00:14:18.720\nPeople can walk into my building cuz we\nwanna sell product and things like that.\n\n280\n00:14:18.720 --> 00:14:22.530\nSo right there is my physical\nsecurities no where near what\n\n281\n00:14:22.530 --> 00:14:24.260\ntheir gonna have at\nMicrosoft's Data Center.\n\n282\n00:14:24.260 --> 00:14:28.910\nI bet you I can't walk up and walk in the\nfront door of one of those data centers.\n\n283\n00:14:28.910 --> 00:14:31.848\n>> Not without talking to a large,\nburly man with a gun most likely.\n\n284\n00:14:31.848 --> 00:14:35.327\n>> [LAUGH]\n>> They've got redundancy when it comes to\n\n285\n00:14:35.327 --> 00:14:37.800\npower, when it comes to air conditioning.\n\n286\n00:14:37.800 --> 00:14:41.660\nWhen it comes to the servers, being able\nto move them on the fly if something goes\n\n287\n00:14:41.660 --> 00:14:44.240\ndown, so\nI think they've got us covered there.\n\n288\n00:14:44.240 --> 00:14:50.090\nWhat I will say though is that you can't\nget complacent with your security, right?\n\n289\n00:14:50.090 --> 00:14:52.570\nJust because you move your servers or\n\n290\n00:14:52.570 --> 00:14:56.730\nyou put some of your Active Directory\nout there in Azure, right?\n\n291\n00:14:56.730 --> 00:15:01.210\nPhysically, I think that virtual machine\nthat I'm running out there is secure.\n\n292\n00:15:01.210 --> 00:15:04.990\nNow, if I go and open up ports on it,\nyes, it is exposed to the Internet.\n\n293\n00:15:04.990 --> 00:15:09.330\nAnd if I don't secure that server\nproperly, if I leave default passwords,\n\n294\n00:15:09.330 --> 00:15:13.620\nif I use default ports, if I turn\non services that are not necessary.\n\n295\n00:15:13.620 --> 00:15:15.480\nThat's not Microsoft,\nthat's not the cloud service,\n\n296\n00:15:15.480 --> 00:15:18.620\nthat's me making that server insecure.\n\n297\n00:15:18.620 --> 00:15:21.860\nSo we still have to make sure\nwe're following best practices and\n\n298\n00:15:21.860 --> 00:15:24.410\nwe need to harden our servers.\n\n299\n00:15:24.410 --> 00:15:28.360\nIn fact, we might need to be\njust a little more proactive,\n\n300\n00:15:28.360 --> 00:15:31.000\nbecause there is that risk\nout there in the cloud.\n\n301\n00:15:31.000 --> 00:15:35.190\nIf I do something wrong,\nif I don't secure something properly.\n\n302\n00:15:35.190 --> 00:15:39.090\nThe odds of somebody finding it and\ntaking advantage of it might be greater.\n\n303\n00:15:39.090 --> 00:15:42.950\nThan what it was here in my physical\nnetwork or in my on-premise, right?\n\n304\n00:15:42.950 --> 00:15:46.200\nBut it's not to say that\nit can't be secured, right?\n\n305\n00:15:46.200 --> 00:15:49.220\nWe just have to make sure we\nare doing our due diligence and\n\n306\n00:15:49.220 --> 00:15:53.910\nour due care to secure those servers\nlike we would any other machine.\n\n307\n00:15:53.910 --> 00:15:55.262\nIs really what it comes down to.\n\n308\n00:15:55.262 --> 00:15:56.735\n>> And Mike, you make a great point.\n\n309\n00:15:56.735 --> 00:15:59.241\nThe fact that who is it that's\nmaking the mistake here?\n\n310\n00:15:59.241 --> 00:16:02.897\nIt's us as the admin, cuz you gotta\nremember with infrastructure as\n\n311\n00:16:02.897 --> 00:16:05.797\na service the accountability and\nresponsibility, or\n\n312\n00:16:05.797 --> 00:16:10.420\ncertain parts of it, stop with basically\nhardware and physical security, right?\n\n313\n00:16:10.420 --> 00:16:12.050\nThey're giving us the infrastructure,\n\n314\n00:16:12.050 --> 00:16:15.340\nthe actual physical part of\nthe platform that we need.\n\n315\n00:16:15.340 --> 00:16:19.440\nAnd that's what we're renting from them or\nbasically releasing from them anyway.\n\n316\n00:16:19.440 --> 00:16:23.710\nAnd then we have to configure and\nmaintain a secure servers on our end,\n\n317\n00:16:23.710 --> 00:16:25.420\nthat's our part of the job.\n\n318\n00:16:25.420 --> 00:16:28.630\nSo if I make a mistake,\nwhether it was on-premise or in the cloud,\n\n319\n00:16:28.630 --> 00:16:29.790\nI'm still making the mistake.\n\n320\n00:16:29.790 --> 00:16:31.690\nSo it doesn't matter where it sits.\n\n321\n00:16:31.690 --> 00:16:33.320\nIf I open a port that\ndoesn't need to be opened,\n\n322\n00:16:33.320 --> 00:16:35.260\nI start a service that doesn't\nneed to be started, and\n\n323\n00:16:35.260 --> 00:16:37.540\nit gets compromised, that was my fault.\n\n324\n00:16:37.540 --> 00:16:39.250\nThat was us as the IT admin.\n\n325\n00:16:39.250 --> 00:16:40.280\nThat was our responsibility.\n\n326\n00:16:40.280 --> 00:16:41.900\n>> Yeah, and it didn't happen\nbecause you put it in the cloud.\n\n327\n00:16:41.900 --> 00:16:43.340\n>> Right.\n>> It happened because you left\n\n328\n00:16:43.340 --> 00:16:46.010\nthat service on or didn't close that port.\n\n329\n00:16:46.010 --> 00:16:47.880\nAll right.\nSo we got a good idea, then, I think,\n\n330\n00:16:47.880 --> 00:16:49.210\nwhat we're talking about here.\n\n331\n00:16:49.210 --> 00:16:52.060\nWe're talking about\nActive Directory in Azure.\n\n332\n00:16:52.060 --> 00:16:53.790\nTalking about infrastructure as a service.\n\n333\n00:16:53.790 --> 00:16:56.900\nWe're gonna be creating virtual machines\nout there in Azure, we're gonna\n\n334\n00:16:56.900 --> 00:17:01.110\nbe installing Active Directory on it, and\nwe're gonna make it part of our network.\n\n335\n00:17:01.110 --> 00:17:05.210\nSo let's take a look at, I've got a little\ndiagram so we can kind of visualize\n\n336\n00:17:05.210 --> 00:17:10.620\nwhat we're going to be doing over\nthe course of the next few episodes here.\n\n337\n00:17:10.620 --> 00:17:14.660\nSo we're gonna start by setting\nup our on-premise network.\n\n338\n00:17:14.660 --> 00:17:16.680\nAnd we're gonna go through\nthis from the beginning.\n\n339\n00:17:16.680 --> 00:17:17.880\nNothing is already done.\n\n340\n00:17:17.880 --> 00:17:19.960\nI mean,\nI've got the virtual machines created, but\n\n341\n00:17:19.960 --> 00:17:20.960\nI'm gonna show you the whole thing.\n\n342\n00:17:20.960 --> 00:17:22.920\nSo part of this should be a review for\nyou.\n\n343\n00:17:22.920 --> 00:17:26.696\nIf you're familiar with Active Directory\nalready, getting that installed,\n\n344\n00:17:26.696 --> 00:17:28.949\ngetting your prereqs set,\nand doing all that,\n\n345\n00:17:28.949 --> 00:17:31.956\nthen the first couple of episodes\nmight be a refresher for you.\n\n346\n00:17:31.956 --> 00:17:35.337\nBut I know some people that are watching\nthese episodes haven't seen any of this,\n\n347\n00:17:35.337 --> 00:17:37.306\nwhether it's on-premise or\nout in the cloud.\n\n348\n00:17:37.306 --> 00:17:38.780\nSo, we are gonna start from the beginning.\n\n349\n00:17:38.780 --> 00:17:40.760\nAnd we're gonna set up\na domain controller,\n\n350\n00:17:40.760 --> 00:17:43.030\nan on-premise domain controller.\n\n351\n00:17:43.030 --> 00:17:46.260\nIt's also gonna be running DNS,\ncuz that's most common.\n\n352\n00:17:46.260 --> 00:17:49.750\nWe typically put DNS and\nActive Directory on the same server.\n\n353\n00:17:49.750 --> 00:17:51.280\nSo we're gonna have that.\n\n354\n00:17:51.280 --> 00:17:53.300\nThen I'm gonna set up a router.\n\n355\n00:17:53.300 --> 00:17:58.140\nWe're gonna take another server and\nwe're going to install VPN services and\n\n356\n00:17:58.140 --> 00:17:59.850\nrouting remote access.\n\n357\n00:17:59.850 --> 00:18:02.000\nAnd this is gonna be\nsitting out in my DMZ.\n\n358\n00:18:02.000 --> 00:18:05.880\nSo back here is gonna be my\nprivate corporate network.\n\n359\n00:18:05.880 --> 00:18:09.940\nI'm gonna have, again, another virtual\nmachine, a router, running that routing\n\n360\n00:18:09.940 --> 00:18:14.470\nremote access that has a connection to the\ninside and a connection to the outside.\n\n361\n00:18:14.470 --> 00:18:17.280\nSo this is basically my DMZ, right?\n\n362\n00:18:17.280 --> 00:18:18.800\nYou guys are familiar\nwith that term hopefully.\n\n363\n00:18:18.800 --> 00:18:20.020\nMy demilitarized zone?\n\n364\n00:18:20.020 --> 00:18:24.190\nThis is where I put servers that\nneed that level of public access.\n\n365\n00:18:24.190 --> 00:18:26.960\nSome anonymous connectivity\ncan come into here.\n\n366\n00:18:26.960 --> 00:18:28.630\nSo we're gonna set all of this up.\n\n367\n00:18:28.630 --> 00:18:32.180\nAnd there's a couple of things that we're\ngonna have to make sure we do properly.\n\n368\n00:18:32.180 --> 00:18:35.950\nWe've gotta set up\nActive Directory normally.\n\n369\n00:18:35.950 --> 00:18:39.050\nBut then there's a couple of things\nwe wanna do after we get it set up\n\n370\n00:18:39.050 --> 00:18:43.000\nto get it ready to do\nActive Directory in Azure.\n\n371\n00:18:43.000 --> 00:18:47.067\nAgain, I've got that routing\nremote access server, and\n\n372\n00:18:47.067 --> 00:18:52.379\nreally what's gonna end up happening is,\nI can bump this over a little bit,\n\n373\n00:18:52.379 --> 00:18:56.032\nwe're gonna end up creating\na site-to-site VPN.\n\n374\n00:18:56.032 --> 00:18:58.896\nUp here in Azure,\nwe're gonna create a virtual server and\n\n375\n00:18:58.896 --> 00:19:01.300\nwe're going to install\nActive Directory on it.\n\n376\n00:19:01.300 --> 00:19:04.150\nWe're gonna create a virtual network up\nthere and then we're gonna create that\n\n377\n00:19:04.150 --> 00:19:07.140\nvirtual server and\nwe're going to install Active Directory,\n\n378\n00:19:07.140 --> 00:19:09.870\nas well as DNS is going\nto be on that server.\n\n379\n00:19:09.870 --> 00:19:13.070\nSo you can think of it just like, and\nlike I said, almost like a branch office,\n\n380\n00:19:13.070 --> 00:19:16.680\nit's another subnet on my network.\n\n381\n00:19:16.680 --> 00:19:19.960\nAnd then there's gonna be that\nsite-to-site VPN between the two.\n\n382\n00:19:19.960 --> 00:19:24.878\nAnd that's what's going to allow the\nconnectivity between my domain controller\n\n383\n00:19:24.878 --> 00:19:29.225\non the corporate network and my domain\ncontroller out here in the cloud or\n\n384\n00:19:29.225 --> 00:19:30.200\non Azure.\n\n385\n00:19:30.200 --> 00:19:32.640\nAnd they're gonna talk to each other, and\n\n386\n00:19:32.640 --> 00:19:35.560\nit's not like Azure AD\nwhere it's just port 80 and\n\n387\n00:19:35.560 --> 00:19:39.860\nour web traffic, they're gonna be\nreplicating just like it was another site.\n\n388\n00:19:39.860 --> 00:19:42.700\nJust like this was another\nphysical location,\n\n389\n00:19:42.700 --> 00:19:48.020\nlike I had another office in Dallas or out\nin Seattle, it's gonna work the same way.\n\n390\n00:19:48.020 --> 00:19:51.240\nWe're actually gonna create\nsites within Active Directory\n\n391\n00:19:51.240 --> 00:19:52.980\nthat represent the corporate office.\n\n392\n00:19:52.980 --> 00:19:55.920\nWe're gonna create a site in\nActive Directory that represents\n\n393\n00:19:55.920 --> 00:19:58.770\nthe domain controller out there on Azure.\n\n394\n00:19:58.770 --> 00:20:00.495\nAnd we're gonna be able to\ncontrol the replications.\n\n395\n00:20:00.495 --> 00:20:04.125\nJust like we would normally do\nin an on-premise where we had\n\n396\n00:20:04.125 --> 00:20:06.775\ntwo different physical locations or\ntwo different sites, right?\n\n397\n00:20:06.775 --> 00:20:11.545\nCuz it's replication between sites\ninstead of being on the same site.\n\n398\n00:20:11.545 --> 00:20:13.985\nSo we'll get all of that set up, and\n\n399\n00:20:13.985 --> 00:20:17.230\nthen once that's configured,\nwe should be good to go.\n\n400\n00:20:17.230 --> 00:20:22.000\nWe'll have it set up to where that branch\noffice, again, can use this as their\n\n401\n00:20:22.000 --> 00:20:25.470\nActive Directory and they can connect\nto that, they can resolve names, right?\n\n402\n00:20:25.470 --> 00:20:30.035\nDNS is gonna be out there, so they'll be\nable to resolve names of other resources\n\n403\n00:20:30.035 --> 00:20:33.655\non my internal and my on-premise network.\n\n404\n00:20:33.655 --> 00:20:36.567\nI could have users that are floating\naround out there in the cloud,\n\n405\n00:20:36.567 --> 00:20:39.745\ncuz I've got a lot of users that do that.\n\n406\n00:20:39.745 --> 00:20:43.775\nLike sales people that are on the road,\npeople that work from home,\n\n407\n00:20:43.775 --> 00:20:47.245\nthey're not at a branch office but\nthey still need access to the network.\n\n408\n00:20:47.245 --> 00:20:53.180\nAnd again, the beautiful thing is we're\ngonna be able to apply group policy and\n\n409\n00:20:53.180 --> 00:20:53.790\nthings like that.\n\n410\n00:20:53.790 --> 00:20:56.880\nI can't do that with AzureAD.\n\n411\n00:20:56.880 --> 00:21:02.550\nI still need these guys to connect the\nActive Directory to retrieve group policy.\n\n412\n00:21:02.550 --> 00:21:05.660\nWe're gonna have that capability here.\n\n413\n00:21:05.660 --> 00:21:09.548\nI think it's gonna be a great ride,\nwe're gonna get all this set up.\n\n414\n00:21:09.548 --> 00:21:13.850\nShow you step-by-step how to set up\nthat on-premise Active Directory,\n\n415\n00:21:13.850 --> 00:21:18.290\nhow to get it ready to connect out\nthere to Active Directory in Azure.\n\n416\n00:21:18.290 --> 00:21:20.930\nThen we're gonna set up out\nin Active Directory Azure,\n\n417\n00:21:20.930 --> 00:21:22.650\nwe're gonna create our domain controllers.\n\n418\n00:21:22.650 --> 00:21:25.600\nThere is a couple of caveats when you're\nsetting up that machine that we'll have to\n\n419\n00:21:25.600 --> 00:21:26.670\npay attention to.\n\n420\n00:21:26.670 --> 00:21:28.730\nWe'll get Active Directory\ninstalled on there.\n\n421\n00:21:28.730 --> 00:21:32.480\nThen we'll set up that site-to-site VPN\nconnection, and we should be able to\n\n422\n00:21:32.480 --> 00:21:37.091\nhave those guys replicating just like\nthey were, well, not in the cloud.\n\n423\n00:21:37.091 --> 00:21:38.376\n[LAUGH]\n>> Yeah, and the cool thing about this,\n\n424\n00:21:38.376 --> 00:21:41.800\nthis series anyway, is that it's\na very practical series, right?\n\n425\n00:21:41.800 --> 00:21:46.600\nThis is an environment that is very\nprevalent in today's IT environment.\n\n426\n00:21:46.600 --> 00:21:49.916\nSo if you can take this knowledge and\napply it directly to wherever you're\n\n427\n00:21:49.916 --> 00:21:53.819\nworking right now, or if you haven't got\ninto that yet, when you do, you'll say,\n\n428\n00:21:53.819 --> 00:21:57.426\nyes, I've seen this model before,\nI know exactly how it's supposed to work.\n\n429\n00:21:57.426 --> 00:22:02.143\nAnd until everything goes to the cloud one\nday, this is something we're gonna have to\n\n430\n00:22:02.143 --> 00:22:07.190\ndeal with that we have these on-premises,\nhybrid-type models, on-premise devices,\n\n431\n00:22:07.190 --> 00:22:12.000\nand specifically, Active Directory, trying\nto talk to our cloud Active Directory.\n\n432\n00:22:12.000 --> 00:22:13.930\nWe try to keep it a little easier.\n\n433\n00:22:13.930 --> 00:22:15.650\nTo reference there in Azure, right.\n\n434\n00:22:15.650 --> 00:22:16.266\nThat's our cloud service.\n\n435\n00:22:16.266 --> 00:22:17.832\n[LAUGH]\n>> [LAUGH] It is a mouth full to try\n\n436\n00:22:17.832 --> 00:22:19.280\nto say to keep them straight.\n\n437\n00:22:19.280 --> 00:22:20.430\n>> Yeah.\nIt really does.\n\n438\n00:22:20.430 --> 00:22:22.372\nIt starts to get confusing so\nvery, very quickly.\n\n439\n00:22:22.372 --> 00:22:24.680\n>> It is.\n>> All right, Micheal, that being said,\n\n440\n00:22:24.680 --> 00:22:25.590\nwe now have our road map.\n\n441\n00:22:25.590 --> 00:22:28.030\nIs there anything else for\nthis episode that we need to cover?\n\n442\n00:22:28.030 --> 00:22:29.130\n>> Nope.\nI think we're good to go.\n\n443\n00:22:29.130 --> 00:22:32.160\nI hope you guys are excited as\nI am about getting starting and\n\n444\n00:22:32.160 --> 00:22:33.960\ndoing some Active Directory in Azure.\n\n445\n00:22:33.960 --> 00:22:36.140\n>> Well, Mike I'm super,\nsuper excited about this.\n\n446\n00:22:36.140 --> 00:22:37.160\nI'm looking forward to it.\n\n447\n00:22:37.160 --> 00:22:38.700\nWe thank you for coming in here and\n\n448\n00:22:38.700 --> 00:22:42.220\nlending that wonderful brain you have\nthere as far as Microsoft products go.\n\n449\n00:22:42.220 --> 00:22:43.660\nMan knows his stuff.\n\n450\n00:22:43.660 --> 00:22:46.040\nAs for you guys out there, well,\nwe appreciate you watching.\n\n451\n00:22:46.040 --> 00:22:48.740\nWe're gonna go ahead and sign off for\nthis episode from my ITproTV.\n\n452\n00:22:48.740 --> 00:22:50.080\nI've been your host Daniel Lowrie.\n\n453\n00:22:50.080 --> 00:22:51.110\n>> And I'm Mike Rodrick.\n\n454\n00:22:51.110 --> 00:22:52.071\n>> And we'll see you next time\n\n455\n00:22:52.071 --> 00:22:59.084\n[MUSIC]\n\n",
          "vimeoId": "154722116"
        },
        {
          "description": "In this episode, Daniel and Mike take you through installing Active Directory(AD) for your on-premises server(s). The purpose of this episode is to create an on-premises environment that we will later connect to an Azure cloud environment. Here we focus on installing AD, along with DNS, and promoting our server to be a Domain Controller.",
          "length": "2068",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-2-configure_on_premise_ad-020816-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-2-configure_on_premise_ad-020816-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-2-configure_on_premise_ad-020816-1-sm.jpg",
          "title": "Configure On-premises AD",
          "transcript": "WEBVTT\n\n1\n00:00:02.110 --> 00:00:06.285\n[MUSIC]\n\n2\n00:00:06.285 --> 00:00:10.676\nAll right greetings everyone and\n\n3\n00:00:10.676 --> 00:00:16.800\nwelcome to another great\nepisode of ITProTV.\n\n4\n00:00:16.800 --> 00:00:20.016\nI'm your host Daniel Lowrie,\nand in today's episode,\n\n5\n00:00:20.016 --> 00:00:24.170\nwell we are moving on with our series\nthat we're working on with Azure AD,\n\n6\n00:00:24.170 --> 00:00:26.261\nnot Azure AD, AD and Azure, right?\n\n7\n00:00:26.261 --> 00:00:28.169\nListen, again,\nwe gotta keep that thing straight.\n\n8\n00:00:28.169 --> 00:00:31.384\nJoining us yet again here in the studio\nis our good friend Mr. Mike Rodrick.\n\n9\n00:00:31.384 --> 00:00:32.824\nMike, welcome back to the show sir.\n\n10\n00:00:32.824 --> 00:00:34.182\n>> Hi, thanks for having me.\n\n11\n00:00:34.182 --> 00:00:35.285\nCan't wait to get started.\n\n12\n00:00:35.285 --> 00:00:39.372\nWe are, as you said, continuing on with\nour Active Directory in Azure, right?\n\n13\n00:00:39.372 --> 00:00:42.029\nAnd I'll probably say it wrong\nthroughout half of these episodes.\n\n14\n00:00:42.029 --> 00:00:43.824\n>> [LAUGH]\n>> Remember, though,\n\n15\n00:00:43.824 --> 00:00:47.509\nthere is difference between\nActive Directory in Azure and Azure AD.\n\n16\n00:00:47.509 --> 00:00:51.322\nAzure AD being, software as a service\nwhere we are just taking advantage of\n\n17\n00:00:51.322 --> 00:00:55.376\nthe identity management and the federation\nthat Microsoft has with all of these\n\n18\n00:00:55.376 --> 00:00:58.480\ndifferent organizations to\nsupport that single sign-on.\n\n19\n00:00:58.480 --> 00:01:03.259\nActive Directory in Azure, what we're\ndoing here is actually hosting a copy\n\n20\n00:01:03.259 --> 00:01:08.200\nof my Active Directory, my organization's\nActive Directory in the Cloud.\n\n21\n00:01:08.200 --> 00:01:11.020\nNot just identities but\nfull blown Active Directory.\n\n22\n00:01:11.020 --> 00:01:14.790\nReplication occurring between my\non-premises domain controllers and\n\n23\n00:01:14.790 --> 00:01:17.720\nmy domain controllers\nout there in the Cloud,\n\n24\n00:01:17.720 --> 00:01:20.710\nsupporting all the protocols\nthat Active Directory uses.\n\n25\n00:01:20.710 --> 00:01:24.940\nNot just using web traffic\nto do some single sign-on.\n\n26\n00:01:24.940 --> 00:01:28.060\nSo that is the difference and\nthat's what we're gonna be doing today.\n\n27\n00:01:28.060 --> 00:01:31.050\nSo what we wanted to do though, is we\nwanted to start from the very beginning.\n\n28\n00:01:31.050 --> 00:01:35.590\nWe didn't wanna assume anything so we're\ngonna start with our on-premises network.\n\n29\n00:01:35.590 --> 00:01:38.210\nWe're gonna configure\nActive Directory there.\n\n30\n00:01:38.210 --> 00:01:42.100\nWe'll get it installed and I will get\nrouting and remote access installed.\n\n31\n00:01:42.100 --> 00:01:43.790\nWe'll get DNS installed.\n\n32\n00:01:43.790 --> 00:01:45.840\nWe'll get everything installed\nthat we would need for\n\n33\n00:01:45.840 --> 00:01:48.110\na normal on-premises network, right.\n\n34\n00:01:48.110 --> 00:01:51.800\nThen we're gonna go and\nstart extending that out in the Cloud.\n\n35\n00:01:51.800 --> 00:01:55.680\nRearranging some of our Active Directory,\nor doing some configuration to\n\n36\n00:01:55.680 --> 00:02:01.040\nActive Directory to support extending\nit out in to the Cloud or in to Azure.\n\n37\n00:02:01.040 --> 00:02:05.140\nSo lets start by just getting\nActive Directory installed.\n\n38\n00:02:05.140 --> 00:02:07.820\nI've got my machine up and running here,\nand a couple of things we wanna\n\n39\n00:02:07.820 --> 00:02:12.020\nthink about, again if you're newer to\nActive Directory we definitely have a few\n\n40\n00:02:12.020 --> 00:02:16.360\nshows in our course library that deal\nwith getting Active Directory installed.\n\n41\n00:02:16.360 --> 00:02:19.480\nSo if you want more detail than\nwhat we're getting ready to do,\n\n42\n00:02:19.480 --> 00:02:21.130\nmake sure you go check those out.\n\n43\n00:02:21.130 --> 00:02:25.150\nBut as far as installing Active Directory\ngoes, you need a physical machine, right.\n\n44\n00:02:25.150 --> 00:02:27.450\nOr I guess you could\nuse a virtual machine.\n\n45\n00:02:27.450 --> 00:02:29.540\nI get hung up on the physical sometimes.\n\n46\n00:02:29.540 --> 00:02:31.660\nYeah, but you need a machine that\nyou're gonna install that on.\n\n47\n00:02:31.660 --> 00:02:35.530\nYou need your software,\nI'm gonna be running 2012 R2.\n\n48\n00:02:35.530 --> 00:02:40.270\nSo the latest and greatest,\nwhich is really a good thing to do,\n\n49\n00:02:40.270 --> 00:02:45.430\nespecially when we start virtualizing\nthese 2012 R2 is fully aware of\n\n50\n00:02:45.430 --> 00:02:49.600\nbeing virtualized and has a lot of things\nthat can help me when I'm virtualizing.\n\n51\n00:02:49.600 --> 00:02:52.280\nEspecially virtualizing\ndomain controllers,\n\n52\n00:02:52.280 --> 00:02:55.980\ncuz that's a tricky proposition or\ncan get you into a little bit of trouble\n\n53\n00:02:55.980 --> 00:02:59.330\nif you start using checkpoints\non those domain controllers.\n\n54\n00:02:59.330 --> 00:03:03.100\nSo with that being said,\nlet's go ahead and start here.\n\n55\n00:03:03.100 --> 00:03:04.200\nInstalling Active Directory,\n\n56\n00:03:04.200 --> 00:03:07.440\nwhat you wanna remember is it's\na two part process, right.\n\n57\n00:03:07.440 --> 00:03:13.300\nI have to install the role itself, then I\nhave to go back and configure the role.\n\n58\n00:03:13.300 --> 00:03:16.370\nA couple of things I'd wanna check\non this machine before I go and\n\n59\n00:03:16.370 --> 00:03:20.240\ninstall Active Directory, really,\nI need disk space to store\n\n60\n00:03:20.240 --> 00:03:24.240\nthe Active Directory database,\nI need a static IP address.\n\n61\n00:03:24.240 --> 00:03:26.880\nThat's probably the biggest\nthing I wanna worry about is\n\n62\n00:03:26.880 --> 00:03:29.670\nmaking sure that I've got an IP\naddress that's not gonna change.\n\n63\n00:03:29.670 --> 00:03:34.000\nA lot of records get registered, SRV\nrecords, if we start changing IP address.\n\n64\n00:03:34.000 --> 00:03:38.110\nIt's supported, Microsoft will let you\nchange IP addresses of domain controllers.\n\n65\n00:03:38.110 --> 00:03:41.860\nI don't know about you, Daniel,\nI like to avoid it if at all possible.\n\n66\n00:03:41.860 --> 00:03:45.250\nSeen too many things go\nawry when I do that.\n\n67\n00:03:45.250 --> 00:03:45.830\nSo let's verify.\n\n68\n00:03:45.830 --> 00:03:48.670\nI go over here to local server,\nI've got my computer,\n\n69\n00:03:48.670 --> 00:03:54.340\nit's currently named good old GNV-dc01 and\nit's a member of a workgroup and\n\n70\n00:03:54.340 --> 00:03:59.785\nit has a static IP address of 10.1.1.10.\n\n71\n00:03:59.785 --> 00:04:01.980\nI also went out and got all of my updates.\n\n72\n00:04:01.980 --> 00:04:04.910\nNow you'll see it says never check for\nupdates.\n\n73\n00:04:04.910 --> 00:04:06.970\nNot a recommended practice, but for\n\n74\n00:04:06.970 --> 00:04:10.630\nour lab environment I don't want\nin the background it checking for\n\n75\n00:04:10.630 --> 00:04:13.050\nupdates, installing updates\nin the middle of a show.\n\n76\n00:04:13.050 --> 00:04:16.660\nSo I went out, got all the latest\nupdates up until last night, and\n\n77\n00:04:16.660 --> 00:04:19.530\nthen I turned off automatic\nupdates just for the show.\n\n78\n00:04:19.530 --> 00:04:22.206\nKeep in mind that is definitely\nnot a recommended practice.\n\n79\n00:04:22.206 --> 00:04:25.020\nGot my time zones set, you know,\n\n80\n00:04:25.020 --> 00:04:29.060\nall the normal things that you would do\nafter installing the operating system.\n\n81\n00:04:29.060 --> 00:04:31.490\nSo we are good to go there.\n\n82\n00:04:31.490 --> 00:04:34.760\nSo then we begin the process of\ninstalling Active Directory.\n\n83\n00:04:34.760 --> 00:04:38.070\nSo I'm gonna flip back over to my\nDashboard and I've got the good old link,\n\n84\n00:04:38.070 --> 00:04:39.730\nAdd roles and features.\n\n85\n00:04:39.730 --> 00:04:42.580\nAnd sometimes we get a little\ndependent on this screen,\n\n86\n00:04:42.580 --> 00:04:46.040\nremember this is a kind of\na welcome to Server Manager.\n\n87\n00:04:46.040 --> 00:04:48.760\nIt's got these little quick\nstart options over here.\n\n88\n00:04:48.760 --> 00:04:50.430\nIf this was not there.\n\n89\n00:04:50.430 --> 00:04:54.730\nWhich you might go to a machine and it's\nnot there, cuz they can hide this, right.\n\n90\n00:04:54.730 --> 00:04:59.630\nThen you would go to Manage and\nthen Add Roles and Features.\n\n91\n00:04:59.630 --> 00:05:03.130\nSo either way, we're gonna start\nthe good old Add Roles and\n\n92\n00:05:03.130 --> 00:05:08.300\nFeatures Wizard and it's going to walk me\nthrough the process of installing a role.\n\n93\n00:05:08.300 --> 00:05:09.910\nWe'll click, Next.\n\n94\n00:05:09.910 --> 00:05:13.450\nThis is going to be a Role-based\ninstallation, so, I'll click next.\n\n95\n00:05:14.690 --> 00:05:17.760\nIt has the right server selected\nthat I wanna add this role to.\n\n96\n00:05:17.760 --> 00:05:18.940\nI'll click next.\n\n97\n00:05:18.940 --> 00:05:23.220\nAnd then I'm gonna choose\nthe role I want in this case\n\n98\n00:05:23.220 --> 00:05:25.500\nActive Directory Domains Services.\n\n99\n00:05:25.500 --> 00:05:28.170\nAnd It tells me that if I'm\ngonna install that role\n\n100\n00:05:28.170 --> 00:05:32.090\nhere are some features that are required\nfor Active Directory Domain Services.\n\n101\n00:05:32.090 --> 00:05:33.690\nWould you like to add them?\n\n102\n00:05:33.690 --> 00:05:34.800\nI like the way they ask me.\n\n103\n00:05:34.800 --> 00:05:37.590\nIt says it's required, but do you want to.\n\n104\n00:05:38.990 --> 00:05:39.695\nNo, I don't want to.\n\n105\n00:05:39.695 --> 00:05:40.970\n[LAUGH]\n>> Yeah, who needs that, Mike?\n\n106\n00:05:40.970 --> 00:05:42.420\nIt's completely ludicrous,\n\n107\n00:05:42.420 --> 00:05:46.220\nthe fact that if I don't install these\nfeatures, you're not gonna get anywhere.\n\n108\n00:05:46.220 --> 00:05:47.780\nYou can't even install Active Directory.\n\n109\n00:05:47.780 --> 00:05:49.480\nBut I want Active Directory installed.\n\n110\n00:05:49.480 --> 00:05:52.791\nWell then, yeah, I need,\nyou say these are requirements,\n\n111\n00:05:52.791 --> 00:05:58.280\nthe question where they ask you whether or\nnot you need this is superfluous.\n\n112\n00:05:58.280 --> 00:05:59.430\nIt's not even necessary.\n\n113\n00:05:59.430 --> 00:06:01.180\n>> It really is.\nThe only thing I can possibly think\n\n114\n00:06:01.180 --> 00:06:04.130\nis maybe you get here and\nrealize I didn't know it was gonna\n\n115\n00:06:04.130 --> 00:06:08.320\ninstall the Active Directory module for\nWindows PowerShell, never mind.\n\n116\n00:06:08.320 --> 00:06:08.890\nMaybe.\n\n117\n00:06:08.890 --> 00:06:11.160\nSo you also get to include\nthe Management Tools, right.\n\n118\n00:06:11.160 --> 00:06:14.260\nIf we're gonna use that\ngraphical user interface, or\n\n119\n00:06:14.260 --> 00:06:18.400\nActive Directory uses the computers and\nall those snap-ins, we'll include those.\n\n120\n00:06:18.400 --> 00:06:21.534\nI click Add Features and\nthen I click Next.\n\n121\n00:06:21.534 --> 00:06:23.514\nI don't need anything else,\n\n122\n00:06:23.514 --> 00:06:28.100\nso I'll just keep clicking Next and\nintro screen for Active Directory.\n\n123\n00:06:28.100 --> 00:06:30.500\nTake your time and\nread that when you doing this on your on.\n\n124\n00:06:30.500 --> 00:06:33.040\nI'll click Next, and\nthen I get my confirmation,\n\n125\n00:06:33.040 --> 00:06:36.060\nand I've got the option\nto restart if necessary.\n\n126\n00:06:36.060 --> 00:06:37.500\nRemember, if you were doing this remotely,\n\n127\n00:06:37.500 --> 00:06:40.280\nwhich you definitely can do with\nServer Manager, if you're not there,\n\n128\n00:06:40.280 --> 00:06:44.480\nyou might wanna restart it, but this role,\nin particular, does not require reboot.\n\n129\n00:06:44.480 --> 00:06:46.890\nAll right, so I happen to know\nthat just from experience, so\n\n130\n00:06:46.890 --> 00:06:48.440\nI'm not gonna bother checking it.\n\n131\n00:06:48.440 --> 00:06:49.840\nAnd I'll click Install.\n\n132\n00:06:49.840 --> 00:06:52.870\nAnd this is gonna go through and\ninstall the role.\n\n133\n00:06:52.870 --> 00:06:54.910\nNow what we've got to remember\nwith Active Directory,\n\n134\n00:06:54.910 --> 00:06:57.600\nthough, it is a two step process.\n\n135\n00:06:57.600 --> 00:06:58.880\nYou install the role.\n\n136\n00:06:58.880 --> 00:07:02.410\nWhen this finishes,\nyou do not have a domain controller.\n\n137\n00:07:02.410 --> 00:07:06.570\nAll the pieces necessary to make it\na domain controller are gonna be there.\n\n138\n00:07:06.570 --> 00:07:09.220\nWell we still have to go\nthrough the Active Directory\n\n139\n00:07:09.220 --> 00:07:13.380\nconfiguration wizard to actually\nset up Active Directory.\n\n140\n00:07:13.380 --> 00:07:18.420\nEither create a new forest, or\nadd a new domain to an existing forest, or\n\n141\n00:07:18.420 --> 00:07:21.570\nadd a domain controller\nto an existing domain.\n\n142\n00:07:21.570 --> 00:07:24.010\nSet up all of it, and I'm gonna go\nthrough these options again with you,\n\n143\n00:07:24.010 --> 00:07:27.080\nbut creating, are you gonna install DNS?\n\n144\n00:07:27.080 --> 00:07:31.730\nDo you need the, where are you gonna\nlocate SysFall in the database and\n\n145\n00:07:31.730 --> 00:07:33.610\nthe log files?\n\n146\n00:07:33.610 --> 00:07:38.020\nA few other things that We'll have to,\nyour NetBIOS name and things like that.\n\n147\n00:07:38.020 --> 00:07:40.480\nSo, all of that will\ncome in the next wizard.\n\n148\n00:07:40.480 --> 00:07:43.540\nRemember the other handy thing about\nServer Manager, is this guy is\n\n149\n00:07:43.540 --> 00:07:48.530\nin progress, if I close this,\nthat does not kill that process, right.\n\n150\n00:07:48.530 --> 00:07:52.698\nIt is still going on in the background,\nwe can multitask using Server Manager.\n\n151\n00:07:52.698 --> 00:07:54.358\nI can do other things.\n\n152\n00:07:54.358 --> 00:07:56.558\nIt'll let me know when\nthat wizard completes.\n\n153\n00:07:56.558 --> 00:08:01.885\nI've got my little Notifications flag\nup here, I can click on that and\n\n154\n00:08:01.885 --> 00:08:06.788\nthere I can see it is still working,\nso it's not quite done yet.\n\n155\n00:08:06.788 --> 00:08:11.280\nSo I'll let let that go, again,\nit shouldn't take too long.\n\n156\n00:08:11.280 --> 00:08:14.960\nYou know, one of the things I love and\nI always mention, we've get some time to\n\n157\n00:08:14.960 --> 00:08:19.100\nkill here, is the fact that, and\nit started with 2008 but 2012 as well.\n\n158\n00:08:19.100 --> 00:08:20.935\nNotice I didn't have to go get the disk.\n\n159\n00:08:20.935 --> 00:08:23.760\nDanny, you go back far enough to\nremember 2003, and every time you\n\n160\n00:08:23.760 --> 00:08:26.640\nwanted to install something,\nyou had to go find that install disk.\n\n161\n00:08:26.640 --> 00:08:27.650\n>> Yeah, that's always fun.\n\n162\n00:08:27.650 --> 00:08:32.420\nAnd you know you've left it in that pile\nof MSDN disks that we used to keep around.\n\n163\n00:08:32.420 --> 00:08:35.250\nYou have the big flip board,\nOK well yeah I use this one a lot, so\n\n164\n00:08:35.250 --> 00:08:36.650\nit tends to wander.\n\n165\n00:08:36.650 --> 00:08:38.240\nOr you leave it in a server.\n\n166\n00:08:38.240 --> 00:08:40.430\nYou forget all about,\nwhere's that thing at?\n\n167\n00:08:40.430 --> 00:08:44.650\nDoing it this way where we don't need that\nmedia any longer is a whole lot nicer, and\n\n168\n00:08:44.650 --> 00:08:47.080\nit's, even though it's\ntaking a minute obviously,\n\n169\n00:08:47.080 --> 00:08:48.850\nit is a whole lot quicker\nthan it used to be.\n\n170\n00:08:48.850 --> 00:08:50.744\nAnd as you can see it's It's\nfinally finished up, or\n\n171\n00:08:50.744 --> 00:08:52.831\ndidn't make the- [CROSSTALK]\n>> It's just closed up,\n\n172\n00:08:52.831 --> 00:08:55.970\nI opened it back up just to\ncheck on its progress there.\n\n173\n00:08:55.970 --> 00:08:59.290\nI'm old school,\nI like to watch the progress bar.\n\n174\n00:08:59.290 --> 00:09:00.620\nI'm gonna let this thing go.\n\n175\n00:09:00.620 --> 00:09:04.280\nBut like I said, it is cool that you can\nclose it and you can move on and and\n\n176\n00:09:04.280 --> 00:09:05.850\ndo other things while it's going.\n\n177\n00:09:05.850 --> 00:09:08.530\n>> Like they say though, we spend\nhalf our lives at an IT waiting for\n\n178\n00:09:08.530 --> 00:09:09.710\ncomputers to compute.\n\n179\n00:09:09.710 --> 00:09:10.300\n>> I believe that.\n\n180\n00:09:10.300 --> 00:09:11.130\n>> It's probably true.\n\n181\n00:09:12.360 --> 00:09:13.730\n>> I fully believe that.\n\n182\n00:09:13.730 --> 00:09:15.110\nAnd this guy is taking it's sweet time.\n\n183\n00:09:15.110 --> 00:09:18.160\nNormally it does not take quite this long.\n\n184\n00:09:18.160 --> 00:09:19.120\nBut let's see 63, 64.\n\n185\n00:09:19.120 --> 00:09:24.350\nHere's an interesting little trivia,\nyou guys can check this out for yourself.\n\n186\n00:09:24.350 --> 00:09:27.560\nI've installed a lot of roles\non Microsoft servers and\n\n187\n00:09:27.560 --> 00:09:32.890\nI love this progress bar, but\nI would almost be willing to guarantee you\n\n188\n00:09:32.890 --> 00:09:36.870\nthat when it stops it's gonna be at 63 or\n64 percent.\n\n189\n00:09:36.870 --> 00:09:40.560\nI'm just hovering over the bar there,\nI don't know what it is, that's the magic\n\n190\n00:09:40.560 --> 00:09:46.980\nnumber but every role I've ever installed\nwith it stops right there, it's 63 or 64%.\n\n191\n00:09:46.980 --> 00:09:50.960\n>> Interesting little fact, I've never\npaid much attention to exactly the,\n\n192\n00:09:50.960 --> 00:09:55.060\nI guess Mike probably had to do this,\nhe spent time as a trainer when you train.\n\n193\n00:09:55.060 --> 00:09:58.710\nYou're a trainer, you install these things\nlike a million times, and you start to see\n\n194\n00:09:58.710 --> 00:10:01.710\nthe patterns pop up a little more\noften than if you're just doing it,\n\n195\n00:10:01.710 --> 00:10:05.070\nI need a server, I don't care about\nsitting around waiting for it.\n\n196\n00:10:05.070 --> 00:10:08.290\n>> I know most people go get some coffee,\ncome back, and it's done.\n\n197\n00:10:08.290 --> 00:10:12.020\nYou know, I sit here and watch the\nprogress bar and try to see where it's at,\n\n198\n00:10:12.020 --> 00:10:15.530\nso, yeah, maybe that will win\nyou a trivia contest sometime.\n\n199\n00:10:15.530 --> 00:10:20.390\nIf you're doing some IT trivia or\nsomething, so.\n\n200\n00:10:20.390 --> 00:10:24.030\nAll right, well, Daniel, you know,\nnormally, he asked me before the show,\n\n201\n00:10:24.030 --> 00:10:25.510\nMike, is this gonna take too long?\n\n202\n00:10:25.510 --> 00:10:28.890\nAre we gonna need to do a TV time out or\nanything like that.\n\n203\n00:10:28.890 --> 00:10:31.876\nNo, Active Directory\ninstalls [SOUND] like that.\n\n204\n00:10:31.876 --> 00:10:34.138\nAnd now of course,\nit's proving me wrong, so.\n\n205\n00:10:34.138 --> 00:10:35.709\n>> [CROSSTALK] [LAUGH] We'll\ngive it another minute.\n\n206\n00:10:35.709 --> 00:10:36.930\n>> [INAUDIBLE]\n>> It really did.\n\n207\n00:10:36.930 --> 00:10:38.450\nCome on baby, kick in there.\n\n208\n00:10:38.450 --> 00:10:41.440\nWell, while it's waiting remember\nwe're gonna do a couple things here.\n\n209\n00:10:41.440 --> 00:10:44.300\nWe're gonna get Active Directory installed\nhere, then we're gonna go back in and\n\n210\n00:10:44.300 --> 00:10:44.928\nconfigure it.\n\n211\n00:10:44.928 --> 00:10:46.960\nCouple things that\nActive Directory relies on,\n\n212\n00:10:46.960 --> 00:10:49.930\none thing in particular that I\nwanna mention is DNS, right?\n\n213\n00:10:49.930 --> 00:10:51.760\nSo when you're installing\nActive Directory,\n\n214\n00:10:51.760 --> 00:10:55.960\nthis wizard is gonna detect that I\ndo not have DNS on the network, and\n\n215\n00:10:55.960 --> 00:10:58.850\nit's gonna to ask me if I wanna\ninstall it, and I'm going to.\n\n216\n00:10:58.850 --> 00:11:02.030\nActive Directory relies on DNS,\nit has to have it\n\n217\n00:11:02.030 --> 00:11:06.440\nbecause it has to create those SRV\nrecords so that people can locate it.\n\n218\n00:11:06.440 --> 00:11:09.375\nSo if somebody goes to log on and\nsays, hey, who's running Kerberos?\n\n219\n00:11:09.375 --> 00:11:12.330\nWell it has to create those records and\na few other things.\n\n220\n00:11:12.330 --> 00:11:14.780\nSo active directory requires DNS.\n\n221\n00:11:14.780 --> 00:11:18.160\nYou don't have to put it on the same\nmachine as the domain controller.\n\n222\n00:11:18.160 --> 00:11:20.900\nYou might already have DNS running for\nsome other reason.\n\n223\n00:11:20.900 --> 00:11:23.220\nAnd you can just point\nit over to that machine.\n\n224\n00:11:23.220 --> 00:11:27.550\nBut because active directory and\nDNS have such a tight tie, it really is\n\n225\n00:11:27.550 --> 00:11:32.010\na best practice I think just to put\nDNS on the domain controller itself.\n\n226\n00:11:32.010 --> 00:11:35.440\nYou don't have to host every zone that\nyou have on there, and you don't want to\n\n227\n00:11:35.440 --> 00:11:39.340\nput it out in the DMZ, but that way I\nknow active directory, assuming all my\n\n228\n00:11:39.340 --> 00:11:43.760\nservices started properly, has access\nto DNS cuz it's on the same machine.\n\n229\n00:11:43.760 --> 00:11:47.430\n>> Now Mike, is that a good thing or\njust maybe a best practice where,\n\n230\n00:11:47.430 --> 00:11:50.180\nsay I've already got an Active Directory\ndomain controller installed?\n\n231\n00:11:50.180 --> 00:11:51.530\nDNS is on the same machine.\n\n232\n00:11:51.530 --> 00:11:52.050\nI'm good to go.\n\n233\n00:11:52.050 --> 00:11:53.090\nAnd I figure, you know what?\n\n234\n00:11:53.090 --> 00:11:55.720\nI need another Active Directory\nserver up and running.\n\n235\n00:11:55.720 --> 00:11:58.170\nShould I install DNS on\nthat server as well?\n\n236\n00:11:58.170 --> 00:11:59.340\n>> I do.\n>> Or just point it back\n\n237\n00:11:59.340 --> 00:12:00.460\nto the original DNS?\n\n238\n00:12:00.460 --> 00:12:02.270\n>> I do.\nI like putting it on both of them,\n\n239\n00:12:02.270 --> 00:12:04.350\nthat way I'm getting a little\nbit of fault tolerance there.\n\n240\n00:12:04.350 --> 00:12:09.320\nA little bit of redundancy I should say\nfor the DNS as well as active directory.\n\n241\n00:12:09.320 --> 00:12:12.910\nCan also speed things up a little bit if\nit's got DNS locally, doesn't have to go\n\n242\n00:12:12.910 --> 00:12:17.590\nacross the network, depending on where\nyour other DNS slash domain controller is.\n\n243\n00:12:17.590 --> 00:12:18.950\nSo I like putting them on both.\n\n244\n00:12:18.950 --> 00:12:20.330\n>> Yeah.\nAnd it doesn't hurt anything to do that\n\n245\n00:12:20.330 --> 00:12:21.810\nso-\n>> No, and typically we're doing active\n\n246\n00:12:21.810 --> 00:12:26.070\ndirectory integrated zones, which is our\nbest practice so it's gonna be replicating\n\n247\n00:12:26.070 --> 00:12:28.910\nalong with active directory, so\nit's really not hurting anything.\n\n248\n00:12:30.020 --> 00:12:32.810\n>> All right, well my wizard has finished\nup, so lets take a peek back here at my\n\n249\n00:12:32.810 --> 00:12:36.670\nscreen, and you can see if I zoom in\nthere a little bit it says configuration\n\n250\n00:12:36.670 --> 00:12:39.740\nrequired, installation\nsucceeded on gmv dash dc01.\n\n251\n00:12:39.740 --> 00:12:41.500\nSo good to go there.\n\n252\n00:12:41.500 --> 00:12:43.305\nLove to see those those success messages.\n\n253\n00:12:43.305 --> 00:12:45.695\nAs far as getting to the next wizard,\n\n254\n00:12:45.695 --> 00:12:47.655\ncouple of different ways\nI can go about this.\n\n255\n00:12:47.655 --> 00:12:51.675\nThere is a link right here in\nthe middle of this wizard,\n\n256\n00:12:51.675 --> 00:12:55.185\nif I can say that, that says promote\nthis server to a domain controller.\n\n257\n00:12:55.185 --> 00:12:57.730\nSo when the first wizard finishes,\n\n258\n00:12:57.730 --> 00:13:00.490\nwithin the wizard is a link\nto start the next wizard.\n\n259\n00:13:00.490 --> 00:13:03.880\nI could definitely click that,\nbut I'll show you the other way.\n\n260\n00:13:03.880 --> 00:13:08.040\nI'll close that, and now we can\ngo up to my little notification.\n\n261\n00:13:08.040 --> 00:13:10.820\nYou see I've got an exclamation point\ntelling me there's something I need to\n\n262\n00:13:10.820 --> 00:13:11.920\ndeal with.\n\n263\n00:13:11.920 --> 00:13:16.890\nAnd there it is, I can see that\nthe feature installation completed, but\n\n264\n00:13:16.890 --> 00:13:20.500\nnow my post deployment configuration\nneeds to be completed, and\n\n265\n00:13:20.500 --> 00:13:22.590\nthere's another handy dandy link.\n\n266\n00:13:22.590 --> 00:13:26.500\nNow for you old school guys and gals out\nthere, this is the active directory domain\n\n267\n00:13:26.500 --> 00:13:30.040\nservices configuration wizard,\nthis is not DC Promo.\n\n268\n00:13:30.040 --> 00:13:33.040\nSo if you were expecting DC Promo or\nthought I could just go to a command\n\n269\n00:13:33.040 --> 00:13:34.820\nprompt, you're like,\nI know what he's gonna show us.\n\n270\n00:13:34.820 --> 00:13:38.380\nHe's gonna open up command prompt and\ntype DC promo to launch that wizard.\n\n271\n00:13:38.380 --> 00:13:39.440\nIt won't work.\n\n272\n00:13:39.440 --> 00:13:41.790\nIt has been depreciated.\n\n273\n00:13:41.790 --> 00:13:43.885\nLet's see if I can even show you here.\n\n274\n00:13:43.885 --> 00:13:46.000\nI pull up command prompt.\n\n275\n00:13:46.000 --> 00:13:50.840\nLet's say DC promo,\nthere it will tell you it's\n\n276\n00:13:50.840 --> 00:13:56.000\nbeing relocated to server manager, for\nmore information go out to Microsoft.\n\n277\n00:13:56.000 --> 00:13:59.880\nThe DC promo's actually still\nthere in the background\n\n278\n00:13:59.880 --> 00:14:03.880\nif you wanna do some scripting or some\nautomation, you can tie into that, but\n\n279\n00:14:03.880 --> 00:14:07.080\nas far as doing it this way,\nthey don't want you using DC Promo,\n\n280\n00:14:07.080 --> 00:14:10.400\nthey don't even give you access to it,\nforce you to use this wizard.\n\n281\n00:14:10.400 --> 00:14:12.960\nAnd this wizard starts\noff with a question,\n\n282\n00:14:12.960 --> 00:14:14.580\nit says what the heck\nare you trying to do?\n\n283\n00:14:14.580 --> 00:14:17.560\nAdd a domain controller\nto an existing domain.\n\n284\n00:14:17.560 --> 00:14:22.260\nSo if I already had everything set up, we\nwanted redundancy, I want to add a second,\n\n285\n00:14:22.260 --> 00:14:25.330\nor third, or\nforth domain controller to my domain.\n\n286\n00:14:25.330 --> 00:14:29.790\nThat would be the option, I can add\na new domain to an existing force.\n\n287\n00:14:29.790 --> 00:14:32.060\nSo I already have a force,\nI've got a domain.\n\n288\n00:14:32.060 --> 00:14:33.435\nI want to make a child domain or\n\n289\n00:14:33.435 --> 00:14:35.690\na separate name space\nspace within that forest.\n\n290\n00:14:35.690 --> 00:14:39.310\nA separate tree in the forest I\nwould choose that second option.\n\n291\n00:14:39.310 --> 00:14:43.250\nFor us, since I don't have anything yet\nand if you were staring from the scratch\n\n292\n00:14:43.250 --> 00:14:46.520\nfrom the ground up,\nyou want the add a new forest.\n\n293\n00:14:46.520 --> 00:14:50.300\nYou're going to create your forest and\nyour root domain at the same time.\n\n294\n00:14:50.300 --> 00:14:51.590\nAnd it needs a name.\n\n295\n00:14:51.590 --> 00:14:54.310\nWhat are you gonna call that forest,\nroot domain?\n\n296\n00:14:54.310 --> 00:14:56.570\nI'm gonna call it itprotvdemo.com.\n\n297\n00:14:56.570 --> 00:15:02.603\nBecause it's nice and long and\ntakes forever to type.\n\n298\n00:15:02.603 --> 00:15:04.520\n>> [LAUGH]\n>> [LAUGH] I'll tell you about it,\n\n299\n00:15:04.520 --> 00:15:06.140\nwe'll save it for another day.\n\n300\n00:15:06.140 --> 00:15:07.565\nAlright, so there we go.\n\n301\n00:15:07.565 --> 00:15:08.300\nItprotvdemo.com.\n\n302\n00:15:08.300 --> 00:15:10.500\nWe'll go ahead and click next.\n\n303\n00:15:12.630 --> 00:15:13.390\nAnd a little bit different,\n\n304\n00:15:13.390 --> 00:15:16.380\nthe wizard will change depending on\nwhat option I had selected, right?\n\n305\n00:15:16.380 --> 00:15:20.180\nIf I had chose add a new domain\ncontrol to an existing domain, it\n\n306\n00:15:20.180 --> 00:15:23.690\nwould give me a list of existing domains\nand say which one do you wanna add it to.\n\n307\n00:15:23.690 --> 00:15:25.480\nIf I was adding a domain control or\n\n308\n00:15:25.480 --> 00:15:29.520\nnew domain to an existing forest, it would\nask me for the forest credentials, and\n\n309\n00:15:29.520 --> 00:15:32.500\nit would make me type in the name for\nmy new domain.\n\n310\n00:15:32.500 --> 00:15:34.130\nForest into main functional levels,\n\n311\n00:15:34.130 --> 00:15:36.310\nagain we're not gonna dive\ninto super depth here.\n\n312\n00:15:36.310 --> 00:15:38.290\nI'm gonna choose the latest and greatest.\n\n313\n00:15:38.290 --> 00:15:40.210\nRemember that is going to limit you.\n\n314\n00:15:40.210 --> 00:15:45.342\nJust a quick refresher, if I choose\nserver 2012 R2 for my forest into main\n\n315\n00:15:45.342 --> 00:15:51.508\nfunctional level, I can never create\na 2012, a 2008 R2, a 2008, a 2003.\n\n316\n00:15:51.508 --> 00:15:55.388\nAll those operating systems are off the\ntable now for future domain controllers.\n\n317\n00:15:55.388 --> 00:15:58.468\n2012 R2 and later is all I get.\n\n318\n00:15:58.468 --> 00:16:00.388\nI am going to install dns.\n\n319\n00:16:00.388 --> 00:16:02.848\nNotice that it's got a check\nmark in there already.\n\n320\n00:16:02.848 --> 00:16:04.370\nIt's the preferred thing to do.\n\n321\n00:16:04.370 --> 00:16:06.080\nI'm gonna leave that checked.\n\n322\n00:16:06.080 --> 00:16:09.630\nAlso have global catalog selected and\nI cannot uncheck that.\n\n323\n00:16:09.630 --> 00:16:12.890\nIt's grayed out because\nActive Directory requires at least\n\n324\n00:16:12.890 --> 00:16:14.560\none global catalog server.\n\n325\n00:16:14.560 --> 00:16:16.020\nThis is my first domain controller,\n\n326\n00:16:16.020 --> 00:16:18.360\ntherefore it must be\na global catalogue server.\n\n327\n00:16:18.360 --> 00:16:22.220\nIf I have additional domain controllers\nlater on, I can move and change which\n\n328\n00:16:22.220 --> 00:16:27.320\nserver is the catalog, but as far as\ninstalling it, we have to choose it.\n\n329\n00:16:27.320 --> 00:16:28.040\nFor now.\n\n330\n00:16:28.040 --> 00:16:31.880\nI'll set up my super secret password for\nDSRM.\n\n331\n00:16:31.880 --> 00:16:34.720\nDSRM is my directory service restore mode.\n\n332\n00:16:34.720 --> 00:16:37.840\nThink of it like safe mode for\nActive Directory, right?\n\n333\n00:16:37.840 --> 00:16:41.110\nIf Active Directory has become corrupt or\nfailed and you need to fix it.\n\n334\n00:16:41.110 --> 00:16:44.760\nYou try to start that server, but\nActive Directory won't launch.\n\n335\n00:16:44.760 --> 00:16:48.520\nWell, remember, domain controllers you\ncannot log in with a local account.\n\n336\n00:16:48.520 --> 00:16:50.500\nYou can only log in with domain accounts.\n\n337\n00:16:50.500 --> 00:16:54.420\nSo if Active Directory is not launching\nI can't login with that domain account.\n\n338\n00:16:54.420 --> 00:16:59.050\nSo you reboot the server in what's know\nas Directory Services Restore Mode which\n\n339\n00:16:59.050 --> 00:17:02.738\nallows the server to start even\nthough Active Directory is not.\n\n340\n00:17:02.738 --> 00:17:05.353\nAnd it gives you access to the one\nlocal account that remains on\n\n341\n00:17:05.353 --> 00:17:06.418\nthe domain controller.\n\n342\n00:17:06.418 --> 00:17:08.800\nAnd this is the password\nyou're setting right here.\n\n343\n00:17:08.800 --> 00:17:10.030\nSo it needs to be long and\n\n344\n00:17:10.030 --> 00:17:13.860\nstrong because it's doubtful that\nyou're gonna change it like you should.\n\n345\n00:17:13.860 --> 00:17:17.538\nYou're rarely ever gonna use it,\nonly if when there's a problem.\n\n346\n00:17:17.538 --> 00:17:19.638\nWe'll click Next.\n\n347\n00:17:19.638 --> 00:17:22.494\nAnd then it's telling me\nthat it cannot connect,\n\n348\n00:17:22.494 --> 00:17:24.738\nthe DNS delegation cannot be created.\n\n349\n00:17:24.738 --> 00:17:27.983\nNow this has to do with the fact\nthat this is my internal network and\n\n350\n00:17:27.983 --> 00:17:30.350\nit doesn't have access to the Internet.\n\n351\n00:17:30.350 --> 00:17:33.310\nSo it can't check to\nsee if I own that name.\n\n352\n00:17:33.310 --> 00:17:37.740\nAnd if a delegation has been made so that\nanybody that's typing my name out there in\n\n353\n00:17:37.740 --> 00:17:40.600\nthe public can get\npointed to my DNS server.\n\n354\n00:17:40.600 --> 00:17:45.610\nIt can't make that delegation record\nup there on the dot.com DNS servers,\n\n355\n00:17:45.610 --> 00:17:46.340\nwhich is okay with me.\n\n356\n00:17:46.340 --> 00:17:48.960\nBecause I don't need that type\nof resolution at this point.\n\n357\n00:17:48.960 --> 00:17:50.590\nSo I'm fine with that error.\n\n358\n00:17:50.590 --> 00:17:52.600\nIt's not going to prevent\nme from installing it.\n\n359\n00:17:52.600 --> 00:17:53.860\nI'll go ahead and click next.\n\n360\n00:17:55.300 --> 00:17:58.220\nThen it's gonna check my NetBIOS name,\nmake sure that it's unique.\n\n361\n00:17:59.240 --> 00:18:02.640\nIt'll take, remember NetBIOS is\nthe limit of 15 characters so\n\n362\n00:18:02.640 --> 00:18:04.860\nif your character domain\nname is longer than that,\n\n363\n00:18:04.860 --> 00:18:08.160\nit'll just take the first 15 characters\nof your domain name and there we go,\n\n364\n00:18:08.160 --> 00:18:12.710\nitprotvdemo we're gonna\ngo with like next and\n\n365\n00:18:12.710 --> 00:18:17.620\nthen my paths for where do I want to\nlocate the components of Active Directory.\n\n366\n00:18:17.620 --> 00:18:22.580\nNow by default it's gonna put them all\ninto C:\\Windows\\NTDS for my database and\n\n367\n00:18:22.580 --> 00:18:23.690\nthe log files.\n\n368\n00:18:23.690 --> 00:18:26.820\nSYSVOL goes into its own folder,\nC:\\Windows\\SYSVOL.\n\n369\n00:18:26.820 --> 00:18:30.010\nMy system volume that gets replicated\nto the other domain controllers.\n\n370\n00:18:30.010 --> 00:18:32.530\nTo where we store things like\nparts of our group policy,\n\n371\n00:18:32.530 --> 00:18:35.270\nlog on/log off scripts, things like that.\n\n372\n00:18:35.270 --> 00:18:37.160\nI'm leaving them all in their defaults so\n\n373\n00:18:37.160 --> 00:18:41.240\nthere we'll see when we get out to the\ncloud that's gonna change a little bit.\n\n374\n00:18:41.240 --> 00:18:45.400\nIn the real world you might move that\ndatabase and log files onto a separate\n\n375\n00:18:45.400 --> 00:18:48.870\nphysical spindles, so that if one fails,\nyou still have access to the other.\n\n376\n00:18:48.870 --> 00:18:51.580\n>> Now, Mike, just as I'm watching\nyou go through this here.\n\n377\n00:18:51.580 --> 00:18:54.770\nI'm really starting to get struck by,\nwe're not making any provision for\n\n378\n00:18:54.770 --> 00:18:58.010\nthe fact that we're going into\nthe cloud later on in life here.\n\n379\n00:18:58.010 --> 00:19:03.140\nWe're building this Active Directory,\nthis domain controller as any other.\n\n380\n00:19:03.140 --> 00:19:05.680\nAnd cloud be danged, it does not matter.\n\n381\n00:19:05.680 --> 00:19:07.398\nIt's just a standard\nActive Directory installation.\n\n382\n00:19:07.398 --> 00:19:11.686\n>> Absolutely right, this is just like\nanything else, or just like doing it,\n\n383\n00:19:11.686 --> 00:19:13.700\nlike you said, forget the cloud.\n\n384\n00:19:13.700 --> 00:19:14.640\nDon't even think about the cloud.\n\n385\n00:19:14.640 --> 00:19:17.850\nThis is on premises just\nsetting up a normal network.\n\n386\n00:19:17.850 --> 00:19:18.850\nYou're absolutely right.\n\n387\n00:19:18.850 --> 00:19:20.460\nWe'll click next.\n\n388\n00:19:20.460 --> 00:19:24.030\nIt's going to give me a chance to review\nall my decisions and if I missed any or\n\n389\n00:19:24.030 --> 00:19:26.360\nmade a mistake I would click previous.\n\n390\n00:19:26.360 --> 00:19:27.830\nI didn't I hope.\n\n391\n00:19:27.830 --> 00:19:28.585\nKnock on wood.\n\n392\n00:19:28.585 --> 00:19:30.590\n>> [LAUGH]\n>> We'll click next.\n\n393\n00:19:30.590 --> 00:19:33.920\nAnd now it's gonna do its prereq check and\nmake sure everything is okay, and\n\n394\n00:19:33.920 --> 00:19:37.690\nthen I can create this domain controller,\nbased on the decisions I made.\n\n395\n00:19:37.690 --> 00:19:39.610\nNow we'll see a couple\nof warnings in here.\n\n396\n00:19:40.710 --> 00:19:41.530\nWe should.\n\n397\n00:19:41.530 --> 00:19:44.770\nWe'll see one for down level clients\nare gonna have issues with some of\n\n398\n00:19:44.770 --> 00:19:49.100\nthe security settings,\nbecause I chose that server 2012 R2.\n\n399\n00:19:49.100 --> 00:19:52.750\nThat's okay with me, I'm not\nrunning any NT 4.0 servers anymore.\n\n400\n00:19:52.750 --> 00:19:57.400\nAlso get that warning again about DNS\nnot being able to make that delegation.\n\n401\n00:19:57.400 --> 00:19:59.290\nAgain, that's okay with me for now.\n\n402\n00:19:59.290 --> 00:20:00.560\nI'm not worried about it.\n\n403\n00:20:00.560 --> 00:20:02.080\nAnd they're warnings, they're not errors.\n\n404\n00:20:02.080 --> 00:20:05.380\nSo these are things that you should be\naware of, maybe you wanna do something\n\n405\n00:20:05.380 --> 00:20:08.590\nabout, but it's not gonna prevent\nyou from completing the wizard.\n\n406\n00:20:08.590 --> 00:20:13.170\nIf it was a warning, then you'd have\nto stop, fix it, and come back and\n\n407\n00:20:13.170 --> 00:20:14.410\ndo the prereq check again.\n\n408\n00:20:15.500 --> 00:20:17.370\nI'm sorry, it was an error you would,\nnot a warning.\n\n409\n00:20:17.370 --> 00:20:20.650\nWe'll click Install and we'll let this go.\n\n410\n00:20:20.650 --> 00:20:24.032\nThis is another one, Daniel, and\nI swear it does not take that long.\n\n411\n00:20:24.032 --> 00:20:27.579\n>> [LAUGH] We'll see about that Michael,\nwe'll see about that.\n\n412\n00:20:27.579 --> 00:20:29.720\n>> [LAUGH] So we'll wait for\nthis to install and\n\n413\n00:20:29.720 --> 00:20:31.810\nit is doing a little bit more this time.\n\n414\n00:20:31.810 --> 00:20:34.440\nRight, it's installing\nthe Active Directory Database and\n\n415\n00:20:34.440 --> 00:20:38.050\nall the components and\nconfiguring all that.\n\n416\n00:20:38.050 --> 00:20:42.270\nIt's also installing DNS and getting that\nconfigured and you can see right here,\n\n417\n00:20:42.270 --> 00:20:43.590\nI kinda, I know I'm a geek.\n\n418\n00:20:43.590 --> 00:20:47.620\nI like watching, there you go,\nwaiting for DNS installation to finish.\n\n419\n00:20:47.620 --> 00:20:49.980\nSo it kinda gives you\nan idea of where it's at or\n\n420\n00:20:49.980 --> 00:20:54.160\nwhat it's doing, but at this point,\nyeah, now starting it up.\n\n421\n00:20:54.160 --> 00:20:56.838\nChecking to see if Group Management\nConsole needs to be installed.\n\n422\n00:20:56.838 --> 00:20:58.600\nNow, most of these should\nhave been installed.\n\n423\n00:20:58.600 --> 00:21:00.490\nWe got all of those pieces ready.\n\n424\n00:21:00.490 --> 00:21:05.270\nWhen we ran the first wizard,\nwe actually installed the role.\n\n425\n00:21:05.270 --> 00:21:07.920\nSo now you can see it going through and\ncreating those partitions.\n\n426\n00:21:07.920 --> 00:21:10.860\nAnd I don't know why, Daniel, like I said,\nI'm a geek, once you start learning about\n\n427\n00:21:10.860 --> 00:21:13.150\nActive Directory, and learn about\nthe three different partitions,\n\n428\n00:21:13.150 --> 00:21:15.500\nyou're like I recognize\nthat partition right?\n\n429\n00:21:15.500 --> 00:21:16.275\nI know that name there.\n\n430\n00:21:16.275 --> 00:21:18.102\n[LAUGH]\n>> Everything looks right.\n\n431\n00:21:18.102 --> 00:21:21.150\n>> Yes. [LAUGH] >> That's another\nthing I do the same kind of thing,\n\n432\n00:21:21.150 --> 00:21:26.060\nI watch the scroll bar go by and\nmake sure that everything that pops up is\n\n433\n00:21:26.060 --> 00:21:29.410\nsomething that looks like\nwhat it should look like.\n\n434\n00:21:29.410 --> 00:21:33.060\nIf I had a path, I'd expect to see\nthat path, everything's different,\n\n435\n00:21:33.060 --> 00:21:34.390\nI might raise an eyebrow and\n\n436\n00:21:34.390 --> 00:21:38.280\nthen if anything doesn't work I\nremember that path didn't show up.\n\n437\n00:21:38.280 --> 00:21:41.430\nAnd that can be helpful in the\ntroubleshooting if anything does go wrong.\n\n438\n00:21:41.430 --> 00:21:43.970\nSo it's not the fact\nthat also we are geeks.\n\n439\n00:21:43.970 --> 00:21:44.483\nWe are.\n>> [LAUGH]\n\n440\n00:21:44.483 --> 00:21:45.382\n>> We love to watch and\n\n441\n00:21:45.382 --> 00:21:48.186\nsee about technology.\nBut it can help cuz if you've done this as\n\n442\n00:21:48.186 --> 00:21:51.100\nlong as we have, you realize\nsometimes it just doesn't go right.\n\n443\n00:21:51.100 --> 00:21:52.890\nYou've gotta go back and\ntry to figure out what went wrong.\n\n444\n00:21:52.890 --> 00:21:53.880\n>> Absolutely.\nAll right.\n\n445\n00:21:53.880 --> 00:21:55.360\nSo you can see it's finished up.\n\n446\n00:21:55.360 --> 00:21:57.370\nIt would, if I didn't touch anything.\n\n447\n00:21:57.370 --> 00:21:59.630\nIt would go ahead and\nit would reboot the server.\n\n448\n00:21:59.630 --> 00:22:02.690\nI'll go ahead and click close to let\nit know I'm okay with it rebooting.\n\n449\n00:22:02.690 --> 00:22:06.080\nLike I said if I waited it would go\nahead and do it anyway, it has to.\n\n450\n00:22:06.080 --> 00:22:10.190\nIt has to reboot to start kicking in\nthose Active Directory services and\n\n451\n00:22:10.190 --> 00:22:11.230\nget everything configured.\n\n452\n00:22:12.730 --> 00:22:17.756\nAll right, so we'll keep on trucking here,\nlet this guy reboot.\n\n453\n00:22:17.756 --> 00:22:18.748\nRebooterate.\n\n454\n00:22:18.748 --> 00:22:23.380\n>> I have a feeling you're\nusing Hyper-V on this, Michael.\n\n455\n00:22:23.380 --> 00:22:24.108\n>> No, no.\nVMWare.\n\n456\n00:22:24.108 --> 00:22:25.110\n[LAUGH]\n>> [LAUGH] VMWare.\n\n457\n00:22:25.110 --> 00:22:25.960\nThat's good stuff.\n\n458\n00:22:25.960 --> 00:22:28.260\nWell played, sir, well played.\n\n459\n00:22:28.260 --> 00:22:29.840\n>> We are doing Hyper-V, yep.\n\n460\n00:22:29.840 --> 00:22:33.200\nWe are keeping it all on Microsoft for\nthis show, or trying to, anyway.\n\n461\n00:22:35.440 --> 00:22:37.200\nHave some fun with\nHyper-V if we have time.\n\n462\n00:22:37.200 --> 00:22:39.990\nI'll tell you some of those stories or\nmake another show out of that one.\n\n463\n00:22:41.110 --> 00:22:43.930\nAll right so\nDC-1 is coming back on line here.\n\n464\n00:22:43.930 --> 00:22:44.898\nGive it just a second.\n\n465\n00:22:47.578 --> 00:22:51.214\nTakes a minute for that little virtual\ngraphics processor to kick in and\n\n466\n00:22:51.214 --> 00:22:52.190\nshow me my screen.\n\n467\n00:22:53.330 --> 00:22:58.140\nAnd I tell you the one thing that has been\ndriving me crazy well let's see here.\n\n468\n00:22:58.140 --> 00:22:58.706\nFind my cursor.\n\n469\n00:22:58.706 --> 00:23:00.789\n>> You are cursor-less.\n\n470\n00:23:00.789 --> 00:23:02.460\n[LAUGH]\n>> There it is.\n\n471\n00:23:02.460 --> 00:23:03.760\nI saw it, there it is.\n\n472\n00:23:05.280 --> 00:23:09.395\nI have yet to find how to do\na Ctrl-Alt-Delete keyboard shortcut\n\n473\n00:23:09.395 --> 00:23:13.870\non Hyper-V running, or\nconnecting remotely through a Mac.\n\n474\n00:23:13.870 --> 00:23:16.890\nSo I always have to come out and\nclick the little button here.\n\n475\n00:23:16.890 --> 00:23:18.180\nThere's no control alt.\n\n476\n00:23:18.180 --> 00:23:20.720\nThere's no break key on my Mac.\n\n477\n00:23:20.720 --> 00:23:22.570\nThere's no insert key on my Mac.\n\n478\n00:23:22.570 --> 00:23:24.233\n>> Yeah.\n>> Who makes these keyboards?\n\n479\n00:23:24.233 --> 00:23:26.364\n>> [LAUGH]\n>> What is up with that?\n\n480\n00:23:26.364 --> 00:23:28.590\n>> [LAUGH]\n>> Don't they understand that we need\n\n481\n00:23:28.590 --> 00:23:29.535\nthese keys for?\n\n482\n00:23:29.535 --> 00:23:32.325\nFor us to run these operating systems.\n\n483\n00:23:32.325 --> 00:23:32.975\nCrazy stuff.\n\n484\n00:23:32.975 --> 00:23:34.215\n>> No, it's a Mac, it just works.\n\n485\n00:23:34.215 --> 00:23:35.505\n>> It does.\n>> It just works.\n\n486\n00:23:35.505 --> 00:23:37.761\n>> Unless you're trying to run\na Microsoft environment inside it.\n\n487\n00:23:37.761 --> 00:23:39.485\n[LAUGH]\n>> [LAUGH] That's true,\n\n488\n00:23:39.485 --> 00:23:42.782\nthere's a keyboard shortcut out there,\nand if anybody knows, you can post it on\n\n489\n00:23:42.782 --> 00:23:44.252\n>> So, dig in the forum, and let me know.\n\n490\n00:23:44.252 --> 00:23:46.452\nBut, I have not found it yet.\n\n491\n00:23:46.452 --> 00:23:51.072\nSo, all right, now that I'm actually\nlogging in, I'll go full-screen here.\n\n492\n00:23:51.072 --> 00:23:54.290\nAnd, again, not to be impatient,\nit's doing a lot, right?\n\n493\n00:23:54.290 --> 00:23:58.130\nI know, sometimes I get impatient\nwaiting for these darn machines.\n\n494\n00:23:58.130 --> 00:24:01.538\nAnd, as Daniel pointed out, we spend half\nour life waiting for machines like this.\n\n495\n00:24:01.538 --> 00:24:03.060\nBut, I can't fault it.\n\n496\n00:24:03.060 --> 00:24:06.608\nIt is reconfiguring the entire server,\ninstalling Active Directory,\n\n497\n00:24:06.608 --> 00:24:09.360\ninstalling DNS,\ngetting all that up and running.\n\n498\n00:24:09.360 --> 00:24:12.610\nThe other thing, the only thing we have\nleft to do, once this finishes and\n\n499\n00:24:12.610 --> 00:24:13.700\nwe get logged in,\n\n500\n00:24:13.700 --> 00:24:17.800\nis just to verify the successful\ninstallation of Active Directory.\n\n501\n00:24:17.800 --> 00:24:21.590\nSo what I like to do is make sure all the\npieces, parts, got put in the right place.\n\n502\n00:24:21.590 --> 00:24:23.890\nI'll go into SQL and Windows In TDS.\n\n503\n00:24:23.890 --> 00:24:25.940\nLook for the database,\nlook for the log files.\n\n504\n00:24:25.940 --> 00:24:30.420\nI'll go in and SQL on Windows sysfile and,\nmake sure that sysfile folder is there.\n\n505\n00:24:30.420 --> 00:24:33.862\nI'll open up a couple of the consoles,\nlike Active Directory users or computers,\n\n506\n00:24:33.862 --> 00:24:36.072\nmake sure I can hit the database,\nand it opens up, and\n\n507\n00:24:36.072 --> 00:24:37.818\nit's displaying everything properly.\n\n508\n00:24:37.818 --> 00:24:43.218\nI also wanna double check that DNS is\ninstalled, and that DNS is running.\n\n509\n00:24:43.218 --> 00:24:47.790\nAnd I wanna make sure that my domain\ncontroller on it's TCP/IP config\n\n510\n00:24:47.790 --> 00:24:50.670\nis looking at itself for DNS.\n\n511\n00:24:50.670 --> 00:24:53.770\nNow a lot of times when you first set up\nthat machine, it's a workgroup before you\n\n512\n00:24:53.770 --> 00:24:58.035\never install Active Directory on it, it\nmight be pointed somewhere else for DNS.\n\n513\n00:24:58.035 --> 00:25:03.665\nUsually, during the install it\nreconfigures itself to use 127001 loopback\n\n514\n00:25:03.665 --> 00:25:08.105\naddress for DNS, but if something\ndidn't happen I like to doublecheck.\n\n515\n00:25:08.105 --> 00:25:10.815\nI wanna make sure that\nmy domain controller,\n\n516\n00:25:10.815 --> 00:25:14.695\nwhen he goes to look up something in\nDNS or when he goes to register his SRV\n\n517\n00:25:14.695 --> 00:25:19.980\nrecords, that he looks to himself for\nthe DNS service, not to somewhere else.\n\n518\n00:25:19.980 --> 00:25:21.090\n>> And that's not something we have to do,\n\n519\n00:25:21.090 --> 00:25:22.980\nthey're kind of automatically\ndone by the system, right?\n\n520\n00:25:22.980 --> 00:25:24.840\nWe don't have to go into DNS and\n\n521\n00:25:24.840 --> 00:25:27.270\nsay, here's all these records\nthat you're gonna need.\n\n522\n00:25:27.270 --> 00:25:29.260\nActive Directory kind\nof helps us out there.\n\n523\n00:25:29.260 --> 00:25:34.252\n>> It does, there's a Netlogon service\nthat goes through, and any time you\n\n524\n00:25:34.252 --> 00:25:39.180\nadd a role, it keeps this file of what\nservices are needed for that role.\n\n525\n00:25:39.180 --> 00:25:45.049\nAnd then when you reboot the machine and\nit registers its normal DNS records,\n\n526\n00:25:45.049 --> 00:25:49.033\nlike hey, I'm GNV-DC01.ITProTVdemo.com.\n\n527\n00:25:49.033 --> 00:25:51.089\nIf I can say that three times fast.\n\n528\n00:25:51.089 --> 00:25:54.600\nHere's my IP address, so\nit creates a normal A record, right?\n\n529\n00:25:54.600 --> 00:26:00.710\nBut it also creates SRV records for every\nservice it finds listed in that file so\n\n530\n00:26:00.710 --> 00:26:04.460\nit should have listed those\nActive Directory services in that file and\n\n531\n00:26:04.460 --> 00:26:07.780\nthen when it registers with DNS it\nshould create those SRV records.\n\n532\n00:26:07.780 --> 00:26:10.870\nBut that is something I like to go and\ncheck and make sure they're there because\n\n533\n00:26:10.870 --> 00:26:16.270\nif not a user's computer queries DNS and\nsays, hey, I need to log on.\n\n534\n00:26:16.270 --> 00:26:17.860\nIt won't be able to find your\ndomain controller if those\n\n535\n00:26:17.860 --> 00:26:19.590\nrecords aren't created properly.\n\n536\n00:26:20.910 --> 00:26:24.850\nTypically, what you would do if they're\nnot created is you stop the Netlogon\n\n537\n00:26:24.850 --> 00:26:29.420\nservice and you restart the Netlogon\nservice and that usually triggers it.\n\n538\n00:26:29.420 --> 00:26:30.410\nAnd then if it doesn't work,\n\n539\n00:26:30.410 --> 00:26:33.990\nyou're gonna start troubleshooting\nwhy is DNS even running.\n\n540\n00:26:33.990 --> 00:26:37.430\nIs it allowing those dynamic updates,\nwhat's going on there.\n\n541\n00:26:37.430 --> 00:26:38.410\nAll right, so here we go.\n\n542\n00:26:38.410 --> 00:26:42.280\nI've got my domain controller up and\nrunning, we're hoping.\n\n543\n00:26:42.280 --> 00:26:45.450\nWe're gonna log in using my domain admin.\n\n544\n00:26:45.450 --> 00:26:49.507\nNotice that I'm logging on\nto the domain/administrator,\n\n545\n00:26:49.507 --> 00:26:53.257\nnot local machine,\nGNV- GCO1 slash administrator.\n\n546\n00:26:53.257 --> 00:26:55.451\nOn domain controllers you cannot, right?\n\n547\n00:26:55.451 --> 00:26:58.707\nIf I click back and\nI try to go to other user and\n\n548\n00:26:58.707 --> 00:27:02.672\nI try to do a local host,\nnotice that does not change.\n\n549\n00:27:02.672 --> 00:27:08.422\nIt will not let you log on to anything\nother than the domain admin account or\n\n550\n00:27:08.422 --> 00:27:13.918\nany domain account that has rights\nto log on to the domain controller.\n\n551\n00:27:13.918 --> 00:27:15.323\nAll right, so here we go.\n\n552\n00:27:15.323 --> 00:27:17.076\nWe'll type in that super secret password.\n\n553\n00:27:17.076 --> 00:27:21.250\nAnd we will authenticate and\nhopefully we'll get to the desktop.\n\n554\n00:27:21.250 --> 00:27:24.450\nWe'll let Server Manager open up and\ndo it's thing.\n\n555\n00:27:25.790 --> 00:27:30.350\nJust an FYI, you can turn off\nServer Manager so it doesn't open up\n\n556\n00:27:30.350 --> 00:27:34.530\nautomatically by default,\nit is gonna open up automatically.\n\n557\n00:27:34.530 --> 00:27:38.617\nAnd I have found through my own personal\nexperiences, is in a Microsoft thing or\n\n558\n00:27:38.617 --> 00:27:41.789\nit's not anything that they've said,\nbut if you mess around\n\n559\n00:27:41.789 --> 00:27:45.939\nbefore Server Manager finishes doing\nits thing, it's just gonna take longer.\n\n560\n00:27:45.939 --> 00:27:48.676\n>> [LAUGH]\n>> [LAUGH] Because Server Manager's\n\n561\n00:27:48.676 --> 00:27:49.880\na great interface.\n\n562\n00:27:49.880 --> 00:27:53.080\nIt's a one stop shop for\nmanaging my server.\n\n563\n00:27:53.080 --> 00:27:54.960\nIn fact, managing all my servers.\n\n564\n00:27:54.960 --> 00:27:58.250\nI can add other servers to this Windows,\nI can manage them all from right here.\n\n565\n00:27:58.250 --> 00:28:01.370\nBut that means it has to go\nretrieve a lot of information,\n\n566\n00:28:01.370 --> 00:28:04.050\nread a lot of log files to\ngive me this green box.\n\n567\n00:28:04.050 --> 00:28:05.805\nAnd tell me, hey,\nthere's no errors in this log.\n\n568\n00:28:05.805 --> 00:28:08.350\nThere's no errors in these logs,\nto list all these services.\n\n569\n00:28:08.350 --> 00:28:11.710\nSo you'll see this blue bar\nscrolling across the top here.\n\n570\n00:28:11.710 --> 00:28:15.220\nThat's Server Manager going out and\nrefreshing all of the data.\n\n571\n00:28:15.220 --> 00:28:19.480\nI have found that if I click on\nanything before that's finished\n\n572\n00:28:19.480 --> 00:28:20.710\nit doesn't speed anything up.\n\n573\n00:28:20.710 --> 00:28:24.470\nIn fact, it probably takes longer cuz\nit won't do anything until it's done.\n\n574\n00:28:24.470 --> 00:28:25.880\nSo just a little FYI for you.\n\n575\n00:28:25.880 --> 00:28:26.770\n>> And you know what, Mike?\n\n576\n00:28:26.770 --> 00:28:29.450\nIn my experience as well,\nif this is a domain controller,\n\n577\n00:28:29.450 --> 00:28:32.380\nthat what you're using it for,\njust let it do the thing.\n\n578\n00:28:32.380 --> 00:28:36.120\nOpen up Server Manager, sit back and relax\nuntil it's completely open, and then do\n\n579\n00:28:36.120 --> 00:28:39.800\nit, cuz that's normally what you're\ngoing to if this is a domain controller.\n\n580\n00:28:39.800 --> 00:28:44.605\nIf you're running Server 2012 or whatever\nit is on something for some other reason\n\n581\n00:28:44.605 --> 00:28:47.075\nthen you can kill anything,\nyou don't need that stuff to come up.\n\n582\n00:28:47.075 --> 00:28:50.545\nYou're running some of their software\njust wants to run on top of Server, so\n\n583\n00:28:50.545 --> 00:28:52.265\nthen you would do it that way otherwise.\n\n584\n00:28:52.265 --> 00:28:54.045\n>> Exactly, all right, there we go,\n\n585\n00:28:54.045 --> 00:28:57.495\nI can see it's now finished\nrefreshing all its information.\n\n586\n00:28:57.495 --> 00:29:00.344\nAnd first check that I would\ndo on my domain controller is,\n\n587\n00:29:00.344 --> 00:29:02.855\nis it listed it as one of\nthe services that's installed.\n\n588\n00:29:02.855 --> 00:29:07.343\nAnd there I can see Active Directory\ndomain services, ADDS for short.\n\n589\n00:29:07.343 --> 00:29:09.744\nEverything looks good there, and then.\n\n590\n00:29:09.744 --> 00:29:13.213\n>> [INAUDIBLE] [LAUGH]\n>> [LAUGH] [INAUDIBLE] And\n\n591\n00:29:13.213 --> 00:29:18.790\nthere's Google DNS, so\nthat was installed as well.\n\n592\n00:29:18.790 --> 00:29:24.540\nSo the first thing I'm gonna do is open up\nfile explorer, and we're gonna navigate\n\n593\n00:29:24.540 --> 00:29:30.560\nto C colon Windows and we'll double check\nand make sure that there's an NTDS folder.\n\n594\n00:29:30.560 --> 00:29:34.000\nAnd there it is,\nwe'll double click on that and\n\n595\n00:29:34.000 --> 00:29:39.240\nthere is ntds.dit, that's the actual\nActive Directory database.\n\n596\n00:29:39.240 --> 00:29:41.340\nThat's the file the magic database.\n\n597\n00:29:41.340 --> 00:29:45.240\nAnd all these other EDBs\nthese are my log files.\n\n598\n00:29:45.240 --> 00:29:47.210\nSo everything looks good there.\n\n599\n00:29:47.210 --> 00:29:52.160\nWell drop back out and\ngo down to SYSVOL which is right there.\n\n600\n00:29:52.160 --> 00:29:55.940\nSo, that guy created and it's got all\nthe appropriate folders in there.\n\n601\n00:29:55.940 --> 00:30:00.080\nSo everything looks good as far as\nthe file structure being created.\n\n602\n00:30:00.080 --> 00:30:02.920\nNext thing I'll do, is I will\nopen up an Active Directory tool,\n\n603\n00:30:02.920 --> 00:30:08.150\nlike uses in computers and\nverify that it opens up and\n\n604\n00:30:08.150 --> 00:30:12.010\nI can see my Active Directory database and\nall my defaults.\n\n605\n00:30:12.010 --> 00:30:13.830\nThere's my account for\n\n606\n00:30:13.830 --> 00:30:18.920\nthe domain controller itself,\nGNV-DC01 is in my domain controllers OU.\n\n607\n00:30:18.920 --> 00:30:20.620\nSo that looks good there.\n\n608\n00:30:21.640 --> 00:30:23.550\nWe're going to close that out.\n\n609\n00:30:23.550 --> 00:30:25.617\nOther thing I would like\nto check would be DNS.\n\n610\n00:30:28.659 --> 00:30:34.595\nAnd we'll expand our way down in here,\nto my forward lookup zone and\n\n611\n00:30:34.595 --> 00:30:38.255\nthere's my zone for ITProTVdemo.com.\n\n612\n00:30:38.255 --> 00:30:45.101\nAnd if we go into there, I should see\nUnder TCP, there are my SRV records,\n\n613\n00:30:45.101 --> 00:30:50.350\nglobal catalog, kerberos,\nkpasswd, and ldap.\n\n614\n00:30:50.350 --> 00:30:55.650\nAnd those are all pointing back to\ngnv-dc01, so everything looks good there.\n\n615\n00:30:55.650 --> 00:30:57.630\nI can go ahead and close that.\n\n616\n00:30:57.630 --> 00:31:01.317\nLast thing I wanted to check\nwas my TCP/IP configuration.\n\n617\n00:31:01.317 --> 00:31:05.439\nSo I'm gonna go over to Local Server and\nof course there's ten different ways to\n\n618\n00:31:05.439 --> 00:31:09.209\nget to your network adapter settings,\nyou guys pick your favorite one.\n\n619\n00:31:09.209 --> 00:31:13.970\nI'm gonna click on that there,\nI'm gonna right click,\n\n620\n00:31:13.970 --> 00:31:17.660\nand I'll do status and then details.\n\n621\n00:31:17.660 --> 00:31:21.460\nAnd there I can see the IP address,\nmy Subnet Mask, my Default Gateway.\n\n622\n00:31:21.460 --> 00:31:25.410\nI see nothing listed for DNS Server\nwhich makes me a little nervous.\n\n623\n00:31:25.410 --> 00:31:26.820\nSo we'll go under properties.\n\n624\n00:31:28.958 --> 00:31:33.940\nAnd IPv4, and it definitely just wasn't\nshowing up on that status screen.\n\n625\n00:31:33.940 --> 00:31:38.205\nIt might not understand the whole\nwiser loop back address there but\n\n626\n00:31:38.205 --> 00:31:40.651\nthere I can see 127.0.0.1.\n\n627\n00:31:40.651 --> 00:31:44.727\nNow you don't have to do the loop back, I\nhave set up many a domain controller where\n\n628\n00:31:44.727 --> 00:31:47.995\nI actually type in 10.1.1.10,\nsame as the IP address.\n\n629\n00:31:47.995 --> 00:31:51.579\nSeems like Server 2012, 2012 R2,\nthough, you'll end up flipping it, and\n\n630\n00:31:51.579 --> 00:31:53.707\nyou'll just put the loopback\nright back in there.\n\n631\n00:31:53.707 --> 00:31:57.314\nBut either way, as long as it's\npointed to itself, and honestly,\n\n632\n00:31:57.314 --> 00:32:01.450\nwe pretty much knew that was working\nsince I saw the SRV records were created.\n\n633\n00:32:01.450 --> 00:32:04.235\nI guess there's always the chance\nI had another DNS Server,\n\n634\n00:32:04.235 --> 00:32:07.670\nit registered the records over there,\nand then they replicated.\n\n635\n00:32:07.670 --> 00:32:11.040\nSo again, I just like to make sure that\nthis domain controllers using itself\n\n636\n00:32:11.040 --> 00:32:11.960\nfor DNS.\n\n637\n00:32:11.960 --> 00:32:16.390\nAnd at that point, we've got Active\nDirectory set up, we've got our domain,\n\n638\n00:32:16.390 --> 00:32:20.465\nwe would start running our business, we'd\nstart taking our workstations out of here\n\n639\n00:32:20.465 --> 00:32:23.775\non premises and\nstart joining those guys to the domain.\n\n640\n00:32:23.775 --> 00:32:26.525\nWe create our user accounts,\nall of that fun stuff.\n\n641\n00:32:26.525 --> 00:32:29.683\nSet up group policy,\nwhatever else you wanna do.\n\n642\n00:32:29.683 --> 00:32:33.000\nIf you need more information on\nany of that, make sure you go and\n\n643\n00:32:33.000 --> 00:32:36.835\ncheck out our 70-410 or\nsome of those entry level server classes.\n\n644\n00:32:36.835 --> 00:32:38.942\nBut as far as getting ready for\n\n645\n00:32:38.942 --> 00:32:43.757\nActive Directory in Azure our\non-premises domain is configured.\n\n646\n00:32:43.757 --> 00:32:47.378\n>> And that's what I like about this,\nthere doesn't have to be any kind of weird\n\n647\n00:32:47.378 --> 00:32:51.000\nconfiguration, I've gotta do this\ncuz it's gonna connect to Azure and\n\n648\n00:32:51.000 --> 00:32:53.082\nActive Directory are gonna come together.\n\n649\n00:32:53.082 --> 00:32:56.790\nNope, just build your Active Directory\nas you normally would.\n\n650\n00:32:56.790 --> 00:33:00.516\n>> Yeah, absolutely, when you talk about\ngoing extending your Active Directory,\n\n651\n00:33:00.516 --> 00:33:04.320\nyour on-premises Active Directory out in\nthe cloud, You don't have to start over.\n\n652\n00:33:04.320 --> 00:33:07.640\nI mean, I'm starting from scratch, so\nthat we can show you all the steps and\n\n653\n00:33:07.640 --> 00:33:08.990\nwhat's involved but\n\n654\n00:33:08.990 --> 00:33:12.620\nnine times out of ten your organization\nhas been around for a little while.\n\n655\n00:33:12.620 --> 00:33:14.720\nYou're already running Active Directory.\n\n656\n00:33:14.720 --> 00:33:17.780\nYou don't have to go and reinstall\nActive Directory just cuz you plan on\n\n657\n00:33:17.780 --> 00:33:19.830\nmoving out to Active Directory and Azure.\n\n658\n00:33:19.830 --> 00:33:23.380\nI just wanted to show you these steps,\nso you're absolutely right, Daniel,\n\n659\n00:33:23.380 --> 00:33:26.250\nthere's no difference in\nthe configuration initially.\n\n660\n00:33:26.250 --> 00:33:29.370\nNow there are some things we're\ngonna do to Active Directory\n\n661\n00:33:29.370 --> 00:33:31.720\nto get it ready to extend\nout into the cloud.\n\n662\n00:33:31.720 --> 00:33:34.640\nBut again, if you've already got\nActive Directory on premises,\n\n663\n00:33:35.860 --> 00:33:36.910\nyou don't have to start over.\n\n664\n00:33:36.910 --> 00:33:38.100\n>> You'll be able to do this as well.\n\n665\n00:33:38.100 --> 00:33:38.860\n>> Yes, exactly.\n\n666\n00:33:38.860 --> 00:33:42.730\nThe next steps that we do, you'll be able\nto do on your Active Directory on-premise.\n\n667\n00:33:42.730 --> 00:33:43.800\n>> Well, excellent stuff, Mike.\n\n668\n00:33:43.800 --> 00:33:46.720\nI really look forward to this,\nthis has been a fun show, so far, and\n\n669\n00:33:46.720 --> 00:33:48.460\nit's got a lot more fun to come.\n\n670\n00:33:48.460 --> 00:33:51.390\nAs far as this episode goes, Mike,\nwe've got Active Directory installed.\n\n671\n00:33:51.390 --> 00:33:53.300\nIt's up and running, it's ready to roll.\n\n672\n00:33:53.300 --> 00:33:55.630\nIs there anything else we need\nto cover for this episode?\n\n673\n00:33:55.630 --> 00:33:59.300\n>> I don't think so, until we get into\nsetting up routing and Internet access for\n\n674\n00:33:59.300 --> 00:34:00.910\nour network, we are good to go.\n\n675\n00:34:00.910 --> 00:34:03.030\n>> Talking about more fun,\nthat would definitely be it.\n\n676\n00:34:03.030 --> 00:34:03.910\nWell, thank you so much for\n\n677\n00:34:03.910 --> 00:34:06.700\nstopping by and showing us how\nto prepare an Active Directory.\n\n678\n00:34:06.700 --> 00:34:09.550\nAnd for anywhere,\nany case that you might need it.\n\n679\n00:34:09.550 --> 00:34:11.970\nAnd then next, we'll be moving\ninto doing the other stuff,\n\n680\n00:34:11.970 --> 00:34:13.840\nwhich is a whole lot cooler as well.\n\n681\n00:34:13.840 --> 00:34:14.846\nThank you guys for watching.\n\n682\n00:34:14.846 --> 00:34:16.842\nWe're gonna go ahead and\nsign off for ITProTV.\n\n683\n00:34:16.842 --> 00:34:18.259\nI've been your host, Daniel Lowrie.\n\n684\n00:34:18.259 --> 00:34:19.164\n>> And I'm Mike Rodrick.\n\n685\n00:34:19.164 --> 00:34:21.346\n>> And we'll see you next time.\n\n686\n00:34:21.346 --> 00:34:28.290\n[SOUND]\n\n",
          "vimeoId": "154722128"
        },
        {
          "description": "In this episode, Daniel and Mike walk you through configuring your VPN endpoints which will be used to connect and encrypt your data between the on-premises site with your site in Azure. They begin by installing and configuring the Routing & Remote Access server which acts as the endpoint gateway. Then they configure Network Address Translation(NAT) so that the private internal network can send network traffic across the VPN and access the Internet.",
          "length": "1646",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-3-configure_a_vpn_endpoint-020916-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-3-configure_a_vpn_endpoint-020916-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-3-configure_a_vpn_endpoint-020916-1-sm.jpg",
          "title": "Configure a VPN Endpoint",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.143 --> 00:00:16.811\nAll right, greetings everyone and welcome\nto another exciting episode of ITProTV.\n\n3\n00:00:16.811 --> 00:00:18.850\nI'm your host Daniel Lowrie and\n\n4\n00:00:18.850 --> 00:00:23.380\nin today's episode we're continuing\non with our AD in Azure series.\n\n5\n00:00:23.380 --> 00:00:27.510\nAnd joining us in the studio today, giving\nus all the tips and wisdom that he has\n\n6\n00:00:27.510 --> 00:00:30.920\nrolling around upside in his brain is\nour good friend, Mr. Mike Rodrick.\n\n7\n00:00:30.920 --> 00:00:32.050\nMike, welcome back to the show.\n\n8\n00:00:32.050 --> 00:00:32.910\nHow you doing today, sir?\n\n9\n00:00:32.910 --> 00:00:33.770\n>> Doing fantastic.\n\n10\n00:00:33.770 --> 00:00:34.620\nGlad to be here.\n\n11\n00:00:34.620 --> 00:00:36.870\nExcited to get back into\nActive Directory in Azure.\n\n12\n00:00:36.870 --> 00:00:39.870\nWe're getting that much\ncloser to tying it in.\n\n13\n00:00:39.870 --> 00:00:43.995\nAnd we're still working local, or\nbasically on-premises at this point,\n\n14\n00:00:43.995 --> 00:00:45.550\nif I can say that correctly.\n\n15\n00:00:46.900 --> 00:00:50.250\nIf you remember in the previous episodes,\nwe got Active Directory installed.\n\n16\n00:00:50.250 --> 00:00:53.190\nWe really haven't done anything above and\nbeyond installing.\n\n17\n00:00:53.190 --> 00:00:55.290\nWe haven't done any\nconfiguration to it yet or not,\n\n18\n00:00:55.290 --> 00:00:59.700\nso we've got our enterprise getting\nset up, which is again, one of\n\n19\n00:00:59.700 --> 00:01:03.190\nthose things that probably nine times\nout of ten is already gonna be there.\n\n20\n00:01:03.190 --> 00:01:05.970\nYou're gonna get a job somewhere,\nworking for an enterprise.\n\n21\n00:01:05.970 --> 00:01:09.090\nActive Directory is already configured,\nbut you never know, you might get lucky,\n\n22\n00:01:09.090 --> 00:01:11.790\nyou might be in one of those startups or\nstart your own company.\n\n23\n00:01:11.790 --> 00:01:15.340\nSo we've decided to go from\nthe beginning all the way through.\n\n24\n00:01:15.340 --> 00:01:17.120\nSo we've got active directory installed.\n\n25\n00:01:17.120 --> 00:01:21.210\nThe next thing we're going to\ndo is configure our router or\n\n26\n00:01:21.210 --> 00:01:25.460\nsetup a way for my corporate\nnetwork to get internet access.\n\n27\n00:01:25.460 --> 00:01:30.100\nBecause If we think about it, if I'm gonna\nextend Active Directory out into the cloud\n\n28\n00:01:30.100 --> 00:01:34.540\nor into specifically,\ncannot say that one either,\n\n29\n00:01:34.540 --> 00:01:38.910\nspecifically out into Microsoft Azure,\nwe are gonna need internet access, right.\n\n30\n00:01:38.910 --> 00:01:40.020\nKind of makes sense.\n\n31\n00:01:40.020 --> 00:01:41.470\nSo that's what we're gonna do next.\n\n32\n00:01:41.470 --> 00:01:44.190\nIf we take a look at my screen and we got\nthat drawing that we looked at the other\n\n33\n00:01:44.190 --> 00:01:47.650\nday, we have now configured\nour domain controller.\n\n34\n00:01:47.650 --> 00:01:49.110\nSo that is set up.\n\n35\n00:01:49.110 --> 00:01:52.570\nThe next step is to set up our router\nout here, because we're gonna,\n\n36\n00:01:52.570 --> 00:01:55.090\nagain, want to be able\nto get internet access.\n\n37\n00:01:55.090 --> 00:01:59.410\nAnd in the end, that's where we're\ngonna tie in to Azure, right.\n\n38\n00:01:59.410 --> 00:02:00.600\nWe talked about that.\n\n39\n00:02:00.600 --> 00:02:03.590\nI said we're gonna end up, I think I did,\nif I didn't, let me say it now.\n\n40\n00:02:03.590 --> 00:02:07.540\nWe're gonna go ahead and set up, what\nwe'll end up doing is setting up a site\n\n41\n00:02:07.540 --> 00:02:12.290\nto site VPN between our network and\nMicrosoft Azure.\n\n42\n00:02:12.290 --> 00:02:16.270\nSo we need some type of VPN endpoint\nthen to create that tunnel, right.\n\n43\n00:02:16.270 --> 00:02:19.150\nAnd it's no different than you\nwould any other branch office,\n\n44\n00:02:19.150 --> 00:02:23.410\nI don't want you to get scared and\nthink my gosh this is gonna be crazy.\n\n45\n00:02:23.410 --> 00:02:26.430\nIt's actually easier than\ndoing it between your own,\n\n46\n00:02:26.430 --> 00:02:28.640\nlike say you had another\noffice in another city.\n\n47\n00:02:28.640 --> 00:02:30.230\nYou gotta do both ends, right.\n\n48\n00:02:30.230 --> 00:02:32.760\nWith Azure,\nthey've got their end taken care of and\n\n49\n00:02:32.760 --> 00:02:36.760\nthey're basically saying, just point us\nto your end and we'll build this tunnel.\n\n50\n00:02:36.760 --> 00:02:39.490\nYou'll see that it's really not that bad.\n\n51\n00:02:39.490 --> 00:02:42.819\n>> Yeah, and Mike, when it comes to what\nwe're looking at here with our diagram,\n\n52\n00:02:42.819 --> 00:02:45.454\nanything where you have that\nlittle gnv between the two lines,\n\n53\n00:02:45.454 --> 00:02:48.360\nthat's gonna be our device that\ngives us the access to the internet.\n\n54\n00:02:48.360 --> 00:02:52.250\nAnd this can be anything that can well,\nA, give you internet access, and B,\n\n55\n00:02:52.250 --> 00:02:54.010\ncreate a VPN tunnel.\n\n56\n00:02:54.010 --> 00:02:58.630\nBe it a router, be it a VPN concentrator,\nor, for today's intents and purposes,\n\n57\n00:02:58.630 --> 00:02:59.910\nwe're gonna go a little old school.\n\n58\n00:02:59.910 --> 00:03:02.050\n>> We are.\n>> A little Microsoft-centric.\n\n59\n00:03:02.050 --> 00:03:03.720\nAnd go with the routing remote access.\n\n60\n00:03:03.720 --> 00:03:04.461\n>> Good old RAS.\n\n61\n00:03:04.461 --> 00:03:06.360\nRouting and mode access, right.\n\n62\n00:03:06.360 --> 00:03:07.600\nIt's everybody's favorite.\n\n63\n00:03:07.600 --> 00:03:08.400\n>> You gotta love it.\n\n64\n00:03:08.400 --> 00:03:09.270\n>> Okay, maybe not.\n\n65\n00:03:09.270 --> 00:03:10.930\nBut yeah, you're absolutely right.\n\n66\n00:03:10.930 --> 00:03:15.340\nCould be anything you would use to\ncreate a VPN tunnel at the outside.\n\n67\n00:03:15.340 --> 00:03:19.640\nI just happen to be using routing\nremote access, so let's flip over here.\n\n68\n00:03:19.640 --> 00:03:22.190\nI've got a Server 2012 R2 machine.\n\n69\n00:03:22.190 --> 00:03:25.250\nA nice fresh install\nwith all of its updates.\n\n70\n00:03:25.250 --> 00:03:26.900\nI have done a couple things to it.\n\n71\n00:03:26.900 --> 00:03:31.010\nIf I go over here to local server you'll\nsee that I've obviously renamed it,\n\n72\n00:03:31.010 --> 00:03:32.090\nset my time zone.\n\n73\n00:03:32.090 --> 00:03:35.880\nAll right, those normal things that\nyou do when you do a fresh install.\n\n74\n00:03:35.880 --> 00:03:38.150\nWe've got to do our\npost-installation configuration.\n\n75\n00:03:38.150 --> 00:03:39.800\nSo nothing exciting there.\n\n76\n00:03:39.800 --> 00:03:43.760\nHere though notice I have\ntwo network adapters, right.\n\n77\n00:03:43.760 --> 00:03:47.990\nRemember, this guy is gonna be\nsitting between my corporate network\n\n78\n00:03:47.990 --> 00:03:48.890\nand the internet.\n\n79\n00:03:48.890 --> 00:03:52.910\nAnd we're gonna be setting up a VPN tunnel\ninto him, so he needs one side to be\n\n80\n00:03:52.910 --> 00:03:58.060\nconnected to the outside and therefore\nneeding a publicly routable IP address.\n\n81\n00:03:58.060 --> 00:04:01.800\nThe inner adapter or the second network\nadapter on the left in this drawing\n\n82\n00:04:01.800 --> 00:04:03.870\nwould be the one that's\nconnected to the inside.\n\n83\n00:04:03.870 --> 00:04:07.000\nThat one will most likely\nhave a private IP address,\n\n84\n00:04:07.000 --> 00:04:08.830\nwhich is what I've got going on here.\n\n85\n00:04:08.830 --> 00:04:13.270\nI've got two network adapters, one you'll\nnotice has a nice public IP address,\n\n86\n00:04:13.270 --> 00:04:17.450\nthe other one has an internal,\nprivate IP address on it, all right.\n\n87\n00:04:17.450 --> 00:04:19.360\nSo that's basically all\nI've done in this machine.\n\n88\n00:04:19.360 --> 00:04:21.570\nYou get to see everything else.\n\n89\n00:04:21.570 --> 00:04:23.920\nSo the first thing we'll\ndo is add our role, right.\n\n90\n00:04:23.920 --> 00:04:25.910\nWe'll go to Manage and Add Roles.\n\n91\n00:04:25.910 --> 00:04:28.770\nIf we're on that dashboard I can\nalways click the Add Roles and\n\n92\n00:04:28.770 --> 00:04:30.970\nFeatures link in the middle\nof the screen there.\n\n93\n00:04:30.970 --> 00:04:35.060\nAnd then we'll click Next\nthree times on our wizard.\n\n94\n00:04:36.110 --> 00:04:40.700\nBecause it's role based and because it\nalready knows what server I'm using\n\n95\n00:04:40.700 --> 00:04:43.590\nto install the role, so\nI'll click Next one more time.\n\n96\n00:04:43.590 --> 00:04:45.790\nAnd then here, they have changed this.\n\n97\n00:04:45.790 --> 00:04:46.940\nIf you've worked with Server for\n\n98\n00:04:46.940 --> 00:04:49.660\nsome period of time,\nthe names have changed a little bit.\n\n99\n00:04:49.660 --> 00:04:52.050\nBasically, we're looking for\nRemote Access.\n\n100\n00:04:52.050 --> 00:04:56.538\nRemote Access is Is one of those roles\nthat has several subcomponents or\n\n101\n00:04:56.538 --> 00:04:58.280\nsubroles, as they like to say.\n\n102\n00:04:58.280 --> 00:05:01.170\nYou install this if you\nwanna do direct access,\n\n103\n00:05:01.170 --> 00:05:05.770\nif you wanna do VPN, if you wanna\nrun network address translation.\n\n104\n00:05:05.770 --> 00:05:07.380\nAll of those are kinda\nrolled up into this.\n\n105\n00:05:07.380 --> 00:05:11.070\nYou don't have to deploy all them,\nbut you just install that one role.\n\n106\n00:05:11.070 --> 00:05:13.520\nAnd then when you go to configure,\nyou pick what you actually need.\n\n107\n00:05:13.520 --> 00:05:15.310\nDo I need a direct access server?\n\n108\n00:05:15.310 --> 00:05:16.690\nDo I need a VPN server,\n\n109\n00:05:16.690 --> 00:05:21.160\nam I doing LAN routing or network\naddress translation or what have you.\n\n110\n00:05:21.160 --> 00:05:24.660\nSo that's the role we're gonna pick,\nthe good old Routing and Remote Access.\n\n111\n00:05:24.660 --> 00:05:26.450\nIt's gonna see what else is required and\n\n112\n00:05:26.450 --> 00:05:29.990\nremind me that I should install\nthem if I want to continue.\n\n113\n00:05:29.990 --> 00:05:33.900\nIt says nothing is necessary so\nwe'll just go ahead and click Next.\n\n114\n00:05:33.900 --> 00:05:36.730\nDon't need any additional\nfeatures at this point.\n\n115\n00:05:36.730 --> 00:05:38.060\nAnd I'll click next through there.\n\n116\n00:05:38.060 --> 00:05:39.840\nAgain good idea if you're\ngoing through it for\n\n117\n00:05:39.840 --> 00:05:42.820\nthe first time to read some\nof those intro screens.\n\n118\n00:05:42.820 --> 00:05:45.060\nThey give you a lot of\ngood information there.\n\n119\n00:05:45.060 --> 00:05:47.640\nI'm just going to click Next,\nright on by, and\n\n120\n00:05:47.640 --> 00:05:50.550\nhere I can see the different role\nservices that make up the role.\n\n121\n00:05:50.550 --> 00:05:53.170\nI can choose all of them or\nwhichever ones I need.\n\n122\n00:05:53.170 --> 00:05:56.990\nIn my case, Direct Access and VPN and\nit's gonna ask me if I want to\n\n123\n00:05:56.990 --> 00:06:00.950\ninstall the consoles and all the required\nstuff and I'll say yes, I do.\n\n124\n00:06:00.950 --> 00:06:03.380\nAnd then I'm also gonna do routing,\nall right.\n\n125\n00:06:03.380 --> 00:06:05.840\nAnd that's one of those\nthings that's easy to forget.\n\n126\n00:06:05.840 --> 00:06:08.950\nIf you're doing this on a router\nthat's acting as a VPN endpoint,\n\n127\n00:06:08.950 --> 00:06:11.110\nyou don't have to worry about that, right.\n\n128\n00:06:11.110 --> 00:06:13.240\nBut in my case this is\na server sitting there,\n\n129\n00:06:13.240 --> 00:06:17.180\nit's multi-homed, two network adapters,\nso multiple homes, right.\n\n130\n00:06:17.180 --> 00:06:21.430\nAnd if I'm gonna get traffic\ncoming in to this right-hand side,\n\n131\n00:06:21.430 --> 00:06:26.140\nI then need to route that over to\nthe other side and vice versa.\n\n132\n00:06:26.140 --> 00:06:30.870\nWhen traffic is leaving it's going to\nbe on the 10.1.1 network in my case,\n\n133\n00:06:30.870 --> 00:06:33.680\nneeds to route that out to the internet.\n\n134\n00:06:33.680 --> 00:06:35.800\nSo this guy not only has\nto be a VPN endpoint,\n\n135\n00:06:35.800 --> 00:06:39.450\nit's also going to be\nperforming routing for me.\n\n136\n00:06:39.450 --> 00:06:42.700\nAnd, well I'll save the next one it's\ngonna be a little surprise here so\n\n137\n00:06:42.700 --> 00:06:44.270\nwe'll save that.\n\n138\n00:06:44.270 --> 00:06:45.220\n>> Don't wanna give everything away.\n\n139\n00:06:45.220 --> 00:06:45.855\n>> I don't, yeah, exactly.\n\n140\n00:06:45.855 --> 00:06:47.380\n>> [LAUGH]\n>> I don't wanna give it all away.\n\n141\n00:06:47.380 --> 00:06:48.230\nSpoiler alert!\n\n142\n00:06:48.230 --> 00:06:49.670\n>> Yeah.\n>> All right, so we'll go ahead and\n\n143\n00:06:49.670 --> 00:06:51.400\nclick Next on there.\n\n144\n00:06:51.400 --> 00:06:53.660\nAgain, a nice little intro screen.\n\n145\n00:06:53.660 --> 00:06:57.330\nIt knows, the great thing about 2012, 2012\nR2, right, it knows everything I need.\n\n146\n00:06:57.330 --> 00:06:59.560\nIt knows what I'm doing.\n\n147\n00:06:59.560 --> 00:07:02.480\nThat I'm doing to either, it doesn't\nknow if I'm doing Direct Access or\n\n148\n00:07:02.480 --> 00:07:05.650\nVPN but it has an idea that\nI'm doing one or the other.\n\n149\n00:07:05.650 --> 00:07:07.030\nI'm also gonna be doing routing.\n\n150\n00:07:07.030 --> 00:07:09.905\nSo when you look at this screen it's\ngonna install a web server and there's\n\n151\n00:07:09.905 --> 00:07:13.850\nsomethings checked and somethings not,\nit's smart enough to know what I need.\n\n152\n00:07:13.850 --> 00:07:17.330\nThere might be some things that\nyou want to add in addition, but\n\n153\n00:07:17.330 --> 00:07:21.820\nas far as just getting it up and running,\nit's got everything selected that I need.\n\n154\n00:07:21.820 --> 00:07:25.691\nWe'll go ahead and\nclick Next and then Install.\n\n155\n00:07:25.691 --> 00:07:28.385\nAnd this will take a minute or\ntwo because it is doing quite a bit.\n\n156\n00:07:28.385 --> 00:07:30.560\nIt's getting direct access components,\nconfigured.\n\n157\n00:07:30.560 --> 00:07:33.242\nI shouldn't so say configured but\ninstalled and ready to configure.\n\n158\n00:07:33.242 --> 00:07:34.231\nIf we wanna do them.\n\n159\n00:07:34.231 --> 00:07:37.863\nIt's setting up VPN,\nrouting remote access.\n\n160\n00:07:37.863 --> 00:07:40.052\nIt's adding routing in there.\n\n161\n00:07:40.052 --> 00:07:44.042\nAnd its also doing IIS or\nsetting up a web server and\n\n162\n00:07:44.042 --> 00:07:47.748\nthat WID or\nthe Window's internal database.\n\n163\n00:07:47.748 --> 00:07:50.290\nI don't actually know if anyone\nactually call it Wid but, eh.\n\n164\n00:07:50.290 --> 00:07:50.790\n>> [LAUGH]\n>> [CROSSTALK]\n\n165\n00:07:50.790 --> 00:07:51.938\n>> I'll coin a new term,\n\n166\n00:07:51.938 --> 00:07:54.189\nright here on ITPro.TV.\n>> Mike Rodrick original.\n\n167\n00:07:54.189 --> 00:07:56.230\n>> That's right.\n\n168\n00:07:56.230 --> 00:07:58.221\nAll right, so we'll wait for\n\n169\n00:07:58.221 --> 00:08:02.772\nthis guy to Scroll over, or\nto progress through and get installed.\n\n170\n00:08:02.772 --> 00:08:04.694\nAnd then just like any other role,\n\n171\n00:08:04.694 --> 00:08:07.150\nonce you install it you're not done.\n\n172\n00:08:07.150 --> 00:08:10.370\nI mean it doesn't ask you a lot of\nquestions when you install the role.\n\n173\n00:08:10.370 --> 00:08:14.095\nI always tease people and say, you could\ntrain anybody to install the role.\n\n174\n00:08:14.095 --> 00:08:16.670\nCuz it's basically checkmark,\nnext, next, next.\n\n175\n00:08:16.670 --> 00:08:18.140\nInstall.\n\n176\n00:08:18.140 --> 00:08:20.960\nIt's configuring the role\nonce it's installed and\n\n177\n00:08:20.960 --> 00:08:22.510\nmaking it function in your environment.\n\n178\n00:08:22.510 --> 00:08:25.250\nThat's where the training and\nthe skill and the expertise comes in.\n\n179\n00:08:25.250 --> 00:08:27.670\nSo installing it is\npretty much a no-brainer.\n\n180\n00:08:27.670 --> 00:08:28.950\n>> Yeah.\nThat's what I like about\n\n181\n00:08:28.950 --> 00:08:30.200\nMicrosoft Wizards.\n\n182\n00:08:30.200 --> 00:08:32.265\nThey're just that,\nthey really are a wizard.\n\n183\n00:08:32.265 --> 00:08:34.375\nIt's basically just a next, next, next.\n\n184\n00:08:34.375 --> 00:08:37.605\nEvery now and then, you've got to kind\nof know some particulars as you're going\n\n185\n00:08:37.605 --> 00:08:38.675\nthrough a window.\n\n186\n00:08:38.675 --> 00:08:40.935\nI'm sorry, a wizard, a Windows wizard.\n\n187\n00:08:40.935 --> 00:08:41.860\nSay that three times fast.\n>> It is 64%,\n\n188\n00:08:41.860 --> 00:08:43.398\njust to throw that in there real quick.\n\n189\n00:08:43.398 --> 00:08:44.031\n>> That's right.\n\n190\n00:08:44.031 --> 00:08:46.299\n>> [LAUGH]\n>> Cuz as Mike has let us know\n\n191\n00:08:46.299 --> 00:08:52.100\nthe Microsoft wizard bars love to jump\nto either 63 or 64% and sit there.\n\n192\n00:08:52.100 --> 00:08:54.724\nWe were musing about this before the show,\nand it's funny,\n\n193\n00:08:54.724 --> 00:08:56.739\nwe're pretty sure this is smoke and\nmirrors.\n\n194\n00:08:56.739 --> 00:09:01.191\n[LAUGH] It just jumps to 64% to make you\nfeel good about sitting there waiting,\n\n195\n00:09:01.191 --> 00:09:02.325\nI'm almost there.\n\n196\n00:09:02.325 --> 00:09:03.017\n>> I'm almost there.\n\n197\n00:09:03.017 --> 00:09:04.888\n[CROSSTALK] I'm more than half, right?\n\n198\n00:09:04.888 --> 00:09:05.567\n[LAUGH]\n>> Yeah,\n\n199\n00:09:05.567 --> 00:09:07.590\nyeah, we're on the downhill\nslide on this thing.\n\n200\n00:09:07.590 --> 00:09:09.770\nAnd then of course you wait ten\nminutes and it finally gets sent.\n\n201\n00:09:09.770 --> 00:09:12.420\n>> [LAUGH] Exactly, it'll sit there for\nanother five minutes.\n\n202\n00:09:12.420 --> 00:09:15.280\nIt shouldn't be that long, but yeah,\nso we'll get this installed and\n\n203\n00:09:15.280 --> 00:09:16.660\nthen we'll get it configured.\n\n204\n00:09:16.660 --> 00:09:20.420\nAnd as I was saying once\nyou get this role installed\n\n205\n00:09:20.420 --> 00:09:23.050\nwe're gonna setup routing remote access.\n\n206\n00:09:23.050 --> 00:09:24.190\nWe're basically gonna go in and\n\n207\n00:09:24.190 --> 00:09:29.590\nchoose VPN server because that's\nreally what I need, I need both.\n\n208\n00:09:29.590 --> 00:09:32.910\nI need the routing to get my internal\nnetwork out to the Internet because my\n\n209\n00:09:32.910 --> 00:09:37.720\nusers are not gonna be happy if they don't\nhave Internet access cuz they can't surf\n\n210\n00:09:37.720 --> 00:09:40.820\nFacebook and Instagram and all that.\n\n211\n00:09:40.820 --> 00:09:43.560\nIn today's world you really\ncan't survive isolated.\n\n212\n00:09:43.560 --> 00:09:48.130\nI mean a lot of the resources that your\nusers, your company is going to depend on,\n\n213\n00:09:48.130 --> 00:09:50.880\nare gonna be out there beyond\nyour network boundaries.\n\n214\n00:09:50.880 --> 00:09:57.080\nSo Internet access or access to the Web\nis almost a must in most networks.\n\n215\n00:09:57.080 --> 00:09:59.550\n>> Yeah, very few systems actually\n\n216\n00:09:59.550 --> 00:10:02.640\nare meant to be not connected\nto some sort of Internet.\n\n217\n00:10:02.640 --> 00:10:06.550\nIt's like SCADA systems, things of that\nnature, that need to be isolated so\n\n218\n00:10:06.550 --> 00:10:08.510\nthat no one can bother with them.\n\n219\n00:10:08.510 --> 00:10:09.610\nThat's really the purpose of it.\n\n220\n00:10:09.610 --> 00:10:11.300\nIt's kind of a security feature that,\n\n221\n00:10:11.300 --> 00:10:14.581\nwe're not going to connect you to the\nInternet therefore no one can make this\n\n222\n00:10:14.581 --> 00:10:16.900\nnuclear facility do things\nit's not supposed to do.\n\n223\n00:10:16.900 --> 00:10:19.667\n[LAUGH]\n>> An interesting little side story there\n\n224\n00:10:19.667 --> 00:10:23.189\nbecause that is the way it was designed\nand the way you would think it should be.\n\n225\n00:10:23.189 --> 00:10:26.220\nAnd all of a sudden we\nsee them being connected.\n\n226\n00:10:26.220 --> 00:10:28.780\nBecause people have to be\nable to work remotely.\n\n227\n00:10:28.780 --> 00:10:32.570\nAnd we wonder why we're getting these\nnew attacks that are occurring on these\n\n228\n00:10:32.570 --> 00:10:34.290\nkinds of systems.\n\n229\n00:10:34.290 --> 00:10:38.072\nIt wasn't designed to be\nconnected to the outside world.\n\n230\n00:10:38.072 --> 00:10:40.500\nLet's secure it first then connect it.\n\n231\n00:10:40.500 --> 00:10:41.480\nBut that's a side story.\n\n232\n00:10:41.480 --> 00:10:43.450\n>> I'd have to work in pajamas man.\n\n233\n00:10:43.450 --> 00:10:44.790\nHow am I supposed to do that?\n\n234\n00:10:44.790 --> 00:10:47.960\nIf I can't do it from\nthe comfort of my own home.\n\n235\n00:10:47.960 --> 00:10:49.540\n>> All right so it's almost done here.\n\n236\n00:10:49.540 --> 00:10:50.955\nIt's at 64%.\n\n237\n00:10:50.955 --> 00:10:54.480\n[LAUGH] So\nhopefully it won't be too much longer.\n\n238\n00:10:54.480 --> 00:10:57.710\nAnd then as I said, we're gonna go in and\nbasically there's a wizard, right,\n\n239\n00:10:57.710 --> 00:11:00.110\nthat we're gonna walk through,\nthat's gonna help me set up.\n\n240\n00:11:00.110 --> 00:11:01.870\nIt's gonna ask me, what do I wanna do?\n\n241\n00:11:01.870 --> 00:11:03.820\nDo I want to set up Direct Access?\n\n242\n00:11:03.820 --> 00:11:05.947\nDo I want to setup a VPN?\n\n243\n00:11:05.947 --> 00:11:07.020\nDo I want to setup NAT?\n\n244\n00:11:07.020 --> 00:11:10.190\nDo I want to setup LAN routing?\n\n245\n00:11:10.190 --> 00:11:10.840\nWhat is it that I wanna do?\n\n246\n00:11:10.840 --> 00:11:15.070\nBecause remember that one role has\nseveral role services associated with it.\n\n247\n00:11:15.070 --> 00:11:16.920\nYou're gonna tell the wizard\nwhat you want, and\n\n248\n00:11:16.920 --> 00:11:20.650\nthen it's gonna change the wizard\nappropriately to ask you the right\n\n249\n00:11:20.650 --> 00:11:24.580\nquestions to get that setup however you\nwant it, do whatever it is you plan to do.\n\n250\n00:11:24.580 --> 00:11:27.250\n>> We're talking about setting up\na VPN here, right, you gotta remember,\n\n251\n00:11:27.250 --> 00:11:28.670\nwhat is the purpose of the VPN?\n\n252\n00:11:28.670 --> 00:11:32.470\nAnd it's gonna help you understand,\nwhy we're doing what we're doing.\n\n253\n00:11:32.470 --> 00:11:33.730\nThe purpose of the VPN is for\n\n254\n00:11:33.730 --> 00:11:37.000\nme to be able to use that public\ninfrastructure of the Internet.\n\n255\n00:11:37.000 --> 00:11:39.300\nLike we were saying when we're\nconnecting SCADA systems, and\n\n256\n00:11:39.300 --> 00:11:40.740\nsystems that were never meant or\n\n257\n00:11:40.740 --> 00:11:45.530\ndesigned to be accessed from an outside\nsource, they're now connecting them.\n\n258\n00:11:45.530 --> 00:11:48.950\nWell it's because of things\nlike VPN connections and\n\n259\n00:11:48.950 --> 00:11:52.500\nthe encryption algorithms that they use\nthat that is starting to become a reality.\n\n260\n00:11:52.500 --> 00:11:55.600\nBecause we are, again,\nwe're encrypting that data,\n\n261\n00:11:55.600 --> 00:11:57.100\nwe're using that public infrastructure.\n\n262\n00:11:57.100 --> 00:11:59.570\nIt keeps the cost down,\nit's a very nice thing.\n\n263\n00:11:59.570 --> 00:12:02.920\nBut we're using a high level of\nencryption to make sure that the data,\n\n264\n00:12:02.920 --> 00:12:05.430\neven though it's going\nthrough that public zone,\n\n265\n00:12:05.430 --> 00:12:08.500\nis even if it's intercepted they're not\ngoing to be able to do anything with it.\n\n266\n00:12:08.500 --> 00:12:10.670\nThey're highly encrypted and\nthey use great algorithms and\n\n267\n00:12:10.670 --> 00:12:11.690\nthings of that nature.\n\n268\n00:12:11.690 --> 00:12:15.020\nSo that's what we're doing and that's why\nyou can feel safe about saying well I'm\n\n269\n00:12:15.020 --> 00:12:19.570\ngoing to put a copy of my Active Directory\nout in Azure, it's in the cloud, right?\n\n270\n00:12:19.570 --> 00:12:22.080\nAccessing it through that\npublic infrastructure but\n\n271\n00:12:22.080 --> 00:12:25.512\nwe're creating that site-to-site VPN\ngoing just from here and just from here.\n\n272\n00:12:25.512 --> 00:12:28.160\nYou're gonna create a tunnel and you're\ngoing to encrypt the mess out of it.\n\n273\n00:12:28.160 --> 00:12:31.320\nAnd that way,\neven if someone does gain access to it,\n\n274\n00:12:31.320 --> 00:12:33.610\nthey're not gonna know what's going on and\nnot gonna be able to decrypt it.\n\n275\n00:12:33.610 --> 00:12:34.710\n>> Exactly.\n\n276\n00:12:34.710 --> 00:12:37.980\nAll right, well it finally finished up so\nlet's take a peek at my screen here and\n\n277\n00:12:37.980 --> 00:12:40.240\nwe'll go ahead and click Close.\n\n278\n00:12:40.240 --> 00:12:43.720\nI don't know why, I just like doing that,\nclosing that and then clicking on.\n\n279\n00:12:44.730 --> 00:12:46.949\nI guess I'm a little OCD,\nif I click that link,\n\n280\n00:12:46.949 --> 00:12:50.741\nanother wizard opens on top of that wizard\nthen I have to close two wizards later.\n\n281\n00:12:50.741 --> 00:12:53.010\nIt doesn't matter which way you go.\n\n282\n00:12:53.010 --> 00:12:55.000\nAll right, so here we go.\nOpen the Getting Started wizard.\n\n283\n00:12:56.210 --> 00:12:59.730\nThat's going to, it's really,\nwell I'll just wait and let you see.\n\n284\n00:12:59.730 --> 00:13:03.670\nIt's kind of silly, as soon as it pops up.\n\n285\n00:13:03.670 --> 00:13:04.490\nIt's thinking about it.\n\n286\n00:13:05.630 --> 00:13:06.370\n>> Don't rush it Mike.\n\n287\n00:13:06.370 --> 00:13:07.778\n>> Yeah, I don't want to hurry this thing.\n\n288\n00:13:07.778 --> 00:13:13.710\nIt's only got about 4GBs of RAM and a 3.47\ngigahertz processor here and I5, slow.\n\n289\n00:13:15.010 --> 00:13:16.873\n>> Junk.\n\n290\n00:13:16.873 --> 00:13:19.079\n>> Scrap it.\n>> You could really upgrade Michael.\n\n291\n00:13:19.079 --> 00:13:21.030\n>> All right, so\nhere's the first Wizard that pops up.\n\n292\n00:13:21.030 --> 00:13:23.920\nConfigure remote access,\nthe good old Getting Started wizard and\n\n293\n00:13:23.920 --> 00:13:28.090\nit's simply asking me do I want\nto do both Direct Access and VPN?\n\n294\n00:13:28.090 --> 00:13:29.090\nRecommended.\n\n295\n00:13:29.090 --> 00:13:33.070\nDeploy Direct Access only or\ndeploy VPN only.\n\n296\n00:13:33.070 --> 00:13:36.360\nNow if you've been doing any\ntraining in Microsoft you'll know.\n\n297\n00:13:36.360 --> 00:13:37.950\nIf you haven't, I'm gonna tell you.\n\n298\n00:13:37.950 --> 00:13:41.890\nVPNs are the way we used to provide\naccess as Daniel's explaining\n\n299\n00:13:41.890 --> 00:13:46.750\nto our corporate network from the outside,\nleveraging the public infrastructure.\n\n300\n00:13:46.750 --> 00:13:50.950\nI've got somebody at home, they wanna be\nable to connect to resources at work or\n\n301\n00:13:50.950 --> 00:13:52.492\nI've got somebody traveling.\n\n302\n00:13:52.492 --> 00:13:54.190\nWe're gonna use that\npublic infrastructure,\n\n303\n00:13:54.190 --> 00:13:56.360\nthe Internet,\nbecause it's a big fast mesh.\n\n304\n00:13:56.360 --> 00:13:58.650\nAnd I know no matter where my user is,\n\n305\n00:13:58.650 --> 00:14:01.910\nhe has electrical connectivity\nback to the corporate office.\n\n306\n00:14:01.910 --> 00:14:04.280\nThe problem is, is we're going\nover that public infrastructure.\n\n307\n00:14:04.280 --> 00:14:07.580\nAnd who knows what is trying to capture or\nsteal that data.\n\n308\n00:14:07.580 --> 00:14:11.150\nSo we create that virtual tunnel,\nthat virtual private network,\n\n309\n00:14:11.150 --> 00:14:15.880\nby encapsulating the packets in\na tunneling protocol like some older ones,\n\n310\n00:14:15.880 --> 00:14:22.510\nL2, TPP, PTP, SSTP or what have you\nto protect it as it travels across.\n\n311\n00:14:22.510 --> 00:14:24.770\nStarting in, I wanna say it was 2008,\n\n312\n00:14:24.770 --> 00:14:28.560\n2008 r2, don't quote me on that, was where\nthe started working with Direct Access and\n\n313\n00:14:28.560 --> 00:14:32.640\nit's kind of the replacement in\na Microsoft world for VPN connections.\n\n314\n00:14:32.640 --> 00:14:34.820\nIt's fantastic if you\nhaven't played with it.\n\n315\n00:14:34.820 --> 00:14:38.870\nCheck out some of our Microsoft\ncourses in our course library\n\n316\n00:14:38.870 --> 00:14:40.140\nif you want more information.\n\n317\n00:14:40.140 --> 00:14:45.000\nBut it's, where as a VPN user has to\nopen up their laptop, double-click,\n\n318\n00:14:45.000 --> 00:14:46.435\ngain Internet access.\n\n319\n00:14:46.435 --> 00:14:50.168\nDouble-click on their little VPN\nconnection to establish the connection.\n\n320\n00:14:50.168 --> 00:14:53.680\nAnd once they're connected,\nnow they can gain access to resources.\n\n321\n00:14:53.680 --> 00:14:57.100\nAnd from the corporate side I can\nmanage their computer cuz it's now\n\n322\n00:14:57.100 --> 00:14:59.315\nalmost like it was\nplugged into our network.\n\n323\n00:14:59.315 --> 00:15:02.130\nDirectAccess, as soon as you\npower that computer on and\n\n324\n00:15:02.130 --> 00:15:06.110\nit gains Internet access which it's doing\nin the background before you even log on,\n\n325\n00:15:06.110 --> 00:15:07.710\nI can see your computer and\nI can manage it.\n\n326\n00:15:07.710 --> 00:15:10.450\nSo it's a really cool technology,\nbut that's not what this show is for\n\n327\n00:15:10.450 --> 00:15:14.239\nso I'll digress and move back to our,\nwhat we're doing here.\n\n328\n00:15:15.490 --> 00:15:20.410\nIn this case, and the reason I brought\nall that up is because in the real world\n\n329\n00:15:20.410 --> 00:15:22.420\nI might be doing this for\nmore than one reason.\n\n330\n00:15:22.420 --> 00:15:26.070\nI might be setting up this\nremote access server to do both.\n\n331\n00:15:26.070 --> 00:15:29.835\nAllow remote access to my network for\nmy traveling salespeople and\n\n332\n00:15:29.835 --> 00:15:33.880\na site-to-site VPN out there to Azure.\n\n333\n00:15:33.880 --> 00:15:34.805\nSo I might be doing both.\n\n334\n00:15:34.805 --> 00:15:39.200\nDirectAccess to support my users,\nVPN to set up my site-to-site.\n\n335\n00:15:39.200 --> 00:15:43.230\nIn this lab environment though,\nwe're going to limit it to just the VPN.\n\n336\n00:15:43.230 --> 00:15:48.963\nSo that's why I'm choosing VPN only,\nand that's it, right?\n\n337\n00:15:48.963 --> 00:15:52.253\nIt's kinda strange right,\nit's like whoa, that was it?\n\n338\n00:15:52.253 --> 00:15:54.029\nIt really doesn't do anything, but\n\n339\n00:15:54.029 --> 00:15:57.985\nif we had chosen DirectAccess That would\nhave launched a whole another wizard that\n\n340\n00:15:57.985 --> 00:16:01.420\nwould have walked me through\nthe process of configuring that.\n\n341\n00:16:01.420 --> 00:16:03.655\nIf you do VPN, it says,\n[LAUGH] you're on your own.\n\n342\n00:16:03.655 --> 00:16:04.560\n>> [LAUGH]\n>> Go ahead,\n\n343\n00:16:04.560 --> 00:16:05.740\nand you can set that up yourself.\n\n344\n00:16:05.740 --> 00:16:10.330\n[LAUGH] So once you close\nthat getting started wizard,\n\n345\n00:16:10.330 --> 00:16:13.330\nI now have my Routing and\nRemote Access console opened up.\n\n346\n00:16:13.330 --> 00:16:14.540\nIt opened up automatically.\n\n347\n00:16:14.540 --> 00:16:20.039\nIf it did not, Tools, and then we can\ngo down to Routing and Remote Access.\n\n348\n00:16:21.130 --> 00:16:25.970\nAnd here I've got a red arrow, or a red,\nyeah a little red downward pointing arrow,\n\n349\n00:16:25.970 --> 00:16:30.700\non my GNV-RTR01 because I haven't\nactually configured it yet.\n\n350\n00:16:30.700 --> 00:16:34.210\nSo if I zoom back out you'll see it\nsays I need to configure it before it\n\n351\n00:16:34.210 --> 00:16:35.320\ncan do anything.\n\n352\n00:16:35.320 --> 00:16:39.390\nSo I'm going to right-click on there and\nchoose Configure and Enable Routing and\n\n353\n00:16:39.390 --> 00:16:40.169\nRemote Access.\n\n354\n00:16:41.340 --> 00:16:44.340\nNow again remember, I've already\ngot my network adapter set up.\n\n355\n00:16:44.340 --> 00:16:47.490\nThat's crucial to setting\nthis VPN server up.\n\n356\n00:16:47.490 --> 00:16:48.730\nYou want that done ahead of time.\n\n357\n00:16:48.730 --> 00:16:51.590\nYou want your static IP addresses\nassigned to those network adapters,\n\n358\n00:16:51.590 --> 00:16:54.100\nso that when you run through this,\nit can see them.\n\n359\n00:16:54.100 --> 00:16:57.570\nIt sees which one's on the public side,\nthere's no questions.\n\n360\n00:16:57.570 --> 00:17:02.990\nIf you leave those like DHCP, and then\nyou set this up, it's gonna be confused.\n\n361\n00:17:02.990 --> 00:17:05.390\nAnd then you're gonna have to come\nback and run it again anyway,\n\n362\n00:17:05.390 --> 00:17:08.140\nonce you finally do statically\nassign your IP addresses.\n\n363\n00:17:08.140 --> 00:17:10.350\nI'll go ahead and click Next, and\n\n364\n00:17:10.350 --> 00:17:13.746\nhere's where I've got to tell it\nwhat is it that I'm trying to do.\n\n365\n00:17:13.746 --> 00:17:17.550\nRemote access, dial-up VPN, NAT, VPN and\n\n366\n00:17:17.550 --> 00:17:22.630\nNAT, secure connection between two private\nnetworks, or custom configuration.\n\n367\n00:17:22.630 --> 00:17:24.520\nI'm going to do a couple.\n\n368\n00:17:24.520 --> 00:17:25.640\nI want to do more than one.\n\n369\n00:17:25.640 --> 00:17:27.140\nThese are radio buttons.\n\n370\n00:17:27.140 --> 00:17:28.880\nSo I can only select one.\n\n371\n00:17:28.880 --> 00:17:32.320\nSo I'm going to do a custom configuration,\nthat's gonna allow me,\n\n372\n00:17:32.320 --> 00:17:35.970\nI can zoom back out and\nsee my buttons here, click Next.\n\n373\n00:17:35.970 --> 00:17:39.450\nNow I can choose any combination of,\nrather than just a single one, so\n\n374\n00:17:39.450 --> 00:17:40.730\nyou just choose custom.\n\n375\n00:17:40.730 --> 00:17:45.100\nAnd here I'm gonna do VPN,\nand I'm gonna do LAN routing,\n\n376\n00:17:45.100 --> 00:17:48.730\nthat's what's gonna route the packets from\nthe public to the private, back and forth.\n\n377\n00:17:48.730 --> 00:17:51.790\nWe'll click Next, and then Finish.\n\n378\n00:17:52.830 --> 00:17:56.020\nAnd it will take it a minute, and it will\ntell me that it's ready to be started up.\n\n379\n00:17:56.020 --> 00:18:00.060\nSo we'll go ahead and\nclick Start Service, and\n\n380\n00:18:00.060 --> 00:18:05.560\nwe'll give it just a second to fire up,\nand then we should be good to go.\n\n381\n00:18:08.600 --> 00:18:12.060\nAll right, Routing and Remote Access\nis configured on this server.\n\n382\n00:18:12.060 --> 00:18:13.590\nNormally that expands out on its own.\n\n383\n00:18:13.590 --> 00:18:15.322\nI didn't wanna,\nno we'll go ahead and do it.\n\n384\n00:18:15.322 --> 00:18:20.430\nAll right, and there we go, I can see\nI now have my network interfaces,\n\n385\n00:18:20.430 --> 00:18:24.160\nwhat else, you got your ports, and\nwe're not gonna go through all of this.\n\n386\n00:18:24.160 --> 00:18:28.820\nThis would be more important if you're\nactually setting up a VPN server, choosing\n\n387\n00:18:28.820 --> 00:18:33.390\nthe protocol that you want to allow your\nusers to use to connect, things like that.\n\n388\n00:18:33.390 --> 00:18:38.040\nSome of the important stuff in here,\nsee if I go under IPv4 in General,\n\n389\n00:18:38.040 --> 00:18:40.110\nI can see it sees my two network adapters.\n\n390\n00:18:40.110 --> 00:18:43.460\nIt's got their IP addresses listed there,\nand this is what I was saying earlier.\n\n391\n00:18:43.460 --> 00:18:47.630\nIf you didn't set those up, then it's not\ngonna know which one's facing the public,\n\n392\n00:18:47.630 --> 00:18:48.780\nwhich one's facing the private.\n\n393\n00:18:48.780 --> 00:18:53.400\nIt's gonna have to ask\nyou if these change.\n\n394\n00:18:53.400 --> 00:18:58.450\nJust from personal experience, I have\nfound that if I change IP addresses,\n\n395\n00:18:58.450 --> 00:19:00.650\nsometimes this console doesn't pick it up.\n\n396\n00:19:00.650 --> 00:19:04.420\nAnd I basically have to un-configure\nit and re-configure it.\n\n397\n00:19:04.420 --> 00:19:06.720\nWhich really isn't that hard,\nit's just time.\n\n398\n00:19:06.720 --> 00:19:09.770\nI can always come up here,\nright-click > Disable.\n\n399\n00:19:09.770 --> 00:19:13.030\nAnd what they would do is\nblow away all configuration.\n\n400\n00:19:13.030 --> 00:19:15.980\nAnd then it would have the little\nred downward-pointing arrow again.\n\n401\n00:19:15.980 --> 00:19:18.530\nI'd right-click, Configure Routing and\nRemote Access, and\n\n402\n00:19:18.530 --> 00:19:19.470\nI'd get to go through it again.\n\n403\n00:19:19.470 --> 00:19:21.280\nSo it's not the end of the world, but\n\n404\n00:19:21.280 --> 00:19:25.160\nit is an extra step if you can\njust set that up ahead of time,\n\n405\n00:19:25.160 --> 00:19:28.470\nas far as your network adapters go,\nand you don't have to worry about it.\n\n406\n00:19:28.470 --> 00:19:30.640\nAll right, so that is good to go.\n\n407\n00:19:30.640 --> 00:19:34.140\nAnd then what we need to do is we need\nto start testing some connectivity.\n\n408\n00:19:34.140 --> 00:19:37.730\nCuz there is one thing I left out, I don't\nknow if anybody's picked up on it yet.\n\n409\n00:19:37.730 --> 00:19:42.330\nWe'll find out here in just a second\nif you guys know it in the chat room.\n\n410\n00:19:42.330 --> 00:19:43.360\nLet's see what we can do.\n\n411\n00:19:44.470 --> 00:19:48.350\nI'm going to open up a little\nPowerShell prompt here.\n\n412\n00:19:48.350 --> 00:19:53.150\nAnd I'll adjust that font real quick so\nyou guys can see what I'm typing.\n\n413\n00:19:55.500 --> 00:20:00.440\nAnd I wanna see if I can ping my domain\ncontroller, all right, 10.1.1.10.\n\n414\n00:20:00.440 --> 00:20:04.320\nAnd I have adjusted\nthe firewalls by the way.\n\n415\n00:20:04.320 --> 00:20:09.150\nRemember, 2012 R2 by default\ndoes not allow the echo replies,\n\n416\n00:20:09.150 --> 00:20:10.860\nor the echo requests I should say.\n\n417\n00:20:10.860 --> 00:20:12.550\nSo I have done that ahead of time.\n\n418\n00:20:12.550 --> 00:20:13.580\nYou guys didn't get to see that.\n\n419\n00:20:13.580 --> 00:20:15.880\nSo there you can see\nI've got connectivity, so\n\n420\n00:20:15.880 --> 00:20:18.150\nwe go back over to the drawing,\nthat would be this right here, right?\n\n421\n00:20:18.150 --> 00:20:25.658\nFrom the router to the domain controller,\nfrom the router, can I ping 8.8.8.8?\n\n422\n00:20:25.658 --> 00:20:28.056\nThat'd be a public IP address for\n\n423\n00:20:28.056 --> 00:20:32.980\none of Google's DNS servers I believe,\nif I'm not mistaken.\n\n424\n00:20:32.980 --> 00:20:37.380\nAnd there I can see it, so now that\nwould be this direction here, right, so\n\n425\n00:20:37.380 --> 00:20:38.950\neverything looks good.\n\n426\n00:20:38.950 --> 00:20:41.168\nThen I'm gonna flip over\nto my domain controller.\n\n427\n00:20:44.395 --> 00:20:48.455\nSo I'll go back over to DC01 and\nI'm gonna unlock this guy.\n\n428\n00:20:48.455 --> 00:20:52.560\nAnd you know what Daniel,\nI didn't, see it doesn't work.\n\n429\n00:20:52.560 --> 00:20:59.280\nI was looking up some shortcuts on\nhow to do that with nested VMs.\n\n430\n00:20:59.280 --> 00:21:01.980\nThere's just no way to get that\nkeystroke combination to be sent over\n\n431\n00:21:01.980 --> 00:21:03.812\nthere, evidently.\n\n432\n00:21:03.812 --> 00:21:05.320\nActually, you know what, I lied to you.\n\n433\n00:21:05.320 --> 00:21:07.819\nI did find one way and\nI just remembered it.\n\n434\n00:21:07.819 --> 00:21:08.895\n[LAUGH]\n>> [CROSSTALK] [LAUGH]\n\n435\n00:21:08.895 --> 00:21:10.735\n>> I'll just show you next time, exactly.\n\n436\n00:21:10.735 --> 00:21:12.171\n[LAUGH] Now everybody's going to be like,\nwhat is he going to do?\n\n437\n00:21:12.171 --> 00:21:12.999\n>> What is it?\n\n438\n00:21:12.999 --> 00:21:13.704\n>> What is he gonna do?\n\n439\n00:21:13.704 --> 00:21:15.925\nThat'll make you come back and watch more.\n\n440\n00:21:15.925 --> 00:21:18.473\nAll right, so here I am on my\ndomain controller, same thing,\n\n441\n00:21:18.473 --> 00:21:20.360\nI'm just gonna fire up PowerShell here.\n\n442\n00:21:20.360 --> 00:21:25.810\nAnd I'm going to adjust that font so\neverybody can read what I'm typing.\n\n443\n00:21:27.250 --> 00:21:33.560\nAnd I wanna ping the router 10.1.1.1,\nand that's replying.\n\n444\n00:21:33.560 --> 00:21:37.250\nSo again that's this direction here,\nright?\n\n445\n00:21:37.250 --> 00:21:38.332\nThen I want to try to ping 8.8.8.8.\n\n446\n00:21:39.790 --> 00:21:46.060\n>> We've got a problem Houston.\n\n447\n00:21:46.060 --> 00:21:48.550\n>> Yep, Houston we have a problem.\n\n448\n00:21:48.550 --> 00:21:54.010\nI'm getting request timed out,\nall right, but, that was to be expected.\n\n449\n00:21:54.010 --> 00:21:58.650\nI did that intentionally,\nbecause what's happening right now, and\n\n450\n00:21:58.650 --> 00:22:01.740\nI didn't see anything in the chat room,\nso either nobody's playing along or\n\n451\n00:22:01.740 --> 00:22:04.520\nnobody picked up on it yet.\n\n452\n00:22:04.520 --> 00:22:07.900\nThese guys have private\nIP addresses back here.\n\n453\n00:22:07.900 --> 00:22:10.870\nSometimes we just assume because we're so\n\n454\n00:22:10.870 --> 00:22:15.390\nused to network address translation\nbeing there for us, right.\n\n455\n00:22:15.390 --> 00:22:18.220\nI bring my computer into work,\nit gets a private IP address, but\n\n456\n00:22:18.220 --> 00:22:19.630\nI can connect to the internet.\n\n457\n00:22:19.630 --> 00:22:21.120\nWe don't even think about it.\n\n458\n00:22:21.120 --> 00:22:25.022\nSomebody had to make sure that that router\nor something on the edge was doing network\n\n459\n00:22:25.022 --> 00:22:29.332\naddress translation, because you can't go\nout to the internet with that 10.address.\n\n460\n00:22:29.332 --> 00:22:34.040\nThat's a private address, so let's fix\nthat real quick and it's a simple fix.\n\n461\n00:22:35.250 --> 00:22:39.380\nWe will flip back over to RTR, and\n\n462\n00:22:39.380 --> 00:22:43.490\none of the other things that I\ncould add to my router was NAT.\n\n463\n00:22:43.490 --> 00:22:45.260\nI didn't check it during\nthat wizard write,\n\n464\n00:22:45.260 --> 00:22:48.580\njust to kind of see if I could trip you\nguys up a bit, but we're gonna do it now.\n\n465\n00:22:48.580 --> 00:22:53.060\nSo I'm gonna right-click, not on there,\nbut right below that on General, and\n\n466\n00:22:53.060 --> 00:22:54.450\nchoose New Routing Protocol.\n\n467\n00:22:55.600 --> 00:22:59.140\nAnd we're gonna do NAT,\nnetwork address translation, and\n\n468\n00:22:59.140 --> 00:23:01.770\nwe'll click OK, and it takes it a minute.\n\n469\n00:23:01.770 --> 00:23:06.990\nAnd we'll end up seeing NAT\npop up as another protocol\n\n470\n00:23:06.990 --> 00:23:10.700\nthat this guy's allowed to speak,\nor now understands.\n\n471\n00:23:10.700 --> 00:23:11.600\nBut we're not done yet,\n\n472\n00:23:11.600 --> 00:23:16.410\nwe still have to configure the interfaces\nto use network address translation.\n\n473\n00:23:16.410 --> 00:23:17.430\nHe has to listen, right, or\n\n474\n00:23:17.430 --> 00:23:20.690\nhe has to be ready when that packet\ncomes in with that private IP address.\n\n475\n00:23:20.690 --> 00:23:25.146\nHe has to go, I'm supposed to\ndo something with that, right?\n\n476\n00:23:25.146 --> 00:23:28.360\nSo trying to use the force here,\nmake it go a little faster.\n\n477\n00:23:28.360 --> 00:23:31.190\n>> Throw some ash and\nchicken bones at it or something.\n\n478\n00:23:31.190 --> 00:23:33.850\n>> Yeah.\n[LAUGH] So NAT'll pop up, and\n\n479\n00:23:33.850 --> 00:23:38.350\nthen it's simply telling it, again,\nwhat network adapters are going to be\n\n480\n00:23:38.350 --> 00:23:41.410\nperforming the network\naddress translation.\n\n481\n00:23:41.410 --> 00:23:45.510\nAnd in the end it's actually both,\nright, which sometimes confuses people.\n\n482\n00:23:45.510 --> 00:23:47.800\nSo I'm gonna right-click on NAT and\nchoose New Interface.\n\n483\n00:23:47.800 --> 00:23:49.930\nNotice none are listed by default.\n\n484\n00:23:49.930 --> 00:23:52.629\nNew Interface, and you know what?\n\n485\n00:23:52.629 --> 00:23:55.296\nI've got to remember which one is which.\n\n486\n00:23:55.296 --> 00:23:57.046\nSo let's double check that real quick.\n\n487\n00:23:57.046 --> 00:24:00.170\nAlways better to double check\nthan to pick the wrong one.\n\n488\n00:24:00.170 --> 00:24:01.740\n>> Measure twice, cut once they say.\n\n489\n00:24:01.740 --> 00:24:03.904\n>> That's right.\nSo ethernet is my public,\n\n490\n00:24:03.904 --> 00:24:09.562\nethernet 2 is my private, all right, so\nethernet 2 is private, remember that.\n\n491\n00:24:09.562 --> 00:24:13.962\nNew interface, and we're going to take\nthat private one first, then click OK.\n\n492\n00:24:13.962 --> 00:24:16.355\nIt honestly wouldn't matter\nwhat order you did it in,\n\n493\n00:24:16.355 --> 00:24:18.861\nbecause you get to choose\nright here what it's gonna do.\n\n494\n00:24:18.861 --> 00:24:22.251\nAnd you can see private interface\nconnected to the private network.\n\n495\n00:24:22.251 --> 00:24:23.678\nAnd I'll click OK.\n\n496\n00:24:23.678 --> 00:24:27.132\nSo now it knows which side is gonna\nhave the private IP addresses\n\n497\n00:24:27.132 --> 00:24:29.228\ncoming in that it needs to translate.\n\n498\n00:24:29.228 --> 00:24:33.176\nThen we're gonna right-click on\nthat again, New Interface, and\n\n499\n00:24:33.176 --> 00:24:37.068\nthis time I'll choose ethernet,\nwhich was my public facing one.\n\n500\n00:24:37.068 --> 00:24:39.696\nAnd I'm gonna tell it this\nis the public side, and\n\n501\n00:24:39.696 --> 00:24:42.387\nI want to enable NAT on that interface,\nall right,\n\n502\n00:24:42.387 --> 00:24:46.740\nbecause the public side is where\nthe translation is actually occurring.\n\n503\n00:24:46.740 --> 00:24:48.040\nWe'll click OK.\n\n504\n00:24:48.040 --> 00:24:49.950\nNow it knows what to do.\n\n505\n00:24:49.950 --> 00:24:52.620\nAnd let's see if that solved our problem.\n\n506\n00:24:52.620 --> 00:24:55.930\nWe will flip back over to DC one.\n\n507\n00:24:57.720 --> 00:25:03.126\nWe're going to try to ping .8 .8 .8 again,\nand it's like magic, it's working.\n\n508\n00:25:03.126 --> 00:25:04.338\n>> Hercules.\n\n509\n00:25:04.338 --> 00:25:05.836\n[LAUGH] Very good Mike.\n\n510\n00:25:05.836 --> 00:25:09.425\n>> [LAUGH] So now we've got\nrouting remote access set up,\n\n511\n00:25:09.425 --> 00:25:14.287\nit's ready to be a VPN end point,\nI'm gonna go ahead and close that, and\n\n512\n00:25:14.287 --> 00:25:19.000\nwe'll flip back over to that\nrouting remote access server.\n\n513\n00:25:19.000 --> 00:25:20.690\nSo at this point it's ready to go.\n\n514\n00:25:20.690 --> 00:25:24.770\nNow, again we really haven't\nset up the VPN, right,\n\n515\n00:25:24.770 --> 00:25:26.420\nbecause that's going to come later.\n\n516\n00:25:26.420 --> 00:25:30.980\nAs we progress through these episodes,\nwe're getting everything ready on our end\n\n517\n00:25:30.980 --> 00:25:34.200\nso that by the time we do move\nout to the cloud, and we say hey,\n\n518\n00:25:34.200 --> 00:25:39.120\nwe want to extend Active Directory out\nthere to Azure, it can see our network,\n\n519\n00:25:39.120 --> 00:25:41.190\nit can create that site\nto site to tunnel for\n\n520\n00:25:41.190 --> 00:25:45.020\nme, it can find everything it needs,\nand it just happens, right?\n\n521\n00:25:45.020 --> 00:25:49.460\nYou don't wanna do that part first,\nhave it not find anything, then come and\n\n522\n00:25:49.460 --> 00:25:52.700\nset all this up and\nthen have to fix it, right?\n\n523\n00:25:52.700 --> 00:25:56.840\nGet everything ready first,\nthen when you move to the cloud portion,\n\n524\n00:25:56.840 --> 00:26:00.940\neverything should just fall in a place,\nand it's gonna be a lot easier for\n\n525\n00:26:00.940 --> 00:26:04.352\nyou if you do it that way,\n>> Yeah one of the definite benefits of\n\n526\n00:26:04.352 --> 00:26:08.367\nus doing it that way, starting from\nground up, building the anchor directory,\n\n527\n00:26:08.367 --> 00:26:12.439\nbuilding routing remote access server,\nI can say that, get that out of my mouth,\n\n528\n00:26:12.439 --> 00:26:16.158\nis that not only are we making sure\nthat everything is set up correctly, but\n\n529\n00:26:16.158 --> 00:26:17.482\nnow we know this network.\n\n530\n00:26:17.482 --> 00:26:20.582\nYou as the viewer,\nyou're watching this happen in real time.\n\n531\n00:26:20.582 --> 00:26:23.948\nWe're using the same servers\nthroughout this series, so you can see,\n\n532\n00:26:23.948 --> 00:26:27.583\nI know what's going on in that active\ndirectory, I know what's going on in that\n\n533\n00:26:27.583 --> 00:26:31.540\nrouting remote access server, I know how\nit's setup and I know how we got there.\n\n534\n00:26:31.540 --> 00:26:34.100\nSo everything starts to make sense,\nwe're kinda giving you a context\n\n535\n00:26:34.100 --> 00:26:37.700\nalong with it so it can be very,\nvery helpful in the learning phase.\n\n536\n00:26:37.700 --> 00:26:39.090\n>> Absolutely.\n>> So Mike, where are we at now?\n\n537\n00:26:39.090 --> 00:26:39.980\nWhat else do we have to do?\n\n538\n00:26:39.980 --> 00:26:41.950\n>> We're good to go,\nI think, for this one.\n\n539\n00:26:41.950 --> 00:26:44.950\nOur next episode we're gonna start\nsetting up Active Directory.\n\n540\n00:26:44.950 --> 00:26:48.320\nRemember we've got it installed, but\nwe really haven't done much with it.\n\n541\n00:26:48.320 --> 00:26:49.840\nI'll give you a little teaser.\n\n542\n00:26:49.840 --> 00:26:53.740\nWe're gonna dive in to Active Directory\nsites and services and\n\n543\n00:26:53.740 --> 00:26:56.710\nget that side ready for\nthis connection out to Azure.\n\n544\n00:26:56.710 --> 00:26:57.550\n>> Looking forward to it.\n\n545\n00:26:57.550 --> 00:27:01.525\nThank you so much for stopping by and\nshowing these concepts to us,\n\n546\n00:27:01.525 --> 00:27:04.125\nand showing us how to set\nup the router server.\n\n547\n00:27:04.125 --> 00:27:05.915\nThat's always a good thing to know, and\n\n548\n00:27:05.915 --> 00:27:08.955\nwe're building up to getting\nthe site to site VPN and everything.\n\n549\n00:27:08.955 --> 00:27:10.365\nIt's going to be a lot of fun.\n\n550\n00:27:10.365 --> 00:27:11.655\nWe thank you guys for watching.\n\n551\n00:27:11.655 --> 00:27:13.795\nWe look forward to seeing you\non our upcoming episodes.\n\n552\n00:27:13.795 --> 00:27:16.199\nSigning off for IT Pro TV,\nI've been your host Daniel Lowery.\n\n553\n00:27:16.199 --> 00:27:17.011\n>> And I'm Mike Roderick.\n\n554\n00:27:17.011 --> 00:27:19.136\n>> And we'll see you next time.\n\n555\n00:27:19.136 --> 00:27:26.060\n[MUSIC]\n\n",
          "vimeoId": "154908635"
        },
        {
          "description": "In this episode, Daniel and Mike show you how to prepare your sites for replication from your on-premises Active Directory to your AD in Azure. They start by configuring the on-premises site and then repeat the process in their Azure environment. Finally they configure the site link which will be used to connect the two sites together.",
          "length": "1395",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-4-configuring_ad_vpn_sites-02091-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-4-configuring_ad_vpn_sites-02091-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-1-4-configuring_ad_vpn_sites-02091-1-sm.jpg",
          "title": "Configuring AD Sites",
          "transcript": "WEBVTT\n\n1\n00:00:00.002 --> 00:00:10.002\n[MUSIC]\n\n2\n00:00:12.001 --> 00:00:16.343\nAll right, greetings everyone and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.343 --> 00:00:19.763\nI'm your host Daniel Lowrie and\nin today's episode, well,\n\n4\n00:00:19.763 --> 00:00:22.612\nwe're continuing on with our AD and\nAzure series.\n\n5\n00:00:22.612 --> 00:00:26.268\nHopefully you guys have been enjoying this\nso far and joining us back in the studio\n\n6\n00:00:26.268 --> 00:00:29.171\ntoday, well he's the guy that's\nbeen moving the plan along and\n\n7\n00:00:29.171 --> 00:00:31.200\nthat's our good friend Mr. Mike Rodrick.\n\n8\n00:00:31.200 --> 00:00:32.250\nMike, welcome back to the show.\n\n9\n00:00:32.250 --> 00:00:33.250\nWe're glad to have you.\n\n10\n00:00:33.250 --> 00:00:34.060\nHow you doing today?\n\n11\n00:00:34.060 --> 00:00:35.000\n>> I'm doing fantastic.\n\n12\n00:00:35.000 --> 00:00:37.560\nExcited as always cuz we're\ntalking about Active Directory,\n\n13\n00:00:37.560 --> 00:00:40.090\none of my favorite things and\nas Daniel said,\n\n14\n00:00:40.090 --> 00:00:44.550\nwe're gonna be extending our on premises\nactive directory out to the cloud.\n\n15\n00:00:44.550 --> 00:00:47.910\nSo far we've gotten some of\nthe ground work laid to perform this.\n\n16\n00:00:47.910 --> 00:00:52.120\nRight, we've got active directory\ninstalled, in a previous episode we've got\n\n17\n00:00:52.120 --> 00:00:57.500\nour routing remote access set up, so\nour core print network now has Internet\n\n18\n00:00:57.500 --> 00:01:01.700\naccess, that routing remote access\nserver is performing the routing and\n\n19\n00:01:01.700 --> 00:01:05.300\nit's performing the network address\ntranslation, and it's also a VPN endpoint\n\n20\n00:01:05.300 --> 00:01:09.970\nand that's gonna come into play in a\nlittle bit when we start tying into Azure.\n\n21\n00:01:09.970 --> 00:01:14.360\nAs I've said a couple times, we're gonna\nend up creating a site to site VPN\n\n22\n00:01:14.360 --> 00:01:18.350\nout to Azure, which is gonna make, that\nway that our domain control that we put\n\n23\n00:01:18.350 --> 00:01:22.150\nout in our Azure can go across that site,\ndecide VPN, replicate with our on premises\n\n24\n00:01:22.150 --> 00:01:26.710\ndomain controllers, really just like it\nwas another one of our physical locations.\n\n25\n00:01:26.710 --> 00:01:31.380\nI mean, that's really what it boils down\nto is it becomes another location for\n\n26\n00:01:31.380 --> 00:01:32.030\nyour network.\n\n27\n00:01:32.030 --> 00:01:36.150\nThat's why we said you could do\nbasically disaster recovery, you know,\n\n28\n00:01:36.150 --> 00:01:40.190\nand I think we've dispelled,\nhopefully dispelled a lot of the fears\n\n29\n00:01:40.190 --> 00:01:42.970\nabout the security in putting\nactive directory out there.\n\n30\n00:01:42.970 --> 00:01:46.420\nYou know, again just to say it\none more time, I mean Microsoft's\n\n31\n00:01:46.420 --> 00:01:50.680\ndata centers have been certified by just\nabout every certification out there.\n\n32\n00:01:50.680 --> 00:01:53.680\nThese guys, I think even in one\nof their articles they say,\n\n33\n00:01:53.680 --> 00:01:56.290\nyou know,\nphysical security that could stop a tank.\n\n34\n00:01:56.290 --> 00:01:59.350\nSo I think they probably have\nbetter security than I do\n\n35\n00:01:59.350 --> 00:02:00.860\non my own corporate network.\n\n36\n00:02:00.860 --> 00:02:03.251\nI would just probably not,\nI shouldn't say that.\n\n37\n00:02:03.251 --> 00:02:04.444\n>> [LAUGH]\n>> [LAUGH] But\n\n38\n00:02:04.444 --> 00:02:07.400\na lot of times they've got the resources,\nthey have the capital.\n\n39\n00:02:07.400 --> 00:02:08.570\nAnyway, let's change subjects.\n\n40\n00:02:08.570 --> 00:02:10.510\nWe'll get back on our next phase.\n\n41\n00:02:10.510 --> 00:02:13.820\nI'll pull up this drawing again so\nI can refresh where we're at.\n\n42\n00:02:13.820 --> 00:02:15.930\nWe've got our domain\ncontrollers set up back here.\n\n43\n00:02:15.930 --> 00:02:18.340\nSo we've got our corporate network.\n\n44\n00:02:18.340 --> 00:02:20.460\nWe've got our routers set up.\n\n45\n00:02:20.460 --> 00:02:24.470\nThis is basically a 10.1.1.0/24 back here.\n\n46\n00:02:24.470 --> 00:02:28.810\nWe've got our routers set up and\nit's acting as a VP and M point.\n\n47\n00:02:28.810 --> 00:02:31.560\nNow we haven't done\nanything out to Azure yet.\n\n48\n00:02:31.560 --> 00:02:36.140\nWe still have a couple of things that we\nwant to do internally before we reach out\n\n49\n00:02:36.140 --> 00:02:41.300\nand touch the cloud and that is going\nto be done on our domain controller and\n\n50\n00:02:41.300 --> 00:02:44.290\nit's going to involve configuring sites.\n\n51\n00:02:44.290 --> 00:02:47.050\nNow, if you're not familiar\nwith active directory and\n\n52\n00:02:47.050 --> 00:02:49.350\nsites let's do a little\nbit of a refresher.\n\n53\n00:02:49.350 --> 00:02:53.630\nRight, when we talked about Active\nDirectory, Aftive Direc, blah, blah, blah,\n\n54\n00:02:53.630 --> 00:02:54.720\nif I could that there [LAUGH].\n\n55\n00:02:54.720 --> 00:02:56.294\n>> It's still Microsoft terminology, Mike.\n\n56\n00:02:56.294 --> 00:02:57.307\n[LAUGH]\n>> It is, right?\n\n57\n00:02:57.307 --> 00:03:02.397\n[LAUGH] Active Directory is what we call,\nit uses a multi-master with\n\n58\n00:03:02.397 --> 00:03:08.640\nloose convergence for replication,\nmeaning that all copies are writable.\n\n59\n00:03:08.640 --> 00:03:10.620\nExcept for\nthe read only domain controllers right,\n\n60\n00:03:10.620 --> 00:03:12.160\nwe don't think about those guys.\n\n61\n00:03:12.160 --> 00:03:16.600\nAnd they have replication, any changes\nmade on one domain controller are gonna\n\n62\n00:03:16.600 --> 00:03:19.210\nreplicate to all the other\ndomain controllers.\n\n63\n00:03:19.210 --> 00:03:23.220\nAnd within a site, that's the knowledge\nconsistency checker that sets up\n\n64\n00:03:23.220 --> 00:03:26.100\nthe replication topology\nbetween the domain controllers.\n\n65\n00:03:26.100 --> 00:03:29.910\nAs we add additional domain controllers,\nit will reconfigure the topology,\n\n66\n00:03:29.910 --> 00:03:32.580\nmaking sure that we have a fast and\n\n67\n00:03:32.580 --> 00:03:36.940\nredundant revocation topology\nbetween those domain controllers.\n\n68\n00:03:36.940 --> 00:03:39.210\nAnd replication occurs very quickly.\n\n69\n00:03:39.210 --> 00:03:43.770\nChange notification, you make a change\nin Active Directory, it notifies its\n\n70\n00:03:43.770 --> 00:03:47.450\ndirector application partners, and that\ndomain controller turns around and says,\n\n71\n00:03:47.450 --> 00:03:50.440\nokay, I see you got some\nchanges that I don't have.\n\n72\n00:03:50.440 --> 00:03:55.020\nWill you send them to me, and\nthat replication's gonna occur and\n\n73\n00:03:55.020 --> 00:03:58.930\nthere's no more than three hops\nbetween any two domain controller's\n\n74\n00:03:58.930 --> 00:04:02.120\nthanks to the KCC,\nthe knowledge consistency checker\n\n75\n00:04:02.120 --> 00:04:06.780\nwhich means within a couple of minutes any\nchange that I make in active directory\n\n76\n00:04:06.780 --> 00:04:09.280\nwill be replicated to all of\nthe other domain controllers.\n\n77\n00:04:09.280 --> 00:04:10.490\nIt's very fast.\n\n78\n00:04:10.490 --> 00:04:14.740\nAnd if it's on the local area network, if\nwe're all in the same local area network\n\n79\n00:04:14.740 --> 00:04:16.990\nI'm okay with that, right,\nI've got the bandwidth,\n\n80\n00:04:16.990 --> 00:04:20.530\nI'm okay with replicating those\nchanges soon as they occur.\n\n81\n00:04:20.530 --> 00:04:25.180\nWe open up a second office across town or\nin another city, another state,\n\n82\n00:04:25.180 --> 00:04:26.450\nanother country.\n\n83\n00:04:26.450 --> 00:04:28.530\nI've got domain controllers over there.\n\n84\n00:04:28.530 --> 00:04:32.220\nWell, we need replication to occur,\nright, if I create a new user account\n\n85\n00:04:32.220 --> 00:04:35.220\nit needs to be available on\nthose other domain controllers.\n\n86\n00:04:35.220 --> 00:04:38.240\nBut now we're going across\nthe to replicate, right?\n\n87\n00:04:38.240 --> 00:04:41.470\nAnd I don't need, or\nI usually can't afford that\n\n88\n00:04:41.470 --> 00:04:46.520\nquick fast replication that occurs\nwithin my local area network.\n\n89\n00:04:46.520 --> 00:04:49.100\nSo that's where sites come into play.\n\n90\n00:04:49.100 --> 00:04:54.790\nIn active directory, we use a site\nto define boundaries on our network.\n\n91\n00:04:54.790 --> 00:04:58.300\nThat have high speed\nreliable connectivity.\n\n92\n00:04:58.300 --> 00:05:01.070\nImagine us, we've got an office\nhere in Gainesville, Florida.\n\n93\n00:05:01.070 --> 00:05:05.140\nI've got another office over there\nin Pensacola, Florida, right?\n\n94\n00:05:05.140 --> 00:05:08.860\nWithin Gainesville,\ngood high speed connectivity, so\n\n95\n00:05:08.860 --> 00:05:12.930\nI'm okay with those domain controllers\nhere replicating quickly and often.\n\n96\n00:05:12.930 --> 00:05:16.850\nAt the Pensacola location, good high\nspeed connectivity within that office.\n\n97\n00:05:16.850 --> 00:05:20.090\nThose domain controllers, I've got two\ndomain controllers in each location, those\n\n98\n00:05:20.090 --> 00:05:24.250\ntwo domain controllers they can replicate\nwith each quickly, often, that's fine.\n\n99\n00:05:24.250 --> 00:05:27.620\nBut when a change has to replicate\nfrom Gainesville to Pensacola,\n\n100\n00:05:27.620 --> 00:05:29.880\nthat's the replication I need to control.\n\n101\n00:05:29.880 --> 00:05:34.180\nBecause, during the day, I've got\nusers using the Internet bandwidth,\n\n102\n00:05:34.180 --> 00:05:37.880\nconsuming that, needing to access\nresources to perform their job.\n\n103\n00:05:37.880 --> 00:05:41.110\nI can't have active directory\nreplication soaking up all of that\n\n104\n00:05:41.110 --> 00:05:42.350\navailable bandwidth.\n\n105\n00:05:42.350 --> 00:05:45.420\nSo, we define Gainesville as a site.\n\n106\n00:05:45.420 --> 00:05:48.310\nWe define Pensacola as a site.\n\n107\n00:05:48.310 --> 00:05:49.630\nNow within the Gainesville site,\n\n108\n00:05:49.630 --> 00:05:51.990\nthose domain controllers can\nreplicate all they want.\n\n109\n00:05:51.990 --> 00:05:55.200\nWithin Pensacola site, those domain\ncontrollers can replicate all they want.\n\n110\n00:05:55.200 --> 00:05:58.370\nBetween the sites,\nit occurs when I say, right?\n\n111\n00:05:58.370 --> 00:06:02.410\nI can tell it when it's allowed to\nreplicate, like not between 8 and 5,\n\n112\n00:06:02.410 --> 00:06:05.450\nand I can also say how\noften it replicates.\n\n113\n00:06:05.450 --> 00:06:10.010\nBy default, it's every 180\nminutes every three hours and\n\n114\n00:06:10.010 --> 00:06:11.850\nit doesn't use change notification.\n\n115\n00:06:11.850 --> 00:06:15.580\nIt waits for three hours and\nthen checks to see if there's any changes.\n\n116\n00:06:15.580 --> 00:06:19.110\nSo the changes don't replicate over\nas fast, which might be a problem.\n\n117\n00:06:19.110 --> 00:06:21.380\nYou know it depends on your network and\nyour needs.\n\n118\n00:06:21.380 --> 00:06:23.430\nSo you can actually adjust those.\n\n119\n00:06:23.430 --> 00:06:27.240\nBut the point is within a site,\nreplication occurs frequently,\n\n120\n00:06:27.240 --> 00:06:28.620\noften, very quickly.\n\n121\n00:06:28.620 --> 00:06:30.950\nBetween sites, we can control it.\n\n122\n00:06:30.950 --> 00:06:34.570\nI can specify how often and\nwhen they're allowed to do that.\n\n123\n00:06:34.570 --> 00:06:39.300\nSo that's what we're doing here is we're\ncreating a site for that Azure network.\n\n124\n00:06:39.300 --> 00:06:43.809\nWhen we go up there and create a network\nin Azure we're going to define that as\n\n125\n00:06:43.809 --> 00:06:47.122\na site as part of my active\ndirectory domain services and\n\n126\n00:06:47.122 --> 00:06:51.915\nI can control that replication between my\non premises domain controllers In that\n\n127\n00:06:51.915 --> 00:06:53.554\nAzure domain controller.\n\n128\n00:06:53.554 --> 00:06:57.880\nAll right, and as I said earlier, we wanna\nset this up before we touch the cloud.\n\n129\n00:06:57.880 --> 00:07:00.660\nNotice we haven't done anything\nout there in Azure just yet.\n\n130\n00:07:00.660 --> 00:07:03.680\nAnd I'd be thinking, why the heck do they\ncall this show Active Directory in Azure?\n\n131\n00:07:03.680 --> 00:07:05.320\nI haven't seen it at all.\n\n132\n00:07:05.320 --> 00:07:09.980\nWell, we wanna get all this set up ahead\nof time because once I go out to Azure and\n\n133\n00:07:09.980 --> 00:07:14.680\nI create that domain controller,\nas soon as I set all of that up, one,\n\n134\n00:07:14.680 --> 00:07:17.420\nit's gonna need to talk to\nmy domain controller to add\n\n135\n00:07:17.420 --> 00:07:19.990\nanother domain controller\nto an existing domain.\n\n136\n00:07:19.990 --> 00:07:24.220\nTwo, the KCC is gonna want to\nset up replication topology.\n\n137\n00:07:24.220 --> 00:07:28.590\nAnd in this case it's actually gonna\nbe the KCC calling upon the intersite\n\n138\n00:07:28.590 --> 00:07:31.930\ntopology generator because\nit's gonna be between sites.\n\n139\n00:07:31.930 --> 00:07:34.620\nBut if that link isn't up yet,\nthen it's gonna fail, right,\n\n140\n00:07:34.620 --> 00:07:36.790\nit's not gonna be able to\ndo what it wants to do.\n\n141\n00:07:36.790 --> 00:07:38.620\nIt's gonna throw all kinds of errors.\n\n142\n00:07:38.620 --> 00:07:42.300\nWe eventually get that set up and\nwe can get it fixed, but why?\n\n143\n00:07:42.300 --> 00:07:46.036\nWhy not have it all ready, that way when\nyou set up the domain controller it's\n\n144\n00:07:46.036 --> 00:07:48.755\nhappy as can be and\nit just starts replicating, right?\n\n145\n00:07:48.755 --> 00:07:51.107\n>> That's right, as they say,\nthere's many ways to skin a cat, and\n\n146\n00:07:51.107 --> 00:07:52.671\nthen there's the right\nway to skin the cat.\n\n147\n00:07:52.671 --> 00:07:55.304\n>> [LAUGH]\n>> And in this case, that is setting up\n\n148\n00:07:55.304 --> 00:08:00.089\nall this stuff Beforehand, put the cart\nwhere the cart goes and the horse where\n\n149\n00:08:00.089 --> 00:08:05.110\nthe horse goes so that everything works\nas well as possible, should I say.\n\n150\n00:08:05.110 --> 00:08:08.930\nAnd we don't want to get to where we have\nto try to go back and fix something.\n\n151\n00:08:08.930 --> 00:08:14.670\nWe want it all to work and if we have the\nluxury of being ahead of the game, right?\n\n152\n00:08:14.670 --> 00:08:18.730\nWe can say, all right, we're not ready\nto connect to the cloud and Azure,\n\n153\n00:08:18.730 --> 00:08:23.410\nbut we can go ahead and get out\non-premises equipment ready to go and\n\n154\n00:08:23.410 --> 00:08:25.200\nthat way everything just works\nas smoothly as possible.\n\n155\n00:08:25.200 --> 00:08:29.130\nThat's what we're trying to setup for you,\nand Mike, now that we're jumping into\n\n156\n00:08:29.130 --> 00:08:32.820\nsizing servers this obviously is not\nsomething that we tend to work a lot in.\n\n157\n00:08:32.820 --> 00:08:36.640\nI've worked in Microsoft\nadministration for many years now and\n\n158\n00:08:36.640 --> 00:08:38.410\nI hardly ever had to ever go to sites and\nservices.\n\n159\n00:08:38.410 --> 00:08:39.880\nBut this is one of those times.\n\n160\n00:08:39.880 --> 00:08:42.450\n>> It really does depend\non your enterprise network.\n\n161\n00:08:42.450 --> 00:08:46.810\nIf you are a single location,\nyou'll never use sites and services.\n\n162\n00:08:46.810 --> 00:08:47.950\nThere's no need to.\n\n163\n00:08:47.950 --> 00:08:50.260\nThere's no need to\ncontrol that replication.\n\n164\n00:08:50.260 --> 00:08:54.160\nAs soon as you move to more than\none geographical location and\n\n165\n00:08:54.160 --> 00:08:56.950\nyou don't have a dedicated\nfast link between the two,\n\n166\n00:08:56.950 --> 00:08:59.290\nthat's typically when we start\ngetting into sites and services.\n\n167\n00:08:59.290 --> 00:09:02.810\nSo let's take a peek and\nsee what we can do.\n\n168\n00:09:02.810 --> 00:09:04.450\nI'm on my domain controller here.\n\n169\n00:09:04.450 --> 00:09:07.240\nGood old DC1, and\nI'm going to go to my Tools menu, and\n\n170\n00:09:07.240 --> 00:09:12.030\nServer Manager, then open up\nActiveDirectory, Sites and Services.\n\n171\n00:09:12.030 --> 00:09:16.470\nAnd we'll open this up, and even if like I\nsaid if you're a single physical location,\n\n172\n00:09:16.470 --> 00:09:20.020\nyou might never even open this console up.\n\n173\n00:09:20.020 --> 00:09:23.540\nBut even if you never do,\nyou do have a site.\n\n174\n00:09:23.540 --> 00:09:27.730\nWhen you install ActiveDirectory\nit creates the first site, and\n\n175\n00:09:27.730 --> 00:09:31.240\nevery domain controller created\nthereafter just goes into that site.\n\n176\n00:09:31.240 --> 00:09:34.960\nAnd because you only have that one\nphysical location, you don't care.\n\n177\n00:09:34.960 --> 00:09:38.230\nAs soon as you bring up another location,\nthat's when we have to come in here and\n\n178\n00:09:38.230 --> 00:09:40.300\nstart moving things around,\nand start defining.\n\n179\n00:09:40.300 --> 00:09:43.630\nLetting ActiveDirectory know\nour physical layout, right?\n\n180\n00:09:43.630 --> 00:09:46.980\nCuz remember,\na domain is a logical boundary.\n\n181\n00:09:46.980 --> 00:09:51.610\nI can have a single domain that has\nsome people here in Gainesville,\n\n182\n00:09:51.610 --> 00:09:54.570\nother people in Tampa,\nother people in Tokyo.\n\n183\n00:09:54.570 --> 00:09:57.200\nAnd all those people can be\na part of this same domain.\n\n184\n00:09:57.200 --> 00:09:59.180\nThey don't have to be\nphysically located together.\n\n185\n00:09:59.180 --> 00:10:01.110\nA domain is a logical boundary.\n\n186\n00:10:01.110 --> 00:10:02.370\nBut there definitely is some differences.\n\n187\n00:10:02.370 --> 00:10:06.210\nIf I have a domain controller\nhere in Gainesville,\n\n188\n00:10:06.210 --> 00:10:09.920\nthose people in Tokyo, their traffic is\ngoing to have to go all the way across\n\n189\n00:10:09.920 --> 00:10:12.050\nthat WAN to get to that domain controller.\n\n190\n00:10:12.050 --> 00:10:15.740\nOr I can put a domain controller\nover there in Tokyo but now, again,\n\n191\n00:10:15.740 --> 00:10:21.490\nI've got to worry about the replication\nbecause of the geographic distance or\n\n192\n00:10:21.490 --> 00:10:24.140\ndisparity between those\ntwo physical locations.\n\n193\n00:10:24.140 --> 00:10:25.925\nSo all right, enough of that.\n\n194\n00:10:25.925 --> 00:10:29.419\nLet's get, shut up Mike and\nlet's actually do it.\n\n195\n00:10:29.419 --> 00:10:34.730\nSo here I am in Active Directory,\nSites and Services.\n\n196\n00:10:34.730 --> 00:10:37.250\nYou'll see that there is\na Default-First-Site-Name.\n\n197\n00:10:37.250 --> 00:10:40.750\nThat is actually the name that\nMicrosoft gives your first site.\n\n198\n00:10:40.750 --> 00:10:45.350\nIt is the Default-First-Site-Name and\nif we expand this out and\n\n199\n00:10:45.350 --> 00:10:49.140\nI take a look at servers, I'll see\nmy domain controllers sitting there.\n\n200\n00:10:49.140 --> 00:10:52.770\nIf you had more than one,\nthey'd all be listed right here.\n\n201\n00:10:52.770 --> 00:10:56.340\nRemember, sites and services is only\nconcerned with domain controllers.\n\n202\n00:10:56.340 --> 00:10:59.290\nYou won't see other member servers,\nfile server, print servers,\n\n203\n00:10:59.290 --> 00:11:02.200\nthings like that,\nonly the main control show up in here.\n\n204\n00:11:02.200 --> 00:11:05.730\nSo the first thing I'm going to do\nis I'm gonna rename this because\n\n205\n00:11:05.730 --> 00:11:08.890\nif I'm a single site,\nI never open this console, I don't care.\n\n206\n00:11:08.890 --> 00:11:10.120\nCall it what you want.\n\n207\n00:11:10.120 --> 00:11:11.610\nOnce I start adding multiple sites,\n\n208\n00:11:11.610 --> 00:11:13.970\nthough, I need to be able to\ndifferentiate between them.\n\n209\n00:11:13.970 --> 00:11:18.510\nI want it to make some sense to me, so\nthis does not make any sense to me.\n\n210\n00:11:18.510 --> 00:11:23.460\nSo I'm gonna rename that and\nI'm gonna call this GNV.\n\n211\n00:11:23.460 --> 00:11:26.840\nNow site names are registered\nwith DNS records.\n\n212\n00:11:26.840 --> 00:11:31.210\nWhen you're, like, the main controllers\nfor example, register their SRV records,\n\n213\n00:11:31.210 --> 00:11:33.020\ntheir service locator records.\n\n214\n00:11:33.020 --> 00:11:35.080\nThey register each service twice.\n\n215\n00:11:35.080 --> 00:11:37.770\nOnce just as hey, I'm DCO 1 and\n\n216\n00:11:37.770 --> 00:11:40.380\nI'm running Kerberos,\nmake a DNS record for me.\n\n217\n00:11:40.380 --> 00:11:46.200\nAgain as hey, I'm DCO 1 in site GNV and\nI'm running Kerberos, right?\n\n218\n00:11:46.200 --> 00:11:49.750\nOne record is generic,\none record is site specific.\n\n219\n00:11:49.750 --> 00:11:54.470\nSo because of that, your site names\ndo have to follow DNS rules, right?\n\n220\n00:11:54.470 --> 00:11:58.173\nSo that means no special characters,\nno spaces.\n\n221\n00:11:58.173 --> 00:12:01.780\nAll right, so now I've got gnv,\nwe're good to go there.\n\n222\n00:12:01.780 --> 00:12:05.650\nThe next thing I need to do is\nreally create some sub nets.\n\n223\n00:12:05.650 --> 00:12:10.250\nBecause I can create the site gnv,\nbut how does the system know?\n\n224\n00:12:10.250 --> 00:12:13.580\nHow does Active Directory\nknow what GNV is?\n\n225\n00:12:13.580 --> 00:12:14.760\nIt doesn't have a map.\n\n226\n00:12:14.760 --> 00:12:16.620\nIt can't go look up\nthe state of Florida and\n\n227\n00:12:16.620 --> 00:12:19.010\nsee where Gainesville is and\ngo, there it is.\n\n228\n00:12:19.010 --> 00:12:22.060\nWe use subnets to define sites.\n\n229\n00:12:22.060 --> 00:12:27.010\nSo we will use different subnets\nin different physical locations.\n\n230\n00:12:27.010 --> 00:12:29.260\nLike my example earlier,\nI've got an office in Gainesville and\n\n231\n00:12:29.260 --> 00:12:30.192\nan office in Pensacola.\n\n232\n00:12:30.192 --> 00:12:37.156\nWell, in Gainesville we might\nuse 10.1.1.0/24, 10.1.2.0/24.\n\n233\n00:12:37.156 --> 00:12:39.600\nIn Pensacola we use 10.1.3/24, right.\n\n234\n00:12:40.620 --> 00:12:42.790\nAnd I define that in here and\n\n235\n00:12:42.790 --> 00:12:46.720\nI let it know anything with a 10.1.3\naddress, that's the Pensacola site.\n\n236\n00:12:46.720 --> 00:12:50.835\nIf it has a 10.1.1, or a 10.1.2,\nthat's the Gainesville site.\n\n237\n00:12:50.835 --> 00:12:54.530\nSo your network does have to be\nlaid out properly to use sites.\n\n238\n00:12:54.530 --> 00:12:56.800\nIf we use 10.1.1.0/24 in both locations,\n\n239\n00:12:56.800 --> 00:13:02.480\nit would have no way of differentiating\nbetween the two locations.\n\n240\n00:13:02.480 --> 00:13:06.890\nSo, subnets are how you define\nthe sites within Active Directory.\n\n241\n00:13:06.890 --> 00:13:10.300\nSo what I'm gonna do is I'm gonna go into\nsubnets and I'm gonna create a new one.\n\n242\n00:13:10.300 --> 00:13:13.807\nI'll zoom out just a wee bit here so\nwe have more room for\n\n243\n00:13:13.807 --> 00:13:16.946\nthe dialog and\nI'm going to create a new subnet.\n\n244\n00:13:16.946 --> 00:13:18.506\nI'll zoom out a little bit more.\n\n245\n00:13:18.506 --> 00:13:24.342\nMy prefix is going to be 10.1.1.0/.\n\n246\n00:13:24.342 --> 00:13:25.715\nAnd let me just zoom out one more time.\n\n247\n00:13:25.715 --> 00:13:27.547\nNotice I cannot click OK.\n\n248\n00:13:27.547 --> 00:13:30.623\nI do need the subnet mask, /24.\n\n249\n00:13:30.623 --> 00:13:32.670\nIt's gonna be that siter notation.\n\n250\n00:13:32.670 --> 00:13:34.520\nClass list enter domain routing.\n\n251\n00:13:34.520 --> 00:13:39.490\nAnd then I have to tell it what\nsite that subnet is part of.\n\n252\n00:13:39.490 --> 00:13:40.640\nAnd I click OK.\n\n253\n00:13:40.640 --> 00:13:43.200\nSo a subnet can only\nbe a part of one site.\n\n254\n00:13:43.200 --> 00:13:45.270\nA site can have multiple subnets.\n\n255\n00:13:45.270 --> 00:13:47.360\nIf this is corporate office\nI might have three or four,\n\n256\n00:13:47.360 --> 00:13:49.980\nfive different subnets associated with it.\n\n257\n00:13:49.980 --> 00:13:52.540\nFor Pensacola my little branch\noffice there might be only one or\n\n258\n00:13:52.540 --> 00:13:55.430\ntwo subnets that I associate with that.\n\n259\n00:13:55.430 --> 00:13:59.836\nIn this case though there's just that one,\nso now it knows that Gainesville or\n\n260\n00:13:59.836 --> 00:14:02.740\nGNV is the 10.1.1 network.\n\n261\n00:14:02.740 --> 00:14:05.170\nAll right,\nnow we're gonna create a new site.\n\n262\n00:14:05.170 --> 00:14:09.240\nRemember I said the Azure is gonna\nbasically be another site within my\n\n263\n00:14:09.240 --> 00:14:11.100\nActive Directory domain services.\n\n264\n00:14:11.100 --> 00:14:15.400\nSo I'm gonna come up to Sites,\nright-click, and choose New site.\n\n265\n00:14:16.640 --> 00:14:20.370\nAnd I'm gonna call this one,\nI'm just gonna call it az, for Azure.\n\n266\n00:14:20.370 --> 00:14:26.790\nBecause my naming convention is basically,\ngnv-gc01, gnv-rtr01.\n\n267\n00:14:26.790 --> 00:14:29.206\nAnd then I'll have az-dcl1.\n\n268\n00:14:29.206 --> 00:14:32.167\nThat will be my first to main\ncontroller in that Azure location.\n\n269\n00:14:32.167 --> 00:14:35.431\nIf I add Pensacola and\nits site name is pns,\n\n270\n00:14:35.431 --> 00:14:39.797\nthen I'd be pns.dcl1, or\n-dcl1, or what have you.\n\n271\n00:14:39.797 --> 00:14:43.534\nSo I'm gonna say az, and I'm gonna\nselect this default IP site link, but\n\n272\n00:14:43.534 --> 00:14:46.040\nwe're actually gonna change that later.\n\n273\n00:14:46.040 --> 00:14:47.960\nI'll explain in just a second.\n\n274\n00:14:47.960 --> 00:14:52.260\nSo I'm gonna go and create the site,\nand I'll click OK, all right.\n\n275\n00:14:52.260 --> 00:14:55.810\nAnd then it tells me,\nhey if you don't create subnets, and\n\n276\n00:14:55.810 --> 00:14:58.990\nif you don't link the sites,\nit's not really gonna out work too well.\n\n277\n00:14:58.990 --> 00:15:03.690\nI'm gonna click OK, and\nnow I've got my new site set up here.\n\n278\n00:15:03.690 --> 00:15:07.600\nI then need to create a subnet,\nI need to define what that site is.\n\n279\n00:15:07.600 --> 00:15:09.840\nSo I'm going to right-click, New subnet.\n\n280\n00:15:09.840 --> 00:15:11.110\nNow here, what do we put?\n\n281\n00:15:11.110 --> 00:15:13.230\nWe don't have an Azure network yet.\n\n282\n00:15:13.230 --> 00:15:14.610\nWell we kind of have to plan this out.\n\n283\n00:15:14.610 --> 00:15:16.600\nWe have to decide what are we gonna do?\n\n284\n00:15:16.600 --> 00:15:21.266\nI know that up there in Azure I'm\ngoing to be creating a virtual\n\n285\n00:15:21.266 --> 00:15:26.024\nnetwork that's going to connect\nthose VMs up there in Azure and\n\n286\n00:15:26.024 --> 00:15:29.286\nI'm gonna do a 10.1.2.0 /24.\n\n287\n00:15:29.286 --> 00:15:31.038\nSo a little bit of planning required here,\n\n288\n00:15:31.038 --> 00:15:33.850\nyou have to kinda know where\nyou're going to go with that.\n\n289\n00:15:33.850 --> 00:15:39.400\nAnd I'll tell it that is the subnet for\nthe Azure site and then I'll click OK.\n\n290\n00:15:39.400 --> 00:15:40.450\nSo now I've got my two sites,\n\n291\n00:15:40.450 --> 00:15:42.690\nnow there's no domain controllers\nin the Azure site yet.\n\n292\n00:15:42.690 --> 00:15:45.850\nWe haven't done that yet but\neverything's ready to go.\n\n293\n00:15:47.140 --> 00:15:50.171\nThe next thing I've gotta do is\nI've gotta create the site link.\n\n294\n00:15:50.171 --> 00:15:52.605\nAs I said,\nif I've got an office in Gainesville and\n\n295\n00:15:52.605 --> 00:15:56.343\nI've gotta an office in Pensacola,\nreplication is gonna occur between those\n\n296\n00:15:56.343 --> 00:15:58.950\nsites thanks to the Knowledge\nconsistency checker and\n\n297\n00:15:58.950 --> 00:16:02.710\nthe innersite topology generator,\nthey're going to lay out that topology.\n\n298\n00:16:02.710 --> 00:16:05.410\nThey're going to pick one domain\ncontroller in Gainesville and\n\n299\n00:16:05.410 --> 00:16:09.040\none domain controller in\nPensacola by bridge head servers\n\n300\n00:16:09.040 --> 00:16:10.560\nto replicate between the two sites.\n\n301\n00:16:10.560 --> 00:16:11.170\nRight?\n\n302\n00:16:11.170 --> 00:16:13.590\nWhere was I going with that?\n\n303\n00:16:13.590 --> 00:16:18.670\nSo, we have to define the path\nthat they can go across.\n\n304\n00:16:18.670 --> 00:16:20.980\nIn other words,\nwhat's a good way to say this?\n\n305\n00:16:20.980 --> 00:16:23.380\nIf I had three different sites.\n\n306\n00:16:23.380 --> 00:16:24.870\nLet's jump up to three, right?\n\n307\n00:16:24.870 --> 00:16:28.410\nSo I've got Gainesville, Pensacola,\nand Birmingham, all right?\n\n308\n00:16:28.410 --> 00:16:32.200\nSo three different physical locations,\nthree different sites.\n\n309\n00:16:32.200 --> 00:16:36.610\nWell, if Gainesville's my primary\nlocation, I might want replication to\n\n310\n00:16:36.610 --> 00:16:43.010\noccur between Gainesville and Pensacola\nand then Gainesville and Birmingham.\n\n311\n00:16:43.010 --> 00:16:46.640\nI don't really want replication going\non between Birmingham and Pensacola.\n\n312\n00:16:46.640 --> 00:16:48.400\nThose are two small branch offices.\n\n313\n00:16:48.400 --> 00:16:53.230\nI want everything replication basically\nhub and spoke out of Gainesville.\n\n314\n00:16:53.230 --> 00:17:00.580\nWell the site link defines where the ISTG\nis allowed to make these replication link.\n\n315\n00:17:00.580 --> 00:17:05.140\nIf all three sites are in the same site\nlink it, then it can do whatever it wants.\n\n316\n00:17:05.140 --> 00:17:06.400\nIt can go Gainesville to Pensacola,\n\n317\n00:17:06.400 --> 00:17:09.960\nPensacola to Birmingham, Birmingham\nto Gainesville, whatever it wants.\n\n318\n00:17:09.960 --> 00:17:12.720\nIf we get rid of that and\nwe define site links,\n\n319\n00:17:12.720 --> 00:17:16.110\nthere's one site link between\nPensacola and Gainesville.\n\n320\n00:17:16.110 --> 00:17:19.260\nThere's another site link between\nBirmingham and Gainesville.\n\n321\n00:17:19.260 --> 00:17:22.990\nThat's gonna limit what the ISTG can do.\n\n322\n00:17:22.990 --> 00:17:26.640\nIt'll only be able to\nreplicate across those paths.\n\n323\n00:17:26.640 --> 00:17:27.860\nSo hopefully that makes sense.\n\n324\n00:17:27.860 --> 00:17:31.680\nIf it doesn't, go back and watch some of\nour active directory shows where I do some\n\n325\n00:17:31.680 --> 00:17:34.040\ndrawings and\nwe break that out in a little more detail.\n\n326\n00:17:35.220 --> 00:17:37.340\nSo now let's check it out here.\n\n327\n00:17:37.340 --> 00:17:39.710\nWe're We're gonna go to\nInter-Site Transports, and\n\n328\n00:17:39.710 --> 00:17:44.070\nwe're gonna be using IP because nobody\nuses SMTP for intra-site replication.\n\n329\n00:17:44.070 --> 00:17:48.000\nI explained that in the other shows too,\nso we'll have to do that again.\n\n330\n00:17:48.000 --> 00:17:52.140\nAnd what I'm gonna do is I'm just\ngonna rename this site link.\n\n331\n00:17:52.140 --> 00:17:58.350\nOkay, so I'm gonna rename it, and\nI'm gonna call this my gmv-az site link.\n\n332\n00:17:58.350 --> 00:17:59.510\nAnd I'm gonna make sure,\n\n333\n00:17:59.510 --> 00:18:05.500\nwhen I pull up its properties that the two\nsites are Azure and Gainesville, right?\n\n334\n00:18:05.500 --> 00:18:10.050\nNow just for giggles, let me show you\nif we created another random site here.\n\n335\n00:18:10.050 --> 00:18:13.270\nNew site, and\nI'll call this bhm for Birmingham.\n\n336\n00:18:15.060 --> 00:18:15.590\nOops, yeah.\n\n337\n00:18:15.590 --> 00:18:19.750\nAll right, and I'll dump it in there,\nbecause it's the only site link I have.\n\n338\n00:18:19.750 --> 00:18:24.110\nAll right, now we go back to\nthat site link you'll see\n\n339\n00:18:24.110 --> 00:18:28.090\nthat all three sites are listed in there,\nbecause I only have one site link.\n\n340\n00:18:28.090 --> 00:18:29.510\nSo it puts all three sites in there.\n\n341\n00:18:29.510 --> 00:18:32.360\nThat means it can replicate\nbetween any of these locations.\n\n342\n00:18:32.360 --> 00:18:36.200\nWhat you would normally do is\nremove Birmingham from this one.\n\n343\n00:18:37.350 --> 00:18:40.820\nSo now I've got one site link\nbetween Gainesville and Azure, and\n\n344\n00:18:40.820 --> 00:18:43.620\nthen I would create a second site link.\n\n345\n00:18:43.620 --> 00:18:47.340\nAnd I would add Gainesville and\nBirmingham.\n\n346\n00:18:47.340 --> 00:18:51.170\nSo you see how I'm doing that?\n\n347\n00:18:51.170 --> 00:18:55.770\nNow I've got, did it not show up?\n\n348\n00:18:55.770 --> 00:18:56.840\nI thought I created a new one.\n\n349\n00:18:56.840 --> 00:18:57.630\nLet's refresh that.\n\n350\n00:19:01.970 --> 00:19:05.500\nEither I clicked cancel that didn't work,\nlet's see.\n\n351\n00:19:05.500 --> 00:19:07.778\nI didn't give it a name at all did I?\n\n352\n00:19:07.778 --> 00:19:09.030\n[LAUGH] Oops.\n\n353\n00:19:09.030 --> 00:19:12.220\nYeah let's do -bhm and\n\n354\n00:19:12.220 --> 00:19:17.680\nthen let's add the sites Birmingham and\nGainesville and click Okay.\n\n355\n00:19:17.680 --> 00:19:20.940\nNow I've got two, and now you can see what\nI'm talking about, kind of like a hub and\n\n356\n00:19:20.940 --> 00:19:21.450\nspoke right?\n\n357\n00:19:21.450 --> 00:19:26.200\nGainesville's the center It can replicate\nazure from against gav Birmingham but\n\n358\n00:19:26.200 --> 00:19:28.620\nnot between Birmingham and and azure.\n\n359\n00:19:28.620 --> 00:19:29.330\nAll right.\n\n360\n00:19:29.330 --> 00:19:31.570\nThat may be that doesn't make sense for\nthe way you set it up.\n\n361\n00:19:31.570 --> 00:19:34.550\nI'm just trying to explain\nthe way these site links works.\n\n362\n00:19:34.550 --> 00:19:39.260\nSo, I'm going to go ahead and just remove\nthat, we don't need the gav Birmingham and\n\n363\n00:19:39.260 --> 00:19:41.720\nI'm gonna go ahead and\nremove the site as well.\n\n364\n00:19:44.050 --> 00:19:46.000\nAll right, we'll get rid of that as well.\n\n365\n00:19:46.000 --> 00:19:50.190\nAll right, so now we're back to just what\nwe need, I've got my sites set up for\n\n366\n00:19:50.190 --> 00:19:54.190\nmy corporate network that includes my\ndomain controllers that are on premises.\n\n367\n00:19:54.190 --> 00:19:56.155\nI've got a site ready to go for\n\n368\n00:19:56.155 --> 00:19:59.545\nmy domain controllers that are going\nto be sitting out there in the Cloud.\n\n369\n00:19:59.545 --> 00:20:03.715\nI've got my subnets associated\nwith the appropriate sites.\n\n370\n00:20:03.715 --> 00:20:05.895\nSo, we can always pull\nup those properties.\n\n371\n00:20:05.895 --> 00:20:07.045\nAnd I can see that.\n\n372\n00:20:08.240 --> 00:20:09.770\nLet's see, I can pull up those properties.\n\n373\n00:20:11.090 --> 00:20:14.480\nThis site, this subnet is\nassociated with Gainesville.\n\n374\n00:20:14.480 --> 00:20:20.050\nAnd as I said, maybe Gainesville's\na large center, since it is corporate.\n\n375\n00:20:20.050 --> 00:20:22.890\nI could have more than one subnet.\n\n376\n00:20:22.890 --> 00:20:29.520\nI could come in here and say New Subnet,\n10.1.3.0/24 is also part of GNV And\n\n377\n00:20:29.520 --> 00:20:35.570\nwe also use a new subnet,\n10.1.4.0\\24 is part of Gainesville.\n\n378\n00:20:35.570 --> 00:20:42.930\nSo now Gainesville actually has\nthree subnets associated with it.\n\n379\n00:20:42.930 --> 00:20:46.930\nMaybe I've got one subnet for\nmy backbone, my servers,\n\n380\n00:20:46.930 --> 00:20:51.020\nright got another subnet for\nmy client machines.\n\n381\n00:20:51.020 --> 00:20:54.310\nAnd then maybe another subnet\nout there for my DMZ maybe.\n\n382\n00:20:54.310 --> 00:20:56.950\nOr depending again on how\nyour network is set up.\n\n383\n00:20:56.950 --> 00:21:00.360\nSo just want to show you a site\ncan contain more than one subnet.\n\n384\n00:21:00.360 --> 00:21:02.830\nIt's a very important part\nof setting those sites up is\n\n385\n00:21:02.830 --> 00:21:05.400\nassociating the subnet\nwith the correct site.\n\n386\n00:21:05.400 --> 00:21:10.410\nBecause that's the only way, if a client\ncalls up and talks to active directory or,\n\n387\n00:21:10.410 --> 00:21:13.660\nqueries DNS, and says hey,\nI need to talk to a domain controller.\n\n388\n00:21:13.660 --> 00:21:15.960\nWell, DNS wants to tell the client,\n\n389\n00:21:15.960 --> 00:21:18.610\nuse the domain controller\nthat's in your location.\n\n390\n00:21:18.610 --> 00:21:20.830\nHow does it know what location it's in?\n\n391\n00:21:20.830 --> 00:21:22.320\nBecause of its IP address.\n\n392\n00:21:22.320 --> 00:21:24.820\nIf the IP address of\nthat client is 10.1.1.22,\n\n393\n00:21:24.820 --> 00:21:27.660\nit says you're in the Gainesville site.\n\n394\n00:21:27.660 --> 00:21:30.760\nHere's the IP address of a domain\ncontroller that's in Gainsville.\n\n395\n00:21:30.760 --> 00:21:35.600\nI don't need my client in Gainesville\ntalking to a domain controller\n\n396\n00:21:35.600 --> 00:21:36.630\nin Pensacola.\n\n397\n00:21:36.630 --> 00:21:40.010\nThere's a domain controller right here\non the same local area network as you.\n\n398\n00:21:40.010 --> 00:21:41.000\nUse that one, right?\n\n399\n00:21:41.000 --> 00:21:42.200\nSites allow me to do that.\n\n400\n00:21:42.200 --> 00:21:45.050\nSo just a quick look at sites in general,\n\n401\n00:21:45.050 --> 00:21:47.250\nhopefully a little bit of a refresher for\nyou,\n\n402\n00:21:47.250 --> 00:21:51.540\nas well as getting ready to extend that on\npremise active directory out to the cloud.\n\n403\n00:21:51.540 --> 00:21:55.600\nWe went ahead and made a site that's going\nto represent what we're getting ready to\n\n404\n00:21:55.600 --> 00:21:57.270\ncreate out there in the cloud.\n\n405\n00:21:57.270 --> 00:21:57.780\n>> That's right.\n\n406\n00:21:57.780 --> 00:22:00.230\nNow, once we actually get into the cloud.\n\n407\n00:22:00.230 --> 00:22:01.250\nWe go into Azure.\n\n408\n00:22:01.250 --> 00:22:04.730\nWe create our active directory\ndomain controller there.\n\n409\n00:22:04.730 --> 00:22:07.040\nIt has something to actually talk to and\nlook at.\n\n410\n00:22:07.040 --> 00:22:11.390\nIt's not just going hey,\nI'd love to be a domain controller in this\n\n411\n00:22:11.390 --> 00:22:15.170\nwonderful domain that you've looked up for\nme, but I can't contact anyone and\n\n412\n00:22:15.170 --> 00:22:18.350\nthat's the whole purpose, that's why\nwe're doing this little bit beforehand so\n\n413\n00:22:18.350 --> 00:22:22.420\nthat all it has to do is go, I'm alive and\nI'm ready connect, everything's setup.\n\n414\n00:22:22.420 --> 00:22:25.630\nMike, wonderful demonstration there,\nobviously sites and services can be a bit\n\n415\n00:22:25.630 --> 00:22:30.300\nof a bear, it has some mystique behind it,\nbut you did a great job of\n\n416\n00:22:30.300 --> 00:22:34.550\ndispelling that, removing the veil so that\nwe might see that's what I love to do.\n\n417\n00:22:34.550 --> 00:22:35.124\n>> Yeah, I know you do.\n[LAUGH]\n\n418\n00:22:35.124 --> 00:22:35.624\n>> [LAUGH]\n\n419\n00:22:35.624 --> 00:22:36.664\n>> That makes sense.\n\n420\n00:22:36.664 --> 00:22:37.904\nIs there anything else that we need to\n\n421\n00:22:37.904 --> 00:22:39.600\ncover as far as sites go?\n\n422\n00:22:39.600 --> 00:22:41.090\n>> No, I think we're good to go.\n\n423\n00:22:41.090 --> 00:22:45.020\nReally, our next step is going to\nbe to start working with Azure and\n\n424\n00:22:45.020 --> 00:22:49.030\ncreating our virtual network and getting\nthat ready And then creating our virtual\n\n425\n00:22:49.030 --> 00:22:52.000\nmachine and installing active directory so\nwe're trudging right along here.\n\n426\n00:22:52.000 --> 00:22:53.610\n>> Awesome.\nWell ladies and gentlemen,\n\n427\n00:22:53.610 --> 00:22:57.500\nwe are through the looking glass and\nfinally we will be getting into Azure and\n\n428\n00:22:57.500 --> 00:22:58.990\nstarting to connect these things up.\n\n429\n00:22:58.990 --> 00:23:00.280\nThat being said, Mike, thanks again for\n\n430\n00:23:00.280 --> 00:23:02.410\njoining us today and\nthank you for watching.\n\n431\n00:23:02.410 --> 00:23:04.130\nWe're going to go ahead and\nsign off for ITProTV.\n\n432\n00:23:04.130 --> 00:23:05.790\nI've been your host Daniel Lowery.\n\n433\n00:23:05.790 --> 00:23:06.560\n>> And I'm Mike Rodrick.\n\n434\n00:23:06.560 --> 00:23:08.447\n>> And we'll see you next time.\n\n435\n00:23:08.447 --> 00:23:15.240\n[MUSIC]\n\n",
          "vimeoId": "155033939"
        },
        {
          "description": "In this episode, Daniel and Mike guide you through working with Microsoft Azure. They start by looking at the free subscription the Microsoft offers and what that entails. Then they look over the different Azure portals which includes the New and Classic portals. Finally they show you how to prepare the PowerShell for connecting to your Azure environment.",
          "length": "1999",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-1-getting_started_with_azure-021016-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-1-getting_started_with_azure-021016-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-1-getting_started_with_azure-021016-1-sm.jpg",
          "title": "Getting Started with Azure",
          "transcript": "WEBVTT\n\n1\n00:00:00.057 --> 00:00:10.057\n[MUSIC]\n\n2\n00:00:11.946 --> 00:00:16.672\nAll right, greetings everyone, and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.672 --> 00:00:19.767\nI'm your host, Daniel Lowrie,\nand in today's episode, well,\n\n4\n00:00:19.767 --> 00:00:22.830\nwe're continuing on with our\nActive Directory in Azure series.\n\n5\n00:00:22.830 --> 00:00:27.050\nAnd yes, that is difficult to say\nbecause of the whole Azure AD business.\n\n6\n00:00:27.050 --> 00:00:27.900\nBut that being said,\n\n7\n00:00:27.900 --> 00:00:31.700\nwe are back with more Active Directory in\nAzure, that's the show you're watching.\n\n8\n00:00:31.700 --> 00:00:36.070\nJoining us in the studio today is the man,\nthe myth, the legend that is Mike Rodrick.\n\n9\n00:00:36.070 --> 00:00:37.260\nMike, welcome back to the show, sir.\n\n10\n00:00:37.260 --> 00:00:37.820\nHow you doing?\n\n11\n00:00:37.820 --> 00:00:38.860\n>> I'm doing great, Daniel.\n\n12\n00:00:38.860 --> 00:00:43.010\nExcited as always cuz we are diving\nin again to Active Directory,\n\n13\n00:00:43.010 --> 00:00:43.990\none of my favorite topics.\n\n14\n00:00:43.990 --> 00:00:46.040\nAnd we're mixing it in with Azure which is\n\n15\n00:00:47.130 --> 00:00:49.780\ngrowing on my list of favorite topics,\nwe'll say.\n\n16\n00:00:49.780 --> 00:00:53.417\nAnd it is something that we've gotta be\nfamiliar with because it's where things\n\n17\n00:00:53.417 --> 00:00:54.656\nare going, it seems like.\n\n18\n00:00:54.656 --> 00:00:57.335\nSo, any who,\nlet's talk about in previous episodes,\n\n19\n00:00:57.335 --> 00:00:59.045\nwe've been getting things set up.\n\n20\n00:00:59.045 --> 00:01:03.472\nWhat we're trying to do is, again,\nextend our active directory\n\n21\n00:01:03.472 --> 00:01:08.219\ninfrastructure that we already have\non premise out into the cloud, or\n\n22\n00:01:08.219 --> 00:01:11.290\nto be more specific, into Microsoft Azure.\n\n23\n00:01:11.290 --> 00:01:13.350\nSo far we have set up our internal net.\n\n24\n00:01:13.350 --> 00:01:14.920\nWe've got our corporate network.\n\n25\n00:01:14.920 --> 00:01:16.180\nWe've got our domain controller.\n\n26\n00:01:16.180 --> 00:01:16.980\nWe've got our router.\n\n27\n00:01:16.980 --> 00:01:21.748\nWe've got Internet access going through\nthere, which is going to be key.\n\n28\n00:01:21.748 --> 00:01:24.680\nAnd we configured\nActive Directory to support\n\n29\n00:01:24.680 --> 00:01:26.230\nwhat we're planning on doing in Azure.\n\n30\n00:01:26.230 --> 00:01:28.354\nRemember, we created our sites.\n\n31\n00:01:28.354 --> 00:01:33.559\nWe created one site for\nthe 10.1.1.0/24 network.\n\n32\n00:01:33.559 --> 00:01:35.010\nThat was our corporate network.\n\n33\n00:01:35.010 --> 00:01:40.170\nI think we added a couple other\nsubnets just for giggles, 1.3 and 1.4.\n\n34\n00:01:40.170 --> 00:01:43.040\nAnd then we also created\ncreated a site for\n\n35\n00:01:43.040 --> 00:01:48.049\nwhat's going to be created up in Azure,\nthe 10.1.2.0/24.\n\n36\n00:01:48.049 --> 00:01:49.440\nSo all that was done ahead of time.\n\n37\n00:01:49.440 --> 00:01:51.728\nWe haven't even touched Azure yet.\n\n38\n00:01:51.728 --> 00:01:56.508\nRemember what we said, we wanna get things\nconfigured here on premises correctly\n\n39\n00:01:56.508 --> 00:01:59.345\nfirst so\nthat when we do start working in Azure and\n\n40\n00:01:59.345 --> 00:02:02.253\nAzure reaches out and\ntries to touch our network,\n\n41\n00:02:02.253 --> 00:02:07.130\nand we create that site-to-site VPN,\nthat everything's there waiting for it.\n\n42\n00:02:07.130 --> 00:02:10.830\nWe don't want to have to configure it out\nin Azure and then come back and configure\n\n43\n00:02:10.830 --> 00:02:15.040\nit on premises and then have to fix\nthings, cuz Azure was unable to find it.\n\n44\n00:02:15.040 --> 00:02:18.095\nIt just does not work out well,\ntrust me, [LAUGH] I know.\n\n45\n00:02:18.095 --> 00:02:19.940\n>> [LAUGH]\n>> All right, so\n\n46\n00:02:19.940 --> 00:02:23.330\nat this point,\nlet's start taking a look at Azure.\n\n47\n00:02:23.330 --> 00:02:26.200\nWe haven't even done that yet\nin any of these episodes.\n\n48\n00:02:26.200 --> 00:02:29.390\nSo that's gonna be our next step so\nwhat I'm gonna do here on my screen is\n\n49\n00:02:29.390 --> 00:02:32.780\nopen up a browser and\nI'm going to navigate.\n\n50\n00:02:32.780 --> 00:02:38.540\nWell first let's do a quick search here\nbecause Azure is a paid subscription.\n\n51\n00:02:38.540 --> 00:02:41.400\nIt's a subscription based service.\n\n52\n00:02:41.400 --> 00:02:44.410\nSo you are gonna have to create a account.\n\n53\n00:02:44.410 --> 00:02:46.905\nIf you want to practice with this and\nplay with this stuff and\n\n54\n00:02:46.905 --> 00:02:50.180\nkinda test thing's out though,\nit actually doesn't cost you any money.\n\n55\n00:02:50.180 --> 00:02:52.130\nYou can get a free trial.\n\n56\n00:02:52.130 --> 00:02:54.520\nSo, let's take a look\nat how we can do that.\n\n57\n00:02:55.580 --> 00:02:59.180\nI'm just gonna do a quick search for\nAzure trial.\n\n58\n00:02:59.180 --> 00:03:01.970\nAnd, that's gonna take me\nright there to Microsoft.com,\n\n59\n00:03:01.970 --> 00:03:05.160\nMicrosoft Azure,\nbring me up to their homepage, and boom.\n\n60\n00:03:05.160 --> 00:03:10.230\nRight there on the landing page\nis a free one-month trial.\n\n61\n00:03:10.230 --> 00:03:14.830\nSign up for free and\nget $200 to spend on all Azure services.\n\n62\n00:03:14.830 --> 00:03:17.040\nAll right, so you can go ahead and\nsign up for this.\n\n63\n00:03:17.040 --> 00:03:20.762\nIf I click Try Now, it's going to\nwant me to create an account or\n\n64\n00:03:20.762 --> 00:03:23.920\nlog in so you're gonna need\na Microsoft account to do this with.\n\n65\n00:03:25.500 --> 00:03:28.932\nI'm trying to think if I can actually get,\nlet me go back to that other page.\n\n66\n00:03:28.932 --> 00:03:31.879\nI don't want to sign in just yet to mine.\n\n67\n00:03:31.879 --> 00:03:35.550\nI was gonna see if I could find\nyou some more information.\n\n68\n00:03:35.550 --> 00:03:38.366\nBut what you would do is you'd\nsign in with that account.\n\n69\n00:03:38.366 --> 00:03:42.950\nAnd it's gonna allow you to\nstart filling out some forms to\n\n70\n00:03:42.950 --> 00:03:45.670\ncreate your Microsoft Azure trial.\n\n71\n00:03:45.670 --> 00:03:48.800\nIt is going to ask you for\na credit card, all right?\n\n72\n00:03:48.800 --> 00:03:50.730\nThey're not gonna charge you anything.\n\n73\n00:03:50.730 --> 00:03:54.830\nAnd Microsoft is very good about letting\nyou know we will not charge you for\n\n74\n00:03:54.830 --> 00:03:57.770\nanything without explicitly telling you.\n\n75\n00:03:57.770 --> 00:04:02.930\nSo it's not like there's gonna be hidden\ncharges or if you leave things running or\n\n76\n00:04:02.930 --> 00:04:05.520\nanything like that,\nthat they're gonna start charging you.\n\n77\n00:04:05.520 --> 00:04:08.620\nAt least the last I read, make sure\nyou do your research on that though.\n\n78\n00:04:08.620 --> 00:04:11.150\nI don't want you going out there,\nsetting up some trials, and\n\n79\n00:04:11.150 --> 00:04:12.560\nthen all of a sudden getting billed.\n\n80\n00:04:12.560 --> 00:04:15.380\nFor that first month,\nyou're definitely in the clear.\n\n81\n00:04:15.380 --> 00:04:18.880\nIf it's gonna charge you money,\nit should tell you.\n\n82\n00:04:18.880 --> 00:04:20.420\nAnd say hey, if you do this, or\n\n83\n00:04:20.420 --> 00:04:22.600\nif you leave this running,\nwe're gonna charge you money.\n\n84\n00:04:22.600 --> 00:04:26.840\nThere's a frequently asked\nquestions page where you can go in.\n\n85\n00:04:26.840 --> 00:04:28.340\nDo I pay anything during the trial?\n\n86\n00:04:28.340 --> 00:04:30.080\nNo, it's absolutely free.\n\n87\n00:04:30.080 --> 00:04:31.900\nDo I have to pay anything\nat the end of the trial?\n\n88\n00:04:31.900 --> 00:04:34.230\nNo, there is no obligation.\n\n89\n00:04:34.230 --> 00:04:36.500\nAnd so you can go in.\n\n90\n00:04:36.500 --> 00:04:39.100\nWhy do I need to provide a credit card and\nphone number?\n\n91\n00:04:39.100 --> 00:04:40.640\nFor identification.\n\n92\n00:04:40.640 --> 00:04:43.990\nWe do not bill anything\non the credit card.\n\n93\n00:04:43.990 --> 00:04:47.010\nWhat happens if I exceed the credit?\n\n94\n00:04:47.010 --> 00:04:49.060\nWe will suspend your trial account.\n\n95\n00:04:49.060 --> 00:04:51.550\nYou can optionally\nupgrade to pay-as-you-go.\n\n96\n00:04:51.550 --> 00:04:52.640\nSo that's what I was saying.\n\n97\n00:04:52.640 --> 00:04:55.940\nThey're not just going to start charging\nyou because it can be a little bit\n\n98\n00:04:55.940 --> 00:05:00.565\nconfusing in there and you can end up\ndoing something that might cost you money\n\n99\n00:05:00.565 --> 00:05:03.360\nand they've already got\nyour credit card number.\n\n100\n00:05:03.360 --> 00:05:06.830\nSo that's something that at least I\nknow I would be worried about and\n\n101\n00:05:06.830 --> 00:05:08.370\nif this is a corporate credit card.\n\n102\n00:05:08.370 --> 00:05:11.320\nGotta explain things to the boss,\nwhy did I get this bill?\n\n103\n00:05:11.320 --> 00:05:13.980\nI told you just to check it out,\nI didn't approve that yet.\n\n104\n00:05:13.980 --> 00:05:17.242\nSo just understand that they're\nnot going to bill you anything.\n\n105\n00:05:17.242 --> 00:05:18.820\nThey will suspend your account though.\n\n106\n00:05:18.820 --> 00:05:21.793\nIf you burn through the $200\nbefore the end of your 30 days,\n\n107\n00:05:21.793 --> 00:05:24.240\nthey're gonna say that's all you get,\nright?\n\n108\n00:05:24.240 --> 00:05:28.540\nAnd then you've got the option to continue\non and actually start paying money.\n\n109\n00:05:28.540 --> 00:05:31.360\n>> Yeah, that's actually a nice safety\nmeasure that Microsoft implants in\n\n110\n00:05:31.360 --> 00:05:32.270\nthere for you.\n\n111\n00:05:32.270 --> 00:05:35.730\nSo that you don't, cuz a lot of companies,\nthat's exactly what they'll do is they'll\n\n112\n00:05:35.730 --> 00:05:39.020\njust say well you burned through our $200\ncredit, and you're still running that\n\n113\n00:05:39.020 --> 00:05:43.320\nserver, so ching, ching, ching, ching,\nand they start pulling the money stick.\n\n114\n00:05:43.320 --> 00:05:46.800\nThey don't care, that's why they\ngot that credit card for is so\n\n115\n00:05:46.800 --> 00:05:50.100\nthat when you exceed what it is they've\ngiven you, they can start charging you.\n\n116\n00:05:50.100 --> 00:05:51.780\nMicrosoft doesn't wanna make you an enemy.\n\n117\n00:05:51.780 --> 00:05:54.070\nThey want you to like Azure.\n\n118\n00:05:54.070 --> 00:05:57.840\nThey want you to like their products and\ncharging you behind the scenes\n\n119\n00:05:57.840 --> 00:06:01.700\nis not how they do that, so\nit's really cool that they put it in.\n\n120\n00:06:01.700 --> 00:06:06.660\nYou can feel unafraid to go in and create\nthat free trial, work with it as you need\n\n121\n00:06:06.660 --> 00:06:11.640\nand not worry about starting to get\na bill out of nowhere from Microsoft.\n\n122\n00:06:11.640 --> 00:06:15.600\n>> And you might think well, $200, I could\nburn through that in a couple of days.\n\n123\n00:06:15.600 --> 00:06:17.060\nThere goes my trial.\n\n124\n00:06:17.060 --> 00:06:21.574\nYou'd be surprised, it's really not that\nexpensive unless you're building lots and\n\n125\n00:06:21.574 --> 00:06:25.601\nlots of virtual machines and you're\npicking the highest performance tier and\n\n126\n00:06:25.601 --> 00:06:28.424\nyou're adding multiple drives and\nthings like that.\n\n127\n00:06:28.424 --> 00:06:31.266\nThat's where you can start\nracking up the cost.\n\n128\n00:06:31.266 --> 00:06:34.618\nBut if you're doing simple virtual\nmachines just for testing purposes and\n\n129\n00:06:34.618 --> 00:06:36.745\nthings like that,\nthey're really cheap, and\n\n130\n00:06:36.745 --> 00:06:38.780\nyou'll get to see that\nas we go through here.\n\n131\n00:06:40.220 --> 00:06:43.110\nAll right, so\nlet's see where we've gotta go next.\n\n132\n00:06:43.110 --> 00:06:47.549\nLet's go ahead and log in, so\nonce you create your trial,\n\n133\n00:06:47.549 --> 00:06:53.257\nyou're gonna obviously log in to Azure,\nand it's going to scream at me for\n\n134\n00:06:53.257 --> 00:06:57.168\na minute because I have to\npick from one of the many.\n\n135\n00:06:57.168 --> 00:07:00.216\nLet's see here, where am I going?\n\n136\n00:07:00.216 --> 00:07:02.441\nWhy aren't you logging in?\n\n137\n00:07:02.441 --> 00:07:05.345\nI have a few different\nMicrosoft accounts and\n\n138\n00:07:05.345 --> 00:07:10.587\nI have to make sure it picks the right\none, That has my subscription.\n\n139\n00:07:10.587 --> 00:07:12.948\nNot all my Microsoft accounts\nhave Azure subscription so\n\n140\n00:07:12.948 --> 00:07:14.776\nI have to make sure I\nget the right one there.\n\n141\n00:07:14.776 --> 00:07:20.130\nSo here I am, I'm logging in and\nthis is known as the new portal.\n\n142\n00:07:20.130 --> 00:07:22.300\nThis is the way thing's are going.\n\n143\n00:07:22.300 --> 00:07:26.410\nThis is the new interface that you're\ngonna have to do when you deal with Azure.\n\n144\n00:07:26.410 --> 00:07:28.680\nAnd it's pretty slick, it really is.\n\n145\n00:07:28.680 --> 00:07:30.060\nIt's tile-based.\n\n146\n00:07:30.060 --> 00:07:32.140\nWonder where that came from, right?\n\n147\n00:07:32.140 --> 00:07:35.450\nAgain, that consistent\nlook across all their OSs.\n\n148\n00:07:35.450 --> 00:07:38.920\nThis is just the dashboard\nwhere you can put little,\n\n149\n00:07:38.920 --> 00:07:42.140\nI don't wanna call them-\n>> The quick launch.\n\n150\n00:07:42.140 --> 00:07:45.330\n>> Yeah, where you can add\nlittle tiles and monitor,\n\n151\n00:07:45.330 --> 00:07:46.750\nlike here's my service health.\n\n152\n00:07:46.750 --> 00:07:50.240\nSo I can see at a quick glance\nthat everything looks good, right?\n\n153\n00:07:50.240 --> 00:07:54.224\nOr I might see a red x somewhere,\nindicating that there might be a problem.\n\n154\n00:07:54.224 --> 00:07:59.112\nAnd you can add additional little tiles\nto keep track of different things as you\n\n155\n00:07:59.112 --> 00:08:04.000\nsee fit, or whatever you need to monitor\nQuickly and easy by logging in here and\n\n156\n00:08:04.000 --> 00:08:06.464\nthen over here, on the left hand side.\n\n157\n00:08:06.464 --> 00:08:08.630\nThis is where you've got options like New.\n\n158\n00:08:08.630 --> 00:08:13.920\nAnd when I click New,\nI'll have a lot of different options.\n\n159\n00:08:13.920 --> 00:08:16.020\nEach one of this is basically\nyou gonna slide down a menu.\n\n160\n00:08:16.020 --> 00:08:19.770\nIf I go to Compute for\nexample, I get their gallery,\n\n161\n00:08:19.770 --> 00:08:22.040\nwhere I can choose,\nhey I wanna spend up a new.\n\n162\n00:08:22.040 --> 00:08:23.881\n2012 R2 Datacenter, right?\n\n163\n00:08:23.881 --> 00:08:28.920\nOr I want to spin up a Ubuntu server or\na Sequel server.\n\n164\n00:08:28.920 --> 00:08:30.310\nThese are all templates.\n\n165\n00:08:30.310 --> 00:08:31.550\nI don't have to go get a disk.\n\n166\n00:08:31.550 --> 00:08:33.620\nI don't have to install\nthe operating system.\n\n167\n00:08:33.620 --> 00:08:36.510\nThese are pre-built\ntemplates that they have.\n\n168\n00:08:36.510 --> 00:08:39.150\nYou pick the one you want and\nthey're gonna build it for you.\n\n169\n00:08:39.150 --> 00:08:41.032\nFantastic.\n\n170\n00:08:41.032 --> 00:08:41.950\nLove that.\n\n171\n00:08:41.950 --> 00:08:45.250\nYou get down to like web and mobile, and I\nwon't go through all of these cuz most of\n\n172\n00:08:45.250 --> 00:08:48.140\nthem are not,\npertinent to what we're doing here.\n\n173\n00:08:48.140 --> 00:08:50.800\nBut things like networking,\nthat's going to be an important one for\n\n174\n00:08:50.800 --> 00:08:54.930\nus because we've got to set up our\nvirtual network in a little bit.\n\n175\n00:08:54.930 --> 00:08:57.460\nWe are going to be creating\na virtual machine eventually so\n\n176\n00:08:57.460 --> 00:08:59.030\nwe'll be using net compute.\n\n177\n00:08:59.030 --> 00:09:02.230\nSo we're also going to be using data and\nstorage because I have to create what we\n\n178\n00:09:02.230 --> 00:09:06.300\ncall a storage account to store\nthe virtual machines for example.\n\n179\n00:09:06.300 --> 00:09:07.090\nThe hard drive, right.\n\n180\n00:09:07.090 --> 00:09:10.470\nThe VHD's and the config files for\nthose virtual machines, but\n\n181\n00:09:10.470 --> 00:09:14.990\nyou can see there's quite a few\noptions in this list under management.\n\n182\n00:09:14.990 --> 00:09:19.420\nThis is where we can go in and\nwork with things like the scheduler,\n\n183\n00:09:20.450 --> 00:09:24.000\ncreate resource groups, and\nresources groups are really cool.\n\n184\n00:09:24.000 --> 00:09:26.890\nI know we've talked about them\nin a couple of our other shows.\n\n185\n00:09:26.890 --> 00:09:29.930\nA lot of times when you deploy, if you're\ndeploying a web application, right?\n\n186\n00:09:29.930 --> 00:09:30.860\nThere's a lot of pieces to it.\n\n187\n00:09:30.860 --> 00:09:34.690\nThere might be the web server, the web\napplication, but then the SQL database for\n\n188\n00:09:34.690 --> 00:09:36.510\nthe backend and things like that.\n\n189\n00:09:36.510 --> 00:09:40.750\nA resource group can kinda treat those as\na unit rather than have to manage them\n\n190\n00:09:40.750 --> 00:09:44.780\nindividually, so\nthat's a neat concept there as well.\n\n191\n00:09:44.780 --> 00:09:45.350\nAll right.\n\n192\n00:09:45.350 --> 00:09:47.340\nSo lots of things you can\ndo when you click new.\n\n193\n00:09:47.340 --> 00:09:51.650\nYou can close these little panes down,\nget back out to the dashboard,\n\n194\n00:09:51.650 --> 00:09:54.260\nand then it'll show you like,\nyou can go to all resources and\n\n195\n00:09:54.260 --> 00:09:57.550\nyou can see all the different resources\nthat you have, that you've created,\n\n196\n00:09:57.550 --> 00:10:00.640\nlike resource groups, storage accounts,\n\n197\n00:10:00.640 --> 00:10:03.810\nvirtual machines, virtual networks,\nall of that'll show up here.\n\n198\n00:10:03.810 --> 00:10:06.440\nAnd most of these you can click on and\nit will take you out and\n\n199\n00:10:06.440 --> 00:10:08.120\ngive you more information.\n\n200\n00:10:08.120 --> 00:10:13.270\nYou can see over here though that\nthey have virtual machines and\n\n201\n00:10:13.270 --> 00:10:16.950\nvirtual machines classic and\nthen cloud services classic.\n\n202\n00:10:16.950 --> 00:10:18.640\nAnd what the heck is that all about?\n\n203\n00:10:18.640 --> 00:10:23.250\nWell, I said this is the new portal,\nwhich should kinda lead you\n\n204\n00:10:23.250 --> 00:10:26.930\nto believe that there might have been a\nportal before this, right, and there was.\n\n205\n00:10:26.930 --> 00:10:29.540\nWe'll call that the classic portal.\n\n206\n00:10:29.540 --> 00:10:32.950\nAnd I'll be honest with you,\nI still prefer the classic portal,\n\n207\n00:10:32.950 --> 00:10:37.690\nthe new portal here is good, I like it,\nI think it's got a lot of potential,\n\n208\n00:10:37.690 --> 00:10:41.820\nnot every thing can be done yet\nthrough the new portal.\n\n209\n00:10:41.820 --> 00:10:43.620\nAnd if you do research on this, and\n\n210\n00:10:43.620 --> 00:10:47.710\nyou go out and start studying on How\nto set up a VM and things like that.\n\n211\n00:10:47.710 --> 00:10:52.810\nA lot of the Microsoft blogs are gonna\nbe talking about the old classic portal.\n\n212\n00:10:52.810 --> 00:10:56.310\nAnd it is a different layout,\nthings are called different names,\n\n213\n00:10:56.310 --> 00:10:58.000\neven though they're the exact same thing.\n\n214\n00:10:58.000 --> 00:10:59.490\nThat's Microsoft's favorite thing to do.\n\n215\n00:10:59.490 --> 00:11:01.670\nLet's just change the name.\n\n216\n00:11:01.670 --> 00:11:04.310\nAnd now you have to\nlearn it all over again.\n\n217\n00:11:04.310 --> 00:11:07.340\nSo the classic portal is typically what\nI like to use and what we're gonna be\n\n218\n00:11:07.340 --> 00:11:11.010\nusing in here I thought what we might\ntry to do Daniel is actually use both.\n\n219\n00:11:11.010 --> 00:11:15.300\nWe'll stick with the classic portal\nthroughout, and then if we got time,\n\n220\n00:11:15.300 --> 00:11:19.690\nwe can go back and try to repeat\nthe process using this new portal as well.\n\n221\n00:11:19.690 --> 00:11:23.095\nCuz like I said,\nit's slightly different, primarily Joe,\n\n222\n00:11:23.095 --> 00:11:26.116\njust what they call things\nis really what it's about.\n\n223\n00:11:26.116 --> 00:11:31.790\n>> Yeah, if I'm not mistaken, I think\nthe cloud service's resource groups.\n\n224\n00:11:31.790 --> 00:11:32.290\n>> Yeah.\n>> You know?\n\n225\n00:11:32.290 --> 00:11:34.380\nSo that can get a little confusing\n\n226\n00:11:34.380 --> 00:11:35.180\nif you're not used to.\n\n227\n00:11:35.180 --> 00:11:38.120\nOr if you're used to the old way,\nyou've worked with Azure before.\n\n228\n00:11:38.120 --> 00:11:40.720\nAnd now you're ready to\nstart deploying AD in Azure.\n\n229\n00:11:40.720 --> 00:11:43.800\nYou're, like, well, what is this resource\ngroup which you're talking about?\n\n230\n00:11:43.800 --> 00:11:46.660\nWell, that's in the new portal, and\nit's cloud services in the old portal.\n\n231\n00:11:46.660 --> 00:11:47.580\nSo.\n>> Absolutely.\n\n232\n00:11:47.580 --> 00:11:50.092\n>> You can see where our\nheads get spun a little bit.\n\n233\n00:11:50.092 --> 00:11:50.935\n[LAUGH]\n>> Yeah.\n\n234\n00:11:50.935 --> 00:11:53.910\nAnd I've seen where they've\ntried to kind of go back and\n\n235\n00:11:53.910 --> 00:11:57.610\nupdate some of the stuff in\nthe classic to match the new portal.\n\n236\n00:11:57.610 --> 00:11:59.009\nSo you go to create, say,\n\n237\n00:11:59.009 --> 00:12:03.081\na gateway which we're gonna need when\nwe create that site-to-site VPN and\n\n238\n00:12:03.081 --> 00:12:06.407\nyou hit the list and it says do\nyou want to do dynamic or static?\n\n239\n00:12:06.407 --> 00:12:09.509\nWell wait, that's not what it used to\nbe called, it was called route based or\n\n240\n00:12:09.509 --> 00:12:10.480\npolicy based.\n\n241\n00:12:10.480 --> 00:12:14.300\nYou go out and\ndo some research on it and say, yeah,\n\n242\n00:12:14.300 --> 00:12:18.060\nroute based is dynamic And\npolicy based is now called static.\n\n243\n00:12:18.060 --> 00:12:20.130\nIt's like, okay, why?\n\n244\n00:12:20.130 --> 00:12:21.172\n>> Welcome to IT, Michael.\n\n245\n00:12:21.172 --> 00:12:21.720\n>> Yeah.\n>> [LAUGH]\n\n246\n00:12:21.720 --> 00:12:22.220\n>> Exactly.\n\n247\n00:12:22.220 --> 00:12:24.330\nAll right, so that's the new portal.\n\n248\n00:12:24.330 --> 00:12:29.070\nLet me flip over and see if I can\nget to the classic portal here.\n\n249\n00:12:29.070 --> 00:12:31.710\nAnd you notice the,\nwell you might not have seen that.\n\n250\n00:12:31.710 --> 00:12:34.850\nThe new portal is portal.azure.com.\n\n251\n00:12:34.850 --> 00:12:38.857\nThe classic portal is actually\nmanage.windowsazure.com.\n\n252\n00:12:38.857 --> 00:12:39.959\nOr azure.com.\n\n253\n00:12:41.380 --> 00:12:41.970\nAll right,\n\n254\n00:12:41.970 --> 00:12:45.751\nso this is the good old classic portal and\nyou can see it's a similar layout.\n\n255\n00:12:45.751 --> 00:12:48.513\nYou know, you've got your\nitems where I can see, again,\n\n256\n00:12:48.513 --> 00:12:51.610\nall the things that I have created\nup here under my subscription.\n\n257\n00:12:51.610 --> 00:12:54.370\nBut instead of slide outs\nit's a little bit different.\n\n258\n00:12:54.370 --> 00:12:59.570\nLike virtual machines, I can see I don't\nhave any created cloud services, you know?\n\n259\n00:12:59.570 --> 00:13:02.570\nThere is one that somebody else\nhas created on this account.\n\n260\n00:13:02.570 --> 00:13:06.230\nWe all kind of share some of these\ndemo accounts here at ITPro.\n\n261\n00:13:06.230 --> 00:13:10.410\nSo I've got a scroll list, and\nI can see mostly the same options here.\n\n262\n00:13:12.300 --> 00:13:15.160\nSo just a little bit different\nin the way you get around.\n\n263\n00:13:15.160 --> 00:13:16.900\nIn the end you're doing\nthe exact same thing and\n\n264\n00:13:16.900 --> 00:13:18.850\nyou're creating the exact same thing.\n\n265\n00:13:18.850 --> 00:13:21.330\nI will warn you though, there are some\nthings that are not compatible.\n\n266\n00:13:21.330 --> 00:13:25.080\nIf you create part of the solution\nusing the classic and then try\n\n267\n00:13:25.080 --> 00:13:28.590\nto create the other part using the new\nportal, they won't talk to each other.\n\n268\n00:13:28.590 --> 00:13:29.190\nIt won't work.\n\n269\n00:13:29.190 --> 00:13:31.120\nSo it's something that\nyou gotta keep in mind.\n\n270\n00:13:31.120 --> 00:13:34.140\nReally should pick one and stick with it.\n\n271\n00:13:34.140 --> 00:13:36.640\nAnd honestly, probably, like I said,\n\n272\n00:13:36.640 --> 00:13:38.800\nthe problem is that new portal\nis still being developed.\n\n273\n00:13:38.800 --> 00:13:40.340\nSo I really like this cloud portal.\n\n274\n00:13:41.400 --> 00:13:44.850\nAll right, so let's see we\ntalked about our subscription,\n\n275\n00:13:44.850 --> 00:13:46.810\nwe talked about the portals and\n\n276\n00:13:46.810 --> 00:13:50.170\nthe next thing we really wanna do to get\nready cause again, we're gonna start\n\n277\n00:13:50.170 --> 00:13:53.640\nworking on this Cloud side of things is we\nneed to create a storage account right.\n\n278\n00:13:53.640 --> 00:13:57.680\nWe need to create somewhere to store\nthe resources that we're getting ready\n\n279\n00:13:57.680 --> 00:13:58.810\nto create.\n\n280\n00:13:58.810 --> 00:14:02.610\nAs over that one, I'm gonna click\non storage in my navigation tree.\n\n281\n00:14:03.740 --> 00:14:05.280\nThere you can see that I got one already.\n\n282\n00:14:05.280 --> 00:14:06.910\nThat was one that we set up awhile ago.\n\n283\n00:14:06.910 --> 00:14:09.530\nWe're gonna go ahead and\ncreate a new one for our lab.\n\n284\n00:14:10.960 --> 00:14:16.050\nSo down here at the bottom, if you guys'\ncan see that, is a little new button.\n\n285\n00:14:16.050 --> 00:14:18.520\nThey kind of hide it but\nit's not like it's hidden but\n\n286\n00:14:18.520 --> 00:14:21.660\nI didn't notice it I know the first\ntime I was playing with this.\n\n287\n00:14:21.660 --> 00:14:25.740\nSo you click new and that brings up\nthis menu, and depending on what you had\n\n288\n00:14:25.740 --> 00:14:28.740\nselected when you clicked new,\nit should already be highlighted.\n\n289\n00:14:28.740 --> 00:14:31.980\nNotice data services,\nstorage is already selected.\n\n290\n00:14:31.980 --> 00:14:34.750\nNow if I wanted to create something\nelse I could definitely change and\n\n291\n00:14:34.750 --> 00:14:35.770\ngo to something else.\n\n292\n00:14:35.770 --> 00:14:39.900\nBut whatever you have selected should\nbe highlighted for you already.\n\n293\n00:14:39.900 --> 00:14:43.330\nSo we're going to storage and\nI'm gonna choose quick create,\n\n294\n00:14:43.330 --> 00:14:47.540\ncuz that's my only option\nSee how fast it is?\n\n295\n00:14:49.110 --> 00:14:54.510\nAnd I'm gonna give it a URL and I'm gonna\ncall this one, we're gonna call this AD\n\n296\n00:14:56.180 --> 00:15:01.470\nin Azure and\n\n297\n00:15:01.470 --> 00:15:05.040\nI get a little green checkmark there\nletting me know that that is available,\n\n298\n00:15:05.040 --> 00:15:06.760\nbecause this is going\nto have to be unique.\n\n299\n00:15:06.760 --> 00:15:12.170\nIt's gonna create a URL that we can\nactually use to access this storage\n\n300\n00:15:12.170 --> 00:15:13.000\nfrom the outside.\n\n301\n00:15:13.000 --> 00:15:16.430\nYou can see it's going to\nend in .core.windows.net.\n\n302\n00:15:16.430 --> 00:15:20.740\nSo if I tried to do something like,\nI don't know, Azure, right?\n\n303\n00:15:20.740 --> 00:15:23.110\nThe storage account name,\nAzure, is already taken.\n\n304\n00:15:23.110 --> 00:15:24.590\nSo somebody's already got that one.\n\n305\n00:15:24.590 --> 00:15:26.160\n>> And then that's across the board,\nright?\n\n306\n00:15:26.160 --> 00:15:28.250\n>> Yeah.\n>> This isn't just within our Azure\n\n307\n00:15:28.250 --> 00:15:29.560\nenvironment, our account.\n\n308\n00:15:29.560 --> 00:15:34.340\nThis has to be unique across\nthe entire Azure environment.\n\n309\n00:15:34.340 --> 00:15:37.440\n>> Yes, worldwide, and\nglobally has to be unique.\n\n310\n00:15:37.440 --> 00:15:41.470\nSo a lot of times what I'll suggest for\npeople that are practicing with this\n\n311\n00:15:41.470 --> 00:15:44.660\nis just throw your initials\nout in front of that, right?\n\n312\n00:15:44.660 --> 00:15:47.190\nI put mdr, for Michael Darren Rodrick.\n\n313\n00:15:49.340 --> 00:15:52.838\nBut throw some initials out there,\nand then the word Azure.\n\n314\n00:15:52.838 --> 00:15:54.971\nIf the name you really\nwant is already taken,\n\n315\n00:15:54.971 --> 00:15:59.127\njust add something to the end that's, it's\nlike creating a strong password, right,\n\n316\n00:15:59.127 --> 00:16:00.882\njust add 1-2-3 to the end of it.\n\n317\n00:16:00.882 --> 00:16:03.759\n[LAUGH] All right, so\nwe'll gonna go a d and\n\n318\n00:16:03.759 --> 00:16:07.224\nAzure's gonna be the name\nof my Storage account.\n\n319\n00:16:07.224 --> 00:16:08.840\nThen location or affinity group.\n\n320\n00:16:08.840 --> 00:16:11.890\nNow, this changes in the new portal.\n\n321\n00:16:11.890 --> 00:16:14.500\nWe don't really use\naffinity groups anymore.\n\n322\n00:16:14.500 --> 00:16:16.490\nThey go with that,\nthey have those resource groups.\n\n323\n00:16:16.490 --> 00:16:18.450\nBut kind of the same concept.\n\n324\n00:16:18.450 --> 00:16:22.840\nI'm going to choose east US,\ncuz that's where I am closest to.\n\n325\n00:16:22.840 --> 00:16:24.610\nSo this is basically saying.\n\n326\n00:16:24.610 --> 00:16:27.090\nTo Microsoft,\nthis is where I want to store this.\n\n327\n00:16:27.090 --> 00:16:29.530\nMicrosoft has data\ncenters around the world.\n\n328\n00:16:29.530 --> 00:16:35.130\nYou can see from this list, I've got\nSoutheast or South and Central and East.\n\n329\n00:16:35.130 --> 00:16:37.910\nNorth and West Europe, Asia, Japan.\n\n330\n00:16:37.910 --> 00:16:38.920\nSo I got a few different places.\n\n331\n00:16:38.920 --> 00:16:41.490\nYou'd wanna pick one That\nwas closest to you, right?\n\n332\n00:16:41.490 --> 00:16:44.670\nIf the majority of my users\nare here in the states, or\n\n333\n00:16:44.670 --> 00:16:47.860\nthe people that are gonna be accessing\nthese resources are here in the states on\n\n334\n00:16:47.860 --> 00:16:50.610\nthe Eastern seaboard,\nthen that's the one I'm gonna pick, right?\n\n335\n00:16:50.610 --> 00:16:52.370\nThat's gonna give me the best performance.\n\n336\n00:16:52.370 --> 00:16:53.940\nNot gonna pick the one in Japan.\n\n337\n00:16:53.940 --> 00:16:55.740\nBut if I'm setting up some VMs and\n\n338\n00:16:55.740 --> 00:16:59.560\nI'm gonna create some resources that my\noffices out in Japan are gonna be using\n\n339\n00:16:59.560 --> 00:17:03.360\nI probably wanna store it on their\ndata center out there in Japan.\n\n340\n00:17:03.360 --> 00:17:05.200\nSo pick the right one for that.\n\n341\n00:17:05.200 --> 00:17:08.370\nAnd then for replication,\nit defaults to Geo Redundant,\n\n342\n00:17:08.370 --> 00:17:09.870\nwhich is actually pretty cool.\n\n343\n00:17:09.870 --> 00:17:11.930\nWhat Microsoft is gonna do\nis they're gonna split,\n\n344\n00:17:11.930 --> 00:17:15.560\nthey're gonna replicate your information.\n\n345\n00:17:15.560 --> 00:17:19.120\nWhatever data, there are virtual machines,\nand things that we create.\n\n346\n00:17:19.120 --> 00:17:20.620\nIt's not gonna be just one copy.\n\n347\n00:17:20.620 --> 00:17:23.910\nThey're actually gonna make\nthree copies of this and\n\n348\n00:17:23.910 --> 00:17:26.840\nthey'll replicate it to\ntwo other data centers.\n\n349\n00:17:26.840 --> 00:17:31.620\nSo when I say the eastern US, I'm not\nspecifying a particular data center\n\n350\n00:17:31.620 --> 00:17:35.470\nIt's basically, Microsoft is now gonna\npick three different data centers that\n\n351\n00:17:35.470 --> 00:17:39.380\nare on the eastern side of the US and\nreplicate my data between those three.\n\n352\n00:17:39.380 --> 00:17:44.180\nI can also do geo-redundant which\nmeans now it's gonna pick places that\n\n353\n00:17:44.180 --> 00:17:46.990\nare further away and\nnot in that same region.\n\n354\n00:17:46.990 --> 00:17:50.380\nWhich in the real world, that's probably\nthe option you'd want to go with.\n\n355\n00:17:50.380 --> 00:17:53.698\nIt does add a little bit to\nthe price in the end, but\n\n356\n00:17:53.698 --> 00:17:57.790\nthink you disaster recovery, right?\n\n357\n00:17:57.790 --> 00:18:02.200\nI don't want all my data stored, what if\nwe chose West coast, and all those data\n\n358\n00:18:02.200 --> 00:18:07.050\ncenters over there could be potentially\nsusceptible to the same natural disaster.\n\n359\n00:18:07.050 --> 00:18:08.620\nEarthquake or something like that.\n\n360\n00:18:08.620 --> 00:18:09.630\nOr the Eastern seaboard.\n\n361\n00:18:09.630 --> 00:18:11.650\nWe get a hurricane that comes up and\n\n362\n00:18:11.650 --> 00:18:14.040\nsweeps from Florida all\nthe way up to Maine.\n\n363\n00:18:14.040 --> 00:18:16.870\nPotentially there's that possibility,\nright,\n\n364\n00:18:16.870 --> 00:18:20.410\nthat it hits all three data\ncenters that my data is stored in.\n\n365\n00:18:20.410 --> 00:18:23.670\nSo Geo Redundant would actually\nspread it out even further\n\n366\n00:18:23.670 --> 00:18:25.650\nto avoid that type of situation.\n\n367\n00:18:25.650 --> 00:18:29.370\nI'm gonna leave it on just\nLocally Redundant for this demo.\n\n368\n00:18:29.370 --> 00:18:30.690\nAnd I'll click Create Storage Account.\n\n369\n00:18:32.670 --> 00:18:35.040\nAnd I now have my AD in Azure.\n\n370\n00:18:35.040 --> 00:18:36.960\nWell it's creating, I should say.\n\n371\n00:18:36.960 --> 00:18:37.850\nAnd it's kinda neat.\n\n372\n00:18:37.850 --> 00:18:38.980\nYou can watch it being created.\n\n373\n00:18:38.980 --> 00:18:41.850\nDown here at the bottom,\nI get a little bit of a status bar.\n\n374\n00:18:41.850 --> 00:18:45.850\nYou can see these little moving green\nbars that tells me it's doing something.\n\n375\n00:18:45.850 --> 00:18:48.100\nIt's got one job currently in progress.\n\n376\n00:18:48.100 --> 00:18:52.260\nIf I click on that, it will bring\nup the details of what that job is.\n\n377\n00:18:52.260 --> 00:18:56.970\nYou can see it creating storage\naccount in AD, in Azure,\n\n378\n00:18:56.970 --> 00:18:58.390\nthe name of my storage account there.\n\n379\n00:18:58.390 --> 00:19:00.400\nI can click it again, and it goes away.\n\n380\n00:19:00.400 --> 00:19:03.970\nAnd then we just kind of wait for\nit to create that.\n\n381\n00:19:03.970 --> 00:19:06.250\nNow, that's one thing you\nwill have to get used to.\n\n382\n00:19:06.250 --> 00:19:08.910\nWorking out there with the cloud,\nworking in Azure.\n\n383\n00:19:08.910 --> 00:19:11.660\nIs it is a lot of click and wait, right?\n\n384\n00:19:11.660 --> 00:19:13.890\nBecause they're building this storage,\nright,\n\n385\n00:19:13.890 --> 00:19:16.710\nthey're setting it up to replicate\nacross their data centers.\n\n386\n00:19:16.710 --> 00:19:19.640\nWhen we go to create virtual machines and\nthey've got a template but\n\n387\n00:19:19.640 --> 00:19:23.060\nit has to create a new instance\nof that template, spin it up and\n\n388\n00:19:23.060 --> 00:19:27.230\ngo through the post installation\ntype stuff if you're\n\n389\n00:19:27.230 --> 00:19:30.312\nusing a disc to install\nThe server operating system.\n\n390\n00:19:30.312 --> 00:19:34.760\n>> It's till a whole lot faster than\nbuying a server, racking a server,\n\n391\n00:19:34.760 --> 00:19:39.180\ninstalling the operating system, making\nsure the network connectivity is working.\n\n392\n00:19:39.180 --> 00:19:41.570\nThat tends to take a little time, as well.\n\n393\n00:19:41.570 --> 00:19:45.070\nDoing it this way, so I had to wait\na ten-minute wait for whatever,\n\n394\n00:19:45.070 --> 00:19:49.010\nfor these virtual machines and\nstorage space to provision.\n\n395\n00:19:49.010 --> 00:19:50.790\nWell, Katey bar the door.\n\n396\n00:19:50.790 --> 00:19:52.060\nWhatever we gonna do?\n\n397\n00:19:52.060 --> 00:19:55.350\nThat's a lot nicer than having to\ngo through all that back work.\n\n398\n00:19:55.350 --> 00:19:58.990\nAnd then again, having Microsoft's team,\nhaving Microsoft's hardware and\n\n399\n00:19:58.990 --> 00:20:02.750\nall that they provide through\nusing their cloud services.\n\n400\n00:20:02.750 --> 00:20:05.030\nIt's just so\nmuch benefit to going this way.\n\n401\n00:20:05.030 --> 00:20:06.180\n>> Absolutely.\n\n402\n00:20:06.180 --> 00:20:07.040\nAll right, so let's see.\n\n403\n00:20:07.040 --> 00:20:07.870\nIt has finished.\n\n404\n00:20:07.870 --> 00:20:09.320\nI can see I've got a check mark there.\n\n405\n00:20:09.320 --> 00:20:10.760\nIt is online.\n\n406\n00:20:10.760 --> 00:20:12.910\nIf I look back down on\nmy status bar down here.\n\n407\n00:20:12.910 --> 00:20:17.070\nI still have a one, but notice the green\nbars that are not moving anymore.\n\n408\n00:20:17.070 --> 00:20:21.040\nIf I click on that,\nit will bring up that message again.\n\n409\n00:20:21.040 --> 00:20:25.027\nAnd now it says storage account\nadnasur created successfully.\n\n410\n00:20:25.027 --> 00:20:27.270\nAnd that message actually stays there.\n\n411\n00:20:27.270 --> 00:20:29.900\nYou can click the OK\nbutton to clear it out.\n\n412\n00:20:29.900 --> 00:20:32.730\nCuz you'll have times when\nyou have several tasks going.\n\n413\n00:20:32.730 --> 00:20:37.060\nAnd if you click that little set of green\nbars, and it goes halfway up your screen\n\n414\n00:20:37.060 --> 00:20:40.840\nwith all these different tasks, some of\nthem progress, some of them completed.\n\n415\n00:20:40.840 --> 00:20:42.850\nYou can start clearing out\nthe completed tasks so\n\n416\n00:20:42.850 --> 00:20:45.900\nthat you're only seeing the stuff that's\nin progress, and you'll see that later on.\n\n417\n00:20:45.900 --> 00:20:49.210\nI'll show you an example cuz we're\ngonna have multiple things going on\n\n418\n00:20:49.210 --> 00:20:50.780\nat the same time.\n\n419\n00:20:52.000 --> 00:20:53.170\nSo I'll click on that now.\n\n420\n00:20:53.170 --> 00:20:56.960\nWe can see that I have my storage\naccount has been created.\n\n421\n00:20:56.960 --> 00:20:59.530\nThis is what they call the quick start.\n\n422\n00:20:59.530 --> 00:21:02.640\nAnd if you're new to this,\nthis is a great place to go.\n\n423\n00:21:02.640 --> 00:21:06.390\nAll kinds of tools that we can use,\ninformation,\n\n424\n00:21:06.390 --> 00:21:10.420\nlinks to blogs on what I can\nnow do with this storage.\n\n425\n00:21:10.420 --> 00:21:14.080\nCreating tables,\ncreating blobs to store data up there.\n\n426\n00:21:15.200 --> 00:21:18.230\nLearning about as your\nstorage architecture, so\n\n427\n00:21:18.230 --> 00:21:19.860\nlots of good information there.\n\n428\n00:21:19.860 --> 00:21:21.860\nAs you're more familiar with it,\n\n429\n00:21:21.860 --> 00:21:26.390\nyou might want to check a don't show\nme the quick start next time I visit.\n\n430\n00:21:26.390 --> 00:21:29.160\nAt this icon right over here\nis actually the quick start,\n\n431\n00:21:29.160 --> 00:21:30.650\nyou can always get back to it.\n\n432\n00:21:30.650 --> 00:21:34.720\nBut once you check that, and let's go away\nfrom it for a second and go back to it,\n\n433\n00:21:34.720 --> 00:21:39.150\nyou'll see now it starts out on my\ndashboard instead of that quick start.\n\n434\n00:21:39.150 --> 00:21:42.280\nBut I can get back to the quick start, if\nI wanted to go back and read one of those\n\n435\n00:21:42.280 --> 00:21:45.700\narticles or see if there's any new\ninformation they've posted there.\n\n436\n00:21:45.700 --> 00:21:48.840\nThe dashboard gives you\na nice little status\n\n437\n00:21:48.840 --> 00:21:53.910\nI can see obviously not a lot going on,\nbecause we just created it.\n\n438\n00:21:53.910 --> 00:21:59.360\nBut availability as far as tables and\nblogs go, there is a chance, you can\n\n439\n00:21:59.360 --> 00:22:03.670\ncome down here and look at the end point's\nit's created for connecting up to that.\n\n440\n00:22:03.670 --> 00:22:07.658\nAnd you can see that URL that we created.\n\n441\n00:22:07.658 --> 00:22:10.650\nThere's my\nadinazure.blob.core.windows.net.\n\n442\n00:22:10.650 --> 00:22:16.024\nI want to store tables it's going to\nbe adinazure.table.core.windows.net.\n\n443\n00:22:18.400 --> 00:22:19.000\nSo, we keep going.\n\n444\n00:22:19.000 --> 00:22:21.460\nAnd, then across the board here,\nwe'll come back, and\n\n445\n00:22:21.460 --> 00:22:25.230\nlook at these a little bit closer,\nas we get some activity going on.\n\n446\n00:22:25.230 --> 00:22:26.540\nRight now, I just wanna flip through.\n\n447\n00:22:26.540 --> 00:22:27.900\nYou can monitor.\n\n448\n00:22:27.900 --> 00:22:29.740\nYou can see availability information.\n\n449\n00:22:29.740 --> 00:22:31.940\nAnd, this will be important\nwhen you're troubleshooting, or\n\n450\n00:22:31.940 --> 00:22:34.470\nwhen you're just checking\nstatus on your devices.\n\n451\n00:22:34.470 --> 00:22:39.810\nI love these screens that they give\nus makes it very easy to manage.\n\n452\n00:22:39.810 --> 00:22:45.060\nYou've got containers, import and export,\nso lots of good information there.\n\n453\n00:22:45.060 --> 00:22:48.490\nAgain, we'll come back and look at those\nwhen we have a little more going on so\n\n454\n00:22:48.490 --> 00:22:49.610\nwe can see what's happening.\n\n455\n00:22:49.610 --> 00:22:54.110\nThe last thing I want to show you guys\nin this one, we're just about set up at\n\n456\n00:22:54.110 --> 00:22:57.820\nthis point, we're getting ready\nto start creating things.\n\n457\n00:22:57.820 --> 00:22:59.680\nRight?\nWe've created the storage container\n\n458\n00:22:59.680 --> 00:23:02.270\nto store the stuff that\nwe're gonna create.\n\n459\n00:23:02.270 --> 00:23:08.440\nOne last thing that I wanna show you\nhere is Windows Azure PowerShell.\n\n460\n00:23:08.440 --> 00:23:12.560\nBecause obviously we've talked about\nPowerShell in several different shows.\n\n461\n00:23:12.560 --> 00:23:16.390\nPower Shell is a fantastic way to manage,\nespecially when you need\n\n462\n00:23:16.390 --> 00:23:20.030\nto automate something or\nit's something that you do frequently, and\n\n463\n00:23:20.030 --> 00:23:23.650\nyou don't wanna go through all\nof this logging into a webpage,\n\n464\n00:23:23.650 --> 00:23:27.790\ndealing with maybe slow Internet or\nanything like that.\n\n465\n00:23:27.790 --> 00:23:30.660\nYou know exactly what you wanna do and\nyou just wanna do it real quick.\n\n466\n00:23:30.660 --> 00:23:33.610\nYou can start writing scripts and\nsomebody calls you up and\n\n467\n00:23:33.610 --> 00:23:37.240\nsays we need a new network or\nwe need a new virtual machine.\n\n468\n00:23:37.240 --> 00:23:40.420\nYou can actually write a PowerShell\nscript that's going to do that and\n\n469\n00:23:40.420 --> 00:23:42.840\nthen when they ask you for\none you can just run that script.\n\n470\n00:23:42.840 --> 00:23:46.430\nIt'll reach out to your Azure resource and\nspin that thing out and\n\n471\n00:23:46.430 --> 00:23:47.570\nyou didn't have to go through here and\n\n472\n00:23:47.570 --> 00:23:50.510\ngo through any wizards, everything\nlike that, so it's very powerful.\n\n473\n00:23:50.510 --> 00:23:54.401\n>> Yeah, and Mike, and when you say Azure\nPowerShell that leads me to believe that\n\n474\n00:23:54.401 --> 00:23:56.319\nthis isn't, most operating system,\n\n475\n00:23:56.319 --> 00:24:00.179\nwell the Windows operating systems come\nwith PowerShell already installed.\n\n476\n00:24:00.179 --> 00:24:02.685\nAnd you think okay,\nwell I'll jump into that PowerShell and\n\n477\n00:24:02.685 --> 00:24:03.971\nI'll start dealing with Azure.\n\n478\n00:24:03.971 --> 00:24:05.973\nBut that's not necessarily the case.\n\n479\n00:24:05.973 --> 00:24:10.852\nYou have to actually download like\nthe Azure PowerShell modules to make\n\n480\n00:24:10.852 --> 00:24:12.340\nit actually work.\n\n481\n00:24:12.340 --> 00:24:15.910\n>> Exactly, it's gonna add in just like\nwith everything else with PowerShell,\n\n482\n00:24:15.910 --> 00:24:17.110\nvery modular.\n\n483\n00:24:17.110 --> 00:24:21.260\nDoesn't come with commands that deal with\nAzure because you might not need them.\n\n484\n00:24:21.260 --> 00:24:22.870\nSo if you do need them you\ngotta go out and get them.\n\n485\n00:24:22.870 --> 00:24:24.350\nSo that's what I want to show you next.\n\n486\n00:24:25.450 --> 00:24:27.510\nAnd I think I'm gonna do that right here.\n\n487\n00:24:27.510 --> 00:24:32.980\nBasically, this client I'm on\nright here is a Windows 8 box and\n\n488\n00:24:32.980 --> 00:24:37.465\nI'm treating it like this is my\nnormal desktop at work, right?\n\n489\n00:24:37.465 --> 00:24:42.015\nSo this is where I would want\nto put those Azure PowerShell or\n\n490\n00:24:42.015 --> 00:24:45.305\nimport that Azure PowerShell module\nbecause this is where I sit everyday.\n\n491\n00:24:45.305 --> 00:24:47.485\nI don't want to go over to my server.\n\n492\n00:24:47.485 --> 00:24:48.785\nI don't want to do it on\nmy domain controller.\n\n493\n00:24:48.785 --> 00:24:49.935\nI don't want to do it on my router.\n\n494\n00:24:49.935 --> 00:24:53.545\nI want to do it on my client\nthat I sit at everyday.\n\n495\n00:24:53.545 --> 00:24:57.199\nSo I'm going to just do a quick search for\n\n496\n00:24:57.199 --> 00:25:03.200\nAzure PowerShell and\n\n497\n00:25:03.200 --> 00:25:06.220\nwe will find our little download link for\nthat.\n\n498\n00:25:09.890 --> 00:25:12.810\nThat's not exactly what we want,\nso let's try that again.\n\n499\n00:25:12.810 --> 00:25:13.310\nThere we go.\n\n500\n00:25:17.810 --> 00:25:19.230\nWindows Azure PowerShell.\n\n501\n00:25:19.230 --> 00:25:20.830\nThat's what we want.\n\n502\n00:25:20.830 --> 00:25:28.910\nAnd I should be able to find my\nlittle download link here somewhere.\n\n503\n00:25:28.910 --> 00:25:30.690\n>> Operative word being should there Mike.\n\n504\n00:25:30.690 --> 00:25:31.194\n>> Yeah.\n>> Right?\n\n505\n00:25:31.194 --> 00:25:31.698\n>> [LAUGH]\n\n506\n00:25:31.698 --> 00:25:32.198\n>> [CROSSTALK]\n\n507\n00:25:32.198 --> 00:25:32.765\n>> I don't know why\n\n508\n00:25:32.765 --> 00:25:33.697\n>> Microsoft does that.\n\n509\n00:25:33.697 --> 00:25:34.587\nAny time you look at a KB\n\n510\n00:25:34.587 --> 00:25:37.650\narticle it's like where's the stinking\ndownload section of this?\n\n511\n00:25:37.650 --> 00:25:41.180\n>> So, two pages later there's a link to\nit and I'm sure there's probably, if I\n\n512\n00:25:41.180 --> 00:25:45.160\nspent a little more time going through\nthe search results or if I did a better\n\n513\n00:25:45.160 --> 00:25:49.960\nsearch like download Azure PowerShell I\nmight have gotten a little bit closer.\n\n514\n00:25:49.960 --> 00:25:53.510\nSo I'm going to go ahead save that,\nbring that down.\n\n515\n00:25:53.510 --> 00:25:55.650\nAnd, it's tine, tiny.\n\n516\n00:25:55.650 --> 00:25:56.450\nSo, there it is.\n\n517\n00:25:56.450 --> 00:25:57.700\nI have downloaded it.\n\n518\n00:25:57.700 --> 00:26:00.863\nI'm gonna double-click on it,\nand I'm going to run it.\n\n519\n00:26:04.427 --> 00:26:05.770\nAnd, this opens up.\n\n520\n00:26:05.770 --> 00:26:07.900\nYou know how Microsoft is, now.\n\n521\n00:26:07.900 --> 00:26:12.330\nThey've got this little platform that\nwe can use to download several things,\n\n522\n00:26:12.330 --> 00:26:14.940\nincluding Azure, or Azure PowerShell.\n\n523\n00:26:14.940 --> 00:26:17.460\nSo, I can see up here,\nit's Microsoft Azure PowerShell.\n\n524\n00:26:17.460 --> 00:26:18.420\nAnd I'm going to go ahead and\n\n525\n00:26:18.420 --> 00:26:21.950\nclick install, tells me that I'm\ngoing to have to download that and\n\n526\n00:26:21.950 --> 00:26:25.930\nI'll accept their license agreement and\nit's going to begin the process.\n\n527\n00:26:27.220 --> 00:26:29.200\nI've actually already done this on this,\n\n528\n00:26:29.200 --> 00:26:33.240\nI think I might have already done\nthis on this machine once so\n\n529\n00:26:33.240 --> 00:26:35.950\nwe'll see what it says but I wanted\nto go through the steps for you here.\n\n530\n00:26:37.340 --> 00:26:39.970\nAnd Mike, you didn't have to run\nthe installer as Administrator or\n\n531\n00:26:39.970 --> 00:26:41.640\ndo any right-clicking Run as Admin?\n\n532\n00:26:41.640 --> 00:26:42.580\n>> Not for this part.\n\n533\n00:26:42.580 --> 00:26:43.360\n>> Okay.\n>> Not for this part.\n\n534\n00:26:43.360 --> 00:26:45.630\nNow we are gonna run\nsome commands after this.\n\n535\n00:26:45.630 --> 00:26:50.235\nOnce it gets downloaded, we're gonna run\nsome commands to configure it and for\n\n536\n00:26:50.235 --> 00:26:52.930\nthat we will have to be\nin Administrator mode.\n\n537\n00:26:52.930 --> 00:26:54.449\n>> Got you.\n>> So there we go,\n\n538\n00:26:54.449 --> 00:26:54.960\n>> It is not big.\n\n539\n00:26:56.700 --> 00:26:58.732\nAll right.\nSo it says it's finished.\n\n540\n00:26:58.732 --> 00:27:00.600\nWell, [LAUGH].\n\n541\n00:27:00.600 --> 00:27:02.010\nIt's just a teaser.\n\n542\n00:27:02.010 --> 00:27:04.285\n>> It lied.\nIt lied horribly.\n\n543\n00:27:04.285 --> 00:27:07.120\n[LAUGH] Likes to give you\nhope when it's actually done,\n\n544\n00:27:07.120 --> 00:27:08.550\nyou've got two full green bars.\n\n545\n00:27:08.550 --> 00:27:10.000\nYou're I'm done.\n\n546\n00:27:10.000 --> 00:27:11.020\nNo no, there's another one.\n\n547\n00:27:11.020 --> 00:27:13.295\nLet's erase that one and try that again.\n\n548\n00:27:13.295 --> 00:27:16.710\n[LAUGH]\nAll right,\n\n549\n00:27:16.710 --> 00:27:18.800\njust about 92%, we're almost there.\n\n550\n00:27:18.800 --> 00:27:19.890\n>> It didn't stop at 64.\n\n551\n00:27:19.890 --> 00:27:22.411\n>> It did not, right, and\nthat's only the [CROSSTALK]\n\n552\n00:27:22.411 --> 00:27:23.994\n>> Breaking the mold, yeah.\n\n553\n00:27:23.994 --> 00:27:27.147\n>> All right, there we go, the following\nproduct was successfully installed,\n\n554\n00:27:27.147 --> 00:27:28.490\nMicrosoft Azure PowerShell.\n\n555\n00:27:28.490 --> 00:27:32.160\nI can click Finish and then of\ncourse they want me to download and\n\n556\n00:27:32.160 --> 00:27:33.980\ninstall all kinds of fun stuff.\n\n557\n00:27:33.980 --> 00:27:35.310\nYou guys can play around\nwith that if you want,\n\n558\n00:27:35.310 --> 00:27:37.470\nI'm gonna go ahead and exit out of that.\n\n559\n00:27:37.470 --> 00:27:39.780\nSo now that we've got that downloaded and\ninstalled,\n\n560\n00:27:39.780 --> 00:27:41.730\nwe still like I said need to configure.\n\n561\n00:27:41.730 --> 00:27:44.370\nSo what I'm going to do,\nI'm gonna open up Powershell.\n\n562\n00:27:44.370 --> 00:27:48.620\nThat is the Azure Powershell,\nlet's unpin that so\n\n563\n00:27:48.620 --> 00:27:51.756\nwe can pretend we haven't,\npretend you didn't see that.\n\n564\n00:27:51.756 --> 00:27:54.540\n[LAUGH] This is no the droid\nyou're looking for.\n\n565\n00:27:54.540 --> 00:27:56.625\nSo I'm gonna launch PowerShell here.\n\n566\n00:28:00.164 --> 00:28:01.977\nAnd we'll do it the old school way.\n\n567\n00:28:04.204 --> 00:28:08.076\nAnd I actually need to run\nthat as administrator, so\n\n568\n00:28:08.076 --> 00:28:10.280\nlet me run another one there.\n\n569\n00:28:11.320 --> 00:28:12.360\nQuick easy way to get that up.\n\n570\n00:28:12.360 --> 00:28:16.180\nAll right, so there's my PowerShell\nbeing run as an administrator.\n\n571\n00:28:16.180 --> 00:28:19.070\nLet me bump up my font a little bit so\nyou guys can see what I'm doing.\n\n572\n00:28:20.770 --> 00:28:21.690\nJust a few commands.\n\n573\n00:28:21.690 --> 00:28:22.920\nI won't adjust my window size.\n\n574\n00:28:22.920 --> 00:28:24.730\nWe don't have to worry about that for\nright now.\n\n575\n00:28:24.730 --> 00:28:25.840\nSo a couple commands I'm gonna run.\n\n576\n00:28:25.840 --> 00:28:31.710\nThe first is gonna be\nSet-ExecutionPolicy remotesigned.\n\n577\n00:28:31.710 --> 00:28:33.860\nAll right.\nAnd it's gonna say are you sure you\n\n578\n00:28:33.860 --> 00:28:34.670\nwanna do that?\n\n579\n00:28:34.670 --> 00:28:36.630\nRemember what that allows me to do?\n\n580\n00:28:36.630 --> 00:28:39.160\nThat's gonna give me the ability\nto run remote scripts,\n\n581\n00:28:39.160 --> 00:28:44.410\nscripts that are not located on this\nmachine, only if they're digitally signed.\n\n582\n00:28:44.410 --> 00:28:45.520\nRight?\nIf they're not signed,\n\n583\n00:28:45.520 --> 00:28:47.270\nit'll prevent them from executing.\n\n584\n00:28:47.270 --> 00:28:48.770\nThis is a good practice.\n\n585\n00:28:48.770 --> 00:28:52.200\nYou don't wanna say Run all remote\nscripts, which you could, but\n\n586\n00:28:52.200 --> 00:28:53.680\nthat would be a bad thing.\n\n587\n00:28:53.680 --> 00:28:54.420\nAll right, so there we go.\n\n588\n00:28:54.420 --> 00:28:58.483\nWe got that enabled, and\nthen it's gonna be import,\n\n589\n00:28:58.483 --> 00:29:03.196\nif I can spell that, -module,\nand it's just called Azure.\n\n590\n00:29:05.936 --> 00:29:10.710\nAnd nothing too fancy happened there\nbecause I've already run this once.\n\n591\n00:29:10.710 --> 00:29:13.120\nIf you had not run this before,\n\n592\n00:29:13.120 --> 00:29:17.380\nyou'd see a list of the commands\nscrolling by that it was importing.\n\n593\n00:29:17.380 --> 00:29:19.240\nAnd there's quite a few of them.\n\n594\n00:29:19.240 --> 00:29:24.175\nIn fact, we could do a get -command,\n\n595\n00:29:24.175 --> 00:29:28.467\n-Module azure.\n\n596\n00:29:28.467 --> 00:29:34.100\nAlright, and these are all the commands\nto the same thing if you had run that,\n\n597\n00:29:34.100 --> 00:29:35.420\nand it had been run before.\n\n598\n00:29:35.420 --> 00:29:37.400\nThis is the list that\nwould have scrolled by.\n\n599\n00:29:37.400 --> 00:29:38.200\nAnd you can see,\n\n600\n00:29:38.200 --> 00:29:41.400\njust by how long it took to scroll through\nthere, There's quite a few commands.\n\n601\n00:29:41.400 --> 00:29:41.920\n>> Yeah.\nOne or two.\n\n602\n00:29:41.920 --> 00:29:42.620\n>> One or two, yeah.\n\n603\n00:29:42.620 --> 00:29:43.960\n>> All right.\nSo and\n\n604\n00:29:43.960 --> 00:29:46.260\nyou guys know how to work with\nPowerShell at this point hopefully.\n\n605\n00:29:46.260 --> 00:29:48.520\nIf not, check out our other episodes.\n\n606\n00:29:48.520 --> 00:29:51.180\nYou can filter that down just look for\na particular command and\n\n607\n00:29:51.180 --> 00:29:53.010\nget some help on that as well.\n\n608\n00:29:53.010 --> 00:29:56.470\nSo we have setter execution\npolicy to remote signed.\n\n609\n00:29:56.470 --> 00:29:59.040\nWe have imported the module.\n\n610\n00:29:59.040 --> 00:30:02.940\nNext thing I wanna do is I\ngotta reach out to Azure and\n\n611\n00:30:02.940 --> 00:30:05.050\nI've gotta get my\nconfiguration information.\n\n612\n00:30:05.050 --> 00:30:09.080\nIf I'm gonna do something here\nin PowerShell that I want to\n\n613\n00:30:09.080 --> 00:30:11.550\napply towards Azure, how does it know?\n\n614\n00:30:11.550 --> 00:30:13.860\nHow does it know to reach out to Azure?\n\n615\n00:30:13.860 --> 00:30:20.690\nSo we're gonna do get-azure,\nwhere we at here?\n\n616\n00:30:20.690 --> 00:30:22.960\nIf I type a few more letters here.\n\n617\n00:30:22.960 --> 00:30:23.658\nLet's do that.\n\n618\n00:30:23.658 --> 00:30:28.101\nIs Get-AzurePublishSettingsFile.\n\n619\n00:30:28.101 --> 00:30:32.720\nAlright, and that's gonna take me out\nto Azure because, I've gotta log in and\n\n620\n00:30:32.720 --> 00:30:33.550\nmake sure I have permission.\n\n621\n00:30:33.550 --> 00:30:35.690\nBecause I can't just get anybody's file.\n\n622\n00:30:35.690 --> 00:30:39.280\nSo, do wanna open or save the IT Pro Demo\nto credentials, published settings?\n\n623\n00:30:39.280 --> 00:30:41.720\nNow, it's doing this,\nbecause I was already logged in, right.\n\n624\n00:30:41.720 --> 00:30:45.320\nOn that other tab,\nI'm still logged in to Azure.\n\n625\n00:30:45.320 --> 00:30:49.140\nIf you are not logged in,\nit's gonna prompt you for credentials.\n\n626\n00:30:49.140 --> 00:30:51.720\nAnd then you would be\nable to open this up.\n\n627\n00:30:51.720 --> 00:30:53.351\nSo I'm gonna go ahead and save that.\n\n628\n00:30:54.952 --> 00:30:56.560\nAnd it just takes a second.\n\n629\n00:30:56.560 --> 00:30:59.200\nAnd then I'll show you\nwhere that downloaded.\n\n630\n00:30:59.200 --> 00:31:00.730\nAgain, you can see I've\nalready done it once.\n\n631\n00:31:00.730 --> 00:31:02.200\nBut there's the file.\n\n632\n00:31:02.200 --> 00:31:04.050\nThat it just downloaded, all right?\n\n633\n00:31:04.050 --> 00:31:07.160\nSo you run that command, get-Azure,\n\n634\n00:31:07.160 --> 00:31:10.950\npublish settings file,\nthat's going to reach out to Azure,\n\n635\n00:31:10.950 --> 00:31:15.050\ndownload information about your\nsubscription, and how to connect to it.\n\n636\n00:31:15.050 --> 00:31:19.430\nThen you're going to go\nback over to PowerShell and\n\n637\n00:31:19.430 --> 00:31:21.730\nyou're going to tell\nit where that file is.\n\n638\n00:31:21.730 --> 00:31:26.480\nThis command is going to be\nimport -azurePublishSettingsFile.\n\n639\n00:31:26.480 --> 00:31:32.837\nAnd then you just have\nto tell it where it is.\n\n640\n00:31:32.837 --> 00:31:41.490\nc:\\Users\\Mike\\Downloads\\, I\nthink it started with ITPro.\n\n641\n00:31:41.490 --> 00:31:42.070\nThere we go.\n\n642\n00:31:42.070 --> 00:31:46.850\nITProTV Demo And then the file name\nthat I just downloaded I hit enter, and\n\n643\n00:31:48.520 --> 00:31:54.030\nthen we should be good to go so at this\npoint, I could now start using Azure.\n\n644\n00:31:54.030 --> 00:31:55.770\nStart using Azure, we are using Azure.\n\n645\n00:31:55.770 --> 00:32:00.460\nI can start using Power Shell to\nconfigure resources out there in Azure.\n\n646\n00:32:00.460 --> 00:32:01.470\nSo we'll try, you know,\n\n647\n00:32:01.470 --> 00:32:04.490\nmost of the stuff that we're gonna be\ndoing I wanna go through the GUI so\n\n648\n00:32:04.490 --> 00:32:08.910\nwe can see the wizard and kinda have\na nice understanding of what's going on.\n\n649\n00:32:08.910 --> 00:32:13.038\nYou know, once you get that down pat then\nthat's when you might wanna start playing\n\n650\n00:32:13.038 --> 00:32:18.320\nwith Azure PowerShell and seeing what\nI can automate, but save that until\n\n651\n00:32:18.320 --> 00:32:23.190\nyou're more familiar with Azure and how to\ncreate it through the GUI interface first.\n\n652\n00:32:23.190 --> 00:32:24.080\n>> Excellent stuff, Mike.\n\n653\n00:32:24.080 --> 00:32:26.680\nThis is a great primer on\ngetting started with Azure.\n\n654\n00:32:26.680 --> 00:32:30.230\nTo be honest with you, even if you're\nnot doing Active Directory in Azure,\n\n655\n00:32:30.230 --> 00:32:31.790\nif you just wanted to know about Azure,\n\n656\n00:32:31.790 --> 00:32:36.780\nthis episode alone could stand alone\nto let you get started with that.\n\n657\n00:32:36.780 --> 00:32:39.760\nBecause we've seen how to\nget a demo account set up.\n\n658\n00:32:39.760 --> 00:32:42.460\nWe've seen the different types\nof portals that they have.\n\n659\n00:32:42.460 --> 00:32:45.690\nAnd even connecting it to\nit through the PowerShell.\n\n660\n00:32:45.690 --> 00:32:49.175\nWhich is something that if you're working\nwith Azure in a real environment,\n\n661\n00:32:49.175 --> 00:32:51.080\nyou're probably going to be doing.\n\n662\n00:32:51.080 --> 00:32:52.450\nMike is there anything else\nthat we need to know for\n\n663\n00:32:52.450 --> 00:32:54.080\nthis episode when it comes to Azure?\n\n664\n00:32:54.080 --> 00:32:55.040\n>> I don't think so.\n\n665\n00:32:55.040 --> 00:32:58.260\nAt this point we're set up we are ready\nto actually start creating some\n\n666\n00:32:58.260 --> 00:32:59.210\nresources out there.\n\n667\n00:32:59.210 --> 00:33:01.260\n>> Well we are definitely\nlooking forward to that.\n\n668\n00:33:01.260 --> 00:33:02.560\nHopefully you guys are as well.\n\n669\n00:33:02.560 --> 00:33:05.870\nMike thanks so much for joining us\ntoday and thank you all for watching.\n\n670\n00:33:05.870 --> 00:33:07.700\nWe're gonna go ahead and\nsign for IT Pro TV.\n\n671\n00:33:07.700 --> 00:33:09.360\nI've been your host Daniel Lowrie.\n\n672\n00:33:09.360 --> 00:33:10.160\n>> And I'm Mike Roderick.\n\n673\n00:33:10.160 --> 00:33:11.583\n>> And we'll see you next time.\n\n674\n00:33:11.583 --> 00:33:18.750\n[SOUND]\n\n",
          "vimeoId": "155033973"
        },
        {
          "description": "In this episode, Daniel and Mike show you how to prepare your Azure environment for connecting to your on-premises network. They begin by registering the on-premises and Azure DNS servers in Azure networking. Then they create a virtual network in Azure and prepare the site-to-site VPN so that both environments can start accessing each other.",
          "length": "2424",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-2-build_an_azure_virtual_network-021116-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-2-build_an_azure_virtual_network-021116-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-2-build_an_azure_virtual_network-021116-1-sm.jpg",
          "title": "Build an Azure Virtual Network",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.128 --> 00:00:16.683\nAll right, greetings everyone, and welcome\nto another great episode of ITProTV,\n\n3\n00:00:16.683 --> 00:00:18.491\nI'm your host, Daniel Lowrie.\n\n4\n00:00:18.491 --> 00:00:22.410\nAnd in today's episode, well, we are\ncontinuing on with our Active Directory\n\n5\n00:00:22.410 --> 00:00:26.098\nand Azure series that we've been\nworking very hard on, very diligently,\n\n6\n00:00:26.098 --> 00:00:27.540\nmaking some progress.\n\n7\n00:00:27.540 --> 00:00:31.290\nJoining us back in the studio again\ntoday to help us make even more progress\n\n8\n00:00:31.290 --> 00:00:33.010\nis our good friend Mr. Mike Rodrick.\n\n9\n00:00:33.010 --> 00:00:34.400\nMike, welcome back to the show, sir.\n\n10\n00:00:34.400 --> 00:00:35.300\nHow's it going today.\n\n11\n00:00:35.300 --> 00:00:36.850\n>> It's going great Daniel,\nI'm glad to be here.\n\n12\n00:00:36.850 --> 00:00:40.188\nExcited to be working with, of course,\nActive Directory, one of my favorites.\n\n13\n00:00:40.188 --> 00:00:45.413\nAnd now getting out into the cloud and,\nmore specifically, Microsoft Azure.\n\n14\n00:00:45.413 --> 00:00:49.180\nTying that together with my favorite,\nActive Directory, what could be better?\n\n15\n00:00:50.690 --> 00:00:51.650\n>> A match made in heaven, Michael.\n\n16\n00:00:51.650 --> 00:00:52.650\n>> It really is, it really is.\n\n17\n00:00:52.650 --> 00:00:57.210\nSo let's recap and figure out where the\nheck we are so we know where we're going\n\n18\n00:00:57.210 --> 00:01:01.020\nin this particular episode, just in case\nyou fast forwarded through the other ones.\n\n19\n00:01:01.020 --> 00:01:02.990\nGo back and watch them,\nthey're really good, I promise.\n\n20\n00:01:02.990 --> 00:01:06.550\nBut we've got our internal,\nour corporate network set up, right.\n\n21\n00:01:06.550 --> 00:01:11.759\nWe've got our domain controller obviously\nrunning Active Directory as well as DNS,\n\n22\n00:01:11.759 --> 00:01:15.899\nand that's on a nice internal subnet,\n10.1.1.0/24.\n\n23\n00:01:15.899 --> 00:01:20.117\nI've also got a Windows Server 2012\nr2 running routing and remote access.\n\n24\n00:01:20.117 --> 00:01:24.435\nThat's sitting in between that internal\nsubnet and the World Wide Web or\n\n25\n00:01:24.435 --> 00:01:26.696\nthe Internet or the outside.\n\n26\n00:01:26.696 --> 00:01:29.879\nHe's running routing and\nremote access so he's gonna\n\n27\n00:01:29.879 --> 00:01:34.653\nbe routing traffic out there to the web,\nas well as network address translation so\n\n28\n00:01:34.653 --> 00:01:38.064\nthat those private IP addresses\ncan get routed out there.\n\n29\n00:01:38.064 --> 00:01:42.850\nAnd then within Active Directory we\nwent ahead and created our sites.\n\n30\n00:01:42.850 --> 00:01:48.550\nOne to represent our on-premises network,\nthat 10.1.1.0/24.\n\n31\n00:01:48.550 --> 00:01:56.665\nAnd then we're going to build another\nnetwork out in Azure, 10.1.2.0/24.\n\n32\n00:01:56.665 --> 00:01:58.245\nWe went ahead an created a site for\n\n33\n00:01:58.245 --> 00:02:01.450\nthat in Active Directory even\nthough it's not created yet.\n\n34\n00:02:01.450 --> 00:02:04.840\nRemember, cuz we were talking about how\nI wanna make sure that once I start\n\n35\n00:02:04.840 --> 00:02:06.510\nbuilding that network in Azure,\n\n36\n00:02:06.510 --> 00:02:10.420\nwhen I start setting up that domain\ncontroller, that it can reach out and\n\n37\n00:02:10.420 --> 00:02:14.000\ntalk to my existing domain controller and\nnot have any issues, right.\n\n38\n00:02:14.000 --> 00:02:16.730\nIf I go up there and I try to\nbuild a replica domain controller,\n\n39\n00:02:16.730 --> 00:02:19.230\nadd a domain controller to\nan existing domain, and\n\n40\n00:02:19.230 --> 00:02:23.390\nit can't find the existing domain,\nit's not gonna work out that well, right?\n\n41\n00:02:23.390 --> 00:02:25.987\nAnd remember the KCC the knowledge\nconsistency checker,\n\n42\n00:02:25.987 --> 00:02:27.630\nthe intersite topology generator,\n\n43\n00:02:27.630 --> 00:02:31.348\nthose guys are gonna start building that\nreplication topology in the background.\n\n44\n00:02:31.348 --> 00:02:33.977\nAnd if there's no connection to\nthe other domain controller,\n\n45\n00:02:33.977 --> 00:02:36.010\nthat's not gonna work out well either.\n\n46\n00:02:36.010 --> 00:02:38.840\nAll of those can be fixed but why, right?\n\n47\n00:02:38.840 --> 00:02:42.360\nWhy not just go ahead and set it up in\nthe right order in the first place?\n\n48\n00:02:42.360 --> 00:02:45.340\nAnd you don't have to worry about\ngoing back and looking at errors and\n\n49\n00:02:45.340 --> 00:02:48.160\ntrying to clean things\nup in Active Directory.\n\n50\n00:02:48.160 --> 00:02:50.160\nSo that's where we're at at this point.\n\n51\n00:02:50.160 --> 00:02:52.120\nWe've taken a look at Azure itself.\n\n52\n00:02:52.120 --> 00:02:54.190\nWe've talked about the subscriptions.\n\n53\n00:02:54.190 --> 00:02:57.930\nWe talked about the different portals\nthat we can use to manage Azure.\n\n54\n00:02:57.930 --> 00:03:00.960\nThe classic versus the new portal\nthat they're coming out with, or\n\n55\n00:03:00.960 --> 00:03:04.510\nthat they've come out with and\nis being updated as we speak.\n\n56\n00:03:04.510 --> 00:03:07.710\nWe talked about Azure PowerShell,\nI showed you how to download that,\n\n57\n00:03:07.710 --> 00:03:09.238\nget that installed on a machine.\n\n58\n00:03:09.238 --> 00:03:14.540\nIt gives you access to work with\nyour Azure services from PowerShell.\n\n59\n00:03:14.540 --> 00:03:18.250\nI love the web interface, but there are\ntimes I wanna automate things, I wanna be\n\n60\n00:03:18.250 --> 00:03:24.790\nable to whip out a new virtual machine up\nthere in Azure on the fly or very quickly.\n\n61\n00:03:24.790 --> 00:03:29.160\nJust a standard server with a hard\ndrive of a certain size and\n\n62\n00:03:29.160 --> 00:03:32.840\na VM of a certain size,\nI could script all that out using Azure.\n\n63\n00:03:32.840 --> 00:03:35.790\nSo a lot of cool things you can do with\nPowerShell and hopefully we'll have time\n\n64\n00:03:35.790 --> 00:03:38.680\nlater on to actually go back and\nlook at some of the stuff.\n\n65\n00:03:38.680 --> 00:03:40.550\nBut as we're learning it's a lot easier,\nI think,\n\n66\n00:03:40.550 --> 00:03:43.440\nto go through the graphical\nuser interface.\n\n67\n00:03:43.440 --> 00:03:47.020\nOnce we get our feet wet and we understand\nwhat's going on, then we can go back and\n\n68\n00:03:47.020 --> 00:03:49.670\nmaybe take a look at actually\ndoing some scripting.\n\n69\n00:03:49.670 --> 00:03:54.095\nSo our next step, right,\nis we're gonna go out to Azure and\n\n70\n00:03:54.095 --> 00:03:56.851\nwe need to register our DNS servers.\n\n71\n00:03:56.851 --> 00:04:00.340\nWe need to let Azure know\nwhere our DNS servers are.\n\n72\n00:04:00.340 --> 00:04:03.740\nBecause when I start building new\nvirtual machines up there in Azure\n\n73\n00:04:03.740 --> 00:04:08.010\nthey get their TCP/IP\nconfiguration through DHCP.\n\n74\n00:04:08.010 --> 00:04:11.310\nAnd so it's gonna pass them out\ntheir IP address, their subnet mask,\n\n75\n00:04:11.310 --> 00:04:15.470\ntheir default gateway, as well as their\npreferred and alternate DNS servers.\n\n76\n00:04:15.470 --> 00:04:19.074\nSo that's the first thing we need to do so\nthat when we build these VMs,\n\n77\n00:04:19.074 --> 00:04:20.550\nthey get that information.\n\n78\n00:04:20.550 --> 00:04:25.780\nBecause DHCP in Azure is a little bit\ndifferent from DHCP that we're used to.\n\n79\n00:04:25.780 --> 00:04:31.480\nIt's still dynamic, the machine boots\nup and it requests an IP address.\n\n80\n00:04:31.480 --> 00:04:35.720\nDHCP hears that request and\nis going to provide that information.\n\n81\n00:04:35.720 --> 00:04:36.548\nBut once it does,\n\n82\n00:04:36.548 --> 00:04:39.988\nactually that information is persistent\nthroughout the life of that VM.\n\n83\n00:04:39.988 --> 00:04:44.466\nAs long as you don't decommission that VM,\nit'll maintain or\n\n84\n00:04:44.466 --> 00:04:46.640\nkeep that same IP address.\n\n85\n00:04:46.640 --> 00:04:50.595\nSo dynamic in the assignment, but\nit's almost like a reservation,\n\n86\n00:04:50.595 --> 00:04:53.268\nis really what it's\ndoing in the background.\n\n87\n00:04:53.268 --> 00:04:56.451\nWhich is a good thing because,\nlike domain controllers, they\n\n88\n00:04:56.451 --> 00:05:00.910\nreally should have static IP addresses, I\ndon't want their IP address ever changing.\n\n89\n00:05:00.910 --> 00:05:03.620\nMy DNS servers,\ntheir IP addresses shouldn't change.\n\n90\n00:05:03.620 --> 00:05:07.050\nAnd you think well, how are you\ngonna do that if you're using DHCP?\n\n91\n00:05:07.050 --> 00:05:10.780\nBecause it does reservations and\nthey maintain that throughout, it's okay.\n\n92\n00:05:10.780 --> 00:05:12.450\nThey get assigned it dynamically but\n\n93\n00:05:12.450 --> 00:05:14.730\nthen they keep that so\nwe don't end up changing those.\n\n94\n00:05:14.730 --> 00:05:17.170\nAgain, as long as you don't\ndecommission those VMs.\n\n95\n00:05:17.170 --> 00:05:19.530\nSo let's take a look at my screen here and\nthe first thing, as I said,\n\n96\n00:05:19.530 --> 00:05:22.530\nwe're gonna do is register\nthose DNS servers.\n\n97\n00:05:22.530 --> 00:05:26.190\nAnd we do that through, I've logged\nonto the classic portal here and\n\n98\n00:05:26.190 --> 00:05:31.060\nI'm gonna scroll down and find networking,\nor networks as they like to call it.\n\n99\n00:05:31.060 --> 00:05:33.220\nAnd it tells me I have nothing so far,\n\n100\n00:05:33.220 --> 00:05:38.530\nno virtual networks,\nno local networks and no DNS servers.\n\n101\n00:05:38.530 --> 00:05:39.740\nSo that's where we're gonna go.\n\n102\n00:05:39.740 --> 00:05:43.272\nNow, you can click here,\nyou can click Register a DNS Server and\n\n103\n00:05:43.272 --> 00:05:45.180\nit actually opens up this screen.\n\n104\n00:05:45.180 --> 00:05:47.776\nJust understand that you could\nalso do it the long way.\n\n105\n00:05:47.776 --> 00:05:53.020\nNew, and\nthen Network Services Virtual Network and\n\n106\n00:05:53.020 --> 00:05:54.430\nthen we're gonna do Custom Create.\n\n107\n00:05:54.430 --> 00:05:57.452\nAnd you know what, I didn't pay attention\nif that went to Custom Create or\n\n108\n00:05:57.452 --> 00:05:58.490\nlet me select.\n\n109\n00:05:58.490 --> 00:05:59.970\nSee, it goes to Register DNS Server.\n\n110\n00:05:59.970 --> 00:06:03.500\nSorry, I said Custom Create, Register\nDNS Server is actually what we want.\n\n111\n00:06:03.500 --> 00:06:06.350\nSo either way you go you\nget to the same place.\n\n112\n00:06:06.350 --> 00:06:08.290\nWe come over here and\nwe start giving them names.\n\n113\n00:06:08.290 --> 00:06:09.540\nNow, when you name this,\n\n114\n00:06:09.540 --> 00:06:14.070\nit really doesn't have to be the name\nof the machine that's running DNS.\n\n115\n00:06:14.070 --> 00:06:15.239\nAlthough logically,\n\n116\n00:06:15.239 --> 00:06:19.119\nit might help you keep track of things\nif you did use their actual host name.\n\n117\n00:06:19.119 --> 00:06:27.020\nSo that's what I'm gonna do, gnv-dc01 is\ngoing to be my on-premises DNS server.\n\n118\n00:06:27.020 --> 00:06:29.490\nI'm gonna put his IP address in there,\n10.1.1.10,\n\n119\n00:06:29.490 --> 00:06:32.520\nand I'll register that DNS server.\n\n120\n00:06:33.680 --> 00:06:38.338\nAnd now I can see I have one, it's in\nprogress and there it goes, it finished.\n\n121\n00:06:38.338 --> 00:06:44.370\nAnd I'm gonna do it again, New >\nVirtual Network > Register DNS Server.\n\n122\n00:06:44.370 --> 00:06:49.104\nThis one doesn't exist yet,\nbut I'm gonna go ahead and\n\n123\n00:06:49.104 --> 00:06:53.837\ncreate the registration for\nit anyway, az.dc01 and\n\n124\n00:06:53.837 --> 00:06:58.284\nthat's going to end up being 10.1.2.10.\n\n125\n00:06:58.284 --> 00:07:01.630\nAll right, and\nI'll register that DNS server.\n\n126\n00:07:01.630 --> 00:07:04.800\nThere I've my two DNS servers registered.\n\n127\n00:07:04.800 --> 00:07:08.704\nWe are good to go there, now when it\nstarts passing out TCP/IP configuration to\n\n128\n00:07:08.704 --> 00:07:11.516\nmy new virtual machines,\nthey'll have their DNS info.\n\n129\n00:07:11.516 --> 00:07:14.662\nAll right, we'll let that,\nit looks like it's still going.\n\n130\n00:07:14.662 --> 00:07:18.224\nI wanna make sure that completes\nthere before I move on.\n\n131\n00:07:18.224 --> 00:07:21.661\n>> And obviously Mike,\nwe're using our own DNS servers.\n\n132\n00:07:21.661 --> 00:07:25.318\nBecause obviously using something\nfrom the web, one of those 4.2.2s or\n\n133\n00:07:25.318 --> 00:07:27.287\n8.8.8.8 or something like that,\n\n134\n00:07:27.287 --> 00:07:30.910\nis not gonna give us what we want because\nit doesn't know about our servers.\n\n135\n00:07:30.910 --> 00:07:34.240\nThat's why we register our\nservers with our systems.\n\n136\n00:07:34.240 --> 00:07:37.044\n>> Exactly, you might be able\nto resolve website names and\n\n137\n00:07:37.044 --> 00:07:40.695\nthings like that but what about your\nfile servers, your print servers?\n\n138\n00:07:40.695 --> 00:07:42.552\nHow does it log on,\nconnect to your domain controllers?\n\n139\n00:07:42.552 --> 00:07:43.620\nSo we'll go ahead and\n\n140\n00:07:43.620 --> 00:07:47.360\ndismiss those completed messages,\nwe are good to go there.\n\n141\n00:07:47.360 --> 00:07:48.490\nSo now that we've got that done,\n\n142\n00:07:48.490 --> 00:07:52.360\nthe next thing is going to be\ncreate a new virtual network.\n\n143\n00:07:52.360 --> 00:07:56.070\nSo again, I could use my New button,\nI can click the handy dandy link up here.\n\n144\n00:07:56.070 --> 00:07:59.328\nAnd it should be the same location,\nlet's just double check that,\n\n145\n00:07:59.328 --> 00:08:01.625\ncreate a virtual network,\nname and location.\n\n146\n00:08:01.625 --> 00:08:06.132\nIf we go down here, new > network\n> virtual network > custom create,\n\n147\n00:08:06.132 --> 00:08:09.150\nand you'll see the screen\nis exactly the same.\n\n148\n00:08:09.150 --> 00:08:11.780\nSo it doesn't really\nmatter which way you go.\n\n149\n00:08:11.780 --> 00:08:18.370\nAnd for this virtual network I'm going\nto call this one my Azure subnet.\n\n150\n00:08:21.710 --> 00:08:24.890\nMaybe or something like that or\nI don't know.\n\n151\n00:08:24.890 --> 00:08:28.010\nI always get, so indecisive with\nnames cuz it's so permanent.\n\n152\n00:08:28.010 --> 00:08:31.540\nOnce I name them I'm like aah what\ndo I do I'm just not creative.\n\n153\n00:08:31.540 --> 00:08:32.290\nWe'll call it subnet.\n\n154\n00:08:33.500 --> 00:08:34.570\nEasy, subnet.\n\n155\n00:08:34.570 --> 00:08:39.240\nI'm gonna store it in the East location\nthat's where I am it's closest to me.\n\n156\n00:08:39.240 --> 00:08:42.320\nAnd I'll go ahead and\nit's kinda hard to see on my resolution.\n\n157\n00:08:42.320 --> 00:08:45.914\nSee a little check mark, or\nI'm sorry a little arrow down here,\n\n158\n00:08:45.914 --> 00:08:48.645\nallowing me to move to the next screen.\n\n159\n00:08:48.645 --> 00:08:51.697\nThank you, that was behind my head,\nI hope you guys saw that,\n\n160\n00:08:51.697 --> 00:08:54.574\nand now my DNS servers,\nI'm gonna hit my drop down list and\n\n161\n00:08:54.574 --> 00:08:57.780\nthere's my DNS servers that\nhave already registered.\n\n162\n00:08:57.780 --> 00:09:01.420\nSo I'm gonna select it and\nas it pulls the IP address right in and\n\n163\n00:09:01.420 --> 00:09:03.140\nI'm gonna do my Azure-1.\n\n164\n00:09:03.140 --> 00:09:06.670\nAlso notice that I did\nthe On-Premises DNS Server first and\n\n165\n00:09:06.670 --> 00:09:10.490\nthen the Azure DNS Server, the server\nthat's gonna exist out there in Azure.\n\n166\n00:09:10.490 --> 00:09:14.140\nAnd that's the way you wanna do it,\nyou wanna do your On-Premise first.\n\n167\n00:09:14.140 --> 00:09:17.510\nWe're also gonna wanna set up\nsite-to-site connectivity.\n\n168\n00:09:17.510 --> 00:09:20.500\nConfigure a site to site VPN.\n\n169\n00:09:20.500 --> 00:09:24.030\nSo that's gonna be what\nconnects my localary network,\n\n170\n00:09:24.030 --> 00:09:29.540\nmy internal network here on premises, with\nmy Azure subnet out there in the Cloud.\n\n171\n00:09:29.540 --> 00:09:31.500\nSo go ahead and click next.\n\n172\n00:09:33.170 --> 00:09:35.740\nAll right, and\non my site to site connectivity here,\n\n173\n00:09:35.740 --> 00:09:38.640\nwe're looking at my address space.\n\n174\n00:09:38.640 --> 00:09:42.740\nThis is the network, this is my\nlocal network that it wants me to,\n\n175\n00:09:42.740 --> 00:09:46.300\nyou see the yellow box here\naround my local network.\n\n176\n00:09:46.300 --> 00:09:48.710\nI'm gonna do my ITProTV LAN.\n\n177\n00:09:53.980 --> 00:09:59.800\nAnd my VPN device IP address,\nthat's the IP address of my, what Daniel?\n\n178\n00:09:59.800 --> 00:10:01.740\nI don't think I brought that with me.\n\n179\n00:10:01.740 --> 00:10:02.895\n>> [CROSSTALK] Shame, shame Michael.\n\n180\n00:10:02.895 --> 00:10:05.735\n>> Yeah,\ngotta get that public IP address so\n\n181\n00:10:05.735 --> 00:10:09.865\nwhat we wanna do is flip over\nto my router real quick and.\n\n182\n00:10:09.865 --> 00:10:14.083\n>> [NOISE]\n>> One of\n\n183\n00:10:14.083 --> 00:10:17.078\nthose nice features of actually\nworking in the Cloud and\n\n184\n00:10:17.078 --> 00:10:21.170\nyour own servers cause you can access\nboth from the same workstation.\n\n185\n00:10:21.170 --> 00:10:24.450\nHave everything right there at hand and\nall you gotta do is jump over there and\n\n186\n00:10:24.450 --> 00:10:25.320\nget it.\n\n187\n00:10:25.320 --> 00:10:26.980\n>> There it is, so\nwe're gonna right that down,\n\n188\n00:10:26.980 --> 00:10:28.855\nright real quick cuz my memory is so\ngreat.\n\n189\n00:10:28.855 --> 00:10:33.472\n2-0-9, 251, 133, 154,\nwe'll flip back over here and\n\n190\n00:10:33.472 --> 00:10:38.317\nyou can see when I hover over that enter\nthe IP address of your local router and\n\n191\n00:10:38.317 --> 00:10:43.238\nI didn't show you this one, enter the name\nfor your local network and my local\n\n192\n00:10:43.238 --> 00:10:48.419\nnetwork exist, it's not like I'm creating\nit, I have to tell as your about it.\n\n193\n00:10:48.419 --> 00:10:51.940\nMy VPN device again that is\ngonna be 209 Oops .251.133.154.\n\n194\n00:10:51.940 --> 00:10:55.530\n>> The name is really like a label for\n\n195\n00:10:55.530 --> 00:11:02.150\nthe network itself, so\nthat you can easily reference it.\n\n196\n00:11:02.150 --> 00:11:06.510\nIt's not like I'm saying this is the name\nor the full even DNS name of that network,\n\n197\n00:11:06.510 --> 00:11:09.380\nit's just basically a label\ngoing this is this network.\n\n198\n00:11:09.380 --> 00:11:09.930\nIf I have three or\n\n199\n00:11:09.930 --> 00:11:13.930\nfour networks all have different names and\nwhich one it is that you need to access.\n\n200\n00:11:13.930 --> 00:11:15.030\n>> Yep, exactly right.\n\n201\n00:11:15.030 --> 00:11:16.410\nHey, cuz you might have more than one.\n\n202\n00:11:16.410 --> 00:11:18.652\nYou might have more than one on premises,\n\n203\n00:11:18.652 --> 00:11:23.156\nyou might have more than one premises that\nare all connecting up there to the Cloud.\n\n204\n00:11:23.156 --> 00:11:27.208\nSo my address space for\nmy network here is 1.0.1., oops, well,\n\n205\n00:11:27.208 --> 00:11:28.770\nlet's just do it this way.\n\n206\n00:11:28.770 --> 00:11:31.630\nWe'll do 10.1.1.0 is\nwhere I want to start.\n\n207\n00:11:32.780 --> 00:11:36.382\nI'll do one really because that\nwouldn't be a valid IP address and\n\n208\n00:11:36.382 --> 00:11:40.177\nthen we'll tell it we're using\na /24 pulls all that out and\n\n209\n00:11:40.177 --> 00:11:43.477\nthat's not gonna like that,\nlet's put that back to a zero.\n\n210\n00:11:43.477 --> 00:11:45.864\nYeah, it says starting IP address but\n\n211\n00:11:45.864 --> 00:11:51.100\nthen it pulled the wrong address space ,so\nlet's just make sure we use that there.\n\n212\n00:11:51.100 --> 00:11:55.360\nSo now I should go from 10.1.0 all\nthe way up to 10.1.1 that 255,\n\n213\n00:11:55.360 --> 00:11:58.040\nso we should be good to go there.\n\n214\n00:11:58.040 --> 00:12:01.330\nI'll go ahead and click next, and\n\n215\n00:12:01.330 --> 00:12:05.840\nnow I can see that this is my\nvirtual network address space.\n\n216\n00:12:05.840 --> 00:12:08.020\nNotice it already picked an address space.\n\n217\n00:12:09.280 --> 00:12:10.130\nHow the heck did it do that?\n\n218\n00:12:10.130 --> 00:12:14.890\nIt's psychic, it read my mind,\nit knew exactly what I wanted to set up.\n\n219\n00:12:14.890 --> 00:12:17.626\nI registered that DNS address,\n\n220\n00:12:17.626 --> 00:12:22.710\ntid.2.10 and\nit figured that's probably what I'm using.\n\n221\n00:12:22.710 --> 00:12:26.700\nI can always change that if I needed to\nfor some reason but that's perfectly fine.\n\n222\n00:12:26.700 --> 00:12:28.710\nI really don't need to create\nany additional subnet,\n\n223\n00:12:28.710 --> 00:12:33.260\nyou can see it's actually breaking\nup one subnet and giving me about\n\n224\n00:12:33.260 --> 00:12:38.180\n30 addresses there that I can use, I could\nchange that if I want, if I needed more or\n\n225\n00:12:38.180 --> 00:12:43.430\nless in that virtual network that I'm\ncreating up there, so we should be good.\n\n226\n00:12:43.430 --> 00:12:45.980\nAnd then I'm gonna add my gateway subnet.\n\n227\n00:12:45.980 --> 00:12:50.340\nThe gateway subnet again is gonna\nlie right on the edge of my\n\n228\n00:12:50.340 --> 00:12:54.110\nvirtual network and the outside world.\n\n229\n00:12:54.110 --> 00:12:58.740\nIt's kind of like a DMZ, but\nwe don't really put anything out there\n\n230\n00:12:58.740 --> 00:13:02.500\nthis is where like the cloud\nservices are going to create\n\n231\n00:13:02.500 --> 00:13:06.890\nbasically the edge router that's going\nto route traffic to the outside.\n\n232\n00:13:06.890 --> 00:13:12.110\nThat's where my VPN end point on\nMicrosoft end is gonna reside.\n\n233\n00:13:12.110 --> 00:13:12.620\nAll right.\n\n234\n00:13:12.620 --> 00:13:16.180\nSo I just click add gateway seven and\nyou'll see it adds a very tiny space.\n\n235\n00:13:16.180 --> 00:13:19.060\nIt looks like I've got about\neight addresses in there.\n\n236\n00:13:19.060 --> 00:13:23.115\nAgain, and I typically I've never really\nfound I need to put it in that subnet, but\n\n237\n00:13:23.115 --> 00:13:24.985\nwe do need to create it.\n\n238\n00:13:24.985 --> 00:13:29.575\nAnd then we'll click, check mark for\nthe fact that we're done.\n\n239\n00:13:29.575 --> 00:13:33.895\nAnd ti should go through the process\nof creating my Azure subnet.\n\n240\n00:13:33.895 --> 00:13:37.705\nNow with your naming convention there\nagain, you might have more than one, so\n\n241\n00:13:37.705 --> 00:13:40.630\nthat naming convention's\nnot going to fly too well\n\n242\n00:13:40.630 --> 00:13:41.785\nI told you I'm just not very creative.\n\n243\n00:13:41.785 --> 00:13:44.500\n[LAUGH] Always have to go back and change\nthings, but you actually could go back and\n\n244\n00:13:44.500 --> 00:13:46.470\nchange that if you needed to.\n\n245\n00:13:46.470 --> 00:13:51.440\nAll right, so we'll watch\nthe little bars go back and forth,\n\n246\n00:13:51.440 --> 00:13:56.410\nlet that get created and\nthat gets us most of the way there.\n\n247\n00:13:56.410 --> 00:13:58.500\nRight?\nWe'll see that we've kind of got\n\n248\n00:13:58.500 --> 00:14:02.310\neverything set up on the internal side.\n\n249\n00:14:02.310 --> 00:14:02.920\nAll right.\n\n250\n00:14:02.920 --> 00:14:06.130\nWe've got everything set\nup now on the cloud side.\n\n251\n00:14:06.130 --> 00:14:08.750\nWe still have to create\nthe gateway itself.\n\n252\n00:14:08.750 --> 00:14:11.600\nWe've got the gateway subnet created.\n\n253\n00:14:11.600 --> 00:14:15.980\nBut the gateway is the actual VPN and\nend point that I'm gonna connect to\n\n254\n00:14:15.980 --> 00:14:20.770\nthat resides in that gateway subnet,\nso that we still have to create.\n\n255\n00:14:21.870 --> 00:14:24.610\nSo I click OK here and\nI'll show you what I mean.\n\n256\n00:14:24.610 --> 00:14:28.060\nNow that I've got my virtual network\nyou'll see I have my local network.\n\n257\n00:14:28.060 --> 00:14:31.690\nThere's ITProTV's LAN,\nright we can see that,\n\n258\n00:14:31.690 --> 00:14:34.650\nI've got my DNS servers\nthat are registered.\n\n259\n00:14:34.650 --> 00:14:39.140\nGo back over here to my virtual networks\nan I can click on the name, AZ Subnet,\n\n260\n00:14:39.140 --> 00:14:43.960\nand that'll take me into a little bit\nof details about that virtual network.\n\n261\n00:14:43.960 --> 00:14:46.820\nNow you've got the quick start which\nhas some really good information if\n\n262\n00:14:46.820 --> 00:14:49.640\nyou're new at this and\nyou wanna learn a little more about it.\n\n263\n00:14:49.640 --> 00:14:51.700\nAnd they've got some\ngreat links to articles.\n\n264\n00:14:51.700 --> 00:14:54.550\nNetworking overview,\nname resolution overview,\n\n265\n00:14:54.550 --> 00:14:59.350\ndesign considerations for\nAD domain services, site to site.\n\n266\n00:14:59.350 --> 00:15:02.150\nSo maybe you want to take\na little time and read those.\n\n267\n00:15:02.150 --> 00:15:04.500\nOnce you're reading them,\nyou don't wanna see that anymore.\n\n268\n00:15:04.500 --> 00:15:07.860\nYou check Skip the Quick Start\nthe next time I visit.\n\n269\n00:15:07.860 --> 00:15:10.620\nAnd this screen will still be available,\nbut it won't start here.\n\n270\n00:15:10.620 --> 00:15:11.800\nIn fact I'll show you what I mean.\n\n271\n00:15:11.800 --> 00:15:14.500\nIf I go back, now I click on my network.\n\n272\n00:15:14.500 --> 00:15:15.880\nNotice it starts on dashboard.\n\n273\n00:15:15.880 --> 00:15:16.830\nThe screen is still there.\n\n274\n00:15:16.830 --> 00:15:20.480\nI can click on it and get to it,\nbut it just doesn't start there.\n\n275\n00:15:20.480 --> 00:15:23.860\nSo this is the dashboard for\nmy virtual subnet that I just created.\n\n276\n00:15:23.860 --> 00:15:26.810\nGive it chance to do its\nlittle circley refresh.\n\n277\n00:15:28.860 --> 00:15:31.330\nPull the information back\nabout my virtual subnet.\n\n278\n00:15:32.840 --> 00:15:35.740\n>> I love the fact that you were there,\nyou clicked off of it.\n\n279\n00:15:35.740 --> 00:15:39.305\nYou come back and it's like, well hold\non now, I better check this again.\n\n280\n00:15:39.305 --> 00:15:41.160\n[LAUGH]\n>> I clicked a little too fast for it.\n\n281\n00:15:41.160 --> 00:15:43.440\n>> Yes.\n>> All right, and here we go.\n\n282\n00:15:43.440 --> 00:15:47.080\nAnd I like the visual representation\nthat it gives me of what's going on.\n\n283\n00:15:47.080 --> 00:15:50.990\nIt shows me actually where I'm at,\nand what I really need to do next.\n\n284\n00:15:50.990 --> 00:15:52.630\nI can see my Azure subnet.\n\n285\n00:15:52.630 --> 00:15:54.990\nIt says the gateway was not created.\n\n286\n00:15:54.990 --> 00:15:58.077\nRemember we created a gateway subnet,\nnot the gateway itself.\n\n287\n00:15:58.077 --> 00:16:00.384\nSo I can see that as red currently, and\n\n288\n00:16:00.384 --> 00:16:04.152\nI've got a little break in\nthe line between the Azure subnet.\n\n289\n00:16:04.152 --> 00:16:08.796\nAnd the ITProTV LAN representing\nthe fact that their not connected yet.\n\n290\n00:16:08.796 --> 00:16:11.610\nI've got my DNS servers listed over here.\n\n291\n00:16:11.610 --> 00:16:15.640\nSo that is our next step then\nis to create the actual gateway.\n\n292\n00:16:15.640 --> 00:16:17.660\nThere's a little button right down here.\n\n293\n00:16:17.660 --> 00:16:19.070\nI'm gonna click Create Gateway.\n\n294\n00:16:19.070 --> 00:16:23.460\nAnd then I've gotta choose either\nstatic routing or dynamic routing.\n\n295\n00:16:23.460 --> 00:16:27.589\nStatic routing is if I wanna use this\nVPN for just a couple of protocols.\n\n296\n00:16:28.870 --> 00:16:31.840\nI can create routes for those protocols or\nwhat you have you or just for\n\n297\n00:16:31.840 --> 00:16:33.810\na couple of IP addresses maybe.\n\n298\n00:16:33.810 --> 00:16:36.320\nWe can do just a few static routes\n\n299\n00:16:36.320 --> 00:16:38.960\nto limit what traffic is\ngoing across this tunnel.\n\n300\n00:16:38.960 --> 00:16:41.040\nDynamic routing allows\nme to do everything.\n\n301\n00:16:41.040 --> 00:16:43.070\nAnd if I'm going to be\ndoing Active Directory,\n\n302\n00:16:43.070 --> 00:16:46.700\nI'm going to need all those\ndifferent protocols available.\n\n303\n00:16:46.700 --> 00:16:50.800\nI don't wanna create static routes for\neverything cuz I've got LDAP that needs\n\n304\n00:16:50.800 --> 00:16:54.140\nto be able to pass through there, Kerberos\nneeds to be able to pass through there,\n\n305\n00:16:54.140 --> 00:16:56.340\nreplication, traffic,\nall of that good stuff.\n\n306\n00:16:56.340 --> 00:16:58.750\nSo we're going to do dynamic routing,\n\n307\n00:16:58.750 --> 00:17:01.420\nand they'll tell you if you go\nout to Microsoft and read if\n\n308\n00:17:01.420 --> 00:17:04.820\nyou wanna do Active Directory you're\ngonna have to use the dynamic routing.\n\n309\n00:17:04.820 --> 00:17:09.050\nSo I'll click on that,\nit says do I want to create a gateway for\n\n310\n00:17:09.050 --> 00:17:12.150\nvirtual subnet or\nvirtual network AZ subnet.\n\n311\n00:17:12.150 --> 00:17:15.920\nYes I do, and\nit's going to start the process.\n\n312\n00:17:15.920 --> 00:17:18.890\nUnfortunately, this\ntakes a little while and\n\n313\n00:17:18.890 --> 00:17:20.690\nthere's really nothing\nyou can do about it.\n\n314\n00:17:20.690 --> 00:17:23.490\nYou kind of just have to sit here and\nwatch.\n\n315\n00:17:23.490 --> 00:17:26.790\nAnd I will tell you from personal\nexperience this is gonna be\n\n316\n00:17:26.790 --> 00:17:28.590\nabout 30 minutes long.\n\n317\n00:17:28.590 --> 00:17:34.010\nSo what we're gonna do instead of sitting\nhere watching that bar move back and forth\n\n318\n00:17:34.010 --> 00:17:38.830\nfor 30 minutes and listen to Daniel and I\nmake Men in Black references or whatever.\n\n319\n00:17:38.830 --> 00:17:41.880\nI think we'll go ahead and\ndo a little quick time out and\n\n320\n00:17:41.880 --> 00:17:46.620\nwhen we come back we'll see that it\ncompleted and we'll be able to move one.\n\n321\n00:17:46.620 --> 00:17:48.250\nAll right, so should be completed.\n\n322\n00:17:48.250 --> 00:17:52.139\nLet's take a look at my screen here and\nwe'll see what we've got.\n\n323\n00:17:52.139 --> 00:17:56.557\nAnd there we go, we can see we've got\na successfully created a gateway for\n\n324\n00:17:56.557 --> 00:18:00.220\nvirtual network Azure\nsubnet message down there.\n\n325\n00:18:00.220 --> 00:18:02.560\nGive you a close up view\nof that message for you.\n\n326\n00:18:02.560 --> 00:18:04.120\nSo I'll go ahead and click Okay to that.\n\n327\n00:18:04.120 --> 00:18:06.590\nAnd now my screen,\nI can see it looks a little bit different.\n\n328\n00:18:06.590 --> 00:18:11.220\nThis was red earlier, it's now blue\nindicating that we're good there.\n\n329\n00:18:11.220 --> 00:18:14.700\nBut I have a red box\naround my ITProTV LAN,\n\n330\n00:18:14.700 --> 00:18:17.210\nand I can see where it says disconnected.\n\n331\n00:18:17.210 --> 00:18:22.578\nSo now we've got that gateway set up ready\nto go up there on Azure just waiting for\n\n332\n00:18:22.578 --> 00:18:26.983\nus to reach out and connect to it\nfrom our VPN end point on our side,\n\n333\n00:18:26.983 --> 00:18:32.950\nwhich in our case is a routing and remote\naccess server running the VPN services.\n\n334\n00:18:32.950 --> 00:18:33.510\nSo what do we need?\n\n335\n00:18:33.510 --> 00:18:36.955\nHow do we go about getting and\nfinally establishing that connection?\n\n336\n00:18:36.955 --> 00:18:38.310\nWell we're gonna need a couple of things.\n\n337\n00:18:38.310 --> 00:18:41.340\nWhen we go to configure our\nrunning remote access server and\n\n338\n00:18:41.340 --> 00:18:43.500\nset up that site-to-site VPN,\n\n339\n00:18:43.500 --> 00:18:48.870\nI need the IP address of that other end of\nthe tunnel, which in this case is Azure.\n\n340\n00:18:48.870 --> 00:18:51.340\nAnd that's this IP address right here.\n\n341\n00:18:51.340 --> 00:18:54.223\nSo I'm just gonna make\na quick note of that.\n\n342\n00:18:54.223 --> 00:19:00.931\n137.135.80.104, all right.\n\n343\n00:19:00.931 --> 00:19:03.222\nThe other thing we're\ngonna need is the key.\n\n344\n00:19:03.222 --> 00:19:06.554\nRemember I said it's gonna set up and\nIKEV2,\n\n345\n00:19:06.554 --> 00:19:11.400\nInternet Key Exchange Version 2,\ntunnel as our VPN tunnel.\n\n346\n00:19:11.400 --> 00:19:15.290\nAnd it's gonna use pre-shared\nkeys as a means to authenticate\n\n347\n00:19:15.290 --> 00:19:16.700\neither end of that tunnel.\n\n348\n00:19:16.700 --> 00:19:20.860\nSo obviously, Azure knows about\nthe key because they generated it.\n\n349\n00:19:20.860 --> 00:19:25.190\nI need to get the key down to my end,\nand that's what this one is for\n\n350\n00:19:25.190 --> 00:19:27.520\nright here where it says manage key.\n\n351\n00:19:27.520 --> 00:19:31.280\nI'm gonna go ahead and click on that,\nand there's the key that it generates.\n\n352\n00:19:31.280 --> 00:19:33.630\nSo I'm gonna copy that to my clip board.\n\n353\n00:19:33.630 --> 00:19:36.520\nIf I ever need to regenerate the key for\nsome reason,\n\n354\n00:19:36.520 --> 00:19:39.230\nif I need to,\nmaybe I think its been compromised.\n\n355\n00:19:39.230 --> 00:19:40.730\nI wanna change the keys every so\n\n356\n00:19:40.730 --> 00:19:45.370\noften as part of my routine procedures\nthat we go through, our standard operating\n\n357\n00:19:45.370 --> 00:19:48.800\nprocedures, every 30 days we change\nthe key app or what have you.\n\n358\n00:19:48.800 --> 00:19:51.490\nYou simply come in here,\ngo to manage key, and\n\n359\n00:19:51.490 --> 00:19:55.040\nchoose regenerate key and\nit will configure a new one.\n\n360\n00:19:55.040 --> 00:19:56.930\nYou don't have to do\nanything on the Azure end,\n\n361\n00:19:56.930 --> 00:19:59.030\nit's gonna see that we've regenerated it.\n\n362\n00:19:59.030 --> 00:20:02.780\nWe just need to plug it in then\nto our end of that tunnel.\n\n363\n00:20:02.780 --> 00:20:06.820\nSo again I'll copy that one more time just\nto make sure it's on my clipboard and\n\n364\n00:20:06.820 --> 00:20:08.470\nI'll click okay there.\n\n365\n00:20:08.470 --> 00:20:11.730\nNow, we can go and\nconfigure this manually, right.\n\n366\n00:20:11.730 --> 00:20:15.930\nSo I can go through, I can open up routing\nremote access, I've got the IP address,\n\n367\n00:20:15.930 --> 00:20:17.620\nI've got the key that I need.\n\n368\n00:20:17.620 --> 00:20:19.690\nI can do it that way and\nI'm going to show you that way, but\n\n369\n00:20:19.690 --> 00:20:23.350\nI also want to talk about the other\nway that we can set up this tunnel.\n\n370\n00:20:23.350 --> 00:20:25.330\nThere is, if I look over here,\n\n371\n00:20:25.330 --> 00:20:29.980\nyou'll see this little link that says,\ndownload a VPN device script.\n\n372\n00:20:29.980 --> 00:20:32.170\nAnd this is a pretty cool little option.\n\n373\n00:20:32.170 --> 00:20:33.260\nI'm gonna go ahead and click that.\n\n374\n00:20:34.280 --> 00:20:36.740\nAnd it opens up a window that\nasks me a few questions.\n\n375\n00:20:36.740 --> 00:20:39.530\nWhat is the vendor of\nyour local VPN device?\n\n376\n00:20:39.530 --> 00:20:42.990\nAnd you can see they've got a few here,\nnot a huge amount,\n\n377\n00:20:42.990 --> 00:20:46.750\nbut those are really the most common\nones that you're gonna see out there.\n\n378\n00:20:46.750 --> 00:20:50.000\nThey are adding additional ones,\nnot all the time.\n\n379\n00:20:50.000 --> 00:20:53.260\nYou can probably talk to them, see if they\ncan configure one for you, or help you\n\n380\n00:20:53.260 --> 00:20:57.090\nwith one, but they've got a pretty good\nlist there, Cisco, Juniper, Microsoft.\n\n381\n00:20:57.090 --> 00:20:57.860\nOurs is a Microsoft.\n\n382\n00:20:57.860 --> 00:20:59.150\nIf I was to choose Cisco,\n\n383\n00:20:59.150 --> 00:21:03.400\nyou'll see the different appliances\nthat they have listed there.\n\n384\n00:21:03.400 --> 00:21:04.799\nIf we choose Juniper,\n\n385\n00:21:04.799 --> 00:21:10.120\nthey've got a nice selection of Juniper\nrouters there that you might be using.\n\n386\n00:21:10.120 --> 00:21:13.700\nIf we do Microsoft, well there's not\na whole lot, there is routing and\n\n387\n00:21:13.700 --> 00:21:15.518\nremote access,\nthat's about all we get with Microsoft.\n\n388\n00:21:15.518 --> 00:21:17.460\n[LAUGH] All right, but\nthat's what I'm running, so\n\n389\n00:21:17.460 --> 00:21:18.710\nthat's what I'm going to choose.\n\n390\n00:21:18.710 --> 00:21:20.780\nAnd then here you do have to be careful,\nright.\n\n391\n00:21:20.780 --> 00:21:25.150\nIs Windows Server 2012 and you just say\nyeah, that's 2012, that's what I got.\n\n392\n00:21:25.150 --> 00:21:30.000\nThere's a difference between 2012 and 2012\nR2 as far as what this script is doing, so\n\n393\n00:21:30.000 --> 00:21:33.550\nwe do need to make sure we tell it,\nin my case, that we're running 2012 R2.\n\n394\n00:21:33.550 --> 00:21:37.190\nI'll go ahead and\nclick that check mark there.\n\n395\n00:21:37.190 --> 00:21:42.190\nAnd what it's going to do is it's going\nto generate a script and allow me to\n\n396\n00:21:42.190 --> 00:21:47.032\ndownload it, you can see this, do you\nwant to open or save VpnDeviceScript.cfg?\n\n397\n00:21:47.032 --> 00:21:50.740\nAnd I'll just go ahead and click save, and\n\n398\n00:21:50.740 --> 00:21:54.630\nthen I'll open up that folder, and\nthis is what it generated right here.\n\n399\n00:21:54.630 --> 00:21:59.140\nNow if I edit this,\nwe'll take a peek at it.\n\n400\n00:22:00.360 --> 00:22:02.240\nTold you to use a little notepad.\n\n401\n00:22:02.240 --> 00:22:03.570\nThere you can see the script.\n\n402\n00:22:03.570 --> 00:22:08.889\nI'll bump this font up a wee bit, so\nwe can see it a little bit better.\n\n403\n00:22:11.765 --> 00:22:15.300\nAll right, and as you go through this,\nthis is actually a PowerShell script.\n\n404\n00:22:15.300 --> 00:22:19.690\nAnd what I would end up doing is right\nnow it's a .cfg file, all I do is change\n\n405\n00:22:19.690 --> 00:22:24.700\nthe extension to .ps1 and I can open\nthis up in PowerShell and execute it.\n\n406\n00:22:24.700 --> 00:22:26.260\nAnd I won't go through every line, but\n\n407\n00:22:26.260 --> 00:22:29.650\nyou can see it's creating\na couple functions up here.\n\n408\n00:22:29.650 --> 00:22:33.963\nIt's building some variables that\nare gonna store all the information about\n\n409\n00:22:33.963 --> 00:22:35.780\nrour end, your network.\n\n410\n00:22:35.780 --> 00:22:38.880\nWhat else do we wanna point out in here?\n\n411\n00:22:38.880 --> 00:22:42.000\nAgain, most of this we don't\nreally have to worry about this.\n\n412\n00:22:42.000 --> 00:22:43.440\nThere are a couple of things you,\n\n413\n00:22:43.440 --> 00:22:46.860\nactually I can't think of anything you'd\nreally ever need to change in here\n\n414\n00:22:46.860 --> 00:22:49.560\ncuz it generates it based on\nthe input that you've giving it.\n\n415\n00:22:49.560 --> 00:22:52.940\nSo it knows, especially Microsoft\nrouting and remote access,\n\n416\n00:22:52.940 --> 00:22:56.840\nI think Microsoft has a pretty good\nidea of what needs to be done, right.\n\n417\n00:22:56.840 --> 00:23:00.040\nIf you had a router that was similar\nto one of those on the list like for\n\n418\n00:23:00.040 --> 00:23:03.190\nCisco or Juniper but didn't have the exact\nmodel, maybe you go in there and\n\n419\n00:23:03.190 --> 00:23:05.940\ntweak it a little bit,\nmake it work with your device.\n\n420\n00:23:05.940 --> 00:23:09.220\nYou can see that it's going to\ninstall routing remote access, right.\n\n421\n00:23:09.220 --> 00:23:11.580\nWe've seen these commands before.\n\n422\n00:23:11.580 --> 00:23:15.240\nImport module, server manager,\ninstall Windows feature,\n\n423\n00:23:15.240 --> 00:23:19.270\nremote access, include management tools,\nadd feature, routing,\n\n424\n00:23:19.270 --> 00:23:22.560\ninclude management tools,\ntell you it might need a reboot.\n\n425\n00:23:22.560 --> 00:23:26.550\nAnd then on install site to site VP,\nand import module remote access.\n\n426\n00:23:26.550 --> 00:23:31.890\nIf VPN site to site is not installed,\nnot equal to installed, then install\n\n427\n00:23:31.890 --> 00:23:36.990\nremote access VPN type, VPN site to site\nand then it goes on and configures it.\n\n428\n00:23:36.990 --> 00:23:41.785\nYou can see it adds a VPN site to site\ninterface using that IKEV2 protocol,\n\n429\n00:23:41.785 --> 00:23:45.980\npre-shared key,\nnumber of tries for connections.\n\n430\n00:23:45.980 --> 00:23:48.880\nAlso another interesting one,\nit sets up the encryption as maximum.\n\n431\n00:23:48.880 --> 00:23:50.244\nThat's good, right,\n\n432\n00:23:50.244 --> 00:23:54.477\nI mean we're gonna be sending\nActive Directory replication at minimum,\n\n433\n00:23:54.477 --> 00:23:59.071\nwhich is enough, across that VPN tunnel so\nwe wanna make sure it's encrypted.\n\n434\n00:23:59.071 --> 00:24:01.764\nThere's the IP address and\n\n435\n00:24:01.764 --> 00:24:07.276\nyou'll notice that is the IP\naddress that I wrote down.\n\n436\n00:24:07.276 --> 00:24:08.683\nRight?\nFrom right there.\n\n437\n00:24:08.683 --> 00:24:12.340\nSo that same IP address is\nsitting here in my script.\n\n438\n00:24:12.340 --> 00:24:14.110\nWhich is another good point to make.\n\n439\n00:24:14.110 --> 00:24:17.360\nIf you delete that gateway, and\nhave to recreate it for some reason.\n\n440\n00:24:17.360 --> 00:24:18.558\nGenerate a new script.\n\n441\n00:24:18.558 --> 00:24:21.160\nCuz you're gonna get a different IP\naddress, and that is in the script.\n\n442\n00:24:21.160 --> 00:24:23.860\nSo make sure you generate a new script.\n\n443\n00:24:23.860 --> 00:24:25.920\nOr if you changed your end.\n\n444\n00:24:25.920 --> 00:24:30.800\nBecause you'll see I wanna say maybe it\ndoesn't have your IP address in here.\n\n445\n00:24:30.800 --> 00:24:34.770\nAnd then the very last thing restart\nremote access and then connect\n\n446\n00:24:34.770 --> 00:24:38.390\nto that interface, whereas basically\ncreating a domain dial interface, I was\n\n447\n00:24:38.390 --> 00:24:43.140\ngonna show you somewhere, there it is,\nit is gonna make it persistent as well.\n\n448\n00:24:43.140 --> 00:24:45.060\nSo, it does create a demand dial.\n\n449\n00:24:45.060 --> 00:24:47.390\nBut it sets it up as\na persistent connection.\n\n450\n00:24:47.390 --> 00:24:49.460\n>> Well it's a good thing that\nthey do this script for us Mike.\n\n451\n00:24:49.460 --> 00:24:52.771\nCuz this is quite involved and\nI'm not saying that you couldn't get this\n\n452\n00:24:52.771 --> 00:24:55.070\nunderneath your own hands and\nfigure it out.\n\n453\n00:24:55.070 --> 00:24:57.290\nBut man it sure is sweet\nthat they do it for you.\n\n454\n00:24:57.290 --> 00:24:58.190\n>> It really is.\n\n455\n00:24:58.190 --> 00:24:59.450\nI'm gonna show you how\nto do it manually but\n\n456\n00:24:59.450 --> 00:25:00.860\nthere might be some\nthings that you forget.\n\n457\n00:25:00.860 --> 00:25:03.060\nDid you forget to set your encryption?\n\n458\n00:25:03.060 --> 00:25:05.950\nDid you forget to make it persistent.\n\n459\n00:25:05.950 --> 00:25:06.840\nAnd things like that.\n\n460\n00:25:06.840 --> 00:25:09.500\nThis takes care of everything for you.\n\n461\n00:25:09.500 --> 00:25:13.100\nSo what I thought we would do,\nlet's see how we can do this.\n\n462\n00:25:13.100 --> 00:25:17.560\nWhat I'm gonna do is I'm\ngonna go grab that script.\n\n463\n00:25:19.930 --> 00:25:24.170\nI'm just gonna copy that and\nI should have a window already connected.\n\n464\n00:25:24.170 --> 00:25:27.380\nNow this is not part of any lesson or\nanything.\n\n465\n00:25:27.380 --> 00:25:28.450\nWhat I'm doing here is,\n\n466\n00:25:28.450 --> 00:25:31.860\nI've gotta get the script somehow from\nthe virtual machine that's running on my\n\n467\n00:25:31.860 --> 00:25:35.580\nmachine here to the virtual machine\nthat's running on my Hyper-V server\n\n468\n00:25:35.580 --> 00:25:38.550\nin the other room that's running my domain\ncontroller, my routing access server.\n\n469\n00:25:38.550 --> 00:25:41.850\nSo this is just a shared folder I've\nset up that both have connectivity to.\n\n470\n00:25:41.850 --> 00:25:44.700\nSo I paste that in there.\n\n471\n00:25:44.700 --> 00:25:49.330\nI'm gonna go and close those windows and\nthen I'll flip over to my router\n\n472\n00:25:49.330 --> 00:25:52.460\nwho also has access to the shared\nfolder on the Hyper-V server.\n\n473\n00:25:52.460 --> 00:25:55.100\nAnd there's that script\nthat I just pasted in.\n\n474\n00:25:55.100 --> 00:25:56.176\nRight?\n\n475\n00:25:56.176 --> 00:26:00.280\nSo let's see,\nlet me show you how to do it manually and\n\n476\n00:26:00.280 --> 00:26:03.604\nthen I can kinda undo that and then I'll\nshow you how to run through this script.\n\n477\n00:26:03.604 --> 00:26:07.470\nCuz there are some interesting things\nabout the script I wanna point out.\n\n478\n00:26:07.470 --> 00:26:11.675\nSo what I'm gonna do is fire\nup routing remote access.\n\n479\n00:26:11.675 --> 00:26:12.978\nI'm on my router.\n\n480\n00:26:12.978 --> 00:26:16.212\nThere's my routing remote access console.\n\n481\n00:26:18.847 --> 00:26:20.725\nWell there it is.\n\n482\n00:26:20.725 --> 00:26:23.445\n[LAUGH] Coming soon to a theater near you.\n\n483\n00:26:23.445 --> 00:26:24.790\nHere we go, network interfaces.\n\n484\n00:26:24.790 --> 00:26:26.690\nWhat I'm doing is a right-click.\n\n485\n00:26:26.690 --> 00:26:28.210\nNew Demand Dial Interface.\n\n486\n00:26:29.220 --> 00:26:30.250\nAnd it launches a wizard.\n\n487\n00:26:30.250 --> 00:26:31.750\nAnd I'll click Next.\n\n488\n00:26:31.750 --> 00:26:33.660\nAnd I can give this guy a name.\n\n489\n00:26:33.660 --> 00:26:38.760\nI might call it my Azure connection or\nmaybe my Azure.\n\n490\n00:26:38.760 --> 00:26:40.575\nWe'll do their terminology.\n\n491\n00:26:40.575 --> 00:26:41.970\n$to$VPN.\n\n492\n00:26:41.970 --> 00:26:45.170\nI'll click Next.\n\n493\n00:26:45.170 --> 00:26:46.900\nAnd it's gonna connect using VPN.\n\n494\n00:26:47.960 --> 00:26:51.768\nI'll click Next, we're gonna do IKEv2.\n\n495\n00:26:51.768 --> 00:26:54.460\nI'll click Next.\n\n496\n00:26:54.460 --> 00:26:57.713\nAnd then the name or IP address of\nthe router you are connecting to.\n\n497\n00:26:57.713 --> 00:27:03.633\nThis is where I need\nthe public IP address,\n\n498\n00:27:03.633 --> 00:27:07.115\nit's 130, whoops.\n\n499\n00:27:07.115 --> 00:27:08.230\n137.135.80.104.\n\n500\n00:27:08.230 --> 00:27:12.930\nAnd I'll click Next, and then we're gonna\nroute IP packets on this interface.\n\n501\n00:27:12.930 --> 00:27:20.330\nActually, I don't want to do that,\nRoute IP packets on user account.\n\n502\n00:27:20.330 --> 00:27:24.330\nI don't need to do that for\nthis one cuz I wanted to.\n\n503\n00:27:26.530 --> 00:27:29.420\nYeah, I don't need it to route\nIP packets on this interface.\n\n504\n00:27:29.420 --> 00:27:30.330\nWe'll click Next.\n\n505\n00:27:30.330 --> 00:27:33.370\nBecause it's already got\nrouting remote access, so\n\n506\n00:27:33.370 --> 00:27:38.803\nthis demand tunnel is not\nactually doing the routing.\n\n507\n00:27:38.803 --> 00:27:39.303\nI'll click Next.\n\n508\n00:27:41.785 --> 00:27:47.390\nAnd then my dial out credentials,\nin this case I'm just gonna type in.\n\n509\n00:27:47.390 --> 00:27:48.690\nHeck I could type in test,\n\n510\n00:27:48.690 --> 00:27:51.796\nbecause we're not using credentials\nto authenticate it to the other end.\n\n511\n00:27:51.796 --> 00:27:57.930\nWe're gonna do pre-shared keys, which I\nfailed to I did copy it I never pasted it.\n\n512\n00:27:57.930 --> 00:28:00.040\nSilly me,\nI'm gonna need that here in just a second.\n\n513\n00:28:00.040 --> 00:28:02.740\nSo I'll go ahead and\nclick Next and finish.\n\n514\n00:28:02.740 --> 00:28:04.610\nAnd it's gonna create my\ndemand out connection.\n\n515\n00:28:04.610 --> 00:28:08.470\nBut it's not ready to use yet,\nI'm just gonna double-click on it.\n\n516\n00:28:08.470 --> 00:28:10.400\nGo over here to Security.\n\n517\n00:28:10.400 --> 00:28:14.240\nSee IKEv2 is selected using\nmachine certificates which is\n\n518\n00:28:14.240 --> 00:28:16.120\nprobably the most common way to do it.\n\n519\n00:28:16.120 --> 00:28:19.320\nBut in this case we don't wanna have\nto deal with, it's a little bit easier\n\n520\n00:28:19.320 --> 00:28:22.910\nnot having to deal with trading\ncertificates, making sure they're trusted,\n\n521\n00:28:22.910 --> 00:28:26.670\nthings like that, so that's where that\nnice generated pre-shared key comes in.\n\n522\n00:28:26.670 --> 00:28:30.820\nBut I need that key so I've failed to do\nthat, so I'll flip back over to here.\n\n523\n00:28:30.820 --> 00:28:32.540\nAnd I'll just copy it one more time.\n\n524\n00:28:32.540 --> 00:28:35.390\nIt's probably still on my clipboard.\n\n525\n00:28:35.390 --> 00:28:37.040\nBut we'll copy that one more time.\n\n526\n00:28:37.040 --> 00:28:42.270\nAnd then I'm going to open\nthat folder up again.\n\n527\n00:28:42.270 --> 00:28:47.720\nAnd now I've got to remember,\nthat was, there we go.\n\n528\n00:28:48.910 --> 00:28:51.829\nLike a new little text file in here.\n\n529\n00:28:53.900 --> 00:28:56.190\nI'll call it something crazy\nlike new text document.\n\n530\n00:28:56.190 --> 00:28:59.239\nNo, I should call it my VPN key.\n\n531\n00:29:02.200 --> 00:29:05.352\nNow these are files that you would\nprobably want to make sure you got rid\n\n532\n00:29:05.352 --> 00:29:08.030\nof once you are done with this, right?\n\n533\n00:29:08.030 --> 00:29:09.370\nJust so nobody finds that.\n\n534\n00:29:11.470 --> 00:29:14.120\nWe'll save that guy up in that share.\n\n535\n00:29:14.120 --> 00:29:17.160\nNow I should be able to flip\nback over to my router.\n\n536\n00:29:20.320 --> 00:29:21.260\nAnd grab that key.\n\n537\n00:29:21.260 --> 00:29:25.860\nWe'll copy that out.\n\n538\n00:29:28.380 --> 00:29:29.190\nCopy that guy.\n\n539\n00:29:29.190 --> 00:29:33.650\nI'll minimize it just because I\nwanna make sure it actually copied.\n\n540\n00:29:33.650 --> 00:29:39.440\nAnd we'll paste that key in there and\nclick Okay.\n\n541\n00:29:39.440 --> 00:29:40.230\nAnd that should be it.\n\n542\n00:29:40.230 --> 00:29:42.260\nAt this point,\nI should be able to connect.\n\n543\n00:29:42.260 --> 00:29:44.400\nLet's try it.\n\n544\n00:29:44.400 --> 00:29:45.870\n>> Moment of truth, Michael\n>> Yeah.\n\n545\n00:29:45.870 --> 00:29:46.400\nWell let's do it.\n\n546\n00:29:46.400 --> 00:29:47.720\nI'm gonna go ahead and click.\n\n547\n00:29:47.720 --> 00:29:48.220\nConnect.\n\n548\n00:29:48.220 --> 00:29:50.271\nAnd we'll see what happens here.\n\n549\n00:29:52.512 --> 00:29:53.605\nAn error occurred.\n\n550\n00:29:53.605 --> 00:29:58.578\n[INAUDIBLE]\nDidn't like something I did there.\n\n551\n00:29:58.578 --> 00:30:01.593\nInteresting.\n\n552\n00:30:01.593 --> 00:30:04.070\nWonder why.\n\n553\n00:30:04.070 --> 00:30:05.440\nThat should show up, you know what?\n\n554\n00:30:05.440 --> 00:30:13.300\nI need to add a new Let's add that IPv4.\n\n555\n00:30:13.300 --> 00:30:17.220\nI forgot to add that down there.\n\n556\n00:30:17.220 --> 00:30:19.080\nThat's gonna help,\nI believe, a little bit.\n\n557\n00:30:19.080 --> 00:30:22.269\nSo now, we'll get back over here,\nand we'll try that again.\n\n558\n00:30:29.618 --> 00:30:35.470\nError in assigning inner IP address\nto initiator in tunnel mode.\n\n559\n00:30:35.470 --> 00:30:39.700\nI've not seen that one.\n\n560\n00:30:39.700 --> 00:30:40.220\nAll right well.\n\n561\n00:30:40.220 --> 00:30:43.930\nLet me pull up my properties and\nsee what I failed to do here.\n\n562\n00:30:43.930 --> 00:30:46.910\nI've got my Demand dial.\n\n563\n00:30:46.910 --> 00:30:49.450\nI'm gonna make that\na Persistent connection\n\n564\n00:30:49.450 --> 00:30:51.820\nI'm gonna set redial attempts to three.\n\n565\n00:30:51.820 --> 00:30:58.554\nAverage redial interval I can do\nlike three seconds that'll be fine.\n\n566\n00:31:02.095 --> 00:31:04.920\nMake sure got this set correctly.\n\n567\n00:31:06.610 --> 00:31:09.090\nThat looks good.\nAn IPv4 is not even selected.\n\n568\n00:31:09.090 --> 00:31:10.180\nAin't that nice.\n\n569\n00:31:10.180 --> 00:31:11.390\nLet's go ahead and add that.\n\n570\n00:31:12.770 --> 00:31:14.642\nAnd we'll try to connect to this guy.\n\n571\n00:31:22.106 --> 00:31:24.560\nLittle wait, and we're see,\nand it should connect up.\n\n572\n00:31:24.560 --> 00:31:25.680\nThere we go.\n\n573\n00:31:25.680 --> 00:31:27.860\nInterface is already in\nthe process of connecting.\n\n574\n00:31:27.860 --> 00:31:29.350\nOnce I changed that to persistent,\n\n575\n00:31:29.350 --> 00:31:32.660\nit was probably starting to\nconnect already in the background.\n\n576\n00:31:32.660 --> 00:31:34.480\nSo you can see on my end,\nit's showing connected.\n\n577\n00:31:34.480 --> 00:31:36.550\nSo, a couple things that\nI forgot to do there.\n\n578\n00:31:36.550 --> 00:31:39.376\nLet me make sure I point those real quick.\n\n579\n00:31:39.376 --> 00:31:40.987\nI went to IPv4 general.\n\n580\n00:31:40.987 --> 00:31:44.746\nI added a new interface, and\nthere's nothing now to add, but\n\n581\n00:31:44.746 --> 00:31:48.610\nI added the Azure S2S,\nright, I created it, here.\n\n582\n00:31:48.610 --> 00:31:50.970\nAnd then I went back down to IPv4.\n\n583\n00:31:50.970 --> 00:31:53.164\nAnd added the interface here.\n\n584\n00:31:53.164 --> 00:31:57.924\nNow I also had to go back into\nthe Azure Site to Site that we've created.\n\n585\n00:31:57.924 --> 00:32:01.683\nGood at networking and\nselect Internet Protocol Version 4.\n\n586\n00:32:01.683 --> 00:32:06.690\nNow, obviously, if you're in a fully IPv6\nenvironment, maybe you don't need that.\n\n587\n00:32:06.690 --> 00:32:09.190\nI think that's what they\nkinda wanna assume but\n\n588\n00:32:09.190 --> 00:32:13.080\nwe're doing everything IPv4 here\nsomewhat I just added that.\n\n589\n00:32:13.080 --> 00:32:15.819\nOnce we did that, everything seems\nto have connected just fine.\n\n590\n00:32:15.819 --> 00:32:17.402\nLet's verify we go back over here.\n\n591\n00:32:17.402 --> 00:32:20.790\nNow this sometimes takes at\na minute to actually show up.\n\n592\n00:32:20.790 --> 00:32:23.620\nEven though it's showing disconnected.\n\n593\n00:32:23.620 --> 00:32:25.700\nThere it goes, right,\nas I was talking about it, right?\n\n594\n00:32:25.700 --> 00:32:29.870\nI can see that data is in fact,\ntravelling back and forth.\n\n595\n00:32:29.870 --> 00:32:31.190\nI've got the connectivity.\n\n596\n00:32:31.190 --> 00:32:32.520\nLet's scroll in there.\n\n597\n00:32:32.520 --> 00:32:34.990\nWe see these guys are no longer separated.\n\n598\n00:32:34.990 --> 00:32:35.690\nWe're good to go.\n\n599\n00:32:35.690 --> 00:32:38.530\nWe've got our tunnel set up, all right?\n\n600\n00:32:38.530 --> 00:32:43.410\nNow, the script, well, let's go ahead and\nlet's see how we can do this.\n\n601\n00:32:43.410 --> 00:32:45.280\nI know we're getting short\non time there Daniel.\n\n602\n00:32:45.280 --> 00:32:46.540\nLet me go a little bit longer?\n\n603\n00:32:46.540 --> 00:32:47.111\n>> You go for it, Michael.\n\n604\n00:32:47.111 --> 00:32:48.987\n>> All right, so what I gonna do now-\n>> This is the good stuff.\n\n605\n00:32:48.987 --> 00:32:50.195\n[LAUGH]\n>> This is the good stuff.\n\n606\n00:32:50.195 --> 00:32:53.080\nI'm gonna go ahead and\nget rid of that interface.\n\n607\n00:32:53.080 --> 00:32:53.790\nI'm gonna blow it away.\n\n608\n00:32:53.790 --> 00:32:58.986\nAll right, so\nI'm going to actually just delete it.\n\n609\n00:32:58.986 --> 00:33:02.080\nAnd yes,\nwe'll make sure it's gone from there.\n\n610\n00:33:02.080 --> 00:33:03.390\nShould be gone from there as well.\n\n611\n00:33:03.390 --> 00:33:06.194\nSo it's like it never happened.\n\n612\n00:33:06.194 --> 00:33:07.236\n>> You're a mad man.\n\n613\n00:33:07.236 --> 00:33:09.440\n>> I know,\nthat's crazy what are you doing?\n\n614\n00:33:09.440 --> 00:33:10.710\nYou had it working.\n\n615\n00:33:10.710 --> 00:33:12.830\nAnd in here, in a minute,\n\n616\n00:33:12.830 --> 00:33:17.140\nit's gonna realize that it disconnected\nand this is gonna be broken.\n\n617\n00:33:17.140 --> 00:33:20.360\nI guess we could wait just a second\nto see if it picks that up.\n\n618\n00:33:20.360 --> 00:33:21.839\nWe'll refresh this page real quick.\n\n619\n00:33:23.120 --> 00:33:25.529\nSee if it picks that up,\ncuz what I wanna do,\n\n620\n00:33:25.529 --> 00:33:29.777\nI do wanna show you that script because\nit's a little bit odd the way it works.\n\n621\n00:33:29.777 --> 00:33:34.921\nEvery time I've ever used the script\nit actually looks like it fails,\n\n622\n00:33:34.921 --> 00:33:39.550\nbut it works it's strange,\nit's what we've come to expect.\n\n623\n00:33:39.550 --> 00:33:41.901\n>> Don't believe what it tells\nyou is what you're saying.\n\n624\n00:33:41.901 --> 00:33:45.440\n>> [LAUGH] I don't wanna bad mouth about\nMicrosoft, I mean, they do a great job.\n\n625\n00:33:45.440 --> 00:33:47.870\nI love this stuff, and\nit is still showing connected,\n\n626\n00:33:47.870 --> 00:33:53.000\nbut we know it's not connected, because we\ndeleted it, it's definitely not connected.\n\n627\n00:33:53.000 --> 00:33:55.300\nJust takes a minute for\nthe Cloud Management interface,\n\n628\n00:33:55.300 --> 00:33:58.360\nthat Azure interface, to catch up with us.\n\n629\n00:33:58.360 --> 00:34:02.480\nSo, what I'm gonna do is,\nI'm gonna go grab that script,\n\n630\n00:34:02.480 --> 00:34:05.230\nshould be in my downloads here,\nnow where did I stick that script?\n\n631\n00:34:06.980 --> 00:34:10.250\nCopy it, I might not have copied it.\n\n632\n00:34:10.250 --> 00:34:15.819\nVM host, end point, and\nthere is my script.\n\n633\n00:34:15.819 --> 00:34:20.191\nLet me just copy that and\nI'll put it somewhere really easy to\n\n634\n00:34:20.191 --> 00:34:24.319\nfind if it'll let me just paste\nit out here on the C drive.\n\n635\n00:34:24.319 --> 00:34:24.987\nAll right.\n\n636\n00:34:24.987 --> 00:34:28.650\nThen what I need to do is I\nneed to change that extension.\n\n637\n00:34:28.650 --> 00:34:33.010\nSo I'm just gonna take that c of g off and\nchange that to a ps1 file\n\n638\n00:34:33.010 --> 00:34:36.290\nwhich is a PowerShell script, so,\nI'll say yes, I know what I'm doing.\n\n639\n00:34:36.290 --> 00:34:39.980\nI wanna change that,\nnow I'm gonna open up PowerShell.\n\n640\n00:34:39.980 --> 00:34:43.530\nI'm gonna run it as an administrator\nbecause that script is installing roles,\n\n641\n00:34:43.530 --> 00:34:46.890\ninstalling features, and\ndoing some configuration.\n\n642\n00:34:46.890 --> 00:34:51.319\nI also need to change my,\nwhat is this word that I'm looking for?\n\n643\n00:34:51.319 --> 00:34:52.540\nMy execution policy.\n\n644\n00:34:52.540 --> 00:34:54.350\nSorry, had a little brain cramp there.\n\n645\n00:34:54.350 --> 00:34:57.340\nRemember, by default, PowerShell\nprevents you from running scripts,\n\n646\n00:34:57.340 --> 00:34:59.140\ncuz scripts can be dangerous.\n\n647\n00:34:59.140 --> 00:35:01.240\nEspecially scripts you\nget from the Internet or\n\n648\n00:35:01.240 --> 00:35:04.910\nfrom somewhere else that aren't\nlocal to you, or are not signed.\n\n649\n00:35:04.910 --> 00:35:05.730\nNow unfortunately,\n\n650\n00:35:05.730 --> 00:35:09.430\nthat script we downloaded from Microsoft\nis not digitally signed, right?\n\n651\n00:35:09.430 --> 00:35:12.130\nBecause it generated there on\nthe fly with our information.\n\n652\n00:35:12.130 --> 00:35:15.620\nAnd I guess they haven't,\nI'm just guessing, I'm not Microsoft,\n\n653\n00:35:15.620 --> 00:35:19.500\nbut they don't feel like, I don't\nwhy they don't digitally sign them.\n\n654\n00:35:19.500 --> 00:35:22.440\nThey have to be signed after we've\ngenerated it right because we're\n\n655\n00:35:22.440 --> 00:35:27.010\nchanging information in the file,\nthe IP address and all of that.\n\n656\n00:35:27.010 --> 00:35:28.986\nSo, I'm not sure why it\ndoesn't get digitally signed.\n\n657\n00:35:28.986 --> 00:35:30.527\nI'm sure it's just maybe not possible.\n\n658\n00:35:30.527 --> 00:35:32.770\nI don't know.\n\n659\n00:35:32.770 --> 00:35:38.010\nNow the point is normally, I would come\nin here and say set-executionpolicy\n\n660\n00:35:38.010 --> 00:35:43.654\nto restricted, because restricted allow me\nto run scripts as long as their side and\n\n661\n00:35:43.654 --> 00:35:48.950\nthat keeps me pretty safe but the script\nwill not run if I use that policy.\n\n662\n00:35:48.950 --> 00:35:52.652\nSo, what I actually have to do\nis set this to unrestricted.\n\n663\n00:35:52.652 --> 00:35:56.664\nNow that's a bad thing normally, because\nthat means any script from anywhere,\n\n664\n00:35:56.664 --> 00:35:59.490\nsigned or not,\nis allowed to run on your server.\n\n665\n00:35:59.490 --> 00:36:02.690\nSo this is something you're going to do,\nrun that script, and\n\n666\n00:36:02.690 --> 00:36:04.480\nthen change that policy back, right?\n\n667\n00:36:04.480 --> 00:36:06.350\nDon't forget to do that.\n\n668\n00:36:06.350 --> 00:36:08.480\nSo now, I need to call that script C:/,\n\n669\n00:36:08.480 --> 00:36:13.150\nI think it started with itpro,\nno it was vpnconfig.\n\n670\n00:36:13.150 --> 00:36:14.610\nLet's double check that.\n\n671\n00:36:14.610 --> 00:36:16.340\nMy memory VPN device script.\n\n672\n00:36:16.340 --> 00:36:23.310\nSo we'll call that VpnDeviceScript.ps1,\nand I'll go ahead and hit Enter.\n\n673\n00:36:23.310 --> 00:36:25.890\nAnd I want to run once,\nso I'll do the letter R.\n\n674\n00:36:28.040 --> 00:36:29.736\nAnd we'll let it go through its thing.\n\n675\n00:36:29.736 --> 00:36:33.111\nNow again, I have routing remote\naccess running right now.\n\n676\n00:36:33.111 --> 00:36:34.210\nIt's already installed.\n\n677\n00:36:34.210 --> 00:36:37.360\nSo what you'll see is\nthis is Success True,\n\n678\n00:36:37.360 --> 00:36:40.090\nNoChangeNeeded, it sees\nthe fact it's there.\n\n679\n00:36:40.090 --> 00:36:42.170\nBut if you hadn't configured Routing and\nRemote Access yet,\n\n680\n00:36:42.170 --> 00:36:43.640\nit would go ahead and do it for you.\n\n681\n00:36:45.560 --> 00:36:48.270\nAnd here's where it starts saying\nwaiting for service Routing and\n\n682\n00:36:48.270 --> 00:36:52.490\nRemote Access to stop,\nand then I get this error.\n\n683\n00:36:52.490 --> 00:36:56.600\nBut let's go take a look at what's\ngoing on in Routing and Remote Access.\n\n684\n00:36:56.600 --> 00:36:59.900\nI'm gonna refresh this interface here,\nor this page.\n\n685\n00:37:01.430 --> 00:37:05.600\nAnd there you can see the connection that\nit created, I'm gonna double click on it,\n\n686\n00:37:05.600 --> 00:37:10.680\nand you'll see that's set to be\npersistent, and we go over to Networking,\n\n687\n00:37:10.680 --> 00:37:14.360\nit includes IPv4, it also includes\nfile and printer sharing, and client.\n\n688\n00:37:14.360 --> 00:37:16.300\nDepending on what you were\ndoing with this VPN tunnel,\n\n689\n00:37:16.300 --> 00:37:19.170\nyou might wanna disconnect\nthose two protocols.\n\n690\n00:37:19.170 --> 00:37:20.500\nI don't need those right?\n\n691\n00:37:20.500 --> 00:37:21.990\nFile and printer sharing for\n\n692\n00:37:21.990 --> 00:37:26.590\nMicrosoft Networks allows other\nmachines to access shares on me.\n\n693\n00:37:26.590 --> 00:37:30.400\nClient for Microsoft Networks allows\nme to reach out and touch other shares.\n\n694\n00:37:30.400 --> 00:37:33.850\nIf I'm not doing things\nlike that across tunnel,\n\n695\n00:37:33.850 --> 00:37:36.220\nif I'm just doing Active Directory DNS\nthings like that.\n\n696\n00:37:36.220 --> 00:37:38.940\nI really could disable those two and\nmake us more secure, right?\n\n697\n00:37:38.940 --> 00:37:42.730\nWe talk about hardening,\nremoving unnecessary protocols.\n\n698\n00:37:42.730 --> 00:37:44.940\nI'll go ahead and click OK on that.\n\n699\n00:37:44.940 --> 00:37:48.750\nAnd let's see,\nit should have added it here as well.\n\n700\n00:37:48.750 --> 00:37:51.320\nThe only thing it did not\ndo is actually turn it on.\n\n701\n00:37:51.320 --> 00:37:52.111\nAnd actually it did.\n\n702\n00:37:52.111 --> 00:37:53.193\nThere it goes.\n\n703\n00:37:53.193 --> 00:37:58.270\nIt is now connected, so\neven though my script, says it fails.\n\n704\n00:37:58.270 --> 00:38:03.255\nRouting and remote access server is\neither not configured or not running.\n\n705\n00:38:03.255 --> 00:38:05.020\nCrud, and believe me.\n\n706\n00:38:05.020 --> 00:38:09.360\nThe first few times I was working\nwith this, I thought I had a problem.\n\n707\n00:38:09.360 --> 00:38:10.680\nAnd I'm getting ready to break down and\n\n708\n00:38:10.680 --> 00:38:13.710\ntroubleshoot the script itself and\nfigured out what's going on.\n\n709\n00:38:13.710 --> 00:38:17.027\nHappened to look over here and\nit's like wait, it is connected.\n\n710\n00:38:17.027 --> 00:38:20.569\nGo back over here and\nit is connected, right?\n\n711\n00:38:20.569 --> 00:38:23.861\nI don't know if we ever waited for\nthis to disconnect but.\n\n712\n00:38:23.861 --> 00:38:28.486\n>> We'll see the incremental of the data\nbeing sent to us so you'll know.\n\n713\n00:38:28.486 --> 00:38:32.470\n>> Yeah,\n\n714\n00:38:32.470 --> 00:38:40.730\nabsolutely.\n\n715\n00:38:40.730 --> 00:38:43.990\nBut you can also get that script\nfrom Microsoft that's generated\n\n716\n00:38:43.990 --> 00:38:47.660\nbased on the type of equipment you\ntell it you have, and just run it.\n\n717\n00:38:47.660 --> 00:38:50.340\nSo you could have somebody,\nI could pass that script on\n\n718\n00:38:50.340 --> 00:38:53.060\nto somebody that's really not\nfamiliar with any of this, right?\n\n719\n00:38:53.060 --> 00:38:55.950\nAs long as they have permission to run\nthat script, they've got credentials that\n\n720\n00:38:55.950 --> 00:38:59.360\nallows them to do that on that VPN server,\nand they can have it set up and running.\n\n721\n00:38:59.360 --> 00:39:01.140\nOr if I need to do this again somewhere,\n\n722\n00:39:01.140 --> 00:39:04.720\nI don't have to go through the process\nagain, I can run that script right?\n\n723\n00:39:04.720 --> 00:39:07.700\nSo it really is neat that\nthey give you that option.\n\n724\n00:39:07.700 --> 00:39:10.730\n>> Yeah, very cool of Microsoft to say\nhey, we want to make this as easy as\n\n725\n00:39:10.730 --> 00:39:14.500\npossible for you to get connected because\nwe want you to use our product, and\n\n726\n00:39:14.500 --> 00:39:19.220\nthat just makes good business sense and it\nmakes good sense for the end user as well.\n\n727\n00:39:19.220 --> 00:39:20.674\nMike, that being said,\n\n728\n00:39:20.674 --> 00:39:24.777\nwe have successfully connected our\nAzure to our on premises devices.\n\n729\n00:39:24.777 --> 00:39:28.472\nThis is money mental for\nour little small business we built for\n\n730\n00:39:28.472 --> 00:39:29.902\nthis particular show.\n\n731\n00:39:29.902 --> 00:39:32.570\nSo is there anything else that we need\nto cover as far as this episode goes?\n\n732\n00:39:32.570 --> 00:39:35.810\n>> No,we're gonna wait because you\nknow really can't test it out.\n\n733\n00:39:35.810 --> 00:39:37.230\nI mean, we can see that it's connected and\n\n734\n00:39:37.230 --> 00:39:39.850\nI can see the data's traveling back and\nforth there.\n\n735\n00:39:39.850 --> 00:39:43.070\nNot a lot because my Azure\nnetwork is empty, right?\n\n736\n00:39:43.070 --> 00:39:47.530\nOur next episode we'll build up a virtual\nmachine and we'll see that we can actually\n\n737\n00:39:47.530 --> 00:39:50.690\nping up there and talk to it and\nit'll start installing active directory.\n\n738\n00:39:50.690 --> 00:39:54.060\nSo that's when we're actually verify but\nhonestly, like I said,\n\n739\n00:39:54.060 --> 00:39:56.620\nyou can look at that remote access\nconsole and see that it's connected.\n\n740\n00:39:56.620 --> 00:39:58.100\n>> Awesome stuff, excellent stuff,\n\n741\n00:39:58.100 --> 00:40:02.120\nhopefully you guys are getting a lot out\nof this very, very practical information,\n\n742\n00:40:02.120 --> 00:40:05.650\nas well as, well, you never know when you\nneed to pass that along to someone else.\n\n743\n00:40:05.650 --> 00:40:08.010\nMike, thank you so much for\nshowing us how to do this.\n\n744\n00:40:08.010 --> 00:40:09.569\nThank you, guys, for joining us today.\n\n745\n00:40:09.569 --> 00:40:12.327\nWe're gonna go ahead and sign off for\nITProTV, I've been your host,\n\n746\n00:40:12.327 --> 00:40:12.945\nDaniel Lowry.\n\n747\n00:40:12.945 --> 00:40:17.110\n>> And I'm Mike Rodrick, and\nwe'll see you next time.\n\n748\n00:40:17.110 --> 00:40:23.650\n[SOUND]\n\n",
          "vimeoId": "155121788"
        },
        {
          "description": "In this episode, Daniel and Mike walk you through creating a Virtual Machine in Azure for the purposes of installing Windows Server 2012 R2 as a replica Domain Controller. They take you step-by-step to create the VM and then show you how to get connected to it with Remote Desktop. Finally they attach a secondary drive for installing Active Directory.",
          "length": "1617",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-3-1-install_a_replica_dc_in_azure-021116-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-3-1-install_a_replica_dc_in_azure-021116-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-3-1-install_a_replica_dc_in_azure-021116-1-sm.jpg",
          "title": "Install a Replica DC in Azure",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.046 --> 00:00:17.297\nAll right, greetings everyone and welcome\nto another exciting episode of ITProTV.\n\n3\n00:00:17.297 --> 00:00:19.951\nI'm your host Daniel Lowrie,\nand in today's episode,\n\n4\n00:00:19.951 --> 00:00:23.220\nwe are continuing on with our\nActive Directory in Azure series.\n\n5\n00:00:23.220 --> 00:00:25.370\nJoining us in the studio again\ntoday is our good friend,\n\n6\n00:00:25.370 --> 00:00:28.940\nour mentor, the man guiding us down\nthis road, that is Mike Rodrick.\n\n7\n00:00:28.940 --> 00:00:30.430\nMike, welcome back to the show, sir.\n\n8\n00:00:30.430 --> 00:00:31.250\nHow's it going?\n\n9\n00:00:31.250 --> 00:00:32.070\n>> It's going great, Daniel.\n\n10\n00:00:32.070 --> 00:00:32.770\nThanks for having me.\n\n11\n00:00:32.770 --> 00:00:36.750\nWe are continuing on in our\njourney to the cloud, right?\n\n12\n00:00:36.750 --> 00:00:39.565\nYou might wanna kick off some Hendrix\nsong or something there, but.\n\n13\n00:00:39.565 --> 00:00:41.430\n>> [LAUGHS] Yeah\n>> Yeah, so so far,\n\n14\n00:00:41.430 --> 00:00:45.910\nif you've watched our previous episodes,\nwe've just finished establishing that site\n\n15\n00:00:45.910 --> 00:00:50.950\nto site VPN between our corporate\nnetwork and our now-existing\n\n16\n00:00:50.950 --> 00:00:55.100\nAzure network that we created,\nour virtual networ Out there in Azure.\n\n17\n00:00:55.100 --> 00:00:57.090\nAnd we'll just double check.\n\n18\n00:00:57.090 --> 00:01:00.165\nI'll go click on my Azure subnet,\nwe'll pull up that dashboard.\n\n19\n00:01:00.165 --> 00:01:02.500\nSo remember,\nwe did re-do it in the previous episode.\n\n20\n00:01:02.500 --> 00:01:06.550\nWe created it once manually,\ntore it down, and then created it\n\n21\n00:01:06.550 --> 00:01:11.010\nagain using the handy dandy script\noption that Microsoft gives us.\n\n22\n00:01:11.010 --> 00:01:15.580\nAnd I showed you a little bit with that,\nhow it seems to error out, but\n\n23\n00:01:15.580 --> 00:01:19.180\nif you're just patient,\nit does kick in and it does work.\n\n24\n00:01:19.180 --> 00:01:23.020\nAnd now you can see even more data is\ntraveling back and forth between there.\n\n25\n00:01:23.020 --> 00:01:23.730\n>> Don't let it fool you.\n\n26\n00:01:23.730 --> 00:01:24.680\n>> Don't let it fool you.\n\n27\n00:01:24.680 --> 00:01:26.028\nIt tries.\n\n28\n00:01:26.028 --> 00:01:29.640\nAll right, so we got that done, so our\nnext step then is to create a VM, right?\n\n29\n00:01:29.640 --> 00:01:31.790\nWe've got that virtual network\nsitting up them in Azure,\n\n30\n00:01:31.790 --> 00:01:33.980\nwe've got a tunnel back\nto our corporate network.\n\n31\n00:01:33.980 --> 00:01:36.542\nNow we need to create our\nVM up there in the cloud so\n\n32\n00:01:36.542 --> 00:01:41.640\nthat we can install Active Directory and\nget this replica domain controller set up.\n\n33\n00:01:41.640 --> 00:01:43.020\nSo, that is next.\n\n34\n00:01:43.020 --> 00:01:47.690\nSo, what I'm gonna do is jump on\nover to my Virtual Machines node\n\n35\n00:01:47.690 --> 00:01:49.625\nin my classic portal.\n\n36\n00:01:49.625 --> 00:01:52.830\nIt tells me no virtual\nmachines have been created,\n\n37\n00:01:52.830 --> 00:01:55.870\nto create one click\nCreate a Virtual Machine.\n\n38\n00:01:55.870 --> 00:01:56.400\nSo, that's what I'll do.\n\n39\n00:01:56.400 --> 00:01:59.930\nYou can also go down to the New button,\nyou see it slide up there.\n\n40\n00:01:59.930 --> 00:02:04.020\nYou're gonna go under the Compute section,\nand then, Virtual Machine.\n\n41\n00:02:04.020 --> 00:02:08.170\nAnd then you have Quick Create or\nFrom a Gallery.\n\n42\n00:02:08.170 --> 00:02:11.030\nQuick Create, Gallery,\nreally either one would work.\n\n43\n00:02:11.030 --> 00:02:12.150\nI wanna do Gallery just so\n\n44\n00:02:12.150 --> 00:02:17.210\nI can show you some of the options here\nas I lock up the screen, there we go.\n\n45\n00:02:17.210 --> 00:02:20.630\nAnd the gallery is pretty cool,\nyou've gotta choose an image, and\n\n46\n00:02:20.630 --> 00:02:24.570\nyou can see all these different\nimages that they have built for us.\n\n47\n00:02:24.570 --> 00:02:27.330\nIf you wanna go to Microsoft,\nyou've got Windows Server,\n\n48\n00:02:27.330 --> 00:02:32.400\na machine already running SharePoint or\nSQL, Biz Talk, you've got Ubuntu,\n\n49\n00:02:32.400 --> 00:02:37.470\nyou've got a few different\nLinux based OS's, pretty neat.\n\n50\n00:02:37.470 --> 00:02:40.550\nI can just grab one of those,\nand I'm off and running.\n\n51\n00:02:40.550 --> 00:02:42.900\nWe're gonna do Microsoft,\nI'm gonna leave it on all, but\n\n52\n00:02:42.900 --> 00:02:44.510\nyou could, these are just filters, right.\n\n53\n00:02:44.510 --> 00:02:49.880\nIf I click on Ubuntu, it filters this\nlist, to show just Ubuntu based options.\n\n54\n00:02:49.880 --> 00:02:54.570\nIf I click on Windows Server, I'm going to\nsee just the Windows Server based options.\n\n55\n00:02:54.570 --> 00:02:58.129\nWe're gonna do 2012 R2 data center.\n\n56\n00:02:58.129 --> 00:02:59.546\nWe'll go with the latest and greatest.\n\n57\n00:02:59.546 --> 00:03:03.547\nAnd actually, this is a good time to\nstop and talk about virtualizing domain\n\n58\n00:03:03.547 --> 00:03:08.090\ncontrollers real quick, it is definitely\nsomething that we need to consider.\n\n59\n00:03:08.090 --> 00:03:11.400\nRemember, we've been virtualizing\nservers for quite some time.\n\n60\n00:03:11.400 --> 00:03:14.392\nAnd it's fantastic, and\nwe won't go into the details but,\n\n61\n00:03:14.392 --> 00:03:16.500\ncheck out some of our other courses.\n\n62\n00:03:16.500 --> 00:03:18.890\nWe talk about green IT and\nthings like that.\n\n63\n00:03:18.890 --> 00:03:21.030\nVirtualization is the way\nthings are going, right?\n\n64\n00:03:21.030 --> 00:03:23.900\nAll of this is possible\nbecause of virtualization.\n\n65\n00:03:23.900 --> 00:03:27.110\nMicrosoft doesn't have physical\nservers up there that we're using.\n\n66\n00:03:27.110 --> 00:03:29.480\nWell I guess I can't say they\ndon't have physical servers,\n\n67\n00:03:29.480 --> 00:03:33.060\nthey're not giving me access to a single\nphysical server, or each customer, or\n\n68\n00:03:33.060 --> 00:03:34.020\nanything like that, right?\n\n69\n00:03:34.020 --> 00:03:36.980\nIt's all virtualized, and it's fantastic.\n\n70\n00:03:36.980 --> 00:03:39.180\nBut when it comes to\ndomain controllers and\n\n71\n00:03:39.180 --> 00:03:43.660\nActive Directory,\nvirtualization can cause some problems.\n\n72\n00:03:43.660 --> 00:03:47.470\nWhat we have, what happens in\nthe past was if you use snapshots or\n\n73\n00:03:47.470 --> 00:03:51.200\ncheckpoints or whatever you want\nto call them now Microsoft,\n\n74\n00:03:51.200 --> 00:03:55.600\nif we use that as a method to keep our\nmachines, I don't want to say safe but\n\n75\n00:03:55.600 --> 00:03:59.070\nlet's say we're getting ready to make\na change, we'll take a quick checkpoint.\n\n76\n00:03:59.070 --> 00:04:00.820\nIf that change didn't work out,\n\n77\n00:04:00.820 --> 00:04:04.540\nwe could roll it back on a normal server,\nno big deal.\n\n78\n00:04:04.540 --> 00:04:08.180\nIf we did that on a domain\ncontroller in 2008,\n\n79\n00:04:08.180 --> 00:04:10.370\n2008 R2,\nwe could have some serious problems.\n\n80\n00:04:10.370 --> 00:04:15.580\nBecause of the replication that occurs\nbetween those domain controllers and\n\n81\n00:04:15.580 --> 00:04:17.020\nthe process that it goes through.\n\n82\n00:04:17.020 --> 00:04:20.000\nAgain I'm not gonna dive into\nupdate sequence numbers and\n\n83\n00:04:20.000 --> 00:04:22.910\nall that fun stuff in\nthis particular episode,\n\n84\n00:04:22.910 --> 00:04:25.370\nbut check out some of our\nothers we've got that in there.\n\n85\n00:04:25.370 --> 00:04:27.530\nThe problem is things get goofed up right?\n\n86\n00:04:27.530 --> 00:04:32.180\nBecause you're rolling that guide back in\ntime and those numbers get incremented as\n\n87\n00:04:32.180 --> 00:04:36.460\nchanges occur and that's how they\ncan tell whether they're current or\n\n88\n00:04:36.460 --> 00:04:40.240\nwhether their replication partner if\nthey need to replicate those changes.\n\n89\n00:04:40.240 --> 00:04:45.020\nSo if I roll him back in time it goofs\nall of that up because he loses track.\n\n90\n00:04:45.020 --> 00:04:47.460\nEverybody else that they'll\nstop replicating with, or\n\n91\n00:04:47.460 --> 00:04:50.560\nhe'll stop replicating with everybody\nelse, it just causes problems.\n\n92\n00:04:50.560 --> 00:04:53.950\nOther problems that can occur\nthe relative identifiers, all right.\n\n93\n00:04:53.950 --> 00:04:56.940\nWe've learned about that in\nbasic Active Directory 101.\n\n94\n00:04:56.940 --> 00:04:59.890\nThat's a unique number that\nnever ever gets reused.\n\n95\n00:04:59.890 --> 00:05:02.870\nIt gets plugged in with the domain\nidentifier to generate the SID,\n\n96\n00:05:02.870 --> 00:05:06.110\nthe security identifier\nthat makes all objects,\n\n97\n00:05:06.110 --> 00:05:08.610\nsecurity principles anyway, unique.\n\n98\n00:05:08.610 --> 00:05:12.290\nWell, if he's keeping track\nof what RIDs he's used, and\n\n99\n00:05:12.290 --> 00:05:16.610\nI roll him back in time,\nhe's forgetting what RIDs he's used.\n\n100\n00:05:16.610 --> 00:05:19.490\nAnd he could attempt to\nuse those RIDs again and\n\n101\n00:05:19.490 --> 00:05:22.600\nstart generating objects\nthat have duplicate SIDs.\n\n102\n00:05:22.600 --> 00:05:24.020\nAnd that's a no-no, right?\n\n103\n00:05:24.020 --> 00:05:29.230\nSo bad things happened when we tried\nto roll back domain controllers.\n\n104\n00:05:29.230 --> 00:05:30.820\n2012 R2 changes all that, all right.\n\n105\n00:05:30.820 --> 00:05:32.500\nIt's aware of virtualization.\n\n106\n00:05:32.500 --> 00:05:36.320\nIt understands that it's\na virtualized domain controller.\n\n107\n00:05:36.320 --> 00:05:41.450\nAnd there's processes in place that will\nprevent those bad things from happening.\n\n108\n00:05:41.450 --> 00:05:45.700\nIt uses a VM generation ID and\nwhen that no longer matches,\n\n109\n00:05:45.700 --> 00:05:49.920\nwhen you roll it back in time,\nit basically gets rid of its RID pool.\n\n110\n00:05:49.920 --> 00:05:53.710\nIt does some things with its update\nsequence number to make it look like\n\n111\n00:05:53.710 --> 00:05:57.000\na brand new domain controller to\nthe rest of the replication partners so\n\n112\n00:05:57.000 --> 00:05:59.800\nthey all replicate with him again,\nbring it up to speed.\n\n113\n00:05:59.800 --> 00:06:01.200\nIt works out great.\n\n114\n00:06:01.200 --> 00:06:06.109\nBut if you're not using 2012 R2 one\nthat uses those VM generation IDs isn't\n\n115\n00:06:06.109 --> 00:06:09.440\naware of virtualization,\nget yourself in trouble really fast.\n\n116\n00:06:09.440 --> 00:06:12.933\nIf you happen to use a check\npoint on a domain controller, and\n\n117\n00:06:12.933 --> 00:06:14.107\ntry to roll it back.\n\n118\n00:06:14.107 --> 00:06:15.400\nSo you can still do it.\n\n119\n00:06:15.400 --> 00:06:20.126\nRight, you can use other operating\nsystems, don't use checkpoints if you are,\n\n120\n00:06:20.126 --> 00:06:20.970\nall right?\n\n121\n00:06:20.970 --> 00:06:22.990\n>> Mike, you should teach this stuff.\n\n122\n00:06:22.990 --> 00:06:24.826\n>> [LAUGH]\n>> You sound like you know a little bit\n\n123\n00:06:24.826 --> 00:06:25.435\nabout that.\n\n124\n00:06:25.435 --> 00:06:27.660\n[LAUGH]\n>> Yeah and learned from it.\n\n125\n00:06:27.660 --> 00:06:31.022\nI've been through it, so\nyou don't wanna do that.\n\n126\n00:06:31.022 --> 00:06:34.310\nAll right, so we're gonna go\ninto 2012 R2 Data Center and\n\n127\n00:06:34.310 --> 00:06:37.540\nwe'll go ahead and\nclick Next on the old Next button there.\n\n128\n00:06:37.540 --> 00:06:40.489\nAnd then I've got release\ndates if you need it,\n\n129\n00:06:40.489 --> 00:06:46.410\nif you really wanted the release from\n10/22/2015 for some reason it's available.\n\n130\n00:06:46.410 --> 00:06:47.300\nI want the latest and\n\n131\n00:06:47.300 --> 00:06:51.720\ngreatest release, then I'm gonna\ngive my virtual machine a name.\n\n132\n00:06:51.720 --> 00:06:56.420\nNow this is really what's gonna show\nup in my console it's not going to,\n\n133\n00:06:56.420 --> 00:06:59.460\nwell I take that back,\nit actually will name my machine.\n\n134\n00:06:59.460 --> 00:07:02.879\nWe'll verify that, I can't remember\nright off the top of my head.\n\n135\n00:07:02.879 --> 00:07:09.420\nI'm gonna call this AZ-DC01, cuz it's my\nfirst domain controller in my AZ siter.\n\n136\n00:07:09.420 --> 00:07:11.020\nRemember we set up sites.\n\n137\n00:07:11.020 --> 00:07:14.220\nI created my GNV site for\nmy on premises network.\n\n138\n00:07:14.220 --> 00:07:18.480\nAnd I created my AZ site for\nmy Azure virtual network.\n\n139\n00:07:18.480 --> 00:07:23.120\nSo in the name of the machine I\nlike to indicate that, so AZ-DC01.\n\n140\n00:07:23.120 --> 00:07:26.710\nAnd then when it comes to\nchoosing the different tiers and\n\n141\n00:07:26.710 --> 00:07:29.870\nthe size of your machine,\nthis is where it's gonna be up to you.\n\n142\n00:07:29.870 --> 00:07:34.530\nYou have to think about what you need,\nbecause I can get more and more and\n\n143\n00:07:34.530 --> 00:07:39.346\nmore performance, more processors,\nthings like that on these VMs, but\n\n144\n00:07:39.346 --> 00:07:41.462\nthey also cost more to operate.\n\n145\n00:07:41.462 --> 00:07:45.550\nSo you have to figure out where it is,\nwhat else does that machine gonna do?\n\n146\n00:07:45.550 --> 00:07:47.436\nWhat type of resources does it need?\n\n147\n00:07:47.436 --> 00:07:51.794\nYou can take a look at performance monitor\non your existing domain controllers and\n\n148\n00:07:51.794 --> 00:07:54.016\ndo some monitoring over a period of time.\n\n149\n00:07:54.016 --> 00:07:57.384\nOver a week or two and\nsee what your average utilization is and\n\n150\n00:07:57.384 --> 00:08:01.824\nfigure out what you need and then you can\nduplicate that up on the cloud, right?\n\n151\n00:08:01.824 --> 00:08:06.711\nI'm gonna go with a standard tier,\nD1 I think and if you've got some of\n\n152\n00:08:06.711 --> 00:08:11.532\nthe basic tiers A1, 2, 3, 4, 5 and\nyou can see they kinda go up.\n\n153\n00:08:11.532 --> 00:08:13.691\nI'll zoom in here, all right.\n\n154\n00:08:13.691 --> 00:08:20.310\nAnd A0 shared core 768, so not gonna\nbe the best performance most likely.\n\n155\n00:08:20.310 --> 00:08:23.550\nYou can get 1, 2, 4 cores memory goes up.\n\n156\n00:08:23.550 --> 00:08:28.543\nYou get into the Ds and again, this isn't\nthe episode to really dive into all\n\n157\n00:08:28.543 --> 00:08:31.288\nthe different options that we have here.\n\n158\n00:08:31.288 --> 00:08:35.297\nEasy to do research,\nMicrosoft has lots of spreadsheets and\n\n159\n00:08:35.297 --> 00:08:39.083\ndocumentation on exactly what\na D1 is compared to a D2.\n\n160\n00:08:39.083 --> 00:08:40.607\nWhat kind of resources you're gonna get,\n\n161\n00:08:40.607 --> 00:08:42.521\nwhat kind of performance\nyou're gonna get out of it.\n\n162\n00:08:42.521 --> 00:08:46.607\nFor my domain controller, it's really just\ngonna be running Active Directory in DNS.\n\n163\n00:08:46.607 --> 00:08:49.161\nSo I'm gonna just grab this D1.\n\n164\n00:08:49.161 --> 00:08:55.101\nIt's got 1 core, it's got 3.5 gigs of\nmemory, should be good for what I need.\n\n165\n00:08:55.101 --> 00:08:58.092\nBut as you go up into some\nof those higher ones,\n\n166\n00:08:58.092 --> 00:09:02.793\nyou'll get faster disk I O,\nI've been more processors, more memory.\n\n167\n00:09:02.793 --> 00:09:05.880\nThen you've gotta create a user name.\n\n168\n00:09:05.880 --> 00:09:10.220\nThis is gonna be the name that\nyou'll use to log in to this VM.\n\n169\n00:09:10.220 --> 00:09:11.890\nAdministrator is not gonna work, right?\n\n170\n00:09:11.890 --> 00:09:14.790\nYou're not gonna have that, so\nyou're gonna create a user name here.\n\n171\n00:09:14.790 --> 00:09:17.100\nI'm just gonna use my old\nstandard user name and\n\n172\n00:09:17.100 --> 00:09:19.680\nyou wanna set a password, obviously.\n\n173\n00:09:19.680 --> 00:09:23.760\nIt's going to need to be strong,\nand it will warn you.\n\n174\n00:09:23.760 --> 00:09:28.810\nLike if I try to do a password,\nit tells me the password\n\n175\n00:09:28.810 --> 00:09:32.864\nmust contain upper and lower characters.\n\n176\n00:09:32.864 --> 00:09:37.200\nIf I try to do pa$$, something like that.\n\n177\n00:09:37.200 --> 00:09:41.380\nTo say the password you provided is\ntoo common, so it's gonna guide you.\n\n178\n00:09:41.380 --> 00:09:45.002\nTrying to get you to create\na strong password obviously,\n\n179\n00:09:45.002 --> 00:09:47.120\nthey're going to need to match.\n\n180\n00:09:47.120 --> 00:09:48.374\nAnd I'll go ahead and click Next.\n\n181\n00:09:50.224 --> 00:09:52.070\nThen you're gonna create a Cloud service.\n\n182\n00:09:52.070 --> 00:09:56.631\nNow a Cloud service is really what's going\nto another good way to describe this,\n\n183\n00:09:56.631 --> 00:09:58.924\nI'll show you their description here.\n\n184\n00:09:58.924 --> 00:10:03.254\nA Cloud service as a container for\none or more virtual machines you create.\n\n185\n00:10:03.254 --> 00:10:06.678\nYou can create a Cloud service for\na single VM, you can load balance\n\n186\n00:10:06.678 --> 00:10:11.520\nmultiple virtual machines by placing them\nin the same Cloud service, all right?\n\n187\n00:10:11.520 --> 00:10:15.510\nSo you typically create a VM or I'm sorry,\na Cloud service like I would create one\n\n188\n00:10:15.510 --> 00:10:18.738\nfor, if I was gonna have more than\none domain controller up here,\n\n189\n00:10:18.738 --> 00:10:22.286\ncreate one Cloud service probably,\nand put both of those VMs in there.\n\n190\n00:10:22.286 --> 00:10:25.177\nYou could create separate\ncloud services for each one.\n\n191\n00:10:25.177 --> 00:10:30.702\nCloud service name, you can see it's\ngoing to try to grab my machine name.\n\n192\n00:10:30.702 --> 00:10:34.460\nBut here it tells me a hosted service\nwith the specified name already exists.\n\n193\n00:10:34.460 --> 00:10:35.640\nRemember, these are global.\n\n194\n00:10:35.640 --> 00:10:37.260\nThese have to be unique globally.\n\n195\n00:10:37.260 --> 00:10:42.200\nSomebody else has stole my\nnaming convention, dang them.\n\n196\n00:10:42.200 --> 00:10:46.350\nSo I'm gonna come in here and just add\na little bit to this Cloud service name.\n\n197\n00:10:46.350 --> 00:10:49.880\nI'm gonna just do a -cs for Cloud service.\n\n198\n00:10:51.420 --> 00:10:53.310\nSo I can keep it straight.\n\n199\n00:10:53.310 --> 00:10:56.960\nI'll zoom back out a little bit, and there\nI can see, I've got a green check mark so\n\n200\n00:10:56.960 --> 00:10:59.250\nI am good to go, it is unique.\n\n201\n00:10:59.250 --> 00:11:02.120\nMy region affinity group virtual network.\n\n202\n00:11:02.120 --> 00:11:04.670\nBe really careful here, right?\n\n203\n00:11:04.670 --> 00:11:05.987\nEasy to go East US.\n\n204\n00:11:05.987 --> 00:11:09.660\nThat's what I've been using for\neverything else and just move on.\n\n205\n00:11:09.660 --> 00:11:10.990\nYou would be wrong.\n\n206\n00:11:10.990 --> 00:11:12.475\nYou're not gonna be\nhappy with the results,\n\n207\n00:11:12.475 --> 00:11:14.160\ncuz what's gonna happen is it will work.\n\n208\n00:11:14.160 --> 00:11:18.420\nIt will create a VM, it will be speed\nit up and you're gonna see this IP\n\n209\n00:11:18.420 --> 00:11:22.240\naddress like 100 dot something,\nit's not gonna be what you want, right?\n\n210\n00:11:22.240 --> 00:11:26.328\nWe created a virtual network, 10.1.2.0/24.\n\n211\n00:11:26.328 --> 00:11:30.402\nWe wanna make sure our VM\nis created on that subnet.\n\n212\n00:11:30.402 --> 00:11:35.161\nSo what I need to do is drop down,\nand you'll see there is my az-subnet.\n\n213\n00:11:35.161 --> 00:11:40.360\nThe az-subnet's already in East US,\nso I don't have to worry about that.\n\n214\n00:11:40.360 --> 00:11:46.450\nIt's still gonna be here on datacenters\non my coast, so I'm good to go there.\n\n215\n00:11:46.450 --> 00:11:49.470\nAs soon as I change that you\nnotice it picks up my subnet.\n\n216\n00:11:49.470 --> 00:11:50.629\nI only had one subnet up there.\n\n217\n00:11:50.629 --> 00:11:55.730\nIf you had multiple subnets in that\nvirtual network they'd be listed here.\n\n218\n00:11:55.730 --> 00:11:57.522\nYou'd pick the appropriate one, and\n\n219\n00:11:57.522 --> 00:12:00.775\nthen for the storage account you\ncan generate a new storage account.\n\n220\n00:12:00.775 --> 00:12:05.548\nI'm just gonna use my AD in Azure\nthat we created when we created that\n\n221\n00:12:05.548 --> 00:12:07.490\nvirtual network.\n\n222\n00:12:07.490 --> 00:12:10.150\nAnd then down at the bottom,\nI get this availability set.\n\n223\n00:12:10.150 --> 00:12:11.840\nAnd I really like this.\n\n224\n00:12:11.840 --> 00:12:13.419\nWe are gonna create an availability set.\n\n225\n00:12:13.419 --> 00:12:16.370\nI'm gonna hover over that give\nyou the description there.\n\n226\n00:12:16.370 --> 00:12:17.400\nTake a look at that.\n\n227\n00:12:17.400 --> 00:12:21.460\nAn availability set is a group of virtual\nmachines that are deployed across\n\n228\n00:12:21.460 --> 00:12:24.018\nfault domains and update domains.\n\n229\n00:12:24.018 --> 00:12:28.140\nAnd availability set, make sure that your\napplication is not affected by a single\n\n230\n00:12:28.140 --> 00:12:33.400\npoint of failure like the network\nswitch or power unit of rack server.\n\n231\n00:12:33.400 --> 00:12:37.650\nBecause if I make more than\none domain controller, right?\n\n232\n00:12:37.650 --> 00:12:40.458\nAnd they're part of that\nsame Cloud service,\n\n233\n00:12:40.458 --> 00:12:43.482\nwhat can end up happening\nis they can end up being on\n\n234\n00:12:43.482 --> 00:12:47.307\nbasically the same physical HyperV\nhost up there in the Cloud.\n\n235\n00:12:47.307 --> 00:12:52.086\nAnd that way, if Microsoft was to have\na failure of one of their racks or\n\n236\n00:12:52.086 --> 00:12:56.460\na switch, or something like that,\nit could bring of them down.\n\n237\n00:12:56.460 --> 00:12:58.245\nI don't get my fault\ntolerance that I really want.\n\n238\n00:12:58.245 --> 00:13:01.770\nRemember that the Cloud\nservice is load balancing.\n\n239\n00:13:01.770 --> 00:13:08.020\nThis is really about fault tolerance and\nso it's a great idea, I think.\n\n240\n00:13:08.020 --> 00:13:11.220\nSo what I'm gonna do,\nespecially as my domain controller, right?\n\n241\n00:13:11.220 --> 00:13:14.088\nAnd it's my disaster recover site,\npotentially.\n\n242\n00:13:14.088 --> 00:13:16.620\nSo I wanna make sure that these\nguys are always available,\n\n243\n00:13:16.620 --> 00:13:19.568\ndo everything I can to make\nsure that we have redundancies.\n\n244\n00:13:19.568 --> 00:13:24.832\nSo I'm gonna go ahead and\nchoose create an availability set and\n\n245\n00:13:24.832 --> 00:13:30.604\nI'll call this availability set\nmy az-dcs or something like that.\n\n246\n00:13:30.604 --> 00:13:34.760\nAnd then down here it's giving me\nmy end points for remote desktop.\n\n247\n00:13:34.760 --> 00:13:35.525\nIt's showing me the port numbers.\n\n248\n00:13:35.525 --> 00:13:39.720\nI could definitely change\nthat if I wanted to.\n\n249\n00:13:39.720 --> 00:13:44.210\nMight be not a bad idea to\nnot use those default ports.\n\n250\n00:13:44.210 --> 00:13:47.210\nFor our lab,\nI'm gonna go ahead and leave them.\n\n251\n00:13:47.210 --> 00:13:48.159\nWe'll go ahead and click Next.\n\n252\n00:13:50.696 --> 00:13:53.353\nAnd then here,\nyou can add some extensions.\n\n253\n00:13:53.353 --> 00:13:58.962\nI'm gonna install the VM agent, you can\nsee some of these other ones that we have,\n\n254\n00:13:58.962 --> 00:14:02.297\nPuppet Enterprises, Chief, Custom Scripts,\n\n255\n00:14:02.297 --> 00:14:06.691\nthere's some security extensions,\nMicrosoft Antimalware,\n\n256\n00:14:06.691 --> 00:14:11.035\nSymantec, Trend Micro, so\nwe could add those if we wanted to.\n\n257\n00:14:11.035 --> 00:14:13.253\nAll right and I'll go ahead and\nclick Create.\n\n258\n00:14:13.253 --> 00:14:18.070\nAnd it's gonna begin the process\nof provisioning this machine.\n\n259\n00:14:18.070 --> 00:14:21.751\nNow this is gonna go through\na couple of different phases.\n\n260\n00:14:21.751 --> 00:14:25.186\nIt's gonna say starting,\nand then it's gonna say,\n\n261\n00:14:25.186 --> 00:14:30.310\nI forget some of the other ones, it says\nit goes through deploying or building.\n\n262\n00:14:31.370 --> 00:14:34.200\nSo it takes a few minutes\nto get this done.\n\n263\n00:14:34.200 --> 00:14:40.660\nSo probably what we'll do here is we'll\ndo a little bit of TV magic on you guys.\n\n264\n00:14:40.660 --> 00:14:42.940\nSo if we wanna take my screen away for\n\n265\n00:14:42.940 --> 00:14:46.950\njust a second it won't take that\nlong to finish this process.\n\n266\n00:14:48.810 --> 00:14:52.760\nSo rather than us sit here and\nwatch these bars\n\n267\n00:14:52.760 --> 00:14:58.320\nwe'll come back as soon as this\nmachine is done provisioning.\n\n268\n00:14:58.320 --> 00:14:59.280\nAll right, there we go.\n\n269\n00:14:59.280 --> 00:15:01.220\nTake a look at my screen and we are done.\n\n270\n00:15:01.220 --> 00:15:05.870\nWe have created our first VM\nup there in Microsoft Azure.\n\n271\n00:15:05.870 --> 00:15:08.670\nSo there you see I have\nsuccessfully created,\n\n272\n00:15:08.670 --> 00:15:10.210\nif I can get that tool tip out of the way.\n\n273\n00:15:10.210 --> 00:15:14.417\nSuccessfully created virtual machine\naz-dc01, and I click on Details.\n\n274\n00:15:14.417 --> 00:15:17.509\nAnd I can see it created it,\nprovisioned the virtual machine,\n\n275\n00:15:17.509 --> 00:15:20.100\ninstalled the extensions\nin the virtual machine.\n\n276\n00:15:20.100 --> 00:15:21.640\nSo I'll click OK to that.\n\n277\n00:15:21.640 --> 00:15:22.439\nAnd here's what I just need to check.\n\n278\n00:15:22.439 --> 00:15:25.940\nI'm gonna go ahead and\nclick on that machine.\n\n279\n00:15:25.940 --> 00:15:30.332\nAnd kinda like our networks, I got that\nquick start screen, great information if\n\n280\n00:15:30.332 --> 00:15:34.294\nyou wanna learn more about managing\nVMs and disk, and that kind of thing.\n\n281\n00:15:34.294 --> 00:15:37.907\nFollow some of those links,\njump over to the dashboard and\n\n282\n00:15:37.907 --> 00:15:39.760\nyou'll see a couple things.\n\n283\n00:15:39.760 --> 00:15:42.970\nFirst thing I'll point out, actually the\nfirst thing I wanna do is I'm gonna scroll\n\n284\n00:15:42.970 --> 00:15:48.430\ndown here and\ntake a look at my internal IP address.\n\n285\n00:15:48.430 --> 00:15:51.915\nThat I wanna verify ended\nup where I wanted it to be.\n\n286\n00:15:51.915 --> 00:15:58.464\nRemember what I said that we've\ngot the 10.1.2.0/24 network,\n\n287\n00:15:58.464 --> 00:16:04.409\nI also said when we registered our\nDNS servers, the DNS was gonna be.\n\n288\n00:16:04.409 --> 00:16:08.871\n10.1.1.10, actually I said 10, didn't I?\n\n289\n00:16:08.871 --> 00:16:13.010\nWe've got four, so I might need\nto register another DNS server.\n\n290\n00:16:13.010 --> 00:16:17.330\nI said ten, it got four,\nthat's okay, we can fix that.\n\n291\n00:16:17.330 --> 00:16:19.970\nBut the important thing is\nit's on the right subnet.\n\n292\n00:16:19.970 --> 00:16:21.250\nIf you come to this screen and\n\n293\n00:16:21.250 --> 00:16:25.500\nyou see that that internal IP address is\nnot correct, most likely when you created\n\n294\n00:16:25.500 --> 00:16:29.450\nthe VM, you didn't pick the right option\nthere when I showed you the dropped\n\n295\n00:16:29.450 --> 00:16:33.540\nnumbers of the regions and\nyour virtual network that should exist.\n\n296\n00:16:33.540 --> 00:16:36.810\nAnd how you fix that, you delete\nthe virtual machine and you do it again.\n\n297\n00:16:36.810 --> 00:16:41.440\nIn Azure, there really isn't a way to\nfix that, you would simply delete it,\n\n298\n00:16:41.440 --> 00:16:45.760\ndeprovision it basically, and\nthen build a new VM and try it again.\n\n299\n00:16:45.760 --> 00:16:48.060\nNo big deal,\nnot too terribly difficult so.\n\n300\n00:16:48.060 --> 00:16:51.300\n>> Good thing at this point you really\nhaven't done anything other then provision\n\n301\n00:16:51.300 --> 00:16:52.280\nthe virtual machine.\n\n302\n00:16:52.280 --> 00:16:55.843\nWe haven't installed any operating systems\nor done any tweeks and configuration, so\n\n303\n00:16:55.843 --> 00:16:56.980\nit's easy enough Doug.\n\n304\n00:16:56.980 --> 00:16:57.510\n>> Yeah absolutely.\n\n305\n00:16:57.510 --> 00:16:59.361\nNow is the time to fix it, right?\n\n306\n00:16:59.361 --> 00:17:00.424\n>> [LAUGH]\n>> [LAUGH] Yeah.\n\n307\n00:17:00.424 --> 00:17:02.624\n>> All right, but now,\nlook at this message I've got up here.\n\n308\n00:17:02.624 --> 00:17:04.140\nImportant, the availability set for\n\n309\n00:17:04.140 --> 00:17:09.430\nthis virtual machine has only one\nrunning instance, which effects the SLA,\n\n310\n00:17:09.430 --> 00:17:13.370\nthe SLA requires at least two\nrunning virtual machine instances.\n\n311\n00:17:13.370 --> 00:17:14.940\nIt kinda makes sense, right?\n\n312\n00:17:14.940 --> 00:17:16.990\nRemember what that\navailability set did for me?\n\n313\n00:17:16.990 --> 00:17:21.200\nIt said, it gonna prevent failure or give\n\n314\n00:17:21.200 --> 00:17:24.780\nme full tolerance in the event of a single\npoint of failure like a network switch,\n\n315\n00:17:24.780 --> 00:17:27.320\nor a power supply for\na RAC or something like that.\n\n316\n00:17:27.320 --> 00:17:30.140\nWell, I've only got one machine.\n\n317\n00:17:30.140 --> 00:17:31.240\nMicrosoft can't do anything about it.\n\n318\n00:17:31.240 --> 00:17:34.610\nSo they're saying I know you said\ncreate an availability set, but\n\n319\n00:17:34.610 --> 00:17:38.270\nyou haven't given us enough to work with\nso don't try to hold us to that SLA,\n\n320\n00:17:38.270 --> 00:17:39.730\nthere's just nothing we can do.\n\n321\n00:17:39.730 --> 00:17:41.600\n>> So\nit typically means more then one right?\n\n322\n00:17:41.600 --> 00:17:42.830\n>> Yeah exactly exactly.\n\n323\n00:17:42.830 --> 00:17:44.990\n>> Its in the terminology itself.\n\n324\n00:17:44.990 --> 00:17:45.680\n>> So what would I do?\n\n325\n00:17:45.680 --> 00:17:48.310\nWell now I'd go back and\ncreate another VM.\n\n326\n00:17:48.310 --> 00:17:50.800\nAnd I'd put it in that\nsame availability set.\n\n327\n00:17:50.800 --> 00:17:55.650\nWe created the availability set when I\ncreated my first VM, we create the second\n\n328\n00:17:55.650 --> 00:17:59.420\nVM, we just choose that availability\nset from the drop-down list, and\n\n329\n00:17:59.420 --> 00:18:02.822\nnow they can provide us with\nthat level of fault tolerance.\n\n330\n00:18:02.822 --> 00:18:06.730\nAll right so that's it, we are up and\nrunning, let's go check it out.\n\n331\n00:18:06.730 --> 00:18:09.340\nSo I'm gonna come down here to\nthe bottom and choose Connect.\n\n332\n00:18:09.340 --> 00:18:13.840\nAnd what it's gonna do is it's going\nto download a remote desktop file.\n\n333\n00:18:13.840 --> 00:18:15.410\nSo I'm gonna go ahead and save that.\n\n334\n00:18:15.410 --> 00:18:17.140\nYou could just click open and\nit would connect.\n\n335\n00:18:17.140 --> 00:18:21.040\nI'm gonna go ahead and save cuz I might\nwant to connect more than once, right?\n\n336\n00:18:21.040 --> 00:18:24.010\nIf I wanna connect tomorrow, I don't have\nto go through there are save that again.\n\n337\n00:18:24.010 --> 00:18:26.025\nThere is my remote desktop file.\n\n338\n00:18:26.025 --> 00:18:26.638\nAll right.\n\n339\n00:18:26.638 --> 00:18:29.680\nAnd if we take a look at\nthat remote desktop file.\n\n340\n00:18:29.680 --> 00:18:32.310\nAnd you see that it's\ngot the name in there,\n\n341\n00:18:32.310 --> 00:18:34.440\nthe port information's already tied in.\n\n342\n00:18:34.440 --> 00:18:35.710\nSo it should be good to go.\n\n343\n00:18:35.710 --> 00:18:40.560\nWe'll go ahead and click Connect, and\nwe could take a look at the certificate.\n\n344\n00:18:40.560 --> 00:18:44.140\nIt's telling me that the publisher\ncould not be identified.\n\n345\n00:18:44.140 --> 00:18:45.560\nDo you want to continue?\n\n346\n00:18:45.560 --> 00:18:46.175\nYes, I do.\n\n347\n00:18:48.637 --> 00:18:50.990\nAnd we'll see if we can connect.\n\n348\n00:18:50.990 --> 00:18:54.440\nThat's a good sign when I get\nthat authentication dialog box.\n\n349\n00:18:54.440 --> 00:18:57.460\nSo now this is where you need to\nremember the account that you created\n\n350\n00:18:57.460 --> 00:18:58.410\nwhen you set up that VM.\n\n351\n00:18:58.410 --> 00:19:00.762\nAll right, so\nthat's the account you're gonna use.\n\n352\n00:19:04.384 --> 00:19:05.160\nAnd there we go.\n\n353\n00:19:05.160 --> 00:19:07.480\nNow, it has a self sign\ncertificate at this point.\n\n354\n00:19:09.340 --> 00:19:10.766\nSo I'm gonna go ahead and trust it.\n\n355\n00:19:13.134 --> 00:19:16.860\nIn the real world we'd end up, issuing,\nif we were running a certificate services,\n\n356\n00:19:16.860 --> 00:19:20.174\nwe'd go ahead and issue certificates,\nwhere we might have a policy that's\n\n357\n00:19:20.174 --> 00:19:22.845\neventually going to Issue\na certificate over this machine.\n\n358\n00:19:24.737 --> 00:19:26.595\nSo we'll give it a minute\nto build my profile,\n\n359\n00:19:26.595 --> 00:19:30.235\njust like any other time you build\na machine, or the first time you log onto\n\n360\n00:19:30.235 --> 00:19:33.855\na machine with a particular account, takes\nit a minute to build your profile up.\n\n361\n00:19:35.045 --> 00:19:36.955\nRun some of those initialization scripts.\n\n362\n00:19:40.030 --> 00:19:43.650\nAnd bada bing, we have a desktop.\n\n363\n00:19:43.650 --> 00:19:47.980\nAnd yeah, we want to go ahead and\ntrust that network, make it private.\n\n364\n00:19:50.840 --> 00:19:51.940\nAnd we'll give it just a second.\n\n365\n00:19:51.940 --> 00:19:54.170\nWe'll wait for\na service manager to launch up here.\n\n366\n00:19:54.170 --> 00:19:56.590\nWhat I'm gonna do is I'm\ngonna open up PowerShell.\n\n367\n00:19:56.590 --> 00:19:59.390\nYou can see that actually\nyou have a really cool,\n\n368\n00:19:59.390 --> 00:20:03.320\nthis is something that used to\nbe called BG info, or back info.\n\n369\n00:20:03.320 --> 00:20:06.870\nMicrosoft picked it up, gosh,\nI don't wanna misquote,\n\n370\n00:20:06.870 --> 00:20:10.700\nsys internals, I can't remember\nexactly who wrote this originally.\n\n371\n00:20:10.700 --> 00:20:11.710\nMicrosoft uses it.\n\n372\n00:20:11.710 --> 00:20:15.890\nAnd I love using it on all my virtual\nmachines because it does get difficult\n\n373\n00:20:15.890 --> 00:20:19.450\nsometimes when you're looking, if you've\ngot five, ten different, you know.\n\n374\n00:20:19.450 --> 00:20:22.590\nI've had situations where I had four or\nfive virtual machines opened up at\n\n375\n00:20:22.590 --> 00:20:25.080\nthe same time, four or\nfive different remote desktop connections.\n\n376\n00:20:25.080 --> 00:20:27.615\nAnd they've all got the default\nServer 2012 R2 background,\n\n377\n00:20:27.615 --> 00:20:30.115\nhow do you tell which one's which, right?\n\n378\n00:20:30.115 --> 00:20:33.465\nEspecially because I like\nto hide this bar up here.\n\n379\n00:20:33.465 --> 00:20:37.165\nThis gives you good information right\nthere on that screen like that.\n\n380\n00:20:37.165 --> 00:20:40.015\nBut, let's just a do\na little verification here.\n\n381\n00:20:40.015 --> 00:20:43.018\nIf I can get PowerShell to play along.\n\n382\n00:20:45.067 --> 00:20:48.365\nWhat I was going to do was\njust bump up that font a hair.\n\n383\n00:20:50.650 --> 00:20:52.170\nShow you a little ip config.\n\n384\n00:20:52.170 --> 00:20:55.800\nAnd there's my 10.1.2.4 IP address so\nwe're good to go there.\n\n385\n00:20:55.800 --> 00:20:58.960\nThere's that subnet mask.\n\n386\n00:20:58.960 --> 00:21:02.700\nRemember it did a slash 27\nif I remember correctly.\n\n387\n00:21:02.700 --> 00:21:05.380\nHopefully my math is correct there,\nif not I'm sure someone will correct me.\n\n388\n00:21:06.410 --> 00:21:07.590\nAnd then I'll close that.\n\n389\n00:21:07.590 --> 00:21:12.070\nSo, we've got the VM up and running,\nwe're obviously connected to it.\n\n390\n00:21:12.070 --> 00:21:15.230\nBut we're really not\nconnected through the tunnel,\n\n391\n00:21:15.230 --> 00:21:17.040\nwe're actually going outside that tunnel.\n\n392\n00:21:17.040 --> 00:21:19.510\nWe need to verify that that\ntunnel is up and running.\n\n393\n00:21:19.510 --> 00:21:23.696\nSo what I want to do is go to Tools and\nthen Windows, oops,\n\n394\n00:21:23.696 --> 00:21:27.450\nI don't know what I just clicked on,\nsensitive touch pad there.\n\n395\n00:21:27.450 --> 00:21:29.440\nWe don't want to schedule\na task right now.\n\n396\n00:21:29.440 --> 00:21:32.080\nWe'll go to Windows Firewall\nwith Advanced Security.\n\n397\n00:21:33.210 --> 00:21:34.380\nInbound Rules.\n\n398\n00:21:35.700 --> 00:21:39.830\nAnd I'm gonna drop down to my File and\nPrinter Sharing.\n\n399\n00:21:39.830 --> 00:21:42.840\nAnd I'm gonna turn on Echo Request for\nV4 and V6.\n\n400\n00:21:42.840 --> 00:21:47.119\nI'll just go ahead and\nenable those two rules there.\n\n401\n00:21:49.750 --> 00:21:54.490\nAnd now what I wanna do is I'm gonna\nflip over to my hyper view server.\n\n402\n00:21:54.490 --> 00:21:57.810\nSo this is my local domain controller.\n\n403\n00:21:57.810 --> 00:21:59.920\nThis is the one that's onsite.\n\n404\n00:21:59.920 --> 00:22:03.130\nRemember I told you that keyboard\nshortcuts are really tough when you're\n\n405\n00:22:03.130 --> 00:22:06.210\nnesting VMs or\nnesting remote desktop sessions?\n\n406\n00:22:06.210 --> 00:22:09.300\nI did find one sort of shortcut.\n\n407\n00:22:09.300 --> 00:22:13.220\nWhen you're on a Mac,\nyou don't have the Ctrl+Alt+Delete option.\n\n408\n00:22:13.220 --> 00:22:17.937\nI can pull up the on-screen keyboard,\nhit Ctrl+Alt on my keyboard and\n\n409\n00:22:17.937 --> 00:22:21.580\nclick the Delete key, and\nit does the same thing.\n\n410\n00:22:21.580 --> 00:22:22.490\nJust a little FYI there.\n\n411\n00:22:23.780 --> 00:22:25.050\n>> Any tips from Mike Rodrick.\n\n412\n00:22:25.050 --> 00:22:25.740\n>> Yeah right.\n\n413\n00:22:25.740 --> 00:22:28.570\nNever know when you find yourself in the\nsituation when you're sitting in a Mac,\n\n414\n00:22:28.570 --> 00:22:30.050\nremoted in a one machine and\n\n415\n00:22:30.050 --> 00:22:33.250\nthen remoted into another\nmachine from that one machine.\n\n416\n00:22:33.250 --> 00:22:34.110\n>> IT problems, man.\n\n417\n00:22:34.110 --> 00:22:35.185\nIT problems.\n\n418\n00:22:35.185 --> 00:22:38.010\n[LAUGH]\n>> All right, so here we go.\n\n419\n00:22:38.010 --> 00:22:40.560\nI'm on my domain controller,\nI'm going to pull up PowerShell.\n\n420\n00:22:41.880 --> 00:22:46.460\nAnd first I'll do a little ipconfig,\nand show you guys that I actually have,\n\n421\n00:22:49.460 --> 00:22:52.240\nwhen it finishes, there we go,\n10.1.1.10, right?\n\n422\n00:22:52.240 --> 00:22:58.400\nThis is the on-premesis domain controller.\n\n423\n00:22:58.400 --> 00:23:03.270\nAnd now I'm gonna ping 10.1.2.4.\n\n424\n00:23:03.270 --> 00:23:05.440\nAnd there's my replies.\n\n425\n00:23:05.440 --> 00:23:09.558\nSo this guy, DC1,\nif we remember back to my simple diagram,\n\n426\n00:23:09.558 --> 00:23:17.400\nI've got 10.1.1.1.0 subnet that is going\nthrough a router to get Internet access.\n\n427\n00:23:17.400 --> 00:23:19.490\nAnd that router is also my VPN endpoint.\n\n428\n00:23:19.490 --> 00:23:22.540\nSo I've got my site to site\ntunnel built out to Azure.\n\n429\n00:23:22.540 --> 00:23:26.390\nSo it's like these guys were on, I don't\nwant to say on the same network, right?\n\n430\n00:23:26.390 --> 00:23:28.760\nBut like they're on the same local area\nnetwork, just two different subnets.\n\n431\n00:23:30.120 --> 00:23:31.060\nThat's it.\n\n432\n00:23:31.060 --> 00:23:33.110\nI mean, to me, that's pretty cool stuff.\n\n433\n00:23:33.110 --> 00:23:34.250\nWe are connected.\n\n434\n00:23:34.250 --> 00:23:36.330\n>> And that's through the Internet too.\n\n435\n00:23:36.330 --> 00:23:39.380\n>> That's the really cool part about\nit is, Azure, you gotta remember,\n\n436\n00:23:39.380 --> 00:23:40.510\nthat's our cloud provider.\n\n437\n00:23:40.510 --> 00:23:42.340\nIt's out there in the world.\n\n438\n00:23:42.340 --> 00:23:47.180\nIt's not sitting in another room,\nor just across a switch or\n\n439\n00:23:47.180 --> 00:23:49.710\nacross a router in the same room.\n\n440\n00:23:49.710 --> 00:23:50.763\nIt is actually out there.\n\n441\n00:23:50.763 --> 00:23:54.873\nMicrosoft's hardware, Microsoft's taking\ncare of every bit of that infrastructure.\n\n442\n00:23:54.873 --> 00:23:59.236\nAll we did is create a tunnel\nbetween the two actual places.\n\n443\n00:23:59.236 --> 00:24:00.537\nAnd let them start talking.\n\n444\n00:24:00.537 --> 00:24:04.403\n>> That's it, and looking at this\nresponse times, I mean, I'm looking 31ms.\n\n445\n00:24:04.403 --> 00:24:05.090\n>> That's not bad.\n\n446\n00:24:05.090 --> 00:24:07.140\n>> That is not bad at all, right?\n\n447\n00:24:07.140 --> 00:24:09.750\nAll right so let me close that down,\nand what we're going to do,\n\n448\n00:24:09.750 --> 00:24:11.420\nI know that we're getting\na little low on time,\n\n449\n00:24:11.420 --> 00:24:14.910\nyou know we want to install Active\nDirectory but, there's a couple of, one\n\n450\n00:24:14.910 --> 00:24:19.000\nmore thing I need to do before I go in and\ninstall that Active Directory onto here.\n\n451\n00:24:19.000 --> 00:24:23.650\nAnd that is because of the way these\nvirtual machines hard drive work.\n\n452\n00:24:23.650 --> 00:24:24.180\nAll right?\n\n453\n00:24:24.180 --> 00:24:29.530\nWe need to add a second disc to this\nvirtual machine, and I'll example as I go.\n\n454\n00:24:29.530 --> 00:24:31.950\nSo, I'm going to flip back\nover to my Azure Management.\n\n455\n00:24:31.950 --> 00:24:35.590\nI'm going to go ahead and\ndisconnect from my remote desktop session.\n\n456\n00:24:35.590 --> 00:24:38.010\nAll right.\n\n457\n00:24:38.010 --> 00:24:41.250\nAnd I'm going to go back over\nto my management portal.\n\n458\n00:24:41.250 --> 00:24:47.320\nI'll click okay on that message,\nand with my Azure dc01 selected.\n\n459\n00:24:47.320 --> 00:24:51.810\nI'm in virtual machines,\nAzure dco1 dashboard.\n\n460\n00:24:51.810 --> 00:24:57.850\nI'm going to come down here and\nclick attach empty disc, all right?\n\n461\n00:24:57.850 --> 00:24:58.830\nYou could change the name.\n\n462\n00:24:58.830 --> 00:25:01.680\nIt knows what machine,\nbecause that's the one I have selected.\n\n463\n00:25:01.680 --> 00:25:04.414\nWhere it's going to store it is\nthat storage location that I had\n\n464\n00:25:04.414 --> 00:25:05.590\nalready created.\n\n465\n00:25:05.590 --> 00:25:09.610\nAzure, sorry, AD in Azure, remember,\n\n466\n00:25:09.610 --> 00:25:14.980\nthis is a BLOB, Binary Large OBject,\na VHD that's treated as a BLOB.\n\n467\n00:25:14.980 --> 00:25:17.680\nThere's my file name, you could\nchange it if you really wanted to.\n\n468\n00:25:17.680 --> 00:25:21.707\nWe're going to set a size, and\nI'm just going to say 10 GB,\n\n469\n00:25:21.707 --> 00:25:23.940\nthat size is in gigabytes.\n\n470\n00:25:23.940 --> 00:25:24.640\nSo click 10.\n\n471\n00:25:24.640 --> 00:25:29.190\nAnd then Host Cache Preference,\nNone all right?\n\n472\n00:25:29.190 --> 00:25:35.300\nI want to put None on there because\nof the way active directory\n\n473\n00:25:35.300 --> 00:25:40.030\nworks, it can't be on a drive they could\nbe caching information before it writes.\n\n474\n00:25:40.030 --> 00:25:43.160\nIt needs to be written right to that disk.\n\n475\n00:25:43.160 --> 00:25:46.830\nIt's just a requirement\nof active directory.\n\n476\n00:25:46.830 --> 00:25:51.790\nSo when we take this VM and we want\nto install Active Directory, I cannot\n\n477\n00:25:51.790 --> 00:25:56.520\nput the Active Directory database on those\ndefault drives that we get with Azure.\n\n478\n00:25:56.520 --> 00:26:01.680\nI cannot put sisfall on there, so\nI need a second drive to put those on.\n\n479\n00:26:01.680 --> 00:26:02.620\nSo that's what I'm doing here.\n\n480\n00:26:02.620 --> 00:26:04.550\nI'm going to add another ten gig drive.\n\n481\n00:26:04.550 --> 00:26:06.920\nI'll click my little check mark there,\n\n482\n00:26:06.920 --> 00:26:11.250\nshouldn't take it very long to\nattach a new virtual disk and\n\n483\n00:26:11.250 --> 00:26:16.630\nat that point we're ready go, we're going\nto start installing active directory.\n\n484\n00:26:16.630 --> 00:26:19.450\n>> All right, well Mike you're\ntaking us on a long journey here.\n\n485\n00:26:19.450 --> 00:26:22.340\nWe're making a lot of headway\nhere in these last few episodes.\n\n486\n00:26:22.340 --> 00:26:24.540\nA lot of fun and\na lot of interesting things.\n\n487\n00:26:24.540 --> 00:26:26.570\nBut like you said,\nwe've got a little more to do.\n\n488\n00:26:26.570 --> 00:26:28.300\nWe've got to install the active directory.\n\n489\n00:26:28.300 --> 00:26:32.420\nThis looks like a really good spot for\nus to call it a day and\n\n490\n00:26:32.420 --> 00:26:35.040\ncome back and do a part two and\nwe'll jump into that active directory.\n\n491\n00:26:35.040 --> 00:26:35.590\nHow does that sound?\n\n492\n00:26:35.590 --> 00:26:36.430\n>> Sounds like a plan to me.\n\n493\n00:26:36.430 --> 00:26:37.870\n>> Excellent.\nWell, thank you so much for\n\n494\n00:26:37.870 --> 00:26:39.550\njoining us today, Michael, and showing it.\n\n495\n00:26:39.550 --> 00:26:40.790\nWe look forward to seeing you in part two.\n\n496\n00:26:40.790 --> 00:26:42.498\nLook forward to seeing\nyou guys there as well.\n\n497\n00:26:42.498 --> 00:26:43.060\nWe're going to go ahead and\n\n498\n00:26:43.060 --> 00:26:45.940\nsign off for IT Pro TV,\nI've been your host Daniel Lowery.\n\n499\n00:26:45.940 --> 00:26:46.680\n>> And I'm Mike Vitry.\n\n500\n00:26:46.680 --> 00:26:47.524\nWe'll see you next time.\n\n501\n00:26:47.524 --> 00:26:54.534\n[MUSIC]\n\n",
          "vimeoId": "155121825"
        },
        {
          "description": "In this episode, Daniel and Mike continue working with their new replica Domain Controller in Azure. Here they finish up by creating a partition on the secondary disk and then install the Active Directory role on the server. Finally, they create a replica of the AD on the replica DC.",
          "length": "1590",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-3-2-install_a_replica_dc_in_azure_pt2-021116-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-3-2-install_a_replica_dc_in_azure_pt2-021116-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-3-2-install_a_replica_dc_in_azure_pt2-021116-1-sm.jpg",
          "title": "Install a Replica DC in Azure Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.055 --> 00:00:10.055\n[MUSIC]\n\n2\n00:00:12.181 --> 00:00:16.940\nAll right, greetings everyone and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.940 --> 00:00:20.120\nI'm your host, Daniel Lowrie and\nin today's episode,\n\n4\n00:00:20.120 --> 00:00:23.460\nwe are continuing on with\nour AD in Azure series.\n\n5\n00:00:23.460 --> 00:00:26.380\nBeen chugging away at that here for\nquite a few episodes.\n\n6\n00:00:26.380 --> 00:00:30.528\nJoining us back in the studio again today\nis our good friend, our mentor, Mr.\n\n7\n00:00:30.528 --> 00:00:31.430\nMike Rodrick.\n\n8\n00:00:31.430 --> 00:00:32.550\nMike, welcome back to the show, sir.\n\n9\n00:00:32.550 --> 00:00:34.370\n>> Thank you Dan, I'm excited to be here.\n\n10\n00:00:34.370 --> 00:00:36.200\nAnd you're right, you know,\nwe're getting close, right?\n\n11\n00:00:36.200 --> 00:00:37.780\nWe've got everything set up.\n\n12\n00:00:37.780 --> 00:00:43.430\nWe're to this point now where we're\nready to install Active Directory on\n\n13\n00:00:43.430 --> 00:00:47.720\nour virtual machine, I should say,\nit's not a domain controller yet.\n\n14\n00:00:47.720 --> 00:00:50.810\nOn our virtual machine that\nwe've created up there in Azure.\n\n15\n00:00:50.810 --> 00:00:55.940\nAnd if you remember the end of\nthe previous episode, as we created a new\n\n16\n00:00:55.940 --> 00:01:00.460\ndisk, I attached a blank disk\nto the VM that we have created.\n\n17\n00:01:00.460 --> 00:01:05.560\nAnd that's because of the drives they\nused by default up there in Azure\n\n18\n00:01:05.560 --> 00:01:09.650\nthey do a lot of caching, I can't have\nthat Active Directory database and\n\n19\n00:01:09.650 --> 00:01:11.680\nSYSVOL located on those drives.\n\n20\n00:01:11.680 --> 00:01:14.740\nWe created another drive,\nstuck it in there, and\n\n21\n00:01:14.740 --> 00:01:19.020\nwe made sure we chose no caching\nwhen we built that second VHD.\n\n22\n00:01:19.020 --> 00:01:23.460\nSo if you look at my screen now I can see\nit successfully attached an empty disc\n\n23\n00:01:23.460 --> 00:01:25.260\nto virtual machine az-dc01.\n\n24\n00:01:25.260 --> 00:01:29.420\nSo go a head an click OK to that and\nI'm gonna go a head an connect.\n\n25\n00:01:29.420 --> 00:01:32.740\nAll right, so instead of connecting or\nclicking the connect button down here,\n\n26\n00:01:32.740 --> 00:01:36.790\nI've already saved that RDP file,\nso gonna flip over to downloads and\n\n27\n00:01:36.790 --> 00:01:41.120\nI will double click on\nthat ac-dz01 RDP file.\n\n28\n00:01:41.120 --> 00:01:46.750\nAnd we'll go ahead and\nconnect up to that new AZ virtual machine.\n\n29\n00:01:46.750 --> 00:01:48.170\nIf i can remember my password.\n\n30\n00:01:48.170 --> 00:01:52.890\nI'll say yes to the certificate warning,\n\n31\n00:01:53.950 --> 00:01:55.690\nand we'll go ahead and\nconnect in, so there we go.\n\n32\n00:01:55.690 --> 00:01:59.400\nRemember once we added that disk but\nit was a black disk, so\n\n33\n00:01:59.400 --> 00:02:02.790\njust like any other physical machine,\nvirtual machine, doesn't matter.\n\n34\n00:02:02.790 --> 00:02:04.480\nYou throw a new disk in there.\n\n35\n00:02:04.480 --> 00:02:06.490\nIt's blank, it's not usable.\n\n36\n00:02:06.490 --> 00:02:09.830\nI'm going to have to initialize that disk,\n\n37\n00:02:09.830 --> 00:02:13.960\nI'm going to have to partition the disk,\nand format that partition.\n\n38\n00:02:13.960 --> 00:02:18.020\nSo I'm just going to click on file storage\nservices right here in server manager.\n\n39\n00:02:18.020 --> 00:02:24.080\nClick on disks, and there, I can see that\nten gigabyte disk listed as unknown.\n\n40\n00:02:24.080 --> 00:02:25.490\nSo I'll right click on it.\n\n41\n00:02:25.490 --> 00:02:28.060\nAnd I'll initialize that disk.\n\n42\n00:02:28.060 --> 00:02:30.020\nTells me I'm gonna lose\nany data that's on there.\n\n43\n00:02:30.020 --> 00:02:31.900\nWell, there isn't any so\nI'm okay with that.\n\n44\n00:02:33.160 --> 00:02:34.260\nAnd there we go.\n\n45\n00:02:34.260 --> 00:02:37.140\nNotice it does initialize\nit as a GPT disk,\n\n46\n00:02:37.140 --> 00:02:39.165\na GUID Partition Partition\ntable instead of MBR.\n\n47\n00:02:39.165 --> 00:02:43.965\nNow that I've got that disk created I'll\nright-click again and choose New Volume.\n\n48\n00:02:45.025 --> 00:02:49.295\nAnd this is a standard wizard that\nwe've seen dozens of times, so\n\n49\n00:02:49.295 --> 00:02:51.925\nI will just go ahead and click on through.\n\n50\n00:02:51.925 --> 00:02:56.105\nI'm gonna make one big partition to\ntake up the entire 10 gigabytes.\n\n51\n00:02:56.105 --> 00:02:58.350\nDrive letter F is fine with me.\n\n52\n00:02:58.350 --> 00:03:00.410\nNext NTFS, default.\n\n53\n00:03:00.410 --> 00:03:03.860\nI am an anti Volume Label kind of person.\n\n54\n00:03:03.860 --> 00:03:05.240\nI'm just going to delete that, click Next.\n\n55\n00:03:05.240 --> 00:03:06.285\n>> Michael hates labels.\n\n56\n00:03:06.285 --> 00:03:07.410\n>> [LAUGH] I do hate labels.\n\n57\n00:03:07.410 --> 00:03:08.555\n>> Why you gotta label everyone?\n\n58\n00:03:08.555 --> 00:03:11.460\n>> [LAUGH] It's so\nwrong to do that to a disk.\n\n59\n00:03:11.460 --> 00:03:13.960\nI feel like it\n\n60\n00:03:13.960 --> 00:03:17.190\nwill never live up to it's full potential\nif we label it this early in life.\n\n61\n00:03:17.190 --> 00:03:18.920\n>> Don't wanna pigeonhole that disk.\n\n62\n00:03:18.920 --> 00:03:19.988\n>> Yeah, we don't want to do that.\n\n63\n00:03:19.988 --> 00:03:24.718\nAll right, there we go, that is completed,\nwe'll go ahead and click Close.\n\n64\n00:03:24.718 --> 00:03:28.414\nAnd now I've got my new volume,\nand I should be able to open\n\n65\n00:03:28.414 --> 00:03:33.500\nup File Explorer and I'll see that we've\ngot an F: supposedly, there it is.\n\n66\n00:03:33.500 --> 00:03:35.810\nThere is my new F drive, good to go.\n\n67\n00:03:35.810 --> 00:03:41.740\nAll right, so that is where we're\ngoing to store the NTDS.DIT,\n\n68\n00:03:41.740 --> 00:03:46.350\nthe actual directory database as well as\nSIS wall and I\"ll dump the log files and\n\n69\n00:03:46.350 --> 00:03:48.920\nmight as well just move it all over there.\n\n70\n00:03:48.920 --> 00:03:50.780\nSo now we're going to\ninstall active directory.\n\n71\n00:03:50.780 --> 00:03:54.835\nThis part is no different than\ninstalling active directory locally.\n\n72\n00:03:54.835 --> 00:03:55.800\nActually, I take that back.\n\n73\n00:03:55.800 --> 00:03:59.430\nThere is another thing we need to check,\nright?\n\n74\n00:03:59.430 --> 00:04:01.820\nAnd this is no different\nthan what we normally do.\n\n75\n00:04:01.820 --> 00:04:06.990\nIf I'm gonna join a domain and\nin this case not only join a domain but\n\n76\n00:04:06.990 --> 00:04:11.030\nmake a replica domain controller,\nthis machine needs to be able to\n\n77\n00:04:11.030 --> 00:04:14.090\nfind the current domain\ncontroller right and talk to it.\n\n78\n00:04:14.090 --> 00:04:18.660\nGet a copy of that database well\nwe should okay right because we\n\n79\n00:04:20.840 --> 00:04:22.670\npublished our DNS servers.\n\n80\n00:04:22.670 --> 00:04:27.037\nAnd the first one,\nthe on-premesis was 10.1.1.10.\n\n81\n00:04:27.037 --> 00:04:31.880\nI just wanna verify ipconfig switchall,\nand we'll make sure that,\n\n82\n00:04:31.880 --> 00:04:34.690\nthere we go, my DNS server's listed,\nfirst one, 10.1.1.10.\n\n83\n00:04:34.690 --> 00:04:39.180\nWe've already seen that\nwe can ping one way.\n\n84\n00:04:39.180 --> 00:04:42.710\nLet's see if we can ping back 10.1.1.10.\n\n85\n00:04:42.710 --> 00:04:44.350\nAnd we're good to go there.\n\n86\n00:04:44.350 --> 00:04:47.090\nWe could also test name\nresolution at this point.\n\n87\n00:04:47.090 --> 00:04:51.712\nI could do ping,\nif I could remember his name, gnv-dco1.\n\n88\n00:04:51.712 --> 00:04:55.660\nMake sure it resolves correctly.\n\n89\n00:04:55.660 --> 00:04:58.990\nAnd it actually did not,\nthat's interesting.\n\n90\n00:04:58.990 --> 00:05:00.900\nLet's try a fully qualified domain name.\n\n91\n00:05:02.950 --> 00:05:04.366\nWhat is my domain name?\n\n92\n00:05:04.366 --> 00:05:08.857\nLet's see, itprotvdemo.com.\n\n93\n00:05:08.857 --> 00:05:09.860\nAnd there we go.\n\n94\n00:05:09.860 --> 00:05:14.030\nSo get that, get rid of that Wins or\nyou know, the Net Bios name.\n\n95\n00:05:14.030 --> 00:05:17.310\nJust use a fully qualified domain name,\nand it resolves just fine.\n\n96\n00:05:17.310 --> 00:05:19.990\nSo, that lets me know that,\nwhen I go through this process,\n\n97\n00:05:19.990 --> 00:05:22.560\nwhen I go through that active\ndirectory configuration wizard\n\n98\n00:05:22.560 --> 00:05:26.820\nIts going to be able to find\nthat existing domain controller.\n\n99\n00:05:26.820 --> 00:05:31.380\nAll right so we'll go ahead and close down\npower shell and I'll do my add roles and\n\n100\n00:05:31.380 --> 00:05:32.250\nfeatures.\n\n101\n00:05:32.250 --> 00:05:36.540\nWe've seen this in our very first or\nsecond episode when we went and installed\n\n102\n00:05:36.540 --> 00:05:40.350\nactive directory initially on the on\npremise so I'm gonna go kind of fast.\n\n103\n00:05:40.350 --> 00:05:42.370\nWe are gonna need to make a change to DNS.\n\n104\n00:05:42.370 --> 00:05:45.240\nRemember we published those DNS and\nremember,\n\n105\n00:05:45.240 --> 00:05:50.255\nI said my Cloud-based DNS server was\n10.1.2.10 instead I've got a 10.1.2.4.\n\n106\n00:05:50.255 --> 00:05:55.310\nWe'll talk a little more\nabout that in just a second.\n\n107\n00:05:55.310 --> 00:05:57.600\nBut I can't click and\ntalk at the same time.\n\n108\n00:05:57.600 --> 00:06:00.240\nIt's very difficult, so\nI'll continue on here.\n\n109\n00:06:00.240 --> 00:06:01.940\nActive Directory Domain Services.\n\n110\n00:06:01.940 --> 00:06:06.050\nI'll click next,\ndon't need any additional features.\n\n111\n00:06:06.050 --> 00:06:07.170\nPretty much all the defaults.\n\n112\n00:06:07.170 --> 00:06:08.810\nAnd I'll go ahead and click Install.\n\n113\n00:06:08.810 --> 00:06:11.130\nAnd that's gonna install that role.\n\n114\n00:06:11.130 --> 00:06:15.380\nNow, while it's doing that,\nlet's again talk about that DNS issue, and\n\n115\n00:06:15.380 --> 00:06:18.690\nIP in general with Azure.\n\n116\n00:06:18.690 --> 00:06:22.970\nI think I mentioned this before, but\nit warrants some mentioning again.\n\n117\n00:06:22.970 --> 00:06:27.870\nThe IP addresses are assigned dynamically\nto the virtual machines that I create out\n\n118\n00:06:27.870 --> 00:06:32.020\nthere in Azure, which means I don't really\nhave control over what IP address it gives\n\n119\n00:06:32.020 --> 00:06:35.660\nit other than I picked the subnet\nthat it's gonna place it on.\n\n120\n00:06:35.660 --> 00:06:38.960\nAnd you notice it started with four, and\nthat's because it reserves a couple of\n\n121\n00:06:38.960 --> 00:06:42.410\nthose addresses for\nsome internal workings of that subnet.\n\n122\n00:06:42.410 --> 00:06:44.430\nI'm like, the gives it a gate way.\n\n123\n00:06:44.430 --> 00:06:46.580\nI think 10.102.\nI think it uses one for\n\n124\n00:06:46.580 --> 00:06:48.640\nthe gateway if I remember correctly.\n\n125\n00:06:48.640 --> 00:06:50.530\nAnd I can't change that.\n\n126\n00:06:50.530 --> 00:06:53.520\nI can't go in and statically map this.\n\n127\n00:06:53.520 --> 00:06:58.080\nI have before in the past tried to\nuse some static mapping techniques.\n\n128\n00:06:58.080 --> 00:07:01.100\nThere's actually some PowerShell\ncommands that you can use\n\n129\n00:07:01.100 --> 00:07:03.220\nto not really statically map it.\n\n130\n00:07:03.220 --> 00:07:06.770\nBut force a reservation, for\na particular IP address.\n\n131\n00:07:06.770 --> 00:07:08.480\nBut I've never gotten that to work.\n\n132\n00:07:08.480 --> 00:07:09.480\nI'll tell you, I don't know.\n\n133\n00:07:09.480 --> 00:07:13.410\nIf it was something that Microsoft\nchanged up there, the powershell\n\n134\n00:07:13.410 --> 00:07:16.670\ncommands are still there, but they don't\nseem to do what they're supposed to do.\n\n135\n00:07:16.670 --> 00:07:20.990\nAnd I still end up with, it picking an IP\naddress for me, within that subnet range.\n\n136\n00:07:20.990 --> 00:07:23.240\nSo, just something you\nwant to keep in mind.\n\n137\n00:07:23.240 --> 00:07:27.140\nRemember what we said though,\nit's okay that it's assigned dynamically,\n\n138\n00:07:27.140 --> 00:07:30.430\nbecause once it is assigned,\nit does create the reservation.\n\n139\n00:07:30.430 --> 00:07:33.880\nAnd it will maintain 10.1.2.4 for\n\n140\n00:07:33.880 --> 00:07:37.160\nthe lifetime of this virtual machine,\nunless I decommission.\n\n141\n00:07:37.160 --> 00:07:38.720\nIf I deprovision it or\n\n142\n00:07:38.720 --> 00:07:41.920\ndeprovision that subnet,\nobviously that's gonna change things.\n\n143\n00:07:41.920 --> 00:07:45.680\nBut as long as I don't do that I don't\nhave to worry about that IP address\n\n144\n00:07:45.680 --> 00:07:46.318\nchanging.\n\n145\n00:07:46.318 --> 00:07:50.159\nAnd that's important cuz Active Directory\nneeds that permanent IP address,\n\n146\n00:07:50.159 --> 00:07:51.450\nlike statically mapped.\n\n147\n00:07:51.450 --> 00:07:55.196\nSo, even though it's not technically\nstatically mapped, it's got a reservation,\n\n148\n00:07:55.196 --> 00:07:56.698\nit will maintain that IP address.\n\n149\n00:07:56.698 --> 00:08:01.398\nAll right, so we're waiting for\nthat roll to get past that 64%.\n\n150\n00:08:01.398 --> 00:08:03.987\nWe'll let that chug along.\n\n151\n00:08:03.987 --> 00:08:05.695\nWhat else can we look at?\n\n152\n00:08:05.695 --> 00:08:09.584\nWe can actually go and And while that's\ndoing that, how about we do this.\n\n153\n00:08:09.584 --> 00:08:13.953\nI'll flip back over to our cloud,\nas I make everybody sick there,\n\n154\n00:08:13.953 --> 00:08:16.140\nflipping back and forth.\n\n155\n00:08:16.140 --> 00:08:19.938\nAnd what I wanna do is,\nI'm gonna go back over to network,\n\n156\n00:08:19.938 --> 00:08:23.048\nnot storage Mike,\nwhere's my little arrows?\n\n157\n00:08:23.048 --> 00:08:27.889\nThere we go, there's my network and\nI'm gonna go to DNS SERVERS.\n\n158\n00:08:27.889 --> 00:08:34.610\nAnd we can go ahead and fix this while\nwe're here, there's my az-dc01, 10.1.2.10.\n\n159\n00:08:34.610 --> 00:08:36.630\nI'm just gonna go ahead and delete that.\n\n160\n00:08:39.605 --> 00:08:41.422\n[SOUND] And what does it say,\n\n161\n00:08:41.422 --> 00:08:46.015\nis referenced to virtual network\naz-subnet and cannot be removed.\n\n162\n00:08:46.015 --> 00:08:51.110\nAll right, so\nwe'll have to remove it from that subnet,\n\n163\n00:08:51.110 --> 00:08:54.942\nwhich was kinda what I\nthought I was doing.\n\n164\n00:08:54.942 --> 00:08:57.848\nSo let's pull up this Azure subnet again.\n\n165\n00:09:01.463 --> 00:09:05.423\nLet's see, well it might be something\nI have to do a little bit later.\n\n166\n00:09:05.423 --> 00:09:09.358\nIt really doesn't look,\nthere we go, configure.\n\n167\n00:09:09.358 --> 00:09:13.350\nAll right, and there's my DNS servers and\nI probably can just edit this guy.\n\n168\n00:09:13.350 --> 00:09:16.630\nLet me see if it will let me, oops.\n\n169\n00:09:16.630 --> 00:09:18.060\nDoggone it, try that again.\n\n170\n00:09:20.000 --> 00:09:24.010\nI love Macs, I'm teasing,\nI do, I don't mind them.\n\n171\n00:09:24.010 --> 00:09:26.870\nBut you know, delete key, would be\nnice if when you hit the delete key\n\n172\n00:09:26.870 --> 00:09:29.880\nit actually deleted something\ninstead of went backwards.\n\n173\n00:09:29.880 --> 00:09:33.110\nAll right, so it's not gonna let\nme change that IP address there.\n\n174\n00:09:33.110 --> 00:09:37.120\nSo what I'm gonna do is I'm gonna\ngo ahead and remove it, and\n\n175\n00:09:37.120 --> 00:09:39.360\nthen I'm going to see if it.\n\n176\n00:09:39.360 --> 00:09:41.060\nSo those are the ones that are registered.\n\n177\n00:09:41.060 --> 00:09:43.425\nI'm gonna go ahead and remove that one.\n\n178\n00:09:43.425 --> 00:09:49.416\nAnd I'm going to enter a new name,\nif it'll let me.\n\n179\n00:09:49.416 --> 00:09:50.589\nIt's not gonna let me.\n\n180\n00:09:50.589 --> 00:09:54.540\nIt's really not happy about that.\n\n181\n00:09:54.540 --> 00:09:59.060\nSo I'll work on that, let me check and\nsee if my Active Direct, I don't wanna\n\n182\n00:09:59.060 --> 00:10:03.050\nwait too long, we'll get that straightened\nout, and I'll show you guys what I do.\n\n183\n00:10:03.050 --> 00:10:06.370\nBut if roll has finished, I'm gonna\ngo ahead and click Close on that and\n\n184\n00:10:06.370 --> 00:10:08.500\nthen we'll promote this guy\nto a domain controller.\n\n185\n00:10:08.500 --> 00:10:10.130\nWe'll go ahead and get that part started.\n\n186\n00:10:10.130 --> 00:10:13.030\nBecause as long as the first\nDNS server is correct and\n\n187\n00:10:13.030 --> 00:10:16.272\nthat one's pointing to my on-premises DNS\nserver, and that's the one I need to find.\n\n188\n00:10:16.272 --> 00:10:21.030\n10.1.2.10 is not running DNS yet,\n10.1.2.4 is not even\n\n189\n00:10:21.030 --> 00:10:25.320\nrunning DNS yet, so I'm okay with\nfixing that in just a moment.\n\n190\n00:10:25.320 --> 00:10:27.950\nSo here normal domain installation,\n\n191\n00:10:27.950 --> 00:10:30.560\nwe're gonna add a domain\ncontroller to an existing domain.\n\n192\n00:10:30.560 --> 00:10:32.060\nWhat domain do you want?\n\n193\n00:10:32.060 --> 00:10:38.832\nThat's gonna be itprotvdemo.com.\n\n194\n00:10:38.832 --> 00:10:43.426\nAnd then we'll go ahead and\nchoose or set my credentials.\n\n195\n00:10:43.426 --> 00:10:49.420\nCredentials for that are going to be,\n\n196\n00:10:49.420 --> 00:10:52.238\nlet's see, az.\n\n197\n00:10:52.238 --> 00:10:53.567\nActually that's not gonna be right.\n\n198\n00:10:53.567 --> 00:10:58.936\nThat's gonna be itprotvdemo\\administrator,\n\n199\n00:10:58.936 --> 00:11:02.520\nand my super-secret password.\n\n200\n00:11:04.968 --> 00:11:07.868\nAll right, so that's an account that\nhas credentials to add a domain\n\n201\n00:11:07.868 --> 00:11:09.820\ncontroller to that existing domain, right?\n\n202\n00:11:09.820 --> 00:11:13.136\nSo I need to be at least a domain\nadmin in that domain, and so\n\n203\n00:11:13.136 --> 00:11:15.730\nthere's my credentials for that.\n\n204\n00:11:15.730 --> 00:11:17.167\nWe'll go ahead and click Next.\n\n205\n00:11:20.152 --> 00:11:21.560\nMake sure you can find it.\n\n206\n00:11:21.560 --> 00:11:26.450\nEverything should check out if I didn't\nmake any silly typos in there, all right?\n\n207\n00:11:26.450 --> 00:11:27.030\nSo that's good.\n\n208\n00:11:27.030 --> 00:11:28.700\nIt moved past that screen.\n\n209\n00:11:28.700 --> 00:11:32.900\nThat means it was able to find an existing\ndomain controller in that domain.\n\n210\n00:11:32.900 --> 00:11:34.910\nThat means it's going across\nour site to site VPN.\n\n211\n00:11:36.430 --> 00:11:38.800\nAll right, and we do wanna put DNS\nup here, and I'm gonna go ahead and\n\n212\n00:11:38.800 --> 00:11:40.660\nmake a global catalog as well.\n\n213\n00:11:40.660 --> 00:11:44.390\nRemember, this is really\ngonna be a couple of things.\n\n214\n00:11:44.390 --> 00:11:45.740\nOne of the reasons we do this is for\n\n215\n00:11:45.740 --> 00:11:49.730\ndisaster recovery, Active Directory\nrequires a global catalog.\n\n216\n00:11:49.730 --> 00:11:53.570\nI wanna make sure that I'm running a\nglobal catalog up in the cloud as well, so\n\n217\n00:11:53.570 --> 00:11:57.860\nif I lose my enterprise network,\nI still have a global catalog.\n\n218\n00:11:57.860 --> 00:11:59.829\nWe'll set our DSRM password.\n\n219\n00:12:03.739 --> 00:12:06.329\nWe'll click Next.\n\n220\n00:12:06.329 --> 00:12:08.847\nIt tells me it can't create a delegation,\nthat's fine.\n\n221\n00:12:08.847 --> 00:12:09.996\nWe'll go ahead and click Next.\n\n222\n00:12:14.049 --> 00:12:19.109\nFor additional options, I could choose to\npick a particular domain controller to\n\n223\n00:12:19.109 --> 00:12:24.038\nreplicate from, we only have one but\nnotice it did find it, it's in that list.\n\n224\n00:12:24.038 --> 00:12:27.185\nYou could leave it at any, that's the only\none to choose from, we'll go ahead and\n\n225\n00:12:27.185 --> 00:12:27.696\nclick Next.\n\n226\n00:12:27.696 --> 00:12:29.102\nThis is where we gotta pay attention,\nright?\n\n227\n00:12:29.102 --> 00:12:32.430\nThis is where it's different from what\nwe did in our first few episodes.\n\n228\n00:12:32.430 --> 00:12:36.612\nI have to change this to that F drive.\n\n229\n00:12:36.612 --> 00:12:40.373\nAll right, so we'll change that to F:,\n\n230\n00:12:40.373 --> 00:12:46.360\nchange that one to F, and\nwe'll change that one to F, right?\n\n231\n00:12:46.360 --> 00:12:49.855\nSo, we'll zoom in there real quick,\nyou see we've changed all\n\n232\n00:12:49.855 --> 00:12:54.076\nof those to the F drive, that newly\ncreated drive that we attached to this VM.\n\n233\n00:12:54.076 --> 00:12:57.815\nI'll click Next, review my choices,\n\n234\n00:12:57.815 --> 00:13:01.905\nclick Next, go through my prereq checks.\n\n235\n00:13:01.905 --> 00:13:03.745\nHopefully I get no exclamation points,\n\n236\n00:13:03.745 --> 00:13:07.217\nnothing major that's gonna prevent\nme from installing Active Directory.\n\n237\n00:13:13.486 --> 00:13:14.670\nIt's thinking about it.\n\n238\n00:13:14.670 --> 00:13:15.970\nOne or more prereqs failed.\n\n239\n00:13:15.970 --> 00:13:17.680\nVerification of user credential permission\nfailed in Active Directory's main\n\n240\n00:13:17.680 --> 00:13:19.100\ncontroller for the domain,\nItprotvdemo could not be contacted.\n\n241\n00:13:22.480 --> 00:13:27.761\nAll right, so it's telling me that\nit's having issues with that.\n\n242\n00:13:27.761 --> 00:13:35.085\nSo, I probably need to figure out why.\n\n243\n00:13:35.085 --> 00:13:37.826\nAll right, so\nit tells me that it cannot connect.\n\n244\n00:13:37.826 --> 00:13:42.745\nSo, I'm gonna go ahead and\njust click Previous on this, and\n\n245\n00:13:42.745 --> 00:13:47.476\nsee if I can't figure out why\nhe's not connecting there.\n\n246\n00:13:47.476 --> 00:13:49.734\nI did ping him.\n\n247\n00:13:49.734 --> 00:13:55.334\nDo a little ping again, we'll say ping,\n\n248\n00:13:55.334 --> 00:14:02.063\nwhat was it, gnv-dc01.itprotvdemo.com.\n\n249\n00:14:03.400 --> 00:14:04.720\nAnd he can definitely connect to him.\n\n250\n00:14:04.720 --> 00:14:08.790\nSo there's just something that's\nhung up that's causing an issue and\n\n251\n00:14:08.790 --> 00:14:10.690\nI just have to figure out what it is.\n\n252\n00:14:10.690 --> 00:14:13.730\nIt's not a connectivity thing.\n\n253\n00:14:13.730 --> 00:14:16.240\nSo go ahead and close,\nwell we'll leave that open for a second.\n\n254\n00:14:17.275 --> 00:14:18.788\nLet's see what else we can do.\n\n255\n00:14:18.788 --> 00:14:23.650\nWhat I'm gonna try to do is go back\nto that first screen and do a Select.\n\n256\n00:14:25.720 --> 00:14:28.590\nAnd there it's got the domain so\nit sees the domain.\n\n257\n00:14:28.590 --> 00:14:33.200\nAnd what I'm doing here is by clicking\nthis Select, it's actually browsing and\n\n258\n00:14:33.200 --> 00:14:36.070\nsaying I see that domain out there.\n\n259\n00:14:36.070 --> 00:14:38.188\nSo I go ahead and click OK to that.\n\n260\n00:14:38.188 --> 00:14:42.877\nI'll change my credentials.\n\n261\n00:14:42.877 --> 00:14:49.818\nLet's do it again,\nitprotvdemo\\administrator.\n\n262\n00:14:52.628 --> 00:14:56.111\nMake sure I type that\npassword in correctly.\n\n263\n00:14:59.071 --> 00:15:02.589\nAll right, and then jump back through\nthese options one more time here.\n\n264\n00:15:07.465 --> 00:15:11.053\nSo this point, what it's supposed to be\ndoing is reaching out and making sure that\n\n265\n00:15:11.053 --> 00:15:14.174\nit verifies this information,\nthe name of the domain that I wanna add,\n\n266\n00:15:14.174 --> 00:15:17.367\nthis domain controller two, and\nthe credentials that I have provided.\n\n267\n00:15:17.367 --> 00:15:18.376\nNow I get a warning.\n\n268\n00:15:18.376 --> 00:15:19.151\nThe first time I did not.\n\n269\n00:15:19.151 --> 00:15:24.828\nVerification request fail,\n[INAUDIBLE] could not be contacted.\n\n270\n00:15:24.828 --> 00:15:30.853\nEnsure and\nsupply the correct DNS domain name,\n\n271\n00:15:30.853 --> 00:15:33.569\nitprotvdemo.com.\n\n272\n00:15:33.569 --> 00:15:35.126\nLet's verify.\n\n273\n00:15:35.126 --> 00:15:37.690\nIt says to verify, we will verify.\n\n274\n00:15:37.690 --> 00:15:42.241\nWe're gonna flip back over here,\nlog into my domain controller.\n\n275\n00:15:49.022 --> 00:15:54.303\nITPROTVDEMO\\administrator is\nthe account that I'm using.\n\n276\n00:15:54.303 --> 00:15:57.862\nI haven't changed that password,\nshould be good to go there as well.\n\n277\n00:15:57.862 --> 00:16:00.950\nMm, interesting, tell you what we'll do.\n\n278\n00:16:00.950 --> 00:16:06.184\nLet's do this, let's cancel this\nwizard for just a second Close\n\n279\n00:16:06.184 --> 00:16:12.280\ndown power shell, and\nlet's just see if we can join that domain.\n\n280\n00:16:12.280 --> 00:16:16.470\nI'm gonna go to local server over here and\nclick on Workgroup.\n\n281\n00:16:17.710 --> 00:16:20.890\nAnd we'll change that, and\nwe'll try to join the domain,\n\n282\n00:16:20.890 --> 00:16:23.310\nmake this a member server, and\nsee if we can promote it after that.\n\n283\n00:16:23.310 --> 00:16:28.295\nSo I'll do itprotvdemo.com.\n\n284\n00:16:28.295 --> 00:16:30.293\nClick OK.\n\n285\n00:16:30.293 --> 00:16:36.080\nAnd I found the domain controller,\nthen, silly wizards.\n\n286\n00:16:36.080 --> 00:16:40.890\nAdministrator, same old password.\n\n287\n00:16:44.833 --> 00:16:46.225\n>> Looking for that lovely welcome screen.\n\n288\n00:16:46.225 --> 00:16:50.244\n>> Mm-hm,\nwelcome to the IT Pro TV demo.com domain.\n\n289\n00:16:50.244 --> 00:16:52.740\nAll right, and we'll go ahead and\nreboot this guy and\n\n290\n00:16:52.740 --> 00:16:55.380\nsee if that helps our\nsituation a little bit.\n\n291\n00:16:55.380 --> 00:16:58.712\n>> We probably should have just\nrebooted it to begin with, right?\n\n292\n00:16:58.712 --> 00:17:00.470\n>> [LAUGH] Yeah.\n>> It's probably the thing that cures\n\n293\n00:17:00.470 --> 00:17:04.010\nevery computer ailment,\ndid you reboot the thing?\n\n294\n00:17:04.010 --> 00:17:06.458\nWell, no, why don't you try that for\nme real quick.\n\n295\n00:17:06.458 --> 00:17:10.630\n[LAUGH] And of course, that is not\nlost on even guys who know better.\n\n296\n00:17:10.630 --> 00:17:13.920\nWe should be doing that.\n\n297\n00:17:13.920 --> 00:17:16.627\n>> So now what I'm doing, I'm actually\nchecking out some of those DMS\n\n298\n00:17:16.627 --> 00:17:20.635\nissues while we've got some time, while\nwe're waiting for that thing to reboot.\n\n299\n00:17:20.635 --> 00:17:27.465\nActually what I could do to see,\nlet's do this, 10.1.2.4 -t.\n\n300\n00:17:27.465 --> 00:17:34.155\nAnd it's already replying, so\nI didn't even need the -t.\n\n301\n00:17:34.155 --> 00:17:36.330\nWe are good to go.\n\n302\n00:17:36.330 --> 00:17:38.630\nOpen up, there it goes now it's\nfinished and it's starting to reboot.\n\n303\n00:17:41.290 --> 00:17:43.220\nWow, that is fast, right?\n\n304\n00:17:43.220 --> 00:17:44.210\n>> That is a smoking fast.\n\n305\n00:17:44.210 --> 00:17:45.890\n[LAUGH]\n>> That was really quick.\n\n306\n00:17:45.890 --> 00:17:47.290\nAlmost makes me believe it didn't do it.\n\n307\n00:17:47.290 --> 00:17:49.972\nBut, you know, it's like,\nwait, do I trust that?\n\n308\n00:17:49.972 --> 00:17:52.990\nAll right, so according to that,\nit is back up and running,\n\n309\n00:17:52.990 --> 00:17:55.770\nso we're gonna see if\nwe can connect again.\n\n310\n00:17:57.290 --> 00:18:00.740\nSo, I'll double click on the RDP file and\nwe'll just say you know what,\n\n311\n00:18:00.740 --> 00:18:02.970\ndon't ask me that again.\n\n312\n00:18:02.970 --> 00:18:04.390\nAnd I'll authenticate.\n\n313\n00:18:08.549 --> 00:18:11.270\nAnd I'm gonna trust that for a while so\nwe can stop seeing that message.\n\n314\n00:18:13.040 --> 00:18:14.750\nAnd sure enough it is done rebooting.\n\n315\n00:18:14.750 --> 00:18:15.329\nThat's impressive.\n\n316\n00:18:16.960 --> 00:18:18.840\nTis impressive, all right.\n\n317\n00:18:19.950 --> 00:18:23.840\nSo we'll wait for server manager to kick\nin and we'll try this one more time.\n\n318\n00:18:23.840 --> 00:18:28.420\nIf I go to local server and I hate\nclicking before its done refreshing and\n\n319\n00:18:28.420 --> 00:18:29.800\nI'll probably lock it up, there it goes.\n\n320\n00:18:32.250 --> 00:18:34.060\nSo we'll get it up and\ngo to local server and\n\n321\n00:18:34.060 --> 00:18:37.270\nI just want to verify that I\nam indeed part of the domain.\n\n322\n00:18:37.270 --> 00:18:38.190\nThere we go.\n\n323\n00:18:38.190 --> 00:18:40.480\nI've got my domain profile now turned on.\n\n324\n00:18:40.480 --> 00:18:42.000\nIt was on private.\n\n325\n00:18:42.000 --> 00:18:46.840\nThat could have had something to do\nwith me being able to add that replica.\n\n326\n00:18:46.840 --> 00:18:48.980\nSo lets try it one more time.\n\n327\n00:18:48.980 --> 00:18:52.190\nLets do our little,\nsee what our warning is up here.\n\n328\n00:18:52.190 --> 00:18:53.530\nPromote the server to main controller.\n\n329\n00:18:53.530 --> 00:18:57.020\nWell we've tried that,\nwe gonna try that again.\n\n330\n00:18:57.020 --> 00:18:59.432\nSo, we'll let this fill out.\n\n331\n00:18:59.432 --> 00:19:04.520\nAll right, I added\n\n332\n00:19:04.520 --> 00:19:10.260\na main controller to an existing domain\nitprotvdemo.com, we'll change credentials\n\n333\n00:19:10.260 --> 00:19:14.000\nbecause the local admin on this machine\nis not gonna have those kind of rights.\n\n334\n00:19:14.000 --> 00:19:19.540\nThat should be itprotvdemo/administrator.\n\n335\n00:19:21.080 --> 00:19:24.633\nSame password, and we'll click next.\n\n336\n00:19:29.269 --> 00:19:31.370\nAnd we'll see if we get\nthat red bar this time.\n\n337\n00:19:34.990 --> 00:19:37.190\nSo we made it past that first screen,\nthat's a good sign, right?\n\n338\n00:19:37.190 --> 00:19:38.435\n>> Fingers crossed.\n\n339\n00:19:38.435 --> 00:19:40.180\n>> [LAUGH] Course the, now okay.\n\n340\n00:19:40.180 --> 00:19:40.680\nThere we go.\n\n341\n00:19:40.680 --> 00:19:42.330\nThat looks a little bit better.\n\n342\n00:19:42.330 --> 00:19:45.250\nI noticed, you know, and\none thing I didn't mention the last time.\n\n343\n00:19:45.250 --> 00:19:47.960\nIt picked it by default and\nI didn't mention it and\n\n344\n00:19:47.960 --> 00:19:50.190\nthat's actually probably a good\nthing we came back through here.\n\n345\n00:19:50.190 --> 00:19:51.860\nNotice I do get to choose the site.\n\n346\n00:19:51.860 --> 00:19:56.160\nRemember initially we created one site for\nour on premises network.\n\n347\n00:19:56.160 --> 00:19:58.210\nOne site for my Azure virtual network.\n\n348\n00:19:58.210 --> 00:20:01.510\nI do wanna make sure that I\nput that in the right site.\n\n349\n00:20:01.510 --> 00:20:02.510\nIt sees the IP address.\n\n350\n00:20:02.510 --> 00:20:05.710\nRemember how we define sites is by subnet.\n\n351\n00:20:05.710 --> 00:20:09.410\nSo it sees that, and it picked the right\none, but it is good to point out.\n\n352\n00:20:09.410 --> 00:20:13.600\nWe'll go ahead and\ntype in my DSRN password.\n\n353\n00:20:19.779 --> 00:20:24.140\nLet it chug along there, can't create a\ndelegation, that's fine, we'll click Next.\n\n354\n00:20:25.440 --> 00:20:27.940\nWe're not worried about what domain\ncontroller you replicate from,\n\n355\n00:20:27.940 --> 00:20:29.840\nwe just want you to replicate.\n\n356\n00:20:29.840 --> 00:20:31.415\n>> All's quiet on the western front so\nfar.\n\n357\n00:20:31.415 --> 00:20:32.320\n[LAUGH]\n>> That's right.\n\n358\n00:20:32.320 --> 00:20:38.690\nWe'll click next, we are gonna go in and\nchange these guys again so we'll put our,\n\n359\n00:20:38.690 --> 00:20:45.811\nI'll even make it pretty this time,\nI'll put that uppercase F there and\n\n360\n00:20:45.811 --> 00:20:50.160\nthere and there.\n\n361\n00:20:50.160 --> 00:20:56.760\nUh-oh, I've lost my zooming capabilities,\nthere we go.\n\n362\n00:20:56.760 --> 00:21:01.067\nWe'll click Next, and Next.\n\n363\n00:21:04.061 --> 00:21:04.840\nDrum roll please.\n\n364\n00:21:04.840 --> 00:21:09.510\n[LAUGH]\n>> And the Oscar goes to [LAUGH].\n\n365\n00:21:09.510 --> 00:21:12.580\n>> Right?\n[LAUGH] There we go, look at that,\n\n366\n00:21:12.580 --> 00:21:14.130\ngreen check mark.\n\n367\n00:21:14.130 --> 00:21:18.260\nSo mostly likely an issue with\na firewall blocking something,\n\n368\n00:21:18.260 --> 00:21:23.310\nbecause I had that private profile,\nbecause it wasn't part of the domain.\n\n369\n00:21:23.310 --> 00:21:25.640\nSo join it to the domain first.\n\n370\n00:21:25.640 --> 00:21:29.360\nAnd then you do your DC promo,\nseems to work a little bit better.\n\n371\n00:21:29.360 --> 00:21:30.130\nI'll go ahead.\n\n372\n00:21:30.130 --> 00:21:33.860\nAnd these are the warnings we saw when\nwe created our first domain controller,\n\n373\n00:21:33.860 --> 00:21:37.290\nnot being compatible with\nolder operating systems,\n\n374\n00:21:37.290 --> 00:21:39.960\nnot being able to create that delegation.\n\n375\n00:21:39.960 --> 00:21:44.140\nIt also warns me on this one, one warning\nwe didn't see on our first domain\n\n376\n00:21:44.140 --> 00:21:48.720\ncontroller, was the fact that I don't\nhave a static IP address assigned to it.\n\n377\n00:21:48.720 --> 00:21:52.510\nBut we've already said I can't do that\nup there in the cloud but we're okay\n\n378\n00:21:52.510 --> 00:21:56.560\nbecause it creates a reservation,\nso it is sort of in a way static.\n\n379\n00:21:56.560 --> 00:22:02.070\nWe'll click install and it's going to\ngo through the process of replicating.\n\n380\n00:22:02.070 --> 00:22:04.930\nIt's like any other replicate\nof the main controller.\n\n381\n00:22:04.930 --> 00:22:07.230\nAdding a main controller\ninto an existing domain,\n\n382\n00:22:07.230 --> 00:22:11.460\nthat means it's going to install active\ndirectory, it's going to set up Sysvol,\n\n383\n00:22:11.460 --> 00:22:16.580\nit's gonna copy that database from\nthat existing domain controller\n\n384\n00:22:16.580 --> 00:22:21.500\nover to this guy,\ncreate that second domain controller.\n\n385\n00:22:21.500 --> 00:22:24.300\nSo it shouldn't take too long,\nbut I'll tell you what we'll do.\n\n386\n00:22:24.300 --> 00:22:27.020\nIt'll take about five minutes probably for\nthis to complete, so\n\n387\n00:22:27.020 --> 00:22:28.890\nwe'll do a quickly little time out here.\n\n388\n00:22:28.890 --> 00:22:32.840\nWhen we come back, we should have our\nsecond domain controller up and running.\n\n389\n00:22:32.840 --> 00:22:34.330\nAll right, so it's finished rebooting.\n\n390\n00:22:34.330 --> 00:22:37.040\nI was doing a couple of pings,\nwaiting for it to start responding so\n\n391\n00:22:37.040 --> 00:22:38.230\nI know it's up and running.\n\n392\n00:22:38.230 --> 00:22:40.080\nAnd we'll try to remote back into it.\n\n393\n00:22:41.840 --> 00:22:42.570\nAnd there we go.\n\n394\n00:22:42.570 --> 00:22:46.216\nAnd I'm gonna have to switch accounts,\n\n395\n00:22:46.216 --> 00:22:50.945\ncuz now I need to use\nIT Pro TV demo/administrator.\n\n396\n00:22:57.621 --> 00:22:58.689\nIf I can remember what password I used for\nthat account.\n\n397\n00:23:01.766 --> 00:23:02.741\nAnd we'll see what happens.\n\n398\n00:23:08.054 --> 00:23:11.560\nThe tempt, the green bars.\n\n399\n00:23:11.560 --> 00:23:13.010\nYeah, it reminds me the,\nwhat's that called?\n\n400\n00:23:13.010 --> 00:23:16.130\nIf anybody remembers, the old Heinz\ncommercials, the ketchup, right?\n\n401\n00:23:16.130 --> 00:23:17.385\nAnticipation, yeah.\n\n402\n00:23:17.385 --> 00:23:21.790\n[LAUGH]\nAll right, there we go,\n\n403\n00:23:21.790 --> 00:23:25.855\nwe are remoting back in slowly but surely.\n\n404\n00:23:25.855 --> 00:23:27.520\n[COUGH] We'll get back here.\n\n405\n00:23:27.520 --> 00:23:29.150\n>> It just had a major\nchange in it's life,\n\n406\n00:23:29.150 --> 00:23:31.580\nyou gotta give it a minute,\nit's gathering itself.\n\n407\n00:23:31.580 --> 00:23:33.740\n>> Yeah, it's one of those life changes,\nall right, here we go.\n\n408\n00:23:33.740 --> 00:23:38.630\nWe're gonna let server manager do its\nrefresh, as we talked about before.\n\n409\n00:23:38.630 --> 00:23:42.320\nIt does slow it down when I start clicking\non things before it's ready for me.\n\n410\n00:23:42.320 --> 00:23:45.200\nWhat we could do, though, is flip\nback over to this domain controller,\n\n411\n00:23:45.200 --> 00:23:50.490\nmy on-premise DC, and let's open up\nactive directory users and computers.\n\n412\n00:23:50.490 --> 00:23:53.100\nTools, maybe.\n\n413\n00:23:54.510 --> 00:24:04.040\nActive directory users and computers and\ndomain controllers and look there.\n\n414\n00:24:04.040 --> 00:24:07.840\nThere is another domain controller listed,\nall right.\n\n415\n00:24:07.840 --> 00:24:09.080\nThat is a good sign.\n\n416\n00:24:09.080 --> 00:24:14.540\nAll right, so flip back over here to as\nyour DCO one and what was I gonna do.\n\n417\n00:24:14.540 --> 00:24:17.440\nYou can see there's active directory,\nthere's DNS.\n\n418\n00:24:17.440 --> 00:24:21.769\nI should be able to do tools and\nactive directory users and computers.\n\n419\n00:24:23.870 --> 00:24:27.740\nAnd sure enough we're opened up, there we\ngo, I go down to the main controllers,\n\n420\n00:24:27.740 --> 00:24:30.050\nI can see both of those\ndomain controllers there.\n\n421\n00:24:30.050 --> 00:24:34.650\nAnother thing we might wanna do is check,\nmake sure I look at my F drive and\n\n422\n00:24:35.820 --> 00:24:40.970\nthere's windows and there's NTDS,\nthere's my active directory database,\n\n423\n00:24:40.970 --> 00:24:42.970\nthere's the associated log files.\n\n424\n00:24:42.970 --> 00:24:45.370\nI jump back out, there's SYSVOL, and\n\n425\n00:24:45.370 --> 00:24:47.650\nall the things that are gonna\nreplicate along with SYSVOL.\n\n426\n00:24:47.650 --> 00:24:52.190\nSo at this point, we have another\ndomain controller out there in Azure.\n\n427\n00:24:52.190 --> 00:24:55.170\nNow we've still got a few things\nthat we really should do.\n\n428\n00:24:55.170 --> 00:24:57.610\nRemember our availability\nset is not complete,\n\n429\n00:24:57.610 --> 00:24:59.880\ncuz I've only got one domain\ncontroller out there in the cloud.\n\n430\n00:25:01.010 --> 00:25:02.560\nSo probably what I'm gonna do for\n\n431\n00:25:02.560 --> 00:25:05.390\neverybody is before we get to\nthe next episode, I'll go ahead and\n\n432\n00:25:05.390 --> 00:25:08.860\nrun through that process again,\nit'll be the exact same thing.\n\n433\n00:25:08.860 --> 00:25:11.920\nSet up a second domain controller\nup there in the cloud,\n\n434\n00:25:11.920 --> 00:25:15.475\nprobably set up second domain controller\ndown here on the corporate network,\n\n435\n00:25:15.475 --> 00:25:19.885\nas well, just to make sure we're teaching\nyou and showing you best practices.\n\n436\n00:25:19.885 --> 00:25:24.165\nThere's no point in seeing me do that part\ncuz it's just gonna be a duplicate of what\n\n437\n00:25:24.165 --> 00:25:28.085\nwe did in the first episode and what we've\njust accomplished in these two episodes.\n\n438\n00:25:28.085 --> 00:25:31.475\nSo I'll get that done in the background\nand then when we get back and\n\n439\n00:25:31.475 --> 00:25:36.330\nwe start rolling our next episodes out,\nwe'll start taking a look at replication.\n\n440\n00:25:36.330 --> 00:25:40.070\nMaking a user account,\nmaking sure it replicates up there and\n\n441\n00:25:40.070 --> 00:25:43.960\ndoing some other fun things with\nActive Directory in the cloud.\n\n442\n00:25:43.960 --> 00:25:45.780\n>> Wow, we've definitely come a log way.\n\n443\n00:25:45.780 --> 00:25:49.410\nWe started with absolutely nothing,\nbuilt an environment on premises.\n\n444\n00:25:49.410 --> 00:25:52.080\nNow we've connected to\nan environment in Azure.\n\n445\n00:25:52.080 --> 00:25:52.990\nEverything's replicating.\n\n446\n00:25:52.990 --> 00:25:58.370\nWe could use it as a DR if we wanted to,\nor if we just needed somewhere\n\n447\n00:25:58.370 --> 00:26:01.490\nout in the cloud to have our Active\nDirectory, it's there waiting for us.\n\n448\n00:26:01.490 --> 00:26:03.380\nAnd data is replicating.\n\n449\n00:26:03.380 --> 00:26:06.100\nMike, I didn't think it was gonna happen,\nbut it did.\n\n450\n00:26:06.100 --> 00:26:09.420\nYou trudged through each one of\nthe obstacles that was put before you,\n\n451\n00:26:09.420 --> 00:26:10.000\nand did with style.\n\n452\n00:26:10.000 --> 00:26:11.300\nWe appreciate you showing up.\n\n453\n00:26:11.300 --> 00:26:11.830\n>> Any time.\n\n454\n00:26:11.830 --> 00:26:14.640\n>> We're looking forward to\nthe next upcoming episodes,\n\n455\n00:26:14.640 --> 00:26:16.060\nlook forward to seeing you there as well.\n\n456\n00:26:16.060 --> 00:26:19.230\nSigning off for ITProTV,\nI'm your host Daniel Lowrie.\n\n457\n00:26:19.230 --> 00:26:20.010\n>> And I'm Mike Rodrick.\n\n458\n00:26:20.010 --> 00:26:24.367\n>> We'll see you next time.\n\n459\n00:26:24.367 --> 00:26:30.030\n[MUSIC]\n\n",
          "vimeoId": "155121662"
        },
        {
          "description": "In this episode, Daniel and Mike add a second domain controller in Azure to add to the availability set which helps with fault tolerance and load balancing. They also show you how to fix an improperly registered DNS server in Azure.",
          "length": "2245",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-4-completing_an_availability_set-021216-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-4-completing_an_availability_set-021216-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-4-completing_an_availability_set-021216-1-sm.jpg",
          "title": "Completing an Availability Set",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.139 --> 00:00:16.601\nAll right greetings everyone and welcome\nto another great episode of ITPROTV.\n\n3\n00:00:16.601 --> 00:00:21.530\nI'm your host Daniel Lowrie and in today's\nepisode where we are continuing on with\n\n4\n00:00:21.530 --> 00:00:24.330\nour Active Directory in Azure's series,\nand\n\n5\n00:00:24.330 --> 00:00:28.510\nto further that effort we brought along\nour good friends Mr. Mike Rodrick.\n\n6\n00:00:28.510 --> 00:00:30.580\nWelcome back to the show Mike\nhow you doing today sir?\n\n7\n00:00:30.580 --> 00:00:32.750\n>> Doing great Daniel, thank's for\nhaving me back and you're right,\n\n8\n00:00:32.750 --> 00:00:36.990\nwe're continuing on with our efforts to\nextend Active Directory out in the cloud,\n\n9\n00:00:36.990 --> 00:00:38.870\nwhich we've really come a long way right?\n\n10\n00:00:38.870 --> 00:00:40.950\nWe started with our local network,\n\n11\n00:00:40.950 --> 00:00:43.610\nour what we would call\nour on premises network.\n\n12\n00:00:43.610 --> 00:00:46.750\nWe got that set up,\nwe got internet access established for\n\n13\n00:00:46.750 --> 00:00:50.150\nour on-premises network,\nthen we went out to Azure.\n\n14\n00:00:50.150 --> 00:00:53.480\nWe created our virtual network,\nwe created our virtual machine,\n\n15\n00:00:53.480 --> 00:00:55.830\nwe installed active directory on there.\n\n16\n00:00:55.830 --> 00:00:59.380\nAnd in between there,\nwe set up that site to site VPN, right, so\n\n17\n00:00:59.380 --> 00:01:03.290\nthat our corporate network here,\nour on-premises Has that VPN tunnel.\n\n18\n00:01:03.290 --> 00:01:08.270\nThat IKEV2 tunnel going out there to\nAzure, but one of the couple things\n\n19\n00:01:08.270 --> 00:01:11.750\nthat we did as we went through that\nsetup that we want to go back and\n\n20\n00:01:11.750 --> 00:01:13.290\ntake a look at again.\n\n21\n00:01:13.290 --> 00:01:16.380\nFirst one is going to be\nthe availability set.\n\n22\n00:01:16.380 --> 00:01:19.630\nYou'll remember we talked about\nwhat an availability set was.\n\n23\n00:01:19.630 --> 00:01:24.950\nWhen you create VMs out there in Azure,\nyou can create an availability set.\n\n24\n00:01:24.950 --> 00:01:26.650\nThat's more than one machine.\n\n25\n00:01:26.650 --> 00:01:30.990\nThat is part of the same availability set\nand what Microsoft will do is make sure\n\n26\n00:01:30.990 --> 00:01:34.260\nthat there is no single point\nof failure for those machines.\n\n27\n00:01:34.260 --> 00:01:36.370\nIn other words they are not\ngonna be on the same rack.\n\n28\n00:01:36.370 --> 00:01:39.700\nIf there is a network switch that fails,\nif a power supply for\n\n29\n00:01:39.700 --> 00:01:44.280\none of the racks fail or something like\nthat you are not gonna lose both machines.\n\n30\n00:01:44.280 --> 00:01:48.880\nWell we created one when we created our\nfirst VM then you'll remember after that\n\n31\n00:01:48.880 --> 00:01:52.330\nit warned us, it said hey you\ncreated a availability set, but\n\n32\n00:01:52.330 --> 00:01:57.260\nyou only have one machine in there, so\nits not really giving that level of\n\n33\n00:01:57.260 --> 00:02:00.900\navailability that you might think you\nhave which is It kind makes sense, right?\n\n34\n00:02:00.900 --> 00:02:04.930\nOne machine, it can't really do anything\nabout any single points of failure.\n\n35\n00:02:04.930 --> 00:02:08.120\nSo we need to go back and\nadd a second domain controller.\n\n36\n00:02:08.120 --> 00:02:10.030\nEven if it wasn't for\nthe availability set,\n\n37\n00:02:10.030 --> 00:02:12.410\nthat's still going to be a best practice,\nright?\n\n38\n00:02:12.410 --> 00:02:15.820\nWhen we learn about active directory\nin some of our other server classes,\n\n39\n00:02:15.820 --> 00:02:18.240\nwe always talk about redundancy, and\n\n40\n00:02:18.240 --> 00:02:23.470\nfull tolerance and we'll say minimum,\n2 domain controllers per domain.\n\n41\n00:02:23.470 --> 00:02:27.290\nAnd really what you want is two\ndomain controllers per site,\n\n42\n00:02:27.290 --> 00:02:28.570\nper physical location.\n\n43\n00:02:28.570 --> 00:02:31.370\nThat way if one of them goes down,\nyou still have another.\n\n44\n00:02:31.370 --> 00:02:36.670\nPeople can log on, access resources, get\nthose service tickets, whatever they need.\n\n45\n00:02:36.670 --> 00:02:41.600\nWell, my Azure network is another site,\nbasically, so\n\n46\n00:02:41.600 --> 00:02:43.580\nI really want two domain\ncontrollers there.\n\n47\n00:02:43.580 --> 00:02:47.240\nIt's also given me that kind of\na disaster recovery, if you will,\n\n48\n00:02:47.240 --> 00:02:52.130\nwhere if I lose my on premises\nnetwork I still have Azure out there.\n\n49\n00:02:52.130 --> 00:02:53.900\nWell if there's only\none domain controller,\n\n50\n00:02:53.900 --> 00:02:59.070\nI lose my site here, now I'm down to one\ndomain controller on my entire domain,\n\n51\n00:02:59.070 --> 00:03:00.230\nthat's not going to be a good thing,\nright?\n\n52\n00:03:00.230 --> 00:03:02.920\nThat's just asking for more disaster.\n\n53\n00:03:02.920 --> 00:03:07.020\nSo really there's a few reason we want\nto put more than one domain controller\n\n54\n00:03:07.020 --> 00:03:10.930\nout there in Azure,\nthe other would be simply load balancing.\n\n55\n00:03:10.930 --> 00:03:15.190\nThat's another thing that we get from the,\nnot so much from the availability set, but\n\n56\n00:03:15.190 --> 00:03:21.530\nfrom the cloud service that we\nuse to create these EMs as well.\n\n57\n00:03:21.530 --> 00:03:23.840\nSo that's the next thing we're\ngoing to do, is set that up.\n\n58\n00:03:23.840 --> 00:03:28.090\nSo if we take a look at my screen here,\nI'm logged back into the good old classic\n\n59\n00:03:28.090 --> 00:03:33.030\nAzure portal, and I'm gonna go up to my\nvirtual machines where we've got one.\n\n60\n00:03:33.030 --> 00:03:37.390\nAnd we've seen all of this so I'm gonna\nkinda go through it relatively quickly.\n\n61\n00:03:37.390 --> 00:03:40.100\nThere's just one screen\nI kinda wanna focus on.\n\n62\n00:03:40.100 --> 00:03:40.880\nI'm gonna click New.\n\n63\n00:03:42.250 --> 00:03:46.330\nAnd we're gonna go virtual\nmachine from gallery and\n\n64\n00:03:46.330 --> 00:03:50.670\nI'll chose my 2008 sorry\n2012 R2 Data center.\n\n65\n00:03:50.670 --> 00:03:52.990\nWe'll click on that next arrow\nthat's hidden down there.\n\n66\n00:03:54.240 --> 00:03:59.594\nMy release date, I'll give this\nmachine a name, this will be AZ-DC02.\n\n67\n00:03:59.594 --> 00:04:05.248\nWe're gonna do the same size for\nthe virtual machine use that same.\n\n68\n00:04:07.243 --> 00:04:11.376\nCan't spell my own name,\nset that nice strong password.\n\n69\n00:04:15.883 --> 00:04:20.350\nHopefully those match, and\nthen we'll go ahead and collect next.\n\n70\n00:04:20.350 --> 00:04:24.420\nAnd here's the string that I really\nwant us to focus on, because\n\n71\n00:04:24.420 --> 00:04:28.210\nwe talked about when we created the first\none that you can create one cloud service.\n\n72\n00:04:28.210 --> 00:04:32.670\nRemember the cloud service is\na container that stores my VM's.\n\n73\n00:04:32.670 --> 00:04:35.250\nI can create a cloud service for\na single machine.\n\n74\n00:04:35.250 --> 00:04:37.760\nOr you can load balance\nmultiple virtual machines,\n\n75\n00:04:37.760 --> 00:04:39.980\nplacing them in the same cloud service.\n\n76\n00:04:39.980 --> 00:04:44.510\nSo we could again use that one that\nwe already have, that I made for\n\n77\n00:04:44.510 --> 00:04:49.250\nAzure DCO1, or I can make a new\ncloud service for this VM.\n\n78\n00:04:49.250 --> 00:04:52.370\nBut the problem is if I\nchoose new cloud service,\n\n79\n00:04:52.370 --> 00:04:56.820\nif I come down here to availability set,\nI'm gonna get the option none or\n\n80\n00:04:56.820 --> 00:05:00.660\ncreate an availability set, and\nthat's not what I wanna do.\n\n81\n00:05:00.660 --> 00:05:05.060\nI want to put both of these demand\ngators in the same availability set.\n\n82\n00:05:05.060 --> 00:05:09.560\nSo in that case what I need to do is\nput it in the same cloud service.\n\n83\n00:05:09.560 --> 00:05:14.004\nSo in the point of the story is\nto create an availability set,\n\n84\n00:05:14.004 --> 00:05:17.120\nthey do need to be part of\nthe same cloud service.\n\n85\n00:05:17.120 --> 00:05:19.270\nSo we choose the existing\ncloud service there.\n\n86\n00:05:19.270 --> 00:05:21.340\nI've already got my subnet selected,\n\n87\n00:05:21.340 --> 00:05:25.420\nbecause that cloud service,\nFirst VM was on that Azure subnet.\n\n88\n00:05:25.420 --> 00:05:27.560\nYou see I can't change that.\n\n89\n00:05:27.560 --> 00:05:30.620\nI could change it to,\nI should say, a virtual network.\n\n90\n00:05:30.620 --> 00:05:34.650\nIf there was more than one subnet I could\nactually change it to a different subnet.\n\n91\n00:05:34.650 --> 00:05:38.370\nStorage account, I'm gonna use\nthe existing one, AD in Azure.\n\n92\n00:05:38.370 --> 00:05:40.540\nNow when I get to availability set,\n\n93\n00:05:40.540 --> 00:05:45.603\nnotice I have the existing\navailability set az-dcs.\n\n94\n00:05:45.603 --> 00:05:48.586\nNow I'll go ahead and select that.\n\n95\n00:05:50.817 --> 00:05:57.550\nAnd now we'll go ahead and click next And\nthe rest of this is no different.\n\n96\n00:05:57.550 --> 00:05:59.950\nI'll click Next on that,\nwe'll install that VM agent,\n\n97\n00:05:59.950 --> 00:06:03.560\nand that's gonna begin the process\nof provisioning that machine.\n\n98\n00:06:03.560 --> 00:06:06.610\nNow I still have to go through and\ndo everything we did to that first VM,\n\n99\n00:06:06.610 --> 00:06:09.370\nthat first domain control\nwe created in Azure.\n\n100\n00:06:09.370 --> 00:06:11.050\nI gotta add a blank disk.\n\n101\n00:06:11.050 --> 00:06:15.850\nI gotta log into that machine and\nI've got to format that disk,\n\n102\n00:06:15.850 --> 00:06:18.590\npartition it, format it, and\nthen we would go through and\n\n103\n00:06:18.590 --> 00:06:22.460\ninstall active directory,\nwhich we might do in this show.\n\n104\n00:06:22.460 --> 00:06:25.330\nWe might leave that for\nsomething in the background.\n\n105\n00:06:25.330 --> 00:06:29.200\nWe will wait and see how much time we\nhave since you have seen it before.\n\n106\n00:06:29.200 --> 00:06:31.610\nSo we'll go through that\nprovisioning process, and\n\n107\n00:06:31.610 --> 00:06:35.190\nwe'll have a second domain controller and\nthen our availability set will be happy.\n\n108\n00:06:35.190 --> 00:06:36.410\nYou know if we take a look at the,\n\n109\n00:06:36.410 --> 00:06:39.850\nthis machine this is the one we\nset up on the previous episode,\n\n110\n00:06:39.850 --> 00:06:43.080\nI still have that warning, the\navailability set for this virtual machine\n\n111\n00:06:43.080 --> 00:06:48.690\nonly has one running instance which\naffects the SLA requires at least two.\n\n112\n00:06:48.690 --> 00:06:54.970\nSo hopefully that will go away once we add\nthis second domain controller up there.\n\n113\n00:06:54.970 --> 00:06:56.380\nSo while we're waiting for that,\n\n114\n00:06:56.380 --> 00:07:00.830\ninstead of just sitting here watching\nthose progress bars like we love to do I\n\n115\n00:07:00.830 --> 00:07:03.150\nthought we'd go ahead, and\nclean up some of that DNS.\n\n116\n00:07:03.150 --> 00:07:09.430\nNow, we saw in previous episodes we\nregistered our DNS servers in Azure.\n\n117\n00:07:09.430 --> 00:07:13.820\nAnd we said that was because all these\nmachines on that Azure virtual network\n\n118\n00:07:13.820 --> 00:07:16.470\nAre getting their IP address via DHCP.\n\n119\n00:07:16.470 --> 00:07:19.840\nSo their TCP/IP config,\nIP address, subnet mass,\n\n120\n00:07:19.840 --> 00:07:23.090\ndefault gateway,\npreferred alternate DNS servers.\n\n121\n00:07:23.090 --> 00:07:27.460\nSo, we registered our DNS servers so that\nway it knows what DNS servers to pass out\n\n122\n00:07:27.460 --> 00:07:30.600\nto the virtual machines that\nI create out there in Azure.\n\n123\n00:07:30.600 --> 00:07:33.390\nNow the time that I did it I registered,\nin fact here,\n\n124\n00:07:33.390 --> 00:07:35.340\nlet's just go look and see what I did.\n\n125\n00:07:36.450 --> 00:07:42.200\nWe'll go down to Networks And\n\n126\n00:07:42.200 --> 00:07:45.090\nwe'll take a look at my Azure subnet.\n\n127\n00:07:47.968 --> 00:07:49.363\nAnd we'll go to configure.\n\n128\n00:07:50.893 --> 00:07:53.450\nI should be able to see the DNN\nservers that I've registered for.\n\n129\n00:07:53.450 --> 00:07:57.936\nThe subnet, and I used the IP address\n10.1.2.10 thinking that was gonna be\n\n130\n00:07:57.936 --> 00:08:00.793\nthe first address available\non the subnet I created.\n\n131\n00:08:00.793 --> 00:08:04.124\nUp there in Azure,\nturned out it as 10.1.2.4.\n\n132\n00:08:04.124 --> 00:08:06.291\nSo this is actually incorrect,\n\n133\n00:08:06.291 --> 00:08:11.600\nthere is no machine 10.1.2.10,\nso this isn't going to work.\n\n134\n00:08:11.600 --> 00:08:14.920\nAnd so I wanna fix that, and\nyou can't edit this, all right?\n\n135\n00:08:14.920 --> 00:08:17.920\nI can't go in, I don't think it'll\neven let me change the name.\n\n136\n00:08:17.920 --> 00:08:23.080\nIt might change the name but I don't want\nto, but I can't change this IP address.\n\n137\n00:08:23.080 --> 00:08:25.250\nYou know and\nnow it's actually letting me do it.\n\n138\n00:08:25.250 --> 00:08:30.260\nI will tell you that normally it won't\nlet me do it this way, and as soon\n\n139\n00:08:30.260 --> 00:08:33.920\nas I set it back to that name it changes\nit because it's got a record, right?\n\n140\n00:08:33.920 --> 00:08:37.750\nOf that name and\nthat IP address that's associated with it.\n\n141\n00:08:37.750 --> 00:08:42.050\nSo what I've got to do is actually\nremove that registration and\n\n142\n00:08:42.050 --> 00:08:46.180\nrecreate the registration\nwith the correct IP address.\n\n143\n00:08:46.180 --> 00:08:49.100\nAnd removing it is not\nas easy as it sounds.\n\n144\n00:08:49.100 --> 00:08:50.660\nIt depends.\n\n145\n00:08:50.660 --> 00:08:51.610\n>> Don't click delete.\n\n146\n00:08:51.610 --> 00:08:54.550\nI mean,\nthat's normally how you delete stuff.\n\n147\n00:08:54.550 --> 00:08:55.490\n>> You would think so.\n\n148\n00:08:55.490 --> 00:08:59.070\nWhat I see people doing more\noften than not is going here and\n\n149\n00:08:59.070 --> 00:09:03.330\nthen clicking on DNS server because this\nis where we registered the DNS server.\n\n150\n00:09:03.330 --> 00:09:04.390\nSo you go here.\n\n151\n00:09:04.390 --> 00:09:06.680\nYou see that Azure dc01.\n\n152\n00:09:06.680 --> 00:09:08.230\nAnd you click Delete.\n\n153\n00:09:08.230 --> 00:09:10.790\nAnd take a look at\nthe warning I get down here.\n\n154\n00:09:10.790 --> 00:09:15.190\nDNS server Azure dc01 is referenced\nby virtual network Azure subnet, and\n\n155\n00:09:15.190 --> 00:09:16.100\ncannot be removed.\n\n156\n00:09:16.100 --> 00:09:19.140\nAnd this is something you're\ngonna run into quite often\n\n157\n00:09:19.140 --> 00:09:22.600\nwhen you're doing any kind of\nreconfiguration up here in Azure.\n\n158\n00:09:22.600 --> 00:09:25.510\nBecause these resources have dependencies.\n\n159\n00:09:25.510 --> 00:09:27.580\nAnd you're nesting one inside the other.\n\n160\n00:09:27.580 --> 00:09:30.750\nThe cloud service contains\nthe virtual machine.\n\n161\n00:09:30.750 --> 00:09:32.420\nIt contains the network.\n\n162\n00:09:32.420 --> 00:09:36.560\nAnd so when you try to remove something,\nif there's anything dependent on it,\n\n163\n00:09:36.560 --> 00:09:37.740\nit's not gonna let you.\n\n164\n00:09:37.740 --> 00:09:41.070\nYou actually have to think\nabout the nesting and\n\n165\n00:09:41.070 --> 00:09:43.210\nthen remove it from the inside out, right?\n\n166\n00:09:43.210 --> 00:09:46.890\nYou gotta take the little piece out of the\ninside, then you can remove the next level\n\n167\n00:09:46.890 --> 00:09:49.950\nof the container, and then the next level,\nand so on and so forth.\n\n168\n00:09:49.950 --> 00:09:52.100\nIt's the old, what do you call,\nthose little-\n\n169\n00:09:52.100 --> 00:09:52.750\n>> Russian dolls.\n\n170\n00:09:52.750 --> 00:09:53.710\n>> Russian dolls, yeah.\n\n171\n00:09:53.710 --> 00:09:55.700\nRight, so\nthat's basically what we've gotta do.\n\n172\n00:09:55.700 --> 00:10:00.680\nSo I can't remove it here, because\nthe Azure subnet is still referencing it.\n\n173\n00:10:00.680 --> 00:10:04.540\n>> So then, would you just be\nable to add another one here, and\n\n174\n00:10:04.540 --> 00:10:06.030\njust start to point it that way?\n\n175\n00:10:06.030 --> 00:10:08.360\n>> I could, but the problem is the name.\n\n176\n00:10:08.360 --> 00:10:10.630\nRight.\nI can't use that name again.\n\n177\n00:10:10.630 --> 00:10:14.290\nMy problem that I have is that I've got\nthe right name in the wrong IP address.\n\n178\n00:10:14.290 --> 00:10:17.010\nSo, if I try to register\nas your dc01 again,\n\n179\n00:10:17.010 --> 00:10:19.330\nit's going to say that\nname is already in use.\n\n180\n00:10:19.330 --> 00:10:24.530\nLike we can say new Network,\nRegister DNS Server.\n\n181\n00:10:24.530 --> 00:10:28.773\nI'm gonna come up here and\nsay az-dc01, and\n\n182\n00:10:28.773 --> 00:10:33.670\nyou get that immediate warning\nthere the name is already in use.\n\n183\n00:10:33.670 --> 00:10:37.590\nSo I really do have to remove\nit first before I can go back.\n\n184\n00:10:37.590 --> 00:10:38.710\nNow I can register others.\n\n185\n00:10:38.710 --> 00:10:42.110\nAnd you can register up to,\nwant to say it's 20.\n\n186\n00:10:42.110 --> 00:10:43.770\nI'll have to verify that number, but\n\n187\n00:10:43.770 --> 00:10:46.470\nyou can register up to 20 DNS\nservers up here in Azure,\n\n188\n00:10:46.470 --> 00:10:49.990\nif you need more than that you can\nactually talk to Microsoft and get more.\n\n189\n00:10:49.990 --> 00:10:54.070\nAnd what it does it it does\nrapid round robining when your\n\n190\n00:10:54.070 --> 00:10:57.930\nclient needs a DNS server it\nresponds with round robining.\n\n191\n00:10:57.930 --> 00:11:03.800\nSo what we're going to do is go to\nthe network itself, Azure subnet.\n\n192\n00:11:03.800 --> 00:11:08.740\nBecause this is really what's\nreferencing that registration, so\n\n193\n00:11:08.740 --> 00:11:13.680\nI go to configure here, and\nI'm just gonna remove that record.\n\n194\n00:11:14.760 --> 00:11:17.880\nNow do be careful here because\nyou remove and you say OK and\n\n195\n00:11:17.880 --> 00:11:23.480\nyou click back and you'll see it does try\nto warn you unsaved changes will be lost.\n\n196\n00:11:23.480 --> 00:11:27.000\nYou need to save your changes that\nyou've made to the configuration.\n\n197\n00:11:27.000 --> 00:11:27.740\nNow, it's gonna warn me.\n\n198\n00:11:27.740 --> 00:11:30.620\nChange in the configuring\nof a network that is in use\n\n199\n00:11:30.620 --> 00:11:34.380\nwill briefly disrupt the connection\nbetween virtual network and local network.\n\n200\n00:11:34.380 --> 00:11:35.350\nAre you sure you want to continue?\n\n201\n00:11:35.350 --> 00:11:38.270\nWell, I'm just removing\na DNS server IP address, so\n\n202\n00:11:38.270 --> 00:11:41.240\nit's really not going to cause\nany connectivity issues.\n\n203\n00:11:41.240 --> 00:11:44.870\nThey got that IP address when they\ngot there their TCP IP information.\n\n204\n00:11:44.870 --> 00:11:46.420\nSo we're good to go there,\nI'll go ahead and\n\n205\n00:11:46.420 --> 00:11:48.990\nclick Yes, but\nit is something that you want to consider.\n\n206\n00:11:48.990 --> 00:11:52.390\nIf this is a production environment,\nyou've got users relying on these\n\n207\n00:11:52.390 --> 00:11:56.750\nresources, you start making changes up\nhere, you can affect their connectivity.\n\n208\n00:11:56.750 --> 00:12:00.930\nAnd it can take a few minutes for\nthose changes to kind of kick in in Azure.\n\n209\n00:12:00.930 --> 00:12:04.550\nSo you've gotta think\nabout what you're doing.\n\n210\n00:12:04.550 --> 00:12:05.950\nSo I'm gonna get rid of that message.\n\n211\n00:12:05.950 --> 00:12:08.530\nSo there I can see it's\nupdating the virtual network,\n\n212\n00:12:08.530 --> 00:12:09.970\nwe'll give it just a minute.\n\n213\n00:12:09.970 --> 00:12:12.820\nThis is my warning from the effect that\nI couldn't remove it, I'll go ahead and\n\n214\n00:12:12.820 --> 00:12:13.830\nclear that out as well.\n\n215\n00:12:13.830 --> 00:12:17.740\nSo it's going through the process\nof updating my virtual network.\n\n216\n00:12:18.960 --> 00:12:21.430\nShouldn't take it too terribly long.\n\n217\n00:12:21.430 --> 00:12:26.140\nAnd once that is removed,\nnow that name will be free, and\n\n218\n00:12:26.140 --> 00:12:29.940\nI can register it with\nthe correct IP address.\n\n219\n00:12:29.940 --> 00:12:32.230\nSo there we go,\nsuccessfully updated my network.\n\n220\n00:12:32.230 --> 00:12:33.040\nWe can click OK.\n\n221\n00:12:33.040 --> 00:12:37.650\nNow you'll see here,\nit actually still shows it.\n\n222\n00:12:37.650 --> 00:12:38.600\nYeah, it's got the wrong address.\n\n223\n00:12:38.600 --> 00:12:39.170\nI don't wanna do that.\n\n224\n00:12:39.170 --> 00:12:42.650\nLet's go away with that.\n\n225\n00:12:42.650 --> 00:12:43.840\nDiscard my changes there.\n\n226\n00:12:43.840 --> 00:12:46.690\nI was gonna see if it would\nactually clear that list out.\n\n227\n00:12:46.690 --> 00:12:47.710\nIt did not.\n\n228\n00:12:47.710 --> 00:12:51.814\nAnd that's because I haven't move\nthe removed the actual registration yet.\n\n229\n00:12:51.814 --> 00:12:54.580\nYou gotta remember we\ngonna do all the steps.\n\n230\n00:12:54.580 --> 00:12:56.852\nIt's easy to forget, and\njust like I did and I did.\n\n231\n00:12:56.852 --> 00:12:59.570\nSay, okay, we removed it,\nlet's go and have a back.\n\n232\n00:12:59.570 --> 00:13:03.790\nI did remove all traces of it from\nAzure so it still knows about it.\n\n233\n00:13:03.790 --> 00:13:08.220\nSo once you removed the reference\nto that DNS server from the subnet.\n\n234\n00:13:09.270 --> 00:13:14.200\nNow I should be able to go back out\nto Networks, and then DNS servers,\n\n235\n00:13:14.200 --> 00:13:18.770\nselect the one that I wanna get rid of,\nand choose Delete.\n\n236\n00:13:18.770 --> 00:13:20.820\nAnd it's gonna tell me are you\nsure you wanna remove it?\n\n237\n00:13:20.820 --> 00:13:22.300\nAnd I'll say yes.\n\n238\n00:13:22.300 --> 00:13:25.170\nAnd then it should have\nwarned me here in a second.\n\n239\n00:13:25.170 --> 00:13:30.520\nOne thing that you wanna consider\nis that just like with DHCP on\n\n240\n00:13:30.520 --> 00:13:35.610\npremises, your client calls out, gets that\ninformation, and then he gets a lease.\n\n241\n00:13:35.610 --> 00:13:37.880\nAnd it's good for\nhowever long that lease is.\n\n242\n00:13:37.880 --> 00:13:40.480\nYou go make changes on your DHCP server,\n\n243\n00:13:40.480 --> 00:13:43.480\nclients are not immediately\ninformed of those changes.\n\n244\n00:13:43.480 --> 00:13:45.820\nNot until they release and\nrenew their lease.\n\n245\n00:13:45.820 --> 00:13:47.830\nThat's when they'll pick\nthat information up.\n\n246\n00:13:47.830 --> 00:13:51.220\nSo it'll tell you in here,\nremember, this isn't the same DHCP.\n\n247\n00:13:51.220 --> 00:13:56.160\nThey get it dynamically, but\nthen they get like a 135 year lease.\n\n248\n00:13:56.160 --> 00:13:56.740\nAs, so\n\n249\n00:13:56.740 --> 00:14:00.555\nit's guaranteed to last probably longer\nthan your virtual machine will last.\n\n250\n00:14:00.555 --> 00:14:03.085\nSo they're never [CROSSTALK]\n>> Definitely longer than your tenure in\n\n251\n00:14:03.085 --> 00:14:04.220\nwhatever job you're in.\n\n252\n00:14:04.220 --> 00:14:05.580\n[LAUGH]\n>> [LAUGH] Yeah, right?\n\n253\n00:14:05.580 --> 00:14:10.000\nSo, your machine's never gonna get that\nnew information, unless you reboot the VM.\n\n254\n00:14:10.000 --> 00:14:11.954\nSo, you make changes like this.\n\n255\n00:14:11.954 --> 00:14:15.160\nOne of the thing that you wanna remember\nto do is to reboot all of your VMs that\n\n256\n00:14:15.160 --> 00:14:18.250\nare depending on that so\nthey'll pick up that change.\n\n257\n00:14:18.250 --> 00:14:22.637\nSo it looks like that finished up,\nsuccessfully removed DNS server DCL1.\n\n258\n00:14:22.637 --> 00:14:26.617\nNow if I go back into\nmy virtual network and\n\n259\n00:14:26.617 --> 00:14:33.350\nI hit my little drop-down list for\nDNS, we'll go over to Configure.\n\n260\n00:14:33.350 --> 00:14:36.200\nAnd you'll see there is no drop-down\n\n261\n00:14:36.200 --> 00:14:38.440\nlist because there is no\nother registered service.\n\n262\n00:14:38.440 --> 00:14:45.320\nSo now we're free and clear to go ahead\nand recreate or create a new registration.\n\n263\n00:14:45.320 --> 00:14:51.656\nWe'll say new, network service,\nvirtual network, registered DNS server.\n\n264\n00:14:51.656 --> 00:14:55.870\naz-dc0, if you click in the box and\n\n265\n00:14:55.870 --> 00:15:00.610\nmake it active first, az-dc01,\n\n266\n00:15:00.610 --> 00:15:05.520\nand my IP address for\nthat one is 10.1.2.4.\n\n267\n00:15:05.520 --> 00:15:07.553\nRegister DNS server.\n\n268\n00:15:10.351 --> 00:15:14.880\nAnd then once that is done,\nI can go back over to my virtual network.\n\n269\n00:15:14.880 --> 00:15:18.720\nAnd this is again another\npart that is easy to forget,\n\n270\n00:15:18.720 --> 00:15:20.470\nyou think I registered it, I'm good to go.\n\n271\n00:15:20.470 --> 00:15:25.850\nYou still have to go tell the virtual\nnetwork that it's using that registration.\n\n272\n00:15:25.850 --> 00:15:31.412\nSo we'll go back to configure,\nhit our drop-down list,\n\n273\n00:15:31.412 --> 00:15:35.500\nAzure DCO1, and now I've got\nthe right IP address 10.1.2.4.\n\n274\n00:15:35.500 --> 00:15:36.770\nMake sure you click Save.\n\n275\n00:15:38.230 --> 00:15:39.460\nAnd this is where it's warning me.\n\n276\n00:15:39.460 --> 00:15:44.169\nChanging the configuration of a network\nthat's in use will briefly disrupt,\n\n277\n00:15:44.169 --> 00:15:46.176\nare you sure you wanna continue?\n\n278\n00:15:46.176 --> 00:15:50.025\nAnd then below, if you change DNS servers\nwhile the virtual network is in use,\n\n279\n00:15:50.025 --> 00:15:53.369\nyou have to restart the virtual\nmachines to reset the DNS settings.\n\n280\n00:15:53.369 --> 00:15:55.298\nWe'll say Yes to those messages.\n\n281\n00:15:55.298 --> 00:15:59.017\nAnd I'll let this run through its process.\n\n282\n00:15:59.017 --> 00:16:05.606\nSave those changes that we've made,\nand then we'll check on our machine.\n\n283\n00:16:05.606 --> 00:16:11.110\nSo let that run, and\nwhat else were we working on?\n\n284\n00:16:11.110 --> 00:16:13.270\nYeah, we got our RVM\nprovisioning somewhere.\n\n285\n00:16:13.270 --> 00:16:17.750\nI haven't seen that finished message, but-\n>> I'd be surprised if it wasn't, though.\n\n286\n00:16:17.750 --> 00:16:19.700\n>> I know, I think I just\nmight have cleared it out and\n\n287\n00:16:19.700 --> 00:16:21.400\nnot have paid attention to it.\n\n288\n00:16:21.400 --> 00:16:23.472\nI'm Jimminy Click It over here,\nI'm just like click click click.\n\n289\n00:16:23.472 --> 00:16:25.400\n>> [LAUGH]\n>> [LAUGH]\n\n290\n00:16:25.400 --> 00:16:26.570\n>> Mike sees an x and\n\n291\n00:16:26.570 --> 00:16:28.450\nhe wants to click it.\n\n292\n00:16:28.450 --> 00:16:32.660\n>> Sure enough,\nas your DC02 is up and running.\n\n293\n00:16:32.660 --> 00:16:34.750\nAll right, so let's take a look.\n\n294\n00:16:34.750 --> 00:16:35.890\nMy subject's updated.\n\n295\n00:16:35.890 --> 00:16:38.800\nAnd just for giggles,\nsee what we've got here.\n\n296\n00:16:38.800 --> 00:16:43.660\nGo to dc01 and let's connect to this guy.\n\n297\n00:16:43.660 --> 00:16:50.205\nGo ahead and retrieve that file, just\nsay open instead of saving it this time.\n\n298\n00:16:50.205 --> 00:16:51.500\nYou guys saw how to save it.\n\n299\n00:16:53.150 --> 00:16:57.360\nI'll authenticate with my\nsuper secret password.\n\n300\n00:16:59.560 --> 00:17:03.957\nIf you haven't figured out,\nmy password is S-U-P-E-R-S-E-C-R-E-T.\n\n301\n00:17:03.957 --> 00:17:05.604\n>> [LAUGH]\n>> P-A-S-S, no just kidding.\n\n302\n00:17:05.604 --> 00:17:09.315\n>> That would actually be\na good password if it wasn't so\n\n303\n00:17:09.315 --> 00:17:10.085\nblatant,\n\n304\n00:17:10.085 --> 00:17:10.610\n>> [LAUGH]\n\n305\n00:17:10.610 --> 00:17:11.517\n>> [LAUGH]\n>> Good length.\n\n306\n00:17:11.517 --> 00:17:12.972\nIf I just didn't spill it out on\n\n307\n00:17:12.972 --> 00:17:16.280\nthe Internet here.\nAll right, so there we go.\n\n308\n00:17:16.280 --> 00:17:16.960\nWe get logged in.\n\n309\n00:17:16.960 --> 00:17:19.300\nSo I'm logged in to dc01, and\n\n310\n00:17:19.300 --> 00:17:22.810\nwhat I wanted to do is just do a real\nquick IP config and see what we have.\n\n311\n00:17:22.810 --> 00:17:24.930\nRemember, this guy has not been rebooted,\nand\n\n312\n00:17:24.930 --> 00:17:30.570\nwe made changes to our DNS\nsettings on our virtual network.\n\n313\n00:17:30.570 --> 00:17:32.760\nSo let's see what kind of goodness we get.\n\n314\n00:17:34.630 --> 00:17:38.980\nWe'll bump this font up just a hair, make\nit a little bit easier for my old eyes to\n\n315\n00:17:38.980 --> 00:17:43.850\nread it, and\nwe'll do a little ipconfig /all.\n\n316\n00:17:43.850 --> 00:17:49.528\nAnd DNS servers, I've got 10.1.1.10 and\n10.1.2.10, right.\n\n317\n00:17:49.528 --> 00:17:50.440\nThat's not correct.\n\n318\n00:17:50.440 --> 00:17:52.980\nThat's the one that we\nregistered initially.\n\n319\n00:17:52.980 --> 00:17:55.220\nIt's not the new one, 10.1.2.4.\n\n320\n00:17:55.220 --> 00:17:58.737\nSo we are going to restart this guy.\n\n321\n00:18:01.106 --> 00:18:07.340\nOf course I'll lose my remote\ndesktop connection as that restarts.\n\n322\n00:18:07.340 --> 00:18:09.140\nWhile it's restarting let's check on dc2.\n\n323\n00:18:09.140 --> 00:18:13.150\nNow it really depends on when\nthis guy finished provisioning.\n\n324\n00:18:13.150 --> 00:18:15.590\nIf it finished provisioning\nbefore I made those changes,\n\n325\n00:18:15.590 --> 00:18:17.490\nit's probably got the wrong ENS server.\n\n326\n00:18:17.490 --> 00:18:20.960\nIf it finished provisioning after,\nit might have the right one.\n\n327\n00:18:20.960 --> 00:18:22.240\nWe'll see.\n\n328\n00:18:22.240 --> 00:18:23.880\nWe'll open that guy up.\n\n329\n00:18:23.880 --> 00:18:24.611\nAuthenticate.\n\n330\n00:18:26.701 --> 00:18:27.990\nOops, he's not part of the domain yet.\n\n331\n00:18:27.990 --> 00:18:29.510\nSilly me.\n\n332\n00:18:29.510 --> 00:18:33.920\nSo let's just do Backslash administrator.\n\n333\n00:18:33.920 --> 00:18:36.130\n>> I was just thinking Mike,\nthat, I was like wow,\n\n334\n00:18:36.130 --> 00:18:39.480\nwhy didn't you just do\nan ipconfig release and redo it?\n\n335\n00:18:39.480 --> 00:18:43.950\nIf you're remoted into a machine and\nyou do an ipconfig release,\n\n336\n00:18:43.950 --> 00:18:47.280\nyou lose your internet connectivity,\nor your connectivity to that machine.\n\n337\n00:18:47.280 --> 00:18:51.284\nYou're not going to be able to get back\nin there unless you can physically access\n\n338\n00:18:51.284 --> 00:18:51.954\nit, right?\n\n339\n00:18:51.954 --> 00:18:55.929\nIt's a good idea to restart a machine\nwhen it comes to something like that.\n\n340\n00:18:55.929 --> 00:18:56.910\n>> [LAUGH] Absolutely.\n\n341\n00:18:56.910 --> 00:18:59.820\nI'm going to go ahead and\nmove away some of these warnings there,\n\n342\n00:18:59.820 --> 00:19:00.620\nas we'll get onto dc.\n\n343\n00:19:00.620 --> 00:19:04.550\nDid I log into the wrong one?\n\n344\n00:19:04.550 --> 00:19:06.230\nI think so.\nNow it shows dc01 again.\n\n345\n00:19:06.230 --> 00:19:07.227\nWell.\n[CROSSTALK] We need to check\n\n346\n00:19:07.227 --> 00:19:07.770\nthat one anyway.\n\n347\n00:19:07.770 --> 00:19:11.236\n>> [LAUGH]\n>> [LAUGH]\n\n348\n00:19:12.340 --> 00:19:13.268\n>> Although it looks like,\n\n349\n00:19:13.268 --> 00:19:14.110\nwhy's it say dc01?\n\n350\n00:19:15.130 --> 00:19:17.300\nThis looks like the first\ntime I'm logging into it.\n\n351\n00:19:17.300 --> 00:19:19.260\n>> It does look like the first\ntime you're logging into it.\n\n352\n00:19:19.260 --> 00:19:22.340\n>> And I was on DC02, so somewhere\ntheir little name has gotten stuck.\n\n353\n00:19:22.340 --> 00:19:23.610\nBut that's all right.\n\n354\n00:19:23.610 --> 00:19:24.290\nWe'll figure it out.\n\n355\n00:19:26.380 --> 00:19:28.540\nWe'll have server manager come up and\nsee what we've got.\n\n356\n00:19:28.540 --> 00:19:30.660\nSo this is my brand new machine.\n\n357\n00:19:30.660 --> 00:19:32.700\n>> I don't know why that\ntitle bar up there says dc01.\n\n358\n00:19:32.700 --> 00:19:33.620\nThat's okay.\n\n359\n00:19:33.620 --> 00:19:35.005\n>> It's hopelessly confused.\n\n360\n00:19:35.005 --> 00:19:35.810\n[LAUGH]\n>> You know what?\n\n361\n00:19:35.810 --> 00:19:38.470\nThat's the cloud service.\n\n362\n00:19:38.470 --> 00:19:40.660\nThat's the name of the cloud service-\n>> It's called dc01.\n\n363\n00:19:40.660 --> 00:19:41.898\n>> That I'm actually remoting into.\n\n364\n00:19:41.898 --> 00:19:44.710\nYup, exactly,\nbecause when I made that cloud service,\n\n365\n00:19:44.710 --> 00:19:47.530\nI wasn't thinking about adding a second\nmachine to that availability set.\n\n366\n00:19:47.530 --> 00:19:49.837\nI would have used a slightly\ndifferent naming convention,\n\n367\n00:19:49.837 --> 00:19:51.413\nhad I thought about where we were going.\n\n368\n00:19:51.413 --> 00:19:53.480\n>> It could be confusing.\n\n369\n00:19:53.480 --> 00:19:54.250\n>> It can.\n[LAUGH] Definitely.\n\n370\n00:19:54.250 --> 00:19:57.230\n>> So you really do have to think\nahead in your planning stage.\n\n371\n00:19:57.230 --> 00:20:01.530\nYou think something as simple as a name\nwould be, yeah, I'll call it dc01.\n\n372\n00:20:01.530 --> 00:20:04.370\nBut later down the road,\nyou didn't think about, maybe I'll\n\n373\n00:20:04.370 --> 00:20:09.060\nadd another server to that availability\nset, and now it's called dc01.\n\n374\n00:20:09.060 --> 00:20:10.930\nEverything in there is dc01.\n\n375\n00:20:10.930 --> 00:20:13.550\nYou start seeing it, and\nit starts confusing you.\n\n376\n00:20:13.550 --> 00:20:15.530\nSo try to keep that in mind as you do.\n\n377\n00:20:15.530 --> 00:20:17.620\nSo naming conventions do matter.\n\n378\n00:20:17.620 --> 00:20:20.140\nIt's not just a simple\nlabel a lot of times.\n\n379\n00:20:20.140 --> 00:20:21.174\n>> Yeah very, very true.\n\n380\n00:20:21.174 --> 00:20:25.660\nAnd especially Microsoft kind of leads you\ndown the wrong road almost, because it\n\n381\n00:20:25.660 --> 00:20:29.110\nstarts filling in some of those fields\nusing the name of the VM you just created.\n\n382\n00:20:29.110 --> 00:20:31.320\nAnd so you think, that's a good idea.\n\n383\n00:20:31.320 --> 00:20:32.650\nI'm just going to do that.\n\n384\n00:20:32.650 --> 00:20:34.550\nAnd no probably not.\n\n385\n00:20:34.550 --> 00:20:35.260\nProbably not.\n\n386\n00:20:35.260 --> 00:20:38.600\nOkay, so there I see that it actually did\nprovision before I made the change, so\n\n387\n00:20:38.600 --> 00:20:40.140\nit's got the wrong one as well.\n\n388\n00:20:40.140 --> 00:20:41.580\nSo you know what we're going to do.\n\n389\n00:20:42.950 --> 00:20:45.439\nWe're going to restart this one also.\n\n390\n00:20:49.336 --> 00:20:50.130\nLet that go away.\n\n391\n00:20:50.130 --> 00:20:52.600\nYeah, yeah, you're going to\ngo away on your own anyway.\n\n392\n00:20:52.600 --> 00:20:56.481\nAnd that'll flip back over to dc01,\nwhich should have rebooted by now.\n\n393\n00:20:59.190 --> 00:21:00.186\nWait for it.\n\n394\n00:21:01.791 --> 00:21:03.550\nWait for it.\n\n395\n00:21:03.550 --> 00:21:08.000\nThere we go.\nWe'll connect dc01, and\n\n396\n00:21:08.000 --> 00:21:11.309\nthis one is the domain so\n\n397\n00:21:11.309 --> 00:21:15.950\nITproTVdemo/administrator.\n\n398\n00:21:19.652 --> 00:21:22.720\nOne two three four, one two three four,\none two three four.\n\n399\n00:21:22.720 --> 00:21:24.472\nDid I just say that out loud?\n\n400\n00:21:24.472 --> 00:21:26.009\n>> [LAUGH]\n>> [LAUGH\n\n401\n00:21:26.009 --> 00:21:30.808\n>> I have used the old qwer several times,\n\n402\n00:21:30.808 --> 00:21:31.976\nor asdf.\n\n403\n00:21:31.976 --> 00:21:35.505\nasdfasdfasdf1.\n\n404\n00:21:35.505 --> 00:21:38.872\nLong enough, has a number in there.\n\n405\n00:21:38.872 --> 00:21:39.754\n>> Complex enough.\n\n406\n00:21:39.754 --> 00:21:41.380\nMeet all the requirements with that one.\n\n407\n00:21:41.380 --> 00:21:42.016\n>> Yeah.\n\n408\n00:21:42.016 --> 00:21:45.392\nJust teasing, guys and gals.\n\n409\n00:21:45.392 --> 00:21:47.280\nDon't do that.\n\n410\n00:21:47.280 --> 00:21:50.320\nipconfig /all, and\n\n411\n00:21:50.320 --> 00:21:55.570\nI still have the wrong darn DNS\nserver IP address listed there.\n\n412\n00:21:55.570 --> 00:21:56.440\nSo that's not good.\n\n413\n00:21:56.440 --> 00:22:00.020\nWe'll have to try to figure out\nwhat is going on with that.\n\n414\n00:22:00.020 --> 00:22:03.030\nSo, what I would do for trouble shooting,\nI'm just going to disconnect.\n\n415\n00:22:03.030 --> 00:22:06.950\nWell, before I disconnect,\nlet's see what else I can do.\n\n416\n00:22:06.950 --> 00:22:08.940\nLet's go look at local server.\n\n417\n00:22:08.940 --> 00:22:13.010\n>> Is that's maybe something that's\ncoming in from the DHCP reservation?\n\n418\n00:22:13.010 --> 00:22:15.950\n>> You know,\nI might not have given it long enough, and\n\n419\n00:22:15.950 --> 00:22:17.380\nthat's probably the thing.\n\n420\n00:22:17.380 --> 00:22:21.040\nYou know, I created that new reservation,\nor not reservation, but\n\n421\n00:22:21.040 --> 00:22:26.310\nthat new DNS registration, and I might\nnot have waited long enough to reboot.\n\n422\n00:22:26.310 --> 00:22:28.525\nWell we have a good test\nwould be to check dc2,\n\n423\n00:22:28.525 --> 00:22:31.400\nbecause I did wait a little\nbit longer on him.\n\n424\n00:22:32.410 --> 00:22:34.580\nSo I will check that guy and\nsee what we got,\n\n425\n00:22:34.580 --> 00:22:38.450\nand then it's a matter of going back and\ntroubleshooting my registration.\n\n426\n00:22:38.450 --> 00:22:39.590\nMake sure that I did that correctly.\n\n427\n00:22:39.590 --> 00:22:41.760\nMake sure that it is still showing up.\n\n428\n00:22:43.380 --> 00:22:45.210\nLet's see we got for this machine.\n\n429\n00:22:45.210 --> 00:22:48.300\nSo this guy is dc2,\nwho is not part of the domain yet.\n\n430\n00:22:48.300 --> 00:22:51.580\nSo you've got to use the account that\nyou set up when you created the VM.\n\n431\n00:22:53.320 --> 00:22:54.630\nWhich I think that was the password.\n\n432\n00:22:55.990 --> 00:22:59.380\nI swore I told you not to show me that\nagain, and you're showing me that again.\n\n433\n00:22:59.380 --> 00:23:03.000\nWhat's up with that?\n\n434\n00:23:03.000 --> 00:23:05.634\nInternal IP 10.125.\n\n435\n00:23:06.730 --> 00:23:10.636\nYeah, we don't have to wait for Server\nManager, let's just go see what we got.\n\n436\n00:23:13.435 --> 00:23:16.420\nAll right, so this guy has picked\nup the correct one, right?\n\n437\n00:23:16.420 --> 00:23:19.580\nSo you've got the on premise DNS,\n10.1.1.10,\n\n438\n00:23:19.580 --> 00:23:24.390\nas well as your dc01 10.1.2.4.\n\n439\n00:23:24.390 --> 00:23:25.840\nSo he is good to go.\n\n440\n00:23:25.840 --> 00:23:29.280\nWe'll go ahead and start the process\nwhile I'm on this machine.\n\n441\n00:23:29.280 --> 00:23:32.600\nI'm going to, actually I have not added\na second drive yet, so I take that back.\n\n442\n00:23:32.600 --> 00:23:33.160\nWe can't do that.\n\n443\n00:23:34.240 --> 00:23:38.950\nWe'll disconnect from that session, and\nwe'll kind of kill a few birds with one or\n\n444\n00:23:38.950 --> 00:23:40.250\ntwo stones here.\n\n445\n00:23:40.250 --> 00:23:42.390\nAlright, what was I going to do?\n\n446\n00:23:42.390 --> 00:23:47.366\nLet's attach an empty disk,\nand we'll just make that\n\n447\n00:23:47.366 --> 00:23:51.916\n10 gigabytes, and\nwe'll click okay for that.\n\n448\n00:23:51.916 --> 00:23:55.378\nAnd while that's going,\nwe're going to flip back over to dc01.\n\n449\n00:23:55.378 --> 00:24:00.110\nAnd you'll notice even though Active\nDirectory is not installed on that second\n\n450\n00:24:00.110 --> 00:24:00.964\nmachine yet.\n\n451\n00:24:00.964 --> 00:24:05.250\nThe warning for\nmy availability set is gone, all right?\n\n452\n00:24:05.250 --> 00:24:08.350\nSo Microsoft is saying two\nVMs in that availability set,\n\n453\n00:24:08.350 --> 00:24:12.750\nthat's the minimum that you have to\nhave to provide that that availability.\n\n454\n00:24:12.750 --> 00:24:14.130\nWe're good to go on our end.\n\n455\n00:24:14.130 --> 00:24:17.630\nIt's up to you to make sure the machines\nare running the same services.\n\n456\n00:24:17.630 --> 00:24:20.130\nIf you had one guy running DNS and\none guy running DHCP, and\n\n457\n00:24:20.130 --> 00:24:23.920\nyou put them in an availability set,\nsure, one of those machines is going to be\n\n458\n00:24:23.920 --> 00:24:27.620\nrunning barring it even with\na single point of failure.\n\n459\n00:24:27.620 --> 00:24:31.230\nBut you might have a DNS server or\nyou might have a DHCP server, right?\n\n460\n00:24:31.230 --> 00:24:32.140\nSo, you've gotta think about that.\n\n461\n00:24:32.140 --> 00:24:36.320\nWhen you create those availability sets,\nthe machines need to be running the same\n\n462\n00:24:36.320 --> 00:24:40.960\nservices or at least Whatever service\nyou're providing that availability for.\n\n463\n00:24:40.960 --> 00:24:44.040\nLike, in my case, I might have\na domain controller DNS server.\n\n464\n00:24:44.040 --> 00:24:48.980\nThe other one might be domain controller\nDNS and, I don't know, TFTP, right?\n\n465\n00:24:48.980 --> 00:24:52.800\nI'm not trying to provide availability for\nTFTP, so it's only on one of them.\n\n466\n00:24:52.800 --> 00:24:57.512\nBut the main active directory and DNS are\non both of them in that availability set.\n\n467\n00:24:57.512 --> 00:24:58.820\nAll right.\n\n468\n00:24:58.820 --> 00:25:03.270\nSo, we'll go ahead and\nconnect back over to DC1 real quick, and\n\n469\n00:25:03.270 --> 00:25:05.860\nwe'll have to reboot this guy.\n\n470\n00:25:05.860 --> 00:25:10.385\nIt's kind of annoying\nthat it remembers the,\n\n471\n00:25:10.385 --> 00:25:15.060\nittvprodemo/administrator instead of\n\n472\n00:25:15.060 --> 00:25:18.570\nremembering the last logged on account for\nthat one machine.\n\n473\n00:25:18.570 --> 00:25:21.940\nIt's like the last logged on account for\nany of the machines.\n\n474\n00:25:21.940 --> 00:25:25.190\nSo as I'm flipping back and\nforth, it's not helping me out.\n\n475\n00:25:25.190 --> 00:25:26.400\nBut we will go check.\n\n476\n00:25:26.400 --> 00:25:28.930\nWe'll open up PowerShell, here.\n\n477\n00:25:28.930 --> 00:25:30.970\nI'm sorry.\nWe gotta reboot this guy one more time.\n\n478\n00:25:30.970 --> 00:25:32.070\nThat's what it was.\n\n479\n00:25:33.350 --> 00:25:35.640\nWe'll restart him one more time.\n\n480\n00:25:36.820 --> 00:25:37.560\nOr did I restart?\n\n481\n00:25:37.560 --> 00:25:40.640\nI can't remember, I've lost track.\n\n482\n00:25:40.640 --> 00:25:42.810\nTrying to do too many\nthings at the same time.\n\n483\n00:25:42.810 --> 00:25:44.126\nLet's verify that I did not restart it.\n\n484\n00:25:44.126 --> 00:25:46.110\nI might have done that.\n\n485\n00:25:49.298 --> 00:25:50.485\nNo, still has the wrong one.\n\n486\n00:25:50.485 --> 00:25:51.943\nSo, we'll do a restart.\n\n487\n00:25:51.943 --> 00:25:55.651\nShutdown.G Dash R.\n\n488\n00:25:55.651 --> 00:25:58.318\nT.\nZero.\n\n489\n00:25:58.318 --> 00:26:02.360\nGo ahead and restart that guy.\n\n490\n00:26:02.360 --> 00:26:05.818\nAnd while we're waiting for that,\nwe'll flip back over to DC two.\n\n491\n00:26:05.818 --> 00:26:06.900\nAnd I'll go ahead.\n\n492\n00:26:06.900 --> 00:26:09.780\nWe've already attached that disc,\nso I'm gonna connect to it.\n\n493\n00:26:09.780 --> 00:26:14.170\nAnd I'll start that process all over\nagain for setting up active directory.\n\n494\n00:26:14.170 --> 00:26:16.901\nSo this is my local account.\n\n495\n00:26:20.318 --> 00:26:22.290\nAnd now I know I checked\nthat little check mark.\n\n496\n00:26:23.430 --> 00:26:24.530\n>> At least three times.\n\n497\n00:26:24.530 --> 00:26:25.600\n>> Right?\n>> [LAUGH]\n\n498\n00:26:25.600 --> 00:26:26.770\n>> And so, remember what we did?\n\n499\n00:26:26.770 --> 00:26:29.420\nGo to file services, disks.\n\n500\n00:26:29.420 --> 00:26:32.840\nI should see my newly\nattached blank drive.\n\n501\n00:26:32.840 --> 00:26:36.872\nThat is going to be unknown, so\nI need to initialize that drive.\n\n502\n00:26:36.872 --> 00:26:39.220\nIt's gonna bring it in\nas a GPT based disc.\n\n503\n00:26:40.600 --> 00:26:45.180\nOnce it finishes that we'll create\na volume that spans the entire graph.\n\n504\n00:26:45.180 --> 00:26:48.070\nSo I'm just going to next, next,\nnext all the way through here.\n\n505\n00:26:48.070 --> 00:26:50.660\nDrive letter F is, you know me.\n\n506\n00:26:50.660 --> 00:26:53.960\nAnd my-\n>> Get rid of that label.\n\n507\n00:26:53.960 --> 00:26:55.500\n>> Yeah, can't do those labels.\n\n508\n00:26:55.500 --> 00:26:57.188\n>> I won't be able to\nsleep at night anymore.\n\n509\n00:26:57.188 --> 00:26:59.250\n>> [LAUGH] I don't know what it is.\n\n510\n00:26:59.250 --> 00:26:59.970\nIt's so silly.\n\n511\n00:26:59.970 --> 00:27:03.920\nI did so much work,\nused to, in disk management.\n\n512\n00:27:03.920 --> 00:27:06.360\nAnd the top part had them listed.\n\n513\n00:27:06.360 --> 00:27:09.360\nAnd if you had drive labels that\nwere different lengths, you know,\n\n514\n00:27:09.360 --> 00:27:10.750\nthe letters wouldn't be lined up.\n\n515\n00:27:10.750 --> 00:27:15.180\nAnd I tend to be a little on the OCD side,\nand I want my letters to line up.\n\n516\n00:27:15.180 --> 00:27:19.160\nSo, no label, that letter would be\nleft-justified, and I would be good to go.\n\n517\n00:27:19.160 --> 00:27:21.740\n>> That's where it came from,\njust in case you wanted to know.\n\n518\n00:27:21.740 --> 00:27:22.975\n>> And now it's part of your DNA.\n\n519\n00:27:22.975 --> 00:27:24.901\n[LAUGH]\n>> It really is.\n\n520\n00:27:24.901 --> 00:27:26.840\nAll right, we'll click close on that one.\n\n521\n00:27:26.840 --> 00:27:28.830\nSo, now I got a new drive.\n\n522\n00:27:28.830 --> 00:27:32.940\nNow, I can begin the process of\ninstalling Active Directory.\n\n523\n00:27:32.940 --> 00:27:38.610\nActually, let me make sure that,\nyeah, we're gonna join the WORKGROUP.\n\n524\n00:27:38.610 --> 00:27:41.069\nRemember, I did the other day with dc01.\n\n525\n00:27:42.080 --> 00:27:45.890\nSo, I need to make sure he does have\nthe right IP address, 10.1.2.4 for DNS.\n\n526\n00:27:45.890 --> 00:27:48.980\nSo, he'll be able to find\nthe domain controller.\n\n527\n00:27:48.980 --> 00:27:50.570\nI did that the other day.\n\n528\n00:27:50.570 --> 00:27:52.310\nAnd I was trying to recall, Daniel,\n\n529\n00:27:52.310 --> 00:27:55.210\nI mean I've been doing this for\nyears and years, and I'm almost\n\n530\n00:27:55.210 --> 00:27:59.110\npositive that I've ran DCPromo on\na machine that was not part of the domain.\n\n531\n00:27:59.110 --> 00:28:02.680\nAs long as you have the right credentials\nyou would join the domain and\n\n532\n00:28:02.680 --> 00:28:03.685\ncreate a domain controller.\n\n533\n00:28:03.685 --> 00:28:05.234\nBut that failed yesterday, right?\n\n534\n00:28:05.234 --> 00:28:07.650\nAnd as soon as I joined\ninto the domain and\n\n535\n00:28:07.650 --> 00:28:09.860\nthen ran the UC promo\neverything worked fine.\n\n536\n00:28:09.860 --> 00:28:13.900\nAnd now I cannot remember to the life of\nme if I had actually done that before or\n\n537\n00:28:13.900 --> 00:28:15.490\nif something is different about it.\n\n538\n00:28:15.490 --> 00:28:16.562\n>> Or if you have just thought you have?\n\n539\n00:28:16.562 --> 00:28:17.191\n>> Yeah.\nYou know?\n\n540\n00:28:17.191 --> 00:28:19.482\nSo, I'm not sure on that one,\nladies and gentlemen.\n\n541\n00:28:19.482 --> 00:28:21.370\nI'll have do a few research there.\n\n542\n00:28:21.370 --> 00:28:24.510\nWe're gonna join ITProTVdemo.com.\n\n543\n00:28:24.510 --> 00:28:27.690\n>> Either way, this does work.\n\n544\n00:28:27.690 --> 00:28:28.290\n>> This does work.\n\n545\n00:28:28.290 --> 00:28:30.222\n>> What Mike is showing you right now,\nthis will work.\n\n546\n00:28:30.222 --> 00:28:32.510\n[LAUGH]\n>> [LAUGH] That it does.\n\n547\n00:28:32.510 --> 00:28:34.220\nAdministrator, give it the credentials for\n\n548\n00:28:34.220 --> 00:28:39.050\nsomebody in the domain to add a new\ndomain controller to an existing domain.\n\n549\n00:28:39.050 --> 00:28:43.240\nHopefully, get welcome to the Azure or\nitpdoemo.com network.\n\n550\n00:28:43.240 --> 00:28:44.280\nThere we go.\n\n551\n00:28:44.280 --> 00:28:46.110\nEnter, enter, tab, enter, enter.\n\n552\n00:28:48.818 --> 00:28:49.960\nI haven't done that-\n>> You've never.\n\n553\n00:28:49.960 --> 00:28:51.880\n>> 2,000 times.\n[LAUGH] All right.\n\n554\n00:28:51.880 --> 00:28:52.704\nAll right.\n\n555\n00:28:52.704 --> 00:28:54.518\nThat guy is rebooting.\n\n556\n00:28:54.518 --> 00:28:58.990\nNow, it's gonna be part of the domain\n>> So, really, Daniel,\n\n557\n00:28:58.990 --> 00:29:02.320\nI mean, I think we've seen,\nonly thing, let's check with DC1 and\n\n558\n00:29:02.320 --> 00:29:05.380\njust make sure that\nconfiguration kicked in.\n\n559\n00:29:05.380 --> 00:29:08.960\nThe rest of the process is gonna be no\ndifferent than what we did before, right?\n\n560\n00:29:08.960 --> 00:29:12.420\nI've got that second drive now,\nso once it's part of the domain,\n\n561\n00:29:12.420 --> 00:29:18.890\nI'll run the add roles and features,\nif I can get that out of my mouth.\n\n562\n00:29:18.890 --> 00:29:20.690\nAnd I'll add those domain services.\n\n563\n00:29:20.690 --> 00:29:22.150\nI'll finish that wizard.\n\n564\n00:29:22.150 --> 00:29:25.580\nI'll launch the active\ndirectory configuration wizard,\n\n565\n00:29:25.580 --> 00:29:27.908\nadd an existing domain control\nto an existing domain.\n\n566\n00:29:27.908 --> 00:29:31.010\nNo different than what we teach\nyou in Server 101, right?\n\n567\n00:29:31.010 --> 00:29:33.978\nAs far as adding a replica\ndomain controller there.\n\n568\n00:29:33.978 --> 00:29:36.180\nAnd you've already seen that once.\n\n569\n00:29:36.180 --> 00:29:37.870\nAnd that completes my availability set.\n\n570\n00:29:37.870 --> 00:29:39.830\nSo, let's, let me connect,\n\n571\n00:29:39.830 --> 00:29:46.280\nmake sure my new registration is\nkicking in on my TCP IP settings here.\n\n572\n00:29:46.280 --> 00:29:51.350\n>> Yeah, this show isn't so much about\ngetting AD installed on another replica.\n\n573\n00:29:51.350 --> 00:29:55.460\nI's all about making sure you have the\navailability set filled out the way that\n\n574\n00:29:55.460 --> 00:29:59.314\nyou need to in case one DC goes down\nyou have another one right there,\n\n575\n00:29:59.314 --> 00:30:01.180\na secondary waiting to take over and\n\n576\n00:30:01.180 --> 00:30:04.820\ndo everything that needs to be done and\nhaving that full tolerance.\n\n577\n00:30:04.820 --> 00:30:06.220\n>> Exactly.\nIn fact, I had planned, I think,\n\n578\n00:30:06.220 --> 00:30:09.240\nif you watched the previous episode\nI wasn't gonna show you any of this.\n\n579\n00:30:09.240 --> 00:30:10.710\nI was just gonna move on.\n\n580\n00:30:10.710 --> 00:30:13.670\nBut then I wanted to make sure\nwe pointed out the whole,\n\n581\n00:30:13.670 --> 00:30:17.830\nyou have to use the same Cloud service\nto complete that availability set.\n\n582\n00:30:17.830 --> 00:30:18.540\nAll right.\nSo,\n\n583\n00:30:18.540 --> 00:30:23.140\nwhile that's loading up Server Manager,\nwe'll pull up a little Windows PowerShell,\n\n584\n00:30:23.140 --> 00:30:26.810\ndo a little ipconfig all.\n\n585\n00:30:26.810 --> 00:30:29.570\nAnd still has the wrong one, so-\n>> Really hanging on to that\n\n586\n00:30:29.570 --> 00:30:30.180\nthere, isn't it?\n\n587\n00:30:30.180 --> 00:30:31.585\n>> It really is.\n\n588\n00:30:31.585 --> 00:30:36.420\nThat's just odd.\n\n589\n00:30:36.420 --> 00:30:38.050\nI wonder if you can do, let's experiment.\n\n590\n00:30:38.050 --> 00:30:40.943\nipconfig switch release.\n\n591\n00:30:43.318 --> 00:30:44.610\n>> And now you've lost connectivity.\n\n592\n00:30:44.610 --> 00:30:47.780\n>> [LAUGH]\n>> What was I saying earlier?\n\n593\n00:30:47.780 --> 00:30:48.550\n>> Throw away, right?\n\n594\n00:30:48.550 --> 00:30:50.270\nThrow away your old lease.\n\n595\n00:30:50.270 --> 00:30:52.400\nAll right, now we'll try to reconnect.\n\n596\n00:30:52.400 --> 00:30:56.340\nIt should renew and\nget the same IP address back.\n\n597\n00:30:56.340 --> 00:31:01.780\nSo, let's see we'll give it a three,\ntwo, one.\n\n598\n00:31:01.780 --> 00:31:02.600\nTry to connect again.\n\n599\n00:31:07.235 --> 00:31:10.185\n[LAUGH]\n>> Probably gonna have to\n\n600\n00:31:10.185 --> 00:31:12.020\nrestart the program from Azure, right?\n\n601\n00:31:12.020 --> 00:31:13.310\n>> I might have to.\n\n602\n00:31:13.310 --> 00:31:16.940\nI released it, but\nhe's probably not gonna do it.\n\n603\n00:31:16.940 --> 00:31:20.740\nRemember, DHCP is not quite\nthe same as our on-premises.\n\n604\n00:31:20.740 --> 00:31:23.970\nSo, it might not be the DHCP\nclient call every so\n\n605\n00:31:23.970 --> 00:31:28.100\noften, trying to find a DHCP server.\n\n606\n00:31:28.100 --> 00:31:29.276\nSo, I'll just restart it from here.\n\n607\n00:31:32.068 --> 00:31:35.056\nWhich, making sure I'm not hosing up.\n\n608\n00:31:35.056 --> 00:31:36.180\n>> [INAUDIBLE] [LAUGH]\n>> I know.\n\n609\n00:31:36.180 --> 00:31:37.635\nI was trying to think.\n\n610\n00:31:37.635 --> 00:31:42.780\nSo, DC 2, I hadn't started the promotion\nyet, so we should be fine there as well.\n\n611\n00:31:42.780 --> 00:31:45.612\nNobody's looking for\nDC 1 right now, Azure DC 1 anyway.\n\n612\n00:31:45.612 --> 00:31:48.790\nAll right.\n\n613\n00:31:48.790 --> 00:31:51.533\nSo, now I was going to say that\nwas all we have to do, but\n\n614\n00:31:51.533 --> 00:31:52.862\nnow we got to wait and see.\n\n615\n00:31:52.862 --> 00:31:57.325\nWe really wanna find out what\nhappened there with DC1, so\n\n616\n00:31:57.325 --> 00:31:59.976\ntune in next week when we find out.\n\n617\n00:31:59.976 --> 00:32:02.051\n[LAUGH].\n>> [LAUGH]\n\n618\n00:32:02.051 --> 00:32:05.526\n>> All right let's try it,\n\n619\n00:32:05.526 --> 00:32:09.504\nare we up and running again?\n\n620\n00:32:09.504 --> 00:32:12.361\nWe'll find out here.\n\n621\n00:32:15.528 --> 00:32:19.740\nWould be kinda funny if doing\na release completely ruined your VM.\n\n622\n00:32:19.740 --> 00:32:23.380\nYou would think they would\nnot allow that to happen.\n\n623\n00:32:23.380 --> 00:32:25.520\n>> No, that would be a mistake.\n\n624\n00:32:25.520 --> 00:32:26.850\n>> That would be.\n\n625\n00:32:26.850 --> 00:32:28.240\nSo we'll give it another minute here.\n\n626\n00:32:28.240 --> 00:32:31.160\nWe'll see what's completed\nin the meantime.\n\n627\n00:32:32.170 --> 00:32:34.119\nThere we go.\nSo it's still restarting that machine.\n\n628\n00:32:35.530 --> 00:32:36.610\nIt's really mad at me.\n\n629\n00:32:36.610 --> 00:32:38.781\nIt did not like that\ntrying to do that release.\n\n630\n00:32:38.781 --> 00:32:39.870\nI mean he doesn't tell you.\n\n631\n00:32:39.870 --> 00:32:44.743\nThey say this is not DHCP, you're getting\nit once, you get a 135 year lease or\n\n632\n00:32:44.743 --> 00:32:46.330\n137 or whatever it is.\n\n633\n00:32:47.830 --> 00:32:51.150\nThey don't tell you that running\nthe release command will\n\n634\n00:32:51.150 --> 00:32:53.230\ncompletely hose your your\naccess to the machine.\n\n635\n00:32:54.530 --> 00:32:55.795\n>> Here's hoping that it doesn't.\n\n636\n00:32:55.795 --> 00:32:58.652\n[LAUGH]\n>> I know it's gonna come back,\n\n637\n00:32:58.652 --> 00:33:00.776\nit's just a little bit slow right now.\n\n638\n00:33:03.742 --> 00:33:06.081\nSo what else can we do in the meantime?\n\n639\n00:33:06.081 --> 00:33:09.901\nWe can go back and while we're waiting for\n\n640\n00:33:09.901 --> 00:33:14.923\nit to refresh we might as well\nrefresh our memory on what\n\n641\n00:33:14.923 --> 00:33:20.620\nit takes to set up our domain\ncontroller up there in the cloud.\n\n642\n00:33:27.111 --> 00:33:29.903\nHm, great.\n\n643\n00:33:29.903 --> 00:33:31.430\nI have killed all connectivity.\n\n644\n00:33:31.430 --> 00:33:32.350\nThe cloud is gone.\n\n645\n00:33:32.350 --> 00:33:33.810\nI just brought down Azure.\n\n646\n00:33:33.810 --> 00:33:34.315\n>> Azure's done.\n\n647\n00:33:34.315 --> 00:33:41.073\n>> [LAUGH]\n>> Right.\n\n648\n00:33:42.198 --> 00:33:43.194\nYou know.\n\n649\n00:33:46.532 --> 00:33:49.856\nIt's really not happy at all right now.\n\n650\n00:33:53.148 --> 00:33:54.618\nLet's see if this guy is.\n\n651\n00:33:54.618 --> 00:33:56.050\nYou see everything is locked up.\n\n652\n00:33:56.050 --> 00:33:57.380\nIt says restarting.\n\n653\n00:33:57.380 --> 00:34:01.770\nBut the little bars are not moving\nanymore which is telling me that it\n\n654\n00:34:03.020 --> 00:34:05.180\nis not refreshing at this point so\nwe're just waiting.\n\n655\n00:34:08.470 --> 00:34:08.970\nThere we go.\n\n656\n00:34:10.300 --> 00:34:13.115\nIt's moving again so\nit should finish in just a minute.\n\n657\n00:34:13.115 --> 00:34:17.060\nWe'll wait for that, we can review, trying\nto think what else we're going to do.\n\n658\n00:34:17.060 --> 00:34:19.410\nNow what we plan on doing in\nthe next episode go ahead and\n\n659\n00:34:19.410 --> 00:34:21.890\nset you up with that\ncliffhanger that we love to do.\n\n660\n00:34:21.890 --> 00:34:25.600\nMy next step is we wanna examine things,\nright?\n\n661\n00:34:25.600 --> 00:34:30.540\nWe wanna verify that everything's working\nand that we've got replication occurring.\n\n662\n00:34:30.540 --> 00:34:34.690\nSo now we have, now off camera before\nthis episode, I went ahead and\n\n663\n00:34:34.690 --> 00:34:38.400\nset up a second on premise domain\ncontroller, on premise domain controller.\n\n664\n00:34:38.400 --> 00:34:40.540\nSo we've got two here on premise.\n\n665\n00:34:40.540 --> 00:34:43.420\nWhere it should,\nhopefully unless I ruined things,\n\n666\n00:34:43.420 --> 00:34:47.010\nwe have two domain controllers\nout here in Azure.\n\n667\n00:34:47.010 --> 00:34:48.830\nEach one of those is a site.\n\n668\n00:34:48.830 --> 00:34:53.210\nAnd remember with ActiveDirectory\nreplication, a site within a site,\n\n669\n00:34:53.210 --> 00:34:57.420\ndomain controllers replicate as often as\nthey want based on change notification.\n\n670\n00:34:57.420 --> 00:34:59.090\nIt occurs within minutes.\n\n671\n00:34:59.090 --> 00:35:00.770\nBetween sites it's on a schedule.\n\n672\n00:35:00.770 --> 00:35:02.620\nRight?\nThat's why we like sites or\n\n673\n00:35:02.620 --> 00:35:04.520\none of the reasons we use sites.\n\n674\n00:35:04.520 --> 00:35:08.470\nNow, if we're doing this just strictly on\npremises and I've got an office here and\n\n675\n00:35:08.470 --> 00:35:13.430\nI've got an office in Birmingham and\nwe create sites by,\n\n676\n00:35:13.430 --> 00:35:16.690\ndefault it replicates every three hours.\n\n677\n00:35:16.690 --> 00:35:19.630\nEvery 180 minutes and\nit does that 24 hours a day.\n\n678\n00:35:19.630 --> 00:35:23.500\nSo every three hours the domain,\nthe bridge head servers one site\n\n679\n00:35:23.500 --> 00:35:26.830\nare going to contact the bridge\nhead servers at the other site and\n\n680\n00:35:26.830 --> 00:35:29.400\nsee if there's been any changes.\n\n681\n00:35:29.400 --> 00:35:32.490\nSo it doesn't notify the other side\nwhen there's been a change, it waits for\n\n682\n00:35:32.490 --> 00:35:36.230\nthem to come ask if there's been a change\nand it does it every three hours.\n\n683\n00:35:36.230 --> 00:35:39.890\nThat minimizes the replication\ntraffic going across that site link\n\n684\n00:35:39.890 --> 00:35:42.850\nbecause we have users trying to\nconsume internet resources and\n\n685\n00:35:42.850 --> 00:35:45.470\nwe don't want to soak\nup all that bandwidth.\n\n686\n00:35:45.470 --> 00:35:48.335\nI want to show you up here in the cloud\nit does it a little bit differently.\n\n687\n00:35:48.335 --> 00:35:51.650\nIt's still a separate\nsite from on premises but\n\n688\n00:35:51.650 --> 00:35:56.470\nthe schedule is a little bit different so\nfinally good golly, I went ahead and\n\n689\n00:35:56.470 --> 00:36:02.300\nreset that machine or restarted and\nI'll go ahead and click back in there.\n\n690\n00:36:02.300 --> 00:36:08.560\nAuthenticate if I can remember which\naccount we're using for this one.\n\n691\n00:36:08.560 --> 00:36:09.779\n>> Mike, you learned a valuable today.\n\n692\n00:36:09.779 --> 00:36:10.330\n[LAUGH]\n>> Yes I did.\n\n693\n00:36:10.330 --> 00:36:12.680\nAnd hopefully you guys\nlearned from my mistake.\n\n694\n00:36:12.680 --> 00:36:14.170\n>> That's right, that's right.\n\n695\n00:36:14.170 --> 00:36:15.880\nThat's why we add these\nthings into our shows.\n\n696\n00:36:15.880 --> 00:36:19.460\nCuz, you know what,\nnothing always goes perfectly.\n\n697\n00:36:19.460 --> 00:36:21.000\nYou're gonna have those flyers.\n\n698\n00:36:21.000 --> 00:36:21.840\nThis is one of those times,\n\n699\n00:36:21.840 --> 00:36:24.580\nbut you can learn something from it and\nyou usually do.\n\n700\n00:36:24.580 --> 00:36:25.610\n>> And you know what Daniel?\n\n701\n00:36:25.610 --> 00:36:28.540\nIt still has the same IP address for DNS.\n\n702\n00:36:28.540 --> 00:36:30.120\nThat is interesting.\n\n703\n00:36:30.120 --> 00:36:33.800\nSo that's something I'll have to do\na little bit more troubleshooting on.\n\n704\n00:36:33.800 --> 00:36:36.800\nAnd I'll make sure I point that out to\nyou rather than you guys sit here and\n\n705\n00:36:36.800 --> 00:36:39.700\nwatch me go through and\ntry to figure out what's wrong with Azure.\n\n706\n00:36:39.700 --> 00:36:42.150\nBut I'll make sure I let you\nguys know what I found out.\n\n707\n00:36:42.150 --> 00:36:43.370\nIn the meantime,\n\n708\n00:36:43.370 --> 00:36:49.310\ndo not run an IPconfig /release on one\nof your machines out there in the cloud.\n\n709\n00:36:49.310 --> 00:36:50.030\n>> [LAUGH].\nAll right.\n\n710\n00:36:50.030 --> 00:36:53.640\nGood advice that we've definitely\nlearned is the gospel.\n\n711\n00:36:53.640 --> 00:36:54.152\nAll right.\n>> [LAUGH].\n\n712\n00:36:54.152 --> 00:36:55.462\n>> So with that being said,\n\n713\n00:36:55.462 --> 00:36:57.240\nMike we've covered a lot of stuff today.\n\n714\n00:36:57.240 --> 00:37:00.420\nI know you got some other stuff that\nwe want to verify in another episode.\n\n715\n00:37:00.420 --> 00:37:03.300\nSo I think this is a good spot for\nus to go ahead and call her a day.\n\n716\n00:37:03.300 --> 00:37:07.350\nI thank you so much for joining us today\nand showing us how to do these things.\n\n717\n00:37:07.350 --> 00:37:09.480\nAnd hopefully you'll see\nus in the next episode.\n\n718\n00:37:09.480 --> 00:37:10.970\nWe do appreciate your viewership.\n\n719\n00:37:10.970 --> 00:37:12.840\nWe are gonna go ahead and\nsign off for ITProTV.\n\n720\n00:37:12.840 --> 00:37:14.710\nI've been your host Daniel Lowery.\n\n721\n00:37:14.710 --> 00:37:15.571\nAnd I'm Mike Rodrick.\n\n722\n00:37:15.571 --> 00:37:17.617\nWe'll see you next time.\n\n723\n00:37:17.617 --> 00:37:25.230\n[SOUND]\n\n",
          "vimeoId": "155388021"
        },
        {
          "description": "In this episode, Daniel and Mike go through all the infrastructure that they've set up so far and take steps to verify that replication is occurring as expected. They show you how to check the replication schedule as well as how to adjust The schedule if needed. They also show you how to force replication when necessary.",
          "length": "1976",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-5-verifying_replication_and_topology-021216-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-5-verifying_replication_and_topology-021216-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-2-5-verifying_replication_and_topology-021216-1-sm.jpg",
          "title": "Verifying Replication and Topology",
          "transcript": "WEBVTT\n\n1\n00:00:00.005 --> 00:00:04.157\n[SOUND]\n\n2\n00:00:04.157 --> 00:00:12.536\n[MUSIC]\n\n3\n00:00:12.536 --> 00:00:17.010\nAll right, greetings everyone and welcome\nto another exciting episode of ITPro TV.\n\n4\n00:00:17.010 --> 00:00:19.090\nI'm your host, Daniel Lowery and\n\n5\n00:00:19.090 --> 00:00:22.950\nin today's episode, well we\nare continuing on with our What is this?\n\n6\n00:00:22.950 --> 00:00:23.820\nThis is AD in Assure.\n\n7\n00:00:23.820 --> 00:00:24.380\nThat's right.\n\n8\n00:00:24.380 --> 00:00:27.040\nActive directory in that\nAzure cloud environment and\n\n9\n00:00:27.040 --> 00:00:30.630\njoining us back today is our good friend,\nand the guy that's been helping us\n\n10\n00:00:30.630 --> 00:00:33.840\nwalk through this little\nconundrum of a problem.\n\n11\n00:00:33.840 --> 00:00:35.390\nAnd that is Mike Roger.\n\n12\n00:00:35.390 --> 00:00:37.760\nMike, welcome back to the show and\nthanks for joining us.\n\n13\n00:00:37.760 --> 00:00:38.470\n>> Your welcome.\n\n14\n00:00:38.470 --> 00:00:39.460\nGlad to be here.\n\n15\n00:00:39.460 --> 00:00:42.810\nIt has been a little bit of a roller\ncoaster as we've gone through\n\n16\n00:00:42.810 --> 00:00:44.150\nsome of these things with Azure.\n\n17\n00:00:44.150 --> 00:00:48.000\nMostly smooth sailing, right, but\na couple of hiccups here and there and\n\n18\n00:00:48.000 --> 00:00:51.880\nthat can be expected and hopefully you're\nlearning from those and you'll be able to\n\n19\n00:00:51.880 --> 00:00:54.830\ndeal with them better when you get\nout there and do this for yourself.\n\n20\n00:00:54.830 --> 00:00:57.080\nSo, hopefully that works for you.\n\n21\n00:00:57.080 --> 00:01:00.750\nAll right, so what we are going\nto do today is really stop and\n\n22\n00:01:00.750 --> 00:01:03.830\ntake a look at and\nwhat we've got up to this point,\n\n23\n00:01:03.830 --> 00:01:06.360\nbecause we have like I\nsaid done quite a bit.\n\n24\n00:01:06.360 --> 00:01:10.360\nIf you remember, I think I still have\nthis drawing up, when we first started we\n\n25\n00:01:10.360 --> 00:01:16.060\ntalked about our corporate office and how\nwe had a domain controller sitting here.\n\n26\n00:01:16.060 --> 00:01:18.540\nJust like as our on premises network.\n\n27\n00:01:18.540 --> 00:01:23.410\nIt was also running a DNS and\nthen we had another Server\n\n28\n00:01:23.410 --> 00:01:28.640\nthat's running Access to provide\nInternet access to my corporate office.\n\n29\n00:01:28.640 --> 00:01:33.330\nWe install routing and remote access on\nthere, we created a VPN server out of it,\n\n30\n00:01:33.330 --> 00:01:37.060\nand we built a tunnel out to Azure, and\n\n31\n00:01:37.060 --> 00:01:42.360\nthen on our virtual network out there in\nAzure, we built a domain controller and it\n\n32\n00:01:42.360 --> 00:01:47.410\njust successfully joins, so it's a second\ndomain controller to our existing domain.\n\n33\n00:01:47.410 --> 00:01:48.700\nWe also made these sites.\n\n34\n00:01:48.700 --> 00:01:52.770\nWe had the Azure site in active directory,\nwe've got the G and\n\n35\n00:01:52.770 --> 00:01:55.230\nV site, and\nwe've done a little bit since then.\n\n36\n00:01:55.230 --> 00:01:58.330\nSo that we should real quick updates,\noops,\n\n37\n00:01:58.330 --> 00:02:01.230\nnot do that to my poor little\ncorporate network there.\n\n38\n00:02:01.230 --> 00:02:04.500\nMaybe update this real quick,\nso I'm just going to.\n\n39\n00:02:04.500 --> 00:02:09.520\nAdd a couple of things and\nwhat we'll do is we'll update this\n\n40\n00:02:09.520 --> 00:02:14.230\nguy so we now have two main\ncontrollers on premise.\n\n41\n00:02:16.480 --> 00:02:21.480\nAnd, move that out of the way, and\nwe'll grab this guy and this guy, and\n\n42\n00:02:24.150 --> 00:02:29.960\nwe now have two domain\ncontrollers out in Azure.\n\n43\n00:02:29.960 --> 00:02:34.606\nSo we'll put the AZDCO2 out there.\n\n44\n00:02:34.606 --> 00:02:36.350\nAll right?\n\n45\n00:02:36.350 --> 00:02:38.900\nSo that's what we've\ngot going on right now.\n\n46\n00:02:38.900 --> 00:02:40.430\nWe are going to continue on.\n\n47\n00:02:40.430 --> 00:02:46.130\nWe are actually going to setup a little\nrouter over here, setup a branch office.\n\n48\n00:02:46.130 --> 00:02:49.060\nAnd show you how we can do that\nwithout adding a domain controller to\n\n49\n00:02:49.060 --> 00:02:52.130\nthat branch office and\nstill providing them that functionality.\n\n50\n00:02:52.130 --> 00:02:53.660\nSo this kinda what we got going on.\n\n51\n00:02:53.660 --> 00:02:56.560\nAnd this really falls in line\nwith our best practices,\n\n52\n00:02:56.560 --> 00:02:58.780\ntwo domain controllers per site.\n\n53\n00:02:58.780 --> 00:03:03.400\nSo what we wanna do now that we've\ngot all this set up is go back in and\n\n54\n00:03:03.400 --> 00:03:05.340\nverify that things are working.\n\n55\n00:03:05.340 --> 00:03:08.010\nEach one of my domain\ncontrollers is running DNS.\n\n56\n00:03:08.010 --> 00:03:13.040\nSo we still really need to add a couple\nmore registrations to Azure, right.\n\n57\n00:03:13.040 --> 00:03:17.090\nBecause we only registered two\nof the DNS servers up there.\n\n58\n00:03:17.090 --> 00:03:22.270\nIf one of those was down, or\nboth of them happen to be down,\n\n59\n00:03:22.270 --> 00:03:25.580\nwe still domain controllers running DNS\nbut nobody would know about them, right.\n\n60\n00:03:25.580 --> 00:03:28.040\nSo we wanna make sure that\ninformation is passed out\n\n61\n00:03:28.040 --> 00:03:30.060\nalong with the other TCP/IP configs.\n\n62\n00:03:30.060 --> 00:03:34.800\nWe need to do that we also wanna\nverify that replication is occurring,\n\n63\n00:03:34.800 --> 00:03:37.520\nboth between the domain controllers and\nthe corporate office,\n\n64\n00:03:37.520 --> 00:03:41.460\nbetween the domain controllers out there\nin Azure, and between the two sites.\n\n65\n00:03:41.460 --> 00:03:43.600\nBetween Gainesville and Azure.\n\n66\n00:03:43.600 --> 00:03:45.840\nBetween my two locations, there.\n\n67\n00:03:45.840 --> 00:03:49.170\nSo, that's what we are going to do today.\n\n68\n00:03:49.170 --> 00:03:51.390\nSo, I'm going to flip over here,\nand let's start local.\n\n69\n00:03:53.160 --> 00:03:57.080\nWe're going to pull up GNV-DCO 1.\n\n70\n00:03:57.080 --> 00:04:02.010\nThese guys time out so fast we'll log\n\n71\n00:04:02.010 --> 00:04:06.824\nback into this is one\nof my on-premise DCs.\n\n72\n00:04:06.824 --> 00:04:09.449\nI'll full-screen that for us.\n\n73\n00:04:11.350 --> 00:04:14.230\nAnd I'm simply gonna pull up,\nlet's start with DNS.\n\n74\n00:04:14.230 --> 00:04:16.330\nIt's like a good place to start.\n\n75\n00:04:16.330 --> 00:04:17.710\nSo, we're gonna open up DNS.\n\n76\n00:04:18.880 --> 00:04:21.980\nAnd what I would be looking for\nin here, is making sure that all\n\n77\n00:04:21.980 --> 00:04:26.870\nfour domain controllers are properly\nregistering their SRV records.\n\n78\n00:04:26.870 --> 00:04:31.810\nSo that they can be located by the clients\nor whomever needs to access them.\n\n79\n00:04:31.810 --> 00:04:36.195\nSo I'm going to expand out forward look up\nzones and I'm gonna expand on my domain\n\n80\n00:04:36.195 --> 00:04:40.930\nITproTVdemo.com and\nthen I'm gonna expand out sites.\n\n81\n00:04:40.930 --> 00:04:45.980\nAll right and I'll go into I'll start with\na local site here I'll expand out GNV,\n\n82\n00:04:45.980 --> 00:04:49.360\nclick on TCP, and what I should see,\nand I'll zoom in a little bit for\n\n83\n00:04:49.360 --> 00:04:50.100\nyou guys here.\n\n84\n00:04:51.970 --> 00:04:56.750\nWhat I should see is records, for the\nglobal catalog service, for kerberos and\n\n85\n00:04:56.750 --> 00:04:57.770\nfor ldap.\n\n86\n00:04:57.770 --> 00:05:01.290\nAnd if we take a look at\nthe names in these records,\n\n87\n00:05:01.290 --> 00:05:06.530\nyou can see gnv-dc01 and\ngnv-dc02 for each one of those.\n\n88\n00:05:06.530 --> 00:05:10.440\nTwo for global catalogue,\ntwo for Kerberos, two for LDAP.\n\n89\n00:05:10.440 --> 00:05:12.180\nSo, that looks good there.\n\n90\n00:05:12.180 --> 00:05:15.741\nWe expand out Azure and TCP and\n\n91\n00:05:15.741 --> 00:05:20.320\nI can see the same thing going on here.\n\n92\n00:05:20.320 --> 00:05:21.570\nGot hxdc01 and dc02.\n\n93\n00:05:21.570 --> 00:05:26.070\nBoth of them successfully\nregistering their records there.\n\n94\n00:05:26.070 --> 00:05:27.370\nSo that looks good, right?\n\n95\n00:05:27.370 --> 00:05:33.090\nDNS, that means everybody is properly\nregistering their SRV records.\n\n96\n00:05:33.090 --> 00:05:36.300\nSo go ahead and close that.\n\n97\n00:05:36.300 --> 00:05:40.410\nNext, let's check out\nActive Directory Sites and Services.\n\n98\n00:05:42.180 --> 00:05:44.469\nSo we'll come into our Sites and\nServices console.\n\n99\n00:05:45.790 --> 00:05:46.290\nWait.\n\n100\n00:05:46.290 --> 00:05:49.290\nThis console does sometimes take\na minute to gather all it's information\n\n101\n00:05:49.290 --> 00:05:50.180\nand open up.\n\n102\n00:05:50.180 --> 00:05:52.260\nSo you have to be patient with it.\n\n103\n00:05:52.260 --> 00:05:55.380\nAnd I can see my two sites over here.\n\n104\n00:05:55.380 --> 00:05:58.260\nSo everything's looking good so far.\n\n105\n00:05:58.260 --> 00:06:00.400\nIf I expand out Azure, and\n\n106\n00:06:00.400 --> 00:06:04.044\nexpand out servers,\nI see both of my domain controllers there.\n\n107\n00:06:04.044 --> 00:06:08.270\nAZ-DC01 and DC02 expend out gnv and\n\n108\n00:06:08.270 --> 00:06:12.340\nservers, I see both of those\nservers there as well.\n\n109\n00:06:12.340 --> 00:06:15.050\nAs we click on these,\nwhat I would be checking, and\n\n110\n00:06:15.050 --> 00:06:16.770\nI'll zoom out just a lit bit.\n\n111\n00:06:16.770 --> 00:06:20.690\nI'm going to expand out one of these\nservers and click on NTDS, and\n\n112\n00:06:20.690 --> 00:06:24.090\nI wanna look at their replication links.\n\n113\n00:06:24.090 --> 00:06:26.640\nRemembers, we don't have\nto do this manually.\n\n114\n00:06:26.640 --> 00:06:28.490\nWe've got the knowledge\nconsistency checker,\n\n115\n00:06:28.490 --> 00:06:33.780\nthe KCC as well as the inter site\ntopology generator, the ISTG,\n\n116\n00:06:33.780 --> 00:06:40.430\nthat work in conjunction to create the\nreplication topology for active directory.\n\n117\n00:06:40.430 --> 00:06:45.060\nIt makes a robust two way replication\ntopology without help from me,\n\n118\n00:06:45.060 --> 00:06:46.060\nand that's always good.\n\n119\n00:06:46.060 --> 00:06:49.110\nThat's what this automatically\ngenerated remember,\n\n120\n00:06:49.110 --> 00:06:51.730\nwe've seen this in some of\nour other server classes.\n\n121\n00:06:51.730 --> 00:06:55.940\nIf you want more information about should\nI manually create some replication links,\n\n122\n00:06:55.940 --> 00:06:56.900\nthings like that.\n\n123\n00:06:56.900 --> 00:06:57.550\nCheck those out.\n\n124\n00:06:57.550 --> 00:06:59.810\nBut for now,\nI'm fine with the automatically generated.\n\n125\n00:06:59.810 --> 00:07:02.880\n99% of the time we are.\n\n126\n00:07:02.880 --> 00:07:09.150\nBut, I can see that the GNVDC01\nhas a replication link from DC02.\n\n127\n00:07:09.150 --> 00:07:12.900\nSo the other domain\ncontroller on premises, and\n\n128\n00:07:12.900 --> 00:07:15.460\nDC01 are replicating with each other.\n\n129\n00:07:15.460 --> 00:07:18.650\nAnd then there's a replication\nlink created out to Azure DC01.\n\n130\n00:07:18.650 --> 00:07:20.800\nSo, from server.\n\n131\n00:07:20.800 --> 00:07:22.250\nMake sure you pay attention there.\n\n132\n00:07:22.250 --> 00:07:26.310\nFrom Azure DC01 back to g and v DCO1.\n\n133\n00:07:27.380 --> 00:07:34.980\nIf we look at DC02 and his NTDS settings,\nI see one link from DC01, right?\n\n134\n00:07:34.980 --> 00:07:38.580\nBut you don't see one from Azure and\nI'll explain in just a second.\n\n135\n00:07:39.780 --> 00:07:44.781\nI'll go up to Azure,\nexpand out to Azure DC-01 NTDS\n\n136\n00:07:44.781 --> 00:07:48.488\nsettings and there's one from DC01.\n\n137\n00:07:48.488 --> 00:07:50.858\nAnd that's probably not a good thing.\n\n138\n00:07:50.858 --> 00:07:53.778\nYeah, Azure DC02 has not picked up.\n\n139\n00:07:53.778 --> 00:07:55.118\nA replication link is.\n\n140\n00:07:55.118 --> 00:07:57.288\nSo, that's something that\nwe're gonna have to look into.\n\n141\n00:07:57.288 --> 00:08:01.740\nAll of a sudden I've got a domain\ncontroller that has no replication.\n\n142\n00:08:01.740 --> 00:08:05.830\nThere's no link established, therefore\nhe's not gonna be getting information.\n\n143\n00:08:05.830 --> 00:08:09.600\nWhen we make changes in the directory,\nthey're not gonna replicate over to him.\n\n144\n00:08:09.600 --> 00:08:12.190\nAnd that's not a good thing, so\nwe definitely have an issue here.\n\n145\n00:08:12.190 --> 00:08:13.200\nGood thing we went in and checked.\n\n146\n00:08:13.200 --> 00:08:13.800\n>> That's right.\n\n147\n00:08:13.800 --> 00:08:17.760\nThat's the whole purpose of going\nthrough a verification process, right?\n\n148\n00:08:17.760 --> 00:08:21.140\nMake sure that everything that you\nexpect to see is actually there.\n\n149\n00:08:21.140 --> 00:08:22.740\nAnd if not, now we know,\n\n150\n00:08:22.740 --> 00:08:26.090\nokay well at least if we have a problem\nand we've caught it beforehand.\n\n151\n00:08:26.090 --> 00:08:28.680\nBefore we said, hey yeah go ahead and\nflip those switches.\n\n152\n00:08:28.680 --> 00:08:32.090\nThose things are ready for production and\nthey weren't, and now you gotta go to\n\n153\n00:08:32.090 --> 00:08:36.330\nbefore the man and let him dress you down\nand go, you said you could do a job and\n\n154\n00:08:36.330 --> 00:08:39.130\nthat's not happening, and\nyou said it was done and it's not.\n\n155\n00:08:39.130 --> 00:08:41.820\nYou don't wanna be a part\nof that conversation, so\n\n156\n00:08:41.820 --> 00:08:43.540\nalways a good idea to verify.\n\n157\n00:08:43.540 --> 00:08:47.330\nWhat do they say, trust but verify,\nand that's what we're doing right now.\n\n158\n00:08:47.330 --> 00:08:47.960\n>> Absolutely,\n\n159\n00:08:47.960 --> 00:08:52.050\nso what I might do while I'm in this\nconsole here, I'm just gonna go ahead.\n\n160\n00:08:52.050 --> 00:08:55.326\nI'll use the one in the cloud right\nnext to him, that is working.\n\n161\n00:08:55.326 --> 00:08:59.850\nI'm gonna right click on NTDS settings and\nI'm gonna choose All Tasks and\n\n162\n00:08:59.850 --> 00:09:03.500\nthen Check Replication Topology.\n\n163\n00:09:03.500 --> 00:09:07.250\nWhat that does is it\nmanually kicks in the KCC,\n\n164\n00:09:07.250 --> 00:09:11.070\nthe Knowledge Consistency Checker, what's\nresponsible for generating these links and\n\n165\n00:09:11.070 --> 00:09:16.270\nhopefully it will create one,\nActive Directory, Check topology.\n\n166\n00:09:16.270 --> 00:09:19.320\nAny new or deleted connections will\nnot be visible until they replicate\n\n167\n00:09:19.320 --> 00:09:22.020\nto DC gnv-dc01, blah,\nblah, blah, blah, blah.\n\n168\n00:09:22.020 --> 00:09:25.690\nAll right, so\nit very well could have created one, and\n\n169\n00:09:25.690 --> 00:09:30.960\nit just hasn't replicated\nback to my site here, right?\n\n170\n00:09:30.960 --> 00:09:35.450\nBecause remember, I am on gnv-dc01,\nwhich is on premise.\n\n171\n00:09:35.450 --> 00:09:38.830\nNow, we've gotta stop and\nthink about the replication.\n\n172\n00:09:38.830 --> 00:09:41.655\nI know we've mentioned this in\na couple of other episodes, but\n\n173\n00:09:41.655 --> 00:09:42.947\nlet's say it one more time.\n\n174\n00:09:42.947 --> 00:09:45.191\nWhen we look at replication,\n\n175\n00:09:45.191 --> 00:09:50.500\nreplication between the main\ncontrollers within a site, all right.\n\n176\n00:09:50.500 --> 00:09:54.730\nLet's, how can I do this here.\n\n177\n00:09:54.730 --> 00:09:55.420\nLet's do this.\n\n178\n00:09:55.420 --> 00:09:57.770\nWe'll draw a little line here.\n\n179\n00:09:57.770 --> 00:10:00.930\nWe'll take away that,\nwe'll add an arrow to the other end and\n\n180\n00:10:02.990 --> 00:10:06.961\nwe'll give it a different color so\nit stands out just a wee bit, right?\n\n181\n00:10:06.961 --> 00:10:14.270\nThat's inter site, inter intra sites,\nsorry get that right, within sites.\n\n182\n00:10:14.270 --> 00:10:17.980\nThat replication occurs frequently\non a change notification.\n\n183\n00:10:17.980 --> 00:10:22.290\nI also have replication occurring,\nwell hopefully,\n\n184\n00:10:22.290 --> 00:10:25.860\nwe're gonna go check on it in a minute,\nbetween these two guys.\n\n185\n00:10:25.860 --> 00:10:29.900\nThat's again,\nthat intra site replication, so\n\n186\n00:10:29.900 --> 00:10:32.790\nwithin a site should occur frequently and\noften.\n\n187\n00:10:32.790 --> 00:10:36.342\nBetween sites, however,\nthat's when it occurs on a schedule,\n\n188\n00:10:36.342 --> 00:10:41.810\ninter site replication, and we're gonna\ndraw another line to represent that.\n\n189\n00:10:41.810 --> 00:10:44.397\nOf course,\nit really is going across that tunnel, but\n\n190\n00:10:44.397 --> 00:10:46.490\njust so\nwe can kinda visually represent it.\n\n191\n00:10:46.490 --> 00:10:51.350\nI'm gonna put it our here and\ngive it a different color, all right?\n\n192\n00:10:51.350 --> 00:10:56.330\nI'm able to move that label down there,\nget that out of the way, all right.\n\n193\n00:10:56.330 --> 00:10:58.880\nThis replication occurs on a schedule.\n\n194\n00:10:58.880 --> 00:11:02.370\nSo, when I first set this guy\nup the second to main controller\n\n195\n00:11:02.370 --> 00:11:06.420\nhe might have very well created\nthe replication link and most likely did.\n\n196\n00:11:06.420 --> 00:11:11.620\nBut that fact hasn't\nreplicated over to GEVDCO one\n\n197\n00:11:11.620 --> 00:11:15.520\nwhich is where I was running the Active\nDirectory sites and service console.\n\n198\n00:11:15.520 --> 00:11:18.280\nSo, just because I saw\nthat it wasn't there, it\n\n199\n00:11:18.280 --> 00:11:21.800\ndoesn't mean necessarily that something's\ngone wrong but I went ahead and\n\n200\n00:11:21.800 --> 00:11:26.690\nrun the KCC anyway just to kinda make sure\nthings are kicked off in the background.\n\n201\n00:11:26.690 --> 00:11:27.420\nSo, let's do this.\n\n202\n00:11:27.420 --> 00:11:30.700\nLet's go back over to Azure.\n\n203\n00:11:30.700 --> 00:11:33.300\nAnd what we'll see, what we think here.\n\n204\n00:11:33.300 --> 00:11:34.990\nWe're gonna go to dc01.\n\n205\n00:11:34.990 --> 00:11:36.165\nThat's Azure dc01.\n\n206\n00:11:36.165 --> 00:11:39.442\nSo, one of my Azure dc's.\n\n207\n00:11:39.442 --> 00:11:46.960\nAnd I'm gonna open up active directory\nsites and services on this one.\n\n208\n00:11:46.960 --> 00:11:48.710\nAnd we'll make that a little bit bigger.\n\n209\n00:11:48.710 --> 00:11:53.920\nWe'll expand our sites and\nwe'll go Azure servers Azure dc02,\n\n210\n00:11:53.920 --> 00:11:57.460\nand sure enough, I do have NTDS settings.\n\n211\n00:11:57.460 --> 00:12:00.960\nAnd it has a link from Azure dc01,\nall right?\n\n212\n00:12:02.150 --> 00:12:04.420\nSo, probably just has not replicated and\n\n213\n00:12:04.420 --> 00:12:08.240\nI'm gonna show you that schedule that\nit runs on here in just a second.\n\n214\n00:12:08.240 --> 00:12:12.150\nBut, let's finish up that concept,\nwhy I saw two replication and\n\n215\n00:12:12.150 --> 00:12:14.780\nactually we need to switch these around,\ndon't we?\n\n216\n00:12:15.910 --> 00:12:19.532\nLet me just verify that\nI did that correctly.\n\n217\n00:12:19.532 --> 00:12:21.622\nServers, dc01.\n\n218\n00:12:21.622 --> 00:12:24.462\nSee, they don't even know about dc02 yet,\nso\n\n219\n00:12:24.462 --> 00:12:27.875\nwe can see that replication\nhas not occurred across that.\n\n220\n00:12:27.875 --> 00:12:33.334\nSo let's pull up dc01, and I'm gonna\nverify that he had the two links,\n\n221\n00:12:33.334 --> 00:12:36.125\nand CC2 has just the one link.\n\n222\n00:12:36.125 --> 00:12:37.155\nSo let's fix our drawing.\n\n223\n00:12:37.155 --> 00:12:41.125\nLet's make our drawing match the actual\nscenario just a little bit better.\n\n224\n00:12:41.125 --> 00:12:45.036\nLet's flip these guys around, all right.\n\n225\n00:12:45.036 --> 00:12:47.676\nSo that's what we've got there and\n\n226\n00:12:47.676 --> 00:12:51.470\nwe should probably flip\nthese guys around as well.\n\n227\n00:12:53.360 --> 00:12:55.700\nI promise I'll get this\nstraight here in just a second.\n\n228\n00:12:55.700 --> 00:13:00.528\nSometimes my drawing tool doesn't\nlike to play along with me.\n\n229\n00:13:00.528 --> 00:13:03.245\nWe'll put that down here, okay.\n\n230\n00:13:03.245 --> 00:13:06.898\nSo, the reason we saw two off dc01 but\nonly one off dc02,\n\n231\n00:13:06.898 --> 00:13:11.407\nis because when you have more than one\ndomain controller in a single site and\n\n232\n00:13:11.407 --> 00:13:13.769\nit's replicating with another site,\n\n233\n00:13:13.769 --> 00:13:18.580\nnot every domain controller has to\nreplicate across that site boundary.\n\n234\n00:13:18.580 --> 00:13:21.630\nYou're not gonna see something\nthat looks like this.\n\n235\n00:13:21.630 --> 00:13:28.910\nWe'll duplicate that and\nwe could do this because there's no need.\n\n236\n00:13:28.910 --> 00:13:32.870\nRemember this is a limited, we're\nassuming this is why we created sites in\n\n237\n00:13:32.870 --> 00:13:34.980\nthe first place that have got slower,\n\n238\n00:13:34.980 --> 00:13:39.680\nunreliable connectivity out to that\nbranch office in this case Azure, and\n\n239\n00:13:39.680 --> 00:13:43.120\nI don't need every domain controller\nreplicating with every domain controller.\n\n240\n00:13:43.120 --> 00:13:45.742\nIf a change is made back\non my corporate site,\n\n241\n00:13:45.742 --> 00:13:50.163\nthey're gonna replicate between all\nthe domain controllers on that site.\n\n242\n00:13:50.163 --> 00:13:54.616\nI only need one domain controller to\nreplicate the change to the other site.\n\n243\n00:13:54.616 --> 00:13:58.243\nAnd then once it's to the other site where\nI've got good high speed connectivity\n\n244\n00:13:58.243 --> 00:14:01.420\nthey can replicate all they want\nreally fast and take care of it.\n\n245\n00:14:01.420 --> 00:14:04.170\nSo, I just need one guy to\nget the change over and\n\n246\n00:14:04.170 --> 00:14:06.130\nthen replicate it within that site, right?\n\n247\n00:14:06.130 --> 00:14:10.120\nAnd if there's a third site, one server\nresponsible for replicating to the third\n\n248\n00:14:10.120 --> 00:14:13.210\nsite and then they can replicate\nwithin that site all they want.\n\n249\n00:14:13.210 --> 00:14:15.500\nThat's known as our bridgehead server.\n\n250\n00:14:15.500 --> 00:14:18.250\nAnd this is another thing\nthat the K-C-C picks.\n\n251\n00:14:18.250 --> 00:14:22.810\nIt picks which server is gonna act as\nthe connection between the other site.\n\n252\n00:14:22.810 --> 00:14:26.410\nNow you can change that but typically,\nwe don't have to, all right.\n\n253\n00:14:26.410 --> 00:14:30.559\nSo, that's why we saw two come from dc1,\nonly one coming from dc2.\n\n254\n00:14:30.559 --> 00:14:35.700\nDc2 is not replicating out\nwith anybody in Azure at all.\n\n255\n00:14:35.700 --> 00:14:37.960\nAll right, so\nwe got our drawing kinda updated.\n\n256\n00:14:37.960 --> 00:14:39.900\nWe see what's going on\nthere with the replication.\n\n257\n00:14:39.900 --> 00:14:43.490\nNow as far as why it hasn't\nreplicated process site yet,\n\n258\n00:14:43.490 --> 00:14:44.520\nlet's take a look at that.\n\n259\n00:14:45.750 --> 00:14:48.980\nAll right, let's go to,\nactually let's go to cloud city here.\n\n260\n00:14:51.150 --> 00:14:53.610\nSo here we are on our cloud machine.\n\n261\n00:14:53.610 --> 00:14:57.680\nThis is the link right\nhere from Azure dc01, so\n\n262\n00:14:57.680 --> 00:15:02.970\nthat's my bridgehead server up there\nin the cloud or in Azure, right?\n\n263\n00:15:02.970 --> 00:15:05.878\nNo, I'm sorry, I take that back.\n\n264\n00:15:05.878 --> 00:15:10.850\nFrom dc01 out to Azure and\ndo be careful with these links, too.\n\n265\n00:15:10.850 --> 00:15:13.170\nThat's one thing that's\neasy to get confused on.\n\n266\n00:15:13.170 --> 00:15:15.910\nPay attention to who it's from.\n\n267\n00:15:15.910 --> 00:15:17.720\nWhen you go underneath a server,\nyou might think, well,\n\n268\n00:15:17.720 --> 00:15:20.130\nthese are all the replication\nlinks from this server.\n\n269\n00:15:20.130 --> 00:15:23.290\nThese are the inbound replication\nlinks that you're seeing.\n\n270\n00:15:23.290 --> 00:15:25.440\nThis tells you where it's coming from.\n\n271\n00:15:25.440 --> 00:15:29.430\nSo in other words,\nif I had a change on Azure dc01 and\n\n272\n00:15:29.430 --> 00:15:32.720\nI wanted to force that\nreplication to occur right now.\n\n273\n00:15:32.720 --> 00:15:39.520\nI really need that change to replicate, I\nwanna force it from Azure 1 over to SVR 1.\n\n274\n00:15:39.520 --> 00:15:42.580\nPeople are always tempted to come in\nhere to go to Azure dc1 cuz that's\n\n275\n00:15:42.580 --> 00:15:45.850\nwhere the change occurred and\nI wanna push it out to everybody else.\n\n276\n00:15:45.850 --> 00:15:47.438\nIt's pole replication, right?\n\n277\n00:15:47.438 --> 00:15:51.947\nSo, you would actually have to go to dc01,\nfind the link from Azure 1\n\n278\n00:15:51.947 --> 00:15:55.418\nwhere the change was made and\nforce this replication.\n\n279\n00:15:55.418 --> 00:15:58.178\nSo just a little tidbit for you there.\n\n280\n00:15:58.178 --> 00:16:01.379\nAll right, so now we're going to\ntake a look at the replication link\n\n281\n00:16:01.379 --> 00:16:03.200\nbetween our two bridgehead servers.\n\n282\n00:16:03.200 --> 00:16:07.050\nI'm going to right click on that and\npull up Properties.\n\n283\n00:16:07.050 --> 00:16:10.140\nAnd on here,\nI've got a Change Schedule button.\n\n284\n00:16:10.140 --> 00:16:14.610\nNow, in fact, let me, before I've clicked\non that, let's go to the one between\n\n285\n00:16:14.610 --> 00:16:20.230\nthe two domain controllers in Azure,\nand take a look at this schedule.\n\n286\n00:16:20.230 --> 00:16:23.810\nIt's a little bit different than\nwhat you're going to see on-premise.\n\n287\n00:16:23.810 --> 00:16:25.130\nSo we'll look at all of them.\n\n288\n00:16:25.130 --> 00:16:27.030\nIn fact, you know what, Daniel?\n\n289\n00:16:27.030 --> 00:16:29.650\nLet's go back to on-premise.\n\n290\n00:16:29.650 --> 00:16:32.910\nLet's start there, because this is really\nwhat most people are probably gonna be\n\n291\n00:16:32.910 --> 00:16:35.360\nfamiliar with, so\nlet's start with something familiar.\n\n292\n00:16:35.360 --> 00:16:42.332\nI'm gonna take a look at the replication\nlink between GNV-DC02 and GNV-DC01.\n\n293\n00:16:42.332 --> 00:16:46.510\nSo this is intrasite\nreplication on-premises.\n\n294\n00:16:47.690 --> 00:16:51.710\nPull up Properties > Change Schedule,\nand there you go.\n\n295\n00:16:51.710 --> 00:16:53.600\nAnd actually,\nit looks exactly the same, right?\n\n296\n00:16:54.660 --> 00:16:57.590\nThat's something they've changed,\nthis is kind of impressive,\n\n297\n00:16:57.590 --> 00:16:59.660\nwhat they've done with 2012 R2.\n\n298\n00:16:59.660 --> 00:17:01.090\nBut what you'll see is,\n\n299\n00:17:01.090 --> 00:17:05.580\nit's allowed to replicate 24 hours a day,\nseven days a week.\n\n300\n00:17:05.580 --> 00:17:07.010\nAnd that's what these blue boxes mean.\n\n301\n00:17:07.010 --> 00:17:09.120\nLet me zoom in here real quick.\n\n302\n00:17:09.120 --> 00:17:11.170\nThis is one hour of the day.\n\n303\n00:17:11.170 --> 00:17:16.220\nSo this would be between 8 and\n9 am on Monday.\n\n304\n00:17:16.220 --> 00:17:18.600\nAnd over here it says once per hour.\n\n305\n00:17:18.600 --> 00:17:21.620\nSo they're only gonna\nreplicate once per hour.\n\n306\n00:17:21.620 --> 00:17:26.180\nI can bump that up to twice per hour,\nI can bump that up to four times per hour.\n\n307\n00:17:27.290 --> 00:17:29.030\nWe'll leave it on the default there.\n\n308\n00:17:29.030 --> 00:17:35.740\nSo by default, within this site,\nit's gonna replicate once an hour.\n\n309\n00:17:35.740 --> 00:17:40.450\nBut replication still occurs on change\nnotification, so just keep that in mind.\n\n310\n00:17:40.450 --> 00:17:45.320\nIf there's no change,\nthen the downstream neighbor is\n\n311\n00:17:45.320 --> 00:17:49.980\ngonna poll the upstream neighbor once an\nhour to see if there's been any changes.\n\n312\n00:17:49.980 --> 00:17:51.970\nOr you can bump that up\na little bit if you need to.\n\n313\n00:17:51.970 --> 00:17:56.920\nOr you can bump it up to four times a day,\nand that would take up that whole block.\n\n314\n00:17:56.920 --> 00:18:00.130\nAll right, so\nthat is intrasite replication.\n\n315\n00:18:01.140 --> 00:18:04.191\nWhen we get over to intersite replication,\nso\n\n316\n00:18:04.191 --> 00:18:09.133\nbetween my on-premise DC and the\nbridgehead server up there in the cloud.\n\n317\n00:18:09.133 --> 00:18:13.543\nRight click on that, Properties,\nand we go to Change Schedule and\n\n318\n00:18:13.543 --> 00:18:16.790\nyou see it looks a little different,\nall right?\n\n319\n00:18:17.840 --> 00:18:22.600\nHere I can see it's once every\nthree hours, and then on that hour,\n\n320\n00:18:22.600 --> 00:18:24.820\nonly once per hour, right?\n\n321\n00:18:24.820 --> 00:18:27.840\nSo you can see a lot less\nreplication is going on,\n\n322\n00:18:27.840 --> 00:18:32.750\nwhich means if I make a change right\nafter, let's say, it replicates here,\n\n323\n00:18:32.750 --> 00:18:35.720\nbetween 7 and 8,\nit replicates once, right?\n\n324\n00:18:35.720 --> 00:18:38.527\nSo say I was working on 7:05.\n\n325\n00:18:38.527 --> 00:18:40.469\nI make a change at 7:15,\n\n326\n00:18:40.469 --> 00:18:45.400\nit's not gonna replicate again until\nsometime after 10 o'clock in the morning.\n\n327\n00:18:45.400 --> 00:18:50.700\nSo it could be three plus hours there\nbefore it ends up replicating that change\n\n328\n00:18:50.700 --> 00:18:51.480\nout to the site.\n\n329\n00:18:51.480 --> 00:18:54.270\nAnd that's why we don't see\nthat NTDS connection yet.\n\n330\n00:18:54.270 --> 00:19:01.150\nBecause it's been created, it just hasn't\nreplicated over to our on-premise site.\n\n331\n00:19:01.150 --> 00:19:02.750\nAnd you're free to change this.\n\n332\n00:19:02.750 --> 00:19:04.550\nI can come in here and bump this up.\n\n333\n00:19:04.550 --> 00:19:10.540\nDepends on how many changes are occurring\non your network on a per hour basis,\n\n334\n00:19:10.540 --> 00:19:13.230\nand how important those changes are.\n\n335\n00:19:13.230 --> 00:19:15.160\n>> Now, Mike,\nif we were doing what we're doing here,\n\n336\n00:19:15.160 --> 00:19:20.150\nwe're setting up a brand new on-premises,\nwe set up brand new Azure, a site.\n\n337\n00:19:20.150 --> 00:19:21.120\nWe've connected them together.\n\n338\n00:19:21.120 --> 00:19:23.170\nAnd we want to get that\nreplication to happen faster.\n\n339\n00:19:23.170 --> 00:19:26.470\nWould it be all right for\nus to go ahead and jack that sucker up and\n\n340\n00:19:26.470 --> 00:19:29.650\nthen as we make changes and\nget everything homogenized?\n\n341\n00:19:29.650 --> 00:19:30.820\nAnd then we're done, we go back in and\n\n342\n00:19:30.820 --> 00:19:34.760\nwe reset it to something a little more-\n>> Absolutely, nothing wrong with that.\n\n343\n00:19:34.760 --> 00:19:35.730\nYou could do it one of two ways.\n\n344\n00:19:35.730 --> 00:19:36.790\nYou could do what Daniel was saying.\n\n345\n00:19:36.790 --> 00:19:38.330\nYou could change that schedule up.\n\n346\n00:19:38.330 --> 00:19:39.790\n>> Or\nyou could just trigger the replication.\n\n347\n00:19:39.790 --> 00:19:43.220\nYou could make a whole bunch of\nchanges and then replicate now, right?\n\n348\n00:19:43.220 --> 00:19:46.470\nSo to manually force it to\nreplicate outside of the schedule.\n\n349\n00:19:46.470 --> 00:19:49.080\nThen you wouldn't have to go back and\nchange the schedule.\n\n350\n00:19:49.080 --> 00:19:51.650\nBut if you're doing this all day long,\nyou might get tired of going in there and\n\n351\n00:19:51.650 --> 00:19:52.990\nforcing replication, so\n\n352\n00:19:52.990 --> 00:19:56.050\nmaybe you do just bump the schedule\nup to four times an hour.\n\n353\n00:19:56.050 --> 00:20:00.660\nEvery 15 minutes it replicates, so you're\njust sitting there making changes all day.\n\n354\n00:20:00.660 --> 00:20:04.360\nAnd then once you're done, it,\nchanges or you change the schedule back.\n\n355\n00:20:04.360 --> 00:20:06.900\nSo, either way would work just fine.\n\n356\n00:20:06.900 --> 00:20:10.200\nAll right, so\nlet's see if we can't force it.\n\n357\n00:20:10.200 --> 00:20:13.598\nLet's go ahead, and this is,\n\n358\n00:20:13.598 --> 00:20:18.320\nfrom Azure DC01, back to GNV-DC01.\n\n359\n00:20:18.320 --> 00:20:22.720\nSo, because I built the new\ndomain control in Azure, right?\n\n360\n00:20:22.720 --> 00:20:25.430\nThe two domain controllers in\nAzure have already replicated.\n\n361\n00:20:25.430 --> 00:20:26.690\nAnd, they know about that new link.\n\n362\n00:20:27.850 --> 00:20:30.530\nMy on-premises site\ndoesn't know about it yet.\n\n363\n00:20:30.530 --> 00:20:35.030\nSo, I wanna pull it from Azure,\ndown to the on-premise site.\n\n364\n00:20:35.030 --> 00:20:38.110\nSo, I'm gonna right click, replicate now.\n\n365\n00:20:38.110 --> 00:20:41.470\nAnd, it's gonna tell me oneor more\nof these Domain Service connections\n\n366\n00:20:41.470 --> 00:20:43.350\nare between Domain Controllers\nin different sites.\n\n367\n00:20:43.350 --> 00:20:45.770\nIt will attempt to replicate\nacross these connections.\n\n368\n00:20:45.770 --> 00:20:48.800\nFor more information to how to verify,\nsee Help and Support.\n\n369\n00:20:50.020 --> 00:20:52.210\nHm, that was a nice white screen there.\n\n370\n00:20:52.210 --> 00:20:55.100\nAll right, so I've done that, and\nthat can take a minute or two for\n\n371\n00:20:55.100 --> 00:20:57.530\nit really to kick in.\n\n372\n00:20:57.530 --> 00:20:58.920\nYou can find out.\n\n373\n00:20:58.920 --> 00:21:03.150\nWe can go in and see the last time\nthat it successfully replicated.\n\n374\n00:21:03.150 --> 00:21:06.590\nLet's see if we can pull\nup some properties.\n\n375\n00:21:06.590 --> 00:21:09.450\nAnd I don't know if I can\nactually see it from here.\n\n376\n00:21:09.450 --> 00:21:11.180\nIt does not look like it.\n\n377\n00:21:11.180 --> 00:21:13.640\nBut we can go into our log files.\n\n378\n00:21:13.640 --> 00:21:17.140\nAnd we can check and we can see when\nit last successfully replicated.\n\n379\n00:21:17.140 --> 00:21:21.700\nWe could pull up a command prompt and\ndo some replmon, R-E-P-L-M-O-N,\n\n380\n00:21:21.700 --> 00:21:27.330\nto monitor replication as well,\nbut since we are right here,\n\n381\n00:21:28.470 --> 00:21:31.820\nlet's see if it knows about it yet,\nand I'll refresh my console.\n\n382\n00:21:32.820 --> 00:21:33.500\nAnd there we go.\n\n383\n00:21:33.500 --> 00:21:38.600\nThere's my NTDS settings and now I can see\nthe link from Azure DC1 to Azure DC2 so\n\n384\n00:21:38.600 --> 00:21:41.490\nnow need to go check the logs\nbecause my GUI updated and\n\n385\n00:21:41.490 --> 00:21:42.840\nwe can see the information right there.\n\n386\n00:21:42.840 --> 00:21:44.880\nSo I just had to trigger that replication.\n\n387\n00:21:45.952 --> 00:21:50.130\nAll right, so we've got the topology laid\nout, we've go the replication laid out.\n\n388\n00:21:50.130 --> 00:21:55.390\nLet's make a couple of objects and\nactually see the replication occurring.\n\n389\n00:21:55.390 --> 00:21:58.570\nWell, let's go to,\nI'm gonna pull up server manager.\n\n390\n00:21:58.570 --> 00:22:03.580\nI'm still on my on-premise DC1, and I'm\ngonna go into Active Directory Users and\n\n391\n00:22:03.580 --> 00:22:08.600\nComputers, and\nI am going to do a couple of things.\n\n392\n00:22:08.600 --> 00:22:13.689\nI'm gonna make a new organizational unit,\nand I'll call it Employees.\n\n393\n00:22:16.010 --> 00:22:18.760\nAnd then within that new\norganizational unit,\n\n394\n00:22:18.760 --> 00:22:21.730\nI'm gonna make a user let's say, Daniel.\n\n395\n00:22:21.730 --> 00:22:22.970\nThe hell with that.\n\n396\n00:22:22.970 --> 00:22:25.648\nWe'll call it what's\na good fictitious name?\n\n397\n00:22:25.648 --> 00:22:29.907\nJames Kirk.\n\n398\n00:22:29.907 --> 00:22:31.480\nAll right.\n\n399\n00:22:31.480 --> 00:22:33.329\nAnd we'll call his log on jkirk.\n\n400\n00:22:35.050 --> 00:22:36.770\nAnd we'll click next.\n\n401\n00:22:36.770 --> 00:22:41.510\nWe'll set his super-secret password.\n\n402\n00:22:41.510 --> 00:22:45.230\nAnd we're never going to use this account,\nso I don't care too much about that.\n\n403\n00:22:45.230 --> 00:22:46.918\nWe'll disable it just in case.\n\n404\n00:22:46.918 --> 00:22:50.590\nNext, and finish.\n\n405\n00:22:50.590 --> 00:22:51.940\nSo now I've got a new user there.\n\n406\n00:22:51.940 --> 00:22:52.970\nThat was on GNV-DC01.\n\n407\n00:22:54.530 --> 00:22:56.790\nAll right, let's minimize that.\n\n408\n00:22:56.790 --> 00:23:03.408\nJump over to GNV-DC2, and\nit's locked me out so we'll log back in.\n\n409\n00:23:06.577 --> 00:23:09.080\nBlow that guy back out full screen.\n\n410\n00:23:09.080 --> 00:23:14.740\nOpen up some Active Directory Users and\nComputers, and\n\n411\n00:23:14.740 --> 00:23:18.730\nthere's Employees and there's\nCaptain James T Kirk already there.\n\n412\n00:23:18.730 --> 00:23:22.240\nSo that was, what, 20 seconds, maybe,\nit took me to flip over to that machine?\n\n413\n00:23:22.240 --> 00:23:25.120\n>> Mike hit the OK button,\nit was probably there waiting for him.\n\n414\n00:23:25.120 --> 00:23:27.770\nAnd that's the great thing\nabout that intrasite.\n\n415\n00:23:27.770 --> 00:23:32.050\nIt's super fast, whatever it is your\nnetwork backbone is inside your building,\n\n416\n00:23:32.050 --> 00:23:36.350\nit's going to go at that speed really and\npush it across.\n\n417\n00:23:36.350 --> 00:23:38.330\nSo that's the great thing about intrasite.\n\n418\n00:23:38.330 --> 00:23:39.840\nBut it's probably not.\n\n419\n00:23:39.840 --> 00:23:40.490\nIt might be.\n\n420\n00:23:40.490 --> 00:23:41.908\nBut it's probably not.\n\n421\n00:23:41.908 --> 00:23:44.290\n>> My guess is going to be no as well.\n\n422\n00:23:44.290 --> 00:23:45.463\nAre we betting people?\n\n423\n00:23:45.463 --> 00:23:47.308\n>> [LAUGH] Who is laying down the money?\n\n424\n00:23:47.308 --> 00:23:49.673\n>> If you guys want to bet,\nput it in the chat room right now.\n\n425\n00:23:49.673 --> 00:23:50.400\n>> That's right.\n\n426\n00:23:50.400 --> 00:23:51.998\n>> And we'll start by laying some odds.\n\n427\n00:23:51.998 --> 00:23:56.168\nAll right, so we're going to go back\nover to the Cloud and here's Azure DC01.\n\n428\n00:23:56.168 --> 00:23:58.048\nI'm going to close Sites and Services.\n\n429\n00:23:58.048 --> 00:24:02.016\nOpen up active directory users and\ncomputers, and\n\n430\n00:24:02.016 --> 00:24:07.790\nI do not see an OU called employees,\nnor do I have a user there, right?\n\n431\n00:24:07.790 --> 00:24:12.190\nBecause our schedule, let's see what time,\nthis guy thinks it's 9 o'clock, right?\n\n432\n00:24:12.190 --> 00:24:15.285\nHave to figure out what I did there-\n>> Could probably change that.\n\n433\n00:24:15.285 --> 00:24:18.400\n[LAUGH]\n>> Yeah, these guys they use UTC and\n\n434\n00:24:18.400 --> 00:24:21.270\nI don't know if I did not change that or\nnot, I must not have changed it.\n\n435\n00:24:22.880 --> 00:24:23.650\nWhat was I gonna do?\n\n436\n00:24:23.650 --> 00:24:25.380\nYeah, so\nlet's force the replication, right?\n\n437\n00:24:25.380 --> 00:24:28.100\nLet's go ahead and see if we can force it.\n\n438\n00:24:28.100 --> 00:24:30.300\nWe could wait until the next schedule.\n\n439\n00:24:30.300 --> 00:24:34.000\nBut we know that could be up to three\nhours before it actually replicates.\n\n440\n00:24:34.000 --> 00:24:35.670\nWhat if I need it up there now?\n\n441\n00:24:35.670 --> 00:24:37.440\nLet's say I've got a branch office, right,\n\n442\n00:24:37.440 --> 00:24:41.170\nand at that branch office,\nthere's no domain controller.\n\n443\n00:24:41.170 --> 00:24:44.840\nBut there is a router, a little Cisco\ndevice or something that's got a site to\n\n444\n00:24:44.840 --> 00:24:48.080\nsite connection with Azure and\nthat's their domain controller, right.\n\n445\n00:24:48.080 --> 00:24:50.880\nWhen they go to work at that\nbranch office, they log in,\n\n446\n00:24:50.880 --> 00:24:52.670\nit connects to my domain\ncontrollers out there in Azure.\n\n447\n00:24:52.670 --> 00:24:56.030\nIt's one of the reasons we set\nthis up in the first place.\n\n448\n00:24:56.030 --> 00:24:59.668\nSo, if I go create a new user account,\nI'm sitting back at the corporate office,\n\n449\n00:24:59.668 --> 00:25:02.832\nthey tell me hey, we just hired\nCaptain Kirk, he's gonna come work for\n\n450\n00:25:02.832 --> 00:25:06.086\nus out there at our branch office,\nI'm like sweet, get his autograph.\n\n451\n00:25:06.086 --> 00:25:08.806\nBut, I create a user account for\nhim, well,\n\n452\n00:25:08.806 --> 00:25:11.682\nthat user account sitting\nin there on GVDCO1.\n\n453\n00:25:11.682 --> 00:25:15.770\nHey, GVDCO2 knows about it\nalready cuz it was like that.\n\n454\n00:25:15.770 --> 00:25:17.970\nBut they're not connecting to\nthose domain controllers right,\n\n455\n00:25:17.970 --> 00:25:18.920\nhe's at the branch office.\n\n456\n00:25:18.920 --> 00:25:22.500\nHe's going across that site to\nsite tunnel up to Azure and\n\n457\n00:25:22.500 --> 00:25:25.400\nhe's logging in with those\ndomain controllers up there.\n\n458\n00:25:25.400 --> 00:25:29.040\nThey don't know about it yet,\nit could be three hours before it does.\n\n459\n00:25:29.040 --> 00:25:33.000\nSo if his first day is tomorrow,\nI don't care, I make the user account.\n\n460\n00:25:33.000 --> 00:25:36.020\nBy tomorrow it'll be replicated,\nwe should be good to go.\n\n461\n00:25:36.020 --> 00:25:38.440\nBut if he's already sitting there and\nthey just forgot to call me and\n\n462\n00:25:38.440 --> 00:25:39.810\ntell me to make the account.\n\n463\n00:25:39.810 --> 00:25:41.110\nThen now they're like hey, he's here,\n\n464\n00:25:41.110 --> 00:25:44.000\nI need him to log in,\ncan you create that account?\n\n465\n00:25:44.000 --> 00:25:45.100\nI can't wait three hours.\n\n466\n00:25:45.100 --> 00:25:48.160\n>> And Mike, this is super practical\ninformation to be honest with you because\n\n467\n00:25:48.160 --> 00:25:50.820\nthis is something I've dealt\nwith a lot as a systems admin.\n\n468\n00:25:50.820 --> 00:25:52.060\nMike is being very generous.\n\n469\n00:25:52.060 --> 00:25:54.785\n>> [LAUGH]\n>> To our workforce by saying they forgot\n\n470\n00:25:54.785 --> 00:25:59.080\nto let you know they have a new employee\nsitting there waiting to do work.\n\n471\n00:25:59.080 --> 00:26:02.435\nNow you typically hire somebody,\ntell them yeah, start on Monday, and\n\n472\n00:26:02.435 --> 00:26:05.515\nthen they call you Monday morning and\nsay, hey I need an account for\n\n473\n00:26:05.515 --> 00:26:08.540\nthis person we just hired, and\nthey're here, so get that done.\n\n474\n00:26:08.540 --> 00:26:13.908\nSo If they're looking up into our\nAzure cloud for replication from where\n\n475\n00:26:13.908 --> 00:26:20.620\nI'm creating the user account in on my\non-premise, well, that's gonna be a while.\n\n476\n00:26:20.620 --> 00:26:23.455\nNow, the good thing is,\nis we do have the ability to force, but\n\n477\n00:26:23.455 --> 00:26:25.169\nmaybe I'm testing replication, and\n\n478\n00:26:25.169 --> 00:26:28.400\nI wanna see is my schedule actually\nworking out the way I want it to work.\n\n479\n00:26:28.400 --> 00:26:32.885\nOr maybe I wanna lower it down and say,\nyou know what, I need to replicate more\n\n480\n00:26:32.885 --> 00:26:37.577\nper day because I'm not getting enough for\npeople out there and my office users,\n\n481\n00:26:37.577 --> 00:26:41.937\nmy off premises users who are trying\nto get information that's not there.\n\n482\n00:26:41.937 --> 00:26:45.806\nSo this is a good way to try to test\nthe waters and see what's working and\n\n483\n00:26:45.806 --> 00:26:46.600\nwhat's not.\n\n484\n00:26:46.600 --> 00:26:47.460\n>> Exactly.\n\n485\n00:26:47.460 --> 00:26:50.090\nNow interesting thing happened\nwhile we were talking there.\n\n486\n00:26:50.090 --> 00:26:54.730\nI refreshed my console on the Azure DC,\nand there's employees.\n\n487\n00:26:54.730 --> 00:26:57.510\nBut that's most likely because\nof the schedule, right?\n\n488\n00:26:57.510 --> 00:26:59.580\nIt just happened to be\nthat the hour changed,\n\n489\n00:26:59.580 --> 00:27:01.200\nand that might have been the third hour.\n\n490\n00:27:01.200 --> 00:27:03.570\nLet's go check the schedule and\nsee if that's what happened.\n\n491\n00:27:03.570 --> 00:27:05.240\nI'm gonna minimize that for a second.\n\n492\n00:27:05.240 --> 00:27:07.452\nTools, Active Directory Sites and\nServices.\n\n493\n00:27:10.438 --> 00:27:13.110\nWait patiently for Sites and Services.\n\n494\n00:27:13.110 --> 00:27:20.330\nAzure DC from DC02 out to Azure DC01.\n\n495\n00:27:20.330 --> 00:27:23.770\nAnd that's actually changed since\nthe last time we looked at it, hasn't it?\n\n496\n00:27:23.770 --> 00:27:25.590\nOr was that DC02 last time?\n\n497\n00:27:25.590 --> 00:27:29.760\nAnd remember the KCC can change\nthings whenever it feels like it.\n\n498\n00:27:29.760 --> 00:27:31.670\nWe really usually don't care.\n\n499\n00:27:31.670 --> 00:27:35.450\nAs you add and remove domain controllers,\nit will automatically\n\n500\n00:27:35.450 --> 00:27:39.520\nupdate the topology to make sure there's\nalways a robust two-way connection.\n\n501\n00:27:39.520 --> 00:27:42.420\nSo, these can change if you don't\nstatically create them, and\n\n502\n00:27:42.420 --> 00:27:43.850\nwe usually don't need to.\n\n503\n00:27:43.850 --> 00:27:45.310\nI'm gonna pull up the properties though,\nfor\n\n504\n00:27:45.310 --> 00:27:49.120\nthat link and\nI'm gonna check out my schedule.\n\n505\n00:27:49.120 --> 00:27:50.360\nAnd sure enough 9:00,\n\n506\n00:27:50.360 --> 00:27:55.820\nlet me zoom in right there, is one of the\nhours that it's allowed to replicate on.\n\n507\n00:27:55.820 --> 00:27:58.840\nOnce per hour, it probably does it\nright at the beginning of the hour, so\n\n508\n00:27:58.840 --> 00:28:03.310\nsince it's 9:03 it happened to replicate\nright after I made that object.\n\n509\n00:28:03.310 --> 00:28:04.860\nLet's test that the-\n>> How convenient for us?\n\n510\n00:28:04.860 --> 00:28:07.310\n>> I know right.\nIt's not what I wanted to show you,\n\n511\n00:28:07.310 --> 00:28:09.020\nbut great, but it does work, yes.\n\n512\n00:28:09.020 --> 00:28:10.320\nAll right so let's do it again.\n\n513\n00:28:10.320 --> 00:28:15.179\nLet's see what happens if I go back over\n\n514\n00:28:15.179 --> 00:28:20.331\nto my on premises DC, so back to DC01 and\n\n515\n00:28:20.331 --> 00:28:24.763\nI'm gonna make another employee.\n\n516\n00:28:24.763 --> 00:28:26.065\nI don't know if that's how he spells it.\n\n517\n00:28:26.065 --> 00:28:28.008\nIs that Jean Luc?\n\n518\n00:28:28.008 --> 00:28:28.853\n>> Jean Luc Piquard.\n\n519\n00:28:28.853 --> 00:28:32.603\n>> [LAUGH] I'm just gonna put.\n\n520\n00:28:32.603 --> 00:28:33.276\n>> Boy, having fun now.\n\n521\n00:28:33.276 --> 00:28:35.605\n>> Yeah, I know, we really,\nI'm just gonna put Spock.\n\n522\n00:28:35.605 --> 00:28:37.129\nOr I could have put McCoy,\nI guess, on there.\n\n523\n00:28:37.129 --> 00:28:38.520\n>> What's Spock's last name?\n\n524\n00:28:38.520 --> 00:28:39.880\n>> I think it's Spock.\n\n525\n00:28:39.880 --> 00:28:40.570\n>> Spock Spock.\n\n526\n00:28:40.570 --> 00:28:42.140\n>> Spock Spock.\n\n527\n00:28:42.140 --> 00:28:44.450\n>> His logon name is going to be Spock.\n\n528\n00:28:44.450 --> 00:28:47.430\nAll right.\nDid I spell Sprock.\n\n529\n00:28:48.900 --> 00:28:49.560\nS P O C K.\n\n530\n00:28:49.560 --> 00:28:51.890\nSometimes it's fun to have\nfun while you're doing stuff.\n\n531\n00:28:51.890 --> 00:28:52.800\n>> That's right.\n\n532\n00:28:52.800 --> 00:28:54.710\n>> Now this is edutainment.\n\n533\n00:28:54.710 --> 00:28:56.620\nAll right so\nwe're making another user account.\n\n534\n00:28:56.620 --> 00:28:58.870\nI'll set the password for this guy.\n\n535\n00:28:58.870 --> 00:29:00.266\nDisable it for safety's sake.\n\n536\n00:29:00.266 --> 00:29:04.460\nClick next and finish, so\nnow I've got a new user sitting there.\n\n537\n00:29:04.460 --> 00:29:05.285\nI did that on DC1.\n\n538\n00:29:05.285 --> 00:29:09.220\nWhat we saw DC2 was actually\nthe bridge head server.\n\n539\n00:29:09.220 --> 00:29:14.140\nBut as we've already seen,\nDC2 should be aware of the change\n\n540\n00:29:14.140 --> 00:29:19.020\nby the time I get to the console and\nrefresh it, and there is Spock.\n\n541\n00:29:19.020 --> 00:29:23.390\nSo now we'll flip back up to the cloud and\nwe will open up active directory users and\n\n542\n00:29:23.390 --> 00:29:26.980\ncomputers and we'll refresh,\nand it does not know about it.\n\n543\n00:29:26.980 --> 00:29:30.670\nAnd we could sit here for\nthe next 2 hours and 59 minutes and\n\n544\n00:29:30.670 --> 00:29:33.920\nI could refresh all day long and\nit's not gonna change anything, right?\n\n545\n00:29:33.920 --> 00:29:37.870\nBecause it's not due to replicate,\nit just replicated at 9:00.\n\n546\n00:29:37.870 --> 00:29:44.251\nAll right, and so the next replication\ncycle is not going to occur until\n\n547\n00:29:44.251 --> 00:29:49.440\n[INAUDIBLE]\n12:00 AM is my next schedule,\n\n548\n00:29:49.440 --> 00:29:51.470\nthree hours from now.\n\n549\n00:29:51.470 --> 00:29:53.970\nSo let's see if we can force it and\n\n550\n00:29:53.970 --> 00:29:56.700\nsay, you know what,\nI need Spock up there right now.\n\n551\n00:29:56.700 --> 00:29:59.200\nSo I'm gonna pull, now this is\nwhere you gotta be careful right.\n\n552\n00:29:59.200 --> 00:30:04.450\nThink about where the change is not\nwhere you need to get the change to.\n\n553\n00:30:04.450 --> 00:30:08.590\nI need to find the link to one of my\ndomain controller's up in the cloud\n\n554\n00:30:08.590 --> 00:30:12.250\nthat's coming from the domain\ncontroller on premises.\n\n555\n00:30:12.250 --> 00:30:14.130\nCuz that domain controller\nknows about the new user.\n\n556\n00:30:15.190 --> 00:30:22.760\nIf I was to go here and go to my link\nthat comes from Azure and force that one,\n\n557\n00:30:22.760 --> 00:30:26.270\nit's not gonna do me any good because\nAzure doesn't know about the user.\n\n558\n00:30:26.270 --> 00:30:30.480\nI can trigger replication, but there's no\nchanges that have occurred on those DC's.\n\n559\n00:30:30.480 --> 00:30:33.730\nThe change occurred on premises,\nI need to get it out to the cloud.\n\n560\n00:30:33.730 --> 00:30:39.110\nSo we're gonna find the link that comes\nfrom on premises to the cloud and\n\n561\n00:30:39.110 --> 00:30:39.958\nreplicate now.\n\n562\n00:30:39.958 --> 00:30:44.683\nWe'll click okay to our message,\nwe'll give it about five seconds or so.\n\n563\n00:30:47.144 --> 00:30:51.480\nAnd then we'll refresh my console,\nand ta-da, there's Spock.\n\n564\n00:30:51.480 --> 00:30:53.660\nSo we've proven a couple of things here.\n\n565\n00:30:53.660 --> 00:30:58.272\nTo ourselves, we have, one, verified that\nmy replication apology is set up properly\n\n566\n00:30:58.272 --> 00:31:02.780\nright, we went through verify that the KCC\nlinked all the domain controllers.\n\n567\n00:31:02.780 --> 00:31:08.920\nAt first we were worried that\nAzure DCO2 had somehow gotten left out,\n\n568\n00:31:08.920 --> 00:31:11.360\nbut once we realized that\nhe had been set up and\n\n569\n00:31:11.360 --> 00:31:13.770\nit just hadn't replicated\nback to the corporate office,\n\n570\n00:31:13.770 --> 00:31:20.140\nwe triggered replication and we saw\nthat the KCC had indeed done its job.\n\n571\n00:31:20.140 --> 00:31:22.860\nSo that's good we know\nour topology's set up.\n\n572\n00:31:22.860 --> 00:31:27.450\nWe saw that all the SRV records were\nbeing created properly in DNS so\n\n573\n00:31:27.450 --> 00:31:30.040\nthat I could find those domain\ncontrollers in the first place.\n\n574\n00:31:30.040 --> 00:31:33.210\nAnd then we actually made some new\nobjects and saw replication occur,\n\n575\n00:31:33.210 --> 00:31:37.780\nwe saw it replicate from the one on\npremise to the other on premise.\n\n576\n00:31:37.780 --> 00:31:41.520\nWe saw that actually if we didn't do\nanything and waited, the schedule would've\n\n577\n00:31:41.520 --> 00:31:45.200\neventually kick in and\nreplicate it like it did with James Kirk.\n\n578\n00:31:45.200 --> 00:31:48.990\nWe saw also that if I create one,\nit's not scheduled to replicate again for\n\n579\n00:31:48.990 --> 00:31:50.440\nanother two and a half hours.\n\n580\n00:31:50.440 --> 00:31:55.710\nWe can manually trigger that replication\nthrough active directory sites and\n\n581\n00:31:55.710 --> 00:31:57.920\nservices, and\nget that user to counter replicate.\n\n582\n00:31:57.920 --> 00:31:59.140\nSo, pretty cool stuff.\n\n583\n00:31:59.140 --> 00:32:00.280\n>> Yeah, it is great stuff.\n\n584\n00:32:00.280 --> 00:32:03.510\nAnd this is definitely, like I like\nto say, news you can use, right?\n\n585\n00:32:03.510 --> 00:32:07.520\nIt's not just something that's\nthat's a lovely practical or\n\n586\n00:32:07.520 --> 00:32:09.160\nobscure thing that you've shown us there,\nMike.\n\n587\n00:32:09.160 --> 00:32:14.510\nThis is something that you might actually\nneed to employ in your environment.\n\n588\n00:32:14.510 --> 00:32:18.000\nHey that stuff's not getting up to where\nin to my Azure site quickly enough.\n\n589\n00:32:18.000 --> 00:32:19.680\nLet me force that replication on.\n\n590\n00:32:19.680 --> 00:32:20.590\nLet me check the schedule.\n\n591\n00:32:20.590 --> 00:32:22.010\nWhen was the last time it replicated out?\n\n592\n00:32:22.010 --> 00:32:24.130\nThis is stuff that you wanna check and\n\n593\n00:32:24.130 --> 00:32:27.840\nit verifies that everything is\nworking as you expect it to.\n\n594\n00:32:27.840 --> 00:32:29.390\nMike, great stuff so far.\n\n595\n00:32:29.390 --> 00:32:32.180\nAppreciate you joining us again today.\n\n596\n00:32:32.180 --> 00:32:35.350\nIs there anything else that we need\nto cover for this particular episode?\n\n597\n00:32:35.350 --> 00:32:38.020\n>> I think we got it taken care of there\nwith the replication and the topology.\n\n598\n00:32:38.020 --> 00:32:41.130\n>> All right, well, thanks again for\njoining us, thank you guys again for\n\n599\n00:32:41.130 --> 00:32:43.780\nwatching, we're gonna go ahead and\nsign off for IT Pro TV.\n\n600\n00:32:43.780 --> 00:32:45.450\nI've been your host, Daniel Lowry.\n\n601\n00:32:45.450 --> 00:32:46.240\n>> And I'm Mike Roderick.\n\n602\n00:32:46.240 --> 00:32:48.035\n>> We'll see you next time.\n\n603\n00:32:48.035 --> 00:32:56.020\n[MUSIC]\n\n",
          "vimeoId": "155388053"
        },
        {
          "description": "In this episode, Mike and Daniel show you how to configure a multi-site gateway for connecting multiple sites to Azure. They start by explaining how to crate a modified XML file that acts as a network script to prepare Azure for connecting each additional site. They they use the PowerShell to finish connecting with Azure as the web Portal doesn't support these features fully yet.",
          "length": "2318",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-3-1-configure_a_multi_site_gateway-021516-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-3-1-configure_a_multi_site_gateway-021516-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-3-1-configure_a_multi_site_gateway-021516-1-sm.jpg",
          "title": "Configure a Multi-Site Gateway",
          "transcript": "WEBVTT\n\n1\n00:00:00.255 --> 00:00:10.255\n[MUSIC]\n\n2\n00:00:12.375 --> 00:00:17.450\nAll right, greetings everyone, and welcome\nto another great episode of ITProTV.\n\n3\n00:00:17.450 --> 00:00:20.700\nI'm your host Daniel Lowrie, and\nin today's episode, well, we're continuing\n\n4\n00:00:20.700 --> 00:00:23.940\non with that Active Directory and\nAzure series we're working on.\n\n5\n00:00:23.940 --> 00:00:27.550\nAnd joining us in the studio today is\nthe man that has been guiding that ship,\n\n6\n00:00:27.550 --> 00:00:29.700\nthat is our good friend, Mr Mike Rodrick.\n\n7\n00:00:29.700 --> 00:00:31.010\nMike, welcome back to the show, sir.\n\n8\n00:00:31.010 --> 00:00:31.890\n>> Thank you, sir.\n\n9\n00:00:31.890 --> 00:00:35.100\nI'm excited to be here, hoping I can keep\nthat ship off of the reef, you know?\n\n10\n00:00:35.100 --> 00:00:38.450\nWe don't want to hit any sand bars or\nanything like that.\n\n11\n00:00:38.450 --> 00:00:40.410\nBut, let's see what we can do today.\n\n12\n00:00:40.410 --> 00:00:42.470\nWe're gonna have a little\nbit of fun today, I hope.\n\n13\n00:00:42.470 --> 00:00:47.500\nWhat we're going to try to do is set\nup what we call a multi-site gateway.\n\n14\n00:00:47.500 --> 00:00:51.570\nAnd we've kind of talked about this a\nlittle bit as we've been going through and\n\n15\n00:00:51.570 --> 00:00:53.318\nkind of getting things set up.\n\n16\n00:00:53.318 --> 00:00:57.490\nThis is where I said we really wanted to\nget to in the end, and we've done a good\n\n17\n00:00:57.490 --> 00:01:00.640\njob so far, right, we've got everything\npretty much rocking and rolling.\n\n18\n00:01:00.640 --> 00:01:02.440\nWe've got our corporate network,\n\n19\n00:01:02.440 --> 00:01:06.890\nwe've got our site to site VPN set up\nbetween that corporate network and Azure.\n\n20\n00:01:06.890 --> 00:01:10.862\nWe've got domain controllers running up\nthere on our virtual network and Azure.\n\n21\n00:01:10.862 --> 00:01:15.942\nWe've got replication going on between\nour on premises demand controllers and\n\n22\n00:01:15.942 --> 00:01:20.793\nthe corporate network and our cloud\ndomain controllers out there in Azure,\n\n23\n00:01:20.793 --> 00:01:23.010\nso replication is going on.\n\n24\n00:01:23.010 --> 00:01:24.640\nWe're hunky dorey at that point.\n\n25\n00:01:24.640 --> 00:01:27.520\nBut, now, what do we do next?\n\n26\n00:01:27.520 --> 00:01:28.570\nWhy did we do all this?\n\n27\n00:01:28.570 --> 00:01:32.400\nWe said one of the reasons was for\ndisaster recovery.\n\n28\n00:01:32.400 --> 00:01:36.160\nBecause I wanna make sure that if my\ncorporate network DCs go down for\n\n29\n00:01:36.160 --> 00:01:38.980\nsome reason,\nmy server closet catches fire,\n\n30\n00:01:38.980 --> 00:01:42.970\nI lose all those machines, I've still got\ndomain controllers out there in the cloud.\n\n31\n00:01:42.970 --> 00:01:46.620\nAnd my network could limp along and\nstill function.\n\n32\n00:01:46.620 --> 00:01:50.390\nAnd bringing everything back online\nis not gonna be nearly as difficult\n\n33\n00:01:50.390 --> 00:01:52.370\nbecause I've still got\nActive Directory running.\n\n34\n00:01:52.370 --> 00:01:56.190\nSo it's just a matter of rebuilding\nmy machines on my corporate network,\n\n35\n00:01:56.190 --> 00:01:59.620\nallowing replication to do its thing and\nreestablishing that tunnel.\n\n36\n00:01:59.620 --> 00:02:03.140\nReplication is going to bring those new\ndomain controllers back up to speed and\n\n37\n00:02:03.140 --> 00:02:04.530\nI'm going to be back in business.\n\n38\n00:02:04.530 --> 00:02:09.118\nIt's a quick, easy, relatively inexpensive\nway to run disaster recoveries, so\n\n39\n00:02:09.118 --> 00:02:10.650\nthat's a good one.\n\n40\n00:02:10.650 --> 00:02:14.100\nBut we also talked about the support for\nbranch offices.\n\n41\n00:02:14.100 --> 00:02:17.710\nWhen we have these remote locations or\nwe start opening up\n\n42\n00:02:17.710 --> 00:02:21.550\nadditional branch offices, well there's\na need for authentication there,\n\n43\n00:02:21.550 --> 00:02:25.100\nthere's a need for group policy and\nwe need Active Directory, right.\n\n44\n00:02:25.100 --> 00:02:29.990\nWe've got users out at the branch office,\nand they're gonna have to authenticate.\n\n45\n00:02:29.990 --> 00:02:31.680\nWe're gonna have to join those\ncomputers to the domain,\n\n46\n00:02:31.680 --> 00:02:32.950\nthey've got to authenticate.\n\n47\n00:02:32.950 --> 00:02:36.010\nThey want access to main resources,\nhow do we do that?\n\n48\n00:02:36.010 --> 00:02:40.500\nWell in the past, what we would end up\ndoing is creating a site to site VPN back\n\n49\n00:02:40.500 --> 00:02:44.900\nto the corporate network, all right,\nwhich is definitely a possibility.\n\n50\n00:02:46.340 --> 00:02:50.440\nBut we kinda wanted, the solution that\nI'm leaning for is being able to open up\n\n51\n00:02:50.440 --> 00:02:56.340\nmultiple branch offices really quickly and\nwith a lack of expensive equipment.\n\n52\n00:02:56.340 --> 00:02:58.120\nThat's kind of a relative thing.\n\n53\n00:02:58.120 --> 00:03:01.580\nWe were actually talking\nabout that before the show.\n\n54\n00:03:01.580 --> 00:03:05.530\nBut using the cloud as my domain\ncontrollers for my branch office.\n\n55\n00:03:05.530 --> 00:03:09.511\nNow I don't have to worry about maybe\nputting a read only domain controller out\n\n56\n00:03:09.511 --> 00:03:13.444\nthere at that branch office and worrying\nabout having somebody manage that.\n\n57\n00:03:13.444 --> 00:03:17.589\nPaying for a license for the operating\nsystem, right, Server 2012 r2 license,\n\n58\n00:03:17.589 --> 00:03:21.480\nthe hardware, keeping that up to date,\nwhen nobody at the branch office is IT.\n\n59\n00:03:21.480 --> 00:03:26.078\nI mean, it's just some users,\nthey're very important to my organization,\n\n60\n00:03:26.078 --> 00:03:30.327\nof course, but I don't have anybody\nout there that has got the skills nor\n\n61\n00:03:30.327 --> 00:03:33.478\nanybody that I wanna give\na domain admin password to.\n\n62\n00:03:33.478 --> 00:03:36.720\nSo they can log on to that read-only\ndomain controller and configure and\n\n63\n00:03:36.720 --> 00:03:38.500\ndo updates and things like that.\n\n64\n00:03:38.500 --> 00:03:41.980\nSo that's kind of where I\nwanna go is show you what\n\n65\n00:03:41.980 --> 00:03:43.190\nother things you can do with the cloud.\n\n66\n00:03:43.190 --> 00:03:46.340\nSo this isn't, trying to think of\na better way to say that, Daniel,\n\n67\n00:03:46.340 --> 00:03:49.230\nthere's definitely other solutions,\nother ways of accomplishing this.\n\n68\n00:03:49.230 --> 00:03:53.130\nThis is just one of the myriad of ways\nthat can support a branch office and\n\n69\n00:03:53.130 --> 00:03:54.190\nI think it's pretty cool.\n\n70\n00:03:54.190 --> 00:03:55.560\n>> Yeah, it is, it is really cool.\n\n71\n00:03:55.560 --> 00:03:58.360\nI've definitely worked with\nbranch offices in the past and\n\n72\n00:03:58.360 --> 00:04:01.030\nthere's more than one way\nto skin a cat usually.\n\n73\n00:04:01.030 --> 00:04:04.760\nAnd it's always good to have all\nthose different ways under your belt,\n\n74\n00:04:04.760 --> 00:04:08.290\nhanging from your tool kit, so\nthat when that one comes up,\n\n75\n00:04:08.290 --> 00:04:10.830\nmaybe this branch office is\ndifferent from that branch office.\n\n76\n00:04:10.830 --> 00:04:15.280\nIt's never the right way across the board,\nit's usually the right way for\n\n77\n00:04:15.280 --> 00:04:17.600\nthis branch office and\nthe right way for that branch office.\n\n78\n00:04:17.600 --> 00:04:22.570\nSo this is always a good thing to have, a\nskill to have in the tool kit as it were,\n\n79\n00:04:22.570 --> 00:04:25.400\nso that when this comes up you say,\nyou know what would be perfect for that?\n\n80\n00:04:25.400 --> 00:04:28.188\nLet's do it with Azure cuz\nthat's gonna work best.\n\n81\n00:04:28.188 --> 00:04:32.970\nMaybe they're across the country and\nyour Azure site is in that zone.\n\n82\n00:04:32.970 --> 00:04:34.120\nIt's in that geographical area.\n\n83\n00:04:34.120 --> 00:04:36.270\nWell, they're gonna have a quicker\nconnection than if they were trying to\n\n84\n00:04:36.270 --> 00:04:40.200\ndial back into your corporate\noffice that's across the country or\n\n85\n00:04:40.200 --> 00:04:42.010\nacross the state or\nwherever the case it is.\n\n86\n00:04:42.010 --> 00:04:46.960\nSo this can definitely be very beneficial,\nand you don't have to get into the whole\n\n87\n00:04:48.030 --> 00:04:50.610\ninstalling VPN software\non client computers.\n\n88\n00:04:50.610 --> 00:04:52.990\nAgain, not to say that that's\nthe wrong thing to do,\n\n89\n00:04:52.990 --> 00:04:55.710\nit just might not be the right\nthing to do for certain situations.\n\n90\n00:04:55.710 --> 00:04:58.000\nSo this is what we're looking at.\n\n91\n00:04:58.000 --> 00:04:59.460\n>> Absolutely,\nyou have this great point to it.\n\n92\n00:04:59.460 --> 00:05:03.380\nAnd you mentioned having a branch office\nor a remote office in another country.\n\n93\n00:05:03.380 --> 00:05:07.620\nWell, I could have my VMs rep my\nmachines that are out there in Azure.\n\n94\n00:05:07.620 --> 00:05:10.660\nIt could be replicating between data\ncenters around the world, right?\n\n95\n00:05:10.660 --> 00:05:13.210\nWe talked about geolocation.\n\n96\n00:05:13.210 --> 00:05:16.610\nSo most definitely a faster connection\n\n97\n00:05:16.610 --> 00:05:19.610\nto those VMs than to go all the way\nback over to the corporate office.\n\n98\n00:05:19.610 --> 00:05:20.480\nSo, great point there, Dan.\n\n99\n00:05:20.480 --> 00:05:22.680\nAll right, so\nlet's take a look at what I've got here,\n\n100\n00:05:22.680 --> 00:05:26.320\njust a little drawing to kind of refresh\nour memories as to where we're at.\n\n101\n00:05:26.320 --> 00:05:28.060\nWe've got our corporate\noffice network set up.\n\n102\n00:05:28.060 --> 00:05:29.970\nWe've got Azure virtual network set up.\n\n103\n00:05:29.970 --> 00:05:31.760\nWe've got our domain controllers running.\n\n104\n00:05:31.760 --> 00:05:35.000\nIn fact, we actually have,\nlet's see how we can do this here.\n\n105\n00:05:35.000 --> 00:05:38.030\nWe've got a second domain\ncontroller up there.\n\n106\n00:05:38.030 --> 00:05:39.360\nThere he is, I didn't see him.\n\n107\n00:05:39.360 --> 00:05:40.260\nHe's down below there.\n\n108\n00:05:40.260 --> 00:05:43.090\nSo we've got two domain controllers\nout there in the cloud.\n\n109\n00:05:43.090 --> 00:05:46.810\nAnd we've got that gateway set up, and\nthat's why I'm using this to represent.\n\n110\n00:05:46.810 --> 00:05:50.620\nThat's really the gateway\nto Azure that we created.\n\n111\n00:05:50.620 --> 00:05:53.180\nThat's the VPN endpoint for\nmy Azure network.\n\n112\n00:05:53.180 --> 00:05:56.230\nAnd here I've got a little branch office.\n\n113\n00:05:56.230 --> 00:05:58.030\nAnd I've got a couple of clients and\n\n114\n00:05:58.030 --> 00:06:02.140\nI want them to be able to join the domain,\naccess domain resources.\n\n115\n00:06:02.140 --> 00:06:03.305\nSo how am I gonna do that?\n\n116\n00:06:03.305 --> 00:06:09.670\nWell, we're going to create a second\nconnection to that gateway.\n\n117\n00:06:09.670 --> 00:06:12.840\nSo basically what we're gonna do is,\nand now here's the thing,\n\n118\n00:06:12.840 --> 00:06:17.140\nI'm gonna go ahead and just copy this and\nput this over here, kind of on the edge\n\n119\n00:06:17.140 --> 00:06:21.630\nand then I'll take one of these little\nconnection points, and we'll copy that.\n\n120\n00:06:21.630 --> 00:06:26.990\nAnd we'll make this look the way\nit's going to work logically.\n\n121\n00:06:26.990 --> 00:06:29.330\nSo, we'll kinda drop that in there, and\n\n122\n00:06:29.330 --> 00:06:34.399\nwe'll do one more just to show it can\nconnect it to the inside of my network.\n\n123\n00:06:35.980 --> 00:06:40.060\nLike such and that would be,\nagain, out there in that DMZ, but\n\n124\n00:06:40.060 --> 00:06:44.500\nthis is really what we're focusing on\nright here is this multi-site gateway.\n\n125\n00:06:44.500 --> 00:06:48.160\nCan I connect more than one\nlocation up to that Azure Vnet, or\n\n126\n00:06:48.160 --> 00:06:51.410\nthat virtual network, and\nthe answer is absolutely.\n\n127\n00:06:51.410 --> 00:06:55.980\nNow this, what I just got through saying,\nyou might have a branch office and\n\n128\n00:06:55.980 --> 00:06:58.100\nyou don't have a server.\n\n129\n00:06:58.100 --> 00:07:01.130\nYou might have some little PIX firewall,\nor ASA or\n\n130\n00:07:01.130 --> 00:07:04.020\nsomething like that that's sitting there\nthat's gonna act as your VPN endpoint,\n\n131\n00:07:04.020 --> 00:07:07.550\nI'm just doing this for just something\nto throw out there on the picture.\n\n132\n00:07:07.550 --> 00:07:10.760\nI guess I could dump another\none of these down there and\n\n133\n00:07:10.760 --> 00:07:16.800\nget rid of the server altogether and\nmake it look something like that, right.\n\n134\n00:07:16.800 --> 00:07:21.510\nIn my lab however, I'm actually\nusing routing remote access, right?\n\n135\n00:07:21.510 --> 00:07:25.950\nJust because it's how I can simulate it\nand show you guys how the process works.\n\n136\n00:07:25.950 --> 00:07:30.590\nBut what we use for this VPN end point on\nour branch office doesn't matter, right?\n\n137\n00:07:30.590 --> 00:07:34.610\nWe saw the other day that we could\ndownload a script for Cisco devices,\n\n138\n00:07:34.610 --> 00:07:38.640\nJuniper devices, or the Microsoft\nrouting and remote access, so\n\n139\n00:07:38.640 --> 00:07:42.050\nit'd just be a matter of configuring\nit slightly differently, right?\n\n140\n00:07:42.050 --> 00:07:45.220\nKnowing how to configure your VPN\npoint versus this routing and\n\n141\n00:07:45.220 --> 00:07:46.720\nremote access server.\n\n142\n00:07:46.720 --> 00:07:48.830\nAll right, so\nthat's what we're going to try to do.\n\n143\n00:07:48.830 --> 00:07:51.358\nNow a couple things that\nwe need to be aware of.\n\n144\n00:07:51.358 --> 00:07:55.526\nWhen we look at this, we've been\nusing the classic portal, so far.\n\n145\n00:07:55.526 --> 00:07:59.562\nWe're gonna switch gears and In a few\nepisodes and dive into the new portal,\n\n146\n00:07:59.562 --> 00:08:02.652\nthe one that Microsoft really\nwants to guide us towards and\n\n147\n00:08:02.652 --> 00:08:04.850\nget everybody to start using.\n\n148\n00:08:04.850 --> 00:08:10.470\nThe classic portal, just my guess, but\nI would imagine disappears at some point.\n\n149\n00:08:10.470 --> 00:08:14.520\nSo what we'll take a look at\nhow to use that in the future.\n\n150\n00:08:14.520 --> 00:08:17.150\nFor right now, we're gonna,\nagain, stick with this and\n\n151\n00:08:17.150 --> 00:08:19.420\nthis is a big limitation\nof the classic portal.\n\n152\n00:08:19.420 --> 00:08:24.590\nThe classic portal wasn't designed to set\nup multiple connections to that gateway.\n\n153\n00:08:24.590 --> 00:08:28.270\nIn other words, we're really only\nallowed through the classic portal\n\n154\n00:08:28.270 --> 00:08:32.400\nto create one site to site\nVPN up there to Azure.\n\n155\n00:08:32.400 --> 00:08:37.690\nNow it can be done, but we can't use the\nGUI interface here on the classic portal,\n\n156\n00:08:37.690 --> 00:08:41.310\nwe're going to have to actually\nuse Some PowerShell to do it.\n\n157\n00:08:41.310 --> 00:08:43.080\nBut I thought hey, that would be neat,\n\n158\n00:08:43.080 --> 00:08:45.610\nbecause we haven't really looked\nat any PowerShell commands.\n\n159\n00:08:45.610 --> 00:08:48.830\nSo we can kinda look at how\nwe can use PowerShell and\n\n160\n00:08:48.830 --> 00:08:52.480\nthen you guys can take it a step\nfurther and start automating things and\n\n161\n00:08:52.480 --> 00:08:55.240\nhaving fun with PowerShell, sound good?\n\n162\n00:08:56.350 --> 00:09:00.160\nI like it, all right, so what we're gonna\ndo, the first thing we gotta do is really,\n\n163\n00:09:00.160 --> 00:09:05.831\nif we think about how we set all of this\nup, we had to define our local network.\n\n164\n00:09:05.831 --> 00:09:07.975\nAll right.\nNow, we could go in here and\n\n165\n00:09:07.975 --> 00:09:10.710\ndo the local network this way.\n\n166\n00:09:10.710 --> 00:09:12.090\nI just clicked on new.\n\n167\n00:09:12.090 --> 00:09:13.150\nNetwork.\n\n168\n00:09:13.150 --> 00:09:14.460\nVirtual network.\n\n169\n00:09:14.460 --> 00:09:16.270\nAnd I could click add local network.\n\n170\n00:09:16.270 --> 00:09:18.970\nAnd I could give it details\nabout that branch office.\n\n171\n00:09:18.970 --> 00:09:19.480\nRight.\n\n172\n00:09:19.480 --> 00:09:21.220\nWhat the subnet address was.\n\n173\n00:09:21.220 --> 00:09:26.290\nAnd what the public facing IP\naddress is on that VPNM point.\n\n174\n00:09:26.290 --> 00:09:30.480\nGive it that information here,\nand it would show up in my list.\n\n175\n00:09:30.480 --> 00:09:34.960\nBut when we went to go to Configure,\nwhat's gonna happen is this little drop\n\n176\n00:09:34.960 --> 00:09:40.940\ndown list for site to site connectivity\nwould now allow me to choose both.\n\n177\n00:09:40.940 --> 00:09:42.900\nIt's gonna be one or the other.\n\n178\n00:09:42.900 --> 00:09:46.460\nAnd that's when I say the classic\nportal wasn't set up to allow multiple\n\n179\n00:09:46.460 --> 00:09:52.660\nconnections or to configure multiple\nconnections out there to Azure.\n\n180\n00:09:52.660 --> 00:09:53.430\nAll right?\n\n181\n00:09:53.430 --> 00:09:56.830\nSo what we're gonna do is, like I said,\nwe're gonna use PowerShell.\n\n182\n00:09:56.830 --> 00:10:00.160\nAnd we do this, I'm gonna flip\nback out to my Azure subnet.\n\n183\n00:10:01.708 --> 00:10:07.120\nAnd the way we're gonna do is write\na script, or we're gonna tweak a script.\n\n184\n00:10:07.120 --> 00:10:10.520\nWell, let me take that back,\nwe're gonna tweak an XML file.\n\n185\n00:10:10.520 --> 00:10:14.480\nSo what I wanna do is click\nExport here on my Azure subnet.\n\n186\n00:10:14.480 --> 00:10:17.950\nThere's a couple of different screens you\ncan actually get to that Export from,\n\n187\n00:10:17.950 --> 00:10:19.200\nit all does the same thing.\n\n188\n00:10:19.200 --> 00:10:24.006\nExport network configuration,\nI tell it what subscription I have, and\n\n189\n00:10:24.006 --> 00:10:26.132\nI clicked a little check mark and\n\n190\n00:10:26.132 --> 00:10:30.409\nit's going to begin the download\nof this network config.xml.\n\n191\n00:10:30.409 --> 00:10:32.300\nI'm gonna go ahead and save that.\n\n192\n00:10:32.300 --> 00:10:33.740\nAnd then, I'm gonna open it up.\n\n193\n00:10:33.740 --> 00:10:38.400\nNow I'm just using Notepad, you could use\nwhatever you want to edit your XML file,\n\n194\n00:10:38.400 --> 00:10:41.900\nand this is my network\nconfiguration straight from Azure.\n\n195\n00:10:41.900 --> 00:10:44.810\nWe'll see stuff in here that's\ngonna look recognizable.\n\n196\n00:10:44.810 --> 00:10:49.790\nThere's those DnsServers that we\nregistered many, many episodes ago.\n\n197\n00:10:49.790 --> 00:10:54.160\nThere's the current local\nsite that we have configured.\n\n198\n00:10:54.160 --> 00:10:58.300\nNotice it's inside a tag called\nLocalNetworkSites plural.\n\n199\n00:10:58.300 --> 00:11:01.300\nThere's the ending tag for\nLocalNetworkSites, and\n\n200\n00:11:01.300 --> 00:11:05.340\nthen there's one local network site,\nsingular, named ITProTV LAN.\n\n201\n00:11:05.340 --> 00:11:08.620\nAnd it defines the prefix, right, for\n\n202\n00:11:08.620 --> 00:11:13.480\nthat particular local network,\nas well as the VPN gateway address.\n\n203\n00:11:13.480 --> 00:11:16.030\nAnd if we scroll down\na little bit further,\n\n204\n00:11:16.030 --> 00:11:21.392\nwe'll see my virtual network information,\nthe 10.1.2.0 network,\n\n205\n00:11:21.392 --> 00:11:28.240\nthat gateway subnet that it created\nright with that 29-bit subnet mask.\n\n206\n00:11:28.240 --> 00:11:30.170\nThere's my DNS server references for\n\n207\n00:11:30.170 --> 00:11:33.920\nthat gateway and then below that\nconnections to local network.\n\n208\n00:11:33.920 --> 00:11:36.890\nAnd there is where you see\nit's got that IP sec tunnel.\n\n209\n00:11:36.890 --> 00:11:40.730\nThat site to site\nconnectivity that we set up.\n\n210\n00:11:40.730 --> 00:11:44.070\nSo all I'm going to do is I'm\ngoing to modify this file.\n\n211\n00:11:44.070 --> 00:11:46.970\nSince we can't do it through the GUI,\nwe use this.\n\n212\n00:11:46.970 --> 00:11:47.880\nSo here's how you do it.\n\n213\n00:11:47.880 --> 00:11:52.200\nI am gonna copy the entire tag for\nlocal network site.\n\n214\n00:11:52.200 --> 00:11:56.465\nLet's do a little Control-C here,\n\n215\n00:11:56.465 --> 00:12:01.760\nand then I'm going to hit Enter and do a\nlittle Control-V and paste that in there.\n\n216\n00:12:01.760 --> 00:12:05.340\nSo I basically duplicated that tag for\nlocal network site.\n\n217\n00:12:05.340 --> 00:12:09.760\nAnd then we're gonna tweak\nthe information, I'm gonna change this and\n\n218\n00:12:09.760 --> 00:12:15.515\nlet's say this is my,\nwhere do we want an office today Daniel?\n\n219\n00:12:15.515 --> 00:12:17.130\n[CROSSTALK]\n>> Somewhere exotic.\n\n220\n00:12:17.130 --> 00:12:20.500\nAre we going to a lands that\nare unspeakable and have.\n\n221\n00:12:20.500 --> 00:12:22.913\n>> Yeah.\nInteresting people and languages.\n\n222\n00:12:22.913 --> 00:12:24.821\n[LAUGH] Let's go with Micronesia.\n\n223\n00:12:24.821 --> 00:12:28.795\n>> Micronesia, how do I spell that?\n\n224\n00:12:28.795 --> 00:12:29.772\n[LAUGH]\n>> You asked for it Mike.\n\n225\n00:12:29.772 --> 00:12:31.820\n>> [LAUGH] I want Tokyo.\n\n226\n00:12:31.820 --> 00:12:34.050\nThat's what I get for asking, right?\n\n227\n00:12:34.050 --> 00:12:37.350\nWe're gonna do my Tokyo LAN here, and\n\n228\n00:12:37.350 --> 00:12:40.860\nthen we are going to change\nthe address prefix, right?\n\n229\n00:12:40.860 --> 00:12:46.248\nBecause on that Tokyo LAN,\nwe're using a 10.1.3.0/24.\n\n230\n00:12:46.248 --> 00:12:50.960\nAnd the gateway for this guy is\ngonna be just slightly different.\n\n231\n00:12:50.960 --> 00:12:55.210\nThis is the other publis of\nthe public interface on my\n\n232\n00:12:55.210 --> 00:12:59.550\nVPN endpoint device out there on\nthat Tokyo subnet or that Tokyo LAN.\n\n233\n00:12:59.550 --> 00:13:00.930\nAll right, so, I told about it.\n\n234\n00:13:00.930 --> 00:13:04.040\nAnd again, we could have done that\nthrough the little plus sign back there\n\n235\n00:13:04.040 --> 00:13:06.920\nin the GUI where I just\nadd a new local network.\n\n236\n00:13:06.920 --> 00:13:07.540\nThat would've worked.\n\n237\n00:13:07.540 --> 00:13:10.270\nBut I figured since we're\nmodifying the script to do this,\n\n238\n00:13:10.270 --> 00:13:11.990\nwe might as well do both here.\n\n239\n00:13:11.990 --> 00:13:15.360\nBecause this part you\ncan't do through the GUI.\n\n240\n00:13:15.360 --> 00:13:18.000\nThis is the local network site ref for\nthe gateway.\n\n241\n00:13:18.000 --> 00:13:21.070\nNotice it's inside a gateway tag, right.\n\n242\n00:13:21.070 --> 00:13:22.470\nThere's the start and the end.\n\n243\n00:13:22.470 --> 00:13:26.740\nAnd then it's inside connections\nto a local network, right?\n\n244\n00:13:26.740 --> 00:13:30.620\nAnd then it references the local\nnetwork sites that we have created.\n\n245\n00:13:30.620 --> 00:13:34.910\nSo I'm gonna copy this and\npaste another one in there.\n\n246\n00:13:34.910 --> 00:13:41.330\nAnd we're going to change\nthat to Tokyo LAN.\n\n247\n00:13:43.040 --> 00:13:44.490\nSounds like a theme park or something.\n\n248\n00:13:44.490 --> 00:13:46.790\nWe'll change that to Tokyo LAN, and\n\n249\n00:13:46.790 --> 00:13:52.200\nthat's really all I gotta do is change\nthe name, cuz that is now gonna reference\n\n250\n00:13:52.200 --> 00:13:56.980\nthe local area network at this local\nsite name that we create up here.\n\n251\n00:13:56.980 --> 00:13:58.130\nAnd that's it.\n\n252\n00:13:58.130 --> 00:14:00.958\nThat's all I have to do.\n\n253\n00:14:00.958 --> 00:14:05.610\nSee, make sure I say that correctly,\nthere's nothing else to modify in there.\n\n254\n00:14:05.610 --> 00:14:06.410\nWe are good to go.\n\n255\n00:14:06.410 --> 00:14:10.600\nSo I'm just gonna save this\nfile to a file save, and\n\n256\n00:14:10.600 --> 00:14:13.130\nthen I'll close that config file.\n\n257\n00:14:13.130 --> 00:14:18.630\nNow, how do I get that\ninformation back up to Azure?\n\n258\n00:14:18.630 --> 00:14:22.568\nWell, we go to new, network service,\n\n259\n00:14:22.568 --> 00:14:28.210\nvirtual network, import configuration.\n\n260\n00:14:28.210 --> 00:14:32.240\nAnd I'm going to browse and find that\nconfig file that we just created or\n\n261\n00:14:32.240 --> 00:14:32.850\nmodified.\n\n262\n00:14:32.850 --> 00:14:33.945\nAnd that's the one right there.\n\n263\n00:14:33.945 --> 00:14:36.700\nMake sure that is 3:50 PM, last modified.\n\n264\n00:14:36.700 --> 00:14:38.700\nYep, that is the one.\n\n265\n00:14:38.700 --> 00:14:41.500\nI'll select it, and\nthen it's gonna read it.\n\n266\n00:14:41.500 --> 00:14:43.910\nIt will tell you right here\nif there are any errors.\n\n267\n00:14:43.910 --> 00:14:45.980\nA couple of things that it's looking for,\none,\n\n268\n00:14:45.980 --> 00:14:49.230\nif you messed up any of the XML tags,\nit's gonna let you know.\n\n269\n00:14:49.230 --> 00:14:53.760\nTwo, if any of your local\nnetworks use overlapping ranges,\n\n270\n00:14:53.760 --> 00:14:57.030\nit will stop you in your\ntracks right here, all right?\n\n271\n00:14:57.030 --> 00:15:00.210\nBecause if you have any\noverlapping address ranges,\n\n272\n00:15:00.210 --> 00:15:02.550\nAzure is not gonna be able to\ntell the difference, right?\n\n273\n00:15:02.550 --> 00:15:06.490\nIf you've got two different local area\nnetworks that you've defined, but\n\n274\n00:15:06.490 --> 00:15:11.048\nthey're both on the 10.1.3.0/24,\nand I got a packet that's going to\n\n275\n00:15:11.048 --> 00:15:15.720\n10.1.3.25, which gateway do I go out,\nright?\n\n276\n00:15:15.720 --> 00:15:16.890\nThere's no way to tell.\n\n277\n00:15:16.890 --> 00:15:20.640\nSo if you have any overlapping, if you\nmistakenly type that subnet mask, or\n\n278\n00:15:20.640 --> 00:15:25.260\nthat pre text,\nit will warn you right here.\n\n279\n00:15:25.260 --> 00:15:26.260\nWe'll go ahead and click next.\n\n280\n00:15:27.400 --> 00:15:28.580\nAnd here you can see what it's gonna do.\n\n281\n00:15:28.580 --> 00:15:30.810\nIt's not gonna modify that existing LAN.\n\n282\n00:15:30.810 --> 00:15:33.240\nIt's gonna create my new Tokyo LAN.\n\n283\n00:15:33.240 --> 00:15:37.130\nIt's not changing anything as far\nas my DNS server registrations.\n\n284\n00:15:37.130 --> 00:15:39.530\nAnd it's updating the Azure subnet.\n\n285\n00:15:39.530 --> 00:15:41.520\nSo I mean, really slick interface here.\n\n286\n00:15:41.520 --> 00:15:45.270\nAnd this is, not just for this,\nany changes that you're making.\n\n287\n00:15:45.270 --> 00:15:49.734\nWhether you can go through the GUI or not,\nif you feel more comfortable with XML and\n\n288\n00:15:49.734 --> 00:15:51.690\nPowerShell, this is how you do it.\n\n289\n00:15:51.690 --> 00:15:53.798\nWe'll click on that checkmark, and\n\n290\n00:15:53.798 --> 00:15:57.542\nnow it's gonna start importing\nmy network configuration file.\n\n291\n00:15:57.542 --> 00:16:00.722\nAnd it won't take you too\nlong to create all that, and\n\n292\n00:16:00.722 --> 00:16:03.346\nthen we'll See what we've accomplished.\n\n293\n00:16:03.346 --> 00:16:08.040\nNow, while it's doing that, I'm gonna go\nahead, we're gonna do some multitasking.\n\n294\n00:16:08.040 --> 00:16:10.620\nWell, yeah we'll do a little\nbit of multitasking here.\n\n295\n00:16:10.620 --> 00:16:16.450\nI'm gonna pull up my Birmingham router and\nI've saved us the trouble,\n\n296\n00:16:16.450 --> 00:16:20.510\nI've gone ahead and set up routing or\nremote access on this server.\n\n297\n00:16:20.510 --> 00:16:28.050\nSo if I go to tools, And then routing and\nroad access everything is set up, right?\n\n298\n00:16:28.050 --> 00:16:33.030\nAs far as the routing goes, as far as\nrunning network address translation I also\n\n299\n00:16:33.030 --> 00:16:38.310\nhave a client on this network,\nBirmingham, and I was playing around\n\n300\n00:16:38.310 --> 00:16:42.610\nearlier I actually called him Birmingham\nWe're getting a little exotic on you and\n\n301\n00:16:42.610 --> 00:16:46.140\ncalling it Tokyo now so my names\naren't gonna line up, but that's okay.\n\n302\n00:16:46.140 --> 00:16:47.720\nI'll go ahead and full screen this guy.\n\n303\n00:16:49.330 --> 00:16:53.980\nSo this again is my little Windows\n10 box that's sitting out there\n\n304\n00:16:53.980 --> 00:16:55.330\non that Tokyo LAN.\n\n305\n00:16:55.330 --> 00:16:57.930\nAnd they wanna be able to\naccess the domain resources,\n\n306\n00:16:57.930 --> 00:16:59.750\nthey want to be able to join the domain.\n\n307\n00:16:59.750 --> 00:17:05.930\nWell at this point if I do a ping 8.8.8.8,\nyou know I have internet access.\n\n308\n00:17:05.930 --> 00:17:08.190\nRight?\nBecause that router is doing its job and\n\n309\n00:17:08.190 --> 00:17:11.400\nits network address translation.\n\n310\n00:17:11.400 --> 00:17:12.940\nBut if I had tried a ping 10.1.2.4,\n\n311\n00:17:12.940 --> 00:17:18.190\nwhich is the domain controller out there\nin Azure, I'm not gonna get anything.\n\n312\n00:17:18.190 --> 00:17:18.980\nRight?\n\n313\n00:17:18.980 --> 00:17:20.170\nIt's not gonna go anywhere.\n\n314\n00:17:20.170 --> 00:17:22.710\nSo nothing happens there.\n\n315\n00:17:22.710 --> 00:17:24.880\nSo that is what we're going to fix.\n\n316\n00:17:26.500 --> 00:17:28.580\nSo let's go back over here and\nsee how it looks.\n\n317\n00:17:28.580 --> 00:17:30.990\nIt looks like my task has completed,\n\n318\n00:17:30.990 --> 00:17:33.530\nsuccessfully imported\nthe network configuration file.\n\n319\n00:17:33.530 --> 00:17:35.410\nLet's see what changes it made.\n\n320\n00:17:35.410 --> 00:17:38.690\nIf we go to local networks now,\nI now have two networks.\n\n321\n00:17:38.690 --> 00:17:41.710\nI've got the ITPro.TV LAN,\nthat was our corporate office, and\n\n322\n00:17:41.710 --> 00:17:47.000\nI have my Tokyo LAN which\nis the 10.1.3.0/24 And\n\n323\n00:17:47.000 --> 00:17:52.450\nit knows about the VPN Gateway address,\nthat was all from that XML file.\n\n324\n00:17:52.450 --> 00:17:58.550\nIf I go to Virtual Networks, and\nI go to Azure subnet, we're gonna\n\n325\n00:17:58.550 --> 00:18:02.240\nsee that I do have now this connection\nto Tokyo LAN, it's not connected yet.\n\n326\n00:18:02.240 --> 00:18:05.720\nWe haven't set up the other end\nof the VPN connection at Tokyo.\n\n327\n00:18:05.720 --> 00:18:07.360\nBut it does know about it, right.\n\n328\n00:18:07.360 --> 00:18:10.150\nSo that's a good sign,\nwe can see it there.\n\n329\n00:18:10.150 --> 00:18:16.760\nIf we go to CONFIGURE,\nYou're gonna see an interesting message.\n\n330\n00:18:16.760 --> 00:18:18.530\nI don't think that was on\nthe first screen, was it?\n\n331\n00:18:18.530 --> 00:18:19.490\nLet's make sure.\n\n332\n00:18:19.490 --> 00:18:20.900\nYeah, it was there too.\n\n333\n00:18:20.900 --> 00:18:24.320\nLet's take a look at this message real\nquick, cuz this is important stuff.\n\n334\n00:18:24.320 --> 00:18:29.240\nThe virtual network is configured to\nconnect to more than one Local network.\n\n335\n00:18:29.240 --> 00:18:34.220\nSome changes will not be allowed\nthrough the management portal.\n\n336\n00:18:34.220 --> 00:18:36.090\nUse the Windows power shell commandments,\nor\n\n337\n00:18:36.090 --> 00:18:40.200\nthe rest API,\nto modify this virtual network instead.\n\n338\n00:18:40.200 --> 00:18:43.630\nOnce you make changes that aren't\nsupported in the GUI, Well then I can't\n\n339\n00:18:43.630 --> 00:18:48.360\nvery well manage those changes or\nthose configurations through the GUI, so\n\n340\n00:18:48.360 --> 00:18:51.630\nthere are some things that are just not\ngoing to work anymore through the GUI.\n\n341\n00:18:51.630 --> 00:18:56.320\nI can still do other things,\nlike well I'll show you an example here.\n\n342\n00:18:56.320 --> 00:18:57.820\nIf I go over to configure,\n\n343\n00:18:57.820 --> 00:19:02.050\nsame warning, notice I can't change\nmy site to site connectivity now.\n\n344\n00:19:02.050 --> 00:19:02.790\nThat's grayed out.\n\n345\n00:19:02.790 --> 00:19:06.150\nIt's selected, it's grayed out, and\nI can hit this drop down list, and\n\n346\n00:19:06.150 --> 00:19:07.790\nit just says multiple again.\n\n347\n00:19:07.790 --> 00:19:11.710\nAll because when this interface was\ndeveloped, there was no support for\n\n348\n00:19:11.710 --> 00:19:13.390\nmultiple connections into that gateway.\n\n349\n00:19:13.390 --> 00:19:14.840\nAll right, Azure was new.\n\n350\n00:19:14.840 --> 00:19:17.410\nWe really just had that\none site to site VPN.\n\n351\n00:19:17.410 --> 00:19:20.350\nThe idea always was you'd run some\nvirtual machines up there that\n\n352\n00:19:20.350 --> 00:19:21.660\nwere part of your local network.\n\n353\n00:19:21.660 --> 00:19:26.300\nWell, obviously Azure has grown and what\nwe can do with it so this portal really\n\n354\n00:19:26.300 --> 00:19:30.660\ndoesn't cut the mustard anymore, if you\nwill, that's why the new portal is out.\n\n355\n00:19:30.660 --> 00:19:32.640\nSo just something that you\nguys have to keep in mind.\n\n356\n00:19:32.640 --> 00:19:35.460\n>> Yeah, Mike.\nI always get the question of why do you\n\n357\n00:19:35.460 --> 00:19:36.650\nuse the command line so often?\n\n358\n00:19:36.650 --> 00:19:38.000\nWhy are you in PowerShell?\n\n359\n00:19:38.000 --> 00:19:40.520\nWhy are you in the command prompt?\n\n360\n00:19:40.520 --> 00:19:43.110\nWell because it's good to\nknow these things because of\n\n361\n00:19:43.110 --> 00:19:44.820\nexactly what we're showing you right here.\n\n362\n00:19:44.820 --> 00:19:49.560\nYou need to be proficient in those tools\nbecause they're part of our job and\n\n363\n00:19:49.560 --> 00:19:53.200\nif something ever comes up where the\ngraphical interface doesn't support it,\n\n364\n00:19:53.200 --> 00:19:54.300\nwhat are you gonna do?\n\n365\n00:19:54.300 --> 00:19:57.350\nYou're either gonna be going,\nthe big shoulder shrug and\n\n366\n00:19:57.350 --> 00:19:58.810\nthe boss looking at you going,\nwhat's your problem?\n\n367\n00:19:58.810 --> 00:20:00.580\nI'm paying you a lot of money to do this.\n\n368\n00:20:00.580 --> 00:20:03.120\nOr you can say, hey, you know what?\n\n369\n00:20:03.120 --> 00:20:04.250\nThat's not a problem.\n\n370\n00:20:04.250 --> 00:20:05.220\nI know PowerShell.\n\n371\n00:20:05.220 --> 00:20:06.940\nI know command line interface structure.\n\n372\n00:20:06.940 --> 00:20:07.950\nI can jump in there and\n\n373\n00:20:07.950 --> 00:20:11.310\nmake it happen with there because they\ndo put a lot of support in there.\n\n374\n00:20:11.310 --> 00:20:14.870\nI remember when we were installing\nthe PowerShell modules for Azure,\n\n375\n00:20:14.870 --> 00:20:20.240\nthere were a ton of additions\nto PowerShell through there.\n\n376\n00:20:20.240 --> 00:20:21.950\nThat's not just there for fun and games.\n\n377\n00:20:21.950 --> 00:20:23.865\nThey didn't develop that stuff for\nthe heck of it.\n\n378\n00:20:23.865 --> 00:20:25.070\n>> [LAUGH]\n>> They put it in there to\n\n379\n00:20:25.070 --> 00:20:28.420\ngive you expanded capabilities\nwith your environment.\n\n380\n00:20:28.420 --> 00:20:31.120\nSo don't be afraid to learn these things.\n\n381\n00:20:31.120 --> 00:20:33.150\nAs your job, it's not like\nyou've got to go through every,\n\n382\n00:20:33.150 --> 00:20:37.690\nthe whole laundry list of Azure\ncapabilities inside of PowerShell.\n\n383\n00:20:37.690 --> 00:20:39.520\nBut as you do your job,\nyou're gonna pick up stuff.\n\n384\n00:20:39.520 --> 00:20:40.850\nYou're gonna learn new stuff.\n\n385\n00:20:40.850 --> 00:20:45.080\nAnd that's what's gonna help you be better\nas an admin in this type of environment.\n\n386\n00:20:45.080 --> 00:20:46.515\n>> Exactly right, Daniel.\n\n387\n00:20:46.515 --> 00:20:48.540\nAlright, there was one more\nthing I wanna show you.\n\n388\n00:20:48.540 --> 00:20:50.960\nHold on one second before\nwe pull up my screen here.\n\n389\n00:20:53.180 --> 00:20:54.390\nYes, okay.\n\n390\n00:20:54.390 --> 00:20:57.510\nSo what I want to do now let's\ngo back over to my screen.\n\n391\n00:20:57.510 --> 00:21:01.330\nAgain, Tokyo LAN is disconnected but\nnow we to set up the gateway or\n\n392\n00:21:01.330 --> 00:21:06.040\nI should say the VPN endpoint at the Tokyo\noffice to connect as you're ready and\n\n393\n00:21:06.040 --> 00:21:10.260\nwaiting, it says all right I'm gonna\nhave multiple connections now coming in,\n\n394\n00:21:10.260 --> 00:21:12.730\nmultiple sites connected up here to Azure.\n\n395\n00:21:12.730 --> 00:21:14.850\nSo on the Azure end, we're good to go.\n\n396\n00:21:14.850 --> 00:21:16.260\nWe've told it what we need.\n\n397\n00:21:16.260 --> 00:21:20.390\nWe need to set up the VPN\nendpoint in the Tokyo office.\n\n398\n00:21:20.390 --> 00:21:21.570\nBut how did we do that last time?\n\n399\n00:21:21.570 --> 00:21:23.880\nRemember, we could have done it manually.\n\n400\n00:21:23.880 --> 00:21:28.370\nWe just went in to routing remote access,\ncreated a new Demand dial interface.\n\n401\n00:21:28.370 --> 00:21:29.790\nPut the appropriate information in there.\n\n402\n00:21:29.790 --> 00:21:33.770\nOr we could use that script that\nwe generated from Microsoft.\n\n403\n00:21:33.770 --> 00:21:35.360\nWe can still do it manually.\n\n404\n00:21:35.360 --> 00:21:39.920\nI wanna show you the script because\nif you try to use the script,\n\n405\n00:21:39.920 --> 00:21:42.490\nit could end up goofing yourself up and\nI'll show you why.\n\n406\n00:21:42.490 --> 00:21:45.300\nI'm gonna choose download\nVPN device script.\n\n407\n00:21:45.300 --> 00:21:49.560\nI'm gonna tell it that I need this script\nfrom Microsoft routing remote access\n\n408\n00:21:49.560 --> 00:21:52.650\n2012 R2 and I'm gonna go ahead and\ndownload that.\n\n409\n00:21:54.100 --> 00:21:58.430\nAll right, I'm gonna go ahead and\nsave that VPN device script and\n\n410\n00:21:58.430 --> 00:21:59.370\nwe can close that.\n\n411\n00:21:59.370 --> 00:22:01.390\nAnd we'll go take a peak\nat it in a second.\n\n412\n00:22:01.390 --> 00:22:03.650\nThe other thing I needed was the key.\n\n413\n00:22:03.650 --> 00:22:06.080\nAnd this is another one that\ncan end up goofing you up.\n\n414\n00:22:06.080 --> 00:22:08.150\nAnd this is really kinda\nreally the same thing.\n\n415\n00:22:08.150 --> 00:22:09.680\nIn fact let's go look here.\n\n416\n00:22:09.680 --> 00:22:15.270\nIf we take a peak at that\nscript Go into downloads and\n\n417\n00:22:15.270 --> 00:22:19.440\nthere is my VPN device script.\n\n418\n00:22:19.440 --> 00:22:21.300\nTake a look at this.\n\n419\n00:22:21.300 --> 00:22:22.330\nRight?\nWe've seen this before,\n\n420\n00:22:22.330 --> 00:22:26.510\nthis is what we use to configure our first\nVPN server in our corporate network and\n\n421\n00:22:26.510 --> 00:22:31.310\nsolves the role, sets up that site to\nsite VPN But this part right here,\n\n422\n00:22:31.310 --> 00:22:33.946\nadd and configure these\nsite to site VPN interface.\n\n423\n00:22:33.946 --> 00:22:39.490\nIt's still like AEV2 P share key only,\nbut if I scroll over\n\n424\n00:22:42.820 --> 00:22:50.580\nand we look here, it's got this\npre-share key which is important.\n\n425\n00:22:50.580 --> 00:22:57.040\nBut, the problem is, each side to\nside VPN gives a different key.\n\n426\n00:22:57.040 --> 00:23:00.150\nAnd so\nyou take the script to the Tokyo office,\n\n427\n00:23:00.150 --> 00:23:03.630\nit work just fine when you setup\nthe one in, in the corporate office.\n\n428\n00:23:03.630 --> 00:23:06.990\nYou email this out there with\nthe guys in Tokyo, they run it and\n\n429\n00:23:06.990 --> 00:23:08.890\nthey're gonna get an authentication error.\n\n430\n00:23:08.890 --> 00:23:13.590\nIt's gonna tell them that the IKE VPN\ntunnel found the other endpoint,\n\n431\n00:23:13.590 --> 00:23:17.610\nattempted to connect, but it was refused\nbecause of authentication issues,\n\n432\n00:23:17.610 --> 00:23:21.100\nbecause the pre-shared key is\nwhat it's using to authenticate.\n\n433\n00:23:21.100 --> 00:23:24.090\nAnd so if you didn't know to look for\nthis I'm telling you.\n\n434\n00:23:24.090 --> 00:23:25.740\nYou bang your head against the desk for\n\n435\n00:23:25.740 --> 00:23:27.440\nhours trying to figure\nout what's going on.\n\n436\n00:23:27.440 --> 00:23:31.710\nNowhere in here did they tell us that hey,\nwe're gonna generate a separate key for\n\n437\n00:23:31.710 --> 00:23:34.660\neach tunnel, or\na separate pre-shared key for each tunnel.\n\n438\n00:23:34.660 --> 00:23:35.690\nSo that's what I need.\n\n439\n00:23:35.690 --> 00:23:36.900\nI need to modify that.\n\n440\n00:23:36.900 --> 00:23:38.410\nSo what I'm gonna do.\n\n441\n00:23:38.410 --> 00:23:42.960\nI'm going to close that script there,\nI need to obtain the key for\n\n442\n00:23:42.960 --> 00:23:44.670\nthat second tunnel.\n\n443\n00:23:44.670 --> 00:23:47.550\nAnd since I can't do it through the GUI,\n\n444\n00:23:47.550 --> 00:23:53.163\nbecause it only supports one connection\nwe're going to be using PowerShell.\n\n445\n00:23:53.163 --> 00:23:57.041\nSo let me make sure I'm on my\nright little box here, and I am.\n\n446\n00:23:57.041 --> 00:24:00.115\nAnd we're going to launch PowerShell.\n\n447\n00:24:00.115 --> 00:24:02.356\nAnd I need that good old\nAdministrative PowerShell.\n\n448\n00:24:02.356 --> 00:24:07.920\nI'm gonna right click on there,\nRun as Administrator, all right.\n\n449\n00:24:09.140 --> 00:24:10.920\nAnd remember we have already loaded up,\n\n450\n00:24:10.920 --> 00:24:14.610\nway back in a previous episode, we loaded\nup all the PowerShell commandlets.\n\n451\n00:24:14.610 --> 00:24:18.170\nI showed you guys how to\ndownload those and import those.\n\n452\n00:24:18.170 --> 00:24:20.615\nSo let's just double\ncheck a couple of things.\n\n453\n00:24:20.615 --> 00:24:27.020\nGet-ExecutionPolicy, should be set to\nremote signed, and we're good to go there.\n\n454\n00:24:27.020 --> 00:24:32.620\nThe other one I'm going to need,\nlet's just take a git-module\n\n455\n00:24:32.620 --> 00:24:37.820\n-listAvailable, give it just a second\n\n456\n00:24:37.820 --> 00:24:42.170\nto cycle through all of that, and there\nI can see all of those Azure modules,\n\n457\n00:24:42.170 --> 00:24:44.930\nwhich means I'll be able\nto use my Azure commands.\n\n458\n00:24:44.930 --> 00:24:48.220\nRemember, we also ran that little file.\n\n459\n00:24:48.220 --> 00:24:50.730\nWe downloaded some\ninformation to our machine,\n\n460\n00:24:50.730 --> 00:24:52.800\nPowerShell configuration information.\n\n461\n00:24:52.800 --> 00:24:58.225\nSo, PowerShell knows how to reach\nout to my Azure subscription.\n\n462\n00:24:58.225 --> 00:25:01.185\nRight, you need to do that for yours so\nthat it knows how to reach out and\n\n463\n00:25:01.185 --> 00:25:03.355\ntalk to Azure with your subscription,\n\n464\n00:25:03.355 --> 00:25:07.655\nyour authentication information, your\npassword, to get into your subscription.\n\n465\n00:25:07.655 --> 00:25:15.052\nAll right, once we get that,\nwe're gonna do a get-azureVNetGatewayKey.\n\n466\n00:25:15.052 --> 00:25:20.600\nget-azureVNetGatewayKey.\n\n467\n00:25:20.600 --> 00:25:24.522\nAnd we also need to tell it for what\nvirtual network we're talking about, so\n\n468\n00:25:24.522 --> 00:25:28.240\nit's -VNetName, and\n\n469\n00:25:28.240 --> 00:25:33.648\nin that we're going to put in quotes\nalthough there's no spaces, az-subnet.\n\n470\n00:25:33.648 --> 00:25:35.210\nAll right?\n\n471\n00:25:35.210 --> 00:25:37.430\nSo that's the virtual network\nthat I have up there on Azure.\n\n472\n00:25:37.430 --> 00:25:40.340\nAnd then we also need the dash local...\n\n473\n00:25:40.340 --> 00:25:48.035\nI cannot talk today,-localNetworkSiteName.\n\n474\n00:25:48.035 --> 00:25:49.980\nAll right.\n\n475\n00:25:49.980 --> 00:25:52.500\nAnd here's another gotcha.\n\n476\n00:25:53.660 --> 00:25:56.100\nThe site names are case sensitive.\n\n477\n00:25:56.100 --> 00:25:58.550\nI don't know why, but\nthe site names are case sensitive.\n\n478\n00:25:58.550 --> 00:26:04.490\nSo we called that what, Tokyo LAN,\nI believe we called it.\n\n479\n00:26:04.490 --> 00:26:05.590\nWe should double check that.\n\n480\n00:26:06.740 --> 00:26:07.600\nLet's just make sure.\n\n481\n00:26:07.600 --> 00:26:09.190\nTokyo LAN, there we go.\n\n482\n00:26:09.190 --> 00:26:11.410\nThat's exactly what I called it.\n\n483\n00:26:11.410 --> 00:26:12.429\nNow I'm gonna go ahead and hit Enter.\n\n484\n00:26:16.423 --> 00:26:17.610\nWe'll see what we get.\n\n485\n00:26:17.610 --> 00:26:21.590\nAll right, so there's my key,\nbut that's not very friendly.\n\n486\n00:26:21.590 --> 00:26:26.010\nI mean, I don't think routing\nmode access is gonna accept,\n\n487\n00:26:26.010 --> 00:26:27.970\nhere's part of the key dot, dot, dot.\n\n488\n00:26:27.970 --> 00:26:29.150\n>> It'll be fine with that.\n\n489\n00:26:29.150 --> 00:26:30.440\n>> You think it'll be?\n\n490\n00:26:30.440 --> 00:26:31.502\n>> I'm sure, yeah, yeah.\n\n491\n00:26:31.502 --> 00:26:32.690\n>> [LAUGH]\n>> No, no, that's a joke everyone.\n\n492\n00:26:32.690 --> 00:26:37.270\n>> So let's take that same command and\npipe that in into a format list.\n\n493\n00:26:38.640 --> 00:26:42.750\nAnd there's the rest of the key\nthat we probably will need.\n\n494\n00:26:42.750 --> 00:26:48.280\nSo now, all I'm gonna do is\ntake this key and copy it.\n\n495\n00:26:48.280 --> 00:26:50.820\nMinimize that so\nI still have it if I need it.\n\n496\n00:26:50.820 --> 00:26:52.210\nFlip back over here.\n\n497\n00:26:52.210 --> 00:26:55.410\nFind that VPN device script config.\n\n498\n00:26:55.410 --> 00:26:56.380\nOpen it back up.\n\n499\n00:26:58.000 --> 00:27:00.407\nAnd then scroll back down to\nthat authentication part.\n\n500\n00:27:03.425 --> 00:27:08.182\nScroll over and find this key, and\n\n501\n00:27:08.182 --> 00:27:13.290\nswap it out with that key, right?\n\n502\n00:27:13.290 --> 00:27:17.010\nSo the key for the Tokyo tunnel\nthat's gonna be established.\n\n503\n00:27:17.010 --> 00:27:18.130\nEverything else stays the same.\n\n504\n00:27:18.130 --> 00:27:21.660\nThe only other references in here,\nthis is to the virtual network, right.\n\n505\n00:27:21.660 --> 00:27:25.720\nThat's my, that's how my router's gonna\nknow how to route traffic from the Tokyo\n\n506\n00:27:25.720 --> 00:27:29.350\noffice up to the two dot network,\nthe 10.1.2 dot network.\n\n507\n00:27:29.350 --> 00:27:30.930\nSo that's going to stay the same.\n\n508\n00:27:30.930 --> 00:27:33.370\nThese are the public IP addresses for\n\n509\n00:27:33.370 --> 00:27:39.270\nmy gateway up there in the Azure network,\nso those don't change.\n\n510\n00:27:39.270 --> 00:27:41.650\nEverything else is just installing roles.\n\n511\n00:27:41.650 --> 00:27:45.370\nIt's gonna name the demand dial\nconnection by this IP address.\n\n512\n00:27:45.370 --> 00:27:47.660\nIt's going to set it up as persistent.\n\n513\n00:27:47.660 --> 00:27:48.700\nSo nothing else changes.\n\n514\n00:27:48.700 --> 00:27:52.770\nJust that key,\nthat pre-shared key for the tunnel.\n\n515\n00:27:52.770 --> 00:27:56.330\nNow we'll go ahead and do a little File,\nand I'm going to do a Save As, and\n\n516\n00:27:56.330 --> 00:28:02.210\nI'm gonna call this, we're just going to\nadd Tokyo out to the front of that so\n\n517\n00:28:02.210 --> 00:28:03.310\nwe can keep all this straight.\n\n518\n00:28:05.340 --> 00:28:05.850\nAnd, we'll save it.\n\n519\n00:28:06.890 --> 00:28:10.890\nAll right, so now I've got the script\nI need to configure my VPN tunnel so\n\n520\n00:28:10.890 --> 00:28:13.860\nI need to,\nactually let me open that back up.\n\n521\n00:28:15.460 --> 00:28:18.190\nGo to Downloads, copy that guy.\n\n522\n00:28:20.320 --> 00:28:23.210\nAnd again, this is just me\nin my little lab environment\n\n523\n00:28:23.210 --> 00:28:26.780\ngetting it over to the virtual\nmachine that needs that key.\n\n524\n00:28:26.780 --> 00:28:28.110\nSo we're gonna paste that in there.\n\n525\n00:28:28.110 --> 00:28:30.330\nThere's my Tokyo VPN device script.\n\n526\n00:28:30.330 --> 00:28:31.990\nLet me close that.\n\n527\n00:28:31.990 --> 00:28:35.370\nWe can flip over to my Tokyo router.\n\n528\n00:28:35.370 --> 00:28:35.870\nAll right.\n\n529\n00:28:37.440 --> 00:28:39.346\nAnd we'll go grab that script.\n\n530\n00:28:39.346 --> 00:28:42.932\nWhich is on.\n\n531\n00:28:46.954 --> 00:28:48.130\nThere's my script.\n\n532\n00:28:48.130 --> 00:28:48.840\nWe're gonna grab that.\n\n533\n00:28:48.840 --> 00:28:52.750\nCopy it, throw it in my Downloads.\n\n534\n00:28:52.750 --> 00:28:55.380\nAll right.\n\n535\n00:28:55.380 --> 00:28:58.590\nAnd now we're right back to the point\nof what we did a few episodes ago.\n\n536\n00:28:58.590 --> 00:29:01.959\nWe're gonna rename this guy\nto a PowerShell script.\n\n537\n00:29:03.500 --> 00:29:04.370\nPS1.\nYes Windows,\n\n538\n00:29:06.180 --> 00:29:08.770\nI do want to change the extension.\n\n539\n00:29:08.770 --> 00:29:11.170\nThen we're gonna open up\nPowerShell as an administrator.\n\n540\n00:29:11.170 --> 00:29:13.450\nAll right.\n\n541\n00:29:13.450 --> 00:29:15.690\nLet's check our execution policy.\n\n542\n00:29:17.710 --> 00:29:18.750\nIt's set to unrestricted.\n\n543\n00:29:18.750 --> 00:29:22.890\nCuz remember, that's not a signed script,\nand I made changes to it anyway so\n\n544\n00:29:22.890 --> 00:29:25.000\nit wouldn't match\nthe signature any longer.\n\n545\n00:29:25.000 --> 00:29:27.380\nSo I do have to temporarily\nchange this to unrestricted.\n\n546\n00:29:27.380 --> 00:29:28.870\nDo make sure you change that back,\n\n547\n00:29:28.870 --> 00:29:32.770\nnot a good configuration\nto leave your server in.\n\n548\n00:29:32.770 --> 00:29:34.400\nSo we are set to unrestricted.\n\n549\n00:29:34.400 --> 00:29:37.345\nI just need to call that script.\n\n550\n00:29:37.345 --> 00:29:47.081\nC:\\Users\\Administrator\\Downloads\\Tokyovpn-\nDeviceScript.ps1.\n\n551\n00:29:47.081 --> 00:29:49.470\nI go to execute that.\n\n552\n00:29:49.470 --> 00:29:52.350\nAnd since I've already installed\nrouting remote access it just says no\n\n553\n00:29:52.350 --> 00:29:53.330\nchange needed there.\n\n554\n00:29:54.830 --> 00:29:56.190\nAnd remember what it did last time.\n\n555\n00:29:56.190 --> 00:29:59.430\nIt went through this and\nthen it errored but it worked anyway.\n\n556\n00:29:59.430 --> 00:30:01.730\nSo we're okay with that error there.\n\n557\n00:30:01.730 --> 00:30:02.750\nI'll minimize that.\n\n558\n00:30:04.260 --> 00:30:05.150\nWe'll close Downloads.\n\n559\n00:30:05.150 --> 00:30:06.630\nWe should be done with that.\n\n560\n00:30:06.630 --> 00:30:07.760\nWe'll refresh.\n\n561\n00:30:09.770 --> 00:30:12.140\nAnd sure enough there is my\nnew demand dial interface.\n\n562\n00:30:12.140 --> 00:30:15.780\nNow just like before we gotta\ndouble check a couple of things.\n\n563\n00:30:15.780 --> 00:30:17.840\nLet's make sure it added it under IPv4.\n\n564\n00:30:17.840 --> 00:30:19.480\nSo there we go.\n\n565\n00:30:19.480 --> 00:30:20.580\nThat looks good.\n\n566\n00:30:20.580 --> 00:30:23.330\nThe other thing I wanna warn you about,\n\n567\n00:30:23.330 --> 00:30:27.349\ncuz just through doing some\nexperimentation in my own experience.\n\n568\n00:30:29.050 --> 00:30:30.740\nNetwork address translation.\n\n569\n00:30:30.740 --> 00:30:34.720\nRemember, if you disable your\nconfiguration, you lose it all, and\n\n570\n00:30:34.720 --> 00:30:36.170\nthen you run that script\nbecause you're like,\n\n571\n00:30:36.170 --> 00:30:38.630\nokay, I'm just gonna blow\naway everything I have.\n\n572\n00:30:38.630 --> 00:30:41.820\nAnd I'm gonna turn off\nrouting remote access.\n\n573\n00:30:41.820 --> 00:30:43.370\nAnd then I'm going to run that script,\n\n574\n00:30:43.370 --> 00:30:47.380\nwhich is going to install routing\nremote access and configure everything.\n\n575\n00:30:47.380 --> 00:30:49.010\nIt doesn't know you need a NAT.\n\n576\n00:30:49.010 --> 00:30:50.460\nSo NAT won't come back.\n\n577\n00:30:50.460 --> 00:30:52.180\nSo do make sure if you\nblow everything away and\n\n578\n00:30:52.180 --> 00:30:56.240\nstart over that you make a note of\nwhat protocols were already there,\n\n579\n00:30:56.240 --> 00:30:58.700\nwhat static routes, if any,\nthat you had in there.\n\n580\n00:30:58.700 --> 00:31:02.450\nBut at this point we should be good to go.\n\n581\n00:31:02.450 --> 00:31:03.760\nLet's check it out.\n\n582\n00:31:03.760 --> 00:31:05.430\nWe look at our routing table.\n\n583\n00:31:05.430 --> 00:31:08.800\nI can see there is a route\nto the 10.1.2 network.\n\n584\n00:31:08.800 --> 00:31:14.220\nGoing through that tunnel, heading out\nto that 80.104, that's the name of my\n\n585\n00:31:14.220 --> 00:31:19.810\nVPN demand dial interface,\nso we should be good to go.\n\n586\n00:31:19.810 --> 00:31:21.210\nLets make sure it connected.\n\n587\n00:31:22.870 --> 00:31:25.560\nAnd there I'm showing connected,\nit's a beautiful thing.\n\n588\n00:31:27.080 --> 00:31:31.300\nNow we flip back over to here, I can\nsee that still says disconnected, and\n\n589\n00:31:31.300 --> 00:31:35.650\nagain this is just a time\nthing most likely.\n\n590\n00:31:35.650 --> 00:31:38.040\nIt'll take it a minute\nbefore that pops in and\n\n591\n00:31:38.040 --> 00:31:40.270\nupdates with the fact that it's connected.\n\n592\n00:31:40.270 --> 00:31:42.070\nLet me see if it has just yet.\n\n593\n00:31:42.070 --> 00:31:44.010\n>> So don't panic if-\n>> Yes.\n\n594\n00:31:44.010 --> 00:31:46.570\n>> After a few minutes it's\nstill not saying connected.\n\n595\n00:31:46.570 --> 00:31:47.950\nGive it a little bit of time.\n\n596\n00:31:47.950 --> 00:31:51.836\nI know I'm the worst, because I always\nused to say, if you want patience become\n\n597\n00:31:51.836 --> 00:31:54.739\na doctor right, I'm in IT here,\nI gotta make things work.\n\n598\n00:31:54.739 --> 00:31:59.301\nBut sometimes it's exactly what is\nrequired that you need to just hold up.\n\n599\n00:31:59.301 --> 00:32:01.083\nI remember Mike, once I came to you and\n\n600\n00:32:01.083 --> 00:32:04.780\nI said This Active Directory is not\nworking correctly, it's not syncing up.\n\n601\n00:32:04.780 --> 00:32:06.630\nAnd you said, well,\ndid you wait any amount of time?\n\n602\n00:32:06.630 --> 00:32:08.652\nMan, I've been waiting forever,\nit's still not working.\n\n603\n00:32:08.652 --> 00:32:10.788\nWe'll go check it again, and\nI went back, it was fine, it worked.\n\n604\n00:32:10.788 --> 00:32:13.248\n>> [LAUGH]\n>> I literally had to tell Mike.\n\n605\n00:32:13.248 --> 00:32:14.525\n>> Exactly.\n\n606\n00:32:14.525 --> 00:32:16.376\nThe little bit of time it took\nyou to walk over and talk to me,\n\n607\n00:32:16.376 --> 00:32:17.093\nit was enough to do it.\n\n608\n00:32:17.093 --> 00:32:19.690\nAnd there we go, we are now connected.\n\n609\n00:32:19.690 --> 00:32:21.230\nYeah, so it's a great point.\n\n610\n00:32:21.230 --> 00:32:23.480\nDon't go, my gosh, it's not connected.\n\n611\n00:32:23.480 --> 00:32:26.979\nGo back, disable routing room and\naccess, start all over.\n\n612\n00:32:26.979 --> 00:32:30.030\nGive it a minute to get\neverything together and go, okay,\n\n613\n00:32:30.030 --> 00:32:32.100\nlet me show you what I've got.\n\n614\n00:32:32.100 --> 00:32:33.900\nBut there we go, we are now connected.\n\n615\n00:32:33.900 --> 00:32:38.920\nWe've got Tokyo LAN up and\nrunning, which means, let's see.\n\n616\n00:32:38.920 --> 00:32:46.940\nIf we go over here to my little Windows\n10 box, and let's clear all that out.\n\n617\n00:32:46.940 --> 00:32:48.650\nSo this is my Windows 10 box.\n\n618\n00:32:48.650 --> 00:32:54.620\nAnd if I do an IPconfig, we'll see that he\nshould be on the 10.1.3 network, right?\n\n619\n00:32:54.620 --> 00:32:59.990\nAnd let's see if we can do a ping,\n10.1.2.4.\n\n620\n00:32:59.990 --> 00:33:01.225\nThat's a beautiful thing, right?\n\n621\n00:33:01.225 --> 00:33:02.610\nCuz you know what that means.\n\n622\n00:33:02.610 --> 00:33:04.193\nIf I can ping that domain controller,\n\n623\n00:33:04.193 --> 00:33:06.819\nthe only other thing I should try\nis to make sure DNS is working.\n\n624\n00:33:06.819 --> 00:33:15.451\nSo let's ping az-dc01.itprotvdemo.com,\n\n625\n00:33:15.451 --> 00:33:18.330\nand there we go.\n\n626\n00:33:18.330 --> 00:33:22.580\nResolved into an IP address and\ngot the job done for us, right?\n\n627\n00:33:22.580 --> 00:33:25.450\nWhich means, I should be able to\njoin the domain, let's find out.\n\n628\n00:33:26.600 --> 00:33:31.578\nSo we're going to pull up\nmy system properties, and\n\n629\n00:33:31.578 --> 00:33:34.755\nwe're going to change this guy,\n\n630\n00:33:37.638 --> 00:33:42.536\nTo ITProTVdemo.com.\n\n631\n00:33:44.488 --> 00:33:46.425\nAnd could not be contacted.\n\n632\n00:33:46.425 --> 00:33:47.482\nSon of a gun.\n\n633\n00:33:47.482 --> 00:33:49.037\n>> [LAUGH]\n>> Did I type that right?\n\n634\n00:33:49.037 --> 00:33:52.423\nITProTVdemo.com.\n\n635\n00:33:52.423 --> 00:33:53.195\nInteresting.\n\n636\n00:33:53.195 --> 00:33:55.632\nAll right, let's give it a second and see.\n\n637\n00:33:55.632 --> 00:33:58.331\nLet's double check that one more time.\n\n638\n00:34:00.050 --> 00:34:06.355\n[CROSSTALK] Yeah, ip config which flush,\nbecause it did resolve to that 69,\n\n639\n00:34:06.355 --> 00:34:11.526\nother address when we tried to\nping it by a fully qualified name.\n\n640\n00:34:11.526 --> 00:34:18.606\nFlush DNS, and let's just see,\nping, 10.1.2.4, I'm good to go.\n\n641\n00:34:18.606 --> 00:34:23.760\nYou know what, I know what the problem is,\nrookie mistake here.\n\n642\n00:34:23.760 --> 00:34:28.721\nYou were right, DNS setting,\nit's IP configuration that I failed to do,\n\n643\n00:34:28.721 --> 00:34:31.210\nforgot to show you that part.\n\n644\n00:34:31.210 --> 00:34:32.730\nLet's open up Network and Sharing.\n\n645\n00:34:32.730 --> 00:34:34.165\nAnd this is really just basic.\n\n646\n00:34:34.165 --> 00:34:36.580\n[LAUGH] Which is kind of embarrassing but\n\n647\n00:34:36.580 --> 00:34:39.600\nthis is basic joining\nthe domain skills here, right.\n\n648\n00:34:39.600 --> 00:34:40.810\n>> It's bush league, Mike.\n\n649\n00:34:40.810 --> 00:34:42.630\n>> Bush league all the way.\n\n650\n00:34:42.630 --> 00:34:45.580\nThe client that you are trying\nto join the domain, if it can't\n\n651\n00:34:45.580 --> 00:34:48.670\nresolve the name of the domain controller,\nwell, you're not gonna join the domain.\n\n652\n00:34:48.670 --> 00:34:54.390\nWhich means your TCIV settings have to\npoint to a DNS server of that domain.\n\n653\n00:34:54.390 --> 00:34:55.125\nSo let's try it.\n\n654\n00:34:55.125 --> 00:35:00.620\nLet's go into IPv4, and sure enough,\nI'm still pointed to Google's DNS server,\n\n655\n00:35:00.620 --> 00:35:05.810\nso let's change that to 10.1.2.4, which\nI know I can get to across that tunnel.\n\n656\n00:35:05.810 --> 00:35:07.350\nHeck, we've got two domain\ncontrollers up there,\n\n657\n00:35:07.350 --> 00:35:11.770\nI should do fault tolerance, right,\nwe've got 2.5 up there as well.\n\n658\n00:35:11.770 --> 00:35:16.045\nAnd then I can even for good measure add\n\n659\n00:35:16.045 --> 00:35:22.160\na third just in case, right?\n\n660\n00:35:22.160 --> 00:35:23.540\nWe could throw a third one in there.\n\n661\n00:35:23.540 --> 00:35:24.888\n>> Just to get Internet DNS, right?\n\n662\n00:35:24.888 --> 00:35:29.380\n>> Right, exactly, so if for some unknown\nreason, the Azure network was down,\n\n663\n00:35:29.380 --> 00:35:33.650\nthat person in Tokyo could still\nget out to Google or what have you.\n\n664\n00:35:33.650 --> 00:35:36.120\nAll right, so we'll go ahead and\nclose that out.\n\n665\n00:35:36.120 --> 00:35:39.440\nAnd we're gonna try that one more time and\nsee how things work.\n\n666\n00:35:39.440 --> 00:35:44.830\nWe'll close that down, we'll click,\nI did flush DNS right, yep.\n\n667\n00:35:44.830 --> 00:35:50.057\nSo we'll change, change, change,\n\n668\n00:35:50.057 --> 00:35:53.914\nsorry, ITProTVdemo.com.\n\n669\n00:35:56.421 --> 00:35:56.978\n>> There we go.\n\n670\n00:35:56.978 --> 00:35:59.575\n>> And that looks a little better, right?\n\n671\n00:35:59.575 --> 00:36:02.680\nAs soon as you get those authentication\nrequests, you're good to go.\n\n672\n00:36:02.680 --> 00:36:10.120\nSo administrator, super secret password,\nand you know what we're looking for.\n\n673\n00:36:11.300 --> 00:36:11.830\nWelcome.\n\n674\n00:36:11.830 --> 00:36:14.750\n>> Welcome to the IT Pro TV Demo.\n\n675\n00:36:14.750 --> 00:36:16.137\n>> Demo, whatever it's called [LAUGH].\n\n676\n00:36:16.137 --> 00:36:17.750\n>> [LAUGH] Whatever you've named it there,\nMike.\n\n677\n00:36:19.470 --> 00:36:23.140\n>> I will have to say that is\na long name and I hate it [LAUGH].\n\n678\n00:36:23.140 --> 00:36:24.650\nBut it's efficient, or it's not efficient.\n\n679\n00:36:24.650 --> 00:36:25.460\n>> It's descriptive.\n\n680\n00:36:25.460 --> 00:36:27.590\n>> It's descriptive,\nthat's what I'm looking for.\n\n681\n00:36:27.590 --> 00:36:29.600\nSo, all right, so\nwe'll give it a second, but.\n\n682\n00:36:29.600 --> 00:36:32.748\nI mean really, as soon as you see the\nauthentication credentials, that means it\n\n683\n00:36:32.748 --> 00:36:35.592\nreached out, found the domain\ncontroller for that domain, said sure.\n\n684\n00:36:35.592 --> 00:36:40.345\nI'll let you join if you've got the\nappropriate credentials to create a new\n\n685\n00:36:40.345 --> 00:36:43.316\ncomputer account in\nActive Directory to add and\n\n686\n00:36:43.316 --> 00:36:47.290\nthen to map this computer to that account,\nso hopefully I do.\n\n687\n00:36:47.290 --> 00:36:49.950\nI am their domain admin there,\nso we're good.\n\n688\n00:36:49.950 --> 00:36:51.580\nWelcome to the domain, we'll click okay.\n\n689\n00:36:52.610 --> 00:36:58.130\nWait for the next message and\nOK, and then close and restart.\n\n690\n00:36:58.130 --> 00:36:59.040\nAnd we're good to go.\n\n691\n00:36:59.040 --> 00:37:01.240\nSo at this point, we've added a branch.\n\n692\n00:37:01.240 --> 00:37:06.180\nNow it might have seemed a little bit\ncomplex, but if you really boil it down to\n\n693\n00:37:06.180 --> 00:37:10.450\nwhat we did, and once you've done it once,\nit's extremely easy.\n\n694\n00:37:10.450 --> 00:37:11.920\nI downloaded my configuration file.\n\n695\n00:37:11.920 --> 00:37:14.840\nI would already have that downloaded and\nsaved somewhere, right,\n\n696\n00:37:14.840 --> 00:37:16.400\nif this was my actual network.\n\n697\n00:37:16.400 --> 00:37:18.440\nSo all I did was copy and paste and\n\n698\n00:37:18.440 --> 00:37:23.610\nmodify a couple of entries in the config\nfile and then upload it to Azure, right?\n\n699\n00:37:23.610 --> 00:37:28.620\nThen I ran a PowerShell command to get\nthe key for the new tunnel that I created.\n\n700\n00:37:28.620 --> 00:37:31.539\nAnd then I ran that script on\nmy routing remote access server,\n\n701\n00:37:31.539 --> 00:37:33.910\npopped in the new key,\nand we're up and running.\n\n702\n00:37:33.910 --> 00:37:36.682\nSo I mean in the end,\nit's not very difficult, and\n\n703\n00:37:36.682 --> 00:37:38.990\nit wouldn't take you that long at all.\n\n704\n00:37:38.990 --> 00:37:39.600\n>> No, not at all.\n\n705\n00:37:39.600 --> 00:37:42.860\nI mean we're sitting here\nexplaining it to you and\n\n706\n00:37:42.860 --> 00:37:47.440\nthat little over 30 minutes now,\nbut that's all it took.\n\n707\n00:37:47.440 --> 00:37:49.640\nIf Mike wasn't trying to\ntell you how to do it,\n\n708\n00:37:49.640 --> 00:37:51.894\nhe could have probably had\nit done in about 15 minutes.\n\n709\n00:37:51.894 --> 00:37:54.410\nAnd he'd have been live at 5, ready to go.\n\n710\n00:37:54.410 --> 00:37:57.880\nWell Mike, we have done a lot in this\nepisode, a lot of very practical,\n\n711\n00:37:57.880 --> 00:37:58.910\ngood stuff.\n\n712\n00:37:58.910 --> 00:38:02.280\nIt was a good learning experience,\nhopefully for you, it was for us as well.\n\n713\n00:38:02.280 --> 00:38:03.710\nSometimes we've gotta go back to square.\n\n714\n00:38:03.710 --> 00:38:06.530\nMike, is there anything else that we\nneed to talk about in this episode?\n\n715\n00:38:06.530 --> 00:38:09.780\n>> I don't think so, as far as I remember,\nthis was all done through the classic,\n\n716\n00:38:09.780 --> 00:38:14.270\nit is going to be different if\nyou're using the modern portal.\n\n717\n00:38:14.270 --> 00:38:17.030\nBut we're gonna show you that in\nfuture episodes, so don't worry.\n\n718\n00:38:17.030 --> 00:38:18.270\n>> All right, well,\nwe look forward to that.\n\n719\n00:38:18.270 --> 00:38:19.180\nThank you again Mike, for\n\n720\n00:38:19.180 --> 00:38:22.540\nshowing up and teaching us\nthese good skills for us today.\n\n721\n00:38:22.540 --> 00:38:23.800\nThank you guys for watching.\n\n722\n00:38:23.800 --> 00:38:25.415\nWe're gonna go ahead and sign off.\n\n723\n00:38:25.415 --> 00:38:27.275\nFor ITProTV,\nI've been your host Daniel Lowrie.\n\n724\n00:38:27.275 --> 00:38:28.086\n>> And I'm Mike Roderick.\n\n725\n00:38:28.086 --> 00:38:30.223\n>> And we'll see you next time.\n\n726\n00:38:30.223 --> 00:38:38.190\n[MUSIC]\n\n",
          "vimeoId": "155684968"
        },
        {
          "description": "In this episode, Mike and Daniel show you how to setup and configure a Point to Site VPN with Microsoft Azure for connecting mobile clients. They begin by explaining how to setup the security certificates that will be required to make the connection. Then they walk you through downloading and installing the VPN client configuration for the mobile device and finally connect to Azure using the Point to Site VPN.",
          "length": "1950",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-3-2-configuring_point_to_site_vpn-021616-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-3-2-configuring_point_to_site_vpn-021616-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-3-2-configuring_point_to_site_vpn-021616-1-sm.jpg",
          "title": "Configuring Point-to-Site VPN",
          "transcript": "WEBVTT\n\n1\n00:00:00.004 --> 00:00:10.004\n[MUSIC]\n\n2\n00:00:12.019 --> 00:00:16.860\nAll right, greetings everyone and welcome\nto another exciting episode of ITProTV.\n\n3\n00:00:16.860 --> 00:00:18.970\nI'm your host, Daniel Lowrie.\n\n4\n00:00:18.970 --> 00:00:22.570\nAnd in today's episode, well, we are\ncontinuing on with that active directory.\n\n5\n00:00:22.570 --> 00:00:24.600\nI can't even get the word out of my mouth.\n\n6\n00:00:24.600 --> 00:00:28.470\nIn Azure, so AD in Azure series,\nwe've been working very diligently on.\n\n7\n00:00:28.470 --> 00:00:32.790\nJoining us back in the studio again today,\nhelping us guide this lovely little star\n\n8\n00:00:32.790 --> 00:00:35.780\nthat we're on, is none other than\nour good friend, Mr. Mike Rogers.\n\n9\n00:00:35.780 --> 00:00:37.140\nMike, welcome back to the show, sir.\n\n10\n00:00:37.140 --> 00:00:38.700\n>> Thanks for having me back,\nand you're right.\n\n11\n00:00:38.700 --> 00:00:41.350\nWe're continuing on with\nActive Directory in Azure.\n\n12\n00:00:41.350 --> 00:00:42.540\nAnd in today's episode,\n\n13\n00:00:42.540 --> 00:00:47.320\nwe're going to be looking at what we\ncall a point-to-site VPN connection.\n\n14\n00:00:47.320 --> 00:00:49.910\nNow, we've seen a couple VPN's\nthat we've set up, right?\n\n15\n00:00:49.910 --> 00:00:53.240\nWe've had our corporate network,\nour on-premises network.\n\n16\n00:00:53.240 --> 00:00:57.370\nWe've created a site-to-site VPN\nout there to our Azure network, and\n\n17\n00:00:57.370 --> 00:01:00.290\nthen we've created a second,\nlike a branch office.\n\n18\n00:01:00.290 --> 00:01:03.070\nAnd we created another\nsite-to-site VPN from there.\n\n19\n00:01:03.070 --> 00:01:07.450\nSo we ended up making a multi-site\nVPN end-point up there in Azure.\n\n20\n00:01:07.450 --> 00:01:11.020\nSo that pretty much covers what you\nwould do with that kind of thing.\n\n21\n00:01:11.020 --> 00:01:12.860\nWhere you've got your corporate office and\n\n22\n00:01:12.860 --> 00:01:15.770\nneeds to replicate with the main\ncontrollers up there at the branch office.\n\n23\n00:01:15.770 --> 00:01:17.780\nYou got, I'm sorry, up there in Azure.\n\n24\n00:01:17.780 --> 00:01:21.300\nYou've got branch offices that maybe\ndon't have domain controllers.\n\n25\n00:01:21.300 --> 00:01:25.310\nSo you setup a site-to-site VPN and\nnow they can authenticate using the domain\n\n26\n00:01:25.310 --> 00:01:29.440\ncontrollers that are located out there\nin Azure, acts as other resources and\n\n27\n00:01:29.440 --> 00:01:30.660\nwhat have you.\n\n28\n00:01:30.660 --> 00:01:35.360\nThis next one that we wanna do, again,\nthe site or the point-to-site VPN, now if\n\n29\n00:01:35.360 --> 00:01:39.780\nI can keep all of these straight, is\nanother one that's gonna be commonly used.\n\n30\n00:01:39.780 --> 00:01:42.310\nWhen you're running resources\nout there in Azure.\n\n31\n00:01:42.310 --> 00:01:45.630\nAnd that's because you're gonna\nhave users that you need to support\n\n32\n00:01:45.630 --> 00:01:46.880\nthat are traveling, right.\n\n33\n00:01:46.880 --> 00:01:48.550\nThey're not at the corporate office.\n\n34\n00:01:48.550 --> 00:01:50.560\nThey're not at a branch location.\n\n35\n00:01:50.560 --> 00:01:51.220\nThey're traveling.\n\n36\n00:01:51.220 --> 00:01:52.080\nThey're at a hotel.\n\n37\n00:01:52.080 --> 00:01:53.420\nThey're at Starbucks.\n\n38\n00:01:53.420 --> 00:01:55.070\nAn airport.\n\n39\n00:01:55.070 --> 00:01:56.500\nWhatever the case may be.\n\n40\n00:01:56.500 --> 00:02:00.320\nOr as Daniel and I were talking about the\nother day, you know, they might be a home\n\n41\n00:02:00.320 --> 00:02:04.760\nworker, right, where we want them to\nbe able to set up a VPN connection\n\n42\n00:02:04.760 --> 00:02:09.060\nfrom their computer at home into Azure so\nthey can access those resources.\n\n43\n00:02:09.060 --> 00:02:13.070\nNow we were talking about the fact\nyou could just do a site-to-site VPN\n\n44\n00:02:13.070 --> 00:02:14.090\nfrom their house, right?\n\n45\n00:02:14.090 --> 00:02:15.120\nAnd then any computer,\n\n46\n00:02:15.120 --> 00:02:18.850\ndevice at their home could connect\nto those Azure resources or\n\n47\n00:02:18.850 --> 00:02:22.560\nit might be where you don't want that and\nyou just want a single machine.\n\n48\n00:02:22.560 --> 00:02:26.100\nYou've issued them a laptop, and\nthat's the only one you want them using\n\n49\n00:02:26.100 --> 00:02:28.440\nto connect out there to\nyour Azure resources or\n\n50\n00:02:28.440 --> 00:02:32.170\nthe rest of your corporate network, so\nmaybe you do what we call a point-to-site.\n\n51\n00:02:32.170 --> 00:02:33.140\nAnd that's all it means.\n\n52\n00:02:33.140 --> 00:02:34.410\nPoint to site.\n\n53\n00:02:34.410 --> 00:02:38.330\nInstead of the entire site\nhaving a tunnel back to Azure,\n\n54\n00:02:38.330 --> 00:02:42.590\nwe're going from a single point, a single\nendpoint, typically a laptop usually.\n\n55\n00:02:42.590 --> 00:02:45.190\nBut some endpoint device up to Azure.\n\n56\n00:02:45.190 --> 00:02:47.940\nSo that's what we're going to do today.\n\n57\n00:02:47.940 --> 00:02:51.970\nAnd if I put it on my drawing here just so\nwe can keep it all straight and kinda keep\n\n58\n00:02:51.970 --> 00:02:56.730\ntrack of what we've done, I'm just gonna\ndump one of these laptops right out here.\n\n59\n00:02:56.730 --> 00:03:01.310\nAnd say they wanna make\na connection back into Azure.\n\n60\n00:03:01.310 --> 00:03:05.640\nSo we'll just kinda give him\na little connection here.\n\n61\n00:03:05.640 --> 00:03:07.540\nWe'll drag that guy up and\n\n62\n00:03:07.540 --> 00:03:10.530\nwe're basically doing,\nwell we'll do it like the rest of them.\n\n63\n00:03:10.530 --> 00:03:14.150\nWe're connecting him there, right.\n\n64\n00:03:14.150 --> 00:03:15.030\nSo that's what we're doing.\n\n65\n00:03:15.030 --> 00:03:19.060\nSo now for this, obviously it's only\ngoing to be good for that one node.\n\n66\n00:03:19.060 --> 00:03:22.780\nSo if I had five different sales people\nthat travel that needed to access\n\n67\n00:03:22.780 --> 00:03:27.850\nresources up there in Azure,\nI would need five different point-to-site\n\n68\n00:03:27.850 --> 00:03:32.020\nconnectivities, or\npoint-to-site VPN tunnels, which is fine.\n\n69\n00:03:32.020 --> 00:03:33.550\nAzure supports that.\n\n70\n00:03:33.550 --> 00:03:35.530\nI'll look up the number in just a minute,\n\n71\n00:03:35.530 --> 00:03:38.979\nI can't remember exactly how many\nthey support, but it's pretty large.\n\n72\n00:03:39.990 --> 00:03:44.890\nAll right, so to do it it's actually\nreally simple, believe it or not.\n\n73\n00:03:44.890 --> 00:03:47.580\nYou see what we've gone through\nto create the site-to-site VPNs,\n\n74\n00:03:47.580 --> 00:03:51.560\nnone of it was all that complex we\njust had to figure out where to go and\n\n75\n00:03:51.560 --> 00:03:55.750\nwhat to do and once you've seen it and\ndone it once or twice, it's not too bad.\n\n76\n00:03:55.750 --> 00:03:58.720\nThey've made this process relatively easy.\n\n77\n00:03:58.720 --> 00:04:00.020\nIt's pretty darn painless.\n\n78\n00:04:00.020 --> 00:04:01.200\nI really like it.\n\n79\n00:04:01.200 --> 00:04:05.270\nThe first thing you need to do is decide\nhow you're going to authenticate,\n\n80\n00:04:05.270 --> 00:04:06.580\nwell I shouldn't say that.\n\n81\n00:04:06.580 --> 00:04:08.070\nYou're gonna use certificates.\n\n82\n00:04:08.070 --> 00:04:11.280\nThat's what you're gonna use cuz that's\nwhat Microsoft's gonna allow you to use.\n\n83\n00:04:11.280 --> 00:04:14.940\nThe question you have to ask is,\nwhere do I get those certificates, right?\n\n84\n00:04:14.940 --> 00:04:20.150\nWe're gonna install a certificate\non that client machine and that's\n\n85\n00:04:20.150 --> 00:04:25.015\nwhat it's going to use to authenticate,\nback up to Azure and establish that\n\n86\n00:04:25.015 --> 00:04:29.500\npoint-to-site connectivity, so we're\nreally gonna need a few certificates.\n\n87\n00:04:29.500 --> 00:04:32.520\nWe need one for\nthe Azure location itself, and\n\n88\n00:04:32.520 --> 00:04:36.130\nwe're gonna put a trusted\nroot certificate up there.\n\n89\n00:04:36.130 --> 00:04:39.260\nAnd then we're gonna generate\nclient certificates for\n\n90\n00:04:39.260 --> 00:04:42.440\neach one of my nodes that\nneeds to be able to establish\n\n91\n00:04:42.440 --> 00:04:46.010\nthat point-to-site connectivity and then\nwe install it on each one of those nodes.\n\n92\n00:04:46.010 --> 00:04:48.670\nAnd it's really no different than\nwhat you probably do every day in\n\n93\n00:04:48.670 --> 00:04:49.400\na corporate network.\n\n94\n00:04:49.400 --> 00:04:50.210\n>> That's right.\n\n95\n00:04:50.210 --> 00:04:54.570\nAnd Mike's used the lovely little buzz\nword there that was certificates, and\n\n96\n00:04:54.570 --> 00:04:57.550\nthat makes me think immediately,\nmy mind jumps to a PKI,\n\n97\n00:04:57.550 --> 00:05:02.040\na public key infrastructure,\nhaving all that built into place.\n\n98\n00:05:02.040 --> 00:05:05.390\nIf you're in a corporate environment, that\nis probably already set up and in place,\n\n99\n00:05:05.390 --> 00:05:10.330\nbecause, well, we use this kinda thing a\nlittle bit in the enterprise environment.\n\n100\n00:05:10.330 --> 00:05:11.860\nIs that what we're talking about here,\nMike?\n\n101\n00:05:11.860 --> 00:05:12.430\n>> It could be.\n\n102\n00:05:12.430 --> 00:05:15.260\nYou actually have choices, and\nit's cool that we do have a choice.\n\n103\n00:05:15.260 --> 00:05:16.350\nBut you're exactly right.\n\n104\n00:05:16.350 --> 00:05:19.920\nMost organizations are gonna have public\nkey infrastructure set up already.\n\n105\n00:05:19.920 --> 00:05:24.060\nThey're issuing certificates to their\nusers, as well as their devices.\n\n106\n00:05:24.060 --> 00:05:28.460\nThey're using them for various purposes\nto sign emails or to authenticate, or\n\n107\n00:05:28.460 --> 00:05:29.600\nwhat have you.\n\n108\n00:05:29.600 --> 00:05:31.480\nSo you've already got that\ninfrastructure set up.\n\n109\n00:05:31.480 --> 00:05:33.340\nYou can definitely leverage that.\n\n110\n00:05:33.340 --> 00:05:38.410\nIssue certificates for this purpose and\nuse them and you'll be good to go.\n\n111\n00:05:38.410 --> 00:05:42.960\nBut what if you don't have\nan Enterprise PKI already set up?\n\n112\n00:05:42.960 --> 00:05:44.400\nRight?\nMaybe you've got one or\n\n113\n00:05:44.400 --> 00:05:49.300\ntwo certificates that you've bought\nfrom Verisign or or Equifax, or GTE, or\n\n114\n00:05:49.300 --> 00:05:53.340\none of those third-party\ncertificate vendors out there for\n\n115\n00:05:53.340 --> 00:05:56.675\nyour website and for the front end\nof your exchange, but that's it.\n\n116\n00:05:56.675 --> 00:06:00.485\nYou don't use certificates internally,\nyou're not running your own PKI.\n\n117\n00:06:00.485 --> 00:06:01.635\nAre you left out?\n\n118\n00:06:01.635 --> 00:06:02.975\nAbsolutely not.\n\n119\n00:06:02.975 --> 00:06:05.165\nYou could purchase certificates, but\n\n120\n00:06:05.165 --> 00:06:07.853\nwe can take advantage of\nself-signed certificates.\n\n121\n00:06:07.853 --> 00:06:10.215\nAnd self-signed\ncertificates are just that.\n\n122\n00:06:10.215 --> 00:06:13.695\nRather than being signed by\nsome trusted third party, or\n\n123\n00:06:13.695 --> 00:06:18.930\nsome trusted Enterprise PKI,\nWe're going to sign them ourselves.\n\n124\n00:06:18.930 --> 00:06:21.010\nAnd, you might think,\nwhat good is that, then?\n\n125\n00:06:21.010 --> 00:06:22.010\nI could do whatever I want.\n\n126\n00:06:22.010 --> 00:06:24.070\nAnd you could, and that's okay, right?\n\n127\n00:06:24.070 --> 00:06:29.060\nIt's your VPN endpoint, its your Azure\nnetwork, its your clients, they don't need\n\n128\n00:06:29.060 --> 00:06:34.880\nto be trusted by anybody else, as long as\nyour nodes trust them, you're good to go.\n\n129\n00:06:34.880 --> 00:06:35.730\nThat's it.\n\n130\n00:06:35.730 --> 00:06:40.060\nSo, you can still take advantage of\nthis being a small organization.\n\n131\n00:06:40.060 --> 00:06:43.300\nBy using, we can create our\nown self-signed certificates.\n\n132\n00:06:43.300 --> 00:06:46.800\nOr if you're testing or playing around or\njust trying to get used to, or\n\n133\n00:06:46.800 --> 00:06:50.840\nlearning your way about it with Azure,\nyou can use this method as well.\n\n134\n00:06:50.840 --> 00:06:53.830\nSo what I'm gonna do is I'm gonna\nshow you that method because\n\n135\n00:06:53.830 --> 00:06:55.070\nit's not something you see every day.\n\n136\n00:06:55.070 --> 00:06:58.760\nI've been doing this for a long time,\nand I don't know that I've ever really\n\n137\n00:06:58.760 --> 00:07:01.700\nplayed around with making my\nown certificates before this.\n\n138\n00:07:01.700 --> 00:07:04.310\nWe always study Enterprise PKI, right.\n\n139\n00:07:04.310 --> 00:07:08.810\nInstalling a certificate authority,\nsetting up via hierarchy of certificate\n\n140\n00:07:08.810 --> 00:07:13.530\nauthorities, and issuing certificates and\nusing group policy to issue them out.\n\n141\n00:07:13.530 --> 00:07:17.400\nThis is something that we don't see\neveryday but it could be very useful for\n\n142\n00:07:17.400 --> 00:07:18.330\ntest environments.\n\n143\n00:07:18.330 --> 00:07:21.580\nI can think of many places where I could\nhave used some self-signed certificates.\n\n144\n00:07:21.580 --> 00:07:25.580\nHeck, I'm thinking right now at my own\nhouse with my little Linksys router,\n\n145\n00:07:25.580 --> 00:07:28.480\nyou know, getting a certificate\ninstalled on there and being able to set\n\n146\n00:07:28.480 --> 00:07:31.060\nup a secure connection, I'm like hey,\nI don't have to buy one from Verisign.\n\n147\n00:07:31.060 --> 00:07:34.350\n>> That's right, and every now and\nthen it's fun to get away with a quick and\n\n148\n00:07:34.350 --> 00:07:37.180\ndirty way to do it because,\nwell, A, you gotta remember,\n\n149\n00:07:37.180 --> 00:07:40.180\nyou're working with inside of a,\neven though we're kind of transversing\n\n150\n00:07:40.180 --> 00:07:45.000\nthe internet, that's still okay that we're\nworking with our own certificates because,\n\n151\n00:07:45.000 --> 00:07:48.280\nwell, we're controlling all that and\nwe trust ourselves, at least I hope we do.\n\n152\n00:07:48.280 --> 00:07:49.040\n>> [LAUGH] For the most part.\n\n153\n00:07:49.040 --> 00:07:52.170\n>> You know, I've been know to\nmake a mistake from time to time.\n\n154\n00:07:52.170 --> 00:07:56.794\nBut I try to run on the assumption that\nI'm doing myself a favor on any endeavor\n\n155\n00:07:56.794 --> 00:07:58.157\nthat I've jumped on.\n\n156\n00:07:58.157 --> 00:07:59.973\nSo that's kinda what\nwe're dealing with here.\n\n157\n00:07:59.973 --> 00:08:00.848\n>> Exactly.\n\n158\n00:08:00.848 --> 00:08:03.477\nSo let's take a look at how\nwe can go about doing this.\n\n159\n00:08:03.477 --> 00:08:06.863\nAnd this way you'll really get\nboth methods out of it, right?\n\n160\n00:08:06.863 --> 00:08:10.150\nBecause I'm gonna show you how to\ncreate your own certificates and\n\n161\n00:08:10.150 --> 00:08:11.620\nset this up using that.\n\n162\n00:08:11.620 --> 00:08:15.050\nIf you've got a public key infrastructure,\nor access to certificates,\n\n163\n00:08:15.050 --> 00:08:18.060\nthen it's gonna be the same concept,\nyou're just not making the certificates.\n\n164\n00:08:18.060 --> 00:08:19.860\nYou still have to upload\nthem the same way.\n\n165\n00:08:19.860 --> 00:08:22.940\nYou still have to install them\non client machines the same way.\n\n166\n00:08:22.940 --> 00:08:24.490\nSo that process is not gonna change,\n\n167\n00:08:24.490 --> 00:08:26.700\nits just where youre\ngetting the certificate from.\n\n168\n00:08:26.700 --> 00:08:30.090\nSo Im gonna show you this method, if\nyouve got your own PKI thats fine too.\n\n169\n00:08:30.090 --> 00:08:32.660\nJust generate your own\ncertificates from your PKI,\n\n170\n00:08:32.660 --> 00:08:37.129\nand then use them the way we use\nthese self-signed certificates here.\n\n171\n00:08:37.129 --> 00:08:42.270\nAll right, so that being said,\nlet's see how we can get this done.\n\n172\n00:08:42.270 --> 00:08:46.517\nThe first thing we're going to need\nis a way to make those certificates.\n\n173\n00:08:46.517 --> 00:08:49.970\nRight, I can't just open up Notepad and\ntry to generate one that way.\n\n174\n00:08:49.970 --> 00:08:54.490\nSo Microsoft actually has a tool\ncalled MakeCert, makecert.exe.\n\n175\n00:08:54.490 --> 00:08:59.080\nNow finding that tool proved to\nbe a little challenging, but\n\n176\n00:08:59.080 --> 00:09:01.350\nI got it done, so\nI'm gonna help you guys out here.\n\n177\n00:09:01.350 --> 00:09:05.552\nEverything I've been reading out there\nsays, hey, all you gotta do is go download\n\n178\n00:09:05.552 --> 00:09:09.393\nthe latest version of Visual Studio\nCommunity Edition, which is free, and\n\n179\n00:09:09.393 --> 00:09:11.091\nit's got the MakeCert in there.\n\n180\n00:09:11.091 --> 00:09:13.188\nInstall it, and you'll see MakeCert, and\n\n181\n00:09:13.188 --> 00:09:15.464\nyou can start creating\nyour own certificates.\n\n182\n00:09:15.464 --> 00:09:20.040\nSo I did, and it was not a short download\nprocess to get this done, get it all\n\n183\n00:09:20.040 --> 00:09:25.580\ninstalled, and searched, and searched,\nand searched, and could not find it.\n\n184\n00:09:25.580 --> 00:09:31.197\nAfter going through several blogs,\nand several choice words, I realized\n\n185\n00:09:31.197 --> 00:09:36.918\nthat Microsoft has actually moved a lot\nof their tools into the Windows SDK.\n\n186\n00:09:36.918 --> 00:09:37.982\nWhich is just not being reflected\n\n187\n00:09:37.982 --> 00:09:39.770\nout there on a lot of the things\nyou read on the Internet.\n\n188\n00:09:39.770 --> 00:09:44.210\nSo, what you really need, don't be fooled\nby some of those articles if you try to go\n\n189\n00:09:44.210 --> 00:09:46.770\nlook some information up on this,\ngo get your Windows SDK,\n\n190\n00:09:46.770 --> 00:09:49.520\nyour Software Development Kit.\n\n191\n00:09:49.520 --> 00:09:52.299\nI'm running Windows 8.1 on this laptop, so\n\n192\n00:09:52.299 --> 00:09:55.849\nI've got the Software Development Kit for\nWindows 8.1.\n\n193\n00:09:55.849 --> 00:09:57.852\nIf you've got a different\noperating system,\n\n194\n00:09:57.852 --> 00:10:00.540\nthen you're gonna wanna\nget the appropriate one.\n\n195\n00:10:00.540 --> 00:10:03.000\nAnother one that's not\nsuper quick to download,\n\n196\n00:10:03.000 --> 00:10:06.650\nbut it does have a lot of things\nin it which are kinda cool.\n\n197\n00:10:06.650 --> 00:10:11.650\nSo we're not going to go through all of\nthat, but there are a lot of useful tools.\n\n198\n00:10:11.650 --> 00:10:13.100\nSo you might already have the SDK.\n\n199\n00:10:13.100 --> 00:10:16.310\nIf you do any type of development or\nanything like that,\n\n200\n00:10:16.310 --> 00:10:17.340\nyou might already have this.\n\n201\n00:10:18.360 --> 00:10:23.430\nOnce you get that installed, then the\nquestion was, where the heck did it go?\n\n202\n00:10:23.430 --> 00:10:27.470\nBecause it doesn't show up on my,\nwell I don't have a Start menu any more.\n\n203\n00:10:27.470 --> 00:10:32.610\nIt doesn't show up on my Start screen,\nit's nowhere to be found.\n\n204\n00:10:32.610 --> 00:10:36.670\nSo you need to go explore and\nfind it and I'll save you the trouble.\n\n205\n00:10:36.670 --> 00:10:40.020\nWe're gonna go into C: Program Files.\n\n206\n00:10:40.020 --> 00:10:44.284\nAnd then not Microsoft SDKs, where you\nmight think you would find the software\n\n207\n00:10:44.284 --> 00:10:46.617\ndevelopment kit that you just installed.\n\n208\n00:10:46.617 --> 00:10:47.368\n>> That just makes sense.\n\n209\n00:10:47.368 --> 00:10:48.913\n>> Yeah, well we're not gonna do that.\n\n210\n00:10:48.913 --> 00:10:49.629\n>> Forget that part?\n\n211\n00:10:49.629 --> 00:10:51.784\n[LAUGH]\n>> If it makes sense that would be crazy\n\n212\n00:10:51.784 --> 00:10:52.705\n[LAUGH] all right.\n\n213\n00:10:52.705 --> 00:10:56.593\nSo yes, it is indeed not in here,\nthere are a few things in there, but\n\n214\n00:10:56.593 --> 00:10:58.460\nnot what we're looking for.\n\n215\n00:10:58.460 --> 00:11:02.619\nThere's actually Windows Kits\nway down here, and\n\n216\n00:11:02.619 --> 00:11:06.969\ninside Windows Kits I'll\nfind an 8.1 folder, and\n\n217\n00:11:06.969 --> 00:11:10.810\ninside there I will find a Bin folder.\n\n218\n00:11:10.810 --> 00:11:16.056\nInside there, I'll find my x64,\ncuz that's what I'm running,\n\n219\n00:11:16.056 --> 00:11:20.771\nand in here, this is where I'm\ngoing to find makecert.exe.\n\n220\n00:11:20.771 --> 00:11:23.155\nAnd that is actually what I'm looking for.\n\n221\n00:11:23.155 --> 00:11:24.273\n>> So very intuitive [LAUGH].\n\n222\n00:11:24.273 --> 00:11:25.161\n>> Yes, right [LAUGH]?\n>> I mean,\n\n223\n00:11:25.161 --> 00:11:27.713\nI just thought immediately\nas I saw these folders.\n\n224\n00:11:27.713 --> 00:11:28.546\n>> [LAUGH]\n>> Crazy,\n\n225\n00:11:28.546 --> 00:11:31.332\nsometimes they hide these things from you,\nand thank you Michael, for\n\n226\n00:11:31.332 --> 00:11:32.784\npointing us in the right direction.\n\n227\n00:11:32.784 --> 00:11:33.966\n>> [LAUGH] No problem.\n\n228\n00:11:33.966 --> 00:11:36.460\nSo now you know exactly where to look for\nthat.\n\n229\n00:11:36.460 --> 00:11:38.260\nAnd like I said,\nyou probably already looked there.\n\n230\n00:11:38.260 --> 00:11:40.970\nI was like yeah, Mike,\nthat's the first place I looked.\n\n231\n00:11:40.970 --> 00:11:42.270\nAll right, so now we know where that is.\n\n232\n00:11:42.270 --> 00:11:43.700\nNow the next problem is,\n\n233\n00:11:43.700 --> 00:11:49.020\nI need an administrative command prompt\nto be able to run this successfully.\n\n234\n00:11:49.020 --> 00:11:52.680\nSo I am going to fire up\nan administrative command prompt.\n\n235\n00:11:54.140 --> 00:11:56.099\nA great little trick with Windows,\n\n236\n00:11:56.099 --> 00:12:00.026\nI know I need an administrative\ncommand prompt here at makecert.exe.\n\n237\n00:12:00.026 --> 00:12:05.270\nI could jump back up one folder, and\nactually do a Shift+Right-Click.\n\n238\n00:12:05.270 --> 00:12:07.370\nAnd I can do Cmd+Window here, right?\n\n239\n00:12:07.370 --> 00:12:10.790\nLove that, so the path is already set.\n\n240\n00:12:10.790 --> 00:12:13.730\nThe problem is this is not\nan administrative console or\n\n241\n00:12:13.730 --> 00:12:14.756\nan administrative command prompt.\n\n242\n00:12:14.756 --> 00:12:18.547\nSo, I've launched an administrative\ncommand prompt, and\n\n243\n00:12:18.547 --> 00:12:21.606\nthen I'm just gonna do\na change directory or CD.\n\n244\n00:12:21.606 --> 00:12:24.859\nAnd I happened to copy that path while I\nwas in Windows Explorer just a minute ago.\n\n245\n00:12:24.859 --> 00:12:26.970\nYou might not have seen\nme do that on the sly.\n\n246\n00:12:26.970 --> 00:12:29.260\nI copied that, and\nnow I'm at that right path.\n\n247\n00:12:29.260 --> 00:12:33.470\nAnd let's bump this up a wee bit so\nyou guys out there can see it a little bit\n\n248\n00:12:33.470 --> 00:12:37.680\neasier, as well as me,\nbecause my eyes are old and tired.\n\n249\n00:12:38.890 --> 00:12:40.340\nThat should be good.\n\n250\n00:12:40.340 --> 00:12:41.892\nWe'll get that a little bit bigger.\n\n251\n00:12:41.892 --> 00:12:46.535\nAnd eh, you know what, for\ngiggles, why gray is the default\n\n252\n00:12:46.535 --> 00:12:51.650\ncolor on a black background,\nI never really understood.\n\n253\n00:12:51.650 --> 00:12:53.895\nLet's go with white.\n\n254\n00:12:53.895 --> 00:12:55.093\n>> It tends to pop a little harder.\n\n255\n00:12:55.093 --> 00:13:00.119\n>> It does, it does, or we could do hacker\ngreen, if we wanna do that, so [LAUGH].\n\n256\n00:13:00.119 --> 00:13:03.816\nAlways seems more, I don't know,\nmischievous when you use green.\n\n257\n00:13:03.816 --> 00:13:07.788\nAll right, so what we're gonna do is,\nwe are going to, actually,\n\n258\n00:13:07.788 --> 00:13:10.940\nbefore I do this,\nlet's take care of the Azure side.\n\n259\n00:13:10.940 --> 00:13:14.890\nSo what you need to get started on the\nclient, go ahead and get that downloading.\n\n260\n00:13:14.890 --> 00:13:17.620\nSo that by the time we get\ndone with the Azure stuff,\n\n261\n00:13:17.620 --> 00:13:18.950\nthat's ready to rock and roll.\n\n262\n00:13:18.950 --> 00:13:21.350\nI've already downloaded\nit to save us the time.\n\n263\n00:13:21.350 --> 00:13:26.900\nI'm gonna run out here to, where is Azure?\n\n264\n00:13:26.900 --> 00:13:28.115\n>> It's in the cloud.\n>> There we go.\n\n265\n00:13:28.115 --> 00:13:29.119\nThat's what it is.\n\n266\n00:13:29.119 --> 00:13:30.095\nWhere is that thing?\n\n267\n00:13:30.095 --> 00:13:33.720\n[LAUGH] All right, here we go,\nso back over to Microsoft Azure.\n\n268\n00:13:33.720 --> 00:13:38.020\nAnd I'm going to find my Azure subnet.\n\n269\n00:13:39.830 --> 00:13:41.590\nRight, and\nwe've still got that VPN connection.\n\n270\n00:13:41.590 --> 00:13:45.260\nI tore down the site-to-site\nbetween Tokyo and\n\n271\n00:13:45.260 --> 00:13:48.560\nhere just to simplify\nmy screen a little bit.\n\n272\n00:13:48.560 --> 00:13:51.880\nAnd mainly, and really,\nremember what happens.\n\n273\n00:13:51.880 --> 00:13:56.830\nTo create that site-to-site from Tokyo, we\nhad to do a custom network configuration\n\n274\n00:13:56.830 --> 00:14:00.560\nby downloading that configuration file,\nmodifying it, and\n\n275\n00:14:00.560 --> 00:14:02.420\nthen uploading it back to Azure.\n\n276\n00:14:02.420 --> 00:14:06.510\nWhich everything worked, but as soon as we\ndid that, we've gone beyond what we can\n\n277\n00:14:06.510 --> 00:14:10.880\ndo with the GUI interface, and the GUI\ninterface becomes locked out, right?\n\n278\n00:14:10.880 --> 00:14:12.070\nYou can't really make any changes.\n\n279\n00:14:12.070 --> 00:14:14.484\nRemember that warning\nwe saw across the top?\n\n280\n00:14:14.484 --> 00:14:17.424\nYou're not gonna be able to make any\nchanges because change has been made\n\n281\n00:14:17.424 --> 00:14:19.120\ndirectly to the network configuration.\n\n282\n00:14:19.120 --> 00:14:22.090\nSo I had to do away with all that so\nwe could get back in here.\n\n283\n00:14:22.090 --> 00:14:24.653\nNow technically I could have gone in and\n\n284\n00:14:24.653 --> 00:14:29.166\nreworked that XML file again to\nadd point-to-site connectivity.\n\n285\n00:14:29.166 --> 00:14:31.892\nBut I wanna show you what it's\nlike when you have it set up\n\n286\n00:14:31.892 --> 00:14:35.024\nthe way it's supposed to,\nI won't say the way it's supposed to\n\n287\n00:14:35.024 --> 00:14:35.598\nbe, but-\n>> Normally.\n\n288\n00:14:35.598 --> 00:14:37.166\n>> The normal, yeah,\nthe default configuration. All right, so\n\n289\n00:14:37.166 --> 00:14:42.222\nwe're gonna go to Configure,\nand there again my DNS servers.\n\n290\n00:14:42.222 --> 00:14:46.178\nAnd remember, this is where we chose\nthat site-to-site connectivity and\n\n291\n00:14:46.178 --> 00:14:47.570\nmy local network.\n\n292\n00:14:47.570 --> 00:14:52.320\nWhat I'm gonna do is simply put a check\nmark here for point-to-site connectivity.\n\n293\n00:14:52.320 --> 00:14:54.220\nSo we'll go ahead and\nput a check mark there.\n\n294\n00:14:54.220 --> 00:14:55.420\nAnd once I do that, it says,\n\n295\n00:14:55.420 --> 00:14:57.830\nwell now you're gonna need\nto set up an address space.\n\n296\n00:14:57.830 --> 00:15:01.489\nThese are gonna be the IP addresses that\nare passed out to those points, right,\n\n297\n00:15:01.489 --> 00:15:04.700\nthe ones that are making\nthe point-to-site connectivity.\n\n298\n00:15:04.700 --> 00:15:10.050\nWhat IP address are they gonna use\nwhen they connect into Azure remotely?\n\n299\n00:15:10.050 --> 00:15:14.334\nSo I'm just gonna do this, we've been\ndoing a 10.1 for just about everything.\n\n300\n00:15:14.334 --> 00:15:20.370\nSo 10.1.5.0 I think will work fine for us.\n\n301\n00:15:21.820 --> 00:15:27.620\nAll right, with a /24, so there is\nmy address space that I'm gonna use.\n\n302\n00:15:27.620 --> 00:15:31.370\nOnce we've got that set,\nI'm gonna just save that connection, or\n\n303\n00:15:31.370 --> 00:15:33.370\nsave this configuration.\n\n304\n00:15:33.370 --> 00:15:39.050\nSo we'll click Save, and it tells me\nit could disrupt my connectivity.\n\n305\n00:15:39.050 --> 00:15:41.340\nIt's something you gotta think about\nif you have people connecting in.\n\n306\n00:15:42.610 --> 00:15:44.390\nYou might disrupt their connection for\n\n307\n00:15:44.390 --> 00:15:47.090\na minute while you're making\nthese types of changes.\n\n308\n00:15:47.090 --> 00:15:50.480\nSo we'll wait for that,\nit should not take too terribly long.\n\n309\n00:15:50.480 --> 00:15:52.390\nAnd we'll see what\nhappens when we're done.\n\n310\n00:15:52.390 --> 00:15:57.477\nSo again, really not a lot,\nas you can see so far, to set this up.\n\n311\n00:15:57.477 --> 00:16:01.143\nNow there's a couple more steps that\nwe have to do, we're not done yet.\n\n312\n00:16:01.143 --> 00:16:03.865\nSo we'll get this up and running.\n\n313\n00:16:03.865 --> 00:16:08.110\nAnd I tell you what, while that's\ndoing that, while it's completing that\n\n314\n00:16:08.110 --> 00:16:12.775\nnetwork configuration, we will flip back\nover to our little command prompt here.\n\n315\n00:16:12.775 --> 00:16:15.850\nAnd as soon as I do that,\nI can see it finished in the background.\n\n316\n00:16:15.850 --> 00:16:18.510\nSo there my changes have been saved.\n\n317\n00:16:18.510 --> 00:16:20.000\nI'll click OK.\n\n318\n00:16:20.000 --> 00:16:21.200\nEverything looks good there.\n\n319\n00:16:21.200 --> 00:16:23.230\nNow, you know what I should have done?\n\n320\n00:16:23.230 --> 00:16:24.000\nI forgot to show you.\n\n321\n00:16:24.000 --> 00:16:27.170\nI'm gonna click on, I'm scrolling\nback up to the top, add your subnet,\n\n322\n00:16:27.170 --> 00:16:29.280\nand I'm gonna click on certificates.\n\n323\n00:16:29.280 --> 00:16:32.020\nNow before I check that\nlittle check mark and\n\n324\n00:16:32.020 --> 00:16:35.150\nthen save my changes,\nif you came to this screen it\n\n325\n00:16:35.150 --> 00:16:39.740\nwould say there are no point-to-site\nVPNs configured for this network.\n\n326\n00:16:39.740 --> 00:16:43.370\nAnd it wouldn't let you do anything\nas far as certificates go.\n\n327\n00:16:43.370 --> 00:16:48.110\nCuz, this screen is only used if you've\nconfigured point to site connectivity for\n\n328\n00:16:48.110 --> 00:16:49.580\nyour Azure gateway.\n\n329\n00:16:49.580 --> 00:16:53.010\nNow that I have configured that\npoint-to-site connectivity,\n\n330\n00:16:53.010 --> 00:16:54.670\nthis screen becomes useful and\n\n331\n00:16:54.670 --> 00:16:58.980\nyou can see I've got the option to\nupload a route certificate, right?\n\n332\n00:16:58.980 --> 00:17:00.034\nSo that's what we need.\n\n333\n00:17:00.034 --> 00:17:03.670\nThe next thing we really need is that\nroute certificate, so let's make one.\n\n334\n00:17:04.742 --> 00:17:07.720\nAll right, I'll have to use my little\ncheat sheet here because these\n\n335\n00:17:07.720 --> 00:17:12.530\nare commands you do not use every day,\nso it's going to be makecert.\n\n336\n00:17:12.530 --> 00:17:14.860\nAnd I can do a switch\nquestion mark with make cert,\n\n337\n00:17:14.860 --> 00:17:19.080\nand you'll see some of the switches\nthat we're going to be using.\n\n338\n00:17:19.080 --> 00:17:21.260\nThere's actually many more than this, and\n\n339\n00:17:21.260 --> 00:17:25.420\nyou could do an exclamation\npoint to get even more help.\n\n340\n00:17:25.420 --> 00:17:27.750\nAnd if I do an exclamation point there,\n\n341\n00:17:27.750 --> 00:17:30.760\nyou'll see all of the different\nswitches that can be used.\n\n342\n00:17:30.760 --> 00:17:35.030\nSo, again, this one we're not going to\nbe breaking down how to use Breakcert,\n\n343\n00:17:35.030 --> 00:17:38.600\nother than what we need to make it\nwork for this particular exercise.\n\n344\n00:17:38.600 --> 00:17:41.320\nSo if you want more information,\njust do your switch question mark,\n\n345\n00:17:41.320 --> 00:17:43.460\ndo your switch exclamation point.\n\n346\n00:17:43.460 --> 00:17:48.410\nAnd there's actually a lot of really\ngood techman articles on using MakeCert.\n\n347\n00:17:48.410 --> 00:17:52.470\nAll right, so what we're gonna do is\nwe're gonna type in makecert, and\n\n348\n00:17:52.470 --> 00:17:59.682\nthen it's gonna be -sky exchange -r -n.\n\n349\n00:18:00.710 --> 00:18:05.630\nAnd then in quotes, and really you could\nget away without the quotes if you didn't\n\n350\n00:18:05.630 --> 00:18:07.620\nhave spaces in your name.\n\n351\n00:18:07.620 --> 00:18:11.730\nI like to put the quotes there just\nin case, just a a matter of habit.\n\n352\n00:18:11.730 --> 00:18:17.086\nAnd I'm gonna call this my AzureRootCert,\n\n353\n00:18:17.086 --> 00:18:19.844\nsomething like that.\n\n354\n00:18:19.844 --> 00:18:22.282\nAnd I'll end my quote,\nyou could name it whatever you what.\n\n355\n00:18:22.282 --> 00:18:23.760\nIt doe not matter.\n\n356\n00:18:23.760 --> 00:18:25.430\nAs long as you know what it is.\n\n357\n00:18:25.430 --> 00:18:28.781\nYou can call it Mike's thing-a-ma-jig,\ncertificate of Bob, or whatever,\n\n358\n00:18:28.781 --> 00:18:29.431\nif you want to.\n\n359\n00:18:29.431 --> 00:18:30.476\n>> That'll be fun.\n>> Yeah.\n\n360\n00:18:30.476 --> 00:18:33.433\n>> [LAUGH]\n>> [LAUGH] All right, so\n\n361\n00:18:33.433 --> 00:18:38.452\nwhatever name you wanna call it,\n-pe -a sha1.\n\n362\n00:18:38.452 --> 00:18:40.453\nThere's something we can recognize, right?\n\n363\n00:18:40.453 --> 00:18:47.658\n-length or -len 2048.\n\n364\n00:18:47.658 --> 00:18:51.732\nAnd then -ss My.\n\n365\n00:18:52.780 --> 00:18:55.580\nI really don't need to capitalize that.\n\n366\n00:18:55.580 --> 00:18:59.720\nAnd then in quotes,\nwe're going to do the same thing,\n\n367\n00:18:59.720 --> 00:19:05.250\nI'm going to call it AzurerootCert.cer,\n\n368\n00:19:05.250 --> 00:19:08.190\nand then end my quote.\n\n369\n00:19:10.310 --> 00:19:11.770\nSo, that the gist that we're using, S-H-A,\n\n370\n00:19:11.770 --> 00:19:16.410\nsha1, is the algorithm to\nsign this certificate.\n\n371\n00:19:16.410 --> 00:19:19.700\nIt's gonna use a key length of 2048,\nthere.\n\n372\n00:19:19.700 --> 00:19:22.970\nI'll hit Enter, and\nhopefully I get succeeded.\n\n373\n00:19:22.970 --> 00:19:24.290\nAnd then, you know what I did, Daniel?\n\n374\n00:19:24.290 --> 00:19:25.980\nI did this last time and I forgot.\n\n375\n00:19:25.980 --> 00:19:28.082\nI was like,\ndon't do that at the show, Michael.\n\n376\n00:19:28.082 --> 00:19:30.990\n>> [LAUGH]\n>> Because I didn't put any pads in there,\n\n377\n00:19:30.990 --> 00:19:32.980\nfinding that cert is challenging,\n\n378\n00:19:34.130 --> 00:19:38.330\nbecause it goes into the location of where\nyou're running the prompt from, right?\n\n379\n00:19:38.330 --> 00:19:41.740\nI really should have put a sequel or\nbackslash or something in there.\n\n380\n00:19:41.740 --> 00:19:44.715\nBut, hey, I'll show you what happens\nwhen you don't do it correctly.\n\n381\n00:19:44.715 --> 00:19:48.369\nYou get to go back into this location and\nyou should be able to find,\n\n382\n00:19:48.369 --> 00:19:50.870\nwhat did we call it, Azurerootcert.cert.\n\n383\n00:19:50.870 --> 00:19:52.180\nThere it is.\n\n384\n00:19:52.180 --> 00:19:56.370\nAnd I'm just going to cut that and\nput it in my downloads, so\n\n385\n00:19:56.370 --> 00:19:57.410\nit's a little bit easier to find.\n\n386\n00:19:58.590 --> 00:20:00.030\n>> You missed a prime opportunity there,\nMike,\n\n387\n00:20:00.030 --> 00:20:03.033\nto really make it look like, I'm gonna\nshow you the wrong way to do this.\n\n388\n00:20:03.033 --> 00:20:03.680\n>> [LAUGH]\n>> And\n\n389\n00:20:03.680 --> 00:20:06.010\nthen we can better\nunderstand the right way.\n\n390\n00:20:06.010 --> 00:20:08.280\nBut you stuck yourself under the bus.\n\n391\n00:20:08.280 --> 00:20:09.030\n>> I know, I know.\n\n392\n00:20:09.030 --> 00:20:10.930\nYou know, those darn buses.\n\n393\n00:20:10.930 --> 00:20:15.642\nAll right, so now we've got that root\ncertificate, now we're gonna go back over\n\n394\n00:20:15.642 --> 00:20:19.276\nto Azure, and we're gonna choose\nUPLOAD A ROOT CERTIFICATE.\n\n395\n00:20:19.276 --> 00:20:20.995\nSo we'll go ahead and check that.\n\n396\n00:20:20.995 --> 00:20:24.150\nAnd then we'll click BROWSE FOR FILE...\n\n397\n00:20:24.150 --> 00:20:26.520\nAnd I'm gonna go grab\nmy AzureRootCert.cer.\n\n398\n00:20:26.520 --> 00:20:31.580\nRemember, this is a .cer so\nit does not contain the private key.\n\n399\n00:20:31.580 --> 00:20:33.440\nAll right, it's just the certificate.\n\n400\n00:20:33.440 --> 00:20:37.190\nAnd we'll click Open and\nthen our little check mark there.\n\n401\n00:20:37.190 --> 00:20:41.670\nAnd we'll give it a second, and\nit begins the upload process.\n\n402\n00:20:44.050 --> 00:20:49.120\nAll right, I'll tell you, Azure will\ntell you you can upload 20 certificates.\n\n403\n00:20:49.120 --> 00:20:51.322\nThat's quite a few if you\nhad different 20 roots,\n\n404\n00:20:51.322 --> 00:20:54.126\nI'd say maybe we need to rethink\nyour public infrastructure, but\n\n405\n00:20:54.126 --> 00:20:56.999\nyou know you might have a good reason for\ndoing something like that.\n\n406\n00:20:56.999 --> 00:21:00.801\nSo, maybe you do but you can upload\nup to 20 certificates up here,\n\n407\n00:21:00.801 --> 00:21:01.946\nmore if you need to.\n\n408\n00:21:01.946 --> 00:21:04.811\nIf you contact them, I'm sure they'll\ncharge you a little bit of money and\n\n409\n00:21:04.811 --> 00:21:05.459\nlet you do more.\n\n410\n00:21:05.459 --> 00:21:08.711\nAll right, so\nnow the root cert is up there on Azure and\n\n411\n00:21:08.711 --> 00:21:11.650\nit's associated with my Azure subnet.\n\n412\n00:21:11.650 --> 00:21:13.920\nSo we are halfway there.\n\n413\n00:21:13.920 --> 00:21:15.150\nMore than halfway.\n\n414\n00:21:15.150 --> 00:21:18.090\nAll right, now we go back over to\nthe command prompt, all right, and\n\n415\n00:21:18.090 --> 00:21:20.110\nwe're gonna run that makecert.\n\n416\n00:21:20.110 --> 00:21:24.560\nSo what I need to do now is generate\ncertificates that I install on the client\n\n417\n00:21:24.560 --> 00:21:26.570\nmachine, okay?\n\n418\n00:21:26.570 --> 00:21:33.956\nSo for that, we're going to use the same\ncommand prompt here, makecert -n.\n\n419\n00:21:33.956 --> 00:21:38.879\nAnd then in quote cn equals and\nI'm gonna call this one I\n\n420\n00:21:38.879 --> 00:21:43.710\ncan't remember what I call\nthis little laptop here.\n\n421\n00:21:43.710 --> 00:21:46.760\nI'm gonna say laptop01.\n\n422\n00:21:48.430 --> 00:21:50.306\nI know that's not his name but\nthat's what we'll call it.\n\n423\n00:21:50.306 --> 00:21:55.473\nI also have laptop 01 in my quotes and\n\n424\n00:21:55.473 --> 00:22:00.002\nthen it's -pe -skyexchange.\n\n425\n00:22:00.002 --> 00:22:05.656\nMake sure I don't make any typos there,\n\n426\n00:22:05.656 --> 00:22:12.150\n-m96-66my -in, and then open quote.\n\n427\n00:22:12.150 --> 00:22:18.199\nAnd then here, I need to do AzureRootCert,\n\n428\n00:22:18.199 --> 00:22:22.294\nand end my quote, all right?\n\n429\n00:22:22.294 --> 00:22:30.753\nAnd then -is my -a sha1, all right?\n\n430\n00:22:30.753 --> 00:22:36.457\nSo what we're doing is we're generating\na certificate in the name of laptop 01,\n\n431\n00:22:36.457 --> 00:22:39.153\nbut issued by AzureRootCert, right?\n\n432\n00:22:39.153 --> 00:22:40.230\nStarting to make sense?\n\n433\n00:22:40.230 --> 00:22:43.605\nEspecially those of you that\nunderstand public infrastructure?\n\n434\n00:22:43.605 --> 00:22:46.100\nYou got that root certificate\nup there on Azure.\n\n435\n00:22:46.100 --> 00:22:49.180\nThis certificate I'm generating\nis gonna have a trust chain,\n\n436\n00:22:49.180 --> 00:22:53.120\nright, back up to that root\ncertificate that we uploaded To Azure.\n\n437\n00:22:53.120 --> 00:22:57.580\nSo I'll go ahead and hit Enter,\nand it succeeds, right?\n\n438\n00:22:57.580 --> 00:22:58.990\nNow here's the trick with this,\n\n439\n00:22:58.990 --> 00:23:04.730\nyou will need to generate a different\ncertificate for each node, all right.\n\n440\n00:23:04.730 --> 00:23:08.720\nSo if I add another laptop, what I would\ndo is I would just come in here like this\n\n441\n00:23:08.720 --> 00:23:12.650\nand I would change this to laptop02.\n\n442\n00:23:12.650 --> 00:23:14.630\nAll right and I would continue on and\n\n443\n00:23:14.630 --> 00:23:19.950\nmake as many certificates as I needed for\ndifferent devices.\n\n444\n00:23:19.950 --> 00:23:24.119\nAnd anytime somebody says, \"Hey I need\nanother one of those certs.\" I can open up\n\n445\n00:23:24.119 --> 00:23:27.933\nthis computer the one that has the root\ncertificate that I generated on it and\n\n446\n00:23:27.933 --> 00:23:29.184\nI can run this command and\n\n447\n00:23:29.184 --> 00:23:32.301\nI can generate more client\ncertificates based off that root.\n\n448\n00:23:32.301 --> 00:23:33.971\nSo you can generate a few at a time.\n\n449\n00:23:33.971 --> 00:23:38.647\nYou can wait until you need one,\ncome back in and issue it.\n\n450\n00:23:38.647 --> 00:23:42.052\nAll right now we need to,\nlet's go check and\n\n451\n00:23:42.052 --> 00:23:47.209\nsee let's do a little Microsoft\nmanagement console real quick and\n\n452\n00:23:47.209 --> 00:23:53.396\nwe'll add our certificate snap in and\njust verify that Mike's not lying to us.\n\n453\n00:23:53.396 --> 00:23:54.395\n>> At least not about this.\n\n454\n00:23:54.395 --> 00:23:56.467\n>> Yeah, right [LAUGH]\n>> [LAUGH]\n\n455\n00:23:56.467 --> 00:23:58.176\n>> All right, and we go on here.\n\n456\n00:23:58.176 --> 00:24:01.528\nAnd there's my AzureRootCert\nsitting right there.\n\n457\n00:24:01.528 --> 00:24:05.734\nAnd there's my three for\nlaptop01, laptop02 and laptop03.\n\n458\n00:24:05.734 --> 00:24:09.552\nNow I said you've got to create one for\neach laptop and then install it.\n\n459\n00:24:09.552 --> 00:24:12.320\nSo let's say Daniel had laptop two.\n\n460\n00:24:12.320 --> 00:24:16.730\nWell what I would need to do is\nexport this key, or this certificate.\n\n461\n00:24:16.730 --> 00:24:20.820\nI'd say right click all tasks, export.\n\n462\n00:24:20.820 --> 00:24:26.030\nI would click next and I'd say yes\nexport that private key, and next.\n\n463\n00:24:26.030 --> 00:24:30.790\nAnd I'd create this PFX file,\n\n464\n00:24:30.790 --> 00:24:35.360\nsend it over to Daniel, tell him to\ninstall it into his trusted certificates,\n\n465\n00:24:35.360 --> 00:24:39.930\nor install it myself, whatever\nthe process that our organization uses.\n\n466\n00:24:39.930 --> 00:24:43.260\nSo you just export that out,\ngive it to the other laptop.\n\n467\n00:24:43.260 --> 00:24:44.070\nHave them install it.\n\n468\n00:24:44.070 --> 00:24:46.750\nThe one for\nlaptop one is already installed.\n\n469\n00:24:46.750 --> 00:24:49.065\nThis is where I generated it.\n\n470\n00:24:49.065 --> 00:24:55.770\nAll right now that is successful or that\nwe were successful there I'm not gonna.\n\n471\n00:24:55.770 --> 00:24:58.620\nActually let's just minimize that\nin case we want to come back.\n\n472\n00:24:58.620 --> 00:25:01.370\nAll right so we've got the root\ncertificate generated up there and\n\n473\n00:25:01.370 --> 00:25:03.100\nuploaded to Azure.\n\n474\n00:25:03.100 --> 00:25:05.420\nI've got the client\ncertificate created and\n\n475\n00:25:05.420 --> 00:25:09.338\ninstalled in my certificate\nstore on my laptop.\n\n476\n00:25:09.338 --> 00:25:13.550\nWe've enabled point-to-site\nconnectivity in Azure.\n\n477\n00:25:13.550 --> 00:25:16.780\nThe only thing we have left to do\nis establish the VPN connection now\n\n478\n00:25:16.780 --> 00:25:19.230\nfrom the client to Azure.\n\n479\n00:25:19.230 --> 00:25:21.550\nHow do we do that, well, watch.\n\n480\n00:25:21.550 --> 00:25:25.850\nRemember that little script we used to set\nup our VPN server that Microsoft was so\n\n481\n00:25:25.850 --> 00:25:27.100\nnice to give us?\n\n482\n00:25:27.100 --> 00:25:28.530\nLet's see what they do for this.\n\n483\n00:25:28.530 --> 00:25:30.730\nI'm going to back over to\nthe dashboard actually,\n\n484\n00:25:30.730 --> 00:25:32.310\nthat was a little misclick there.\n\n485\n00:25:32.310 --> 00:25:35.630\nI'm on my Azure subnet,\nback over to dashboard,\n\n486\n00:25:35.630 --> 00:25:37.830\nand you'll see things have\nchanged here already.\n\n487\n00:25:37.830 --> 00:25:39.549\nThere's my ITPRoTV LAN.\n\n488\n00:25:39.549 --> 00:25:44.950\nThis one is for my point to site\nconnectivity, I've got zero clients.\n\n489\n00:25:44.950 --> 00:25:47.800\nI scroll down though our\nquick glance has changed.\n\n490\n00:25:47.800 --> 00:25:54.180\nIt used to be download VPN device script,\nnow I've got a couple extra links here.\n\n491\n00:25:54.180 --> 00:25:56.760\nBecause we checked the check mark for\nthe for\n\n492\n00:25:56.760 --> 00:26:01.199\npoint to site connectivity I'm going to\ndownload the 64-bit client VPN package.\n\n493\n00:26:04.470 --> 00:26:06.800\nAnd we'll let that process run just for\na second.\n\n494\n00:26:06.800 --> 00:26:11.100\nSo it's basically downloading\na little VPN configuration.\n\n495\n00:26:11.100 --> 00:26:13.330\nAnd I could save it and then run it.\n\n496\n00:26:13.330 --> 00:26:14.840\nI'm just gonna run it from right here.\n\n497\n00:26:14.840 --> 00:26:20.690\nAll right, and\nit tells me that Windows protected my PC.\n\n498\n00:26:20.690 --> 00:26:22.840\nThank you, Window, for keeping me safe.\n\n499\n00:26:22.840 --> 00:26:25.530\nSo I'm gonna click More info,\nand run it anyway.\n\n500\n00:26:27.770 --> 00:26:33.090\nAnd then yes, do I wish to install\na VPN client for Azure Subnet?\n\n501\n00:26:33.090 --> 00:26:34.650\nYes I do.\n\n502\n00:26:36.780 --> 00:26:39.194\nAnd that's it, right.\n\n503\n00:26:39.194 --> 00:26:44.535\nIt flashes, it whirs, and\nlet's see what happened there.\n\n504\n00:26:44.535 --> 00:26:47.120\nGonna go ahead and minimize everything.\n\n505\n00:26:47.120 --> 00:26:49.990\nAnd we'll take a look at my networks,\nand take a look.\n\n506\n00:26:49.990 --> 00:26:53.650\nThere is my VPN connection for\nAzure subnet.\n\n507\n00:26:53.650 --> 00:26:55.660\nAnd before I connect,\nlet's just see something here.\n\n508\n00:26:55.660 --> 00:27:00.900\nIf l take a look, this machine,\nin fact, let's close this guy.\n\n509\n00:27:00.900 --> 00:27:03.630\nThis is a virtual machine\nthat I am running.\n\n510\n00:27:03.630 --> 00:27:05.440\nAnd it's not on any of my networks, right?\n\n511\n00:27:05.440 --> 00:27:10.940\nIt's not on my corporate network,\nthe 10.1.1 network.\n\n512\n00:27:10.940 --> 00:27:12.504\nit's not on Azure, 10.1.2.\n\n513\n00:27:12.504 --> 00:27:15.429\nIt's not in the Tokyo office, 10.1.3.\n\n514\n00:27:15.429 --> 00:27:19.080\nSo it really has no connectivity\nother than Internet access.\n\n515\n00:27:19.080 --> 00:27:24.090\nSo this would be just like a laptop\nsitting at the hotel or at the airport.\n\n516\n00:27:24.090 --> 00:27:28.655\nIf I do a little ip config,\nyou'll see my ip address is\n\n517\n00:27:28.655 --> 00:27:33.936\nactually [SOUND] 192.168.238.135, right.\n\n518\n00:27:33.936 --> 00:27:39.790\nI do have internet access\nfrom this machine.\n\n519\n00:27:39.790 --> 00:27:41.870\nI'm getting now behind it a NAT device so\n\n520\n00:27:41.870 --> 00:27:44.270\nI'm able to go out and\nget internet access.\n\n521\n00:27:44.270 --> 00:27:48.060\nBut if I tried to ping 10.1.2.4\nthat DC up there in azure,\n\n522\n00:27:48.060 --> 00:27:51.730\nthat's not going to work, right?\n\n523\n00:27:51.730 --> 00:27:57.140\nIt's a private IP address, has no idea\nwhere that is or how to access it.\n\n524\n00:27:57.140 --> 00:27:59.392\n>> Not even on the same network if it did.\n\n525\n00:27:59.392 --> 00:28:02.500\n[INAUDIBLE] completely separate networks,\nthis is just like any, your home,\n\n526\n00:28:02.500 --> 00:28:06.720\njust like a network at home,\njust like a network in a coffee house.\n\n527\n00:28:06.720 --> 00:28:09.200\nOr at, like Mike said,\nan airport, something like that.\n\n528\n00:28:09.200 --> 00:28:11.540\nThese private networks are all over the\nplace and we can connect to them a lot.\n\n529\n00:28:11.540 --> 00:28:13.820\nEspecially if we're mobile users.\n\n530\n00:28:13.820 --> 00:28:17.600\nNothing dissimilar from anything you've\nprobably encountered in the past.\n\n531\n00:28:17.600 --> 00:28:20.960\n>> So we'll go here and\nclick on that azure subnet.\n\n532\n00:28:20.960 --> 00:28:21.750\nAnd click Connect.\n\n533\n00:28:24.100 --> 00:28:27.970\nAnd it tells me to click Connect to begin\nconnecting, to work offline click Cancel.\n\n534\n00:28:27.970 --> 00:28:29.600\nWell, we're going to click Connect.\n\n535\n00:28:30.710 --> 00:28:33.860\nAnd tells me I can\nupdate my routing table.\n\n536\n00:28:33.860 --> 00:28:35.690\nIt will update my routing table, right.\n\n537\n00:28:35.690 --> 00:28:39.350\nBecause again,\nhere I am with this laptop at a hotel.\n\n538\n00:28:39.350 --> 00:28:44.430\nEven once I establish this connection,\ndoes my computer know, hey anything going\n\n539\n00:28:44.430 --> 00:28:49.580\nto the 10.1.2.0 network, my Azure subnet,\nsend it through this particular tunnel.\n\n540\n00:28:49.580 --> 00:28:55.720\nSo I'll say continue, and\nthen I'm going to select my certificate.\n\n541\n00:28:55.720 --> 00:29:00.690\nBecause I have multiples, all right,\nI could export those other two out.\n\n542\n00:29:00.690 --> 00:29:03.690\nAnd then remove them from\nmy certificate store so\n\n543\n00:29:03.690 --> 00:29:05.800\nthat I wouldn't get this\nmessage every time.\n\n544\n00:29:05.800 --> 00:29:08.580\nJust leave the one for\nthis particular laptop.\n\n545\n00:29:08.580 --> 00:29:11.338\nBut I'll select that one, I'll click OK.\n\n546\n00:29:14.856 --> 00:29:19.227\nAnd then, like magic,\nnothing happens, right.\n\n547\n00:29:19.227 --> 00:29:22.350\nNow, you guys know how it is,\nI always love teasing people with that.\n\n548\n00:29:22.350 --> 00:29:26.180\nIt's not like people always confuse\nVPNs and remote desktop, and they do\n\n549\n00:29:26.180 --> 00:29:30.620\na VPN connection, they expect a desktop\nto open up or a different background.\n\n550\n00:29:30.620 --> 00:29:34.910\nA VPN connection is just like taking\na cable from your machine and\n\n551\n00:29:34.910 --> 00:29:36.380\nplugging it into a switch.\n\n552\n00:29:36.380 --> 00:29:38.650\nNothing changes on your machine per se,\n\n553\n00:29:38.650 --> 00:29:42.520\nother than the fact that you should now\nbe able to access new resources, right.\n\n554\n00:29:42.520 --> 00:29:49.570\nLet's see, ping 10.1.2.4 and\nthere's my reply.\n\n555\n00:29:49.570 --> 00:29:54.970\nSo this point, I'm sitting at a hotel,\nyet I'm connected to that Azure network.\n\n556\n00:29:54.970 --> 00:29:57.730\nSo if I needed to access domain resources.\n\n557\n00:29:57.730 --> 00:30:00.660\nIf I needed to, if they had file servers,\n\n558\n00:30:00.660 --> 00:30:06.090\nprint servers, SharePoint sites, whatever\nthe case was, I'm now connected to Azure.\n\n559\n00:30:06.090 --> 00:30:10.090\nI've got a secure tunnel\nthat's being encrypted\n\n560\n00:30:10.090 --> 00:30:11.900\nall the way up to that Azure site.\n\n561\n00:30:11.900 --> 00:30:16.320\nAnd I could be anywhere that has Internet\naccess and I can establish that.\n\n562\n00:30:16.320 --> 00:30:19.070\nThat's the key, right, I don't have\nto be at the corporate office.\n\n563\n00:30:19.070 --> 00:30:21.620\nI don't have to be at the branch office.\n\n564\n00:30:21.620 --> 00:30:23.530\nAll I need is internet access and\nI'm good to go.\n\n565\n00:30:23.530 --> 00:30:25.950\nAnd you saw it,\nnot to terribly difficult to set up.\n\n566\n00:30:25.950 --> 00:30:27.370\n>> Yeah and I like your analogy.\n\n567\n00:30:27.370 --> 00:30:29.650\nIt's basically like you\ntook that lovely and\n\n568\n00:30:29.650 --> 00:30:32.930\nblue cable you plugged in your computer\nand plugged it into the wall and\n\n569\n00:30:32.930 --> 00:30:36.570\nit magically connected you\nto your corporate network.\n\n570\n00:30:36.570 --> 00:30:37.912\nGiving you access to all those resources.\n\n571\n00:30:37.912 --> 00:30:43.140\nThat's the beauty of VPN and now we're\nbeing able to marry the the Azure,\n\n572\n00:30:43.140 --> 00:30:45.671\nusing Azure as another resource and\n\n573\n00:30:45.671 --> 00:30:49.990\nsaying, I've got a data center\non this side of the world.\n\n574\n00:30:49.990 --> 00:30:53.280\nMaybe I've flown across the country and\nI'm in California.\n\n575\n00:30:53.280 --> 00:30:57.240\nAnd now I can access the data center that\nwe have already there in Azure, right.\n\n576\n00:30:57.240 --> 00:31:01.320\nIt's a quick, fast connection, secure to\nthe VPN, and I've done it straight from\n\n577\n00:31:01.320 --> 00:31:05.430\nthe laptop when I'm sitting in my\nhotel room, accessing resources.\n\n578\n00:31:05.430 --> 00:31:07.110\nLovely, lovely way to fly.\n\n579\n00:31:07.110 --> 00:31:09.880\nAnd a lot of people do this,\nI've seen this,\n\n580\n00:31:09.880 --> 00:31:11.810\nI've had to implement this\nkind of thing before.\n\n581\n00:31:11.810 --> 00:31:16.630\nSo get ready because it is\nsomething you will do if this is\n\n582\n00:31:16.630 --> 00:31:18.550\nthe job description that you sign up for.\n\n583\n00:31:18.550 --> 00:31:21.829\nMike, is there anything else that\nwe need to cover as far as these,\n\n584\n00:31:21.829 --> 00:31:24.831\nnot multisite but\npoint to site VPN again, very confusing.\n\n585\n00:31:24.831 --> 00:31:28.277\n>> I don't think it is it's just the key\nto remember is you'll need different\n\n586\n00:31:28.277 --> 00:31:29.600\ncertificates for each one.\n\n587\n00:31:29.600 --> 00:31:34.530\nNow technically that certificate is\nnot tied to my lap top in anyway.\n\n588\n00:31:34.530 --> 00:31:39.580\nAnd I could use that one certificate\nacross multiple laptops, but best\n\n589\n00:31:39.580 --> 00:31:44.380\npractice says issue a separate certificate\nfor each one because I can control access.\n\n590\n00:31:44.380 --> 00:31:48.460\nI might revoke one of those certificates\nif I don't want that person using that\n\n591\n00:31:48.460 --> 00:31:50.640\nlaptop to connect anymore,\nmaybe they've left the company.\n\n592\n00:31:50.640 --> 00:31:53.940\nIn other words if I start sharing\ncertificates across machines\n\n593\n00:31:53.940 --> 00:31:56.740\nI lose all of that control, right.\n\n594\n00:31:56.740 --> 00:32:00.160\nSo, even though you could, best\npractice says different certificate for\n\n595\n00:32:00.160 --> 00:32:01.440\neach laptop.\n\n596\n00:32:01.440 --> 00:32:03.750\nNot the root,\nonly one root that we uploaded, but\n\n597\n00:32:03.750 --> 00:32:05.660\neach laptop get's a different certificate.\n\n598\n00:32:05.660 --> 00:32:08.570\n>> All right, well thank you so much\nMichael for showing us how to do this.\n\n599\n00:32:08.570 --> 00:32:13.800\nObviously it's a very handy feature set\nto have in our tool kit for us as admins.\n\n600\n00:32:13.800 --> 00:32:16.180\nHopefully you've enjoyed it,\nI sure had a good time as well.\n\n601\n00:32:16.180 --> 00:32:17.360\nWe thank you for watching.\n\n602\n00:32:17.360 --> 00:32:20.410\nSigning off for ITProTV,\nI've been your host Daniel Lowrie.\n\n603\n00:32:20.410 --> 00:32:21.220\n>> And I'm Mike Rodrick.\n\n604\n00:32:21.220 --> 00:32:23.106\n>> And we'll see you next time.\n\n605\n00:32:23.106 --> 00:32:29.940\n[SOUND]\n\n",
          "vimeoId": "155693280"
        },
        {
          "description": "In this episode, Mike and Daniel walk you through the new Azure Portal. Here they show you the differences in the look and function of the new Azure Portal from that of the Classic Azure Portal. They also show you how to use the new Portal to access certain features of the Classic portal.",
          "length": "1520",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-1-the_new_azure_portal-021616-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-1-the_new_azure_portal-021616-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-1-the_new_azure_portal-021616-1-sm.jpg",
          "title": "The New Azure Portal",
          "transcript": "WEBVTT\n\n1\n00:00:00.019 --> 00:00:10.019\n[MUSIC]\n\n2\n00:00:12.238 --> 00:00:16.560\nAll right, greetings everyone, and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.560 --> 00:00:18.400\nI'm your host Daniel Lowrie, and\n\n4\n00:00:18.400 --> 00:00:22.500\nin today's episode we are moving\non with our AD and Azure series.\n\n5\n00:00:22.500 --> 00:00:25.816\nJoining back in the studio again today\nis none other than our good friend Mr.\n\n6\n00:00:25.816 --> 00:00:26.530\nMike Roger.\n\n7\n00:00:26.530 --> 00:00:28.120\nMike, welcome back to the show sir,\nhow you doing?\n\n8\n00:00:28.120 --> 00:00:29.020\n>> Doing great Daniel.\n\n9\n00:00:29.020 --> 00:00:29.970\nThanks for having me back.\n\n10\n00:00:29.970 --> 00:00:33.340\nAnd today we're gonna be\nkinda changing gears.\n\n11\n00:00:33.340 --> 00:00:37.520\nWe've been working in what\nwe call the classic mode or\n\n12\n00:00:37.520 --> 00:00:41.120\nthe classic portal for\nall of these episodes.\n\n13\n00:00:41.120 --> 00:00:42.530\nAnd I did that on purpose.\n\n14\n00:00:42.530 --> 00:00:45.060\nBecause one it's been around for\na long time.\n\n15\n00:00:45.060 --> 00:00:49.160\nThis is the original interface\nthat we used to work with Azure.\n\n16\n00:00:49.160 --> 00:00:52.790\nSo if anybody's out there has already\nbeen working with Azure you're\n\n17\n00:00:52.790 --> 00:00:56.610\ngonna be familiar with this probably\nwhere you spend a lot of you time.\n\n18\n00:00:56.610 --> 00:01:00.870\nAnd it really is I won't say complete cuz\n\n19\n00:01:00.870 --> 00:01:03.885\nthat would imply that the other one is\nnot, but the other one is not complete.\n\n20\n00:01:03.885 --> 00:01:07.500\n[LAUGH] So maybe there's nothing\nwrong with implying that.\n\n21\n00:01:07.500 --> 00:01:10.840\nBut no, this is the classic portal but\nthings are changing.\n\n22\n00:01:10.840 --> 00:01:15.020\nMicrosoft is moving to what they call,\ntheir new portal.\n\n23\n00:01:15.020 --> 00:01:18.880\nThis one is being rebranded\nas the classic portal and\n\n24\n00:01:18.880 --> 00:01:22.390\nthe new portal is just\ncalled the Azure portal.\n\n25\n00:01:22.390 --> 00:01:24.680\nAnd it's a little bit confusing right now.\n\n26\n00:01:24.680 --> 00:01:26.850\nIf you guys are gonna\nstart working with Azure,\n\n27\n00:01:26.850 --> 00:01:31.022\nif you start doing any research out there\non Azure, you're looking at all these\n\n28\n00:01:31.022 --> 00:01:34.860\ndifferent technotic articles and blogs and\nthings like that about how to do things.\n\n29\n00:01:34.860 --> 00:01:38.780\nYou really have to pay attention\nto which portal you're using\n\n30\n00:01:38.780 --> 00:01:40.110\nbecause they are different.\n\n31\n00:01:40.110 --> 00:01:44.340\nAnd not just in the way they look and\nfeel, but the functionality, right?\n\n32\n00:01:44.340 --> 00:01:48.390\nWith the classic portal we create\nwhat we called cloud services.\n\n33\n00:01:48.390 --> 00:01:51.320\nRemember, when we first\ncreated our virtual machine,\n\n34\n00:01:51.320 --> 00:01:56.250\nwe created a storage account, and\nthen we created a cloud service.\n\n35\n00:01:56.250 --> 00:01:58.690\nAnd then we created\nthose virtual machines.\n\n36\n00:01:58.690 --> 00:02:01.690\nWell, we don't have\nthat in the new portal.\n\n37\n00:02:01.690 --> 00:02:04.720\nWe actually don't have\ncloud services at all.\n\n38\n00:02:04.720 --> 00:02:09.650\nThere's something called resource groups\nand it seems to be shifting a little bit.\n\n39\n00:02:09.650 --> 00:02:11.430\nYou'll see what I mean.\n\n40\n00:02:11.430 --> 00:02:16.070\nThis could just be my take on it, but\nit does seem like it's really geared\n\n41\n00:02:16.070 --> 00:02:20.050\ntoward people that are developers and\ndeveloping applications.\n\n42\n00:02:20.050 --> 00:02:23.920\nAnd that we're using the cloud for\npushing out services.\n\n43\n00:02:23.920 --> 00:02:27.510\nIf I want to put out a web\nserver with the sequel back end,\n\n44\n00:02:27.510 --> 00:02:30.810\nI can create this resource group and\nthat would include the sequel server,\n\n45\n00:02:30.810 --> 00:02:34.230\nthe connection between the two\nvirtual networks, the web server and\n\n46\n00:02:34.230 --> 00:02:37.250\neverything I need to\nsupport this application.\n\n47\n00:02:37.250 --> 00:02:41.070\nNot as much just strictly\nIT infrastructure.\n\n48\n00:02:41.070 --> 00:02:44.530\nBut, it can still be done and\nit's still is done.\n\n49\n00:02:44.530 --> 00:02:47.830\nIt's just that it's gonna be\ndone a little bit differently.\n\n50\n00:02:47.830 --> 00:02:52.210\nSo what I thought I'd do with this episode\nis kind of compare and contrast and\n\n51\n00:02:52.210 --> 00:02:56.700\nshow you the different portals that\nwe have available, and look at them.\n\n52\n00:02:56.700 --> 00:03:00.910\nAnd I wanna see, now that we've got\nthings set up using the classic portal,\n\n53\n00:03:00.910 --> 00:03:03.730\nlet's see what it looks\nlike in the new portal.\n\n54\n00:03:03.730 --> 00:03:06.800\nBecause the reason I say you have to be\ncareful is because there are some things\n\n55\n00:03:06.800 --> 00:03:12.650\nyou can do in the classic portal that you\ncan't do anymore in the what they call,\n\n56\n00:03:12.650 --> 00:03:17.930\nagain, another confusion point,\nthe new portal or resource manager.\n\n57\n00:03:17.930 --> 00:03:20.330\nThere's another name for\nit that some people like to call it.\n\n58\n00:03:20.330 --> 00:03:26.320\nSo when you see resource manager,\nthat's again, the new portal for Azure.\n\n59\n00:03:26.320 --> 00:03:31.270\nBut there are some things that you can\ndo in the classic that you can't do yet\n\n60\n00:03:31.270 --> 00:03:32.270\nin the new portal.\n\n61\n00:03:32.270 --> 00:03:34.880\nBecause it's still being developed,\nit's still being added to.\n\n62\n00:03:34.880 --> 00:03:37.740\nFunctionality is still being\nbrought to that new portal.\n\n63\n00:03:37.740 --> 00:03:40.750\nSo there are some things you\ncan't do in the new portal.\n\n64\n00:03:40.750 --> 00:03:44.490\nThere are things you can\nbuild in the classic portal\n\n65\n00:03:44.490 --> 00:03:48.680\nthat will not talk to resources\nyou create using the new portal.\n\n66\n00:03:48.680 --> 00:03:51.780\nWhich is kinda mind blowing,\nbut because they're different,\n\n67\n00:03:51.780 --> 00:03:55.270\nbecause they're handled differently in the\nbackground, the way Microsoft deals with\n\n68\n00:03:55.270 --> 00:03:59.820\nthis on their cloud infrastructure,\nyou can run into a problem.\n\n69\n00:03:59.820 --> 00:04:02.950\nIf you create a virtual network\nthat in the classic mode and\n\n70\n00:04:02.950 --> 00:04:05.560\nyou go to the new portal and\ntry to create a virtual machine and\n\n71\n00:04:05.560 --> 00:04:07.860\nattach it to that network,\nIt's not gonna happen, right?\n\n72\n00:04:07.860 --> 00:04:13.350\nIt just won't see it, so you really\nhave to kind of pick one or the other.\n\n73\n00:04:13.350 --> 00:04:16.150\nSo, what I would suggest,\nand this is just me.\n\n74\n00:04:16.150 --> 00:04:19.040\nIf you're using the classic portal,\n\n75\n00:04:19.040 --> 00:04:24.140\nit's probably time to start thinking\nabout moving over to the new portal.\n\n76\n00:04:24.140 --> 00:04:28.100\nIf you're not started yet, then you\nmight wanna just skip the classic and\n\n77\n00:04:28.100 --> 00:04:31.040\ngo right to the new portal and\nstart playing around and\n\n78\n00:04:31.040 --> 00:04:33.570\nlearning things there and\ngetting your feet wet there.\n\n79\n00:04:33.570 --> 00:04:36.990\nBecause that's really where\nit's all going to end up.\n\n80\n00:04:36.990 --> 00:04:40.870\nOr you can do like I do and go back and\nforth and just get really angry\n\n81\n00:04:40.870 --> 00:04:44.710\nwhen things won't play together and\ndon't show up in one portal or the other.\n\n82\n00:04:44.710 --> 00:04:46.980\nSo, you could do it that way as well.\n\n83\n00:04:46.980 --> 00:04:50.310\n>> Yeah, I've seen that kind of thing from\nMicrosoft a little bit where they, and,\n\n84\n00:04:50.310 --> 00:04:51.830\nyou got to understand.\n\n85\n00:04:51.830 --> 00:04:53.930\nThis is just kind of\nthe nature of the beast.\n\n86\n00:04:53.930 --> 00:04:57.350\nOnce they create a product people start\ngoing I'm gonna use this product.\n\n87\n00:04:57.350 --> 00:04:58.910\nAnd they get used to it, and they like it.\n\n88\n00:04:58.910 --> 00:05:00.900\nAnd it does things that\nthey need it to do.\n\n89\n00:05:00.900 --> 00:05:04.520\nAnd then they've learned that system, and\nthen they come out with a new system.\n\n90\n00:05:04.520 --> 00:05:05.500\nAnd now what are you going to do?\n\n91\n00:05:05.500 --> 00:05:08.360\nI either have to shun\nthe old system completely or\n\n92\n00:05:08.360 --> 00:05:10.290\ndo we try to make the two work together or\n\n93\n00:05:10.290 --> 00:05:12.990\ndo we want to do away with that\nbecause the new system is better.\n\n94\n00:05:12.990 --> 00:05:16.080\nSo there's always like\nthis weird almagomization\n\n95\n00:05:16.080 --> 00:05:20.760\nof the joining of the two things until\nthe newer thing becomes the only thing.\n\n96\n00:05:20.760 --> 00:05:25.080\nSo you kind of just gotta have both\ntoes dipped in two sets of water\n\n97\n00:05:25.080 --> 00:05:26.520\nuntil they get that figured out.\n\n98\n00:05:26.520 --> 00:05:28.290\nIt's just the nature of\nthe beast right now.\n\n99\n00:05:28.290 --> 00:05:30.140\n>> It really is, so let's take a look.\n\n100\n00:05:30.140 --> 00:05:33.460\nWhat I've got on my screen here\nis what we've been working with\n\n101\n00:05:33.460 --> 00:05:34.800\nthroughout these episodes.\n\n102\n00:05:34.800 --> 00:05:37.890\nI've got my,\nwhat we call the classic portal.\n\n103\n00:05:37.890 --> 00:05:40.539\nAnd I showed you this in one\nof the very first episodes.\n\n104\n00:05:40.539 --> 00:05:45.086\nAnd if you look at the URL up here\nit's manage.windowsazure.com and\n\n105\n00:05:45.086 --> 00:05:49.360\nthen my account and\nsome of the account information there.\n\n106\n00:05:49.360 --> 00:05:54.060\nThat's the classic portal,\nwe're gonna call the classic portal now.\n\n107\n00:05:54.060 --> 00:05:59.290\nThere is a link right up here at the top,\nthat says check out the new portal.\n\n108\n00:05:59.290 --> 00:06:01.990\nHm, all right, now, we've seen\neverything that I've got, right.\n\n109\n00:06:01.990 --> 00:06:06.400\nHere's all items, we created my AD in\nAzure, that was my storage account.\n\n110\n00:06:06.400 --> 00:06:09.155\nWe've got that cloud\nservice that we created.\n\n111\n00:06:09.155 --> 00:06:13.100\nGot my virtual network, I've got a couple\nof virtual machines, and then there's,\n\n112\n00:06:13.100 --> 00:06:16.830\nthat's just the default directory that\ncomes with your Azure subscription,\n\n113\n00:06:16.830 --> 00:06:19.180\nso that's nothing that we created here.\n\n114\n00:06:19.180 --> 00:06:21.770\nSo now I'm gonna click on this link,\ncheck out the new portal.\n\n115\n00:06:21.770 --> 00:06:23.420\nHm, let's check it out.\n\n116\n00:06:23.420 --> 00:06:26.220\nAnd it says the new Azure portal is here!\n\n117\n00:06:26.220 --> 00:06:27.480\nClick Launch.\n\n118\n00:06:27.480 --> 00:06:29.070\nSo I'm gonna click Launch, and\n\n119\n00:06:29.070 --> 00:06:32.485\nthe first thing you'll notice\nis the difference in the URL.\n\n120\n00:06:32.485 --> 00:06:36.760\nportal.azure.com.\n\n121\n00:06:36.760 --> 00:06:40.245\nAnd it looks a lot different, right.\n\n122\n00:06:40.245 --> 00:06:42.065\nSo we'll give it a second to populate.\n\n123\n00:06:42.065 --> 00:06:44.915\nBut it looks like our modern\noperating systems, right.\n\n124\n00:06:44.915 --> 00:06:49.150\nTiles, we see those in everything now,\nin Windows 10 and\n\n125\n00:06:49.150 --> 00:06:51.957\nServer 2012 and Server 2016.\n\n126\n00:06:51.957 --> 00:06:55.046\nWe're gonna see those for\nprobably quite some time.\n\n127\n00:06:55.046 --> 00:06:57.545\nAnd that's basically what we have here.\n\n128\n00:06:57.545 --> 00:07:00.055\nThis is known as my dashboard.\n\n129\n00:07:00.055 --> 00:07:05.850\nAnd it's kind of a one stop quick\noverview of whatever I want, really.\n\n130\n00:07:05.850 --> 00:07:09.650\nEach one of these little\ncomponents is a tile and\n\n131\n00:07:09.650 --> 00:07:15.080\nI can move these guys around and\nrearrange them as I see fit.\n\n132\n00:07:15.080 --> 00:07:19.590\nI can drag this guy over here and\nwe can move them around.\n\n133\n00:07:19.590 --> 00:07:21.340\nWe can add additional ones.\n\n134\n00:07:21.340 --> 00:07:25.550\nIf I click Edit up here, actually it\nlooks like I'm already in the Edit mode.\n\n135\n00:07:25.550 --> 00:07:28.070\nAs soon as I started moving\nthings around it went ahead and\n\n136\n00:07:28.070 --> 00:07:29.260\nflopped over to the Edit mode.\n\n137\n00:07:29.260 --> 00:07:35.240\nAnd over here on the left I can\nsee Find resource by: Type.\n\n138\n00:07:35.240 --> 00:07:38.410\nAnd I can choose different resources.\n\n139\n00:07:38.410 --> 00:07:41.380\nAnd here's where it's gonna get, and\nI'll explain here in just a minute.\n\n140\n00:07:41.380 --> 00:07:44.370\nI'm gonna switch over\nto Default networking,\n\n141\n00:07:44.370 --> 00:07:46.160\nthere's my Azure virtual subnet.\n\n142\n00:07:46.160 --> 00:07:49.405\nNotice this says virtual network classic,\nI'll zoom back out so\n\n143\n00:07:49.405 --> 00:07:51.181\nwe can see this a little bit better.\n\n144\n00:07:51.181 --> 00:07:52.522\nAnd what do I got?\n\n145\n00:07:52.522 --> 00:07:54.554\nHere's some settings.\n\n146\n00:07:54.554 --> 00:07:58.170\nMaybe I want to drag this one out here.\n\n147\n00:07:58.170 --> 00:08:01.116\nMaybe I want,\nwhat else do we have down here.\n\n148\n00:08:01.116 --> 00:08:03.723\nA resource map, that might be a good one,\n\n149\n00:08:03.723 --> 00:08:08.580\nthat's probably similar to what I've\ngot there, looks like a nice big one.\n\n150\n00:08:08.580 --> 00:08:11.660\nSo you can see there's different tiles,\nevents, roles, so\n\n151\n00:08:11.660 --> 00:08:16.860\nyou find the resource that you're looking\nfor, our storage is actually in east U.S.,\n\n152\n00:08:16.860 --> 00:08:18.570\nso there's my storage account.\n\n153\n00:08:18.570 --> 00:08:23.630\nSo you can see some of the different tiles\nI can put, availability, estimated spend,\n\n154\n00:08:23.630 --> 00:08:28.770\ncapacity for the past week, a few\ndifferent tiles that we can view there.\n\n155\n00:08:28.770 --> 00:08:31.810\nI can go to operations, usage,\n\n156\n00:08:31.810 --> 00:08:37.080\nmonitoring, and again,\nwe can drag these guys out here.\n\n157\n00:08:37.080 --> 00:08:38.370\nAnd I can add these tiles.\n\n158\n00:08:38.370 --> 00:08:41.080\nSo I'm gonna make a really\nugly dashboard here.\n\n159\n00:08:41.080 --> 00:08:42.140\nIn just a second.\n\n160\n00:08:42.140 --> 00:08:43.300\nAll right.\n\n161\n00:08:43.300 --> 00:08:44.350\nSo, that's the idea.\n\n162\n00:08:44.350 --> 00:08:48.330\nThe idea is that,\nI get the stuff that I need to see.\n\n163\n00:08:48.330 --> 00:08:50.420\nRight?\nWhen I need to just check on my status and\n\n164\n00:08:50.420 --> 00:08:51.840\nI want to see what's going on.\n\n165\n00:08:51.840 --> 00:08:54.560\nI can add different tiles for\ndifferent resources.\n\n166\n00:08:54.560 --> 00:08:56.590\nI'll tell that I'm done editing.\n\n167\n00:08:56.590 --> 00:09:00.560\nAnd there we go,\nI've got my new dashboard, all right?\n\n168\n00:09:00.560 --> 00:09:04.340\nAnd you can actually move these guys,\nI'll move this one over here just\n\n169\n00:09:04.340 --> 00:09:09.130\nto kind of show you, let's do that,\n\n170\n00:09:09.130 --> 00:09:14.300\nmove that one even further over if\nI can get it to go, there we go.\n\n171\n00:09:14.300 --> 00:09:18.220\nI was gonna just push some out here to\nthe side, not for any particular reason.\n\n172\n00:09:18.220 --> 00:09:20.700\nWell, son of a gun, get over there.\n\n173\n00:09:20.700 --> 00:09:21.820\nThere we go.\n\n174\n00:09:21.820 --> 00:09:25.550\nJust to show you, you just keep\nscrolling horizontally, right?\n\n175\n00:09:25.550 --> 00:09:27.170\nAs I slide over I can go,\n\n176\n00:09:27.170 --> 00:09:33.090\nif I added more tiles we could keep\ngoing further and further over.\n\n177\n00:09:33.090 --> 00:09:34.300\nAnd just keep on scrolling.\n\n178\n00:09:34.300 --> 00:09:36.480\nSo you can really load this thing up.\n\n179\n00:09:36.480 --> 00:09:38.660\nYou can scroll vertically\nof course as well.\n\n180\n00:09:38.660 --> 00:09:42.840\nYou can load it up with\nall kinds of information.\n\n181\n00:09:42.840 --> 00:09:46.540\nSo, kinda cool that you get this\nquick overview of all of your stuff.\n\n182\n00:09:46.540 --> 00:09:48.650\nLike here's my VPN connection.\n\n183\n00:09:48.650 --> 00:09:49.540\nThere's that gateway.\n\n184\n00:09:49.540 --> 00:09:52.150\nI can see by point to side\nI still have that client.\n\n185\n00:09:52.150 --> 00:09:56.440\nAnd in fact, this client is still\nconnected to that Azure sub net.\n\n186\n00:09:57.600 --> 00:09:59.876\nRight.\nI've got my site to site up between\n\n187\n00:09:59.876 --> 00:10:04.210\ncorporate, or, our 10.1.1 network.\n\n188\n00:10:04.210 --> 00:10:05.890\nSo I can get quick information.\n\n189\n00:10:05.890 --> 00:10:08.360\nHey, I will know immediately\nif one of these links is down.\n\n190\n00:10:08.360 --> 00:10:10.520\nCuz I'm not gonna have\nthat green checkmark.\n\n191\n00:10:10.520 --> 00:10:12.565\nI can actually click on that, and\n\n192\n00:10:12.565 --> 00:10:15.870\nit'll take me over to my\nsite to site VPN connection.\n\n193\n00:10:15.870 --> 00:10:17.150\nSo I can take a look at what's going on.\n\n194\n00:10:17.150 --> 00:10:20.960\nAnd I can click on that and I can get\na little bit of status about this.\n\n195\n00:10:20.960 --> 00:10:23.560\nWe can just keep sliding things over.\n\n196\n00:10:23.560 --> 00:10:26.000\nAnd I can see there's\nmy VPN gateway address.\n\n197\n00:10:26.000 --> 00:10:28.600\nI could add a new subnet from here.\n\n198\n00:10:28.600 --> 00:10:33.830\nSo you'll see that it's really\nI don't know, you know?\n\n199\n00:10:33.830 --> 00:10:36.050\nSometimes when I'm playing with this,\nI think wow this is great.\n\n200\n00:10:36.050 --> 00:10:39.200\nOther times I get confused,\nI'm like where the heck am I?\n\n201\n00:10:39.200 --> 00:10:40.360\nSkins keep sliding out.\n\n202\n00:10:40.360 --> 00:10:43.980\nYou could really get lost in\nthe nesting if you're not careful.\n\n203\n00:10:43.980 --> 00:10:46.400\n>> You know what they say about old dogs,\nMike.\n\n204\n00:10:46.400 --> 00:10:47.240\n>> Yes.\n\n205\n00:10:47.240 --> 00:10:49.040\n>> They're idiots [LAUGH].\n\n206\n00:10:49.040 --> 00:10:51.752\n>> We are hard to teach new tricks,\nexactly.\n\n207\n00:10:51.752 --> 00:10:56.005\nAll right, so there's our dashboard,\nagain you can add all kinds of tiles so\n\n208\n00:10:56.005 --> 00:10:59.690\nthat you can get quick\noverview information\n\n209\n00:10:59.690 --> 00:11:03.260\nabout anything that you've\ncreated up there in Azure.\n\n210\n00:11:03.260 --> 00:11:04.680\nSo that's pretty cool.\n\n211\n00:11:04.680 --> 00:11:07.390\nNow, if we go down this list,\nthis is similar, right?\n\n212\n00:11:07.390 --> 00:11:09.100\nI'm going to flip back and forth here.\n\n213\n00:11:09.100 --> 00:11:14.860\nHere is my classic portal, and I've got my\ndifferent items I can scroll through here.\n\n214\n00:11:14.860 --> 00:11:18.520\nWe go over to that new portal, and\nI can see I got something similar.\n\n215\n00:11:18.520 --> 00:11:20.400\nI've got these items.\n\n216\n00:11:20.400 --> 00:11:24.560\nBut notice I have things like virtual\nmachine classic and virtual machines.\n\n217\n00:11:24.560 --> 00:11:28.950\nIf I click on virtual machines,\nit says it has zero.\n\n218\n00:11:28.950 --> 00:11:29.930\nNo virtual machines.\n\n219\n00:11:29.930 --> 00:11:31.360\nBut we know,that I've got at least two.\n\n220\n00:11:31.360 --> 00:11:33.378\nRight.\nI created those two to main controllers.\n\n221\n00:11:33.378 --> 00:11:37.730\nI go to virtual machines classic,\nthere are my machines, and\n\n222\n00:11:37.730 --> 00:11:41.090\nthat means these were created\nusing that classic portal.\n\n223\n00:11:41.090 --> 00:11:45.880\n>> So the new portal is actually allowing\nyou to basically access the classic\n\n224\n00:11:45.880 --> 00:11:48.050\nportal without having to jump\ninto the classic portal?\n\n225\n00:11:48.050 --> 00:11:48.640\n>> Correct.\n\n226\n00:11:48.640 --> 00:11:51.900\nExactly, and\nthere are some things, and I keep\n\n227\n00:11:51.900 --> 00:11:56.600\nsaying some things because they're isn't\na specific list, at least that I've found,\n\n228\n00:11:56.600 --> 00:11:59.770\nof things you can and\ncan't do in each one of these portals.\n\n229\n00:11:59.770 --> 00:12:01.390\nWhen you create things in here, and\n\n230\n00:12:01.390 --> 00:12:03.880\nI'll show you this as we go\nthrough the next few episodes.\n\n231\n00:12:03.880 --> 00:12:06.800\nWe're going to basically create\nthe same set up that we have.\n\n232\n00:12:06.800 --> 00:12:09.232\nI'm going to tear it all down, and\nwe're going to create it again,\n\n233\n00:12:09.232 --> 00:12:14.160\nthis time using the new portal so we can\nsee the differences in how it's done\n\n234\n00:12:14.160 --> 00:12:16.700\nusing the new portal,\nsome of the new terminology.\n\n235\n00:12:16.700 --> 00:12:20.530\nAnd with no more cloud services, we use\nresource groups, and things like that.\n\n236\n00:12:20.530 --> 00:12:24.690\nSo we're gonna get to see it all again,\nthrough the new portal.\n\n237\n00:12:24.690 --> 00:12:27.460\nBut, when you create things in\nthe new portal, it'll usually,\n\n238\n00:12:27.460 --> 00:12:32.670\ndepending on what it is, it'll ask you, do\nyou wanna create this using the classic or\n\n239\n00:12:32.670 --> 00:12:35.410\ndo you wanna create this\nusing the new portal.\n\n240\n00:12:35.410 --> 00:12:38.560\nBecause if I need to make a virtual\nmachine that's gonna work with that\n\n241\n00:12:38.560 --> 00:12:42.700\nsubmethod I've already got, that was\ncreated in the classic, and talk to those\n\n242\n00:12:42.700 --> 00:12:46.410\nVMs that were created in classic,\nI need to create them using the classic.\n\n243\n00:12:46.410 --> 00:12:48.140\nThere's basically different APIs,\n\n244\n00:12:48.140 --> 00:12:51.410\napplication programming interfaces,\nin the background.\n\n245\n00:12:51.410 --> 00:12:54.700\nThere's the resource manager,\nwhich is the new portal, and\n\n246\n00:12:54.700 --> 00:12:57.810\nthen there's, I want to say they call\na service manager, don't pull me on that,\n\n247\n00:12:57.810 --> 00:12:58.680\nI'll have to double check.\n\n248\n00:12:58.680 --> 00:13:02.746\nBut I'll say it's called service\nmanagers the API for the old classic,\n\n249\n00:13:02.746 --> 00:13:05.020\nthey are completely separate, right?\n\n250\n00:13:05.020 --> 00:13:10.752\nAnd so if you're working with let's say\ndevelopment, and you will choose which API\n\n251\n00:13:10.752 --> 00:13:16.881\ndo you want to use that exposes what you\ncan create and work with up here in Azure.\n\n252\n00:13:17.900 --> 00:13:23.600\nAll right so let's take a look if we go to\nresource groups, you can see that I've got\n\n253\n00:13:23.600 --> 00:13:29.480\na few, and my cloud service actually shows\nup now as a resource group over here.\n\n254\n00:13:29.480 --> 00:13:32.905\nSo I can still manage this cloud service.\n\n255\n00:13:32.905 --> 00:13:35.095\nNotice it says,\nlook what it says up there though.\n\n256\n00:13:35.095 --> 00:13:35.825\nAll right?\n\n257\n00:13:35.825 --> 00:13:40.015\nIt actually calls it a resource group.\n\n258\n00:13:40.015 --> 00:13:43.785\nIt's not exactly a resource group though,\nit really is a cloud service.\n\n259\n00:13:43.785 --> 00:13:46.185\nBut they're gonna dump it\nup under resource groups.\n\n260\n00:13:46.185 --> 00:13:52.630\nBut I can see it, I can go to I don't\nknow, properties for that resource group.\n\n261\n00:13:52.630 --> 00:13:54.290\nI'm sorry, that cloud service.\n\n262\n00:13:54.290 --> 00:13:57.840\nI can see the subscriptions\nassociated with it, the name, the ID.\n\n263\n00:13:57.840 --> 00:14:02.020\nLet's see if there's anything else,\nnot much else over there.\n\n264\n00:14:02.020 --> 00:14:04.695\nResource costs,\nI was actually having issues with this.\n\n265\n00:14:04.695 --> 00:14:09.745\nAnd I believe it's because they\nwere created using classic.\n\n266\n00:14:09.745 --> 00:14:12.585\nIt just sits here and you get these\ndots that go forever and ever and ever.\n\n267\n00:14:12.585 --> 00:14:14.785\nAnd it really doesn't\never bring anything up.\n\n268\n00:14:14.785 --> 00:14:15.965\nBut some cool things that I can do.\n\n269\n00:14:15.965 --> 00:14:17.335\nI can work with it from here.\n\n270\n00:14:17.335 --> 00:14:19.225\nI can look at deployments for it.\n\n271\n00:14:19.225 --> 00:14:20.535\nI don't have any.\n\n272\n00:14:20.535 --> 00:14:22.175\nYou can get alerts.\n\n273\n00:14:22.175 --> 00:14:24.085\nYou can look at audit logs.\n\n274\n00:14:26.060 --> 00:14:30.210\nYou can, and again I probably won't\nhave any, no real warnings or\n\n275\n00:14:30.210 --> 00:14:32.990\nevents going on right now or\nour network is pretty quiet.\n\n276\n00:14:32.990 --> 00:14:35.950\nBut, you know that's where\nyou would find this, so\n\n277\n00:14:35.950 --> 00:14:39.970\nif you're looking for cloud services over\nhere, you're just not gonna find it.\n\n278\n00:14:39.970 --> 00:14:41.460\nIt's not gonna be there, and\n\n279\n00:14:41.460 --> 00:14:45.600\nthis doesn't scroll, like unlike over here\nin the classic where I've got all of these\n\n280\n00:14:45.600 --> 00:14:49.600\noptions I scroll through\nthis is customizable.\n\n281\n00:14:49.600 --> 00:14:51.760\nSo these are what they've\nchosen to put out here.\n\n282\n00:14:51.760 --> 00:14:54.010\nAnd I can move these around a little bit.\n\n283\n00:14:54.010 --> 00:14:56.250\nIf I need to, I can rearrange them.\n\n284\n00:14:56.250 --> 00:14:57.800\nI can also add some.\n\n285\n00:14:57.800 --> 00:15:00.380\nIf we go to,\nlet's see where we're at here.\n\n286\n00:15:00.380 --> 00:15:04.110\nIf we go to browse down at the bottom.\n\n287\n00:15:04.110 --> 00:15:07.000\nAll right, here's a list of all\nof them that are available.\n\n288\n00:15:07.000 --> 00:15:08.950\nYou can see there's quite a few.\n\n289\n00:15:08.950 --> 00:15:12.790\nAnd the ones with the yellow stars here,\nif you can make that out on screen,\n\n290\n00:15:12.790 --> 00:15:15.490\nthose are the ones that\nare showing up on that menu.\n\n291\n00:15:15.490 --> 00:15:18.150\nThe ones without them aren't\ncurrently showing up.\n\n292\n00:15:18.150 --> 00:15:18.980\nI can still use them.\n\n293\n00:15:18.980 --> 00:15:21.620\nI can come in here and\nI can find the one I'm looking for.\n\n294\n00:15:22.620 --> 00:15:23.810\nAnd I can click on it.\n\n295\n00:15:23.810 --> 00:15:25.620\nLet's say, here's my virtual networks.\n\n296\n00:15:25.620 --> 00:15:32.250\nAll right, so I can click on virtual\nnetworks classic or virtual networks,\n\n297\n00:15:32.250 --> 00:15:35.430\nand that would open up, but\nit won't be out on my menu the next time.\n\n298\n00:15:35.430 --> 00:15:37.660\nIf I put a little star next to it, or\n\n299\n00:15:37.660 --> 00:15:41.650\nI highlight that star,\nnow it does show up on my list over here.\n\n300\n00:15:41.650 --> 00:15:45.160\nSo if it's something I use all the time,\nthen I might just decide to go ahead and\n\n301\n00:15:45.160 --> 00:15:47.500\nbasically pin it to that menu.\n\n302\n00:15:47.500 --> 00:15:51.142\nYou can filter this down if\nI was looking for network.\n\n303\n00:15:51.142 --> 00:15:54.636\nI could find all of that information,\nthere's my gateways and things like that.\n\n304\n00:15:54.636 --> 00:15:57.552\nSo, find the tools that you're\nlooking for, and the point is,\n\n305\n00:15:57.552 --> 00:16:00.528\nreally, that I'm trying to make\nVery customizable interface.\n\n306\n00:16:00.528 --> 00:16:05.361\nSo that I can show just what I need to\nwork with when I'm up here working with my\n\n307\n00:16:05.361 --> 00:16:08.462\ncloud service or\nwith my Azure infrastructure,\n\n308\n00:16:08.462 --> 00:16:13.679\nrather than seeing everything and have to\nscroll past things that I'm never gonna\n\n309\n00:16:13.679 --> 00:16:19.312\nuse in my particular environment, yet it's\nstill on this list, I can't get rid of it.\n\n310\n00:16:19.312 --> 00:16:23.668\nAnd over here, I can fully customize this\ninterface to where it's just what I need.\n\n311\n00:16:23.668 --> 00:16:27.901\nAnd that just makes me more efficient for\nworking with this information,\n\n312\n00:16:27.901 --> 00:16:30.029\nbecause just what you need is there.\n\n313\n00:16:30.029 --> 00:16:32.188\n>> That's right, you don't wanna\nhave to look at the clutter,\n\n314\n00:16:32.188 --> 00:16:34.028\nthings that aren't really\npertinent to what it is.\n\n315\n00:16:34.028 --> 00:16:38.932\nThat's the great thing about customization\nis it becomes your 10,000 foot\n\n316\n00:16:38.932 --> 00:16:40.575\nview of your environment.\n\n317\n00:16:40.575 --> 00:16:43.591\nYou login, you look at exactly\nwhat you're looking for, and\n\n318\n00:16:43.591 --> 00:16:47.535\nthere it all is because you've laid it out\nwhich is gonna be the most convenient,\n\n319\n00:16:47.535 --> 00:16:50.103\nthe most efficient for you and\nthe way you do things.\n\n320\n00:16:50.103 --> 00:16:54.552\nSo it's really nice that they add that\nlevel of customization for your Azure.\n\n321\n00:16:54.552 --> 00:16:55.571\n>> Absolutely.\n\n322\n00:16:55.571 --> 00:16:58.947\nNow where as we look at some of these,\nyou're gonna see some interesting things.\n\n323\n00:16:58.947 --> 00:17:00.778\nLet me zoom back in over here.\n\n324\n00:17:00.778 --> 00:17:06.163\nWe get down here, you saw probably when I\nadded those, that one is Virtual networks.\n\n325\n00:17:06.163 --> 00:17:11.222\nAnd if you look at the URL at the bottom\nthere, portal.azure.com, pound symbol,\n\n326\n00:17:11.222 --> 00:17:15.366\nor hashtag, blade/HubsExtension,\nyada, yada, yada, right?\n\n327\n00:17:15.366 --> 00:17:17.614\nThat's one of those slideout menus.\n\n328\n00:17:17.614 --> 00:17:21.263\nIf I go over classic, actually it\ndoes show it being a blade as well,\n\n329\n00:17:21.263 --> 00:17:24.412\nbut well let's zoom out and\nshow you the difference here.\n\n330\n00:17:24.412 --> 00:17:29.150\nIf I go to Virtual networks,\nall right, I have none.\n\n331\n00:17:29.150 --> 00:17:31.839\nIf I go to Virtual networks classic,\n\n332\n00:17:31.839 --> 00:17:36.019\nyou'll actually see I have\nmy Azure subnet, all right.\n\n333\n00:17:36.019 --> 00:17:39.301\nThis one is even another,\nI don't wanna say another different way,\n\n334\n00:17:39.301 --> 00:17:40.953\nthat doesn't really make sense.\n\n335\n00:17:40.953 --> 00:17:45.687\nBut what I wanna point out is see\nthat little shortcut icon, all right.\n\n336\n00:17:45.687 --> 00:17:49.859\nIf I click on that,\nit doesn't even open up in the portal.\n\n337\n00:17:49.859 --> 00:17:53.523\nThere is nothing in the portal\nthat supports that yet.\n\n338\n00:17:53.523 --> 00:17:59.231\nSo it's actually a shortcut over to,\nyou guessed it, the classic portal.\n\n339\n00:17:59.231 --> 00:18:01.913\nCuz it's still done using\nthe classic portal.\n\n340\n00:18:01.913 --> 00:18:04.972\nAnd it's gonna take me right to,\nif we scroll down,\n\n341\n00:18:04.972 --> 00:18:09.571\nwe'll see that Active Directory should\nbe highlighted there and Azure Demo.\n\n342\n00:18:09.571 --> 00:18:14.159\nSo it did bring me to exactly what I click\non, but it did it in the classic portal.\n\n343\n00:18:14.159 --> 00:18:18.944\nIt can't open it up in the new portal\ncuz that functionally is not there yet.\n\n344\n00:18:18.944 --> 00:18:20.565\nAnd you'll see that there\nis a few of them like that.\n\n345\n00:18:20.565 --> 00:18:25.768\nIf we go back to browse and now you look\nthrough this list, you'll see that one.\n\n346\n00:18:25.768 --> 00:18:30.324\nSome of them are just previews, there's\nanother little shortcut one that's is\n\n347\n00:18:30.324 --> 00:18:33.544\ngonna take you,\nagain back over to that classic portal.\n\n348\n00:18:33.544 --> 00:18:36.341\nSo this is what I was saying\nthat the functionality for\n\n349\n00:18:36.341 --> 00:18:38.029\nthe new portal is not complete.\n\n350\n00:18:38.029 --> 00:18:42.080\nThere's still some things that you're\ngonna have to use that classic portal to\n\n351\n00:18:42.080 --> 00:18:46.191\nwork with, and we can run into some issues\nwith the compatibility between things\n\n352\n00:18:46.191 --> 00:18:49.469\ncreated in the classic mode and\nthings created in that new mode.\n\n353\n00:18:49.469 --> 00:18:55.311\nAnd unfortunately, I've got a website,\nhold on, I'll show you this list,\n\n354\n00:18:55.311 --> 00:19:00.018\nand I'll make sure we give you\nthis link here in our show notes.\n\n355\n00:19:00.018 --> 00:19:02.883\nThis is Azure portal availability chart,\nand\n\n356\n00:19:02.883 --> 00:19:07.075\nthis is kind of showing you some of it,\nagain, it's not complete.\n\n357\n00:19:07.075 --> 00:19:10.997\nBut use the chart below to check which\nportal supports the portal service and\n\n358\n00:19:10.997 --> 00:19:12.232\napplications you use.\n\n359\n00:19:12.232 --> 00:19:17.496\nSo the idea is I can use this to decide,\nwhat is it that I wanna do with Azure.\n\n360\n00:19:17.496 --> 00:19:21.379\nSo which portal am I better off using?\n\n361\n00:19:21.379 --> 00:19:25.168\nYou see things like Backup and\nRecovery Services, Backup Vaults,\n\n362\n00:19:25.168 --> 00:19:29.625\nnot supported by that new portal, if I\nwanna do that, I need to use the classic.\n\n363\n00:19:29.625 --> 00:19:31.913\nBiztalk, everybody's favorite.\n\n364\n00:19:31.913 --> 00:19:37.322\nThat has to be done through classic,\ncan't do that through the new portal.\n\n365\n00:19:37.322 --> 00:19:40.290\nAnd you notice, I'm pointing out all\nthe things you can't do in the new one.\n\n366\n00:19:40.290 --> 00:19:42.318\nIt seems like I'm promoting\nthe classic a little bit?\n\n367\n00:19:42.318 --> 00:19:44.503\n[LAUGH]\n>> You might have a dog in this fight,\n\n368\n00:19:44.503 --> 00:19:45.023\nMichael.\n\n369\n00:19:45.023 --> 00:19:48.645\n[LAUGH]\n>> I might be a little bit biased.\n\n370\n00:19:48.645 --> 00:19:52.392\nBut there's definitely things I can\ndo in the new portal that I can't do\n\n371\n00:19:52.392 --> 00:19:53.772\nin classic like Storage.\n\n372\n00:19:53.772 --> 00:19:57.347\nThis is a different type of storage, and\nnotice, classic is available in both,\n\n373\n00:19:57.347 --> 00:20:00.358\nStorage classic, but the new type\nof storage is only in the new one.\n\n374\n00:20:00.358 --> 00:20:05.071\nAnd they're not gonna add it to the\nclassic cuz the classic's gonna be going\n\n375\n00:20:05.071 --> 00:20:06.329\naway at some point.\n\n376\n00:20:06.329 --> 00:20:08.360\nVirtual networks, classic.\n\n377\n00:20:08.360 --> 00:20:11.646\nCan be done in both, but the new virtual\nnetworks can only be done in the new.\n\n378\n00:20:11.646 --> 00:20:14.911\nSo that's why I'm saying,\nif you're already working with Azure and\n\n379\n00:20:14.911 --> 00:20:18.133\nyou're using that classic,\nyou can hold on for a little bit longer.\n\n380\n00:20:18.133 --> 00:20:19.854\nI know I have.\n\n381\n00:20:19.854 --> 00:20:23.978\nBut if you're just getting started,\nprobably behoove you to go ahead and\n\n382\n00:20:23.978 --> 00:20:25.916\njust figure out the Azure portal.\n\n383\n00:20:25.916 --> 00:20:31.037\nUnless there's something specific that\nyou need that can only be done in that\n\n384\n00:20:31.037 --> 00:20:36.257\nclassic portal, probably better off\njust starting and learning the new one.\n\n385\n00:20:36.257 --> 00:20:40.259\nIt'd be like, I remember, way back when,\n\n386\n00:20:40.259 --> 00:20:45.018\nwhen I first started to get\ninto system management,\n\n387\n00:20:45.018 --> 00:20:48.167\nand 2000 Server had come out.\n\n388\n00:20:48.167 --> 00:20:51.093\nAnd I was like, I just missed Windows NT.\n\n389\n00:20:51.093 --> 00:20:56.273\nNow I could have gone back and\nreally studied up on Windows NT and\n\n390\n00:20:56.273 --> 00:21:00.689\nlearn that, but\n2000 was way different from NT.\n\n391\n00:21:00.689 --> 00:21:04.081\nAnd so yeah, I was able to say, yeah,\nI'm not ever going to bother with that.\n\n392\n00:21:04.081 --> 00:21:05.714\nAnd that's where you might be right now.\n\n393\n00:21:05.714 --> 00:21:07.156\nYou might say, you know what, Mike?\n\n394\n00:21:07.156 --> 00:21:09.969\nI'm not ever going to bother with that\nclassic portal and dealing with all that.\n\n395\n00:21:09.969 --> 00:21:12.822\nI'm gonna go straight to the new one.\n\n396\n00:21:12.822 --> 00:21:16.174\nAll right, so\nthat's a good little chart to look at.\n\n397\n00:21:16.174 --> 00:21:19.780\nSo you can decide again which\nportal might be better off for you.\n\n398\n00:21:19.780 --> 00:21:23.147\nThe only other thing I really\nwanted to show off here was,\n\n399\n00:21:23.147 --> 00:21:25.616\nit does show me the resources that I have.\n\n400\n00:21:25.616 --> 00:21:27.122\nI just have to find them.\n\n401\n00:21:27.122 --> 00:21:32.933\nMy cloud service ended up being\nunderneath Resource groups.\n\n402\n00:21:32.933 --> 00:21:35.150\nWhat else?\nYou can go to All resources, and\n\n403\n00:21:35.150 --> 00:21:37.135\nit should show me everything I have.\n\n404\n00:21:37.135 --> 00:21:38.876\nSo there's my Storage account.\n\n405\n00:21:38.876 --> 00:21:41.265\nNotice, it does say classic next to it.\n\n406\n00:21:41.265 --> 00:21:46.009\nThere's my two Virtual machines that\nare classic, my Cloud service, classic.\n\n407\n00:21:46.009 --> 00:21:49.308\nYou can tell,\nI'm just a classic kind of guy.\n\n408\n00:21:49.308 --> 00:21:51.201\nThere's my Azure subnet.\n\n409\n00:21:51.201 --> 00:21:52.608\nSo I can see all this.\n\n410\n00:21:52.608 --> 00:21:56.927\nNow, the Resource group,\nit creates these default storage, and\n\n411\n00:21:56.927 --> 00:22:02.033\nit just kinda puts things in there, so\nthat I can find them a little bit easier.\n\n412\n00:22:02.033 --> 00:22:03.563\nWhat else do I wanna show you?\n\n413\n00:22:03.563 --> 00:22:08.371\nThere is Cloud services, I can still\nsee my actual cloud service even though\n\n414\n00:22:08.371 --> 00:22:12.651\nit's treating it now as a resource\ngroup as far as this portal goes,\n\n415\n00:22:12.651 --> 00:22:14.472\nit is still a cloud service.\n\n416\n00:22:14.472 --> 00:22:18.997\nNow I can just manage it\nunderneath Resource groups.\n\n417\n00:22:18.997 --> 00:22:22.423\nThere's a couple things in SQL\nthat you can do in the new portal,\n\n418\n00:22:22.423 --> 00:22:24.650\nthat you cannot do in the classic portal.\n\n419\n00:22:24.650 --> 00:22:27.474\nYou can get Subscription\ninformation very easy, and\n\n420\n00:22:27.474 --> 00:22:31.817\nI probably maybe shouldn't, yeah,\nit's not gonna show you anything there.\n\n421\n00:22:31.817 --> 00:22:35.640\nEh, you don't need to worry about\nthat subscription ID there.\n\n422\n00:22:35.640 --> 00:22:37.757\nI don't think you can do\nanything too bad with that.\n\n423\n00:22:37.757 --> 00:22:42.863\nWhat else do we wanna see about\nthis new portal that's really cool?\n\n424\n00:22:42.863 --> 00:22:45.362\nSettings-wise you can change the themes.\n\n425\n00:22:45.362 --> 00:22:47.079\nI kinda like the old dark theme, but\n\n426\n00:22:47.079 --> 00:22:49.609\nI didn't know how that would\nshow up onscreen here.\n\n427\n00:22:49.609 --> 00:22:51.230\nSo that's cool and exciting.\n\n428\n00:22:51.230 --> 00:22:53.130\nYou can change some themes.\n\n429\n00:22:53.130 --> 00:22:56.769\nYou can hide and\nshow the labels and the animations,\n\n430\n00:22:56.769 --> 00:22:59.590\nwhether those windows slide out or not.\n\n431\n00:22:59.590 --> 00:23:02.588\nIf you're on a machine that\ndoesn't have the graphics power,\n\n432\n00:23:02.588 --> 00:23:04.691\nthat might really slow things down for\nyou.\n\n433\n00:23:04.691 --> 00:23:10.335\nYou can throw everything away, Discard\nmodifications, and go back to default.\n\n434\n00:23:10.335 --> 00:23:11.329\nWhat else?\n\n435\n00:23:11.329 --> 00:23:14.582\nWe can drag things around,\nI've shown you that,\n\n436\n00:23:14.582 --> 00:23:17.377\nhow you can add additional tiles out here.\n\n437\n00:23:17.377 --> 00:23:21.925\nYou can give Microsoft some feedback\nwith their little smiley face and\n\n438\n00:23:21.925 --> 00:23:24.711\ntell them how much you\nlove the new portal.\n\n439\n00:23:24.711 --> 00:23:26.261\nAnd then that is just Notifications.\n\n440\n00:23:26.261 --> 00:23:29.992\nSo if they're sending you any\nnotifications like, I don't know,\n\n441\n00:23:29.992 --> 00:23:32.545\nmaybe your credit card's ready to expire,\nor\n\n442\n00:23:32.545 --> 00:23:35.498\nsomething, they can send\nyou notifications there.\n\n443\n00:23:35.498 --> 00:23:36.583\nWhat else, Daniel?\n\n444\n00:23:36.583 --> 00:23:40.668\nI think that is about it, so\nthis is where we're going to go for\n\n445\n00:23:40.668 --> 00:23:42.249\nthe next few episodes.\n\n446\n00:23:42.249 --> 00:23:45.970\nI'm going to basically tear everything\ndown that we've already done,\n\n447\n00:23:45.970 --> 00:23:48.959\nget rid of the virtual machines,\nget rid of the gateways,\n\n448\n00:23:48.959 --> 00:23:51.158\nthe subnets that we created, all of that.\n\n449\n00:23:51.158 --> 00:23:56.037\nI could manage that through this new\nportal, because you can manage most of\n\n450\n00:23:56.037 --> 00:24:00.528\nthat through here, but I wanna show\nyou the whole creation process,\n\n451\n00:24:00.528 --> 00:24:05.115\nwhere we actually create resource\ngroups instead of cloud services.\n\n452\n00:24:05.115 --> 00:24:09.726\nWe're gonna create those new virtual\nmachines rather than the classic virtual\n\n453\n00:24:09.726 --> 00:24:10.427\nmachines.\n\n454\n00:24:10.427 --> 00:24:13.397\nAnd you'll see in the end,\nthere's not a lot of difference, but\n\n455\n00:24:13.397 --> 00:24:15.617\nit's how they're working\nin the backgrounds.\n\n456\n00:24:15.617 --> 00:24:16.279\nThat's the difference.\n\n457\n00:24:16.279 --> 00:24:19.578\nAnd that's what we gotta keep in mind\nbecause like I said, because of the way\n\n458\n00:24:19.578 --> 00:24:23.397\nthey're built in the background, sometimes\nthey can have trouble communicating with\n\n459\n00:24:23.397 --> 00:24:26.101\neach other, so you really kinda\nneed to pick one or the other.\n\n460\n00:24:26.101 --> 00:24:28.089\n>> Awesome.\nWell, Mike, thank you so much for\n\n461\n00:24:28.089 --> 00:24:29.003\njoining us today and\n\n462\n00:24:29.003 --> 00:24:32.683\ndescribing some of the differences in\nthe new portal versus the classic portal.\n\n463\n00:24:32.683 --> 00:24:37.283\nObviously, were gonna get ready to jump\ninto that, and that's gonna come real\n\n464\n00:24:37.283 --> 00:24:41.084\nhandy so that we are a little more\nfamiliar with the environment that\n\n465\n00:24:41.084 --> 00:24:44.700\nyou're in as we rebuild our\nenvironments using the new portal.\n\n466\n00:24:44.700 --> 00:24:49.424\nIs there anything else that you'd like to\naddress before we close the show today?\n\n467\n00:24:49.424 --> 00:24:51.420\n>> No-\n>> Don't do drugs.\n\n468\n00:24:51.420 --> 00:24:54.636\n>> [LAUGH] I was trying to think of\nsomething we needed to say about the old\n\n469\n00:24:54.636 --> 00:24:56.339\nclassic portal, but I couldn't.\n\n470\n00:24:56.339 --> 00:24:59.382\n>> Mike's going to wear his top hat and\ncane and spats.\n\n471\n00:24:59.382 --> 00:25:01.270\n>> There you go, there you go.\n\n472\n00:25:01.270 --> 00:25:03.932\nI mean, there is something to say for\nthat classic stuff.\n\n473\n00:25:03.932 --> 00:25:05.631\n>> All right, well,\nthanks again for joining us.\n\n474\n00:25:05.631 --> 00:25:09.093\nThank you, guys for watching, we're going\nto go ahead and sign off for ITProTV.\n\n475\n00:25:09.093 --> 00:25:10.410\nI've been your host, Daniel Lowrie.\n\n476\n00:25:10.410 --> 00:25:11.347\n>> And I'm Mike Rodrick.\n\n477\n00:25:11.347 --> 00:25:13.552\n>> And we'll see you next time.\n\n478\n00:25:13.552 --> 00:25:20.300\n[MUSIC]\n\n",
          "vimeoId": "155685133"
        },
        {
          "description": "In this episode, Mike and Daniel show you how to create a Site-to-Site VPN using the new Portal in Azure. Starting in the new Azure Portal, they walk you through creating a Resource Group. Next they explain how to create a storage account, a virtual network, subnets for the virtual network, and gateway subnet. Finally they request a public IP address and register the DNS servers.",
          "length": "1923",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-2-1-create_a_site_to_site_vpn-021716-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-2-1-create_a_site_to_site_vpn-021716-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-2-1-create_a_site_to_site_vpn-021716-1-sm.jpg",
          "title": "Create a Site-to-Site VPN",
          "transcript": "WEBVTT\n\n1\n00:00:00.027 --> 00:00:10.027\n[MUSIC]\n\n2\n00:00:11.321 --> 00:00:17.152\nAll right, greetings everyone and welcome\nto another great episode of ITPro TV.\n\n3\n00:00:17.152 --> 00:00:18.928\nI'm your host Daniel Lowery and\n\n4\n00:00:18.928 --> 00:00:23.613\nin today's episode we are continuing on\nwith our Active directory in Azure series.\n\n5\n00:00:23.613 --> 00:00:26.547\nJoining us back in the studio again today,\nyou know him you love him,\n\n6\n00:00:26.547 --> 00:00:28.326\nhe is our good friend Mr. Mike Roderick.\n\n7\n00:00:28.326 --> 00:00:31.340\nMike welcome back to the show sir,\nand how are you doing today?\n\n8\n00:00:31.340 --> 00:00:33.970\n>> Doing great Daniel thanks for\nhaving me back and we are going to\n\n9\n00:00:33.970 --> 00:00:38.450\ndive right back into extending our\nActive Directory out into Azure.\n\n10\n00:00:38.450 --> 00:00:41.280\nNow so far in the previous\nepisodes we've gone through\n\n11\n00:00:41.280 --> 00:00:45.980\nthe entire process of setting up our local\nnetwork with Active Directory on-premises.\n\n12\n00:00:45.980 --> 00:00:50.510\nWe created our Azure virtual network,\nwe created our site-to-site VPN to connect\n\n13\n00:00:50.510 --> 00:00:54.847\nthose two networks, we added a replica\ndomain controller for our domain up there\n\n14\n00:00:54.847 --> 00:00:59.312\nin Azure, we created a branch office that\nwas actually using the demand controller\n\n15\n00:00:59.312 --> 00:01:03.374\nin Azure as its DC, so we could join\ncomputers to the domain, etc., etc.\n\n16\n00:01:03.374 --> 00:01:06.689\nSo we've really been through\nthe whole process, but\n\n17\n00:01:06.689 --> 00:01:10.530\nthe entire time we were using\nwhat we call the classic portal.\n\n18\n00:01:10.530 --> 00:01:12.907\nIf you're been using Azure for\na little while,\n\n19\n00:01:12.907 --> 00:01:15.889\nyou're probably very familiar with that,\nmost of us are.\n\n20\n00:01:15.889 --> 00:01:21.140\nBut now they have the new portal coming\nout right, or it's actually, it is out.\n\n21\n00:01:21.140 --> 00:01:25.907\nIt's still being refined, but it is\nout and I thought we would go back and\n\n22\n00:01:25.907 --> 00:01:28.346\nkind of go through the same process.\n\n23\n00:01:28.346 --> 00:01:31.681\nMaybe a little bit quicker cuz now\nwe understand what we're doing and\n\n24\n00:01:31.681 --> 00:01:35.533\nwhy we're doing it, we just need to see\nhow to do it in this new interface because\n\n25\n00:01:35.533 --> 00:01:37.860\nthe new portal is the way\nthings are going to go.\n\n26\n00:01:37.860 --> 00:01:40.670\nSo I don't know how long they'll\nkeep the classic around,\n\n27\n00:01:40.670 --> 00:01:43.400\nmaybe they leave it forever, so\nwe can go back to play with it and\n\n28\n00:01:43.400 --> 00:01:45.110\njust don't bring any of\nthe new features into it.\n\n29\n00:01:45.110 --> 00:01:48.340\nOr maybe they do away with it,\nwho knows what Microsoft's gonna do,\n\n30\n00:01:48.340 --> 00:01:52.480\nbut at some point we probably should\nfamiliarize ourself with this new portal.\n\n31\n00:01:52.480 --> 00:01:55.960\nAnd it's got a lot of\nreally nice features.\n\n32\n00:01:55.960 --> 00:01:58.910\nI'll be honest with you, somebody\nthat's used to the classic portal,\n\n33\n00:01:58.910 --> 00:02:04.690\nthe new portal is a little bit frustrating\nsometimes, it's not what I like.\n\n34\n00:02:04.690 --> 00:02:08.600\nI get used to the way things work,\nand we all hate change, right?\n\n35\n00:02:08.600 --> 00:02:12.440\nBut change is inevitable and so\nwe do have to get used to it.\n\n36\n00:02:12.440 --> 00:02:14.570\nAnd there are some things that you can\ndo in the new portal that you can't\n\n37\n00:02:14.570 --> 00:02:15.840\ndo in the classic.\n\n38\n00:02:15.840 --> 00:02:18.950\nIf you make virtual machines\nin the classic portal, and\n\n39\n00:02:18.950 --> 00:02:23.080\nvirtual machines in the new portal\nusing the resource manager mode.\n\n40\n00:02:23.080 --> 00:02:26.000\nThey're not going to be able to talk to\neach other, so you really got to figure\n\n41\n00:02:26.000 --> 00:02:29.820\nout at some point, okay I need to move\neverything over to this new portal.\n\n42\n00:02:29.820 --> 00:02:32.120\nSo that's what we're going to do today.\n\n43\n00:02:32.120 --> 00:02:35.045\nSo let's start by just taking\na look at my screen here.\n\n44\n00:02:35.045 --> 00:02:37.990\nIn the previous episode,\nwe went through and kind of felt\n\n45\n00:02:37.990 --> 00:02:42.920\nour way around this new portal,\ngot an idea of how things are laid out.\n\n46\n00:02:42.920 --> 00:02:44.780\nNow we're going to use this.\n\n47\n00:02:44.780 --> 00:02:49.080\nAnd so, but before I use it,\nI reset everything back to the default.\n\n48\n00:02:49.080 --> 00:02:52.995\nSo when you log into that portal for the\nfirst time, and again they just call this\n\n49\n00:02:52.995 --> 00:02:56.220\nportal.azure.com, I\ncall it the new portal,\n\n50\n00:02:56.220 --> 00:03:00.690\nbut it is just the Azure portal I guess,\nversus the classic.\n\n51\n00:03:00.690 --> 00:03:02.650\nThis is what it's gonna look like, right?\n\n52\n00:03:02.650 --> 00:03:07.150\nNow over here on the left hand side\nwe've got all these menu options.\n\n53\n00:03:07.150 --> 00:03:09.630\nBut unlike the old classic,\nit's not scrollable.\n\n54\n00:03:09.630 --> 00:03:12.680\nIt's just got a few of them\nbasically pinned out here.\n\n55\n00:03:12.680 --> 00:03:16.920\nMicrosoft decided these are the ones\nyou might want to start with.\n\n56\n00:03:16.920 --> 00:03:17.970\nNow we're gonna change that up.\n\n57\n00:03:17.970 --> 00:03:22.060\nSo I'm gonna click Browse and the ones\nwith the yellow stars you remember\n\n58\n00:03:22.060 --> 00:03:24.370\nare the ones that are out here,\nand I'm gonna go through and\n\n59\n00:03:24.370 --> 00:03:27.360\nchoose some of these that I want to\nput out there and what I don't want,\n\n60\n00:03:27.360 --> 00:03:30.720\nbased on what we're going to be\ndoing throughout these episodes.\n\n61\n00:03:30.720 --> 00:03:33.130\nSo as a I scroll down through here,\n\n62\n00:03:33.130 --> 00:03:36.060\nI know at some point I want\nto create availability sets.\n\n63\n00:03:36.060 --> 00:03:39.740\nNow I can simply click on it and\nwork with availability sets, but\n\n64\n00:03:39.740 --> 00:03:41.540\nthen when I go away,\nit's not gonna be on my menu.\n\n65\n00:03:41.540 --> 00:03:43.870\nI'm going to have to dive\nthrough this system again.\n\n66\n00:03:43.870 --> 00:03:47.100\nSo you might decide you want to pin\nit out there, or maybe you don't,\n\n67\n00:03:47.100 --> 00:03:48.860\ndepending how often you use it.\n\n68\n00:03:48.860 --> 00:03:51.430\nI'm going to go ahead and add that one and\n\n69\n00:03:51.430 --> 00:03:53.820\nthen I'm going to keep\non scrolling down here.\n\n70\n00:03:53.820 --> 00:03:58.390\nSome other things that we're gonna\nbe working with are going to be,\n\n71\n00:03:58.390 --> 00:04:00.980\nlet's see what we've got here.\n\n72\n00:04:00.980 --> 00:04:02.100\nIf I can find the rest of them.\n\n73\n00:04:02.100 --> 00:04:04.679\nThere's my local network gateways,\nI need that our there, and\n\n74\n00:04:04.679 --> 00:04:07.257\nI'm just going to uncheck some\nof these that I don't feel like,\n\n75\n00:04:07.257 --> 00:04:09.194\nlike cloud services classic,\ndon't want it.\n\n76\n00:04:09.194 --> 00:04:12.408\nWe're not messing with any of\nthe classic stuff anymore,\n\n77\n00:04:12.408 --> 00:04:15.870\nwe're moving on to the new\nway of doing things.\n\n78\n00:04:15.870 --> 00:04:20.520\nI'll keep going down, and I'll miss one or\ntwo probably but that's okay, right.\n\n79\n00:04:20.520 --> 00:04:22.380\nI don't need my recent out there.\n\n80\n00:04:22.380 --> 00:04:29.020\nI don't want my resource\nexplorer out there.\n\n81\n00:04:29.020 --> 00:04:31.550\nResource groups I'm gonna leave out there.\n\n82\n00:04:31.550 --> 00:04:34.910\nWhat else as I go down through this list?\n\n83\n00:04:34.910 --> 00:04:37.600\nWe're not gonna be working with SQL.\n\n84\n00:04:37.600 --> 00:04:42.910\nGonna take away subscriptions, and\nI know there's some I'm missing,\n\n85\n00:04:42.910 --> 00:04:44.910\nbut virtual machines,\nI don't want the classic.\n\n86\n00:04:44.910 --> 00:04:49.190\nI need virtual network gateways,\nI need virtual networks for today.\n\n87\n00:04:49.190 --> 00:04:50.530\nWhat else, I need some IPs.\n\n88\n00:04:50.530 --> 00:04:54.490\nWhere are my public, if I can find them.\n\n89\n00:04:56.240 --> 00:04:59.200\nPublic IP addresses,\nwe're gonna need those.\n\n90\n00:04:59.200 --> 00:05:03.000\nAnd that's probably good for now I think.\n\n91\n00:05:03.000 --> 00:05:08.110\nAnything else I'll just have to come back\ninto this list and find it when I need it.\n\n92\n00:05:08.110 --> 00:05:10.720\nSo again,\nreally just want to show you how you can\n\n93\n00:05:10.720 --> 00:05:14.200\ncustomize this interface to exactly\nwhat you need to do, right.\n\n94\n00:05:14.200 --> 00:05:15.690\nWhat do you do in this portal every day?\n\n95\n00:05:15.690 --> 00:05:17.445\nWhat do you commonly work with?\n\n96\n00:05:17.445 --> 00:05:21.530\nWell, change this list up to\nshow those kind of things.\n\n97\n00:05:21.530 --> 00:05:22.850\nAll right, so if we remember back,\n\n98\n00:05:22.850 --> 00:05:25.470\nhopefully you've watched all those\nprevious episodes, and we think about\n\n99\n00:05:25.470 --> 00:05:29.670\nwhat we went through, we're gonna kinda\ngo through, hopefully the same order.\n\n100\n00:05:29.670 --> 00:05:34.260\nBut what you're gonna see is it's\nnot quite as user-friendly, or\n\n101\n00:05:34.260 --> 00:05:38.680\nautomated, maybe is a good word for\nit, as the classic portal was.\n\n102\n00:05:38.680 --> 00:05:40.700\nAgain, this is still being developed.\n\n103\n00:05:40.700 --> 00:05:45.500\nAnd I'll tell you that they really\nwant you to surprise, surprise,\n\n104\n00:05:45.500 --> 00:05:49.530\nuse PowerShell to work\nwith your Azure resources.\n\n105\n00:05:51.000 --> 00:05:52.920\nSo most everything is getting developed.\n\n106\n00:05:52.920 --> 00:05:54.895\nPowershell commands are being developed,\nand\n\n107\n00:05:54.895 --> 00:05:58.575\nthen at some point they try to go back\nin and add these to the interface.\n\n108\n00:05:58.575 --> 00:06:01.395\nSome of them take a while to show up,\nsome of them don't ever show up.\n\n109\n00:06:01.395 --> 00:06:03.805\nSo anyway,\nlet's see what we can play with.\n\n110\n00:06:03.805 --> 00:06:06.605\nThe first thing we're gonna do is\nwe're gonna create a resource group.\n\n111\n00:06:06.605 --> 00:06:11.105\nNow resource groups are similar to\nwhat we used to call cloud services.\n\n112\n00:06:11.105 --> 00:06:14.215\nRight, it really is just\na group of resources,\n\n113\n00:06:14.215 --> 00:06:16.982\nand we're just gonna click Add up here.\n\n114\n00:06:16.982 --> 00:06:20.770\nAnd there's really two\nways of going about this.\n\n115\n00:06:21.800 --> 00:06:23.060\nLet me show you what I mean.\n\n116\n00:06:23.060 --> 00:06:27.460\nI can go to New,\nup here at the top left and\n\n117\n00:06:27.460 --> 00:06:30.070\nthen I can find, I think resource group,\n\n118\n00:06:30.070 --> 00:06:35.560\nlet's see is gonna be under possibly\nManagement, I have to remember.\n\n119\n00:06:35.560 --> 00:06:37.340\nThere's my resource group right there.\n\n120\n00:06:37.340 --> 00:06:39.580\nSo I can definitely go this way and\n\n121\n00:06:39.580 --> 00:06:43.910\nbegin creating that resource group or\nany other thing I need to create.\n\n122\n00:06:43.910 --> 00:06:47.840\nAnother way to do it is\nsimply go to resource groups,\n\n123\n00:06:47.840 --> 00:06:48.870\neven though you don't have one yet.\n\n124\n00:06:48.870 --> 00:06:51.170\nAnd it might show you\nthat you don't have any.\n\n125\n00:06:51.170 --> 00:06:53.310\nI've got all the defaults\nthat come with Azure.\n\n126\n00:06:53.310 --> 00:06:57.530\nAnd I can click Add up here and\nit brings me right to that same screen.\n\n127\n00:06:57.530 --> 00:07:00.760\nSo just two different ways to\nend up at the same destination.\n\n128\n00:07:00.760 --> 00:07:02.820\nCommon Microsoft thing, right?\n\n129\n00:07:02.820 --> 00:07:08.135\nSo let's call this resource group\nsomething like RG80 in Azure.\n\n130\n00:07:08.135 --> 00:07:11.730\nAnd I'm gonna make sure it's\nassociated with my subscription.\n\n131\n00:07:11.730 --> 00:07:16.710\nAs for my resource group location,\nwhy it went to Brazil South, I'm not sure.\n\n132\n00:07:16.710 --> 00:07:18.270\nWe'll go to East US.\n\n133\n00:07:18.270 --> 00:07:21.860\nAnd I'll go ahead and pin it to\nthe dashboard although, we'll go ahead and\n\n134\n00:07:21.860 --> 00:07:25.660\npin it to the dashboard, and\nthen I'll click Create, and\n\n135\n00:07:25.660 --> 00:07:27.490\nwe'll end up with a resource group.\n\n136\n00:07:27.490 --> 00:07:31.090\nAnd remember a resource group, like\na cloud service, is just a collection or\n\n137\n00:07:31.090 --> 00:07:35.100\na container that's gonna contain\nall of the objects that I create.\n\n138\n00:07:35.100 --> 00:07:37.820\nNow, you can create several\ndifferent resource groups.\n\n139\n00:07:37.820 --> 00:07:41.270\nThe idea is, if you're deploying\napplications in particular\n\n140\n00:07:41.270 --> 00:07:43.410\nthat have more than one\nresource associated with them.\n\n141\n00:07:43.410 --> 00:07:49.030\nLike a web front end, a mid tier,\na SQL Backend, things like that and maybe\n\n142\n00:07:49.030 --> 00:07:54.560\nmultiple web front ends to load balance,\na load balancer, a web security group.\n\n143\n00:07:54.560 --> 00:07:56.734\nAll of that stuff could be\nin the same resource group.\n\n144\n00:07:56.734 --> 00:07:59.030\nAnd I can kinda treat it as a unit.\n\n145\n00:07:59.030 --> 00:08:02.442\nThat's the idea behind\nthose resource groups.\n\n146\n00:08:02.442 --> 00:08:05.754\nSo, there I've got my new\nresource group created.\n\n147\n00:08:05.754 --> 00:08:08.650\nWe are good to go there.\n\n148\n00:08:08.650 --> 00:08:13.260\nAnother thing that i need and i did not\nadd to my, actually, i missed one or two,\n\n149\n00:08:13.260 --> 00:08:14.120\nis a storage account.\n\n150\n00:08:14.120 --> 00:08:16.780\nRight?\nJust like in a classic, i need store,\n\n151\n00:08:16.780 --> 00:08:19.450\nthe place to store things.\n\n152\n00:08:19.450 --> 00:08:21.160\nSo, we're gonna come down here and\n\n153\n00:08:21.160 --> 00:08:24.880\nlook for storage because i got\nmy storage account classic.\n\n154\n00:08:24.880 --> 00:08:28.640\nWe're not gonna do that we're gonna\nwith the new school storage accounts.\n\n155\n00:08:28.640 --> 00:08:30.390\n>> Now Mike,\n\n156\n00:08:30.390 --> 00:08:34.600\nhow does the new storage accounts differ\nfrom the classic storage accounts?\n\n157\n00:08:34.600 --> 00:08:37.410\n>> You know really I don't think\nthey do that much there might be\n\n158\n00:08:37.410 --> 00:08:41.300\nsome differences in the background but\n>> They definitely don't play\n\n159\n00:08:41.300 --> 00:08:42.640\nnicely together.\n\n160\n00:08:42.640 --> 00:08:44.930\nLike, you don't take\nresources in the classic, and\n\n161\n00:08:44.930 --> 00:08:48.030\nput them in your storage account\ncreated in the new portal.\n\n162\n00:08:49.420 --> 00:08:53.300\nBut as far as the differences go, I'm sure\nthere are some in the background, but\n\n163\n00:08:53.300 --> 00:08:55.810\nit's more about how you access them and\ninterface with them.\n\n164\n00:08:55.810 --> 00:08:58.860\n>> Gotcha, so it's more of\nkinda doing the same thing but\n\n165\n00:08:58.860 --> 00:09:01.110\nprobably going around\na different way to do it.\n\n166\n00:09:01.110 --> 00:09:03.690\nSo that's why they're not\nreally compatible even\n\n167\n00:09:03.690 --> 00:09:04.990\nthough they're doing the exact same thing.\n\n168\n00:09:04.990 --> 00:09:06.260\n>> Exactly right.\n\n169\n00:09:06.260 --> 00:09:08.480\nSo I'm gonna call this\nsomething like store.\n\n170\n00:09:08.480 --> 00:09:09.940\nOops, I can't type.\n\n171\n00:09:09.940 --> 00:09:15.660\nStore dash AD, in as you're trying to\nkeep a theme going in the name this time.\n\n172\n00:09:15.660 --> 00:09:18.300\nI know last time I was all over\nthe place with some of my names and\n\n173\n00:09:18.300 --> 00:09:19.490\n>> And that's something that you\n\n174\n00:09:19.490 --> 00:09:22.830\nreally should plan out because as you\nmight have seen from my episodes,\n\n175\n00:09:22.830 --> 00:09:25.420\nit starts getting a little bit confusing.\n\n176\n00:09:25.420 --> 00:09:27.400\nAnd I think even more so\n\n177\n00:09:27.400 --> 00:09:30.440\nin this new portal because you'll\nsee the way things are done.\n\n178\n00:09:30.440 --> 00:09:33.040\nIf you really want to name things,\n\n179\n00:09:33.040 --> 00:09:35.500\nhave some type of naming\nconvention you're using.\n\n180\n00:09:35.500 --> 00:09:37.910\nTo keep everything straight.\n\n181\n00:09:37.910 --> 00:09:40.570\nAnd as far as the type goes,\nI guess this is a little different,\n\n182\n00:09:40.570 --> 00:09:42.820\nlike there are different\ntypes that I can choose,\n\n183\n00:09:42.820 --> 00:09:45.380\nwhere as in the classic you\nreally didn't get a choice.\n\n184\n00:09:46.630 --> 00:09:49.830\nHere I can choose some different\noptions as far as whether it's like,\n\n185\n00:09:49.830 --> 00:09:54.468\nthis is premium so\nit's doing 5,000 Max NRops,\n\n186\n00:09:54.468 --> 00:09:59.480\ninput/output per second,\niops, stores page blobs.\n\n187\n00:09:59.480 --> 00:10:04.570\nThis one is three local replicas but\nless performance.\n\n188\n00:10:04.570 --> 00:10:07.243\nBut do you see the price difference?\n\n189\n00:10:07.243 --> 00:10:09.910\n$19.71 per month versus $2.40 per month.\n\n190\n00:10:09.910 --> 00:10:15.700\nFor this less performance store trip, it\nwould depend on what you're trying to do.\n\n191\n00:10:15.700 --> 00:10:17.900\nDo you need it geodistributed.\n\n192\n00:10:17.900 --> 00:10:22.180\nDo I need the storage geodistributed\nat different regions to work with\n\n193\n00:10:22.180 --> 00:10:24.360\nnatural disaster type fall tolerance.\n\n194\n00:10:24.360 --> 00:10:29.370\nAnd you have several options to choose\nfrom I'm just going to go with this,\n\n195\n00:10:29.370 --> 00:10:30.440\nwhat do we got?\n\n196\n00:10:30.440 --> 00:10:34.090\n240 versus three down is,\nlet's do with the 240, we'll go cheap.\n\n197\n00:10:35.100 --> 00:10:37.142\nMy boss'll like that.\n\n198\n00:10:37.142 --> 00:10:38.277\n[LAUGH].\n\n199\n00:10:38.277 --> 00:10:41.610\nAll right,\nuh-oh it's not liking my name here.\n\n200\n00:10:41.610 --> 00:10:49.160\nIt doesn't like the dash in there so\nwe'll just get rid of that dash.\n\n201\n00:10:49.160 --> 00:10:52.990\nAnd now i'm just gonna spell it out then,\nstorageadinazure.\n\n202\n00:10:52.990 --> 00:10:56.770\n3 and 24 characters,\nso I'm okay now right?\n\n203\n00:10:56.770 --> 00:10:57.980\nYep, there we go.\nIt went away.\n\n204\n00:10:57.980 --> 00:11:01.560\nI got my little green, if you can see that\nnow, I've got my little green check mark.\n\n205\n00:11:01.560 --> 00:11:04.150\nDidn't like the hyphen in my name.\n\n206\n00:11:04.150 --> 00:11:06.420\nDiagnostics, I'll leave those enabled.\n\n207\n00:11:06.420 --> 00:11:08.640\nSubscription ITProTV demo.\n\n208\n00:11:08.640 --> 00:11:11.870\nResource group, now you could\ncreate a new resource group if you\n\n209\n00:11:11.870 --> 00:11:15.600\nhadn't done that already or\nI can choose select existing.\n\n210\n00:11:15.600 --> 00:11:20.310\nAnd so, it's a little bit confusing,\nI don't know, to me it is anyway.\n\n211\n00:11:20.310 --> 00:11:23.780\nYou choose select existing and\nthen it says not configured.\n\n212\n00:11:23.780 --> 00:11:25.940\nYou have to click on that.\n\n213\n00:11:25.940 --> 00:11:28.760\nAnd that's gonna bring up a list\nof all your resource groups.\n\n214\n00:11:28.760 --> 00:11:31.750\nWe can choose the one we\nwant to store this in.\n\n215\n00:11:32.910 --> 00:11:34.600\nOr make this a part of and\nwe're good to go.\n\n216\n00:11:34.600 --> 00:11:39.130\nGot my location, I'll pin it to\nthe dashboard and I'll click create.\n\n217\n00:11:40.620 --> 00:11:47.110\nSo now we have our resource group created\nas well as our storage account created.\n\n218\n00:11:47.110 --> 00:11:50.450\nAs far as the portal goes,\nyou'll notice it's a little bit\n\n219\n00:11:50.450 --> 00:11:53.090\ndifferent in the fact that I don't\nget that bar across the bottom\n\n220\n00:11:53.090 --> 00:11:55.760\nshowing me that things are working or\nin progress.\n\n221\n00:11:55.760 --> 00:12:00.180\nI do have however get a tile and so\nyou're seeing deploying storage account,\n\n222\n00:12:00.180 --> 00:12:03.060\nthere is my resource group\nthat I created earlier.\n\n223\n00:12:03.060 --> 00:12:05.180\nAnd the message is right\nup here at the top.\n\n224\n00:12:05.180 --> 00:12:09.140\nAnd now I can see there my deployment\nhas started for my storage account.\n\n225\n00:12:09.140 --> 00:12:12.160\nThere's the message for\nthe resource group having completed.\n\n226\n00:12:13.400 --> 00:12:14.800\nAnd these tiles are clickable.\n\n227\n00:12:14.800 --> 00:12:15.450\nYou can click on them.\n\n228\n00:12:16.670 --> 00:12:19.350\nAnd it takes you right\nto that resource group.\n\n229\n00:12:19.350 --> 00:12:23.520\nAll right, so we'll let this finish.\n\n230\n00:12:23.520 --> 00:12:25.950\nAnd there we go, deployment succeeded.\n\n231\n00:12:25.950 --> 00:12:29.960\nSo we're good to go there, and\nnow I've got my storage group.\n\n232\n00:12:29.960 --> 00:12:33.090\nYou can see it's a little prettier,\nright, the interface?\n\n233\n00:12:33.090 --> 00:12:36.430\nYou've got information down there about\nthe storage group, or in this case,\n\n234\n00:12:36.430 --> 00:12:38.140\nI'm sorry, my storage account.\n\n235\n00:12:38.140 --> 00:12:40.550\nYou've got where you can go up and\n\n236\n00:12:40.550 --> 00:12:44.930\nread your audit logs you can check your\nproperties and each one of these is\n\n237\n00:12:44.930 --> 00:12:50.610\ncalled a blade and as you click on them\none will slide in and one will slide out.\n\n238\n00:12:50.610 --> 00:12:54.190\nThere's my access keys my account type\n\n239\n00:12:54.190 --> 00:12:57.780\nwe already chose our storage account\ntype right I could change that up but\n\n240\n00:12:57.780 --> 00:13:01.500\nI wouldn't get the performance I\nneeded maybe I wanted to change out\n\n241\n00:13:01.500 --> 00:13:06.300\nwhat storage account I'm using alert\nrules if I needed to get alerts.\n\n242\n00:13:06.300 --> 00:13:08.940\nYou can add new alerts for\nyour storage account.\n\n243\n00:13:08.940 --> 00:13:10.860\nSo lots of neat things in here.\n\n244\n00:13:10.860 --> 00:13:13.260\nAgain, I can scroll horizontally.\n\n245\n00:13:13.260 --> 00:13:15.760\nI can see those blades sliding out.\n\n246\n00:13:15.760 --> 00:13:20.730\nIf you close the first blade, it should\nclose all the rest of the blades and\n\n247\n00:13:20.730 --> 00:13:23.370\nget you back to your dashboard.\n\n248\n00:13:23.370 --> 00:13:25.400\nAll right, so we got our resource\ngroup and we got our storage account.\n\n249\n00:13:25.400 --> 00:13:27.390\nWe're really just getting things ready,\nright?\n\n250\n00:13:27.390 --> 00:13:30.780\nMaking places to create what\nwe really wanna create,\n\n251\n00:13:30.780 --> 00:13:32.210\nwhich is that virtual network.\n\n252\n00:13:32.210 --> 00:13:36.580\nNow we got a place to store that and\na resource group to tie them all together.\n\n253\n00:13:36.580 --> 00:13:37.540\nSo that will be next,\n\n254\n00:13:37.540 --> 00:13:41.360\nwe're gonna go with a virtual\nnetworks over here on my nav tree.\n\n255\n00:13:41.360 --> 00:13:42.549\nI'm gonna click virtual networks.\n\n256\n00:13:43.940 --> 00:13:45.390\nI don't have any yet.\n\n257\n00:13:45.390 --> 00:13:47.920\nSo I'm gonna click the add\nbutton to create one.\n\n258\n00:13:51.230 --> 00:13:53.140\nAnd give it just a second and\n\n259\n00:13:53.140 --> 00:13:57.790\nit will give me the opportunity\nto create my new virtual network.\n\n260\n00:13:57.790 --> 00:14:04.280\nSo I'm gonna call this VNET 01 And\nfor my address space,\n\n261\n00:14:04.280 --> 00:14:07.610\nI am going to change it up a little bit\nfrom what we dd in the previous one.\n\n262\n00:14:07.610 --> 00:14:10.570\nI'm going to go with a 10.2 network for\nmy cloud.\n\n263\n00:14:10.570 --> 00:14:13.350\nBecause I was thinking about\nthe method I was using\n\n264\n00:14:13.350 --> 00:14:14.565\nbefore\n>> Wild man.\n\n265\n00:14:14.565 --> 00:14:17.110\n[LAUGH]\n>> I'm getting crazy now.\n\n266\n00:14:17.110 --> 00:14:21.970\nIn the other episodes I used\n10.1.1 on the local and 10.1.2,\n\n267\n00:14:21.970 --> 00:14:27.020\nFor an Azure, but I did kinda limit\nmyself as far as growth goes.\n\n268\n00:14:27.020 --> 00:14:31.380\nI had to jump around that Azure\nsubnet to add another subnet for\n\n269\n00:14:31.380 --> 00:14:33.290\nthe Tokyo office that we created, right?\n\n270\n00:14:33.290 --> 00:14:36.730\nSo I was thinking,\nhey let's plan ahead this time.\n\n271\n00:14:36.730 --> 00:14:40.270\nI'm gonna do the ten for the cloud stuff.\n\n272\n00:14:40.270 --> 00:14:41.175\nI'm gonna do 10.2.0.\n\n273\n00:14:41.175 --> 00:14:45.820\n.0.0 with a 16 bit subnet mask.\n\n274\n00:14:45.820 --> 00:14:50.620\nThat gives me plenty of room to create\nall the subnets I could ever need\n\n275\n00:14:50.620 --> 00:14:53.900\nout there in the cloud and\nI can still use the 10.1.0.0 for\n\n276\n00:14:53.900 --> 00:14:57.890\nall of my local subnets or\nmy on premises subnet.\n\n277\n00:14:57.890 --> 00:14:59.990\nAnd you do need to create\nat least one subnet.\n\n278\n00:14:59.990 --> 00:15:04.390\nWhen you create this network, notice\nthis is like the entire address space.\n\n279\n00:15:04.390 --> 00:15:08.280\nAnd then within that I've gotta create\nmy subnet and I'm gonna just call this\n\n280\n00:15:08.280 --> 00:15:15.110\nsomething like Vsub01,\nmy first subnet that I'm gonna create.\n\n281\n00:15:15.110 --> 00:15:19.140\nAnd let's do 10.2.1 for sub01.\n\n282\n00:15:19.140 --> 00:15:22.120\nAll right,\nit's gonna give me 256 addresses in there.\n\n283\n00:15:22.120 --> 00:15:23.750\nShould be good to go.\n\n284\n00:15:23.750 --> 00:15:27.290\nAnd if I scroll down a little\nbit further I've got my\n\n285\n00:15:27.290 --> 00:15:31.080\nsubscription I wanna associate that\nwith and then my resource group.\n\n286\n00:15:31.080 --> 00:15:37.130\nAnd again, instead of giving me a drop\ndown list it gives me a select existing.\n\n287\n00:15:37.130 --> 00:15:38.750\nAnd then it doesn't give\nme a drop down list.\n\n288\n00:15:38.750 --> 00:15:40.700\nI still have to click on this.\n\n289\n00:15:40.700 --> 00:15:42.740\nAnd then eventually I can\nfind my resource script.\n\n290\n00:15:42.740 --> 00:15:46.290\nA little bit funky in my opinion,\nbut they didn't ask me.\n\n291\n00:15:46.290 --> 00:15:50.280\nI used U.S. for my location and\nI'll go ahead and click create and\n\n292\n00:15:50.280 --> 00:15:52.950\nnow I've got my virtual network.\n\n293\n00:15:54.230 --> 00:15:57.847\n>> I do like the fact that it all shows\nup right there at your dashboard, right?\n\n294\n00:15:57.847 --> 00:15:59.473\nIt's got all the nice tiles.\n\n295\n00:15:59.473 --> 00:16:03.516\nI wasn't a huge fan of tiles when they\ncame out with it in Windows 8.1 or 8.0.\n\n296\n00:16:03.516 --> 00:16:06.990\nWhen that came out, but the more I've\nworked with it the more I've like it.\n\n297\n00:16:06.990 --> 00:16:10.812\nAnd they've ported that over\ninto the Azure new portal and\n\n298\n00:16:10.812 --> 00:16:12.650\nthat is a feature I do like.\n\n299\n00:16:12.650 --> 00:16:14.760\n>> It is nice cuz you can\nget information right here,\n\n300\n00:16:14.760 --> 00:16:16.440\njust like our live tiles\nlike you were saying.\n\n301\n00:16:16.440 --> 00:16:20.270\nSo you can get information right there\non the tile, nice quick overview.\n\n302\n00:16:20.270 --> 00:16:24.130\nThere goes, it looks like,\na completed as I can see my Information,\n\n303\n00:16:24.130 --> 00:16:28.690\nmy resource group, my location,\nmy subscription, my IT address range.\n\n304\n00:16:28.690 --> 00:16:34.070\nIf I collapse this up, I can see I don't\nhave any connected devices at the moment.\n\n305\n00:16:34.070 --> 00:16:36.860\nOver here in the settings,\nand if this was closed,\n\n306\n00:16:36.860 --> 00:16:41.020\nI can always get to settings by clicking\nhere or all settings, right here.\n\n307\n00:16:41.020 --> 00:16:42.640\nEither way, it's gonna work.\n\n308\n00:16:42.640 --> 00:16:47.080\nAnd that I can get back to here I can see\nthat the properties for this network,\n\n309\n00:16:47.080 --> 00:16:48.520\nwhich isn't too exciting.\n\n310\n00:16:48.520 --> 00:16:53.850\nI can see the address space,\nso I can see my 10.2.0.0, and\n\n311\n00:16:53.850 --> 00:16:59.360\nthen by subnets that I've created,\nV sub 01 with the 10 2 1.\n\n312\n00:16:59.360 --> 00:17:00.080\nRight?\n\n313\n00:17:00.080 --> 00:17:04.650\nAnd then DNS servers, you know,\nyou'll notice that what I'm\n\n314\n00:17:04.650 --> 00:17:08.370\nhoping you're noticing is that\neverything seems very independent,\n\n315\n00:17:08.370 --> 00:17:11.140\nwhere in the classic\nit kind of guided you.\n\n316\n00:17:11.140 --> 00:17:11.780\nAnd I don't know,\n\n317\n00:17:11.780 --> 00:17:15.520\nat least to me it seemed like it\nalmost made you go in a certain order.\n\n318\n00:17:15.520 --> 00:17:18.830\nHere you can go in pretty\nmuch any order you want,\n\n319\n00:17:18.830 --> 00:17:22.140\nlike you can do the DNS servers first.\n\n320\n00:17:22.140 --> 00:17:26.370\nSorry, with DNS servers you can't do\nthem first because you don't see this.\n\n321\n00:17:26.370 --> 00:17:30.140\nThere is no register DNS\nservers like we had in classic.\n\n322\n00:17:30.140 --> 00:17:32.880\nIt's done right here after\nyou create the network.\n\n323\n00:17:32.880 --> 00:17:35.370\nSo again,\na little bit different on the order.\n\n324\n00:17:35.370 --> 00:17:41.410\nAnd let's go ahead and do the DNS\nwhile we're here before I forget.\n\n325\n00:17:41.410 --> 00:17:44.510\nAzure DNS servers yet,\ndon't have any machines up there, but\n\n326\n00:17:44.510 --> 00:17:51.068\nI'm gonna do my custom DNS server and\nthat's gonna be 10.1.1.10.\n\n327\n00:17:51.068 --> 00:17:55.440\nThat's why on-premises DNS server, and\n\n328\n00:17:55.440 --> 00:17:59.790\nthen you need to click save up here\nat the top, and that will save that.\n\n329\n00:17:59.790 --> 00:18:02.390\nAnd all that does, remember what that's\ngoing to do is as those machines get\n\n330\n00:18:02.390 --> 00:18:05.770\ncreated, that's going to be where\nthey get their TCP/IP config,\n\n331\n00:18:05.770 --> 00:18:08.730\nit'll tell them what DNS server to use.\n\n332\n00:18:08.730 --> 00:18:12.550\nSave that, there we go,\nmy changes have been saved.\n\n333\n00:18:12.550 --> 00:18:15.770\nWe are good to go so\nI kind of did that out of order but\n\n334\n00:18:15.770 --> 00:18:20.170\nI figured while we were here might as\nwell otherwise I might forget right?\n\n335\n00:18:20.170 --> 00:18:21.180\n>> Mike you are forgetful.\n\n336\n00:18:21.180 --> 00:18:22.820\n>> I am a little forgetful.\n\n337\n00:18:22.820 --> 00:18:23.540\nAll right so\n\n338\n00:18:23.540 --> 00:18:28.140\nwhat else now the next thing we need to\ndo is we need to create a gateway subnet.\n\n339\n00:18:28.140 --> 00:18:32.670\nIf you remember from the classic we\ncreated a very small little subnet\n\n340\n00:18:32.670 --> 00:18:36.590\nthat would be used by Azure,\nnot really directly by us.\n\n341\n00:18:36.590 --> 00:18:41.530\nI think they used a 28 or 29 bit subnet\nmask, and that's where it basically built\n\n342\n00:18:41.530 --> 00:18:45.740\nthe VPN endpoint that we\nconnected to up there in Azure.\n\n343\n00:18:45.740 --> 00:18:47.340\nWe're gonna do the same thing here, but\n\n344\n00:18:47.340 --> 00:18:52.310\nthere is no there is no,\nif that's proper English, I'm not sure.\n\n345\n00:18:52.310 --> 00:18:53.340\n>> There aren't any.\n\n346\n00:18:53.340 --> 00:18:57.230\n>> There aren't any, there's not an easy\nway or there's no button that says hey.\n\n347\n00:18:57.230 --> 00:18:59.550\nLet's go ahead and\nadd a gateway subnet, right?\n\n348\n00:18:59.550 --> 00:19:02.320\nYou have to create it just like\nyou did your other subnets.\n\n349\n00:19:02.320 --> 00:19:08.720\nSo you click the add button here and\nit brings up my new subnet dialog box.\n\n350\n00:19:08.720 --> 00:19:13.810\nAnd, pay attention to this,\nwhen the teacher stomps the foot,\n\n351\n00:19:13.810 --> 00:19:16.810\nyou need to know this gateway subnet.\n\n352\n00:19:17.920 --> 00:19:20.990\nThat has to be the name of the subnet.\n\n353\n00:19:20.990 --> 00:19:23.950\nThe others you can call them whatever\nthe heck you want, if you don't call this\n\n354\n00:19:23.950 --> 00:19:27.980\none gateway subnet, Azure will not\nrecognize it as your gateway subnet,\n\n355\n00:19:27.980 --> 00:19:31.960\nand it won't allow you to set up that\ngateway to connect to the outside world,\n\n356\n00:19:31.960 --> 00:19:33.300\nor create our site-to-site.\n\n357\n00:19:33.300 --> 00:19:38.550\nSo one thing that you have to do is name\nthe subnet gateway subnet, I'm just gonna\n\n358\n00:19:38.550 --> 00:19:44.500\nget them over here, and use a .28, which\nshould give me 16, or so address there.\n\n359\n00:19:44.500 --> 00:19:47.400\nNetwork security group, I'm not gonna add,\nwe're not really getting into network\n\n360\n00:19:47.400 --> 00:19:52.360\nsecurity groups in here, but at some\npoint you will go over these in some\n\n361\n00:19:52.360 --> 00:19:56.470\nother class or some other videos that we\ndo, I think of network security groups as\n\n362\n00:19:56.470 --> 00:20:01.250\nalmost ways to isolate your\nvirtual networks up in Azure.\n\n363\n00:20:01.250 --> 00:20:04.190\nLet's say I wanted to set up\na front end and a back end,\n\n364\n00:20:04.190 --> 00:20:06.730\nmy front end was basically\ngoing to be my DMZ.\n\n365\n00:20:06.730 --> 00:20:11.490\nWell, you connect network security\ngroups that encapsulate you're a virtual\n\n366\n00:20:11.490 --> 00:20:15.660\nnetwork that you've created, and then you\ncan create rules that control traffic\n\n367\n00:20:15.660 --> 00:20:19.390\nbetween those network security groups,\nso you can have your front end and\n\n368\n00:20:19.390 --> 00:20:23.650\nthen your back end, and only certain\nmachines are allowed, certain IPs ranges\n\n369\n00:20:23.650 --> 00:20:28.230\nare allowed to talk to that backend, so\nit protects it from say, external traffic.\n\n370\n00:20:28.230 --> 00:20:30.110\n>> So it works kinda like a firewall then?\n\n371\n00:20:30.110 --> 00:20:31.240\n>> Yep, it's exactly right.\n\n372\n00:20:31.240 --> 00:20:32.580\nIt's exactly what your doing.\n\n373\n00:20:32.580 --> 00:20:36.700\nNow they don't call it that, you don't\nsee that, but that's what your doing.\n\n374\n00:20:36.700 --> 00:20:38.730\nThen the access control is the rule for\nbasically\n\n375\n00:20:38.730 --> 00:20:39.760\n>> God forbid we call it the thing that\n\n376\n00:20:39.760 --> 00:20:42.150\neveryone calls it,\nwe'll call it a security group,\n\n377\n00:20:42.150 --> 00:20:43.975\nthen that'll make sense\nto everyone that sees it.\n\n378\n00:20:43.975 --> 00:20:46.400\n[LAUGH]\n>> That's they way they like to do it.\n\n379\n00:20:46.400 --> 00:20:49.140\nAll right, we'll go ahead and\nclick okay to add that subnet.\n\n380\n00:20:49.140 --> 00:20:52.620\nHopefully I didn't\noverlap any ranges there.\n\n381\n00:20:53.650 --> 00:20:59.720\nI should be good to go, and eventually\nit will add my little gateway subnet.\n\n382\n00:20:59.720 --> 00:21:02.760\nSo again, the whole key there was\nto make sure you actually name it.\n\n383\n00:21:02.760 --> 00:21:03.930\nGateway subnet.\n\n384\n00:21:03.930 --> 00:21:06.120\nI don't know if it's case-sensitive.\n\n385\n00:21:06.120 --> 00:21:09.340\nI went ahead and used the proper case\nthe way they do it just in case.\n\n386\n00:21:09.340 --> 00:21:12.230\nNever really wanted to try it,\nhave it fail, have to do it again.\n\n387\n00:21:12.230 --> 00:21:15.340\nBut maybe one day I'll\nexperiment with that.\n\n388\n00:21:15.340 --> 00:21:17.500\nAll right, so that subnet should show up.\n\n389\n00:21:17.500 --> 00:21:21.240\nI'm gonna close that blade and\nthen open that blade up again.\n\n390\n00:21:21.240 --> 00:21:23.220\nAnd there's my gateway subnet.\n\n391\n00:21:24.460 --> 00:21:27.590\nSo now we got a place, but remember that\ndoesn't actually create the gateway.\n\n392\n00:21:27.590 --> 00:21:31.340\nAll that does is create\nthe gateway subnet place to locate\n\n393\n00:21:31.340 --> 00:21:35.730\nthe gateway that we will\neventually be creating.\n\n394\n00:21:35.730 --> 00:21:37.550\nAlright, I'm gonna close all this down.\n\n395\n00:21:37.550 --> 00:21:40.340\nAnd I think to me you know Daniel and\nI know I keep harping on this,\n\n396\n00:21:40.340 --> 00:21:44.360\nbut you guys that have you'll\nprobably love this interface.\n\n397\n00:21:44.360 --> 00:21:47.950\nI tend to find myself\ngetting lost in blades.\n\n398\n00:21:47.950 --> 00:21:51.460\nYou start clicking out here and\nthings start sliding over and\n\n399\n00:21:51.460 --> 00:21:52.990\nthen I'm like wait, where was I?\n\n400\n00:21:52.990 --> 00:21:53.490\nWhat?\n\n401\n00:21:54.990 --> 00:21:56.590\nDrives me crazy.\n\n402\n00:21:56.590 --> 00:21:57.530\n>> You know how it is Mike.\n\n403\n00:21:57.530 --> 00:22:00.860\nOnce you get used to the interface,\nyou're like, yea, it's three blades down,\n\n404\n00:22:00.860 --> 00:22:03.425\ntwo down, and\nyou go past the deli on third.\n\n405\n00:22:03.425 --> 00:22:05.900\n[LAUGH] And\nthen you're right where you need to be.\n\n406\n00:22:05.900 --> 00:22:07.170\nYou know exactly what to do.\n\n407\n00:22:07.170 --> 00:22:07.680\n>> Exactly.\n\n408\n00:22:07.680 --> 00:22:09.610\nIt's what drives me crazy.\n\n409\n00:22:09.610 --> 00:22:12.490\nAll right.\nSo now we've got that set up.\n\n410\n00:22:12.490 --> 00:22:13.700\nWhat else are we need here, Daniel?\n\n411\n00:22:13.700 --> 00:22:16.570\nWe're going to need\na local gateway network.\n\n412\n00:22:16.570 --> 00:22:20.120\nRemember what I want to do is\nI want to create a gateway.\n\n413\n00:22:21.130 --> 00:22:26.090\nAnd let's see what happens here,\nlet's go ahead and create a,\n\n414\n00:22:26.090 --> 00:22:29.150\nI do not have my local network defined.\n\n415\n00:22:29.150 --> 00:22:32.640\nWhat's gonna happen is if I try to\nclick on virtual network gateway\n\n416\n00:22:32.640 --> 00:22:34.890\ncause logically you might\nthink that's the next step.\n\n417\n00:22:34.890 --> 00:22:38.090\nI've created my network, my sub nets,\n\n418\n00:22:38.090 --> 00:22:41.390\nmy gateway sub net,\nnow I wanna create that gateway, right?\n\n419\n00:22:41.390 --> 00:22:44.240\nWell let's see what happens when\nI click add to create my gateway.\n\n420\n00:22:47.600 --> 00:22:48.790\nIt gives me my dialogue and\n\n421\n00:22:48.790 --> 00:22:52.890\nchoose my virtual network,\nchoose a public IP address.\n\n422\n00:22:52.890 --> 00:22:54.790\nHave we created a public IP address yet,\nDaniel?\n\n423\n00:22:54.790 --> 00:22:55.570\n>> That's a negative.\n\n424\n00:22:55.570 --> 00:22:56.670\n>> That is a big negative.\n\n425\n00:22:56.670 --> 00:22:58.440\nSo we haven't done that yet.\n\n426\n00:22:58.440 --> 00:23:03.480\nAs I scroll down here, resource group,\nso there's something I'm going to need.\n\n427\n00:23:03.480 --> 00:23:05.430\nNow, I could create it through here.\n\n428\n00:23:05.430 --> 00:23:07.760\nI could actually say go ahead and\ncreate a new one.\n\n429\n00:23:07.760 --> 00:23:11.630\nI will tell you that every time I've\ntried to do it this way It's failed.\n\n430\n00:23:11.630 --> 00:23:15.080\nI'm assuming that's probably just\na little glitch somewhere and\n\n431\n00:23:15.080 --> 00:23:17.840\nthat'll be fixed because they obviously\nhave a create new button there.\n\n432\n00:23:17.840 --> 00:23:19.730\n>> It's just not ready for primetime yet.\n\n433\n00:23:19.730 --> 00:23:20.390\n>> Maybe not.\n\n434\n00:23:20.390 --> 00:23:26.160\nSo I'm gonna go ahead and\ncreate that before I get into here and\n\n435\n00:23:26.160 --> 00:23:29.800\nI'm gonna do that with my there's\nmy public IP addresses and\n\n436\n00:23:29.800 --> 00:23:35.160\nremember the way we deal with IP addresses\nup in the cloud right I want a new\n\n437\n00:23:35.160 --> 00:23:40.340\npublic IP address that I can assign to\nthe gateway I'm getting ready to create.\n\n438\n00:23:40.340 --> 00:23:45.890\nSo I'm gonna give it a name here\nI'm gonna call this my gateway IP.\n\n439\n00:23:45.890 --> 00:23:50.700\nAnd then you might be\ntempted to choose static.\n\n440\n00:23:50.700 --> 00:23:54.250\nStatic makes sense,\nI don't want that IP address to change.\n\n441\n00:23:54.250 --> 00:23:55.540\nWell, it won't work.\n\n442\n00:23:55.540 --> 00:23:57.751\nIf you go and you choose static,\nit'll give you,\n\n443\n00:23:57.751 --> 00:23:59.762\nit'll generate a static public IP address.\n\n444\n00:23:59.762 --> 00:24:01.464\nThen you go to create the gateway and\n\n445\n00:24:01.464 --> 00:24:04.720\nit'll say static addresses are not\nallowed, it has to be dynamic.\n\n446\n00:24:04.720 --> 00:24:07.077\nWell wait, I don't want it to ever change.\n\n447\n00:24:07.077 --> 00:24:08.214\nAnd it's not gonna change.\n\n448\n00:24:08.214 --> 00:24:14.216\nThe dynamic address gets reserved for\nyou for the lifetime of that gateway,\n\n449\n00:24:14.216 --> 00:24:17.790\nand it won't change,\nso it is static maybe.\n\n450\n00:24:17.790 --> 00:24:21.273\n>> So it's a static address\nthat' been dynamically assigned.\n\n451\n00:24:21.273 --> 00:24:23.056\n[LAUGH]\n>> Yes, there you go, all right so\n\n452\n00:24:23.056 --> 00:24:27.960\nas counter-intuitive as it might seem,\nwe're gonna choose dynamic for this one.\n\n453\n00:24:27.960 --> 00:24:30.180\nIdle time out I'm not going to change.\n\n454\n00:24:30.180 --> 00:24:36.383\nDNS name label,\nI'll call this my ADN Azure\n\n455\n00:24:36.383 --> 00:24:41.420\ngateway, or something like that.\n\n456\n00:24:41.420 --> 00:24:43.900\nAnd, resource group, select existing.\n\n457\n00:24:43.900 --> 00:24:47.880\nNot configured, so I click on that,\nchoose that AD in Azure, oops.\n\n458\n00:24:47.880 --> 00:24:50.350\nIs that the one I've been creating?\n\n459\n00:24:50.350 --> 00:24:51.810\nYou know, I've been using\nthat one this whole time and\n\n460\n00:24:51.810 --> 00:24:55.420\nI thought we created a different one.\n\n461\n00:24:55.420 --> 00:24:58.670\nI was using RG, I'm going to have and\nchange some of those guys.\n\n462\n00:24:58.670 --> 00:25:01.300\nI've been using this old test one\nthat I started, you know what?\n\n463\n00:25:01.300 --> 00:25:02.490\nI'll just continue to use that.\n\n464\n00:25:02.490 --> 00:25:05.750\nI'll show you how to change the resource\ngroup later on, how about that?\n\n465\n00:25:05.750 --> 00:25:09.940\nBecause everything I'm doing so\nfar is AD in Azure test.\n\n466\n00:25:09.940 --> 00:25:13.037\nWe'll go East US, and I'll click create.\n\n467\n00:25:16.312 --> 00:25:20.061\nAnd it's gonna go through the process\nof requesting a public IP address to be\n\n468\n00:25:20.061 --> 00:25:20.890\nassigned to me.\n\n469\n00:25:20.890 --> 00:25:24.610\nSo let's see what we've got here.\n\n470\n00:25:25.760 --> 00:25:27.300\nAnd there is my Gateway IP.\n\n471\n00:25:27.300 --> 00:25:33.990\nNow you might think I can see\nthe actual IP, but it's blank.\n\n472\n00:25:33.990 --> 00:25:34.630\nAll right.\nAnd\n\n473\n00:25:34.630 --> 00:25:39.070\nthat's because really what you've done\nis you've created the request for\n\n474\n00:25:39.070 --> 00:25:43.730\nthe IP address but until you associate it\nwith a resource, it's not going to create.\n\n475\n00:25:43.730 --> 00:25:48.250\nIt's not actually going to\ngenerate the IP address.\n\n476\n00:25:48.250 --> 00:25:49.350\nI know, I'm telling you, it's odd.\n\n477\n00:25:49.350 --> 00:25:50.130\nIt's different.\n\n478\n00:25:50.130 --> 00:25:51.590\n>> It's gonna take some getting used to.\n\n479\n00:25:51.590 --> 00:25:52.480\n[LAUGH]\n>> It's different, and\n\n480\n00:25:52.480 --> 00:25:55.530\nthat's why I thought it\nwould be worth going through\n\n481\n00:25:55.530 --> 00:25:59.480\nthis new portal because this is the way\nthey want you to do things now.\n\n482\n00:25:59.480 --> 00:26:01.780\nAll right, so we're getting closer.\n\n483\n00:26:01.780 --> 00:26:05.920\nNow we're going to choose\na Virtual Network Gateway and\n\n484\n00:26:05.920 --> 00:26:09.160\nwe'll see how close we\ncan come to finishing.\n\n485\n00:26:09.160 --> 00:26:11.730\nWe'll click Add.\nAnd the nice thing about this though,\n\n486\n00:26:11.730 --> 00:26:14.840\nif you've noticed is if I get\ninto something and I realize,\n\n487\n00:26:14.840 --> 00:26:19.650\nI didn't get that public IP address yet, I\ncan just close that little blade, go back,\n\n488\n00:26:19.650 --> 00:26:22.360\nget the public IP address and\ntry it again, right?\n\n489\n00:26:22.360 --> 00:26:25.620\nIt doesn't balk at me,\nit doesn't scream, lock anything up, so\n\n490\n00:26:25.620 --> 00:26:27.720\nit's pretty nice there.\n\n491\n00:26:27.720 --> 00:26:29.470\nSo now, what do we call this one?\n\n492\n00:26:29.470 --> 00:26:36.584\nLet's call this my Azure NAD Gateway.\n\n493\n00:26:38.906 --> 00:26:43.150\nAll right and my virtual network that\nI'm creating as gateway to is VNET 01.\n\n494\n00:26:43.150 --> 00:26:45.510\nNotice it's not one of the subnets.\n\n495\n00:26:45.510 --> 00:26:47.720\nIt's the actual virtual network.\n\n496\n00:26:47.720 --> 00:26:50.060\nPublic IP address.\n\n497\n00:26:50.060 --> 00:26:50.580\nWell, there it is.\n\n498\n00:26:50.580 --> 00:26:51.550\nNotice it says unassigned.\n\n499\n00:26:51.550 --> 00:26:53.310\nSo I'm gonna select it.\n\n500\n00:26:54.630 --> 00:26:57.490\nGateway type is gonna be VPN.\n\n501\n00:26:57.490 --> 00:27:00.490\nRemember this,\nroute base versus policy base,\n\n502\n00:27:00.490 --> 00:27:06.010\nto do a site to site VPN it\nmust be a route base VPN.\n\n503\n00:27:07.320 --> 00:27:09.750\nResource group, not configured.\n\n504\n00:27:09.750 --> 00:27:12.390\nWe'll go in and we'll choose that same\nresource group I've been using for\n\n505\n00:27:12.390 --> 00:27:13.960\neverything else.\n\n506\n00:27:13.960 --> 00:27:17.656\nLocation needs US,\npin it to my dashboard, click create, and\n\n507\n00:27:17.656 --> 00:27:22.285\nthen you wait for it to either bounce it\nback to it or say yeah, you did it right?\n\n508\n00:27:23.355 --> 00:27:27.415\n>> Now Mike why doesn't that policy\nbased VPN work with what we're doing?\n\n509\n00:27:27.415 --> 00:27:30.665\n>> Because it's specific to\nthat particular protocols.\n\n510\n00:27:30.665 --> 00:27:34.477\nYou create a policy says I wanna\nallow this traffic to go through.\n\n511\n00:27:34.477 --> 00:27:38.747\nWell if we're gonna put Active Directory\nand basically our infrastructure up there\n\n512\n00:27:38.747 --> 00:27:41.847\nand create a site to site,\nit is to allow all protocols.\n\n513\n00:27:41.847 --> 00:27:44.507\nSo rather than having to try and\ncreate a policy for each and\n\n514\n00:27:44.507 --> 00:27:47.277\nevery one,\nit allows everything to go through.\n\n515\n00:27:47.277 --> 00:27:51.727\nNow we can still control and\ndo filters on the VPN tunnel and\n\n516\n00:27:51.727 --> 00:27:55.220\nstuff like that to control the traffic,\nbut it does have to be that route based.\n\n517\n00:27:56.700 --> 00:28:02.020\nAll right, so let that go for just a\nminute, it'll deploy that network gateway.\n\n518\n00:28:03.430 --> 00:28:08.410\nAnd remember, that's not the actual\ngateway, that's the gateway network that's\n\n519\n00:28:08.410 --> 00:28:14.000\nbeen created within our gateway subnet\nthat's part of our virtual network.\n\n520\n00:28:14.000 --> 00:28:16.170\n>> Yeah, that makes a whole lot of sense.\n\n521\n00:28:16.170 --> 00:28:17.180\n>> Right.\n>> I'm there with you and\n\n522\n00:28:17.180 --> 00:28:18.405\nhopefully you guys are there as well.\n\n523\n00:28:18.405 --> 00:28:22.330\n[LAUGH] It can seem a bit complex,\nthat's for sure.\n\n524\n00:28:22.330 --> 00:28:23.910\nThat's a good way to put it.\n\n525\n00:28:23.910 --> 00:28:28.400\nBut again it's just like anything a lot of\ntimes with these types of systems you just\n\n526\n00:28:28.400 --> 00:28:32.110\nhave to continue to work with them and\nsee what works and what doesn't work.\n\n527\n00:28:32.110 --> 00:28:34.500\nThank goodness Mike has\ndone the legwork for us, so\n\n528\n00:28:34.500 --> 00:28:38.390\nfar he's showing us all the pitfalls and\nhurdles to get around so\n\n529\n00:28:38.390 --> 00:28:41.380\nthat we can implement this a whole lot\nquicker than if we were just trying to\n\n530\n00:28:41.380 --> 00:28:45.840\nstumble through it and figure out how\nthis system actually works in reality.\n\n531\n00:28:45.840 --> 00:28:47.230\n>> Yeah, you know, and\n\n532\n00:28:47.230 --> 00:28:51.920\nanother thing that I've found after going\nthrough this new portal a few times is,\n\n533\n00:28:51.920 --> 00:28:56.260\nyou know, like I said, they really want\nyou to use Power Shell, and I'm ready.\n\n534\n00:28:56.260 --> 00:28:59.100\nAfter doing this three or\nfour times to prep for this show, and\n\n535\n00:28:59.100 --> 00:29:02.650\nget all this stuff set up so\nthat we could do it together, I realized,\n\n536\n00:29:02.650 --> 00:29:05.410\nI don't want to have to\ndo this all the time.\n\n537\n00:29:05.410 --> 00:29:07.500\nYou know, this is something where\nI want a script waiting and\n\n538\n00:29:07.500 --> 00:29:10.000\nI can just run a script anytime I need to.\n\n539\n00:29:10.000 --> 00:29:13.160\nSo, and we are going to take\na look at doing that as well\n\n540\n00:29:13.160 --> 00:29:14.500\nat some point in this show.\n\n541\n00:29:14.500 --> 00:29:17.180\nSo I'll show you how to do\nall of this via PowerShell.\n\n542\n00:29:18.220 --> 00:29:19.982\nAll right, so that is still deploying.\n\n543\n00:29:19.982 --> 00:29:21.510\nWhat else can we look\nat while we're waiting?\n\n544\n00:29:21.510 --> 00:29:25.300\nWe've really got most of it ready to go,\nright?\n\n545\n00:29:25.300 --> 00:29:29.970\nThe only thing we've got left to do\nis create the gateway itself, and\n\n546\n00:29:29.970 --> 00:29:31.700\nI'd really like to get to that.\n\n547\n00:29:31.700 --> 00:29:34.640\nRight before we run out of time on this\nshow because remember from the previous\n\n548\n00:29:34.640 --> 00:29:37.250\nepisodes that's that 30 minute task,\nright.\n\n549\n00:29:37.250 --> 00:29:38.910\nThere's just no getting around it.\n\n550\n00:29:38.910 --> 00:29:43.460\nYou click on create the actual gateway and\nit takes it, almost to the tee,\n\n551\n00:29:43.460 --> 00:29:46.762\nI think that every time, or the last time\nthat I did it it was like 34 minutes.\n\n552\n00:29:46.762 --> 00:29:50.740\nBut it's almost right at\n30 minutes on the nose.\n\n553\n00:29:50.740 --> 00:29:52.120\nIt does take a little while.\n\n554\n00:29:52.120 --> 00:29:59.740\nAs soon as this finishes, we should\nbe able to create our little gateway.\n\n555\n00:29:59.740 --> 00:30:00.756\n[CROSSTALK]\n>> You can refresh the page.\n\n556\n00:30:00.756 --> 00:30:01.278\n>> Yeah.\n\n557\n00:30:01.278 --> 00:30:02.180\n[LAUGH]\n>> Sometimes that works.\n\n558\n00:30:02.180 --> 00:30:05.900\n>> You know they were actually\nhaving an issue this morning.\n\n559\n00:30:05.900 --> 00:30:09.410\nI came in and\nthere was a blue dot right here and\n\n560\n00:30:09.410 --> 00:30:12.080\nwhen I went to click on that\nto see what's happening,\n\n561\n00:30:12.080 --> 00:30:16.140\nthere was some informational messages in\nEast U.S. was actually having a problem.\n\n562\n00:30:16.140 --> 00:30:19.230\nHere I can see the latest\nmessages that it was resolved.\n\n563\n00:30:19.230 --> 00:30:23.300\nWhat was happening was, any time you\nspun up a new machine in East U.S.,\n\n564\n00:30:23.300 --> 00:30:26.550\nthe machine would spin up if you\nbuilt a new virtual machine.\n\n565\n00:30:27.830 --> 00:30:31.080\nBut your tile would not show it.\n\n566\n00:30:31.080 --> 00:30:33.930\nAnd so I tried to just to see what\nwould happen and I got a tile for\n\n567\n00:30:33.930 --> 00:30:34.550\nthe new machine.\n\n568\n00:30:34.550 --> 00:30:37.000\nBut it said, deployment failed.\n\n569\n00:30:37.000 --> 00:30:39.330\nBut if I went over here and\nwent to virtual machines,\n\n570\n00:30:39.330 --> 00:30:42.340\nyou saw the virtual machine and\nI can remote into it, it was fine.\n\n571\n00:30:42.340 --> 00:30:45.620\nBut the tile itself is\nnot updating properly.\n\n572\n00:30:45.620 --> 00:30:50.068\nSo they had an issue and\nlooks like they have resolved that issue.\n\n573\n00:30:50.068 --> 00:30:55.510\nBut I thought it was pretty impressive\nthat within 30 minutes of the problem\n\n574\n00:30:55.510 --> 00:30:59.040\nbeing discovered they had messages out\nletting everybody know what was going on.\n\n575\n00:30:59.040 --> 00:31:01.530\nThey put up messages\nevery two hours I think,\n\n576\n00:31:01.530 --> 00:31:03.670\nkeeping people posted on the progress.\n\n577\n00:31:03.670 --> 00:31:06.140\nAnd as soon as it was resolved,\nthey posted another message,\n\n578\n00:31:06.140 --> 00:31:09.760\nso pretty cool that they\nkeep us informed like that.\n\n579\n00:31:11.430 --> 00:31:13.420\nAll right.\nBack out here, it is still deploying so\n\n580\n00:31:13.420 --> 00:31:17.840\nI guess we could take a break here,\ncome back,\n\n581\n00:31:17.840 --> 00:31:20.910\nwe'll see that it has deployed and\nmove on from there if you want.\n\n582\n00:31:20.910 --> 00:31:22.300\n>> All right.\nThat is perfectly fine.\n\n583\n00:31:22.300 --> 00:31:24.460\nThat's the great thing\nabout our show format.\n\n584\n00:31:24.460 --> 00:31:26.381\nAs we can do what we want.\n\n585\n00:31:26.381 --> 00:31:29.530\n[LAUGH] So Mike, I look forward to\nseeing you there and thank you for\n\n586\n00:31:29.530 --> 00:31:31.480\nshowing us what we've learned so far.\n\n587\n00:31:31.480 --> 00:31:33.510\nHow to work with this new Azure portal.\n\n588\n00:31:33.510 --> 00:31:37.140\nThere is a couple new little hiccups\nsince you got to be familiar with.\n\n589\n00:31:37.140 --> 00:31:41.090\nBut once we get there and Mike's doing\na great job of leading us down that road,\n\n590\n00:31:41.090 --> 00:31:44.308\nwe'll be able to use that new\nportal as well as the classic.\n\n591\n00:31:44.308 --> 00:31:45.830\nSo Mike, I look forward to\nseeing you in the next show and\n\n592\n00:31:45.830 --> 00:31:47.930\nlook forward to seeing you there as well.\n\n593\n00:31:47.930 --> 00:31:48.504\nThanks for watching.\n\n594\n00:31:48.504 --> 00:31:50.582\nWe're gonna go ahead and\nsign off for ITProTV.\n\n595\n00:31:50.582 --> 00:31:51.767\nI've been your host Daniel Lowery.\n\n596\n00:31:51.767 --> 00:31:52.787\n>> And I'm Mike Roderick.\n\n597\n00:31:52.787 --> 00:31:53.658\n>> We'll see you next time.\n\n598\n00:31:53.658 --> 00:32:02.960\n[SOUND]\n\n",
          "vimeoId": "156015452"
        },
        {
          "description": "In this episode, Mike and Daniel finished creating the Site-to-Site VPN. They pickup by creating local network gateway and create the VPN connection. Then they make sure they can establish the connection. Finally they create a virtual Machine which will be the host for the Azure side replica Domain Controller.",
          "length": "1598",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-2-2-create_a_site_to_site_vpn_pt2-021716-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-2-2-create_a_site_to_site_vpn_pt2-021716-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-2-2-create_a_site_to_site_vpn_pt2-021716-1-sm.jpg",
          "title": "Create a Site-to-Site VPN Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.369 --> 00:00:13.458\nAll right.\n\n3\n00:00:13.458 --> 00:00:17.510\nGreetings, everyone, and welcome to\nanother exciting episode of ITProTV.\n\n4\n00:00:17.510 --> 00:00:18.911\nI'm your host, Daniel Lowrie.\n\n5\n00:00:18.911 --> 00:00:20.151\nAnd, in today's episode, well,\n\n6\n00:00:20.151 --> 00:00:23.980\nwe are moving forward with our\nActive Directory in Azure series.\n\n7\n00:00:23.980 --> 00:00:28.130\nBack again today to join us to help\ncontinue that train down the tracks is\n\n8\n00:00:28.130 --> 00:00:29.600\nour good friend, Mr. Mike Roderick.\n\n9\n00:00:29.600 --> 00:00:31.100\nMike, welcome back to the show, sir.\n\n10\n00:00:31.100 --> 00:00:32.430\n>> Thanks for the engineer position.\n\n11\n00:00:32.430 --> 00:00:33.710\nI am guiding us down the tracks.\n\n12\n00:00:33.710 --> 00:00:35.850\nAll right.\nThanks for having me back, and yes,\n\n13\n00:00:35.850 --> 00:00:39.970\nexcited, we are continuing on using\nthat new portal, right, to rinse and\n\n14\n00:00:39.970 --> 00:00:44.850\nrepeat, to create that site-to-site VPN\nbetween our on-premises network and\n\n15\n00:00:44.850 --> 00:00:47.990\nour Azure network so\nwe can extend Active Directory out there.\n\n16\n00:00:47.990 --> 00:00:49.630\nHost domain controllers.\n\n17\n00:00:49.630 --> 00:00:51.380\nNot Azure AD, right?\n\n18\n00:00:51.380 --> 00:00:53.050\nNot just an identity management solution,\n\n19\n00:00:53.050 --> 00:00:58.530\nbut actual copy of our Active Directory\nout there in our Azure network.\n\n20\n00:00:58.530 --> 00:01:01.140\nWe can use that for disaster recovery.\n\n21\n00:01:01.140 --> 00:01:04.970\nWe can use that to support branch offices,\ndeploying Cloud apps.\n\n22\n00:01:04.970 --> 00:01:06.450\nYou know, Cloud based apps,\nthings like that.\n\n23\n00:01:06.450 --> 00:01:10.360\nSo, mobile users, traveling people\nthat are traveling, working from home,\n\n24\n00:01:10.360 --> 00:01:15.000\nall kinds of great benefits from extending\nactive directory out there into the Cloud.\n\n25\n00:01:15.000 --> 00:01:19.250\nSo as we went along we\ngot a lot of the pieces,\n\n26\n00:01:19.250 --> 00:01:21.870\nparts put into place to\ncreate that site to site VPN.\n\n27\n00:01:21.870 --> 00:01:23.050\nWe went through and\n\n28\n00:01:23.050 --> 00:01:27.460\ncreated our resource group to associate\nall the resources that were deploying.\n\n29\n00:01:27.460 --> 00:01:29.050\nWe created a storage account so\n\n30\n00:01:29.050 --> 00:01:32.910\nthat we had some place to put all of\nthis resources that we are creating.\n\n31\n00:01:32.910 --> 00:01:37.856\nWe created out virtual network, we created\na subnet within that virtual network,\n\n32\n00:01:37.856 --> 00:01:40.540\nwe created a gateway\nsubnet that Microsoft or\n\n33\n00:01:40.540 --> 00:01:45.216\nAzure users at the edge of our network to\nallow us to create that site to to site.\n\n34\n00:01:45.216 --> 00:01:48.544\nAnd then the last thing we did was we\ncreated the virtual network gateway in\n\n35\n00:01:48.544 --> 00:01:52.410\nthat previous episodes, remember that\nthe one that takes 30 minutes right about,\n\n36\n00:01:52.410 --> 00:01:55.384\nthis time was actually quick Daniel,\nit took 26 minutes or so.\n\n37\n00:01:55.384 --> 00:01:59.478\n>> Yeah, we were screaming right along and\nwe thought that was gonna be in the next\n\n38\n00:01:59.478 --> 00:02:02.350\nstep but it actually turned\nout to be that actual step.\n\n39\n00:02:02.350 --> 00:02:06.070\n>> I misspoke a little bit there\nprobably at the end of that last one.\n\n40\n00:02:06.070 --> 00:02:06.880\nBut we did.\n\n41\n00:02:06.880 --> 00:02:10.078\nWhen you created that\nvirtual network gateway,\n\n42\n00:02:10.078 --> 00:02:14.950\nthat's what they used to in the classic\nportal call just the gateway.\n\n43\n00:02:14.950 --> 00:02:17.820\nSo that virtual network\ngateway is the gateway.\n\n44\n00:02:17.820 --> 00:02:19.860\nSo at this point,\nif we take a look at my screen,\n\n45\n00:02:19.860 --> 00:02:23.440\nit did finish up right\nhere Azure in AD gateway.\n\n46\n00:02:23.440 --> 00:02:27.160\nIf I click on that, you'll see I\nhave my virtual network gateway,\n\n47\n00:02:27.160 --> 00:02:31.530\nand it has a public IP\naddress assigned to it.\n\n48\n00:02:31.530 --> 00:02:35.090\nThat's what I need so\nthat I can establish that tunnel.\n\n49\n00:02:35.090 --> 00:02:39.680\nWhen I configure my on premises VPN\nserver, that's the address I'm gonna use.\n\n50\n00:02:39.680 --> 00:02:41.770\nThat's what we're connecting to.\n\n51\n00:02:41.770 --> 00:02:46.200\nBut if I look at connections,\nwell, I don't have any yet.\n\n52\n00:02:46.200 --> 00:02:49.350\nNow I could click this add button right\nhere, and go ahead and add the connection.\n\n53\n00:02:49.350 --> 00:02:54.910\nBut what's gonna happen when I do that\nis it's gonna want to know about my,\n\n54\n00:02:54.910 --> 00:02:56.780\nwhat have we got here?\n\n55\n00:02:56.780 --> 00:03:02.640\nPre-shared key, resource, location,\nfirst gateway we've got access to.\n\n56\n00:03:02.640 --> 00:03:06.790\nIf I change this to site to site,\nwhich was what we're trying to do right.\n\n57\n00:03:06.790 --> 00:03:10.000\nThis first option which we really\ndidn't see in the classic portal,\n\n58\n00:03:10.000 --> 00:03:15.950\nyou can do these in classic portal but\nyou can do a VNET to VNET type tunnel.\n\n59\n00:03:15.950 --> 00:03:18.590\nSo if you had two separate\nvirtual networks you could tunnel\n\n60\n00:03:18.590 --> 00:03:19.410\nbetween those two.\n\n61\n00:03:19.410 --> 00:03:23.020\nIf I change this to site to site which is\nwhat we're doing, one of the things that\n\n62\n00:03:23.020 --> 00:03:27.260\nit's going to need is my local network\ngateway, which we haven't created yet.\n\n63\n00:03:27.260 --> 00:03:31.890\nNow if I click here it would give\nme the option to go ahead and\n\n64\n00:03:31.890 --> 00:03:33.610\nit's gonna say I don't have any.\n\n65\n00:03:33.610 --> 00:03:36.980\nAnd it usually will give me\nthe option to create one and\n\n66\n00:03:36.980 --> 00:03:38.500\nI can't even create it here.\n\n67\n00:03:38.500 --> 00:03:43.560\nAnd like I said earlier I really\nlike to create things prior to\n\n68\n00:03:43.560 --> 00:03:46.910\nneeding them in those wizards cuz I've had\na couple times where it just glitches.\n\n69\n00:03:46.910 --> 00:03:50.320\nIf I try to add it during the wizard,\nit seems to add it.\n\n70\n00:03:50.320 --> 00:03:53.240\nBut the wizard itself doesn't\nrecognize that it's been added.\n\n71\n00:03:53.240 --> 00:03:55.900\nAnd so I end up cancelling the wizard and\nstarting over anyway.\n\n72\n00:03:55.900 --> 00:03:58.500\nSo I like to just go\nback to the beginning.\n\n73\n00:03:58.500 --> 00:03:59.770\nAnd that's what we're going to do here.\n\n74\n00:03:59.770 --> 00:04:02.990\nI'm gonna click local network gateways.\n\n75\n00:04:02.990 --> 00:04:06.480\nAgain, it's gonna show me that I don't\nhave any, and I'm gonna go ahead and\n\n76\n00:04:06.480 --> 00:04:07.510\nclick Add.\n\n77\n00:04:07.510 --> 00:04:10.730\nSo what I'm doing now is I'm\ndefining my local network,\n\n78\n00:04:10.730 --> 00:04:14.410\nmy on-premises network, it's called\na local network up here in Azure.\n\n79\n00:04:14.410 --> 00:04:16.990\nAnd I'm telling it what\nthat public IP address is,\n\n80\n00:04:16.990 --> 00:04:22.560\nwhat is the other end of that\nsite-to-site tunnel going to be.\n\n81\n00:04:22.560 --> 00:04:26.500\nSo I will call this one my Corp Net or\n\n82\n00:04:26.500 --> 00:04:29.838\nsomething like that for\nmy corporate network.\n\n83\n00:04:29.838 --> 00:04:32.170\nThe IP address is going to be no,\n\n84\n00:04:32.170 --> 00:04:34.560\nyou be careful you might want\nto try to put the range in.\n\n85\n00:04:34.560 --> 00:04:39.090\nThis is actually looking for\nthe public IP address of my local gateway.\n\n86\n00:04:39.090 --> 00:04:43.951\nSo in my case that's 209,\nif I can remember this\n\n87\n00:04:43.951 --> 00:04:48.594\n25 1133154 I think, we'll find out.\n\n88\n00:04:48.594 --> 00:04:55.346\nMy address space is 10.1.1.0/24.\n\n89\n00:04:55.346 --> 00:04:56.954\nNow you can add additional addresses,\n\n90\n00:04:56.954 --> 00:04:59.420\nit needs to know about all\nyour different subnets.\n\n91\n00:04:59.420 --> 00:05:02.170\nThat this site to site\nconnection is going to be\n\n92\n00:05:02.170 --> 00:05:04.390\non the other end of that\nsite to site connection.\n\n93\n00:05:04.390 --> 00:05:07.480\nSo if at the corporate network\nI used more than one subnet,\n\n94\n00:05:07.480 --> 00:05:09.360\nI would want to list them all here.\n\n95\n00:05:09.360 --> 00:05:13.800\nI can always go back and add additional\nones if I want to start with the main one\n\n96\n00:05:13.800 --> 00:05:15.440\nand then add others later, or\n\n97\n00:05:15.440 --> 00:05:19.690\nif I want to restrict to keep this only\ntalking to that one particular subnet.\n\n98\n00:05:19.690 --> 00:05:21.740\nI can also modify these\nin the future as well,\n\n99\n00:05:21.740 --> 00:05:25.975\njust something good to know because\nsometimes we restructure our networks and\n\n100\n00:05:25.975 --> 00:05:30.340\nmaybe we change prefixes to allow for\nmore subnets or what have you.\n\n101\n00:05:30.340 --> 00:05:33.100\nSo you can go back and\nmodify those later on.\n\n102\n00:05:33.100 --> 00:05:35.903\nI tell it what subscription,\nthe resource group and\n\n103\n00:05:35.903 --> 00:05:39.354\nI'm just gonna continue to use\nmy good old test resource group.\n\n104\n00:05:41.876 --> 00:05:44.400\nLocation, [INAUDIBLE]\npin it to my dashboard.\n\n105\n00:05:44.400 --> 00:05:45.300\nClick Create.\n\n106\n00:05:47.790 --> 00:05:52.540\nAnd it will begin the process of\ndeploying my local network gateway.\n\n107\n00:05:54.420 --> 00:05:55.850\nOnce that finishes,\n\n108\n00:05:55.850 --> 00:05:59.880\nwe're done with the cloud portion\nof setting up this site to site.\n\n109\n00:05:59.880 --> 00:06:03.820\nNow we have to go back to the local\nsite and get everything ready there.\n\n110\n00:06:03.820 --> 00:06:05.060\nSo while that's worrying and\n\n111\n00:06:05.060 --> 00:06:09.770\ngrinding I'll refresh your memory on what\nwe've got on our on premises network.\n\n112\n00:06:09.770 --> 00:06:13.760\nI do have my domain controller up and\nrunning.\n\n113\n00:06:15.200 --> 00:06:17.249\nSo this guy is my on premises.\n\n114\n00:06:19.100 --> 00:06:22.200\nLet me get logged in for you guys here so\nwe can take a look at things.\n\n115\n00:06:25.740 --> 00:06:28.870\nMaximize that back out,\nand if we go into sites.\n\n116\n00:06:28.870 --> 00:06:33.140\nI did change this to match my IP\naddress range that I'm using or\n\n117\n00:06:33.140 --> 00:06:35.020\nmy subnets that I'm using\nup there in the cloud.\n\n118\n00:06:35.020 --> 00:06:37.070\nSo if we go to ActiveDirectory sites and\nservices.\n\n119\n00:06:37.070 --> 00:06:40.650\nRemember we did this way back in\none of those early on episodes.\n\n120\n00:06:40.650 --> 00:06:44.070\nI defined a subnet for the Azure network.\n\n121\n00:06:44.070 --> 00:06:49.615\nAnd I associated that subnet with the\nAzure site, so I created a site just for\n\n122\n00:06:49.615 --> 00:06:53.280\nAzure and told it what subnet was being\nused up there, because in the end,\n\n123\n00:06:53.280 --> 00:06:57.240\nthat's going to be what active directory\nuses when it's replicating and\n\n124\n00:06:57.240 --> 00:07:00.670\ncreating that replication topology.\n\n125\n00:07:00.670 --> 00:07:02.870\nSo we got that up and running.\n\n126\n00:07:02.870 --> 00:07:05.020\nWe're good to go there.\n\n127\n00:07:05.020 --> 00:07:07.270\nThen over to our router.\n\n128\n00:07:07.270 --> 00:07:08.870\nOn the router,\nI've already got routing and\n\n129\n00:07:08.870 --> 00:07:12.920\nremote access installed, didn't think\nwe needed to see that again, but\n\n130\n00:07:12.920 --> 00:07:15.580\nI will pull it up and\nshow you what we've got here.\n\n131\n00:07:16.750 --> 00:07:19.450\nJust basic install of routing and\nremote access.\n\n132\n00:07:19.450 --> 00:07:21.350\nI've got two network interfaces.\n\n133\n00:07:21.350 --> 00:07:25.090\nOne connected to my local area network,\none connected to the outside.\n\n134\n00:07:25.090 --> 00:07:28.520\nThat has a public routable\nIP address assigned to it.\n\n135\n00:07:28.520 --> 00:07:32.530\nI did add NAT because I need\nnetwork address translation\n\n136\n00:07:32.530 --> 00:07:36.060\nto route from that 10.1.1\nnetwork to the Internet.\n\n137\n00:07:36.060 --> 00:07:39.220\nSo my users can get\naccess to the Internet.\n\n138\n00:07:39.220 --> 00:07:44.080\nBut other than that it's a pretty standard\ninstall of routing remote access.\n\n139\n00:07:44.080 --> 00:07:49.221\nAll right, there we go, corp net\nlocal network gateway has completed,\n\n140\n00:07:49.221 --> 00:07:51.171\nso we're good to go there.\n\n141\n00:07:51.171 --> 00:07:55.593\nLet's see right now if we have any\nconnections listed yet and we don't,\n\n142\n00:07:55.593 --> 00:07:56.547\nwhich is fine.\n\n143\n00:07:56.547 --> 00:07:59.510\nWe really haven't done anything yet.\n\n144\n00:07:59.510 --> 00:08:00.129\nRight.\n\n145\n00:08:00.129 --> 00:08:05.950\nI'm gonna close all that down and\nlet's do this.\n\n146\n00:08:05.950 --> 00:08:14.270\nLet's just take one more more\nlook at my Azure AD gateway.\n\n147\n00:08:14.270 --> 00:08:18.754\nCuz I'm gonna need that public IP address,\nso let me make sure I write that one down.\n\n148\n00:08:18.754 --> 00:08:24.952\n40.114.53.101.\n\n149\n00:08:24.952 --> 00:08:28.251\nSee if I can read my\nchicken scratch later.\n\n150\n00:08:28.251 --> 00:08:30.560\nAll right and\nagain still don't have connections yet.\n\n151\n00:08:30.560 --> 00:08:33.780\nBut if we're gonna end up adding\na connection but just not yet\n\n152\n00:08:33.780 --> 00:08:38.049\nuntil we,\nlet's see we're gonna do a site to site.\n\n153\n00:08:39.630 --> 00:08:41.330\nAnd I do need that pre-shared key.\n\n154\n00:08:41.330 --> 00:08:42.930\nSo let's go ahead and do that now.\n\n155\n00:08:42.930 --> 00:08:44.760\nMight as well,\nwhile we're here up on the cloud.\n\n156\n00:08:44.760 --> 00:08:48.730\nLet me do that again, just so I can\nshow you what I'm getting ready to do.\n\n157\n00:08:48.730 --> 00:08:51.940\nSo we have our gateway set up, right.\n\n158\n00:08:51.940 --> 00:08:53.696\nNow, I'm gonna go to connections.\n\n159\n00:08:55.136 --> 00:08:57.038\nAnd I'm gonna Add a new connection.\n\n160\n00:08:58.977 --> 00:09:03.353\nAnd I wanna give this a name,\nand I'm gonna call this corp,\n\n161\n00:09:03.353 --> 00:09:08.798\nI don't know corpVPN or corp\nsite-to-site maybe something like that.\n\n162\n00:09:08.798 --> 00:09:10.980\nIt is a site-to-site.\n\n163\n00:09:10.980 --> 00:09:13.610\nIt's coming from the Azure NAD gateway.\n\n164\n00:09:13.610 --> 00:09:18.890\nThat's perfect and then local network\ngateway we'll we just created that.\n\n165\n00:09:18.890 --> 00:09:20.560\nSo it should be able to find my CorpNet.\n\n166\n00:09:22.336 --> 00:09:24.640\nAll right, and then pre-shared key.\n\n167\n00:09:24.640 --> 00:09:28.720\nNow remember in a classic portal,\nit generated one for me.\n\n168\n00:09:28.720 --> 00:09:30.820\nWe created all this, it generated one.\n\n169\n00:09:30.820 --> 00:09:34.380\nAnd I just had to copy it down to my VM or\n\n170\n00:09:34.380 --> 00:09:37.093\nmy routing remote access server\nat my on-premises network.\n\n171\n00:09:37.093 --> 00:09:38.500\nHere it's not gonna do that for me.\n\n172\n00:09:38.500 --> 00:09:42.470\nRemember I said it does seem like there's\na little bit less automation to this.\n\n173\n00:09:42.470 --> 00:09:47.540\nYou would think the new portal might\nhave more but it does seem less helpful.\n\n174\n00:09:47.540 --> 00:09:48.490\nI don't know.\n\n175\n00:09:48.490 --> 00:09:52.340\nMaybe that functionality is coming later\nand I'm just gonna make up something for\n\n176\n00:09:52.340 --> 00:09:53.682\nthis pre-shared key.\n\n177\n00:09:53.682 --> 00:09:56.510\nThe pre-shared key does need\nto be a mixture of letters and\n\n178\n00:09:56.510 --> 00:10:00.110\nnumbers up to 64 characters\nif I remember correctly.\n\n179\n00:10:00.110 --> 00:10:03.100\nSo I'll call this itprotvdemo2016,\n\n180\n00:10:05.790 --> 00:10:11.870\nsomething like that,\njust make it relatively secure.\n\n181\n00:10:11.870 --> 00:10:13.340\nResource Group, it's already in there.\n\n182\n00:10:13.340 --> 00:10:13.980\nWe're good to go.\n\n183\n00:10:13.980 --> 00:10:14.480\nWe click OK.\n\n184\n00:10:16.190 --> 00:10:18.149\nAnd it's going to create that connection,\nall right.\n\n185\n00:10:19.380 --> 00:10:22.320\nBut the other end of the connection\nhas not been configured yet, right.\n\n186\n00:10:22.320 --> 00:10:26.801\nSo it's not actually going to succeed\nin establishing the connection,\n\n187\n00:10:26.801 --> 00:10:29.230\nbut now it's ready to go at this point.\n\n188\n00:10:29.230 --> 00:10:31.762\nHopefully, we'll let that finish up.\n\n189\n00:10:33.269 --> 00:10:35.860\nWell, while we're doing that we\ncan actually flip back over.\n\n190\n00:10:35.860 --> 00:10:40.420\nSo on my router,\non my on-premises RTR here,\n\n191\n00:10:40.420 --> 00:10:45.930\nmy RTR01,\nI need to set up a new interface.\n\n192\n00:10:45.930 --> 00:10:49.190\nAgain, another thing that,\nin the classic, was really nice.\n\n193\n00:10:49.190 --> 00:10:51.800\nWe had that link to download the script.\n\n194\n00:10:51.800 --> 00:10:55.820\nAnd I ran that on my VPN server and\nit created that network interface,\n\n195\n00:10:55.820 --> 00:10:59.020\nadded the protocol,\ncreated a static route for me.\n\n196\n00:10:59.020 --> 00:11:00.440\nIt did all of that.\n\n197\n00:11:00.440 --> 00:11:03.040\nSo here in the new portal\nit's probably even better.\n\n198\n00:11:03.040 --> 00:11:05.610\nI probably just click a button and\nit just does it right?\n\n199\n00:11:05.610 --> 00:11:08.425\n>> I think it pre-cognitively\nknows exactly what you want and\n\n200\n00:11:08.425 --> 00:11:09.275\nit's already there Michael.\n\n201\n00:11:09.275 --> 00:11:11.075\n[LAUGH]\n>> No.\n\n202\n00:11:11.075 --> 00:11:11.640\n>> No.\n\n203\n00:11:11.640 --> 00:11:14.430\nUnfortunately it does nothing for me.\n\n204\n00:11:14.430 --> 00:11:18.420\nSo we get to do it on our own,\nso let's see if we can do this.\n\n205\n00:11:18.420 --> 00:11:21.897\nWe're gonna right-click on\nNetwork Interfaces up here and\n\n206\n00:11:21.897 --> 00:11:25.660\nchoose New Demand Dial Interface and\nI'll click Next.\n\n207\n00:11:25.660 --> 00:11:33.100\nI'll give it a name and I typically like\nto put the IP address 40.114.53.101.\n\n208\n00:11:33.100 --> 00:11:38.320\nHelps me keep track of things, plus I can\nfind that public IP address really easy.\n\n209\n00:11:38.320 --> 00:11:39.870\nI'll click Next.\n\n210\n00:11:39.870 --> 00:11:42.630\nWe are connecting using\na virtual private network.\n\n211\n00:11:42.630 --> 00:11:43.850\nI'll click Next.\n\n212\n00:11:43.850 --> 00:11:48.852\nWe are still using IKEv2,\nsetting up that IP sect tunnel.\n\n213\n00:11:48.852 --> 00:11:54.958\nAnd then the destination address, again,\n\n214\n00:11:54.958 --> 00:11:59.915\nis 40.114.53.101.\n\n215\n00:11:59.915 --> 00:12:01.574\n>> Your writing does like pre-Sumerian.\n\n216\n00:12:01.574 --> 00:12:03.328\n[LAUGH] It's no joke.\n\n217\n00:12:03.328 --> 00:12:05.887\n>> [LAUGH] We'll click,\nI don't wanna route packets,\n\n218\n00:12:05.887 --> 00:12:07.865\nthat's what we talked about last time,\n\n219\n00:12:07.865 --> 00:12:12.500\nI don't need to actually route packets\nacross here, everything's going across.\n\n220\n00:12:12.500 --> 00:12:13.680\nWe'll click Next,\n\n221\n00:12:13.680 --> 00:12:18.370\nbecause we're using pre-shared key I\ndon't even have to enter in credentials.\n\n222\n00:12:18.370 --> 00:12:20.800\nI'll click Next and Finish.\n\n223\n00:12:21.860 --> 00:12:23.030\nAll right, so there we go.\n\n224\n00:12:23.030 --> 00:12:26.370\nI've got my new demand dial,\nbut it's not done yet.\n\n225\n00:12:26.370 --> 00:12:27.730\nSo we're gonna pull up the properties for\n\n226\n00:12:27.730 --> 00:12:31.630\nthat guy, take a look at the options,\nand I want it to be persistent.\n\n227\n00:12:31.630 --> 00:12:34.480\nI don't want it to\nactually be a demand dial.\n\n228\n00:12:34.480 --> 00:12:37.480\nSo it's going to be\na persistent connection.\n\n229\n00:12:37.480 --> 00:12:40.759\nI'll give it 3 redial attempts,\nthat's fine.\n\n230\n00:12:40.759 --> 00:12:45.946\nSecurity wise,\nwe gotta change this over to\n\n231\n00:12:45.946 --> 00:12:50.859\npreshared key, Itprotvdemo2016.\n\n232\n00:12:50.859 --> 00:12:55.630\nAnd then on Networking,\nI wanna make sure to include IP version 4.\n\n233\n00:12:55.630 --> 00:12:58.520\nRemember, I don't need\nthese other protocols,\n\n234\n00:12:58.520 --> 00:13:01.110\nthis interface using\nthose other protocols.\n\n235\n00:13:01.110 --> 00:13:07.300\nI'll click OK, and now we are close.\n\n236\n00:13:07.300 --> 00:13:09.280\nSo, what I'm gonna do is,\nI'm gonna right-click on that and\n\n237\n00:13:09.280 --> 00:13:13.860\nchoose Connect, and\nwe'll see what happens.\n\n238\n00:13:13.860 --> 00:13:18.470\nAll right, so let this guy go, and I've\nseen this, kinda what we did with the last\n\n239\n00:13:18.470 --> 00:13:21.570\none, where it sometimes it can\ntake a little bit to connect.\n\n240\n00:13:21.570 --> 00:13:26.248\nSometimes it takes this end a little\nwhile just to notice that it's connected.\n\n241\n00:13:26.248 --> 00:13:27.720\nI don't know.\nIt'll sit there and\n\n242\n00:13:27.720 --> 00:13:30.990\nsay it's connecting, but if you look\nover here, it's actually connected.\n\n243\n00:13:30.990 --> 00:13:31.730\nSo let's see.\n\n244\n00:13:31.730 --> 00:13:36.900\nLet's go back, close this, and\nsee what we're seeing on this end here.\n\n245\n00:13:38.060 --> 00:13:41.662\nHere's my Azure Virtual Network,\nlet's go to,\n\n246\n00:13:41.662 --> 00:13:44.763\nwhere would be a good\nplace to look at this?\n\n247\n00:13:44.763 --> 00:13:46.388\nAzure Network Gateway.\n\n248\n00:13:50.068 --> 00:13:51.845\nI'm not connected, yet.\n\n249\n00:13:51.845 --> 00:13:53.980\nWe'll see Connections.\n\n250\n00:13:53.980 --> 00:13:56.596\nAnd not connected just yet.\n\n251\n00:13:56.596 --> 00:13:58.873\nSo we'll wait for this guy to go here.\n\n252\n00:14:00.671 --> 00:14:03.399\nI don't know if it'll let me click away,\nwhile this is up.\n\n253\n00:14:05.390 --> 00:14:10.350\nAnd this were can take a few minutes\nto actually establish this connection.\n\n254\n00:14:10.350 --> 00:14:13.199\nI'm not sure why it takes this long.\n\n255\n00:14:15.800 --> 00:14:16.990\nWe'll let that go.\n\n256\n00:14:16.990 --> 00:14:21.500\nAnd really not a lot I can do until\nI either connect, or see what\n\n257\n00:14:21.500 --> 00:14:26.120\nthe error is so I can figure out what the\nproblem is and try to fix the connection.\n\n258\n00:14:26.120 --> 00:14:29.300\nIt should, as far as I know,\nhave everything it needs.\n\n259\n00:14:29.300 --> 00:14:30.980\nI'm gonna cancel that out.\n\n260\n00:14:30.980 --> 00:14:33.130\nAnd now it says, connecting.\n\n261\n00:14:33.130 --> 00:14:35.899\nWe'll just let it go for a minute.\n\n262\n00:14:35.899 --> 00:14:38.058\nIf we can refresh this info.\n\n263\n00:14:38.058 --> 00:14:40.055\nLet's see here.\n\n264\n00:14:42.052 --> 00:14:44.170\nStill showing not connected.\n\n265\n00:14:44.170 --> 00:14:48.550\nSo, I will give it a minute to connect.\n\n266\n00:14:49.660 --> 00:14:53.560\nWhile it's doing that,\nwe can also look over here and\n\n267\n00:14:53.560 --> 00:14:55.540\nsay here I don't, let's refresh that.\n\n268\n00:14:57.560 --> 00:15:00.830\nIt's strange the way\nthis has not picked up.\n\n269\n00:15:00.830 --> 00:15:06.680\nThere's no interface here for\nmy demand dial.\n\n270\n00:15:06.680 --> 00:15:08.910\nSo, what I'm going to do\nis manually create that.\n\n271\n00:15:08.910 --> 00:15:13.580\nUsually, when you check IPv4, when I\nwent to of the demand dial interface,\n\n272\n00:15:13.580 --> 00:15:16.700\nyou check IPv4, and it automatically\nadds the interface to my IPv4.\n\n273\n00:15:16.700 --> 00:15:20.280\nIt did not, so that could be\na little bit of a problem there.\n\n274\n00:15:20.280 --> 00:15:21.970\nI'm gonna say, New Interface.\n\n275\n00:15:21.970 --> 00:15:24.890\nAnd I'm gonna choose that one that\nwe just created, that demand dial.\n\n276\n00:15:24.890 --> 00:15:26.380\nGo ahead and add that there.\n\n277\n00:15:26.380 --> 00:15:29.220\nThere's really nothing to change\non the properties of that.\n\n278\n00:15:29.220 --> 00:15:31.090\nSo we'll leave that going.\n\n279\n00:15:32.170 --> 00:15:33.630\nFlip back over here.\n\n280\n00:15:33.630 --> 00:15:35.180\nStill says, connecting.\n\n281\n00:15:35.180 --> 00:15:36.440\nWe're going to disconnect.\n\n282\n00:15:37.560 --> 00:15:39.280\nYeah and see when it,\ndid you see that error?\n\n283\n00:15:39.280 --> 00:15:41.820\nI kind of clicked OK a little bit,\na little quickly.\n\n284\n00:15:41.820 --> 00:15:44.910\nBut it said cannot disconnect cuz\nit's in the middle of connecting.\n\n285\n00:15:44.910 --> 00:15:48.870\nIt probably is going to be\nconnected in just a minute.\n\n286\n00:15:48.870 --> 00:15:51.754\nThis is usually what I find.\n\n287\n00:15:51.754 --> 00:15:54.504\nI wanna close all this down.\n\n288\n00:15:54.504 --> 00:15:58.504\nJump back out to the dashboard,\nkind of freshen things up here.\n\n289\n00:16:00.106 --> 00:16:03.306\nAnd then we go back into that gateway.\n\n290\n00:16:05.986 --> 00:16:07.506\nTake a look at connections.\n\n291\n00:16:09.526 --> 00:16:12.746\nStill says not connected.\n\n292\n00:16:12.746 --> 00:16:13.810\nNot connected.\n\n293\n00:16:13.810 --> 00:16:14.310\nAll right.\n\n294\n00:16:15.700 --> 00:16:19.290\nSo at this point, we're kind of stuck.\n\n295\n00:16:20.820 --> 00:16:21.590\nWe have to wait.\n\n296\n00:16:21.590 --> 00:16:24.550\nI can see some traffic is actually\nmoving back and forth, and\n\n297\n00:16:24.550 --> 00:16:26.650\nsee how it says connected here.\n\n298\n00:16:26.650 --> 00:16:29.270\nSo there is a good chance\nthat I am connected.\n\n299\n00:16:29.270 --> 00:16:32.620\nIt's just not updating in all\nthe different interfaces yet,\n\n300\n00:16:32.620 --> 00:16:35.630\nwhich is why I hate this trying\nto stop it and do it again.\n\n301\n00:16:35.630 --> 00:16:37.760\nYou really just have to be patient.\n\n302\n00:16:37.760 --> 00:16:40.830\nIt's one of those things that,\nas IT people we usually\n\n303\n00:16:40.830 --> 00:16:46.280\nhave very little of ,because we spend so\nmuch time staring at progress bars.\n\n304\n00:16:46.280 --> 00:16:47.730\nSo we get impatient with this stuff.\n\n305\n00:16:47.730 --> 00:16:51.490\nBut because it says connected there,\nmy guess is that we,\n\n306\n00:16:51.490 --> 00:16:54.040\nnow it says connected here as well.\n\n307\n00:16:54.040 --> 00:17:01.061\nSo if I flip back over to the screen, and\nunfortunately, there's not a Refresh here.\n\n308\n00:17:01.061 --> 00:17:04.143\nWonder if I can do an F5,\nI know it's not gonna like that.\n\n309\n00:17:06.083 --> 00:17:08.190\nWe'll just refresh the whole web page.\n\n310\n00:17:09.830 --> 00:17:11.620\n>> You killed it.\n\n311\n00:17:11.620 --> 00:17:12.472\n>> Say, wake up Azure.\n\n312\n00:17:12.472 --> 00:17:14.640\n>> [LAUGH]\n>> [LAUGH] So, we'll reload that page, and\n\n313\n00:17:14.640 --> 00:17:15.380\nsee what happens.\n\n314\n00:17:15.380 --> 00:17:17.572\nBut, odds are, it actually is connected.\n\n315\n00:17:17.572 --> 00:17:19.610\nThe interface just hasn't\npicked that fact up.\n\n316\n00:17:19.610 --> 00:17:23.020\nIf you remember in the classic, it had\nthat pretty little drawing with the green,\n\n317\n00:17:23.020 --> 00:17:25.890\nand the thing, and they had a little\nbreak in between there, and\n\n318\n00:17:25.890 --> 00:17:26.970\neven once we were connected,\n\n319\n00:17:26.970 --> 00:17:30.970\nit took a little while before that drawing\nupdated and put the two halves together.\n\n320\n00:17:30.970 --> 00:17:32.610\nSame thing going on here.\n\n321\n00:17:32.610 --> 00:17:35.787\nSometimes I get a little\nimpatient waiting for it, but\n\n322\n00:17:35.787 --> 00:17:38.973\nin the end,\nit's doing quite a bit in the background.\n\n323\n00:17:41.413 --> 00:17:44.693\nBut not sure what is doing right now\nbecause I'm not touching anything.\n\n324\n00:17:44.693 --> 00:17:46.420\n[LAUGH]\n>> Microsoft alarms are going\n\n325\n00:17:46.420 --> 00:17:47.043\noff right now.\n\n326\n00:17:47.043 --> 00:17:49.700\n>> [LAUGH]\n>> What's going on on data center and\n\n327\n00:17:49.700 --> 00:17:50.790\nyou assist again?\n\n328\n00:17:50.790 --> 00:17:52.481\n>> And we got blades flying around.\n\n329\n00:17:52.481 --> 00:17:53.960\nSomebody's going to get cut.\n\n330\n00:17:55.320 --> 00:17:56.700\nAll right, let's see.\n\n331\n00:17:56.700 --> 00:17:57.918\nAs you're into the gateway.\n\n332\n00:18:00.158 --> 00:18:01.818\nConnections.\n\n333\n00:18:02.998 --> 00:18:04.146\nYou can do it.\n\n334\n00:18:05.398 --> 00:18:07.898\nCorpNet is now connected.\n\n335\n00:18:07.898 --> 00:18:08.950\nSo, there we go.\n\n336\n00:18:08.950 --> 00:18:13.050\nWe had to do it a little bit\nmore of a manual process, right?\n\n337\n00:18:13.050 --> 00:18:16.990\nWhen I went to this router,\nI didn't have a handy-dandy script to run.\n\n338\n00:18:16.990 --> 00:18:19.620\nYou could create your own script.\n\n339\n00:18:19.620 --> 00:18:21.250\nThere's nothing stopping\nyou from doing that.\n\n340\n00:18:21.250 --> 00:18:23.590\nWe can use PowerShell\nto write the scripts.\n\n341\n00:18:23.590 --> 00:18:27.910\nI'm going to, we might have a chance to do\nsome of that in these episodes coming up.\n\n342\n00:18:27.910 --> 00:18:32.990\nAll right, now there is one more thing\nthat I have to do to finish this off.\n\n343\n00:18:32.990 --> 00:18:35.310\nBecause I have a tunnel established, but\n\n344\n00:18:35.310 --> 00:18:39.420\nbecause there was no script,\nthere's no route added.\n\n345\n00:18:39.420 --> 00:18:47.160\nSo if I do a show IP routing table,\nthis is my router that's connected.\n\n346\n00:18:47.160 --> 00:18:51.260\nI can see routes for the one dot network,\nwhich is the corp net,\n\n347\n00:18:51.260 --> 00:18:52.780\nmy on premises network.\n\n348\n00:18:52.780 --> 00:18:57.592\nI can see your route for\nmy AsYourGateway there that\n\n349\n00:18:57.592 --> 00:19:01.970\n40.114, but the virtual network 10.2.1,\n\n350\n00:19:01.970 --> 00:19:07.180\nand those subnets up there,\nno route was added for that.\n\n351\n00:19:07.180 --> 00:19:11.130\nSo at this point,\nif I had a machine on the 10.1.1 network,\n\n352\n00:19:12.450 --> 00:19:13.710\nI still couldn't connect.\n\n353\n00:19:13.710 --> 00:19:18.720\nThere's a path, there is a tunnel\nestablished between the two endpoints, but\n\n354\n00:19:18.720 --> 00:19:22.180\nthe packets are going to have no way to\nget there because the router doesn't know\n\n355\n00:19:22.180 --> 00:19:24.070\nabout that network up there.\n\n356\n00:19:24.070 --> 00:19:26.580\nWe're not running Rip, or\nanything like tha,t where these\n\n357\n00:19:26.580 --> 00:19:31.030\nVPNs can share their routing information,\nso I need to manually add that.\n\n358\n00:19:31.030 --> 00:19:33.620\nSo what I'm going to do-\n>> Is a static routing table.\n\n359\n00:19:33.620 --> 00:19:34.480\n>> Exactly.\n\n360\n00:19:34.480 --> 00:19:36.660\nSo all you do is you come\nover here to static routes,\n\n361\n00:19:36.660 --> 00:19:41.556\nright click New Static Route,\nand for my interface I'm\n\n362\n00:19:41.556 --> 00:19:45.640\ngoing to choose MyDemandDial,\nand for my destination 10, 2.\n\n363\n00:19:45.640 --> 00:19:48.588\nAnd I'm going to actually,\nI'm not the Cisco guy,\n\n364\n00:19:48.588 --> 00:19:52.475\nsuper knit this, I don't think\nthat's actually what they call it.\n\n365\n00:19:52.475 --> 00:19:53.125\n>> Supernetting?\n\n366\n00:19:53.125 --> 00:19:55.435\n>> Yeah.\n>> To add more networks to your-\n\n367\n00:19:55.435 --> 00:19:56.243\n>> Simplify my routes.\n\n368\n00:19:56.243 --> 00:19:57.795\n>> Yeah.\nInstead of doing a 24-bit,\n\n369\n00:19:57.795 --> 00:20:01.623\nI know there's more than one 10.2.1,\n10.2.2, 10.2.3.\n\n370\n00:20:01.623 --> 00:20:04.543\n>> Yeah, you can-\n>> I can add a route for 10.2.0.0.16.\n\n371\n00:20:04.543 --> 00:20:06.545\n>> Right.\n>> Is that supernetting?\n\n372\n00:20:06.545 --> 00:20:10.647\n>> Supernetting is if you want to add\nmore hosts than [CROSSTALK] kind of doing\n\n373\n00:20:10.647 --> 00:20:14.547\nthe opposite of subnetting which is\nthat it's taking from the host to\n\n374\n00:20:14.547 --> 00:20:15.568\nadd to networks.\n\n375\n00:20:15.568 --> 00:20:17.220\nThe opposite of supernetting.\n\n376\n00:20:17.220 --> 00:20:19.603\n>> So I'm just adding a single route.\n\n377\n00:20:19.603 --> 00:20:24.164\nI could add individual routes,\nlike if I had a 10.2.1.0 network and\n\n378\n00:20:24.164 --> 00:20:27.550\na 10.2.2 virtual network\nup there with a /24.\n\n379\n00:20:27.550 --> 00:20:32.384\nI could add individual routes for each one\nof those, or I could add one route for\n\n380\n00:20:32.384 --> 00:20:38.340\nthe 10.2.0.0/16, because anything\n10.2 is going through this tunnel.\n\n381\n00:20:38.340 --> 00:20:41.260\nAll of the subnets up there\nare going to be 10.2 something.\n\n382\n00:20:41.260 --> 00:20:42.395\nSo I'm going to add it that way.\n\n383\n00:20:42.395 --> 00:20:44.950\nI'll click OK, and there we go.\n\n384\n00:20:44.950 --> 00:20:47.090\nI now have a route.\n\n385\n00:20:47.090 --> 00:20:51.610\nNow, we won't be able to test\nthis until we throw out some\n\n386\n00:20:51.610 --> 00:20:52.650\nvirtual machines up there.\n\n387\n00:20:52.650 --> 00:20:59.150\nI don't have anything yet to ping, so\nwhy don't we, real quick, create a VM?\n\n388\n00:20:59.150 --> 00:21:00.860\nWe've got a few minutes left,\nright Daniel?\n\n389\n00:21:00.860 --> 00:21:02.780\n>> We do.\n>> All right, then I will go ahead and\n\n390\n00:21:02.780 --> 00:21:07.650\ndo that so we can test it and\nmake sure Mike isn't just blowing smoke.\n\n391\n00:21:07.650 --> 00:21:11.840\nSo let's go back over here and\nsee how we create a virtual machine, and\n\n392\n00:21:11.840 --> 00:21:15.630\nthen in our next episode we'll look at\nmaking this guy a domain controller, or\n\n393\n00:21:15.630 --> 00:21:18.040\nadding a couple more virtual machines.\n\n394\n00:21:18.040 --> 00:21:19.310\nI added virtual machines here.\n\n395\n00:21:19.310 --> 00:21:22.430\nRemember, this is\nthe Resource Manager Deployment Model,\n\n396\n00:21:22.430 --> 00:21:24.880\nnot the classic portal, okay?\n\n397\n00:21:24.880 --> 00:21:26.530\nSo they are different.\n\n398\n00:21:26.530 --> 00:21:27.637\n>> We'll click Add.\n\n399\n00:21:30.537 --> 00:21:36.620\nI could also go New, and then Compute, and\nthen find my virtual machine that way.\n\n400\n00:21:36.620 --> 00:21:38.510\nI'm going to choose WIndows server.\n\n401\n00:21:38.510 --> 00:21:40.870\nIt's a little bit,\nthe organization is a little different.\n\n402\n00:21:40.870 --> 00:21:47.700\nLike you have recommended, you have\nwhat's new, we have solutions templates.\n\n403\n00:21:47.700 --> 00:21:50.485\nYou can also search down there.\n\n404\n00:21:50.485 --> 00:21:53.690\nThere's another category,\nApplication Infrastructure.\n\n405\n00:21:53.690 --> 00:21:59.130\nI can search for a server,\nWindows, server and\n\n406\n00:21:59.130 --> 00:22:01.620\nI can find my Server 2012\nData Center that way.\n\n407\n00:22:01.620 --> 00:22:06.014\nEither way you want to go, find that\ntemplate that you want to deploy,\n\n408\n00:22:06.014 --> 00:22:07.730\nselect it and then decide.\n\n409\n00:22:07.730 --> 00:22:11.170\nAgain we're going to use\nthat resource manager model.\n\n410\n00:22:11.170 --> 00:22:14.830\nRemember I think I mentioned this before,\nin the classic portal,\n\n411\n00:22:14.830 --> 00:22:17.400\nyou can basically do it the classic way.\n\n412\n00:22:17.400 --> 00:22:20.340\n>> In the new portal you can\nchoose to do it the new way.\n\n413\n00:22:20.340 --> 00:22:23.430\nSometimes it'll let you do it the old way.\n\n414\n00:22:23.430 --> 00:22:26.540\nSo I've had a classic virtual network,\nand some classic VMs, and\n\n415\n00:22:26.540 --> 00:22:30.290\nI want them to create another VM that\nwould work with those resources.\n\n416\n00:22:30.290 --> 00:22:33.080\nI might choose the classic\ndeployment model here, right?\n\n417\n00:22:33.080 --> 00:22:38.150\nBut we're going all new school in this\nepisode so Resource Manager it is.\n\n418\n00:22:38.150 --> 00:22:39.410\nAnd I'll click Create.\n\n419\n00:22:42.200 --> 00:22:46.390\nAnd we'll go and choose,\nset up our basic settings.\n\n420\n00:22:46.390 --> 00:22:47.352\nSo I'll give this guy a name.\n\n421\n00:22:47.352 --> 00:22:51.919\nI'm going to call it az-dc01,\n\n422\n00:22:51.919 --> 00:22:56.332\nset up a user name and a password.\n\n423\n00:22:56.332 --> 00:22:57.832\nI'm surprised it likes that password.\n\n424\n00:22:57.832 --> 00:22:59.780\nSilly, silly.\n\n425\n00:22:59.780 --> 00:23:06.900\nPut it in my resource group that we're\nusing for everything else, and click OK.\n\n426\n00:23:06.900 --> 00:23:11.170\nAnd then I've got to pick\nthe size of my virtual machine.\n\n427\n00:23:12.490 --> 00:23:15.410\nAnd we saw these earlier\nin another episode, so\n\n428\n00:23:15.410 --> 00:23:20.130\nI'm going to go with that D1 standard for\nthis, and select.\n\n429\n00:23:20.130 --> 00:23:23.666\nYou see that's about $50\nsomething a month there.\n\n430\n00:23:23.666 --> 00:23:25.306\nClick Select.\n\n431\n00:23:29.086 --> 00:23:30.766\nThis time I'm going standard.\n\n432\n00:23:30.766 --> 00:23:33.660\nI don't need the SSD for\nthis storage account.\n\n433\n00:23:33.660 --> 00:23:36.300\nIt already has my storage\naccount selected.\n\n434\n00:23:36.300 --> 00:23:41.986\nI'm going to attach it to that subnet01,\nso on VNET01,\n\n435\n00:23:41.986 --> 00:23:47.681\nsubnet01, 10.2 1-0-24, public IP address.\n\n436\n00:23:47.681 --> 00:23:50.836\nWe're going to get a new public\nIP address for this guy.\n\n437\n00:23:50.836 --> 00:23:53.554\nI haven't had any and\ndidn't request any earlier,\n\n438\n00:23:53.554 --> 00:23:55.730\nbecause I can't reuse that one, right?\n\n439\n00:23:55.730 --> 00:23:59.006\nThe one I got for my gateway,\nthat's Already in use by the gateway.\n\n440\n00:23:59.006 --> 00:24:03.454\nSo, we're not, and I could choose none,\nand I think I might do that for this one,\n\n441\n00:24:03.454 --> 00:24:05.550\nis not give it a public IP address.\n\n442\n00:24:05.550 --> 00:24:07.240\nThis is gonna be a domain controller.\n\n443\n00:24:07.240 --> 00:24:09.940\nI don't necessarily want\na public IP address.\n\n444\n00:24:09.940 --> 00:24:15.490\nAlthough, now that I think about it,\nfor this lab, I might want one.\n\n445\n00:24:16.700 --> 00:24:17.885\nSo that we can do some testing.\n\n446\n00:24:17.885 --> 00:24:20.620\nAnd I could always remove that later,\nall right?\n\n447\n00:24:20.620 --> 00:24:25.050\nSo let's use Create New,\nand I'll call it az-dc01ip.\n\n448\n00:24:25.050 --> 00:24:30.190\nIt's gonna be dynamically assigned,\nand we'll click OK.\n\n449\n00:24:33.290 --> 00:24:36.440\nNetwork security group, it's gonna\ntry to create one on its own, and\n\n450\n00:24:36.440 --> 00:24:40.580\nit's gonna associate it with\nthe network adapter itself.\n\n451\n00:24:40.580 --> 00:24:42.250\nI'm going to choose none for that and\n\n452\n00:24:42.250 --> 00:24:46.890\nwe're gonna wait on those network\nsecurity groups for another show.\n\n453\n00:24:46.890 --> 00:24:48.960\nMonitoring, I'm gonna go ahead and\nleave enabled.\n\n454\n00:24:48.960 --> 00:24:50.670\nStorage Account is already picked.\n\n455\n00:24:50.670 --> 00:24:52.080\nAvailability's set.\n\n456\n00:24:52.080 --> 00:24:53.725\nWe talked about those\nin a previous episode.\n\n457\n00:24:53.725 --> 00:24:57.140\nWe probably won't end up spinning\nup a second domain controller here.\n\n458\n00:24:57.140 --> 00:24:58.740\nWe've already seen how that works.\n\n459\n00:24:58.740 --> 00:25:00.662\nThe availability sets\nwill work the same way.\n\n460\n00:25:00.662 --> 00:25:05.220\nI would have to create a new availability\nset, then create another machine,\n\n461\n00:25:05.220 --> 00:25:09.370\ndump it in there, and then make sure I\ndidn't have any single points of failure.\n\n462\n00:25:09.370 --> 00:25:10.820\nI'm gonna leave it on none.\n\n463\n00:25:10.820 --> 00:25:11.490\nThen click OK.\n\n464\n00:25:11.490 --> 00:25:16.220\nAnd that should spin up my new machine.\n\n465\n00:25:18.920 --> 00:25:23.310\nAlthough, it might take it a minute there\nDaniel, so we'll see how long this takes.\n\n466\n00:25:23.310 --> 00:25:26.480\nIt should take it a minute or\ntwo to spin up.\n\n467\n00:25:26.480 --> 00:25:29.400\nSo we'll let that spin up and I don't\nknow if you're gonna really have time to\n\n468\n00:25:29.400 --> 00:25:31.190\nwait around and then actually test it.\n\n469\n00:25:31.190 --> 00:25:33.240\nWe can do that in the next\nepisode if we have to.\n\n470\n00:25:33.240 --> 00:25:34.000\n>> That sounds good.\n\n471\n00:25:34.000 --> 00:25:35.250\nThat's not a problem.\n\n472\n00:25:35.250 --> 00:25:39.580\nWe're actually seeing the difference\nobviously, cuz we're using a new portal.\n\n473\n00:25:39.580 --> 00:25:41.070\nIt's a different way\nof going about things.\n\n474\n00:25:41.070 --> 00:25:45.180\nThis is not your daddy's portal for\nMicrosoft Azure.\n\n475\n00:25:45.180 --> 00:25:50.200\nThat is for sure a lot more ways for\nus to get in trouble,\n\n476\n00:25:50.200 --> 00:25:52.660\nis really what it looks like,\nto be honest with you.\n\n477\n00:25:52.660 --> 00:25:56.060\nEven though I'm sure that once\nwe've spent a little time in there,\n\n478\n00:25:56.060 --> 00:25:58.900\nwe'll get used to it and things will\nbecome a little more intuitive for us.\n\n479\n00:25:58.900 --> 00:26:02.320\nOnce you're a little more familiar\nwith how things are suppose to work.\n\n480\n00:26:02.320 --> 00:26:06.580\nSo Michael, we look forward to seeing that\nepisode were we finish this all up and\n\n481\n00:26:06.580 --> 00:26:08.540\nwatch everything connect and work and\n\n482\n00:26:08.540 --> 00:26:13.500\nhave connectivity across our site\nto site VPN, always cool stuff.\n\n483\n00:26:13.500 --> 00:26:16.380\nMike is there anything else you want to\ntalk about before we close the show up?\n\n484\n00:26:16.380 --> 00:26:17.140\n>> I think we're good.\n\n485\n00:26:17.140 --> 00:26:20.208\nJust stay tuned to see us install\nActive Directory up there.\n\n486\n00:26:20.208 --> 00:26:20.731\n>> All right.\n\n487\n00:26:20.731 --> 00:26:21.779\nWell.\nThanks for\n\n488\n00:26:21.779 --> 00:26:24.096\njoining us Mike and\nthank you for watching.\n\n489\n00:26:24.096 --> 00:26:26.348\nWe're gonna go ahead and\nsign off for IT ProTV.\n\n490\n00:26:26.348 --> 00:26:27.451\nI've been your host Daniel Auric.\n\n491\n00:26:27.451 --> 00:26:28.356\n>> And I'm Mike Roderick.\n\n492\n00:26:28.356 --> 00:26:30.133\n>> We'll see you next time.\n\n493\n00:26:30.133 --> 00:26:38.070\n[MUSIC]\n\n",
          "vimeoId": "156015465"
        },
        {
          "description": "In this episode, Mike and Daniel create a Replica Domain Controller on their newly created virtual machine in Azure. They begin by connecting to the VM with Remote Desktop and adjust the Windows Firewall to allow ping traffic to test connectivity. Then they join the new VM to their existing AD domain, after which they install Active Directory and verify replication with the on-premesis site.",
          "length": "1352",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-3-create_a_replica_dc_in_azure-021716-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-3-create_a_replica_dc_in_azure-021716-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-4-3-create_a_replica_dc_in_azure-021716-1-sm.jpg",
          "title": "Create a Replica DC in Azure",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.165 --> 00:00:12.980\nAll right.\n\n3\n00:00:12.980 --> 00:00:16.821\nGreetings everyone, and welcome to\nanother great episode of ITProTV.\n\n4\n00:00:16.821 --> 00:00:18.710\nI'm your host Daniel Lowrie.\n\n5\n00:00:18.710 --> 00:00:23.700\nAnd in today's episode, well we're still\ncontinuing on with our AD in Azure series.\n\n6\n00:00:23.700 --> 00:00:27.470\nJoining us back in the studio again today\nto continue that little mission we're on\n\n7\n00:00:27.470 --> 00:00:28.990\nis none other than Mr. Mike Rodrick.\n\n8\n00:00:28.990 --> 00:00:30.590\nMike, welcome back to the show, sir.\n\n9\n00:00:30.590 --> 00:00:31.170\n>> Thank you very much.\n\n10\n00:00:31.170 --> 00:00:34.070\nThat's right, we left off in\nthat previous episode building\n\n11\n00:00:34.070 --> 00:00:37.350\nup our first virtual machine on\nour brand new virtual network\n\n12\n00:00:37.350 --> 00:00:41.060\nthat we created up there in\nAzure using that new portal.\n\n13\n00:00:41.060 --> 00:00:44.950\nThat brand new interface that we've got\nto work with all of our Azure resources.\n\n14\n00:00:44.950 --> 00:00:46.410\nSo let's take a look at my screen.\n\n15\n00:00:46.410 --> 00:00:48.980\nWe'll get right back into it and\nsee what happened.\n\n16\n00:00:48.980 --> 00:00:54.070\nAnd, as we can see here, it finished and\nI get my little status screen for that VM.\n\n17\n00:00:54.070 --> 00:00:57.470\nSo I can see there's my computer name,\nthere's the size we picked,\n\n18\n00:00:57.470 --> 00:00:58.750\nit's running Windows.\n\n19\n00:00:58.750 --> 00:01:02.620\nRemember I went ahead and left a public IP\naddress assigned to it because I'm gonna\n\n20\n00:01:02.620 --> 00:01:07.500\nbe remoting into it from this machine,\nwhich is not on the same network, it's not\n\n21\n00:01:07.500 --> 00:01:10.570\non the corporate network so I can't go\nthrough the tunnel and all of that.\n\n22\n00:01:10.570 --> 00:01:13.420\nSo that's why I wanted to leave\nthat public IP address for now.\n\n23\n00:01:13.420 --> 00:01:14.790\nIt shows me that it's on subnet01.\n\n24\n00:01:14.790 --> 00:01:19.130\nGot some monitoring down\nhere that we can do,\n\n25\n00:01:19.130 --> 00:01:23.390\nI can see my CPU percentage for example.\n\n26\n00:01:23.390 --> 00:01:24.090\nBring that back down.\n\n27\n00:01:24.090 --> 00:01:28.820\nAnd then over here to the settings\npane I can look at properties, discs,\n\n28\n00:01:28.820 --> 00:01:32.880\nnetwork interfaces and let's take\na look at that network interface and\n\n29\n00:01:32.880 --> 00:01:37.920\nI see that I did indeed put me on\nthe 10.2.1.0-24 network which is\n\n30\n00:01:39.390 --> 00:01:41.840\nthat subnet that I created.\n\n31\n00:01:41.840 --> 00:01:44.780\nRemember if this is ever wrong it probably\n\n32\n00:01:44.780 --> 00:01:48.560\nmeans you didn't pick the right subnet\nwhen you were rolling the machine out and\n\n33\n00:01:48.560 --> 00:01:52.140\nyou're gonna most likely\nneed to redo that machine.\n\n34\n00:01:52.140 --> 00:01:55.620\nAnd dot four is going to be\nthe first IP address assigned.\n\n35\n00:01:55.620 --> 00:02:01.530\nDot one, dot two, dot three end up getting\nreserved for something that the something\n\n36\n00:02:01.530 --> 00:02:03.685\nMicrosoft's doing in the background,\nthey don't tell us what it is but\n\n37\n00:02:03.685 --> 00:02:08.730\ndot four is always going to be the first\nIP address on that sub net range.\n\n38\n00:02:08.730 --> 00:02:11.380\nAlthough, I guess,\ndepending on what your sub net is,\n\n39\n00:02:11.380 --> 00:02:16.540\nit'll be the fourth available address\nis maybe a better way to say that.\n\n40\n00:02:16.540 --> 00:02:17.690\nAll right, so that looks good.\n\n41\n00:02:17.690 --> 00:02:22.885\nThe next thing I want to do is\nactually connect into that guy.\n\n42\n00:02:22.885 --> 00:02:24.790\nToo many fingers on the swipe, there.\n\n43\n00:02:24.790 --> 00:02:25.850\nSo, I'm go ahead and click connect.\n\n44\n00:02:25.850 --> 00:02:31.220\nAnd that's gonna allow me to remote\ninto that machine using a little RDP.\n\n45\n00:02:31.220 --> 00:02:36.820\nAnd I'll use the credentials that\nI assigned when I first created\n\n46\n00:02:36.820 --> 00:02:37.500\nthis machine.\n\n47\n00:02:37.500 --> 00:02:40.049\nIf I remember what I used.\n\n48\n00:02:42.860 --> 00:02:45.920\nAnd there we go, I'm remoted in and\nnotice it's going over the public address,\n\n49\n00:02:45.920 --> 00:02:49.570\nit's not going through the tunnel\nagain because I'm sitting at\n\n50\n00:02:49.570 --> 00:02:52.970\na laptop that's not part of that domain,\nor that corporate network.\n\n51\n00:02:54.770 --> 00:02:56.730\nAnd what it really, what I want to\ndo is I want to come in here and\n\n52\n00:02:56.730 --> 00:03:00.030\nadjust the firewall so\nthat we can go back and test our tunnel.\n\n53\n00:03:02.080 --> 00:03:03.150\nSo give that one second.\n\n54\n00:03:03.150 --> 00:03:07.290\nA lovely RDP screen there,\n\n55\n00:03:07.290 --> 00:03:10.360\nsometimes if I minimize that and\nbring it back up it wakes it up.\n\n56\n00:03:10.360 --> 00:03:10.970\nThere we go.\n\n57\n00:03:10.970 --> 00:03:13.332\n>> Or as Don likes to say black\ntext on a black background.\n\n58\n00:03:13.332 --> 00:03:14.153\n>> [LAUGH] Yeah.\n\n59\n00:03:14.153 --> 00:03:16.867\nWe'll go ahead and\nsay yes to that for now.\n\n60\n00:03:19.892 --> 00:03:22.775\nAll right, and we're gonna wait for\nserver manager to open up\n\n61\n00:03:22.775 --> 00:03:26.840\ncuz I'm gonna open up that Windows\nfirewall with advanced security, so\n\n62\n00:03:26.840 --> 00:03:29.600\nwe'll give it a second to\npopulate some of this info.\n\n63\n00:03:29.600 --> 00:03:32.590\nIt seems to get a little finicky if\nyou try to click on anything too soon,\n\n64\n00:03:33.980 --> 00:03:35.330\nwhich I can't resist doing.\n\n65\n00:03:35.330 --> 00:03:38.140\nI know that it's going to get\nmad if I click on something.\n\n66\n00:03:38.140 --> 00:03:38.700\nI click anyway.\n\n67\n00:03:40.030 --> 00:03:40.680\nAll right.\nThere we go.\n\n68\n00:03:40.680 --> 00:03:43.560\nWindows firewall with advanced security,\nas soon as it'll let me, there we go.\n\n69\n00:03:43.560 --> 00:03:48.170\nAnd then, you wait for\n\n70\n00:03:48.170 --> 00:03:51.872\nthat server to say okay, now I'm\nready to do what you want me to do.\n\n71\n00:03:51.872 --> 00:03:55.250\nI'm gonna go into my inbound rules,\nwe're gonna go down to my file and\n\n72\n00:03:55.250 --> 00:03:59.140\nprinter sharing, and I'm just gonna\ndo my Echo request V4 and V6.\n\n73\n00:03:59.140 --> 00:04:02.850\nAnd then I'll go ahead and\nenable those two rules.\n\n74\n00:04:02.850 --> 00:04:05.580\nAnd then I can close my firewall.\n\n75\n00:04:05.580 --> 00:04:09.620\nAnd I can actually log off, or\ndisconnect from my session here.\n\n76\n00:04:09.620 --> 00:04:11.080\nAll right.\n\n77\n00:04:11.080 --> 00:04:13.646\nSo I'll go ahead and sign out.\n\n78\n00:04:13.646 --> 00:04:18.344\nAnd we're good to go there, so now what\nI wanna do is I wanna go to one of\n\n79\n00:04:18.344 --> 00:04:21.990\nmy VMs and in particular,\nmy, the main controller.\n\n80\n00:04:23.120 --> 00:04:25.517\nSo, I'll log onto this guy.\n\n81\n00:04:28.965 --> 00:04:32.925\nWe bring that back out full screen so\nI can click on the right start bar.\n\n82\n00:04:32.925 --> 00:04:34.405\nThere we go.\nSo I'm logged into GMBDC1.\n\n83\n00:04:34.405 --> 00:04:37.445\nIf you remember this is on\nmy on-premises network.\n\n84\n00:04:37.445 --> 00:04:39.325\nMy on-premises domain controller.\n\n85\n00:04:39.325 --> 00:04:46.030\nHe's got a 10.1.1.10 IP address, I'll\njust verify that for everybody out there.\n\n86\n00:04:46.030 --> 00:04:46.930\nSo we go to local server.\n\n87\n00:04:48.890 --> 00:04:50.380\nWait for it.\n\n88\n00:04:50.380 --> 00:04:50.920\nAnd there we go.\n\n89\n00:04:52.080 --> 00:04:53.450\nSo now I'm gonna open up PowerShell.\n\n90\n00:04:54.910 --> 00:04:59.114\nAnd I'm gonna ping 10.2.1.4.\n\n91\n00:05:00.620 --> 00:05:04.490\nAnd there's my replies, so\nmy traffic is successfully\n\n92\n00:05:04.490 --> 00:05:08.540\nhitting the internal facing IP or\nnetwork adaptor of my router.\n\n93\n00:05:08.540 --> 00:05:12.740\nIt's networking it across, it's sending it\nthrough the tunnel, it's now connecting or\n\n94\n00:05:12.740 --> 00:05:18.160\nhitting that 10.2.1.0 network up there,\nconnecting to or hitting that machine.\n\n95\n00:05:18.160 --> 00:05:21.800\nThat machine is replying and the packets\nare making it all the way back right?\n\n96\n00:05:21.800 --> 00:05:24.860\nSo we've successfully set\nup our site-to-site tunnel\n\n97\n00:05:24.860 --> 00:05:26.380\nas well as the routing.\n\n98\n00:05:26.380 --> 00:05:29.480\nRemember, when you do it this way,\na couple things I want to point out.\n\n99\n00:05:29.480 --> 00:05:34.450\nWe didn't have that handy script to\nconfigure the VPN server on-premises.\n\n100\n00:05:34.450 --> 00:05:37.930\nSo we needed to manually create\nthat demand dial interface, and\n\n101\n00:05:37.930 --> 00:05:39.768\nI needed to create a route.\n\n102\n00:05:39.768 --> 00:05:44.510\nOtherwise these 10.1 packets would\nhave no way of figuring out how to get\n\n103\n00:05:44.510 --> 00:05:45.240\nto the cloud, right?\n\n104\n00:05:45.240 --> 00:05:48.660\nEven though the tunnel was there,\nthere was no route for that tunnel.\n\n105\n00:05:48.660 --> 00:05:50.130\nOr for that network range.\n\n106\n00:05:50.130 --> 00:05:54.000\nSo we had to make sure we\nmanually added that route.\n\n107\n00:05:54.000 --> 00:05:54.500\n>> All right, Mike.\n\n108\n00:05:54.500 --> 00:05:58.370\nNow that we've got some connectivity\nverified, looks like things are working.\n\n109\n00:05:58.370 --> 00:05:59.430\nWhat's our next step?\n\n110\n00:05:59.430 --> 00:06:02.620\n>> Now we're gonna make it a domain\ncontroller and really, like I said,\n\n111\n00:06:02.620 --> 00:06:03.780\nwe've seen this before.\n\n112\n00:06:03.780 --> 00:06:05.770\nWe saw it in the classic portal.\n\n113\n00:06:05.770 --> 00:06:07.050\nThe steps are gonna be the same.\n\n114\n00:06:07.050 --> 00:06:09.770\nJust where you do it is going\nto be a little bit different.\n\n115\n00:06:09.770 --> 00:06:13.630\nThe big thing to remember about putting\na domain controller out there in Azure\n\n116\n00:06:13.630 --> 00:06:18.180\nis that you have to add a second\ndrive to store the NTDS.dit.\n\n117\n00:06:18.180 --> 00:06:22.670\nThe active directory database and\nSYSVOL and those log files.\n\n118\n00:06:22.670 --> 00:06:28.150\nYou cannot put them on that drive that\ncomes with the VM when you create it,\n\n119\n00:06:28.150 --> 00:06:29.850\nbecause it does some right caching,\n\n120\n00:06:29.850 --> 00:06:32.550\nand we can't have that with\nthe active directory database.\n\n121\n00:06:32.550 --> 00:06:36.650\nSo, what I'm gonna do is, and\nlet's pretend all of this was closed, and\n\n122\n00:06:36.650 --> 00:06:37.980\ngo back out to my dashboard here.\n\n123\n00:06:39.330 --> 00:06:39.960\nAll right.\n\n124\n00:06:39.960 --> 00:06:44.639\nSo what I need to do is pull up that VM,\nso there's my Azure dc01.\n\n125\n00:06:48.329 --> 00:06:52.320\nAnd then in my settings,\nI'm gonna take a look at disks.\n\n126\n00:06:54.300 --> 00:06:55.900\nI have one currently.\n\n127\n00:06:55.900 --> 00:06:58.520\nWe can't use that one, so\nI'm gonna attach a new disk.\n\n128\n00:07:00.070 --> 00:07:02.460\nAnd I'm gonna just use that\ndefault name that it creates.\n\n129\n00:07:02.460 --> 00:07:06.130\nIt's gonna be a standard I\ndon't need a terabyte of space.\n\n130\n00:07:06.130 --> 00:07:08.120\nTen gigabytes will be just fine.\n\n131\n00:07:08.120 --> 00:07:11.925\nSomething you gotta think about how big is\nyour active directory database going to\n\n132\n00:07:11.925 --> 00:07:14.750\nget and your sys file and your log files.\n\n133\n00:07:14.750 --> 00:07:19.140\nLocation, there's that storage that we\ncreated and it stores it as a blob.\n\n134\n00:07:19.140 --> 00:07:20.830\nRemember a binary large object.\n\n135\n00:07:20.830 --> 00:07:24.150\nThat's what it,\nhow it stores the virtual hard drives.\n\n136\n00:07:24.150 --> 00:07:26.990\nHost caching,\nmake sure you leave that on, none.\n\n137\n00:07:26.990 --> 00:07:29.448\nAnd then go ahead and click, okay.\n\n138\n00:07:29.448 --> 00:07:34.232\nAll right,\n\n139\n00:07:34.232 --> 00:07:37.080\nnow one thing I did not do,\n\n140\n00:07:37.080 --> 00:07:42.360\nDaniel was actually enable remote\nadministration, in there on that VM.\n\n141\n00:07:42.360 --> 00:07:45.650\nSo, I don't think I'll be able to\nremote in from, my domain controller.\n\n142\n00:07:45.650 --> 00:07:47.100\nSo I'm gonna do it from\nthis machine right here,\n\n143\n00:07:47.100 --> 00:07:50.590\nwhich is, oops, which is just as easy.\n\n144\n00:07:50.590 --> 00:07:54.313\nSo I'll go ahead and\nestablish that remote connection again,\n\n145\n00:07:54.313 --> 00:07:56.148\nback there to my DC up at Azure.\n\n146\n00:08:00.749 --> 00:08:02.724\nLooks like I got the right password.\n\n147\n00:08:04.978 --> 00:08:05.699\nAll right.\n\n148\n00:08:05.699 --> 00:08:09.372\nSo this guy, I'm gonna wait for\nserver manager to populate and\n\n149\n00:08:09.372 --> 00:08:11.314\nfill out all that information and\n\n150\n00:08:11.314 --> 00:08:15.770\nthen we just have to make sure that disk\ngot attached and we have to format it.\n\n151\n00:08:15.770 --> 00:08:17.310\nWe have to partition it and format it.\n\n152\n00:08:17.310 --> 00:08:18.130\n>> Make it useful.\n\n153\n00:08:18.130 --> 00:08:19.180\n>> Make it useful.\n\n154\n00:08:19.180 --> 00:08:20.290\nExactly.\n\n155\n00:08:20.290 --> 00:08:23.051\nSo I'll go to file and\nstorage services and\n\n156\n00:08:23.051 --> 00:08:28.552\nthen disks And then wait for\n\n157\n00:08:28.552 --> 00:08:33.241\nit, and there's that new ten gigabyte\ndrive, we're gonna initialize it and\n\n158\n00:08:33.241 --> 00:08:37.644\nsay, yes, it'll wipe all the data,\ninitialize it as a GPT based disc and\n\n159\n00:08:37.644 --> 00:08:42.980\nthen we're just gonna create a volume\nthat takes up the entire ten gigabytes.\n\n160\n00:08:42.980 --> 00:08:47.520\nSo, let's just next all the way\nthrough this wizard, except for\n\n161\n00:08:47.520 --> 00:08:50.386\nthat silly volume label,\ncuz you know how I am with labels.\n\n162\n00:08:50.386 --> 00:08:53.126\nNext, and create.\n\n163\n00:08:57.788 --> 00:08:58.690\nSo let that run.\n\n164\n00:09:00.270 --> 00:09:02.970\nAnd then we're going to\njoin it to the domain,\n\n165\n00:09:02.970 --> 00:09:07.270\nbut to join it to the domain,\nwe need to verify a couple of things.\n\n166\n00:09:07.270 --> 00:09:10.290\nPrimarily my DNS settings.\n\n167\n00:09:10.290 --> 00:09:13.300\nI have to be able to find\nan existing domain controller\n\n168\n00:09:13.300 --> 00:09:15.520\nin order to join the domain.\n\n169\n00:09:15.520 --> 00:09:18.550\nSo I may bump this font\nup just a wee bit for us.\n\n170\n00:09:20.610 --> 00:09:25.360\nChange the layout so it stays on my screen\nand doesn't wrap around the edge there.\n\n171\n00:09:28.720 --> 00:09:31.746\nAnd we'll do a little ipconfig all, and\n\n172\n00:09:31.746 --> 00:09:36.378\nthere we can see my address 10.2.1.1 for\nmy gateway.\n\n173\n00:09:36.378 --> 00:09:41.628\nMy address is 10.2.1.4,\nand my DNS 10.1.1.10.\n\n174\n00:09:41.628 --> 00:09:43.370\nNow, how did it get that?\n\n175\n00:09:43.370 --> 00:09:47.470\nRemember, we went to our Azure portal when\nwe were creating that virtual network and\n\n176\n00:09:47.470 --> 00:09:49.850\nwe created a reference to a DNS server.\n\n177\n00:09:49.850 --> 00:09:53.930\nIn the classic portal it\nwas register a DNS server.\n\n178\n00:09:53.930 --> 00:09:57.530\nIn the new portal it'd just say,\nyou know, add a DNS server.\n\n179\n00:09:57.530 --> 00:10:01.848\nWe added the IP address of my\non premises DNS server, and so\n\n180\n00:10:01.848 --> 00:10:07.948\nnow any VM I spin up and attached to that\nsubnet it's gonna get those DNS settings.\n\n181\n00:10:07.948 --> 00:10:09.108\nSo we should be good to go.\n\n182\n00:10:09.108 --> 00:10:14.030\nI should be able to ping from this side,\n10.1.1.10.\n\n183\n00:10:14.030 --> 00:10:16.878\nBeautiful, everything's working there.\n\n184\n00:10:16.878 --> 00:10:22.200\nI should really also be able\nto ping it by name which\n\n185\n00:10:22.200 --> 00:10:27.538\nis going to be gnv- dc01.itprotvdemo.com.\n\n186\n00:10:27.538 --> 00:10:30.278\nAnd beautiful,\nit resolves to the right IP address.\n\n187\n00:10:30.278 --> 00:10:31.518\nSo we are good to go.\n\n188\n00:10:31.518 --> 00:10:38.120\nAt that point, I should be able to go to\nlocal server, and choose my workgroup.\n\n189\n00:10:38.120 --> 00:10:43.260\nOpen up my System Properties,\nclick Change, choose Domain.\n\n190\n00:10:43.260 --> 00:10:46.960\nAnd ITProTVdemo.com.\n\n191\n00:10:46.960 --> 00:10:50.116\n>> Smart to check that DNS before we\njumped in to trying to join the domain,\n\n192\n00:10:50.116 --> 00:10:53.376\nbecause [LAUGH] if you don't have DNS\nworking you're going to have a little\n\n193\n00:10:53.376 --> 00:10:57.028\ntrouble establishing that connection,\nand you're not going to be able to join.\n\n194\n00:10:57.028 --> 00:10:58.126\nWe had this problem actually before.\n\n195\n00:10:58.126 --> 00:10:58.806\n>> Yes.\n\n196\n00:10:58.806 --> 00:11:01.166\n[LAUGH]\n>> And it's a super easy step to just,\n\n197\n00:11:01.166 --> 00:11:04.814\na little glance over, and Mike,\nhe learned from his mistakes, and\n\n198\n00:11:04.814 --> 00:11:06.548\nhe didn't forget it this time.\n\n199\n00:11:06.548 --> 00:11:08.666\n>> That's right.\n\n200\n00:11:08.666 --> 00:11:10.786\nIf you don't learn from your mistakes.\n\n201\n00:11:10.786 --> 00:11:11.446\n>> What good are they?\n\n202\n00:11:11.446 --> 00:11:12.926\n[LAUGH]\n>> Exactly.\n\n203\n00:11:12.926 --> 00:11:13.530\nAll right, there we go.\n\n204\n00:11:13.530 --> 00:11:16.810\nWelcome to the ITProTVdemo.com domain,\n\n205\n00:11:16.810 --> 00:11:20.390\nyou must restart your computer for\nthese changes to apply.\n\n206\n00:11:20.390 --> 00:11:23.540\nSo we'll go ahead and\nrestart that computer.\n\n207\n00:11:23.540 --> 00:11:27.550\nAnd when it comes back up, it should now\nbe part of the domain, and ready for\n\n208\n00:11:27.550 --> 00:11:30.096\nus to install Active Directory.\n\n209\n00:11:30.096 --> 00:11:35.120\nBut at this point, we really,\nwe've done what we've set out to do,\n\n210\n00:11:35.120 --> 00:11:37.510\nother than actually creating\na new domain controller.\n\n211\n00:11:37.510 --> 00:11:41.590\nBut everything here now is gonna work the\nsame as it did when we used the classic\n\n212\n00:11:41.590 --> 00:11:42.450\nform, right.\n\n213\n00:11:42.450 --> 00:11:46.330\nAs far as Active Directory goes,\nas far as Windows Operating System,\n\n214\n00:11:46.330 --> 00:11:48.980\nall of that doesn't change.\n\n215\n00:11:48.980 --> 00:11:52.400\nIt's just how we go about creating\nthose resources in the first place.\n\n216\n00:11:52.400 --> 00:11:54.960\nFiguring out where to do\nit in the classic portal or\n\n217\n00:11:54.960 --> 00:11:56.910\nwhere to do it in this new portal.\n\n218\n00:11:58.130 --> 00:12:02.250\nSo let's see,\nit's probably already rebooted.\n\n219\n00:12:02.250 --> 00:12:03.980\nSo I'll see if I can connect to it.\n\n220\n00:12:03.980 --> 00:12:07.010\nWe could do a persistent ping and\nwait for it to come back up.\n\n221\n00:12:07.010 --> 00:12:09.290\nBut these guys reboot so fast.\n\n222\n00:12:09.290 --> 00:12:10.180\n>> They are like lightning.\n\n223\n00:12:10.180 --> 00:12:12.270\n>> Yeah,\nnow here you wanna be careful too, right.\n\n224\n00:12:12.270 --> 00:12:15.230\nI want, I'm now part of the domain.\n\n225\n00:12:15.230 --> 00:12:19.340\nAnd this is the account that I\nuse when I created the VM itself.\n\n226\n00:12:19.340 --> 00:12:21.690\nBasically the local admin account.\n\n227\n00:12:21.690 --> 00:12:25.588\nI wanna log in with a domain account so I\nhave permission to join it to the domain.\n\n228\n00:12:25.588 --> 00:12:31.623\nSo I'm gonna choose a different user,\nITProTVdemo/administrator, and\n\n229\n00:12:31.623 --> 00:12:37.090\nthat's a gotcha just, doesn't have\nanything to do with the cloud,\n\n230\n00:12:37.090 --> 00:12:40.596\nbut I see that happen\nto people all the time.\n\n231\n00:12:40.596 --> 00:12:44.570\nNot paying attention to what accounts\nyou're logging on with after you join\n\n232\n00:12:44.570 --> 00:12:46.750\na domain, easy mistake to make.\n\n233\n00:12:46.750 --> 00:12:51.178\nEnd up logging in with that local account,\nand you have no domain rights.\n\n234\n00:12:51.178 --> 00:12:53.038\nBut it looks like I'm\ngoing to be successful.\n\n235\n00:12:53.038 --> 00:12:55.598\nI'm just waiting for\nit to build up my profile,\n\n236\n00:12:55.598 --> 00:12:58.038\nsince this is the first\ntime I've logged on.\n\n237\n00:13:01.348 --> 00:13:07.170\nAnd we get that black on black again,\nso we'll minimize and restore that guy.\n\n238\n00:13:07.170 --> 00:13:11.090\nAnd sometimes it works,\nsometimes it doesn't.\n\n239\n00:13:13.240 --> 00:13:13.740\nThere we go.\n\n240\n00:13:16.560 --> 00:13:21.630\nAll right, once that gets up we\nare going to give it one minute to\n\n241\n00:13:21.630 --> 00:13:23.060\nrefresh its information here.\n\n242\n00:13:25.020 --> 00:13:26.340\nI get impatient, there we go.\n\n243\n00:13:26.340 --> 00:13:30.430\nWe'll do a little add roles and features\nand you guys have seen this a few times,\n\n244\n00:13:30.430 --> 00:13:32.750\nso I'm not gonna spend too much time here.\n\n245\n00:13:32.750 --> 00:13:36.310\nBasically gonna choose\nActive Directory Domain Services,\n\n246\n00:13:36.310 --> 00:13:43.701\nwe're gonna add the feature, we'll click,\nNext, Next, Next, and Install.\n\n247\n00:13:45.160 --> 00:13:48.230\nKey to think about here is this\ndoesn't create a domain controller,\n\n248\n00:13:48.230 --> 00:13:52.220\nit just gives all the pieces, parts\nnecessary to create a domain controller.\n\n249\n00:13:52.220 --> 00:13:56.820\nWe still have to go through what us\nold-school people would call DC promo, but\n\n250\n00:13:56.820 --> 00:14:00.540\nwhat is now called the active\ndirectory configuration wizard\n\n251\n00:14:00.540 --> 00:14:04.210\nto turn it into a domain controller.\n\n252\n00:14:04.210 --> 00:14:09.250\nSo this'll unpack all the parts necessary\nto make that domain controller should take\n\n253\n00:14:09.250 --> 00:14:15.300\njust a minute here, 49, what do you say\nthe odds are it's gonna stop on 64?\n\n254\n00:14:15.300 --> 00:14:16.708\n>> I'm not taking that bet.\n\n255\n00:14:16.708 --> 00:14:18.028\n>> You're not taking that bet.\n\n256\n00:14:18.028 --> 00:14:20.548\n>> Yeah I've learned too well\nthat Mike says, it stops at 64.\n\n257\n00:14:20.548 --> 00:14:21.608\n>> 64!\n\n258\n00:14:21.608 --> 00:14:22.468\nLook at that!\n\n259\n00:14:22.468 --> 00:14:23.328\n>> Stops at 64.\n\n260\n00:14:23.328 --> 00:14:24.828\nLook at me.\n\n261\n00:14:24.828 --> 00:14:25.668\n>> Smart man!\n\n262\n00:14:25.668 --> 00:14:28.268\n>> You should have been betting on whether\nor not I was going to take Mike's bet.\n\n263\n00:14:28.268 --> 00:14:28.809\nRight?\n\n264\n00:14:28.809 --> 00:14:30.148\n>> That would've.\n>> That would've been a good bet.\n\n265\n00:14:30.148 --> 00:14:34.438\n>> [LAUGH] All right, so\nwe'll let this finish up and\n\n266\n00:14:34.438 --> 00:14:38.050\nas soon as it does we'll promote it.\n\n267\n00:14:38.050 --> 00:14:39.768\nSo what do you think Daniel?\n\n268\n00:14:39.768 --> 00:14:43.880\nNew interface, classic portal, anything-\n>> Yeah.\n\n269\n00:14:43.880 --> 00:14:44.660\n>> Any opinions yet?\n\n270\n00:14:44.660 --> 00:14:49.585\n>> Yeah, it's really tough because there\nare things that the classic portal does\n\n271\n00:14:49.585 --> 00:14:53.150\nreally well and then there's things that\nthe classic portal doesn't do really well.\n\n272\n00:14:53.150 --> 00:14:54.780\nRight?\nThen there's things that\n\n273\n00:14:54.780 --> 00:14:55.328\nthe-\n>> [LAUGH]\n\n274\n00:14:55.328 --> 00:14:56.808\n>> New portal does really well.\n\n275\n00:14:56.808 --> 00:15:01.010\nIt's really like having half a dozen\nof one, six of the other at this point.\n\n276\n00:15:01.010 --> 00:15:05.940\nI think that Microsoft has released\nthe new portal as the portal.\n\n277\n00:15:05.940 --> 00:15:08.460\nThat's the portal you get\nwhen you log into Azure and\n\n278\n00:15:08.460 --> 00:15:12.340\nyou have to say I want the classic\nportal if you're new to it, right?\n\n279\n00:15:13.480 --> 00:15:16.440\nI don't think that the new portal\nis quite prime time ready.\n\n280\n00:15:16.440 --> 00:15:18.000\n>> Right.\n>> I think once it is,\n\n281\n00:15:18.000 --> 00:15:19.890\nI think when every\nfeature is turned on and\n\n282\n00:15:19.890 --> 00:15:23.110\nworks as they expect it to,\nit blows the classic portal away.\n\n283\n00:15:23.110 --> 00:15:25.840\n>> Yeah it's still like\nan after hours tv show.\n\n284\n00:15:25.840 --> 00:15:27.620\n>> Yeah.\n>> It's late night tv.\n\n285\n00:15:27.620 --> 00:15:30.010\n>> [LAUGH]\n>> [LAUGH] It's not quite prime time.\n\n286\n00:15:30.010 --> 00:15:30.720\nI like it.\n\n287\n00:15:32.070 --> 00:15:36.288\nAll right so hopefully this will\nfinish up in just a moment.\n\n288\n00:15:36.288 --> 00:15:40.444\nBut like I said, we've seen this and\neverything should work at this point.\n\n289\n00:15:40.444 --> 00:15:43.610\nI know that I can talk to the on\npremises domain controller.\n\n290\n00:15:43.610 --> 00:15:46.130\nBecause I was able to ping it,\nI was able to ping it by name and\n\n291\n00:15:46.130 --> 00:15:47.990\nheck, I was able to join the domain.\n\n292\n00:15:47.990 --> 00:15:49.838\nSo what more proof do you want, right,\n\n293\n00:15:49.838 --> 00:15:51.913\nthat we can talk to\nthat domain controller.\n\n294\n00:15:51.913 --> 00:15:56.584\nSo really installing active directory is\njust a formality at this point, right.\n\n295\n00:15:56.584 --> 00:15:58.796\nI need to get active\ndirectory installed on there.\n\n296\n00:15:58.796 --> 00:16:02.330\nOnce we do that, the ISTG and\nthe knowledge consistency checker and\n\n297\n00:16:02.330 --> 00:16:05.182\nthe intersite topology\ngenerator will do their job and\n\n298\n00:16:05.182 --> 00:16:07.320\ncreate those replication links.\n\n299\n00:16:07.320 --> 00:16:10.990\nActive Directory will start replicating\nand I've got another domain controller.\n\n300\n00:16:10.990 --> 00:16:13.620\nSo that if my on premises\ndomain controllers fail,\n\n301\n00:16:13.620 --> 00:16:15.910\nwe have a disaster of some kind.\n\n302\n00:16:15.910 --> 00:16:20.350\nGetting back up and running is just\na matter of putting new servers in place,\n\n303\n00:16:20.350 --> 00:16:22.960\ninstalling Active Directory,\nestablishing that tunnel, and\n\n304\n00:16:22.960 --> 00:16:25.600\nletting replication bring\nthem back up to speed, right?\n\n305\n00:16:25.600 --> 00:16:26.110\n>> Right.\n\n306\n00:16:26.110 --> 00:16:27.730\n>> Basically the opposite\nof what we're doing here,\n\n307\n00:16:27.730 --> 00:16:32.650\nbecause we have the on premises,\nand we're setting it up in Azure.\n\n308\n00:16:32.650 --> 00:16:36.840\nWell, if our on premises disappears,\nwe've got Azure, we just need to work\n\n309\n00:16:36.840 --> 00:16:40.190\nbackwards now and create that\ntunnel back to our local network.\n\n310\n00:16:40.190 --> 00:16:43.320\nAnd set up our on premises domain\ncontrollers again as replicas.\n\n311\n00:16:43.320 --> 00:16:45.050\n>> So Mike, at this point in time,\n\n312\n00:16:45.050 --> 00:16:49.950\nwhat we're saying is if something goes\nwrong, it's probably a Windows issue.\n\n313\n00:16:49.950 --> 00:16:55.370\nIt's something in the server software\nitself, probably not necessarily a network\n\n314\n00:16:55.370 --> 00:16:59.350\nor Azure issue, because they're talking,\nthey're working, everything there is set\n\n315\n00:16:59.350 --> 00:17:02.950\nup fine, you see the connections\non both ends data is being passed.\n\n316\n00:17:02.950 --> 00:17:06.270\nNow if replication's not\noccurring of course your gonna\n\n317\n00:17:06.270 --> 00:17:08.420\ncheck to make sure your VPN\nis working at that point.\n\n318\n00:17:08.420 --> 00:17:12.372\nBut if it is, you know it's not Azure\nthat;s causing the problem, it's something\n\n319\n00:17:12.372 --> 00:17:15.839\nwithin the replication itself,\nthe server software is having an issue.\n\n320\n00:17:15.839 --> 00:17:17.139\n>> it could be a misconfigured firewall.\n\n321\n00:17:17.139 --> 00:17:17.743\n>> Right.\n\n322\n00:17:17.743 --> 00:17:21.342\n>> Or blocking a particular protocol.\n\n323\n00:17:21.342 --> 00:17:23.750\nAll right so we're going to promote\nthe server to domain controller.\n\n324\n00:17:23.750 --> 00:17:27.440\nI just click the link right there in\nthe middle of the first wizard to bring up\n\n325\n00:17:27.440 --> 00:17:31.090\nthe second wizard, adding a domain\ncontroller to an existing domain,\n\n326\n00:17:31.090 --> 00:17:35.540\nitprotvdemo, using my currently logged\non credentials as the domain admin.\n\n327\n00:17:35.540 --> 00:17:36.748\nAnd then I click Next.\n\n328\n00:17:39.825 --> 00:17:43.310\nAnd we wait for that DNS delegation here.\n\n329\n00:17:43.310 --> 00:17:45.800\nSo we are gonna install DNS and\nglobal catalog,\n\n330\n00:17:45.800 --> 00:17:50.840\nI'll set my DSRM password in case\nActive Directory craps out on us.\n\n331\n00:17:50.840 --> 00:17:52.240\nWe need to get into this machine.\n\n332\n00:17:53.980 --> 00:17:55.190\nAnd my site.\n\n333\n00:17:55.190 --> 00:17:58.650\nI'm gonna choose that AZ site,\nright, my Azure site.\n\n334\n00:17:58.650 --> 00:18:00.220\nAnd we'll click next.\n\n335\n00:18:02.983 --> 00:18:06.610\nNext, we're not worried about\nthe DNS delegation for right now.\n\n336\n00:18:06.610 --> 00:18:09.910\nAs far as replicating, well,\nthere's really only one to choose from, so\n\n337\n00:18:09.910 --> 00:18:12.070\nI don't care about that at this point.\n\n338\n00:18:12.070 --> 00:18:14.860\nThis is where I've gotta\nmake that change right?\n\n339\n00:18:14.860 --> 00:18:19.980\nI can not install that Active Directory\ndata base on the C drive of this Azure VM.\n\n340\n00:18:19.980 --> 00:18:23.750\nSo we created an F drive for this purpose.\n\n341\n00:18:23.750 --> 00:18:30.420\nSo I'll change all these to F: or\nwhatever you had labeled it as.\n\n342\n00:18:30.420 --> 00:18:31.239\nWe'll click Next.\n\n343\n00:18:32.880 --> 00:18:37.310\nAnd next, it'll check my prereqs,\n\n344\n00:18:37.310 --> 00:18:41.090\nmake sure I get a nice\ngreen checkmark up here.\n\n345\n00:18:41.090 --> 00:18:43.570\nThere we go, we got our green checkmark,\nwe passed everything,\n\n346\n00:18:43.570 --> 00:18:46.560\nwe got a couple warnings,\nyour standard warnings that we always get.\n\n347\n00:18:46.560 --> 00:18:50.680\n2012 R2 has some settings that are not\ncompatible with older operating systems,\n\n348\n00:18:50.680 --> 00:18:55.500\nDNS delegation can't be found or created,\nand that's because I really haven't\n\n349\n00:18:55.500 --> 00:18:59.310\ngone to the trouble of hosting any of\nthese DNS zones out in the public.\n\n350\n00:18:59.310 --> 00:19:01.170\nThis is just a demo lab.\n\n351\n00:19:01.170 --> 00:19:03.990\nThere is one about the static IP address.\n\n352\n00:19:03.990 --> 00:19:05.880\nRemember, you're not\ngonna get away from this.\n\n353\n00:19:05.880 --> 00:19:10.580\nWith Azure VMs, their IP addresses\nare gonna be assigned dynamically.\n\n354\n00:19:10.580 --> 00:19:13.620\nActive Directory wants you\nto have a static IP address.\n\n355\n00:19:13.620 --> 00:19:18.760\nWe know, that when you get a dynamic IP\naddress in Azure, that that IP address\n\n356\n00:19:18.760 --> 00:19:22.740\nis reserved, and it's going to stay\nwith that VM for the life of the VM,\n\n357\n00:19:22.740 --> 00:19:26.680\nas long as you don't remove that VM and\ntry to re-create it, right?\n\n358\n00:19:26.680 --> 00:19:31.040\nSo, even though windows,\nthe operating system detects it as\n\n359\n00:19:31.040 --> 00:19:34.660\na Dynamic IP addresses say,\nhey you shouldn't do this,\n\n360\n00:19:34.660 --> 00:19:37.560\nwe know it's okay because we know that\nIP address is not going to change.\n\n361\n00:19:37.560 --> 00:19:39.630\nAnd we'll just go ahead and click install.\n\n362\n00:19:39.630 --> 00:19:44.800\nAnd that is going to begin the process\nof configuring Active Directory.\n\n363\n00:19:44.800 --> 00:19:47.740\nSo why don't we take a little break.\n\n364\n00:19:47.740 --> 00:19:49.110\nWe'll just do a little\nTV time out here and\n\n365\n00:19:49.110 --> 00:19:53.270\nthrough the magic of TV we come back\nActive Directory will be installed.\n\n366\n00:19:53.270 --> 00:19:55.800\nAll right and through the magic of TV,\nmy machine has finished\n\n367\n00:19:55.800 --> 00:20:00.010\ninstalling Active Directory, it has\nrebooted and I have remoted back into it.\n\n368\n00:20:00.010 --> 00:20:01.470\nSo we take a look at my screen here.\n\n369\n00:20:01.470 --> 00:20:03.550\nI've got my Dashboard up.\n\n370\n00:20:03.550 --> 00:20:05.360\nLet me click on Local Server.\n\n371\n00:20:06.442 --> 00:20:11.050\nAnd I should see that it is now part\nof the domain which we did earlier.\n\n372\n00:20:11.050 --> 00:20:15.260\nIf I go to tools, I do have\nActive Directory users and computers.\n\n373\n00:20:17.110 --> 00:20:20.690\nAnd we'll launch that, and\nwait for just a second.\n\n374\n00:20:20.690 --> 00:20:24.190\nAnd there we go, I now have a copy\nof the Active Directory domain.\n\n375\n00:20:24.190 --> 00:20:27.500\nThere is my Azure DC01\nthat we just created.\n\n376\n00:20:27.500 --> 00:20:28.940\nThat is the main controller of the domain.\n\n377\n00:20:28.940 --> 00:20:32.250\nAnd so, again, not too terribly difficult.\n\n378\n00:20:32.250 --> 00:20:35.210\nI don't really want to,\nI shouldn't say that.\n\n379\n00:20:35.210 --> 00:20:39.110\nLet's say that, it's not like Active\nDirectory hasn't changed much, right?\n\n380\n00:20:39.110 --> 00:20:41.340\nThe big key there, like I said,\nI know I said it a couple times.\n\n381\n00:20:41.340 --> 00:20:45.030\nI want to make sure we remember\nyou have to add that second disk.\n\n382\n00:20:45.030 --> 00:20:48.160\nDon't try to install Active Directory\non the disk that comes with the VM.\n\n383\n00:20:48.160 --> 00:20:52.990\nAdd that second disk that does\nnot have any caching turned on.\n\n384\n00:20:52.990 --> 00:20:54.350\nAnd you should be good to go.\n\n385\n00:20:54.350 --> 00:20:55.560\nAnd at this point,\n\n386\n00:20:55.560 --> 00:21:00.570\nwe have extended Active Directory out in\nthe Cloud using the new portal this time.\n\n387\n00:21:00.570 --> 00:21:01.900\nSo a few differences, right.\n\n388\n00:21:01.900 --> 00:21:06.330\nThat the end result is the same, but\nhow we go about it is slightly different.\n\n389\n00:21:06.330 --> 00:21:09.550\nSo, you really just have to pay\nattention to those little newaunces.\n\n390\n00:21:09.550 --> 00:21:13.190\nUnfortunately, there's not as\nmuch help with that new portal.\n\n391\n00:21:13.190 --> 00:21:16.640\nYou would thing that new portal\nwould have more help, not so much.\n\n392\n00:21:16.640 --> 00:21:20.699\nA lot more information, I think is visible\nin that new portal I like that, but\n\n393\n00:21:20.699 --> 00:21:25.140\nno handy-dandy scripts or\nthings like that that we can just download\n\n394\n00:21:25.140 --> 00:21:28.940\nto configure our VPN server, so\ncouple of things I've gotta do.\n\n395\n00:21:28.940 --> 00:21:31.750\nLike I said towards the beginning\nI think of that previous episode,\n\n396\n00:21:31.750 --> 00:21:33.990\nthey really are pushing\nyou towards PowerShell and\n\n397\n00:21:33.990 --> 00:21:36.550\nwriting your own scripts\nif you wanna do that.\n\n398\n00:21:36.550 --> 00:21:37.310\nSo.\n\n399\n00:21:37.310 --> 00:21:38.090\nThere we go.\nWe've got our\n\n400\n00:21:38.090 --> 00:21:39.830\nnew domain controller in Azure.\n\n401\n00:21:39.830 --> 00:21:41.100\n>> Very, very cool stuff.\n\n402\n00:21:41.100 --> 00:21:44.305\nObviously it's different because\nyou're in the new portal, so\n\n403\n00:21:44.305 --> 00:21:48.384\nyou gotta figure your way around that, but\neven though it was a little more clumsy,\n\n404\n00:21:48.384 --> 00:21:51.764\nall the things were there and\nanything that wasn't very intuitive,\n\n405\n00:21:51.764 --> 00:21:54.442\nMike, you did a very good job\nof explaining that to us so\n\n406\n00:21:54.442 --> 00:21:57.263\nthat we don't have to try to\nfigure it out for ourselves.\n\n407\n00:21:57.263 --> 00:22:01.584\nAnd that's why we do these episodes for\nyou guys so that you don't have to do all\n\n408\n00:22:01.584 --> 00:22:04.530\nthe leg work,\ntry to figure out how this stuff works,\n\n409\n00:22:04.530 --> 00:22:07.170\nyou can just follow us along and\nmake it happen.\n\n410\n00:22:07.170 --> 00:22:09.970\nMike, is there anything else we need\nto cover before we wrap up the show?\n\n411\n00:22:09.970 --> 00:22:11.050\n>> I think we've got it all.\n\n412\n00:22:11.050 --> 00:22:12.420\n>> All right.\nWell, thank you again for\n\n413\n00:22:12.420 --> 00:22:16.220\njoining us and explaining this cool\ntopic to us and using the new portal.\n\n414\n00:22:16.220 --> 00:22:17.235\nThank you guys for watching.\n\n415\n00:22:17.235 --> 00:22:18.578\nWe're gonna go ahead and sign off for\n\n416\n00:22:18.578 --> 00:22:20.230\nITPro TV I've been your\nhost Daniel Lowery.\n\n417\n00:22:20.230 --> 00:22:21.253\n>> And I'm Mike Roderick.\n\n418\n00:22:21.253 --> 00:22:22.029\n>> We'll see you next time.\n\n419\n00:22:22.029 --> 00:22:31.660\n[MUSIC]\n\n",
          "vimeoId": "156015579"
        },
        {
          "description": "In this episode, Mike and Daniel show you how to create a Site-to-Site VPN from your on-premesis environment to your Azure environment using Windows PowerShell. They start by connecting to Azure with the PowerShell, making sure to choose the correct subscription. Then they show you how to access the necessary Azure resources to create the VPN connection.",
          "length": "1834",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-1-1-s2s_vpn_with_azure_powershell-021816-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-1-1-s2s_vpn_with_azure_powershell-021816-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-1-1-s2s_vpn_with_azure_powershell-021816-1-sm.jpg",
          "title": "Site-to-Site VPN with Azure PowerShell",
          "transcript": "WEBVTT\n\n1\n00:00:00.106 --> 00:00:10.106\n[MUSIC]\n\n2\n00:00:12.183 --> 00:00:16.677\nAll right, greetings everyone, and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.677 --> 00:00:20.745\nI'm your host Daniel Lowrie, and in\ntoday's episode, well, we're moving right\n\n4\n00:00:20.745 --> 00:00:24.680\nalong with our AD and Azure series\nwe've been working so diligently on.\n\n5\n00:00:24.680 --> 00:00:27.905\nAnd joining us in the studio again today\nis our good friend, our mentor, Mr.\n\n6\n00:00:27.905 --> 00:00:28.690\nMike Rodrick.\n\n7\n00:00:28.690 --> 00:00:30.030\nMike welcome back to the show, sir.\n\n8\n00:00:30.030 --> 00:00:32.090\n>> Thank you very much for\nhaving me, and yup that's right.\n\n9\n00:00:32.090 --> 00:00:36.120\nWe're going to continue on with Azure,\nand today we're playing with PowerShell.\n\n10\n00:00:36.120 --> 00:00:40.190\nWe've seen a few different ways that we\ncan work with our Azure resources, or\n\n11\n00:00:40.190 --> 00:00:41.470\nAzure subscription.\n\n12\n00:00:41.470 --> 00:00:43.330\nWe've looked at the classic portal.\n\n13\n00:00:43.330 --> 00:00:47.840\nWe've looked at the new portal, or\nthe portal, as they like to say.\n\n14\n00:00:47.840 --> 00:00:50.248\nNow we want to take a look at PowerShell.\n\n15\n00:00:50.248 --> 00:00:52.250\nPowerShell's a fantastic tool.\n\n16\n00:00:52.250 --> 00:00:54.970\nHopefully you've had a little bit\nof experience with PowerShell\n\n17\n00:00:54.970 --> 00:00:56.770\njust through your Windows Server training.\n\n18\n00:00:56.770 --> 00:00:58.920\nIf you've been working with Server for\nvery long,\n\n19\n00:00:58.920 --> 00:01:02.130\nyou've probably had to write\nsome PowerShell scripts.\n\n20\n00:01:02.130 --> 00:01:05.490\nAnd, remember with the way\nMicrosoft develops things now,\n\n21\n00:01:05.490 --> 00:01:07.430\nis PowerShell comes first.\n\n22\n00:01:07.430 --> 00:01:11.398\nEverything can be done through PowerShell,\nand then they'll go back and\n\n23\n00:01:11.398 --> 00:01:15.520\nadd a GUI interface for it,\neventually, if they ever do.\n\n24\n00:01:15.520 --> 00:01:16.060\nRight?\n\n25\n00:01:16.060 --> 00:01:19.404\nSo there are some things that you can do\nwith PowerShell that you can't do through\n\n26\n00:01:19.404 --> 00:01:23.540\na normal GUI interface, and that's one of\nthe big differences with the new portal\n\n27\n00:01:23.540 --> 00:01:28.550\nversus the classic is the new portal is,\nagain, designed around PowerShell.\n\n28\n00:01:28.550 --> 00:01:30.750\nEverything that we can\ndo in that new portal,\n\n29\n00:01:30.750 --> 00:01:34.210\nthere is a PowerShell command\nto accomplish the same task.\n\n30\n00:01:34.210 --> 00:01:37.040\nIn fact, there might be a few things\nthat you can do with PowerShell in there\n\n31\n00:01:37.040 --> 00:01:39.720\nthat you can't do through that new portal.\n\n32\n00:01:39.720 --> 00:01:41.190\nThey've made some improvements to it.\n\n33\n00:01:41.190 --> 00:01:43.330\nIt's a, well, we're going to play with it.\n\n34\n00:01:43.330 --> 00:01:44.710\nI'll show you how fantastic it is.\n\n35\n00:01:44.710 --> 00:01:46.550\n>> Now real quickly,\nright out of the gate,\n\n36\n00:01:46.550 --> 00:01:49.300\nour chat room jumps in and\nsays is this version specific?\n\n37\n00:01:49.300 --> 00:01:52.270\nBecause they are a few different versions\nof PowerShell that you might encounter,\n\n38\n00:01:52.270 --> 00:01:52.870\nright Mike?\n\n39\n00:01:52.870 --> 00:01:56.320\n>> Yes.\nAnd it really, I believe I'm using 0.9 for\n\n40\n00:01:56.320 --> 00:01:58.143\nthat Azure PowerShell.\n\n41\n00:01:58.143 --> 00:02:01.330\n1.0, I believe, is out, and\nI can't remember if I went and\n\n42\n00:02:01.330 --> 00:02:03.310\ndownloaded that latest one or not.\n\n43\n00:02:03.310 --> 00:02:05.230\nSo there are a couple of versions.\n\n44\n00:02:06.950 --> 00:02:08.740\nI take that back,\nbecause when you go to install the latest,\n\n45\n00:02:08.740 --> 00:02:13.710\nwhen you download the modules, it'll\nremove your old ones and add the new ones,\n\n46\n00:02:13.710 --> 00:02:16.990\nis what it does, if I remember correctly.\n\n47\n00:02:16.990 --> 00:02:20.410\nI'm on 1 point, I can't remember\nthe exact number, and that's pretty bad.\n\n48\n00:02:20.410 --> 00:02:21.110\nIt's a good question, David.\n\n49\n00:02:21.110 --> 00:02:24.234\nLet's go check Azure PowerShell.\n\n50\n00:02:26.393 --> 00:02:29.795\nOops, if I could spell, download.\n\n51\n00:02:29.795 --> 00:02:33.028\nAnd we'll verify that version\nthat we're using here.\n\n52\n00:02:33.028 --> 00:02:37.230\nAzure PowerShell 1.0 it looks like.\n\n53\n00:02:38.600 --> 00:02:40.386\nSo yeah, Azure PowerShell 1.0.\n\n54\n00:02:40.386 --> 00:02:42.790\nIt's the same as, what do they say?\n\n55\n00:02:42.790 --> 00:02:45.230\nBlah, blah, blah, 9.X.\n\n56\n00:02:45.230 --> 00:02:48.090\nIf you have Azure Power Shell\n.9X installed,\n\n57\n00:02:48.090 --> 00:02:52.810\nyou will be prompted to uninstall that\none first, so this does replace .9.\n\n58\n00:02:52.810 --> 00:02:55.190\nSo, there we go.\n\n59\n00:02:55.190 --> 00:02:56.240\nWe're going to be on version 1.0.\n\n60\n00:02:56.240 --> 00:03:00.490\nNow, as far as the commands go,\nand again, I don't know for sure.\n\n61\n00:03:00.490 --> 00:03:01.740\nIt'd have to be something\nyou'd want to try.\n\n62\n00:03:01.740 --> 00:03:06.900\nJust download and get the latest one is\nthe best way, I think, to go about that.\n\n63\n00:03:06.900 --> 00:03:08.600\nAll right, now.\n\n64\n00:03:08.600 --> 00:03:10.140\nLet's see where do we start here, Daniel?\n\n65\n00:03:10.140 --> 00:03:13.060\nI guess the first thing we'll do\nis just roam through some basic\n\n66\n00:03:13.060 --> 00:03:17.440\ncommands that we need to be familiar with,\nget our feet wet with Azure PowerShell.\n\n67\n00:03:17.440 --> 00:03:20.930\nNow, way back in an episode towards\nthe beginning of this series,\n\n68\n00:03:20.930 --> 00:03:24.470\nwe did download Azure PowerShell,\nand we installed it, and\n\n69\n00:03:24.470 --> 00:03:29.240\nyou saw me run through the process\nof importing those modules,\n\n70\n00:03:29.240 --> 00:03:35.400\ngetting my subscription information and\nall that, tying PowerShell to Azure.\n\n71\n00:03:35.400 --> 00:03:37.920\nSo it's not a separate window.\n\n72\n00:03:37.920 --> 00:03:41.770\nYou open up PowerShell, and I'm just\ngoing to open up PowerShell real quick.\n\n73\n00:03:41.770 --> 00:03:47.020\nAnd if I try to do something\nlike get-azurerm and\n\n74\n00:03:47.020 --> 00:03:49.740\nI hit Tab, you can see that it\nstarts to link things up, right?\n\n75\n00:03:49.740 --> 00:03:53.920\nWhich is the way I test to see\nif I have a module installed.\n\n76\n00:03:53.920 --> 00:03:58.490\nAnd obviously I do,\nbecause it's able to do my tab Autofill.\n\n77\n00:03:58.490 --> 00:04:03.740\nAnd I'll see if I can remember one of my,\nthere we go, get Azure subscription now.\n\n78\n00:04:05.040 --> 00:04:09.350\nEven though it shows the command, right,\nI'm able to do a tab Autofill to pull that\n\n79\n00:04:09.350 --> 00:04:14.065\ncommand up, which means the modules\nare installed, notice I get an error.\n\n80\n00:04:14.065 --> 00:04:16.350\nBecause I just opened up PowerShell and\ntried to fire a command,\n\n81\n00:04:16.350 --> 00:04:17.560\nand it says, wait.\n\n82\n00:04:17.560 --> 00:04:25.390\nYou need to run the login, and that's a\nhorrible color, the login Azurerm account.\n\n83\n00:04:25.390 --> 00:04:29.500\nSo even though I've got the modules\ninstalled, the commands are available,\n\n84\n00:04:29.500 --> 00:04:34.370\nI can't just typing and expect to\nconnect out to my Azure subscription and\n\n85\n00:04:34.370 --> 00:04:37.690\nstart creating resources, or deleting\nresources, or what have you, right?\n\n86\n00:04:37.690 --> 00:04:40.050\nI need to authenticate first,\nlet it know who I am.\n\n87\n00:04:40.050 --> 00:04:41.566\nSo that's going to be the first step.\n\n88\n00:04:41.566 --> 00:04:45.850\nBut I'm going to actually close this,\nand I'm going to fire up the ISE,\n\n89\n00:04:45.850 --> 00:04:50.290\nthe Integrated Scripting Environment,\nbecause I've got a bunch of commands\n\n90\n00:04:50.290 --> 00:04:53.620\nalready written out for us,\nbecause you've seen how I type, and\n\n91\n00:04:53.620 --> 00:04:58.850\nthis could turn into a three-hour trip\nif I try to type this live on TV.\n\n92\n00:04:58.850 --> 00:05:01.090\nSo I've got a lot of those pre-loaded for\nus.\n\n93\n00:05:01.090 --> 00:05:05.525\nSo, what I'm going to do is open up one\nof those scripts that I have created.\n\n94\n00:05:07.570 --> 00:05:10.550\nJust so we can get, again,\nstart getting familiar with this.\n\n95\n00:05:10.550 --> 00:05:12.170\nAnd the first one I have listed up here,\nand\n\n96\n00:05:12.170 --> 00:05:17.800\nI can make these available to you guys out\nthere if you want, Login-AzureRmAccount.\n\n97\n00:05:17.800 --> 00:05:19.970\nSo that's really the first command I need.\n\n98\n00:05:19.970 --> 00:05:21.590\nIf you're familiar with the ISE,\n\n99\n00:05:21.590 --> 00:05:24.860\nthe Integrated Scripting Environment,\nthat's what I'm in here.\n\n100\n00:05:24.860 --> 00:05:27.180\nI've got my PowerShell\nwindow at the bottom.\n\n101\n00:05:27.180 --> 00:05:29.650\nI've got my scripting\nenvironment up here at the top.\n\n102\n00:05:29.650 --> 00:05:33.270\nThis allows me to write out commands but\nnot execute them.\n\n103\n00:05:33.270 --> 00:05:37.570\nWhereas anything I type in PowerShell,\nI hit Enter, and it ends up executing.\n\n104\n00:05:37.570 --> 00:05:39.010\nI love creating these scripts, and\n\n105\n00:05:39.010 --> 00:05:42.530\nthis script is not meant to\nbe run as one unit, right?\n\n106\n00:05:42.530 --> 00:05:46.020\nI've just got random commands in here\nthat I need to run now and again.\n\n107\n00:05:46.020 --> 00:05:49.230\nSo, any time that I need to run them,\nI can just come in here, highlight one\n\n108\n00:05:49.230 --> 00:05:54.110\nparticular line, and choose Run Selected,\nand it'll run just that one line.\n\n109\n00:05:55.370 --> 00:05:56.940\nLove that feature.\n\n110\n00:05:56.940 --> 00:05:59.170\nWe'll be using it throughout this show.\n\n111\n00:05:59.170 --> 00:06:02.690\nSo I did run the login\nto your AzureRm account.\n\n112\n00:06:02.690 --> 00:06:06.410\nYou can see when I ran that, it put it\nin Powershell down here, it executed it,\n\n113\n00:06:06.410 --> 00:06:08.550\nand then this popped up, right?\n\n114\n00:06:08.550 --> 00:06:11.590\nMicrosoft Azure for\nhow do you want to authenticate.\n\n115\n00:06:11.590 --> 00:06:13.575\nI'm going to change this up a little bit.\n\n116\n00:06:17.534 --> 00:06:19.695\nMake sure, hopefully my password\nwon't show up on screen.\n\n117\n00:06:19.695 --> 00:06:20.612\nTee hee hee.\n\n118\n00:06:22.584 --> 00:06:25.219\nHopefully, I remember my\npassword to authenticate.\n\n119\n00:06:27.042 --> 00:06:28.210\nAnd there we go.\n\n120\n00:06:28.210 --> 00:06:31.220\nWe can see that I've got my,\nit tells me my environment.\n\n121\n00:06:31.220 --> 00:06:36.180\nIt shows me the account that I'm using,\nand Tenant and Subscription ID.\n\n122\n00:06:36.180 --> 00:06:38.460\nAnd at this point,\nI'm authenticated, right?\n\n123\n00:06:38.460 --> 00:06:41.450\nSo now I can start firing off commands.\n\n124\n00:06:41.450 --> 00:06:44.900\nOne of them might be get\nmy AzureSubscription.\n\n125\n00:06:44.900 --> 00:06:48.320\nNow in my case,\nI only have one subscription, but\n\n126\n00:06:48.320 --> 00:06:52.360\nmany organizations might have several\ndifferent subscriptions that you use.\n\n127\n00:06:52.360 --> 00:06:57.130\nMaybe one for just development,\none for production, or one for\n\n128\n00:06:57.130 --> 00:07:00.440\nmarketing versus one for\nIT, or things like that.\n\n129\n00:07:00.440 --> 00:07:03.190\nYou might have access to more\nthan one subscription, so\n\n130\n00:07:03.190 --> 00:07:05.370\nwe need to make sure we're\nworking with the right one,\n\n131\n00:07:05.370 --> 00:07:09.920\nand we need to be able to change context\nto the appropriate subscription if needed.\n\n132\n00:07:09.920 --> 00:07:14.400\nSo the next command I'm going\nto run is Get-AzureSubscription.\n\n133\n00:07:14.400 --> 00:07:15.660\nAnd then I'm simply going to,\n\n134\n00:07:15.660 --> 00:07:18.040\nthat's really all that's needed,\nis that part right there.\n\n135\n00:07:18.040 --> 00:07:22.120\nIn fact, I can run just that, and\n\n136\n00:07:22.120 --> 00:07:26.040\nwe'll see it'll list the different\nsubscriptions that I have available.\n\n137\n00:07:26.040 --> 00:07:29.640\nNow, in my case,\nI only have one, ITProTV Demo.\n\n138\n00:07:29.640 --> 00:07:32.220\nIf I had more than that and\nI wanted to get the entire list,\n\n139\n00:07:32.220 --> 00:07:36.910\nI would run this same command, pipe it\nout and do a sort subscription name,\n\n140\n00:07:36.910 --> 00:07:39.690\nand then select subscription name.\n\n141\n00:07:39.690 --> 00:07:43.680\nYou don't have to, but it makes a nice\ntidy list when you do it that way.\n\n142\n00:07:43.680 --> 00:07:45.383\nYou see down here my output.\n\n143\n00:07:47.367 --> 00:07:51.833\nThere we get a nice little list without\nall the other information that I might not\n\n144\n00:07:51.833 --> 00:07:52.974\nnecessarily need.\n\n145\n00:07:52.974 --> 00:07:56.895\nI just want to see a list of all\nthe subscriptions I have access too.\n\n146\n00:07:56.895 --> 00:08:02.489\nAnd then, if you needed to change context,\nYou would use this command here,\n\n147\n00:08:02.489 --> 00:08:06.624\nSelect-AzureSubscription-SubscriptionName,\nand\n\n148\n00:08:06.624 --> 00:08:11.780\nthen whatever the name of that was,\nin this case ITProTV Demo.\n\n149\n00:08:11.780 --> 00:08:15.740\nNow as you write scripts you'll\n\n150\n00:08:15.740 --> 00:08:19.470\nfind you might want to use them for\nother, what's a good way to say this?\n\n151\n00:08:21.410 --> 00:08:24.380\nI use variables a lot in my scripts,\nis really where I'm going with this.\n\n152\n00:08:24.380 --> 00:08:27.810\nAnd that's because I can come in here and\nchange the variable, and\n\n153\n00:08:27.810 --> 00:08:31.880\nnot have to go through and find\neverywhere I needed that in my script.\n\n154\n00:08:31.880 --> 00:08:35.190\nCuz I might be using that several\ntimes throughout my script.\n\n155\n00:08:35.190 --> 00:08:40.140\nWell if I assign that to a variable, and\nthen just use the variable in the script\n\n156\n00:08:40.140 --> 00:08:44.330\nI can change it once and not have to go\nthrough the entire script, miss one, and\n\n157\n00:08:44.330 --> 00:08:48.130\nnow it goofs up, something fails because I\ndidn't see that one place to replace it.\n\n158\n00:08:48.130 --> 00:08:50.390\n>> So you're making it much more portable.\n\n159\n00:08:50.390 --> 00:08:53.680\nYou're able to say, I got this one script,\nI do have a variable, and\n\n160\n00:08:53.680 --> 00:08:55.520\nthat's why we use these variables.\n\n161\n00:08:55.520 --> 00:08:58.650\nAnd that variable's going\nto equal a certain value.\n\n162\n00:08:58.650 --> 00:09:02.030\nAnd then, if Mike wants to give me\nthat script I can take this script and\n\n163\n00:09:02.030 --> 00:09:04.350\nreplace the value for my own values and\n\n164\n00:09:04.350 --> 00:09:07.260\nI'm able to reuse that script without\nhaving to rewrite the script and\n\n165\n00:09:07.260 --> 00:09:10.490\njust change a couple little values here\nand there and I'm off to the races.\n\n166\n00:09:10.490 --> 00:09:13.040\nIt's very handy and\nthat's why we like scripting.\n\n167\n00:09:13.040 --> 00:09:16.520\n>> Yes, absolutely,\nyou know you want that reusability, right?\n\n168\n00:09:16.520 --> 00:09:18.300\nThe reason we write these scripts is to,\n\n169\n00:09:18.300 --> 00:09:22.510\ntypically because it's something that I\ndo more than once, on a frequent basis.\n\n170\n00:09:22.510 --> 00:09:24.570\nSo I don't wanna have to\ntype this out every time.\n\n171\n00:09:24.570 --> 00:09:27.300\nBut what if it's something I do more\nthan once, or on a frequent basis,\n\n172\n00:09:27.300 --> 00:09:29.380\nbut certain things change?\n\n173\n00:09:29.380 --> 00:09:31.820\nThat's where those variables\nreally come into play, as you say.\n\n174\n00:09:31.820 --> 00:09:33.820\nI like that.\nIt gives it that portability,\n\n175\n00:09:33.820 --> 00:09:34.714\nthat reuseability.\n\n176\n00:09:35.720 --> 00:09:38.970\nAll right so normally I would inline,\nsince I only have one I really\n\n177\n00:09:38.970 --> 00:09:42.950\ndon't need to, but I could run this\ncommand again, I can go ahead and say all\n\n178\n00:09:42.950 --> 00:09:47.935\nright set my subscription set the variable\nsubscribe to IT ProTV demo, and then\n\n179\n00:09:47.935 --> 00:09:51.350\nselect-AzureSubscription-sSubscriptionN-\name.\n\n180\n00:09:51.350 --> 00:09:54.910\nAnd then the name of my\nvariable then -current,\n\n181\n00:09:54.910 --> 00:09:59.390\nsaying make this my current subscription\nthat I'm working with In this session so\n\n182\n00:09:59.390 --> 00:10:02.820\nI'll go ahead and execute those two\ncommands and really nothing will\n\n183\n00:10:02.820 --> 00:10:06.420\nchange because I was already using\nthat particular subscription.\n\n184\n00:10:07.530 --> 00:10:13.930\nAlright other commands that we might find\nuseful, Get-Azure RM resource group.\n\n185\n00:10:13.930 --> 00:10:15.300\nYou know what we're going to find in,\n\n186\n00:10:15.300 --> 00:10:17.180\nin the next set of commands\nthat we start going to,\n\n187\n00:10:17.180 --> 00:10:21.860\nas we start creating things a lot of times\nwe need the names of certain resources.\n\n188\n00:10:21.860 --> 00:10:26.140\nLike if I wanna add new virtual network,\nthink about what we do we're in the GUI.\n\n189\n00:10:26.140 --> 00:10:26.650\nRight?\n\n190\n00:10:26.650 --> 00:10:28.220\nI click new virtual network.\n\n191\n00:10:28.220 --> 00:10:28.880\nWhat do I have to do?\n\n192\n00:10:28.880 --> 00:10:31.170\nI have to select a resource group.\n\n193\n00:10:31.170 --> 00:10:33.010\nI have to select a storage account.\n\n194\n00:10:33.010 --> 00:10:34.980\nRight?\nWell that means in the command.\n\n195\n00:10:34.980 --> 00:10:38.200\nWhen I do this in PowerShell,\nI'm also gonna tell what resource group.\n\n196\n00:10:38.200 --> 00:10:42.100\nWhat storage account or what other,\nother parameters that I need to provide.\n\n197\n00:10:42.100 --> 00:10:42.960\nWell how do I know?\n\n198\n00:10:42.960 --> 00:10:43.790\nWhat are the names?\n\n199\n00:10:43.790 --> 00:10:46.390\nWhat storage groups do I have out there?\n\n200\n00:10:46.390 --> 00:10:48.630\nWhat resource groups do I have out there?\n\n201\n00:10:48.630 --> 00:10:51.260\nThese kind of commands can be very,\nvery useful.\n\n202\n00:10:51.260 --> 00:10:56.330\nAgain, I've added a little bit to it,\nthe whole sort and then get just the name.\n\n203\n00:10:56.330 --> 00:11:04.240\nFor example, if I do just this,\nGet-AzureRMResourceGroup and\n\n204\n00:11:04.240 --> 00:11:05.980\nagain, if you're not\nfamiliar with the ISE,\n\n205\n00:11:05.980 --> 00:11:09.110\nI think I started to tell you this and\nthen I got sidetracked.\n\n206\n00:11:09.110 --> 00:11:12.100\nWhat I'm doing is I'm highlighting\nwhat I want to run and\n\n207\n00:11:12.100 --> 00:11:15.310\nthen I'm using this button right here,\nF8 is the keyboard shortcut.\n\n208\n00:11:15.310 --> 00:11:19.740\nThat executes not the entire script,\njust what you have highlighted, so very,\n\n209\n00:11:19.740 --> 00:11:20.970\nvery handy.\n\n210\n00:11:20.970 --> 00:11:23.670\nHere I can see I get a lot\nof information back.\n\n211\n00:11:23.670 --> 00:11:28.510\nAbout the, in this case,\nthe resource groups that I have.\n\n212\n00:11:28.510 --> 00:11:32.110\nThere's my Default-web-East and\nmy ResourceID.\n\n213\n00:11:32.110 --> 00:11:36.090\nThere's Storage-West,\nthere's Storage-SouthCentralUS.\n\n214\n00:11:36.090 --> 00:11:39.710\nSomewhere up here we'll find\nthere's my adinazuretest.\n\n215\n00:11:39.710 --> 00:11:45.370\nAll right, but if I run this whole line\ninstead of just that first part you\n\n216\n00:11:45.370 --> 00:11:50.460\nsee I get a nice tidy list without all the\nextra information which is sometimes nice.\n\n217\n00:11:50.460 --> 00:11:53.510\nAll I need is the name of the resource\ngroups like in fill it in,\n\n218\n00:11:53.510 --> 00:11:54.790\nin this other command.\n\n219\n00:11:54.790 --> 00:11:59.550\nSo this sort and then select just\nthe name allows you to do that.\n\n220\n00:11:59.550 --> 00:12:00.840\nSame thing for storage accounts,\n\n221\n00:12:00.840 --> 00:12:06.570\nwe can just get a list of existing storage\naccounts I have a whole whopping one.\n\n222\n00:12:06.570 --> 00:12:10.630\nAnother handy one here, Test-AzureName.\n\n223\n00:12:10.630 --> 00:12:16.360\nRemember, a lot of times the names that\nwe're creating have to be globally unique.\n\n224\n00:12:16.360 --> 00:12:20.950\nWell in the GUI, as I fill in those names\nin that form, there's a little green\n\n225\n00:12:20.950 --> 00:12:25.100\ncheckmark that'll light up at the end\nof that text field in that form.\n\n226\n00:12:25.100 --> 00:12:28.600\nAnd that lets me know that it's\ntested it and the name is unique.\n\n227\n00:12:28.600 --> 00:12:32.100\nOr I'll get that exclamation point\nsaying hey, the name's already in use.\n\n228\n00:12:32.100 --> 00:12:34.260\nWell in PowerShell I'm not gonna get that,\nright?\n\n229\n00:12:34.260 --> 00:12:38.340\nIf I try to use a name that's already\nin use, the command's just gonna fail.\n\n230\n00:12:38.340 --> 00:12:42.580\nMost likely in the error it'll tell\nme that the name was not unique but\n\n231\n00:12:42.580 --> 00:12:46.760\nI have to siphon through the error that it\nspits out and figure out what happened.\n\n232\n00:12:46.760 --> 00:12:50.110\nWell here I can do a test before I try it,\nall right?\n\n233\n00:12:50.110 --> 00:12:55.210\nTest- AzureName -Storage and\nthen a name that I plan on using.\n\n234\n00:12:55.210 --> 00:12:57.549\nWell I know this one's already in use so\nlet's see what happens.\n\n235\n00:12:59.890 --> 00:13:01.790\nYou see I get true.\n\n236\n00:13:01.790 --> 00:13:03.865\nIt's kind of opposite of\nwhat you might think.\n\n237\n00:13:03.865 --> 00:13:09.850\nTest-AzureName is gonna tell\nme true if the name is in use,\n\n238\n00:13:09.850 --> 00:13:11.850\nwhich means I can't Can't use that name.\n\n239\n00:13:11.850 --> 00:13:13.370\nI thought it should be the backwards,\nright?\n\n240\n00:13:13.370 --> 00:13:16.350\nI would thinking if the names are in use,\nyou should come back false.\n\n241\n00:13:16.350 --> 00:13:19.050\nHey, that's a bad thing but\nthat's not the way they do.\n\n242\n00:13:19.050 --> 00:13:21.892\nIf I change this up and\nI try something that I know is not in use,\n\n243\n00:13:21.892 --> 00:13:23.329\nI'll add Mike to the end of it.\n\n244\n00:13:27.600 --> 00:13:32.620\nI can't use capital letters in\nstorage accounts, I knew that.\n\n245\n00:13:33.860 --> 00:13:35.330\nJust fail to execute that.\n\n246\n00:13:35.330 --> 00:13:37.415\n>> Just testing us all to\nsee if we knew that, right?\n\n247\n00:13:37.415 --> 00:13:39.116\n>> [LAUGH] That's right.\n\n248\n00:13:39.116 --> 00:13:41.540\nAlright, so there I get false, and\n\n249\n00:13:41.540 --> 00:13:46.190\nfalse is actually what you wanna get if\nyou're looking for a unique name, alright?\n\n250\n00:13:46.190 --> 00:13:49.350\nSo just keep that in mind when you\nrun that command false is really what\n\n251\n00:13:49.350 --> 00:13:49.960\nyou're looking for.\n\n252\n00:13:49.960 --> 00:13:54.950\nThat tells you that that name\nis available, it's not in use.\n\n253\n00:13:54.950 --> 00:13:59.840\nSome more listing virtual networks yeah,\nif we need to do that.\n\n254\n00:13:59.840 --> 00:14:02.810\nI'll go ahead and execute it just so\nyou can see the results.\n\n255\n00:14:04.030 --> 00:14:06.260\nSo I've got a big one virtual network.\n\n256\n00:14:06.260 --> 00:14:09.130\nWhat else?\nThe rest of these basic commands list\n\n257\n00:14:09.130 --> 00:14:10.860\nsubnets for the virtual network.\n\n258\n00:14:10.860 --> 00:14:12.920\nThis is one we'll actually\nhave to use in a little bit.\n\n259\n00:14:12.920 --> 00:14:15.720\nI'll go ahead and execute that one.\n\n260\n00:14:15.720 --> 00:14:19.150\nBecause the way it does the subnets,\nyou see it comes back.\n\n261\n00:14:19.150 --> 00:14:21.110\nNow I did sort it.\n\n262\n00:14:21.110 --> 00:14:21.840\nWait, I'm sorry.\n\n263\n00:14:21.840 --> 00:14:23.130\nI did not sort that one, did I?\n\n264\n00:14:23.130 --> 00:14:26.110\nBut I did select subnets, so\nit's not giving me all the information,\n\n265\n00:14:26.110 --> 00:14:27.320\njust the name.\n\n266\n00:14:27.320 --> 00:14:30.430\nThe order that it returns them in,\nit creates an array.\n\n267\n00:14:30.430 --> 00:14:33.090\nThey're basically indexed and\nit starts at zero.\n\n268\n00:14:33.090 --> 00:14:37.660\nSo if I want to reference\nsubnet Vsub01 I can actually do\n\n269\n00:14:37.660 --> 00:14:41.890\nsubnet index ID of 0, right?\n\n270\n00:14:41.890 --> 00:14:46.730\nSubnet index of 1 would\nbe this Gateway subnet.\n\n271\n00:14:46.730 --> 00:14:50.310\nSo, remember that, they start at 0 if\nyou're looking for that index number.\n\n272\n00:14:51.670 --> 00:14:53.500\nAll right.\nSo a lot of cool commands there.\n\n273\n00:14:53.500 --> 00:14:57.790\nAnd again, that's a teeny tiny snippet\nof the commands that are available.\n\n274\n00:14:57.790 --> 00:15:00.560\nI will give you guys\na link in the show notes.\n\n275\n00:15:00.560 --> 00:15:03.840\nWe'll make sure Danny gets that\nof all the different commands.\n\n276\n00:15:03.840 --> 00:15:06.670\nJust basically a reference\nto all of the commands.\n\n277\n00:15:06.670 --> 00:15:09.100\nNow I will tell you that\nthe documentation is sparse.\n\n278\n00:15:09.100 --> 00:15:10.640\nSome of the commands are changing.\n\n279\n00:15:12.110 --> 00:15:15.970\nI have found several commands\nthat you go through some of these\n\n280\n00:15:15.970 --> 00:15:21.170\nMicrosoft blogs written by\nMicrosoft last year, in 2015, and\n\n281\n00:15:21.170 --> 00:15:26.700\nyou try to run the command and it fails\nbecause the command no longer exists.\n\n282\n00:15:26.700 --> 00:15:29.300\nOr it's the name of the command\nhas been changed a little bit, so\n\n283\n00:15:29.300 --> 00:15:32.750\ndo have some patience there when\nyou're trying to fumble through here.\n\n284\n00:15:32.750 --> 00:15:35.220\nWell, I shouldn't say fumble.\n\n285\n00:15:35.220 --> 00:15:36.910\nLearn using Azure PowerShell.\n\n286\n00:15:36.910 --> 00:15:41.380\n>> Yeah they have some interesting ideas\non how we should learn their products over\n\n287\n00:15:41.380 --> 00:15:43.873\nthere at the good old Microsoft-\n>> [LAUGH]\n\n288\n00:15:43.873 --> 00:15:45.640\n>> And [LAUGH] throwing us a bone and\n\n289\n00:15:45.640 --> 00:15:46.900\nthen removing it-\n>> [LAUGH]\n\n290\n00:15:46.900 --> 00:15:48.230\n>> From our plate is one\n\n291\n00:15:48.230 --> 00:15:49.560\nof their favorite things to do.\n\n292\n00:15:49.560 --> 00:15:52.910\nSo yeah it's not gonna happen yeah\nyou're gonna get used to a command and\n\n293\n00:15:52.910 --> 00:15:54.980\nthe next thing you know it's not\nsupported, it doesn't work any longer.\n\n294\n00:15:54.980 --> 00:15:56.934\nYou're gonna have to figure\nout the new way to do it.\n\n295\n00:15:56.934 --> 00:15:57.790\nBut that's all,\n\n296\n00:15:57.790 --> 00:16:00.061\nif you're in IT just the name of the game-\n>> Mm-hm.\n\n297\n00:16:00.061 --> 00:16:01.300\n>> It's what we gotta do.\n\n298\n00:16:01.300 --> 00:16:04.638\nNow Mike you've done a great job at\nshowing us how do we connect to the Azure,\n\n299\n00:16:04.638 --> 00:16:06.217\nwe've Seen our storage accounts.\n\n300\n00:16:06.217 --> 00:16:09.610\nWe've seen in our,\nthe thing that replaces cloud services.\n\n301\n00:16:09.610 --> 00:16:10.640\n>> Resource groups.\n\n302\n00:16:10.640 --> 00:16:12.450\n>> The resource groups,\nwe can get to that.\n\n303\n00:16:12.450 --> 00:16:16.290\nWe can integrate Azure with PowerShell,\nmake them talk to each other.\n\n304\n00:16:16.290 --> 00:16:20.770\nAnd now that we can do that If\nwe can see it, can we modify it?\n\n305\n00:16:20.770 --> 00:16:22.040\nThat's the next question.\n\n306\n00:16:22.040 --> 00:16:25.960\nCan we create these things and\nmaybe you would do that site to site VBN..\n\n307\n00:16:25.960 --> 00:16:26.780\n>> Absolutely.\n\n308\n00:16:26.780 --> 00:16:27.750\nLet's try it.\n\n309\n00:16:27.750 --> 00:16:29.790\nLet's have some fun with PowerShell here.\n\n310\n00:16:29.790 --> 00:16:33.780\nSo I have to again, gone through and\nopened up, I'm gonna open up a file\n\n311\n00:16:33.780 --> 00:16:36.820\nthat has a bunch of my commands\nin here that we're going to use.\n\n312\n00:16:36.820 --> 00:16:38.630\nSo we'll just start at the very top.\n\n313\n00:16:38.630 --> 00:16:42.210\nThe first thing I need to do is\ncreate a new resource group.\n\n314\n00:16:42.210 --> 00:16:45.820\nNow, if I already had a resource group\nthat I wanted to create these objects in,\n\n315\n00:16:45.820 --> 00:16:49.190\nperfectly okay just using\nthat resource group.\n\n316\n00:16:49.190 --> 00:16:52.700\nWhen you come down and look at some of\nthese next commands, like New dash.\n\n317\n00:16:52.700 --> 00:16:56.728\nAzure remote virtual Azure RM\nvirtual network, and it asks for\n\n318\n00:16:56.728 --> 00:16:59.060\nthe resource group name.\n\n319\n00:16:59.060 --> 00:17:00.950\nWell just type in the name right there,\nright?\n\n320\n00:17:00.950 --> 00:17:04.450\nSo if you've already got one created,\nby all means use that or\n\n321\n00:17:04.450 --> 00:17:05.480\nyou can create a new one.\n\n322\n00:17:05.480 --> 00:17:08.720\nFor the show I thought I'd show you\neverything, so I'm gonna go ahead and\n\n323\n00:17:08.720 --> 00:17:09.450\ncreate a new one.\n\n324\n00:17:09.450 --> 00:17:12.950\nSo I'm gonna select that line there, so\nwe don't have to watch me type it and\n\n325\n00:17:12.950 --> 00:17:13.590\nI'm gonna run it.\n\n326\n00:17:13.590 --> 00:17:16.640\nWhat I've got it is new-Azure RM.\n\n327\n00:17:16.640 --> 00:17:23.030\nRM is Resource Manager, and\nResource Manager is the new portal.\n\n328\n00:17:23.030 --> 00:17:26.450\nSo you will find some commands\nthat don't have the RM in it.\n\n329\n00:17:26.450 --> 00:17:30.460\nIf you went back to point nine, like David\nwas asking about earlier version wise,\n\n330\n00:17:30.460 --> 00:17:32.890\nthose commands didn't\nhave the RM in there.\n\n331\n00:17:32.890 --> 00:17:36.360\nWe get to 1.0, they added the RM for\nresource manager, so\n\n332\n00:17:36.360 --> 00:17:38.190\nwe can differentiate between.\n\n333\n00:17:38.190 --> 00:17:45.320\nSo Azure RM resource group dash name\nrecovery dash location, west US, right?\n\n334\n00:17:45.320 --> 00:17:46.040\nThink about it again.\n\n335\n00:17:46.040 --> 00:17:47.783\nI always like to think about the GUI.\n\n336\n00:17:47.783 --> 00:17:49.920\nCuz I know I've done it there before.\n\n337\n00:17:49.920 --> 00:17:52.660\nWhat are the things I had to do when\nI created a new resource group?\n\n338\n00:17:52.660 --> 00:17:53.780\nGive it a name.\n\n339\n00:17:53.780 --> 00:17:57.250\nAnd pick what date center from\nMicrosoft I want to store it in.\n\n340\n00:17:57.250 --> 00:17:57.820\nRight?\n\n341\n00:17:57.820 --> 00:18:00.260\nI'm gonna use West US for this one.\n\n342\n00:18:00.260 --> 00:18:03.250\nWe're gonna move it the other side of\nthe country, just in case the big storm\n\n343\n00:18:03.250 --> 00:18:07.270\ncomes through here and wipes out the East\nCoast and all the Microsoft date centers.\n\n344\n00:18:07.270 --> 00:18:11.190\nMy stuff will be safe over there on\nthe West coast as long as they don't\n\n345\n00:18:11.190 --> 00:18:12.360\nhave an earthquake.\n\n346\n00:18:12.360 --> 00:18:18.290\nSo I'm gonna run that command and we'll\ngive it just a second, and there we go.\n\n347\n00:18:18.290 --> 00:18:24.760\nI get ResourceGroup recovery,\nwest us, and oops, succeeded, right?\n\n348\n00:18:24.760 --> 00:18:25.850\nSo it did succeed.\n\n349\n00:18:26.950 --> 00:18:30.869\nNow I'm gonna jump over to the portal and\nI'm going to go to Resource groups\n\n350\n00:18:33.132 --> 00:18:38.225\nAnd sure enough there is my new\nresource group called Recovery,\n\n351\n00:18:38.225 --> 00:18:42.100\nand it is indeed located\nin West US data centers.\n\n352\n00:18:43.330 --> 00:18:45.270\nAll right?\nSo you can see that it, either way,\n\n353\n00:18:45.270 --> 00:18:46.590\nworking from PowerShell,\n\n354\n00:18:46.590 --> 00:18:49.480\nworking through the GUI you're\ngonna create those resources.\n\n355\n00:18:49.480 --> 00:18:53.280\nAll right, so the next thing I wanna do,\ncreate a virtual network and sub nets.\n\n356\n00:18:53.280 --> 00:18:56.420\nAgain, think back to our episodes\nwhere we did this in the GUI,\n\n357\n00:18:56.420 --> 00:18:58.840\nand this is gonna look really familiar.\n\n358\n00:18:58.840 --> 00:19:02.600\nYou know new-AzureRmVirutalNetwork subnet,\nright.\n\n359\n00:19:02.600 --> 00:19:03.790\nJust like when I would do the GUI,\n\n360\n00:19:03.790 --> 00:19:06.420\nI had to click the plus\nbutton to add a new sub net.\n\n361\n00:19:06.420 --> 00:19:10.980\nI had to define the name of the sub\nnet and what the address prefix was.\n\n362\n00:19:12.170 --> 00:19:15.800\nAll right, notice I'm making\none called GatewaySubnet.\n\n363\n00:19:15.800 --> 00:19:18.180\nRemember what I said,\nif you're gonna do a site-to-site VPN,\n\n364\n00:19:18.180 --> 00:19:22.070\nyou must have a subnet\ncalled GatewaySubnet.\n\n365\n00:19:22.070 --> 00:19:24.210\nIf you do not,\nif you name it anything else,\n\n366\n00:19:24.210 --> 00:19:28.550\nit will not recognize it as a gateway\nsubnet and it won't be able to use that.\n\n367\n00:19:28.550 --> 00:19:31.210\nI made both of these\nnetworks pretty small here.\n\n368\n00:19:31.210 --> 00:19:33.100\nAbout 15 hosts on each one of them.\n\n369\n00:19:33.100 --> 00:19:37.180\nSo, I'm going to create two subnets,\nbut notice what I'm doing.\n\n370\n00:19:37.180 --> 00:19:40.730\nThe variables subnet one has the command\n\n371\n00:19:40.730 --> 00:19:43.460\nnew Azure RN virtual\nnetwork subnet config.\n\n372\n00:19:43.460 --> 00:19:46.810\nThat is a long command, and\nall the properties there.\n\n373\n00:19:46.810 --> 00:19:49.810\nAnd then subnet two, again,\nis another variable.\n\n374\n00:19:49.810 --> 00:19:52.010\nThat's storing the results\nof this command.\n\n375\n00:19:52.010 --> 00:19:55.730\nThen when I do the new\nAzure RM Virtual Network,\n\n376\n00:19:55.730 --> 00:19:57.770\nI'm giving it a name, recoveryvnet.\n\n377\n00:19:57.770 --> 00:20:03.170\nI am telling it what resource group to\nstore it in; what location we're using.\n\n378\n00:20:05.310 --> 00:20:09.300\nTelling it what the prefix is for\nthe all virtual network.\n\n379\n00:20:09.300 --> 00:20:12.930\nAnd then dash subnet and instead of\nhaving to provide all that information,\n\n380\n00:20:12.930 --> 00:20:16.520\nI can just call the variable which has all\nthe information, right, what my prefix is,\n\n381\n00:20:16.520 --> 00:20:18.660\nget it, so we're storing that in there.\n\n382\n00:20:18.660 --> 00:20:22.930\nAnd then I'm adding a DNS server\n10110 to my virtual network.\n\n383\n00:20:24.060 --> 00:20:27.007\nSo let's run those guys and\nsee what happens.\n\n384\n00:20:30.535 --> 00:20:32.982\nMike just slowed the rotation\nof the Earth with PowerShell.\n\n385\n00:20:32.982 --> 00:20:34.790\n[LAUGH]\n>> [LAUGH]\n\n386\n00:20:34.790 --> 00:20:36.610\n>> Hopefully it will whir and grind for\n\n387\n00:20:36.610 --> 00:20:37.130\na second.\n\n388\n00:20:37.130 --> 00:20:38.380\nThe only downside to this.\n\n389\n00:20:38.380 --> 00:20:40.030\nYou don't get a lot of feedback.\n\n390\n00:20:40.030 --> 00:20:42.930\nIf you've worked with PowerShell,\nyou know you don't get a lot of feedback.\n\n391\n00:20:42.930 --> 00:20:46.560\nAnd it's hard to tell if something\ngot stuck or if it's still running.\n\n392\n00:20:46.560 --> 00:20:47.970\nUsually you can look\nright down at the bottom,\n\n393\n00:20:47.970 --> 00:20:53.430\nwhere it says completed right now and\nit'll say, running script.\n\n394\n00:20:53.430 --> 00:20:55.810\nSo that's your indication that,\nhey, it hasn't locked up.\n\n395\n00:20:55.810 --> 00:20:58.180\nIt's still running something out there.\n\n396\n00:20:58.180 --> 00:20:59.260\nAll right, and then my results.\n\n397\n00:20:59.260 --> 00:21:01.890\nIn this case, it does feed back\na little bit of information.\n\n398\n00:21:01.890 --> 00:21:05.280\nIt tells me a name of\nthe network that I just created.\n\n399\n00:21:05.280 --> 00:21:07.180\nAnd hopefully there's my provisioning,\noops.\n\n400\n00:21:08.350 --> 00:21:09.750\nEvery time I do that.\n\n401\n00:21:09.750 --> 00:21:14.000\nProvisioning succeeded,\nthat's really what I'm looking for there.\n\n402\n00:21:14.000 --> 00:21:17.310\nThe rest of it is just verifying\nthe information that I provided.\n\n403\n00:21:17.310 --> 00:21:20.010\nWhat DNS server, what my prefix was.\n\n404\n00:21:20.010 --> 00:21:23.750\nThere's the information about my\ngateway subnet, that succeeded.\n\n405\n00:21:23.750 --> 00:21:26.290\nSubnet one succeeded, so we're good to go.\n\n406\n00:21:26.290 --> 00:21:31.130\nAnd again if we flip over to the portal.\n\n407\n00:21:31.130 --> 00:21:31.890\nLet's take a look.\n\n408\n00:21:31.890 --> 00:21:33.514\nI'll go out to all resources.\n\n409\n00:21:36.415 --> 00:21:41.365\nSure enough, there is my recovery VNet,\nand if I click on that,\n\n410\n00:21:41.365 --> 00:21:46.630\nand we take a look,\nthere's the address space right up there.\n\n411\n00:21:46.630 --> 00:21:48.490\nThere's my DNS server.\n\n412\n00:21:48.490 --> 00:21:52.370\nWe can also go to settings and\nI can verify my address space.\n\n413\n00:21:52.370 --> 00:21:54.480\nMy DNS server that I added.\n\n414\n00:21:55.770 --> 00:21:56.360\nRight?\n\n415\n00:21:56.360 --> 00:21:57.570\nAnd the subnets that I created.\n\n416\n00:21:58.630 --> 00:22:01.410\nGateway subnet, subnet one.\n\n417\n00:22:01.410 --> 00:22:02.000\nRight?\n\n418\n00:22:02.000 --> 00:22:03.395\nAll of that is good.\n\n419\n00:22:03.395 --> 00:22:07.550\nCome back over to PowerShell, and\nnow we'll just keep trucking through here.\n\n420\n00:22:07.550 --> 00:22:10.380\nAdding gateway subnet to\nthe existing virtual network.\n\n421\n00:22:10.380 --> 00:22:11.770\nNow you might think, wait.\n\n422\n00:22:11.770 --> 00:22:16.170\nDidn't you just define a gateway subnet,\nright up here?\n\n423\n00:22:17.170 --> 00:22:19.135\nYes, and\nactually I don't need this command.\n\n424\n00:22:19.135 --> 00:22:23.060\n[LAUGH]\nJust thought I'd throw that out there.\n\n425\n00:22:23.060 --> 00:22:24.360\nNow if you were,\n\n426\n00:22:24.360 --> 00:22:29.150\nthis command that I ran, I didn't\nhave the virtual network created yet.\n\n427\n00:22:29.150 --> 00:22:33.620\nSo I created the v-net, the virtual\nnetwork, and the subnets at the same time.\n\n428\n00:22:33.620 --> 00:22:35.220\nThis command here,\nI just threw it in there for\n\n429\n00:22:35.220 --> 00:22:39.470\nyour benefit, this is add a gateway\nsubnet to an existing virtual network.\n\n430\n00:22:39.470 --> 00:22:41.650\nSo, if you already created\na virtual network and\n\n431\n00:22:41.650 --> 00:22:44.590\nyou didn't create a gateway subnet cuz you\ndidn't think you were going to connect it\n\n432\n00:22:44.590 --> 00:22:47.110\nwith site to site, and\nnow you're going to.\n\n433\n00:22:47.110 --> 00:22:52.500\nInstead of creating it, you would say add\nas your virtual network subnet config.\n\n434\n00:22:52.500 --> 00:22:56.666\nGateway subnet,\nprefix what network are you adding it to?\n\n435\n00:22:56.666 --> 00:22:57.630\nDollar sign, vnet, right?\n\n436\n00:22:57.630 --> 00:23:03.640\nDollar sign vnet was get\nas your RM virtual network.\n\n437\n00:23:03.640 --> 00:23:07.400\nAnd then set, that's the command set.\n\n438\n00:23:07.400 --> 00:23:09.510\nRM is your virtual network.\n\n439\n00:23:09.510 --> 00:23:12.010\nVNET so it pools all of that\ninformation and creates it.\n\n440\n00:23:12.010 --> 00:23:14.180\nI don't have to run that\nbecause I just did, but\n\n441\n00:23:14.180 --> 00:23:16.730\njust wanted to throw that in for\nyou just in case.\n\n442\n00:23:16.730 --> 00:23:17.620\n>> A little bonus script.\n\n443\n00:23:17.620 --> 00:23:19.240\n>> A little bonus script.\n\n444\n00:23:19.240 --> 00:23:22.640\nAll right, then I've got add\na local site with an existing,\n\n445\n00:23:22.640 --> 00:23:24.750\nwith a single ad direct prefix.\n\n446\n00:23:24.750 --> 00:23:27.820\nRemember I'm defined my virtual\nnetwork up there in Azure.\n\n447\n00:23:27.820 --> 00:23:31.970\nI still have to tell Azure about my\nlocal network, my on premises network.\n\n448\n00:23:31.970 --> 00:23:35.850\nAnd what IP ranges are being used,\njust like we did in the GUI.\n\n449\n00:23:35.850 --> 00:23:39.130\nI had to create the local\nnetwork reference, right?\n\n450\n00:23:39.130 --> 00:23:40.120\nSo that's what I'm doing here.\n\n451\n00:23:40.120 --> 00:23:41.940\nI'm telling it I'm giving it a name.\n\n452\n00:23:41.940 --> 00:23:43.950\nI just happened to call it gnvSite.\n\n453\n00:23:43.950 --> 00:23:48.070\nI'm gonna add it to the resource\ngroup recovery, west US.\n\n454\n00:23:48.070 --> 00:23:53.362\nAnd then the public IP address of my\nVPN server on my premises network,\n\n455\n00:23:53.362 --> 00:23:58.223\nand the address range that I'm\nusing on my on premises network.\n\n456\n00:23:58.223 --> 00:24:01.878\nNow if you had more than one\nsubnet on your on premises, and\n\n457\n00:24:01.878 --> 00:24:05.842\nyou needed to be able to route all\nof those from that Azure VNet.\n\n458\n00:24:05.842 --> 00:24:07.609\nYou would do more than one prefix.\n\n459\n00:24:07.609 --> 00:24:09.763\nAnd you can see the syntax\nis slightly different.\n\n460\n00:24:09.763 --> 00:24:12.600\nWith one prefix, you just list the prefix.\n\n461\n00:24:12.600 --> 00:24:16.410\nIf you have more than one prefix,\nyou create an array, you do an @( and\n\n462\n00:24:16.410 --> 00:24:21.930\nthen each one\n\n463\n00:24:21.930 --> 00:24:26.880\nof those subnets would get listed in here,\nseparated by a comma.\n\n464\n00:24:26.880 --> 00:24:30.230\nNotice there are single\nquotes around those guys.\n\n465\n00:24:30.230 --> 00:24:31.490\nIt will not work if you don't.\n\n466\n00:24:31.490 --> 00:24:35.290\nEven though that's not a string,\nwhen you create this array\n\n467\n00:24:35.290 --> 00:24:38.050\nyou do have to treat them like\nstrings within that array there.\n\n468\n00:24:38.050 --> 00:24:40.150\nAll right, now I'm just gonna add the one.\n\n469\n00:24:41.290 --> 00:24:43.233\nSo I'm gonna run this command right here.\n\n470\n00:24:47.455 --> 00:24:50.710\nAnd we'll get that guy going,\nshould take just a second.\n\n471\n00:24:50.710 --> 00:24:52.310\nSo I don't need to do this next command,\n\n472\n00:24:52.310 --> 00:24:55.400\nadd a local site with\nmultiple address prefixes.\n\n473\n00:24:55.400 --> 00:24:58.129\nAgain, that's bonus script\nlike Daniel was saying.\n\n474\n00:25:00.037 --> 00:25:02.050\nAll right, there we go, that succeeded.\n\n475\n00:25:02.050 --> 00:25:04.380\nNext, request a public IP address.\n\n476\n00:25:04.380 --> 00:25:09.670\nRemember, if I'm gonna make a gateway up\nthere on my Azure VNet to create the site,\n\n477\n00:25:09.670 --> 00:25:14.530\nI need a public IP address assigned to me,\nby Azure that i can use.\n\n478\n00:25:14.530 --> 00:25:15.930\nSo, that's this right here.\n\n479\n00:25:15.930 --> 00:25:20.150\nAnd I'm simply going to\nstore that in a variable.\n\n480\n00:25:20.150 --> 00:25:27.420\nSo, Gateway Public IP GWPIP equals\nnew dash Azure RN Public IP address.\n\n481\n00:25:27.420 --> 00:25:29.340\nThere's the name I decided to give it.\n\n482\n00:25:29.340 --> 00:25:32.220\nI'm going to put it in\nthe resource group recovery.\n\n483\n00:25:32.220 --> 00:25:35.760\nAllocation method is dynamic,\nremember what we did in the gooey?\n\n484\n00:25:35.760 --> 00:25:39.090\nYou can't do static if you're\ngoing to set up this site to site,\n\n485\n00:25:39.090 --> 00:25:41.130\nit has to be dynamic.\n\n486\n00:25:41.130 --> 00:25:42.990\nWe've talked about that before.\n\n487\n00:25:42.990 --> 00:25:45.016\nSo let me run that guy.\n\n488\n00:25:49.100 --> 00:25:50.660\nAll right.\n\n489\n00:25:50.660 --> 00:25:52.180\nLet that go for just a second.\n\n490\n00:25:52.180 --> 00:25:57.170\nAnd what that's gonna do is it's gonna\nget that public IP address assignment\n\n491\n00:25:57.170 --> 00:25:59.280\nas go stored in this variable.\n\n492\n00:25:59.280 --> 00:26:01.590\nAnd then I'm gonna, while that's running\nI'll go ahead and explain the next one.\n\n493\n00:26:01.590 --> 00:26:05.440\nI'm actually gonna use that variable\nright here in this next command.\n\n494\n00:26:08.690 --> 00:26:12.290\nWell there we go, we have created my\npublic or generated an IP address.\n\n495\n00:26:12.290 --> 00:26:14.040\nIt really didn't create the IP address yet\nright?\n\n496\n00:26:14.040 --> 00:26:15.440\nIt just generates the request for\n\n497\n00:26:15.440 --> 00:26:19.860\nthe one, now I've got to create\nthe gateway IP address configuration.\n\n498\n00:26:19.860 --> 00:26:26.920\nI've got to add the gateway to my\ngateway subnet On my virtual network.\n\n499\n00:26:26.920 --> 00:26:29.090\nSo I got a couple of things going on here.\n\n500\n00:26:29.090 --> 00:26:33.210\nFirst, I need information about\nthe virtual network that I'm adding\n\n501\n00:26:33.210 --> 00:26:33.930\nthe gateway to.\n\n502\n00:26:33.930 --> 00:26:37.095\nSo I've a variable that's\nstoring the results of,\n\n503\n00:26:37.095 --> 00:26:43.000\nGet-AzureRmVirtualNetwork, and telling it\nabout the name of that virtual network.\n\n504\n00:26:43.000 --> 00:26:45.485\nAnd then I've got another variable\nthat I'm creating here subnet,\n\n505\n00:26:45.485 --> 00:26:49.170\nGet-AzureRmVirtualNetwork subnet\nconfig name.\n\n506\n00:26:49.170 --> 00:26:53.030\nGatewaySubnet from\nthe virtual network Vnet.\n\n507\n00:26:53.030 --> 00:26:55.300\nWhich is the results of this one up here.\n\n508\n00:26:55.300 --> 00:26:56.970\nRight.\nSo you see I'm doing that.\n\n509\n00:26:56.970 --> 00:26:59.170\nYou're running a command,\nstoring a results in there.\n\n510\n00:26:59.170 --> 00:27:03.910\nAnd I just makes the next command that\nmuch easier to read and to write.\n\n511\n00:27:03.910 --> 00:27:07.070\nInstead of trying to write\none long command that has\n\n512\n00:27:07.070 --> 00:27:10.020\ndozens of parameters\nthat you have to provide.\n\n513\n00:27:10.020 --> 00:27:14.650\nThen, the last one is going to be\nthe actual creation of the gateway IP.\n\n514\n00:27:14.650 --> 00:27:17.550\nBut again,\nit's storing it in this variable.\n\n515\n00:27:17.550 --> 00:27:24.510\nLet's run this while I talk [COUGH]\nand that was a quick one.\n\n516\n00:27:24.510 --> 00:27:26.830\nI didn't even get to anything.\n\n517\n00:27:26.830 --> 00:27:28.420\n>> Fast.\n>> And now we're actually gonna create\n\n518\n00:27:28.420 --> 00:27:33.390\nthe gateway using all the information\nstored in these variables up here.\n\n519\n00:27:33.390 --> 00:27:36.880\nThere's the name of the gateway that\nI'm gonna create, the resource group,\n\n520\n00:27:36.880 --> 00:27:38.020\nthe location.\n\n521\n00:27:38.020 --> 00:27:41.370\nBut IP configurations,\nit's just pointing to this variable.\n\n522\n00:27:41.370 --> 00:27:43.019\nI don't have to type out all of this.\n\n523\n00:27:44.300 --> 00:27:46.310\nBecause that's all stored\nin this variable, so\n\n524\n00:27:46.310 --> 00:27:48.180\nI could just use that\nvariable right there.\n\n525\n00:27:48.180 --> 00:27:51.450\nGateway type VPN, VPN type is route based.\n\n526\n00:27:52.550 --> 00:27:54.230\nSo we'll execute that one.\n\n527\n00:27:54.230 --> 00:27:55.070\nNow, guess what?\n\n528\n00:27:56.400 --> 00:27:59.710\nRemember how long it took int he\ngooey to run this command when we\n\n529\n00:27:59.710 --> 00:28:00.640\ncreated the gateway?\n\n530\n00:28:01.870 --> 00:28:03.490\nYeah, it's no different in PowerShell.\n\n531\n00:28:03.490 --> 00:28:08.490\nI mean you're changing the way your\nrequesting to create that gateway, but\n\n532\n00:28:08.490 --> 00:28:12.390\nit's still Azure churning and\nburning and creating that gateway.\n\n533\n00:28:12.390 --> 00:28:15.190\nSo just because I'm using PowerShell,\nit's not gonna happen any faster.\n\n534\n00:28:15.190 --> 00:28:16.900\nIt's gonna take a good 30 minutes for\nthis to run.\n\n535\n00:28:16.900 --> 00:28:19.370\n>> Yeah.\nThe provisioning is no different just\n\n536\n00:28:19.370 --> 00:28:23.300\nbecause we're using a different interface\nwhich to interact with Azure itself.\n\n537\n00:28:23.300 --> 00:28:28.340\nSo once you hit this marker point,\nthis goal post, you're just gonna\n\n538\n00:28:28.340 --> 00:28:32.470\nhave to hit go and then start that part\nof the script and let it do its business.\n\n539\n00:28:32.470 --> 00:28:35.510\nOnce it's done it will be,\nnow I will tell you Mike,\n\n540\n00:28:35.510 --> 00:28:40.220\nI am sitting here watching you go through\nthis, this to me does seem to be a little\n\n541\n00:28:40.220 --> 00:28:46.190\nbit easier than you assume I don't want to\ndown play the graphics, gooies are great.\n\n542\n00:28:46.190 --> 00:28:49.220\nThey're wonderful, but\nthis seems to be very, very simple and\n\n543\n00:28:49.220 --> 00:28:53.820\nhighly repeatable which obviously is the\npurpose of scripting, but it's super easy.\n\n544\n00:28:53.820 --> 00:28:55.930\n>> I'm with you there and it's surprising.\n\n545\n00:28:55.930 --> 00:28:58.650\nAnd these are two guys who have been\ndoing this for quite some time.\n\n546\n00:28:58.650 --> 00:29:03.000\nAnd I've always been a big gooey guy,\nI like my mouse, I like to click.\n\n547\n00:29:03.000 --> 00:29:05.120\nBut I tell you, this actually,\n\n548\n00:29:05.120 --> 00:29:08.970\nto me, seemed easier to accomplish than\ngoing through the wizards and the GUI.\n\n549\n00:29:08.970 --> 00:29:09.660\n>> Straightforward.\n\n550\n00:29:09.660 --> 00:29:11.520\n>> Yes, and I think that's it.\n\n551\n00:29:11.520 --> 00:29:13.230\nThere no extra fluff around it.\n\n552\n00:29:13.230 --> 00:29:16.360\nThere's no sliding blades or\nanything like that.\n\n553\n00:29:16.360 --> 00:29:20.140\nYou're getting right down to it and\nyou're saying look, create a gateway,\n\n554\n00:29:20.140 --> 00:29:24.040\nname it this,\ngive it this IP address and go, right?\n\n555\n00:29:24.040 --> 00:29:26.710\nYou don't have to worry\nabout spinning Cheerios and\n\n556\n00:29:26.710 --> 00:29:28.430\nother things that are worrying you.\n\n557\n00:29:28.430 --> 00:29:31.660\n>> Yeah, and\nI would submit that you have to even know\n\n558\n00:29:31.660 --> 00:29:35.150\nAzure better\n>> So the Power Shell, because you gotta\n\n559\n00:29:35.150 --> 00:29:39.410\nknow every step that you gotta take and\nscript that out you can't rely, let me,\n\n560\n00:29:39.410 --> 00:29:42.160\nremember that visual cue that reminds\nme to do this, that and the other?\n\n561\n00:29:42.160 --> 00:29:45.110\nYou don't have that, you just have to\nremember each step that needs to be\n\n562\n00:29:45.110 --> 00:29:47.650\ndone in the order that\nit needs to be done.\n\n563\n00:29:47.650 --> 00:29:51.830\nSo in my estimation this is the better\nway also in the long run because\n\n564\n00:29:51.830 --> 00:29:55.410\nit makes you retain the information better\nso that you can do the scripting part.\n\n565\n00:29:55.410 --> 00:29:57.490\n>> Yes, absolutely, absolutely.\n\n566\n00:29:57.490 --> 00:29:58.690\nAnd heck, it's fun.\n\n567\n00:29:58.690 --> 00:29:59.470\n>> It is fun.\n\n568\n00:29:59.470 --> 00:30:02.110\n>> I have to say I enjoy using PowerShell.\n\n569\n00:30:02.110 --> 00:30:04.290\nSo yeah, we're gonna have to wait for\n30 minutes, Daniel, so\n\n570\n00:30:04.290 --> 00:30:05.940\nwhat do you want to do there?\n\n571\n00:30:05.940 --> 00:30:07.372\n>> Well I guess it depends on.\n\n572\n00:30:07.372 --> 00:30:09.657\n[LAUGH]\n>> We'll have to make a part two.\n\n573\n00:30:09.657 --> 00:30:10.800\n>> Well yeah, we can make a part two.\n\n574\n00:30:10.800 --> 00:30:11.570\nThat's perfect.\n\n575\n00:30:11.570 --> 00:30:13.210\nThat's a great place for us to stop.\n\n576\n00:30:13.210 --> 00:30:14.130\nThat's what we'll do.\n\n577\n00:30:14.130 --> 00:30:17.020\nThanks for showing us how to\nuse PowerShell to get this far,\n\n578\n00:30:17.020 --> 00:30:18.930\nand we'll see what you got lined up for\nthe next episode.\n\n579\n00:30:18.930 --> 00:30:20.070\nWe look forward to that.\n\n580\n00:30:20.070 --> 00:30:21.070\nThank you guys for watching.\n\n581\n00:30:21.070 --> 00:30:22.890\nWe'll hopefully see you in part two,\nas well.\n\n582\n00:30:22.890 --> 00:30:25.260\nSigning off for IT Pro TV I've\nbeen your host Daniel Lowry.\n\n583\n00:30:25.260 --> 00:30:25.950\n>> And I'm Mike Roderick.\n\n584\n00:30:25.950 --> 00:30:27.838\n>> We'll see you next time.\n\n585\n00:30:27.838 --> 00:30:34.350\n[MUSIC]\n\n",
          "vimeoId": "156015624"
        },
        {
          "description": "In this episode, Mike and Daniel continue demonstrating how to create a Site-to-Site VPN from on-premesis to Azure. They pick up by verifying the provisioning of the necessary resources through the Azure portal. Then they create and configure the VPN connection from their on-premesis domain controller; finally initializing the VPN connection and verifying connectivity.",
          "length": "1099",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-1-2-s2s_vpn_with_azure_powershell_pt2-021816-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-1-2-s2s_vpn_with_azure_powershell_pt2-021816-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-1-2-s2s_vpn_with_azure_powershell_pt2-021816-1-sm.jpg",
          "title": "Site-to-Site VPN with Azure PowerShell Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.054 --> 00:00:17.140\nAll right, greetings everyone and welcome\nto another exciting episode of ITProTV.\n\n3\n00:00:17.140 --> 00:00:19.630\nI'm your host, Daniel Lowrie,\nand today's episode?\n\n4\n00:00:19.630 --> 00:00:22.870\nWell, we are moving right along\nwith our AD and Azure series.\n\n5\n00:00:22.870 --> 00:00:27.950\nActually into a part two using Power Shell\nto actually create a site to site VPN,\n\n6\n00:00:27.950 --> 00:00:32.710\njoining us today, try to help finish up\nthat configuration well, you know him, Mr.\n\n7\n00:00:32.710 --> 00:00:33.530\nMike Roderick.\n\n8\n00:00:33.530 --> 00:00:34.760\nMike welcome back to the show sir.\n\n9\n00:00:34.760 --> 00:00:36.640\n>> Thank you very much and you are right.\n\n10\n00:00:36.640 --> 00:00:39.810\nLet's see where we got when we\nleft off the previous episode\n\n11\n00:00:39.810 --> 00:00:42.080\nWe have done the old\ncreate the gateway and\n\n12\n00:00:42.080 --> 00:00:46.050\nwe know after watching the previous\nepisode that that's a click and\n\n13\n00:00:46.050 --> 00:00:50.990\ngo make a sandwich type move, cuz it does\ntake about 30 minutes to provision that.\n\n14\n00:00:50.990 --> 00:00:54.380\nAnd it doesn't matter if we do that in\nthe classic portal, the new portal, or\n\n15\n00:00:54.380 --> 00:00:55.600\nthrough Power Shell right?\n\n16\n00:00:55.600 --> 00:00:59.840\nWe're just issuing the command to Azure,\nAzure still has to do it's thing.\n\n17\n00:00:59.840 --> 00:01:02.840\nAnd generate that gateway for us,\nso it does take about 30 minutes.\n\n18\n00:01:02.840 --> 00:01:05.310\nBut it has finished up so\nlet's take a look at my screen and\n\n19\n00:01:05.310 --> 00:01:07.650\nwe will see the results.\n\n20\n00:01:07.650 --> 00:01:11.090\nSo there my command is finished so\nI'm gonna scroll back up a little bit.\n\n21\n00:01:12.410 --> 00:01:15.203\nAnd where I issued the command, there's my\n\n22\n00:01:15.203 --> 00:01:20.320\nnew/azurermvirtualnetworkgateway where\nwe gave it that information.\n\n23\n00:01:20.320 --> 00:01:23.510\nAnd once it did complete here's\nthe information that it spit back,\n\n24\n00:01:23.510 --> 00:01:26.480\nthat we created our Gateway of a type VPN.\n\n25\n00:01:26.480 --> 00:01:28.690\nIt was route based,\nnot policy based, right?\n\n26\n00:01:28.690 --> 00:01:29.930\nThat is very important.\n\n27\n00:01:29.930 --> 00:01:34.790\nAnd it succeeded and\nI can see our private allocation methods.\n\n28\n00:01:34.790 --> 00:01:37.555\nWe got our subnet, what else do we need?\n\n29\n00:01:37.555 --> 00:01:40.325\nThere's a public IP address that it used.\n\n30\n00:01:40.325 --> 00:01:42.405\nWe used our Gateway IP config one.\n\n31\n00:01:43.585 --> 00:01:46.505\nAnd again, it's just churning through\nthose variables that we provided.\n\n32\n00:01:47.775 --> 00:01:51.255\nNothing too exciting down here.\n\n33\n00:01:51.255 --> 00:01:56.725\nYep so anyway, those are the rules to now\nwe need to verify that we have it, right?\n\n34\n00:01:56.725 --> 00:02:00.350\nSo let's take a look at the portal.\n\n35\n00:02:00.350 --> 00:02:02.060\nSo we go back up here to the portal.\n\n36\n00:02:02.060 --> 00:02:06.120\nHere is my recovery resource group that\nwe created in the previous episode.\n\n37\n00:02:08.630 --> 00:02:11.390\nAnd, we'll wait for\nthat to populate and resource wise,\n\n38\n00:02:11.390 --> 00:02:14.400\nthese are all the things we've\nbeen creating using power shell.\n\n39\n00:02:14.400 --> 00:02:17.160\nHere's my local site, my GNV site.\n\n40\n00:02:17.160 --> 00:02:22.130\nThere's my gateway public IP request,\nthere's my virtual net gateway one.\n\n41\n00:02:22.130 --> 00:02:25.910\nThat's what we just created,\nthere's the actual recovery VNets.\n\n42\n00:02:25.910 --> 00:02:26.870\nI'm gonna click on that.\n\n43\n00:02:26.870 --> 00:02:28.910\nThe virtual network gateway WAN.\n\n44\n00:02:28.910 --> 00:02:33.810\nOr VNet GW1 and there I can see the same\ninformation that was split back and that\n\n45\n00:02:33.810 --> 00:02:39.000\npower show results that it was VPN based\nroute based, name of the virtual network.\n\n46\n00:02:39.000 --> 00:02:43.300\nThere's my public IP address\nthat I would need later.\n\n47\n00:02:43.300 --> 00:02:45.650\nAnd as far as connections go.\n\n48\n00:02:45.650 --> 00:02:46.850\nWell, we don't have any yet right?\n\n49\n00:02:46.850 --> 00:02:49.130\nWe just created that gateway.\n\n50\n00:02:49.130 --> 00:02:53.430\nSo we're going to go back over to\nPowerShell to complete this process.\n\n51\n00:02:53.430 --> 00:02:57.090\nAgain, if you think back to the other\nepisodes where we did it in the GUI.\n\n52\n00:02:57.090 --> 00:02:59.340\nSame steps we have to go through.\n\n53\n00:02:59.340 --> 00:03:01.620\nWe're just doing it from PowerShell.\n\n54\n00:03:01.620 --> 00:03:02.270\nSo the next thing.\n\n55\n00:03:02.270 --> 00:03:04.040\nNow that we've got that gateway up there.\n\n56\n00:03:04.040 --> 00:03:05.980\nThis was the command we just ran.\n\n57\n00:03:05.980 --> 00:03:09.430\nAnd now we're gonna\nconfigure our VPN device.\n\n58\n00:03:09.430 --> 00:03:11.470\nSo I'm going to flip over\nto my virtual machine,\n\n59\n00:03:12.850 --> 00:03:15.450\nactually before I do that\nlet's rung this command here.\n\n60\n00:03:15.450 --> 00:03:20.760\nThis command Get-AzureRmPublicIpAddress,\nall right.\n\n61\n00:03:20.760 --> 00:03:25.680\nBecause in the outputs were\nwe created this VPN Right.\n\n62\n00:03:25.680 --> 00:03:29.700\nWe don't get to see the IP\naddress that got generated.\n\n63\n00:03:29.700 --> 00:03:34.120\nNow if I'm gonna go configure my VPN\nserver on my on premises network.\n\n64\n00:03:34.120 --> 00:03:36.880\nI need to know the IP address\non the other end of the tunnel.\n\n65\n00:03:36.880 --> 00:03:38.980\nRight?\nWe got to create that demand dial\n\n66\n00:03:38.980 --> 00:03:39.910\ninterface.\n\n67\n00:03:39.910 --> 00:03:41.930\nSo that's what this command is for.\n\n68\n00:03:41.930 --> 00:03:44.190\nIs hey,\nlet me know what the public IP address.\n\n69\n00:03:44.190 --> 00:03:46.140\nNow we peeked at the portal, but\n\n70\n00:03:46.140 --> 00:03:48.180\nthe idea is you might not\nbe using the portal at all.\n\n71\n00:03:48.180 --> 00:03:50.800\nYou might be doing everything\nthrough Powershell.\n\n72\n00:03:50.800 --> 00:03:52.860\nSo, how do I get that public IP address?\n\n73\n00:03:52.860 --> 00:03:54.240\nThat command right there.\n\n74\n00:03:54.240 --> 00:03:59.200\nI tell it what gateway or this is\nthe name, is the gateway public IP address\n\n75\n00:03:59.200 --> 00:04:03.220\nbecause I might have several IP addresses\nthat I had Azure generate for me.\n\n76\n00:04:03.220 --> 00:04:04.430\nWhich one am I trying to get?\n\n77\n00:04:04.430 --> 00:04:06.070\nGateway Public IP.\n\n78\n00:04:06.070 --> 00:04:07.740\nOut of what resource group?\n\n79\n00:04:07.740 --> 00:04:08.540\nRecovery.\n\n80\n00:04:08.540 --> 00:04:09.500\nSo we'll run that one.\n\n81\n00:04:12.079 --> 00:04:18.250\nAnd there is my, oops, there is\nthe public IP address that I need.\n\n82\n00:04:18.250 --> 00:04:22.965\nLet me just make a note of that real\nquick so I don't have to flip back.\n\n83\n00:04:22.965 --> 00:04:27.672\n40.112.213 To ten, all right now back\n\n84\n00:04:27.672 --> 00:04:32.500\nover to mister RTR01 on\nthe on premises network.\n\n85\n00:04:32.500 --> 00:04:36.820\nWe open up routing and road access and\nwe create a new demand dial interface.\n\n86\n00:04:36.820 --> 00:04:40.390\nSo new demand dial interface.\n\n87\n00:04:40.390 --> 00:04:43.210\nWe'll click next on our wizard.\n\n88\n00:04:43.210 --> 00:04:46.130\nAnd I'm gonna call this just recovery,\nso I can keep track.\n\n89\n00:04:46.130 --> 00:04:51.050\nRemember we still have that other\none going to, where was that one?\n\n90\n00:04:51.050 --> 00:04:52.750\nMaybe I got rid of that one.\n\n91\n00:04:52.750 --> 00:04:54.410\nWe got recovery, I'll click next.\n\n92\n00:04:56.410 --> 00:05:00.470\nNo, it doesn't all right,\nwe'll cancel that.\n\n93\n00:05:00.470 --> 00:05:02.450\nLet's just refresh this screen real quick.\n\n94\n00:05:03.660 --> 00:05:04.390\nThere is recovery.\n\n95\n00:05:06.170 --> 00:05:07.610\nAnd I'm pretty sure I\ndeleted that earlier.\n\n96\n00:05:07.610 --> 00:05:08.700\nWe're gonna delete that one more time.\n\n97\n00:05:11.650 --> 00:05:12.980\nThere we go.\n\n98\n00:05:12.980 --> 00:05:15.580\nAll right, so\nthis is that demand dial that went from\n\n99\n00:05:15.580 --> 00:05:19.728\nthe one that we set up using\nthe new portal from my on premises.\n\n100\n00:05:19.728 --> 00:05:21.710\nTo that 10.2 network.\n\n101\n00:05:21.710 --> 00:05:27.220\nNow we're gonna right click,\nnew demand-dial Interface.\n\n102\n00:05:27.220 --> 00:05:31.630\nI'll click next,\ncall it recovery, click next.\n\n103\n00:05:31.630 --> 00:05:34.270\nIt's gonna be a VPN connection.\n\n104\n00:05:35.360 --> 00:05:36.270\nWe're using IKEv2.\n\n105\n00:05:38.620 --> 00:05:42.110\nAnd for the IP address,\nthat's the public IP that Azure gave us.\n\n106\n00:05:42.110 --> 00:05:43.150\n112, 213, 210.\n\n107\n00:05:43.150 --> 00:05:44.200\nI'll click next.\n\n108\n00:05:44.200 --> 00:05:50.830\nWe don't need to route IP packets.\n\n109\n00:05:50.830 --> 00:05:52.310\nWe'll click next.\n\n110\n00:05:52.310 --> 00:05:54.520\nNot using credentials, next.\n\n111\n00:05:54.520 --> 00:05:55.350\nAnd, finish.\n\n112\n00:05:56.690 --> 00:05:59.420\nThen, remember, we've got to pull it back\nup, because we're not using credentials to\n\n113\n00:05:59.420 --> 00:06:02.890\nauthenticate this tunnel,\nwe're using Pre-Shared key.\n\n114\n00:06:02.890 --> 00:06:04.150\nSo I am going to go through my options.\n\n115\n00:06:04.150 --> 00:06:06.470\nI'm going to make this\na persistent connection and\n\n116\n00:06:06.470 --> 00:06:11.480\njump that up to three redial attempts,\nin case anything happens and it goes down.\n\n117\n00:06:11.480 --> 00:06:16.150\nSecurity wise, we're going to choose\npreshared key and I'll make up a key.\n\n118\n00:06:20.443 --> 00:06:26.250\nSomething Just need to remember\nthat ITPROTV 2016 demo.\n\n119\n00:06:26.250 --> 00:06:30.590\nAnd then, on networking I wanna\nadd IPV4 for our network then,\n\n120\n00:06:30.590 --> 00:06:33.220\nI'll click okay all right.\n\n121\n00:06:33.220 --> 00:06:38.588\nNow, remember with the classic portal,\nit generated the key force,\n\n122\n00:06:38.588 --> 00:06:39.850\nthe pre-shared key, right?\n\n123\n00:06:39.850 --> 00:06:43.110\nAnd we click manage key,\nwe copy that key down.\n\n124\n00:06:43.110 --> 00:06:46.050\nAnd put it in on our end of\nthe tunnel on our VPN server.\n\n125\n00:06:46.050 --> 00:06:49.410\nWith the the new portal,\nit didn't generate the key,\n\n126\n00:06:49.410 --> 00:06:50.520\nwe had to create our own.\n\n127\n00:06:50.520 --> 00:06:54.220\nAnd it's the same thing here\nusing Azure PowerShell.\n\n128\n00:06:54.220 --> 00:06:55.930\nIt doesn't generate the key for us.\n\n129\n00:06:55.930 --> 00:06:58.340\nWe're gonna key it in here on our end.\n\n130\n00:06:58.340 --> 00:07:01.400\nKey in the key, you like that, and\nthen we're go up there in Azure and\n\n131\n00:07:01.400 --> 00:07:04.050\nmake sure that it has the same key.\n\n132\n00:07:04.050 --> 00:07:06.700\nSo recovery is created,\nwe've set up our options,\n\n133\n00:07:06.700 --> 00:07:10.030\nit should show up now underneath IPB4,\nwe'll refresh that.\n\n134\n00:07:13.092 --> 00:07:14.380\nWait for it for a second.\n\n135\n00:07:15.820 --> 00:07:17.860\nWhy is it not showing up there?\n\n136\n00:07:17.860 --> 00:07:18.910\nLet's refresh that again.\n\n137\n00:07:22.550 --> 00:07:23.571\nIt's thinking about it.\n\n138\n00:07:23.571 --> 00:07:28.150\nThere it is, Disconnected IPv4, Refresh.\n\n139\n00:07:30.500 --> 00:07:32.260\nLet's refresh the whole darn console.\n\n140\n00:07:33.530 --> 00:07:34.220\nYou know what?\n\n141\n00:07:34.220 --> 00:07:35.260\nI'm so silly.\n\n142\n00:07:35.260 --> 00:07:36.670\nI need to add that interface, don't I?\n\n143\n00:07:36.670 --> 00:07:37.960\nIt's not gonna show up automatically.\n\n144\n00:07:37.960 --> 00:07:41.690\n[LAUGH] Right click, new interface,\nand there's recovery.\n\n145\n00:07:41.690 --> 00:07:44.590\nAnd we'll add it and we'll click okay.\n\n146\n00:07:44.590 --> 00:07:45.590\nAnd there we go.\n\n147\n00:07:45.590 --> 00:07:49.460\nRefresh all you want if you don't add\nthat interface it's not gonna show up,\n\n148\n00:07:49.460 --> 00:07:50.685\nso learn from my mistakes.\n\n149\n00:07:50.685 --> 00:07:52.040\n[LAUGH]\n>> Yeah, that's a fun one.\n\n150\n00:07:52.040 --> 00:07:55.870\nActually it's something that's probably\nhappened to you if you've ever tried to do\n\n151\n00:07:55.870 --> 00:07:58.420\nthis before or maybe if it's the first\ntime you're working with it.\n\n152\n00:07:58.420 --> 00:08:00.400\nYou might not know to do that and\nyou just think yeah.\n\n153\n00:08:00.400 --> 00:08:01.650\nThis should just show up.\n\n154\n00:08:01.650 --> 00:08:03.950\nCreated this to be there,\nbut if you don't add it in,\n\n155\n00:08:03.950 --> 00:08:06.140\nit's not gonna be actually visible.\n\n156\n00:08:06.140 --> 00:08:07.610\n>> Exactly.\nAll right, so\n\n157\n00:08:07.610 --> 00:08:09.120\nnow we've got that all set up.\n\n158\n00:08:09.120 --> 00:08:13.810\nSo we will flip back over to Azure, or\nI should say to Azure PowerShell, and\n\n159\n00:08:13.810 --> 00:08:14.740\nwe'll move on to our next step.\n\n160\n00:08:14.740 --> 00:08:17.570\nWe've already configured our VPN device.\n\n161\n00:08:17.570 --> 00:08:21.180\nSo the gateway's configured\nup there in my Azure network.\n\n162\n00:08:21.180 --> 00:08:24.640\nRVPN device is configured on\nour arm premises network.\n\n163\n00:08:24.640 --> 00:08:27.800\nWe now just need to connect the two,\nand that's what these next commands do.\n\n164\n00:08:27.800 --> 00:08:30.030\nI've got a variable called Gateway 1.\n\n165\n00:08:30.030 --> 00:08:37.380\nIt's gonna get AzureRMVirtualNetwork\nGateway VNET 1, the one we just created.\n\n166\n00:08:37.380 --> 00:08:38.570\nAnd stored in this gateway1.\n\n167\n00:08:38.570 --> 00:08:41.820\nAnd then it's gonna use\nthis variable called local.\n\n168\n00:08:41.820 --> 00:08:43.960\nAnd variables, of course,\nyou can name them whatever you want.\n\n169\n00:08:43.960 --> 00:08:48.810\nGet-AzureRmLocalNetworkGateway name\ngnvSite,\n\n170\n00:08:48.810 --> 00:08:54.490\nthat's the one we created earlier up\nhere when we created our local site.\n\n171\n00:08:54.490 --> 00:08:54.990\nRight?\n\n172\n00:08:56.240 --> 00:08:57.660\nResource group recovery.\n\n173\n00:08:57.660 --> 00:08:59.445\nAnd the next command would\nactually do the work.\n\n174\n00:08:59.445 --> 00:09:04.220\nNew-azurermvirtualnetworkgatewayconnect-\nion.\n\n175\n00:09:04.220 --> 00:09:06.030\nGive it a name for the connection itself.\n\n176\n00:09:06.030 --> 00:09:08.690\nTell what resource group we're\ngoing to be storing it in.\n\n177\n00:09:08.690 --> 00:09:13.590\nWhat location and then virtual network\ngateway we're using that variable that\n\n178\n00:09:13.590 --> 00:09:15.820\nwe just showed you defining it.\n\n179\n00:09:15.820 --> 00:09:18.380\nAnd then for the local network,\na variable as well.\n\n180\n00:09:18.380 --> 00:09:21.210\nAnd then connection type, IP sec.\n\n181\n00:09:21.210 --> 00:09:25.120\nAnd then shared key, and\nmake sure I type the same key in there.\n\n182\n00:09:25.120 --> 00:09:28.090\nNow this is where I've got whatever\nI typed in on the pre-shared\n\n183\n00:09:28.090 --> 00:09:30.590\nkey when I configured\nthe on-premises network.\n\n184\n00:09:30.590 --> 00:09:33.250\nThat's what I'm going to\nput in my script here.\n\n185\n00:09:33.250 --> 00:09:36.540\nSo whatever I typed in, and\nI believe that's the same thing.\n\n186\n00:09:36.540 --> 00:09:37.465\nSo we'll try that.\n\n187\n00:09:37.465 --> 00:09:39.890\nWe will run this command right here.\n\n188\n00:09:39.890 --> 00:09:41.990\nWell actually all three of these commands.\n\n189\n00:09:45.377 --> 00:09:46.260\nAll right?\n\n190\n00:09:46.260 --> 00:09:48.330\nAnd you see the first three\nI've already run and succeeded.\n\n191\n00:09:48.330 --> 00:09:51.730\nThe last one is now running,\nit's creating that connection.\n\n192\n00:09:53.670 --> 00:09:57.140\nSo we'll give it just a second to finish\nthat up and then we can go and check and\n\n193\n00:09:57.140 --> 00:09:58.990\nsee if I succeeded.\n\n194\n00:10:00.550 --> 00:10:01.530\nAnd then we've got a command.\n\n195\n00:10:01.530 --> 00:10:04.540\nI'll show you now to verify it,\nas well, from PowerShell,\n\n196\n00:10:04.540 --> 00:10:07.550\ncuz again, you might be doing\neverything through PowerShell.\n\n197\n00:10:10.341 --> 00:10:12.875\nAll right, so\nit's thinking about it, whirring and\n\n198\n00:10:12.875 --> 00:10:14.573\ngrinding there in the background.\n\n199\n00:10:16.935 --> 00:10:19.299\nGonna give it just a minute\nto generate that guy.\n\n200\n00:10:20.570 --> 00:10:22.870\nAnd again, down here is what\nI was talking about earlier.\n\n201\n00:10:22.870 --> 00:10:26.702\nYou can see it says running\nscript / selection.\n\n202\n00:10:26.702 --> 00:10:28.890\nCtrl+Break to stop.\n\n203\n00:10:28.890 --> 00:10:32.280\nSo lets me know that it is running,\nat least.\n\n204\n00:10:33.650 --> 00:10:37.050\nCuz I don't get the spinning cheerio or\nthe hourglass or any of that good stuff.\n\n205\n00:10:37.050 --> 00:10:39.213\n>> What's the break key on\nyour Mac keyboard, Mike?\n\n206\n00:10:39.213 --> 00:10:40.875\n[LAUGH]\n>> Yeah, it's called a hammer.\n\n207\n00:10:40.875 --> 00:10:42.055\n[LAUGH]\n>> It is broken.\n\n208\n00:10:42.055 --> 00:10:47.400\n[LAUGH] You know, I've run into that\nmore than once with the good old Mac,\n\n209\n00:10:47.400 --> 00:10:48.550\nnot having enough keys on it.\n\n210\n00:10:50.192 --> 00:10:52.690\nI need, I have to bring up the onscreen\n\n211\n00:10:52.690 --> 00:10:54.930\nkeyboard sometimes to\ntype some of that stuff.\n\n212\n00:10:54.930 --> 00:10:57.050\n>> Mac doesn't think you need that,\nApple says hey man,\n\n213\n00:10:57.050 --> 00:10:59.730\ndon't need that stinking break key,\nit's useless anyway.\n\n214\n00:10:59.730 --> 00:11:00.550\nWhy I tell you.\n\n215\n00:11:00.550 --> 00:11:05.070\n>> One of my favorite key that pause break\nkey is one that I used on a Windows key or\n\n216\n00:11:05.070 --> 00:11:06.610\nWindows keyboard quite often.\n\n217\n00:11:06.610 --> 00:11:07.670\nWhat was it?\n\n218\n00:11:07.670 --> 00:11:12.380\nI can't remember, that's been so\n\n219\n00:11:12.380 --> 00:11:15.150\nlong since I actually been\non the Windows machine.\n\n220\n00:11:15.150 --> 00:11:17.470\nTo get to my system properties,\nthere was a pause break key.\n\n221\n00:11:18.580 --> 00:11:19.830\nKeystroke combination.\n\n222\n00:11:19.830 --> 00:11:20.730\nAll right.\nThere we go.\n\n223\n00:11:20.730 --> 00:11:22.340\nIt has finished.\n\n224\n00:11:22.340 --> 00:11:27.080\nSo I can see all the information and\nthe main thing I'm looking for there.\n\n225\n00:11:27.080 --> 00:11:29.530\nIt does that every time to me.\n\n226\n00:11:29.530 --> 00:11:31.990\nIs the provisioning state.\n\n227\n00:11:31.990 --> 00:11:34.848\nThat's really what I'm looking for,\nsucceeded.\n\n228\n00:11:34.848 --> 00:11:38.760\nYou know, PowerShell if it didn't\nget a bunch of red text on there,\n\n229\n00:11:38.760 --> 00:11:41.050\nletting me know that something went wrong.\n\n230\n00:11:41.050 --> 00:11:44.430\nAnd I will say, PowerShell's pretty good\nabout telling you what went wrong and\n\n231\n00:11:44.430 --> 00:11:46.010\nyou have to read through the error.\n\n232\n00:11:46.010 --> 00:11:47.580\nSometimes it can be difficult but\n\n233\n00:11:47.580 --> 00:11:49.920\nthey usually do a good job of\ntelling you what exactly went wrong.\n\n234\n00:11:49.920 --> 00:11:54.710\nAll right at that point we\nshould be connected, right?\n\n235\n00:11:54.710 --> 00:11:55.290\nLet's check.\n\n236\n00:11:55.290 --> 00:11:58.490\nSo I'm going to flip back over\nhere to my local network.\n\n237\n00:11:58.490 --> 00:12:01.240\nAnd we're going to refresh\nthis screen real quick.\n\n238\n00:12:01.240 --> 00:12:04.190\nBut I can already see\nrecovery is connected.\n\n239\n00:12:04.190 --> 00:12:08.270\nI have to go down to general,\nI take a look at recovery.\n\n240\n00:12:08.270 --> 00:12:11.300\nAnd I can see some bytes have\nactually been sent back and forth.\n\n241\n00:12:11.300 --> 00:12:12.770\nI am showing connected there.\n\n242\n00:12:12.770 --> 00:12:15.140\nSo pretty good sign, right?\n\n243\n00:12:15.140 --> 00:12:16.590\nWe'll flip out to Azure.\n\n244\n00:12:18.330 --> 00:12:20.730\nWe can also verify here.\n\n245\n00:12:20.730 --> 00:12:25.750\nThere's my connection that\nsucceeded in provisioning.\n\n246\n00:12:25.750 --> 00:12:27.640\nClick on it,\ntake a look at its properties.\n\n247\n00:12:29.450 --> 00:12:31.370\nAnd it still says not connected.\n\n248\n00:12:31.370 --> 00:12:34.590\nSo it is\n>> We've seen that before though.\n\n249\n00:12:34.590 --> 00:12:37.700\nEvery time it's been,\nyou just gotta give it a little more time,\n\n250\n00:12:37.700 --> 00:12:38.950\nand then it'll show up.\n\n251\n00:12:38.950 --> 00:12:39.630\n>> Yep, exactly.\n\n252\n00:12:39.630 --> 00:12:42.920\nSo in fact, let's just close out all of\nthese blades that I've got going here.\n\n253\n00:12:44.020 --> 00:12:47.250\nWe'll just jump all the way back to\nthe beginning, close all that app,\n\n254\n00:12:47.250 --> 00:12:48.810\ngo back out to my dashboard.\n\n255\n00:12:48.810 --> 00:12:50.090\n>> New portal's a little blade happy.\n\n256\n00:12:50.090 --> 00:12:51.290\n>> It is a little blade happy.\n\n257\n00:12:51.290 --> 00:12:54.560\nYou can end up with quite a serious\nbread crumb trail up there.\n\n258\n00:12:54.560 --> 00:12:58.430\nSo I'm going to go to my resources.\n\n259\n00:12:58.430 --> 00:13:01.400\nOf course there's different ways\nyou can navigate around in here and\n\n260\n00:13:01.400 --> 00:13:03.690\nI'm just gonna find my gateway.\n\n261\n00:13:07.559 --> 00:13:11.310\nAll right, and there is my gateway,\nwe're gonna go to connections.\n\n262\n00:13:13.877 --> 00:13:16.286\nAnd still showing as not\nconnected on this end but\n\n263\n00:13:16.286 --> 00:13:19.224\nI imagine it's just like Daniel\nwas saying just a little bit\n\n264\n00:13:19.224 --> 00:13:23.120\nbehind because it's definitely\nshowing connected on my router.\n\n265\n00:13:23.120 --> 00:13:25.590\nSo most likely we are good to go.\n\n266\n00:13:27.020 --> 00:13:28.020\nWhat else?\n\n267\n00:13:28.020 --> 00:13:28.770\nIn fact, you know what?\n\n268\n00:13:28.770 --> 00:13:29.840\nLet's try.\nLet's see if\n\n269\n00:13:29.840 --> 00:13:31.650\nPowerShell's ahead of the game here.\n\n270\n00:13:31.650 --> 00:13:33.800\nCuz again, you might be doing\neverything through PowerShell and\n\n271\n00:13:33.800 --> 00:13:35.120\nnot using the GUI at all.\n\n272\n00:13:35.120 --> 00:13:37.770\nSo how would I verify that that\nconnection was established?\n\n273\n00:13:37.770 --> 00:13:42.820\nI'm just gonna run this command, Get\n-AzureRmVirtualNetworkGatewayConnection\n\n274\n00:13:42.820 --> 00:13:44.730\nwith a debug switch.\n\n275\n00:13:44.730 --> 00:13:47.140\nSo I'll run that command.\n\n276\n00:13:47.140 --> 00:13:47.960\nNow it's gonna ask me,\n\n277\n00:13:47.960 --> 00:13:52.340\nare you sure you wanna run this operation\ncuz I am doing some debug there.\n\n278\n00:13:52.340 --> 00:13:56.170\nI'll say yes to all otherwise it's\ngonna stop on every single response and\n\n279\n00:13:56.170 --> 00:13:58.030\nask me if I wanna continue\nwith that operation.\n\n280\n00:13:59.390 --> 00:14:01.590\nAnd then I'll scroll back through\nthe results here for you.\n\n281\n00:14:03.000 --> 00:14:04.110\nSlide that up a wee bit.\n\n282\n00:14:06.500 --> 00:14:08.310\nAnd as I scroll up, there we go.\n\n283\n00:14:08.310 --> 00:14:11.220\nSo there's my command and\nyou can see getting the virtual network\n\n284\n00:14:11.220 --> 00:14:14.750\ngateway connection command to begin\nthe processing of the parameter set.\n\n285\n00:14:14.750 --> 00:14:19.090\nAll parameter sets, so\nit goes through my account information.\n\n286\n00:14:20.820 --> 00:14:23.420\nWhat else exciting do\nwe get to see in here?\n\n287\n00:14:23.420 --> 00:14:27.090\nReally just a lot of info that\nsome of it might be useful,\n\n288\n00:14:27.090 --> 00:14:31.430\nsome of it might not be useful,\ndepending on what you're troubleshooting.\n\n289\n00:14:31.430 --> 00:14:37.060\nBut down here is what I'm really\ngetting at, ConnectionStatus.\n\n290\n00:14:37.060 --> 00:14:41.020\nGosh darn, every time I switch focus,\nwhere did we go?\n\n291\n00:14:41.020 --> 00:14:44.760\nThere we go,\nconnection status connected, right?\n\n292\n00:14:44.760 --> 00:14:49.700\nSo that verifies that I actually do have\nmy site to site connection is up between\n\n293\n00:14:49.700 --> 00:14:55.070\nmy on-premises router and\nthat network out there in Azure.\n\n294\n00:14:55.070 --> 00:14:55.910\nWe're up and running.\n\n295\n00:14:55.910 --> 00:14:59.640\n>> Mike I gotta be honest with you,\nyou're really selling me on Azure.\n\n296\n00:14:59.640 --> 00:15:01.558\nUsing the Azure Power Shell.\n\n297\n00:15:01.558 --> 00:15:03.651\n[LAUGH] It's faster,\nit works better, it's more efficient.\n\n298\n00:15:03.651 --> 00:15:04.990\n[LAUGH] It's easier to work with.\n\n299\n00:15:04.990 --> 00:15:06.290\n>> It is.\n>> More straight forward.\n\n300\n00:15:06.290 --> 00:15:09.180\n>> Yeah, you know the GUI is still waiting\nto tell me whether I'm connected or not,\n\n301\n00:15:09.180 --> 00:15:10.745\nthe power cell,\nyou're connected you're good.\n\n302\n00:15:10.745 --> 00:15:12.470\n[LAUGH] And it did it in seconds, right?\n\n303\n00:15:12.470 --> 00:15:13.410\n>> Yeah.\n>> So,\n\n304\n00:15:13.410 --> 00:15:16.120\nit is a pretty impressive\nway to do things.\n\n305\n00:15:16.120 --> 00:15:18.550\nAnd that my friends is really she wrote.\n\n306\n00:15:18.550 --> 00:15:21.830\nWe went though the entire process,\nand we'll just refresh this,\n\n307\n00:15:21.830 --> 00:15:26.580\nwe'll give it\n>> The GUI one more chance to catch up.\n\n308\n00:15:26.580 --> 00:15:29.190\nIt did say connected there, didn't it?\n\n309\n00:15:29.190 --> 00:15:30.490\nConnected and connected.\n\n310\n00:15:30.490 --> 00:15:32.940\nSo finally the GUI caught\nup with PowerShell.\n\n311\n00:15:32.940 --> 00:15:35.125\n>> Well welcome to the show, GUI.\n\n312\n00:15:35.125 --> 00:15:37.100\n>> [LAUGH]\n>> Well, awesome, Mike.\n\n313\n00:15:37.100 --> 00:15:40.580\nIs there anything else that we need to do,\nor is this basically it?\n\n314\n00:15:40.580 --> 00:15:41.650\nWe've got a connection.\n\n315\n00:15:41.650 --> 00:15:43.410\nEverything's working as it should.\n\n316\n00:15:43.410 --> 00:15:45.950\nAnd we can off rough the races.\n\n317\n00:15:45.950 --> 00:15:49.290\n>> Yeah our next step would be to\nactually create our virtual machine.\n\n318\n00:15:49.290 --> 00:15:52.000\nSet up our VM,\nadd that second data drive, and\n\n319\n00:15:52.000 --> 00:15:54.320\ninstall active directory, get it going.\n\n320\n00:15:54.320 --> 00:15:57.030\nWe can do that with Power Shell as well.\n\n321\n00:15:57.030 --> 00:15:58.210\nWhich I think we should do.\n\n322\n00:15:58.210 --> 00:15:59.530\n>> I think definitely we should do.\n\n323\n00:15:59.530 --> 00:16:01.350\nThat would be an excellent show.\n\n324\n00:16:01.350 --> 00:16:02.760\nLearning every which way.\n\n325\n00:16:02.760 --> 00:16:04.760\nI love having options, right?\n\n326\n00:16:04.760 --> 00:16:06.250\nIf I want to use the new portal.\n\n327\n00:16:06.250 --> 00:16:08.520\nI can use the new portal if I'm\ncomfortable with that it's fine.\n\n328\n00:16:08.520 --> 00:16:10.470\nLike the classic portal I know Mike does.\n\n329\n00:16:10.470 --> 00:16:12.540\nJump in there, use that, it's fine.\n\n330\n00:16:12.540 --> 00:16:15.500\nIf I like Azure,\nI'm obviously now a huge fan.\n\n331\n00:16:15.500 --> 00:16:16.810\nI can't wait to see what else we can do.\n\n332\n00:16:16.810 --> 00:16:18.450\nHow we can make that happen?\n\n333\n00:16:18.450 --> 00:16:21.390\nI'm gonna use that having options\nis the best thing for us.\n\n334\n00:16:21.390 --> 00:16:23.310\nAnd they've given us\nthree really good ones.\n\n335\n00:16:23.310 --> 00:16:25.190\nPick the one you like and run with it.\n\n336\n00:16:25.190 --> 00:16:26.480\nSo Mike, I look forward to those shows.\n\n337\n00:16:26.480 --> 00:16:28.386\nI think you've probably got\na little extra something.\n\n338\n00:16:28.386 --> 00:16:29.450\n>> Yeah.\nThere's one more thing\n\n339\n00:16:29.450 --> 00:16:32.120\nI want to say about the script\nitself that we were writing.\n\n340\n00:16:32.120 --> 00:16:36.400\nIt looked a little bit complex,\nbecause I had broken out each command,\n\n341\n00:16:36.400 --> 00:16:39.180\ncommented it up so we would know\nexactly what we were doing and\n\n342\n00:16:39.180 --> 00:16:41.190\nI could run those commands one at a time.\n\n343\n00:16:41.190 --> 00:16:45.710\nAnd I was defining variables\nalong with the commands.\n\n344\n00:16:45.710 --> 00:16:48.420\nWhat you'll find,\nwhen you start writing these scripts,\n\n345\n00:16:48.420 --> 00:16:51.930\nreally the best way to do it is at\nthe beginning of the script you've got a,\n\n346\n00:16:51.930 --> 00:16:55.340\nyou create a block of\nvariable assignments, right?\n\n347\n00:16:55.340 --> 00:16:58.660\nAnd you just go through and\nyou assign names and IP addresses.\n\n348\n00:16:58.660 --> 00:17:01.270\nOr whatever it is those\nvariables are going to store.\n\n349\n00:17:01.270 --> 00:17:04.960\nAnd then down below, you've got all your\ncode that executes the actual scripts.\n\n350\n00:17:04.960 --> 00:17:06.750\nBecause, that way, let's say tomorrow,\n\n351\n00:17:06.750 --> 00:17:10.940\nI need to set up another site to\nsite to a different branch office.\n\n352\n00:17:10.940 --> 00:17:12.300\nWhere I can just take that script and\n\n353\n00:17:12.300 --> 00:17:14.530\nwrite at the top of\nthe scripts all my variables.\n\n354\n00:17:14.530 --> 00:17:16.640\nAnd I just change branch\none to branch two.\n\n355\n00:17:16.640 --> 00:17:17.170\nRight.\n\n356\n00:17:17.170 --> 00:17:21.390\nChange the name of my connection\nfrom gateway one to gateway two or\n\n357\n00:17:21.390 --> 00:17:22.020\nwhatever it is.\n\n358\n00:17:22.020 --> 00:17:22.834\nYou see what I'm saying?\n\n359\n00:17:22.834 --> 00:17:26.385\nYou just update those variables and\nrun that script again and you're done.\n\n360\n00:17:26.385 --> 00:17:29.335\nWhere you have them scattered throughout\nyour script like I've got now\n\n361\n00:17:29.335 --> 00:17:31.895\nit can be easy to miss one or\ntwo variables.\n\n362\n00:17:31.895 --> 00:17:34.735\nYou don't change it like you should, and\nthen what happens is you end up with\n\n363\n00:17:34.735 --> 00:17:38.325\na duplicate name error or something gets\nput in the wrong resource group, you know?\n\n364\n00:17:38.325 --> 00:17:39.035\nOr something like that.\n\n365\n00:17:39.035 --> 00:17:42.215\nSo, if I was writing these scripts for\na production environment and\n\n366\n00:17:42.215 --> 00:17:46.900\nnot to demo I would probably segregate\nout a lot of the variable smart,\n\n367\n00:17:46.900 --> 00:17:50.820\nit's just a wise way to create\nyour scripts to make it easy for\n\n368\n00:17:50.820 --> 00:17:53.050\nyourself down the road\nto reuse those scripts.\n\n369\n00:17:53.050 --> 00:17:55.510\nAnd we call that portability or\nreusability.\n\n370\n00:17:55.510 --> 00:17:56.460\nIt's good stuff.\n\n371\n00:17:56.460 --> 00:17:59.490\nGood tips, Mike, and we look forward\nto seeing your upcoming shows and\n\n372\n00:17:59.490 --> 00:18:02.340\nwhat else we can use with\nthe Azure PowerShell.\n\n373\n00:18:02.340 --> 00:18:04.270\nThat being said,\nthanks again for joining us.\n\n374\n00:18:04.270 --> 00:18:07.326\nThank you guys for watching, we're gonna\ngo ahead and sign off for ITProTV.\n\n375\n00:18:07.326 --> 00:18:08.627\nI've been your host Daniel Lowrie.\n\n376\n00:18:08.627 --> 00:18:09.568\n>> And I'm Mike Rodrick.\n\n377\n00:18:09.568 --> 00:18:11.716\n>> And we'll see you next time.\n\n378\n00:18:11.716 --> 00:18:19.489\n[MUSIC]\n\n",
          "vimeoId": "156015674"
        },
        {
          "description": "In this episode, Mike and Daniel show you how to use the PowerShell to create a Virtual Machine in Azure. They begin by connecting to Azure using the PowerShell, after which they create a storage account and availability set. Then they create the VM and show you how this can be done with a script. They then modify that script to create another VM.",
          "length": "1507",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-2-create_vpn_with_azure_powershell-022316-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-2-create_vpn_with_azure_powershell-022316-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-adinazure/techskills-adinazure-5-2-create_vpn_with_azure_powershell-022316-1-sm.jpg",
          "title": "Create a VM with Azure PowerShell",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.111 --> 00:00:17.340\nAll right, greetings everyone and welcome\nto another great episode of ITProTV.\n\n3\n00:00:17.340 --> 00:00:19.460\nI'm your host Daniel Lowrie and\nin today's episode,\n\n4\n00:00:19.460 --> 00:00:23.500\nwell, we are continuing on with\nour series on AD in Azure.\n\n5\n00:00:23.500 --> 00:00:27.600\nJoining us back in the studio today is\nour friend that's been guiding us, Mr.\n\n6\n00:00:27.600 --> 00:00:28.120\nMike Rodrick.\n\n7\n00:00:28.120 --> 00:00:29.190\nMike, welcome back to the show, sir.\n\n8\n00:00:29.190 --> 00:00:30.100\n>> Thank you very much.\n\n9\n00:00:30.100 --> 00:00:33.810\nThat's right, today we are gonna see\nhow we can roll out a virtual machine\n\n10\n00:00:33.810 --> 00:00:34.830\nusing PowerShell, right?\n\n11\n00:00:34.830 --> 00:00:38.480\nOr I should, more correctly,\nsay Azure PowerShell.\n\n12\n00:00:38.480 --> 00:00:40.630\nWe've already used it to\ndo a lot of the work.\n\n13\n00:00:40.630 --> 00:00:44.640\nWe've created a virtual\nnetwork up there in Azure.\n\n14\n00:00:44.640 --> 00:00:49.160\nWe created the gateway, we set up the site\nto site VPN, all through PowerShell.\n\n15\n00:00:49.160 --> 00:00:52.970\nNow that we've got all that set up,\nthe next logical step then is to start\n\n16\n00:00:52.970 --> 00:00:56.520\nrolling out some VMS, and we want to\nuse PowerShell to do that as well.\n\n17\n00:00:56.520 --> 00:00:59.179\nWe've already shown you we can\ndo it using the classic portal,\n\n18\n00:00:59.179 --> 00:01:01.420\nwe can do it using the new portal.\n\n19\n00:01:01.420 --> 00:01:05.210\nBut if I want to start automating this,\nif it's something that I'm gonna be doing\n\n20\n00:01:05.210 --> 00:01:08.890\noften, having that PowerShell script\navailable is definitely the way to go.\n\n21\n00:01:08.890 --> 00:01:13.360\nSo let's take a look at what we're\ngonna need to do to get this done.\n\n22\n00:01:13.360 --> 00:01:15.340\nLet's take a look at my screen here, and\n\n23\n00:01:15.340 --> 00:01:17.330\nthe first thing that we're gonna\nhave to do is authenticate.\n\n24\n00:01:17.330 --> 00:01:21.580\nLike we did before when we created our\nvirtual network, I need to log into Azure,\n\n25\n00:01:21.580 --> 00:01:26.340\nso that my PowerShell session knows\nwhere to connect up to Azure.\n\n26\n00:01:26.340 --> 00:01:34.160\nAnd this command is simply\nLogin-AzureRmAccount, and I'll hit Enter.\n\n27\n00:01:34.160 --> 00:01:36.585\nAnd that should prompt me\nwith a little dialogue box.\n\n28\n00:01:36.585 --> 00:01:38.338\nActually, here I am working in the ISE,\n\n29\n00:01:38.338 --> 00:01:41.430\nI keeping thinking that I'm\nin the actual PowerShell.\n\n30\n00:01:41.430 --> 00:01:44.010\nSo let me run that,\nthat will actually make it go.\n\n31\n00:01:45.030 --> 00:01:49.740\nRun that and that is going to\ngenerate my authentication dialog box\n\n32\n00:01:49.740 --> 00:01:53.740\nwhere I'll type in the appropriate account\ninformation so that I can authenticate.\n\n33\n00:01:53.740 --> 00:02:00.511\nIf I can remember my user name and\nmy password.\n\n34\n00:02:00.511 --> 00:02:06.350\nWe'll drop down there, enter in my\npassword, and we should be good to go.\n\n35\n00:02:06.350 --> 00:02:09.040\nThat window usually flash\na couple of times and\n\n36\n00:02:09.040 --> 00:02:12.910\nthen you'll get a little message showing\nyou that you are indeed connected.\n\n37\n00:02:12.910 --> 00:02:16.790\nIt's got my Tenant Id and\nmy Subscription Id in there.\n\n38\n00:02:16.790 --> 00:02:18.440\nSo now I'm connected to Azure and\n\n39\n00:02:18.440 --> 00:02:21.720\nI can start firing off commands\nagainst my Azure subscription.\n\n40\n00:02:22.870 --> 00:02:23.770\nSo the next thing we need to do,\n\n41\n00:02:23.770 --> 00:02:28.470\nif we're gonna create VMS, we're gonna\nneed a storage account to store that.\n\n42\n00:02:28.470 --> 00:02:32.810\nRemember we created a resource\ngroup in that new portal and\n\n43\n00:02:32.810 --> 00:02:34.640\nwe did it through PowerShell.\n\n44\n00:02:34.640 --> 00:02:37.470\nAnd that resource group contains\nall my different resources,\n\n45\n00:02:37.470 --> 00:02:41.030\nlike my virtual network,\nmy Virtual Network Gateway.\n\n46\n00:02:41.030 --> 00:02:46.830\nThe public IP address for that, the local\nnetwork that I let it know that we have.\n\n47\n00:02:46.830 --> 00:02:48.530\nAll that goes in that resource group.\n\n48\n00:02:48.530 --> 00:02:52.350\nBut when we create virtual machines,\nwe start creating virtual hard drives.\n\n49\n00:02:52.350 --> 00:02:55.050\nAnd those still need to\ngo in a storage account.\n\n50\n00:02:55.050 --> 00:02:57.500\nRemember I showed you when\nwe were in that new portal,\n\n51\n00:02:57.500 --> 00:03:00.280\nwe had storage accounts classic,\nand then we had storage accounts.\n\n52\n00:03:00.280 --> 00:03:03.240\nSo there's a difference between\nthe old ones and the new ones.\n\n53\n00:03:03.240 --> 00:03:04.850\nSo we're gonna go ahead and create one.\n\n54\n00:03:04.850 --> 00:03:08.810\nThe other thing we've talked about before\nis the fact that that storage account name\n\n55\n00:03:08.810 --> 00:03:09.980\nhas to be unique.\n\n56\n00:03:09.980 --> 00:03:12.840\nBut Microsoft gives us\nthe ability to test.\n\n57\n00:03:12.840 --> 00:03:14.230\nCuz if we're in the GUI,\n\n58\n00:03:14.230 --> 00:03:17.610\nif we're at the new portal,\nwe type in a name in that field.\n\n59\n00:03:17.610 --> 00:03:21.072\nThere's a little green check mark\nthat'll light up if that name is unique.\n\n60\n00:03:21.072 --> 00:03:23.760\nOtherwise it'll throw and exclamation\npoint over there and it'll tell us hey,\n\n61\n00:03:23.760 --> 00:03:25.650\nthat name's not unique, try again.\n\n62\n00:03:25.650 --> 00:03:29.590\nWell if I'm in PowerShell and I write\nthis big old long script and I run it,\n\n63\n00:03:29.590 --> 00:03:33.780\nI don't want it to fail on the third line\nwhen I'm naming that storage account or\n\n64\n00:03:33.780 --> 00:03:34.382\nsomething like that.\n\n65\n00:03:34.382 --> 00:03:37.990\nSo it's important that we test to\nmake sure that the name is available.\n\n66\n00:03:37.990 --> 00:03:42.410\nAnd I'll get to show you, we've seen so\nfar I've had all of my commands typed out.\n\n67\n00:03:42.410 --> 00:03:46.550\nAnd that's just because I don't want you\nguys watching me type, it's kinda painful.\n\n68\n00:03:46.550 --> 00:03:50.760\nBut I did want to take a minute to show\nyou how easy it is to work with Azure\n\n69\n00:03:50.760 --> 00:03:54.100\nthrough PowerShell once you've done what\nwe did in that previous episode where\n\n70\n00:03:54.100 --> 00:03:57.860\nwe downloaded all those modules,\nmade those commands available.\n\n71\n00:03:57.860 --> 00:04:00.810\nOnce we do that, the commands,\nlike when you go in the ISE,\n\n72\n00:04:00.810 --> 00:04:04.480\nit's gonna do the same thing it's always\ndone with our normal server commands.\n\n73\n00:04:04.480 --> 00:04:07.690\nIt's gonna do the tab auto-fill,\nit's gonna give us those drop down\n\n74\n00:04:07.690 --> 00:04:10.030\nlists where it shows us\nall the possible commands.\n\n75\n00:04:10.030 --> 00:04:11.770\nAll the help commands are there,\n\n76\n00:04:11.770 --> 00:04:14.850\neverything we need to work with\nAzure right here through PowerShell.\n\n77\n00:04:14.850 --> 00:04:17.580\nSo let's try it out,\nwe're gonna do a test-, and\n\n78\n00:04:17.580 --> 00:04:22.270\nyou can see right there, it starts pulling\nup the appropriate Azure commands.\n\n79\n00:04:22.270 --> 00:04:27.789\nAnd as I type it'll filter them down and\nwe want AzureName.\n\n80\n00:04:27.789 --> 00:04:30.898\nSo there we go and\nI'll just hit tab to fill that in.\n\n81\n00:04:30.898 --> 00:04:33.217\nAnd I have to tell it\nwhat I'm checking and\n\n82\n00:04:33.217 --> 00:04:36.540\nas I hit that dash you'll see\nall the possibilities there.\n\n83\n00:04:36.540 --> 00:04:40.280\nI want service, right,\nso I'm checking to see.\n\n84\n00:04:40.280 --> 00:04:42.656\nI'm sorry not service,\nwe're doing storage.\n\n85\n00:04:42.656 --> 00:04:48.420\nAll right, I wanna see if this name is\navailable for a new storage account and\n\n86\n00:04:48.420 --> 00:04:53.540\nthe name I wanna go with is gonna\nbe \"recoversa\" for storage account.\n\n87\n00:04:53.540 --> 00:04:56.800\nPut that in quotes because it's\na string and then I'll go ahead and\n\n88\n00:04:56.800 --> 00:04:57.800\nexecute that line.\n\n89\n00:05:00.550 --> 00:05:05.020\nAnd remember if we get false that means\nthe name is not currently in use.\n\n90\n00:05:05.020 --> 00:05:08.110\nIt was not found,\ntherefore I can use that name.\n\n91\n00:05:08.110 --> 00:05:09.900\nSo I know that name is unique.\n\n92\n00:05:10.900 --> 00:05:15.184\nAll right, now we're gonna\ncreate the storage account,\n\n93\n00:05:15.184 --> 00:05:19.041\nand this is gonna be\nNew-AzureRm storage account.\n\n94\n00:05:19.041 --> 00:05:24.553\nAnd let me try that again, a few less\nletters should help me, there we go.\n\n95\n00:05:24.553 --> 00:05:28.980\nNew-AzureRmStorageAccount and -Name.\n\n96\n00:05:28.980 --> 00:05:30.830\nNow, here's another really cool thing.\n\n97\n00:05:30.830 --> 00:05:35.098\nOnce you've downloaded those modules\nit starts helping you type cuz what if\n\n98\n00:05:35.098 --> 00:05:39.846\nyou don't know all the parameters\nassociated with New-AzureRmStorageAccount?\n\n99\n00:05:39.846 --> 00:05:42.100\nWell, you should go do your research,\nreally.\n\n100\n00:05:42.100 --> 00:05:46.700\nYou should pull up TechNet or MSDN and\ntake a look at the commandlets and\n\n101\n00:05:46.700 --> 00:05:48.500\nsee what the different parameters are.\n\n102\n00:05:48.500 --> 00:05:50.850\nBut notice that the ISE\ntries to help me out.\n\n103\n00:05:50.850 --> 00:05:55.350\nSoon as I hit that dash, it says well\nthese are all the possible parameters\n\n104\n00:05:55.350 --> 00:05:58.440\nthat you can use with\nthis particular command.\n\n105\n00:05:58.440 --> 00:06:02.770\nWhat it doesn't tell me is which ones are\nrequired and which ones aren't required.\n\n106\n00:06:02.770 --> 00:06:04.820\nSome of them you have\nto provide in order for\n\n107\n00:06:04.820 --> 00:06:07.630\nthe command to succeed,\nothers are optional.\n\n108\n00:06:07.630 --> 00:06:10.350\nThat's where your research\nis gonna come in,\n\n109\n00:06:10.350 --> 00:06:14.085\nknowing which ones you have to provide,\nor you can simply do a trial and error.\n\n110\n00:06:14.085 --> 00:06:16.175\n[LAUGH] Run it and see if it works, right?\n\n111\n00:06:16.175 --> 00:06:18.860\n>> [LAUGH] Yeah,\nthat's always a fun way to do it.\n\n112\n00:06:18.860 --> 00:06:21.780\nLet's just throw darts at a board,\nsee which one's actually gonna work.\n\n113\n00:06:21.780 --> 00:06:25.740\nLike Mike said, this is more of a help\nthan it is a, let me do that for you,\n\n114\n00:06:25.740 --> 00:06:26.780\nmaster.\n\n115\n00:06:26.780 --> 00:06:29.650\nSo you do have to be familiar\nwith it cuz lot of times,\n\n116\n00:06:29.650 --> 00:06:32.650\nyou should see, there's quite\na laundry list of them there actually,\n\n117\n00:06:32.650 --> 00:06:35.550\nthat Mike had pulled up\nas he started to type.\n\n118\n00:06:35.550 --> 00:06:39.680\nYou have to know which one it is you need,\nbut I do this with Cisco.\n\n119\n00:06:39.680 --> 00:06:43.540\nCisco's really helpful in allowing you to\ngive you a list of what you might need.\n\n120\n00:06:43.540 --> 00:06:46.510\nI don't have to know it all, but\nI gotta be familiar with it so\n\n121\n00:06:46.510 --> 00:06:48.320\nthat I can pick the right\none when I need it.\n\n122\n00:06:48.320 --> 00:06:50.830\n>> Exactly, so\nwe'll start with the resource group names.\n\n123\n00:06:50.830 --> 00:06:54.650\nI get to tell it what resource group\nis gonna store this storage account, or\n\n124\n00:06:54.650 --> 00:06:56.490\nwhat it's gonna be associated with.\n\n125\n00:06:56.490 --> 00:06:58.680\nWe have one called recovery.\n\n126\n00:06:58.680 --> 00:07:02.427\nWe'll go ahead, and\nthen I'll do another dash, and you notice\n\n127\n00:07:02.427 --> 00:07:06.830\nResourceGroupName now disappears\nfrom my list of possible parameters.\n\n128\n00:07:06.830 --> 00:07:09.440\nCuz I've already provided it so\nthere's no reason for it to show it again.\n\n129\n00:07:09.440 --> 00:07:12.990\nYou can't, well, you shouldn't use\nthat same parameter twice, right?\n\n130\n00:07:12.990 --> 00:07:15.510\nThat would make my command fail.\n\n131\n00:07:15.510 --> 00:07:18.440\nAnd I will tell you that it's\nnot sorted alphabetically.\n\n132\n00:07:18.440 --> 00:07:21.200\nAnd you might think,\nwell that's odd, why isn't it?\n\n133\n00:07:21.200 --> 00:07:24.020\nAnd honestly, the required ones\nare right here at the top.\n\n134\n00:07:24.020 --> 00:07:25.440\nNow, that's no guarantee.\n\n135\n00:07:25.440 --> 00:07:29.000\nAgain, you really should do your\nresearch on these commands.\n\n136\n00:07:29.000 --> 00:07:32.840\nBut Name, Type, Location,\nI have to provide those in order for\n\n137\n00:07:32.840 --> 00:07:34.322\nthis command to succeed.\n\n138\n00:07:34.322 --> 00:07:39.360\nTags and below, those are all optional\nparameters that I can provide.\n\n139\n00:07:39.360 --> 00:07:45.732\nSo let's give this guy a name, we're\ngonna call it something like recoversa.\n\n140\n00:07:45.732 --> 00:07:49.030\nAnd then we're gonna\nalso have to do a -Type,\n\n141\n00:07:49.030 --> 00:07:53.691\nand this is where it's really nice\nto have this ISE environment.\n\n142\n00:07:53.691 --> 00:07:55.309\nBecause we talk about types,\n\n143\n00:07:55.309 --> 00:07:58.867\nin the GUI we've got those pretty\nlittle pictures that said hey,\n\n144\n00:07:58.867 --> 00:08:03.541\nhere's a D1, and here's a D3, or whatever\nthe different storage accounts were.\n\n145\n00:08:03.541 --> 00:08:07.374\nHere's a locally redundant,\nhere's Geolocated redundant.\n\n146\n00:08:07.374 --> 00:08:13.140\nHere's read only georedundant, or\nread access georedundant, right?\n\n147\n00:08:13.140 --> 00:08:14.980\nWe had nice little things\nwe could click on.\n\n148\n00:08:14.980 --> 00:08:16.160\nWhen here I don't.\n\n149\n00:08:16.160 --> 00:08:18.320\nAnd heck,\nI don't know what they call them, right.\n\n150\n00:08:18.320 --> 00:08:20.970\nWhat are the actual names of them\nwhen you're writing your code?\n\n151\n00:08:20.970 --> 00:08:21.590\nWell, I know now.\n\n152\n00:08:21.590 --> 00:08:22.890\nThey're right there in my list, right?\n\n153\n00:08:22.890 --> 00:08:25.910\nSo it's just a matter of doing\na little bit of research again,\n\n154\n00:08:25.910 --> 00:08:29.020\nand knowing what standard dash LRS is.\n\n155\n00:08:29.020 --> 00:08:30.110\nI'll help you guys out.\n\n156\n00:08:30.110 --> 00:08:32.110\nThat's local redundant storage.\n\n157\n00:08:32.110 --> 00:08:35.420\nGRS is georedundant storage.\n\n158\n00:08:35.420 --> 00:08:38.750\nRAGRS is read access georedundant storage.\n\n159\n00:08:38.750 --> 00:08:43.850\nI'm not even sure what ZRS is, but\nit sounds better than LRS or GRS.\n\n160\n00:08:43.850 --> 00:08:44.700\n>> I'll take two.\n\n161\n00:08:44.700 --> 00:08:46.160\n>> Yeah.\nExactly.\n\n162\n00:08:46.160 --> 00:08:50.030\nI'm going to go with a standard local\nredundant storage for this one.\n\n163\n00:08:50.030 --> 00:08:53.410\nThe other thing we have\nto provide is a location.\n\n164\n00:08:53.410 --> 00:08:56.340\nWhat data center are we\nstoring this stuff in?\n\n165\n00:08:56.340 --> 00:09:01.210\nIn this case west US is\ngonna work just fine for us.\n\n166\n00:09:02.390 --> 00:09:03.900\nAnd that should be all I need.\n\n167\n00:09:03.900 --> 00:09:04.450\nWe'll find out.\n\n168\n00:09:04.450 --> 00:09:07.890\nIf I could scroll back over,\nI'll select that line, and\n\n169\n00:09:07.890 --> 00:09:10.130\nwe'll go ahead and run that line.\n\n170\n00:09:12.100 --> 00:09:16.540\nAll right, and hopefully in a minute or\nso, we'll have my new storage account.\n\n171\n00:09:17.840 --> 00:09:20.970\nAnd then once that's created,\nthe only other thing I wanna do before we\n\n172\n00:09:20.970 --> 00:09:25.180\nactually create the virtual machine\nis to create an availability set.\n\n173\n00:09:25.180 --> 00:09:27.200\nWe talked about what\nan availability set is.\n\n174\n00:09:27.200 --> 00:09:31.390\nIt's the way I can create more than\none virtual machine as part of\n\n175\n00:09:31.390 --> 00:09:32.900\nan availability set.\n\n176\n00:09:32.900 --> 00:09:36.590\nAnd Microsoft makes sure there's no single\npoint of failure for those machines.\n\n177\n00:09:36.590 --> 00:09:39.670\nNot on the same rack or\nif a power supply or\n\n178\n00:09:39.670 --> 00:09:42.450\nswitch was to fail at their data center.\n\n179\n00:09:42.450 --> 00:09:46.490\nBoth the machines will be unavailable,\nso we'll create one of those as well.\n\n180\n00:09:47.690 --> 00:09:50.850\nSo we give this just\na minute to finish up, and\n\n181\n00:09:50.850 --> 00:09:55.120\nwe will verify that everything\ngot created successfully.\n\n182\n00:09:55.120 --> 00:09:56.240\nIn fact,\n\n183\n00:09:56.240 --> 00:10:01.160\nwhile that's going, I'll tell you what we\ncan do is I'll jump down to my next line.\n\n184\n00:10:01.160 --> 00:10:08.441\nAnd to create the availability set,\nnew-azurerm availability.\n\n185\n00:10:08.441 --> 00:10:09.738\nWell, maybe.\n\n186\n00:10:09.738 --> 00:10:12.820\nIt's in the middle of a command, and\nthis is one thing that you'll run into.\n\n187\n00:10:12.820 --> 00:10:15.830\nIt's a little busy right now,\nrunning that last command.\n\n188\n00:10:15.830 --> 00:10:20.320\nSo my tab autofill seizes\nto work temporarily.\n\n189\n00:10:20.320 --> 00:10:21.970\nSo it's not helping me out there.\n\n190\n00:10:21.970 --> 00:10:23.970\nIt is availability set.\n\n191\n00:10:23.970 --> 00:10:26.100\nAnd you don't have to use tab autofill.\n\n192\n00:10:26.100 --> 00:10:29.360\nIf you can type and spell,\nyou can type it in there.\n\n193\n00:10:29.360 --> 00:10:32.750\nI just like verifying that\nI didn't make a typo.\n\n194\n00:10:32.750 --> 00:10:34.460\nSo we'll give it just a second here.\n\n195\n00:10:34.460 --> 00:10:36.980\n>> In the same way I got\na pretty strong Linux background,\n\n196\n00:10:36.980 --> 00:10:39.110\nif any of you've been watching knows that.\n\n197\n00:10:39.110 --> 00:10:42.570\nI love tab auto complete, I don't\nknow how to live my life without it.\n\n198\n00:10:42.570 --> 00:10:45.300\n>> [LAUGH]\n>> Cisco devices, they do it now.\n\n199\n00:10:45.300 --> 00:10:47.390\nMicrosoft has around for\na little while now.\n\n200\n00:10:47.390 --> 00:10:49.380\nYou get used to that thing,\nyou never go back.\n\n201\n00:10:49.380 --> 00:10:53.500\nAnd any time it's It's strict for\nme, I have to type this entire word?\n\n202\n00:10:54.540 --> 00:10:55.970\n>> [LAUGH] And it's easy to make a typo.\n\n203\n00:10:55.970 --> 00:10:57.220\nFat finger something,\n\n204\n00:10:57.220 --> 00:11:00.370\nget a little dyslexic on there,\nget letters switched around.\n\n205\n00:11:00.370 --> 00:11:03.710\nAnd if you use the tab autofill,\nyou know it's right, all right?\n\n206\n00:11:03.710 --> 00:11:06.790\nAnd if it won't tab autofill,\nyou know you spelled something wrong, or\n\n207\n00:11:06.790 --> 00:11:08.400\nthe command is not correct.\n\n208\n00:11:08.400 --> 00:11:11.760\nSo it's just a way to kinda double\ncheck yourself as you're going.\n\n209\n00:11:11.760 --> 00:11:13.270\nSo I do like waiting for it.\n\n210\n00:11:13.270 --> 00:11:14.630\nWe'll give it another second here.\n\n211\n00:11:14.630 --> 00:11:18.170\nIt's gotta be almost done\ncreating this storage account.\n\n212\n00:11:19.930 --> 00:11:20.590\nWhat else?\n\n213\n00:11:20.590 --> 00:11:21.570\nAnd I'll tell you what we'll do.\n\n214\n00:11:21.570 --> 00:11:23.570\nWhile we're waiting for that complete, and\n\n215\n00:11:23.570 --> 00:11:27.100\nwe'll be able to complete down here in the\nbottom in my actual power trail window.\n\n216\n00:11:27.100 --> 00:11:31.730\nBut while that's going, let's take a look\nat the next script we're going to run.\n\n217\n00:11:31.730 --> 00:11:35.410\nThis is where we're gonna create\nthe virtual machine itself.\n\n218\n00:11:35.410 --> 00:11:38.620\nAnd you can see it just has some\nvariables that we've created, and\n\n219\n00:11:38.620 --> 00:11:40.830\nthen values that we're gonna\nstore in those variables.\n\n220\n00:11:40.830 --> 00:11:45.160\nSo we're just deciding values,\nstoring them in these variables, and\n\n221\n00:11:45.160 --> 00:11:46.440\nthen we're running certain commands.\n\n222\n00:11:46.440 --> 00:11:49.445\nLike here's one that says\nIn the variable vnet,\n\n223\n00:11:49.445 --> 00:11:53.760\nGet-AzureRMVirtualNetwork-Name, vnet name.\n\n224\n00:11:53.760 --> 00:11:58.344\nWell, what is vnet name\nof $vnetname=recoverynet,\n\n225\n00:11:58.344 --> 00:12:00.981\nresource group name $ RG name.\n\n226\n00:12:00.981 --> 00:12:04.620\nWell we set that variable somewhere.\n\n227\n00:12:04.620 --> 00:12:08.180\nWe set that up here to recovery,\nall right?\n\n228\n00:12:08.180 --> 00:12:09.180\nSo as we go through here,\n\n229\n00:12:09.180 --> 00:12:12.540\nwe'll seek commands to create\nthe network adapter, right?\n\n230\n00:12:12.540 --> 00:12:17.550\nTo request the public IP address, that we\nwanna associate with that network adapter.\n\n231\n00:12:17.550 --> 00:12:21.990\nThe name I'm gonna give\nthe virtual machine, the size.\n\n232\n00:12:21.990 --> 00:12:26.270\nRemember, this is where you have to, again\nPowerShell helps me fill this out because\n\n233\n00:12:26.270 --> 00:12:29.460\nI don't know what they call those\ndifferent size virtual machines by heart.\n\n234\n00:12:29.460 --> 00:12:34.150\nBut as I start typing it kinda gives\nme that list and I can figure it out.\n\n235\n00:12:34.150 --> 00:12:38.190\nThere's the availability set that\nwhere getting ready to create, right.\n\n236\n00:12:38.190 --> 00:12:41.400\nSo I'm gonna have to\nmake sure I name it that.\n\n237\n00:12:41.400 --> 00:12:42.850\nCreating at availability set.\n\n238\n00:12:42.850 --> 00:12:44.160\nRemember with our domain controllers,\n\n239\n00:12:44.160 --> 00:12:48.780\nI can't use the operating system drive\nto store the active directory database.\n\n240\n00:12:48.780 --> 00:12:51.460\nSo I'm adding a second drive\nto this virtual machine.\n\n241\n00:12:52.740 --> 00:12:56.466\nAnd then below,\nwe're telling it what image I want to use.\n\n242\n00:12:56.466 --> 00:13:00.380\nI want a server 2012 R2 data center.\n\n243\n00:13:00.380 --> 00:13:03.910\nAnd if you think back to our other\nepisodes where we were using the classic\n\n244\n00:13:03.910 --> 00:13:08.480\nor that new portal, these are the same\nthings I was specifying when I clicked new\n\n245\n00:13:08.480 --> 00:13:13.290\nvirtual machine or went to compute and\nthen shows 2012 R2 data center and\n\n246\n00:13:13.290 --> 00:13:14.820\nthen had to provide a name.\n\n247\n00:13:14.820 --> 00:13:17.960\nWe had to create the public adapter and\nrequest the public IP address\n\n248\n00:13:17.960 --> 00:13:20.244\nahead of time so that we could\nassign it to that virtual machine.\n\n249\n00:13:20.244 --> 00:13:25.160\nSo all the same things are going on,\nwe're just doing it from PowerShow.\n\n250\n00:13:25.160 --> 00:13:30.301\nThen finally down at the bottom,\nspecify the operating system disk name and\n\n251\n00:13:30.301 --> 00:13:33.770\nthen the very last command\nis the New-AzureRMvm.\n\n252\n00:13:33.770 --> 00:13:37.040\nThen it's pulling from\nall of those variables\n\n253\n00:13:37.040 --> 00:13:40.622\nfrom above to give it all the things it\nneeds to create that virtual machine.\n\n254\n00:13:40.622 --> 00:13:45.780\nAll right Daniel, I tell you it's taking\na little while to run through this so\n\n255\n00:13:45.780 --> 00:13:49.210\nwhy don't we go ahead and through\nthe magic of TV take a quick break and\n\n256\n00:13:49.210 --> 00:13:50.960\nas soon as it finishes\nwe'll come right back.\n\n257\n00:13:52.610 --> 00:13:56.480\nAlright, and now we're back and through\nthe magic of TV timeouts here our storage\n\n258\n00:13:56.480 --> 00:13:59.730\naccount has finished provisioning,\nso let's take a look at that.\n\n259\n00:13:59.730 --> 00:14:04.360\nThere is the command that I ran\nNew-AzureRMstorageaccount and\n\n260\n00:14:04.360 --> 00:14:10.080\nwe can see below here my success\nmessage where it did indeed succeed.\n\n261\n00:14:10.080 --> 00:14:11.920\nOops.\nWe'll scroll back up there.\n\n262\n00:14:11.920 --> 00:14:16.200\nIt did indeed succeed in\nprovisioning that storage account.\n\n263\n00:14:16.200 --> 00:14:17.480\nNow you will see an error down here.\n\n264\n00:14:17.480 --> 00:14:20.830\nI actually ran the test\nAzure command one more time.\n\n265\n00:14:20.830 --> 00:14:21.840\nI was testing connectivity.\n\n266\n00:14:21.840 --> 00:14:25.920\nWe had a firewall issue that rebooted,\nso I was testing my connectivity.\n\n267\n00:14:25.920 --> 00:14:27.700\nWe might have to reauthenticate.\n\n268\n00:14:27.700 --> 00:14:31.870\nBut the good news is my storage\naccount was provisioned.\n\n269\n00:14:31.870 --> 00:14:36.300\nSo the next thing we're gonna do\nis provision the availability set.\n\n270\n00:14:36.300 --> 00:14:38.050\nSo let's go ahead and\ndo that one real quick.\n\n271\n00:14:38.050 --> 00:14:39.180\nAgain this might bomb on me.\n\n272\n00:14:39.180 --> 00:14:39.890\nWe'll find out.\n\n273\n00:14:39.890 --> 00:14:41.070\nI might have to reconnect or\n\n274\n00:14:41.070 --> 00:14:44.830\nreauthenticate because we lost\nconnectivity for a minute with Azure.\n\n275\n00:14:44.830 --> 00:14:49.790\nSo I'm gonna do new\nAzure RM availability set.\n\n276\n00:14:51.440 --> 00:14:52.890\nAnd all we have to do for this one.\n\n277\n00:14:52.890 --> 00:14:53.560\nWe'll hit our dash.\n\n278\n00:14:53.560 --> 00:14:56.380\nAnd we'll see we need to give\nit a resource group name.\n\n279\n00:14:56.380 --> 00:14:59.060\nThat's going into recovery.\n\n280\n00:14:59.060 --> 00:15:03.180\nWe also need to give\nthe availability set a name.\n\n281\n00:15:03.180 --> 00:15:09.849\nAnd we're going to call this one, oops,\nrecovery AS, for availability set.\n\n282\n00:15:11.320 --> 00:15:13.520\nAnd I also need a location.\n\n283\n00:15:13.520 --> 00:15:17.620\nAnd again, we're gonna do the old west US\n\n284\n00:15:19.570 --> 00:15:22.010\nand that should be all I need for\nthat command.\n\n285\n00:15:22.010 --> 00:15:24.040\nSo let's go ahead and execute that one.\n\n286\n00:15:24.040 --> 00:15:27.820\nAnd we'll see what happens here.\n\n287\n00:15:27.820 --> 00:15:30.040\nAgain, we had a little, op, good to go.\n\n288\n00:15:30.040 --> 00:15:34.590\nIt picked my connection right back up\nmuch quicker for that availability set.\n\n289\n00:15:34.590 --> 00:15:35.870\nThere I can see it succeeded.\n\n290\n00:15:35.870 --> 00:15:44.200\nThe main thing I'm looking for, where is\nmy success recovery, availabilitySets.\n\n291\n00:15:44.200 --> 00:15:46.630\nIt doesn't really say success,\nit doesn't give me a status,\n\n292\n00:15:46.630 --> 00:15:48.460\nbut you know how PowerShell works.\n\n293\n00:15:48.460 --> 00:15:51.320\nIf I don't get red text,\nI'm pretty sure I'm good to go.\n\n294\n00:15:51.320 --> 00:15:53.050\nBut we can always verify.\n\n295\n00:15:53.050 --> 00:15:57.570\nI could flip over to the portal here,\nand let me reconnect again.\n\n296\n00:15:57.570 --> 00:15:59.523\nWe had to reboot here on set.\n\n297\n00:15:59.523 --> 00:16:06.367\nSo let me reload this page and\nwe'll verify that those resources show up.\n\n298\n00:16:06.367 --> 00:16:09.910\nLet's just go ahead and\nrefresh this whole thing.\n\n299\n00:16:11.000 --> 00:16:12.920\nSo we'll go back over to that recovery.\n\n300\n00:16:14.460 --> 00:16:15.700\nThat's my resource group.\n\n301\n00:16:17.180 --> 00:16:22.540\nAnd in my resource group, I should now\nhave my recovery availability set,\n\n302\n00:16:22.540 --> 00:16:25.540\nas well as my recovery storage account.\n\n303\n00:16:25.540 --> 00:16:28.932\nSo now I've got all the pieces in place,\nI can roll out a VM.\n\n304\n00:16:28.932 --> 00:16:33.618\nSo back over good old ISE,\nwe'll flip over to my CreateVM.\n\n305\n00:16:33.618 --> 00:16:36.636\nAnd we've already gone over\nthis script with you, so\n\n306\n00:16:36.636 --> 00:16:38.660\nI'm just gonna go ahead and run it.\n\n307\n00:16:38.660 --> 00:16:42.090\nFor this one,\nI'm gonna run the entire script.\n\n308\n00:16:42.090 --> 00:16:44.918\nSo we'll click run, and\nthen we'll let it go.\n\n309\n00:16:44.918 --> 00:16:48.245\nAnd again, it's another one of\nthose things, it's gonna take five,\n\n310\n00:16:48.245 --> 00:16:52.210\nten minutes so we're gonna take a little\nbit of a timeout here while that runs.\n\n311\n00:16:52.210 --> 00:16:56.619\nAnd then as soon as it finishes, we'll\ncome back and we'll check the results.\n\n312\n00:16:57.690 --> 00:17:00.850\nAll right, and again through\nthe magic of TV, we are back and\n\n313\n00:17:00.850 --> 00:17:02.060\nthe task has completed.\n\n314\n00:17:02.060 --> 00:17:03.560\nThe script has completed.\n\n315\n00:17:03.560 --> 00:17:06.100\nSo let's take a look at my results here.\n\n316\n00:17:06.100 --> 00:17:08.781\nI can see that I have StatusCode OK.\n\n317\n00:17:08.781 --> 00:17:11.080\nEverything looks good.\n\n318\n00:17:11.080 --> 00:17:13.892\nAgain, that probably took\nabout 15 minutes maybe?\n\n319\n00:17:13.892 --> 00:17:14.612\n>> Yeah, it was a good little while.\n\n320\n00:17:14.612 --> 00:17:15.970\n>> Something like that, real time.\n\n321\n00:17:15.970 --> 00:17:17.346\nSo not the fastest thing, but\n\n322\n00:17:17.346 --> 00:17:20.274\nit was no different than when we\ndid it through the GUI, right.\n\n323\n00:17:20.274 --> 00:17:23.372\nWhen we went into the portal\nportal.azure.com and we clicked those,\n\n324\n00:17:23.372 --> 00:17:24.929\nyou had to wait for it to provision.\n\n325\n00:17:24.929 --> 00:17:27.216\nIf you think about it,\nit's doing quite a bit.\n\n326\n00:17:27.216 --> 00:17:32.230\nIt's rolling out a new templates\nbased on Server 2012 R2.\n\n327\n00:17:32.230 --> 00:17:34.530\nIt's putting that operating\nsystem disk in there.\n\n328\n00:17:34.530 --> 00:17:38.690\nI mean, at this point I have a machine\nthat I can boot up and log into, right?\n\n329\n00:17:38.690 --> 00:17:41.660\nSo granted,\nit seems like it takes forever to run.\n\n330\n00:17:41.660 --> 00:17:45.703\nIt's really not that bad if you think\nabout you trying to roll out the disk, and\n\n331\n00:17:45.703 --> 00:17:48.594\ninstall, and all of that stuff,\nit's about the same.\n\n332\n00:17:48.594 --> 00:17:49.430\nSo, should be good to go.\n\n333\n00:17:49.430 --> 00:17:50.180\nLet's go check it out.\n\n334\n00:17:50.180 --> 00:17:52.790\nI'll flip over to the portal,\nsee if we're still logged in.\n\n335\n00:17:52.790 --> 00:17:55.580\nI'm gonna close this so\nI can kinda refresh things.\n\n336\n00:17:55.580 --> 00:17:57.740\nI'm gonna go back over to\nmy recovery storage group.\n\n337\n00:17:59.830 --> 00:18:04.990\nAnd in here we'll see what kind of\nresources we can find, all right?\n\n338\n00:18:04.990 --> 00:18:07.710\nThere is recovery-dc01 right there.\n\n339\n00:18:07.710 --> 00:18:09.990\nI can also see the network adapter and\n\n340\n00:18:09.990 --> 00:18:14.500\nthe public IP address that we requested,\nlooks good there.\n\n341\n00:18:14.500 --> 00:18:17.240\nIf I click on that domain controller or\n\n342\n00:18:17.240 --> 00:18:19.790\nthat new virtual machine,\nit's not really a domain controller yet.\n\n343\n00:18:19.790 --> 00:18:21.620\nIt just has Windows installed.\n\n344\n00:18:21.620 --> 00:18:27.330\nBut there I can see all the selections\nI made in the script, a Standard D1.\n\n345\n00:18:27.330 --> 00:18:29.390\nIt's got that public IP address.\n\n346\n00:18:29.390 --> 00:18:32.810\nIt's part of Subnet 1 on my recovery VNET.\n\n347\n00:18:32.810 --> 00:18:33.810\nEverything is good to go.\n\n348\n00:18:33.810 --> 00:18:36.668\nIn fact,\nI should be able to click Connect and\n\n349\n00:18:36.668 --> 00:18:40.592\nopen up a remote desktop connection\nright into that machine.\n\n350\n00:18:40.592 --> 00:18:42.960\nI'll go ahead and\nclick Connect, and there we go.\n\n351\n00:18:42.960 --> 00:18:47.020\nWe set the user name and password for\nthe administrator account in that script.\n\n352\n00:18:47.020 --> 00:18:52.690\nRemember I did the get credentials, and\nit prompted me for the credentials.\n\n353\n00:18:52.690 --> 00:18:53.670\nAnd there we go.\n\n354\n00:18:53.670 --> 00:18:56.430\nI am remoted into that machine.\n\n355\n00:18:56.430 --> 00:19:02.570\nSo you can see where the power of\nAzure PowerShell, no pun intended, is.\n\n356\n00:19:02.570 --> 00:19:06.290\nNow, another thing I want to show you,\nI'm gonna go ahead and\n\n357\n00:19:06.290 --> 00:19:08.340\ndisconnect from that\nremote desktop session.\n\n358\n00:19:08.340 --> 00:19:12.304\nThe last thing I wanna show you in this\nextended episode that we're doing is I'm\n\n359\n00:19:12.304 --> 00:19:17.030\ngonna take that same script and\nrearrange it a little bit, all right?\n\n360\n00:19:17.030 --> 00:19:19.720\nRemember I talked about this\nthe other day, is the problem with\n\n361\n00:19:19.720 --> 00:19:22.510\nthe way I have this first script written,\nis that it works good for\n\n362\n00:19:22.510 --> 00:19:25.938\nteaching because everything is kind of\nbroken out into its own little section.\n\n363\n00:19:25.938 --> 00:19:27.600\nI've got it commented up.\n\n364\n00:19:27.600 --> 00:19:31.270\nAnd so we can really kinda go through and\ntalk about what each part is doing,\n\n365\n00:19:31.270 --> 00:19:35.430\nor you can break it down yourself as you\ngo through these different sections.\n\n366\n00:19:35.430 --> 00:19:38.720\nBut when it comes time to reuse this\nscript, and that's really what scripts\n\n367\n00:19:38.720 --> 00:19:41.800\nare about, is the ability to use\nthem over and over and over again.\n\n368\n00:19:41.800 --> 00:19:44.550\nThis is something I do\nnot wanna have to type up\n\n369\n00:19:44.550 --> 00:19:47.040\nevery time I need to roll\nout a new virtual machine.\n\n370\n00:19:47.040 --> 00:19:49.020\nSo I wanna create a script.\n\n371\n00:19:49.020 --> 00:19:52.280\nWell with this one, I've gotta go\nthrough and figure out all the different\n\n372\n00:19:52.280 --> 00:19:55.700\nplaces that the variables are used and\nmake sure I change them, right.\n\n373\n00:19:55.700 --> 00:19:58.310\nI can't have a duplicate\nnetwork adapter name.\n\n374\n00:19:58.310 --> 00:20:02.860\nI can't have a duplicate operating system\ndisk name or virtual machine name or\n\n375\n00:20:02.860 --> 00:20:03.660\nanything like that.\n\n376\n00:20:03.660 --> 00:20:07.300\nI've gotta make sure those get changed\neach time I run the script, and\n\n377\n00:20:07.300 --> 00:20:11.890\nif I'm just looking at the script, I might\nmiss one or two that I need to change.\n\n378\n00:20:11.890 --> 00:20:16.240\nSo what I've done in the second script\nis I've broken out all of the variables\n\n379\n00:20:16.240 --> 00:20:17.285\ninto their own section.\n\n380\n00:20:17.285 --> 00:20:22.999\nAnd so now I can just go through here and\nsee there's my resource group name,\n\n381\n00:20:22.999 --> 00:20:27.281\nmy location name,\nmy storage account name, my VM name,\n\n382\n00:20:27.281 --> 00:20:31.861\nmy VM size, etc, etc,\ndown through this list, all right.\n\n383\n00:20:31.861 --> 00:20:35.862\nAnd then below that I've got another\nsection that says do not change the values\n\n384\n00:20:35.862 --> 00:20:37.160\nbelow this line.\n\n385\n00:20:37.160 --> 00:20:40.540\nThis way I can share this script\nwith other administrators, and\n\n386\n00:20:40.540 --> 00:20:44.770\nthey know that hey,\nanything up here I can modify as needed.\n\n387\n00:20:44.770 --> 00:20:47.700\nAnything down below this line,\ndon't touch it, right?\n\n388\n00:20:47.700 --> 00:20:49.660\nWe don't need to change\nanything down there.\n\n389\n00:20:49.660 --> 00:20:53.370\nIt's just pulling the data from\nthese variables at the top.\n\n390\n00:20:53.370 --> 00:20:55.970\nSo, if I want to roll out,\nreal quick, another machine\n\n391\n00:20:55.970 --> 00:21:00.910\nthat's part of the same VNET,\nthat's part of the same resource group and\n\n392\n00:21:00.910 --> 00:21:04.290\nstorage account, all I have to do is\ncome in here and change the name.\n\n393\n00:21:04.290 --> 00:21:05.910\nI changed this to a 2.\n\n394\n00:21:05.910 --> 00:21:07.021\nThat first one was dc01.\n\n395\n00:21:07.021 --> 00:21:12.670\nI'm using the same size, and\neverything else is staying the same.\n\n396\n00:21:12.670 --> 00:21:13.360\nI'll just run the script.\n\n397\n00:21:16.140 --> 00:21:19.095\nAnd it's gonna go and\nroll out another machine.\n\n398\n00:21:19.095 --> 00:21:22.600\nNow as soon as that finishes,\nwhich will be about 15 minutes from now,\n\n399\n00:21:22.600 --> 00:21:27.555\nI can come in here and change this to a 3\nand roll out another virtual machine.\n\n400\n00:21:27.555 --> 00:21:31.940\nOr if my boss or my admin or somebody in\nmy network comes to me and says hey, we\n\n401\n00:21:31.940 --> 00:21:37.060\nneed a couple new virtual machines running\n2012 R2 over in that other resource group.\n\n402\n00:21:37.060 --> 00:21:41.100\nLet me go ahead and\nassign the admin username and password for\n\n403\n00:21:41.100 --> 00:21:42.770\nthe VM that it's creating right now.\n\n404\n00:21:42.770 --> 00:21:44.830\nI can simply change my\nresource group name, or\n\n405\n00:21:44.830 --> 00:21:49.010\nchange my location name and\nreuse the same script.\n\n406\n00:21:49.010 --> 00:21:53.660\nSo that's the idea behind PowerShell and\nusing Azure PowerShell is figure\n\n407\n00:21:53.660 --> 00:21:58.660\nout what it is you need to do or that you\ndo repeatedly, save it as a script, and\n\n408\n00:21:58.660 --> 00:22:01.030\nthen you can use it any time you need.\n\n409\n00:22:01.030 --> 00:22:04.712\nSomething like these commands over here,\nthey don't really work together.\n\n410\n00:22:04.712 --> 00:22:06.800\nI kinda need to run one and\nthen the other.\n\n411\n00:22:06.800 --> 00:22:12.628\nBut I might have one PS1 file that has all\nthese different random commands in it.\n\n412\n00:22:12.628 --> 00:22:17.470\nAnd any time I want, I can open up this\nscript, select one line out of it, and\n\n413\n00:22:17.470 --> 00:22:18.860\nrun it, right?\n\n414\n00:22:18.860 --> 00:22:20.945\nSo that's the idea is use PowerShell.\n\n415\n00:22:20.945 --> 00:22:24.300\nPowerShell's great, it works just\nlike using the portals, right?\n\n416\n00:22:24.300 --> 00:22:25.670\nYou have to learn your commands.\n\n417\n00:22:25.670 --> 00:22:27.770\nBut it gives me that reusability,\n\n418\n00:22:27.770 --> 00:22:31.740\nand that's something that can make me\nas an admin much more productive and\n\n419\n00:22:31.740 --> 00:22:35.470\nmuch more efficient when it comes\nto managing my Azure resources.\n\n420\n00:22:35.470 --> 00:22:39.828\n>> Yeah, I always say that scripting is\none of the greatest utilities that we have\n\n421\n00:22:39.828 --> 00:22:43.867\nin the IT world, being able to say,\nit seems almost backwards, right.\n\n422\n00:22:43.867 --> 00:22:47.874\nWe think we live in the land of modern\ntechnology with beautiful graphic\n\n423\n00:22:47.874 --> 00:22:50.220\ninterfaces, and yes they are there.\n\n424\n00:22:50.220 --> 00:22:51.200\nAnd they work, they work great.\n\n425\n00:22:51.200 --> 00:22:51.950\nI use them everyday.\n\n426\n00:22:51.950 --> 00:22:53.530\nMike uses them everyday as well.\n\n427\n00:22:53.530 --> 00:22:56.980\nBut for\njust that brute force day to day thing,\n\n428\n00:22:56.980 --> 00:22:59.993\na lot of times the command line\nis gonna be your best friend.\n\n429\n00:22:59.993 --> 00:23:03.650\nYou're just gonna go there, and you're\ngonna do a bunch of stuff that's going to\n\n430\n00:23:03.650 --> 00:23:06.363\ngive you no frills,\nno nonsense information that you need.\n\n431\n00:23:06.363 --> 00:23:09.288\nAnd it's gonna take commands,\nall you gotta do is know them.\n\n432\n00:23:09.288 --> 00:23:14.960\nAnd that really enhances its utility,\nand most importantly, its flexibility.\n\n433\n00:23:14.960 --> 00:23:18.630\nLike what Mike says, I want to be\nable to roll out VMs all day long.\n\n434\n00:23:18.630 --> 00:23:19.640\nI gotta have different names.\n\n435\n00:23:19.640 --> 00:23:20.620\nI can create a script.\n\n436\n00:23:20.620 --> 00:23:23.642\nWe can probably even go even\nfarther than what Mike has done.\n\n437\n00:23:23.642 --> 00:23:26.200\nHe's really just showing you the basics,\n\n438\n00:23:26.200 --> 00:23:28.790\nthe bare bones of what can\nbe done through scripting.\n\n439\n00:23:28.790 --> 00:23:32.678\nHe can probably create a script that says\nonce you've created this machine, go back,\n\n440\n00:23:32.678 --> 00:23:36.246\nrename it this, and create another one,\nand to continue to loop through that,\n\n441\n00:23:36.246 --> 00:23:37.550\nlots of flexibility there.\n\n442\n00:23:37.550 --> 00:23:38.410\n>> We could have some fun.\n\n443\n00:23:38.410 --> 00:23:42.003\nWe could actually parameterize,\nif I could say that, right.\n\n444\n00:23:42.003 --> 00:23:42.804\n>> I like that.\n\n445\n00:23:42.804 --> 00:23:47.170\n>> Where you run the script, and you might\ncall CreateVM, right, CreateVM.PS1 and\n\n446\n00:23:47.170 --> 00:23:49.815\nthen provide parameters\nwhen you call the script,\n\n447\n00:23:49.815 --> 00:23:53.340\nso that you don't even have to go\ninto the script and change things.\n\n448\n00:23:53.340 --> 00:23:56.310\nIn the script,\nthe name of the VM is not defined.\n\n449\n00:23:56.310 --> 00:23:59.730\nYou have to provide the name when\nyou actually run the script.\n\n450\n00:23:59.730 --> 00:24:01.500\nAnd then you don't even\nhave to change anything.\n\n451\n00:24:01.500 --> 00:24:04.360\nSo you can have a lot\nof fun with PowerShell.\n\n452\n00:24:04.360 --> 00:24:06.960\nAnd Daniel, I don't think there's\nreally any need to wait for\n\n453\n00:24:06.960 --> 00:24:07.910\nthat second one to finish.\n\n454\n00:24:07.910 --> 00:24:10.360\nYou guys know that it is\ngonna complete at this point.\n\n455\n00:24:10.360 --> 00:24:14.070\nI just wanted to show you a different\nway of organizing that script,\n\n456\n00:24:14.070 --> 00:24:16.080\nmake it a little bit more reusable.\n\n457\n00:24:16.080 --> 00:24:17.339\n>> Yeah, and how easy that was, right?\n\n458\n00:24:17.339 --> 00:24:18.843\n>> Yeah.\n>> He just went in there and\n\n459\n00:24:18.843 --> 00:24:20.253\nchanged the name and hit run.\n\n460\n00:24:20.253 --> 00:24:21.912\nGo, off it goes, very, very nice.\n\n461\n00:24:21.912 --> 00:24:23.950\nMike, awesome stuff today.\n\n462\n00:24:23.950 --> 00:24:27.950\nThank you so much for showing us how\nto jump into Azure PowerShell and\n\n463\n00:24:27.950 --> 00:24:32.030\nstart using and interacting with\nAzure using that command line.\n\n464\n00:24:32.030 --> 00:24:34.520\nThat we should be good at anyway.\n\n465\n00:24:34.520 --> 00:24:40.290\nSo this just gives us another set of\ntools in the kit to be able to run and\n\n466\n00:24:40.290 --> 00:24:41.410\nwork in our environments.\n\n467\n00:24:41.410 --> 00:24:43.150\nAgain, thanks for\nstopping by and showing us that.\n\n468\n00:24:43.150 --> 00:24:43.698\n>> Absolutely.\n\n469\n00:24:43.698 --> 00:24:46.168\n>> I'll go ahead and thank everybody\nout there for joining us today.\n\n470\n00:24:46.168 --> 00:24:48.419\nThis is finally the end of-\n>> [LAUGH] Yeah, for\n\n471\n00:24:48.419 --> 00:24:49.327\nour live audience here.\n\n472\n00:24:49.327 --> 00:24:49.889\n>> That's right,\n\n473\n00:24:49.889 --> 00:24:52.588\nfor our live audience, they know what\nwe're talking about, of this episode.\n\n474\n00:24:52.588 --> 00:24:54.132\nThanks again for watching.\n\n475\n00:24:54.132 --> 00:24:56.130\nWe're gonna go ahead and\nsign off for ITProTV.\n\n476\n00:24:56.130 --> 00:24:57.533\nI've been your host, Daniel Lowrie.\n\n477\n00:24:57.533 --> 00:24:58.254\n>> And I'm Mike Rodrick.\n\n478\n00:24:58.254 --> 00:24:59.147\n>> And we'll see you next time.\n\n479\n00:24:59.147 --> 00:25:07.370\n[SOUND]\n\n",
          "vimeoId": "156858999"
        }
      ],
      "title": "Active Directory in Azure"
    }
  ],
  "url": "active-directory-azure",
  "vLab": false
}
