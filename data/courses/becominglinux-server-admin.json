{
  "description": "The Becoming a Linux Server Administrator covers managing Linux servers in a business environment. Topics covered include installing Linux as a server, managing networking and troubleshooting the OS. Other episodes demonstrate how to configure a web server, a file server, and other common servers. The primary goal of the course is to help system administrators learn to deploy and support the Linux operating system as a server platform.",
  "descriptionMD": "The *Becoming a Linux Server Administrator* covers managing Linux servers in a business environment. Topics covered include installing Linux as a server, managing networking and troubleshooting the OS. Other episodes demonstrate how to configure a web server, a file server, and other common servers. The primary goal of the course is to help system administrators learn to deploy and support the Linux operating system as a server platform.",
  "length": "43784",
  "name": "Becoming a Linux Server Admin",
  "practiceExam": false,
  "subtitle": "Becoming a Linux Server Admin",
  "tagUrl": "systems-admin",
  "topics": [
    {
      "episodes": [
        {
          "description": "The Becoming a Linux Server Administrator covers managing Linux servers in a business environment. Topics covered include installing Linux as a server, managing networking and troubleshooting the OS. Other episodes demonstrate how to configure a web server, a file server, and other common servers. The primary goal of the course is to help system administrators learn to deploy and support the Linux operating system as a server platform.",
          "length": "253",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-0-0-overview-071717-PGM.00_04_03_24.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-0-0-overview-071717-PGM.00_04_03_24.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-0-0-overview-071717-PGM.00_04_03_24.Still001-sm.jpg",
          "title": "Overview",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:05.846\n[MUSIC]\n\n2\n00:00:05.846 --> 00:00:07.169\nHello, and thank you for joining us.\n\n3\n00:00:07.169 --> 00:00:09.557\nIn this video we're taking\nto look at the upcoming,\n\n4\n00:00:09.557 --> 00:00:12.030\nBecoming a Linux Server Administrator\nseries.\n\n5\n00:00:12.030 --> 00:00:15.600\nAnd what is becoming\na Linux Server Administrator series?\n\n6\n00:00:15.600 --> 00:00:18.300\n&gt;&gt; Sure, you know a lot of people out\nthere wan to learn the Linux operating\n\n7\n00:00:18.300 --> 00:00:21.460\nsystems, it's very popular and most people\nget their start working on a desktop.\n\n8\n00:00:21.460 --> 00:00:25.400\nYou install Linux on your laptop, or\nyour PC, and that's how you learn it.\n\n9\n00:00:25.400 --> 00:00:29.950\nBut in real life land where Linux really\ndominates is in the server market.\n\n10\n00:00:29.950 --> 00:00:33.180\nAnd you'll find that running Linux\non a server is a lot different\n\n11\n00:00:33.180 --> 00:00:35.270\nthan running Linux on a work station.\n\n12\n00:00:35.270 --> 00:00:38.010\nSo in this series what we do is we try and\n\n13\n00:00:38.010 --> 00:00:39.940\nget the users accustomed\nto working on a server.\n\n14\n00:00:39.940 --> 00:00:40.990\nWe show them that environment,\n\n15\n00:00:40.990 --> 00:00:44.110\nwhat it's like working with Linux in\na server environment and the different\n\n16\n00:00:44.110 --> 00:00:47.580\nadministrative tasks we have to perform\nto keep that system up and running.\n\n17\n00:00:47.580 --> 00:00:51.620\nIt really helps to take your Linux skills\nfrom hobbyist to professional, and\n\n18\n00:00:51.620 --> 00:00:55.230\nget you out there in the real world using\ntrade skills to manage Linux servers.\n\n19\n00:00:55.230 --> 00:00:57.190\n&gt;&gt; And who is the show targeted towards?\n\n20\n00:00:57.190 --> 00:00:59.840\n&gt;&gt; Well, this could really apply\nto a number of different people,\n\n21\n00:00:59.840 --> 00:01:03.530\nif you work for a company that implements\nLinux servers and you're responsible for\n\n22\n00:01:03.530 --> 00:01:06.130\nsupporting those servers this\nseries should be great for you.\n\n23\n00:01:06.130 --> 00:01:09.120\nCuz we're gonna help you ensure those\nservers are installed properly.\n\n24\n00:01:09.120 --> 00:01:10.240\nAnd show you how to maintain them.\n\n25\n00:01:10.240 --> 00:01:12.420\nAnd run the different services\nthat are inside of there.\n\n26\n00:01:12.420 --> 00:01:14.630\nIf you're just curious about\nhow Linux servers work,\n\n27\n00:01:14.630 --> 00:01:16.780\nthis is a great series for you.\n\n28\n00:01:16.780 --> 00:01:18.920\nBut if you're looking to\nrun Linux on your desktop,\n\n29\n00:01:18.920 --> 00:01:22.310\nwell that's not really a thing\nwe're going to be covering here.\n\n30\n00:01:22.310 --> 00:01:25.450\nIn fact, we're going to do very very\nlittle with the graphical user interface.\n\n31\n00:01:25.450 --> 00:01:27.650\nSo if you're just getting\nstarted with Linux,\n\n32\n00:01:27.650 --> 00:01:29.760\nthis will be a pretty harsh spot to start.\n\n33\n00:01:29.760 --> 00:01:32.950\nSo, the typical viewer for the series\nis gonna be somebody who already\n\n34\n00:01:32.950 --> 00:01:34.900\nhas experience working with\na Linux operating system,\n\n35\n00:01:34.900 --> 00:01:37.880\nmaybe not servers but\nat least experience with the OS itself.\n\n36\n00:01:37.880 --> 00:01:39.490\nAnd is ready to make that jump.\n\n37\n00:01:39.490 --> 00:01:43.175\nIf you're somebody who's just starting\nout, wanting to get that first taste\n\n38\n00:01:43.175 --> 00:01:45.675\nof working with Linux,\nI encourage you to check out our Linux for\n\n39\n00:01:45.675 --> 00:01:49.355\nBeginners series, or\nour Becoming a Linux System Administrator.\n\n40\n00:01:49.355 --> 00:01:50.565\nDifferent than server administrator.\n\n41\n00:01:50.565 --> 00:01:52.185\nSystem focuses on the desktop.\n\n42\n00:01:52.185 --> 00:01:55.225\nWe use a lot of GUI utilities and other\nthings there, and you get that experience.\n\n43\n00:01:55.225 --> 00:01:59.247\nBut this one, this series is dedicated\nto that person that's got to support\n\n44\n00:01:59.247 --> 00:02:01.207\nservers and work in that environment.\n\n45\n00:02:01.207 --> 00:02:03.507\n&gt;&gt; Is there certificated available for\nthis?\n\n46\n00:02:03.507 --> 00:02:05.287\n&gt;&gt; No, you know this series is\na little bit different than what we\n\n47\n00:02:05.287 --> 00:02:06.207\ncreate normally on [INAUDIBLE] TV.\n\n48\n00:02:06.207 --> 00:02:08.527\nA lot of our content is\ncertification based but\n\n49\n00:02:08.527 --> 00:02:11.057\nhere, it's more real world skills based.\n\n50\n00:02:11.057 --> 00:02:14.337\nI wanna show you guys what it takes to\nbe able to manage these systems and\n\n51\n00:02:14.337 --> 00:02:16.657\ngive you more of a hands\non practical example.\n\n52\n00:02:16.657 --> 00:02:20.210\nSo as this series goes through, you'll\nsee where we're doing just examples,\n\n53\n00:02:20.210 --> 00:02:22.210\nlabs we're actually working\nwith the equipment and\n\n54\n00:02:22.210 --> 00:02:25.260\ngetting it set up and\nusing it and implementing it.\n\n55\n00:02:25.260 --> 00:02:28.810\nWithout having to worry about what\nquestion is on a particular exam.\n\n56\n00:02:28.810 --> 00:02:31.085\nThere are some great certifications\nout there if you're looking for\n\n57\n00:02:31.085 --> 00:02:34.700\nLinux certifications we have several\non our own site like CompTIA Linux+.\n\n58\n00:02:34.700 --> 00:02:37.240\nYou can check those out and get certified.\n\n59\n00:02:37.240 --> 00:02:39.670\nBut if you're just looking\nto get the practical skills,\n\n60\n00:02:39.670 --> 00:02:41.300\nthat's what this series is all about.\n\n61\n00:02:41.300 --> 00:02:43.350\n&gt;&gt; Now what topics\nare covered in this show?\n\n62\n00:02:43.350 --> 00:02:44.780\n&gt;&gt; Well you know, we cover a big range.\n\n63\n00:02:44.780 --> 00:02:45.870\nWe start with the really important stuff,\n\n64\n00:02:45.870 --> 00:02:49.980\nwhich is how you install a Linux server\nand how you get it initially set up.\n\n65\n00:02:49.980 --> 00:02:52.810\nThere's a lot of initial configuration\nyou have to go through to get that Linux\n\n66\n00:02:52.810 --> 00:02:55.220\nserver in place and deployed correctly.\n\n67\n00:02:55.220 --> 00:02:58.530\nWe talked a little bit about securing and\nhardening a Linux server,\n\n68\n00:02:58.530 --> 00:03:01.550\nwhich is another really important thing\nbecause these servers are typically\n\n69\n00:03:01.550 --> 00:03:03.740\nexposed to the Internet, and\nthat makes them a security risk.\n\n70\n00:03:03.740 --> 00:03:06.090\nSo we've gotta make sure that\nthey're configured properly.\n\n71\n00:03:06.090 --> 00:03:09.790\nAfter that, we're gonna break\ndown into individual services.\n\n72\n00:03:09.790 --> 00:03:12.030\nAnd we'll take a look at\nhow to set up a web server,\n\n73\n00:03:12.030 --> 00:03:13.900\nwe'll talk about how to\nset up a database server,\n\n74\n00:03:13.900 --> 00:03:18.830\nwe'll talk about how to do Samba and\nfile sharing, NFS, another file system.\n\n75\n00:03:18.830 --> 00:03:22.590\nAnd so different kind of roles that\nyour Linux server can perform.\n\n76\n00:03:22.590 --> 00:03:26.170\nNow we're gonna take a look\nat these from the basics.\n\n77\n00:03:26.170 --> 00:03:27.740\nTake for example a database server.\n\n78\n00:03:27.740 --> 00:03:29.720\nIf I wanna set up MariaDB.\n\n79\n00:03:29.720 --> 00:03:33.948\nWell, we could have 100 hours of\ncontent on how just to setup MariaDB.\n\n80\n00:03:33.948 --> 00:03:36.180\nSo in this series it's\nmore of an introduction.\n\n81\n00:03:36.180 --> 00:03:38.750\nHow we get the database server deployed,\nhow we connect to it,\n\n82\n00:03:38.750 --> 00:03:42.150\nhow we make sure it's secured\nproperly to be able to put it in use.\n\n83\n00:03:42.150 --> 00:03:46.480\nBut you can carry that knowledge on and go\ninto the more advanced courses later on to\n\n84\n00:03:46.480 --> 00:03:47.890\nlearn more about these\nindividual products.\n\n85\n00:03:47.890 --> 00:03:51.250\nBut here we'll look at how to set up\nall these difference server types and\n\n86\n00:03:51.250 --> 00:03:52.840\nget them running in\nthe production environment.\n\n87\n00:03:52.840 --> 00:03:53.710\n&gt;&gt; That sounds great.\n\n88\n00:03:53.710 --> 00:03:56.910\nBecoming a Linux server administrator,\nif this sounds interesting to you, and I'm\n\n89\n00:03:56.910 --> 00:04:02.100\nsure it does, watch all the video content\nin becoming a Linux server administrator.\n\n90\n00:04:02.100 --> 00:04:03.410\nThank you for watching.\n\n91\n00:04:03.410 --> 00:04:04.326\nSee you soon.\n\n92\n00:04:04.326 --> 00:04:08.912\n[MUSIC]\n\n",
          "vimeoId": "225991988"
        },
        {
          "description": "Don and Zach discuss Installing Linux as a Server, why install it, how to install it, starting the Server, monitoring the Server, obtaining installation media, obtaining the necessary hardware, performing the install, and what you need to know when working with Red Hat 7.3 / Ubuntu / & Centos in regards to the installation of Linux as a Server.",
          "length": "1896",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-1-1-installing_linux_as_a_server-071717-PGM.00_31_20_11.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-1-1-installing_linux_as_a_server-071717-PGM.00_31_20_11.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-1-1-installing_linux_as_a_server-071717-PGM.00_31_20_11.Still001-sm.jpg",
          "title": "Installing Linux as a Server",
          "transcript": "WEBVTT\n\n1\n00:00:00.330 --> 00:00:06.334\nWelcome to ITProTV,\nI'm your host Don Pezet [CROSSTALK]\n\n2\n00:00:06.334 --> 00:00:07.964\n[MUSIC]\n\n3\n00:00:07.964 --> 00:00:12.101\n&gt;&gt; You're watching ITPro.TV.\n\n4\n00:00:12.101 --> 00:00:14.620\n&gt;&gt; Hello and thank you for\nchoosing ITPro.TV.\n\n5\n00:00:14.620 --> 00:00:17.020\nHelping you learn wherever you go.\n\n6\n00:00:17.020 --> 00:00:19.358\nI'm your host Zach Memos\nas we continue on,\n\n7\n00:00:19.358 --> 00:00:23.737\nwhere we actually begin a brand series,\nBecoming A Linux Server Administrator.\n\n8\n00:00:23.737 --> 00:00:27.674\nAnd bringing us all the information\nwe need is our IT pro, Don Pezet.\n\n9\n00:00:27.674 --> 00:00:29.034\nHey, Don, good to see you sir.\n\n10\n00:00:29.034 --> 00:00:31.639\n&gt;&gt; Hey, Zach, I am excited to\nbe kicking off a new series and\n\n11\n00:00:31.639 --> 00:00:35.332\nthis is actually a pretty fun one for me\ncuz I love working with Linux servers, and\n\n12\n00:00:35.332 --> 00:00:38.840\nso that's what we're gonna be doing\nright here in this very first episode.\n\n13\n00:00:38.840 --> 00:00:42.790\nSo we're gonna be talking about what's\ninvolved in just installing a Linux\n\n14\n00:00:42.790 --> 00:00:43.380\nserver.\n\n15\n00:00:43.380 --> 00:00:46.503\nWhat it takes to run the Linux operating\nsystem as a server in your environment or\n\n16\n00:00:46.503 --> 00:00:47.073\nin the cloud.\n\n17\n00:00:47.073 --> 00:00:49.050\nIt's really all the same to Linux.\n\n18\n00:00:49.050 --> 00:00:52.185\nSo we'll get a chance to see this right\nhere as we walk through the initial steps\n\n19\n00:00:52.185 --> 00:00:53.955\nof becoming a Linux Server Administrator.\n\n20\n00:00:53.955 --> 00:00:58.800\n&gt;&gt; So, the basic question is what are\nthe steps to install Linux as a server?\n\n21\n00:00:58.800 --> 00:01:02.590\n&gt;&gt; All right, so, it's not all that much\ndifferent than other operating systems.\n\n22\n00:01:02.590 --> 00:01:04.530\nThe way we execute the steps\nis very different but\n\n23\n00:01:04.530 --> 00:01:06.470\nthe steps themselves are pretty\nstraight forward, right?\n\n24\n00:01:06.470 --> 00:01:09.332\nStep one, we gotta install\nthe operating system, right?\n\n25\n00:01:09.332 --> 00:01:11.350\nSo, what is that entail?\n\n26\n00:01:11.350 --> 00:01:12.387\nHow is that different than a normal OS?\n\n27\n00:01:12.387 --> 00:01:13.294\nSo we'll get a chance to see that.\n\n28\n00:01:13.294 --> 00:01:15.270\nSo, that's what step one is gonna be.\n\n29\n00:01:15.270 --> 00:01:16.790\nBut after that we're not just done right.\n\n30\n00:01:16.790 --> 00:01:17.797\nWe've gotta configure the server,\n\n31\n00:01:17.797 --> 00:01:19.680\nwhere there's a lot of things\nthat will have to change.\n\n32\n00:01:19.680 --> 00:01:24.310\nThe default install is not necessarily\nvery useful to us, we need to modify it\n\n33\n00:01:24.310 --> 00:01:27.800\nto our needs and get it set up\nthe way that we want to implement it.\n\n34\n00:01:27.800 --> 00:01:29.543\nStep three we've got firing up the server,\nright.\n\n35\n00:01:29.543 --> 00:01:32.395\nYou gotta start it up, make sure\neverything's working properly because,\n\n36\n00:01:32.395 --> 00:01:35.202\njust because the install's over doesn't\nmean that everything is working\n\n37\n00:01:35.202 --> 00:01:36.690\nthe way we expect.\n\n38\n00:01:36.690 --> 00:01:39.140\nThe next step is to secure the server.\n\n39\n00:01:39.140 --> 00:01:41.600\nThe default install makes\na lot of assumptions.\n\n40\n00:01:41.600 --> 00:01:45.960\nAnd those assumptions aren't\nnecessarily the best choices in life.\n\n41\n00:01:45.960 --> 00:01:49.050\nSo we'll need to come in and\ndo what's called hardening the server.\n\n42\n00:01:49.050 --> 00:01:51.070\nClosing down any services we're not using,\n\n43\n00:01:51.070 --> 00:01:53.710\ndisabling any defaults that we don't need,\nand making sure\n\n44\n00:01:53.710 --> 00:01:57.710\nthe system is secure as possible before\nwe throw it out there into the wild.\n\n45\n00:01:57.710 --> 00:02:01.690\nAnd then the last step is, well,\ntechnically, we're done setting it up.\n\n46\n00:02:01.690 --> 00:02:04.218\nBut we need to monitor it,\nwe need to maintain it,\n\n47\n00:02:04.218 --> 00:02:07.430\nwe need to make sure that server\nstays up and running reliably.\n\n48\n00:02:07.430 --> 00:02:09.780\nSo what are the different things\nthat we need to set up to do that?\n\n49\n00:02:09.780 --> 00:02:11.770\nThat's all kind of in that fifth step.\n\n50\n00:02:11.770 --> 00:02:13.130\nSo it's a lot to do.\n\n51\n00:02:13.130 --> 00:02:17.836\nIt's a lot involved in it and\nwhile I know that I could install a Linux\n\n52\n00:02:17.836 --> 00:02:21.487\nserver in I don't know five\nminutes probably tops.\n\n53\n00:02:21.487 --> 00:02:24.680\nGet one spun out and deployed out\nthere as a web server or something.\n\n54\n00:02:24.680 --> 00:02:26.816\nThere's a lot of decisions\nthat go into that.\n\n55\n00:02:26.816 --> 00:02:28.640\n&gt;&gt; Mm-hm.\n&gt;&gt; And if you're just starting out and\n\n56\n00:02:28.640 --> 00:02:31.100\njust learning you need to know\nwhat all those decisions are.\n\n57\n00:02:31.100 --> 00:02:31.985\nSo we're gonna take it slow.\n\n58\n00:02:31.985 --> 00:02:33.900\nWe're not gonna try and\ndeploy a server in five minutes.\n\n59\n00:02:33.900 --> 00:02:38.389\nWe'll walk through the process and see how\nwe can make decisions that change the way\n\n60\n00:02:38.389 --> 00:02:41.675\nthat servers functions, and\nget it working the best for us.\n\n61\n00:02:41.675 --> 00:02:43.619\n&gt;&gt; So, where do we start?\n\n62\n00:02:43.619 --> 00:02:45.788\n&gt;&gt; All right, so step one,\njust like any operating system,\n\n63\n00:02:45.788 --> 00:02:48.830\nif you're gonna install you need to\nget the installation media, right?\n\n64\n00:02:48.830 --> 00:02:51.350\nIf you watched our becoming\na Linux System Administrator show,\n\n65\n00:02:51.350 --> 00:02:53.440\nwe've all ready shown you how to do that.\n\n66\n00:02:53.440 --> 00:02:57.110\nIf you're just starting out here, the way\nyou get installation media is a little\n\n67\n00:02:57.110 --> 00:02:59.620\ndifferent depending on which\ndistribution you choose.\n\n68\n00:02:59.620 --> 00:03:03.680\nNow out there in real life land,\nwhen it comes down to Linux servers,\n\n69\n00:03:03.680 --> 00:03:07.670\nthere's really three primary\ndistributions that are used today.\n\n70\n00:03:07.670 --> 00:03:11.310\nIn the desktop world, everybody has\na different distro they prefer.\n\n71\n00:03:11.310 --> 00:03:13.387\nI like Linux Mint or I like XYZ.\n\n72\n00:03:13.387 --> 00:03:15.100\nThere's all sorts of distros.\n\n73\n00:03:15.100 --> 00:03:16.840\nBut in the server world,\n\n74\n00:03:16.840 --> 00:03:20.270\nthis is where we're dealing with\nmission critical applications.\n\n75\n00:03:20.270 --> 00:03:23.611\nApplications that if they fail,\nthey don't just affect you, right?\n\n76\n00:03:23.611 --> 00:03:26.730\nLike, if my laptop fails,\nit inconveniences me and that's it.\n\n77\n00:03:26.730 --> 00:03:29.813\nZach doesn't care if my laptop fails.\n\n78\n00:03:29.813 --> 00:03:30.629\n&gt;&gt; I do care though.\n\n79\n00:03:30.629 --> 00:03:31.998\n&gt;&gt; Maybe we have an emotional bond, right?\n\n80\n00:03:31.998 --> 00:03:36.435\nBut as far your ability to work Is not\nimpacted, but if the web server were to go\n\n81\n00:03:36.435 --> 00:03:41.170\ndown, right, or our video server, you\nguys are watching this video streaming.\n\n82\n00:03:41.170 --> 00:03:44.915\nThat video server failed, all of you\nviewers out there would lose access.\n\n83\n00:03:44.915 --> 00:03:48.570\nNow it's one system failing\naffecting a ton of people.\n\n84\n00:03:48.570 --> 00:03:53.880\nSo, when businesses deploy Linux as\nan operating system for a server.\n\n85\n00:03:53.880 --> 00:03:57.700\nThey wanna pick an operating system\nthat is reliable and solid, and\n\n86\n00:03:57.700 --> 00:04:01.760\nthat if something goes wrong,\nthey have somebody to call, right?\n\n87\n00:04:01.760 --> 00:04:04.460\nSlackware Linux,\nI love Slackware Linux, but\n\n88\n00:04:04.460 --> 00:04:07.260\nif something goes wrong,\nthere's no one to call.\n\n89\n00:04:07.260 --> 00:04:10.953\nYou can post a message in one of the email\nlists and usually get made fun of for\n\n90\n00:04:10.953 --> 00:04:14.189\na few days and that's it and\nnever actually get any help, right?\n\n91\n00:04:14.189 --> 00:04:15.938\n&gt;&gt; [LAUGH]\n&gt;&gt; That's the culture that's been built in\n\n92\n00:04:15.938 --> 00:04:17.090\nthe Linux community.\n\n93\n00:04:17.090 --> 00:04:20.000\nBut there's nobody there to call for help.\n\n94\n00:04:20.000 --> 00:04:21.900\nA lot of the OS' are like that.\n\n95\n00:04:21.900 --> 00:04:25.210\nAnd so in the server world you\nsee this gravitation towards OS'\n\n96\n00:04:25.210 --> 00:04:26.960\nthat actually have a support structure.\n\n97\n00:04:26.960 --> 00:04:31.701\nAnd the two leading operating systems,\nare Red Hat Enterprise Linux from\n\n98\n00:04:31.701 --> 00:04:37.273\nthe Red Hat Company and then you have\nUbuntu Linux which is from right?\n\n99\n00:04:37.273 --> 00:04:41.050\nAnd Red Hat are two\ncommercial organizations.\n\n100\n00:04:41.050 --> 00:04:45.960\nYou get Linux from them and\nyou pay them for support.\n\n101\n00:04:45.960 --> 00:04:49.320\nNet support says, if something goes\nwrong you can call them on the phone and\n\n102\n00:04:49.320 --> 00:04:52.130\nthey will help you get through the issues.\n\n103\n00:04:52.130 --> 00:04:53.560\nThat's really important.\n\n104\n00:04:53.560 --> 00:04:57.240\nThey're also reviewing security patches\nand updates and pushing them out and\n\n105\n00:04:57.240 --> 00:04:59.660\nmaking sure that you get up to date right?\n\n106\n00:04:59.660 --> 00:05:02.051\nNow, I mention a moment ago that\nthere's three distributions,\n\n107\n00:05:02.051 --> 00:05:03.191\nI just mentioned two, right?\n\n108\n00:05:03.191 --> 00:05:07.670\nRed Hat Enterprise Linux and\nUbuntu, the third one is CentOS.\n\n109\n00:05:07.670 --> 00:05:13.119\nAnd CentOS is the community enterprise\noperating system, C-E-N-T-O-S and\n\n110\n00:05:13.119 --> 00:05:17.260\nCentOS Is technically Red Hat, right?\n\n111\n00:05:17.260 --> 00:05:19.312\nRed Hat and Ubuntu have kind\nof taken different models for\n\n112\n00:05:19.312 --> 00:05:20.217\nhow their system works.\n\n113\n00:05:20.217 --> 00:05:22.060\nSo let me show you here,\nI'll pull up the web page.\n\n114\n00:05:22.060 --> 00:05:23.810\nLet's start with Ubuntu.\n\n115\n00:05:23.810 --> 00:05:27.270\nSo if you go to Ubuntu's website,\nUbuntu.com, right?\n\n116\n00:05:27.270 --> 00:05:29.910\nThere is a commercial\nentity named Canonical and\n\n117\n00:05:29.910 --> 00:05:32.610\nthey need to make money, they need\nto make money to stay in business.\n\n118\n00:05:32.610 --> 00:05:35.490\nAnd they make their money through support.\n\n119\n00:05:35.490 --> 00:05:39.753\nIf you go to their website and you look up\ntop, there's all these options here and\n\n120\n00:05:39.753 --> 00:05:40.894\nyou'll see server.\n\n121\n00:05:40.894 --> 00:05:44.950\nAnd I can go to server and\nI can learn about their server options.\n\n122\n00:05:44.950 --> 00:05:47.240\nAnd I can download Ubuntu\nserver right here.\n\n123\n00:05:47.240 --> 00:05:49.320\nIf I had just gone straight to downloads,\n\n124\n00:05:49.320 --> 00:05:52.430\nI've got the option of download server or\ndesktop.\n\n125\n00:05:52.430 --> 00:05:55.220\nUnder the hood It's the same Linux Kernel,\n\n126\n00:05:55.220 --> 00:05:59.610\nit's the same core operating system,\nit's just configured differently.\n\n127\n00:05:59.610 --> 00:06:02.780\nA desktop is gonna have a nice\nshiny graphical user interface and\n\n128\n00:06:02.780 --> 00:06:04.660\na bunch of applications pre installed.\n\n129\n00:06:04.660 --> 00:06:07.110\nA server isn't,\na server's gonna be very spartan,\n\n130\n00:06:07.110 --> 00:06:10.560\nvery minimal, no GUI,\nvery few applications.\n\n131\n00:06:10.560 --> 00:06:12.630\nAnd we add just what we need.\n\n132\n00:06:12.630 --> 00:06:15.270\nIt's the same operating system but\nconfigured differently.\n\n133\n00:06:15.270 --> 00:06:18.320\nIn Ubuntu makes it where you can\ndownload either one for free.\n\n134\n00:06:18.320 --> 00:06:22.590\nIf I want to download server I just click\non server and here's my links, right?\n\n135\n00:06:22.590 --> 00:06:24.760\nSo I can download it and install it.\n\n136\n00:06:24.760 --> 00:06:27.180\nI can run Ubuntu Server and\nnever pay them a dime.\n\n137\n00:06:28.300 --> 00:06:31.370\nBut if something goes\nwrong I can't call now\n\n138\n00:06:31.370 --> 00:06:33.810\nunless I have a support agreement, right?\n\n139\n00:06:33.810 --> 00:06:37.380\nAnd if you poke around on their site\nyou'll find where they sell the support\n\n140\n00:06:37.380 --> 00:06:42.530\nagreements where you can basically buy a\ncertain amount of phone calls per year and\n\n141\n00:06:42.530 --> 00:06:44.130\nyou can reach out and contact them.\n\n142\n00:06:44.130 --> 00:06:46.590\nEven if you don't contact them it's\nat least a way to support them and\n\n143\n00:06:46.590 --> 00:06:48.590\ngive them some money so\nthey can stay in business.\n\n144\n00:06:48.590 --> 00:06:51.050\nIf they don't stay in business\nthey stop making the OS and\n\n145\n00:06:51.050 --> 00:06:52.720\nnow you've got a problem right?\n\n146\n00:06:52.720 --> 00:06:55.780\nSo that's the way that Ubuntu works.\n\n147\n00:06:55.780 --> 00:06:58.769\nIf you wanna install Ubuntu you just\ncome here and you download the ISO and\n\n148\n00:06:58.769 --> 00:07:01.027\nyou install it and\nthat's all you have to worry about.\n\n149\n00:07:01.027 --> 00:07:03.310\nRed Hat is a little bit different.\n\n150\n00:07:03.310 --> 00:07:06.842\nOkay, Red Hat works\nthe same it's a Linux OS.\n\n151\n00:07:06.842 --> 00:07:09.330\nBut they charge money for it.\n\n152\n00:07:09.330 --> 00:07:11.540\nOkay, it's more like\nMicrosoft Windows in that respect.\n\n153\n00:07:11.540 --> 00:07:17.817\nIf I wanna run Red Hat Enterprise Linux\nserver it is, I think it starts at $350.\n\n154\n00:07:17.817 --> 00:07:19.430\nI've got to pay $350.\n\n155\n00:07:19.430 --> 00:07:23.235\nBut that gives me an entitlement to\na couple of support phone calls.\n\n156\n00:07:23.235 --> 00:07:26.335\nAnd if I want to run the desktop version,\nRedhat Enterprise Linux Workstation,\n\n157\n00:07:26.335 --> 00:07:28.718\nthat's what I'm running on my laptop,\nyou have to buy that.\n\n158\n00:07:28.718 --> 00:07:31.772\nI think it's $180, something like that.\n\n159\n00:07:31.772 --> 00:07:35.111\nSo you have to pay that and\nthat entitles you to support, right and\n\n160\n00:07:35.111 --> 00:07:38.329\nI think that's [INAUDIBLE] to\nthe forms if I remember right, but\n\n161\n00:07:38.329 --> 00:07:41.470\notherwise you basically\nhave to pay upfront.\n\n162\n00:07:41.470 --> 00:07:43.850\nWell that pay upfront part,\na lot of people don't like.\n\n163\n00:07:43.850 --> 00:07:47.116\nA lot of people, they like being able to\ncall somebody for support and paying for\n\n164\n00:07:47.116 --> 00:07:49.873\nthat support, but they want to be\nable to download the OS for free.\n\n165\n00:07:49.873 --> 00:07:53.990\nAnd, officially the Open Source rules\nof conduct, right the GNU license and\n\n166\n00:07:53.990 --> 00:07:57.409\nall that says, that if you're\nrepackaging the Linux Kernel and\n\n167\n00:07:57.409 --> 00:08:01.207\ndistributing this out you need to be\ndistributing source code as well So\n\n168\n00:08:01.207 --> 00:08:03.829\nRedHat does,\nthey distribute the source code.\n\n169\n00:08:03.829 --> 00:08:08.248\nAnd this organizations CentOS takes\nour source code, recompiles it.\n\n170\n00:08:08.248 --> 00:08:11.180\nThey recompile it without all\nthe RedHat trademarks in it.\n\n171\n00:08:11.180 --> 00:08:15.500\nAnd so, CentOS is effectively RedHat\nenterprise link, it's our ATL, right?\n\n172\n00:08:16.550 --> 00:08:20.260\nExcept when you buy RedHat Enterprise\nLinux from RedHat, and you have a problem,\n\n173\n00:08:20.260 --> 00:08:22.010\nyou can call them for support.\n\n174\n00:08:22.010 --> 00:08:26.450\nWhen you get CentOS from\nthe CentOS website, centos.org,\n\n175\n00:08:26.450 --> 00:08:27.340\nyou can download it for free.\n\n176\n00:08:27.340 --> 00:08:29.480\nAnd if something goes wrong,\nyou can't call anybody.\n\n177\n00:08:29.480 --> 00:08:31.060\nYou definitely can't call Red Hat, right.\n\n178\n00:08:31.060 --> 00:08:34.460\nEven if there's a lot of Red Hat employees\nthat help with the CentOS project and\n\n179\n00:08:34.460 --> 00:08:35.100\nthen they're friendly.\n\n180\n00:08:35.100 --> 00:08:38.420\nThis is not some secret devious\nkind of back alley loo.\n\n181\n00:08:38.420 --> 00:08:42.150\nA lot of Red Hat help with the CentOS\nproject and get it out there.\n\n182\n00:08:42.150 --> 00:08:45.690\nBut CentOS is like a free version of RHEL.\n\n183\n00:08:45.690 --> 00:08:50.960\nSo when you deploy things in, if you go to\nAWS and you start spinning up Linux AMIs\n\n184\n00:08:50.960 --> 00:08:55.490\nin the AWS, Amazon actually uses\nCentOS as the base for that, and\n\n185\n00:08:55.490 --> 00:08:58.580\nCentOS is based on Red Hat, so\nit's really all kind of tied together.\n\n186\n00:08:58.580 --> 00:09:01.470\nSo if you're just learning and\nyou're kind of experimenting around and\n\n187\n00:09:01.470 --> 00:09:03.600\nyou want to learn\nRed Hat Enterprise Linux,\n\n188\n00:09:03.600 --> 00:09:06.800\nusing CentOS is a great way to do it\nbecause they're functionally identical.\n\n189\n00:09:06.800 --> 00:09:09.290\nThere's a couple of closed\nsource binaries that are in\n\n190\n00:09:09.290 --> 00:09:12.870\nthe actual server that aren't\nhere in CentOS, but by and\n\n191\n00:09:12.870 --> 00:09:16.190\nlarge, everything you need\nis right here in CentOS.\n\n192\n00:09:16.190 --> 00:09:17.770\nIf you wanna learn about\nRed Hat Enterprise Linux,\n\n193\n00:09:17.770 --> 00:09:20.880\nyou can actually sign up for a developer\naccount and that will give you license for\n\n194\n00:09:20.880 --> 00:09:22.290\nserver free that you can use.\n\n195\n00:09:22.290 --> 00:09:25.150\nSo you don't have to pay for it but you're\nnot allowed to use it in production.\n\n196\n00:09:25.150 --> 00:09:26.570\nFor learning, it works out really well.\n\n197\n00:09:26.570 --> 00:09:28.470\nThat's part of their developer network.\n\n198\n00:09:28.470 --> 00:09:33.260\nSo these three OSes are really\nthe ones that we're gonna be seeing.\n\n199\n00:09:33.260 --> 00:09:38.790\nRed Hat Enterprise Linux and Ubuntu, and\nCentOS is a mirror of Red Hat, all right?\n\n200\n00:09:38.790 --> 00:09:41.800\nI'm gonna focus in this series,\non Red Hat Enterprise Linux.\n\n201\n00:09:41.800 --> 00:09:44.110\nI'll identify areas that\nare different on Ubuntu.\n\n202\n00:09:44.110 --> 00:09:48.645\nYou'll find, for the most part, everything\nthat we learn works in both platforms, but\n\n203\n00:09:48.645 --> 00:09:50.850\nthere are a few subtle differences that\nyou'll run into every now and then.\n\n204\n00:09:50.850 --> 00:09:54.090\nI'll try to highlight those as we go, but\nI'm gonna focus on Red Hat because it\n\n205\n00:09:54.090 --> 00:09:57.740\nis kind of the, they're the ones\nwho have the major market share in\n\n206\n00:09:57.740 --> 00:10:01.245\nEnterprise server deployments as\nfar as ones with paid support.\n\n207\n00:10:01.245 --> 00:10:04.755\nSo, from their website what you do is,\nyou go,\n\n208\n00:10:04.755 --> 00:10:07.005\nyou find the software,\nand you download it.\n\n209\n00:10:07.005 --> 00:10:09.275\nIf you're using Red Hat,\nyou've gotta go and purchase it, right.\n\n210\n00:10:09.275 --> 00:10:13.785\nSo you'll go in and sign up for a Red Hat\naccount, and you'll purchase the software.\n\n211\n00:10:13.785 --> 00:10:16.560\nOnce you've done that,\nyou have access to their portal.\n\n212\n00:10:16.560 --> 00:10:19.850\nAnd in the portal, you can download\nthe server operating system and\n\n213\n00:10:19.850 --> 00:10:22.320\nthe other products that you might\nhave purchased from them right?\n\n214\n00:10:22.320 --> 00:10:24.700\nWhen you download it,\nit's just an ISO file though, and\n\n215\n00:10:24.700 --> 00:10:29.060\nafter that, everything is just like\nin the system administration show.\n\n216\n00:10:29.060 --> 00:10:33.190\nYou create a USB install media,\nyou plug it in, you boot up off of it and\n\n217\n00:10:33.190 --> 00:10:35.050\nyou perform the install, right.\n\n218\n00:10:35.050 --> 00:10:39.240\nSo that really isn't any different than\nwhat we've seen in previous series.\n\n219\n00:10:39.240 --> 00:10:42.330\nSo if you haven't seen that, jump over to\nsystem administration show and check out.\n\n220\n00:10:42.330 --> 00:10:43.860\nI show you how to build the USB key and\n\n221\n00:10:43.860 --> 00:10:46.270\nall that we've kind of all\nready been through that.\n\n222\n00:10:46.270 --> 00:10:48.920\nBut if you're at the point where you're\nsupporting servers, you more than\n\n223\n00:10:48.920 --> 00:10:53.430\nlikely know it, so I'm not going to\ndouble up on that data right here.\n\n224\n00:10:53.430 --> 00:10:58.250\nOnce we go in here and we download\nthat ISO and we start the install,\n\n225\n00:10:58.250 --> 00:11:02.790\na server install is going to look\nalmost identical to a desktop install.\n\n226\n00:11:02.790 --> 00:11:04.290\nThe difference is going to be what?\n\n227\n00:11:04.290 --> 00:11:08.220\nPackages are installed by default and\nthe choices that we make.\n\n228\n00:11:08.220 --> 00:11:13.110\nSo I wanna walk you through that process\nof getting everything kind of setup, and\n\n229\n00:11:13.110 --> 00:11:16.690\nso what I've got is\na Red Hat Enterprise Linux 7.3 system.\n\n230\n00:11:16.690 --> 00:11:20.280\nThat's the latest version as of\nthe filming of this episode.\n\n231\n00:11:20.280 --> 00:11:21.930\n7.4 is in beta right now.\n\n232\n00:11:21.930 --> 00:11:26.880\nSo if we plug in that USB key and we press\nthe power button, we come right here to\n\n233\n00:11:26.880 --> 00:11:31.550\nthis screen where it offers to install or\nto test the media in install, right?\n\n234\n00:11:31.550 --> 00:11:33.280\nIf this the first time\nyou're using your USB key,\n\n235\n00:11:33.280 --> 00:11:35.960\nit's a good idea to test it just to make\nsure all the data got written properly,\n\n236\n00:11:35.960 --> 00:11:39.140\nand then we can jump and\nperform that install, all right?\n\n237\n00:11:39.140 --> 00:11:42.260\nNow if I were installing\nRedHat Enterprise Linux Workstation, or\n\n238\n00:11:42.260 --> 00:11:44.890\nCentOS, I'd see these same basic screens.\n\n239\n00:11:44.890 --> 00:11:46.790\nThere's really not any difference.\n\n240\n00:11:46.790 --> 00:11:51.110\nBut as we go forward, the decisions that\nI make will be a little bit different.\n\n241\n00:11:51.110 --> 00:11:53.330\nAnd there's two main decisions\nwe're gonna make here.\n\n242\n00:11:53.330 --> 00:11:56.550\nOne, are the packages\nthat I choose to install.\n\n243\n00:11:56.550 --> 00:11:59.280\nI might choose to install a ton\nof packages on a workstation.\n\n244\n00:11:59.280 --> 00:12:04.080\nI might want LibreOffice and\na graphical window environment, and\n\n245\n00:12:04.080 --> 00:12:05.670\nall these other things, right?\n\n246\n00:12:05.670 --> 00:12:08.908\nBut on a server, I don't want any of that.\n\n247\n00:12:08.908 --> 00:12:12.400\nAll I wanna need is the core OS and\n\n248\n00:12:12.400 --> 00:12:15.060\nthen whatever it is I'm\ntrying to do as a server,\n\n249\n00:12:15.060 --> 00:12:19.830\nif I'm trying to be a web server, then\nI need Apache or some other web server.\n\n250\n00:12:19.830 --> 00:12:24.750\nIf I'm trying to be a file server,\nI then need Samba or NFS or whatever.\n\n251\n00:12:24.750 --> 00:12:26.990\nYou need those components, right?\n\n252\n00:12:26.990 --> 00:12:29.512\nBut we'll have to pick and choose those.\n\n253\n00:12:29.512 --> 00:12:32.250\nAll right now when I perform this install,\nwhat you're gonna notice right off the bat\n\n254\n00:12:32.250 --> 00:12:36.790\nis, it's not loading the video card\ndrivers to give me a full 16 by 9\n\n255\n00:12:36.790 --> 00:12:38.730\nresolution, so\nI've got black bars on the side.\n\n256\n00:12:38.730 --> 00:12:43.280\nBut that's okay because we don't\nnormally sit at a server, right?\n\n257\n00:12:43.280 --> 00:12:44.850\nServers are normally deployed in MACs.\n\n258\n00:12:44.850 --> 00:12:47.450\nYou might have hundreds or even thousands\nof servers all in the racks and\n\n259\n00:12:47.450 --> 00:12:49.170\nthey don't have monitors and keyboards.\n\n260\n00:12:49.170 --> 00:12:52.140\nWe normally remote into\nthem to manage them.\n\n261\n00:12:52.140 --> 00:12:55.210\nSo this is really the only\ntime I'm gonna be sitting\n\n262\n00:12:55.210 --> 00:12:57.770\nat the console of this server\nis during this install.\n\n263\n00:12:57.770 --> 00:13:00.600\nI'm gonna walk through this little wizard,\nwe're gonna get it installed, and\n\n264\n00:13:00.600 --> 00:13:04.550\nthen after that, I'm gonna be\nremotely connecting into the system.\n\n265\n00:13:04.550 --> 00:13:07.810\nWe'll SSH in and\nwe'll do everything remotely.\n\n266\n00:13:07.810 --> 00:13:09.690\nSo I'm not really worried\nabout the video card driver.\n\n267\n00:13:09.690 --> 00:13:11.650\nIn fact, in reality,\n\n268\n00:13:11.650 --> 00:13:15.330\nwhen I deploy servers, I don't normally\nbother to load the video card driver.\n\n269\n00:13:15.330 --> 00:13:17.750\nIf it wants to load 4:3, fine, who cares.\n\n270\n00:13:17.750 --> 00:13:20.860\nBecause when you SSH in, you're in\na console, and you don't see that.\n\n271\n00:13:20.860 --> 00:13:26.030\nSame thing for sound card drivers or\nmultimedia devices.\n\n272\n00:13:26.030 --> 00:13:29.230\nI'm not gonna plug headphones into\na server, so I don't care about that.\n\n273\n00:13:29.230 --> 00:13:31.210\nI can skip bypass that.\n\n274\n00:13:31.210 --> 00:13:33.400\nSo I'll go ahead and hit Continue\non this when it moves forward.\n\n275\n00:13:34.570 --> 00:13:39.370\nAnd on this screen, we're gonna have\nthings like our timezone and date and\n\n276\n00:13:39.370 --> 00:13:42.380\ntime on a work station,\nwe don't normally worry that much about.\n\n277\n00:13:42.380 --> 00:13:46.100\nIt's easy to fix later, but on a server,\ndate and time is really important and\n\n278\n00:13:46.100 --> 00:13:48.170\nthat's because of encryption.\n\n279\n00:13:48.170 --> 00:13:51.920\nAnd if you're doing any kind of encrypted\ntunnels or resources like that,\n\n280\n00:13:51.920 --> 00:13:55.800\nthey use time stamps and if the time gets\ntoo far off, it can really cause problems.\n\n281\n00:13:55.800 --> 00:13:58.420\nThe main one we need to pay\nattention to is the time zone\n\n282\n00:13:58.420 --> 00:14:02.230\nbecause it might be 10 o'clock right\nnow in the Eastern time zone, and\n\n283\n00:14:02.230 --> 00:14:06.300\nif I set my computer to 10 o'clock,\nbut it's in the Pacific time zone,\n\n284\n00:14:06.300 --> 00:14:08.840\nnow it's a three-hour difference,\nand it's actually wrong.\n\n285\n00:14:08.840 --> 00:14:11.990\nIt might look right, but it's wrong, and\nthat'll cause encryption to mess up,\n\n286\n00:14:11.990 --> 00:14:14.230\nespecially if you're doing\nKerberos authentication.\n\n287\n00:14:14.230 --> 00:14:15.040\nThat'll really break with that.\n\n288\n00:14:15.040 --> 00:14:17.230\nSo we really need to\nmake sure that's correct.\n\n289\n00:14:17.230 --> 00:14:22.520\nAfter that, notice the software selection\nis defaulting to minimal install.\n\n290\n00:14:22.520 --> 00:14:23.620\nThat's what I want.\n\n291\n00:14:23.620 --> 00:14:25.040\nI want a minimal install.\n\n292\n00:14:25.040 --> 00:14:27.590\nWhen we say minimal, we really mean it.\n\n293\n00:14:27.590 --> 00:14:30.230\nThat installed DVD might\nbe 4 gigs in size.\n\n294\n00:14:30.230 --> 00:14:32.330\nThis installation will\nbe beneath 600 megs.\n\n295\n00:14:32.330 --> 00:14:35.340\nIt's a really really small install because\n\n296\n00:14:35.340 --> 00:14:39.370\nyou don't have all the user LAN stuff\nthat we have in a normal Linux install.\n\n297\n00:14:39.370 --> 00:14:41.390\nBut you can change that if you want.\n\n298\n00:14:41.390 --> 00:14:44.460\nRemember I said if we're building up\na server, it probably has a purpose.\n\n299\n00:14:44.460 --> 00:14:47.380\nWe probably want it to do something,\nto be a database server,\n\n300\n00:14:47.380 --> 00:14:48.790\na file server, or whatever.\n\n301\n00:14:48.790 --> 00:14:50.680\nAnd so if you click on\nthe Software collection here,\n\n302\n00:14:50.680 --> 00:14:54.810\nyou'll see where you can pick from some\nbasic roles that Red Hat has defined.\n\n303\n00:14:54.810 --> 00:15:00.010\nThey defined if you're going to be a file\nand print server or a web server, but\n\n304\n00:15:00.010 --> 00:15:02.880\ndatabase isn't in the list,\nwhat if I wanna be a database server?\n\n305\n00:15:02.880 --> 00:15:05.090\nSometimes you might want something\nthat's not in the list and\n\n306\n00:15:05.090 --> 00:15:06.560\nthen you just have to do it by hand.\n\n307\n00:15:06.560 --> 00:15:09.315\nI usually prefer to do it by hand because\nwhen you choose to do some of these\n\n308\n00:15:09.315 --> 00:15:11.910\npre-built roles,\nthey've got a lot of options over here\n\n309\n00:15:11.910 --> 00:15:15.170\nthat might not necessarily apply to you,\nyou might not know which ones to pick.\n\n310\n00:15:15.170 --> 00:15:19.061\nSo if you do it by hand, you know you're\nputting in just the right one, and so\n\n311\n00:15:19.061 --> 00:15:21.300\nthat's how I'm gonna handle\nthe rest of the episodes.\n\n312\n00:15:21.300 --> 00:15:23.260\nBut you can save some time from here.\n\n313\n00:15:23.260 --> 00:15:26.236\nIf I choose to do a Basic Web Server,\nthen over here, I can kind pick and\n\n314\n00:15:26.236 --> 00:15:28.590\nchoose between a couple\nof different options.\n\n315\n00:15:28.590 --> 00:15:33.970\nBut notice how it never says\nI'm using Apache, right?\n\n316\n00:15:33.970 --> 00:15:36.820\nApache is the most common web\nserver found in Linux and\n\n317\n00:15:36.820 --> 00:15:42.270\nif I look at all my options over here,\nI don't see Apache in the list.\n\n318\n00:15:42.270 --> 00:15:45.600\nOkay, so\nit's just assuming I wanna use Apache.\n\n319\n00:15:45.600 --> 00:15:46.610\nAll right, well, that's okay.\n\n320\n00:15:46.610 --> 00:15:47.770\nI probably would use that.\n\n321\n00:15:47.770 --> 00:15:51.438\nBut if I wanna do some other\nweb server like Lighttpd,\n\n322\n00:15:51.438 --> 00:15:53.729\nit doesn't give me that choice.\n\n323\n00:15:53.729 --> 00:15:56.805\nSo sometimes, these roles don't\nmake the right choice for you.\n\n324\n00:15:56.805 --> 00:15:58.707\nYou might want NGINX or\nsome other utility.\n\n325\n00:15:58.707 --> 00:15:59.554\nIt's not here.\n\n326\n00:15:59.554 --> 00:16:03.212\nSo even though I'm setting up\na web server, I might still choose\n\n327\n00:16:03.212 --> 00:16:07.703\nto do a minimal install, knowing that I\ncan add whatever I want after the fact.\n\n328\n00:16:07.703 --> 00:16:10.800\nAll right, so I'm gonna just\nleave that at minimal install.\n\n329\n00:16:10.800 --> 00:16:13.160\nThen where we're gonna install to.\n\n330\n00:16:13.160 --> 00:16:16.708\nNow, I talked a little bit about\ndis-partitioning back in the system\n\n331\n00:16:16.708 --> 00:16:20.570\nadministration series, but in that\nseries I was focused on workstations.\n\n332\n00:16:21.870 --> 00:16:26.050\nNow we're focused on servers,\nand servers are a lot different.\n\n333\n00:16:26.050 --> 00:16:30.654\nIf I go into that installation destination\nand pick the hard drive that I wanna\n\n334\n00:16:30.654 --> 00:16:35.240\ninstall, on a workstation I don;t really\nworry about partitioning very much.\n\n335\n00:16:35.240 --> 00:16:37.280\nI can just say install everything\non this one drive and it's fine.\n\n336\n00:16:38.280 --> 00:16:42.990\nBut on a server you almost\nalways partition out the disk,\n\n337\n00:16:42.990 --> 00:16:45.330\nyou separate out locations.\n\n338\n00:16:45.330 --> 00:16:47.190\nAnd there's a few different reasons for\nthat, all right?\n\n339\n00:16:47.190 --> 00:16:50.395\nLet me give you a few different reasons\nwhy we might divide our disk up.\n\n340\n00:16:50.395 --> 00:16:52.880\nUsually it's centered around permissions.\n\n341\n00:16:52.880 --> 00:16:55.450\nThat I might have a server application and\n\n342\n00:16:55.450 --> 00:16:59.870\nI only want it to have access\nto certain areas of the disk.\n\n343\n00:16:59.870 --> 00:17:02.265\nThe main reason for that is,\nif a hacker breaks in,\n\n344\n00:17:02.265 --> 00:17:04.006\ncuz this is exposed to the Internet.\n\n345\n00:17:04.006 --> 00:17:06.478\nIf a hacker breaks in and\ntakes over that application,\n\n346\n00:17:06.478 --> 00:17:09.180\nI don't want them being able\nto write anywhere on the disk.\n\n347\n00:17:09.180 --> 00:17:13.000\nThey could actually start seizing\nmore control once they were in.\n\n348\n00:17:13.000 --> 00:17:17.129\nBut if I can create a little jail, right,\na little cage around an application and\n\n349\n00:17:17.129 --> 00:17:18.234\nlimit its exposure.\n\n350\n00:17:18.234 --> 00:17:20.870\nYeah, that application might\nhave gotten compromised, but\n\n351\n00:17:20.870 --> 00:17:22.946\nat least the rest of\nthe system is still intact and\n\n352\n00:17:22.946 --> 00:17:25.390\nthey can't use it to leapfrog\nto other systems, right?\n\n353\n00:17:25.390 --> 00:17:27.220\nThat's one reason to divide it up.\n\n354\n00:17:27.220 --> 00:17:30.800\nAnother reason is,\nwhat if my hard drive gets full?\n\n355\n00:17:30.800 --> 00:17:36.390\nWell, usually on a workstation the system\ngets slow, it annoys us, maybe it crashes.\n\n356\n00:17:36.390 --> 00:17:38.400\nOn a server the same thing can happen,\n\n357\n00:17:38.400 --> 00:17:42.420\nexcept when it crashes now a lot more\npeople are affected by it, right?\n\n358\n00:17:42.420 --> 00:17:47.510\nSo we need to make sure that we take\nanything we expect to grow rapidly and\n\n359\n00:17:47.510 --> 00:17:48.460\npartition that out.\n\n360\n00:17:48.460 --> 00:17:51.940\nMove it separate, and then that way\nwe don't have to worry about it.\n\n361\n00:17:51.940 --> 00:17:55.130\nIf that fills up, it doesn't affect\nthe regular operating system.\n\n362\n00:17:55.130 --> 00:17:56.661\nSo we will want to divide it up a bit.\n\n363\n00:17:56.661 --> 00:18:01.240\nNow, most distributions will give\nyou kind of a sampling, right?\n\n364\n00:18:01.240 --> 00:18:07.330\nIf I choose to go with this disk and\nI do automatic partitioning, it'll try and\n\n365\n00:18:07.330 --> 00:18:10.910\ndivide this up appropriately for me so\nI don't have to worry about it, right?\n\n366\n00:18:10.910 --> 00:18:17.210\nBut down here we can actually\ncustomize a lot of that.\n\n367\n00:18:17.210 --> 00:18:19.280\nAnd what I'll see is, if I click Done,\n\n368\n00:18:20.810 --> 00:18:25.430\nthat it's telling me automatic\npartitioning is selected.\n\n369\n00:18:25.430 --> 00:18:29.090\nBut I don't want it to be automatic,\nI want to customize it.\n\n370\n00:18:29.090 --> 00:18:31.450\nAnd so when we go back in here and\nwe take a look at the disk,\n\n371\n00:18:31.450 --> 00:18:33.470\nwe can customize what that\npartitioning is gonna be.\n\n372\n00:18:33.470 --> 00:18:36.120\nAnd the option isn't showing up here,\nit's kind of hard to see, but\n\n373\n00:18:36.120 --> 00:18:38.400\nI actually do have a scroll bar over here.\n\n374\n00:18:38.400 --> 00:18:41.610\nAnd if I scroll down, there we go,\n\n375\n00:18:41.610 --> 00:18:45.350\nI can tell it how I want to\nconfigure the partitioning.\n\n376\n00:18:45.350 --> 00:18:49.005\nAnd that's because Red Hat knows\nwhat the standard server needs,\n\n377\n00:18:49.005 --> 00:18:52.799\nthey don't know what your server needs,\nor Ubuntu for that matter.\n\n378\n00:18:52.799 --> 00:18:56.610\nNobody knows how you're going to\ndeploy the server, only you know that.\n\n379\n00:18:56.610 --> 00:18:59.267\nSo we need a chance to apply our\nknowledge and get that set up.\n\n380\n00:18:59.267 --> 00:19:02.385\nSo I'm gonna choose that I'll configure\nthe partition and I'll hit Done.\n\n381\n00:19:02.385 --> 00:19:06.760\nAnd now I've got the chance to go in and\nlay it out myself, okay?\n\n382\n00:19:06.760 --> 00:19:10.750\nNow when you look at it, it's gonna\ndefault to wanting to use the LVM.\n\n383\n00:19:10.750 --> 00:19:12.810\nThe LVM is the Logical Volume Manager.\n\n384\n00:19:12.810 --> 00:19:16.150\nAnd the Logical Volume Manager\nis a really handy utility.\n\n385\n00:19:16.150 --> 00:19:18.920\nBack in the workstation side,\nwe saw the LVM because,\n\n386\n00:19:18.920 --> 00:19:23.070\nwell, back on the workstation side I said\nhow we didn't necessarily need the LVM.\n\n387\n00:19:23.070 --> 00:19:26.025\nBecause you're not normally adding\nextra hard drives to a workstation, and\n\n388\n00:19:26.025 --> 00:19:28.240\nchanging it, but servers, you do.\n\n389\n00:19:28.240 --> 00:19:31.540\nServers we constantly add new hard\ndrives as they expand and they grow.\n\n390\n00:19:31.540 --> 00:19:34.020\nAnd so the Logical Volume Manager\nallows us to do that,\n\n391\n00:19:34.020 --> 00:19:37.440\nallows us to expand the disks and\nadd more storage to them.\n\n392\n00:19:37.440 --> 00:19:40.030\nIf you're not familiar with the LVM,\nthis is another area where you wanna jump\n\n393\n00:19:40.030 --> 00:19:41.990\nback to the system\nadministration episodes.\n\n394\n00:19:41.990 --> 00:19:44.550\nAnd you get a chance to see how\nto use it and manipulate it.\n\n395\n00:19:44.550 --> 00:19:45.910\nNow, I am going to use the LVM.\n\n396\n00:19:45.910 --> 00:19:50.380\nAnd I'm gonna do this click here\nto create automatically link.\n\n397\n00:19:50.380 --> 00:19:55.350\nAnd that's gonna lay out the default\nlayout that Red Hat recommends, right?\n\n398\n00:19:55.350 --> 00:19:58.460\nSo had I gone with automatic partitioning,\nthis is what it would've done,\n\n399\n00:19:58.460 --> 00:20:00.540\nbut I'm gonna change it.\n\n400\n00:20:00.540 --> 00:20:04.990\nBecause they didn't know I was gonna\nset this up as a web server and I am.\n\n401\n00:20:04.990 --> 00:20:10.190\nAnd so I wanna add a separate\npartition for my web server to use.\n\n402\n00:20:10.190 --> 00:20:12.908\nNow, it's allocated all my space out.\n\n403\n00:20:12.908 --> 00:20:14.740\nI'm got a 256 gig drive and\n\n404\n00:20:14.740 --> 00:20:17.129\nit's allocated all that space\nacross these different systems.\n\n405\n00:20:18.150 --> 00:20:21.945\nYou'll see the root of the operating\nsystem it gave it 50 gigs,\n\n406\n00:20:21.945 --> 00:20:25.951\nmy swap file it gave that 4 gigs,\nmy boot partition it gave it 1 gig.\n\n407\n00:20:25.951 --> 00:20:32.101\nAnd then everything that was left over\nwent into /home, user home directories.\n\n408\n00:20:32.101 --> 00:20:36.651\nBecause they assume you're gonna run\napplications or whatever, but I'm not.\n\n409\n00:20:36.651 --> 00:20:40.817\nSo I'm gonna take that partition and\nI'm gonna shrink it down, and\n\n410\n00:20:40.817 --> 00:20:43.178\nmaybe I'll just make it 100 gigs.\n\n411\n00:20:43.178 --> 00:20:47.740\nSo I'm gonna shrink that one down,\nI'll hit Update Settings.\n\n412\n00:20:47.740 --> 00:20:51.360\nAnd now the home partition is 100 gigs,\nand now I've got some free space.\n\n413\n00:20:51.360 --> 00:20:53.400\nSo down here I can see I've\ngot 100 gigs of free space.\n\n414\n00:20:53.400 --> 00:20:57.040\nSo I'm gonna add another 100\ngig partition, all right?\n\n415\n00:20:57.040 --> 00:20:59.980\nSo I'll just put in here that\nit's gonna be 100 gigabytes.\n\n416\n00:20:59.980 --> 00:21:03.270\nAnd for the mount point,\nwhere do I want this mounted?\n\n417\n00:21:03.270 --> 00:21:08.586\nI'm gonna mount this in /var/www.\n\n418\n00:21:08.586 --> 00:21:13.868\nIf you install Apache, the default\nlocation of its web files is /var/www.\n\n419\n00:21:13.868 --> 00:21:15.454\nNow, how did I know to do that?\n\n420\n00:21:15.454 --> 00:21:16.880\nWell, I know Apache.\n\n421\n00:21:16.880 --> 00:21:18.900\nIf you know the server that\nyou're gonna be working with,\n\n422\n00:21:18.900 --> 00:21:20.480\nyou know where to place this data.\n\n423\n00:21:20.480 --> 00:21:24.150\nSo it is important to learn about\nthe service you're wanting to deploy.\n\n424\n00:21:24.150 --> 00:21:26.900\nMaybe I didn't know about Apache, or\nmaybe I'm learning some other web service.\n\n425\n00:21:26.900 --> 00:21:30.800\nI don't have to put it there,\nI could put it in /website.\n\n426\n00:21:30.800 --> 00:21:34.130\nI'm gonna make a folder called /website\nand that's where it's gonna go.\n\n427\n00:21:34.130 --> 00:21:36.720\nThat is gonna have some ramifications\nI'll show you a little bit later,\n\n428\n00:21:36.720 --> 00:21:38.040\nbut you're welcome to do it.\n\n429\n00:21:38.040 --> 00:21:39.820\nYou can, you control your file system,\n\n430\n00:21:39.820 --> 00:21:41.760\nyou can put the stuff wherever you want,\nall right?\n\n431\n00:21:41.760 --> 00:21:44.570\nBut I'll show you a little bit later\nwhere that can cause some problems.\n\n432\n00:21:44.570 --> 00:21:45.320\nI'm gonna go ahead and\n\n433\n00:21:45.320 --> 00:21:51.160\nput mine in /var/www because\nthat's where I want it to go.\n\n434\n00:21:51.160 --> 00:21:54.306\nOr actually we'll highlight the problem,\nI'm wishy-washy today, Zack.\n\n435\n00:21:54.306 --> 00:21:56.291\n&gt;&gt; [LAUGH]\n&gt;&gt; So I'm gonna put it back in website.\n\n436\n00:21:56.291 --> 00:21:58.498\n&gt;&gt; Well, there are so many options\n&gt;&gt; I tell ya what.\n\n437\n00:21:58.498 --> 00:21:59.057\n&gt;&gt; So many.\n\n438\n00:21:59.057 --> 00:22:03.760\n&gt;&gt; And the truth of this is I can always\nchange my mind later, I likely will.\n\n439\n00:22:03.760 --> 00:22:07.120\n[LAUGH] And so we can just remount\nthis to another location later.\n\n440\n00:22:07.120 --> 00:22:08.516\nThis isn't necessarily binding,\n\n441\n00:22:08.516 --> 00:22:10.897\nthe important part is that I\ncreated the partition, right?\n\n442\n00:22:10.897 --> 00:22:13.620\nCuz that's hard to do after the fact.\n\n443\n00:22:13.620 --> 00:22:15.680\nSo now I've kind of set this up.\n\n444\n00:22:15.680 --> 00:22:18.160\nThey didn't know I wanted that,\nI had to tell it.\n\n445\n00:22:18.160 --> 00:22:20.210\nIn fact,\nI'm leaving a little extra space here.\n\n446\n00:22:20.210 --> 00:22:22.570\nNot much, a little over gig,\nbut I'll ignore that.\n\n447\n00:22:22.570 --> 00:22:25.010\nSo we've got that in place.\n\n448\n00:22:25.010 --> 00:22:26.950\nThere we go, I'll go ahead and hit Done.\n\n449\n00:22:26.950 --> 00:22:30.610\nSo be aware that if you're\nsetting up a web server,\n\n450\n00:22:30.610 --> 00:22:33.700\nyou might wanna put your web\nfiles into one location.\n\n451\n00:22:33.700 --> 00:22:37.080\nIf you're setting up a database server,\nyou likely want your database files in\n\n452\n00:22:37.080 --> 00:22:39.850\none location and\nyour transaction logs in another.\n\n453\n00:22:39.850 --> 00:22:43.101\nAnd these might be completely separate\nhard drives, not partitions, but\n\n454\n00:22:43.101 --> 00:22:44.655\ncompletely separate hard drives.\n\n455\n00:22:44.655 --> 00:22:47.203\nDifferent servers have different needs.\n\n456\n00:22:47.203 --> 00:22:51.269\nAnd during the install this is really\nprobably the most critical piece right\n\n457\n00:22:51.269 --> 00:22:55.461\nhere, cuz if you misconfigure your\nstorage, it's really hard to fix later on\n\n458\n00:22:55.461 --> 00:22:59.610\nwithout having to just wipe the system and\nreload it, which we want to avoid.\n\n459\n00:22:59.610 --> 00:23:02.042\nAll right, I'm gonna go ahead and\naccept these changes, and so\n\n460\n00:23:02.042 --> 00:23:03.630\nit'll write that to disk.\n\n461\n00:23:03.630 --> 00:23:08.302\nThen we have a couple other things\nwe need to decide about, networking.\n\n462\n00:23:08.302 --> 00:23:12.687\nIn a lot of distributions, when you do\na minimal install, they take minimal\n\n463\n00:23:12.687 --> 00:23:16.676\nto the extreme, so extreme that\nthey don't configure networking.\n\n464\n00:23:16.676 --> 00:23:19.282\nSo when the system reboots and\ncomes up the first time,\n\n465\n00:23:19.282 --> 00:23:20.822\nyou've got no network access.\n\n466\n00:23:20.822 --> 00:23:22.665\nYou can't reach out there and\ndo updates, and\n\n467\n00:23:22.665 --> 00:23:24.850\nyou've gotta go and\nconfigure the network adapters.\n\n468\n00:23:24.850 --> 00:23:27.500\nAnd that's kind of a pain, so\nI recommend you configure it here so\n\n469\n00:23:27.500 --> 00:23:30.200\nyou don't have to worry about it, but\nI'll show you how to do it by hand later.\n\n470\n00:23:30.200 --> 00:23:32.810\nBut if I click on that network and\nhost name, I can come in and\n\n471\n00:23:32.810 --> 00:23:33.860\nI can configure that adapter.\n\n472\n00:23:33.860 --> 00:23:38.132\nI'm gonna say I want this adapter on,\nand you can assign a static IP,\n\n473\n00:23:38.132 --> 00:23:40.504\nor I'll just use a DHCP address here.\n\n474\n00:23:40.504 --> 00:23:42.940\nBut you can configure\nwhat you want that to be.\n\n475\n00:23:42.940 --> 00:23:46.117\nOr here I'll change it up,\nI'm all about changing my mind today,\n\n476\n00:23:46.117 --> 00:23:49.440\nso I'll go ahead and tell it-\n&gt;&gt; Options, options, options.\n\n477\n00:23:49.440 --> 00:23:51.232\n&gt;&gt; I'll tell it I want a static IP,\njust so I can remember it.\n\n478\n00:23:51.232 --> 00:23:54.582\nSo I'm gonna come in and\ntell it I'm gonna do a manual IP, and\n\n479\n00:23:54.582 --> 00:23:56.971\nI'll add in what I want\nthat address to be.\n\n480\n00:23:56.971 --> 00:23:59.951\nI'll use 172.16.0.100.\n\n481\n00:23:59.951 --> 00:24:03.712\nAnd I think I'm actually\nusing a /24 on that so\n\n482\n00:24:03.712 --> 00:24:08.350\nlet me put that there and\nI'll put in my default gateway.\n\n483\n00:24:08.350 --> 00:24:13.030\nThis is all stuff that I could easily\nadd after the fact, but right now\n\n484\n00:24:13.030 --> 00:24:15.990\nI've got a graphical user interface,\nso why not take advantage of it.\n\n485\n00:24:15.990 --> 00:24:18.850\nI'll show you the config files,\nnow we can do it by hand afterwards,\n\n486\n00:24:18.850 --> 00:24:21.979\nbut this certainly is\nthe easier way to go about it.\n\n487\n00:24:23.680 --> 00:24:24.490\nSo we'll get that put in there.\n\n488\n00:24:24.490 --> 00:24:28.100\nSo there, it's got my information in\nplace and now we can move forward.\n\n489\n00:24:29.150 --> 00:24:32.510\nThe other thing is we've got a couple\ninteresting options over here, Kdump and\n\n490\n00:24:32.510 --> 00:24:33.210\nSecurity Policy.\n\n491\n00:24:34.280 --> 00:24:36.370\nKdump is a kernel dump.\n\n492\n00:24:36.370 --> 00:24:41.300\nWhen a crash happens on your server,\nif that happens, if a crash happens\n\n493\n00:24:41.300 --> 00:24:45.750\nit'll take what memory the kernel was\nusing and write it to the hard drive.\n\n494\n00:24:45.750 --> 00:24:47.770\nThat's useful for\ntroubleshooting purposes.\n\n495\n00:24:47.770 --> 00:24:51.640\nIf you're dealing with support and you\ntell them you had a crash, you can send\n\n496\n00:24:51.640 --> 00:24:55.620\nthem that kernel dump file and they can\nlook at it and try to find the problem.\n\n497\n00:24:56.630 --> 00:24:59.040\nBut at the same time its kind\nof a double-edged sword.\n\n498\n00:24:59.040 --> 00:25:02.680\nBecause there might be sensitive\ndata in that kernel dump file and\n\n499\n00:25:02.680 --> 00:25:05.030\nnow it's saved right there\non your hard drive, and\n\n500\n00:25:05.030 --> 00:25:07.790\nan attacker might be able to gain\naccess to that and look in that memory.\n\n501\n00:25:07.790 --> 00:25:13.820\nSo on a server often times we don't\nturn this on by default we leave it off.\n\n502\n00:25:13.820 --> 00:25:17.020\nAnd then when you're seeing a crash you'd\ngo and turn it on in a testing system or\n\n503\n00:25:17.020 --> 00:25:19.640\nwhatever and recreate the crash\nwhere you've got the dump there.\n\n504\n00:25:19.640 --> 00:25:22.350\nSo here it's saying kdump is\nenabled I'm gonna come in and\n\n505\n00:25:22.350 --> 00:25:25.240\nturn that off so\nthat I don't have to worry about that.\n\n506\n00:25:25.240 --> 00:25:29.170\nI need to be aware of crashes, I just\ndon't want memory dumps laying around on\n\n507\n00:25:29.170 --> 00:25:32.090\nthe disk that I might forget about or\nnot maintain.\n\n508\n00:25:33.540 --> 00:25:34.890\nAnd then the security policy,\n\n509\n00:25:34.890 --> 00:25:38.150\nit says no profile selected\nthat's probably not a good thing.\n\n510\n00:25:38.150 --> 00:25:42.570\nI need a default security profile I could\nconfigure it by hand, but they're really,\n\n511\n00:25:42.570 --> 00:25:46.020\nreally hard to configure and\nget right, easy to make mistakes.\n\n512\n00:25:46.020 --> 00:25:49.480\nSo it's better to start\nwith a template profile and\n\n513\n00:25:49.480 --> 00:25:52.020\nthen adjust it to meet your needs.\n\n514\n00:25:52.020 --> 00:25:55.330\nAnd Red Hat has a standard system\nsecurity profile that I can use,\n\n515\n00:25:55.330 --> 00:25:56.930\nand then modify that one.\n\n516\n00:25:56.930 --> 00:25:58.730\nAnd that's what I usually choose.\n\n517\n00:25:58.730 --> 00:26:01.780\nNotice as a default,\nbe really careful with this one.\n\n518\n00:26:01.780 --> 00:26:08.840\nIf you look closely at that default, It\nactually says the implicit XCCDF profile.\n\n519\n00:26:08.840 --> 00:26:10.820\nUsually, the default contains no rules.\n\n520\n00:26:11.850 --> 00:26:13.910\nSo, it's empty.\n\n521\n00:26:13.910 --> 00:26:16.855\nYeah.\n[LAUGH] An empty profile is like,\n\n522\n00:26:16.855 --> 00:26:18.010\nsaid anything.\n\n523\n00:26:18.010 --> 00:26:21.680\nSo that would be if you wanna start\nfrom scratch and set it up yourself.\n\n524\n00:26:21.680 --> 00:26:26.120\nNormally, we wanna go to this guy right\nhere, standard systems security profile.\n\n525\n00:26:26.120 --> 00:26:27.770\nThat's going to apply to SELinux and\n\n526\n00:26:27.770 --> 00:26:30.770\na couple of other restrictions on this\nsystem that's going to protect it.\n\n527\n00:26:30.770 --> 00:26:32.680\nAnd then we can loosen that up as we need.\n\n528\n00:26:32.680 --> 00:26:36.550\nThere's more stringent security\nrestrictions that are defined by the US\n\n529\n00:26:36.550 --> 00:26:37.890\ngovernment and other organizations.\n\n530\n00:26:37.890 --> 00:26:40.310\nThere's PCI,\nwhich is the payment card industry.\n\n531\n00:26:40.310 --> 00:26:43.660\nC2S the common criteria or\ncommercial cloud services.\n\n532\n00:26:43.660 --> 00:26:47.370\nYou got a couple of different\norganizations that are all vying for\n\n533\n00:26:47.370 --> 00:26:48.452\nthat space.\n\n534\n00:26:48.452 --> 00:26:54.470\nAnd as I scroll down here, you'll just see\nthere's a whole list of different ones.\n\n535\n00:26:54.470 --> 00:26:59.300\nRed Hat corporate profiles for certified\ncloud providers and in other ones\n\n536\n00:26:59.300 --> 00:27:02.950\nthat are, I thought common criteria was\nin here somewhere, but I don't see it.\n\n537\n00:27:02.950 --> 00:27:06.580\nSo anyhow, you choose what level it\nis that you're trying to provide.\n\n538\n00:27:06.580 --> 00:27:09.072\nI'm gonna go with the standard profile,\n\n539\n00:27:09.072 --> 00:27:12.428\nbecause we're gonna be\nadjusting that in a little bit.\n\n540\n00:27:12.428 --> 00:27:14.960\nAnd then this is a tricky one.\n\n541\n00:27:14.960 --> 00:27:16.090\nI forget this myself a lot.\n\n542\n00:27:16.090 --> 00:27:18.390\nYou have to make sure you\nclick select profile.\n\n543\n00:27:18.390 --> 00:27:22.620\nIf you just click done it doesn't actually\nselect it, so I'm gonna hit select profile\n\n544\n00:27:22.620 --> 00:27:26.620\nso that it updates right there and\nthen I'll hit, Done.\n\n545\n00:27:26.620 --> 00:27:29.245\nSo now I've got a security profile\nthat says everything is okay.\n\n546\n00:27:29.245 --> 00:27:31.224\nEverything is okay.\n\n547\n00:27:31.224 --> 00:27:33.052\n[LAUGH]\n&gt;&gt; [LAUGH] No worries\n\n548\n00:27:33.052 --> 00:27:34.043\nMike\n&gt;&gt; That's\n\n549\n00:27:34.043 --> 00:27:34.690\nright\n&gt;&gt; [LAUGH]\n\n550\n00:27:34.690 --> 00:27:36.600\n&gt;&gt; We'll go on and hit Begin Installation\n\n551\n00:27:36.600 --> 00:27:38.040\nand now it's going.\n\n552\n00:27:38.040 --> 00:27:41.420\nNow I mentioned this was gonna be the only\ntime I'm really sitting at this console.\n\n553\n00:27:41.420 --> 00:27:44.540\nSo I need to set my root password so\nI'll be able to log in to it.\n\n554\n00:27:44.540 --> 00:27:48.200\nAnd I need to create a user account for\nmyself so I can remote in and\n\n555\n00:27:48.200 --> 00:27:51.370\ndo everything else\nremotely on this system.\n\n556\n00:27:51.370 --> 00:27:53.690\nSo I'm gonna set that\nroot password real quick.\n\n557\n00:27:55.480 --> 00:27:57.210\nAnd we'll get that put in place.\n\n558\n00:27:57.210 --> 00:27:59.270\nAnd then I'll do the same thing for\nthe user account.\n\n559\n00:27:59.270 --> 00:28:02.940\nI must not have typed the same thing\ntwice so let's try that again.\n\n560\n00:28:04.890 --> 00:28:08.750\nI'm using a intentionally weak password so\nit's complaining a little bit about that\n\n561\n00:28:08.750 --> 00:28:11.970\nbut if you click [INAUDIBLE]\ntwice it'll get you around that.\n\n562\n00:28:11.970 --> 00:28:13.780\nShoot, my caps lock was on.\n\n563\n00:28:13.780 --> 00:28:15.430\nThat's gonna cause a problem.\n\n564\n00:28:15.430 --> 00:28:19.550\nSo let me, then so I'm gonna create\na user account for myself now.\n\n565\n00:28:19.550 --> 00:28:21.420\nThis user account might be\na temporary thing, just for\n\n566\n00:28:21.420 --> 00:28:24.010\nthe first time that you login and\nget things set up.\n\n567\n00:28:24.010 --> 00:28:27.420\nBut you do need to create a user cuz a lot\nof distribution out there will prohibit\n\n568\n00:28:27.420 --> 00:28:28.960\nroot from using SSH.\n\n569\n00:28:28.960 --> 00:28:31.330\nSo you can't remote with\nadministrator account.\n\n570\n00:28:31.330 --> 00:28:36.180\nSo I'm gonna go ahead and\nuse that one and set it up again.\n\n571\n00:28:36.180 --> 00:28:40.280\nI can always remove it after the fact\nif I need to and I'm gonna go and\n\n572\n00:28:40.280 --> 00:28:44.800\njust redo that root password, just because\nI'm not positive if my caps lock was on or\n\n573\n00:28:44.800 --> 00:28:45.630\nnot when I did it.\n\n574\n00:28:47.580 --> 00:28:50.310\nSo let's try that, there we go.\n\n575\n00:28:50.310 --> 00:28:53.000\nAnd now that's gonna churn through and\ndo the installation.\n\n576\n00:28:53.000 --> 00:28:59.091\nNow technically that brings\nus to the end of step one.\n\n577\n00:28:59.091 --> 00:29:02.070\nI figured we'd get further in this\nepisode but that's the end of step one.\n\n578\n00:29:02.070 --> 00:29:06.560\nIt's doing the install,\nwhen it's done it's going to reboot and\n\n579\n00:29:06.560 --> 00:29:08.580\neverything's been working great so far.\n\n580\n00:29:08.580 --> 00:29:11.720\nI haven't had any problems I've been\nable to navigate through my windows and\n\n581\n00:29:11.720 --> 00:29:14.880\nall that but\njust because the installer ran great\n\n582\n00:29:14.880 --> 00:29:18.410\ndoesn't mean the actual\ninstall went great.\n\n583\n00:29:18.410 --> 00:29:21.740\nWhen you reboot you may have\nhardware that didn't get detected,\n\n584\n00:29:21.740 --> 00:29:24.860\nyou may have other problems\nthat we just didn't see.\n\n585\n00:29:24.860 --> 00:29:29.940\nSo as part of any install, the next step\nwould be to verify the installation,\n\n586\n00:29:29.940 --> 00:29:32.000\nto make sure all your\nhardware was detected.\n\n587\n00:29:32.000 --> 00:29:34.740\nAnd if you haven't watched our\nLinux system administration series,\n\n588\n00:29:34.740 --> 00:29:35.920\nI definitely encourage\nyou to jump back and\n\n589\n00:29:35.920 --> 00:29:38.500\ncheck that out because I show\nyou the hardware process there.\n\n590\n00:29:38.500 --> 00:29:41.700\nHow to detect all of\nyour hardware on servers,\n\n591\n00:29:41.700 --> 00:29:45.760\nall we normally care about our\nnetwork adapters and rate controllers.\n\n592\n00:29:45.760 --> 00:29:47.350\nThe rate controllers\nwill determine whether or\n\n593\n00:29:47.350 --> 00:29:48.920\nnot your hard drives were detected.\n\n594\n00:29:48.920 --> 00:29:50.590\nThe network adapters are whether\nyou can talk on the network.\n\n595\n00:29:50.590 --> 00:29:52.090\nSo we need to verify those are there,\n\n596\n00:29:52.090 --> 00:29:54.640\nand I show you how to do that in\nthe systems administration series.\n\n597\n00:29:54.640 --> 00:29:57.940\nBut, definitely,\nmake sure you verify that install.\n\n598\n00:29:57.940 --> 00:30:00.970\nAfter that, we are technically\ndone with the installation,\n\n599\n00:30:00.970 --> 00:30:02.910\nand we're ready to customize\nit to meet our needs.\n\n600\n00:30:04.440 --> 00:30:07.890\nAll right, well instead of sitting here\nwaiting, looks like it's about 50% done.\n\n601\n00:30:07.890 --> 00:30:11.590\nIt's actually done copying the files cuz\nit's not really a whole lot of files, but\n\n602\n00:30:11.590 --> 00:30:12.870\nnow it's configuring add-ons and\nother things.\n\n603\n00:30:12.870 --> 00:30:16.070\nSo we gotta give a little\ntime to finish that install.\n\n604\n00:30:16.070 --> 00:30:20.800\nWhy don't we stop here and\nwe'll do a part two in this series, and\n\n605\n00:30:20.800 --> 00:30:24.130\nin part two, I wanna show you the initial\nconfiguration of this machine,\n\n606\n00:30:24.130 --> 00:30:26.420\nwhat we need to get it actually setup.\n\n607\n00:30:26.420 --> 00:30:27.690\nTo be able to start using it.\n\n608\n00:30:27.690 --> 00:30:31.020\nAnd we'll tackle that as soon is\nthis install is done in part two.\n\n609\n00:30:31.020 --> 00:30:32.400\n&gt;&gt; Awesome job, Don.\n\n610\n00:30:32.400 --> 00:30:36.570\nBecoming a Linux server administrator,\ninstalling Linux as a server.\n\n611\n00:30:36.570 --> 00:30:37.900\nThis has been part one.\n\n612\n00:30:37.900 --> 00:30:39.410\nAny final words?\n\n613\n00:30:39.410 --> 00:30:42.580\n&gt;&gt; Main thing here is pay\nattention during the install.\n\n614\n00:30:42.580 --> 00:30:46.010\nDon't just click Next 15 times,\nbecause on a server there's changes.\n\n615\n00:30:46.010 --> 00:30:47.840\nAnd we need to be involved\nin every decision so\n\n616\n00:30:47.840 --> 00:30:49.900\nwe know we're making the right ones.\n\n617\n00:30:49.900 --> 00:30:52.210\nAnd make sure you practice this stuff.\n\n618\n00:30:52.210 --> 00:30:54.610\nPractice in a lab before you\nroll it out in production.\n\n619\n00:30:54.610 --> 00:30:56.810\nBecause if this is exposed\nto the Internet and\n\n620\n00:30:56.810 --> 00:31:00.090\nyou missed some security setting,\nthe hackers won't miss it.\n\n621\n00:31:00.090 --> 00:31:00.950\nThey'll find that.\n\n622\n00:31:00.950 --> 00:31:03.269\nSo we need to make sure that we're\ntaking the proper precautions.\n\n623\n00:31:04.340 --> 00:31:07.720\n&gt;&gt; Well, installing Linux as a server,\npart two, it'll be soon.\n\n624\n00:31:07.720 --> 00:31:10.920\nAnd you wanna watch\neverything in the Becoming\n\n625\n00:31:10.920 --> 00:31:12.780\na Linux Server Administrator series.\n\n626\n00:31:12.780 --> 00:31:14.090\nYou'll be glad you did.\n\n627\n00:31:14.090 --> 00:31:16.040\nAnd thank you for watching ITProTV.\n\n628\n00:31:16.040 --> 00:31:18.520\nRemember, a good IT pro\nis always learning.\n\n629\n00:31:18.520 --> 00:31:19.430\nI'm Zach Memos.\n\n630\n00:31:19.430 --> 00:31:20.360\n&gt;&gt; And I'm Don Pezet.\n\n631\n00:31:20.360 --> 00:31:22.840\n&gt;&gt; And we'll see you very soon.\n\n632\n00:31:22.840 --> 00:31:28.768\n[MUSIC]\n\n633\n00:31:28.768 --> 00:31:31.683\nThank you for watching ITPro TV.\n\n",
          "vimeoId": "225992051"
        },
        {
          "description": "Don and Zach continue to cover Installing Linux As A Server, what kind of configuration is needed from the start, configuring the Server, Licensing, Networking, Drivers, Default Files, User Accounts, starting the Server, performing updates, and performing a reboot.",
          "length": "1388",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-1-2-installing_linux_as_a_server_pt_2-071717-PGM.00_23_47_08.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-1-2-installing_linux_as_a_server_pt_2-071717-PGM.00_23_47_08.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-1-2-installing_linux_as_a_server_pt_2-071717-PGM.00_23_47_08.Still001-sm.jpg",
          "title": "Installing Linux as a Server Part 2",
          "transcript": "",
          "vimeoId": "225992841"
        },
        {
          "description": "Don and Zach cover what we need to do to secure the server, configuring passwords, configuring certificates, configure firewall, determine default zone, allow a standard service through firewall, adding custom services, allowing a non-standard service through firewall, configure TCP Wrappers, configure SELinux, view SELinux log, configure service related security, monitoring the Server, and performing updates.",
          "length": "2413",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-2-1-hardening_a_linux_server-071717-PGM.00_40_30_19.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-2-1-hardening_a_linux_server-071717-PGM.00_40_30_19.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-2-1-hardening_a_linux_server-071717-PGM.00_40_30_19.Still001-sm.jpg",
          "title": "Hardening a Linux Server",
          "transcript": "WEBVTT\n\n1\n00:00:00.220 --> 00:00:07.529\nWelcome to ITProTV [CROSSTALK]\n\n2\n00:00:07.529 --> 00:00:11.465\n&gt;&gt; You're watching ITProTV.\n\n3\n00:00:11.465 --> 00:00:14.640\n&gt;&gt; Hello again and\nthank you for watching ITProTV.\n\n4\n00:00:14.640 --> 00:00:19.030\nHelping you learn wherever you go,\nI'm your host Zach Memos as we continue on\n\n5\n00:00:19.030 --> 00:00:21.400\nwith becoming a Linux\nserver administrator.\n\n6\n00:00:21.400 --> 00:00:27.130\nAnd this is hardening a Linux server and\nit's gonna be interesting and wonderful.\n\n7\n00:00:27.130 --> 00:00:30.540\nAnd Don Pezet is gonna bring us all the\ninformation we need because he knows so\n\n8\n00:00:30.540 --> 00:00:31.870\nmuch about it.\n\n9\n00:00:31.870 --> 00:00:33.200\nDon't you?\n&gt;&gt; [LAUGH] I try.\n\n10\n00:00:33.200 --> 00:00:36.300\nWell, you know in this episode like Zach\nsaid we are going to be tackling hardening\n\n11\n00:00:36.300 --> 00:00:37.370\na Linux server.\n\n12\n00:00:37.370 --> 00:00:39.270\nWhen you do a default install and\n\n13\n00:00:39.270 --> 00:00:43.400\nyou install any of them Ubuntu,\nRed Hat or whatever.\n\n14\n00:00:43.400 --> 00:00:46.080\nThe default operating system\n\n15\n00:00:46.080 --> 00:00:49.810\nis configure in a way to make it the most\nconvenient for the most users, and\n\n16\n00:00:49.810 --> 00:00:53.750\nthat means that it's not necessarily\nconfigured as securely as possible.\n\n17\n00:00:53.750 --> 00:00:54.940\nSo whenever we deploy a new system,\n\n18\n00:00:54.940 --> 00:00:59.600\none of our first actions needs\nto be make it more secure.\n\n19\n00:00:59.600 --> 00:01:02.520\nTurning off all things around using,\nrestricting some access to base.\n\n20\n00:01:02.520 --> 00:01:05.844\nSo that's what we're gonna be taking a\nlook at in our episode here is we kind of\n\n21\n00:01:05.844 --> 00:01:08.861\nrun through that process of getting\na server ready to be pushed out into\n\n22\n00:01:08.861 --> 00:01:09.490\nproduction.\n\n23\n00:01:09.490 --> 00:01:12.240\n&gt;&gt; Again Don thanks for\ndoing this and what do we need to do?\n\n24\n00:01:12.240 --> 00:01:14.970\nOr how do we begin to secure the server?\n\n25\n00:01:14.970 --> 00:01:16.460\nWhat do we have to start?\n\n26\n00:01:16.460 --> 00:01:20.980\n&gt;&gt; Well step number one really is kind\nof performing an inventory right.\n\n27\n00:01:20.980 --> 00:01:24.660\nAn inventory of what you intend to\ndo with that server because there's\n\n28\n00:01:24.660 --> 00:01:27.280\ngoing to be certain things\nyou need to allow and\n\n29\n00:01:27.280 --> 00:01:29.650\ncertain things you don't\nneed to allow on a system.\n\n30\n00:01:29.650 --> 00:01:34.385\nSo if I wanna have a web server,\nI'm gonna need a web service running and\n\n31\n00:01:34.385 --> 00:01:36.300\nI'm gonna need to allow\npeople to get to it.\n\n32\n00:01:36.300 --> 00:01:40.390\nSo if I really wanna harden a server\nthe best way to do it is to turn off\n\n33\n00:01:40.390 --> 00:01:43.270\nall the network adaptors,\njust turn them all off right.\n\n34\n00:01:43.270 --> 00:01:45.910\nNow nobody can get your\nsystem from the network.\n\n35\n00:01:45.910 --> 00:01:49.810\nBut that's a problem if I wanna run a web\nserver, nobody can get to it right in here\n\n36\n00:01:49.810 --> 00:01:52.360\nthe most secured computer is\nthe one that powered off.\n\n37\n00:01:52.360 --> 00:01:54.530\nBut if it's power off it\nis not really useful so\n\n38\n00:01:54.530 --> 00:01:58.380\nI need to come up in the inventory\nof what is I intend to do.\n\n39\n00:01:58.380 --> 00:02:04.450\nAnd then I need to provide the minimal\nlevel of access to provide that service.\n\n40\n00:02:04.450 --> 00:02:07.851\nAnd the best way to get started with\nthat is through the configuration of\n\n41\n00:02:07.851 --> 00:02:09.035\na firewall.\n\n42\n00:02:09.035 --> 00:02:11.950\nThen we can use a firewall\nservice on your system.\n\n43\n00:02:11.950 --> 00:02:14.610\nYou more than likely\nhave hardware firewalls.\n\n44\n00:02:14.610 --> 00:02:18.260\nWe use software firewalls also\nbecause you want defense in depth.\n\n45\n00:02:18.260 --> 00:02:21.370\nAnd in that software\nfirewall we can restrict and\n\n46\n00:02:21.370 --> 00:02:25.920\nonly allow the traffic that we\nspecifically want into our system.\n\n47\n00:02:25.920 --> 00:02:28.180\nNow when you start coming\nup with that inventory,\n\n48\n00:02:28.180 --> 00:02:32.890\nyou need to think of things like I want to\nremotely administer that server with SSH.\n\n49\n00:02:32.890 --> 00:02:35.710\nSo it might be a web server,\nwhich doesn't need SSH, but\n\n50\n00:02:35.710 --> 00:02:40.360\nI might allow SSH anyway, so that I can\nget in and remotely manage that system.\n\n51\n00:02:40.360 --> 00:02:42.540\nIf it's gonna be a web server\nI do need to allow web ports,\n\n52\n00:02:42.540 --> 00:02:46.280\nand so I'll need to figure out what ports\nI need to open up for that service.\n\n53\n00:02:46.280 --> 00:02:50.700\nAnd most distros come with a software\nfirewall enabled by default.\n\n54\n00:02:50.700 --> 00:02:53.930\nIn Ubuntu you have\nthe IP Tables Firewall utility.\n\n55\n00:02:53.930 --> 00:02:56.212\nThat software's been around a long,\nlong time.\n\n56\n00:02:56.212 --> 00:02:59.810\nRed Hat has made the switch over to\nFirewallD which is a newer firewall daemon\n\n57\n00:02:59.810 --> 00:03:00.310\nthat's out there.\n\n58\n00:03:00.310 --> 00:03:02.400\nUbuntu eventually will\nswitch over to FirewallD.\n\n59\n00:03:02.400 --> 00:03:05.190\nSo that's usually the one that\nwe wanna worry about today.\n\n60\n00:03:05.190 --> 00:03:08.750\nBut either one, whichever firewall\nyou're using, they all work the same.\n\n61\n00:03:08.750 --> 00:03:10.960\nYou go in and you specify rules, and\n\n62\n00:03:10.960 --> 00:03:14.860\nthe rules dictate who is allowed\nto come in and who isn't?\n\n63\n00:03:14.860 --> 00:03:17.990\nRight and if you're not on the list,\nyou get blocked and you get stopped and\n\n64\n00:03:17.990 --> 00:03:19.773\nyou can't access the system.\n\n65\n00:03:19.773 --> 00:03:24.420\nNow, if you're distro included a firewall,\nit's gonna have some default rules.\n\n66\n00:03:24.420 --> 00:03:27.310\nAnd those default rules might be great,\nthey might be terrible.\n\n67\n00:03:27.310 --> 00:03:30.780\nThey might be saying, everyone's allowed\nin so you're running a firewall service,\n\n68\n00:03:30.780 --> 00:03:32.010\nbut it's not doing anything.\n\n69\n00:03:32.010 --> 00:03:34.110\nSo we need to get in there and\nstart to manipulate that.\n\n70\n00:03:34.110 --> 00:03:36.090\nSo I'm gonna take this\nRed Hat system that I've got.\n\n71\n00:03:36.090 --> 00:03:40.250\nThis is the one that we installed\nin the first part of this series.\n\n72\n00:03:40.250 --> 00:03:42.920\nSo I've installed\nRed Hat Enterprise Linux 7.3.\n\n73\n00:03:42.920 --> 00:03:46.130\nAnd I chose to do a minimal install.\n\n74\n00:03:46.130 --> 00:03:49.380\nThe only thing I've changed\non this system is actually,\n\n75\n00:03:49.380 --> 00:03:51.040\nhave I changed anything at this point?\n\n76\n00:03:51.040 --> 00:03:52.360\n[LAUGH] I haven't really changed anything.\n\n77\n00:03:52.360 --> 00:03:54.290\n&gt;&gt; No.\n&gt;&gt; I registered it to my account and\n\n78\n00:03:54.290 --> 00:03:55.390\nI did some updates.\n\n79\n00:03:55.390 --> 00:03:56.480\nThat's it, right?\n\n80\n00:03:56.480 --> 00:04:01.540\nSo if I wanna take a look at it here, I\ncan come in and say, firewall -cmd, right?\n\n81\n00:04:01.540 --> 00:04:05.330\nThat's the FirewallD utility for\nmanipulating the firewall.\n\n82\n00:04:05.330 --> 00:04:08.290\nAnd I can do a --state to\nlook at its current state,\n\n83\n00:04:08.290 --> 00:04:09.800\nto find out if it's running or not.\n\n84\n00:04:09.800 --> 00:04:14.460\nAnd I'm actually gonna pseudo that so\nthat it'll run as the administrator.\n\n85\n00:04:14.460 --> 00:04:17.030\nAnd I can see the firewall\nis indeed running.\n\n86\n00:04:17.030 --> 00:04:18.160\nI didn't tell it to do that.\n\n87\n00:04:18.160 --> 00:04:22.141\nThat was part of the default install,\nit configured FirewallD and\n\n88\n00:04:22.141 --> 00:04:24.950\nit turned it on so I am filtering traffic.\n\n89\n00:04:24.950 --> 00:04:30.090\nIf you do a firewall\nthat's cmd-- get- zones,\n\n90\n00:04:30.090 --> 00:04:33.220\nwhat you'll see is where\nit's created several zones.\n\n91\n00:04:33.220 --> 00:04:37.580\nWork, drop, internal, external,\ntrusted home, DMZ, public block.\n\n92\n00:04:37.580 --> 00:04:40.830\nEach of these are collections of rules and\n\n93\n00:04:40.830 --> 00:04:45.020\nevery network adapter gets\nassigned to one of these zones.\n\n94\n00:04:45.020 --> 00:04:49.690\nI might have a zone like work,\nwhere, I trust my work network.\n\n95\n00:04:49.690 --> 00:04:52.110\nAnd so I might allow everything\nto pass through that one.\n\n96\n00:04:52.110 --> 00:04:55.930\nBut then I might have a zone like DMZ,\nwhere I don't trust anything, and\n\n97\n00:04:55.930 --> 00:04:57.820\nthat one's really strict.\n\n98\n00:04:57.820 --> 00:05:00.715\nAnd if I have multiple network\nadapters In my system,\n\n99\n00:05:00.715 --> 00:05:03.997\nsome that work adaptors might be on\ntrusted networks some might not, right.\n\n100\n00:05:03.997 --> 00:05:06.925\nI might have web server and\nthe web interface,\n\n101\n00:05:06.925 --> 00:05:08.445\nthe one that's facing the internet.\n\n102\n00:05:08.445 --> 00:05:09.525\nI don't trust it at all.\n\n103\n00:05:09.525 --> 00:05:11.975\nThe internet is a dangerous place so\nit's really restrictive.\n\n104\n00:05:11.975 --> 00:05:14.745\nBut there might be another interface\nthat faces the internal network so\n\n105\n00:05:14.745 --> 00:05:15.625\nI do allow it.\n\n106\n00:05:15.625 --> 00:05:17.820\nSo these zones become really important.\n\n107\n00:05:17.820 --> 00:05:22.600\nBut most of us deploy servers with\njust one network adapter, right?\n\n108\n00:05:22.600 --> 00:05:24.460\nIf it's a web server it faces\nthe internet, and that's it.\n\n109\n00:05:24.460 --> 00:05:28.790\nAnd if I look at this server, I can see\nthat in fact I do just have one adapter.\n\n110\n00:05:28.790 --> 00:05:30.000\nENS33 right there.\n\n111\n00:05:30.000 --> 00:05:32.180\nSo that's the adapter that I've got, and\n\n112\n00:05:32.180 --> 00:05:35.280\nit's going to be stuck\ninside one of these zones.\n\n113\n00:05:35.280 --> 00:05:42.360\nIf I do a firewall cmd --get Default zone.\n\n114\n00:05:42.360 --> 00:05:46.320\nWhat you'll find is that there's\na zone that's defined by default and\n\n115\n00:05:46.320 --> 00:05:47.730\nthat's where your adapters are.\n\n116\n00:05:47.730 --> 00:05:49.810\nSo all of my adapters are gonna\nbe in this default zone.\n\n117\n00:05:49.810 --> 00:05:51.590\nMy default zone is called Public.\n\n118\n00:05:51.590 --> 00:05:55.390\nAnd unless I move them to another zone,\nthat's where they're all going to reside.\n\n119\n00:05:55.390 --> 00:05:57.340\nAnd if I could move them if I need to.\n\n120\n00:05:57.340 --> 00:06:00.070\nBut mine is fine right there.\n\n121\n00:06:00.070 --> 00:06:05.400\nAnd so inside of that zone it's got rules\nthat are restricting or allowing access.\n\n122\n00:06:05.400 --> 00:06:07.760\nAnd so I just need to configure\nthat to meet my needs.\n\n123\n00:06:07.760 --> 00:06:11.160\nSo for example, if I'm running a standard\nservice that's pretty easy right?\n\n124\n00:06:11.160 --> 00:06:16.780\nWeb servers, database servers\nbecause you can just come in and\n\n125\n00:06:16.780 --> 00:06:20.820\nsay firewall-cmd --get-services.\n\n126\n00:06:20.820 --> 00:06:23.070\nAnd you'll see a list of\nstandard services they support.\n\n127\n00:06:23.070 --> 00:06:25.770\nAnd so if I wanna allow our servers\nthrough that's in this list,\n\n128\n00:06:25.770 --> 00:06:27.450\nthat makes life really easy.\n\n129\n00:06:27.450 --> 00:06:31.182\nSo if I am doing a web server for\nexample here's HTTP and HTTPS,\n\n130\n00:06:31.182 --> 00:06:35.820\nI probably wanna allow those through\nthey're defined right here right?\n\n131\n00:06:35.820 --> 00:06:41.214\nSo I can come in and\nI can say something like firewall-cmd.\n\n132\n00:06:41.214 --> 00:06:44.240\nHang on let me pseudo that, firewallcmd,\n\n133\n00:06:44.240 --> 00:06:48.276\nI can say -- zone=public,\nthat's the default zone so\n\n134\n00:06:48.276 --> 00:06:53.790\nI could leave this off if I had other\nzones I would have to specify it here.\n\n135\n00:06:53.790 --> 00:07:02.070\nSo zone=public and\nthen I could say --add-service=http.\n\n136\n00:07:02.070 --> 00:07:05.800\nAnd that's going to allow http\nto pass through the firewall.\n\n137\n00:07:05.800 --> 00:07:07.549\nAnd I could follow it up with https and\n\n138\n00:07:07.549 --> 00:07:10.433\nthat's going to allow it to\npass through the firewall also.\n\n139\n00:07:10.433 --> 00:07:14.308\nI'm opening up these ports if I didn't\nwant them I could do the remove server so\n\n140\n00:07:14.308 --> 00:07:19.490\ndelete service--DEL-service, and delete\nthem out of there and close those ports.\n\n141\n00:07:19.490 --> 00:07:22.550\nNow quick word of warning\nwith these commands.\n\n142\n00:07:22.550 --> 00:07:26.270\nThese commands are actually temporary,\nI'm modifying in configuration in memory.\n\n143\n00:07:26.270 --> 00:07:28.370\nIf I reboot, I'm gonna lose all these.\n\n144\n00:07:28.370 --> 00:07:34.670\nSo I need to run them a second\ntime with --permanent added to it.\n\n145\n00:07:34.670 --> 00:07:36.530\nAnd that's gonna add it to\nthe configuration file, so\n\n146\n00:07:36.530 --> 00:07:37.920\nit'll be there when we start up.\n\n147\n00:07:37.920 --> 00:07:40.990\nIf I just ran it with permanent,\nit actually doesn't modify it in memory.\n\n148\n00:07:40.990 --> 00:07:41.990\nSo I have to do both.\n\n149\n00:07:41.990 --> 00:07:44.350\nI have to make sure I run\nboth sets of commands.\n\n150\n00:07:44.350 --> 00:07:46.420\nSo that we get in there and\nwe secure it, right?\n\n151\n00:07:46.420 --> 00:07:50.950\nSo there, I've done http and https and\nkinda added those to the list.\n\n152\n00:07:50.950 --> 00:07:54.797\nIf you're working with simple\nstandard services like these,\n\n153\n00:07:54.797 --> 00:07:58.001\nit's really easy to just add them in or\nremove them.\n\n154\n00:07:58.001 --> 00:08:01.828\nIf you pull up the MAN file for\nfirewall-cmd, You can look around in there\n\n155\n00:08:01.828 --> 00:08:05.964\nand you'll see a ton of options that make\nit easy to verify that state, to reload\n\n156\n00:08:05.964 --> 00:08:10.250\nthe firewall if you need to test, whether\nthose configuration items were saved.\n\n157\n00:08:10.250 --> 00:08:12.410\nYou can pull all\nthe information right from here,\n\n158\n00:08:12.410 --> 00:08:17.940\nit's really pretty straight forward how\nto work with it, and see what's going on.\n\n159\n00:08:17.940 --> 00:08:21.850\nSo, they try to make it as easy as\npossible with the iptables firewall,\n\n160\n00:08:21.850 --> 00:08:24.270\nthe older version, you had to go and\nmodify a config file,\n\n161\n00:08:24.270 --> 00:08:26.130\nthe rules were written kinda cryptically.\n\n162\n00:08:26.130 --> 00:08:29.500\nHere it's all done in a command line\nutility so that makes life a heck of a lot\n\n163\n00:08:29.500 --> 00:08:33.840\neasier and you just jump in and\nyou get it configured the way you need it.\n\n164\n00:08:33.840 --> 00:08:36.220\n&gt;&gt; What if it's a nonstandard service?\n\n165\n00:08:36.220 --> 00:08:39.610\n&gt;&gt; Okay, yeah so\nI showed you a standard service, right?\n\n166\n00:08:39.610 --> 00:08:44.290\nI cheated [LAUGH] so when I did that get\nservices these guys are all super easy to\n\n167\n00:08:44.290 --> 00:08:46.420\nadd them in or block them, right?\n\n168\n00:08:46.420 --> 00:08:49.110\nIt based on my needs,\nlet's add a non standard service.\n\n169\n00:08:49.110 --> 00:08:54.450\nMaybe I'm running a web server, but I'm\nrunning it on port 8080 instead, right?\n\n170\n00:08:54.450 --> 00:08:55.950\nThat's not the standard port.\n\n171\n00:08:55.950 --> 00:09:00.530\nSo I allowed HTTP and\nHTTPS which is port 80 and 443, but\n\n172\n00:09:00.530 --> 00:09:03.940\nif I need port 8080, that's not standard.\n\n173\n00:09:03.940 --> 00:09:09.166\nWell, I can add that in pretty\neasy by saying firewall-cmd,\n\n174\n00:09:09.166 --> 00:09:11.590\nand then specifying a zone.\n\n175\n00:09:11.590 --> 00:09:14.980\nAgain, if it's the default zone, you don't\nhave to do this, but I'll do it anyway.\n\n176\n00:09:14.980 --> 00:09:19.660\nSo zone = public, and\nthen I can just come through and\n\n177\n00:09:19.660 --> 00:09:23.630\nsay something like --add-port=.\n\n178\n00:09:23.630 --> 00:09:25.170\nAnd I can tell it the port,\nso I might add 8080.\n\n179\n00:09:25.170 --> 00:09:27.930\nI need to follow that up\nwith one extra thing though.\n\n180\n00:09:27.930 --> 00:09:31.250\nIf I just say 8080 like this,\nit's gonna do TCP and UDP.\n\n181\n00:09:31.250 --> 00:09:35.767\nSo I might wanna be really specific and\nsay something like /tcp so\n\n182\n00:09:35.767 --> 00:09:40.587\nthat it knows I'm just allowing\nport 8080 for TCP traffic.\n\n183\n00:09:40.587 --> 00:09:44.190\nI'd need to run it again with dash\ndash permanent to make that permanent.\n\n184\n00:09:44.190 --> 00:09:46.880\nBut that's kinda how we\nwould do a non-standard one.\n\n185\n00:09:48.100 --> 00:09:51.750\nAnd if you wanna to see like\na list of what you've added.\n\n186\n00:09:51.750 --> 00:09:55.780\nWe could say,\nlike if we kinda pull up as a whoops.\n\n187\n00:09:55.780 --> 00:09:59.210\nI do list-ports,\n\n188\n00:09:59.210 --> 00:10:03.744\nlike that I can see the ports that I have\nallowed through it and list-services.\n\n189\n00:10:04.780 --> 00:10:06.360\nWe can see the services that have proof.\n\n190\n00:10:06.360 --> 00:10:09.930\nSo right now, I'm allowing the DACP\nclient pass to the firewall.\n\n191\n00:10:09.930 --> 00:10:13.220\nI'm allowing SSH, I'm on HTTP NHDPS.\n\n192\n00:10:13.220 --> 00:10:14.420\nIt's a web server, right?\n\n193\n00:10:14.420 --> 00:10:16.320\nSo are tip of the things that I want.\n\n194\n00:10:16.320 --> 00:10:18.110\nI'm actually not using\nDHTP on this system.\n\n195\n00:10:18.110 --> 00:10:19.600\nSo I could block that.\n\n196\n00:10:19.600 --> 00:10:24.350\nI could take that out with\nthe delay service but otherwise,\n\n197\n00:10:24.350 --> 00:10:26.970\nI'm allowing the various\nthings that I want, and\n\n198\n00:10:26.970 --> 00:10:30.530\ngetting them kinda put in place,\nand getting all of that entered in.\n\n199\n00:10:30.530 --> 00:10:34.840\nIf I just do a -- list you'll see kind of\nsome of the different things that we can\n\n200\n00:10:34.840 --> 00:10:38.160\npull up a list, to see what's\nbeing allowed, and what's not.\n\n201\n00:10:38.160 --> 00:10:42.810\nIn this, I actually list- all,\nthat's what I want, there we go.\n\n202\n00:10:42.810 --> 00:10:45.420\nSo now I can see all the different things\nthat are being allowed through and\n\n203\n00:10:45.420 --> 00:10:47.330\nit kinda customized and tailor those.\n\n204\n00:10:47.330 --> 00:10:49.050\nSo custom port is really easy.\n\n205\n00:10:49.050 --> 00:10:52.902\nI think it's ranges a ports\nmaybe you gotta VoIP system.\n\n206\n00:10:52.902 --> 00:10:55.162\nAnd you're VoIP system is using UDP.\n\n207\n00:10:55.162 --> 00:10:57.530\nSo you might have a whole range of ports.\n\n208\n00:10:57.530 --> 00:11:02.030\nSo I can say, add- port, and\nthen I can say maybe like\n\n209\n00:11:02.030 --> 00:11:06.790\nport 50,000 through I don't\nknow 51,000/udp, right so,\n\n210\n00:11:06.790 --> 00:11:12.815\nnow I can open up that whole range\nof ports to pass through the system.\n\n211\n00:11:12.815 --> 00:11:14.615\nThrough a handy on VoIP systems.\n\n212\n00:11:14.615 --> 00:11:18.075\nBut once you get that configured,\nyou are the person deciding\n\n213\n00:11:18.075 --> 00:11:20.825\nwhat traffic is allowed to pass\nthrough and what traffic isn't.\n\n214\n00:11:20.825 --> 00:11:25.665\nThis is a great way to harden you system\nbecause you're blocking off any other port\n\n215\n00:11:25.665 --> 00:11:29.910\nfrom people to get access to and helping\nto really tighten up that network access.\n\n216\n00:11:29.910 --> 00:11:33.600\n&gt;&gt; Don are there other ways to\nfilter traffic besides the firewall?\n\n217\n00:11:33.600 --> 00:11:37.680\nYeah, absolutely so, I'm using firewall D,\nright because I'm on a Red Hat system, or\n\n218\n00:11:37.680 --> 00:11:38.920\nCentOS would be the same.\n\n219\n00:11:38.920 --> 00:11:40.670\nIf you're on Ubuntu, theres IP tables, so\n\n220\n00:11:40.670 --> 00:11:43.340\nit's got its own configuration\nfile found inside /etc.\n\n221\n00:11:43.340 --> 00:11:45.660\nSo you can go in there and\ndig up IP tables.\n\n222\n00:11:45.660 --> 00:11:48.280\nBut back in the olden days\n&gt;&gt; Olden days!\n\n223\n00:11:48.280 --> 00:11:50.020\n&gt;&gt; We're gonna go back in time here.\n\n224\n00:11:50.020 --> 00:11:52.070\nWe don't always have\nthese firewall services.\n\n225\n00:11:52.070 --> 00:11:55.610\nAnd so in the olden days,\nwe had what we called TCP Wrappers.\n\n226\n00:11:55.610 --> 00:11:59.130\nAnd TCP Wrappers were actually\nbuilt into the services.\n\n227\n00:11:59.130 --> 00:12:02.340\nThe services would include these\nlibrary hooks to load TCP Wrappers.\n\n228\n00:12:02.340 --> 00:12:05.490\nAnd so you could have what were\nin effect firewall rules for\n\n229\n00:12:05.490 --> 00:12:07.430\neach individual service.\n\n230\n00:12:07.430 --> 00:12:10.820\nIt was really difficult to maintain these,\ncuz if you have ten services,\n\n231\n00:12:10.820 --> 00:12:13.070\nthere's ten different configurations\nyou gotta worry about, right?\n\n232\n00:12:13.070 --> 00:12:16.450\nBut so, that's all been replaced\nby these software firewalls.\n\n233\n00:12:16.450 --> 00:12:18.770\nBut the TCP Wrappers are still there.\n\n234\n00:12:18.770 --> 00:12:20.830\nSo if you're troubleshooting a system\nhere and you're not getting access,\n\n235\n00:12:20.830 --> 00:12:22.870\nit might be that somebody\nhas configured those.\n\n236\n00:12:23.940 --> 00:12:27.910\nThe Wrappers that I'm talking about,\nif i go into /etc and\n\n237\n00:12:27.910 --> 00:12:31.450\ntake a poke around in there you'll\nsee some interesting files or\n\n238\n00:12:31.450 --> 00:12:35.770\nusually you'll see some interesting files,\nlike hosts.allow, hosts.deny.\n\n239\n00:12:35.770 --> 00:12:36.818\nSee these two guys right here?\n\n240\n00:12:36.818 --> 00:12:38.060\nHosts.allow and hosts.deny.\n\n241\n00:12:39.070 --> 00:12:41.650\nThose are part of the TCP Wrapper system.\n\n242\n00:12:41.650 --> 00:12:47.070\nAnd what you do is you make a list in\nthere of hosts that are either allowed or\n\n243\n00:12:47.070 --> 00:12:49.350\nhosts that are denied now,\ndeny gets loaded first.\n\n244\n00:12:49.350 --> 00:12:51.860\nSo, if you got a deny,\nyou're blocking those people.\n\n245\n00:12:51.860 --> 00:12:53.540\nIt doesn't matter if they're\nin the allow file also.\n\n246\n00:12:53.540 --> 00:12:56.110\nThey're not gonna be allowed,\ndeny overrides.\n\n247\n00:12:56.110 --> 00:12:58.520\nSo, usually we just fill out deny.\n\n248\n00:12:58.520 --> 00:13:01.340\nBut if you wanna allow everybody and\njust block a few people,\n\n249\n00:13:01.340 --> 00:13:02.380\nthen you gotta do it the other way.\n\n250\n00:13:02.380 --> 00:13:04.930\nYou gotta do it in the host.allow file.\n\n251\n00:13:04.930 --> 00:13:07.190\nBut, those are TCP Wrappers.\n\n252\n00:13:07.190 --> 00:13:08.590\nAnd these are the generic ones.\n\n253\n00:13:08.590 --> 00:13:10.510\nThe ones that are applied to in theory,\n\n254\n00:13:10.510 --> 00:13:15.950\nall TCP traffic as along as\nthe service supports TCP Wrappers.\n\n255\n00:13:15.950 --> 00:13:20.560\nBut sometimes you'll have services\nthat have their own files in here.\n\n256\n00:13:20.560 --> 00:13:23.880\nSo for example,\nI'm trying to think if I've got any.\n\n257\n00:13:23.880 --> 00:13:28.060\nIf I had installed like the INETD\nnot INETD the XINET services\n\n258\n00:13:28.060 --> 00:13:29.140\nthey'd have their own little file.\n\n259\n00:13:29.140 --> 00:13:32.100\nSo you might see other dot allow and\nother dot denys.\n\n260\n00:13:32.100 --> 00:13:35.580\nI don't think I have any,\nthis is a default system, so\n\n261\n00:13:35.580 --> 00:13:37.430\nI'm pretty sure that's all I've got.\n\n262\n00:13:37.430 --> 00:13:40.385\nYeah, you might see other\nfiles pop up though.\n\n263\n00:13:40.385 --> 00:13:42.600\nCron.deny, same thing,\n\n264\n00:13:42.600 --> 00:13:46.440\nyou're dictating who's allowed to use\nthe cron service to schedule tasks.\n\n265\n00:13:46.440 --> 00:13:49.140\nSo you can go through and\nprovide that same concept.\n\n266\n00:13:49.140 --> 00:13:52.970\nNow, not every service\nsupports TCP Wrappers.\n\n267\n00:13:52.970 --> 00:13:54.750\nSo you'll probably need\nto test it to find out.\n\n268\n00:13:54.750 --> 00:13:57.640\nA way to test Is to use the ldd command.\n\n269\n00:13:57.640 --> 00:14:01.690\nLdd lets you see what libraries\nare linked to a program.\n\n270\n00:14:01.690 --> 00:14:06.279\nSo I can say, ldd /user/sbin/sshd, and\n\n271\n00:14:06.279 --> 00:14:09.384\nI can look at the SSH service.\n\n272\n00:14:09.384 --> 00:14:11.080\nAnd I can say, well, do you support it?\n\n273\n00:14:11.080 --> 00:14:15.630\nWell, I'm gonna get a list of all\nthe libraries that SSHD uses.\n\n274\n00:14:15.630 --> 00:14:17.590\nSo I'm gonna filter that\na little bit with grep.\n\n275\n00:14:17.590 --> 00:14:19.320\nAnd I'm gonna look for the word, wrap.\n\n276\n00:14:19.320 --> 00:14:22.772\nAnd when I look,\nI can see it's going liberap.so.0.\n\n277\n00:14:22.772 --> 00:14:25.650\nThat's how I know it\nsupports TCP Wrappers.\n\n278\n00:14:25.650 --> 00:14:28.950\nSo you can test the service to\nsee whether it honors that.\n\n279\n00:14:28.950 --> 00:14:31.750\nIf it comes back like what\nyou're seeing right here,\n\n280\n00:14:31.750 --> 00:14:36.220\nthen that means SSH in my system\nis following the rules and\n\n281\n00:14:36.220 --> 00:14:41.100\nthe firewall, and it's following\nthe rules in host.allow and host.deny.\n\n282\n00:14:41.100 --> 00:14:45.000\nSo, I would need to go in here and\ncheck those too.\n\n283\n00:14:45.000 --> 00:14:49.790\nIf I look at host.deny, you'll see\nin here that it's actually empty.\n\n284\n00:14:49.790 --> 00:14:52.140\nIt's got all the signs here,\nhas a # at the beginning, so\n\n285\n00:14:52.140 --> 00:14:54.240\nthis is all commented out, right?\n\n286\n00:14:54.240 --> 00:14:56.910\nSo, there's nothing in them, it's empty.\n\n287\n00:14:56.910 --> 00:15:01.250\nAnd if I look at host.allow,\nit's also empty.\n\n288\n00:15:01.250 --> 00:15:07.910\nSo while SSHD is using them there's\nnothing in them to give them a task to do.\n\n289\n00:15:07.910 --> 00:15:11.720\nSo if I wanted to use these though,\nI could come in and I could say,\n\n290\n00:15:11.720 --> 00:15:15.770\nI'm gonna edit the hosts.deny file.\n\n291\n00:15:15.770 --> 00:15:21.697\nAnd inside of hosts.deny, I can add\nan extra line down here at the bottom,\n\n292\n00:15:21.697 --> 00:15:28.016\nand I could say something like SSHD colon,\n192.968.0.1, right.\n\n293\n00:15:28.016 --> 00:15:32.762\nAnd what that would do is if the IP\naddress 192.968.0.1 tried to connect\n\n294\n00:15:32.762 --> 00:15:36.013\nto my system and\ntried to access SSHD it would be blocked,\n\n295\n00:15:36.013 --> 00:15:41.470\nit's in the denied file, if I put the same\nline in the allow file, it would allow it.\n\n296\n00:15:41.470 --> 00:15:44.919\nAnd if it was in both files,\ndeny would win and it would be denied and\n\n297\n00:15:44.919 --> 00:15:47.382\nI had to specify that\nservice at the beginning,\n\n298\n00:15:47.382 --> 00:15:49.983\nbecause other services can\nuse this file as well.\n\n299\n00:15:49.983 --> 00:15:51.309\nAnd you basically come through and\n\n300\n00:15:51.309 --> 00:15:53.237\nyou specify each of those\nservices that honor it.\n\n301\n00:15:53.237 --> 00:15:58.098\nSo if I have a web server that uses it\nThen I would come in and specify whatever\n\n302\n00:15:58.098 --> 00:16:02.739\nIP was allowed or denied, you kinda\ngo through and add them in the list.\n\n303\n00:16:02.739 --> 00:16:07.610\nNow this is the old way of doing it,\nthis has been around a long long time.\n\n304\n00:16:07.610 --> 00:16:09.510\nBy and large we don't use these anymore.\n\n305\n00:16:09.510 --> 00:16:12.270\nWe ignore them and we just use the\nfirewall but I did want you to be aware of\n\n306\n00:16:12.270 --> 00:16:14.718\nthem because there's another way\nyou can get in here to put it.\n\n307\n00:16:14.718 --> 00:16:18.301\nAnd it can even supplement your\nfirewall to a degree and help you to\n\n308\n00:16:18.301 --> 00:16:22.929\nrestrict things a little more in the event\nthat maybe your firewall failed open, and\n\n309\n00:16:22.929 --> 00:16:24.378\nthat would be a bad thing.\n\n310\n00:16:24.378 --> 00:16:26.357\nUsually, that doesn't happen,\n\n311\n00:16:26.357 --> 00:16:30.050\nbut this could be a second layer\nof defense if you chose to use it.\n\n312\n00:16:30.050 --> 00:16:32.000\n&gt;&gt; Now we've been talking\nabout networking, right?\n\n313\n00:16:32.000 --> 00:16:34.790\nSo what about local activity?\n\n314\n00:16:34.790 --> 00:16:35.900\n&gt;&gt; Okay, good point right.\n\n315\n00:16:35.900 --> 00:16:40.920\nSo all this firewall stuff is great if\nyou're coming in over the network, but\n\n316\n00:16:40.920 --> 00:16:42.340\nwhat if I set right down on the machine.\n\n317\n00:16:43.400 --> 00:16:45.590\nI'm not coming over the network any\nmore none of these rules apply to me.\n\n318\n00:16:45.590 --> 00:16:47.631\nAnd the same thing goes for\nyour applications,\n\n319\n00:16:47.631 --> 00:16:49.630\nyour applications\nare running on the server.\n\n320\n00:16:49.630 --> 00:16:52.270\nSo the firewall doesn't apply to them.\n\n321\n00:16:52.270 --> 00:16:54.980\nSo if we wanna protect them\nwe need something better.\n\n322\n00:16:54.980 --> 00:16:59.440\nAnd one of the best ways to secure that\nis using a technology called SELinux.\n\n323\n00:16:59.440 --> 00:17:02.060\nIt's security enhanced Linux.\n\n324\n00:17:02.060 --> 00:17:02.855\n&gt;&gt; Right on.\n\n325\n00:17:02.855 --> 00:17:04.051\n&gt;&gt; SELinux has been around awhile.\n\n326\n00:17:04.051 --> 00:17:08.252\nNot a long time,\nright maybe 10, 12 years or so.\n\n327\n00:17:08.252 --> 00:17:11.400\nIt is installed and activated by default.\n\n328\n00:17:11.400 --> 00:17:17.143\nIn Red Hat and Centos, it is not installed\nand not enabled be default in Ubuntu.\n\n329\n00:17:17.143 --> 00:17:20.808\nBut you can, you can install SELinux\nin Ubuntu and you can turn it on.\n\n330\n00:17:20.808 --> 00:17:25.782\nAnd what SELinux does is it's basically\nlike a firewall for your programs.\n\n331\n00:17:25.782 --> 00:17:30.209\nIn SELinux you dictate, you say SSHD\nis allowed to access these folders, and\n\n332\n00:17:30.209 --> 00:17:32.594\nit's allowed to access these ports, and\n\n333\n00:17:32.594 --> 00:17:35.615\nit's allowed to access\nthese other applications.\n\n334\n00:17:35.615 --> 00:17:38.759\nYou get really restrictive,\nnow why would I wanna do that?\n\n335\n00:17:38.759 --> 00:17:43.184\nBecause of a hacker breaks in and then\ncompromise my web server they could then\n\n336\n00:17:43.184 --> 00:17:45.782\nleap frog and\nstart attacking other things.\n\n337\n00:17:45.782 --> 00:17:50.164\nBut if the Web server is restricted and\nonly has access to a subset of my system\n\n338\n00:17:50.164 --> 00:17:52.920\nthat's all the attacker\nwould have access to.\n\n339\n00:17:52.920 --> 00:17:56.820\nSo SELinux is a great way\nto restrict applications.\n\n340\n00:17:56.820 --> 00:18:00.304\nIt's almost like a software firewall for\nyour applications all right.\n\n341\n00:18:00.304 --> 00:18:02.371\nNow, if you're running Red Hat or HEL, or\n\n342\n00:18:02.371 --> 00:18:05.000\nif you're running CentOS\nyou've already got it.\n\n343\n00:18:05.000 --> 00:18:07.320\nIt's installed you just need\nto configure it all right.\n\n344\n00:18:07.320 --> 00:18:10.054\nAnd fortunately there's not a whole lot\nwe need to configure cuz the default\n\n345\n00:18:10.054 --> 00:18:11.217\nconfiguration is really good.\n\n346\n00:18:11.217 --> 00:18:13.270\nLet me show you what I mean.\n\n347\n00:18:13.270 --> 00:18:15.100\nFirst off,\nI just want to see if I have it.\n\n348\n00:18:15.100 --> 00:18:17.565\nYou can run the SE status utility.\n\n349\n00:18:17.565 --> 00:18:20.300\nAnd if you run it it'll tell\nyou if you have SELinux or not.\n\n350\n00:18:20.300 --> 00:18:21.717\nIf it fails, you don't have it.\n\n351\n00:18:21.717 --> 00:18:23.590\nIf it succeeds you'll get this.\n\n352\n00:18:23.590 --> 00:18:26.147\nI can see that SELinux is enabled.\n\n353\n00:18:26.147 --> 00:18:28.233\nAnd that it's up and it's running.\n\n354\n00:18:28.233 --> 00:18:32.684\nI can see the current mode\nis enforcing all right.\n\n355\n00:18:32.684 --> 00:18:37.080\nThere's three modes, enforcing,\npermissive, and disabled all right.\n\n356\n00:18:38.120 --> 00:18:39.610\nYou don't wanna see disabled here.\n\n357\n00:18:39.610 --> 00:18:43.318\nIf it says disabled, you've installed\nSELinux but it's turned off, all right.\n\n358\n00:18:43.318 --> 00:18:46.742\nEnforcing, means it's got a set of\nrules and the applications have to\n\n359\n00:18:46.742 --> 00:18:50.932\nfollow the rules and if they don't they\nget blocked, right, that's what you want.\n\n360\n00:18:50.932 --> 00:18:53.920\nBut there's a third setting\nwhich is Permissive.\n\n361\n00:18:53.920 --> 00:18:56.720\nPermissive says,\nwe've got a set of rules, and\n\n362\n00:18:56.720 --> 00:19:01.740\nif somebody breaks the rule we allow them\nto, we let them do it but we log it.\n\n363\n00:19:01.740 --> 00:19:03.430\nNow why would I do that?\n\n364\n00:19:03.430 --> 00:19:07.091\nWell the default set of rules\nare actually pretty restrictive,\n\n365\n00:19:07.091 --> 00:19:08.595\nthey stop a lot of things.\n\n366\n00:19:08.595 --> 00:19:12.946\nSo for example it's got default rules for\na web server.\n\n367\n00:19:12.946 --> 00:19:14.650\nIf I were to install a web server, right.\n\n368\n00:19:14.650 --> 00:19:18.450\nSo if I do a quick yum install HTTP,\nright.\n\n369\n00:19:18.450 --> 00:19:20.010\nSo I'm installing a web server.\n\n370\n00:19:20.010 --> 00:19:22.069\nAnd it's going to install.\n\n371\n00:19:22.069 --> 00:19:24.137\nAnd then I'm gonna start the web server.\n\n372\n00:19:24.137 --> 00:19:26.551\nAnd the web server expects to have files,\nright.\n\n373\n00:19:26.551 --> 00:19:33.337\nSo if I do a systems ctl starter,\nI need to enable it htbd.\n\n374\n00:19:33.337 --> 00:19:36.642\nAnd then I start it, so\nI'm starting my web server and\n\n375\n00:19:36.642 --> 00:19:39.470\nit expects to have some files.\n\n376\n00:19:39.470 --> 00:19:42.364\nAnd it expects those files\nto be the particular place.\n\n377\n00:19:42.364 --> 00:19:47.844\nSo SELinux has given the web\nserver permission to store those\n\n378\n00:19:47.844 --> 00:19:53.984\nfiles in /bar/www and\ninside of here in this HTML folder, right?\n\n379\n00:19:53.984 --> 00:19:59.377\nAnd so it has permission to\nread filed from this folder.\n\n380\n00:19:59.377 --> 00:20:03.151\nIf a hacker breaks in, the hacker\nwould break in the web server and\n\n381\n00:20:03.151 --> 00:20:05.650\nhave access to this folder.\n\n382\n00:20:05.650 --> 00:20:09.766\nBut they wouldn't have access to /var,\nthey wouldn't be able to get there.\n\n383\n00:20:09.766 --> 00:20:12.015\nBecause SELinux says,\nyou're not allowed to.\n\n384\n00:20:12.015 --> 00:20:15.313\nSELinux says, that's the only\nplace the web server can go.\n\n385\n00:20:15.313 --> 00:20:18.210\nWell, if you remember way back\nin the installation episode,\n\n386\n00:20:18.210 --> 00:20:21.020\nI added another partition for\nmy web server.\n\n387\n00:20:21.020 --> 00:20:28.618\nAnd I decided, instead of putting it in\n/var/www, I wanted it to go in /website.\n\n388\n00:20:28.618 --> 00:20:33.802\nAnd so I created a partition, and\ntold it I wanted to mount into /website.\n\n389\n00:20:33.802 --> 00:20:37.640\nAnd I never did verify,\napparently it didn't actually mount it.\n\n390\n00:20:37.640 --> 00:20:42.682\nSo I need to go here's the entry where\nit thinks that it mounted into /website,\n\n391\n00:20:42.682 --> 00:20:45.634\nbut I didn't see it,\nunless I overlooked it.\n\n392\n00:20:45.634 --> 00:20:46.795\nSo it's not quite mounted.\n\n393\n00:20:46.795 --> 00:20:48.028\nSo I'll have to figure\nout where that went.\n\n394\n00:20:48.028 --> 00:20:50.460\nBut, you know what?\n\n395\n00:20:50.460 --> 00:20:52.987\nI'm in the wrong folder,\nthat's gonna be my problem there it is.\n\n396\n00:20:52.987 --> 00:20:56.115\n[LAUGH] /website, that makes a difference.\n\n397\n00:20:56.115 --> 00:20:57.834\nSo, /website.\n\n398\n00:20:57.834 --> 00:21:00.270\nSo I want my website to go there.\n\n399\n00:21:00.270 --> 00:21:02.050\nWell, I can go into\nApache's configuration.\n\n400\n00:21:02.050 --> 00:21:04.300\nAnd I can tell it, hey,\nyou can find your web files in /website.\n\n401\n00:21:04.300 --> 00:21:05.600\nAnd it's not gonna work.\n\n402\n00:21:05.600 --> 00:21:07.398\nI'm gonna get page not found,\n\n403\n00:21:07.398 --> 00:21:11.141\nbecause SELinux is going to stop\nit from accessing that folder.\n\n404\n00:21:11.141 --> 00:21:13.971\nSo if we're using SELinux,\nwhich hopefully you are,\n\n405\n00:21:13.971 --> 00:21:18.107\nwe need to go through the process of\nallowing that application through, okay?\n\n406\n00:21:18.107 --> 00:21:21.290\nAnd there's a few different ways to do it.\n\n407\n00:21:21.290 --> 00:21:26.190\nBut the easiest way is to use\nthe set in force command.\n\n408\n00:21:26.190 --> 00:21:27.828\nAnd you can change it to permissive.\n\n409\n00:21:27.828 --> 00:21:32.401\nI can say set in force permissive,\nand then I can run my web application.\n\n410\n00:21:32.401 --> 00:21:33.127\nAnd when I run it,\n\n411\n00:21:33.127 --> 00:21:36.193\nit's gonna access this folders that\nit's not allowed to access, right?\n\n412\n00:21:36.193 --> 00:21:38.995\nAnd those are gonna generate log messages,\nerrors, right?\n\n413\n00:21:38.995 --> 00:21:39.818\nThey're not gonna get blocked.\n\n414\n00:21:39.818 --> 00:21:42.138\nIt's gonna generate the errors though.\n\n415\n00:21:42.138 --> 00:21:46.541\nAnd now I'll have a log that shows me all\nthe stuff that it tried to access that it\n\n416\n00:21:46.541 --> 00:21:48.424\nwasn't able to access, right?\n\n417\n00:21:48.424 --> 00:21:50.383\nI'm trying to keep this generic here.\n\n418\n00:21:50.383 --> 00:21:53.205\nBecause I'm talking about a web server,\nbut this is the same for\n\n419\n00:21:53.205 --> 00:21:56.975\na database server, a file server, a custom\napplication that you wrote in-house.\n\n420\n00:21:56.975 --> 00:21:58.820\nThis would all be the same right?\n\n421\n00:21:58.820 --> 00:22:01.550\nYou setenforce to permissive to change it.\n\n422\n00:22:01.550 --> 00:22:03.080\nNow, I would need to sudo that.\n\n423\n00:22:03.080 --> 00:22:04.303\nA regular user can't do that.\n\n424\n00:22:04.303 --> 00:22:08.180\nAnd then that way, I run the application,\nit generates the log messages.\n\n425\n00:22:08.180 --> 00:22:10.320\nAnd once you've got\nthe log messages in place,\n\n426\n00:22:10.320 --> 00:22:13.820\nfrom there, you can import those and\n\n427\n00:22:13.820 --> 00:22:18.410\nuse those to create the exceptions to the\nrule, and put those in place, all right.\n\n428\n00:22:18.410 --> 00:22:22.630\nSo we can take that extra step, and\nthe way you review those log messages,\n\n429\n00:22:22.630 --> 00:22:25.644\nthere's a few different\nways you could go about it.\n\n430\n00:22:25.644 --> 00:22:33.473\nWell, what you'll really do is\ntake a look at /var/log /audit.\n\n431\n00:22:33.473 --> 00:22:38.790\nAnd then inside of there you had\nthis audit.log and the sudu that.\n\n432\n00:22:38.790 --> 00:22:42.360\nAnd as you run applications\nthis is where SELinux logs to.\n\n433\n00:22:42.360 --> 00:22:45.980\nAnd so it's creating all these\nentires in here that are stating\n\n434\n00:22:45.980 --> 00:22:49.580\nwhether you tried to access a folder\nyou weren't supposed to and so on.\n\n435\n00:22:49.580 --> 00:22:53.627\nAnd what I'm seeing right now are\nsuccesses because it's a default install.\n\n436\n00:22:53.627 --> 00:22:57.560\nBut the moment I deviate from that default\ninstall I'm gonna start seeing failures.\n\n437\n00:22:57.560 --> 00:23:01.017\nAnd so we can take those failures and\nuse those to reconfigure SELinux and\n\n438\n00:23:01.017 --> 00:23:03.521\nget it set up so\nthat it allows that traffic through.\n\n439\n00:23:03.521 --> 00:23:06.823\nSo that's an important part\nof getting it configured and\n\n440\n00:23:06.823 --> 00:23:09.172\nit is gonna vary based on your services.\n\n441\n00:23:09.172 --> 00:23:11.830\nAnd so you'll have to tweak and\nadjust that.\n\n442\n00:23:11.830 --> 00:23:13.620\nIf you have the GUI installed,\n\n443\n00:23:13.620 --> 00:23:15.660\nthere's actually a nice little\nGUI utility you can do for this.\n\n444\n00:23:15.660 --> 00:23:18.845\nBut from the command line,\nyou're kinda left to do it here by hand.\n\n445\n00:23:18.845 --> 00:23:23.162\nSo kinda tweaking that sc Linux\nenvironment is a bit of magic.\n\n446\n00:23:23.162 --> 00:23:24.320\n&gt;&gt; Don, that's great.\n\n447\n00:23:24.320 --> 00:23:25.990\nCan you show us the process, though?\n\n448\n00:23:25.990 --> 00:23:27.923\n&gt;&gt; It's a really good point Zack\nbecause everything we 've been talking\n\n449\n00:23:27.923 --> 00:23:28.819\nabout is network access right.\n\n450\n00:23:28.819 --> 00:23:30.467\nCome into over the network.\n\n451\n00:23:30.467 --> 00:23:31.600\nWhat if it's local?\n\n452\n00:23:31.600 --> 00:23:33.823\nWhat if somebody sits down right on\nyour machine or not a somebody or\n\n453\n00:23:33.823 --> 00:23:34.784\nwhat about an application?\n\n454\n00:23:34.784 --> 00:23:38.060\nApplications are always local,\nthey're always running from the server.\n\n455\n00:23:38.060 --> 00:23:41.537\nSo none of the firewall stuff applies\nthen we filter that same way and\n\n456\n00:23:41.537 --> 00:23:42.822\nthat's a real problem.\n\n457\n00:23:42.822 --> 00:23:48.499\nSo to help with that, there's a technology\ncalled SELinux or Security Enhanced Linux.\n\n458\n00:23:48.499 --> 00:23:53.310\nIf you're running Red Hat Enterprise Linux\nor CentOS, it's built in right?\n\n459\n00:23:53.310 --> 00:23:54.456\nIt's just a part of the OS.\n\n460\n00:23:54.456 --> 00:23:56.206\nIt's turned on and enabled by default.\n\n461\n00:23:56.206 --> 00:23:59.915\nIt's installed even on a minimal install,\nlike what I did for this series.\n\n462\n00:23:59.915 --> 00:24:02.667\nIf you're running Ubuntu,\nnot installed by default.\n\n463\n00:24:02.667 --> 00:24:05.175\nYou can install,\nthey do have a SELinux for Ubuntu,\n\n464\n00:24:05.175 --> 00:24:06.779\nit's just not there by default.\n\n465\n00:24:06.779 --> 00:24:11.586\nAnd what SELinux does is basically\na sub-layer that restricts applications.\n\n466\n00:24:11.586 --> 00:24:15.140\nSays, these applications can\nonly access these folders.\n\n467\n00:24:15.140 --> 00:24:18.102\nSo for example, a web server, right?\n\n468\n00:24:18.102 --> 00:24:20.230\nIf I whip up,\nlet me just show you real quick.\n\n469\n00:24:20.230 --> 00:24:21.560\nIf I whip up a web server, right?\n\n470\n00:24:21.560 --> 00:24:25.031\nSo I'm gonna do a yum install httpd,\nright?\n\n471\n00:24:25.031 --> 00:24:27.070\nSo I'll get that installed.\n\n472\n00:24:27.070 --> 00:24:31.280\nAnd once I've got my web server\ninstalled I can start it up and\n\n473\n00:24:31.280 --> 00:24:33.320\nit's expecting to have web files, right?\n\n474\n00:24:33.320 --> 00:24:38.140\nSo I'll do a systemctl enable httpd.\n\n475\n00:24:38.140 --> 00:24:39.580\nAnd so that's gonna start up.\n\n476\n00:24:39.580 --> 00:24:43.000\nWell, actually, that's gonna set it\nto start and I'll actually start it.\n\n477\n00:24:43.000 --> 00:24:43.920\nThere we go.\n\n478\n00:24:43.920 --> 00:24:48.408\nAnd it's expecting all of its\nfiles to be in /var/www, okay?\n\n479\n00:24:48.408 --> 00:24:51.160\nI didn't make that folder,\nit made it, so it put it there.\n\n480\n00:24:51.160 --> 00:24:53.550\nAnd there's an html folder\nright inside of that.\n\n481\n00:24:53.550 --> 00:24:57.240\nNow, if a hacker breaks in and\nthey compromise the web server,\n\n482\n00:24:57.240 --> 00:24:59.740\nobviously they're gonna\nhave access to that folder.\n\n483\n00:24:59.740 --> 00:25:01.729\nAnd if the application\nwas running unbounded,\n\n484\n00:25:01.729 --> 00:25:04.672\nthey'd have access to everything else,\ntoo, so that's a problem.\n\n485\n00:25:04.672 --> 00:25:05.293\n&gt;&gt; Not good.\n\n486\n00:25:05.293 --> 00:25:08.526\n&gt;&gt; So what SELinux does, it steps in and\nit puts a fence in, a cage, right?\n\n487\n00:25:08.526 --> 00:25:10.170\nIt's like a, they call it a jail.\n\n488\n00:25:10.170 --> 00:25:15.890\nAnd so it jails the Apache app,\nthe service, and it says, hey, you've\n\n489\n00:25:15.890 --> 00:25:20.821\ngot access to /var/www/html, but you don't\nhave access to anywhere else, right?\n\n490\n00:25:21.980 --> 00:25:23.949\nSo it holds it, it restricts it, and\n\n491\n00:25:23.949 --> 00:25:26.689\nwe can use SELinux to\ncontrol those applications.\n\n492\n00:25:26.689 --> 00:25:30.218\nAnd if you don't know if you have it,\nit's really easy to see,\n\n493\n00:25:30.218 --> 00:25:33.880\nyou can just run getenforce and\nthat will tell you if you got it, or\n\n494\n00:25:33.880 --> 00:25:36.090\nyou can run sestatus, is another one.\n\n495\n00:25:36.090 --> 00:25:39.644\nsestatus shows you the running\nstatus of SELinux and\n\n496\n00:25:39.644 --> 00:25:42.398\ngetenforce shows you what it's doing.\n\n497\n00:25:42.398 --> 00:25:45.523\nsestatus actually shows you\nthe enforcement status as well.\n\n498\n00:25:45.523 --> 00:25:46.823\nSo let me run over these real quick.\n\n499\n00:25:46.823 --> 00:25:50.560\nSELinux status, mine is set to enabled,\nthat's what you wanna see you want to to\n\n500\n00:25:50.560 --> 00:25:53.380\nbe turned on,\nif it's disabled it's not doing anything.\n\n501\n00:25:53.380 --> 00:25:56.430\nHere it's turned on, so I know I've\ngot it and I know it's running.\n\n502\n00:25:56.430 --> 00:25:59.790\nAnd then if I look down a little\nbit more the current mode.\n\n503\n00:25:59.790 --> 00:26:01.610\nThe current mode is set to enforcing.\n\n504\n00:26:01.610 --> 00:26:04.690\nThere's three modes you're gonna see here,\nenforcing is the good one.\n\n505\n00:26:04.690 --> 00:26:06.350\nThat means there's rules and\n\n506\n00:26:06.350 --> 00:26:10.200\nif an application tries to break\nthe rules, it will stop it.\n\n507\n00:26:10.200 --> 00:26:14.940\nAnother one is disabled, [LAUGH]\ndisabled is it's not doing anything.\n\n508\n00:26:14.940 --> 00:26:17.000\nAnd then the third status is permissive.\n\n509\n00:26:17.000 --> 00:26:20.990\nPermissive says, if somebody tries\nto break the rules, we'll let them.\n\n510\n00:26:20.990 --> 00:26:24.490\nWe'll let them break the rules,\nbut then we'll log it.\n\n511\n00:26:24.490 --> 00:26:26.962\nWe'll keep a record that they\nbroke the rules, all right?\n\n512\n00:26:26.962 --> 00:26:30.217\nAnd we don't normally wanna be in\npermissive mode, but it is useful for\n\n513\n00:26:30.217 --> 00:26:33.660\ntroubleshooting, I'll show\nyou an example in a minute.\n\n514\n00:26:33.660 --> 00:26:37.518\nBut when I install an application, as\nlong as my application follows the rules,\n\n515\n00:26:37.518 --> 00:26:38.835\nit's not the big of a deal.\n\n516\n00:26:38.835 --> 00:26:43.160\nSo I installed the web server here Apache,\nand it's up and running.\n\n517\n00:26:43.160 --> 00:26:47.675\nAnd as long as I put my web files,\nright here in\n\n518\n00:26:47.675 --> 00:26:53.560\n/var/www/html, then I'm following\nthe rules and that's where it goes.\n\n519\n00:26:53.560 --> 00:26:58.772\nBut if you remember from way back in\nepisode one or two, where we talk about\n\n520\n00:26:58.772 --> 00:27:04.175\npartitioning, I created a partition,\nand that partition was /website.\n\n521\n00:27:04.175 --> 00:27:06.998\nI said, I wanna put my\nwebsite in this other folder.\n\n522\n00:27:06.998 --> 00:27:15.190\nAnd so I might go into /website and inside\nthere I might create a index.html file.\n\n523\n00:27:15.190 --> 00:27:17.391\nAnd so\nI've got this index file created and\n\n524\n00:27:17.391 --> 00:27:20.210\nthat's where I want my\nApache web service to use.\n\n525\n00:27:20.210 --> 00:27:23.042\nSo I go and I edit Apache's config, right?\n\n526\n00:27:23.042 --> 00:27:28.760\nI'd have to go and modify it, cuz we're\nkinda changing the way that it behaves.\n\n527\n00:27:28.760 --> 00:27:32.310\nAnd I can go in here and\nI can find where its root is.\n\n528\n00:27:32.310 --> 00:27:36.510\nAnd the root right now will be set\nto something like /var/www, or\n\n529\n00:27:36.510 --> 00:27:38.761\nit might not even be defined at all.\n\n530\n00:27:38.761 --> 00:27:41.160\nIf it's just the default,\nthen it'll assume a default.\n\n531\n00:27:41.160 --> 00:27:42.907\nSo I can go through and\nI can find it, here it is.\n\n532\n00:27:42.907 --> 00:27:47.449\nSee how it says DocumentRoot\n/var/www/html, maybe I come in and\n\n533\n00:27:47.449 --> 00:27:48.492\nI change that.\n\n534\n00:27:48.492 --> 00:27:51.430\nAnd I say, you know what, no,\nyou're gonna be in /website.\n\n535\n00:27:51.430 --> 00:27:52.713\nThat's where I want you to be.\n\n536\n00:27:52.713 --> 00:27:56.674\nAnd there's another entry right here,\nwhich I will change, there.\n\n537\n00:27:56.674 --> 00:28:00.584\nSo I'm remapping it,\nI'm taking this application,\n\n538\n00:28:00.584 --> 00:28:04.860\nand I'm just changing it to\ntell it to reside in /website.\n\n539\n00:28:04.860 --> 00:28:06.070\nThat's where I want it to be.\n\n540\n00:28:06.070 --> 00:28:07.090\n&gt;&gt; Perfect.\n&gt;&gt; Okay?\n\n541\n00:28:07.090 --> 00:28:14.140\nNow, I've configured the application\ncorrectly and if I restart Apache, okay?\n\n542\n00:28:14.140 --> 00:28:19.400\nIt's gonna restart and now it's\nlooking for its web files in /website.\n\n543\n00:28:19.400 --> 00:28:24.540\nThe problem is I'm breaking the rules,\nit's not going to work.\n\n544\n00:28:24.540 --> 00:28:31.125\nIf I fire up a web browser and\nI start trying to browse to pages.\n\n545\n00:28:31.125 --> 00:28:34.304\nLet's see, it's 132.16.0.100, okay?\n\n546\n00:28:34.304 --> 00:28:37.620\nSee how I get this\nRed Hat Enterprise Linux Test Page?\n\n547\n00:28:37.620 --> 00:28:40.210\nWell, I created an index.html\nthat was empty,\n\n548\n00:28:40.210 --> 00:28:43.110\nI should be seeing a white page and\nI'm not.\n\n549\n00:28:43.110 --> 00:28:46.450\nAnd the reason is Apache tried\nto reach into that folder and\n\n550\n00:28:46.450 --> 00:28:48.060\nit wasn't allowed to and it got stopped.\n\n551\n00:28:48.060 --> 00:28:51.081\nNow, I don't see that,\nI don't know that that happened, but\n\n552\n00:28:51.081 --> 00:28:53.258\nit did happen because\nI didn't see my index.\n\n553\n00:28:53.258 --> 00:28:56.850\nThat's SELinux doing it's job,\nthat's it blocking.\n\n554\n00:28:56.850 --> 00:28:59.740\nAnd if I look at my log files, right?\n\n555\n00:28:59.740 --> 00:29:06.240\nSo if I were to,\nlet me just tail the log file,\n\n556\n00:29:06.240 --> 00:29:10.220\nit logs to /var/log/audit/audit.log.\n\n557\n00:29:10.220 --> 00:29:13.660\nIf I look in there,\nwhat I should find in here somewhere\n\n558\n00:29:13.660 --> 00:29:18.560\nis where it tried to access that\nindex file and got blocked, okay?\n\n559\n00:29:18.560 --> 00:29:21.560\nAnd looking at this I've got\na lot of entries in here and so\n\n560\n00:29:21.560 --> 00:29:23.320\nit might be hard for me to find.\n\n561\n00:29:23.320 --> 00:29:28.730\nHere, see I was looking for\n/website/index.html, okay?\n\n562\n00:29:28.730 --> 00:29:32.210\nAnd as I read across here it's\ntelling me about the context and\n\n563\n00:29:32.210 --> 00:29:35.658\nit's showing an unconfined object.\n\n564\n00:29:35.658 --> 00:29:38.100\nAnd an unconfined object is one\nthat's not going to have access to.\n\n565\n00:29:38.100 --> 00:29:43.070\nSo it's getting denied that access and\nI end up getting the default page\n\n566\n00:29:43.070 --> 00:29:46.320\ninstead of that actual index,\nso it was blocked, okay?\n\n567\n00:29:46.320 --> 00:29:50.810\nAnd the problem is, according to SELinux,\n\n568\n00:29:50.810 --> 00:29:54.280\nApache shouldn't be accessing that folder,\nand so it's stopping it.\n\n569\n00:29:54.280 --> 00:29:57.460\nSo what I need to do is I need to\ntell SELinux that it's okay for\n\n570\n00:29:57.460 --> 00:29:59.670\nthat application to\naccess that other folder.\n\n571\n00:29:59.670 --> 00:30:02.294\nI'm opening it up,\nkinda like you open a port in a firewall,\n\n572\n00:30:02.294 --> 00:30:04.307\nhere I'm opening it up for\nthat application.\n\n573\n00:30:04.307 --> 00:30:06.950\nAnd SELinux controls not just file access,\nbut\n\n574\n00:30:06.950 --> 00:30:10.950\nport and network access as well,\nso you can control all that.\n\n575\n00:30:10.950 --> 00:30:14.632\nIn this case what I need to do is I\nneed to look at the default folder.\n\n576\n00:30:14.632 --> 00:30:18.490\nAnd if you take a look at like /var/www,\nright?\n\n577\n00:30:19.510 --> 00:30:22.260\nSee the files in here like html and\ncgi bin,\n\n578\n00:30:22.260 --> 00:30:25.240\nthese are ones that Apache would\nhave normally have access to.\n\n579\n00:30:25.240 --> 00:30:31.280\nIf you add a capital Z to the ls command,\nyou'll start to see the security context.\n\n580\n00:30:31.280 --> 00:30:39.340\nAnd see how that context for\nthe html folder is httpd_sys_content_t.\n\n581\n00:30:39.340 --> 00:30:43.450\nThe context for\nthat folder is httpd content, right?\n\n582\n00:30:43.450 --> 00:30:45.760\nIt expects web pages to be in there.\n\n583\n00:30:45.760 --> 00:30:50.810\nWell, if I do the same thing for /website,\n\n584\n00:30:50.810 --> 00:30:56.240\nit is just set to a default context,\nwhich Apache doesn't have access to.\n\n585\n00:30:56.240 --> 00:30:57.410\nSo I need to change that.\n\n586\n00:30:57.410 --> 00:31:01.000\nAnd there's a few ways to do it, but\nthe easiest way is to use chcon, so\n\n587\n00:31:01.000 --> 00:31:04.950\nI'm gonna change\nthe context of that folder.\n\n588\n00:31:04.950 --> 00:31:06.770\nI'm gonna use -R to make it recursive, so\n\n589\n00:31:06.770 --> 00:31:09.010\nit'll hit everything inside\nof the folder as well.\n\n590\n00:31:09.010 --> 00:31:14.070\nAnd the v is just verbose, so I'll get\nextra logging if I have an error, right?\n\n591\n00:31:14.070 --> 00:31:18.230\nAnd I'm gonna tell it that I wanna\nchange the type of that folder.\n\n592\n00:31:18.230 --> 00:31:26.547\nI'm gonna change it to\nhttpd_sys_content_t for /website.\n\n593\n00:31:26.547 --> 00:31:30.250\nSo that's gonna correct the context for\nthat folder.\n\n594\n00:31:30.250 --> 00:31:35.018\nAnd so now when Apache tries to access\nthat folder, it will be allowed to it,\n\n595\n00:31:35.018 --> 00:31:36.518\nit now has access to it.\n\n596\n00:31:36.518 --> 00:31:39.355\nSo just like the firewall\nwhere you open up a port,\n\n597\n00:31:39.355 --> 00:31:42.883\nhere I'm opening up a folder and\nallowing Apache to get to it.\n\n598\n00:31:42.883 --> 00:31:45.576\n&gt;&gt; Well Don,\nwhat about non-standard applications?\n\n599\n00:31:45.576 --> 00:31:48.482\n&gt;&gt; Yeah, this example was easy cuz it\nwas a standard application, right?\n\n600\n00:31:48.482 --> 00:31:53.134\nAll I had to do was look at /var/www and\nsee what the context was there and\n\n601\n00:31:53.134 --> 00:31:53.753\ncopy it.\n\n602\n00:31:53.753 --> 00:31:55.566\nSo that makes life really easy.\n\n603\n00:31:55.566 --> 00:31:57.454\nBut if you develop your own application,\nright?\n\n604\n00:31:57.454 --> 00:32:00.427\nAn in house application,\none you built yourself,\n\n605\n00:32:00.427 --> 00:32:02.787\nit's not gonna have a default context.\n\n606\n00:32:02.787 --> 00:32:05.630\nYou're not gonna be able to look at\nthat and use that as a cheat sheet.\n\n607\n00:32:05.630 --> 00:32:08.810\nSo the way to get around that is\nkind of an interesting system.\n\n608\n00:32:08.810 --> 00:32:11.780\nWhat you do is you stop your application.\n\n609\n00:32:11.780 --> 00:32:14.960\nYou just turn it off,\nturn off the non-standard application and\n\n610\n00:32:14.960 --> 00:32:17.360\nthen, you take SC Linux.\n\n611\n00:32:17.360 --> 00:32:19.592\nAnd you make it permissive okay.\n\n612\n00:32:19.592 --> 00:32:24.620\nI'm gonna say set enforce permissive and\nwhen I do that.\n\n613\n00:32:24.620 --> 00:32:27.390\nNow, it's going to let\nprograms break the rules.\n\n614\n00:32:27.390 --> 00:32:29.315\nBut when they break the rules\nit's going to log them.\n\n615\n00:32:29.315 --> 00:32:31.510\nIt's gonna keep track of that, okay.\n\n616\n00:32:31.510 --> 00:32:37.400\nSo now, I could start my non standard\napp so let's just pretend that it's,\n\n617\n00:32:39.260 --> 00:32:43.330\nhere let's put I'm gonna put\nthe context of that folder back.\n\n618\n00:32:43.330 --> 00:32:44.947\nSo I'm gonna make it default.\n\n619\n00:32:47.165 --> 00:32:48.410\nThat default context.\n\n620\n00:32:48.410 --> 00:32:51.650\nSo I'm putting that website back\nto the default context right and\n\n621\n00:32:51.650 --> 00:32:57.410\nthen I'm gonna say, I will stop httpd,\nall right and then I'll start it again.\n\n622\n00:32:59.470 --> 00:33:04.050\nOkay, so now that it's up and\nrunning I'm in permissive mode.\n\n623\n00:33:04.050 --> 00:33:06.940\nSo I can go through and\nI can start to break the rules, right?\n\n624\n00:33:06.940 --> 00:33:10.450\nSo I can fire up Chrome,\nChromium or whatever.\n\n625\n00:33:10.450 --> 00:33:12.390\nI can browse that site, I can try and\n\n626\n00:33:12.390 --> 00:33:15.370\naccess it and\nsee how I'm getting my white page now?\n\n627\n00:33:15.370 --> 00:33:17.660\nIt's cuz they empty it,\nit's working right?\n\n628\n00:33:17.660 --> 00:33:20.402\n&gt;&gt; It is.\n&gt;&gt; But in reality I'm breaking the rules.\n\n629\n00:33:20.402 --> 00:33:23.210\nI'm breaking the rules, and\nin the background it's logging it.\n\n630\n00:33:23.210 --> 00:33:25.340\nIt's keeping track of that.\n\n631\n00:33:25.340 --> 00:33:28.809\nSo now I can break the rules all I want,\nand when I'm done breaking the rules, and\n\n632\n00:33:28.809 --> 00:33:30.920\nI run through all the stuff\nmy application does.\n\n633\n00:33:30.920 --> 00:33:34.450\nYou do all the different activities\nthat your custom application does.\n\n634\n00:33:34.450 --> 00:33:36.800\nAnd when you're done,\nyou come back in here, and\n\n635\n00:33:36.800 --> 00:33:40.030\nyou can stop your application,\nwe can turn it off.\n\n636\n00:33:40.030 --> 00:33:44.520\nAnd now we can take the error logs and\ncovert them\n\n637\n00:33:44.520 --> 00:33:49.560\ninto a policy that will be able to be used\nby our system to allow that access, and\n\n638\n00:33:49.560 --> 00:33:52.440\nthe way we do that is using\na command called audit to allow.\n\n639\n00:33:52.440 --> 00:33:55.630\nI'm gonna use grep and\nI'm gonna look for httpd.\n\n640\n00:33:55.630 --> 00:33:58.100\nYou would look for whatever the name\nof your custom application was, so\n\n641\n00:33:58.100 --> 00:33:58.894\nwhatever the name is.\n\n642\n00:33:58.894 --> 00:34:07.055\nSo I will grep httpd from\n/var/log/audit/audit.log, right?\n\n643\n00:34:07.055 --> 00:34:08.912\nI'm gonna need to sudo this.\n\n644\n00:34:08.912 --> 00:34:11.910\nCuz only two users have\naccess to that log.\n\n645\n00:34:11.910 --> 00:34:15.960\nSo I'm telling it, give me every line from\nthat log that includes the name of my\n\n646\n00:34:15.960 --> 00:34:17.970\ncustom application, right.\n\n647\n00:34:17.970 --> 00:34:22.980\nAnd then I'm gonna pipe\nthat into audit2allow.\n\n648\n00:34:24.020 --> 00:34:28.250\nAnd I'm gonna tell it get all the errors,\nright and\n\n649\n00:34:28.250 --> 00:34:32.860\ncreate a module for me, create a policy\nmodule that allows those errors right?\n\n650\n00:34:32.860 --> 00:34:38.200\nSo I can come in and\nI can then say, dash M and the name\n\n651\n00:34:38.200 --> 00:34:42.540\nof the module we're looking for I'm gonna\ncall mine HTPD cuz that's the program and\n\n652\n00:34:42.540 --> 00:34:44.570\nthen dash W to say to\nwrite it out to a file.\n\n653\n00:34:44.570 --> 00:34:48.516\nNow I'm gonna write that to a file so\nactually I have a slight problem here I\n\n654\n00:34:48.516 --> 00:34:52.336\nneed to get out of the folder that I'm\nin so let me copy that real quick and\n\n655\n00:34:52.336 --> 00:34:54.395\nget into my home folder, there we go.\n\n656\n00:34:54.395 --> 00:34:56.160\nAll right, now I'm gonna run that command.\n\n657\n00:34:56.160 --> 00:35:01.100\nOkay, now when I run the command its\nlooking and its reaching out trying to\n\n658\n00:35:01.100 --> 00:35:04.090\nfind that information from the file and\nthen feed it through audit to allow.\n\n659\n00:35:04.090 --> 00:35:07.320\nI got a little bit of an error about\nmissing some local file context but\n\n660\n00:35:07.320 --> 00:35:09.945\nI'm okay with that cuz it will\npull the other errors and\n\n661\n00:35:09.945 --> 00:35:12.420\ngive me the data that I\nneed to write there okay.\n\n662\n00:35:12.420 --> 00:35:14.345\n&gt;&gt; So Don now that we know what\nthe errors are, what do we do them?\n\n663\n00:35:14.345 --> 00:35:16.009\n&gt;&gt; All right so\nwe can take those errors and\n\n664\n00:35:16.009 --> 00:35:18.340\nwe can feed them right into\nthe audit to allow command.\n\n665\n00:35:18.340 --> 00:35:18.893\n&gt;&gt; Okay.\n&gt;&gt; And\n\n666\n00:35:18.893 --> 00:35:22.411\nthe audit to allow command will convert\nthem into a policy that we can use to\n\n667\n00:35:22.411 --> 00:35:23.620\nallow the errors right.\n\n668\n00:35:23.620 --> 00:35:27.260\nAnd so those aren't errors we actually\nwant to allow that access okay.\n\n669\n00:35:27.260 --> 00:35:29.950\nSo let me clear my screen here and\nI'm gonna it's a long command.\n\n670\n00:35:29.950 --> 00:35:30.698\nSo we need all the room we can get.\n\n671\n00:35:30.698 --> 00:35:31.220\n&gt;&gt; All right.\n\n672\n00:35:31.220 --> 00:35:34.932\n&gt;&gt; [LAUGH] I'm gonna come in here and I'm\ngonna sudo this because I need access to\n\n673\n00:35:34.932 --> 00:35:37.549\nthe logs and\nonly the administrator has that access.\n\n674\n00:35:37.549 --> 00:35:41.427\nSo, I'm going to grep for whatever\nthe name of my application is, right?\n\n675\n00:35:41.427 --> 00:35:42.507\nI'm doing HTTPD.\n\n676\n00:35:42.507 --> 00:35:45.100\nYou would change this to\nwhatever yours was called.\n\n677\n00:35:45.100 --> 00:35:51.022\nAnd I'm gonna grep for\nthat in /var/logs/audit/audit.log.\n\n678\n00:35:51.022 --> 00:35:55.841\nAll right and so that's gonna return\nevery line that has HTTPD in it, and\n\n679\n00:35:55.841 --> 00:35:59.883\nthen I'm going to pipe that\ninto the audit2allow command.\n\n680\n00:35:59.883 --> 00:36:00.499\nAll right,\n\n681\n00:36:00.499 --> 00:36:04.694\nnow if you don't have that command it's\npart of the policycoreutils-python,\n\n682\n00:36:04.694 --> 00:36:08.560\npolicycoretools-python, I believe\nis the name of the package.\n\n683\n00:36:08.560 --> 00:36:13.240\nBut it's what has audit to allow in it,\nand we can feed it into that.\n\n684\n00:36:13.240 --> 00:36:17.390\nAnd we can tell it, hey,\ngive me some output, show me the errors.\n\n685\n00:36:17.390 --> 00:36:20.300\nAnd write them to the screen so\nthat I can see what they are.\n\n686\n00:36:20.300 --> 00:36:22.080\nAnd so it's gonna parse through.\n\n687\n00:36:22.080 --> 00:36:24.720\nAnd it'll show me what errors happened and\nwhy they happened.\n\n688\n00:36:24.720 --> 00:36:26.670\nAnd so when I run that, here they are.\n\n689\n00:36:26.670 --> 00:36:33.191\nAnd so I can start to see each of these,\nlike here, httpd was denied read access.\n\n690\n00:36:33.191 --> 00:36:35.930\nAnd the reason I just don't want\nto blindly run audit to allow.\n\n691\n00:36:35.930 --> 00:36:39.762\nI might be allowing other unauthorized I\nwant to make sure that only the authorized\n\n692\n00:36:39.762 --> 00:36:43.620\nstuff shows up in here and I can see\neach of the errors that occurred.\n\n693\n00:36:43.620 --> 00:36:47.821\nAnd if I'm happy with that output it just\nhas the stuff that I want to permit I\n\n694\n00:36:47.821 --> 00:36:52.421\ncan change that command and get rid of the\n-w cuz I don't want to write to screen and\n\n695\n00:36:52.421 --> 00:36:54.044\nchange that m to a capital M.\n\n696\n00:36:54.044 --> 00:36:58.070\nAnd now it's gonna write a policy file for\nme.\n\n697\n00:36:58.070 --> 00:37:03.798\nAnd so when I run that,\nit creates this guy right here, httpd.pp.\n\n698\n00:37:03.798 --> 00:37:07.343\nOkay, it's called httpd cuz that's what\nI chose to call it when I did this\n\n699\n00:37:07.343 --> 00:37:08.038\n-m, right?\n\n700\n00:37:08.038 --> 00:37:10.330\nYou could have called it anything else.\n\n701\n00:37:10.330 --> 00:37:13.240\nAnd now I just need to import it, which\nthey give me the command for right here.\n\n702\n00:37:13.240 --> 00:37:17.510\nSo I can say semodule -i and\nthe name of the module and\n\n703\n00:37:17.510 --> 00:37:20.033\nactually I need to sudo that and\n\n704\n00:37:20.033 --> 00:37:25.420\nthat's gonna merge that module\ninto my security policy.\n\n705\n00:37:25.420 --> 00:37:29.430\nAnd so now, every time I run\nIt'll have access to that folder.\n\n706\n00:37:29.430 --> 00:37:31.331\nSo I don't have to know a ton\nabout the application, right?\n\n707\n00:37:31.331 --> 00:37:35.667\nI can have custom applications and\nwe just gather the errors, right,\n\n708\n00:37:35.667 --> 00:37:37.100\nand load them in.\n\n709\n00:37:37.100 --> 00:37:40.470\nI do need to make sure that I put SC Linux\nback to, if I do SC Status that I put\n\n710\n00:37:40.470 --> 00:37:47.270\nSC Linux back into enforcing.\n\n711\n00:37:47.270 --> 00:37:49.595\nAnd actually mine already jumped\nback to enforcing for me.\n\n712\n00:37:49.595 --> 00:37:51.710\nYou don't want to leave it in permissive,\nright.\n\n713\n00:37:51.710 --> 00:37:55.690\nIf you moved into Permissive mode then\nit's gonna be allowing that access.\n\n714\n00:37:55.690 --> 00:37:59.623\nWe need to make sure that we do a set\nenforce enforcing because we did set\n\n715\n00:37:59.623 --> 00:38:01.366\nenforce permissive earlier.\n\n716\n00:38:01.366 --> 00:38:04.622\nBut you'll find if you wait long enough\nthat it'll actually flip back to enforcing\n\n717\n00:38:04.622 --> 00:38:05.250\non it's own.\n\n718\n00:38:05.250 --> 00:38:05.922\nWhich is what mine did.\n\n719\n00:38:05.922 --> 00:38:11.520\nSo either way, once we get that set now\nSE Linux is allowing that application.\n\n720\n00:38:11.520 --> 00:38:15.300\nBut it's not giving it any access\nbeyond the bare minimum, right?\n\n721\n00:38:15.300 --> 00:38:20.058\nSo SE Linux an amazing way to harden\nyour system, and I cringe every time I\n\n722\n00:38:20.058 --> 00:38:24.985\nread an Internet tutorial, where on\nstep two they say, disable SE Linux.\n\n723\n00:38:24.985 --> 00:38:28.267\nIt's shocking to me, cuz I'm like,\nyou don't need to disable it,\n\n724\n00:38:28.267 --> 00:38:29.240\njust configure it.\n\n725\n00:38:29.240 --> 00:38:32.840\nIt's not that hard, just go and open\nit up, and then you'll be in business.\n\n726\n00:38:32.840 --> 00:38:34.786\nBut a lot of people don't understand it,\nand they turn it off.\n\n727\n00:38:34.786 --> 00:38:38.650\nUbuntu doesn't even have it installed\nby default, that's very common.\n\n728\n00:38:38.650 --> 00:38:42.850\nBut when you're deploying a service\nrunning on a Linux server,\n\n729\n00:38:42.850 --> 00:38:43.850\nSELinux is your friend.\n\n730\n00:38:43.850 --> 00:38:46.500\nYou want that, it's there,\nit's protecting you.\n\n731\n00:38:46.500 --> 00:38:50.100\nSo if a hacker breaks into an application,\nit's holding them to a particular area and\n\n732\n00:38:50.100 --> 00:38:52.620\npenning them in, and\nthat is really really handy.\n\n733\n00:38:52.620 --> 00:38:54.120\nYou definitely wanna use it.\n\n734\n00:38:54.120 --> 00:38:55.760\n&gt;&gt; Hardening your Linux server.\n\n735\n00:38:55.760 --> 00:38:56.950\nThat's excellent stuff Don.\n\n736\n00:38:56.950 --> 00:38:59.370\nDo you have anything\nelse you'd like to add?\n\n737\n00:38:59.370 --> 00:39:01.940\n&gt;&gt; Well you know there is a good\nbit more to hardening a server.\n\n738\n00:39:01.940 --> 00:39:03.101\nI showed you some of the basics,\n\n739\n00:39:03.101 --> 00:39:05.002\nwe still need to talk a little\nbit about SSH, right?\n\n740\n00:39:05.002 --> 00:39:08.012\nI haven't secured it as much as I want but\nwe'll do that in a separate show.\n\n741\n00:39:08.012 --> 00:39:10.531\nWe'll see hardening SSH as\nits kind of own entity.\n\n742\n00:39:10.531 --> 00:39:13.877\nSo, we'll get a chance to see that but\nthen also what ever\n\n743\n00:39:13.877 --> 00:39:19.240\nserver you are setting up, If it's a MySQL\ndatabase, If it's Apache or whatever.\n\n744\n00:39:19.240 --> 00:39:21.427\nAll of them have their own\nsecurity infrastructure,\n\n745\n00:39:21.427 --> 00:39:24.731\ntheir own security tools and so, you'll\nneed to customize them, tweek them and\n\n746\n00:39:24.731 --> 00:39:27.030\nget them configured the way\nthat they are recommended.\n\n747\n00:39:27.030 --> 00:39:29.190\nSo you've gotta read the documentation.\n\n748\n00:39:29.190 --> 00:39:31.660\nRead the documentation of those services,\nand find out what they recommend for\n\n749\n00:39:31.660 --> 00:39:33.390\nconfiguring them, it goes a step further.\n\n750\n00:39:33.390 --> 00:39:36.180\nBut everything I showed you in\nthis episode is stuff that I do on\n\n751\n00:39:36.180 --> 00:39:37.820\nevery single server that I touch.\n\n752\n00:39:37.820 --> 00:39:42.100\nThis is all important stuff to make sure\nthat your system is as secure as possible.\n\n753\n00:39:42.100 --> 00:39:43.850\n&gt;&gt; Excellent information as usual, Don.\n\n754\n00:39:43.850 --> 00:39:47.970\nBecoming a Linux Server Administrator,\nthere's a lot of video content in this\n\n755\n00:39:47.970 --> 00:39:51.450\nseries, make sure you watch every\nsingle video, you'll be glad you did.\n\n756\n00:39:51.450 --> 00:39:55.420\nAnd thank you for watching ITProTV\nremember a good IT pro is always learning,\n\n757\n00:39:55.420 --> 00:39:56.344\nI'm Zach Memos.\n\n758\n00:39:56.344 --> 00:39:57.436\n&gt;&gt; And I'm Don Pezet.\n\n759\n00:39:57.436 --> 00:39:59.734\n&gt;&gt; And we'll see you very soon.\n\n760\n00:39:59.734 --> 00:40:06.213\n[MUSIC]\n\n761\n00:40:06.213 --> 00:40:08.872\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "225993163"
        },
        {
          "description": "Don and Zach discuss what are some of the things we need to configure in SSH, SSHD, AllowUsers Policy, AllowGroups Policy, restarting SSH, using Certificates to login, generating a Public/ Private Key Pair, disabling Password Authentication on the server, changing the port in the SSHD config, allowing the port in the Firewall, and testing the connection.",
          "length": "1452",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-3-configuring_ssh-071817-PGM.00_23_55_28.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-3-configuring_ssh-071817-PGM.00_23_55_28.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-3-configuring_ssh-071817-PGM.00_23_55_28.Still001-sm.jpg",
          "title": "Configuring SSH",
          "transcript": "WEBVTT\n\n1\n00:00:00.008 --> 00:00:08.259\nWelcome to ITPro.TV I'm your\nhost Don Pezet [CROSSTALK].\n\n2\n00:00:08.259 --> 00:00:12.470\n&gt;&gt; You're watching ITPro.TV.\n\n3\n00:00:12.470 --> 00:00:15.630\n&gt;&gt; Hello, and thank you for\nwatching ITPro.TV.\n\n4\n00:00:15.630 --> 00:00:19.040\nHelping you learn wherever you go,\nI'm your host, Zach Memos,\n\n5\n00:00:19.040 --> 00:00:24.210\nas we continue on with becoming an Linux\nserver administrator and the person\n\n6\n00:00:24.210 --> 00:00:28.380\nbringing us all the information we need,\nis our IT Pro, Don Pezet, right here.\n\n7\n00:00:28.380 --> 00:00:29.262\nGood morning Don.\n\n8\n00:00:29.262 --> 00:00:30.270\n&gt;&gt; Good morning Zach.\n\n9\n00:00:30.270 --> 00:00:31.311\nReady to dive right back into that world?\n\n10\n00:00:31.311 --> 00:00:33.621\n&gt;&gt; Yeah.\n&gt;&gt; Of Linux server administration and\n\n11\n00:00:33.621 --> 00:00:37.590\nin this episode we're gonna focus in\non our first actual server right?\n\n12\n00:00:37.590 --> 00:00:40.620\nSo in our earlier episodes we focused on\njust installing the operating system and\n\n13\n00:00:40.620 --> 00:00:41.200\ngetting it set up.\n\n14\n00:00:41.200 --> 00:00:44.730\nNow we're gonna look at a server and\nthat server is going to be the SSHD or\n\n15\n00:00:44.730 --> 00:00:47.060\nthe Secure Shell Demon.\n\n16\n00:00:47.060 --> 00:00:50.520\nAnd that's what we can use\nto remotely access a system.\n\n17\n00:00:50.520 --> 00:00:53.198\nGain shell access and\ndo it in an encrypted, secure fashion.\n\n18\n00:00:53.198 --> 00:00:54.940\nAnd then work with that system remotely.\n\n19\n00:00:54.940 --> 00:00:58.650\nWith the servers, we don't normally hook a\nmonitor and a keyboard up to them, right?\n\n20\n00:00:58.650 --> 00:01:01.410\nWe need to be able to remote in and\nmanage them.\n\n21\n00:01:01.410 --> 00:01:03.713\nAnd what you'll find is\nthat on most distros,\n\n22\n00:01:03.713 --> 00:01:07.980\nincluding the one I've been using in this\nseries, is that SSH is already installed.\n\n23\n00:01:07.980 --> 00:01:08.600\nIt's already there.\n\n24\n00:01:08.600 --> 00:01:10.840\nIt's already turned on and running.\n\n25\n00:01:10.840 --> 00:01:14.730\nSo in reality you could just hit\nthe old skip button on this episode and\n\n26\n00:01:14.730 --> 00:01:15.930\nmove to the next one right?\n\n27\n00:01:15.930 --> 00:01:20.000\nBut what you'll find is that a lot of the\ndefault settings that are in there are not\n\n28\n00:01:20.000 --> 00:01:23.870\nnecessarily what you want to get SSH\nrunning the way that you need it.\n\n29\n00:01:23.870 --> 00:01:25.134\nSo there are some tweaks,\n\n30\n00:01:25.134 --> 00:01:28.450\nsome little changes you wanna\nmake to secure the SSH service.\n\n31\n00:01:28.450 --> 00:01:31.680\nAnd get it running as securely and\nas stably as possible before we go and\n\n32\n00:01:31.680 --> 00:01:32.843\nplay out in production.\n\n33\n00:01:32.843 --> 00:01:35.190\nSo that's what we're gonna look\nat right here in this episode.\n\n34\n00:01:35.190 --> 00:01:36.720\n&gt;&gt; So, right off the bat Don.\n\n35\n00:01:36.720 --> 00:01:41.320\nWhat is some of the things we\nneed to configure first in SSH?\n\n36\n00:01:41.320 --> 00:01:44.170\n&gt;&gt; All right, well the first\nthing that I recommend is that\n\n37\n00:01:44.170 --> 00:01:48.310\nyou have a security policy, right, and\nI don't mean like some software policy or\n\n38\n00:01:48.310 --> 00:01:50.170\napplication, I mean a piece of paper.\n\n39\n00:01:50.170 --> 00:01:54.130\nAnd on that paper, a list of how\nyou want SSH to be configured.\n\n40\n00:01:54.130 --> 00:01:57.090\nBecause what you'll find is that\nthe default configuration varies\n\n41\n00:01:57.090 --> 00:01:58.720\ngreatly between operating systems.\n\n42\n00:01:58.720 --> 00:02:00.030\nIf you've been watching this whole series,\n\n43\n00:02:00.030 --> 00:02:03.540\nyou'll remember we installed,\nwe did Red Hat Enterprise Linux 7.\n\n44\n00:02:03.540 --> 00:02:07.980\nAnd after the install, I went to SSHN,\nand I said I'm SSHN with\n\n45\n00:02:07.980 --> 00:02:12.480\nmy regular user because the root user\nis not allowed to remotely log in.\n\n46\n00:02:12.480 --> 00:02:16.790\nBut then I tried with Root and it let me\nlog in, that in this particular release,\n\n47\n00:02:16.790 --> 00:02:19.620\nthey're allowing that by default,\nand I may not want that.\n\n48\n00:02:19.620 --> 00:02:22.890\nAnother distro, like Ubuntu,\nmight not allow that by default and\n\n49\n00:02:22.890 --> 00:02:25.380\nyou've gotta log in as a regular user and\nelevate your privileges,\n\n50\n00:02:25.380 --> 00:02:27.120\nwhich is good security practice.\n\n51\n00:02:27.120 --> 00:02:28.210\nThat's what we want.\n\n52\n00:02:28.210 --> 00:02:32.370\nSo we need to have a list of all of\nthose settings, what we wanna change.\n\n53\n00:02:32.370 --> 00:02:35.910\nAnd so, that way we do it consistently\nacross all of our servers.\n\n54\n00:02:35.910 --> 00:02:38.490\nAnd in this case,\nmy server's not consistent right now.\n\n55\n00:02:38.490 --> 00:02:40.300\nI don't want the root user logging in.\n\n56\n00:02:40.300 --> 00:02:42.800\nSo that's the first thing that\nI'm gonna modify on my system is,\n\n57\n00:02:42.800 --> 00:02:47.760\nI want to change who's allowed\nto SSH into the system, right?\n\n58\n00:02:47.760 --> 00:02:51.070\nAnd that's double important when\nyou have things like file servers.\n\n59\n00:02:51.070 --> 00:02:53.394\nBecause on a final server, you'll have\nusers that are allowed to authenticate.\n\n60\n00:02:53.394 --> 00:02:56.060\nThey might be able to browse in and\naccess a folder share.\n\n61\n00:02:56.060 --> 00:02:58.100\nBut you don't want them\nto SSH into the system.\n\n62\n00:02:58.100 --> 00:02:59.530\nSo we need a way to control that.\n\n63\n00:02:59.530 --> 00:03:04.843\nYou can control it with a firewall, or\nyou can control it right inside of SSHD.\n\n64\n00:03:04.843 --> 00:03:06.240\nSo let me show you how that works.\n\n65\n00:03:06.240 --> 00:03:07.600\nI'll do it right here on my system.\n\n66\n00:03:07.600 --> 00:03:08.150\n&gt;&gt; Awesome.\n\n67\n00:03:08.150 --> 00:03:11.080\n&gt;&gt; So on my system,\nI'm gonna go ahead and do SSH.\n\n68\n00:03:11.080 --> 00:03:15.380\nAnd I'm going to try to log in as the root\nuser to that server that we just spun up.\n\n69\n00:03:15.380 --> 00:03:18.714\nI assign the IP address\nto it 172.16.0.100.\n\n70\n00:03:18.714 --> 00:03:21.262\nAnd when I reach out,\nit's asking me for a password.\n\n71\n00:03:21.262 --> 00:03:25.919\nAnd I'm in, so It let me\nremotely log in as the root user,\n\n72\n00:03:25.919 --> 00:03:29.780\nwhich like I said is not\nexactly what I want.\n\n73\n00:03:29.780 --> 00:03:31.740\nWe're going to go in and change that.\n\n74\n00:03:31.740 --> 00:03:33.520\nSo that I don't have to worry\nabout that route user logging in.\n\n75\n00:03:34.520 --> 00:03:38.640\nNow all of this is configured in a file,\n\n76\n00:03:38.640 --> 00:03:42.570\nlet me get into /ETC/SSH.\n\n77\n00:03:42.570 --> 00:03:51.000\nAnd in that folder, you'll find a file in\nthere which is SSH_CONFIG and SSHD_CONFIG.\n\n78\n00:03:51.000 --> 00:03:54.430\nBe careful because they're one letter off,\nright?\n\n79\n00:03:54.430 --> 00:03:59.710\nThis one ssh config,\nthat's when you're using ssh as a client,\n\n80\n00:03:59.710 --> 00:04:04.060\nsshd config, that's the server,\nright, the ssh daemon.\n\n81\n00:04:04.060 --> 00:04:06.910\nThat's the one that I actually\nwanna modify to customize\n\n82\n00:04:06.910 --> 00:04:08.190\nhow things are working.\n\n83\n00:04:08.190 --> 00:04:11.050\nAnd if we go in and edit that file.\n\n84\n00:04:11.050 --> 00:04:17.855\nSo this is /etc/sh/sshd_config.\n\n85\n00:04:17.855 --> 00:04:21.448\nAnd if we edit that file you'll see\na number of settings in here that\n\n86\n00:04:21.448 --> 00:04:24.820\nwe can modify to change\nthe behavior of the service.\n\n87\n00:04:24.820 --> 00:04:27.720\nAnd what I'm looking for and\nwe'll see if it's already in here or\n\n88\n00:04:27.720 --> 00:04:31.560\nif they just let it out,\nis the allow user section.\n\n89\n00:04:31.560 --> 00:04:36.540\nYou can come through and you can specify\nwho's allowed to use the system and\n\n90\n00:04:36.540 --> 00:04:39.380\nwho is not as far as SSH is concerned.\n\n91\n00:04:39.380 --> 00:04:43.250\nAnd so as I skimmed across it here,\nI might have missed it, but I didn't see\n\n92\n00:04:43.250 --> 00:04:47.670\nanywhere in here where they're currently\nallowing or blocking any users.\n\n93\n00:04:47.670 --> 00:04:51.380\nAnd I'm doing this the human way of\nscanning down when I should have just used\n\n94\n00:04:51.380 --> 00:04:55.880\nthe system search and did a quick look for\nallow users all right.\n\n95\n00:04:55.880 --> 00:04:57.030\nThat's not found.\n\n96\n00:04:57.030 --> 00:04:58.135\nAnd I'll look for allow groups.\n\n97\n00:04:58.135 --> 00:05:01.070\nAnd that was not found either, okay.\n\n98\n00:05:01.070 --> 00:05:03.950\nRight now there are no allow\nstatements in here by defaults.\n\n99\n00:05:03.950 --> 00:05:07.230\nThat means everybodys allowed to use it.\n\n100\n00:05:07.230 --> 00:05:11.334\nBut If we start coming in here and\nchanging these values we can modify it to\n\n101\n00:05:11.334 --> 00:05:16.210\nsay, I only want certain people to get in\nand I don't want other people to get in.\n\n102\n00:05:16.210 --> 00:05:18.610\nAs I come through here I'll just\njump down to the very bottom.\n\n103\n00:05:18.610 --> 00:05:22.900\nThat's usually the best place to add\nthings, and I'll come down to the bottom\n\n104\n00:05:22.900 --> 00:05:26.995\nof this file and I'm just gonna add\na couple of entries here, I'm gonna say\n\n105\n00:05:26.995 --> 00:05:31.228\nallow users and then I'm gonna specify\nwho it is that I want to allow to SSH in.\n\n106\n00:05:31.228 --> 00:05:34.580\nAnd it might be that I just want me,\nnobody else just me.\n\n107\n00:05:34.580 --> 00:05:37.030\nAllow users dpezet and that's it.\n\n108\n00:05:37.030 --> 00:05:39.050\nOkay and leave it at that and that's done.\n\n109\n00:05:39.050 --> 00:05:43.758\nBut if I have other users,\nI might have Bob Smith or Jane Doe,\n\n110\n00:05:43.758 --> 00:05:45.700\nor whatever, I start punching them in.\n\n111\n00:05:45.700 --> 00:05:48.110\nJust put a space in between each one and\nyou can list those people out.\n\n112\n00:05:48.110 --> 00:05:50.370\nOr the accounts that\nare allowed to ssh in.\n\n113\n00:05:51.760 --> 00:05:54.240\nYou might also want to do\nthis based on groups right.\n\n114\n00:05:54.240 --> 00:05:56.020\nSo instead of allow users like this,\n\n115\n00:05:56.020 --> 00:06:00.050\nI could say AllowGroups and\nthen provide group names.\n\n116\n00:06:00.050 --> 00:06:02.640\nSo maybe I want to allow adm,\nthe admin group.\n\n117\n00:06:02.640 --> 00:06:04.575\nOr, maybe I've created some custom group,\nright?\n\n118\n00:06:04.575 --> 00:06:07.714\nFor my NOC or helpdesk, or whatever.\n\n119\n00:06:07.714 --> 00:06:10.560\nI wanna allow them to SSH in, right?\n\n120\n00:06:10.560 --> 00:06:12.570\nRemember, you're not giving them\nany special privileges here.\n\n121\n00:06:12.570 --> 00:06:13.520\nIt's still their regular user account.\n\n122\n00:06:13.520 --> 00:06:17.830\nYou're just saying whether or\nnot they're allowed to use SSH, all right?\n\n123\n00:06:17.830 --> 00:06:20.720\nSo, those are a couple of good things to\nconfigure right there to dictate whose\n\n124\n00:06:20.720 --> 00:06:21.260\nallowed to it.\n\n125\n00:06:21.260 --> 00:06:24.520\nThere is one more though, the root user.\n\n126\n00:06:24.520 --> 00:06:25.760\nWith the root users, it's not so\n\n127\n00:06:25.760 --> 00:06:28.680\nmuch that I want to allow the root\nusers that I wanna block them.\n\n128\n00:06:28.680 --> 00:06:32.215\nI wanna deny them the ability to use\nSSH and unfortunately with these\n\n129\n00:06:32.215 --> 00:06:36.195\nallows statements when you put them in,\nthey don't apply to the root user.\n\n130\n00:06:36.195 --> 00:06:39.019\nSo just because I left the root\nuser out of this list,\n\n131\n00:06:39.019 --> 00:06:41.468\ndoesn't mean they won't\nbe able to use SSH.\n\n132\n00:06:41.468 --> 00:06:43.968\nThey can still come in and use it, right.\n\n133\n00:06:43.968 --> 00:06:47.520\nSo there's a special setting for\nthe root user and\n\n134\n00:06:47.520 --> 00:06:50.489\nlet me see if it's already in here or not.\n\n135\n00:06:50.489 --> 00:06:54.356\nSo I'm basically just search for\n\n136\n00:06:54.356 --> 00:06:59.474\npermit root login all right and\nthere it is.\n\n137\n00:06:59.474 --> 00:07:00.450\nIt's commented out.\n\n138\n00:07:00.450 --> 00:07:03.022\nSo it's commented out so\nit's not applying in here,\n\n139\n00:07:03.022 --> 00:07:05.664\nyou'll see it says permit root log in,\nyes all right.\n\n140\n00:07:05.664 --> 00:07:08.997\nSo the default is, that's where they\nusually put you as the default,\n\n141\n00:07:08.997 --> 00:07:11.890\nis that yes they're allowing\nthe root user to login.\n\n142\n00:07:11.890 --> 00:07:15.900\nSo I may wanna change that and come in and\nsay you know what, I don't want that.\n\n143\n00:07:15.900 --> 00:07:20.040\nSo I'm gonna say permit, root login no.\n\n144\n00:07:20.040 --> 00:07:23.940\nOkay, now notice I left the initial line\ncommented out and I added my own that's so\n\n145\n00:07:23.940 --> 00:07:25.410\nI can remember what the default is.\n\n146\n00:07:25.410 --> 00:07:26.580\nSometimes it's hard to remember and\n\n147\n00:07:26.580 --> 00:07:28.570\nif I just leave that there\nthat helps me remember.\n\n148\n00:07:28.570 --> 00:07:30.960\nSo I'm saying permit root login no.\n\n149\n00:07:30.960 --> 00:07:35.454\nSo I used allow users and\nallow groups to specify who is gonna be\n\n150\n00:07:35.454 --> 00:07:39.432\nable to come in and\nthen I'm doing PermitRootLogIn and\n\n151\n00:07:39.432 --> 00:07:43.690\nsetting that to no to stop the root user,\nall right.\n\n152\n00:07:43.690 --> 00:07:47.280\nNow when you make a change like that\nthe change doesn't take effect right\n\n153\n00:07:47.280 --> 00:07:48.180\naway, right?\n\n154\n00:07:48.180 --> 00:07:50.921\nSo we really need to\nrestart the SSH service.\n\n155\n00:07:50.921 --> 00:07:54.637\nAnd this is another important thing,\nwhen you're configuring\n\n156\n00:07:54.637 --> 00:07:59.535\nSSH if you're doing this remotely there's\nthe chance you could lock yourself out.\n\n157\n00:07:59.535 --> 00:08:04.020\nWhat if the root user account's the only\naccount I have and I just blocked it?\n\n158\n00:08:04.020 --> 00:08:06.090\nI restart their service,\nI dropped my connection, and\n\n159\n00:08:06.090 --> 00:08:07.890\nnow I can't connect back in.\n\n160\n00:08:07.890 --> 00:08:11.760\nSo we need to make sure that we've already\ngot another user account that we've\n\n161\n00:08:11.760 --> 00:08:15.180\nalready tested so we know we'll be able\nto get back in using that other account.\n\n162\n00:08:15.180 --> 00:08:17.730\nVery important to make sure you do that.\n\n163\n00:08:17.730 --> 00:08:19.588\nCuz you did not want to lock yourself out.\n\n164\n00:08:19.588 --> 00:08:20.822\n&gt;&gt; [LAUGH] [CROSSTALK] That'd be terrible.\n\n165\n00:08:20.822 --> 00:08:24.929\n&gt;&gt; So, I've saved my file and\nI'm gonna come in here and\n\n166\n00:08:24.929 --> 00:08:27.940\nsay systemctl restart sshd.\n\n167\n00:08:27.940 --> 00:08:29.900\nAnd I'm gonna restart it, okay.\n\n168\n00:08:29.900 --> 00:08:35.350\nNow, now that that's done,\nI'm gonna close my session and\n\n169\n00:08:35.350 --> 00:08:38.290\nI'm gonna try to connect\nback in as route again.\n\n170\n00:08:38.290 --> 00:08:44.720\nAll right, and when I go and connect in,\nit's thinking and I got permission denied.\n\n171\n00:08:44.720 --> 00:08:46.150\nWell, maybe I'll type the password wrong,\nright?\n\n172\n00:08:46.150 --> 00:08:46.920\nSo let's try that again.\n\n173\n00:08:46.920 --> 00:08:48.340\nSo I'll type that password again.\n\n174\n00:08:49.730 --> 00:08:51.480\nPermission denied, okay.\n\n175\n00:08:51.480 --> 00:08:53.930\nI'm typing the password right, but\n\n176\n00:08:53.930 --> 00:08:57.890\nI'm specifically blocked in the service so\nI can't log in.\n\n177\n00:08:57.890 --> 00:09:02.060\nSo now if an attacker tries to brute\nforce the password on my root account,\n\n178\n00:09:02.060 --> 00:09:02.960\nthey won't be able to.\n\n179\n00:09:02.960 --> 00:09:06.220\nEven if they get the right password,\nit shows the password is wrong so now I've\n\n180\n00:09:06.220 --> 00:09:10.210\neliminated the ability of somebody brute\nforcing the root account via SSH, right.\n\n181\n00:09:10.210 --> 00:09:11.620\nThat's a great protection to have and\n\n182\n00:09:11.620 --> 00:09:14.520\nit's pretty easy to put in place\njust by changing those settings.\n\n183\n00:09:14.520 --> 00:09:17.250\nSo, that's a pretty standard\npolicy that I've put in.\n\n184\n00:09:17.250 --> 00:09:21.620\nI do still need to test to make\nsure I can get in myself, right.\n\n185\n00:09:21.620 --> 00:09:23.630\nSo, let me try and log in as myself.\n\n186\n00:09:23.630 --> 00:09:25.270\nI created that account.\n\n187\n00:09:25.270 --> 00:09:30.350\nI'll punch in my password and\nI should see that I get in.\n\n188\n00:09:30.350 --> 00:09:33.114\nOur biggest challenge here\nis apparently whether or\n\n189\n00:09:33.114 --> 00:09:36.959\nnot I can remember my password and\nlet's try this again here real quick.\n\n190\n00:09:38.140 --> 00:09:41.375\nJust launch another session, there we go.\n\n191\n00:09:41.375 --> 00:09:43.870\nSo, it doesn't help you\nremember your password,\n\n192\n00:09:43.870 --> 00:09:45.030\nthat's one thing the system doesn't do.\n\n193\n00:09:45.030 --> 00:09:48.440\nBut once you can remember your own\npassword then you can get in and I'll go\n\n194\n00:09:48.440 --> 00:09:51.330\nback to the statement of you should make\nsure you test out your second account,\n\n195\n00:09:51.330 --> 00:09:53.110\nthat you're actually able to remote in and\n\n196\n00:09:53.110 --> 00:09:55.720\nknow your password to\nmake sure this all works.\n\n197\n00:09:55.720 --> 00:09:58.590\nWe did have a comment in the chatroom from\nStanley where he was saying what he likes\n\n198\n00:09:58.590 --> 00:10:03.330\nto do is already leave a session up, and\nthen go and test with the second one.\n\n199\n00:10:03.330 --> 00:10:06.900\nAnd you might have noticed that, like\nwhen I was logged in as root, I restarted\n\n200\n00:10:06.900 --> 00:10:11.370\nthe SSH service and my connection\nwas still up even after restarting.\n\n201\n00:10:11.370 --> 00:10:14.360\nYou can restart the SSH demon and\nyour session stays online.\n\n202\n00:10:14.360 --> 00:10:16.210\nSo you could have a second window open and\n\n203\n00:10:16.210 --> 00:10:19.020\nthat would help with troubleshooting\nthat password I suppose.\n\n204\n00:10:19.020 --> 00:10:23.160\nBut at the end of the day, it's pretty\nstraightforward to get that up and\n\n205\n00:10:23.160 --> 00:10:27.790\ngoing, and now I know that nobody\ncan remotely log in as root, but\n\n206\n00:10:27.790 --> 00:10:30.440\nI can still log in as me.\n\n207\n00:10:30.440 --> 00:10:32.760\n&gt;&gt; Yeah, and thanks again Stanley for\nthat comment.\n\n208\n00:10:32.760 --> 00:10:35.670\nNow, I notice you're using\na password to log in.\n\n209\n00:10:35.670 --> 00:10:39.215\nIs there a more secure\noption other than password?\n\n210\n00:10:39.215 --> 00:10:41.580\n&gt;&gt; Yeah, passwords are a problem, right?\n\n211\n00:10:41.580 --> 00:10:42.650\nI mention brute-forcing.\n\n212\n00:10:42.650 --> 00:10:46.180\nSo if somebody knows I have a root\nuser account on my system, right?\n\n213\n00:10:46.180 --> 00:10:49.480\nEvery Linux and Unix system has\na user system account called root.\n\n214\n00:10:49.480 --> 00:10:52.340\nSo they know if they can\njust guess the password.\n\n215\n00:10:52.340 --> 00:10:54.050\nThen now they have root\naccess on the system.\n\n216\n00:10:54.050 --> 00:10:57.890\nWell, I've already helped them mitigate\na bit by blocking root account on a SSH.\n\n217\n00:10:57.890 --> 00:11:00.210\nBut passwords in general\nare still a problem.\n\n218\n00:11:00.210 --> 00:11:03.630\nSomebody could figure out my password and\nget in.\n\n219\n00:11:03.630 --> 00:11:05.990\nAnd then once they were\nin they could try and\n\n220\n00:11:05.990 --> 00:11:07.960\nbrute force the root user account locally.\n\n221\n00:11:07.960 --> 00:11:10.290\nAnd that would still work\nI haven't stopped that.\n\n222\n00:11:10.290 --> 00:11:14.520\nSo what's better is to say you know what,\nI'm not gonna use passwords at all.\n\n223\n00:11:14.520 --> 00:11:18.650\nInstead of using passwords, we can\nuse certificates to authenticate us.\n\n224\n00:11:18.650 --> 00:11:23.150\nAnd certificates are like really long,\ncomplex passwords if you think about it.\n\n225\n00:11:23.150 --> 00:11:27.070\nIt hashes and\nall of that gets in the background, but\n\n226\n00:11:27.070 --> 00:11:29.630\ncertificates are a much more\nsecure way of doing it,\n\n227\n00:11:29.630 --> 00:11:32.700\nbecause it can't really be\nintercepted on the network.\n\n228\n00:11:32.700 --> 00:11:36.410\nSomebody could still break into your\nmachine and get your private key,\n\n229\n00:11:36.410 --> 00:11:37.330\nI suppose,\n\n230\n00:11:37.330 --> 00:11:39.770\nthat's always a risk but they wouldn't\nbe able to intercept it on the network.\n\n231\n00:11:39.770 --> 00:11:43.990\nSo certificate-based authentication is\nbetter and SSH fully supports that.\n\n232\n00:11:43.990 --> 00:11:46.360\nIn fact, that's one of the main\nreasons that SSH even exists.\n\n233\n00:11:46.360 --> 00:11:49.000\nIs the ability to do that\ntype of authentication.\n\n234\n00:11:49.000 --> 00:11:52.580\nIf you spin up a Linux box\ninside of Amazon web services,\n\n235\n00:11:52.580 --> 00:11:55.330\nthey usually default doing\ncertificate based authentication.\n\n236\n00:11:55.330 --> 00:11:57.120\nSo, this is really the way we want to go.\n\n237\n00:11:57.120 --> 00:12:00.790\nBut, I don't know a single\nLinux distribution\n\n238\n00:12:00.790 --> 00:12:04.050\nthat sets up certificate based\nauthentication by default.\n\n239\n00:12:04.050 --> 00:12:09.250\nAnd the main reason is you need some kind\nof trusting authority to issue the certs,\n\n240\n00:12:09.250 --> 00:12:13.860\nand if they just turn it on by default,\nyou're trusting them and\n\n241\n00:12:13.860 --> 00:12:16.110\nwhoever they pick or\nyou're trusting a local machine.\n\n242\n00:12:16.110 --> 00:12:17.750\nIt's up to you to pick who you trust.\n\n243\n00:12:17.750 --> 00:12:21.370\nSo in my case, if I want to SSH\nsecurely into that system and\n\n244\n00:12:21.370 --> 00:12:23.130\nI want to use a certificate to do it.\n\n245\n00:12:23.130 --> 00:12:27.060\nWell, I can do it right here by\ngenerating my own certificate, and\n\n246\n00:12:27.060 --> 00:12:28.930\nI'll trust it because\nI generated it myself.\n\n247\n00:12:28.930 --> 00:12:31.600\nSo the way we do this is kind\nof counter-intuitive, but\n\n248\n00:12:31.600 --> 00:12:33.600\nI need to start on my client.\n\n249\n00:12:33.600 --> 00:12:36.910\nOn my client,\nI need to generate a key pair.\n\n250\n00:12:36.910 --> 00:12:39.230\nAnd so I'll have a public key and\na private key.\n\n251\n00:12:39.230 --> 00:12:41.450\nAnd I'll keep the private key with me.\n\n252\n00:12:41.450 --> 00:12:44.060\nAnd I'll store the public\nkey on the server.\n\n253\n00:12:44.060 --> 00:12:45.710\nWhen I connect to the server,\n\n254\n00:12:45.710 --> 00:12:49.170\nI'll be able to authenticate because\nI'll have the other key of that pair.\n\n255\n00:12:49.170 --> 00:12:51.505\nThe two will talk to each other and\nnow we've authenticated.\n\n256\n00:12:51.505 --> 00:12:56.000\nSo, if I want to do that,\nwell I'm here on my local machine and\n\n257\n00:12:56.000 --> 00:13:00.900\nI'm going to say, SSH-keygen.\n\n258\n00:13:00.900 --> 00:13:04.090\nAll right, so\nI'm generating some SSH keys.\n\n259\n00:13:04.090 --> 00:13:06.250\nAnd so when I run that it's gonna tell me\nthat I'm gonna generate a key here and\n\n260\n00:13:06.250 --> 00:13:09.498\nit's gonna put it in my home\ndirectory in the .SSH folder.\n\n261\n00:13:10.670 --> 00:13:12.530\nAnd so I'll just accept the default here.\n\n262\n00:13:12.530 --> 00:13:14.090\nIt's asking for a pass phrase.\n\n263\n00:13:14.090 --> 00:13:15.420\nYou could put a pass phrase on this so\n\n264\n00:13:15.420 --> 00:13:18.540\nif somebody steals the file,\nthen anytime they use it or\n\n265\n00:13:18.540 --> 00:13:21.550\ntry to open it they would have to\nprovide this pass phrase to open it.\n\n266\n00:13:21.550 --> 00:13:24.890\nI'm gonna leave it off here but\nproper security practice is to do it.\n\n267\n00:13:24.890 --> 00:13:27.490\nThe reason we're leaving it off is because\nevery time you use that certificate,\n\n268\n00:13:27.490 --> 00:13:29.550\nyou're gonna have to\nfind that pass phrase.\n\n269\n00:13:29.550 --> 00:13:31.585\nSo, it can get a little\nannoying sometimes.\n\n270\n00:13:31.585 --> 00:13:33.630\n[LAUGH] We'll go ahead and move past that.\n\n271\n00:13:33.630 --> 00:13:34.860\nThat's not a good excuse right?\n\n272\n00:13:34.860 --> 00:13:36.700\nYou should assign a password to it.\n\n273\n00:13:36.700 --> 00:13:39.390\nNow once I've done that,\nit's generated my keys.\n\n274\n00:13:39.390 --> 00:13:44.410\nand if I go into the .ssh folder,\nand I take a look.\n\n275\n00:13:44.410 --> 00:13:51.061\nI'll see this id.rsa,\nan id_rsa.pub, right?\n\n276\n00:13:51.061 --> 00:13:56.930\nid_rsa, that's my public key, sorry, my\nprivate key, the one I don't wanna share.\n\n277\n00:13:56.930 --> 00:13:59.295\nThe public key, very obviously,\nhas .pub on the end of it.\n\n278\n00:13:59.295 --> 00:14:01.010\n[LAUGH] So\nI should have picked up on that.\n\n279\n00:14:01.010 --> 00:14:04.600\nBut idea_ISA is my private key and\nthen the one that's .pub,\n\n280\n00:14:04.600 --> 00:14:05.350\nthat's the public key.\n\n281\n00:14:05.350 --> 00:14:09.140\nI'm gonna take that public key and\nI'm gonna put it on the server.\n\n282\n00:14:09.140 --> 00:14:11.430\nNow there's a few different\nways we can do that.\n\n283\n00:14:11.430 --> 00:14:13.110\nOne way is just a text file, right.\n\n284\n00:14:13.110 --> 00:14:18.480\nAll right, so\nI could take a look at what was in there..\n\n285\n00:14:18.480 --> 00:14:23.110\nAnd I need the .pub there.\n\n286\n00:14:23.110 --> 00:14:27.035\nAnd so there's that public key,\nand I could take that data and\n\n287\n00:14:27.035 --> 00:14:30.840\nthen just copy it and\npaste it into a file on the server, right?\n\n288\n00:14:30.840 --> 00:14:33.440\nSo it's not that big of a deal\nto get this moved over.\n\n289\n00:14:33.440 --> 00:14:35.540\nThere is actually a utility\nthat you might have,\n\n290\n00:14:35.540 --> 00:14:39.960\nlet me see if I have it,\nwhich is called ssh-copy-id.\n\n291\n00:14:39.960 --> 00:14:42.880\nAnd what this utility does is it\nallows you to copy the key up to\n\n292\n00:14:42.880 --> 00:14:44.560\na server using SSH.\n\n293\n00:14:44.560 --> 00:14:46.510\nNow that means it builds\nan encrypted tunnel and\n\n294\n00:14:46.510 --> 00:14:47.910\nthen sends it over the network encrypted.\n\n295\n00:14:47.910 --> 00:14:51.650\nIf I just copy and paste this,\nI might do it through a non-secure means.\n\n296\n00:14:51.650 --> 00:14:53.400\nI might send it via email or\nsomething, right.\n\n297\n00:14:53.400 --> 00:14:56.110\nSo the SSH copy ID utility\ncan help us to do that.\n\n298\n00:14:56.110 --> 00:14:57.010\nBut at the end of the day,\n\n299\n00:14:57.010 --> 00:15:01.810\nI need to get this public key stored\nin my home directory on the server.\n\n300\n00:15:01.810 --> 00:15:03.917\nSo I'll use ssh-copy-id, and\n\n301\n00:15:03.917 --> 00:15:08.742\nyou basically just specify the server\nthat you're gonna be connecting to.\n\n302\n00:15:08.742 --> 00:15:16.380\nSo I'm gonna use dpezet@172.16.0.100,\nright, so I'm pointing to that server.\n\n303\n00:15:16.380 --> 00:15:20.330\nAnd it's gonna reach out to the server and\nit's gonna ask me for my password, right?\n\n304\n00:15:20.330 --> 00:15:22.470\nIt's building up an SSH tunnel.\n\n305\n00:15:22.470 --> 00:15:24.060\nAnd once it builds the SSH tunnel,\n\n306\n00:15:24.060 --> 00:15:28.600\nthen it's gonna copy my key\nover to the server, okay?\n\n307\n00:15:28.600 --> 00:15:32.145\nAnd that's important because\nwhen I looked at that key\n\n308\n00:15:32.145 --> 00:15:38.090\nhere, What you saw was this information.\n\n309\n00:15:38.090 --> 00:15:40.370\nAnd then if I jump over to the server.\n\n310\n00:15:42.202 --> 00:15:43.153\nLet's see.\n\n311\n00:15:46.102 --> 00:15:48.340\nLet me try to get these\nclose to the same size.\n\n312\n00:15:48.340 --> 00:15:52.180\nOops, a little bit on the giant side.\n\n313\n00:15:52.180 --> 00:15:56.706\nSo I will log into that server,\nand I'll show you what it did.\n\n314\n00:15:56.706 --> 00:16:00.615\nSo when I login to the server,\nHere I am, and\n\n315\n00:16:00.615 --> 00:16:06.535\nwhen I look in my home directory,\nI can go into that .ssh folder and\n\n316\n00:16:06.535 --> 00:16:11.250\nI see this authorized_keys file,\nall right.\n\n317\n00:16:11.250 --> 00:16:15.815\nAnd if I take a look at that\nauthorized_keys file, it's copied that\n\n318\n00:16:15.815 --> 00:16:20.945\npublic key that I had right over into\nthe system, and there it is, all right.\n\n319\n00:16:20.945 --> 00:16:25.319\nSo now the server knows that I have an\nauthorized key, and if I wanna connect in,\n\n320\n00:16:25.319 --> 00:16:27.180\nI can provide it, right?\n\n321\n00:16:27.180 --> 00:16:29.700\nAnd you might have also\nnoticed something else.\n\n322\n00:16:29.700 --> 00:16:33.210\nWhen I logged in,\ndid you see me type a password?\n\n323\n00:16:33.210 --> 00:16:34.320\nI didn't, right?\n\n324\n00:16:34.320 --> 00:16:35.960\nLet me exit out and show you that again.\n\n325\n00:16:35.960 --> 00:16:40.400\nIf I connect to dpezet@172.16.0.100 and\n\n326\n00:16:40.400 --> 00:16:44.930\nI go to connect, it just let me in,\nno password at all, right?\n\n327\n00:16:44.930 --> 00:16:49.110\nAnd the reason is I have the certificate\nright there on my own machine.\n\n328\n00:16:49.110 --> 00:16:52.550\nAnd when I connected to the server,\nthe server had the certificate as well.\n\n329\n00:16:52.550 --> 00:16:55.975\nI presented the certificate,\nthey presented their hash, everything\n\n330\n00:16:55.975 --> 00:17:00.490\nmatched up, and so I'd knew that I was\nwho I said I was and it allowed me in.\n\n331\n00:17:00.490 --> 00:17:03.410\nI'm now doing certificate\nbased authentication.\n\n332\n00:17:03.410 --> 00:17:06.900\nNow there's a little more that you\ncan tweak with it if you really want.\n\n333\n00:17:06.900 --> 00:17:10.340\nFor example, right now,\nI'm actually allowing password and\n\n334\n00:17:10.340 --> 00:17:12.720\ncertificate based authentication, right?\n\n335\n00:17:12.720 --> 00:17:17.680\nSo if I were to exit out of this and\nlet's say I delete these keys, right?\n\n336\n00:17:17.680 --> 00:17:20.250\nWhich, in real life,\nif you delete the keys,\n\n337\n00:17:20.250 --> 00:17:24.140\nthen you're not going to be\nable to get into those systems.\n\n338\n00:17:24.140 --> 00:17:26.190\nAnd there's not a good way\nto recover them, right?\n\n339\n00:17:26.190 --> 00:17:28.010\nSo you want to have\na backup of these things,\n\n340\n00:17:28.010 --> 00:17:29.140\notherwise you can lock yourself out.\n\n341\n00:17:29.140 --> 00:17:33.550\nBut in my case, if I get rid of those\nkeys, I should be able to SSH back in.\n\n342\n00:17:33.550 --> 00:17:35.620\nAnd this time I don't\nhave a key to present.\n\n343\n00:17:35.620 --> 00:17:39.140\nAnd so it just prompts for the password\nand I can provide the password and\n\n344\n00:17:39.140 --> 00:17:40.220\nstill get in.\n\n345\n00:17:40.220 --> 00:17:43.010\nIf you've set up a certificate based\nauthentication you might wanna turn off\n\n346\n00:17:43.010 --> 00:17:44.400\npassword authentication.\n\n347\n00:17:44.400 --> 00:17:51.470\nAnd you might have noticed that when\nI was in the /etc/ssh/sshd_config\n\n348\n00:17:51.470 --> 00:17:56.050\nfile that buried in this file is\nan entry right here where you can\n\n349\n00:17:56.050 --> 00:18:00.260\ntell it whether you want to allow\npassword authentication or not.\n\n350\n00:18:00.260 --> 00:18:03.575\nSo right here, PasswordAuthentication,\nyes, that's the default.\n\n351\n00:18:03.575 --> 00:18:06.370\nIf I've configured certificate\nbased authentication,\n\n352\n00:18:06.370 --> 00:18:08.450\nI might want to come in here and\nsay no to this.\n\n353\n00:18:08.450 --> 00:18:12.240\nAnd if I say no, right,\nif I just change that to no,\n\n354\n00:18:12.240 --> 00:18:16.160\nnow the only way I can log in is with\ncertificate based authentication.\n\n355\n00:18:16.160 --> 00:18:19.700\nSo it's a much stronger level of\nauthentication, much more hard,\n\n356\n00:18:19.700 --> 00:18:22.090\nit's impossible, no,\nI shouldn't say impossible.\n\n357\n00:18:22.090 --> 00:18:23.870\nIt's very, very difficult to brute force.\n\n358\n00:18:23.870 --> 00:18:27.270\nYou would need quantum computing and\nhundreds of years and all that stuff.\n\n359\n00:18:27.270 --> 00:18:29.270\nSo it's really challenging to do that.\n\n360\n00:18:29.270 --> 00:18:32.020\nAnd so now we get that high level\nsecurity and we require it, so\n\n361\n00:18:32.020 --> 00:18:33.882\nthat's another option you wanna look into.\n\n362\n00:18:33.882 --> 00:18:37.300\n&gt;&gt; Far out, well, it looks like we've\ngot SSH configured pretty tight.\n\n363\n00:18:37.300 --> 00:18:39.310\nIs there anything else we need to look at?\n\n364\n00:18:39.310 --> 00:18:42.987\n&gt;&gt; You know there is one more thing that\nI'll do sometimes, it just kinda depends.\n\n365\n00:18:42.987 --> 00:18:48.000\nThere is a technology or a technique\ncalled security through obscurity, right?\n\n366\n00:18:48.000 --> 00:18:51.130\nWhere sometimes you can secure\nsomething just by hiding it.\n\n367\n00:18:51.130 --> 00:18:55.710\nIf somebody does a port scan across\nthe network, and they look for servers, or\n\n368\n00:18:55.710 --> 00:18:59.270\nanything that responds, they can check\nto see if port 22 is open right?\n\n369\n00:18:59.270 --> 00:19:01.810\nPort 22 is the default port used by SSH.\n\n370\n00:19:01.810 --> 00:19:02.480\nAnd so\n\n371\n00:19:02.480 --> 00:19:06.060\nany time they see port 22 open somewhere\nthey know hey that's an SSH server.\n\n372\n00:19:06.060 --> 00:19:08.570\nLet me try and connect and\nlog in as root right?\n\n373\n00:19:08.570 --> 00:19:12.290\nSo if you've got servers where you're\nconcerned about that, you can try and\n\n374\n00:19:12.290 --> 00:19:14.190\nobscure SSH.\n\n375\n00:19:14.190 --> 00:19:16.590\nNow it doesn't actually secure anything,\nthey can still find it,\n\n376\n00:19:16.590 --> 00:19:19.470\nthey can still connect, but\nit makes it a little harder to detect.\n\n377\n00:19:19.470 --> 00:19:22.630\nAnd you'll see in this same\nconfiguration file way up at the top,\n\n378\n00:19:22.630 --> 00:19:25.040\nI think it's at the very beginning,\nyeah, right here.\n\n379\n00:19:25.040 --> 00:19:28.970\nIt's got the port number that SSH uses,\nthe default's 22.\n\n380\n00:19:28.970 --> 00:19:31.065\nYou could change that to something else.\n\n381\n00:19:31.065 --> 00:19:35.144\nSo for example, maybe I wanna\nchange mine over to port 2222.\n\n382\n00:19:35.144 --> 00:19:36.070\nI'm not very cryptic here, right?\n\n383\n00:19:36.070 --> 00:19:37.230\n&gt;&gt; Two two's, a lot of two two's.\n\n384\n00:19:37.230 --> 00:19:38.630\n&gt;&gt; It's a ballet service.\n\n385\n00:19:38.630 --> 00:19:40.866\nSo I got lots of two's.\n\n386\n00:19:40.866 --> 00:19:44.273\nAnd now, if I restart my SSH\nservice when I connect in,\n\n387\n00:19:44.273 --> 00:19:46.755\nI have to provide a port number as well.\n\n388\n00:19:46.755 --> 00:19:50.186\nAnd if someone does a port scan,\nthey normally scan one through 1,024,\n\n389\n00:19:50.186 --> 00:19:53.830\nthey look for common services, well,\nthis is outside of that range.\n\n390\n00:19:53.830 --> 00:19:57.770\nAnd if they scan this range and\nthey hit 2222, do they know what it is?\n\n391\n00:19:57.770 --> 00:20:00.580\nMaybe if they look at it and go,\nthat's a lot of twos, this must be SSH.\n\n392\n00:20:00.580 --> 00:20:03.968\nBut I could change it to something else,\nlike 33333, right?\n\n393\n00:20:03.968 --> 00:20:06.670\nAnd now they look at that port and\ndon't know what it is.\n\n394\n00:20:06.670 --> 00:20:08.750\nSo they would have to actively try and\n\n395\n00:20:08.750 --> 00:20:12.730\nconnect with the SSH protocol to see if\nthat's what was answering on that port.\n\n396\n00:20:12.730 --> 00:20:15.950\nThey can do it, right,\nit's not true security.\n\n397\n00:20:15.950 --> 00:20:17.570\nBut it makes their job a little harder.\n\n398\n00:20:17.570 --> 00:20:20.420\nAnd most of the automated scans that are\nout there will just move on to the next\n\n399\n00:20:20.420 --> 00:20:23.160\neasier target than trying to focus on\none that's been configured a little\n\n400\n00:20:23.160 --> 00:20:24.120\nmore secure.\n\n401\n00:20:24.120 --> 00:20:27.130\nSo that's another decision that\nyou'll need to make as part of your\n\n402\n00:20:27.130 --> 00:20:28.250\nsecurity policy.\n\n403\n00:20:28.250 --> 00:20:29.960\nDo we wanna change the default port?\n\n404\n00:20:29.960 --> 00:20:33.670\nIf we do, do we wanna change all of\nour servers to use the same port?\n\n405\n00:20:33.670 --> 00:20:38.000\nOr do we want to randomize it where\nevery server has a different SSH port?\n\n406\n00:20:38.000 --> 00:20:40.730\nIt becomes difficult to manage,\neventually, especially for\n\n407\n00:20:40.730 --> 00:20:42.485\nsomething that's not\ngiving you true security.\n\n408\n00:20:42.485 --> 00:20:45.190\nSo plenty of people say, you know what?\n\n409\n00:20:45.190 --> 00:20:46.742\nWe're just going to leave it at 22.\n\n410\n00:20:46.742 --> 00:20:52.160\nAnd if you use Firewall rules to say only\nthese IP addresses can connect on port 22,\n\n411\n00:20:52.160 --> 00:20:57.150\nand then you use the server config to\nsay only these users are allowed to\n\n412\n00:20:57.150 --> 00:21:01.240\nlog in and you use certificate based\nauthentication, by the time you're done,\n\n413\n00:21:01.240 --> 00:21:04.930\nthat's really secure and\nyou didn't have to change the port,\n\n414\n00:21:04.930 --> 00:21:06.890\nwhich makes life a little\neasier on your administrator.\n\n415\n00:21:06.890 --> 00:21:10.830\nSo it's a decision you'll have to make but\nthe ability to change it is right there.\n\n416\n00:21:10.830 --> 00:21:12.110\nIt's not a big deal.\n\n417\n00:21:12.110 --> 00:21:15.680\nOne thing I will remind you though is\nif you change the port number here,\n\n418\n00:21:15.680 --> 00:21:18.660\nyou will need to update your\nfirewall to allow that other port.\n\n419\n00:21:18.660 --> 00:21:24.251\nPort 22 is cleared through the firewall,\nport 2222 or 33333 is not, right?\n\n420\n00:21:24.251 --> 00:21:27.090\nSo whatever port you pick\nyou need to do that, and\n\n421\n00:21:27.090 --> 00:21:31.804\nif you're running SELinux, you may need\nto modify SELinux to allow that port for\n\n422\n00:21:31.804 --> 00:21:36.500\nSSH as well because SSH is cleared for\nport 22, not necessarily other ports.\n\n423\n00:21:36.500 --> 00:21:39.870\nSo there's actually a good bit involved\nwith changing that port number and\n\n424\n00:21:39.870 --> 00:21:41.620\ndoing it securely.\n\n425\n00:21:41.620 --> 00:21:45.250\nBut those are just some of the things\nthat we need to be aware of\n\n426\n00:21:45.250 --> 00:21:48.212\nto make sure that we get\nthings configured securely and\n\n427\n00:21:48.212 --> 00:21:51.170\nconfigured the way we want to\nmatch our security policy.\n\n428\n00:21:51.170 --> 00:21:55.460\n&gt;&gt; Awesome, well, configuring SSH,\nbecoming a Linux server administrator.\n\n429\n00:21:55.460 --> 00:21:57.450\nGreat information as usual, Don.\n\n430\n00:21:57.450 --> 00:21:58.930\nAny last words?\n\n431\n00:21:58.930 --> 00:21:59.840\n&gt;&gt; Not too much here.\n\n432\n00:21:59.840 --> 00:22:01.710\nRemember that SSH is really important,\n\n433\n00:22:01.710 --> 00:22:04.380\nbecause that's how you remotely\nadminister the server.\n\n434\n00:22:04.380 --> 00:22:06.950\nSo if you lock yourself out,\nif you cause problems there,\n\n435\n00:22:06.950 --> 00:22:12.510\nthat can really severely hinder your\nability to work with the server.\n\n436\n00:22:12.510 --> 00:22:15.240\nSo we wanna make sure that\nthe service is kept healthy.\n\n437\n00:22:15.240 --> 00:22:17.340\nBecause the moment any\nother service goes wrong,\n\n438\n00:22:17.340 --> 00:22:19.920\nyou're gonna rely on SSH\nto get in there and fix it.\n\n439\n00:22:19.920 --> 00:22:22.620\nAlso remember there are other\nconfiguration options in there.\n\n440\n00:22:22.620 --> 00:22:28.040\nLike you can support SSH version 1, or\nversion 2, or both version 1 and 2.\n\n441\n00:22:28.040 --> 00:22:29.540\nIf you're doing both,\n\n442\n00:22:29.540 --> 00:22:33.960\nthen the security you create is equal to\nthe weakest level of security you support.\n\n443\n00:22:33.960 --> 00:22:35.610\nSo that means it's pretty weak.\n\n444\n00:22:35.610 --> 00:22:38.330\nYou wanna make sure you're\njust doing SSH version 2 and\n\n445\n00:22:38.330 --> 00:22:42.380\nthat your clients are secure and you're\nkeeping your keys protected as well.\n\n446\n00:22:42.380 --> 00:22:45.000\nWe did have a question in the chat room\nabout whether you can do multiple ports\n\n447\n00:22:45.000 --> 00:22:45.520\nfor SSH.\n\n448\n00:22:46.650 --> 00:22:51.740\nThe easy answer would be no, but\nthe reality is you technically can.\n\n449\n00:22:51.740 --> 00:22:55.060\nYou have to have multiple IPs to do it.\n\n450\n00:22:55.060 --> 00:22:58.350\nAs far as I know,\nyou can only have one port per IP.\n\n451\n00:22:58.350 --> 00:23:00.159\nSo like my server only has one IP address,\nand so\n\n452\n00:23:00.159 --> 00:23:02.130\nit's got a single port that it's using.\n\n453\n00:23:02.130 --> 00:23:03.800\nBut if you have multiple IP addresses,\n\n454\n00:23:03.800 --> 00:23:06.440\nthere are ways to configure that\nwhere you'll have additional ones.\n\n455\n00:23:06.440 --> 00:23:11.560\nI've also seen where people will\ntake SSH and compartmentalize it,\n\n456\n00:23:11.560 --> 00:23:14.490\nright, so they can assign different\nport numbers that way too.\n\n457\n00:23:14.490 --> 00:23:17.250\nYou can use Nginx to proxy it or\nother things.\n\n458\n00:23:17.250 --> 00:23:19.500\nSo there's a few different\nways you can achieve that.\n\n459\n00:23:19.500 --> 00:23:21.540\nThere's not normally\na whole lot of reason for\n\n460\n00:23:21.540 --> 00:23:24.620\nthat to have SSH running\non more than one port.\n\n461\n00:23:24.620 --> 00:23:26.210\nIf you're supporting\nmore than one customer,\n\n462\n00:23:26.210 --> 00:23:27.920\nyou usually manage that\nall through user accounts,\n\n463\n00:23:27.920 --> 00:23:29.560\nnot necessarily the port numbers.\n\n464\n00:23:29.560 --> 00:23:31.510\nBut there are ways to make it happen.\n\n465\n00:23:31.510 --> 00:23:34.970\nBut the official answer would be no\nthere's not really a way to do that, but\n\n466\n00:23:34.970 --> 00:23:36.100\nthere are ways to do it.\n\n467\n00:23:36.100 --> 00:23:40.810\n&gt;&gt; Awesome, well configure SSH and\nbecoming a Linux server administrator.\n\n468\n00:23:40.810 --> 00:23:41.789\nGreat episode, and\n\n469\n00:23:41.789 --> 00:23:45.251\nthere's lots more content in becoming\na Linux server administrator.\n\n470\n00:23:45.251 --> 00:23:48.000\nA lot of videos, make sure you watch\nthem all, you'll be very glad you did.\n\n471\n00:23:48.000 --> 00:23:50.609\nAnd thank you for watching ITProTV.\n\n472\n00:23:50.609 --> 00:23:53.810\nRemember, a good IT pro\nis always learning.\n\n473\n00:23:53.810 --> 00:23:54.760\nI'm Zach Memos.\n\n474\n00:23:54.760 --> 00:23:55.590\n&gt;&gt; And I'm Don Pezet.\n\n475\n00:23:55.590 --> 00:23:58.134\n&gt;&gt; And we'll see you very soon.\n\n476\n00:23:58.134 --> 00:24:04.166\n[MUSIC]\n\n477\n00:24:04.166 --> 00:24:07.199\nThank you for watching ITProTV.\n\n",
          "vimeoId": "226153141"
        },
        {
          "description": "Don and Zach cover basic log messages from boot-up, system log, SYSLOG, system log rotation, additional maintenance of logs, remote system logs, RSYSLOG, making logs permanent, SystemD Jounal, storing logs as secured binary so they can't be altered, how logging differs on various OS, persistent storage, JournalCTL command, JournalD as a replacement for SYSLOG, filtering for priority and filtering for time.",
          "length": "1939",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-4-configuring_system_logging-071817-PGM.00_32_50_05.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-4-configuring_system_logging-071817-PGM.00_32_50_05.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-4-configuring_system_logging-071817-PGM.00_32_50_05.Still001-sm.jpg",
          "title": "Configuring System Logging",
          "transcript": "WEBVTT\n\n1\n00:00:00.270 --> 00:00:06.430\nWelcome to ITPro.TV, I'm your host,\nDon Pezet [CROSSTALK]\n\n2\n00:00:06.430 --> 00:00:08.509\n[MUSIC]\n\n3\n00:00:08.509 --> 00:00:10.248\n&gt;&gt; You're watching ITPro.TV.\n\n4\n00:00:10.248 --> 00:00:14.008\n&gt;&gt; Hello, and thank you for\nchoosing ITPro.TV,\n\n5\n00:00:14.008 --> 00:00:17.360\nhelping you learn wherever you go.\n\n6\n00:00:17.360 --> 00:00:21.680\nI'm your host Zack Memos as we continue on\nwith becoming a Linux Server Administrator\n\n7\n00:00:21.680 --> 00:00:27.240\ngreat series and today we're gonna be\nlooking at configuring system logging.\n\n8\n00:00:27.240 --> 00:00:31.029\nAwesome stuff and Don Pezet is gonna\nbe bringing us all the information we\n\n9\n00:00:31.029 --> 00:00:32.776\nneed because he knows what to do.\n\n10\n00:00:32.776 --> 00:00:35.132\n[LAUGH]\n&gt;&gt; [LAUGH] Well,\n\n11\n00:00:35.132 --> 00:00:37.160\nhopefully I know what to do.\n\n12\n00:00:37.160 --> 00:00:40.180\nI know what to do in large\npart thanks to logging, right.\n\n13\n00:00:40.180 --> 00:00:43.580\nLogging is kind of a critical\nsystem on our servers.\n\n14\n00:00:43.580 --> 00:00:46.440\nIt's critical on workstations too but\non servers even more so.\n\n15\n00:00:46.440 --> 00:00:50.988\nBecause nobody is sitting\nat a server 24 hours a day.\n\n16\n00:00:50.988 --> 00:00:52.530\nI'm sitting in front of\nmy laptop right now.\n\n17\n00:00:52.530 --> 00:00:54.430\nIf I get an error on my laptop,\nI'll see it.\n\n18\n00:00:54.430 --> 00:00:58.008\nBut a server, it's in a rack in another\nroom, maybe even in another country.\n\n19\n00:00:58.008 --> 00:01:00.310\nI'm not going to see the errors\npop up on the screen.\n\n20\n00:01:00.310 --> 00:01:06.120\nSo we rely upon logs every single day\nto be able to find out what's going on.\n\n21\n00:01:06.120 --> 00:01:09.060\nIf a failure occurred what caused it,\nhow do we troubleshoot?\n\n22\n00:01:09.060 --> 00:01:11.980\nHow do we just monitor\nthe health of a server?\n\n23\n00:01:11.980 --> 00:01:14.390\nAll of that is tied to logging.\n\n24\n00:01:14.390 --> 00:01:17.399\nAnd when you start spinning servers\nup in an enterprise environment,\n\n25\n00:01:17.399 --> 00:01:19.746\nthere is some logging that's\nconfigured by default.\n\n26\n00:01:19.746 --> 00:01:23.611\nBut there's a lot of logging that we need\nto get in and configure ourselves, and\n\n27\n00:01:23.611 --> 00:01:27.250\nget set up, and get kind of working\nthe way that we want it to work.\n\n28\n00:01:27.250 --> 00:01:29.660\nIn order to make sure we've got\nthe information when we need it,\n\n29\n00:01:29.660 --> 00:01:34.010\nbecause there's nothing worse then\nall of a sudden having a failure and\n\n30\n00:01:34.010 --> 00:01:36.220\nrealizing you didn't\nhave logging turned on.\n\n31\n00:01:36.220 --> 00:01:39.500\nAnd so you're like, I really could use\nsome logs, I could turn them on now.\n\n32\n00:01:39.500 --> 00:01:41.713\nBut it's not gonna help you,\nbecause now it's after the failure.\n\n33\n00:01:41.713 --> 00:01:45.060\nSo logging is one of those things that\nwe need to get set up before we need it,\n\n34\n00:01:45.060 --> 00:01:46.030\nnot after we need it.\n\n35\n00:01:46.030 --> 00:01:48.877\nAnd that's what we're gonna see\nright here in this episode.\n\n36\n00:01:48.877 --> 00:01:51.490\n&gt;&gt; Well Don, don't we already\nhave logging on the server?\n\n37\n00:01:51.490 --> 00:01:53.880\nIsn't it automatic?\n\n38\n00:01:53.880 --> 00:01:55.168\n&gt;&gt; Well, to an extent, yes.\n\n39\n00:01:55.168 --> 00:02:00.170\nAlmost every Linux distribution\nout there has logging enabled, and\n\n40\n00:02:00.170 --> 00:02:03.510\nhas it configured in a way that's\nsuitable for most people right?\n\n41\n00:02:03.510 --> 00:02:07.480\nAnd I say almost every, and that's because\nthere's a lot of distributions out there\n\n42\n00:02:07.480 --> 00:02:09.430\nthat are specialized, right?\n\n43\n00:02:09.430 --> 00:02:12.560\nLike the live CD distributions where\nthey're expecting you to boot off a CD and\n\n44\n00:02:12.560 --> 00:02:14.620\nrun Linux right from the CD.\n\n45\n00:02:14.620 --> 00:02:18.090\nWell, if you're doing that,\ncan it write logs to the CD?\n\n46\n00:02:18.090 --> 00:02:20.260\nNo, it's a write once media.\n\n47\n00:02:20.260 --> 00:02:23.270\nSo it can write logs to memory, but\nwhen it reboots, all the logs are gone.\n\n48\n00:02:23.270 --> 00:02:25.100\nAnd so, those systems\nare a little bit special, right.\n\n49\n00:02:25.100 --> 00:02:26.420\nWell, we're not gonna\nuse those on a server.\n\n50\n00:02:26.420 --> 00:02:28.590\nWell, not typically, but maybe you will.\n\n51\n00:02:28.590 --> 00:02:31.430\nBut for most of us we're gonna\nhave more traditional servers.\n\n52\n00:02:31.430 --> 00:02:34.860\nAnd on a traditional system\nyou'll find that logging is\n\n53\n00:02:34.860 --> 00:02:35.980\nactually enabled by default.\n\n54\n00:02:35.980 --> 00:02:37.670\nSome that we've already\nused in this series right?\n\n55\n00:02:37.670 --> 00:02:42.155\nFor example when you boot up you\nuse the d message system, right?\n\n56\n00:02:42.155 --> 00:02:46.220\nYou'll see a lot of text scrolling\nacross your screen when you boot up.\n\n57\n00:02:46.220 --> 00:02:51.730\nAnd that log, or it is logged and stored\nand we can view that log using dmsg.\n\n58\n00:02:51.730 --> 00:02:55.270\nSo if I run dmsg I get a huge amount of\ninformation flowing across my screen.\n\n59\n00:02:55.270 --> 00:02:58.463\nThese are all the boot messages\nthat were related to hardware.\n\n60\n00:02:58.463 --> 00:03:01.896\nSo If I'm troubleshooting a server trying\nto figure out why a piece of hardware\n\n61\n00:03:01.896 --> 00:03:04.260\nwasn't detected or something didn't work.\n\n62\n00:03:04.260 --> 00:03:07.572\nI can run right through here, and\nlook and try and find it and see.\n\n63\n00:03:07.572 --> 00:03:11.641\nIt did detect the hardware but\nit didn't initialize the driver or so on.\n\n64\n00:03:11.641 --> 00:03:14.945\nAll of that information is gonna\nspread right there inside dmessage.\n\n65\n00:03:14.945 --> 00:03:18.577\nNow Dmessage is a command\nthat's displaying you a log and\n\n66\n00:03:18.577 --> 00:03:23.190\nwhat we'll find is that most logs\nare tucked away in the same place.\n\n67\n00:03:23.190 --> 00:03:27.020\nYou have a folder which is /var/log.\n\n68\n00:03:27.020 --> 00:03:31.384\nAnd the majority of your systems are gonna\nbe logging to here now I'm logged in as\n\n69\n00:03:31.384 --> 00:03:35.424\na regular user right now and a regular\nuser will have access to some logs and\n\n70\n00:03:35.424 --> 00:03:37.005\nnot access to others right?\n\n71\n00:03:37.005 --> 00:03:40.258\nSo some of these logs are protected\nespecially when we get into things like\n\n72\n00:03:40.258 --> 00:03:42.410\nthe audit logs that SE Linux uses right?\n\n73\n00:03:42.410 --> 00:03:45.890\nSo as you poke around on these logs\nyou may need to elevate privileges.\n\n74\n00:03:45.890 --> 00:03:50.000\nFor d message for those boot logs all\nit's doing is displaying this text file\n\n75\n00:03:50.000 --> 00:03:51.940\nright here d message right?\n\n76\n00:03:51.940 --> 00:03:54.430\nBut notice there's another one,\nD message.old.\n\n77\n00:03:54.430 --> 00:03:58.731\nEvery time you reboot the current\nboot log is put in d message and\n\n78\n00:03:58.731 --> 00:04:02.153\nthe previous boot log is\nput into d message.old.\n\n79\n00:04:02.153 --> 00:04:06.810\nSo maybe I successfully booted last\ntime and I failed to boot this time.\n\n80\n00:04:06.810 --> 00:04:09.390\nI can compare the two and\nsee what's different right, so\n\n81\n00:04:09.390 --> 00:04:10.750\nthat makes things really useful.\n\n82\n00:04:10.750 --> 00:04:12.520\nThey're just text files stored right here.\n\n83\n00:04:12.520 --> 00:04:16.750\nAnd the dmesg command is not\nmuch different than doing\n\n84\n00:04:16.750 --> 00:04:20.510\nsomething like saying less,\nor cat, or more,\n\n85\n00:04:20.510 --> 00:04:25.405\n/var/log/dmesg and going in and\nlooking that data right?\n\n86\n00:04:25.405 --> 00:04:27.881\nSo it's really basically the same thing.\n\n87\n00:04:27.881 --> 00:04:30.100\nAnd you can pull that information and\nsee it.\n\n88\n00:04:30.100 --> 00:04:31.980\nDon't really have to configure much.\n\n89\n00:04:31.980 --> 00:04:33.840\nSystem log is the same way.\n\n90\n00:04:33.840 --> 00:04:38.840\nEvery Unix system that has been deployed\nsince the 1970s is come with syslog.\n\n91\n00:04:38.840 --> 00:04:40.940\nSyslog is just short for system log.\n\n92\n00:04:40.940 --> 00:04:44.060\nAnd so all of the errors and\nother activity informational messages that\n\n93\n00:04:44.060 --> 00:04:49.350\nare being generated by my system are being\ncaught by syslog and written to a file.\n\n94\n00:04:49.350 --> 00:04:55.680\nNow on some distros,\nit's stored as /var/log/syslog.\n\n95\n00:04:55.680 --> 00:05:02.954\nBut in the Red Hat world or CentOS or\nFedora, It's /var/log/messages.\n\n96\n00:05:02.954 --> 00:05:06.010\nThat's where the syslog is\nstoring its information.\n\n97\n00:05:06.010 --> 00:05:09.467\nIf I take a look at that, I'll use less.\n\n98\n00:05:09.467 --> 00:05:16.460\nAnd I'll do /var/log/messages and\nI get permission denied right?\n\n99\n00:05:16.460 --> 00:05:18.330\nThis is a protected one.\n\n100\n00:05:18.330 --> 00:05:20.760\nYou need to be an administrator to use it,\nso\n\n101\n00:05:20.760 --> 00:05:23.850\nI'm gonna use the sudo command\nto get elevated privileges.\n\n102\n00:05:23.850 --> 00:05:27.880\nAnd then that way I'll be able to open\nthat file up, and go in and look.\n\n103\n00:05:27.880 --> 00:05:30.570\nAnd the reason is there might be\ninformation in here that somebody could\n\n104\n00:05:30.570 --> 00:05:32.510\nuse to potentially exploit the system.\n\n105\n00:05:32.510 --> 00:05:34.260\nSo this needs to be protected.\n\n106\n00:05:34.260 --> 00:05:37.040\nBut the main reason it's protected Is that\n\n107\n00:05:37.040 --> 00:05:40.660\nyou don't want regular users to be\nable to potentially modify this right.\n\n108\n00:05:40.660 --> 00:05:42.930\nWhat's a hacker gonna do if\nthey break into your system?\n\n109\n00:05:42.930 --> 00:05:47.150\nA hacker's first job is figuring\nout how to purge the logs.\n\n110\n00:05:47.150 --> 00:05:49.964\nIf they can purge the logs,\nthen they can cover their tracks.\n\n111\n00:05:49.964 --> 00:05:51.021\nAnd then they can do whatever they want.\n\n112\n00:05:51.021 --> 00:05:52.036\nThey don't even have to be careful.\n\n113\n00:05:52.036 --> 00:05:54.611\nThey can do whatever they want and\nuse a hammer.\n\n114\n00:05:54.611 --> 00:05:57.030\nAnd when they're done, they just clear\nthe logs and you don't even know it.\n\n115\n00:05:57.030 --> 00:05:59.780\nBut if they can't clear the logs,\nthey've gotta be really careful,\n\n116\n00:05:59.780 --> 00:06:03.520\nthey've gotta hide all their actions, and\nmake sure they're not able to be caught.\n\n117\n00:06:03.520 --> 00:06:06.900\nSo this is one of their primary targets,\nand that's why it's protected.\n\n118\n00:06:06.900 --> 00:06:08.730\nBut I can come in here,\nand I've got the logs,\n\n119\n00:06:08.730 --> 00:06:10.850\nall the information's right there,\njust ready for\n\n120\n00:06:10.850 --> 00:06:13.780\nme to peruse through and take a look at\nit, and figure out what I need to do.\n\n121\n00:06:13.780 --> 00:06:15.750\nSo it's all right there inside of syslog.\n\n122\n00:06:17.400 --> 00:06:19.085\n&gt;&gt; So these are already running, right?\n\n123\n00:06:19.085 --> 00:06:22.500\nIs there any configuration or\nmaintenance that we need to do?\n\n124\n00:06:22.500 --> 00:06:24.620\n&gt;&gt; Well, if I'm happy with that.\n\n125\n00:06:24.620 --> 00:06:25.878\n&gt;&gt; Yeah.\n&gt;&gt; Then, no.\n\n126\n00:06:25.878 --> 00:06:26.935\nI could stop right there.\n\n127\n00:06:26.935 --> 00:06:27.579\n&gt;&gt; Yay.\n\n128\n00:06:27.579 --> 00:06:29.267\n[LAUGH]\n&gt;&gt; [LAUGH] This could be the shortest\n\n129\n00:06:29.267 --> 00:06:29.809\nepisode ever, right?\n\n130\n00:06:29.809 --> 00:06:30.607\n&gt;&gt; Okay.\n\n131\n00:06:30.607 --> 00:06:34.568\n&gt;&gt; But the reality is, there's things that\nwe are going to want to configure, right?\n\n132\n00:06:34.568 --> 00:06:38.984\nWith sys logs for example, the log\nmessages are gonna grow as more and\n\n133\n00:06:38.984 --> 00:06:42.640\nmore data gets written to the logs,\nthe logs will grow and\n\n134\n00:06:42.640 --> 00:06:45.550\neventually they get too\nbig to handle right.\n\n135\n00:06:45.550 --> 00:06:48.280\nTo open up the file in memory or\nwhatever, it's just too much.\n\n136\n00:06:48.280 --> 00:06:51.080\nThen so we'll typically want to\nset up what's called log rotation.\n\n137\n00:06:51.080 --> 00:06:53.400\nSome systems do this automatically,\nsome don't.\n\n138\n00:06:53.400 --> 00:06:56.770\nSo it's a good idea to double check your\ndistro and make sure that it is using it.\n\n139\n00:06:56.770 --> 00:07:01.930\nLog rotation just says at a set interval,\nI will take the log file and\n\n140\n00:07:01.930 --> 00:07:05.110\nI will split it off into a separate file,\nright.\n\n141\n00:07:05.110 --> 00:07:08.870\nSo, for example I might do\nthis daily where on Tuesday\n\n142\n00:07:08.870 --> 00:07:13.110\nthe system will take all the log messages\nfrom Monday and put them in a Monday file.\n\n143\n00:07:13.110 --> 00:07:16.446\nAnd then on Wednesday, it will take\nall the log messages from Tuesday and\n\n144\n00:07:16.446 --> 00:07:17.710\nput them in a Tuesday file.\n\n145\n00:07:17.710 --> 00:07:18.810\nAnd that way they're separated out.\n\n146\n00:07:18.810 --> 00:07:21.910\nAnd you get smaller files that\nare easier to deal with and\n\n147\n00:07:21.910 --> 00:07:23.410\nyou can purge the other things.\n\n148\n00:07:23.410 --> 00:07:26.380\nIf you don't know if your system is\nusing log rotation, you can look for\n\n149\n00:07:26.380 --> 00:07:27.580\nthe config file.\n\n150\n00:07:27.580 --> 00:07:29.900\nThis one is stored inside of ETC.\n\n151\n00:07:29.900 --> 00:07:35.530\nSo if I go into /etc and\njust take a look in there,\n\n152\n00:07:35.530 --> 00:07:39.210\nthe file that manages the configuration\nis called log rotate.\n\n153\n00:07:39.210 --> 00:07:42.513\nAnd so If I can remember my alphabet and\nfind the L's, there it is.\n\n154\n00:07:42.513 --> 00:07:45.170\n&gt;&gt; [LAUGH]\n&gt;&gt; Log rotate dot com right?\n\n155\n00:07:45.170 --> 00:07:48.127\nSo that's the configuration file for\nlog rotation, and we can go in there and\n\n156\n00:07:48.127 --> 00:07:49.413\ntell it how we want to log rotate.\n\n157\n00:07:49.413 --> 00:07:53.160\nThere's also a folder called log rotate\ndot D, and you can put individual\n\n158\n00:07:53.160 --> 00:07:56.436\nfiles in there to dictate special\ncircumstances for rotating.\n\n159\n00:07:56.436 --> 00:07:59.066\nFor most people,\nthis file right here is the one we want.\n\n160\n00:07:59.066 --> 00:08:00.665\nSo, I'm going to edit that real quick.\n\n161\n00:08:00.665 --> 00:08:06.270\nLet me elevate to do that and so,\nwe're going to pull up that file.\n\n162\n00:08:07.380 --> 00:08:10.170\nYou'll see here where it's setting,\nwhen do we rotate?\n\n163\n00:08:10.170 --> 00:08:11.560\nMine's rotating weekly.\n\n164\n00:08:11.560 --> 00:08:14.730\nI might want to rotate daily to\nmake those log files more, so\n\n165\n00:08:14.730 --> 00:08:16.500\nI can change this from weekly to daily.\n\n166\n00:08:16.500 --> 00:08:20.370\nAnd then, I'm going to keep\nfour weeks worth of backlogs.\n\n167\n00:08:20.370 --> 00:08:23.032\nEach week,\nit'll splinter out the previous week.\n\n168\n00:08:23.032 --> 00:08:28.001\nAnd on the fifth week,\nit'll delete the oldest week to make room,\n\n169\n00:08:28.001 --> 00:08:31.296\nso it's never saving more than four weeks.\n\n170\n00:08:31.296 --> 00:08:34.642\nThat's the way that it's\nrotating right there.\n\n171\n00:08:34.642 --> 00:08:37.682\nNow I could change that behavior, there's\na lot of ways that you can tweak this.\n\n172\n00:08:37.682 --> 00:08:40.265\nAnd you'll see there's a ton\nof options in here for\n\n173\n00:08:40.265 --> 00:08:43.161\nmanipulating what happens,\nthe permissions and so on.\n\n174\n00:08:43.161 --> 00:08:45.927\nBut for most of us these first two options\nare the ones we're gonna care about.\n\n175\n00:08:45.927 --> 00:08:51.864\nSo I might want to set it to daily, and\nthen set it so that the rotate is 31.\n\n176\n00:08:51.864 --> 00:08:55.639\nSo I'm gonna do daily and\nkeep the last 31 days, I can set that up.\n\n177\n00:08:55.639 --> 00:08:58.686\nWe're setting the limit,\nand as things get older,\n\n178\n00:08:58.686 --> 00:09:01.050\nthey get overwritten by the newer data.\n\n179\n00:09:01.050 --> 00:09:03.220\nSo now, I don't have to worry\nabout my hard drive filling up.\n\n180\n00:09:03.220 --> 00:09:05.700\nSo the logs are gonna be a contained size.\n\n181\n00:09:05.700 --> 00:09:09.070\nAnd I also don't have to worry about\nthe files being too big to open,\n\n182\n00:09:09.070 --> 00:09:11.550\nI'll be able to open them and\nmanage them a little easier.\n\n183\n00:09:11.550 --> 00:09:14.556\nOn a negative side, I'm losing old data.\n\n184\n00:09:14.556 --> 00:09:17.050\nHere I'm keeping four weeks worth of logs.\n\n185\n00:09:17.050 --> 00:09:18.880\nLet's say a hacker gets in the system, and\n\n186\n00:09:18.880 --> 00:09:22.150\nit's like an APT,\nan advanced persistent threat.\n\n187\n00:09:22.150 --> 00:09:25.620\nAnd they've been in the system for\nsix months getting at data.\n\n188\n00:09:25.620 --> 00:09:28.400\nAnd so\nthe data forensics guys come to me and\n\n189\n00:09:28.400 --> 00:09:31.780\nsay Don,\nwe need the last six months worth of logs.\n\n190\n00:09:31.780 --> 00:09:36.605\nAnd I say you know I actually just saved\nfour weeks, so here's the four weeks,\n\n191\n00:09:36.605 --> 00:09:38.024\ngood luck and have at it.\n\n192\n00:09:38.024 --> 00:09:40.886\nSo, you need to make sure that whatever\ninterval you set up here matches\n\n193\n00:09:40.886 --> 00:09:42.610\nup with your company's security policy.\n\n194\n00:09:42.610 --> 00:09:44.420\nIf you need to retain logs for\na certain period of time,\n\n195\n00:09:44.420 --> 00:09:46.420\nyou need to mirror that here.\n\n196\n00:09:46.420 --> 00:09:47.832\nLog rotation is an important thing,\n\n197\n00:09:47.832 --> 00:09:49.889\ncuz you don't want your logs\ngrowing out of control.\n\n198\n00:09:49.889 --> 00:09:54.180\nWe've got to find a happy medium,\nbetween being secure and functioning.\n\n199\n00:09:54.180 --> 00:09:56.150\n[LAUGH] And so,\nthat's what log rotation is all about.\n\n200\n00:09:57.620 --> 00:10:00.567\n&gt;&gt; But, what if I don't want to delete\nthe logs and I want to keep them forever,\n\n201\n00:10:00.567 --> 00:10:01.410\nbecause I love them?\n\n202\n00:10:01.410 --> 00:10:04.447\n&gt;&gt; All right well, and\nyou know we say it jokingly, but\n\n203\n00:10:04.447 --> 00:10:06.669\nthere are some people that love that.\n\n204\n00:10:06.669 --> 00:10:10.761\nIn the EU they have certain privacy rules,\nand even here in the US where you have\n\n205\n00:10:10.761 --> 00:10:15.340\nmedical or a lot of hospitals, that are\nrequired to maintain data for ten years.\n\n206\n00:10:15.340 --> 00:10:17.002\n&gt;&gt; Right.\n&gt;&gt; And we might want to go way\n\n207\n00:10:17.002 --> 00:10:20.715\nlonger then four weeks,\nwell you can, I could adjust this.\n\n208\n00:10:20.715 --> 00:10:23.285\nBut the problem here is,\nI might be worried about disk space.\n\n209\n00:10:23.285 --> 00:10:27.150\nThat as those logs grow, logs are pretty\nsmall, but when you fill up walls of text,\n\n210\n00:10:27.150 --> 00:10:28.377\neventually they do grow.\n\n211\n00:10:28.377 --> 00:10:32.964\nAnd on my servers, I might have the\nsmallest amount of storage possible to be\n\n212\n00:10:32.964 --> 00:10:34.872\nable to keep costs down.\n\n213\n00:10:34.872 --> 00:10:38.142\nIn that scenario, we need to make\nsure we can keep logs longer, or\n\n214\n00:10:38.142 --> 00:10:39.702\nwe need another technology.\n\n215\n00:10:39.702 --> 00:10:42.590\nThe other thing is, what if a hacker\nbreaks into this, and flushes the logs?\n\n216\n00:10:42.590 --> 00:10:45.902\nWell, now I've lost them, it doesn't\nmatter how long I was retaining them.\n\n217\n00:10:45.902 --> 00:10:48.418\nIf they're all right there on the server,\nand a hacker breaks into this server,\n\n218\n00:10:48.418 --> 00:10:49.690\nI've lost the logs.\n\n219\n00:10:49.690 --> 00:10:54.450\nSo another solution,\nis to use something called rsyslog,\n\n220\n00:10:54.450 --> 00:11:00.390\nrsyslog is well, just like syslog,\nexcept remote system log.\n\n221\n00:11:00.390 --> 00:11:04.660\nAnd what it says is instead of keeping\nthe logs right here on this server,\n\n222\n00:11:04.660 --> 00:11:08.100\nwe're gonna take them and\nship them to another server somewhere.\n\n223\n00:11:08.100 --> 00:11:11.510\nYou can set up a centralized\nsyslog server, and\n\n224\n00:11:11.510 --> 00:11:13.950\nnow you might have a 1,000\nservers on your network.\n\n225\n00:11:13.950 --> 00:11:17.650\nAnd they're all sending their\nlogs to this one remote location,\n\n226\n00:11:17.650 --> 00:11:19.180\nthere's two benefits to that.\n\n227\n00:11:19.180 --> 00:11:23.080\nBenefit number one,\nis you have one place to look for logs.\n\n228\n00:11:23.080 --> 00:11:26.715\nWhen there's an advanced persistent\nthreat, and they request the logs for\n\n229\n00:11:26.715 --> 00:11:28.774\nsix months, you can go to this one server.\n\n230\n00:11:28.774 --> 00:11:31.309\nYou can pull all the logs for\nsix months, get that data, and\n\n231\n00:11:31.309 --> 00:11:33.915\nhand it over to the forensics guys,\nand now they've got it.\n\n232\n00:11:33.915 --> 00:11:34.945\nYou went one place.\n\n233\n00:11:34.945 --> 00:11:38.228\nThe other thing is,\nif a hacker breaks into a to a server and\n\n234\n00:11:38.228 --> 00:11:42.386\npurges the logs, who cares,\nyou've already got a copy somewhere else.\n\n235\n00:11:42.386 --> 00:11:45.222\nYou've got that copy stored somewhere\nelse, the server loses its logs,\n\n236\n00:11:45.222 --> 00:11:46.622\nyou've already got them.\n\n237\n00:11:46.622 --> 00:11:49.618\nSo, two big protections there,\nrsyslog is really handy for that.\n\n238\n00:11:49.618 --> 00:11:53.236\nAnd so, if we want to configure that, that\none is a little bit harder to configure,\n\n239\n00:11:53.236 --> 00:11:55.221\nbut It's right here inside of this, /etc.\n\n240\n00:11:55.221 --> 00:11:59.148\nYou're going to look for\na file called rsyslog, and\n\n241\n00:11:59.148 --> 00:12:05.280\nwe'll find it right here in the Rs,\nrsyslog.conf, that file right there.\n\n242\n00:12:05.280 --> 00:12:10.251\nSo I'm gonna edit that one, and when\nwe're in that file, you'll see a lot of\n\n243\n00:12:10.251 --> 00:12:15.148\ninformation in here, that pertains to\nlike what ports it's going to use and\n\n244\n00:12:15.148 --> 00:12:18.120\nthe transport protocol and all of that.\n\n245\n00:12:18.120 --> 00:12:20.560\nBut at the end of the day,\nif I really wanna make use of this,\n\n246\n00:12:20.560 --> 00:12:23.240\nthere's just a couple of\nthings that we need to adjust.\n\n247\n00:12:23.240 --> 00:12:27.365\nRight here at the very beginning, there's\nthis provide UDP syslog reception, and\n\n248\n00:12:27.365 --> 00:12:29.790\nprovide TCP syslog reception.\n\n249\n00:12:29.790 --> 00:12:33.310\nI need to pick which\none we're going to use.\n\n250\n00:12:33.310 --> 00:12:37.610\nMost syslog servers use UDP,\nwhich is the user datagram protocol.\n\n251\n00:12:37.610 --> 00:12:41.450\nThe problem with UDP is that\nit's a best effort protocol.\n\n252\n00:12:41.450 --> 00:12:45.890\nSo when you generate a log message, you'll\nthrow it at this rsyslog server, and\n\n253\n00:12:45.890 --> 00:12:48.610\nif it makes it great,\nif it doesn't you skip over it.\n\n254\n00:12:48.610 --> 00:12:52.680\nAnd so with UDP, you might actually\nskip some messages and not realize it,\n\n255\n00:12:52.680 --> 00:12:54.890\nif the network wasn't stable at the time.\n\n256\n00:12:54.890 --> 00:12:57.120\nMost of us have a pretty stable\nnetwork and that's not a problem, but\n\n257\n00:12:57.120 --> 00:13:00.300\nif you're worried about that\nyou'll wanna use TCP instead.\n\n258\n00:13:00.300 --> 00:13:04.560\nIf a frame or a packet doesn't\nmake it to the other side,\n\n259\n00:13:04.560 --> 00:13:07.980\nit can request a retransmit, and\nyou'll retransmit it and get it over.\n\n260\n00:13:07.980 --> 00:13:09.470\nSo you need to make that decision, and\n\n261\n00:13:09.470 --> 00:13:13.070\nall you have to do is un-comment the lines\nhere for which one you want to use.\n\n262\n00:13:13.070 --> 00:13:16.920\nSo if I'm gonna use UDP,\ncuz my network is stable, shoot,\n\n263\n00:13:16.920 --> 00:13:19.620\nI forgot to elevate my privileges\nwhen I edited the file.\n\n264\n00:13:19.620 --> 00:13:21.756\nSo it's telling me it's read only,\nbut that's fine.\n\n265\n00:13:21.756 --> 00:13:25.070\nLet me just get out of this and\ngo back into it so\n\n266\n00:13:25.070 --> 00:13:28.219\nit doesn't get too mad at me, there we go.\n\n267\n00:13:28.219 --> 00:13:31.169\nAnd so I can come in here and I can just\ntake these and if I want to use UPD,\n\n268\n00:13:31.169 --> 00:13:33.970\nI can just get rid of the little\nhash marks before it.\n\n269\n00:13:33.970 --> 00:13:35.950\nAnd then there we go,\nnow I'm configured to use GDP.\n\n270\n00:13:35.950 --> 00:13:39.440\nSo that's one thing that I'm\ngonna need to configure.\n\n271\n00:13:39.440 --> 00:13:41.410\nThen, the other thing I need to do,\n\n272\n00:13:41.410 --> 00:13:45.040\nis I need to tell it where I\nwant to send the messages.\n\n273\n00:13:45.040 --> 00:13:49.110\nAnd as far as sending the messages out,\nyou put a little entry in here that tells\n\n274\n00:13:49.110 --> 00:13:52.350\nit where to go, and if I scroll down\nwe can see if there's messages already.\n\n275\n00:13:52.350 --> 00:13:54.903\nSee how there's things\nin here like mail.*.\n\n276\n00:13:54.903 --> 00:13:59.305\nSo any log that's generated that\npertains to the mail service,\n\n277\n00:13:59.305 --> 00:14:04.710\nis being sent to /vars/log.maillog,\nso that's where that is being sent.\n\n278\n00:14:04.710 --> 00:14:08.830\nSo as I continue to look down, these\nare all my different log messages and\n\n279\n00:14:08.830 --> 00:14:11.130\ndifferent places to forward them to.\n\n280\n00:14:11.130 --> 00:14:17.030\nAnd down here at the very end, I can add\nan entry to forward to a remote host,\n\n281\n00:14:17.030 --> 00:14:22.910\nand see how they're showing in the example\nthere, *.* ,that means every log.\n\n282\n00:14:22.910 --> 00:14:25.613\nYou can pick and choose, maybe I\njust want logs from the web server.\n\n283\n00:14:25.613 --> 00:14:28.553\nYou can do that, or just some certain\nseverity levels, you can do that.\n\n284\n00:14:28.553 --> 00:14:32.808\nBut what I want is to get everything, I\nwanna take every log message generated on\n\n285\n00:14:32.808 --> 00:14:35.950\nthis server, and\nI'm gonna send it to a remote host.\n\n286\n00:14:35.950 --> 00:14:41.000\nAnd so, you just do a double add sign\nfollowed by the IP address of that server.\n\n287\n00:14:41.000 --> 00:14:46.574\nSo maybe I've got a server at 172.16.0.99,\nthat's where I'm going to send it to.\n\n288\n00:14:46.574 --> 00:14:50.066\nAnd then I need to tell it the port\nnumber, 541 is the default port number,\n\n289\n00:14:50.066 --> 00:14:53.480\nyou still have to type it in though,\neven if you're using the default.\n\n290\n00:14:53.480 --> 00:14:56.100\nIf I change the port number up above,\nI can specify it here.\n\n291\n00:14:56.100 --> 00:15:00.620\nBut now, every time a log message\nis generated here on this server,\n\n292\n00:15:00.620 --> 00:15:03.110\nit's gonna send a copy of it to this IP.\n\n293\n00:15:04.110 --> 00:15:08.260\nAnd I would go to that server,\nyou know whoever is gonna be hosting this.\n\n294\n00:15:08.260 --> 00:15:09.860\nAnd on them we would need to configure,\n\n295\n00:15:09.860 --> 00:15:11.595\nfor them to be able to\nreceive these messages.\n\n296\n00:15:11.595 --> 00:15:13.390\nSo now, we've got it centrally aggregated.\n\n297\n00:15:13.390 --> 00:15:15.850\nSo if you're managing a large server farm,\n\n298\n00:15:15.850 --> 00:15:18.370\nyou should already have\na centralized sys log server.\n\n299\n00:15:18.370 --> 00:15:21.557\nWe're just forwarding to it, and\nthat's really what rsys log is all about,\n\n300\n00:15:21.557 --> 00:15:23.434\ngetting that information moved right over.\n\n301\n00:15:23.434 --> 00:15:27.784\nAnd all I have to do is restart the log\nservice and that'll take effect.\n\n302\n00:15:27.784 --> 00:15:31.250\nSo if I get out of this file and\n\n303\n00:15:31.250 --> 00:15:37.031\nthen just do a quick\nsystemctl enable rsyslog,\n\n304\n00:15:37.031 --> 00:15:40.580\nand then start rsyslog.\n\n305\n00:15:40.580 --> 00:15:44.329\nOkay now I said restart,\nwhich I shouldn't have said that,\n\n306\n00:15:44.329 --> 00:15:48.830\nbecause you're running syslog already and\nsyslog is logging locally.\n\n307\n00:15:48.830 --> 00:15:52.848\nI was turning on rsyslog which I wasn't\nrunning yet, so I just needed to start it.\n\n308\n00:15:52.848 --> 00:15:55.924\nIf I was already running syslog, then yes,\nI would have needed to restart it.\n\n309\n00:15:55.924 --> 00:15:56.951\nIt's the same basic command.\n\n310\n00:15:56.951 --> 00:16:01.707\nJust sudo systemctl restart rsyslog,\nand that'll restart it.\n\n311\n00:16:01.707 --> 00:16:06.267\nBut do note that syslog and\nrsyslog are two different services,\n\n312\n00:16:06.267 --> 00:16:10.500\nright, you can run just\nsyslog without rsyslog.\n\n313\n00:16:10.500 --> 00:16:13.834\nBut you actually can't\nrsyslog without just syslog.\n\n314\n00:16:13.834 --> 00:16:15.500\nBecause syslog is just\ndoing the local logging,\n\n315\n00:16:15.500 --> 00:16:18.260\nand if you don't have local logging, then\nrsyslog doesn't have anything to send.\n\n316\n00:16:18.260 --> 00:16:21.040\nSo you usually use the two together,\nand that's exactly what I'm doing here.\n\n317\n00:16:21.040 --> 00:16:25.870\nSyslog was already turned on by default,\nI've added rsyslog onto it, and\n\n318\n00:16:25.870 --> 00:16:27.548\nnow I've got a great solution.\n\n319\n00:16:27.548 --> 00:16:30.967\nBecause [COUGH] even if I'm\nrotating my logs to just four days,\n\n320\n00:16:30.967 --> 00:16:34.280\nI'm keeping only four\ndays with the logs here.\n\n321\n00:16:34.280 --> 00:16:35.310\nWhen I use rsyslog, and\n\n322\n00:16:35.310 --> 00:16:39.140\nI send it to another server, my log rotate\ndoesn't apply to that other server.\n\n323\n00:16:39.140 --> 00:16:40.670\nIt can hold them as long as they want.\n\n324\n00:16:40.670 --> 00:16:43.114\nSo going back to Zach's question,\nwe can hold them forever,\n\n325\n00:16:43.114 --> 00:16:45.093\nit really just comes down\nthe storage over there.\n\n326\n00:16:45.093 --> 00:16:48.207\nBut that's basically rsyslog,\nand once we get that in place,\n\n327\n00:16:48.207 --> 00:16:50.281\nnow syslog is working the way that I want.\n\n328\n00:16:50.281 --> 00:16:53.154\nAnd I've got my local logging kind of\nconfigured the way that I need it.\n\n329\n00:16:53.154 --> 00:16:54.428\n&gt;&gt; But wait, there's more questions.\n\n330\n00:16:54.428 --> 00:16:57.504\n&gt;&gt; [LAUGH]\n&gt;&gt; No, all the logs we've talked about,\n\n331\n00:16:57.504 --> 00:17:00.971\nall the different types we've already\ntalked about, are they standard for\n\n332\n00:17:00.971 --> 00:17:02.440\nevery system?\n\n333\n00:17:02.440 --> 00:17:03.517\n&gt;&gt; For the most part, yes.\n\n334\n00:17:03.517 --> 00:17:06.590\nRight, syslog has been around a long,\nlong time, right?\n\n335\n00:17:06.590 --> 00:17:10.180\nIt was developed in the late 1970s,\nthe early versions of Unix.\n\n336\n00:17:10.180 --> 00:17:13.900\nThis is what they use for logging, and\nit stuck around over 30 years, right?\n\n337\n00:17:13.900 --> 00:17:18.040\nAnd it serves its job,\nalmost 40 years, to do what it does,\n\n338\n00:17:18.040 --> 00:17:19.760\nit does a great job at it, right?\n\n339\n00:17:19.760 --> 00:17:22.916\nBut there are some limitations,\nwhich we've largely been talking about,\n\n340\n00:17:22.916 --> 00:17:24.206\nlike the ability to export it.\n\n341\n00:17:24.206 --> 00:17:26.762\nAnd the fact that the logs\nare all stored as a text file, so\n\n342\n00:17:26.762 --> 00:17:30.240\nthey're susceptible to being modified,\nthat kind of stuff.\n\n343\n00:17:30.240 --> 00:17:32.470\nSyslog has its weak points, but by and\n\n344\n00:17:32.470 --> 00:17:37.630\nlarge, every Linux distribution\nthat I've ever touched has syslog.\n\n345\n00:17:37.630 --> 00:17:39.540\nIt might be modified, for example,\n\n346\n00:17:39.540 --> 00:17:41.990\nwhere it just writes to memory\ninstead of writing to disk.\n\n347\n00:17:41.990 --> 00:17:44.800\nBut, at the end of the day,\nthey've all got syslog.\n\n348\n00:17:44.800 --> 00:17:46.986\nAnd so I can say that right now, right?\n\n349\n00:17:46.986 --> 00:17:51.200\nSo if you're watching this right now: yes,\nyou can count on syslog being there.\n\n350\n00:17:51.200 --> 00:17:54.260\nBut it's not gonna be like that for\nmuch longer, right?\n\n351\n00:17:54.260 --> 00:17:57.014\nIn fact, the replacement for\nsyslog is already out there and\n\n352\n00:17:57.014 --> 00:17:58.639\nalready deployed on most systems.\n\n353\n00:17:58.639 --> 00:18:03.256\nSo on most systems you're actually\nrunning two different logging systems,\n\n354\n00:18:03.256 --> 00:18:06.400\nsyslog, and\na new one called journald, right?\n\n355\n00:18:06.400 --> 00:18:09.880\nJournald, or the journaling daemon,\nis part of systemd.\n\n356\n00:18:09.880 --> 00:18:13.628\nIt is the native logging system that's\npart of systemd, and it's impressive,\n\n357\n00:18:13.628 --> 00:18:14.572\nit's really good.\n\n358\n00:18:14.572 --> 00:18:17.576\nJournald fixes a lot of\nthe problems with syslog,\n\n359\n00:18:17.576 --> 00:18:22.180\nthings like instead of using a text file,\nit uses binary files, right?\n\n360\n00:18:22.180 --> 00:18:24.848\nBinary files that can't be modified,\nso now if an attacker gets in,\n\n361\n00:18:24.848 --> 00:18:28.180\nthey can destroy the log, but they can't\nmodify it, they can't change it, right?\n\n362\n00:18:28.180 --> 00:18:31.580\nSo it's much more protected, and\nit gives you much better information.\n\n363\n00:18:31.580 --> 00:18:34.690\nYou get a lot more detailed data inside\nof it than you do out of syslog,\n\n364\n00:18:34.690 --> 00:18:37.060\nso journald is really good.\n\n365\n00:18:37.060 --> 00:18:39.860\nBut that's a pretty big change,\nto have this\n\n366\n00:18:39.860 --> 00:18:42.880\ncore logging system that's been around for\nforever and all of a sudden change it.\n\n367\n00:18:42.880 --> 00:18:46.650\nSo most distros have been\npretty slow to accept that.\n\n368\n00:18:46.650 --> 00:18:51.310\nUbuntu, Red Hat, Fedora,\nthey all run journald, right now.\n\n369\n00:18:51.310 --> 00:18:55.490\nAnd it should already be installed,\nand turned on by default, right?\n\n370\n00:18:55.490 --> 00:18:58.840\nBut, it's not the primary logging system,\n\n371\n00:18:58.840 --> 00:19:01.130\nsyslog is still the primary\nlogging system.\n\n372\n00:19:01.130 --> 00:19:02.580\nOn my computer, and\n\n373\n00:19:02.580 --> 00:19:06.342\non this server that we've spun up here\nin this show, it is using syslog.\n\n374\n00:19:06.342 --> 00:19:08.230\nBut journald is there, right?\n\n375\n00:19:08.230 --> 00:19:12.300\nLet me show you, so\nI was showing you /var/log,\n\n376\n00:19:12.300 --> 00:19:16.730\nand inside of there,\nthis messages folder, okay?\n\n377\n00:19:16.730 --> 00:19:21.012\nSo that's the folder where, or sorry,\nfile [LAUGH] where syslog is writing to.\n\n378\n00:19:21.012 --> 00:19:27.580\nJournald is turned on, is gathering logs,\nbut it's only writing them to memory.\n\n379\n00:19:27.580 --> 00:19:31.460\nOkay, so I don't see a journald\nfolder in here or a file,\n\n380\n00:19:31.460 --> 00:19:33.580\nit will actually be a folder\nif it gets created.\n\n381\n00:19:33.580 --> 00:19:37.050\nBut I don't see that, and\nthat's because journald is running, but\n\n382\n00:19:37.050 --> 00:19:40.120\nits not persistent,\nit's just logging to memory.\n\n383\n00:19:40.120 --> 00:19:43.140\nSo every time you reboot what\nhappens to your journald logs?\n\n384\n00:19:43.140 --> 00:19:44.330\nThey go away right?\n\n385\n00:19:44.330 --> 00:19:48.463\nBut they are there, and\nyou can see them with journalctl, okay?\n\n386\n00:19:48.463 --> 00:19:52.770\nLet me sudo that,\njournalctl will bring up that log.\n\n387\n00:19:52.770 --> 00:19:57.070\nAnd I can just run it, and\nyou can scroll through and see it.\n\n388\n00:19:57.070 --> 00:20:00.790\nAnd for the most part,\nit looks just like the syslog data.\n\n389\n00:20:00.790 --> 00:20:04.150\nExcept for all these extra stuff\nhere at the beginning, right?\n\n390\n00:20:04.150 --> 00:20:06.220\nInstead of the little timestamp\nthat we normally see here,\n\n391\n00:20:06.220 --> 00:20:09.230\nI'm seeing a longer more\ndetailed timestamp.\n\n392\n00:20:09.230 --> 00:20:13.590\nAnd the localhost and domain name\nof that system, or host name and\n\n393\n00:20:13.590 --> 00:20:14.950\ndomain name of the system.\n\n394\n00:20:14.950 --> 00:20:18.160\nThat when syslog was originally written,\nrsyslog didn't exist,\n\n395\n00:20:18.160 --> 00:20:19.477\ndo they didn't nest this data in here.\n\n396\n00:20:19.477 --> 00:20:23.310\nBut with journald, they know that we\ncan be shipping logs different places.\n\n397\n00:20:23.310 --> 00:20:26.600\nSo they nest in the name of the system\nthat generated the log message\n\n398\n00:20:26.600 --> 00:20:28.680\nto help you with filtering\nthat identification.\n\n399\n00:20:28.680 --> 00:20:32.365\nBut otherwise, everything that's\nbeing sent to syslog is being\n\n400\n00:20:32.365 --> 00:20:35.205\nsent to journald as well,\nso I'm getting duplicates.\n\n401\n00:20:35.205 --> 00:20:39.905\nBut then journald has additional\ndata that syslog doesn't.\n\n402\n00:20:39.905 --> 00:20:43.245\nSo more detailed information about some\nof the modern services that are hooked\n\n403\n00:20:43.245 --> 00:20:44.875\ninto systemd.\n\n404\n00:20:44.875 --> 00:20:49.775\nNow every developer out there right\nnow is still supporting syslog.\n\n405\n00:20:49.775 --> 00:20:53.891\nOver time though, you're gonna start\nseeing services where they say nope,\n\n406\n00:20:53.891 --> 00:20:55.995\nall our log messages go to systemd now.\n\n407\n00:20:55.995 --> 00:20:58.650\nThey go to journald, and not to syslog.\n\n408\n00:20:58.650 --> 00:21:01.560\nAnd what's more than likely gonna happen\nis the systems are just cut right\n\n409\n00:21:01.560 --> 00:21:02.100\nover at that point.\n\n410\n00:21:02.100 --> 00:21:04.562\nAnd say we're just gonna eliminate\nsyslog and get it out of there.\n\n411\n00:21:04.562 --> 00:21:06.790\nBut, it'll be a slow process,\nit'll take a couple of years, but\n\n412\n00:21:06.790 --> 00:21:08.214\nthat's what's gonna happen.\n\n413\n00:21:08.214 --> 00:21:12.210\nNow, journalctl,\nbecause its data is in a binary format,\n\n414\n00:21:12.210 --> 00:21:15.460\nI can't just cat its files or\nuse less or whatever.\n\n415\n00:21:15.460 --> 00:21:18.660\nI've gotta do things through\nthe journalctl command, and\n\n416\n00:21:18.660 --> 00:21:21.710\nthat's what's making sure I have\npermissions to access the logs,\n\n417\n00:21:21.710 --> 00:21:23.380\nthat I'm allowed to get in there and\ndo it.\n\n418\n00:21:23.380 --> 00:21:25.790\nThere's a group created by\ndefault in Red Hat called adm,\n\n419\n00:21:25.790 --> 00:21:29.010\nand if you're in the adm group you\nhave permission to use journalctl.\n\n420\n00:21:29.010 --> 00:21:31.460\nOtherwise I wouldn't be\nable to run that command.\n\n421\n00:21:31.460 --> 00:21:36.540\nYou can do things like journalctl -f,\nwhich follows the file, and\n\n422\n00:21:36.540 --> 00:21:40.440\nnow it's showing me the ten most\nrecent lines, and it's following it.\n\n423\n00:21:40.440 --> 00:21:43.400\nSo as I start to do things,\nthat I adjust the system or\n\n424\n00:21:43.400 --> 00:21:46.230\nwhatever, it'll update here on the screen.\n\n425\n00:21:46.230 --> 00:21:50.910\nSo for example, if I were to fire\nopen another terminal and try and\n\n426\n00:21:50.910 --> 00:21:55.880\nssh into the system, maybe I try and log\nin as root, right, which is not allowed.\n\n427\n00:21:55.880 --> 00:21:57.210\nAnd so I come in and I try and\n\n428\n00:21:57.210 --> 00:22:00.386\nlogin, and I fail,\nin the background see how it, whoops.\n\n429\n00:22:00.386 --> 00:22:05.280\n[LAUGH] See how it just updated to\nreflect that I'm not allowed to log in,\n\n430\n00:22:05.280 --> 00:22:08.390\ncuz the root user is blocked via ssh,\nright?\n\n431\n00:22:08.390 --> 00:22:09.270\nSo I see that and\n\n432\n00:22:09.270 --> 00:22:12.210\nI can watch it, just like I could\nwatch a regular log file, right?\n\n433\n00:22:12.210 --> 00:22:16.218\nI might do something like,\ntail /var/log/messages,\n\n434\n00:22:16.218 --> 00:22:18.109\nactually let me sudo that.\n\n435\n00:22:18.109 --> 00:22:21.000\nAnd so\nnow I'm watching the end of that file.\n\n436\n00:22:21.000 --> 00:22:24.260\nOops, sorry, I need tail -f to follow,\nthere we go.\n\n437\n00:22:24.260 --> 00:22:26.380\nAnd now I'm watching the end of it, right?\n\n438\n00:22:26.380 --> 00:22:30.210\nBut notice, I didn't get any messages\nhere about that failed login attempt.\n\n439\n00:22:30.210 --> 00:22:34.340\nRight, journald did, syslog didn't, right?\n\n440\n00:22:34.340 --> 00:22:37.990\nSyslog is gathering data like it always\nhas, but it's just not as detailed\n\n441\n00:22:37.990 --> 00:22:41.070\nof information, so\njournald is definitely the better choice.\n\n442\n00:22:41.070 --> 00:22:43.320\nThe main problem you're gonna\nbump into with journald though,\n\n443\n00:22:43.320 --> 00:22:46.460\nis that it's not persistent,\nthat if I reboot, I lose all the logs.\n\n444\n00:22:46.460 --> 00:22:49.050\nThe logs inside of journald\nonly go back to boot time.\n\n445\n00:22:49.050 --> 00:22:53.700\nIf you wanna make the logs persistent,\nyou're gonna need to configure that right?\n\n446\n00:22:53.700 --> 00:22:59.510\nAnd I'm not sure of all the politics\nbehind it, but basically each distro,\n\n447\n00:22:59.510 --> 00:23:02.520\nDebian, Red Hat, they've all kind\nof reached the same conclusion,\n\n448\n00:23:02.520 --> 00:23:05.090\nthat they don't want people\nto have two sets of logs.\n\n449\n00:23:05.090 --> 00:23:08.130\nAnd so if they have to pick one set,\nthey're picking syslog right now.\n\n450\n00:23:08.130 --> 00:23:10.480\nAnd so that's why persistence\nis turned off by default.\n\n451\n00:23:10.480 --> 00:23:12.730\nIt's super easy to turn it on though, but\n\n452\n00:23:12.730 --> 00:23:15.030\ndo be aware that you'll be\nmanaging two sets of logs.\n\n453\n00:23:15.030 --> 00:23:17.810\nNow I like to act under\nthe assumption that people are smart,\n\n454\n00:23:17.810 --> 00:23:19.100\nnot that people are dumb.\n\n455\n00:23:19.100 --> 00:23:22.090\nAnd so if you've got two sets of logs,\nwhat does that mean?\n\n456\n00:23:22.090 --> 00:23:25.635\nI need to watch my storage and maintain\nand do log rotation and purge out logs and\n\n457\n00:23:25.635 --> 00:23:28.876\nthings so I don't run a hard drive\nspace as we generate those messages.\n\n458\n00:23:28.876 --> 00:23:33.150\nSo I'm gonna turn on persistence here,\nand it's actually really easy to do.\n\n459\n00:23:33.150 --> 00:23:35.940\nWe need to edit the configuration file for\njournald, and\n\n460\n00:23:35.940 --> 00:23:41.385\nit is inside of\n/etc/systemd/journald.conf, right?\n\n461\n00:23:42.475 --> 00:23:44.354\nThat's the configuration file for\njournald.\n\n462\n00:23:44.354 --> 00:23:48.366\nAnd if you crack that open and look in\nhere, notice this little entry right here,\n\n463\n00:23:48.366 --> 00:23:51.325\nit's commented out, but\nit says Storage=auto, right?\n\n464\n00:23:51.325 --> 00:23:54.198\nThat means that it's going to\nautomatically figure out what\n\n465\n00:23:54.198 --> 00:23:54.991\nstorage to use.\n\n466\n00:23:54.991 --> 00:23:58.876\nNow, if I leave it that way, which is\nthe default, it's just gonna use memory,\n\n467\n00:23:58.876 --> 00:24:00.608\nit's not gonna use storage at all.\n\n468\n00:24:00.608 --> 00:24:04.276\nUnless, it finds a journal folder, right?\n\n469\n00:24:04.276 --> 00:24:07.106\nIf there was a folder in /var/log/journal,\n\n470\n00:24:07.106 --> 00:24:11.576\nif that folder existed then it would\nuse it and it would become persistent.\n\n471\n00:24:11.576 --> 00:24:17.245\nSo you'll find a lot of instructions out\nthere on the Internet, where people say,\n\n472\n00:24:17.245 --> 00:24:22.307\nyeah, if you wanna be persistent\njust do a sudu mkdir/va/log/journal.\n\n473\n00:24:22.307 --> 00:24:25.306\nAnd then when you restart the journal\nD service, it'll start logging.\n\n474\n00:24:25.306 --> 00:24:29.150\nAnd that's true, that does work except\nyou have the potential of messing\n\n475\n00:24:29.150 --> 00:24:30.520\nup permissions, right?\n\n476\n00:24:30.520 --> 00:24:32.241\nThe permissions on that\nfolder can be set wrong.\n\n477\n00:24:32.241 --> 00:24:36.784\nSo what I recommend is not doing it\nthat way but instead coming in here and\n\n478\n00:24:36.784 --> 00:24:41.876\nin this configuration file you can just\nsay storage=persistent, all right?\n\n479\n00:24:41.876 --> 00:24:47.170\nSo I'm tell it I want it to\nsave the logs to disk, okay?\n\n480\n00:24:47.170 --> 00:24:51.952\nNow, by telling it that, it knows I want\nto save to disk and if I look inside\n\n481\n00:24:51.952 --> 00:24:56.830\nof /bar/log, I do not have a journal\nfolder, I haven't made it, okay?\n\n482\n00:24:56.830 --> 00:25:02.611\nBut, if I do a systemctl, restart,\n\n483\n00:25:02.611 --> 00:25:07.279\nsystemd-jounald, right?\n\n484\n00:25:07.279 --> 00:25:09.229\nI can restart that service.\n\n485\n00:25:09.229 --> 00:25:12.462\nAnd I'm sudo-ing this, I'm actually in\na root session right now anyways, so\n\n486\n00:25:12.462 --> 00:25:13.415\nit wouldn't matter.\n\n487\n00:25:13.415 --> 00:25:15.239\nBut there we go, so I'm gonna restart it.\n\n488\n00:25:15.239 --> 00:25:17.187\nWhen I restart it,\nit's gonna see the configuration file and\n\n489\n00:25:17.187 --> 00:25:18.961\nit's gonna say,\nI'm supposed to be persistent.\n\n490\n00:25:18.961 --> 00:25:20.921\nAnd it's gonna see the folder as missing,\nand\n\n491\n00:25:20.921 --> 00:25:22.638\nit's gonna put the folder there for me.\n\n492\n00:25:22.638 --> 00:25:25.770\nAnd it'll have the right permissions and\nit'll be configured the right way.\n\n493\n00:25:25.770 --> 00:25:27.218\nSo this is the easiest\nway to avoid mistakes.\n\n494\n00:25:27.218 --> 00:25:28.761\nThis is the way I recommend you do it.\n\n495\n00:25:28.761 --> 00:25:33.120\nAnd by doing that,\nnow I've got a folder called journal.\n\n496\n00:25:33.120 --> 00:25:34.816\nAnd that's where the data's being written.\n\n497\n00:25:34.816 --> 00:25:37.555\nAnd if I reboot,\nI don't lose all my journald anymore,\n\n498\n00:25:37.555 --> 00:25:38.968\nnow it's being preserved.\n\n499\n00:25:38.968 --> 00:25:41.588\nIf I go into that folder,\nwhich is why I'm logged in as root.\n\n500\n00:25:41.588 --> 00:25:43.619\nNormally I wouldn't even be\nable to go into this folder.\n\n501\n00:25:43.619 --> 00:25:46.907\nBut if I go in there I\ncan see a binary file.\n\n502\n00:25:46.907 --> 00:25:51.217\nAnd if I try and look at that file, right?\n\n503\n00:25:51.217 --> 00:25:54.392\nIt's gonna tell me oops,\nsorry, that it is a directory,\n\n504\n00:25:54.392 --> 00:25:56.529\nthat's what it's gonna tell me first.\n\n505\n00:25:56.529 --> 00:25:58.756\nAnd then when I get in there,\nthere's the file.\n\n506\n00:25:58.756 --> 00:26:03.026\nAnd if I try and\npull that it's a binary file.\n\n507\n00:26:03.026 --> 00:26:05.031\nSo I just see junk, right?\n\n508\n00:26:05.031 --> 00:26:09.540\nI can't actually read that file but\nthere is, system.journal.\n\n509\n00:26:09.540 --> 00:26:12.595\nThat's it, log in to the disk,\nand put in that data in there and\n\n510\n00:26:12.595 --> 00:26:14.048\nstoring in a secured format.\n\n511\n00:26:14.048 --> 00:26:16.751\nIt's actually a binary\nthat's encrypted as well.\n\n512\n00:26:16.751 --> 00:26:19.830\nSo I can't mess with it, right?\n\n513\n00:26:19.830 --> 00:26:23.564\nSo we're safe, the data is stored there,\nI can go in and\n\n514\n00:26:23.564 --> 00:26:27.065\npull data out of journal ctl\ntill the cows come home.\n\n515\n00:26:27.065 --> 00:26:27.876\n&gt;&gt; [LAUGH]\n&gt;&gt; And\n\n516\n00:26:27.876 --> 00:26:29.157\nI can troubleshoot find my information.\n\n517\n00:26:29.157 --> 00:26:32.850\nSo if you wanna start using journal\nctl today, it's a good idea.\n\n518\n00:26:32.850 --> 00:26:35.986\nYou know journald and\njournal ctl just make it persistent and\n\n519\n00:26:35.986 --> 00:26:38.087\nthat could be your go to logging source.\n\n520\n00:26:38.087 --> 00:26:44.500\nAnd then in time sys log will go away,\nbut not every system has journald.\n\n521\n00:26:44.500 --> 00:26:47.879\nThere are still some systems that\nare clinging on to the old sys v inits or\n\n522\n00:26:47.879 --> 00:26:50.482\nupstart inits and\nthose are gonna be issuing sys logs.\n\n523\n00:26:50.482 --> 00:26:53.917\nSo if you learn sys log,\nyou'll have that everywhere, right?\n\n524\n00:26:53.917 --> 00:26:58.878\nIf you learn journald, you'll have it most\nplaces and you're prepared for tomorrow.\n\n525\n00:26:58.878 --> 00:27:00.845\nThe best solution is\nreally to learn both and\n\n526\n00:27:00.845 --> 00:27:03.779\nmake sure you've got them configured and\nset up the way you want.\n\n527\n00:27:03.779 --> 00:27:05.337\nThat persistence is really important.\n\n528\n00:27:05.337 --> 00:27:08.444\nIf you forget to configure it and\nthen you have a problem,\n\n529\n00:27:08.444 --> 00:27:10.988\nyou can't look back\nbeyond your last reboot.\n\n530\n00:27:10.988 --> 00:27:13.063\nAnd it's too late at that point,\nthose logs are gone.\n\n531\n00:27:13.063 --> 00:27:16.282\nWe need to make sure we turn\nthis on ahead of time so\n\n532\n00:27:16.282 --> 00:27:19.828\nwe've got those log messages there and\nready for us.\n\n533\n00:27:19.828 --> 00:27:21.242\nAll right, let me just, before we wrap up,\n\n534\n00:27:21.242 --> 00:27:22.941\nI'm getting the signal\nwe're running out of time.\n\n535\n00:27:22.941 --> 00:27:24.978\n&gt;&gt; [LAUGH]\n&gt;&gt; But just a couple of journal ctl\n\n536\n00:27:24.978 --> 00:27:26.850\ncommands that are handy for us.\n\n537\n00:27:26.850 --> 00:27:28.195\nI showed you journalctl,\n\n538\n00:27:28.195 --> 00:27:31.324\nlet me get out of this folder\ncuz it's like really long path.\n\n539\n00:27:31.324 --> 00:27:33.742\nI showed you journalctl -f, which says,\n\n540\n00:27:33.742 --> 00:27:36.508\nshow me the last ten lines and\nfollow it, right?\n\n541\n00:27:36.508 --> 00:27:38.137\nSo that's one way we can do it.\n\n542\n00:27:38.137 --> 00:27:41.467\nBut you can also do journalctl -n and\n\n543\n00:27:41.467 --> 00:27:45.990\nyou can tell it to show me\na certain number of line.\n\n544\n00:27:45.990 --> 00:27:48.832\nSo I can say like show\nme the first ten lines.\n\n545\n00:27:48.832 --> 00:27:52.532\nAnd so here I'm getting lines 1\nthrough 11 or whatever, or actually,\n\n546\n00:27:52.532 --> 00:27:55.823\nthis is our last ten lines,\nI'm sorry, I need to get that right.\n\n547\n00:27:55.823 --> 00:27:58.395\nSo you can kinda modify what\nit is that you're outputting.\n\n548\n00:27:58.395 --> 00:28:00.836\nIf you just run it by yourself,\nyou see the whole thing.\n\n549\n00:28:00.836 --> 00:28:04.031\nAnd that beyond CVS what I normally\ndo cuz I'll pipe that in the grep and\n\n550\n00:28:04.031 --> 00:28:05.668\nthen I look for something, right?\n\n551\n00:28:05.668 --> 00:28:08.753\nMaybe I'm troubleshooting HTPD and\nso I'll grep for that.\n\n552\n00:28:08.753 --> 00:28:11.183\nAnd then I get those entries back and\nI can look at them and\n\n553\n00:28:11.183 --> 00:28:13.379\nI can see that information and\nget it out of there.\n\n554\n00:28:13.379 --> 00:28:16.956\nSo you can certainly pipe and then use\nthe utilities that you're used to.\n\n555\n00:28:16.956 --> 00:28:20.109\nAt that point, it's really no different\nthan how you work with syslog.\n\n556\n00:28:20.109 --> 00:28:22.352\nHere, it's just a different\ncommand that we're using.\n\n557\n00:28:22.352 --> 00:28:25.465\nSome of the other things you can\ndo is you can filter by priority.\n\n558\n00:28:25.465 --> 00:28:27.360\nLike maybe I just wanna see errors.\n\n559\n00:28:27.360 --> 00:28:30.104\nWell, I used to have\nthis problem in syslog,\n\n560\n00:28:30.104 --> 00:28:34.295\nwhere I would say like cat\n/var/log/messages and I would pipe that\n\n561\n00:28:34.295 --> 00:28:38.525\ninto grep and I would do a case\ninsensitive search for the word error.\n\n562\n00:28:38.525 --> 00:28:41.756\nCuz maybe the e is capitalized,\nmaybe the whole word is capitalized,\n\n563\n00:28:41.756 --> 00:28:44.848\nI don't know, and I could go in and\nI could look for those, right?\n\n564\n00:28:44.848 --> 00:28:49.027\nOr sometimes maybe just said err,\nthere's some more.\n\n565\n00:28:49.027 --> 00:28:51.211\nI would have missed that just looking for\nthe word error, right?\n\n566\n00:28:51.211 --> 00:28:54.131\nWell actually, these are interrupts,\nso that doesn't even really count.\n\n567\n00:28:54.131 --> 00:28:56.700\nSo that's a challenge\nthat we had with syslog.\n\n568\n00:28:56.700 --> 00:29:02.596\nBut with journald,\nwe can actually say, journalctl -p.\n\n569\n00:29:02.596 --> 00:29:05.196\nAnd I can look for\nthe priorities, and I can say,\n\n570\n00:29:05.196 --> 00:29:08.071\nshow me everything that has\nan err priority, right?\n\n571\n00:29:08.071 --> 00:29:11.161\nThat's an error, I'm not getting all\nthose interrupts, they're there,\n\n572\n00:29:11.161 --> 00:29:12.119\nI'm not getting them.\n\n573\n00:29:12.119 --> 00:29:15.645\nI'm just seeing the ones that have\nactually been flagged as some\n\n574\n00:29:15.645 --> 00:29:16.769\nkind of error here.\n\n575\n00:29:16.769 --> 00:29:19.391\nAnd I can look at what that is and\ntry and figure out what they are.\n\n576\n00:29:19.391 --> 00:29:23.237\nLooks like I've got some kind of storage\nissue on which is odd on a virtual machine\n\n577\n00:29:23.237 --> 00:29:24.210\nbut anyhow I see it.\n\n578\n00:29:24.210 --> 00:29:30.820\nSo that's a technique and you can also\nfilter by date and time if you want to,\n\n579\n00:29:30.820 --> 00:29:36.300\nso I could say journalctl --since= and\nspecify a date.\n\n580\n00:29:36.300 --> 00:29:39.447\nSo maybe I wanna see all\nthe log entries for January.\n\n581\n00:29:39.447 --> 00:29:44.394\nSo I could say since 2017-01-01,\n\n582\n00:29:44.394 --> 00:29:47.785\n00:00:00 like that.\n\n583\n00:29:47.785 --> 00:29:50.529\nSo show me everything since that date, and\n\n584\n00:29:50.529 --> 00:29:54.046\nI could say --until,\nwe're gonna go even further.\n\n585\n00:29:54.046 --> 00:30:01.272\nAnd in here I can say,\nuntil = '2017-02-01'\n\n586\n00:30:01.272 --> 00:30:05.770\n00:00:00, all right?\n\n587\n00:30:05.770 --> 00:30:09.248\nAnd by doing that I'm saying show me\neverything that occurred between January\n\n588\n00:30:09.248 --> 00:30:10.415\n1st and January 31st.\n\n589\n00:30:10.415 --> 00:30:13.138\nOr if you're like me and you can't\nremember if it has 31 days, right?\n\n590\n00:30:13.138 --> 00:30:15.418\nThen it's really all the way\nup until February 1st.\n\n591\n00:30:15.418 --> 00:30:19.922\nSo by doing that now I'll just get those\nlog messages which it looks like I don't\n\n592\n00:30:19.922 --> 00:30:23.974\nhave any, which makes sense cuz I just\nspun up this server two days ago.\n\n593\n00:30:23.974 --> 00:30:25.570\n&gt;&gt; [LAUGH]\n&gt;&gt; [LAUGH] So anyhow we can filter that\n\n594\n00:30:25.570 --> 00:30:27.430\nway through journalctl very powerful.\n\n595\n00:30:27.430 --> 00:30:29.261\nIt is the way of the future,\nit's the way we wanna learn it.\n\n596\n00:30:29.261 --> 00:30:32.579\nAnd that's what you're gonna be\nusing now and in the future, but\n\n597\n00:30:32.579 --> 00:30:33.798\nsyslog is everywhere.\n\n598\n00:30:33.798 --> 00:30:37.509\nGoing back to Zach's original question\nof is it gonna be the same everywhere?\n\n599\n00:30:37.509 --> 00:30:40.196\nIf you want the same everywhere,\nsyslog is what you need to get used to.\n\n600\n00:30:40.196 --> 00:30:43.131\nAnd I do recommend that you learn both,\nat least of the time being.\n\n601\n00:30:43.131 --> 00:30:45.482\n&gt;&gt; Fantastic information, as always, Don.\n\n602\n00:30:45.482 --> 00:30:48.759\nAnd like he's saying,\nbe prepared for the future, so\n\n603\n00:30:48.759 --> 00:30:51.618\nconfiguring system logging,\nany last words?\n\n604\n00:30:51.618 --> 00:30:53.747\n&gt;&gt; The main thing,\nconfig your log rotation, right?\n\n605\n00:30:53.747 --> 00:30:56.748\nDon't assume the defaults are going to\nbe friendly for your security policy,\n\n606\n00:30:56.748 --> 00:30:57.842\ndefinitely check that out.\n\n607\n00:30:57.842 --> 00:31:00.830\nI encourage you to set up\na centralized logging server.\n\n608\n00:31:00.830 --> 00:31:03.610\nIf you don't have one already, it's\na great place to have a second server.\n\n609\n00:31:03.610 --> 00:31:05.929\nAnd you can even provide more\nthan one server if you want.\n\n610\n00:31:05.929 --> 00:31:09.053\nYou might have a remote logging server\nthat's right there in your headquarters\n\n611\n00:31:09.053 --> 00:31:10.788\nand another that's at disaster recovery.\n\n612\n00:31:10.788 --> 00:31:13.919\nSo now you've got two different\ncopies of those logs being sent out.\n\n613\n00:31:13.919 --> 00:31:15.720\nYou can do that, right?\n\n614\n00:31:15.720 --> 00:31:18.500\nAnd then after that,\nthese are just text files, right?\n\n615\n00:31:18.500 --> 00:31:21.590\nIn sys log they could be compressed,\nthey become very, very small.\n\n616\n00:31:21.590 --> 00:31:23.991\nSo I know a lot of people use\nscripts to automate that process,\n\n617\n00:31:23.991 --> 00:31:25.310\ncompressing logs down.\n\n618\n00:31:25.310 --> 00:31:27.100\nWith journal ctl,\nthey're encrypted binary, so\n\n619\n00:31:27.100 --> 00:31:30.109\nthey don't really compress all that well,\nso we don't have to worry about it there.\n\n620\n00:31:30.109 --> 00:31:32.970\nBut definitely pay attention to\nyour maintenance schedule on those,\n\n621\n00:31:32.970 --> 00:31:35.974\ndouble check it and probably the most\nimportant thing that I can tell you,\n\n622\n00:31:35.974 --> 00:31:37.398\nmonitor your logs, look at them.\n\n623\n00:31:37.398 --> 00:31:39.044\nA lot of people do log in,\nthey never look at them,\n\n624\n00:31:39.044 --> 00:31:41.021\nthere's not a whole lot of point\nhaving them at that point.\n\n625\n00:31:41.021 --> 00:31:44.121\nSo, make sure you look at your logs, they\ngot a lot of great information in there\n\n626\n00:31:44.121 --> 00:31:45.899\nand they can help you\nsolve a lot of problems.\n\n627\n00:31:45.899 --> 00:31:49.440\n&gt;&gt; Awesome advice,\nbecoming a Linux server administrator.\n\n628\n00:31:49.440 --> 00:31:51.760\nThere's a lot of video\ncontent in this series,\n\n629\n00:31:51.760 --> 00:31:55.472\nmake sure you watch every single video,\nyou're gonna be very glad you did.\n\n630\n00:31:55.472 --> 00:31:57.381\nAnd thank you for watching ITProTV.\n\n631\n00:31:57.381 --> 00:32:00.916\nRemember, a good IT pro\nis always learning.\n\n632\n00:32:00.916 --> 00:32:01.528\nI'm Zach Memos.\n\n633\n00:32:01.528 --> 00:32:02.379\n&gt;&gt; And I'm Don Pezet.\n\n634\n00:32:02.379 --> 00:32:04.122\n&gt;&gt; And we'll see you very soon.\n\n635\n00:32:04.122 --> 00:32:11.193\n[MUSIC]\n\n636\n00:32:11.193 --> 00:32:13.778\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "226153361"
        },
        {
          "description": "Don and Zach consider how best to monitor performance, when we would need to view performance, viewing current & short-term data, display processes in real-time, disk storage/utilization, memory utilization/historical data, what SAR is, SYSSTAT, how we view logged CPU usage data, viewing logged disk activity, viewing logged network activity, viewing network errors, and viewing real-time data.",
          "length": "1563",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-5-monitoring_performance-071817-PGM.00_27_58_02.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-5-monitoring_performance-071817-PGM.00_27_58_02.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-1-5-monitoring_performance-071817-PGM.00_27_58_02.Still001-sm.jpg",
          "title": "Monitoring Performance",
          "transcript": "WEBVTT\n\n1\n00:00:00.270 --> 00:00:06.490\nWelcome to ITPRO.TV,\nI'm your host Don Pezet [CROSSTALK]\n\n2\n00:00:06.490 --> 00:00:08.226\n[MUSIC]\n\n3\n00:00:08.226 --> 00:00:11.880\n&gt;&gt; You're watching ITPRO.TV.\n\n4\n00:00:11.880 --> 00:00:14.135\n&gt;&gt; Hello and thank you for\nchoosing ITPRO.TV,\n\n5\n00:00:14.135 --> 00:00:16.370\nhelping you learn where ever you go.\n\n6\n00:00:16.370 --> 00:00:17.790\nI'm your host Zach Memos,\n\n7\n00:00:17.790 --> 00:00:21.420\nas we continue on with becoming\na Linux Server Administrator.\n\n8\n00:00:21.420 --> 00:00:23.973\nWe're going to be monitoring\nperformance in this episode.\n\n9\n00:00:23.973 --> 00:00:26.202\nBringing us the information\nwe need is the one, the only,\n\n10\n00:00:26.202 --> 00:00:28.171\nyou know him you love him\nDon Pezet right over here.\n\n11\n00:00:28.171 --> 00:00:30.992\n&gt;&gt; [LAUGH] Such expectations that\nI have to live up to around here.\n\n12\n00:00:30.992 --> 00:00:31.887\nBut in this episode,\n\n13\n00:00:31.887 --> 00:00:35.280\nwe're going to be kicking right back\ninto Linux server administration.\n\n14\n00:00:35.280 --> 00:00:38.320\nAnd we're going to focus a little\nbit on monitoring performance.\n\n15\n00:00:38.320 --> 00:00:40.513\nServers are not cheap,\neven virtual servers.\n\n16\n00:00:40.513 --> 00:00:43.440\nYou pay a lot of money to have\nthem in place and running.\n\n17\n00:00:43.440 --> 00:00:46.390\nWhich means you've gotta kind of\njuggle the resources that you've got.\n\n18\n00:00:46.390 --> 00:00:48.510\nYou've got a limited amount of CPU power.\n\n19\n00:00:48.510 --> 00:00:52.970\nYou've got a limited amount of memory and\ndisk I/O and network resources.\n\n20\n00:00:52.970 --> 00:00:55.841\nSo we need some way to be able to\nmonitor them to make sure that one,\n\n21\n00:00:55.841 --> 00:00:57.898\nwe're actually getting\nwhat we think we are.\n\n22\n00:00:57.898 --> 00:01:01.222\nAnd two, whether or not we need more,\nright, whether we've got enough\n\n23\n00:01:01.222 --> 00:01:05.000\nresources available for us to properly be\nproviding our services on the network.\n\n24\n00:01:05.000 --> 00:01:07.180\nSo In this episode we're\ngonna learn how to do that.\n\n25\n00:01:07.180 --> 00:01:10.640\nHow to monitor and gather that data and\nthen put it to some kind of use.\n\n26\n00:01:10.640 --> 00:01:14.130\n&gt;&gt; So Don could give us an idea\nof when we would need to view or\n\n27\n00:01:14.130 --> 00:01:15.380\nmonitor that performance?\n\n28\n00:01:15.380 --> 00:01:16.906\nWhen or why?\n\n29\n00:01:16.906 --> 00:01:20.610\n&gt;&gt; So there's two main times I find\nmyself monitoring performance.\n\n30\n00:01:20.610 --> 00:01:23.880\nWhenever I deploy a brand new server,\nso you get a new server.\n\n31\n00:01:23.880 --> 00:01:25.790\nYou're rolling it out the first time.\n\n32\n00:01:25.790 --> 00:01:27.540\nYou'll want to gather performance data.\n\n33\n00:01:27.540 --> 00:01:30.100\nWhat you're doing is\ncalled setting a baseline.\n\n34\n00:01:30.100 --> 00:01:33.660\nYou need to understand how that\nserver is running normally.\n\n35\n00:01:33.660 --> 00:01:35.770\nWhen everything is working the way\nthat it is supposed to work,\n\n36\n00:01:35.770 --> 00:01:36.870\nhow does that server look?\n\n37\n00:01:36.870 --> 00:01:39.129\nWhat percentage of CPU\nutilization is it at?\n\n38\n00:01:39.129 --> 00:01:41.190\nLet's say it's at 50% CPU.\n\n39\n00:01:41.190 --> 00:01:43.380\nOkay, fine, great, It's at half.\n\n40\n00:01:43.380 --> 00:01:44.950\nThat's a perfectly good number.\n\n41\n00:01:44.950 --> 00:01:47.270\nAnd that's where it's at normally.\n\n42\n00:01:47.270 --> 00:01:50.160\nAnd then one day somebody calls on\nthe phone and is like Don quick.\n\n43\n00:01:50.160 --> 00:01:53.340\nThe servers are running super\nslow customers are getting angry.\n\n44\n00:01:53.340 --> 00:01:55.540\nAll right I've got to log in and find out.\n\n45\n00:01:55.540 --> 00:01:57.320\nIs the server running super slow?\n\n46\n00:01:57.320 --> 00:02:00.898\nWell if I look and the CPU is at 50%.\n\n47\n00:02:00.898 --> 00:02:03.756\nI might look at that and\nsay 50% is that high, is that low?\n\n48\n00:02:03.756 --> 00:02:05.219\nI don't really know.\n\n49\n00:02:05.219 --> 00:02:06.467\nI've got this baseline.\n\n50\n00:02:06.467 --> 00:02:08.988\nWhen everything was working normally,\nwe were at 50%.\n\n51\n00:02:08.988 --> 00:02:11.810\nNow we're at 50%, everything is fine.\n\n52\n00:02:11.810 --> 00:02:12.719\n&gt;&gt; Makes sense.\n\n53\n00:02:12.719 --> 00:02:13.640\n&gt;&gt; That happens.\n\n54\n00:02:13.640 --> 00:02:17.110\nSometimes people don't know\nyou need context to your data.\n\n55\n00:02:17.110 --> 00:02:19.146\nThat's really what monitoring\nperformance is all about,\n\n56\n00:02:19.146 --> 00:02:20.470\nis being able to look and see.\n\n57\n00:02:20.470 --> 00:02:22.950\nIf somebody calls and\nsays a server is running slow and\n\n58\n00:02:22.950 --> 00:02:26.400\nI pull up the report that says,\nCPU is at 100%.\n\n59\n00:02:26.400 --> 00:02:28.080\nIt's completely maxed out.\n\n60\n00:02:28.080 --> 00:02:29.410\nI know there's a problem.\n\n61\n00:02:29.410 --> 00:02:32.030\nI can go in and\ntry to find why that problem is there.\n\n62\n00:02:32.030 --> 00:02:33.645\nSo that's the best example.\n\n63\n00:02:33.645 --> 00:02:35.558\nThe two times [INAUDIBLE] data is one,\n\n64\n00:02:35.558 --> 00:02:39.013\nwhen we do a baseline to figure out\nhow things run normally and two,\n\n65\n00:02:39.013 --> 00:02:43.060\nwhen we're troubleshooting to figure\nout how things are running right now.\n\n66\n00:02:43.060 --> 00:02:45.504\nAnd so I like to call that\nreal-time performance monitoring.\n\n67\n00:02:45.504 --> 00:02:47.690\nLooking at how things are going right now.\n\n68\n00:02:47.690 --> 00:02:51.450\nAnd as far as the Unix\nlike operating systems.\n\n69\n00:02:51.450 --> 00:02:55.002\nThere's a ton of utilities are just built\nright in that we can take advantage of.\n\n70\n00:02:55.002 --> 00:02:58.305\nRight now, for most of this series\nI've been using a virtual machine, but\n\n71\n00:02:58.305 --> 00:03:01.295\nin this particular episode I'm gonna\nuse my actual laptop because I\n\n72\n00:03:01.295 --> 00:03:05.310\nneed historical data and I need real\nhardware to show you guys good numbers.\n\n73\n00:03:05.310 --> 00:03:07.965\nBut all of this does work on\nvirtual machines as well.\n\n74\n00:03:07.965 --> 00:03:11.519\nVirtual machines are a little trickier\nthough because if I have three VMs they\n\n75\n00:03:11.519 --> 00:03:15.237\ncan all be competing for access to the\nsame resources versus when you're running\n\n76\n00:03:15.237 --> 00:03:17.820\na dedicated hardware where\nyou have exclusive access.\n\n77\n00:03:17.820 --> 00:03:18.910\nSo be aware,\n\n78\n00:03:18.910 --> 00:03:22.570\nmonitoring virtual machines can be a\nlittle bit tricky because of that balance.\n\n79\n00:03:22.570 --> 00:03:27.070\nBut on my machine if I want to take\na look at for example CPU right?\n\n80\n00:03:27.070 --> 00:03:30.810\nOne of the best utilities I can use for\nthat is the PS command.\n\n81\n00:03:30.810 --> 00:03:36.230\nAnd PS is designed to show me processes\nthat are running on the system.\n\n82\n00:03:36.230 --> 00:03:39.580\nAnd when you run it, there's a number of\ncommand line modifiers you can use, but\n\n83\n00:03:39.580 --> 00:03:44.320\nAUX is the most common, which tells\nit to show me all the processes for\n\n84\n00:03:44.320 --> 00:03:46.910\nall of the users, not just for me.\n\n85\n00:03:46.910 --> 00:03:50.744\nWhen you normally run PS by itself,\nit just shows you your processes.\n\n86\n00:03:50.744 --> 00:03:53.950\nAnd not even just yours,\njust the ones in your session.\n\n87\n00:03:53.950 --> 00:03:59.185\nSo for example if I were to fire up\nanother utility like calculator here,\n\n88\n00:03:59.185 --> 00:04:01.940\nso I'm running that calculator as me.\n\n89\n00:04:01.940 --> 00:04:05.590\nAnd when I come and pull up PS,\nI don't see it there, right.\n\n90\n00:04:05.590 --> 00:04:09.720\nBecause it's just stuff that I'm running\nin this shell, and in this particular\n\n91\n00:04:09.720 --> 00:04:14.080\nshell, the only thing I've run is bash to\nget the shell and PS to get my processes.\n\n92\n00:04:14.080 --> 00:04:19.720\nBut if I do PS aux,\nI'll see everybody's processes, okay.\n\n93\n00:04:19.720 --> 00:04:21.670\nEverybody's including mine and\nother people's.\n\n94\n00:04:21.670 --> 00:04:23.860\nI see dpezet as well as root and\n\n95\n00:04:23.860 --> 00:04:26.470\nin summary here if I poked\naround I'd find that calculator.\n\n96\n00:04:26.470 --> 00:04:28.605\nActually, it's right here,\nthat wasn't even that hard.\n\n97\n00:04:28.605 --> 00:04:30.860\nGnome calculator right there right?\n\n98\n00:04:30.860 --> 00:04:32.318\nSo it's running in a window\nI can actually see it.\n\n99\n00:04:32.318 --> 00:04:37.461\nSo PSAUX, now when I run that I'm\nseeing several columns of data.\n\n100\n00:04:37.461 --> 00:04:40.877\nAnd if you scroll up to the top you\ncan see what those columns are,\n\n101\n00:04:40.877 --> 00:04:44.830\neach one pertains to a little bit\nof information about the system.\n\n102\n00:04:44.830 --> 00:04:48.700\nAnd CPU and memory are the two\nthat I normally care about.\n\n103\n00:04:48.700 --> 00:04:51.570\nHow much CPU is that\napplication eating up?\n\n104\n00:04:51.570 --> 00:04:54.690\nAnd how much memory and\nit's listed here in a percentage.\n\n105\n00:04:54.690 --> 00:04:58.580\nSo if my CPU is at 100%,\nI can come in here and\n\n106\n00:04:58.580 --> 00:05:03.440\nlook and say, all right which process\nis it that's really eating things up?\n\n107\n00:05:03.440 --> 00:05:07.630\nNow the only negative about the PS command\nis that it is a one and done type thing.\n\n108\n00:05:07.630 --> 00:05:11.630\nI just got a snapshot of how\nthe server looked right then.\n\n109\n00:05:11.630 --> 00:05:14.230\nBut sometimes I need to keep an eye on it\nfor a moment because you have peaks and\n\n110\n00:05:14.230 --> 00:05:15.630\nvalleys and activity.\n\n111\n00:05:15.630 --> 00:05:19.860\nSo in that respect the top\ncommand is a little more useful.\n\n112\n00:05:19.860 --> 00:05:23.840\nTop will actually show you the same\ndata that I just showed you.\n\n113\n00:05:23.840 --> 00:05:26.120\nBut it's being updated in real time.\n\n114\n00:05:26.120 --> 00:05:27.810\nSee how the list is changing?\n\n115\n00:05:27.810 --> 00:05:30.140\nThe list is gonna change\nto reflect what's going on.\n\n116\n00:05:30.140 --> 00:05:34.270\nSo if I launch a larger program, let me\nlaunch Chromium here in the background.\n\n117\n00:05:34.270 --> 00:05:37.786\nAnd as I launch Chromium,\nit's gonna jump up right to the top.\n\n118\n00:05:37.786 --> 00:05:39.870\nRight there, it's number one on my list.\n\n119\n00:05:39.870 --> 00:05:42.490\nAnd then as that application settles down,\nit'll start to drop down.\n\n120\n00:05:42.490 --> 00:05:44.670\nThis is a real time view.\n\n121\n00:05:44.670 --> 00:05:47.419\nAnd I'm able to see who's\nconsuming the most CPU.\n\n122\n00:05:47.419 --> 00:05:51.330\nChromiums got the most 4% of my CPU right\nnow, and then it drops back down right.\n\n123\n00:05:51.330 --> 00:05:52.931\nSo I now I can sit here and\nI can watch and\n\n124\n00:05:52.931 --> 00:05:55.935\nI can see the CPU and the memory right\nhere inside of the top command, and\n\n125\n00:05:55.935 --> 00:05:59.520\nthis is installed by default, on pretty\nmuch every Linux distro that's out there.\n\n126\n00:05:59.520 --> 00:06:02.410\nIt's considered a core utility.\n\n127\n00:06:02.410 --> 00:06:06.928\nNow the default view is that\nit's sorting by CPU usage.\n\n128\n00:06:06.928 --> 00:06:09.990\nBut I might be more concerned about\nsomething else other than CPU.\n\n129\n00:06:09.990 --> 00:06:13.200\nAnd so you can change the view\nto reflect what you want.\n\n130\n00:06:13.200 --> 00:06:17.700\nSo for example, I could hit the letter\nu and it'll let me filter by user.\n\n131\n00:06:17.700 --> 00:06:21.110\nSo, maybe I just want to\nsee my stuff all right?\n\n132\n00:06:21.110 --> 00:06:23.630\nAnd so I can filter down just to dpezet.\n\n133\n00:06:23.630 --> 00:06:25.720\nAnd now I'm only seeing my processes.\n\n134\n00:06:25.720 --> 00:06:28.280\nOr I can leave it blank and\nI can go back to viewing everybody.\n\n135\n00:06:28.280 --> 00:06:30.430\nSo you lets you filter by user.\n\n136\n00:06:30.430 --> 00:06:35.049\nYou've got M to change the sort\norder from CPU to memory.\n\n137\n00:06:35.049 --> 00:06:36.100\nAnd it's a capital M.\n\n138\n00:06:36.100 --> 00:06:40.200\nIf I do a capital M now it's\nsorting by memory utilization.\n\n139\n00:06:40.200 --> 00:06:45.140\nThe highest memory utilizer is first and\nthen it goes down from there okay.\n\n140\n00:06:45.140 --> 00:06:49.954\nIf I do a capital P, it'll go back\nto being sorted by CPU right.\n\n141\n00:06:49.954 --> 00:06:54.178\nBut I'll M for memory,\ncapital C for CPU and then U,\n\n142\n00:06:54.178 --> 00:06:56.930\nto pick a user and filter by it.\n\n143\n00:06:56.930 --> 00:07:00.850\nThose three little short cuts are really\nhandy, they come in here and try and\n\n144\n00:07:00.850 --> 00:07:03.360\nfind processes, and look at data.\n\n145\n00:07:03.360 --> 00:07:06.900\nIf you see something that's running too\nhigh, right, consuming a lot of CPU,\n\n146\n00:07:06.900 --> 00:07:09.790\nor a lot of memory, you can actually\nkill the process from in here if\n\n147\n00:07:09.790 --> 00:07:14.040\nyou want by hitting K, and then giving it\nthe process ID for what you wanna cancel.\n\n148\n00:07:14.040 --> 00:07:15.860\nIt'll default to whatever's at top.\n\n149\n00:07:15.860 --> 00:07:18.270\nSo right now it's gonna kill my gnome\nshow, which I really don't wanna do.\n\n150\n00:07:18.270 --> 00:07:21.811\n[LAUGH] But I can kill something else or\nI can hit escape to abort out.\n\n151\n00:07:21.811 --> 00:07:23.166\n&gt;&gt; It's hard to kill a gnome.\n\n152\n00:07:23.166 --> 00:07:23.943\nYeah.\n\n153\n00:07:23.943 --> 00:07:24.985\n&gt;&gt; [LAUGH] The little red hats.\n\n154\n00:07:24.985 --> 00:07:26.044\n&gt;&gt; Yeah.\n\n155\n00:07:26.044 --> 00:07:26.726\n&gt;&gt; But anyway so\n\n156\n00:07:26.726 --> 00:07:31.270\nhere I've got my pretty good view here of\nperformance on the system as it stands.\n\n157\n00:07:31.270 --> 00:07:32.920\nI can look, I can see what's going on and\n\n158\n00:07:32.920 --> 00:07:35.970\nget an idea of who's eating that CPU and\nwho's eating that memory.\n\n159\n00:07:35.970 --> 00:07:38.275\nAnd see it all in one concise place.\n\n160\n00:07:38.275 --> 00:07:41.504\n&gt;&gt; So what about disk, storage other than?\n\n161\n00:07:41.504 --> 00:07:42.237\n&gt;&gt; Sure.\nYeah,\n\n162\n00:07:42.237 --> 00:07:44.973\ndisk is often times one of the other\nthings that we need to monitor and\n\n163\n00:07:44.973 --> 00:07:47.050\nI don't see any of that information here,\nright?\n\n164\n00:07:47.050 --> 00:07:48.770\nSo I'm going to hit q to quit out of that.\n\n165\n00:07:48.770 --> 00:07:50.380\nI'm going to get out of the top command.\n\n166\n00:07:50.380 --> 00:07:53.670\nWith disk,\nit's really difficult to monitor.\n\n167\n00:07:53.670 --> 00:07:56.081\nUsually we're worried about\nthe amount of storage.\n\n168\n00:07:56.081 --> 00:07:58.055\nI think in the last episode,\nwe talked about logging and\n\n169\n00:07:58.055 --> 00:08:00.245\nI mentioned how your logs might go and\nfill up your hard drive.\n\n170\n00:08:00.245 --> 00:08:01.176\nYou don't want that to happen.\n\n171\n00:08:01.176 --> 00:08:05.774\nSo we need a way to monitor What disks\nare present and what their utilization is.\n\n172\n00:08:05.774 --> 00:08:07.890\nWe've got a few different commands for\nthat.\n\n173\n00:08:07.890 --> 00:08:10.305\nThe most common one that I use,\nis the df command.\n\n174\n00:08:10.305 --> 00:08:13.588\ndf shows you the disks that you've got and\nwhere they're mounted,\n\n175\n00:08:13.588 --> 00:08:15.980\nwhich is a pretty convenient thing.\n\n176\n00:08:15.980 --> 00:08:19.425\nBut in addition to that,\nit shows how much space they have, and\n\n177\n00:08:19.425 --> 00:08:24.173\nhow much space you've used, as well as how\nmuch is available, and then a percentage.\n\n178\n00:08:24.173 --> 00:08:25.593\nSo you can quickly glance down this.\n\n179\n00:08:25.593 --> 00:08:29.353\nAnd if I see something like this,\n83%, t hat's my storage drive,\n\n180\n00:08:29.353 --> 00:08:31.282\nit's starting to run out of space.\n\n181\n00:08:31.282 --> 00:08:32.071\n&gt;&gt; Hmm!\n\n182\n00:08:32.071 --> 00:08:34.601\n&gt;&gt; So I might need to\nupgrade that in the future.\n\n183\n00:08:34.601 --> 00:08:36.065\nI might need to add more storage.\n\n184\n00:08:36.065 --> 00:08:38.775\nI might need to delete some files,\nis probably the reality there.\n\n185\n00:08:38.775 --> 00:08:41.175\nBut I can see I'm starting to\nrun a little low on storage.\n\n186\n00:08:41.175 --> 00:08:43.265\nThe only thing I don't like\nabout df is that by default,\n\n187\n00:08:43.265 --> 00:08:46.865\nit's showing everything in bytes,\nwhich is a little hard to read.\n\n188\n00:08:46.865 --> 00:08:50.393\nSo I normally run df -h,\nwhich makes it human-readable.\n\n189\n00:08:50.393 --> 00:08:51.265\nIt changes it, so\n\n190\n00:08:51.265 --> 00:08:55.015\ninstead of bytes, it puts them in\nsizes we're a little more used to.\n\n191\n00:08:55.015 --> 00:08:59.950\nSo I can see my storage drive,\nit actually is a 916 gig drive,\n\n192\n00:08:59.950 --> 00:09:01.650\nso it's almost a terabyte.\n\n193\n00:09:01.650 --> 00:09:05.540\nI'm using 717 gigs, and\nI've got a 153 gigs free.\n\n194\n00:09:05.540 --> 00:09:08.440\nSo while it is 83% full,\nwhich is pretty high,\n\n195\n00:09:08.440 --> 00:09:11.810\nI've got 150 gigs of space right there,\nthat's actually quite a bit.\n\n196\n00:09:11.810 --> 00:09:12.680\n&gt;&gt; It's a little bit.\n\n197\n00:09:12.680 --> 00:09:14.025\n&gt;&gt; And so it's easier to see that.\n\n198\n00:09:14.025 --> 00:09:17.330\nThat was df -h, to be able to see that.\n\n199\n00:09:17.330 --> 00:09:20.543\nNow, let's say that I was\nworried about that drive.\n\n200\n00:09:20.543 --> 00:09:24.558\nAnd I said, man, I really need to\nfree up some space back there, and\n\n201\n00:09:24.558 --> 00:09:26.985\nwho is it that's eating all that space?\n\n202\n00:09:26.985 --> 00:09:31.800\nWell, if I take a look at /mnt/storage,\nand I look.\n\n203\n00:09:31.800 --> 00:09:32.680\nI've got a few things in there.\n\n204\n00:09:32.680 --> 00:09:33.990\nI've got my show notes.\n\n205\n00:09:33.990 --> 00:09:37.280\nI've got a folder called ISOs\nthat has CD images in it.\n\n206\n00:09:37.280 --> 00:09:39.510\nI've got my virtual machines\nare tucked in here,\n\n207\n00:09:39.510 --> 00:09:42.600\nmy Google Drive,\nwhich one is the guilty culprit?\n\n208\n00:09:42.600 --> 00:09:45.730\nWho is it that's eating the most\nstorage here on this disk?\n\n209\n00:09:45.730 --> 00:09:48.630\nWell, df doesn't tell me that,\nit just tells me that I'm low on storage.\n\n210\n00:09:48.630 --> 00:09:51.650\nSo there's another utility\nwe can use called, du.\n\n211\n00:09:51.650 --> 00:09:55.025\nAnd du will actually show\nus the disk utilisation,\n\n212\n00:09:55.025 --> 00:09:57.702\nand you can point it at a folder, right?\n\n213\n00:09:57.702 --> 00:10:02.537\nSo I can come in and I can do\nsomething like du and I'll do -sh.\n\n214\n00:10:02.537 --> 00:10:06.316\nThe h making it human-readable,\nand -s cuz I'm pointing at a path.\n\n215\n00:10:06.316 --> 00:10:09.952\nAnd I can point it at\nsomething like /mnt/Storage.\n\n216\n00:10:09.952 --> 00:10:12.478\nAnd it's gonna take a look at that disk,\nand\n\n217\n00:10:12.478 --> 00:10:16.250\nit's gonna tell me how much space is used,\nright, 717 gigs.\n\n218\n00:10:17.830 --> 00:10:21.690\nAnd then beyond that,\nI can look at what's inside of it, right?\n\n219\n00:10:21.690 --> 00:10:23.500\nWhat's inside of that folder.\n\n220\n00:10:23.500 --> 00:10:25.782\nAnd now,\nit'll show me each folder inside, and\n\n221\n00:10:25.782 --> 00:10:28.129\nI can figure out who's using that space,\nright?\n\n222\n00:10:28.129 --> 00:10:33.677\nSo out of 717 gigs, only 173 of\nthat is in my virtual machines.\n\n223\n00:10:33.677 --> 00:10:36.333\nI've got another 156 in my ISOs.\n\n224\n00:10:36.333 --> 00:10:39.140\nI've got 3.8 gigs in my Show Notes.\n\n225\n00:10:39.140 --> 00:10:41.389\nAnd my Google Drive is 1.6 gigs.\n\n226\n00:10:41.389 --> 00:10:44.714\nIt looks like I don't really\nhave one guilty culprit here,\n\n227\n00:10:44.714 --> 00:10:48.650\nI've got several folders that are all\ncombining to eat up that space.\n\n228\n00:10:48.650 --> 00:10:50.650\nNow, I'm not a mathematician, but\n\n229\n00:10:50.650 --> 00:10:55.160\nlooking at this,\nI don't see how that adds up to 717 gigs.\n\n230\n00:10:55.160 --> 00:10:58.430\nAnd the reason is, there's things\nthat I'm not seeing here, okay?\n\n231\n00:10:58.430 --> 00:11:01.060\nI'm running this as my regular user.\n\n232\n00:11:01.060 --> 00:11:04.050\nA lot of times to get a good view\nof performance on your system,\n\n233\n00:11:04.050 --> 00:11:06.610\nyou need to run this stuff\nas an administrator.\n\n234\n00:11:06.610 --> 00:11:10.090\nYou need to make sure that\nyou're sudoing these, so\n\n235\n00:11:10.090 --> 00:11:12.300\nthat it can actually get\na better view of what's going on.\n\n236\n00:11:12.300 --> 00:11:14.610\nAnd you might find additional\ninformation turns up.\n\n237\n00:11:14.610 --> 00:11:17.130\nIn my case, I actually didn't\nturn anything else up, so\n\n238\n00:11:17.130 --> 00:11:20.040\ni wonder if I have a hidden file or\nsomething, which I don't.\n\n239\n00:11:20.040 --> 00:11:21.767\nSo I've got something\nmiscellaneous in here,\n\n240\n00:11:21.767 --> 00:11:24.842\nand it might be something in the trash or\nsomething that I'm being denied access to.\n\n241\n00:11:24.842 --> 00:11:26.420\nBut you've always gotta be\ncareful with that, right?\n\n242\n00:11:26.420 --> 00:11:28.700\nBecause when you monitor your disk,\n\n243\n00:11:28.700 --> 00:11:32.620\nyour permissions can skew the results of\nthese numbers that you're pulling back.\n\n244\n00:11:32.620 --> 00:11:37.590\nSo we do have to be careful, to make sure\nthat we're actually seeing the full set\n\n245\n00:11:37.590 --> 00:11:41.985\nof data, and understanding where\nthat data loss might be, right?\n\n246\n00:11:41.985 --> 00:11:43.938\nSo that's the du command.\n\n247\n00:11:43.938 --> 00:11:48.065\nThat's memories in disk, but\nthere's also memories in RAM.\n\n248\n00:11:48.065 --> 00:11:50.145\nWe saw memory utilization a moment ago,\nbut\n\n249\n00:11:50.145 --> 00:11:52.745\nwe can use another utility\nto view memory utilization.\n\n250\n00:11:52.745 --> 00:11:56.505\nThere's the free command, which will\nshow you how much memory you have and\n\n251\n00:11:56.505 --> 00:11:58.555\nhow much is actually available, right?\n\n252\n00:11:58.555 --> 00:12:02.739\nI'm gonna do a free -h,\ncuz that'll make it human readable again.\n\n253\n00:12:02.739 --> 00:12:04.490\nI like that, it's a little bit easier.\n\n254\n00:12:04.490 --> 00:12:07.940\nAnd let me just show you this command,\ncuz it can be a little tricky sometimes.\n\n255\n00:12:07.940 --> 00:12:09.590\nWhen I look at my system,\n\n256\n00:12:09.590 --> 00:12:12.720\nsometimes it may look like you're\nrunning out of memory when you're not.\n\n257\n00:12:12.720 --> 00:12:16.040\nMy system has 31 gigs of memory, it says.\n\n258\n00:12:16.040 --> 00:12:20.300\nAnd then I'm using 1.3 gigs,\nand then free is 23 gigs.\n\n259\n00:12:21.490 --> 00:12:23.088\nWell, that doesn't quite add up, does it?\n\n260\n00:12:23.088 --> 00:12:23.791\n&gt;&gt; Uh-uh.\n\n261\n00:12:23.791 --> 00:12:29.974\n&gt;&gt; 23 gigs plus another 1.3 that's 24.3\ngigs, not 31, so what happened, right?\n\n262\n00:12:29.974 --> 00:12:34.550\nWell, what happens is most operating\nsystems do caching, right?\n\n263\n00:12:34.550 --> 00:12:38.430\nThey cache information in memory and\nhold it, in case I need it again.\n\n264\n00:12:38.430 --> 00:12:41.010\nAnd if I need it, it's already there\nwaiting for me, I can grab it and\n\n265\n00:12:41.010 --> 00:12:42.310\nI can use it, right?\n\n266\n00:12:42.310 --> 00:12:44.500\nIf I don't need it,\nif I need to use it for something else,\n\n267\n00:12:44.500 --> 00:12:46.780\nit'll overwrite that with the new data,\nright?\n\n268\n00:12:46.780 --> 00:12:49.020\nSo that's that missing memory\nthat's showing up right there.\n\n269\n00:12:49.020 --> 00:12:51.080\nSo sometimes it can look\nlike you're missing memory,\n\n270\n00:12:51.080 --> 00:12:54.350\nbut it's actually available, it's just\ncached and being held there, right?\n\n271\n00:12:54.350 --> 00:12:57.581\nSo while it's telling me\nthat I've got 23 gigs free,\n\n272\n00:12:57.581 --> 00:13:00.002\nI've actually got 29 gigs available.\n\n273\n00:13:00.002 --> 00:13:05.256\nAnd 29 Plus 1.3, that gets us closer to\nthat 31 gigs where I'm supposed to be.\n\n274\n00:13:05.256 --> 00:13:06.490\n&gt;&gt; There it is.\n\n275\n00:13:06.490 --> 00:13:08.660\n&gt;&gt; Now, on the performance side,\n\n276\n00:13:08.660 --> 00:13:12.470\nthe one that I really watch\nis this guy right here, okay?\n\n277\n00:13:12.470 --> 00:13:16.040\nMy laptop has 32 gigs of memory,\nthat's plenty of memory, right?\n\n278\n00:13:16.040 --> 00:13:17.520\nBut what happens if I run out?\n\n279\n00:13:17.520 --> 00:13:21.360\nIf I run out of memory,\nI'll start swapping to hard drive.\n\n280\n00:13:21.360 --> 00:13:25.260\nAnd I've got 15 gigs of swap memory\nsitting right there, that I can use.\n\n281\n00:13:25.260 --> 00:13:29.410\nBut your hard drive is slower than your\nRAM, so you don't want that to happen.\n\n282\n00:13:29.410 --> 00:13:30.520\nIf you're swapping the hard drive,\n\n283\n00:13:30.520 --> 00:13:33.300\nthat means you need to add more\nmemory to your computer, right?\n\n284\n00:13:33.300 --> 00:13:40.060\nWell, I can see right here, my swap is\n15 gigs and I've used zero bytes of it.\n\n285\n00:13:40.060 --> 00:13:45.250\nThat's perfect, as long as I keep seeing\nthat zero there, I'm happy, right?\n\n286\n00:13:45.250 --> 00:13:48.310\nIf I'm just one time,\ndoing something that uses a lot of memory,\n\n287\n00:13:48.310 --> 00:13:49.690\nI might see this start to get used.\n\n288\n00:13:49.690 --> 00:13:53.050\nBut if I'm regularly seeing\nthat swap space being used,\n\n289\n00:13:53.050 --> 00:13:55.110\nit means I need to add\nmore memory to the system.\n\n290\n00:13:55.110 --> 00:13:56.560\nSo easy way to tell,\n\n291\n00:13:56.560 --> 00:13:59.820\nyou can see it right here, I kinda\nspot that [INAUDIBLE] to adjust it.\n\n292\n00:13:59.820 --> 00:14:02.734\nYou definitely want that swap, because if\nyou didn't have it when you ran out of\n\n293\n00:14:02.734 --> 00:14:04.390\nregular RAM, your system might lock up.\n\n294\n00:14:04.390 --> 00:14:06.660\nYour system is not happy\nwhen it runs out of memory.\n\n295\n00:14:06.660 --> 00:14:09.532\nSo having that swap gives you\nthat insulating buffer, but\n\n296\n00:14:09.532 --> 00:14:13.416\nonce it's there you just don't wanna\nuse it, unless you absolutely have to.\n\n297\n00:14:13.416 --> 00:14:17.234\nSo those are all different ways that\nwe can monitor CPU, memory, disk,\n\n298\n00:14:17.234 --> 00:14:20.564\nall right here, with just quick\neasy command line utilities.\n\n299\n00:14:20.564 --> 00:14:23.222\n&gt;&gt; Dan,\nwhat if we need to get historical data?\n\n300\n00:14:23.222 --> 00:14:24.054\n&gt;&gt; Data!\n\n301\n00:14:24.054 --> 00:14:25.522\n[LAUGH]\n&gt;&gt; Data, data,\n\n302\n00:14:25.522 --> 00:14:26.190\nwe could-\n&gt;&gt; Tomatoe, tomatoe!\n\n303\n00:14:26.190 --> 00:14:30.019\n&gt;&gt; Do a whole debate on that one, but\nhistorically is a great point, right?\n\n304\n00:14:30.019 --> 00:14:32.828\nA lot of this data is just snapshots,\nright?\n\n305\n00:14:32.828 --> 00:14:33.978\nThings could change, right?\n\n306\n00:14:33.978 --> 00:14:35.575\nA user could be deleting files right now,\n\n307\n00:14:35.575 --> 00:14:38.820\nand all these numbers I just showed you\non the disk, are no longer accurate.\n\n308\n00:14:38.820 --> 00:14:39.990\nOr CPU and memory,\n\n309\n00:14:39.990 --> 00:14:43.900\nmaybe I just happened to be launching\nan application when I ran the top command.\n\n310\n00:14:43.900 --> 00:14:46.440\nAnd so now that data is skewed and\nit's wrong.\n\n311\n00:14:46.440 --> 00:14:48.110\nSo most of this,\n\n312\n00:14:48.110 --> 00:14:53.260\nany good statistician will tell you,\nyou never just take one sample of data.\n\n313\n00:14:53.260 --> 00:14:56.330\nYou need multiple samples,\nso you can compare.\n\n314\n00:14:56.330 --> 00:14:58.300\nAnd most of these utilities don't do that.\n\n315\n00:14:58.300 --> 00:15:01.060\nSo all the utilities I've shown you so\nfar, are really just good for\n\n316\n00:15:01.060 --> 00:15:05.690\npoint in time statistics,\njust grabbing data real quick, okay?\n\n317\n00:15:05.690 --> 00:15:09.000\nBut there is another utility we\ncan use to gather historical data.\n\n318\n00:15:09.000 --> 00:15:12.060\nAnd it's more than likely\non your system already.\n\n319\n00:15:12.060 --> 00:15:15.398\nThere's a utility called SAR,\nS A R, right?\n\n320\n00:15:15.398 --> 00:15:18.110\nThe System Activity Reporter.\n\n321\n00:15:18.110 --> 00:15:22.940\nAnd the SAR will let you view historical\ndata, and put it in perspective.\n\n322\n00:15:22.940 --> 00:15:25.950\nYou take multiple samples, and\nyou get averages across, and\n\n323\n00:15:25.950 --> 00:15:27.410\nyou get that better data.\n\n324\n00:15:27.410 --> 00:15:31.160\nNow, let's assume for\na moment that you don't have it, right?\n\n325\n00:15:31.160 --> 00:15:34.080\nIt is installed by\ndefault on most systems.\n\n326\n00:15:34.080 --> 00:15:38.130\nBut if you don't have it,\nit's a part of the sysstat package.\n\n327\n00:15:38.130 --> 00:15:42.300\nSo if you need to install it; you can do,\nsudo yum install or\n\n328\n00:15:42.300 --> 00:15:45.230\ndnf install, sudo apt-install,\ndepending on your distro.\n\n329\n00:15:45.230 --> 00:15:49.846\nI'll say sudo yum install sysstat,\nall right?\n\n330\n00:15:49.846 --> 00:15:53.440\nSo I wanna install that package, and\non my system, it's already there.\n\n331\n00:15:53.440 --> 00:15:56.510\nOn yours, it should be, but if it isn't,\nthis will get it installed.\n\n332\n00:15:56.510 --> 00:16:00.420\nAnd once it's installed, it's\na service that runs in the background.\n\n333\n00:16:00.420 --> 00:16:02.562\nIt's a service that's\ncollecting that data,\n\n334\n00:16:02.562 --> 00:16:04.760\neven while you're not doing anything.\n\n335\n00:16:04.760 --> 00:16:07.560\nSo you need to enable it,\nand get it started.\n\n336\n00:16:07.560 --> 00:16:11.991\nSo I'm gonna say systemctl enable sysstat,\nright, so\n\n337\n00:16:11.991 --> 00:16:17.540\nwe're gonna enable that service and\nthen I'm gonna start it.\n\n338\n00:16:17.540 --> 00:16:20.720\nAnd these commands would\nthe same on Ubuntu or Fedora.\n\n339\n00:16:20.720 --> 00:16:23.376\nThe install command is different but\nthese commands are the same.\n\n340\n00:16:23.376 --> 00:16:27.408\nSo now I've got that service started and\nwhat its doing?\n\n341\n00:16:27.408 --> 00:16:31.438\nOkay, well it's running in the background,\nand its collecting data.\n\n342\n00:16:31.438 --> 00:16:34.685\nNow it's collecting data on all\nsorts of different things, on disk,\n\n343\n00:16:34.685 --> 00:16:36.069\non CPU, on network, right.\n\n344\n00:16:36.069 --> 00:16:39.666\nThe information that I haven't even shown\nyou a way to monitor network yet, right.\n\n345\n00:16:39.666 --> 00:16:42.173\nSo this utility is gathering that data,\nand\n\n346\n00:16:42.173 --> 00:16:47.007\nit uses a configuration file to determine\nwhat it's doing and then how it's doing.\n\n347\n00:16:47.007 --> 00:16:53.331\nAnd if you go into /etc what it does,\nis it leverages cron.d, right.\n\n348\n00:16:53.331 --> 00:16:57.070\nThe cron service,\nwhich run things on a schedule, and\n\n349\n00:16:57.070 --> 00:17:02.531\ninside of cron.d you should see where\nit created a file called sysstat, okay.\n\n350\n00:17:02.531 --> 00:17:04.534\nAnd if I take a look at that file,\n\n351\n00:17:04.534 --> 00:17:07.884\nmost of the lines in here\nare actually commented out.\n\n352\n00:17:07.884 --> 00:17:12.220\nIt looks like there's a bunch of stuff,\nbut there's really only one line that I\n\n353\n00:17:12.220 --> 00:17:15.344\ntruly care about and\nthat's this guy right here, okay.\n\n354\n00:17:15.344 --> 00:17:23.400\nAnd what it says is the root user is\ncalling the sa1 command every ten minutes.\n\n355\n00:17:23.400 --> 00:17:28.420\nSo every ten minutes, it's running sa1,\nand it's gathering that data.\n\n356\n00:17:28.420 --> 00:17:31.640\nOkay, I can change that,\nI can make it run more frequently.\n\n357\n00:17:31.640 --> 00:17:34.330\nI can make it run every one minute or\nevery one second, or\n\n358\n00:17:34.330 --> 00:17:36.620\nhowever often I wanna do sampling, right.\n\n359\n00:17:36.620 --> 00:17:40.680\nBut by default, it's gathering data\nevery ten minutes, and it's running.\n\n360\n00:17:40.680 --> 00:17:44.970\nAnd I can run it for months or years and\nevery ten minutes it's gathering data.\n\n361\n00:17:44.970 --> 00:17:47.507\nAnd once it gathers, it puts it in\na little database that we can query,\n\n362\n00:17:47.507 --> 00:17:50.015\nwe can generate information, and\nview it, and look at it and stuff.\n\n363\n00:17:50.015 --> 00:17:53.128\nBut it's running and doing that,\nso we could modify this job and\n\n364\n00:17:53.128 --> 00:17:57.140\nchange it to make it gather data more\nfrequently but I don't normally do that.\n\n365\n00:17:57.140 --> 00:18:00.390\nEvery ten minutes is actually a pretty\ngood number for normal monitoring.\n\n366\n00:18:00.390 --> 00:18:04.370\nAnd if I'm having trouble,\nthen I usually bump the number up and\n\n367\n00:18:04.370 --> 00:18:06.030\nI'll show you a way to do\nthat kind of temporarily.\n\n368\n00:18:06.030 --> 00:18:06.990\nWhere you can bump the number up and\n\n369\n00:18:06.990 --> 00:18:10.570\nmonitor much more frequently to\nget a better view short-term.\n\n370\n00:18:10.570 --> 00:18:12.680\nBut long term,\nevery ten minutes is pretty good.\n\n371\n00:18:12.680 --> 00:18:15.620\nIf you go too short,\nyou end up with a ton of data, right.\n\n372\n00:18:15.620 --> 00:18:17.940\nThe log values can really grow,\nand grow, and grow, and\n\n373\n00:18:17.940 --> 00:18:20.530\nthen you've got disk space\nproblems just from your log.\n\n374\n00:18:20.530 --> 00:18:22.200\nSo we do need to be careful there.\n\n375\n00:18:22.200 --> 00:18:26.720\nBut it's gonna collect that data,\nit's gonna run and harvest it.\n\n376\n00:18:26.720 --> 00:18:29.690\nAnd now I've got historical\ndata that I can view.\n\n377\n00:18:31.060 --> 00:18:33.814\n&gt;&gt; So now that we've gathered the data,\ndata.\n\n378\n00:18:33.814 --> 00:18:36.880\n&gt;&gt; [LAUGH]\n&gt;&gt; [LAUGH] I typically say data,\n\n379\n00:18:36.880 --> 00:18:37.773\nI don't know why is data.\n\n380\n00:18:37.773 --> 00:18:41.270\nBut now that we've gathered the data,\nhow do we view the data?\n\n381\n00:18:41.270 --> 00:18:43.090\n&gt;&gt; All right, so it's trapped, right?\n\n382\n00:18:43.090 --> 00:18:45.190\nThe data's hidden away in this\ndatabase somewhere, right.\n\n383\n00:18:45.190 --> 00:18:47.660\nWell, we use the sar command\nto be able to view it.\n\n384\n00:18:47.660 --> 00:18:50.648\nAnd that's one of the reasons why I\nwanted to use my laptop is that it's been\n\n385\n00:18:50.648 --> 00:18:52.890\ngathering data for weeks,\nand it's got it all stored.\n\n386\n00:18:52.890 --> 00:18:55.440\nAnd I want to view it and\nlook at that information.\n\n387\n00:18:55.440 --> 00:18:58.760\nIf I'd done this on a brand new machine\nit doesn't have much data yet, does it?\n\n388\n00:18:58.760 --> 00:19:02.660\nIf I'm sampling every ten minutes, I might\nhave one data set right now, I need more.\n\n389\n00:19:02.660 --> 00:19:05.480\nSo on my laptop I have days\nworth of data queued up.\n\n390\n00:19:05.480 --> 00:19:09.370\nSo, what I can do is I can use\nthat sar utility and I can say,\n\n391\n00:19:09.370 --> 00:19:12.310\nsar, and then I tell it what I wanna view.\n\n392\n00:19:12.310 --> 00:19:16.000\nMaybe I wanna view CPU usage,\nright, so I can say sar -u.\n\n393\n00:19:16.000 --> 00:19:20.340\nAnd when I run that, it's gonna show\nme all the samples that it's taken.\n\n394\n00:19:20.340 --> 00:19:26.630\nAnd so I can see all these samples,\nright, and it's going back to midnight.\n\n395\n00:19:26.630 --> 00:19:28.910\nAnd so\nI can look at all that information here,\n\n396\n00:19:28.910 --> 00:19:31.740\nand then at the bottom\nI can get an average.\n\n397\n00:19:31.740 --> 00:19:37.560\nIt averages out all of the samples, so\nI can see what my user CPU load and\n\n398\n00:19:37.560 --> 00:19:40.910\nmy system CPU load was, and\nmy idle time, and get an idea.\n\n399\n00:19:40.910 --> 00:19:42.560\nAre there peaks and valleys?\n\n400\n00:19:42.560 --> 00:19:45.830\nMaybe the server was really busy at\none point and then slow at another,\n\n401\n00:19:45.830 --> 00:19:46.940\nI can see those.\n\n402\n00:19:46.940 --> 00:19:48.078\nI can identify peak time.\n\n403\n00:19:48.078 --> 00:19:51.310\nThese are times I might need to add\nadditional servers, or whatever.\n\n404\n00:19:51.310 --> 00:19:55.290\nI get that data spread out over time,\nright, historical data with sampling.\n\n405\n00:19:55.290 --> 00:19:58.280\nThat's really important, and that was CPU.\n\n406\n00:19:58.280 --> 00:20:01.550\nIf I wanted to do disk activity,\nI could do sar -d.\n\n407\n00:20:01.550 --> 00:20:04.458\nAnd when I run that,\nnow I'm seeing disk io and\n\n408\n00:20:04.458 --> 00:20:08.124\nmy windows not quite wide enough\nto make that look normal.\n\n409\n00:20:08.124 --> 00:20:09.752\nYeah it's gonna word\nwrap no matter what I do.\n\n410\n00:20:09.752 --> 00:20:12.095\nBut what I'm seeing here\nare the different devices,\n\n411\n00:20:12.095 --> 00:20:14.540\nI've got more than one storage device,\nright.\n\n412\n00:20:14.540 --> 00:20:19.900\nSo there's device A, device 253 and I've\ngot three partitions inside of device 253.\n\n413\n00:20:19.900 --> 00:20:22.830\nAnd so it's laying them out and\nshowing me that information,\n\n414\n00:20:22.830 --> 00:20:27.770\nthe reads per second the writes per\nsecond, the average queue size.\n\n415\n00:20:27.770 --> 00:20:30.880\nThe queue, that's how long one\napplication had to wait to get to\n\n416\n00:20:30.880 --> 00:20:32.920\ndisk because another\napplication was using it.\n\n417\n00:20:32.920 --> 00:20:36.200\nThat's a key principle right there,\nwe wanna watch that queue size,\n\n418\n00:20:36.200 --> 00:20:40.250\ncuz if it starts to grow too big it\nmeans we've got a disk bottleneck.\n\n419\n00:20:40.250 --> 00:20:43.340\nReal easy way to spot that, and you might\nfind that it's only bottlenecking at\n\n420\n00:20:43.340 --> 00:20:45.870\ncertain times, and\nthe rest of the time it's fine.\n\n421\n00:20:45.870 --> 00:20:49.000\nIn my case, it doesn't look like\nI've ever hit even the number one,\n\n422\n00:20:49.000 --> 00:20:51.470\nso my queue is not a problem.\n\n423\n00:20:51.470 --> 00:20:54.100\nBut we can spot that information\nright there and see it.\n\n424\n00:20:54.100 --> 00:21:00.714\nThe sar gives us a lot of good data, let's\nsee, I showed you CPU, I showed you disk.\n\n425\n00:21:00.714 --> 00:21:03.539\nLet's do network, cuz we haven't\nseen any network yet, right.\n\n426\n00:21:03.539 --> 00:21:08.300\nIf I run sar -n then I can view network.\n\n427\n00:21:08.300 --> 00:21:11.180\nNow it doesn't like sar -n by itself\nbecause there's several different\n\n428\n00:21:11.180 --> 00:21:12.870\nnetworking reports that we can provide.\n\n429\n00:21:12.870 --> 00:21:17.510\nSo, for example, the one that I\nnormally wanna do is the device report.\n\n430\n00:21:17.510 --> 00:21:20.600\nSo I'm gonna say give me the network\nperformance of the devices.\n\n431\n00:21:20.600 --> 00:21:23.920\nSee in the networking world,\nyou've got the networking hardware.\n\n432\n00:21:23.920 --> 00:21:26.140\nBut then you've got the protocol\nstack on top of it.\n\n433\n00:21:26.140 --> 00:21:29.030\nAnd so a lot of times I wanna\nmonitor the actual hardware and\n\n434\n00:21:29.030 --> 00:21:30.300\nthat's why we need to do that DEV.\n\n435\n00:21:30.300 --> 00:21:35.790\nSo I'll say sar -n DEV and\nnow I can look at the network interfaces,\n\n436\n00:21:35.790 --> 00:21:38.575\nand there's a bunch of network\ninterfaces that are being output here.\n\n437\n00:21:38.575 --> 00:21:41.650\nKinda like we saw with disk, so\nI probably wanna filter that a bit and\n\n438\n00:21:41.650 --> 00:21:43.280\nI'll usually just pipe that through grep.\n\n439\n00:21:43.280 --> 00:21:46.680\nThere is a command line modifier for\nsar I just am used to using grep.\n\n440\n00:21:46.680 --> 00:21:51.040\nSo I'll pipe it into grep and\nI'll look for enp3s0f1,\n\n441\n00:21:51.040 --> 00:21:53.780\nwhich is my Ethernet adapter.\n\n442\n00:21:53.780 --> 00:21:56.790\nAnd when I do that,\nnow I'm just seeing that Ethernet adapter.\n\n443\n00:21:56.790 --> 00:21:59.936\nAnd I can see how much it's been using,\nand\n\n444\n00:21:59.936 --> 00:22:03.358\nI can see the average\ndown there at the bottom.\n\n445\n00:22:03.358 --> 00:22:06.130\nAnd look at what my average bandwidth\nutilization has been, and so on.\n\n446\n00:22:06.130 --> 00:22:10.290\nSo I can get that data kind of laid\nout here in a format that's a little\n\n447\n00:22:10.290 --> 00:22:14.050\nmore understandable for us,\nand what we expect to see.\n\n448\n00:22:15.600 --> 00:22:17.890\nThere are additional\nreports that you can pull.\n\n449\n00:22:17.890 --> 00:22:22.020\nLike if I do eDEV instead,\nthat'll show me device errors.\n\n450\n00:22:22.020 --> 00:22:23.080\nSo if I'm looking for input and\n\n451\n00:22:23.080 --> 00:22:25.620\noutput errors on the interface\nI can pull those up.\n\n452\n00:22:25.620 --> 00:22:26.470\nAnd looking at mine,\n\n453\n00:22:26.470 --> 00:22:30.090\nI've got all zeros here, so I haven't\ngenerated any errors on the interface.\n\n454\n00:22:30.090 --> 00:22:32.430\nBut if your suspecting a faulty network,\nright,\n\n455\n00:22:32.430 --> 00:22:34.690\nif this is a server\ndeployed in the cloud and\n\n456\n00:22:34.690 --> 00:22:37.198\nyou cant even see the physical network,\nhere's a way we could check and see.\n\n457\n00:22:37.198 --> 00:22:39.040\nAm I getting interface errors?\n\n458\n00:22:39.040 --> 00:22:42.240\nBecause then it's probably not my fault\nit's probably the underlying hardware in\n\n459\n00:22:42.240 --> 00:22:43.540\nthat cloud of planets.\n\n460\n00:22:43.540 --> 00:22:47.080\nWe can start to spot that right there too.\n\n461\n00:22:47.080 --> 00:22:48.030\nAnd then lastly,\n\n462\n00:22:48.030 --> 00:22:52.520\nwhat I'm showing you here, this is all\npulling from that historical data right.\n\n463\n00:22:52.520 --> 00:22:56.271\nIf I was on a server, like a virtual\nmachine, and I just turned on sysstat,\n\n464\n00:22:56.271 --> 00:22:58.072\nit doesn't have historical data.\n\n465\n00:22:58.072 --> 00:23:00.687\nSo this doesn't really help me,\nso if I'm in a hurry and\n\n466\n00:23:00.687 --> 00:23:04.153\nI just want some real time data,\nyou can actually tell it to run real time.\n\n467\n00:23:04.153 --> 00:23:07.780\nJust like the top command, or\nnot top, no yeah, the top commander,\n\n468\n00:23:07.780 --> 00:23:09.301\nI had it right the first time.\n\n469\n00:23:09.301 --> 00:23:11.633\nSo, [LAUGH] like the top commander or\none of those guys,\n\n470\n00:23:11.633 --> 00:23:13.290\nwe can tell it to run real time.\n\n471\n00:23:13.290 --> 00:23:20.960\nSo what I could do is I could take like\nsar -n DEV, or even -u, or whatever.\n\n472\n00:23:20.960 --> 00:23:24.460\nAnd then after that,\nyou give it an interval to run.\n\n473\n00:23:24.460 --> 00:23:31.260\nI can tell it, hey, I want you to sample\nevery one second for ten times, right.\n\n474\n00:23:31.260 --> 00:23:34.690\nSo the first one is the interval,\nright, every one second.\n\n475\n00:23:34.690 --> 00:23:37.220\nAnd then the next one is repetitions, so\n\n476\n00:23:37.220 --> 00:23:40.490\nI'm gonna monitor every one second,\nten times, so for ten seconds.\n\n477\n00:23:40.490 --> 00:23:43.050\nAnd when I run that,\nit's now running in real time,\n\n478\n00:23:43.050 --> 00:23:47.160\nand I'm getting that output every second,\nfor ten times.\n\n479\n00:23:47.160 --> 00:23:51.990\nAnd then when it's done I'll get my\naverages at the end of it, there it is.\n\n480\n00:23:51.990 --> 00:23:53.820\nAnd so here's all my averages and\nI can look at it.\n\n481\n00:23:53.820 --> 00:23:58.200\nSo even if I just turned\nsysstat on right now,\n\n482\n00:23:58.200 --> 00:24:01.800\nI can run a real time get that data and\nit's still useful.\n\n483\n00:24:01.800 --> 00:24:04.910\nAnd it's still better than\nusing something like top.\n\n484\n00:24:04.910 --> 00:24:09.550\nWhere I'm just seeing the point in time,\nthe current real time data.\n\n485\n00:24:09.550 --> 00:24:12.260\nHere, it's an aggregate of\ndata spread over time, right.\n\n486\n00:24:12.260 --> 00:24:15.710\nSo even though this was only ten seconds,\nat least that was a better window of time\n\n487\n00:24:15.710 --> 00:24:18.510\ncuz it helps to trim out the outliers and\nthe other information.\n\n488\n00:24:18.510 --> 00:24:21.166\nSo sysstat is really cool,\nsysstat is the demon,\n\n489\n00:24:21.166 --> 00:24:23.392\nthe service that runs in the background.\n\n490\n00:24:23.392 --> 00:24:27.030\nYou gotta start that, and\nthen sar is how we interact with it.\n\n491\n00:24:27.030 --> 00:24:30.197\nSo for me,\nwhen I'm on a resurfer performance,\n\n492\n00:24:30.197 --> 00:24:32.140\nsar is kinda my go to utility.\n\n493\n00:24:32.140 --> 00:24:34.812\nThis is the way that I look at\nhow my server is performing.\n\n494\n00:24:34.812 --> 00:24:36.950\n&gt;&gt; Don, once again, excellent information.\n\n495\n00:24:36.950 --> 00:24:39.910\nBecoming a Linux server administrator\nmonitoring performance,\n\n496\n00:24:39.910 --> 00:24:41.860\nany last words, sir?\n\n497\n00:24:41.860 --> 00:24:45.690\n&gt;&gt; Main thing, remember that if you're\ngoing to use sar, get it turned on.\n\n498\n00:24:45.690 --> 00:24:49.557\nAnd get your cron jobs set up, so you're\nsampling at the right amount of data.\n\n499\n00:24:49.557 --> 00:24:53.129\nDon't just assume it's there, right,\nbecause otherwise, if you wanna look at\n\n500\n00:24:53.129 --> 00:24:56.304\ndata from a day ago, or a week ago,\nit's not there unless you turn it on.\n\n501\n00:24:56.304 --> 00:24:59.540\nSo get that set up,\nsysstat is the package you wanna look for.\n\n502\n00:24:59.540 --> 00:25:01.844\nIt's probably installed by default, and\n\n503\n00:25:01.844 --> 00:25:06.069\nthen there are a virtual cornucopia of\nother monitoring solutions out there.\n\n504\n00:25:06.069 --> 00:25:09.030\nI'm trying to focus on ones you're\ndefinitely gonna have available.\n\n505\n00:25:09.030 --> 00:25:13.641\nBut there's many, many third party\nsolutions like Zabbix, and MRTG, and\n\n506\n00:25:13.641 --> 00:25:17.113\nPRTG, and all those other\ncrazy ones that are out there.\n\n507\n00:25:17.113 --> 00:25:19.593\nWhich do a great job of\nmonitoring performance and\n\n508\n00:25:19.593 --> 00:25:23.055\nshowing your CPU load if you set\nup that additional infrastructure.\n\n509\n00:25:23.055 --> 00:25:25.720\nBut even if you have no\nadditional infrastructure you've\n\n510\n00:25:25.720 --> 00:25:27.200\ngot the tools right here to use.\n\n511\n00:25:27.200 --> 00:25:31.970\nJust explore them, learn them, get used to\nthem, and in the end, make use of them.\n\n512\n00:25:31.970 --> 00:25:34.920\n&gt;&gt; Thanks again, Don,\nbecoming a Linux server administrator.\n\n513\n00:25:34.920 --> 00:25:38.160\nThere's a lot of content this series,\nmake sure you watch every video,\n\n514\n00:25:38.160 --> 00:25:39.260\nyou'll be glad you did.\n\n515\n00:25:40.260 --> 00:25:42.230\nAnd thank you for watching ITPro TV.\n\n516\n00:25:42.230 --> 00:25:45.850\nRemember, a good IT pro is\nalways learning, I'm Zack Memos.\n\n517\n00:25:45.850 --> 00:25:46.670\n&gt;&gt; And I'm Don Pezet.\n\n518\n00:25:46.670 --> 00:25:49.033\n&gt;&gt; And we'll see you very soon.\n\n519\n00:25:49.033 --> 00:25:54.973\n[MUSIC]\n\n520\n00:25:54.973 --> 00:25:57.779\n&gt;&gt; Thank you for watching ITPRO.TV.\n\n",
          "vimeoId": "226153744"
        }
      ],
      "title": "Understanding Server Administration"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach discuss options in regards to configuring networking, restarting network service, SYSTEMCTL, configuring adapters, configuration using interface scripts, SYSCONFIG, configuration using global settings, configurations that apply to all NICs, name lookups, NetworkManager (NMCLI), and configuring using NetworkManager.",
          "length": "1800",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-2-1-configuring_networking-071917-PGM.00_29_44_08.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-2-1-configuring_networking-071917-PGM.00_29_44_08.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-2-1-configuring_networking-071917-PGM.00_29_44_08.Still001-sm.jpg",
          "title": "Configure Networking",
          "transcript": "WEBVTT\n\n1\n00:00:00.001 --> 00:00:05.351\nWelcome to ITProvTV,\nI'm your host Don Pezet.\n\n2\n00:00:05.351 --> 00:00:11.922\n[CROSSTALK]\n&gt;&gt; You're watching ITProTV.\n\n3\n00:00:11.922 --> 00:00:14.294\n&gt;&gt; Hello, and thank you for\nchoosing ITProTV,\n\n4\n00:00:14.294 --> 00:00:16.172\nhelping you learn wherever you go.\n\n5\n00:00:16.172 --> 00:00:17.678\nI'm your host, Zach Memos,\n\n6\n00:00:17.678 --> 00:00:20.890\nas we continue on with Becoming\na Linux Server Administrator.\n\n7\n00:00:21.990 --> 00:00:25.640\n&gt;&gt; This topic right now is\nconfiguring networking.\n\n8\n00:00:25.640 --> 00:00:26.756\nWho's bringing you this information?\n\n9\n00:00:26.756 --> 00:00:28.004\nNot me, no.\n\n10\n00:00:28.004 --> 00:00:29.942\nThe man, the myth, the legend Don Pezet.\n\n11\n00:00:29.942 --> 00:00:31.974\nDon, nice to have you with us,\nthanks for joining us.\n\n12\n00:00:31.974 --> 00:00:33.158\n&gt;&gt; Thanks for having me, Zach.\n\n13\n00:00:33.158 --> 00:00:33.668\nAnd yeah,\n\n14\n00:00:33.668 --> 00:00:37.950\nwe're gonna be jumping right back into\nthe world of Linux server administration.\n\n15\n00:00:37.950 --> 00:00:38.950\nAnd in this particular episode,\n\n16\n00:00:38.950 --> 00:00:41.590\nwe're gonna take a look at\nconfiguring networking, right.\n\n17\n00:00:41.590 --> 00:00:43.620\nWe need to get our network adapters up and\nrunning.\n\n18\n00:00:43.620 --> 00:00:47.610\nThey need IP addresses, and subnet masks,\ndefault routes, all the various things\n\n19\n00:00:47.610 --> 00:00:49.560\nthat we need to configure to\nget our systems communicating.\n\n20\n00:00:49.560 --> 00:00:53.720\nBecause it is a rare day that we\nimplement systems now that are not\n\n21\n00:00:53.720 --> 00:00:54.770\nconnected to a network.\n\n22\n00:00:54.770 --> 00:00:57.762\nSo this is a really important step\nin rolling out our systems into our\n\n23\n00:00:57.762 --> 00:00:58.980\nproduction environment.\n\n24\n00:00:58.980 --> 00:01:01.680\nSo that's what we're gonna be taking\nlook at right here, in this episode.\n\n25\n00:01:01.680 --> 00:01:05.475\n&gt;&gt; Well Dan, if we've already\nconfigured network in the install,\n\n26\n00:01:05.475 --> 00:01:07.201\nwhat else would we need to do?\n\n27\n00:01:07.201 --> 00:01:08.790\n&gt;&gt; Well yeah, that's true.\n\n28\n00:01:08.790 --> 00:01:12.420\nSo if you've been watching all these\nepisodes, and started with installation,\n\n29\n00:01:12.420 --> 00:01:15.770\nright, in the installation it\nasked us to pick an IP address.\n\n30\n00:01:15.770 --> 00:01:20.530\nIt asked us to assign a subnet mask and\na default gateway.\n\n31\n00:01:20.530 --> 00:01:23.120\nAnd we clicked Next on through that,\nand it's already configured.\n\n32\n00:01:23.120 --> 00:01:26.450\nSo in the example of the server\nI've been using this whole series,\n\n33\n00:01:26.450 --> 00:01:29.160\nit's already configured for\na network, right?\n\n34\n00:01:29.160 --> 00:01:31.320\nWell, that's true, but it's also not true.\n\n35\n00:01:31.320 --> 00:01:34.140\nIt's true in that it does some\nbasic network configuration.\n\n36\n00:01:34.140 --> 00:01:38.200\nIt's not true in that it doesn't\nhave anything advanced, and\n\n37\n00:01:38.200 --> 00:01:41.410\nI only configured one network adapter.\n\n38\n00:01:41.410 --> 00:01:43.440\nWhat if I have more than\none network adapter?\n\n39\n00:01:43.440 --> 00:01:44.804\nRight, let met show you here on my server.\n\n40\n00:01:44.804 --> 00:01:48.070\nSo my server actually has four\ndifferent network adapters in it.\n\n41\n00:01:48.070 --> 00:01:51.690\nA lot of servers will either have\ntwo network adapters or four,\n\n42\n00:01:51.690 --> 00:01:53.180\nthat's very common today.\n\n43\n00:01:53.180 --> 00:01:56.040\nI can't remember the last time I saw\na server that only had one network jack on\n\n44\n00:01:56.040 --> 00:01:57.490\nit, so it's pretty rare.\n\n45\n00:01:57.490 --> 00:02:00.740\nBut if you go in and run, well, we've\ngot a few different commands we can run.\n\n46\n00:02:00.740 --> 00:02:07.400\nThe old school command is ifconfig, which\nis the interface configuration command.\n\n47\n00:02:07.400 --> 00:02:10.990\nAnd this command is available\non most UNIX systems.\n\n48\n00:02:10.990 --> 00:02:14.120\nSo it's usually what I go to,\ncuz I know this command is gonna work.\n\n49\n00:02:14.120 --> 00:02:15.760\nBut that's not entirely true anymore.\n\n50\n00:02:15.760 --> 00:02:17.880\nWe're starting to see some\nnew commands replace this.\n\n51\n00:02:17.880 --> 00:02:20.800\nBut ifconfig will show me my adapters.\n\n52\n00:02:20.800 --> 00:02:25.253\nAnd when I look,\nI can see where I've got ens33, right?\n\n53\n00:02:25.253 --> 00:02:29.830\nAnd it's got an IP address,\nit's got a subnet mask.\n\n54\n00:02:29.830 --> 00:02:32.330\nIt's got a gateway, it's configured.\n\n55\n00:02:32.330 --> 00:02:34.470\nThat's what was set up during my install.\n\n56\n00:02:34.470 --> 00:02:39.165\nBut I've also got ens36, ens37, ens38.\n\n57\n00:02:39.165 --> 00:02:42.340\nI've got three more network\nadapters in there, right?\n\n58\n00:02:42.340 --> 00:02:44.410\nAnd they were not configured\nduring the install.\n\n59\n00:02:44.410 --> 00:02:45.930\nSo they don't have IP addresses.\n\n60\n00:02:45.930 --> 00:02:48.840\nThey don't have subnet masks,\nit's incomplete.\n\n61\n00:02:48.840 --> 00:02:53.350\nNow that's very common, after an install\nit's only got one adapter configured.\n\n62\n00:02:53.350 --> 00:02:56.737\nThe other scenario where we'd\nneed to do this configuration is,\n\n63\n00:02:56.737 --> 00:02:59.210\nmaybe I needed a driver for\nmy network adapter.\n\n64\n00:02:59.210 --> 00:03:02.070\nAnd so the network adapter didn't\nshow up during the install, so\n\n65\n00:03:02.070 --> 00:03:03.530\nit couldn't be configured.\n\n66\n00:03:03.530 --> 00:03:05.424\nAnd you finished the install and\nthere you are, no adapters are configured.\n\n67\n00:03:05.424 --> 00:03:07.410\nAnd now we've gotta do it by hand.\n\n68\n00:03:07.410 --> 00:03:10.060\nAnd a third scenario would be\nif you do a minimal install.\n\n69\n00:03:10.060 --> 00:03:13.880\nA lot of minimal installs won't\nconfigure a network adapter.\n\n70\n00:03:13.880 --> 00:03:15.770\nSo now they boot up, and\nthe network's not even set up.\n\n71\n00:03:15.770 --> 00:03:16.870\nYou've gotta go in and do it.\n\n72\n00:03:16.870 --> 00:03:20.160\nSo those are all scenarios where we might\nneed to get in there and configure.\n\n73\n00:03:20.160 --> 00:03:22.140\nAnd the command that I ran, that ifconfig,\n\n74\n00:03:22.140 --> 00:03:24.660\nI mentioned that we're seeing\nit start to get replaced.\n\n75\n00:03:24.660 --> 00:03:29.368\nIn new systems released in the last few\nyears and going forward in the future,\n\n76\n00:03:29.368 --> 00:03:31.880\nyou'll wanna use the ip command.\n\n77\n00:03:31.880 --> 00:03:34.840\nThe ip command also lets\nyou see interfaces.\n\n78\n00:03:34.840 --> 00:03:38.833\nOr so I can say something like,\nip addr, to see my IP addresses.\n\n79\n00:03:38.833 --> 00:03:41.137\nAnd it shows me my four interfaces.\n\n80\n00:03:41.137 --> 00:03:43.170\nActually, I have five if\nyou count the loopback.\n\n81\n00:03:43.170 --> 00:03:48.030\nAnd my four interfaces here, ens33 which\nhas a config, and then 36, 37, 38.\n\n82\n00:03:48.030 --> 00:03:50.315\nThese guys that are missing\na configuration,\n\n83\n00:03:50.315 --> 00:03:51.846\nbecause they don't have one.\n\n84\n00:03:51.846 --> 00:03:55.550\nSo I can see that, and\nI need to go in and start to work with it.\n\n85\n00:03:55.550 --> 00:03:59.332\nThe ip command is a lot more\npowerful than the old ifconfig.\n\n86\n00:03:59.332 --> 00:04:01.460\nThe ifconfig just showed\nyou about the interfaces.\n\n87\n00:04:01.460 --> 00:04:05.420\nBut ip, I can say ip route and\nit will show me my routing table.\n\n88\n00:04:05.420 --> 00:04:06.860\nAnd so\nI can see what my default routes are.\n\n89\n00:04:06.860 --> 00:04:10.008\nSo there's a lot more that you can do\nwith the ip command than ifconfig.\n\n90\n00:04:10.008 --> 00:04:12.270\nSo that's kinda the logical replacement.\n\n91\n00:04:12.270 --> 00:04:16.568\nAnd we're starting to see some systems\nthat don't ship with ifconfig any more.\n\n92\n00:04:16.568 --> 00:04:21.196\nIf you do a brand new install with,\nI believe it's CentOS 7,\n\n93\n00:04:21.196 --> 00:04:24.847\nwhere it has ip, but\nit doesn't have ifconfig.\n\n94\n00:04:24.847 --> 00:04:27.382\nSo just know that there's\ntwo different commands for\n\n95\n00:04:27.382 --> 00:04:31.170\nquickly viewing those adapters and seeing\nwhat it is that we need to configure.\n\n96\n00:04:32.250 --> 00:04:36.660\nNow it could be that we've already\nconfigured things, but we made changes and\n\n97\n00:04:36.660 --> 00:04:38.420\nthey just haven't taken effect yet.\n\n98\n00:04:38.420 --> 00:04:40.270\nSo maybe we don't really\nneed to configure anything.\n\n99\n00:04:40.270 --> 00:04:42.050\nWe just need to restart\nour networking stack.\n\n100\n00:04:42.050 --> 00:04:44.838\nMaybe I just installed a driver, and\nthen after I restart the networking stack,\n\n101\n00:04:44.838 --> 00:04:45.880\neverything works.\n\n102\n00:04:45.880 --> 00:04:47.580\nYou could reboot the whole server.\n\n103\n00:04:47.580 --> 00:04:50.290\nOr you could just restart\nthe networking service, right?\n\n104\n00:04:50.290 --> 00:04:54.990\nOn older systems that use upstart or an\ninit, then what you would do is you would\n\n105\n00:04:54.990 --> 00:04:59.560\nsay, service network restart, like that.\n\n106\n00:04:59.560 --> 00:05:01.360\nAnd that would restart the network stack.\n\n107\n00:05:01.360 --> 00:05:03.661\nBut most systems have\nmoved to systemd now.\n\n108\n00:05:03.661 --> 00:05:07.030\nAnd if you're on a systemd system,\nit's gonna look a little different.\n\n109\n00:05:07.030 --> 00:05:13.320\nWhat you're gonna do is say,\nsystemctl restart network.service.\n\n110\n00:05:13.320 --> 00:05:14.570\nLike that, okay?\n\n111\n00:05:14.570 --> 00:05:17.120\nAnd that will restart your\nnetworking subsystem.\n\n112\n00:05:17.120 --> 00:05:20.930\nAnd any changes that hadn't taken\neffect will now take effect, right?\n\n113\n00:05:20.930 --> 00:05:22.780\nSo it might not be that I\nneed to configure something.\n\n114\n00:05:22.780 --> 00:05:24.330\nIt might already be configured.\n\n115\n00:05:24.330 --> 00:05:26.800\nI just need to restart and\nlet that kinda be detected.\n\n116\n00:05:26.800 --> 00:05:30.320\nSo those are ways that we can do that and\nkinda get it put in place.\n\n117\n00:05:30.320 --> 00:05:34.100\n&gt;&gt; So, how do we go about\nconfiguring those adapters?\n\n118\n00:05:34.100 --> 00:05:37.970\n&gt;&gt; Yeah, in my example,\na restart is not enough, right?\n\n119\n00:05:37.970 --> 00:05:38.820\nIt's not setup.\n\n120\n00:05:38.820 --> 00:05:41.910\nIf I take a look at that,\nI still dont have IPs.\n\n121\n00:05:41.910 --> 00:05:43.990\nI need to get things set up.\n\n122\n00:05:43.990 --> 00:05:47.050\nThere's a few different ways\nthese adapters can be managed.\n\n123\n00:05:47.050 --> 00:05:51.980\nBut in most systems,\neach adapter has its own interface script.\n\n124\n00:05:51.980 --> 00:05:55.640\nAnd the interface script defines\nexactly what its configuration is.\n\n125\n00:05:55.640 --> 00:06:01.544\nIf you wanna look at them,\nthey're in /etc/sysconfig/,\n\n126\n00:06:01.544 --> 00:06:05.298\nlet's see, it is network-scripts.\n\n127\n00:06:05.298 --> 00:06:07.430\nThat folder right there, okay.\n\n128\n00:06:07.430 --> 00:06:09.479\nAnd if you look in there,\nyou'll see a lot of stuff.\n\n129\n00:06:10.590 --> 00:06:13.940\nBut the main ones that we wanna look\nat are right at the very beginning,\n\n130\n00:06:13.940 --> 00:06:22.500\nthese guys here where it says\nifcfg-ens33 or ifcfg-lo.\n\n131\n00:06:22.500 --> 00:06:25.786\nRight, lo is my loopback adapter, and\nit just points right back at yourself.\n\n132\n00:06:25.786 --> 00:06:30.360\nBut ens33, that's the network card\nthat l configured during setup.\n\n133\n00:06:30.360 --> 00:06:32.520\nSo l can see it right there.\n\n134\n00:06:32.520 --> 00:06:36.843\nI don't have an ens36, or 37, or\n38, they don't have a script.\n\n135\n00:06:36.843 --> 00:06:39.380\nAnd with no script,\nthey're not configured.\n\n136\n00:06:39.380 --> 00:06:42.602\nSo when I restarted the network service,\nall I did was look in here to see which\n\n137\n00:06:42.602 --> 00:06:45.391\ninterfaces had a script, and\npulled the information out of them.\n\n138\n00:06:45.391 --> 00:06:46.831\nAnd off it goes, right?\n\n139\n00:06:46.831 --> 00:06:49.410\nAnd if they don't have a script,\nthey don't get configured.\n\n140\n00:06:49.410 --> 00:06:53.206\nSo if I wanna configure my other\ninterfaces, I need to create scripts for\n\n141\n00:06:53.206 --> 00:06:54.540\nthem, all right?\n\n142\n00:06:54.540 --> 00:07:00.690\nNow, one question that I usually get\nis why is called ens33, in my case?\n\n143\n00:07:00.690 --> 00:07:03.053\nCuz you'll see different names, right?\n\n144\n00:07:03.053 --> 00:07:06.218\nThis is in a virtual machine,\nthis particular system.\n\n145\n00:07:06.218 --> 00:07:10.711\nIf I were to switch back\nto my actual laptop and\n\n146\n00:07:10.711 --> 00:07:15.794\ntake a look at the same thing,\non my actual laptop,\n\n147\n00:07:15.794 --> 00:07:19.594\nmy interface is called enp3s0f1.\n\n148\n00:07:19.594 --> 00:07:21.916\nAll right, well, [LAUGH].\n\n149\n00:07:21.916 --> 00:07:22.821\n&gt;&gt; Yay!\n\n150\n00:07:22.821 --> 00:07:24.819\n&gt;&gt; So it starts with en, right?\n\n151\n00:07:24.819 --> 00:07:26.258\nAt least it's got that in common.\n\n152\n00:07:26.258 --> 00:07:29.556\nBut the whole rest of that thing,\nthat is just quite a mess.\n\n153\n00:07:29.556 --> 00:07:33.355\nAnd you'll see,\nwlp2so is another interface that I've got.\n\n154\n00:07:33.355 --> 00:07:35.340\nThese are valid interfaces on my laptop.\n\n155\n00:07:35.340 --> 00:07:37.250\nSo where are these names coming from?\n\n156\n00:07:37.250 --> 00:07:39.990\nWell, the names are made up of\na couple of different pieces.\n\n157\n00:07:39.990 --> 00:07:41.060\nSome of them you can kinda guess.\n\n158\n00:07:41.060 --> 00:07:43.420\nen, that's short for ethernet.\n\n159\n00:07:43.420 --> 00:07:46.360\nThat lets me know that that's\na physical network jack.\n\n160\n00:07:46.360 --> 00:07:48.311\nOn my laptop, I have a physical\nnetwork jack on the side.\n\n161\n00:07:48.311 --> 00:07:52.931\nAnd that's what I'm plugged into, and\nit's an en, an ethernet interface.\n\n162\n00:07:52.931 --> 00:07:57.683\nOn my virtual machine,\nit has an ethernet interface.\n\n163\n00:07:57.683 --> 00:08:00.043\nSo en, blah, blah, blah,\nright, so that's what en is.\n\n164\n00:08:00.043 --> 00:08:02.152\nAnd wl, that's wireless, right?\n\n165\n00:08:02.152 --> 00:08:07.440\nSo this is a wireless adapter that I'm\nconnected with here, wlp2s0, whatever.\n\n166\n00:08:07.440 --> 00:08:08.531\nSo that wl's wireless.\n\n167\n00:08:08.531 --> 00:08:10.980\nSo en and wl,\npretty good indicators there.\n\n168\n00:08:12.020 --> 00:08:14.310\nYou might see lo for LoopBack.\n\n169\n00:08:14.310 --> 00:08:16.800\nI've got vi for\nsome of my virtual interfaces.\n\n170\n00:08:16.800 --> 00:08:19.610\nI'm running VMware Workstations, so\nI have some virtual interfaces in place.\n\n171\n00:08:19.610 --> 00:08:22.072\nYou might see ww, which are for WAN cards,\n\n172\n00:08:22.072 --> 00:08:25.296\nlike if you have a wireless\ncellular card or something.\n\n173\n00:08:25.296 --> 00:08:28.841\nIt's not very common, but you might have\none of those, so you'll see that in place.\n\n174\n00:08:28.841 --> 00:08:33.827\nNow the next part, though, see how I've\ngot a p here versus in the virtual machine\n\n175\n00:08:33.827 --> 00:08:36.490\nwhere I had an s, that kind of thing?\n\n176\n00:08:36.490 --> 00:08:39.147\nThe p means it's a pci card, right?\n\n177\n00:08:39.147 --> 00:08:42.020\nThis is a pci card that's\nactually my system.\n\n178\n00:08:42.020 --> 00:08:43.350\nWell, I've got a laptop.\n\n179\n00:08:43.350 --> 00:08:45.640\nUntil it's integrated into the system,\nit's not a card.\n\n180\n00:08:45.640 --> 00:08:47.080\nI can't take it out.\n\n181\n00:08:47.080 --> 00:08:51.544\nSo it's soldered into the motherboard but\nit's soldered under the pci bus, so enp or\n\n182\n00:08:51.544 --> 00:08:54.480\nwlp is telling me it's on the pci bus.\n\n183\n00:08:54.480 --> 00:09:00.690\nIn my virtual machine it shows as ens and\nthat s means that it's a hot plug device.\n\n184\n00:09:00.690 --> 00:09:02.767\nAnd a hot plug device is usually a USB,\nright?\n\n185\n00:09:02.767 --> 00:09:06.379\nWell, I know my virtual machine is not\nactually a USB, but in a virtual machine\n\n186\n00:09:06.379 --> 00:09:10.430\nyou don't truly have a pci bus, and so it\njust adds it like any other USB adapter.\n\n187\n00:09:10.430 --> 00:09:11.972\nSo it kind of shows it that way.\n\n188\n00:09:11.972 --> 00:09:17.100\nBut s isn't just USB, it could be FireWire\nor Thunderbolt or other technologies, too.\n\n189\n00:09:17.100 --> 00:09:19.104\nSo don't, in your mind,\njust tie that to USB.\n\n190\n00:09:19.104 --> 00:09:22.080\nBut it's hot plug devices\nwill show an x right there.\n\n191\n00:09:22.080 --> 00:09:26.853\nAll right, now the rest of it\nis a bit more of mystery, right?\n\n192\n00:09:26.853 --> 00:09:29.195\nThis is actually determined\nby your operating system.\n\n193\n00:09:29.195 --> 00:09:32.945\nDifferent operating systems will give\nthem different nomenclature after that\n\n194\n00:09:32.945 --> 00:09:36.235\ndepending on what number of\nthe interface it is and so on.\n\n195\n00:09:36.235 --> 00:09:38.595\nSo you'll see different\nthings kinda pop up in here.\n\n196\n00:09:38.595 --> 00:09:42.615\nBut that first part gives us the clue\nto what kind of interface that is.\n\n197\n00:09:42.615 --> 00:09:44.515\nThat's kind of where\nthose names come from.\n\n198\n00:09:44.515 --> 00:09:48.150\nSo when I'm trying to figure out which\nadapters I need to configure, and\n\n199\n00:09:48.150 --> 00:09:52.330\nI'm looking at this server,\nI can use IPADDR or\n\n200\n00:09:52.330 --> 00:09:54.740\nI have config to look of\nthe interfaces I've got.\n\n201\n00:09:54.740 --> 00:09:58.990\nAnd I can see, hey, I've got ens 36,\nthat has not been configured.\n\n202\n00:09:58.990 --> 00:10:02.437\nI need to get that one configured, so\nI need to create a script for ens 36.\n\n203\n00:10:02.437 --> 00:10:06.710\nAnd if I looked in here,\nI don't have one, right?\n\n204\n00:10:06.710 --> 00:10:07.960\nSo I can create one.\n\n205\n00:10:07.960 --> 00:10:10.170\nAnd you do need to be\nan administrator to do this.\n\n206\n00:10:10.170 --> 00:10:13.249\nActually a lot of what I'm gonna do\nneeds to be an administrator, so\n\n207\n00:10:13.249 --> 00:10:16.011\nI'm gonna go ahead and\nelevate my privileges with sudo -s.\n\n208\n00:10:16.011 --> 00:10:20.459\nI'm switching over to a root user, just so\nI don't have to sudo every command, but\n\n209\n00:10:20.459 --> 00:10:22.340\nI can certainly do that way, too.\n\n210\n00:10:22.340 --> 00:10:25.220\nAnd I'm gonna edit a file, right?\n\n211\n00:10:25.220 --> 00:10:28.320\nThe file that I'm gonna edit is\ngonna be called ifcfg, right,\n\n212\n00:10:28.320 --> 00:10:33.400\nso interface configuration-ens 36, right?\n\n213\n00:10:33.400 --> 00:10:35.550\nI'm gonna write a script for\nthat interface.\n\n214\n00:10:36.610 --> 00:10:37.970\nAnd in that script,\n\n215\n00:10:37.970 --> 00:10:41.280\nI need to add a few entries to tell\nthe system how I want it configured.\n\n216\n00:10:41.280 --> 00:10:46.000\nAll right, the first thing I need\nto do is I need to say DEVICE= and\n\n217\n00:10:46.000 --> 00:10:48.390\nthe name of the device, right?\n\n218\n00:10:48.390 --> 00:10:52.563\nNow you would think that it could\nextrapolate that from the script name\n\n219\n00:10:52.563 --> 00:10:54.054\nitself, but it can't.\n\n220\n00:10:54.054 --> 00:10:55.744\n&gt;&gt; [LAUGH]\n&gt;&gt; So we have to put it right in here, and\n\n221\n00:10:55.744 --> 00:10:57.224\njust say that's what the device name is.\n\n222\n00:10:57.224 --> 00:10:58.810\n&gt;&gt; That's not intuitive.\n\n223\n00:10:58.810 --> 00:10:59.940\n&gt;&gt; Yeah, it's a little bit weird.\n\n224\n00:10:59.940 --> 00:11:01.610\nBut so I'll punch that in.\n\n225\n00:11:01.610 --> 00:11:02.960\nThen I need to tell it the type,\n\n226\n00:11:02.960 --> 00:11:05.040\nwhich again you'd think it could\nget from the name, but it doesn't.\n\n227\n00:11:05.040 --> 00:11:07.220\nSo type in this case is ethernet.\n\n228\n00:11:07.220 --> 00:11:09.600\nI need to tell it a boot protocol.\n\n229\n00:11:09.600 --> 00:11:13.920\nNow the boot protocol is saying,\nwhen you power on,\n\n230\n00:11:13.920 --> 00:11:17.340\nare you using some other protocol\nto get your configuration, right?\n\n231\n00:11:17.340 --> 00:11:19.514\nNormally we'd use DHCP.\n\n232\n00:11:19.514 --> 00:11:21.952\nIf you had Dynamic Host Configuration\nProtocol you could get your\n\n233\n00:11:21.952 --> 00:11:23.420\nconfiguration from it.\n\n234\n00:11:23.420 --> 00:11:25.800\nI don't, so I'm gonna say none.\n\n235\n00:11:25.800 --> 00:11:27.980\nWell, I do have DHCP,\nI just don't wanna use it, right?\n\n236\n00:11:27.980 --> 00:11:30.270\nOn servers, we don't normally use DHCP.\n\n237\n00:11:30.270 --> 00:11:32.840\nYou don't wanna be dependent\non some other server.\n\n238\n00:11:32.840 --> 00:11:35.900\nYou wanna be kinda\nstandalone wherever you can.\n\n239\n00:11:35.900 --> 00:11:38.983\nSo then I'm gonna come in and\ntell it my IP address, all right?\n\n240\n00:11:38.983 --> 00:11:44.310\nI'm gonna say IPADDR0,\n0 cuz this is the first address.\n\n241\n00:11:44.310 --> 00:11:45.315\nAnd then what address I want it to have.\n\n242\n00:11:45.315 --> 00:11:50.390\nSo I'm gonna make this 172.16.0.101.\n\n243\n00:11:50.390 --> 00:11:53.544\nMy other adapter that we configured\nduring the setup was 100.\n\n244\n00:11:53.544 --> 00:11:55.046\nI'll make this one 101, all right?\n\n245\n00:11:55.046 --> 00:12:01.125\nAnd then I need to give it a prefix, and\nthe prefix is the subnet mask, right?\n\n246\n00:12:01.125 --> 00:12:04.834\nI'm using a class C subnet\nmask of 255.255.255.0.\n\n247\n00:12:04.834 --> 00:12:11.857\nThat's got 24 bits in the network id so\nI'm gonna say my prefix is 24 bits long.\n\n248\n00:12:11.857 --> 00:12:13.820\nThen we specify our gateway.\n\n249\n00:12:13.820 --> 00:12:17.677\nI'll say GATEWAY0 = and\nthen what l want my gateway to be.\n\n250\n00:12:17.677 --> 00:12:22.112\nIn my case it's 172.16.0.2 is my router.\n\n251\n00:12:22.112 --> 00:12:23.091\nAnd so I'll punch that in.\n\n252\n00:12:23.091 --> 00:12:27.117\nI'll say whether or not l am using that\ndefault route because l might be relying\n\n253\n00:12:27.117 --> 00:12:29.802\non the default route of another interface,\nright?\n\n254\n00:12:29.802 --> 00:12:33.008\nl've already got a default route on\nanother interface in my system, so\n\n255\n00:12:33.008 --> 00:12:35.220\nI could just leave this off if I wanted.\n\n256\n00:12:35.220 --> 00:12:38.630\nBut if I want to use this one\nas the default route, I can.\n\n257\n00:12:38.630 --> 00:12:39.540\nI can say yes in here.\n\n258\n00:12:39.540 --> 00:12:42.530\nIf I get a conflict, it'll pick\nthe adapter with the lowest number, so\n\n259\n00:12:42.530 --> 00:12:44.318\nthe other adapter would win.\n\n260\n00:12:44.318 --> 00:12:49.590\nOr I could just say no here, saying yeah,\nyou've got a gateway but don't use it.\n\n261\n00:12:49.590 --> 00:12:52.330\nUse the gateway for\nsome other adapter if you want, right?\n\n262\n00:12:52.330 --> 00:12:54.520\nYou can't have more than\none default gateway.\n\n263\n00:12:54.520 --> 00:12:55.990\nYou can really only have one.\n\n264\n00:12:55.990 --> 00:13:00.141\nAll the other ones to get kinda\nput in a holding pattern.\n\n265\n00:13:00.141 --> 00:13:03.460\nAll right, after that,\nthat's pretty much all we need.\n\n266\n00:13:03.460 --> 00:13:05.030\nWell, there's actually\na couple more things.\n\n267\n00:13:05.030 --> 00:13:07.490\nI probably wanna do name resolution.\n\n268\n00:13:07.490 --> 00:13:09.890\nSo I can come in and\nI can put in my DNS servers.\n\n269\n00:13:09.890 --> 00:13:14.310\nSo I'll say like DNS1= .8.8.8, right?\n\n270\n00:13:14.310 --> 00:13:17.520\nAnd I can say DNS2 if I needed and\nadd more DNS servers.\n\n271\n00:13:17.520 --> 00:13:18.770\nI only need one.\n\n272\n00:13:18.770 --> 00:13:20.309\nAnd then here's really\nthe most important thing,\n\n273\n00:13:20.309 --> 00:13:22.759\nthe thing that I almost forgot that would\nhave ruined this whole demonstration.\n\n274\n00:13:22.759 --> 00:13:27.840\nWhich is, ONBOOT = yes, all right?\n\n275\n00:13:27.840 --> 00:13:30.760\nWhat that's saying is when\nthe system boots up, go ahead and\n\n276\n00:13:30.760 --> 00:13:32.550\nturn this adapter on and use it.\n\n277\n00:13:32.550 --> 00:13:36.220\nOtherwise, the system will boot up, and\nit'll leave this adapter off, right?\n\n278\n00:13:36.220 --> 00:13:37.710\nAnd that's not gonna help us much.\n\n279\n00:13:37.710 --> 00:13:41.780\nSo I wanna make sure that it turns on\nthis adapter, and makes use of it.\n\n280\n00:13:41.780 --> 00:13:45.350\nSo everything right in there is pretty\nmuch configured the way that I need it,\n\n281\n00:13:45.350 --> 00:13:46.550\nand I'll go ahead and save that.\n\n282\n00:13:47.800 --> 00:13:50.320\nNow before I do anything with that,\nlet me show you the other script,\n\n283\n00:13:50.320 --> 00:13:54.030\nthe one that was set up when\nwe did the install, okay?\n\n284\n00:13:54.030 --> 00:13:57.355\nLooking at it,\nits got a lot more in there, right?\n\n285\n00:13:57.355 --> 00:14:00.980\nNow some of this is optional stuff that\nI could've chosen to put into my script.\n\n286\n00:14:00.980 --> 00:14:04.860\nFor example, all the IPv6 information, I\ndidn't configure IPv6 on my interface, so\n\n287\n00:14:04.860 --> 00:14:08.137\nif I wanted to, these are the various\nsettings that would do that, right?\n\n288\n00:14:08.137 --> 00:14:12.750\nOthers, the system will actually put\nin there for you, like the UUID.\n\n289\n00:14:12.750 --> 00:14:16.257\nEvery adapter has a universally\nunique identifier, a UUID.\n\n290\n00:14:16.257 --> 00:14:18.011\nI don't know the UID for my adapter.\n\n291\n00:14:18.011 --> 00:14:19.690\nI can find it out.\n\n292\n00:14:19.690 --> 00:14:21.160\nBut if I don't put it in there,\n\n293\n00:14:21.160 --> 00:14:23.920\nthe system will actually update that\nscript to put it in there for me.\n\n294\n00:14:23.920 --> 00:14:26.250\nSo it'll kinda fill some of this data in.\n\n295\n00:14:26.250 --> 00:14:29.190\nBut if you look at the rest,\nyou'll see information in here like\n\n296\n00:14:29.190 --> 00:14:32.560\nwhere they've specified,\nan IP address and a prefix and a gateway.\n\n297\n00:14:32.560 --> 00:14:34.751\nIn their configuration,\nthey actually did it the old way.\n\n298\n00:14:34.751 --> 00:14:39.131\nSee how they did IPADDR and didn't\nstick a zero on it like I did, right?\n\n299\n00:14:39.131 --> 00:14:43.913\nI put a zero on mine because if I want\nto add more addresses later I can have\n\n300\n00:14:43.913 --> 00:14:46.890\nIPADDR, IPADDR1, IPADDR2, and so on.\n\n301\n00:14:46.890 --> 00:14:48.280\nI can add more addresses.\n\n302\n00:14:48.280 --> 00:14:50.580\nThe way they did it is just set up for\none adapter.\n\n303\n00:14:50.580 --> 00:14:54.180\nSo there's different ways of configuring\nthis that'll all be accepted\n\n304\n00:14:54.180 --> 00:14:55.920\ndepending on what you're looking for.\n\n305\n00:14:55.920 --> 00:14:58.397\nBut most of what else we see\nin here is just like I typed.\n\n306\n00:14:58.397 --> 00:15:01.380\nWe've got TYPE= ethernet, PROTOCOL= none.\n\n307\n00:15:01.380 --> 00:15:03.560\nDEFAULT ROUTE = yes, right?\n\n308\n00:15:03.560 --> 00:15:08.401\nThese are all kind of just demonstrations\nof other things that we could configure\n\n309\n00:15:08.401 --> 00:15:08.981\nin here.\n\n310\n00:15:08.981 --> 00:15:13.740\nAll right, now that the script is written,\nit doesn't actually take effect yet.\n\n311\n00:15:13.740 --> 00:15:15.561\nIt takes effect on boot.\n\n312\n00:15:15.561 --> 00:15:18.460\nSo I could reboot my system, but\nI don't wanna reboot, right?\n\n313\n00:15:18.460 --> 00:15:21.480\nSo this is where restarting\nthe network service comes in handy.\n\n314\n00:15:21.480 --> 00:15:26.457\nWe can just say system ctl\nrestart network.service.\n\n315\n00:15:26.457 --> 00:15:27.630\nAnd it's gonna restart it.\n\n316\n00:15:27.630 --> 00:15:30.080\nAnd when it does,\nit's gonna look for those scripts.\n\n317\n00:15:30.080 --> 00:15:34.120\nAnd it's gonna find the old script for\nens 33, turn that interface on.\n\n318\n00:15:34.120 --> 00:15:38.138\nIt's gonna find the new script for ens 36,\nand hopefully, if I didn't screw it up,\n\n319\n00:15:38.138 --> 00:15:39.198\nturn that on, right?\n\n320\n00:15:39.198 --> 00:15:41.400\nI could have a typo or some other problem.\n\n321\n00:15:41.400 --> 00:15:43.210\nSo we'll have to take a look and see.\n\n322\n00:15:43.210 --> 00:15:49.738\nBut if I do ip addr there's ens 33,\nand it's 172.16.0.100.\n\n323\n00:15:49.738 --> 00:15:55.382\nAnd here's ens 36,\nwhich is now 172.16.0.101.\n\n324\n00:15:55.382 --> 00:15:56.638\nIt came up.\n\n325\n00:15:56.638 --> 00:16:01.140\nIt's got an IP address and\nit appears to be happy, right?\n\n326\n00:16:01.140 --> 00:16:02.526\nNow we can go in and test it.\n\n327\n00:16:02.526 --> 00:16:05.021\nAnd sometimes you're network\ninterface might be up but\n\n328\n00:16:05.021 --> 00:16:06.780\nthere might be a problem on the switch.\n\n329\n00:16:06.780 --> 00:16:08.190\nThere might be down stream problems.\n\n330\n00:16:08.190 --> 00:16:11.090\nWe don't know that but at least as\nfar as this server is concerned,\n\n331\n00:16:11.090 --> 00:16:14.880\nthat interface is now configured and\nit's up and it's right.\n\n332\n00:16:14.880 --> 00:16:19.850\n&gt;&gt; Is there a way that we can make\nchanges, it would affect every adaptor?\n\n333\n00:16:19.850 --> 00:16:20.810\nIs that possible?\n\n334\n00:16:20.810 --> 00:16:23.404\n&gt;&gt; Yeah, there's times when\nwe wanna do that, right?\n\n335\n00:16:23.404 --> 00:16:26.195\nAs an example,\nin each of these scripts, right,\n\n336\n00:16:26.195 --> 00:16:28.420\nlet's use DNS as our example, right.\n\n337\n00:16:28.420 --> 00:16:32.226\nSo in each of these scripts,\nI have a DNS entry,\n\n338\n00:16:32.226 --> 00:16:36.414\nso when I take a look at ifcfg-ens33,\nright, and\n\n339\n00:16:36.414 --> 00:16:40.046\nhere let me just we'll grab this for\nDNS one.\n\n340\n00:16:40.046 --> 00:16:44.054\nThere it's got DNS one equals 8.8.8.8 and\n\n341\n00:16:44.054 --> 00:16:49.316\nif I take a look at ens36\nright there's 8.8.8.8 right?\n\n342\n00:16:49.316 --> 00:16:51.690\nSo I have to define that twice,\nbut it's the same setting.\n\n343\n00:16:51.690 --> 00:16:54.200\nIf I've got four adaptors,\nI'm defining this over and over again.\n\n344\n00:16:54.200 --> 00:16:56.460\nWell, if you just do it once,\nit's not a big deal.\n\n345\n00:16:56.460 --> 00:16:58.880\nBut if I ever wanna change my DNS server,\nI've gotta go and\n\n346\n00:16:58.880 --> 00:17:02.680\nedit all four of these scripts and\nthat gets annoying after awhile.\n\n347\n00:17:02.680 --> 00:17:05.820\nSo we don't have to put\neverything in the adaptor itself.\n\n348\n00:17:05.820 --> 00:17:08.210\nIt's nice to do that cuz\nyou get granularity, right?\n\n349\n00:17:08.210 --> 00:17:09.580\nBut if you're not looking for granularity.\n\n350\n00:17:09.580 --> 00:17:11.220\nIf you want simplicity, right?\n\n351\n00:17:11.220 --> 00:17:13.620\nI just want one DNS server to find for\nall my adapters.\n\n352\n00:17:13.620 --> 00:17:14.490\n&gt;&gt; Keeping it simple.\n\n353\n00:17:14.490 --> 00:17:16.780\n&gt;&gt; Yeah absolutely, and\nthere's an easy way to do that.\n\n354\n00:17:16.780 --> 00:17:19.383\nThere are configuration\nfiles that apply globally.\n\n355\n00:17:19.383 --> 00:17:21.410\nNow the interfaces always override it.\n\n356\n00:17:21.410 --> 00:17:23.810\nSo if you've got settings\non the interface,\n\n357\n00:17:23.810 --> 00:17:25.770\nthey'll override the global configuration.\n\n358\n00:17:25.770 --> 00:17:30.540\nBut if I wanna do global stuff like DNS, I\ncan go just up at two directories I guess.\n\n359\n00:17:30.540 --> 00:17:34.907\nInside of etc, and inside of\nthe etcdirectory you'll find resolve.conf,\n\n360\n00:17:34.907 --> 00:17:37.160\nthis guy right here, all right.\n\n361\n00:17:37.160 --> 00:17:39.180\nAnd that one controls name resolution.\n\n362\n00:17:39.180 --> 00:17:41.290\nThe interface scripts can override this.\n\n363\n00:17:41.290 --> 00:17:45.130\nBut if I leave DNS out of the interfaces,\nif I just don't put a DNS server in\n\n364\n00:17:45.130 --> 00:17:51.100\nthe interfaces, I could come in here and\nmodify this file.\n\n365\n00:17:51.100 --> 00:17:53.220\nAnd put the name server in here.\n\n366\n00:17:53.220 --> 00:17:56.328\nOkay, now I do have to be a little\ncareful with this, look at mine.\n\n367\n00:17:56.328 --> 00:18:00.066\nName server 8.8.8.8,\nI didn't put that there.\n\n368\n00:18:00.066 --> 00:18:01.581\nBut it's already there,\nit's already configured the way I want.\n\n369\n00:18:01.581 --> 00:18:02.580\nThat's awesome!\n\n370\n00:18:02.580 --> 00:18:04.530\nWell, I didn't put it there.\n\n371\n00:18:04.530 --> 00:18:08.750\nThere's a network manager on\nRed Hat Enterprise Linux, on CentOS, and\n\n372\n00:18:08.750 --> 00:18:11.332\non Fedora and\non the newest versions of Ubuntu.\n\n373\n00:18:11.332 --> 00:18:14.000\nThey've started using the utility called\nNetwork Manager that does a lot of\n\n374\n00:18:14.000 --> 00:18:15.240\nthe configuration for you.\n\n375\n00:18:15.240 --> 00:18:18.600\nSo, it's picked up on\nthose DNS servers and\n\n376\n00:18:18.600 --> 00:18:22.920\nput the configuration in\nthis global file for me.\n\n377\n00:18:22.920 --> 00:18:27.140\nSo I've gotta be careful because what\nthat warns me is that I can change this.\n\n378\n00:18:27.140 --> 00:18:30.130\nI could modify this and this would\nbe a global change across my system.\n\n379\n00:18:30.130 --> 00:18:32.590\nBut, the network manager might undo it.\n\n380\n00:18:32.590 --> 00:18:33.740\nIt might go and put this back.\n\n381\n00:18:33.740 --> 00:18:36.040\nSo that's kind of a little warning for me.\n\n382\n00:18:36.040 --> 00:18:38.630\nNot every system runs a network manager\nthough so you may not see that.\n\n383\n00:18:38.630 --> 00:18:40.590\nAnd if you don't,\nfeel free to change this file.\n\n384\n00:18:40.590 --> 00:18:45.286\nYou can make little changes right here\nthat will apply up and they take effect.\n\n385\n00:18:45.286 --> 00:18:47.710\nThere's other ways that we\ncan override things too,\n\n386\n00:18:47.710 --> 00:18:49.840\nit just depends on which service it is.\n\n387\n00:18:49.840 --> 00:18:53.660\nLike gateways can be overwritten\nby doing manual routes.\n\n388\n00:18:53.660 --> 00:18:58.210\nThere's, let's see,\ndealing with DNS, right?\n\n389\n00:18:58.210 --> 00:19:00.970\nSo, I'm doing resolv.conf to\noverride my name look ups.\n\n390\n00:19:00.970 --> 00:19:03.260\nI could override individual\nhosts if I wanted, right?\n\n391\n00:19:03.260 --> 00:19:09.820\nSo, inside of etc there's a file called\nhosts which is right here, hosts.\n\n392\n00:19:09.820 --> 00:19:13.300\nAnd so you can modify that hosts\nfile to override look ups.\n\n393\n00:19:13.300 --> 00:19:16.940\nSo if I took that and one in here.\n\n394\n00:19:16.940 --> 00:19:21.440\nI could come in and I could say\n\n395\n00:19:22.450 --> 00:19:28.019\nsomething like I want\n1.1.1.1 to be www.google.com.\n\n396\n00:19:28.019 --> 00:19:31.470\nAnd now anytime I do a look up for\nGoogle.com,\n\n397\n00:19:31.470 --> 00:19:35.570\nit'll respond with 1.1.1.1 no with\nwhatever Google's actual IP is.\n\n398\n00:19:35.570 --> 00:19:38.580\nThis is useful for developers who have\nlike testing or staging environments.\n\n399\n00:19:38.580 --> 00:19:40.170\nThey don't want to connect to\nthe production environment,\n\n400\n00:19:40.170 --> 00:19:41.120\nthey want to connect to staging.\n\n401\n00:19:41.120 --> 00:19:43.910\nBut they wanna use the same domain name,\nthey can override things here.\n\n402\n00:19:43.910 --> 00:19:46.010\nSo those are other ways\nthat we can override it.\n\n403\n00:19:46.010 --> 00:19:47.773\nThere's always a way, right?\n\n404\n00:19:47.773 --> 00:19:50.840\nThe interface scripts are kind of\nour key configuration point but\n\n405\n00:19:50.840 --> 00:19:54.310\nthere's plenty of other things that\ncan mess with their configuration.\n\n406\n00:19:54.310 --> 00:19:55.600\nSo always be aware of that.\n\n407\n00:19:55.600 --> 00:19:59.650\nAnd unfortunately it does vary a little\nbit from distro to distro, so you may find\n\n408\n00:19:59.650 --> 00:20:03.260\nwhere some distributions are really\nobvious about where the overrides are.\n\n409\n00:20:03.260 --> 00:20:06.856\nOther ones you've got to dig through\ndocumentation to find out what is really\n\n410\n00:20:06.856 --> 00:20:07.700\ngoing on there.\n\n411\n00:20:07.700 --> 00:20:11.930\nBut just be aware there's plenty\nof ways to override stuff and\n\n412\n00:20:11.930 --> 00:20:14.280\nget things kinda set\nthe way that you want.\n\n413\n00:20:16.070 --> 00:20:19.054\n&gt;&gt; And is that the only way that we\ncould configure network adapters or\n\n414\n00:20:19.054 --> 00:20:21.060\nthere are other way that we could do this?\n\n415\n00:20:21.060 --> 00:20:24.932\n&gt;&gt; Yeah so, what I showed you right\nthere was kind of the old way, right,\n\n416\n00:20:24.932 --> 00:20:29.350\nthe way that most systems support and\nyou're welcome to use it, it work great.\n\n417\n00:20:30.560 --> 00:20:33.450\nEventually though,\nit will be replaced by other tools.\n\n418\n00:20:33.450 --> 00:20:37.479\nIt's kinda like when system d came in and\nreplaced the old upstart in it.\n\n419\n00:20:37.479 --> 00:20:40.730\nIt took a while for that to happen, but\nnow everybody is pretty well adopted in.\n\n420\n00:20:40.730 --> 00:20:46.645\nSo if you run Ubuntu or Red Hat or CentOS,\nFedora, they're all using system d now.\n\n421\n00:20:46.645 --> 00:20:48.358\nWell, same thing on the networking side.\n\n422\n00:20:48.358 --> 00:20:50.835\nOn the networking side there's that\nnetwork manager that we saw a few\n\n423\n00:20:50.835 --> 00:20:51.765\nmoments ago.\n\n424\n00:20:51.765 --> 00:20:54.655\nIt is gaining an in roads, we're seeing\n\n425\n00:20:54.655 --> 00:20:59.245\nwhere it's being accepted as the default\nnetwork manager for a lot of systems.\n\n426\n00:20:59.245 --> 00:21:05.060\nRed Hat Enterprise Linux 7, actually\nthey started back in five I think.\n\n427\n00:21:05.060 --> 00:21:08.531\nCentOS 6, Ubuntu started in\ntheir latest version, and\n\n428\n00:21:08.531 --> 00:21:11.960\nFedora started with version 23 or\nsomething.\n\n429\n00:21:11.960 --> 00:21:15.050\nWhere they started using the network\nmanager as just their regular\n\n430\n00:21:15.050 --> 00:21:17.520\nway of interfacing with\nthe network adapters.\n\n431\n00:21:17.520 --> 00:21:21.440\nAnd the network manager, if you've never\nused it, it started out as a GUI utility.\n\n432\n00:21:21.440 --> 00:21:23.870\nAnd so on servers, we didn't care\nabout it, cuz we didn't have a GUI, so\n\n433\n00:21:23.870 --> 00:21:25.270\nnot gonna use it.\n\n434\n00:21:25.270 --> 00:21:26.800\nBut since then, it's evolved, and\n\n435\n00:21:26.800 --> 00:21:29.170\nnow we have a whole command\nline interface for it.\n\n436\n00:21:29.170 --> 00:21:30.780\nAnd now, it's become a very powerful tool.\n\n437\n00:21:30.780 --> 00:21:32.230\nIt's designed to make\nlife a little easier.\n\n438\n00:21:32.230 --> 00:21:36.840\nBecause with the network manager, you\ndon't have to write crazy scripts, right?\n\n439\n00:21:36.840 --> 00:21:38.420\nYou can just do things\nthrough a simple command.\n\n440\n00:21:38.420 --> 00:21:41.490\nSo, let me show you an example of\nhow that network manager works.\n\n441\n00:21:41.490 --> 00:21:43.810\nOne of the first things you need\nto do is find out whether or\n\n442\n00:21:43.810 --> 00:21:44.925\nnot you've even got it, right?\n\n443\n00:21:44.925 --> 00:21:45.590\n&gt;&gt; Mm-hm.\n&gt;&gt; So,\n\n444\n00:21:45.590 --> 00:21:49.560\nyou can do nmcli,\nit's the primary interface command, right?\n\n445\n00:21:49.560 --> 00:21:51.520\nThe network manager\ncommand line interface.\n\n446\n00:21:51.520 --> 00:21:54.080\nAnd if you run that and you get nothing,\n\n447\n00:21:54.080 --> 00:21:56.378\nthen you don't have [LAUGH]\nthe network manager.\n\n448\n00:21:56.378 --> 00:21:57.920\n&gt;&gt; [LAUGH]\n&gt;&gt; But if you run it and\n\n449\n00:21:57.920 --> 00:21:59.770\nyou get the output that I just got,\n\n450\n00:21:59.770 --> 00:22:02.870\nwhat I'm seeing here is\na summary of my adaptors.\n\n451\n00:22:02.870 --> 00:22:05.886\nAnd it's showing me that I've got ens33,\nand it's configured,\n\n452\n00:22:05.886 --> 00:22:06.985\nhere's its IP address.\n\n453\n00:22:06.985 --> 00:22:10.100\nI've got ens36, it's configured,\nhere's its IP address.\n\n454\n00:22:10.100 --> 00:22:14.730\nAnd I've also got ens37 and 38,\nthat I haven't worked with, right, so\n\n455\n00:22:14.730 --> 00:22:19.730\nthe network manager sees them, and now I\ncan get in and start to configure them.\n\n456\n00:22:19.730 --> 00:22:22.290\nNow the network managers allows us\nto configure two different things.\n\n457\n00:22:22.290 --> 00:22:26.100\nIt allows us to configure devices and\nconnections, right?\n\n458\n00:22:26.100 --> 00:22:27.880\nNow that sounds a little weird, but\n\n459\n00:22:27.880 --> 00:22:30.360\nthe device,\nthat's talking about the hardware, right?\n\n460\n00:22:30.360 --> 00:22:33.760\nSo my physical network interface card or\nmy wireless radios or\n\n461\n00:22:33.760 --> 00:22:35.650\nwhatever it is that I'm using\nto interface with the network.\n\n462\n00:22:35.650 --> 00:22:36.897\nSo that's the device.\n\n463\n00:22:36.897 --> 00:22:40.330\nAnd then the connection is\nlike the script we just wrote.\n\n464\n00:22:40.330 --> 00:22:43.800\nIt's the software that sits on top of\nit that assigns an IP and all of that.\n\n465\n00:22:43.800 --> 00:22:45.760\nSo there's two different pieces.\n\n466\n00:22:45.760 --> 00:22:48.020\nAnd sometimes you'll get different\noutputs when you look at it.\n\n467\n00:22:48.020 --> 00:22:53.410\nSo, for example,\nif I do nmcli device show, right?\n\n468\n00:22:53.410 --> 00:22:55.140\nIt's gonna show me some of my devices.\n\n469\n00:22:55.140 --> 00:22:57.220\nAnd this is actually\na really detailed view.\n\n470\n00:22:57.220 --> 00:23:02.684\nBut I'm gonna see a lot in here as\nfar as my actual devices, right?\n\n471\n00:23:02.684 --> 00:23:06.440\nSo ens33, ens36, 37, 38.\n\n472\n00:23:06.440 --> 00:23:09.230\nBut if I were to do, actually I probably\nshould have done device status,\n\n473\n00:23:09.230 --> 00:23:10.630\nthat one's a little cleaner.\n\n474\n00:23:10.630 --> 00:23:11.340\nThere we go.\n\n475\n00:23:11.340 --> 00:23:15.912\nSo a little more summarized, but\nI see all four of those devices,\n\n476\n00:23:15.912 --> 00:23:18.360\nthat physical hardware, right?\n\n477\n00:23:18.360 --> 00:23:22.729\nBut if do nmcli connection show,\n\n478\n00:23:22.729 --> 00:23:27.102\nI've only got two connections.\n\n479\n00:23:27.102 --> 00:23:29.203\nWhat happened to ens37 and 38?\n\n480\n00:23:29.203 --> 00:23:30.130\nThey disappeared.\n\n481\n00:23:30.130 --> 00:23:31.610\nWell, there's no software configuration.\n\n482\n00:23:31.610 --> 00:23:32.550\nThere's no script.\n\n483\n00:23:32.550 --> 00:23:35.960\nI haven't configured the software\npiece to sit on top of them, right?\n\n484\n00:23:35.960 --> 00:23:37.010\nSo, they're missing out of there.\n\n485\n00:23:37.010 --> 00:23:40.220\nSo, connections and devices are two\ndifferent things in the nmcli world.\n\n486\n00:23:40.220 --> 00:23:43.660\nThat's one thing that's kinda hard\nto wrap our minds around sometimes.\n\n487\n00:23:43.660 --> 00:23:45.440\nBut once we've got that\nkinda squared away,\n\n488\n00:23:45.440 --> 00:23:47.740\ngetting the actual configuration\nin place is not that hard.\n\n489\n00:23:47.740 --> 00:23:49.322\nWe can say, nmcli.\n\n490\n00:23:49.322 --> 00:23:51.828\nAnd remember,\nI've elevated my privileges here, so\n\n491\n00:23:51.828 --> 00:23:54.725\nyou'll need to sudo this if\nyou're running as a regular user.\n\n492\n00:23:54.725 --> 00:23:56.334\nSo, I'll do nmcli.\n\n493\n00:23:56.334 --> 00:24:00.641\nConnection edit, and\nthen I'm gonna say ens37, right,\n\n494\n00:24:00.641 --> 00:24:05.043\none of the adapters that doesn't\nhave a connection, right?\n\n495\n00:24:05.043 --> 00:24:08.260\nAnd when I try and do that,\nwell, I'm gonna get an error.\n\n496\n00:24:08.260 --> 00:24:10.460\nThat connection doesn't actually exist,\nright?\n\n497\n00:24:10.460 --> 00:24:14.415\nSo I've gotta get that device configured,\nand kind of brought into the system and\n\n498\n00:24:14.415 --> 00:24:15.116\nput in place.\n\n499\n00:24:15.116 --> 00:24:19.040\nAnd so the way that I've got it right now,\nit's actually not gonna turn up.\n\n500\n00:24:19.040 --> 00:24:21.348\nAnd the reason I'm getting that error is\nthat the NetworkManager doesn't know about\n\n501\n00:24:21.348 --> 00:24:21.870\nthat connection.\n\n502\n00:24:21.870 --> 00:24:24.170\nThere's no script to inform it,\nso I have to tell it.\n\n503\n00:24:24.170 --> 00:24:28.960\nSo I'm gonna come in here and\nsay, nmcli connection add and\n\n504\n00:24:28.960 --> 00:24:31.270\nthis is gonna be a long command here.\n\n505\n00:24:31.270 --> 00:24:33.460\nNot too long, but long enough.\n\n506\n00:24:33.460 --> 00:24:35.100\nSo I'm gonna tell it the type is ethernet.\n\n507\n00:24:35.100 --> 00:24:36.720\nI'm adding an ethernet connection.\n\n508\n00:24:36.720 --> 00:24:38.920\nAnd the connection name.\n\n509\n00:24:38.920 --> 00:24:40.490\nWell, I can name it whatever I want.\n\n510\n00:24:40.490 --> 00:24:44.175\nNotice my connections up here\nens33 was named by the install,\n\n511\n00:24:44.175 --> 00:24:46.240\nens36 I just did via script.\n\n512\n00:24:46.240 --> 00:24:49.009\nSo it picked it up as system ens36, right?\n\n513\n00:24:49.009 --> 00:24:50.760\nThat's just the name it assigned.\n\n514\n00:24:50.760 --> 00:24:54.550\nBut I like to leave the name kind\nof what the interface is easier for\n\n515\n00:24:54.550 --> 00:24:55.370\nme to keep track of.\n\n516\n00:24:55.370 --> 00:24:57.610\nSo I'll just leave it as ens37.\n\n517\n00:24:57.610 --> 00:25:00.390\nAnd then ifname, this one I can't make up.\n\n518\n00:25:00.390 --> 00:25:02.690\nThis needs to actually\nmatch the interface name.\n\n519\n00:25:02.690 --> 00:25:05.520\nSo this one is gonna be ens37 as well,\nall right?\n\n520\n00:25:05.520 --> 00:25:10.690\nAnd by running that, that's going to tell\nthe NetworkManager this interface exists\n\n521\n00:25:10.690 --> 00:25:12.620\nand now we can work with it.\n\n522\n00:25:12.620 --> 00:25:15.430\nAnd so I'm can go right back up into\nthat edit command that I tried to run\n\n523\n00:25:15.430 --> 00:25:16.420\na moment ago.\n\n524\n00:25:16.420 --> 00:25:19.910\nAnd this time,\nit knows about the interface, and\n\n525\n00:25:19.910 --> 00:25:22.780\nnow I'm in the interactive prompt and\nwe can start to work with this.\n\n526\n00:25:22.780 --> 00:25:25.070\nNow the rest of the commands are a heck\nof a lot easier than that one, right?\n\n527\n00:25:25.070 --> 00:25:27.297\nSo I don't need to do giant\nlong running commands.\n\n528\n00:25:27.297 --> 00:25:30.880\nBut the commands that I issue\nhere are pretty important,\n\n529\n00:25:30.880 --> 00:25:33.660\nright, cuz we're gonna go in, start to\nset all the configuration for this.\n\n530\n00:25:33.660 --> 00:25:39.780\nI would say like set\nconnection.autoconnect yes.\n\n531\n00:25:39.780 --> 00:25:41.997\nThat's like the onboot = es, right?\n\n532\n00:25:41.997 --> 00:25:44.042\nI want this to come on\nwhen the system boots up.\n\n533\n00:25:44.042 --> 00:25:48.170\nI can say set ipv4.method, and\n\n534\n00:25:48.170 --> 00:25:52.750\nthen I can set this to DHCP or manual.\n\n535\n00:25:52.750 --> 00:25:53.680\nI'm gonna set mine to manual.\n\n536\n00:25:55.040 --> 00:26:00.519\nI can say set ipv4.addr 172.16.0.103, or\n\n537\n00:26:00.519 --> 00:26:05.674\nwhatever number I'm up to,\nI've kind of lost track.\n\n538\n00:26:05.674 --> 00:26:06.373\n[LAUGH]\n&gt;&gt; [LAUGH]\n\n539\n00:26:06.373 --> 00:26:07.974\n&gt;&gt; And so I'll set that.\n\n540\n00:26:07.974 --> 00:26:12.224\nActually, I need to re-run that because\nI need to set the prefix also, so\n\n541\n00:26:12.224 --> 00:26:14.080\n/24 on that one.\n\n542\n00:26:14.080 --> 00:26:16.780\nI can say set ipv4.dns, and\n\n543\n00:26:16.780 --> 00:26:22.075\nI'll set that to a 8.8.8.8\nlike I've been doing.\n\n544\n00:26:22.075 --> 00:26:30.165\nAnd set ipv4.gateway 172.16.0.2, right?\n\n545\n00:26:30.165 --> 00:26:32.305\nAll of these are things I've\nput in the script before.\n\n546\n00:26:32.305 --> 00:26:33.778\nNow I'm just kinda setting them here.\n\n547\n00:26:33.778 --> 00:26:37.690\nI didn't have to create a file, and the\nfile is open right here through the cli.\n\n548\n00:26:37.690 --> 00:26:42.180\nNow one of the neat things about this\nis I can choose to make these changes\n\n549\n00:26:42.180 --> 00:26:44.790\ntemporary or permanent, right?\n\n550\n00:26:44.790 --> 00:26:46.956\nWe use the save command to\nsave everything we did.\n\n551\n00:26:46.956 --> 00:26:50.916\nAnd so I can say, save Temporary, and\nthat'll turn the network adapter on and\n\n552\n00:26:50.916 --> 00:26:52.603\nget the configuration in place.\n\n553\n00:26:52.603 --> 00:26:54.791\nAnd when I reboot, I lose it all, right?\n\n554\n00:26:54.791 --> 00:26:59.479\nOr I can say, save persistent.\n\n555\n00:26:59.479 --> 00:27:03.720\nAnd now, even if I reboot,\nthat network configuration is there.\n\n556\n00:27:03.720 --> 00:27:08.180\nSo the nmcli becomes my new way\nof managing these adapters.\n\n557\n00:27:08.180 --> 00:27:11.528\nAnd after I quit out of that,\nthat's now got the configuration.\n\n558\n00:27:11.528 --> 00:27:14.420\nI can do nmcli connection show.\n\n559\n00:27:15.480 --> 00:27:18.260\nAnd I see each of those\nconnections including 37.\n\n560\n00:27:18.260 --> 00:27:21.614\nAnd if I just run nmcli by itself,\nthere's 37 and\n\n561\n00:27:21.614 --> 00:27:25.596\nI can see it's got its IP address and\nit's already in place.\n\n562\n00:27:25.596 --> 00:27:27.815\nI didn't even have to restart\nthe network service, right?\n\n563\n00:27:27.815 --> 00:27:28.740\nIf you think about it,\n\n564\n00:27:28.740 --> 00:27:32.110\nwhen you restart the network service,\nit reinitialized every adapter.\n\n565\n00:27:32.110 --> 00:27:33.956\nEvery adapter goes offline and\ncomes back on.\n\n566\n00:27:33.956 --> 00:27:38.771\nIt creates an outage, but\nthis only changed ens37.\n\n567\n00:27:38.771 --> 00:27:39.617\nIt didn't create an outage.\n\n568\n00:27:39.617 --> 00:27:43.984\nThat makes this a much better way of\ndoing things, and that's why more and\n\n569\n00:27:43.984 --> 00:27:47.937\nmore distributions are moving\nover to using the NetworkManager.\n\n570\n00:27:47.937 --> 00:27:49.165\nIt's a good system.\n\n571\n00:27:49.165 --> 00:27:52.252\nIt does its job really well.\n\n572\n00:27:52.252 --> 00:27:56.680\nAnd if I take a look here,\nI can find the script that it made, right?\n\n573\n00:27:56.680 --> 00:28:02.160\nAnd if I look at that, ens37, right?\n\n574\n00:28:02.160 --> 00:28:06.766\nHere it is, and it's properly\nfilled everything out for me.\n\n575\n00:28:06.766 --> 00:28:08.035\nSo I don't have to worry about syntax.\n\n576\n00:28:08.035 --> 00:28:09.695\nI don't have to worry about typos, and\n\n577\n00:28:09.695 --> 00:28:12.570\nsome of the things I left off\nbefore it's put in here for me.\n\n578\n00:28:12.570 --> 00:28:14.370\nIt's now controlling it and\ntaking care of it.\n\n579\n00:28:14.370 --> 00:28:15.908\nSo if you haven't used it already,\n\n580\n00:28:15.908 --> 00:28:19.398\nyou definitely wanna start familiarizing\nyourself with the NetworkManager.\n\n581\n00:28:19.398 --> 00:28:20.630\nThat an nmcli,\n\n582\n00:28:20.630 --> 00:28:23.660\nit is going to be the way you configure\nnetwork adapters in the future.\n\n583\n00:28:23.660 --> 00:28:26.580\nAnd it is going to be the way that\nyou monitor them and see your status.\n\n584\n00:28:26.580 --> 00:28:32.040\nSo commands like ip addr or ifconfig,\nthose are gonna go away eventually.\n\n585\n00:28:32.040 --> 00:28:33.310\nThe NetworkManager's a great way to do it.\n\n586\n00:28:33.310 --> 00:28:37.500\nBut the thing about the NetworkManager\nis it is extra software.\n\n587\n00:28:37.500 --> 00:28:41.240\nAnd so, if you're really trying to harden\nthe system, some people prefer to not have\n\n588\n00:28:41.240 --> 00:28:45.070\nit cuz it minimizes their footprint,\nand then do the manual configuration.\n\n589\n00:28:45.070 --> 00:28:46.735\nSo it never hurts to learn both ways.\n\n590\n00:28:46.735 --> 00:28:48.341\nAnd that's what we've seen\nright here in this episode.\n\n591\n00:28:48.341 --> 00:28:50.480\nWe saw the old way to do it and\nthe new way to do it.\n\n592\n00:28:50.480 --> 00:28:52.759\nWhichever one you use,\nthey both work out in the end, right.\n\n593\n00:28:52.759 --> 00:28:54.770\nBut there are multiple ways to do this.\n\n594\n00:28:54.770 --> 00:28:56.120\n&gt;&gt; Excellent job as always done, Don.\n\n595\n00:28:56.120 --> 00:28:59.620\nConfiguring networking,\nbecoming a Linux server administrator.\n\n596\n00:28:59.620 --> 00:29:01.950\nAny last words before\nwe leave this episode?\n\n597\n00:29:01.950 --> 00:29:05.375\n&gt;&gt; The only thing to really watch out for\nhere is typos, right?\n\n598\n00:29:05.375 --> 00:29:07.570\nIt's really easy to\nmake typos in networks.\n\n599\n00:29:07.570 --> 00:29:10.470\nAnd also if you're configuring\nthis remotely, right, and\n\n600\n00:29:10.470 --> 00:29:13.020\nyou mess up the network configuration,\nyou could disconnect yourself.\n\n601\n00:29:13.020 --> 00:29:14.029\nSo always be careful about that.\n\n602\n00:29:14.029 --> 00:29:15.180\nAlways have a back up plan.\n\n603\n00:29:15.180 --> 00:29:17.620\nHow can I get in to manage\nthat server if I'm remote and\n\n604\n00:29:17.620 --> 00:29:18.750\nI need to reconfigure the network?\n\n605\n00:29:18.750 --> 00:29:20.750\nSo always be aware of that.\n\n606\n00:29:20.750 --> 00:29:23.200\nAnd it doesn't hurt to make\nbackups of those scripts, too.\n\n607\n00:29:23.200 --> 00:29:26.340\nYou can just copy them off to another\ndirectory or copy them to another file and\n\n608\n00:29:26.340 --> 00:29:28.010\ncall them .bak or something.\n\n609\n00:29:28.010 --> 00:29:30.885\nYou can easily do that to serve\nas a backup of those files.\n\n610\n00:29:30.885 --> 00:29:31.745\n&gt;&gt; Excellent stuff.\n\n611\n00:29:31.745 --> 00:29:33.615\nSo becoming a Linux Server administrator,\n\n612\n00:29:33.615 --> 00:29:35.775\nthere's a lot of video\ncontent in this series.\n\n613\n00:29:35.775 --> 00:29:38.365\nWatch every single video,\nyou'll be glad you did.\n\n614\n00:29:38.365 --> 00:29:40.390\nAnd thank you for watching ITProTV.\n\n615\n00:29:40.390 --> 00:29:43.085\nRemember, a good IT pro\nis always learning.\n\n616\n00:29:43.085 --> 00:29:44.045\nI'm Zach Memos.\n\n617\n00:29:44.045 --> 00:29:44.855\n&gt;&gt; And I'm Don Pezet.\n\n618\n00:29:44.855 --> 00:29:45.554\n&gt;&gt; And we will see you soon.\n\n619\n00:29:45.554 --> 00:29:53.488\n[MUSIC]\n\n620\n00:29:53.488 --> 00:29:55.370\n&gt;&gt; Thank you for watching ITProTV\n\n",
          "vimeoId": "226298939"
        },
        {
          "description": "Don and Zach discuss what advanced networking is, how we begin the process, IP address Aliases, what 'Onparent' is, ethernet channel bonding, creating the bond configuration, adding the NICs to the bond, enabling the bonding module, and custom routes.",
          "length": "1885",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-2-2-advanced_networking-071917-PGM.00_48_47_18.Still002.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-2-2-advanced_networking-071917-PGM.00_48_47_18.Still002-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-2-2-advanced_networking-071917-PGM.00_48_47_18.Still002-sm.jpg",
          "title": "Advanced Networking",
          "transcript": "WEBVTT\n\n1\n00:00:00.290 --> 00:00:03.133\nWelcome to ITProTV I'm\nyour host Don Pezet.\n\n2\n00:00:03.133 --> 00:00:06.471\n[CROSSTALK]\n\n3\n00:00:06.471 --> 00:00:08.416\n[MUSIC]\n\n4\n00:00:08.416 --> 00:00:11.274\n&gt;&gt; You're watching ITProTV.\n\n5\n00:00:11.274 --> 00:00:13.380\n&gt;&gt; Hello and thank you for\n\n6\n00:00:13.380 --> 00:00:17.120\nwatching ITProTV,\nhelping you learn wherever you go.\n\n7\n00:00:17.120 --> 00:00:20.410\nI'm your host Zach Memos as we continue\non with becoming a Linux server\n\n8\n00:00:20.410 --> 00:00:21.810\nadministrator.\n\n9\n00:00:21.810 --> 00:00:26.020\nAnd in this episode advance\nnetworking is the topic and\n\n10\n00:00:26.020 --> 00:00:29.432\nDon Pezet is gonna bringing us all the\ninformation we need because he is amazing!\n\n11\n00:00:29.432 --> 00:00:30.860\n[LAUGH]\n&gt;&gt; Well I don't\n\n12\n00:00:30.860 --> 00:00:32.970\nknow about all of the amazing stuff but\nwe are definitely gonna\n\n13\n00:00:32.970 --> 00:00:36.080\nbe taking a look at network configuration\ninside of the Linux environment\n\n14\n00:00:36.080 --> 00:00:39.760\nIn our last episode I showed you guys how\nto configure network adapters, right?\n\n15\n00:00:39.760 --> 00:00:44.050\nJust basic, stick an IP on a NIC and\nturn it loose and there you go.\n\n16\n00:00:44.050 --> 00:00:45.860\nThat's good enough for most people.\n\n17\n00:00:45.860 --> 00:00:49.080\nBut there are some advanced features\ntucked away inside of Linux that\n\n18\n00:00:49.080 --> 00:00:50.030\nare really powerful.\n\n19\n00:00:50.030 --> 00:00:52.220\nThat if you know they're there\nyou can take advantage of and\n\n20\n00:00:52.220 --> 00:00:53.590\ndo some really neat things.\n\n21\n00:00:53.590 --> 00:00:56.370\nSo in this episode we're gonna go\na little bit beyond the standard network\n\n22\n00:00:56.370 --> 00:00:59.830\nconfiguration, and show you some of the\nadvanced behind the scenes stuff that can\n\n23\n00:00:59.830 --> 00:01:03.750\nmake your servers perform even better and\nmore to your needs.\n\n24\n00:01:03.750 --> 00:01:06.260\nThat's right here in advanced\nnetwork configuration.\n\n25\n00:01:06.260 --> 00:01:07.820\n&gt;&gt; Above and beyond.\n\n26\n00:01:07.820 --> 00:01:09.440\nSo where do we start?\n\n27\n00:01:09.440 --> 00:01:12.080\n&gt;&gt; All right let's start with IP alias',\n\n28\n00:01:12.080 --> 00:01:15.590\ncuz I almost wanted to talk about\nalias' in that last episode and\n\n29\n00:01:15.590 --> 00:01:18.640\nI was like let me hold off on that\ncuz it's a little more advanced.\n\n30\n00:01:18.640 --> 00:01:21.220\nOne of the things I mentioned\nin the last episode\n\n31\n00:01:21.220 --> 00:01:25.580\nwas that a network interface could\nhave more than one IP address right?\n\n32\n00:01:25.580 --> 00:01:28.880\nAnd you might ask yourself,\nwhy would I want more than one IP address?\n\n33\n00:01:28.880 --> 00:01:32.520\nWell, if you're running a web server and\nyou've got five different websites,\n\n34\n00:01:32.520 --> 00:01:36.330\nit's very common to assign a different\nIP address to each website.\n\n35\n00:01:36.330 --> 00:01:39.900\nWell, I could have five network adapters,\nbut eventually you hit a threshold.\n\n36\n00:01:39.900 --> 00:01:42.350\nYou can only have so\nmany network adapters in a server.\n\n37\n00:01:42.350 --> 00:01:46.840\nSo it's easier if you just have one\ninterface with a bunch of IPs stuck on it.\n\n38\n00:01:46.840 --> 00:01:49.010\nAnd very very common in\nthe web server world.\n\n39\n00:01:49.010 --> 00:01:50.520\nWell, I can do that.\n\n40\n00:01:50.520 --> 00:01:52.860\nI can take one interface and\nI can have more than one IP.\n\n41\n00:01:52.860 --> 00:01:55.770\nLike here, I'll just pull up.\n\n42\n00:01:55.770 --> 00:01:58.380\nRemember that our network scripts,\nif you didn't watch the last episode,\n\n43\n00:01:58.380 --> 00:02:02.850\nare stored in /ETC /systemfig\n/network desk scripts.\n\n44\n00:02:02.850 --> 00:02:06.930\nAnd if I take a look in there\nthe interface that I wanna work\n\n45\n00:02:06.930 --> 00:02:09.330\nwith is this guy right here IFCFG-ENS33.\n\n46\n00:02:09.330 --> 00:02:11.390\nThat's my primary network interface.\n\n47\n00:02:11.390 --> 00:02:16.030\nAnd if I edit that file and\n\n48\n00:02:16.030 --> 00:02:20.280\npull it up that by default most of that\nvirtual only have one address, right?\n\n49\n00:02:20.280 --> 00:02:27.140\nSo looking at this one, I can see\nI've got a IPADDR of 172.16.0.100.\n\n50\n00:02:27.140 --> 00:02:31.940\nLet's say I want it to have\n72.16.0.101 and .102, right?\n\n51\n00:02:31.940 --> 00:02:33.450\nSo I could change this.\n\n52\n00:02:33.450 --> 00:02:38.290\nInstead of saying IPADDR,\nmake it say IPADDR1 and\n\n53\n00:02:38.290 --> 00:02:42.420\nPREFIX1 and GATEWAY1 like that.\n\n54\n00:02:42.420 --> 00:02:48.680\nAnd once that's done, I can come in, and\nI can add additional IPs that same way.\n\n55\n00:02:48.680 --> 00:02:55.605\nI can say, IPADDR2 = 172.16.0.101 and\n\n56\n00:02:55.605 --> 00:02:59.827\nPREFIX2 = 24 and GATEWAY2.\n\n57\n00:02:59.827 --> 00:03:05.400\nIf I even need a gateway, right?\n\n58\n00:03:05.400 --> 00:03:08.010\nI probably don't need gateways on\nthese other ones if they're all\n\n59\n00:03:08.010 --> 00:03:09.510\nkinda using a common gateway.\n\n60\n00:03:09.510 --> 00:03:11.740\nBut if I wanna source traffic on this IP,\nI might need that.\n\n61\n00:03:11.740 --> 00:03:14.970\nSo I could punch that in if I\nreally wanted to, GATEWAY2 install.\n\n62\n00:03:14.970 --> 00:03:16.340\nI'll leave it off just for a time.\n\n63\n00:03:16.340 --> 00:03:19.940\nAnd I can say IPDADDR3,\nand start specifying more.\n\n64\n00:03:19.940 --> 00:03:22.510\nAnd I'm putting all these IP\naddresses in the same subnet,\n\n65\n00:03:22.510 --> 00:03:26.600\ncuz that's the most common, but\nthey don't have to be on the same subnet.\n\n66\n00:03:26.600 --> 00:03:30.410\nI could have 192.168.0 or something\ncompletely different if I really wanted to\n\n67\n00:03:30.410 --> 00:03:35.160\nall right here inside of this one adapter,\nright?\n\n68\n00:03:35.160 --> 00:03:39.270\nSo there's my three different IP\naddresses stuck on one adapter.\n\n69\n00:03:39.270 --> 00:03:42.420\nAll right, now that right\nthere solves my problem, and\n\n70\n00:03:42.420 --> 00:03:44.350\nit really wasn't even very hard, was it?\n\n71\n00:03:44.350 --> 00:03:46.120\nRight, and\njust adding these extra entries here.\n\n72\n00:03:46.120 --> 00:03:49.650\nBut there's one little problem with this,\nokay?\n\n73\n00:03:49.650 --> 00:03:55.350\nAnd that main problem is that if I wanna\ntake one of those IP addresses offline,\n\n74\n00:03:55.350 --> 00:03:56.670\nor if I wanna make a change,\n\n75\n00:03:56.670 --> 00:04:00.960\nif I wanna add another address I have\nto reset that network interface, right?\n\n76\n00:04:00.960 --> 00:04:03.220\nI have to do something like system CTL.\n\n77\n00:04:03.220 --> 00:04:06.530\nWell, I don't have to\nrestart the network service,\n\n78\n00:04:06.530 --> 00:04:10.220\nI could use the IP command or\nthe IFup command or the IFdown.\n\n79\n00:04:10.220 --> 00:04:12.600\nI could take the interface down and\nbring it back up.\n\n80\n00:04:12.600 --> 00:04:16.440\nI could use MCLI connection down\nif I was using network manager.\n\n81\n00:04:16.440 --> 00:04:17.620\nSo I could reset that interface, but\n\n82\n00:04:17.620 --> 00:04:22.750\nwhen I do it, it's resetting all\nof the IP's on that one interface.\n\n83\n00:04:22.750 --> 00:04:27.490\nSo any change that I make affects\neverybody using that interface and\n\n84\n00:04:27.490 --> 00:04:31.370\nthat's not necessarily what I want.\n\n85\n00:04:31.370 --> 00:04:33.900\nIn a ISP environment,\na hosting environment,\n\n86\n00:04:33.900 --> 00:04:37.490\nyou don't want one customer's\nchanges to affect other customers.\n\n87\n00:04:37.490 --> 00:04:40.690\nSo having everything nested on one\ninterface like this is a bit of a problem.\n\n88\n00:04:40.690 --> 00:04:46.500\nSo there's an advanced feature where\nwe can actually take a single interface\n\n89\n00:04:46.500 --> 00:04:50.130\nlike this and instead of sticking more\nthan one IP on it like I've done here.\n\n90\n00:04:50.130 --> 00:04:53.989\nSee, here's the three IPs,\n.100, .101, .102.\n\n91\n00:04:53.989 --> 00:04:58.060\nInstead of doing it that way I\ncould create virtual interfaces.\n\n92\n00:04:58.060 --> 00:05:01.800\nI can take the one physical interface and\ndivide it into virtual interfaces.\n\n93\n00:05:01.800 --> 00:05:05.650\nAnd by doing that,\nI can now deal with them individually.\n\n94\n00:05:05.650 --> 00:05:07.520\nAnd if I need to reset\na virtual interface,\n\n95\n00:05:07.520 --> 00:05:11.510\nthat's okay, because the parent\ninterface doesn't get affected.\n\n96\n00:05:11.510 --> 00:05:13.790\nDoesn't get messed with right?\n\n97\n00:05:13.790 --> 00:05:15.960\nSo looking at this one here,\n\n98\n00:05:15.960 --> 00:05:19.950\nI've created an environment that runs the\nrisk of one customer affecting another.\n\n99\n00:05:19.950 --> 00:05:22.520\nSo let's say that I wanted to change that.\n\n100\n00:05:22.520 --> 00:05:26.700\nAnd instead of doing these other\nIPs right on the interface,\n\n101\n00:05:26.700 --> 00:05:27.960\nI want to do them on virtual interfaces.\n\n102\n00:05:27.960 --> 00:05:31.770\nWell, the first thing that I need to do is\nundo the changes that I just made, right.\n\n103\n00:05:31.770 --> 00:05:34.690\nSo I'm gonna get rid of these extra IPs.\n\n104\n00:05:34.690 --> 00:05:35.970\nSo let me just get rid of those.\n\n105\n00:05:37.340 --> 00:05:38.765\nAnd we'll restart so they go away.\n\n106\n00:05:38.765 --> 00:05:43.670\nAo those are gone and I want to\nmake sure they are actually gone,\n\n107\n00:05:43.670 --> 00:05:44.950\nyeah so they are gone.\n\n108\n00:05:44.950 --> 00:05:46.670\nAnd now I'm gonna create\nsome virtual interfaces,\n\n109\n00:05:46.670 --> 00:05:49.350\nnow virtual interfaces\nare neat because what you do\n\n110\n00:05:49.350 --> 00:05:51.630\nis you create scripts for them.\n\n111\n00:05:51.630 --> 00:05:54.520\nAnd the scripts usually\nhave the same basic name.\n\n112\n00:05:54.520 --> 00:05:57.090\nSo I would say,\nI'll use the touch command.\n\n113\n00:05:57.090 --> 00:05:59.920\nI could just go in and\nedit it but I'll use touch first.\n\n114\n00:05:59.920 --> 00:06:04.060\nAnd say,\nifcfg-ens33 that's my primary adapter.\n\n115\n00:06:04.060 --> 00:06:06.969\nAnd then I'm gonna say :0.\n\n116\n00:06:06.969 --> 00:06:14.380\nOkay, that :0 is creating a sub interface,\na virtual sub interface.\n\n117\n00:06:14.380 --> 00:06:18.520\nAnd I could say :1, :2, and\n:3 and create as many as we need.\n\n118\n00:06:18.520 --> 00:06:21.110\nIn fact,\nI'm not even sure that there is a limit.\n\n119\n00:06:21.110 --> 00:06:22.760\nYou can really go high with these.\n\n120\n00:06:22.760 --> 00:06:25.600\nBut you don't typically\nneed all that many, right?\n\n121\n00:06:25.600 --> 00:06:28.410\nBut each one is a sub-interface.\n\n122\n00:06:28.410 --> 00:06:31.450\nAnd so now these are virtual\ninterfaces that I'm creating.\n\n123\n00:06:31.450 --> 00:06:35.730\n&gt;&gt; Now Don, for these scripts,\nare they the same as the parent?\n\n124\n00:06:35.730 --> 00:06:36.790\nOr are they different?\n\n125\n00:06:36.790 --> 00:06:37.720\n&gt;&gt; Well they're close.\n\n126\n00:06:37.720 --> 00:06:39.060\nThey're actually a lot easier, right?\n\n127\n00:06:39.060 --> 00:06:41.500\nBecause they're going to get a lot\nof their settings from the parent.\n\n128\n00:06:41.500 --> 00:06:44.160\nSo we only really have to put\nin here what's different.\n\n129\n00:06:44.160 --> 00:06:49.925\nIf I edit one of these,\nI'll start with ifcfg/ens33:0, right?\n\n130\n00:06:49.925 --> 00:06:50.947\nI'll start with that first one.\n\n131\n00:06:50.947 --> 00:06:53.330\nAnd I'm gonna come in here and\nI just need to add a few things.\n\n132\n00:06:53.330 --> 00:06:57.970\nI need to put a device name and\nthe device name here is ens33:0.\n\n133\n00:06:57.970 --> 00:07:01.010\nAnd then I need to say when\nI want this to turn on.\n\n134\n00:07:01.010 --> 00:07:05.920\nNow, on the parent interfaces you say\non boot, on these you say on parent.\n\n135\n00:07:05.920 --> 00:07:08.930\nIf the parent interface is turned off,\nall these interfaces are turned off.\n\n136\n00:07:08.930 --> 00:07:11.478\nS on boot doesn't really mean\nanything to these guys, right.\n\n137\n00:07:11.478 --> 00:07:13.000\nSo on these, it's on parent and\n\n138\n00:07:13.000 --> 00:07:16.860\nI'm gonna say yes if the parent interface\ncomes up I want this interface to come up.\n\n139\n00:07:16.860 --> 00:07:19.207\nAfter that,\nI just need to apply an IP Address, right?\n\n140\n00:07:19.207 --> 00:07:26.047\nSo I'm gonna give this one IP Address\n172.16.0.101 and a prefix of 24.\n\n141\n00:07:26.047 --> 00:07:28.287\nAnd that's it,\nI don't have to put all the other stuff.\n\n142\n00:07:28.287 --> 00:07:30.960\nAll the other stuff would just\ncome from the parent interface.\n\n143\n00:07:30.960 --> 00:07:34.940\nAnd so I can take that and I'll cheat\njust a little bit and copy that so\n\n144\n00:07:34.940 --> 00:07:37.300\nthat I don't have to do all this twice.\n\n145\n00:07:37.300 --> 00:07:42.240\nAnd I will send it over to ens33:1,\n\n146\n00:07:42.240 --> 00:07:46.980\nand then I will just edit that file and\nchange it to the other IP.\n\n147\n00:07:46.980 --> 00:07:49.200\nSo it's gonna be 102, all right?\n\n148\n00:07:49.200 --> 00:07:54.503\nAnd when that's done, I've now got my\nparent interface and these two scripts.\n\n149\n00:07:54.503 --> 00:07:58.580\nAnd if I take the parent down and bring\nthe parent up, that would bring these up.\n\n150\n00:07:58.580 --> 00:08:03.015\nSo this is the only interface I've got\nis actually a little easier to just say\n\n151\n00:08:03.015 --> 00:08:07.040\nSystems, cto,\nrestart it's not easier if I can't type.\n\n152\n00:08:07.040 --> 00:08:09.520\nRestart, network, dot service and\n\n153\n00:08:09.520 --> 00:08:12.940\nthat's going to restart it and\nit should bring the parent up.\n\n154\n00:08:12.940 --> 00:08:14.730\nThe parent should bring\nthe other interfaces up.\n\n155\n00:08:14.730 --> 00:08:20.410\nSo if I do an ipaddr and\ntake a look I can see here's ens33 and\n\n156\n00:08:20.410 --> 00:08:25.340\njust like before I've got 173 out of\n16 out of 0 out of 100, 101, 102,\n\n157\n00:08:25.340 --> 00:08:28.770\nactually 102 is missing, so\napparently I've got a problem in that one.\n\n158\n00:08:28.770 --> 00:08:30.470\nI'll have to check my file.\n\n159\n00:08:30.470 --> 00:08:34.791\nBut so there they are, and if you look\nit kind of looks like it did before but\n\n160\n00:08:34.791 --> 00:08:38.571\nthe difference is,\nsee how this one says scope global ens33?\n\n161\n00:08:38.571 --> 00:08:43.512\nAnd then this one says scope\nglobal secondary ens33:0.\n\n162\n00:08:43.512 --> 00:08:46.540\nIt's that sub interface, right.\n\n163\n00:08:46.540 --> 00:08:48.500\nAnd, I know what my problem is.\n\n164\n00:08:48.500 --> 00:08:50.470\nRemember how I copied that file?\n\n165\n00:08:50.470 --> 00:08:53.490\nI said I'll just copy the file and\nsave some time, and then I went and\n\n166\n00:08:53.490 --> 00:08:54.220\nedited the IP.\n\n167\n00:08:54.220 --> 00:08:57.090\nI kind of forgot to change\nthe device name up here and so\n\n168\n00:08:57.090 --> 00:09:00.720\nI left this device name called\n33:0 which is not right.\n\n169\n00:09:00.720 --> 00:09:04.248\nSo I need to make that device name right,\nit should be 33:1.\n\n170\n00:09:04.248 --> 00:09:06.779\nAnd then, I can restart the network.\n\n171\n00:09:07.920 --> 00:09:10.180\nOr just take the interface down and\nbring it back up.\n\n172\n00:09:10.180 --> 00:09:14.210\nAnd then go in here and now there's my\nmissing IP, it's come home to roost.\n\n173\n00:09:14.210 --> 00:09:20.270\nAnd I've got ens33:1, ens33:0 so\nI've created these subinterfaces,\n\n174\n00:09:20.270 --> 00:09:25.250\nand the end result is not much different\nthan if I had just used IPaddr1, IPaddr2,\n\n175\n00:09:25.250 --> 00:09:27.630\nthe main difference here being,\n\n176\n00:09:27.630 --> 00:09:31.000\nI can now take one of these\nsubinterfaces down by itself.\n\n177\n00:09:31.000 --> 00:09:32.490\nAnd leave all the other ones up.\n\n178\n00:09:32.490 --> 00:09:34.850\nSo now I'm able to work with\nthose without impacting the rest.\n\n179\n00:09:34.850 --> 00:09:35.920\nAnd that's a really nice feature,\n\n180\n00:09:35.920 --> 00:09:39.890\nespecially if you're doing multiple\nIP addresses for websites.\n\n181\n00:09:39.890 --> 00:09:42.050\nThat's really where I\nsee this used the most.\n\n182\n00:09:42.050 --> 00:09:44.280\nDefinitely a very useful\nfeature to have for that.\n\n183\n00:09:44.280 --> 00:09:48.510\n&gt;&gt; Now is there a way that we can take\nmore than one physical interface and\n\n184\n00:09:48.510 --> 00:09:49.920\nmake it one?\n\n185\n00:09:49.920 --> 00:09:52.200\nYeah, basically that the opposite\nof what we just did.\n\n186\n00:09:52.200 --> 00:09:52.830\n&gt;&gt; Yes.\n\n187\n00:09:52.830 --> 00:09:55.340\n&gt;&gt; So what we just did is we\ntook a physical interface, and\n\n188\n00:09:55.340 --> 00:09:57.870\nwe divide it in more than\none virtual interface.\n\n189\n00:09:57.870 --> 00:10:00.642\nBut we can take more that\none physical interface and\n\n190\n00:10:00.642 --> 00:10:03.167\ncombined them to make\none virtual interface.\n\n191\n00:10:03.167 --> 00:10:05.880\nNow, you might ask yourself\nwhy the heck I would do that?\n\n192\n00:10:05.880 --> 00:10:07.157\n&gt;&gt; Why the heck you would do that Don?\n\n193\n00:10:07.157 --> 00:10:09.090\n[LAUGH].\nAnd there's a few different reasons for\n\n194\n00:10:09.090 --> 00:10:09.970\nit right?\n\n195\n00:10:09.970 --> 00:10:13.730\nThe first reason might be for\nredundancy availability, right?\n\n196\n00:10:13.730 --> 00:10:16.030\nWhat happens if my\nnetwork interface fails?\n\n197\n00:10:16.030 --> 00:10:18.050\nWell all these interfaces go down right?\n\n198\n00:10:18.050 --> 00:10:20.520\nThe virtual interface, the physical\ninterface, it all just goes down.\n\n199\n00:10:20.520 --> 00:10:22.770\nSo if I have a highly available site,\n\n200\n00:10:22.770 --> 00:10:26.160\na website I need up as much as possible\nI might want to plan for that.\n\n201\n00:10:26.160 --> 00:10:28.900\nHey, if one network interface goes down,\nwouldn't it be nice if there was\n\n202\n00:10:28.900 --> 00:10:32.200\na second interface that was ready\nto take over at a moment's notice?\n\n203\n00:10:32.200 --> 00:10:35.640\nYou can do that if you've\ngrouped your physical interfaces\n\n204\n00:10:35.640 --> 00:10:39.050\ntogether to create fail-over, right.\n\n205\n00:10:39.050 --> 00:10:40.950\nBut you can also do it for performance.\n\n206\n00:10:40.950 --> 00:10:44.880\nMaybe I've got four one gigabit adapters,\nright, so\n\n207\n00:10:44.880 --> 00:10:46.850\neach one has a gigabit of bandwidth.\n\n208\n00:10:46.850 --> 00:10:48.740\nWouldn't it be nice if we\ncould combine that and\n\n209\n00:10:48.740 --> 00:10:50.820\nhave a a four gigabit adapter, right?\n\n210\n00:10:50.820 --> 00:10:51.900\nNow I can move that much more data.\n\n211\n00:10:51.900 --> 00:10:54.700\nOr if I had ten gig adapters I could\nget up to 40 gigs of traffic or\n\n212\n00:10:54.700 --> 00:10:56.010\nhowever many adapters you have right?\n\n213\n00:10:56.010 --> 00:11:01.290\nMaybe you just have two so you combine\nthem and you get two gigs of traffic.\n\n214\n00:11:01.290 --> 00:11:03.820\nAnd if I one fails you just drop down and\nnow you got one gig of traffic.\n\n215\n00:11:03.820 --> 00:11:06.830\nSo now you get performance\nimprovements and availability.\n\n216\n00:11:06.830 --> 00:11:10.610\nThose are all reasons why we might choose\nto group those physical adapters together.\n\n217\n00:11:10.610 --> 00:11:13.420\nInto one virtual adapter and\nwe can certainly do that.\n\n218\n00:11:13.420 --> 00:11:17.391\n&gt;&gt; That's fantastic so\nis that like one size fits all,\n\n219\n00:11:17.391 --> 00:11:20.557\nI mean is that we're talking about here?\n\n220\n00:11:20.557 --> 00:11:23.640\n&gt;&gt; Well, I mentioned performance.\n\n221\n00:11:23.640 --> 00:11:24.350\n&gt;&gt; Yeah.\n\n222\n00:11:24.350 --> 00:11:28.530\n&gt;&gt; And availability, right there are times\nwhere we don't care about performance,\n\n223\n00:11:28.530 --> 00:11:30.850\nwe just care about availability.\n\n224\n00:11:30.850 --> 00:11:33.510\nAnd there are times when just\ncare about performance and\n\n225\n00:11:33.510 --> 00:11:34.750\nwe don't care about availability at all.\n\n226\n00:11:34.750 --> 00:11:36.520\nAnd then there's times where we want both,\nright?\n\n227\n00:11:36.520 --> 00:11:40.020\nAnd so when we configure this,\nwe've actually got the ability to pick and\n\n228\n00:11:40.020 --> 00:11:40.840\nchose, right?\n\n229\n00:11:40.840 --> 00:11:43.190\nTo chose between the different ones.\n\n230\n00:11:43.190 --> 00:11:46.950\nSo it's not really a one side fits all,\nwe don't just turn this on and that it.\n\n231\n00:11:46.950 --> 00:11:48.308\nWe gotta pick what we\nwant to achieve right.\n\n232\n00:11:48.308 --> 00:11:49.450\n&gt;&gt; Okay.\n\n233\n00:11:49.450 --> 00:11:53.600\n&gt;&gt; If I'm just focused on availability\nI could take two adapters and\n\n234\n00:11:53.600 --> 00:11:56.530\nI could put them into an active\npassive role, where you have\n\n235\n00:11:56.530 --> 00:12:00.160\none adapter that's active and\nrunning and the other one is in standby.\n\n236\n00:12:00.160 --> 00:12:03.900\nAnd as soon as the active one fails,\nyou jump over to the standby, right.\n\n237\n00:12:03.900 --> 00:12:07.470\nThat configuration is really simple to do,\nit's very stable and reliable.\n\n238\n00:12:07.470 --> 00:12:09.310\nBut it doesn't improve your performance.\n\n239\n00:12:09.310 --> 00:12:13.460\nIf I have a gigabyte adaptor as my active,\nand a gigabyte as my stand by, and\n\n240\n00:12:13.460 --> 00:12:16.920\nI fail over, I'm just a gigabyte the whole\ntime, it never changes, all right.\n\n241\n00:12:16.920 --> 00:12:19.820\nBut if I want to balance across them and\n\n242\n00:12:19.820 --> 00:12:23.270\nhave it where I'm getting really\nhigh performance, like two gigabyte.\n\n243\n00:12:23.270 --> 00:12:26.440\nWell I don't wanna do an active and\na passive I want them both active.\n\n244\n00:12:26.440 --> 00:12:28.930\nAnd when they're both active\n\n245\n00:12:28.930 --> 00:12:31.490\nhow do you pick which traffic is\ngoing to which DAP array right.\n\n246\n00:12:31.490 --> 00:12:33.970\nWe need some kind of logic\ngoing behind the scenes, and\n\n247\n00:12:33.970 --> 00:12:35.130\nthere's a number of different choices.\n\n248\n00:12:35.130 --> 00:12:37.730\nActually when we set this up there's\n\n249\n00:12:37.730 --> 00:12:41.230\nseven different modes that\nwe can pick from right.\n\n250\n00:12:41.230 --> 00:12:45.010\nThe first mode is what's called\nbalance RR, which is round robin.\n\n251\n00:12:45.010 --> 00:12:47.340\nRound robin says that as traffic comes in,\n\n252\n00:12:47.340 --> 00:12:51.690\nI'll send my first packet on interface\none, my second packet on interface two.\n\n253\n00:12:51.690 --> 00:12:54.330\nMy third packet on interface one,\nmy fourth packet on interface two.\n\n254\n00:12:54.330 --> 00:12:56.000\nYou just go back and forth,\nround and robin, right.\n\n255\n00:12:56.000 --> 00:13:00.210\nThat's all it is Very simple model,\nIt's not perfect but it works, right?\n\n256\n00:13:00.210 --> 00:13:03.715\nAs sessions come in, the sessions are\nbeing round-robined between the adaptors.\n\n257\n00:13:03.715 --> 00:13:07.415\n&gt;&gt; So then if we are round-robining\n[LAUGH] is this sort of like\n\n258\n00:13:07.415 --> 00:13:09.675\na perfect balance,\nlike a 50 to 50 balance?\n\n259\n00:13:09.675 --> 00:13:11.488\n&gt;&gt; You'd think it would be.\n\n260\n00:13:11.488 --> 00:13:14.456\nYou have two adapters, you go back and\nforth, but the problem is,\n\n261\n00:13:14.456 --> 00:13:17.215\nsometimes a session is open\nlonger than other times, right?\n\n262\n00:13:17.215 --> 00:13:19.645\nSomebody might have a session when\nthey're only on your site for one minute,\n\n263\n00:13:19.645 --> 00:13:21.475\nand another person is on there for\nan hour.\n\n264\n00:13:21.475 --> 00:13:23.440\nSo if you're round-robining sessions, and\n\n265\n00:13:23.440 --> 00:13:26.220\nyou get a bunch of one hour\ntypes on your first adapter and\n\n266\n00:13:26.220 --> 00:13:29.800\na bunch of one minute types on your second\nadapter it can get uneven pretty quick.\n\n267\n00:13:29.800 --> 00:13:32.760\nThere are are other modes\nwe can choose for that.\n\n268\n00:13:32.760 --> 00:13:36.210\nThey can be a little more even, but they\nrequire a little more processor power,\n\n269\n00:13:36.210 --> 00:13:37.530\na little more effort on the system.\n\n270\n00:13:37.530 --> 00:13:40.030\nSo you wanna make sure you\nfind the perfect balance.\n\n271\n00:13:40.030 --> 00:13:44.260\nFor example there is what you\ncall Balance XOR Xor takes a hash\n\n272\n00:13:44.260 --> 00:13:47.330\nof the Mac address of the traffic coming\nthrough to better identify which one\n\n273\n00:13:47.330 --> 00:13:50.490\ngoes to which adapter and try and\nkeep track of those sessions.\n\n274\n00:13:50.490 --> 00:13:52.350\nYou've got broadcast,\n\n275\n00:13:52.350 --> 00:13:55.005\nbroadcast actually doesn't give you\nperformance increases at all, it's.\n\n276\n00:13:55.005 --> 00:13:58.165\nAll traffic out all networks all the time.\n\n277\n00:13:58.165 --> 00:14:02.775\nSo it's really focused on high\navailability, not focused on performance.\n\n278\n00:14:02.775 --> 00:14:07.665\nThere is balanced TLB,\nwhich is transmission load balancing.\n\n279\n00:14:07.665 --> 00:14:11.225\nThat means it's load balancing based\non who we're sending to, right?\n\n280\n00:14:11.225 --> 00:14:14.970\nSo as we respond back to people,\nwe're balancing based on that.\n\n281\n00:14:14.970 --> 00:14:17.720\nAnd there's an alternative\nwhich is called balance ABL,\n\n282\n00:14:17.720 --> 00:14:21.660\nwhich is an active load balancing, which\ntries to balance both based on us and\n\n283\n00:14:21.660 --> 00:14:23.590\nthe people remotely to\nget even distributions.\n\n284\n00:14:23.590 --> 00:14:27.520\nAnd there's one more, which is probably\none of the more common ones that you'll\n\n285\n00:14:27.520 --> 00:14:31.932\nhear about out there, which is called link\naggregation control protocol, or LAC P.\n\n286\n00:14:31.932 --> 00:14:38.480\nLack p, it's gotta number, it's\n802.3ad I know it's in my notes there.\n\n287\n00:14:38.480 --> 00:14:40.040\nThat one is really nice.\n\n288\n00:14:40.040 --> 00:14:42.590\nIf you're not really wanting the server\nto handle the load balancing but\n\n289\n00:14:42.590 --> 00:14:45.950\nyou want a switch to do it, a lot of\nnetworks would just can do lack p for\n\n290\n00:14:45.950 --> 00:14:47.950\nyou and distribute traffic for\nyou across those links.\n\n291\n00:14:47.950 --> 00:14:50.800\nSo you can now talk and participate\ndirectly with the Switch for that.\n\n292\n00:14:50.800 --> 00:14:53.680\nSo all of these are different choices for\nhow you want to configure it,\n\n293\n00:14:53.680 --> 00:14:56.360\nyou've got to pick the one that's\nright for your environment.\n\n294\n00:14:56.360 --> 00:14:59.400\n&gt;&gt; Okay, so, how do we get this started?\n\n295\n00:14:59.400 --> 00:15:00.490\nHow do we start up?\n\n296\n00:15:00.490 --> 00:15:02.290\n&gt;&gt; So if we want to get\nsomething like this set up,\n\n297\n00:15:02.290 --> 00:15:05.580\nthere's a couple of steps that we have\nto go through, and what I'm gonna do is,\n\n298\n00:15:05.580 --> 00:15:08.600\nI've got a couple of extra interfaces on\nmy system I haven't messed with yet, so\n\n299\n00:15:08.600 --> 00:15:12.110\nlike ens.37 and .38, they're just\nsitting there, I haven't used them.\n\n300\n00:15:12.110 --> 00:15:15.550\nSo I wanna take .37 and\n.38 and bond them together.\n\n301\n00:15:15.550 --> 00:15:19.390\nSo the first thing I need to do is\nI need to create a bond interface.\n\n302\n00:15:19.390 --> 00:15:21.790\nAnd a bond interface is a virtual\ninterface, it's not real.\n\n303\n00:15:21.790 --> 00:15:24.360\nSo just like the sub interface\nwe created moments ago,\n\n304\n00:15:24.360 --> 00:15:26.930\nthis one is going to\nbe a fake one as well.\n\n305\n00:15:26.930 --> 00:15:31.085\nSo I'm gonna come in and create\nanother script, which I'm gonna call\n\n306\n00:15:31.085 --> 00:15:35.780\nifcfg-bond followed by a number.\n\n307\n00:15:35.780 --> 00:15:37.920\nAnd you can pick the number, but\nbond0's normally where we start,\n\n308\n00:15:37.920 --> 00:15:39.710\nso I'm creating a bond interface.\n\n309\n00:15:41.150 --> 00:15:45.410\nAnd then in that interface this is where\nI'm gonna specify my main configuration.\n\n310\n00:15:45.410 --> 00:15:48.220\nBecause this configuration is gonna\nbe shared across each of the physical\n\n311\n00:15:48.220 --> 00:15:49.340\ninterfaces, right?\n\n312\n00:15:49.340 --> 00:15:52.234\nSo I'm gonna say device=bond0, right?\n\n313\n00:15:52.234 --> 00:15:53.940\nThat's the bond that I'm making.\n\n314\n00:15:53.940 --> 00:15:55.739\nAnd then I'll say onboot=yes.\n\n315\n00:15:55.739 --> 00:15:58.153\nThis is all just like any regular adaptor,\n\n316\n00:15:58.153 --> 00:16:01.718\nthere's not really any different\nas we go through and do this.\n\n317\n00:16:01.718 --> 00:16:03.239\nI'll give it an IP address.\n\n318\n00:16:03.239 --> 00:16:07.798\nI'm gonna have one IP address, even though\nthere's multiple physical interfaces.\n\n319\n00:16:07.798 --> 00:16:12.664\nI'll make this 172.16.0.105,\nhow about that?\n\n320\n00:16:12.664 --> 00:16:18.896\nI'll set a PREFIX of 24,\nwe'll do, what else?\n\n321\n00:16:18.896 --> 00:16:22.068\nBOOTPROTO=none, right?\n\n322\n00:16:22.068 --> 00:16:25.265\nI don't need the HTP,\ncuz I'm doing a static address.\n\n323\n00:16:25.265 --> 00:16:28.171\nAnd then, here's the important one, okay?\n\n324\n00:16:28.171 --> 00:16:32.074\nBONDING_OPTS right, bonding options.\n\n325\n00:16:32.074 --> 00:16:37.021\nBONDING_OPTS =, and\nthen which mode I want it to be in.\n\n326\n00:16:37.021 --> 00:16:38.347\nYou're gonna say mode =, and\n\n327\n00:16:38.347 --> 00:16:41.830\nthen you're going to specify one of\nthose various modes that I mentioned.\n\n328\n00:16:41.830 --> 00:16:47.120\nSo you might say active-backup as\nthe mode that you want, right?\n\n329\n00:16:47.120 --> 00:16:50.340\nOne interface will go active,\nthe other one will be held in reserve.\n\n330\n00:16:50.340 --> 00:16:53.700\nOr you might wanna do\nthe balance-roundrobin or\n\n331\n00:16:53.700 --> 00:16:55.065\none of the other ones.\n\n332\n00:16:55.065 --> 00:16:59.707\nBalance-alb gives you\nthe best load balancing.\n\n333\n00:16:59.707 --> 00:17:02.005\nIt'll make sure your traffic\nis as even as possible.\n\n334\n00:17:02.005 --> 00:17:04.455\nBut it eats up a lot of\nresources to do that.\n\n335\n00:17:04.455 --> 00:17:05.967\nSo we've gotta find that balance.\n\n336\n00:17:05.967 --> 00:17:06.945\nSo I might say you know what?\n\n337\n00:17:06.945 --> 00:17:11.305\nI'm gonna do tlb,\nwhich is not as perfect but pretty decent.\n\n338\n00:17:11.305 --> 00:17:13.135\nOr you know what forget it,\nI'll just do round robin.\n\n339\n00:17:13.135 --> 00:17:16.380\nRound robin has almost no overhead to it,\ncuz you're just back and\n\n340\n00:17:16.380 --> 00:17:17.010\nforth, back and forth.\n\n341\n00:17:17.010 --> 00:17:18.460\nBut it's just not perfect, right?\n\n342\n00:17:18.460 --> 00:17:22.440\nSo I'm picking which mode that\nI wanna use right there, okay?\n\n343\n00:17:22.440 --> 00:17:25.940\nAnd once I've got that mode set,\nthat's my bond, right?\n\n344\n00:17:26.970 --> 00:17:31.020\nSo that's all the information\nit needs almost.\n\n345\n00:17:31.020 --> 00:17:33.200\nI kinda need to tell it\nwhich adapters it can use.\n\n346\n00:17:33.200 --> 00:17:34.260\nSo it doesn't know that yet.\n\n347\n00:17:34.260 --> 00:17:35.970\nIt doesn't know which\nadaptors are part of it.\n\n348\n00:17:35.970 --> 00:17:39.380\nSo in order to do that,\nI do need to create a script for\n\n349\n00:17:39.380 --> 00:17:40.680\neach of the other interfaces.\n\n350\n00:17:40.680 --> 00:17:45.027\nSo if I want 37 and\n38 to be a part of that,\n\n351\n00:17:45.027 --> 00:17:51.391\nI'm gonna need to come in and\ncreate a IFCFG-ENS37, right?\n\n352\n00:17:51.391 --> 00:17:53.541\nSo I'm gonna create a script for\nthat interface and\n\n353\n00:17:53.541 --> 00:17:57.300\nin that interface this is where it's\ngonna be a little bit different, right?\n\n354\n00:17:57.300 --> 00:18:03.724\nI need to come in and\nsay DEVICE=ens37, right?\n\n355\n00:18:03.724 --> 00:18:08.720\nSo that's my device name,\nI need to say MASTER=bond0, right,\n\n356\n00:18:08.720 --> 00:18:11.370\nwe haven't used that tag yet.\n\n357\n00:18:11.370 --> 00:18:14.930\nThat's what's gonna tell this physical\ninterface that it's part of a bond.\n\n358\n00:18:14.930 --> 00:18:17.660\nIt's gonna join bond zero all right.\n\n359\n00:18:17.660 --> 00:18:21.640\nFrom there,\nwe need to say slave equals yes, so\n\n360\n00:18:21.640 --> 00:18:24.790\nit knows that this adapter\nis not making the decisions.\n\n361\n00:18:24.790 --> 00:18:26.930\nThe bond is making the decisions.\n\n362\n00:18:28.370 --> 00:18:32.420\nThen, boot proto equals none because\nwe don't want this interface\n\n363\n00:18:32.420 --> 00:18:34.440\ngetting a configuration on its own.\n\n364\n00:18:34.440 --> 00:18:37.594\nAnd then I'll say ONBOOT=yes, all right.\n\n365\n00:18:37.594 --> 00:18:41.940\nNow normally when I say BOOTPROTO=none I\nfollow this up with IP address and suffix.\n\n366\n00:18:41.940 --> 00:18:44.940\nBut in this case,\nall that is coming from the pond.\n\n367\n00:18:44.940 --> 00:18:47.980\nSo this is really all\nI need to specify for\n\n368\n00:18:47.980 --> 00:18:50.440\nthis interface to be a part of the bond.\n\n369\n00:18:50.440 --> 00:18:53.274\nAnd I can save that file.\n\n370\n00:18:53.274 --> 00:18:55.850\nAnd I'm gonna copy it.\n\n371\n00:18:55.850 --> 00:18:58.470\nI'll try and\nnot make the same mistake I made early.\n\n372\n00:18:58.470 --> 00:19:05.958\nSo I'm gonna copy that one to ens.38 and\nthen I'll edit that file.\n\n373\n00:19:05.958 --> 00:19:08.359\nAnd I just need to change\nthat device name there.\n\n374\n00:19:08.359 --> 00:19:10.440\nCuz everything else is pretty common,\nright?\n\n375\n00:19:10.440 --> 00:19:12.710\nIt's all gonna be part of bond zero.\n\n376\n00:19:12.710 --> 00:19:16.980\nSo those scripts are gonna tell\nthem that their apart of bond zero.\n\n377\n00:19:16.980 --> 00:19:20.940\nAnd now that that's done all I\nneed to do is make the system\n\n378\n00:19:20.940 --> 00:19:22.430\naware that the bond exists.\n\n379\n00:19:22.430 --> 00:19:26.011\nNow I know we've got that\nbond zero file right there.\n\n380\n00:19:26.011 --> 00:19:29.666\nAnd so you would think that's enough for\nit to look and know that it's a bond,\n\n381\n00:19:29.666 --> 00:19:32.045\nbut there is actually one\nmore thing we need to do.\n\n382\n00:19:32.045 --> 00:19:35.690\nHardware is detected by a service\ncalled modprobe, right?\n\n383\n00:19:35.690 --> 00:19:38.250\nIt's probing for\nhardware to figure out which modules,\n\n384\n00:19:38.250 --> 00:19:40.490\nwhich drivers to load, okay?\n\n385\n00:19:40.490 --> 00:19:42.262\nWhen it looks to this and\nit sees bond zero,\n\n386\n00:19:42.262 --> 00:19:44.300\nthere's no hardware that\ncorresponds to that.\n\n387\n00:19:44.300 --> 00:19:46.714\nSo modprobe isn't gonna find it,\nand it's gonna get ignored,\n\n388\n00:19:46.714 --> 00:19:48.290\nthat file is not gonna get read.\n\n389\n00:19:48.290 --> 00:19:52.410\nSo we need to tell the module\nprobe that we have a bond.\n\n390\n00:19:52.410 --> 00:19:56.260\nSo the way we do that is\nby creating a file, so\n\n391\n00:19:56.260 --> 00:20:01.440\ninside of /etc,\nyou've got modprobe.d as a folder.\n\n392\n00:20:01.440 --> 00:20:05.750\nAnd in that folder are configuration files\nfor any custom hardware that you have.\n\n393\n00:20:05.750 --> 00:20:07.890\nAnytime you load a custom\nlike a third-party driver,\n\n394\n00:20:07.890 --> 00:20:09.760\nit'll put an entry in here.\n\n395\n00:20:09.760 --> 00:20:14.730\nSo I need to create an entry in here for\nmy bond and\n\n396\n00:20:14.730 --> 00:20:17.740\nyou can call it whatever you want really,\nbut I'll call mine bonding.conf, right?\n\n397\n00:20:19.090 --> 00:20:23.530\nAnd I'm gonna tell it in here\nthat I am going to have an alias,\n\n398\n00:20:24.590 --> 00:20:29.300\nand my alias is bond0 bonding, okay.\n\n399\n00:20:29.300 --> 00:20:33.690\nThat's gonna tell it I'm gonna create\nfake hardware called bond0, and\n\n400\n00:20:33.690 --> 00:20:35.990\nthe hardware type is bonding right.\n\n401\n00:20:35.990 --> 00:20:40.810\nSo it will know to load the bonding\nmodule, the bonding driver and look for\n\n402\n00:20:40.810 --> 00:20:43.780\na configuration for bond 0 and\nit will make that fake hardware.\n\n403\n00:20:43.780 --> 00:20:46.640\nThis is really important, otherwise\nthe whole thing doesn't work, right?\n\n404\n00:20:46.640 --> 00:20:48.720\nBecause the bond is\ntechnically fake hardware.\n\n405\n00:20:48.720 --> 00:20:50.690\nIt's a virtual interface, and\n\n406\n00:20:50.690 --> 00:20:53.030\nthe physical interfaces are gonna\nbecome a part of it, all right?\n\n407\n00:20:53.030 --> 00:20:57.629\nBut once I've got that in place we\ncan get out of our configuration, and\n\n408\n00:20:57.629 --> 00:20:59.938\nnow it has everything that we need.\n\n409\n00:20:59.938 --> 00:21:02.998\n&gt;&gt; Don, not only do we've got\nmodules to that, we're done, right?\n\n410\n00:21:02.998 --> 00:21:05.040\n&gt;&gt; Well, close right, we're really close.\n\n411\n00:21:05.040 --> 00:21:08.072\nSo first off,\nwell there's two things, right?\n\n412\n00:21:08.072 --> 00:21:10.004\nSo one, we've created the model,\nand we haven't loaded it, right?\n\n413\n00:21:10.004 --> 00:21:12.250\nMod probe does its job\nreally when you boot up.\n\n414\n00:21:12.250 --> 00:21:15.190\nSo I can reboot,\nit's one way to deal with this, or\n\n415\n00:21:15.190 --> 00:21:18.200\nI can just tell Mod Probe to\nredetect it load that module.\n\n416\n00:21:18.200 --> 00:21:20.232\nAnd then after that,\nI need to test to make sure it works.\n\n417\n00:21:20.232 --> 00:21:21.530\nBecause there's a lot of\nmoving parts here, right?\n\n418\n00:21:21.530 --> 00:21:22.270\n&gt;&gt; There is a lot of moving parts.\n\n419\n00:21:22.270 --> 00:21:23.830\n&gt;&gt; I could have made a mistake\nhere anywhere along the ways.\n\n420\n00:21:23.830 --> 00:21:26.400\nSo, the first thing I'm gonna do is,\nI'm gonna tell modprobe to do it's job.\n\n421\n00:21:26.400 --> 00:21:31.930\nSo, I'm gonna come in here and\njust say, modprobe, bonding, right?\n\n422\n00:21:31.930 --> 00:21:34.300\nAnd that's gonna make it look for\nthat bonding.com file.\n\n423\n00:21:34.300 --> 00:21:37.300\nIf you named it something else, you would\nneed to type the different name here,\n\n424\n00:21:37.300 --> 00:21:38.800\nyou'd just leave the .com off.\n\n425\n00:21:38.800 --> 00:21:41.800\nBut I'm telling modprobe\nto load that module.\n\n426\n00:21:41.800 --> 00:21:47.840\nSo now it knows, it expects to see\nvirtual hardware that's a bond.\n\n427\n00:21:47.840 --> 00:21:51.790\nAnd from here, I can either take\nthat physical interface down and\n\n428\n00:21:51.790 --> 00:21:55.640\nup or usually I would just\nrestart the network service.\n\n429\n00:21:55.640 --> 00:22:00.260\nSo I will restart the network.service,\nand we'll restart it.\n\n430\n00:22:00.260 --> 00:22:01.280\nNow if I had a mistake,\n\n431\n00:22:01.280 --> 00:22:04.400\nwhich apparently I do,\nthen you may get an error like this right.\n\n432\n00:22:04.400 --> 00:22:06.880\nSo I got an error which means\nI messed up one of my files,\n\n433\n00:22:06.880 --> 00:22:09.780\nso actually I think know\nwhich one I messed up.\n\n434\n00:22:09.780 --> 00:22:12.890\nJust a real quick scan,\nI know it's not my bonding module or\n\n435\n00:22:12.890 --> 00:22:15.770\nI would have gotten an error right here,\nso I know I'm clear there.\n\n436\n00:22:15.770 --> 00:22:18.860\nSo my problem is in one of my interfaces,\nand I think I know what it is.\n\n437\n00:22:18.860 --> 00:22:22.770\nBut actually here we can use\njournalctl to get a better idea.\n\n438\n00:22:22.770 --> 00:22:25.430\nIt's actually telling us to\nlook at our journal and see.\n\n439\n00:22:25.430 --> 00:22:30.000\nAnd as I look I can see,\nwe got network service process exited,\n\n440\n00:22:30.000 --> 00:22:35.020\nand here,\nbring up interface ENS38 error connection.\n\n441\n00:22:35.020 --> 00:22:37.540\nAnd then whatever the error is\nactually scrolling off the screen.\n\n442\n00:22:37.540 --> 00:22:40.675\nSo sometimes that happens and I would need\nto like, dump this to a text file and\n\n443\n00:22:40.675 --> 00:22:41.892\nactually read the rest of it.\n\n444\n00:22:41.892 --> 00:22:46.940\nBut notice how I've got an error on\nENS 38 and ENS 37, that's a pretty\n\n445\n00:22:46.940 --> 00:22:51.924\ngood indicator that I had a typo in\nmy bond not the individual interface.\n\n446\n00:22:51.924 --> 00:22:54.300\nAlthough I did copy those files,\nso we can check them all.\n\n447\n00:22:54.300 --> 00:22:59.390\nSo if I just jump back into\nSYS CONFIG slash network scripts.\n\n448\n00:22:59.390 --> 00:22:59.890\nWhoops and\n\n449\n00:22:59.890 --> 00:23:04.450\nI'll spell that right see that's usually\nthe problem is just simple typing.\n\n450\n00:23:04.450 --> 00:23:09.480\nI can come in here and\nfind out, what I did wrong, and\n\n451\n00:23:09.480 --> 00:23:13.060\nI'm gonna start with the bond cuz\nthat's where I think the problem is.\n\n452\n00:23:13.060 --> 00:23:17.070\nAnd if I look at bond0, so\nI've got the device to find,\n\n453\n00:23:17.070 --> 00:23:21.820\nI've got on boot, and actually I'm missing\na very important line on this one, so\n\n454\n00:23:21.820 --> 00:23:23.140\nthat's what my problems gonna be.\n\n455\n00:23:23.140 --> 00:23:26.060\nOr at least one of my problems,\nI've got many today.\n\n456\n00:23:26.060 --> 00:23:26.798\n&gt;&gt; A live action debugging.\n\n457\n00:23:26.798 --> 00:23:28.640\n&gt;&gt; All right, so we go into this one.\n\n458\n00:23:28.640 --> 00:23:30.340\nOne thing that I left out here.\n\n459\n00:23:30.340 --> 00:23:34.310\nRemember in the sub interfaces where I\nput in, I had to say they were slaves,\n\n460\n00:23:34.310 --> 00:23:37.260\nas in slaves equals yes, and\nmaster equals bond zero.\n\n461\n00:23:37.260 --> 00:23:38.850\nSo I was pointing on the bond zero.\n\n462\n00:23:38.850 --> 00:23:42.310\nWell, on the master, there's\na similar line that we need to add.\n\n463\n00:23:42.310 --> 00:23:47.234\nI need to add an entry in\nhere that says that this one\n\n464\n00:23:47.234 --> 00:23:50.414\nis a bonding master equals yes.\n\n465\n00:23:50.414 --> 00:23:52.666\nAll right it needs to know\nthat it's in control.\n\n466\n00:23:52.666 --> 00:23:56.443\nThe other guys say SLAVE = yes,\nthis one says BONDING_MASTER = yes.\n\n467\n00:23:56.443 --> 00:23:59.067\nIf I leave that out,\nit doesn't know that it's a bond.\n\n468\n00:23:59.067 --> 00:24:02.610\nAnd if it doesn't know it's a bond,\nthen the other adapters can't join it.\n\n469\n00:24:02.610 --> 00:24:04.870\nAnd I can almost guarantee you\nthat's what my problem is there.\n\n470\n00:24:04.870 --> 00:24:06.470\nSo I will fix that.\n\n471\n00:24:06.470 --> 00:24:11.960\nAnd now that it's fixed,\nwe can restart that network service and\n\n472\n00:24:11.960 --> 00:24:14.060\nsee if all of our problems go away.\n\n473\n00:24:15.140 --> 00:24:18.690\nAnd, looks like it did.\n\n474\n00:24:18.690 --> 00:24:22.280\nOkay, so now my service has restarted.\n\n475\n00:24:22.280 --> 00:24:24.010\nIf I do a quick ipaddr and\n\n476\n00:24:24.010 --> 00:24:27.040\nlook at my IP addresses I got a couple\nof different things popping up here.\n\n477\n00:24:27.040 --> 00:24:28.810\nBut what I'm looking for\nis this guy right here.\n\n478\n00:24:28.810 --> 00:24:32.170\nI have a bond0 interface.\n\n479\n00:24:32.170 --> 00:24:35.050\nAnd it's showing 172.16.0.105.\n\n480\n00:24:35.050 --> 00:24:38.020\nIt's got the IP address, and it's up.\n\n481\n00:24:38.020 --> 00:24:40.832\nNow, that tells me the bond is up,\nwhich is good.\n\n482\n00:24:40.832 --> 00:24:43.740\nAnd ens37 and 38 I can see right here and\n\n483\n00:24:43.740 --> 00:24:46.150\nthey're showing that\nthey're up with no IP.\n\n484\n00:24:46.150 --> 00:24:48.310\nBut if I didn't know\nthat these were a bond,\n\n485\n00:24:48.310 --> 00:24:50.240\nI really wouldn't be able to\nglean that information from here.\n\n486\n00:24:50.240 --> 00:24:54.850\nSo there's another command I wanna\nshow you which is IP link show.\n\n487\n00:24:54.850 --> 00:24:57.900\nAnd when I run that,\nnow I can look in here and\n\n488\n00:24:57.900 --> 00:25:00.370\nI can see a little more about that bond.\n\n489\n00:25:00.370 --> 00:25:03.325\nAnd I can see that bond0 is here.\n\n490\n00:25:03.325 --> 00:25:08.300\nBut up here I can see master bond0\nis on each of those subinterfaces.\n\n491\n00:25:08.300 --> 00:25:11.280\nSo I kinda tie those\ntogether a little bit more\n\n492\n00:25:11.280 --> 00:25:13.130\nto better understand\nthat that bond is there.\n\n493\n00:25:13.130 --> 00:25:14.710\nBut now those are combined.\n\n494\n00:25:14.710 --> 00:25:16.040\nAnd I set it for round robin, so\n\n495\n00:25:16.040 --> 00:25:20.580\nit's round robining traffic across those\ntwo interfaces to work on the network.\n\n496\n00:25:20.580 --> 00:25:22.040\nWe've now bonded them together.\n\n497\n00:25:22.040 --> 00:25:24.350\nIf one fails, the other one stays up.\n\n498\n00:25:24.350 --> 00:25:26.200\nIt's up, it's doing its job,\nand it's happy, right?\n\n499\n00:25:26.200 --> 00:25:28.490\nAnd because all this\nwas done with scripts,\n\n500\n00:25:28.490 --> 00:25:30.600\nwhen we reboot,\nall the settings are there.\n\n501\n00:25:30.600 --> 00:25:35.780\nIt comes right back up and now we've\ngot a bonded interfaces up and running.\n\n502\n00:25:35.780 --> 00:25:37.790\n&gt;&gt; Awesome, well, when we have\nmultiple interfaces like that,\n\n503\n00:25:37.790 --> 00:25:40.980\nis there a way we can influence,\nif I can say the word,\n\n504\n00:25:40.980 --> 00:25:44.078\nif we can influence what traffic-\n&gt;&gt; Yeah.\n\n505\n00:25:44.078 --> 00:25:45.836\n&gt;&gt; Uses what interfaces?\n\n506\n00:25:45.836 --> 00:25:46.910\n&gt;&gt; Yeah, yeah.\n&gt;&gt; Is there a way we can do that?\n\n507\n00:25:46.910 --> 00:25:50.591\n&gt;&gt; Yep, I thought you were going\na different way with that but yeah, so\n\n508\n00:25:50.591 --> 00:25:53.059\nright now, I've got multiple interfaces.\n\n509\n00:25:53.059 --> 00:25:54.976\nSo if I do my ip addr again,\n\n510\n00:25:54.976 --> 00:26:00.402\nI've got multiple interfaces on\nthis 17.16.0 network, right?\n\n511\n00:26:00.402 --> 00:26:02.409\nI've got this bond that\nwe just created and\n\n512\n00:26:02.409 --> 00:26:05.489\nthen earlier in the episode I\ncreated all these other IPs up here.\n\n513\n00:26:05.489 --> 00:26:10.740\nSo when I reach out to my default gateway,\nmy default gateway is 1720.2.\n\n514\n00:26:10.740 --> 00:26:12.473\nAnd which interface is it gonna take?\n\n515\n00:26:12.473 --> 00:26:16.886\nIs it gonna take the gig adapter,\nup here, this ens33?\n\n516\n00:26:16.886 --> 00:26:18.361\nOr is it gonna take Bond0,\n\n517\n00:26:18.361 --> 00:26:21.773\nwhich has twice the bandwidth\ncuz I'm round-robining on it.\n\n518\n00:26:21.773 --> 00:26:25.730\nSo I can influence that by\nputting in custom rounds, right?\n\n519\n00:26:25.730 --> 00:26:30.430\nThe scripts that I've been working with\nthis whole episode have been IFCFG- and\n\n520\n00:26:30.430 --> 00:26:32.030\nan interface name.\n\n521\n00:26:32.030 --> 00:26:36.414\nBut there's other scripts that you can\nstick in here that do, well, other things,\n\n522\n00:26:36.414 --> 00:26:39.221\nnot the most eloquent\nsentence I'm gonna use today.\n\n523\n00:26:39.221 --> 00:26:41.338\n&gt;&gt; [LAUGH] We get the idea, though.\n\n524\n00:26:41.338 --> 00:26:45.659\n&gt;&gt; I know, so for example, I can stick\nin routing statements that override our\n\n525\n00:26:45.659 --> 00:26:48.530\nrouting table for particular interfaces.\n\n526\n00:26:48.530 --> 00:26:51.370\nSo I can tell it to route a certain way.\n\n527\n00:26:51.370 --> 00:26:54.611\nIf you run the IP route command,\nyou'll see a routing table.\n\n528\n00:26:54.611 --> 00:26:59.451\nAnd right now I can see that I've got two\nroutes to be able to get to the 172.16.0\n\n529\n00:26:59.451 --> 00:27:00.057\nnetwork.\n\n530\n00:27:00.057 --> 00:27:03.658\nOne via ens33 and\nanother via bond0, right?\n\n531\n00:27:03.658 --> 00:27:05.760\nSo there's those two different routes.\n\n532\n00:27:05.760 --> 00:27:07.160\nAnd if I look along the side here,\n\n533\n00:27:07.160 --> 00:27:10.920\nI can see a metric that's identifying\nwhich one is preferred versus another.\n\n534\n00:27:10.920 --> 00:27:14.920\nSo the system is trying to figure\nthat out for us ahead of time, okay?\n\n535\n00:27:14.920 --> 00:27:17.730\nBut I can come in and tweak these routes.\n\n536\n00:27:17.730 --> 00:27:20.300\nAnd I can even redirect\ntraffic a certain way.\n\n537\n00:27:20.300 --> 00:27:25.384\nSo for example,\nI can go inside of an interface,\n\n538\n00:27:25.384 --> 00:27:30.717\nand instead of ifcfg-ens33,\nI could come in and\n\n539\n00:27:30.717 --> 00:27:36.182\nI could say something like route-ens33,\nokay?\n\n540\n00:27:36.182 --> 00:27:40.707\nAnd that's gonna create a custom route or\nrouting file for\n\n541\n00:27:40.707 --> 00:27:43.026\nthat particular interface.\n\n542\n00:27:43.026 --> 00:27:48.967\nAnd in here I could say ADDRESS0= and\nthe network that I want to route around.\n\n543\n00:27:48.967 --> 00:27:51.998\nSo I might say 172.16.1.0.\n\n544\n00:27:51.998 --> 00:27:59.748\nNETMASK0 = 255.255.255.0, right?\n\n545\n00:27:59.748 --> 00:28:02.890\nAnd then the gateway\nthat I want it to use.\n\n546\n00:28:02.890 --> 00:28:05.410\nI might have a different gateway\nthat I want this one to point to or\n\n547\n00:28:05.410 --> 00:28:07.110\nI might want it to use the normal gateway.\n\n548\n00:28:07.110 --> 00:28:11.000\nThe important part to me might just be\nthe fact that it's using this interface.\n\n549\n00:28:11.000 --> 00:28:11.950\nBut I can come in and I can put that.\n\n550\n00:28:11.950 --> 00:28:15.448\nAnd then I can go, address one, address\ntwo, address three, and add more and\n\n551\n00:28:15.448 --> 00:28:16.092\nmore routes.\n\n552\n00:28:16.092 --> 00:28:19.520\nSo there's 172.16.1.0 right here.\n\n553\n00:28:19.520 --> 00:28:23.970\nI'm gonna do the same thing but\n\n554\n00:28:23.970 --> 00:28:29.618\nroute-bond0 and on this one I'll say\n\n555\n00:28:29.618 --> 00:28:35.279\nADDRESS0 =172.16.2.0.\n\n556\n00:28:35.279 --> 00:28:39.317\nNETMASK0 = and\nI'm using netmask which is the old way,\n\n557\n00:28:39.317 --> 00:28:43.200\nI should be using prefix,\nbut either way it'll work.\n\n558\n00:28:43.200 --> 00:28:47.810\nAnd then gateway, and for this gateway it\nmight be something completely different\n\n559\n00:28:49.200 --> 00:28:50.150\nthen what the other one is using.\n\n560\n00:28:50.150 --> 00:28:52.210\nMaybe I'll send this one to .1 instead.\n\n561\n00:28:52.210 --> 00:28:55.610\nOkay, so each one of those\ngetting kind of put in there.\n\n562\n00:28:55.610 --> 00:29:00.220\nThose custom routes will be fed into the\nrouting table, so they go right alongside.\n\n563\n00:29:00.220 --> 00:29:01.740\nI've got my ifcfg scripts,\n\n564\n00:29:01.740 --> 00:29:05.487\nand now, I've got these route\nscripts over here that'll be loaded.\n\n565\n00:29:05.487 --> 00:29:09.814\nAnd if I restart those interfaces or\nif I just restart the network service,\n\n566\n00:29:09.814 --> 00:29:10.900\nthere we go.\n\n567\n00:29:10.900 --> 00:29:16.460\nThat'll force those to get reloaded real\nquick and I'm running VMware Workstation.\n\n568\n00:29:16.460 --> 00:29:18.050\nAnd every time it bonds those adaptors,\n\n569\n00:29:18.050 --> 00:29:21.391\nit's picking up the Mac address showing up\non more than on more than one virtual net.\n\n570\n00:29:21.391 --> 00:29:22.732\nThat's why that keepts popping up.\n\n571\n00:29:22.732 --> 00:29:24.737\nBut we'll ignore that.\nSo once that's loaded,\n\n572\n00:29:24.737 --> 00:29:26.850\nI can pull up my routing table.\n\n573\n00:29:26.850 --> 00:29:28.306\nAnd see how I've got these new entries?\n\n574\n00:29:28.306 --> 00:29:34.908\nAnd now,\n172.16.1.0 is being routed over ens33.\n\n575\n00:29:34.908 --> 00:29:40.140\nAnd 172.16.2.0 is being routed over bond0,\nright?\n\n576\n00:29:40.140 --> 00:29:43.190\nI'm sending those traffics\nover the different links, so\n\n577\n00:29:43.190 --> 00:29:46.840\nyou can influence that and\nsay, I wanna prefer the bond.\n\n578\n00:29:46.840 --> 00:29:49.700\nUse the bond because it's got more\nbandwidth and it's highly available.\n\n579\n00:29:49.700 --> 00:29:52.370\nBut my management traffic,\nI want that to go to this other depth.\n\n580\n00:29:52.370 --> 00:29:55.890\nYou can separate things out like that\nby using these other script files.\n\n581\n00:29:55.890 --> 00:29:59.420\nSo it's not the most common thing in\nthe world, but you certainly can do it.\n\n582\n00:29:59.420 --> 00:30:02.481\nAnd it's one of the advanced networking\nfeatures that kinda tucked away behind\n\n583\n00:30:02.481 --> 00:30:02.990\nthe scenes.\n\n584\n00:30:02.990 --> 00:30:06.940\n&gt;&gt; Awesome, well, advanced networking\nbecoming a Linux Server administrator.\n\n585\n00:30:06.940 --> 00:30:09.960\nGreat episode, any last words?\n\n586\n00:30:09.960 --> 00:30:12.060\n&gt;&gt; Main thing with all of this,\nI mean ESI,\n\n587\n00:30:12.060 --> 00:30:15.130\nI made a mistake in a configuration file\nthere, it's a lot of moving pieces right?\n\n588\n00:30:15.130 --> 00:30:16.640\nThere's a lot of lines in these scripts.\n\n589\n00:30:16.640 --> 00:30:18.860\nSo be careful with them.\n\n590\n00:30:18.860 --> 00:30:21.940\nIf you've got the network managers,\nit can simplify things a little bit.\n\n591\n00:30:21.940 --> 00:30:24.910\nBut we don't always have that, so\nbe used to doing it by hand like this.\n\n592\n00:30:24.910 --> 00:30:28.320\nThere are some new technologies coming\nout, like there's a replacement for\n\n593\n00:30:28.320 --> 00:30:30.860\nbonding that's in\nthe works called teaming.\n\n594\n00:30:30.860 --> 00:30:33.380\nAnd so that's one that might be\navailable on your system but\n\n595\n00:30:33.380 --> 00:30:34.850\nit's not available on all of them.\n\n596\n00:30:34.850 --> 00:30:37.284\nSo what I try to show you guys here\nin this episode is stuff that works\n\n597\n00:30:37.284 --> 00:30:37.813\neverywhere.\n\n598\n00:30:37.813 --> 00:30:38.537\n&gt;&gt; Right.\n\n599\n00:30:38.537 --> 00:30:39.968\n&gt;&gt; Know, that there's other options.\n\n600\n00:30:39.968 --> 00:30:42.486\nThere are other things that just\nmight not be available to everybody.\n\n601\n00:30:42.486 --> 00:30:45.350\nDon't hesitate to use those,\nthey're perfectly good.\n\n602\n00:30:45.350 --> 00:30:48.731\nBut there's a lot of stuff hidden behind\nthe scenes, if you just know it's there,\n\n603\n00:30:48.731 --> 00:30:51.838\nyou can take advantage of it and really\ngets some cool performance out of it.\n\n604\n00:30:51.838 --> 00:30:53.719\n&gt;&gt; And there's no I in team.\n\n605\n00:30:53.719 --> 00:30:58.547\nSo becoming a Linux server administrator,\na lot of video content in this series.\n\n606\n00:30:58.547 --> 00:31:01.190\nMake sure you watch all the videos,\nyou'll be very glad you did.\n\n607\n00:31:01.190 --> 00:31:04.190\nAnd thank you for watching ITProTV.\n\n608\n00:31:04.190 --> 00:31:07.290\nRemember, a good IT pro\nis always learning.\n\n609\n00:31:07.290 --> 00:31:08.210\nI'm Zach Memos.\n\n610\n00:31:08.210 --> 00:31:09.020\n&gt;&gt; And I'm Don Pezet.\n\n611\n00:31:09.020 --> 00:31:11.203\n&gt;&gt; And we will see you soon.\n\n612\n00:31:11.203 --> 00:31:17.219\n[MUSIC]\n\n613\n00:31:17.219 --> 00:31:20.540\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "226485177"
        }
      ],
      "title": "Administering Networking"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach discuss what SysV Init & Upstart Init are, a brief history of SysV Init and Upstart, Upstart as improved SysV, how to manage SysV & Upstart, configuring both, how we interact with init, how init varies between distros, changing the run level while the system is running, information gathering, and manually controlling the services.",
          "length": "1667",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-3-1-sysv_init_and_upstart-072017-PGM.00_30_13_06.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-3-1-sysv_init_and_upstart-072017-PGM.00_30_13_06.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-3-1-sysv_init_and_upstart-072017-PGM.00_30_13_06.Still001-sm.jpg",
          "title": "SysV Init and Upstart",
          "transcript": "WEBVTT\n\n1\n00:00:00.240 --> 00:00:06.242\nWelcome to ITPro.TV,\nI'm your host Don Pezet [CROSSTALK]\n\n2\n00:00:06.242 --> 00:00:08.237\n[MUSIC]\n\n3\n00:00:08.237 --> 00:00:11.777\n&gt;&gt; You're watching ITPro.TV.\n\n4\n00:00:11.777 --> 00:00:16.645\n&gt;&gt; Hello and thank you for watching IT Pro\nTV, helping you learn wherever you go.\n\n5\n00:00:16.645 --> 00:00:19.165\nI'm your host,\nZach Memos as we continue on with becoming\n\n6\n00:00:19.165 --> 00:00:21.295\na Linux Server Administrator.\n\n7\n00:00:21.295 --> 00:00:25.035\nAnd this is a great episode and bringing\nus all the information we need is the one,\n\n8\n00:00:25.035 --> 00:00:26.315\nthe only, Don Pezet.\n\n9\n00:00:26.315 --> 00:00:27.602\nDon, good morning sir.\n\n10\n00:00:27.602 --> 00:00:28.692\n&gt;&gt; Hey, thanks for having me back, Zach.\n\n11\n00:00:28.692 --> 00:00:31.024\nReady to dive right back\ninto server administration.\n\n12\n00:00:31.024 --> 00:00:33.682\nAnd in this episode we're\ngonna be taking a look at two\n\n13\n00:00:33.682 --> 00:00:38.602\nreally important pieces of software,\nand that is the Unix SysV or\n\n14\n00:00:38.602 --> 00:00:41.772\nSystem 5 Init, and\nthe Upstart Init systems.\n\n15\n00:00:41.772 --> 00:00:43.322\nYou know, when we run a server,\n\n16\n00:00:43.322 --> 00:00:46.142\na lot of what we do is going\nto be a background task.\n\n17\n00:00:46.142 --> 00:00:49.630\nIt's gonna be a service that runs in the\nbackground that's doing some operation and\n\n18\n00:00:49.630 --> 00:00:52.460\nwe don't necessarily interact\nwith it on a daily basis.\n\n19\n00:00:52.460 --> 00:00:56.900\nWell, something has to be controlling\nthat, and that's where SysVInit and\n\n20\n00:00:56.900 --> 00:00:57.680\nUpstart come in.\n\n21\n00:00:57.680 --> 00:01:01.150\nThese two different processes can\nstep in and take over that role and\n\n22\n00:01:01.150 --> 00:01:02.080\nrun the show for us.\n\n23\n00:01:02.080 --> 00:01:03.810\nAnd so it's important that\nwe understand how they work,\n\n24\n00:01:03.810 --> 00:01:07.690\nwhat they do, and why they're there,\nas well as how we interact with them.\n\n25\n00:01:07.690 --> 00:01:10.353\nSo, that's all stuff that we're gonna\nsee right here in this episode.\n\n26\n00:01:10.353 --> 00:01:13.516\n&gt;&gt; Now Don, why are we grouping\nthese two together are they related?\n\n27\n00:01:13.516 --> 00:01:17.013\n&gt;&gt; Okay so good question because I\nthink I even said that these two work\n\n28\n00:01:17.013 --> 00:01:18.080\ntogether, right?\n\n29\n00:01:18.080 --> 00:01:20.760\nThey don't actually work together at all,\nso I probably shouldn't have said that.\n\n30\n00:01:20.760 --> 00:01:24.750\nThey're two completely separate things but\nthey are very much related.\n\n31\n00:01:24.750 --> 00:01:28.517\nThe SysVInit right,\nSysVInit is the short name for,\n\n32\n00:01:28.517 --> 00:01:32.720\nthe full name is the Unix System\n5 Initialization.\n\n33\n00:01:32.720 --> 00:01:34.650\nAnd that means that it was developed for\nUnix.\n\n34\n00:01:34.650 --> 00:01:36.850\nAnd that also means that it's old.\n\n35\n00:01:36.850 --> 00:01:38.150\nIt's really, really old.\n\n36\n00:01:38.150 --> 00:01:41.310\nSo back in the early days of Unix,\nthey knew that when you\n\n37\n00:01:41.310 --> 00:01:44.620\npress the power button on your system and\nthe operating system started to boot,\n\n38\n00:01:44.620 --> 00:01:49.280\nafter the kernel loaded,\nit needs to start services.\n\n39\n00:01:49.280 --> 00:01:51.870\nIt needs to run all the various\nthings that allow us to interact\n\n40\n00:01:51.870 --> 00:01:52.720\nwith the computer.\n\n41\n00:01:52.720 --> 00:01:55.100\nAnd so\nthey created the init service to do that.\n\n42\n00:01:55.100 --> 00:01:59.206\nSo init was a process that would run\non the background and it would start\n\n43\n00:01:59.206 --> 00:02:03.605\neverything up and maintain it,\nkeep things up and running on your system.\n\n44\n00:02:03.605 --> 00:02:09.340\nWell, it did a great job for over 30\nyears, still doing a great job today.\n\n45\n00:02:09.340 --> 00:02:13.950\nBut people have improved upon it and\nUpstart is just that.\n\n46\n00:02:13.950 --> 00:02:17.290\nThey took Init and they improved upon it.\n\n47\n00:02:17.290 --> 00:02:19.680\nUpstart is actually\ncompatible with SysVInit,\n\n48\n00:02:19.680 --> 00:02:22.190\na lot of the commands that\nwe use are all the same.\n\n49\n00:02:22.190 --> 00:02:25.991\nSo what happened was, I don't know,\nmaybe six years ago now,\n\n50\n00:02:25.991 --> 00:02:30.252\na lot of distributions that were\nusing SysVInit switched to Upstart.\n\n51\n00:02:30.252 --> 00:02:35.730\nAnd for most of us, as regular users\nyou might not have even noticed, right?\n\n52\n00:02:35.730 --> 00:02:38.640\nThey just moved to Upstart and\nthat was it, you had no clue.\n\n53\n00:02:38.640 --> 00:02:43.690\nBut as a server admin, moving to Upstart\ngave you a few extra capabilities,\n\n54\n00:02:43.690 --> 00:02:46.200\na few extra features\nthat were nice to have.\n\n55\n00:02:46.200 --> 00:02:48.900\nA thing about Upstart though\nis it was short-lived.\n\n56\n00:02:48.900 --> 00:02:51.490\nMost distros only had it for\none or two versions.\n\n57\n00:02:51.490 --> 00:02:56.780\nSo for example Red Hat, Red Hat Enterprise\nLinux used SysVInit all the way through,\n\n58\n00:02:56.780 --> 00:02:59.660\nup until version 5 or up to version 6.\n\n59\n00:02:59.660 --> 00:03:01.048\nNo, I was right, version 5.\n\n60\n00:03:01.048 --> 00:03:03.920\nAnd then in version 6,\nthey went to Upstart.\n\n61\n00:03:03.920 --> 00:03:07.480\nSo in Red Hat Enterprise Linux 6,\nyou had Upstart and\n\n62\n00:03:07.480 --> 00:03:11.480\nthen in Red Hat Enterprise Linux\n7 they switched to Systemd.\n\n63\n00:03:11.480 --> 00:03:15.130\nAnd now you're seeing every distro\nout there coming out with Systemd.\n\n64\n00:03:15.130 --> 00:03:17.210\nSo Upstart had a very\nsmall window of time.\n\n65\n00:03:17.210 --> 00:03:23.359\nBut in real life land when you go out\nthere and go to administer a server,\n\n66\n00:03:23.359 --> 00:03:29.012\nit's either going to be running SysVInit,\nUpstart or Systemd.\n\n67\n00:03:29.012 --> 00:03:33.593\nNow Systemd has a completely separate\nset of commands for managing it, but\n\n68\n00:03:33.593 --> 00:03:36.370\ninit and Upstart are almost identical.\n\n69\n00:03:36.370 --> 00:03:39.520\nSo I'm grouping them together here in this\nepisode cuz if you learn how to administer\n\n70\n00:03:39.520 --> 00:03:41.210\none, you know how to administer the other.\n\n71\n00:03:41.210 --> 00:03:44.480\nSo we're gonna take a look at Upstart and\ninit right here grouped together.\n\n72\n00:03:44.480 --> 00:03:48.682\nBut you might need to be able to figure\nout which one you're actually running.\n\n73\n00:03:48.682 --> 00:03:49.810\nIt's important to some people.\n\n74\n00:03:51.150 --> 00:03:54.480\nSo one of the neat things about\nan initialization process is it is\n\n75\n00:03:54.480 --> 00:03:56.960\nthe first thing the kernel starts.\n\n76\n00:03:56.960 --> 00:04:00.060\nCuz this initialization process\ncouldn't start everything else.\n\n77\n00:04:00.060 --> 00:04:04.299\nSo if we take a look at our processes,\nlike here I've got a machine pulled up and\n\n78\n00:04:04.299 --> 00:04:07.074\nthis is a CentOS 6 machine or\nat least I think it is.\n\n79\n00:04:07.074 --> 00:04:09.190\n[LAUGH] Let's find out.\n\n80\n00:04:09.190 --> 00:04:13.420\nYeah, so I'm running CentOS 6.9,\nwhich is the latest version of CentOS 6.\n\n81\n00:04:13.420 --> 00:04:17.010\nNow, CentOS 7 is running Systemd, right?\n\n82\n00:04:17.010 --> 00:04:20.100\nSo I had to go back to\nCentOS 6 to get Upstart.\n\n83\n00:04:20.100 --> 00:04:22.690\nBut if we take a look at our process list,\nright,\n\n84\n00:04:22.690 --> 00:04:27.190\nthe process list shows you every process\nthat's running on the system, right?\n\n85\n00:04:27.190 --> 00:04:28.580\nAnd if you take a look at all of this,\n\n86\n00:04:28.580 --> 00:04:30.520\nthere's a ton of processes\nthat are out there.\n\n87\n00:04:30.520 --> 00:04:33.220\nAnd if you look at the process ID, and\n\n88\n00:04:33.220 --> 00:04:38.130\ngo all the way back to process number 1,\nokay?\n\n89\n00:04:38.130 --> 00:04:39.710\nProcess number 1 right here.\n\n90\n00:04:39.710 --> 00:04:46.204\nIf I look at that process,\nit is [SOUND] bin/init right?\n\n91\n00:04:46.204 --> 00:04:47.613\nThere is that init, and\n\n92\n00:04:47.613 --> 00:04:52.190\non a sysvinit or on an upstart system,\nI know this system is upstart.\n\n93\n00:04:52.190 --> 00:04:54.780\nIt's gonna show /sbin/init.\n\n94\n00:04:54.780 --> 00:05:00.120\nIf I was on a system D system that very\nfirst process would just be system D\n\n95\n00:05:00.120 --> 00:05:01.900\nnot init like this.\n\n96\n00:05:01.900 --> 00:05:04.750\nSo, by doing that or I could have\nsaved myself a little effort and\n\n97\n00:05:04.750 --> 00:05:08.950\ndone a ps -p 1 like just\nshow me process one.\n\n98\n00:05:08.950 --> 00:05:10.150\nThere it is, it's init.\n\n99\n00:05:10.150 --> 00:05:13.820\nSo, that tells me that I'm\nrunning either init or upstart.\n\n100\n00:05:13.820 --> 00:05:16.200\nI'm running one of those two, okay.\n\n101\n00:05:16.200 --> 00:05:17.960\nAnd do I really care which one?\n\n102\n00:05:17.960 --> 00:05:20.340\nNot necessarily, if I'm gonna use\nsome advanced features maybe.\n\n103\n00:05:20.340 --> 00:05:22.270\nBut otherwise, it doesn't really matter.\n\n104\n00:05:22.270 --> 00:05:25.397\nIf I truly want to find out,\nthough, am I running upstart,\n\n105\n00:05:25.397 --> 00:05:27.158\nthere's not an easy way to tell.\n\n106\n00:05:27.158 --> 00:05:30.030\nYou actually have to look inside\nof init to figure it out.\n\n107\n00:05:30.030 --> 00:05:35.090\nSo if you use the strings command you can\nlook inside of a file and find stuff.\n\n108\n00:05:35.090 --> 00:05:39.320\nSo I'm gonna look inside /sbin/init.\n\n109\n00:05:39.320 --> 00:05:44.781\nAnd I'm just gonna grep that and\nlook for the word upstart, okay so\n\n110\n00:05:44.781 --> 00:05:49.720\ngrep -i does a case insensitive search,\nI'm just gonna look for the word upstart.\n\n111\n00:05:49.720 --> 00:05:54.740\nAnd if you get responses back,\nthen you know you're running upstart.\n\n112\n00:05:54.740 --> 00:05:58.910\nOkay, if you don't get responses back,\nthen you know you're running sysvinit.\n\n113\n00:05:58.910 --> 00:05:59.588\nIt seems weird but\n\n114\n00:05:59.588 --> 00:06:02.537\nthis is really one of the best ways to\nfind out which one that you're running.\n\n115\n00:06:02.537 --> 00:06:04.058\nAnd it's kind of interesting\nwhen you look at it.\n\n116\n00:06:04.058 --> 00:06:07.345\nI'm on a CentOS machine which is\nfrom Red Hat Enterprise Linux and\n\n117\n00:06:07.345 --> 00:06:08.736\nsee all this Ubuntu stuff.\n\n118\n00:06:08.736 --> 00:06:12.005\nThat's because Ubuntu was\nreally the organization or\n\n119\n00:06:12.005 --> 00:06:16.290\nwas the organization that spearheaded\ncreating upstart and improving it.\n\n120\n00:06:16.290 --> 00:06:19.500\nBut even they have moved to systemd.\n\n121\n00:06:19.500 --> 00:06:22.420\nSo, what we're gonna see here in\nthis episode is really when we're\n\n122\n00:06:22.420 --> 00:06:25.650\nadministering servers that are running\nprevious versions of Linux.\n\n123\n00:06:25.650 --> 00:06:28.750\nAnd, I know what some of you are thinking,\nI'm just not gonna do that,\n\n124\n00:06:28.750 --> 00:06:30.970\nlet me skip to the newer episodes.\n\n125\n00:06:30.970 --> 00:06:33.370\nBut, when it comes to servers.\n\n126\n00:06:33.370 --> 00:06:37.030\nServers aren't all about having\nthe latest and greatest technologies.\n\n127\n00:06:37.030 --> 00:06:41.290\nServers are about having stability and\nrock solid reliability.\n\n128\n00:06:41.290 --> 00:06:45.680\nAnd so they will run previous versions\nof Linux that are still supported.\n\n129\n00:06:45.680 --> 00:06:48.670\nRed Hat Enterprise Linux 6.9\nstill supported today right?\n\n130\n00:06:48.670 --> 00:06:50.550\nI can get a support agreement.\n\n131\n00:06:50.550 --> 00:06:52.400\nThere's still really\nsome security updates.\n\n132\n00:06:52.400 --> 00:06:52.950\nSo I can have that.\n\n133\n00:06:52.950 --> 00:06:56.840\nSo you very well may encounter\nsystems running upstart in init\n\n134\n00:06:56.840 --> 00:06:57.660\nout there in the real world.\n\n135\n00:06:57.660 --> 00:07:00.737\nSo it is important to learn it and\nunderstand the basics of it even though\n\n136\n00:07:00.737 --> 00:07:02.758\nwe're moving more and\nmore to systemd today.\n\n137\n00:07:02.758 --> 00:07:03.890\n&gt;&gt; Makes sense too.\n\n138\n00:07:03.890 --> 00:07:06.940\nSo how do we interact\nwith the init system?\n\n139\n00:07:06.940 --> 00:07:09.830\n&gt;&gt; All right, so in a way,\nwe're already interacting with it, right.\n\n140\n00:07:09.830 --> 00:07:12.690\nJust when you turn the system\non the kernel fires up,\n\n141\n00:07:12.690 --> 00:07:16.540\nthe kernel launches init, and then init\nis running all of the services, right?\n\n142\n00:07:16.540 --> 00:07:21.530\nSo when I logged in, I was logging in\nwith a service that was started by init,\n\n143\n00:07:21.530 --> 00:07:23.500\neverything's started by init.\n\n144\n00:07:23.500 --> 00:07:26.660\nSo we sort of interact with it on\na regular basis, but there are times where\n\n145\n00:07:26.660 --> 00:07:30.200\nwe need to manipulate what it's doing,\nor change the way that it functions.\n\n146\n00:07:30.200 --> 00:07:33.840\nAnd so there's a couple of things that\nwe can do, the main way we interact with\n\n147\n00:07:33.840 --> 00:07:37.000\nthe init, is through adjusting\nwhat's called a run level.\n\n148\n00:07:37.000 --> 00:07:40.324\nThe way a init works,\nis the kernel fires up, and\n\n149\n00:07:40.324 --> 00:07:45.355\nthe kernel calls a init, and\nthen a init has to decide what to start.\n\n150\n00:07:45.355 --> 00:07:47.465\nWhat services am I about to start.\n\n151\n00:07:47.465 --> 00:07:50.995\nAnd it determines which services\nbased on which run level we're in.\n\n152\n00:07:50.995 --> 00:07:53.289\nOkay, now all of the run\nlevels are stored in a file.\n\n153\n00:07:53.289 --> 00:07:54.219\nLet me show you this file.\n\n154\n00:07:54.219 --> 00:08:00.895\nIt's inside a /etc and\nif I just take a look at it there we go.\n\n155\n00:08:00.895 --> 00:08:07.520\nSo I'll cat/etc/inittab which\nis the initialization table.\n\n156\n00:08:07.520 --> 00:08:12.800\nAnd if I look at that file, what I'm going\nto see is a definition of run level.\n\n157\n00:08:12.800 --> 00:08:16.300\nThere's six run levels,\nactually seven run levels.\n\n158\n00:08:16.300 --> 00:08:19.390\nThese run levels are somewhat standard,\nbut\n\n159\n00:08:19.390 --> 00:08:21.760\nactually can vary from distro to distro.\n\n160\n00:08:21.760 --> 00:08:25.780\nSo, if you're running Debian, you might\nsee slightly different run levels.\n\n161\n00:08:25.780 --> 00:08:28.160\nOr if you're running Red Hat,\nthey might be slightly different.\n\n162\n00:08:28.160 --> 00:08:28.850\nBut, for\n\n163\n00:08:28.850 --> 00:08:32.890\nthe most part, the ones that we're\nseeing here are pretty standard, okay?\n\n164\n00:08:32.890 --> 00:08:36.800\nNow, I at first said there\nwere six run levels, and\n\n165\n00:08:36.800 --> 00:08:38.940\nthen I had to correct myself and\nsay there were seven.\n\n166\n00:08:38.940 --> 00:08:42.090\nAnd that's because runlevel 0,\nyou're not supposed to,\n\n167\n00:08:42.090 --> 00:08:44.415\nyou see how it says Do NOT\nset initdefault to this?\n\n168\n00:08:44.415 --> 00:08:48.050\n[LAUGH] Run level 0 it means your\ncomputer is turned off, right?\n\n169\n00:08:48.050 --> 00:08:50.690\nSo we can't really use init\nif it's turned off, so\n\n170\n00:08:50.690 --> 00:08:53.282\nI always forget to count that one,\nbut that is important.\n\n171\n00:08:53.282 --> 00:08:56.395\nCuz runlevel 0,\nthe system is turned off, okay?\n\n172\n00:08:56.395 --> 00:09:00.470\nRunlevel 6 is kind of similar\nRunlevel 6 is, we're about to reboot.\n\n173\n00:09:02.030 --> 00:09:07.020\nNow we're just going from seven run levels\nto really five usable run levels but\n\n174\n00:09:07.020 --> 00:09:08.740\neven though those five are not all used.\n\n175\n00:09:08.740 --> 00:09:12.460\nThere's really just a couple\nthat are really important to us.\n\n176\n00:09:12.460 --> 00:09:14.670\nRunlevel 1, is single user mode.\n\n177\n00:09:15.990 --> 00:09:18.690\nAs an administrator there might be\n\n178\n00:09:18.690 --> 00:09:22.760\ntimes where you're trying to work with\na file and it's locked by another user.\n\n179\n00:09:22.760 --> 00:09:24.670\nI need to take a database off line for\nmaintenance but\n\n180\n00:09:24.670 --> 00:09:26.550\nother people are accessing it.\n\n181\n00:09:26.550 --> 00:09:30.020\nYou may need exclusive access to a system.\n\n182\n00:09:30.020 --> 00:09:33.430\nMaybe the system just got hacked,\nsomebody broke into it and\n\n183\n00:09:33.430 --> 00:09:37.490\nyou need to be able to lock it down but\nstill keep it on so you can get in and\n\n184\n00:09:37.490 --> 00:09:39.070\nfind out what damage was done.\n\n185\n00:09:39.070 --> 00:09:43.210\nWe can move the system into single user\nmode and then in single user mode you as\n\n186\n00:09:43.210 --> 00:09:47.850\nroot will be able to get in and work\nwith the system, but nobody else will.\n\n187\n00:09:47.850 --> 00:09:52.380\nAnd all that does is it tells init, hey,\nwhen I'm powering on and I'm initializing\n\n188\n00:09:52.380 --> 00:09:57.370\nI'm gonna go ahead and launch just\nthe stuff needed and allow one user.\n\n189\n00:09:57.370 --> 00:10:00.005\nI'm not gonna allow people to\ncoming in over the network.\n\n190\n00:10:00.005 --> 00:10:04.040\nIt's gonna be local and\nonly gonna allow through the usernet.\n\n191\n00:10:04.040 --> 00:10:06.900\nRight?\nSo we're telling init how to behave.\n\n192\n00:10:06.900 --> 00:10:09.080\nRunlevel 2 is multi user, right?\n\n193\n00:10:10.120 --> 00:10:13.900\nExcept If you look here at CSS the same\nas number three except you don't\n\n194\n00:10:13.900 --> 00:10:14.850\nhave networking, right?\n\n195\n00:10:14.850 --> 00:10:16.210\nSo this will be multi user,\n\n196\n00:10:16.210 --> 00:10:18.490\nmultiple people could login but\nthey'd have to be local.\n\n197\n00:10:19.915 --> 00:10:23.760\nRunlevel 3, that one is a little\nmore common on servers.\n\n198\n00:10:23.760 --> 00:10:28.050\nRunlevel 3 is full\nmulti-user with networking.\n\n199\n00:10:28.050 --> 00:10:32.340\nNow, runlevel 5 is actually\nthe default on a lot of systems.\n\n200\n00:10:32.340 --> 00:10:35.480\nAnd you'll see my system has runlevel\n5 right here as the default.\n\n201\n00:10:35.480 --> 00:10:38.020\nSee, it says ID five init default.\n\n202\n00:10:38.020 --> 00:10:39.960\nRunlevel 5 just says X11.\n\n203\n00:10:39.960 --> 00:10:40.580\nOkay?\n\n204\n00:10:40.580 --> 00:10:45.440\nWhat it actually should say is, multi\nuser with a graphical user interface.\n\n205\n00:10:45.440 --> 00:10:49.170\nSo, runlevel 5 and\nrunlevel 3 are almost the same.\n\n206\n00:10:49.170 --> 00:10:51.990\nThey're both multi user,\nthey both have full networking.\n\n207\n00:10:51.990 --> 00:10:54.270\nThe difference is in\nrunlevel 5 we loaded GUI.\n\n208\n00:10:54.270 --> 00:10:58.120\nNow on a server a lot of\ntimes we don't load a GUI.\n\n209\n00:10:58.120 --> 00:11:00.616\nSo if you don't have a GUI\nloaded then runlevel 3 and\n\n210\n00:11:00.616 --> 00:11:03.060\nrunlevel 5 are really the same for you.\n\n211\n00:11:03.060 --> 00:11:06.880\nBut on a desktop, on a desktop like mine,\nI'm running CentOS and\n\n212\n00:11:06.880 --> 00:11:10.040\nI do have a GUI right here,\nin the background.\n\n213\n00:11:10.040 --> 00:11:13.800\nSo on a desktop, we can tell it,\nhey I want you to boot to a command line.\n\n214\n00:11:13.800 --> 00:11:16.370\nAnd don't bother loading the GUI so\n\n215\n00:11:16.370 --> 00:11:20.330\nI move it to runlevel 3 and\nnow we boot up that way.\n\n216\n00:11:20.330 --> 00:11:23.770\nAnd you'll see right here,\nall I did was edit the init tab file and\n\n217\n00:11:23.770 --> 00:11:27.600\ninside of the init tab file I\ncan change this id right here.\n\n218\n00:11:27.600 --> 00:11:30.420\nI can change it to runlevel 3 or\nrunlevel 5 or\n\n219\n00:11:30.420 --> 00:11:34.300\nwhatever run level I want it to be and\nthen I can reboot.\n\n220\n00:11:34.300 --> 00:11:37.830\nAnd when the system reboots, it'll come\nup under that new run level, right, so\n\n221\n00:11:37.830 --> 00:11:41.660\nthis is the default, what it'll be set\nto at boot when we fire the system up.\n\n222\n00:11:41.660 --> 00:11:43.290\nNow, when we look at that config file,\n\n223\n00:11:43.290 --> 00:11:46.820\nit's easy to think of the run levels as\njust numbers, right, but what the run\n\n224\n00:11:46.820 --> 00:11:51.350\nlevel actually does is each run level has\na series of scripts that it runs, right?\n\n225\n00:11:51.350 --> 00:11:54.620\nAnd it's telling the system\nwhat to do when it boots up.\n\n226\n00:11:54.620 --> 00:11:55.750\nAnd if you look, so I'm in /etc, right?\n\n227\n00:11:55.750 --> 00:11:59.560\nWell, if you just take\na look inside of etc,\n\n228\n00:11:59.560 --> 00:12:03.640\nyou'll actually see a lot of\nstuff kind of spread in here.\n\n229\n00:12:03.640 --> 00:12:08.132\nAnd what I'm looking for\nis a folder called RC .d.\n\n230\n00:12:08.132 --> 00:12:12.363\nNow,I've an rc.d folder right here, but\nthe reason I wanted to pull this up as\n\n231\n00:12:12.363 --> 00:12:15.849\nas a list is if you look,\nlook at at all these links that I've got.\n\n232\n00:12:15.849 --> 00:12:18.750\nThese links are soft links,\nthey're not actual folders,\n\n233\n00:12:18.750 --> 00:12:20.800\nthey're links to somewhere else.\n\n234\n00:12:20.800 --> 00:12:22.867\nRc0.d, rc1.d and so on.\n\n235\n00:12:22.867 --> 00:12:27.460\nEach of these matches up with a run level,\nright?\n\n236\n00:12:27.460 --> 00:12:29.160\nThere was run level zero through six, so\n\n237\n00:12:29.160 --> 00:12:32.500\nI've got RC0 all the way through RC6,\nright?\n\n238\n00:12:32.500 --> 00:12:35.300\nAnd if I go inside of the rc.d folder,\n\n239\n00:12:35.300 --> 00:12:38.750\nthat's the real folder,\nand I look in there.\n\n240\n00:12:38.750 --> 00:12:41.320\nNow I see the other ones\nthat are real folders.\n\n241\n00:12:41.320 --> 00:12:43.080\nSo there's RC0 and so on.\n\n242\n00:12:43.080 --> 00:12:48.040\nSo when I tell init to boot up\nin runlevel 3, it starts up.\n\n243\n00:12:48.040 --> 00:12:53.220\nThe kernel starts up, the kernel calls\ninit, init says we're in runlevel 3,\n\n244\n00:12:53.220 --> 00:12:55.950\nI saw that in the init tab file,\nright, that's where it was defined.\n\n245\n00:12:55.950 --> 00:13:00.772\nI know I'm in run level three,\nso let me look into the rc3.d\n\n246\n00:13:00.772 --> 00:13:05.070\nfolder, and\nsee what scripts I need to run.\n\n247\n00:13:05.070 --> 00:13:08.030\nAnd here's all the scripts\nthat tell it what to do.\n\n248\n00:13:08.030 --> 00:13:09.440\nAnd they've got letters and\n\n249\n00:13:09.440 --> 00:13:13.500\nnumbers before them to coordinate\nthe order that they're run in, right.\n\n250\n00:13:13.500 --> 00:13:17.220\nSo S989 is gonna be run after S25.\n\n251\n00:13:17.220 --> 00:13:19.850\nAnd S25 here is cups,\nthat's the printer system.\n\n252\n00:13:19.850 --> 00:13:22.380\nSo it's gonna start the printer system.\n\n253\n00:13:22.380 --> 00:13:27.520\nWhen I'm in runlevel 3,\nthat's a multi-user with networking.\n\n254\n00:13:27.520 --> 00:13:29.070\nSo it's gonna fire up\nthe printing service so\n\n255\n00:13:29.070 --> 00:13:30.930\nwe'll be able to print and use all that.\n\n256\n00:13:30.930 --> 00:13:34.190\nBut if I were to boot in single user,\nwell,\n\n257\n00:13:34.190 --> 00:13:35.930\nactually I think single user runs cups.\n\n258\n00:13:35.930 --> 00:13:37.130\nWell, we can find out, right.\n\n259\n00:13:37.130 --> 00:13:39.880\nIf I boot in single user,\nthat's runlevel 1.\n\n260\n00:13:39.880 --> 00:13:45.770\nSo if I get into rc1.d and I take a look\nin there, do I have that cups file?\n\n261\n00:13:45.770 --> 00:13:46.760\nAnd if I was smarter,\n\n262\n00:13:46.760 --> 00:13:49.010\nI probably would've paid attention\nto the K number assigned to it.\n\n263\n00:13:49.010 --> 00:13:51.470\nI think it was like K25, wasn't it?\n\n264\n00:13:51.470 --> 00:13:52.580\nSomething like that.\n\n265\n00:13:52.580 --> 00:13:53.130\nI don't see it.\n\n266\n00:13:53.130 --> 00:13:55.140\nI don't see cups here in the list, so\n\n267\n00:13:55.140 --> 00:13:58.540\nthat means that if I started runlevel 1,\nI'm not gonna be running, right?\n\n268\n00:13:58.540 --> 00:14:01.500\nSo these scripts right here,\nactually there it is.\n\n269\n00:14:01.500 --> 00:14:03.370\nShoot, it's on the screen, K10, K10cups.\n\n270\n00:14:03.370 --> 00:14:05.360\nSo let's say I didn't want it to run.\n\n271\n00:14:05.360 --> 00:14:06.590\nRight I don't want it to run.\n\n272\n00:14:06.590 --> 00:14:10.350\nI can actually modify that script or\nremove that script and\n\n273\n00:14:10.350 --> 00:14:12.410\nnow it won't run when runlevel 1 starts.\n\n274\n00:14:12.410 --> 00:14:14.140\nI'm gonna show you a way in a minute\nthat's a little bit easier to\n\n275\n00:14:14.140 --> 00:14:14.990\nwork with that.\n\n276\n00:14:14.990 --> 00:14:17.000\nBut this is how we interact with a init.\n\n277\n00:14:17.000 --> 00:14:19.590\nThis is what init is doing,\nit's looking for these folders.\n\n278\n00:14:19.590 --> 00:14:23.980\nIt's looking for the configuration\nto tell it what to do depending\n\n279\n00:14:23.980 --> 00:14:28.600\non the run level and all we have to do is\ngo into that runlevel file, /etc/init tab\n\n280\n00:14:28.600 --> 00:14:32.810\nmodify the default value and when we\nreboot, that'll be the new run level that\n\n281\n00:14:32.810 --> 00:14:36.360\nwe're at, and we'll run whatever\nscripts are tied to that run level.\n\n282\n00:14:36.360 --> 00:14:40.560\n&gt;&gt; Doug, can we change the run\nlevel while the system is running?\n\n283\n00:14:40.560 --> 00:14:42.330\nYou can yeah absolutely.\n\n284\n00:14:42.330 --> 00:14:44.290\nSo I keep saying you reboot right?\n\n285\n00:14:44.290 --> 00:14:47.300\nSo you change the default run level and\nyou reboot.\n\n286\n00:14:47.300 --> 00:14:51.140\nThat works and is usually what I\ndo if it's gonna be permanent.\n\n287\n00:14:51.140 --> 00:14:52.730\nBut what if it's a temporary change?\n\n288\n00:14:52.730 --> 00:14:54.650\nI give the example of the hacker right?\n\n289\n00:14:54.650 --> 00:14:58.390\nHacker breaks in there are wreaking\nhavoc on the system like\n\n290\n00:14:58.390 --> 00:15:02.270\ncrap I need to get this system running\njust single user mode as fast as I can.\n\n291\n00:15:03.360 --> 00:15:06.860\nWell, instead of changing\nthe default level and rebooting.\n\n292\n00:15:06.860 --> 00:15:10.100\nRebooting which by the way would destroy\nsome of the stuff in RAM that a forensics\n\n293\n00:15:10.100 --> 00:15:11.750\nexpert might be able to recover.\n\n294\n00:15:11.750 --> 00:15:14.150\nI could come in and say you know what?\n\n295\n00:15:14.150 --> 00:15:17.770\nI'm just gonna jump in and\nchange it, right?\n\n296\n00:15:17.770 --> 00:15:19.910\nYou can change it by\nusing the init command.\n\n297\n00:15:19.910 --> 00:15:23.650\nThe init command itself can cause\nit to retrigger it and change.\n\n298\n00:15:23.650 --> 00:15:25.020\nBefore you do that though,\n\n299\n00:15:25.020 --> 00:15:27.600\nthere's another command that's kind of\nimportant which is the run level command.\n\n300\n00:15:27.600 --> 00:15:32.700\nAnd I'm gonna sudu this so\nI'm just gonna run one level, okay.\n\n301\n00:15:32.700 --> 00:15:36.430\nThe run level command will tell you\nwhich run level you're at right now.\n\n302\n00:15:36.430 --> 00:15:39.320\nAll right so\nmaybe I'm already in single user mode or\n\n303\n00:15:39.320 --> 00:15:41.410\nmaybe I'm already in one\nof the other run levels.\n\n304\n00:15:41.410 --> 00:15:42.500\nI don't know.\n\n305\n00:15:42.500 --> 00:15:44.760\nSo I'll run the run level\ncommand to find out, and\n\n306\n00:15:44.760 --> 00:15:46.350\nit'll give you two numbers, right?\n\n307\n00:15:46.350 --> 00:15:48.340\nOr in my case a letter and a number.\n\n308\n00:15:48.340 --> 00:15:52.354\nThe first number is what run\nlevel you were at before and\n\n309\n00:15:52.354 --> 00:15:56.116\nthe second number is what\nrun level you're at now.\n\n310\n00:15:56.116 --> 00:16:00.584\nSo if I had just changed from\nrunlevel 3 to runlevel 5,\n\n311\n00:16:00.584 --> 00:16:03.443\nI would see three 5, but I see N 5.\n\n312\n00:16:03.443 --> 00:16:07.140\nAnd that N means, I don't have\na previous runlevel, I rebooted.\n\n313\n00:16:08.230 --> 00:16:11.764\nSo on a fresh boot, you just go\nstraight into your current runlevel.\n\n314\n00:16:11.764 --> 00:16:14.556\nSo instead of seeing 5 5 which\nwould indicate a change,\n\n315\n00:16:14.556 --> 00:16:17.070\nthere was no change,\nit just booted up, I see N 5.\n\n316\n00:16:18.680 --> 00:16:20.975\nSo that's how I know\nwhat runlevel I am at.\n\n317\n00:16:20.975 --> 00:16:22.670\nI'm currently in runlevel 5.\n\n318\n00:16:22.670 --> 00:16:28.216\nIf I want to drop runlevel 1,\nI can just say sudo init and\n\n319\n00:16:28.216 --> 00:16:31.523\nthen the number that I want to be.\n\n320\n00:16:31.523 --> 00:16:32.900\nNow I do need to be careful.\n\n321\n00:16:32.900 --> 00:16:34.130\nIf users are in the system,\n\n322\n00:16:34.130 --> 00:16:37.100\nI'm about to kick them out if I\ndrop down to single user mode.\n\n323\n00:16:37.100 --> 00:16:39.270\nBut if I'm in a hurry,\nwhat do I care about that?\n\n324\n00:16:39.270 --> 00:16:40.550\nI could be a nice guy.\n\n325\n00:16:40.550 --> 00:16:45.960\nI could come in and say let me do\na who and look at who's logged in or\n\n326\n00:16:45.960 --> 00:16:51.080\nwho -r to see what runlevel I'm at and\nuse the who command to just\n\n327\n00:16:51.080 --> 00:16:52.980\nfind those people and\nthen reach out to them and let them know.\n\n328\n00:16:52.980 --> 00:16:55.250\nHey, get out of the system or whatever.\n\n329\n00:16:55.250 --> 00:16:59.540\nBut if I'm in a hurry I'm just\ngonna say init 1 and run it.\n\n330\n00:16:59.540 --> 00:17:03.210\nOkay, now I was in a GUI.\n\n331\n00:17:03.210 --> 00:17:06.310\nI was in runlevel 5.\n\n332\n00:17:06.310 --> 00:17:10.200\nWhen I did runlevel 1 it\ndropped me to a command shell.\n\n333\n00:17:10.200 --> 00:17:14.270\nAnd let me zoom in on that, cuz it's gonna\nget really small now that I've lost all my\n\n334\n00:17:15.270 --> 00:17:17.750\nGUI scaling and stuff like that.\n\n335\n00:17:17.750 --> 00:17:21.935\nSo if you look,\ntelling INIT to go into single user mode.\n\n336\n00:17:21.935 --> 00:17:26.000\ninit: rc main process (14323)\nkilled by the TERM signal.\n\n337\n00:17:26.000 --> 00:17:27.747\nIt terminated the old process.\n\n338\n00:17:27.747 --> 00:17:31.705\nAnd now it's dropped\nme down to runlevel 1.\n\n339\n00:17:32.810 --> 00:17:33.788\nThe system didn't reboot.\n\n340\n00:17:33.788 --> 00:17:38.760\nIt just re-ran the scripts that were\nappropriate for the new runlevel.\n\n341\n00:17:38.760 --> 00:17:41.170\nAnd it chucked me down to this.\n\n342\n00:17:41.170 --> 00:17:50.180\nAnd if I do like a ps -p 1 I can still\nsee that init is that first process.\n\n343\n00:17:50.180 --> 00:17:52.999\nAnd if I run the runlevel command I\n\n344\n00:17:52.999 --> 00:17:57.152\ncan see that my current\nrunlevel is single user.\n\n345\n00:17:57.152 --> 00:18:01.260\nI'm in that 1,\nwhich moved me into single user mode.\n\n346\n00:18:01.260 --> 00:18:02.110\nSo I can spot that.\n\n347\n00:18:02.110 --> 00:18:05.638\nAnd then if I transition again,\nI can just say, well, I'm already root so\n\n348\n00:18:05.638 --> 00:18:06.933\nI don't have to sudo this.\n\n349\n00:18:06.933 --> 00:18:11.477\nBut I will init and bump into,\nlet's say, runlevel 3.\n\n350\n00:18:11.477 --> 00:18:16.720\nSo now I'm multi-user again,\nbut now I will have networking.\n\n351\n00:18:16.720 --> 00:18:19.780\nSo I can see it's pulling IP\ninformation from my network adapter.\n\n352\n00:18:19.780 --> 00:18:23.280\nAnd it's going through and doing the boot.\n\n353\n00:18:23.280 --> 00:18:27.720\nAnd then I'll get back to a log in shell\nthat's a little more what I'm used to.\n\n354\n00:18:27.720 --> 00:18:30.593\nAnd I'll get logged in here.\n\n355\n00:18:30.593 --> 00:18:32.580\nI'll break the rules and log in as root.\n\n356\n00:18:32.580 --> 00:18:36.000\nBut once I'm in I can\npull up that runlevel.\n\n357\n00:18:36.000 --> 00:18:39.810\nAnd now I see I've switched from\nsingle user mode into runlevel 3.\n\n358\n00:18:39.810 --> 00:18:43.140\nSo I'm doing all of this transitioning\nwithout every actually rebooting.\n\n359\n00:18:43.140 --> 00:18:45.150\nWe can just move back and\nforth and that's it.\n\n360\n00:18:45.150 --> 00:18:51.578\nSo let me put it back into runlevel 5,\nso my screen will look nice [LAUGH].\n\n361\n00:18:51.578 --> 00:18:58.372\nAnd let me get out of the zoom,\nand get logged back in.\n\n362\n00:18:58.372 --> 00:19:00.660\nSo, there's how we can quickly and\neasily transition.\n\n363\n00:19:00.660 --> 00:19:02.930\nAnd that was pretty fast,\na lot faster than rebooting.\n\n364\n00:19:02.930 --> 00:19:04.150\n&gt;&gt; That was very fast.\n\n365\n00:19:04.150 --> 00:19:08.300\nHow do we know what systems\nrun at each runlevel?\n\n366\n00:19:08.300 --> 00:19:11.900\n&gt;&gt; Okay, so right now,\nI showed you guys those scripts.\n\n367\n00:19:11.900 --> 00:19:13.220\nAnd the scripts are fine.\n\n368\n00:19:13.220 --> 00:19:15.440\nIf you wanna go through and\ndig through those scripts,\n\n369\n00:19:15.440 --> 00:19:17.530\nyou can learn a lot about\nwhat your system does.\n\n370\n00:19:17.530 --> 00:19:20.740\nBut if you've got upstart, like I do,\n\n371\n00:19:20.740 --> 00:19:24.370\nthen there's a whole suite of utilities\nwe can use to make this a lot easier.\n\n372\n00:19:24.370 --> 00:19:28.410\nIn the old init days,\nif you just had true sysvinit\n\n373\n00:19:28.410 --> 00:19:32.430\nthe way I would answer Zach's question\nis you go to those rc.d folders and\n\n374\n00:19:32.430 --> 00:19:34.720\nyou find the runlevel and\nyou look at the services and you do that.\n\n375\n00:19:34.720 --> 00:19:36.280\nThat's the hard way.\n\n376\n00:19:36.280 --> 00:19:38.130\nBut Upstart made it easy.\n\n377\n00:19:38.130 --> 00:19:41.780\nWith Upstart you have two\ncommands that are really handy.\n\n378\n00:19:41.780 --> 00:19:47.580\nThe first one is the chkconfig command,\nthe check configuration command.\n\n379\n00:19:47.580 --> 00:19:51.270\nAnd this lets you check services to see\nwhat runlevels they're configured for.\n\n380\n00:19:51.270 --> 00:19:56.150\nAnd you can set them to start at some\nrunlevels and not start at others and\n\n381\n00:19:56.150 --> 00:19:57.610\nto start automatically.\n\n382\n00:19:57.610 --> 00:19:59.500\nThis is the command that we would use for\nthat.\n\n383\n00:19:59.500 --> 00:20:02.260\nSo, for example, SSH.\n\n384\n00:20:02.260 --> 00:20:03.590\nSSH is important to me.\n\n385\n00:20:03.590 --> 00:20:07.090\nI want it running if I'm in runlevel 3,\nmultiuser with networking.\n\n386\n00:20:07.090 --> 00:20:10.978\nAnd if I'm in runlevel 5,\nmulti-user with graphical user interface,\n\n387\n00:20:10.978 --> 00:20:12.430\nI want SSH running.\n\n388\n00:20:12.430 --> 00:20:15.880\nBut if I drop to single user mode,\nI don't want SSH running.\n\n389\n00:20:15.880 --> 00:20:19.570\nSo I might want it in runlevels 3 and\n5 but not in runlevel 1.\n\n390\n00:20:19.570 --> 00:20:25.300\nWell, I can say chkconfig --list and\nthen the name of a service.\n\n391\n00:20:26.340 --> 00:20:32.550\nSo I could say sshd and it will show\nme the runlevels that it's active for.\n\n392\n00:20:32.550 --> 00:20:34.850\nRemember cups a moment ago where\nI had to hunt and find it?\n\n393\n00:20:34.850 --> 00:20:36.280\n&gt;&gt; Yeah.\n&gt;&gt; That was super annoying.\n\n394\n00:20:36.280 --> 00:20:39.970\nI could've just come in and\nsaid, let me find cups.\n\n395\n00:20:39.970 --> 00:20:42.490\nAnd there it is, and\nit tells me the runlevels.\n\n396\n00:20:42.490 --> 00:20:46.930\nAnd if I look at ssh,\nit's turned on not for runlevel 1.\n\n397\n00:20:46.930 --> 00:20:49.830\nSo it's off for\nthat cuz it's single user mode.\n\n398\n00:20:49.830 --> 00:20:53.720\nIt's on for runlevel 2 and\n3, on for runlevels 4 and\n\n399\n00:20:53.720 --> 00:20:55.570\n5 and then off for 0 and 6.\n\n400\n00:20:55.570 --> 00:20:58.490\nEverything should be off for 0 and\n6 cuz the system is shutting down.\n\n401\n00:20:58.490 --> 00:21:00.910\nSo it's actually kinda set\nthe way that I want it anyway.\n\n402\n00:21:01.970 --> 00:21:04.780\nBut I can get in there and\nI can modify that.\n\n403\n00:21:04.780 --> 00:21:08.890\nA lot of people use a very basic\nform of the chkconfig command.\n\n404\n00:21:08.890 --> 00:21:15.180\nThey do chkconfig and\nthen they'll say something like sshd off.\n\n405\n00:21:16.560 --> 00:21:21.580\nAnd that will turn off the sshd service.\n\n406\n00:21:21.580 --> 00:21:27.320\nBut what it's really doing is\nturning it off for those runlevels.\n\n407\n00:21:27.320 --> 00:21:33.703\nAnd when you say chkconfig sshd on,\nwe think we're turning that service on.\n\n408\n00:21:33.703 --> 00:21:39.748\nBut what it's really doing is it's just\nsaying turn it on for these runlevels.\n\n409\n00:21:39.748 --> 00:21:44.210\nAnd when it did it, it turned it on for\nrunlevels 2, 3, 4, and 5.\n\n410\n00:21:44.210 --> 00:21:47.910\nWell, we don't really use\nrunlevel 2 very much.\n\n411\n00:21:47.910 --> 00:21:50.320\nAnd runlevel 4 is not even defined.\n\n412\n00:21:50.320 --> 00:21:50.998\nThat's an empty one.\n\n413\n00:21:50.998 --> 00:21:53.480\nIt's one that you can use if you\nwanna create a custom runlevel 3 for\n\n414\n00:21:53.480 --> 00:21:54.890\nyour own needs.\n\n415\n00:21:54.890 --> 00:21:59.690\nSo what if I wanna be really literal and\nsay I just want runlevel 3 and 5?\n\n416\n00:21:59.690 --> 00:22:02.584\nWell, I can turn it back off again.\n\n417\n00:22:02.584 --> 00:22:05.990\nSo now it's off for all runlevels.\n\n418\n00:22:05.990 --> 00:22:09.420\nAnd when I use that\nchkconfig sshd on command,\n\n419\n00:22:09.420 --> 00:22:12.130\nI can add a little bit more to it.\n\n420\n00:22:12.130 --> 00:22:18.020\nI can say chkconfig --level followed by\nthe runlevels that I want to support.\n\n421\n00:22:18.020 --> 00:22:21.080\nI'm gonna say 3 and 5, like that.\n\n422\n00:22:21.080 --> 00:22:26.200\nSo by saying checkconfig\n--level 35 sshd on\n\n423\n00:22:26.200 --> 00:22:29.920\nnow I'm just gonna turn it on for\nrunlevels 3 and 5.\n\n424\n00:22:29.920 --> 00:22:32.490\nAnd when I look at\nthe new list there it is.\n\n425\n00:22:32.490 --> 00:22:36.990\nRunlevel 2 and\nrunlevel 4 will not start ssh.\n\n426\n00:22:36.990 --> 00:22:40.710\nSo now I'm dictating which runlevels\nthese services will run at.\n\n427\n00:22:40.710 --> 00:22:43.970\nAnd I can go through and\ncustomize every service if I wanted.\n\n428\n00:22:43.970 --> 00:22:47.240\nIf I wanted to be able to print\nwhile I was in single user mode,\n\n429\n00:22:47.240 --> 00:22:49.900\nI could set cups so\nthat it was on in runlevel 1.\n\n430\n00:22:49.900 --> 00:22:52.380\nAnd so now yeah,\nI booted in single user mode.\n\n431\n00:22:52.380 --> 00:22:54.380\nBut I can still print out my reports or\n\n432\n00:22:54.380 --> 00:22:55.730\nwhatever it is that I'm\ntrying to generate.\n\n433\n00:22:55.730 --> 00:22:58.290\nMaybe the forensics guys need that,\nthey can do that.\n\n434\n00:22:58.290 --> 00:22:59.830\nThey set that up.\n\n435\n00:22:59.830 --> 00:23:02.990\nNow, it's defined here in the runlevel.\n\n436\n00:23:02.990 --> 00:23:07.750\nAnd, so if I reboot, or if I use the init\ncommand, and move into runlevel 3 or\n\n437\n00:23:07.750 --> 00:23:10.750\n5, then sshd is going to start.\n\n438\n00:23:10.750 --> 00:23:14.340\nSo, that's how we manage\nit on a permanent basis.\n\n439\n00:23:14.340 --> 00:23:18.070\nBut on a temporary basis,\nlet's say I wanna start sshd right now but\n\n440\n00:23:18.070 --> 00:23:20.140\nI don't wanna reboot the system.\n\n441\n00:23:20.140 --> 00:23:23.410\nThen we can always use the service\ncommand to help with that.\n\n442\n00:23:23.410 --> 00:23:27.130\nBut the service command is not persistent,\nit's a temporary thing.\n\n443\n00:23:27.130 --> 00:23:32.710\nIf I say service sshd start,\nactually let me sudo that,\n\n444\n00:23:32.710 --> 00:23:36.950\nI can start sshd, or I can stop it.\n\n445\n00:23:36.950 --> 00:23:40.330\nBut, if I stop it and I reboot, or\n\n446\n00:23:40.330 --> 00:23:43.880\nanytime I enter runlevel 3 or\nrunlevel 5 it's gonna start it again.\n\n447\n00:23:43.880 --> 00:23:49.092\nSo the service command is how we\ntemporarily interact with init or upstart.\n\n448\n00:23:49.092 --> 00:23:52.690\nBut chkconfig is how\nwe make it persistent.\n\n449\n00:23:52.690 --> 00:23:53.866\nAnd so we normally have to use both.\n\n450\n00:23:53.866 --> 00:23:58.289\nAnd when you read instructions,\nlike how you install service X, Y,\n\n451\n00:23:58.289 --> 00:24:02.346\nZ they'll usually say,\nwe need you to go in and do a chkconfig.\n\n452\n00:24:02.346 --> 00:24:04.426\nSshd on, right?\n\n453\n00:24:04.426 --> 00:24:07.517\nAnd that's gonna turn off on for\nthe run level and\n\n454\n00:24:07.517 --> 00:24:10.950\nthen follow the up with\na service sshd start, right?\n\n455\n00:24:10.950 --> 00:24:14.720\nSo we put the permanent change in place,\nand then we temporarily start it\n\n456\n00:24:14.720 --> 00:24:18.300\nknowing that on the next reboot it'll\nbe put back the way that we want and\n\n457\n00:24:18.300 --> 00:24:19.700\neverything kinda goes in there.\n\n458\n00:24:19.700 --> 00:24:24.578\nAnd you can always do a service\nstatus sshd to look at the current\n\n459\n00:24:24.578 --> 00:24:28.363\nstatus of it and see,\noops, I got it backwards.\n\n460\n00:24:28.363 --> 00:24:34.450\nIt's service shhd status,\nthere we go, and permission denied.\n\n461\n00:24:34.450 --> 00:24:37.431\nWell actually, it's kind of\nfortunate that I got that because.\n\n462\n00:24:37.431 --> 00:24:38.830\n&gt;&gt; [LAUGH] Live action debugging.\n\n463\n00:24:38.830 --> 00:24:40.720\n&gt;&gt; Look at the permission\nthat I got denied on, right?\n\n464\n00:24:40.720 --> 00:24:45.390\nSo I ran service shhd status,\ntell me the status of that service, right?\n\n465\n00:24:45.390 --> 00:24:46.840\nAnd do you see the error?\n\n466\n00:24:46.840 --> 00:24:51.440\n/etc/init.d/sshd, so\nit was init carrying out that role, and\n\n467\n00:24:51.440 --> 00:24:56.118\nif I run it with the actual permissions,\nthen I can see right here that\n\n468\n00:24:56.118 --> 00:25:00.895\nit's being powered by openssh and\nit's currently running, right?\n\n469\n00:25:00.895 --> 00:25:03.753\nSo init, you may have never heard of it.\n\n470\n00:25:03.753 --> 00:25:06.339\nPrior to watching this show, this may be\nthe first time you've ever heard of init\n\n471\n00:25:06.339 --> 00:25:07.920\nor Upstart for that matter, right?\n\n472\n00:25:07.920 --> 00:25:13.210\nBut in reality you've been using it every\nsingle moment you've been on your system.\n\n473\n00:25:13.210 --> 00:25:16.940\nAnd as a desktop administrator,\nor a home user,\n\n474\n00:25:16.940 --> 00:25:18.930\nor just a hobbyist you\nmay not care about that.\n\n475\n00:25:18.930 --> 00:25:21.100\nSo you may have never interacted with it,\nbut\n\n476\n00:25:21.100 --> 00:25:24.660\nas a server administrator,\nit's really important.\n\n477\n00:25:24.660 --> 00:25:28.150\nBecause you could have a server configured\nperfectly, have a MySQL database up and\n\n478\n00:25:28.150 --> 00:25:29.270\nit's running great.\n\n479\n00:25:29.270 --> 00:25:31.380\nAnd then something happens and\nthe server reboots and\n\n480\n00:25:31.380 --> 00:25:33.620\nnow everything's not running anymore,\nright?\n\n481\n00:25:33.620 --> 00:25:36.010\nOr things run in the wrong order,\nor something happens and\n\n482\n00:25:36.010 --> 00:25:37.500\nthat service is broken.\n\n483\n00:25:37.500 --> 00:25:38.860\nThis is really important,\n\n484\n00:25:38.860 --> 00:25:41.750\nwe've got to make sure that the\ninitialization system knows what we want\n\n485\n00:25:41.750 --> 00:25:45.120\nstarted, what we need to have that\nserver performing its functions.\n\n486\n00:25:45.120 --> 00:25:46.610\nAnd so these are the ways that we do that.\n\n487\n00:25:46.610 --> 00:25:52.440\nSo the key things to take away here\nare the inittab file, /etc/inittab.\n\n488\n00:25:52.440 --> 00:25:54.955\nThat sets your default run level.\n\n489\n00:25:54.955 --> 00:26:00.300\nChkconfig can easily allow us to assign\nservices to one run level or another.\n\n490\n00:26:00.300 --> 00:26:06.000\nAnd then service can temporarily start and\nstop services and get them running.\n\n491\n00:26:06.000 --> 00:26:10.519\nSo between those three places we got\neverything we need to interact with\n\n492\n00:26:10.519 --> 00:26:11.962\nthe init and Upstart.\n\n493\n00:26:11.962 --> 00:26:18.524\n&gt;&gt; Fantastic information as usual Don, so\ncisv, init, and Upstart, any final words?\n\n494\n00:26:18.524 --> 00:26:21.360\n&gt;&gt; I did mention that systemd\nis the replacement for this.\n\n495\n00:26:22.730 --> 00:26:28.870\nMost distros that are running systemd\nactually still honor the init commands.\n\n496\n00:26:28.870 --> 00:26:32.490\nSo if you go onto a systemd system and\nuse the service command or\n\n497\n00:26:32.490 --> 00:26:36.400\nyou use the chkconfig command, most of\nthem will translate it into systemd land.\n\n498\n00:26:36.400 --> 00:26:40.850\nSo you can still get away with it,\nbut if you're on an init system,\n\n499\n00:26:40.850 --> 00:26:43.484\nit will not take the systemd commands.\n\n500\n00:26:43.484 --> 00:26:46.760\nSo I do encourage people to\nlearn both sets of commands.\n\n501\n00:26:46.760 --> 00:26:48.730\nIf you're just using Upstart today,\n\n502\n00:26:48.730 --> 00:26:51.050\nyou wanna learn systemd\nbecause it's the future.\n\n503\n00:26:51.050 --> 00:26:52.915\nAnd if you're just using systemd today,\n\n504\n00:26:52.915 --> 00:26:55.990\nit's still useful to learn init\nbecause you may encounter it.\n\n505\n00:26:55.990 --> 00:26:58.270\nIt's still very very common out there.\n\n506\n00:26:58.270 --> 00:27:01.380\nIt's gonna be a while before\neverybody is completely on systemd.\n\n507\n00:27:01.380 --> 00:27:05.370\nBut every current distro being\nreleased is systemd based,\n\n508\n00:27:05.370 --> 00:27:06.690\nall the major ones at least.\n\n509\n00:27:06.690 --> 00:27:09.380\nUbuntu, Debian, Red Hat, CentOS,\n\n510\n00:27:09.380 --> 00:27:13.920\nFedora, they've all moved to systemd so\nthat is the way of the future.\n\n511\n00:27:13.920 --> 00:27:16.040\n&gt;&gt; Great information,\nDon, thanks very much.\n\n512\n00:27:16.040 --> 00:27:18.160\nAnd becoming a Linux server administrator.\n\n513\n00:27:18.160 --> 00:27:21.100\nThere's a lot of video\ncontent in the series.\n\n514\n00:27:21.100 --> 00:27:22.560\nMake sure you watch each and every video.\n\n515\n00:27:22.560 --> 00:27:26.110\nYou'll be glad you did and\nthank you for watching ITProTV.\n\n516\n00:27:26.110 --> 00:27:29.980\nRemember, a good IT pro is\nalways learning, I'm Zach Memos.\n\n517\n00:27:29.980 --> 00:27:30.650\n&gt;&gt; And I'm Don Pezet.\n\n518\n00:27:30.650 --> 00:27:33.478\n&gt;&gt; And we will see you very soon.\n\n519\n00:27:33.478 --> 00:27:39.389\n[MUSIC]\n\n520\n00:27:39.389 --> 00:27:41.420\nThank you for watching ITProTV.\n\n",
          "vimeoId": "226448130"
        },
        {
          "description": "Don and Zach give an overview as to why we would choose systemd over Upstart & SysV Init, go over key terms, discuss Target, NFS, go over Process, managing services, tools we need for systemd, managing run levels, and system power.",
          "length": "1718",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-3-2-systemd-072017-PGM.00_28_21_20.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-3-2-systemd-072017-PGM.00_28_21_20.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-3-2-systemd-072017-PGM.00_28_21_20.Still001-sm.jpg",
          "title": "systemd",
          "transcript": "WEBVTT\n\n1\n00:00:00.260 --> 00:00:01.158\nWelcome to ITProTV.\n\n2\n00:00:01.158 --> 00:00:02.813\nI'm your host Don Pezet.\n\n3\n00:00:02.813 --> 00:00:05.657\nWe're coming at you live from\nSan Francisco, California.\n\n4\n00:00:05.657 --> 00:00:07.222\n[CROSSTALK]\n\n5\n00:00:07.222 --> 00:00:08.243\n[MUSIC]\n\n6\n00:00:08.243 --> 00:00:12.169\n&gt;&gt; You're watching ITProTV.\n\n7\n00:00:12.169 --> 00:00:15.265\n&gt;&gt; Hello again, and\nthank you for choosing ITProTV,\n\n8\n00:00:15.265 --> 00:00:17.425\nhelping you learn wherever you go.\n\n9\n00:00:17.425 --> 00:00:19.999\nI'm your host Zach Memos as\nwe continue on with Becoming\n\n10\n00:00:19.999 --> 00:00:21.491\na Linux Server Administrator.\n\n11\n00:00:21.491 --> 00:00:25.076\nThe topic right now is systemd, and\nwe're gonna learn all about it.\n\n12\n00:00:25.076 --> 00:00:26.648\nAnd who's gonna bring us\nto all that information?\n\n13\n00:00:26.648 --> 00:00:29.534\nDon Pezet, our IT pro himself, right here.\n\n14\n00:00:29.534 --> 00:00:31.162\n&gt;&gt; And I am glad to be on the show.\n\n15\n00:00:31.162 --> 00:00:36.112\nIn the last episode I had talked\nabout upstart and init, sysvinit.\n\n16\n00:00:36.112 --> 00:00:38.341\nAnd during that whole\nepisode I kept saying, well,\n\n17\n00:00:38.341 --> 00:00:40.883\nyou do wanna learn about systemd\nbecause it's the future.\n\n18\n00:00:40.883 --> 00:00:42.945\nSo I'm kinda glad in this episode-\n&gt;&gt; The future!\n\n19\n00:00:42.945 --> 00:00:44.596\n&gt;&gt; We get to be in the future [LAUGH].\n\n20\n00:00:44.596 --> 00:00:45.960\n&gt;&gt; That's right.\n\n21\n00:00:45.960 --> 00:00:50.070\n&gt;&gt; So in this episode, we're gonna be\ntaking a look at what systemd is, how it\n\n22\n00:00:50.070 --> 00:00:55.360\nworks, how it does its job, how it has\neffectively replaced sysvinit and upstart.\n\n23\n00:00:55.360 --> 00:00:57.550\nAnd how it is what we're gonna\nbe using to manage our system.\n\n24\n00:00:57.550 --> 00:01:00.220\nSo if we're deploying servers\nthat are running systemd,\n\n25\n00:01:00.220 --> 00:01:03.810\nit is critical to keeping\nour systems up and running.\n\n26\n00:01:03.810 --> 00:01:05.660\nSo it's important we have\na basic understanding of it and\n\n27\n00:01:05.660 --> 00:01:07.310\nhow to interact with it and maintain it.\n\n28\n00:01:07.310 --> 00:01:10.120\nAnd that's all stuff that we're gonna\nsee right here in this episode.\n\n29\n00:01:10.120 --> 00:01:12.730\n&gt;&gt; And like you just mentioned, in a\nprevious episode we learned about upstart.\n\n30\n00:01:12.730 --> 00:01:16.242\nWhy would we use systemd over upstart?\n\n31\n00:01:16.242 --> 00:01:19.950\n&gt;&gt; All right, so for most people\nthe reason they're gonna switch to systemd\n\n32\n00:01:19.950 --> 00:01:22.615\nis simply because whichever distro\nthey're using has switched.\n\n33\n00:01:22.615 --> 00:01:24.500\n[LAUGH] And so that's it, right?\n\n34\n00:01:24.500 --> 00:01:29.640\nIf you're running Red Hat Enterprise Linux\n6 then you're using upstart, right?\n\n35\n00:01:29.640 --> 00:01:32.830\nAnd then when you upgrade to\nRed Hat Enterprise Linux 7,\n\n36\n00:01:32.830 --> 00:01:36.120\nthey've switched to systemd which\nmeans you've now switched to systemd.\n\n37\n00:01:36.120 --> 00:01:37.810\nSo that's what's gonna\nhappen to a lot of people.\n\n38\n00:01:37.810 --> 00:01:39.170\nThey're gonna switch because of that.\n\n39\n00:01:39.170 --> 00:01:43.402\nAnd honestly, many people on a workstation\nyou wouldn't notice the difference.\n\n40\n00:01:43.402 --> 00:01:47.948\nThere's not really anything there that's\ngonna show to the end user, right?\n\n41\n00:01:47.948 --> 00:01:51.570\nBut why are the distros\npicking the switch to systemd?\n\n42\n00:01:51.570 --> 00:01:53.980\nObviously, they have to do a lot of\nwork to make a change like that.\n\n43\n00:01:53.980 --> 00:01:56.700\nSo what would motivate them\nto make a change like that?\n\n44\n00:01:56.700 --> 00:02:01.050\nThe main thing is in nit,\na couple of problems.\n\n45\n00:02:01.050 --> 00:02:05.530\nOne problem was it didn't deal with\nhot plug hardware really well.\n\n46\n00:02:05.530 --> 00:02:07.816\nAnd in this day and age,\nwe are USB crazy, right?\n\n47\n00:02:07.816 --> 00:02:09.134\n&gt;&gt; Yeah.\n&gt;&gt; USB hard drives and mice and\n\n48\n00:02:09.134 --> 00:02:11.110\nkeyboards and all sorts of stuff.\n\n49\n00:02:11.110 --> 00:02:15.260\nAnd init liked to do all of its\nwork when the system booted up or\n\n50\n00:02:15.260 --> 00:02:18.950\nwhen the system changed run levels, which\nnormally was when you rebooted, right?\n\n51\n00:02:18.950 --> 00:02:20.490\nWe didn't change run levels very often.\n\n52\n00:02:20.490 --> 00:02:22.720\nSo it didn't handle hot\nplug hardware very well.\n\n53\n00:02:22.720 --> 00:02:28.190\nNow, let me make sure I'm clear on this,\nyou can have hot plug software under\n\n54\n00:02:28.190 --> 00:02:31.938\na NIT based systems and upstart systems,\nit just doesn't handle it very well.\n\n55\n00:02:31.938 --> 00:02:36.940\nSo with systemd, what they said is\nwe're not just gonna start up and\n\n56\n00:02:36.940 --> 00:02:39.620\nrun some scripts and\nthen clock out, right?\n\n57\n00:02:39.620 --> 00:02:40.970\nWe're gonna start up and\n\n58\n00:02:40.970 --> 00:02:45.550\nstay running and keep doing our job all\nthroughout the life cycle of this system,\n\n59\n00:02:45.550 --> 00:02:49.860\nwhich makes it really easy for\nit to detect and handle hot-plug hardware.\n\n60\n00:02:49.860 --> 00:02:53.700\nIn the server world, that's usually gonna\nbe hot-plug hard drives and detection for\n\n61\n00:02:53.700 --> 00:02:55.280\nthat, so it handles that really well, but\n\n62\n00:02:55.280 --> 00:02:58.500\nalso just additional hardware,\nit does a great job with.\n\n63\n00:02:58.500 --> 00:03:01.980\nBut the other thing is,\nit focused really on configuration.\n\n64\n00:03:01.980 --> 00:03:05.034\nIn the init world,\nyou have a ton of scripts right,\n\n65\n00:03:05.034 --> 00:03:09.579\nall of these scripts that are in slash\netc slash rc.d, and a typo in any one of\n\n66\n00:03:09.579 --> 00:03:13.656\nthose scripts could really derail\nyour system and cause problems.\n\n67\n00:03:13.656 --> 00:03:17.101\nProblems that might show up in one run\nlevel and not show up in another run level\n\n68\n00:03:17.101 --> 00:03:20.705\nor might cause where some of your services\nrun fine, and then there's this point\n\n69\n00:03:20.705 --> 00:03:24.160\nwhere you get broken and then all\nthe other services don't run fine.\n\n70\n00:03:24.160 --> 00:03:26.750\nIt's really difficult to troubleshoot and\nwork with.\n\n71\n00:03:26.750 --> 00:03:29.980\nAnd so with systemd, they took\nthe approach of saying, you know what?\n\n72\n00:03:29.980 --> 00:03:35.170\nInstead of a bunch of scripts, let's go\nwith what's called a monolithic binary,\n\n73\n00:03:35.170 --> 00:03:36.760\none big binary program.\n\n74\n00:03:36.760 --> 00:03:40.260\nSystemd, it's a program and\nit's running in the background.\n\n75\n00:03:40.260 --> 00:03:43.680\nAnd then it's gonna load\nconfiguration files,\n\n76\n00:03:43.680 --> 00:03:45.460\nall these different configuration files.\n\n77\n00:03:45.460 --> 00:03:48.988\nAnd because it's loading config\nfiles if one of them is messed up,\n\n78\n00:03:48.988 --> 00:03:50.510\nit's not a script, right.\n\n79\n00:03:50.510 --> 00:03:53.009\nIt's a config file, so\nwe can just ignore it and move on and\n\n80\n00:03:53.009 --> 00:03:56.292\nall the other ones are fine and\nit can handle that much, much better.\n\n81\n00:03:56.292 --> 00:04:01.110\nSo systemd is more reliable and stable for\n\n82\n00:04:01.110 --> 00:04:05.080\nenvironment where we may\npotentially have errors like that.\n\n83\n00:04:05.080 --> 00:04:08.010\nYou will see a lot of\narguments on the Internet.\n\n84\n00:04:08.010 --> 00:04:11.200\nThere are people out\nthere who hate systemd.\n\n85\n00:04:11.200 --> 00:04:15.070\nAnd the main argument is that\nit is this monolithic binary,\n\n86\n00:04:15.070 --> 00:04:17.220\nthis binary that does more than one thing.\n\n87\n00:04:17.220 --> 00:04:21.060\nAnd in the Unix world, we normally try and\nkeep things very task focused.\n\n88\n00:04:21.060 --> 00:04:23.859\nA system does one job, and\nit does it really well.\n\n89\n00:04:23.859 --> 00:04:25.275\nWith systemd it's bigger, and\n\n90\n00:04:25.275 --> 00:04:28.358\nit's got a lot of protections\nto stop us from making mistakes.\n\n91\n00:04:28.358 --> 00:04:31.800\nSo the hardcore Unix administrators\nwill say, well, you know how I do that?\n\n92\n00:04:31.800 --> 00:04:32.520\nI don't make mistakes!\n\n93\n00:04:33.660 --> 00:04:37.290\nWell, that's fine and good, but I,\nDon Pezet, make mistakes and so\n\n94\n00:04:37.290 --> 00:04:39.077\nI appreciate the systemd.\n\n95\n00:04:39.077 --> 00:04:41.120\n&gt;&gt; [LAUGH]\n&gt;&gt; A man has got to know his limitations.\n\n96\n00:04:41.120 --> 00:04:42.600\n&gt;&gt; [LAUGH] That is absolutely true.\n\n97\n00:04:42.600 --> 00:04:44.185\nSo we all make mistakes.\n\n98\n00:04:44.185 --> 00:04:46.710\nSystemd makes those mistakes less painful.\n\n99\n00:04:46.710 --> 00:04:48.420\nAnd so I like it.\n\n100\n00:04:48.420 --> 00:04:50.104\nThe distros like it.\n\n101\n00:04:50.104 --> 00:04:54.454\nYou are seeing where Ubuntu,\nRed Hat, CentOS,\n\n102\n00:04:54.454 --> 00:04:58.184\nFedora, they've all moved to systemd.\n\n103\n00:04:58.184 --> 00:05:02.415\nDebian is kind of on the fence where\nthey still have both where you can\n\n104\n00:05:02.415 --> 00:05:04.530\ndo Upstart or you can do systemd.\n\n105\n00:05:04.530 --> 00:05:08.140\nYou can actually still do regular\ncis via net to be in also.\n\n106\n00:05:08.140 --> 00:05:10.915\nSo, they're a little more on the fence,\nbut most of the distros have moved over,\n\n107\n00:05:10.915 --> 00:05:11.529\nall the big ones.\n\n108\n00:05:11.529 --> 00:05:15.640\nThe big distros that we usually worry\nabout, are all running systemd these days.\n\n109\n00:05:15.640 --> 00:05:18.690\nSo, that's one of the main reasons\nthat we want to learn about it.\n\n110\n00:05:18.690 --> 00:05:21.800\nLearn how it works and\nkinda see how it does its job.\n\n111\n00:05:21.800 --> 00:05:25.230\nNow I mentioned this binary, right?\n\n112\n00:05:25.230 --> 00:05:28.060\nAnd with init, in the upstart episodes,\n\n113\n00:05:28.060 --> 00:05:31.025\nI talked about how it was\nthe first process that was run.\n\n114\n00:05:31.025 --> 00:05:32.116\nSystemd is the same way, right?\n\n115\n00:05:32.116 --> 00:05:34.140\nIf you wanna find out if you're\nrunning systemd, it's real easy.\n\n116\n00:05:34.140 --> 00:05:36.120\nYeah, I'll show you on this system.\n\n117\n00:05:36.120 --> 00:05:40.720\nSo I am remoted into the server\nthat we've been using this series.\n\n118\n00:05:40.720 --> 00:05:44.275\nSo it is running\nRed Hat Enterprise Linux 7.3.\n\n119\n00:05:44.275 --> 00:05:45.410\nSo that's what we're running.\n\n120\n00:05:45.410 --> 00:05:51.373\nAnd if I do a ps- p 1,\nI just want to see process number 1.\n\n121\n00:05:51.373 --> 00:05:53.730\nShow me the very first process.\n\n122\n00:05:53.730 --> 00:05:54.890\nMine is systemd.\n\n123\n00:05:56.240 --> 00:06:00.840\nIf I was running upstart or\nsysvinit I would see init here.\n\n124\n00:06:00.840 --> 00:06:02.860\nBut I'm running systemd.\n\n125\n00:06:02.860 --> 00:06:08.180\nNow in the very first versions of system\ndeep they actually did call it init.\n\n126\n00:06:08.180 --> 00:06:10.160\nBut those are long gone by now.\n\n127\n00:06:11.270 --> 00:06:13.800\nSo now it's all called systemd,\nthat's what you should see.\n\n128\n00:06:13.800 --> 00:06:15.260\nIf you're worried about that though.\n\n129\n00:06:15.260 --> 00:06:19.280\nIf you're worried about whether or\nnot you've maybe got a really old\n\n130\n00:06:19.280 --> 00:06:21.880\nsystem you think it might\nactually be running systemd,\n\n131\n00:06:21.880 --> 00:06:25.520\nwe'll see a little bit later the commands\nthat we use to interact with systemd.\n\n132\n00:06:25.520 --> 00:06:26.710\nAnd those commands just won't work.\n\n133\n00:06:26.710 --> 00:06:27.540\nAnd that's how you know.\n\n134\n00:06:27.540 --> 00:06:29.090\nEither the commands will be there or\nthey won't.\n\n135\n00:06:29.090 --> 00:06:33.560\nBut this is the easiest way to see it, ps-\np1, just show me process number one and\n\n136\n00:06:33.560 --> 00:06:37.040\nif you see systemd,\nthen you're up and you're running it.\n\n137\n00:06:37.040 --> 00:06:41.680\nAnd as far as like all the configuration\nfiles and stuff that I mentioned,\n\n138\n00:06:41.680 --> 00:06:46.720\nall that stuff, if you take a look in\nslash lib /systemd, that's another\n\n139\n00:06:46.720 --> 00:06:49.400\ngood indication that you're running\nsystemd, if this folder even exists.\n\n140\n00:06:49.400 --> 00:06:50.215\n&gt;&gt; Right on.\n\n141\n00:06:50.215 --> 00:06:51.900\n&gt;&gt; /system.\n\n142\n00:06:51.900 --> 00:06:56.260\nIn sysvnit, we had /etc/rc.d.\n\n143\n00:06:56.260 --> 00:06:58.820\nAnd it was packed full of all\nthese various scripts and\n\n144\n00:06:58.820 --> 00:07:00.540\ndifferent run levels, right.\n\n145\n00:07:00.540 --> 00:07:05.867\nIn systemd, we have /lib/systemd/system\nand if you look in there,\n\n146\n00:07:05.867 --> 00:07:10.060\nthat's all the config files\nthat I mentioned, right?\n\n147\n00:07:10.060 --> 00:07:13.160\nSo we take ourselves out\nof the scripting world and\n\n148\n00:07:13.160 --> 00:07:15.680\nwe put ourselves into\na configuration file world.\n\n149\n00:07:15.680 --> 00:07:19.163\nAnd these are all the configuration files\nthat systemd is loading, all kind of\n\n150\n00:07:19.163 --> 00:07:22.225\ntucked right here in this folder to\nmake that administration a little\n\n151\n00:07:22.225 --> 00:07:25.792\nbit easier and have everything kind of all\nin one place where we can work with it.\n\n152\n00:07:25.792 --> 00:07:28.620\n&gt;&gt; Now,\nDon you said this would be easier, but\n\n153\n00:07:28.620 --> 00:07:32.837\nafter seeing the directory I'm\nwondering how is this easier?\n\n154\n00:07:32.837 --> 00:07:35.235\n&gt;&gt; All right,\nit's a little daunting at first,\n\n155\n00:07:35.235 --> 00:07:37.735\nokay I'll admit there's a lot\nof stuff in here, right?\n\n156\n00:07:37.735 --> 00:07:40.545\nBut let's equate this back to the old way.\n\n157\n00:07:40.545 --> 00:07:44.220\nThe old was was that I\nwould go into /etc/rc.d and\n\n158\n00:07:44.220 --> 00:07:48.690\ninside of rc.d, there were multiple\nfolders, one for each run level, right?\n\n159\n00:07:48.690 --> 00:07:52.374\nSo rc.d0, rc.d1, all the way up to 6.\n\n160\n00:07:52.374 --> 00:07:54.043\nAnd there were scripts inside of there.\n\n161\n00:07:54.043 --> 00:07:56.969\nAnd if I had a service that I wanted\nto run at more than one run level,\n\n162\n00:07:56.969 --> 00:08:00.123\nI had to have more than one copy of\nthat script which made room for error.\n\n163\n00:08:00.123 --> 00:08:04.037\nWell, here all of the configuration\nvalues are just in one place.\n\n164\n00:08:04.037 --> 00:08:07.420\nSo we're lumping all those\ndirectories together in one place.\n\n165\n00:08:07.420 --> 00:08:11.681\nAnd then we're defining things a little\nbit differently, that, if you look,\n\n166\n00:08:11.681 --> 00:08:13.279\nevery file has an extension.\n\n167\n00:08:13.279 --> 00:08:15.332\nThat's a very un-Unix type thing.\n\n168\n00:08:15.332 --> 00:08:16.806\nEvery file has an extension on it.\n\n169\n00:08:16.806 --> 00:08:21.299\nAnd you'll see .service, .socket, .target.\n\n170\n00:08:21.299 --> 00:08:23.401\nThese are all different things.\n\n171\n00:08:23.401 --> 00:08:25.410\n.wants, that's kind of an important one.\n\n172\n00:08:25.410 --> 00:08:27.162\nSo all of those are different things.\n\n173\n00:08:27.162 --> 00:08:30.245\nThese aren't just simple scripts.\n\n174\n00:08:30.245 --> 00:08:35.720\nsystemd can control a lot more\nthan just a simple script.\n\n175\n00:08:35.720 --> 00:08:38.730\nIt can control whether\na file system gets mounted.\n\n176\n00:08:38.730 --> 00:08:45.860\nIf we look for anything that ends in\n.mount, let me do *.mount*, there we go.\n\n177\n00:08:45.860 --> 00:08:50.170\nSo I see these little files here for\nthe fuse file system,\n\n178\n00:08:50.170 --> 00:08:53.080\nhow you can mount third party\nfile systems like NTFS.\n\n179\n00:08:53.080 --> 00:08:54.470\nSo it's got a .mount file.\n\n180\n00:08:54.470 --> 00:08:57.122\nSo enabling the ability\nto mount those drives.\n\n181\n00:08:57.122 --> 00:09:01.480\nOr socket,\nif I wanted to pull up the sockets,\n\n182\n00:09:01.480 --> 00:09:03.330\nthese are network sockets\nthat I might wanna open.\n\n183\n00:09:03.330 --> 00:09:07.170\nIf I'm running SSH, I need to open\nup port22 to receive connection.\n\n184\n00:09:07.170 --> 00:09:10.190\nSo there's the SSHD\nsocket that being opened.\n\n185\n00:09:10.190 --> 00:09:11.520\nThose are there.\n\n186\n00:09:11.520 --> 00:09:13.830\nSo these are all defining\ndifferent functions.\n\n187\n00:09:13.830 --> 00:09:18.080\nNow, SSHD is not just a socket,\nit's also a service.\n\n188\n00:09:18.080 --> 00:09:23.660\nAnd so there'll be a second file,\nif I look for sshd*,\n\n189\n00:09:23.660 --> 00:09:30.790\nwhere it's got the socket as well\nas the service itself right there.\n\n190\n00:09:30.790 --> 00:09:34.480\nSo the service starts up and\nthe network socket is waiting for it.\n\n191\n00:09:34.480 --> 00:09:37.690\nAnd I could turn off the network socket\nbut keep the service running for\n\n192\n00:09:37.690 --> 00:09:39.400\nlocal testing or whatever.\n\n193\n00:09:39.400 --> 00:09:40.520\nYou can control that independently.\n\n194\n00:09:40.520 --> 00:09:42.520\nThat's some of the power that we get.\n\n195\n00:09:42.520 --> 00:09:46.200\nNow the challenge here becomes\nhow do we group these together.\n\n196\n00:09:46.200 --> 00:09:49.640\nWith init they were grouped\ntogether in folders.\n\n197\n00:09:49.640 --> 00:09:50.780\nHere they're not.\n\n198\n00:09:50.780 --> 00:09:56.696\nSo what you'll find are there\nare some files that end in .target.\n\n199\n00:09:56.696 --> 00:10:01.570\nAnd the target is actually\na grouping of other things.\n\n200\n00:10:01.570 --> 00:10:07.852\nNow .service, .socket, .mount,\nthose are all what are called units.\n\n201\n00:10:07.852 --> 00:10:11.980\nAnd systemd works based on units and\ntargets, okay?\n\n202\n00:10:11.980 --> 00:10:15.710\nA unit is an individual thing,\nlike the SSHD service.\n\n203\n00:10:15.710 --> 00:10:18.870\nA target is a group of units.\n\n204\n00:10:18.870 --> 00:10:20.981\nAnd so when I boot up my system,\n\n205\n00:10:20.981 --> 00:10:25.470\nyou actually have a couple of\ndifferent targets that can be used.\n\n206\n00:10:25.470 --> 00:10:28.712\nBut the main one that we\nwant is this default target,\n\n207\n00:10:28.712 --> 00:10:31.020\nwhich is buried in here somewhere.\n\n208\n00:10:31.020 --> 00:10:33.590\nRight here, default.target.\n\n209\n00:10:33.590 --> 00:10:39.040\nAnd that default target is a collection\nof units that I'll use when I start.\n\n210\n00:10:39.040 --> 00:10:43.220\nAnd there's other ones that we might use,\nlike this graphical.target.\n\n211\n00:10:43.220 --> 00:10:46.640\nIf I wanna boot to a GUI,\nthe graphical.target is what I want.\n\n212\n00:10:46.640 --> 00:10:52.005\nOr if I just wanna boot to command Line,\nI might want multiuser.target.\n\n213\n00:10:52.005 --> 00:10:55.455\nWell, notice default.target,\nhow it's a link.\n\n214\n00:10:55.455 --> 00:10:57.902\nIt's a symlink,\nit's a little light blue color here.\n\n215\n00:10:57.902 --> 00:11:02.964\nBecause all we have to do is say hey,\nif I wanna boot into the command line,\n\n216\n00:11:02.964 --> 00:11:06.818\nI just symlink default.target\nto point to multiuser.\n\n217\n00:11:06.818 --> 00:11:10.683\nBut if I wanna boot to a graphical user\ninterface I just symlink default.target to\n\n218\n00:11:10.683 --> 00:11:12.148\npoint to graphical.target.\n\n219\n00:11:12.148 --> 00:11:14.730\nSo I can easily activate a target.\n\n220\n00:11:14.730 --> 00:11:19.060\nAnd when the target runs,\nit calls all the units inside of it.\n\n221\n00:11:19.060 --> 00:11:21.550\nSo this is kind of a hierarchy.\n\n222\n00:11:21.550 --> 00:11:25.655\nAnd so yes, there's a ton of stuff\nin here, all these different units.\n\n223\n00:11:25.655 --> 00:11:29.150\nBut they're grouped together targets,\nand that makes life a lot easier.\n\n224\n00:11:29.150 --> 00:11:31.336\nAnd then you've got\nthings like the .wants.\n\n225\n00:11:31.336 --> 00:11:33.174\nwants really cool.\n\n226\n00:11:33.174 --> 00:11:37.315\nThat's saying look,\nI've got a timers target,\n\n227\n00:11:37.315 --> 00:11:41.379\nif we look really close here,\ntimers.target.\n\n228\n00:11:41.379 --> 00:11:46.860\nAnd the timers.target might rely on\nother targets to have already started.\n\n229\n00:11:46.860 --> 00:11:49.560\nAnd so there's timers.target.wants.\n\n230\n00:11:49.560 --> 00:11:52.526\nBefore I start timers, I need to start\nsome of these other things first.\n\n231\n00:11:52.526 --> 00:11:55.500\nSo now we have a hierarchy in order.\n\n232\n00:11:55.500 --> 00:11:58.540\nBack in the upstart days,\nyou had to name the scripts.\n\n233\n00:11:58.540 --> 00:11:59.620\nAnd you had to put a number on them.\n\n234\n00:11:59.620 --> 00:12:04.451\nI would have to give timers a number\nthat was earlier than something else.\n\n235\n00:12:04.451 --> 00:12:10.010\nIf it was a kernel service,\nI would say, k99 timers.\n\n236\n00:12:10.010 --> 00:12:13.126\nAnd then for whatever it wanted,\nI'd have to go to those guys and\n\n237\n00:12:13.126 --> 00:12:15.870\nset them to be k01 or\nk02 so they started first.\n\n238\n00:12:15.870 --> 00:12:17.300\nThat was difficult to manage.\n\n239\n00:12:17.300 --> 00:12:18.772\nHere we can just define\nit in these wants files.\n\n240\n00:12:18.772 --> 00:12:21.490\nAnd systemd reads these configurations.\n\n241\n00:12:21.490 --> 00:12:24.860\nAnd it builds the proper boot order\nto make sure this all goes off\n\n242\n00:12:24.860 --> 00:12:25.620\nwithout a hitch.\n\n243\n00:12:25.620 --> 00:12:26.860\nThat's what it does.\n\n244\n00:12:26.860 --> 00:12:27.530\nThat's it's job.\n\n245\n00:12:27.530 --> 00:12:29.940\nsystemd is very powerful.\n\n246\n00:12:29.940 --> 00:12:34.600\nAnd, it doesn't get tripped up if there's\nan error in a simple config file.\n\n247\n00:12:34.600 --> 00:12:36.380\nAnd I'll show you how we can\nkind of verify that stuff.\n\n248\n00:12:36.380 --> 00:12:38.947\nBut, it'll actually recover\nfrom that pretty well.\n\n249\n00:12:38.947 --> 00:12:42.540\nAnd just that one service or\njust that one target will be damaged.\n\n250\n00:12:42.540 --> 00:12:44.450\nSo, it does look daunting.\n\n251\n00:12:44.450 --> 00:12:46.140\nIt looks like there's\na ton of stuff there.\n\n252\n00:12:46.140 --> 00:12:49.180\nBut at the end of the day,\nit boils down to just a couple of things,\n\n253\n00:12:49.180 --> 00:12:51.500\nthose dot services and those dot targets.\n\n254\n00:12:51.500 --> 00:12:52.649\nI used SSH as an example there.\n\n255\n00:12:52.649 --> 00:12:56.560\nBut we could look for NFS and\nit would be the same thing.\n\n256\n00:12:57.750 --> 00:13:00.040\nLet's see here,\nI don't have NFS installed.\n\n257\n00:13:00.040 --> 00:13:03.330\nSo you do have to have the services\ninstalled in order for that to work.\n\n258\n00:13:03.330 --> 00:13:09.240\nAnd if I were to install NFS,\nlet's see if I can do that real quick.\n\n259\n00:13:09.240 --> 00:13:12.400\nIf I were to do nfs tools and nfsclient.\n\n260\n00:13:12.400 --> 00:13:14.400\nI think those are the package that I want.\n\n261\n00:13:14.400 --> 00:13:20.876\nBut if I install NFS,\nas part of installing that, let's see.\n\n262\n00:13:20.876 --> 00:13:21.870\nNo, apparently I don't know the names.\n\n263\n00:13:21.870 --> 00:13:26.578\nWell, anyhow, as part of installing those\nservices, it will create the .service and\n\n264\n00:13:26.578 --> 00:13:27.160\nthe .target.\n\n265\n00:13:27.160 --> 00:13:28.800\nAnd it will put those things in here.\n\n266\n00:13:28.800 --> 00:13:33.136\nSo, for example, if I want a web server,\nwell I've already got a web server,\n\n267\n00:13:33.136 --> 00:13:34.079\nif I want my SQL.\n\n268\n00:13:34.079 --> 00:13:36.738\nLet's see if we got that one, there we go.\n\n269\n00:13:36.738 --> 00:13:38.055\nSo we don't have that one.\n\n270\n00:13:38.055 --> 00:13:44.050\nSo I'll do a quick install of MySQL,\nand we can install that.\n\n271\n00:13:44.050 --> 00:13:47.660\nAnd when we do it as part of installing\nit it's gonna add the dot service.\n\n272\n00:13:47.660 --> 00:13:49.055\nIt's gonna add the dot targets,\nand it's gonna configure it.\n\n273\n00:13:49.055 --> 00:13:51.110\nSo we don't have to interact with those so\nmuch.\n\n274\n00:13:51.110 --> 00:13:51.644\n&gt;&gt; That's great.\n\n275\n00:13:51.644 --> 00:13:53.966\n&gt;&gt; It's a overwhelming amount\nof stuff in that folder.\n\n276\n00:13:53.966 --> 00:13:57.270\nBut we just need to target in on\nthe areas that are important to us.\n\n277\n00:13:57.270 --> 00:13:59.120\nAnd that way when the system\nboots it knows what to get.\n\n278\n00:13:59.120 --> 00:14:04.867\nAnd so now if I look inside of here,\nshoot, I picked a bad example.\n\n279\n00:14:04.867 --> 00:14:07.680\nMySQL, you have to run it once to\ncreate the configuration files.\n\n280\n00:14:07.680 --> 00:14:09.811\nIt's got a whole little process\nthat it has to goes through.\n\n281\n00:14:09.811 --> 00:14:12.343\nSo I actually won't be able\nto show with my MySQL.\n\n282\n00:14:12.343 --> 00:14:19.009\nBut we could see it with httpd where\nit created that service right there.\n\n283\n00:14:19.009 --> 00:14:20.480\nIt's got the service file.\n\n284\n00:14:20.480 --> 00:14:21.970\nNow it doesn't have a target.\n\n285\n00:14:21.970 --> 00:14:25.090\nAnd that's because it's kind of\na standalone thing, it's by itself.\n\n286\n00:14:25.090 --> 00:14:29.080\nBut, if I have EngineX or a few other\nthings and I wanna link them together,\n\n287\n00:14:29.080 --> 00:14:31.150\nI would need to create a file\nto create that linkage.\n\n288\n00:14:31.150 --> 00:14:33.230\nI would need to tell the system about it.\n\n289\n00:14:33.230 --> 00:14:36.024\nSo that's all part of having\nthese services running and\n\n290\n00:14:36.024 --> 00:14:38.250\nsystemd managing them.\n\n291\n00:14:38.250 --> 00:14:42.230\nNow, Don, do we use the same tools\nfrom upstart to manage systemd?\n\n292\n00:14:42.230 --> 00:14:44.430\n&gt;&gt; You can, yeah.\n\n293\n00:14:44.430 --> 00:14:45.820\nYou shouldn't, but you can.\n\n294\n00:14:45.820 --> 00:14:47.980\nNow I've been showing\nyou this folder here.\n\n295\n00:14:47.980 --> 00:14:51.140\nAnd the reality is we're not normally\ngonna go mess around in this folder.\n\n296\n00:14:51.140 --> 00:14:52.990\nThis is not where we're\ngonna interact with things.\n\n297\n00:14:52.990 --> 00:14:56.490\nIf I want httpd to start when my system\nstarts I'm not gonna come in here and\n\n298\n00:14:56.490 --> 00:14:58.290\nedit this service file directly.\n\n299\n00:14:58.290 --> 00:15:00.760\nSo we do have commands that we can use.\n\n300\n00:15:00.760 --> 00:15:06.070\nAnd if you're familiar with sysvinit and\nyou're familiar with upstart, those old\n\n301\n00:15:06.070 --> 00:15:10.460\ncommands, most of the distros that are out\nthere, they actually still support them.\n\n302\n00:15:10.460 --> 00:15:11.520\nBut they're gonna take the commands.\n\n303\n00:15:11.520 --> 00:15:14.540\nAnd they're gonna send\nthem over to systemd.\n\n304\n00:15:14.540 --> 00:15:19.332\nSo, for example, if I did something like,\nI'm gonna just become a root user here so\n\n305\n00:15:19.332 --> 00:15:21.710\nI don't have to sudo everything.\n\n306\n00:15:21.710 --> 00:15:26.489\nI'm gonna say service httpd start.\n\n307\n00:15:26.489 --> 00:15:28.898\nWhen I run that, see what it did?\n\n308\n00:15:28.898 --> 00:15:34.350\nRedirecting to /bin/systemctl\nstart httpd.service.\n\n309\n00:15:34.350 --> 00:15:37.390\nIt took my old upstart command.\n\n310\n00:15:37.390 --> 00:15:41.540\nAnd it converted it into\nthe new systemd command.\n\n311\n00:15:41.540 --> 00:15:47.020\nWe interact with systemd using systemctl,\nsystemctl, or system control.\n\n312\n00:15:47.020 --> 00:15:49.950\nThat's the command we use\nto interact with systemd.\n\n313\n00:15:49.950 --> 00:15:53.808\nAnd we'll use it for darn near everything.\n\n314\n00:15:53.808 --> 00:15:56.598\nIn the upstart days really\nthe service command and\n\n315\n00:15:56.598 --> 00:16:00.263\nthe checkconfig command Those\nwere the two that we used, right?\n\n316\n00:16:00.263 --> 00:16:03.871\nSo, anytime I installed a new service,\nlike HTTP,\n\n317\n00:16:03.871 --> 00:16:09.030\nI would say check config HTTP on,\nto say I want it to run at boot, okay?\n\n318\n00:16:09.030 --> 00:16:13.180\nAnd then I would say service HTTP start,\nt actually start it up, right?\n\n319\n00:16:13.180 --> 00:16:18.470\nWell, both of those are getting forwarded,\nand they're being forwarded to system CTL.\n\n320\n00:16:18.470 --> 00:16:20.790\nSystem CTL does that job now.\n\n321\n00:16:20.790 --> 00:16:25.660\nSo if I want something to start\nat boot I say system CTL,\n\n322\n00:16:25.660 --> 00:16:30.424\nenable and then the name of what it\nis I want to start at boot right?\n\n323\n00:16:30.424 --> 00:16:31.900\nSo n this case HTTP.\n\n324\n00:16:31.900 --> 00:16:36.950\nNow in the past, we just had service names\nbecause init just worried about services.\n\n325\n00:16:36.950 --> 00:16:38.240\nBut system D can do more.\n\n326\n00:16:38.240 --> 00:16:39.100\nIt can do services.\n\n327\n00:16:39.100 --> 00:16:40.120\nIt can do sockets.\n\n328\n00:16:40.120 --> 00:16:42.499\nIt can do mounts, all those other things.\n\n329\n00:16:43.850 --> 00:16:49.372\nSo technically when I run this,\nI need to say HTTPD.service,\n\n330\n00:16:49.372 --> 00:16:53.390\nunless there is only one HTTPD file.\n\n331\n00:16:53.390 --> 00:16:54.957\nWhen I look, oops that's not backspace.\n\n332\n00:16:54.957 --> 00:16:58.198\nWhen I look in this folder, so\n\n333\n00:16:58.198 --> 00:17:04.100\nI'm still in /user/lib/systemD/system.\n\n334\n00:17:04.100 --> 00:17:08.820\nIf I look in here for\nHTTPD I've only got one file, right?\n\n335\n00:17:08.820 --> 00:17:11.330\nSo if I were to run system CTL\n\n336\n00:17:11.330 --> 00:17:14.490\nenable HTTPD it would know\nwhat I was talking about.\n\n337\n00:17:14.490 --> 00:17:17.410\nIt would know I was talking\nabout the service, okay?\n\n338\n00:17:17.410 --> 00:17:22.263\nBut if it was SSH,\nwhere there was a .service and\n\n339\n00:17:22.263 --> 00:17:24.910\na .socket it might not know\nwhat I was talking about.\n\n340\n00:17:24.910 --> 00:17:28.090\nSo technically I need to follow\nthat up with .service so\n\n341\n00:17:28.090 --> 00:17:30.560\nit knows that I'm specifically\ntalking about the service,\n\n342\n00:17:30.560 --> 00:17:34.560\nnot necessarily the socket or the mount or\nwhatever the other thing is, all right?\n\n343\n00:17:34.560 --> 00:17:37.970\nSo system ctl enable, that tells it\nto start when the system starts.\n\n344\n00:17:37.970 --> 00:17:41.750\nOr system ctl disable tells it not\nto start it when the system starts.\n\n345\n00:17:41.750 --> 00:17:47.390\nAnd then system ctl start and\nthe name of the service.\n\n346\n00:17:47.390 --> 00:17:50.650\nThat'll actually start it up,\nwhere you can say stop, or\n\n347\n00:17:50.650 --> 00:17:53.270\nmy favorite, there's a restart now.\n\n348\n00:17:53.270 --> 00:17:58.080\nIn the service days, we had to say,\nservice HTTP stop, service HTTP start.\n\n349\n00:17:58.080 --> 00:17:59.690\nYou had to do two commands.\n\n350\n00:17:59.690 --> 00:18:00.940\nNow I can just say,\n\n351\n00:18:00.940 --> 00:18:06.400\nsystem CTL restart HTTPD and\nit'll go in and it'll do it, right?\n\n352\n00:18:06.400 --> 00:18:08.400\nSo it'll stop it and then start it again.\n\n353\n00:18:08.400 --> 00:18:11.735\nAnd I could leave .service off here and\nit would run just fine,\n\n354\n00:18:11.735 --> 00:18:13.180\nbecause there's no duplicates, right?\n\n355\n00:18:13.180 --> 00:18:17.340\nSo as long as it's a unique name,\nyou'll be okay there with just system CTL.\n\n356\n00:18:17.340 --> 00:18:21.000\nNow, it does a lot more than just\nstarting and stopping services,\n\n357\n00:18:21.000 --> 00:18:22.950\nbecause SystemD does a lot more.\n\n358\n00:18:22.950 --> 00:18:25.600\nSo for example,\nI could say systemCTL -- version.\n\n359\n00:18:27.090 --> 00:18:29.400\nIt'll tell me which version\nof system D I'm running.\n\n360\n00:18:29.400 --> 00:18:31.040\nI'm running system D version 219.\n\n361\n00:18:31.040 --> 00:18:35.300\nI think the current\nversion is actually 234 or\n\n362\n00:18:35.300 --> 00:18:39.500\nsomething like that so I'm several\nversions behind but that's okay.\n\n363\n00:18:39.500 --> 00:18:41.610\nSystem D updates very, very frequently.\n\n364\n00:18:41.610 --> 00:18:45.710\nThere's new versions almost\nevery month that come out and\n\n365\n00:18:45.710 --> 00:18:47.920\nyou don't necessarily want the latest and\ngreatest.\n\n366\n00:18:47.920 --> 00:18:51.150\nBut it helps me to determine\nwhich version I'm running and\n\n367\n00:18:51.150 --> 00:18:53.600\nwhich plugins are enabled on it?\n\n368\n00:18:53.600 --> 00:18:58.110\nI can see that I've got SC Linux\nis added onto my system D.\n\n369\n00:18:58.110 --> 00:19:00.250\nSystemd is a program.\n\n370\n00:19:00.250 --> 00:19:04.790\nIt's a monolithic binary and so it uses\nplugins to extend its functionality.\n\n371\n00:19:04.790 --> 00:19:07.990\nAnd these are things that\nhave been added to it.\n\n372\n00:19:07.990 --> 00:19:10.540\nSo my functionality might be\nmore than your functionality.\n\n373\n00:19:10.540 --> 00:19:13.200\nIf you're running a different distro you\nmight be missing some of these pieces.\n\n374\n00:19:13.200 --> 00:19:17.450\nBut that shows me how I can use system D\nto manage a heck of a lot more than just\n\n375\n00:19:17.450 --> 00:19:19.330\nwhether services start and stop.\n\n376\n00:19:19.330 --> 00:19:23.620\nAnd notice how there's this guy\nright here, plus sysvinit right?\n\n377\n00:19:23.620 --> 00:19:28.560\nThat's what's giving me my compatibility\nwith upstart and sysvinit.\n\n378\n00:19:28.560 --> 00:19:32.370\nOne of these days that's gonna go away and\nwe're just gonna be in the system D world\n\n379\n00:19:32.370 --> 00:19:36.300\nso that's kind of the future\nthat is coming for us.\n\n380\n00:19:36.300 --> 00:19:39.695\n&gt;&gt; It is the future and\nolder versions we had run levels.\n\n381\n00:19:39.695 --> 00:19:40.230\n&gt;&gt; Yes.\n\n382\n00:19:40.230 --> 00:19:42.640\n&gt;&gt; So do we have run levels in system D?\n\n383\n00:19:42.640 --> 00:19:45.280\n&gt;&gt; You do, sort of [LAUGH] so\n\n384\n00:19:45.280 --> 00:19:50.230\nyou don't technically have the hard rigid\ndefined run levels Now you have targets.\n\n385\n00:19:50.230 --> 00:19:53.310\nAnd you can create as many targets as\nyou want, so in the run level days,\n\n386\n00:19:53.310 --> 00:19:56.190\nyou had seven run levels,\nreally just five that were usable, right,\n\n387\n00:19:56.190 --> 00:19:59.680\ncuz zero was your turned off and\nsix was your rebooting.\n\n388\n00:19:59.680 --> 00:20:01.080\nSo you had one through five.\n\n389\n00:20:01.080 --> 00:20:03.960\nWell, in system D, you use targets and\n\n390\n00:20:03.960 --> 00:20:07.040\nyou can create as many targets as you\nwant so you can go run level crazy.\n\n391\n00:20:07.040 --> 00:20:10.515\nCreate as many as you want,\nin fact if you look inside of\n\n392\n00:20:10.515 --> 00:20:15.850\n/user/lib/systemD/system and\nyou kinda look at all the stuff in there.\n\n393\n00:20:15.850 --> 00:20:19.070\nYou'll find where they've\ncreated fake run levels for us.\n\n394\n00:20:19.070 --> 00:20:19.880\nSomewhere in here.\n\n395\n00:20:19.880 --> 00:20:20.780\nRight here.\n\n396\n00:20:20.780 --> 00:20:27.561\nSo here's this run level zero.target, run\nlevel one.target, run level two.target,\n\n397\n00:20:27.561 --> 00:20:33.300\nthese are kind of placeholder targets\nthat mirror the old run levels, okay?\n\n398\n00:20:33.300 --> 00:20:35.450\nSo if you're just trying to recreate\nthat functionality that you had\n\n399\n00:20:35.450 --> 00:20:36.740\nin the previous run levels.\n\n400\n00:20:36.740 --> 00:20:37.900\nYou've got the alias' right there.\n\n401\n00:20:37.900 --> 00:20:39.670\nThey are just alias the links.\n\n402\n00:20:39.670 --> 00:20:43.010\nBecause run level one is single user mode.\n\n403\n00:20:43.010 --> 00:20:45.650\nAnd so\nwe've already got single user mode target.\n\n404\n00:20:45.650 --> 00:20:50.629\nThat's the rescue mode target inside of\nsystem D that we can run level three is\n\n405\n00:20:50.629 --> 00:20:55.540\nmulti user with no GUI, we've got\na multi user target already there.\n\n406\n00:20:55.540 --> 00:20:59.823\nAnd run level five is multi user with a\nGUI, we've already got a graphical.target\n\n407\n00:20:59.823 --> 00:21:03.450\nso these are just pointing to it,\nbut it gives us that compatibility.\n\n408\n00:21:03.450 --> 00:21:06.310\nSo we don't technically\nhave run levels anymore.\n\n409\n00:21:06.310 --> 00:21:08.380\nBut we have the same functionality.\n\n410\n00:21:08.380 --> 00:21:10.330\nAnd you can create as\nmany targets as you need,\n\n411\n00:21:10.330 --> 00:21:12.900\nto create as many run levels as you need,\nand you can call them.\n\n412\n00:21:12.900 --> 00:21:14.240\nWe interact with it different though.\n\n413\n00:21:14.240 --> 00:21:15.530\nWe don't use like you\n\n414\n00:21:16.700 --> 00:21:20.740\nused to have to have a /etc/init tab\nwhere you defined your default run level.\n\n415\n00:21:20.740 --> 00:21:24.320\nAnd then you used the init command\nto change run levels on the fly.\n\n416\n00:21:24.320 --> 00:21:26.150\nWe don't have either of\nthose anymore right?\n\n417\n00:21:26.150 --> 00:21:30.180\nSo now the default run level is whatever\n\n418\n00:21:30.180 --> 00:21:35.210\ndefault.target is symlinked to, right?\n\n419\n00:21:35.210 --> 00:21:38.900\nSo if I do an ls -la and\n\n420\n00:21:38.900 --> 00:21:43.970\nI look at default.target, see how\nit's symlinked to graphical.target?\n\n421\n00:21:43.970 --> 00:21:46.690\nSo when I power this computer on, it's\ngonna load the graphical user interface,\n\n422\n00:21:46.690 --> 00:21:48.230\nwhat used to be runlevel five.\n\n423\n00:21:48.230 --> 00:21:50.070\nBut if I change that SIM link.\n\n424\n00:21:50.070 --> 00:21:54.705\nAnd I point it to multi-user.target\nnow it'll boot to the command line.\n\n425\n00:21:54.705 --> 00:21:56.540\nMulti-user mode but just the command line.\n\n426\n00:21:56.540 --> 00:21:58.110\nRight that's the old run level three.\n\n427\n00:21:58.110 --> 00:22:02.560\nRight and I can change the SIM link\nmyself, but normally I use SystemCTL.\n\n428\n00:22:02.560 --> 00:22:05.250\nRemember SystemCTL is very, very powerful.\n\n429\n00:22:05.250 --> 00:22:11.400\nSo I can change run levels with it and\nI can say, SystemCTL get -default.\n\n430\n00:22:11.400 --> 00:22:13.970\nAnd it'll tell me my default is multiuser,\nright?\n\n431\n00:22:13.970 --> 00:22:15.960\nThat's my default right now, all right.\n\n432\n00:22:15.960 --> 00:22:18.830\nAnd I can change that cause I'm\non a server with no GUI, right?\n\n433\n00:22:18.830 --> 00:22:22.750\nSo the GUI in the background is my laptop,\nnot the server I'm remoted into.\n\n434\n00:22:22.750 --> 00:22:24.810\nSo the default here is multi user.\n\n435\n00:22:24.810 --> 00:22:26.650\nIf I wanted to go graphical,\nI could change that.\n\n436\n00:22:26.650 --> 00:22:31.168\nI could say system CTL,\nwhoops, which I can't spell.\n\n437\n00:22:31.168 --> 00:22:34.720\nSystems CTL, set-default.\n\n438\n00:22:34.720 --> 00:22:37.871\nAnd then I can tell it\ngraphical.target and\n\n439\n00:22:37.871 --> 00:22:40.540\nthat's gonna change it to\nuse the graphical target.\n\n440\n00:22:40.540 --> 00:22:42.250\nAnd see how it say created simlink?\n\n441\n00:22:42.250 --> 00:22:43.710\nIt made the simile for\n\n442\n00:22:43.710 --> 00:22:46.185\nme and that's good because I can never\nremember the syntax of that line command.\n\n443\n00:22:46.185 --> 00:22:47.350\n&gt;&gt; [LAUGH]\n&gt;&gt; So here and\n\n444\n00:22:47.350 --> 00:22:49.280\nI have system CTL do it for me.\n\n445\n00:22:49.280 --> 00:22:50.200\nI always screw it up.\n\n446\n00:22:50.200 --> 00:22:52.770\nI get it is the target first or\nis the source first.\n\n447\n00:22:52.770 --> 00:22:54.060\nAnd here you don't have to worry about it.\n\n448\n00:22:54.060 --> 00:22:57.680\nSystem CTL set-default and it does it.\n\n449\n00:22:57.680 --> 00:22:59.760\nAnd if I get the default I can\nsee now I'm tied to graphical.\n\n450\n00:22:59.760 --> 00:23:01.340\nNow I do have a little problem.\n\n451\n00:23:01.340 --> 00:23:03.350\nIn that I don't have a GUI\ninstalled in that server.\n\n452\n00:23:03.350 --> 00:23:04.830\nSo it's really not gonna\nmake any difference.\n\n453\n00:23:04.830 --> 00:23:07.250\nSo I'm gonna put it back to\nmulti user before I forget.\n\n454\n00:23:07.250 --> 00:23:08.950\nAnd so\nI can just come right back in here and\n\n455\n00:23:08.950 --> 00:23:14.150\nsay, mutli-user.target and\nthat'll put that back.\n\n456\n00:23:14.150 --> 00:23:16.640\nNow, if I just wanna go temporary,\n\n457\n00:23:16.640 --> 00:23:21.530\nlike I just temporarily wanna switch to\none of these other modes, you can do that.\n\n458\n00:23:21.530 --> 00:23:26.120\nThe way you do it is a little bit weird,\nyou say system CTL\n\n459\n00:23:26.120 --> 00:23:29.690\nisolate and then the name of\nthe target that I wanna load.\n\n460\n00:23:29.690 --> 00:23:35.278\nSo if I just wanna temporarily go command\nline, I could come in and I could say,\n\n461\n00:23:35.278 --> 00:23:40.890\nsystemctl isolate multi-user.target and\nnow it'll switch over.\n\n462\n00:23:40.890 --> 00:23:43.784\nThis is the equivalent\nof the old init command.\n\n463\n00:23:43.784 --> 00:23:46.870\nThe reality is most people\nnever changed init on the fly.\n\n464\n00:23:46.870 --> 00:23:48.651\nIt really just wasn't\nall that commonly used.\n\n465\n00:23:48.651 --> 00:23:52.687\nSome of you might have had edge case\nscenarios or whatever, but for most of us,\n\n466\n00:23:52.687 --> 00:23:54.165\nwe never changed on the fly.\n\n467\n00:23:54.165 --> 00:23:55.292\nSo this is the equivalent [INAUDIBLE].\n\n468\n00:23:55.292 --> 00:23:56.873\nSo you still can do it.\n\n469\n00:23:56.873 --> 00:23:59.131\nThe main time when people would do it,\n\n470\n00:23:59.131 --> 00:24:03.720\nwhen they would really change on the fly\nwas usually when they wanted to drop to\n\n471\n00:24:03.720 --> 00:24:07.130\nsingle user mode to protect\nthe system somehow, right?\n\n472\n00:24:07.130 --> 00:24:09.308\nOr to stop a problem,\nso it was an emergency.\n\n473\n00:24:09.308 --> 00:24:13.390\nAnd in systemd, we have a rescue\nmode that's the equivalent of that.\n\n474\n00:24:13.390 --> 00:24:18.530\nAnd so what you would do is you\nwould say systemctl rescue, right?\n\n475\n00:24:18.530 --> 00:24:24.500\nThat would be the equivalent of saying\ninit 1 and dropping down to single user\n\n476\n00:24:24.500 --> 00:24:28.765\nmode and getting into that mode where you\nhad access to the system and that was it.\n\n477\n00:24:28.765 --> 00:24:31.714\nIf I say systemctl rescue,\nit'll do the same thing, okay?\n\n478\n00:24:31.714 --> 00:24:35.144\nNow I'm not gonna run that,\nbecause I'm remoted into the system, so\n\n479\n00:24:35.144 --> 00:24:38.065\nit'll kick me out,\n[LAUGH] I'll lose access to the system.\n\n480\n00:24:38.065 --> 00:24:42.442\nSo not something I want to do, but that's\nwhat it would be, a systemctl rescue, and\n\n481\n00:24:42.442 --> 00:24:43.935\nthat'll move you that way.\n\n482\n00:24:43.935 --> 00:24:48.035\nOther things systemctl can do,\nit can really get pretty crazy.\n\n483\n00:24:48.035 --> 00:24:51.160\nYou can do systemctl reboot, right?\n\n484\n00:24:51.160 --> 00:24:54.380\nNow I have the reboot command\nthat I could just call, but here,\n\n485\n00:24:54.380 --> 00:24:56.230\nI'm telling systemctl to do it.\n\n486\n00:24:56.230 --> 00:24:59.760\nAnd that's good, because it'll make sure\nthat all the services get gracefully shut\n\n487\n00:24:59.760 --> 00:25:03.640\ndown, and all the processes get closed\noff, and those sockets get closed.\n\n488\n00:25:03.640 --> 00:25:06.890\nIt makes sure that things are done\nright by rebooting through systemctl\n\n489\n00:25:06.890 --> 00:25:10.300\nas opposed to rebooting through\nthe regular reboot command.\n\n490\n00:25:10.300 --> 00:25:13.388\nAnd you can even do systemctl poweroff,\nand\n\n491\n00:25:13.388 --> 00:25:16.340\nthat'll turn the system off and\ncut it out, right?\n\n492\n00:25:16.340 --> 00:25:19.983\nSo these are all different things,\nsystemctl, if you ever get bored,\n\n493\n00:25:19.983 --> 00:25:23.945\nyou have a ton of time on your hands,\ntake a look at the man file for systemctl.\n\n494\n00:25:23.945 --> 00:25:27.320\nAnd you'll be surprised at all\nthe different things that it can do.\n\n495\n00:25:27.320 --> 00:25:31.740\nAnd this is part of the reason why you\nhear people say they hate systemd,\n\n496\n00:25:31.740 --> 00:25:33.334\nthey feel like it just does too much,\nright?\n\n497\n00:25:33.334 --> 00:25:35.880\n&gt;&gt; [LAUGH]\n&gt;&gt; That the old init system\n\n498\n00:25:35.880 --> 00:25:39.372\njust ran a series of scripts,\nand you controlled those scripts.\n\n499\n00:25:39.372 --> 00:25:43.563\nBut systemd does a lot more,\nand you don't control it.\n\n500\n00:25:43.563 --> 00:25:45.403\nI mean, you could,\nyou could go get the source code and\n\n501\n00:25:45.403 --> 00:25:48.170\nmodify it and compile it yourself,\nbut most people won't do that.\n\n502\n00:25:48.170 --> 00:25:49.920\nAnd so\nwe're losing a little bit of control.\n\n503\n00:25:49.920 --> 00:25:51.235\nBut in exchange,\nyou're getting lot of power.\n\n504\n00:25:51.235 --> 00:25:54.787\nYour system boots faster,\nsystemd is a little more efficient,\n\n505\n00:25:54.787 --> 00:25:57.540\nespecially on memory consumption.\n\n506\n00:25:57.540 --> 00:26:01.480\nSo it's a trade off, and so far,\n\n507\n00:26:01.480 --> 00:26:04.420\nall the major distros have agreed,\nit's the way to go.\n\n508\n00:26:04.420 --> 00:26:08.850\nSo very powerful software,\nit is the heart and soul of your system,\n\n509\n00:26:08.850 --> 00:26:09.772\nafter the Linux kernel, right?\n\n510\n00:26:09.772 --> 00:26:11.921\nThe Linux kernel,\nthat's the most important part, but\n\n511\n00:26:11.921 --> 00:26:13.710\nthen what does Linux kernel do?\n\n512\n00:26:13.710 --> 00:26:16.750\nIt fires up systemd, and\nthen systemd does the rest of the work.\n\n513\n00:26:16.750 --> 00:26:20.043\nSo it is really the workhorse that's\nkeeping your system running and\n\n514\n00:26:20.043 --> 00:26:22.720\ndoing its job after the kernel\nhas turned over control.\n\n515\n00:26:22.720 --> 00:26:23.888\nSo really powerful stuff,\n\n516\n00:26:23.888 --> 00:26:27.048\ndefinitely something you want to be\ncomfortable with and familiar with.\n\n517\n00:26:27.048 --> 00:26:31.074\nAnd fortunately, it's not so\nhard using systemctl.\n\n518\n00:26:31.074 --> 00:26:33.930\n&gt;&gt; And it sounds like systemd\ncan make our lives a lot easier.\n\n519\n00:26:33.930 --> 00:26:36.290\nSo thanks a lot, Don, great information.\n\n520\n00:26:36.290 --> 00:26:38.140\nAnything else you'd like to add?\n\n521\n00:26:38.140 --> 00:26:41.190\n&gt;&gt; The only thing I\ndidn't mention is systemd\n\n522\n00:26:41.190 --> 00:26:43.615\nactually has some neat troubleshooting\ntools that are a part of it.\n\n523\n00:26:43.615 --> 00:26:48.205\nSo if something ever goes wrong with the\nolder style like init, you have to go and\n\n524\n00:26:48.205 --> 00:26:50.355\ndig through scripts and try and\nfind where the error is.\n\n525\n00:26:50.355 --> 00:26:52.445\nWith systemd, you can actually\ndo some fun stuff with it.\n\n526\n00:26:52.445 --> 00:26:58.445\nSo there's a command, let me show you\nguys real quick, systemd -analyze.\n\n527\n00:26:58.445 --> 00:27:01.215\nIf you run that, it'll actually\ntake a look at your boot time, and\n\n528\n00:27:01.215 --> 00:27:03.346\nit'll say how long did it\ntake your system to boot.\n\n529\n00:27:03.346 --> 00:27:06.215\nAnd it'll show you that, because\nsystemd was the first thing to run, so\n\n530\n00:27:06.215 --> 00:27:08.220\nit knows how long everything took to boot.\n\n531\n00:27:08.220 --> 00:27:11.867\nIt's showing how long the kernel took to\ndo its job, user space, and init, and\n\n532\n00:27:11.867 --> 00:27:13.680\nit gives you all that laid out.\n\n533\n00:27:13.680 --> 00:27:18.263\nAnd my favorite command is\nsystemd -analyze blame [LAUGH].\n\n534\n00:27:18.263 --> 00:27:22.680\nAnd that's saying if your\nboot took a long time, why?\n\n535\n00:27:22.680 --> 00:27:24.035\nWho was it that took the longest time?\n\n536\n00:27:24.035 --> 00:27:31.090\nAnd it'll look, and it'll show you each\nunit ordered by how long they took.\n\n537\n00:27:31.090 --> 00:27:34.780\nAnd so I can see the network\nmanager was my biggest bottleneck.\n\n538\n00:27:34.780 --> 00:27:36.850\nIt added five and\nhalf seconds to my boot time.\n\n539\n00:27:36.850 --> 00:27:38.070\n&gt;&gt; Five seconds.\n\n540\n00:27:38.070 --> 00:27:41.020\n&gt;&gt; And so if that's a problem,\nI might not wanna use the network manager.\n\n541\n00:27:41.020 --> 00:27:44.390\nI don't need it, I could use scripts\nto control my network interfaces, so\n\n542\n00:27:44.390 --> 00:27:45.240\nI could get rid of it.\n\n543\n00:27:45.240 --> 00:27:47.900\nNow I just shaved five and\na half seconds off my boot time, right?\n\n544\n00:27:47.900 --> 00:27:51.957\nOr, I'm probably okay with that,\ncuz it's five seconds, whatever, right?\n\n545\n00:27:51.957 --> 00:27:54.314\n&gt;&gt; [LAUGH]\n&gt;&gt; So there's tools like that,\n\n546\n00:27:54.314 --> 00:27:58.080\nit can actually scan your config files\nto look for errors and stuff in there.\n\n547\n00:27:58.080 --> 00:27:59.970\nIt can do a lot of really neat things.\n\n548\n00:27:59.970 --> 00:28:01.610\nTake some time, dive into the technology,\n\n549\n00:28:01.610 --> 00:28:03.530\nyou'll find that systemd's\npretty rewarding.\n\n550\n00:28:03.530 --> 00:28:07.700\n&gt;&gt; Great information on systemd,\nbecoming a Linux server administrator.\n\n551\n00:28:07.700 --> 00:28:10.460\nThere's a lot of videos in this series.\n\n552\n00:28:10.460 --> 00:28:14.170\nYou wanna make sure you watch every single\none of them, you'll be very glad you did.\n\n553\n00:28:14.170 --> 00:28:17.440\nGreat job Don, and\nthank you for watching ITProTV.\n\n554\n00:28:17.440 --> 00:28:19.579\nRemember, a good IT pro\nis always learning.\n\n555\n00:28:19.579 --> 00:28:20.850\nI'm Zach Memos.\n\n556\n00:28:20.850 --> 00:28:21.700\n&gt;&gt; And I'm Don Pezet.\n\n557\n00:28:21.700 --> 00:28:23.968\n&gt;&gt; And we will see you soon.\n\n558\n00:28:23.968 --> 00:28:29.861\n[MUSIC]\n\n559\n00:28:29.861 --> 00:28:33.508\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "226447781"
        }
      ],
      "title": "Starting and Stopping Services"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach discuss what BIND is, why we would choose BIND over other DNS servers, installing the BIND packages, editing the configuration file, define the listen ports, restrict recursive lookups, verify Configuration files, cleanup permissions, named.servce, and allowing BIND through firewalld.",
          "length": "1443",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-1-installing_bind-072117-PGM.00_23_47_01.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-1-installing_bind-072117-PGM.00_23_47_01.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-1-installing_bind-072117-PGM.00_23_47_01.Still001-sm.jpg",
          "title": "Installing BIND",
          "transcript": "WEBVTT\n\n1\n00:00:00.002 --> 00:00:01.293\nWelcome to ITPRO.TV.\n\n2\n00:00:01.293 --> 00:00:08.148\nI'm your host\n&gt;&gt; [CROSSTALK]\n\n3\n00:00:08.148 --> 00:00:12.036\n&gt;&gt; You're watching ITPRO.TV.\n\n4\n00:00:12.036 --> 00:00:14.607\n&gt;&gt; Hello and thank you for\nchoosing ITPRO.TV.\n\n5\n00:00:14.607 --> 00:00:16.760\nHelping you learn wherever you go.\n\n6\n00:00:16.760 --> 00:00:18.060\nI'm your host Zach Memos.\n\n7\n00:00:18.060 --> 00:00:21.872\nAs we continue on with becoming\na Linux server administrator, and\n\n8\n00:00:21.872 --> 00:00:24.740\nin this episode we're\ngonna be installing BIND.\n\n9\n00:00:24.740 --> 00:00:28.487\nNow, the person bringing us all\nthe information we need is our ITPro and\n\n10\n00:00:28.487 --> 00:00:31.122\nresident nice guy,\nDon Pezet, right over here.\n\n11\n00:00:31.122 --> 00:00:32.590\n[LAUGH] Good morning Don.\n\n12\n00:00:32.590 --> 00:00:33.465\n&gt;&gt; Good morning Zack, and\n\n13\n00:00:33.465 --> 00:00:36.241\nyep, we are continuing our adventure\nthrough being a Linux server admin.\n\n14\n00:00:36.241 --> 00:00:39.234\nAnd we're gonna be kicking off here\nwith a really important service, and\n\n15\n00:00:39.234 --> 00:00:40.156\nthat's DNS, right?\n\n16\n00:00:40.156 --> 00:00:42.250\nDNS, the Domain Naming System.\n\n17\n00:00:42.250 --> 00:00:46.650\nIt's what we use to resolve names to\nIPs and IPs to names, pretty critical.\n\n18\n00:00:46.650 --> 00:00:48.630\nAnd so when you're standing up\nservers in your environment,\n\n19\n00:00:48.630 --> 00:00:50.690\nthe odds are you've got\na DNS server somewhere.\n\n20\n00:00:50.690 --> 00:00:54.700\nSo in this episode, we're gonna\nsee how to do that by using BIND\n\n21\n00:00:54.700 --> 00:00:58.010\nrunning on top of a Linux distro,\nwhich is a really common scenario.\n\n22\n00:00:58.010 --> 00:00:59.851\nAnd definitely one that you'll\nencounter out in the real world.\n\n23\n00:00:59.851 --> 00:01:02.320\nSo that's what we're gonna see\nright here in this episode.\n\n24\n00:01:02.320 --> 00:01:06.340\n&gt;&gt; Now, Don why are we picking\nBIND over other DNS servers?\n\n25\n00:01:06.340 --> 00:01:07.246\n&gt;&gt; All right, a good question, right?\n\n26\n00:01:07.246 --> 00:01:09.520\nCuz there are several other DNS\nservers that are out there.\n\n27\n00:01:09.520 --> 00:01:11.070\nBIND just happens to be one of them.\n\n28\n00:01:11.070 --> 00:01:12.680\nWell, I shouldn't say\njust happens to be one.\n\n29\n00:01:12.680 --> 00:01:15.058\nIt happens to be the original, right?\n\n30\n00:01:15.058 --> 00:01:16.400\n&gt;&gt; Bum bum bum.\n&gt;&gt; So, BIND stands for\n\n31\n00:01:16.400 --> 00:01:18.970\nthe Berkeley Internet Naming Domain.\n\n32\n00:01:18.970 --> 00:01:22.850\nAnd it was developed at the University of\nCalifornia at Berkeley as part of BSD way,\n\n33\n00:01:22.850 --> 00:01:24.340\nway back in the day.\n\n34\n00:01:24.340 --> 00:01:27.590\nAnd it's been used for\nname resolution for a long, long time.\n\n35\n00:01:27.590 --> 00:01:30.760\nIn fact,\nall the other DNS servers out there\n\n36\n00:01:30.760 --> 00:01:33.410\nwork to maintain capability with BIND.\n\n37\n00:01:33.410 --> 00:01:35.328\nSo if you learn Bind and\nknow how it works, and\n\n38\n00:01:35.328 --> 00:01:36.753\nunderstand all the ins and outs.\n\n39\n00:01:36.753 --> 00:01:39.517\nThen you actually know how to do this\nstuff with the other DNS servers that\n\n40\n00:01:39.517 --> 00:01:40.255\nare out there too.\n\n41\n00:01:40.255 --> 00:01:42.420\nYou're really just swapping out\nbinaries for the most part.\n\n42\n00:01:42.420 --> 00:01:44.280\nSo you can definitely look at others, and\n\n43\n00:01:44.280 --> 00:01:47.260\nwe've actually got a whole series\nhere on ITPro.TV just on DNS servers.\n\n44\n00:01:47.260 --> 00:01:48.800\nYou're welcome to go and check it out.\n\n45\n00:01:48.800 --> 00:01:51.660\nBut as far as this one,\nI wanted to stick with the most common.\n\n46\n00:01:51.660 --> 00:01:54.360\nAnd the most common DNS server is BIND.\n\n47\n00:01:54.360 --> 00:01:58.040\nAnd you'll find that it's really easy for\nus to get it installed, get it configured.\n\n48\n00:01:58.040 --> 00:02:00.160\nAnd have a DNS server up and\nrunning before we know it.\n\n49\n00:02:00.160 --> 00:02:01.570\n&gt;&gt; So, it makes sense then.\n\n50\n00:02:01.570 --> 00:02:02.894\nHow do we get it installed?\n\n51\n00:02:02.894 --> 00:02:04.390\nI wanna see this.\n\n52\n00:02:04.390 --> 00:02:08.560\n&gt;&gt; All right, well, on a lot of distros\nyou'll find where it's already installed.\n\n53\n00:02:08.560 --> 00:02:11.100\nYou don't even have to install it,\nit's already there for you.\n\n54\n00:02:11.100 --> 00:02:15.653\nBut on some it isn't, so let's act on\nthe assumption that it's not installed.\n\n55\n00:02:15.653 --> 00:02:18.088\nAnd you might ask yourself,\nif I'm not doing a DNS server,\n\n56\n00:02:18.088 --> 00:02:19.960\nwhy would BIND already be installed?\n\n57\n00:02:19.960 --> 00:02:22.427\nSome distros actually use it for\nan internal name lookups as well, so\n\n58\n00:02:22.427 --> 00:02:23.499\nthat's why it might have it.\n\n59\n00:02:23.499 --> 00:02:25.496\nBut on ours, who knows, right?\n\n60\n00:02:25.496 --> 00:02:28.849\nSo I'm on a Red Hat Enterprise Linux\n7.3 machine.\n\n61\n00:02:28.849 --> 00:02:33.177\nAnd so I'm gonna take this server and\nI'm gonna install BIND, right?\n\n62\n00:02:33.177 --> 00:02:37.625\nSo, one thing that I've done is I'm\nlogged in as my user account, D.Pezet.\n\n63\n00:02:37.625 --> 00:02:40.173\nBut I'm gonna do a lot of stuff\nthat you need to be root for,\n\n64\n00:02:40.173 --> 00:02:41.798\nthat you need elevated privileges.\n\n65\n00:02:41.798 --> 00:02:45.908\nSo I'm gonna do a sudo-s, just to switch\nto a root shell while I work on this.\n\n66\n00:02:45.908 --> 00:02:49.003\nIf you don't do that you'll just have\nto sudo every command that we run in\n\n67\n00:02:49.003 --> 00:02:49.679\nthis episode.\n\n68\n00:02:49.679 --> 00:02:50.640\n&gt;&gt; And that can be tiring.\n\n69\n00:02:50.640 --> 00:02:51.600\n&gt;&gt; So yeah, it gets old.\n\n70\n00:02:51.600 --> 00:02:55.260\nSo, I'm gonna come in here and\njust do a quick yum install.\n\n71\n00:02:55.260 --> 00:02:59.190\nIf I was on Debian or\nUbuntu I'd be saying, apt-install.\n\n72\n00:02:59.190 --> 00:03:02.143\nIf I was on Fedora I would\nbe doing dnf-install, right.\n\n73\n00:03:02.143 --> 00:03:03.424\nSo subtle difference there.\n\n74\n00:03:03.424 --> 00:03:05.620\nBut I'm gonna do yum install BIND.\n\n75\n00:03:05.620 --> 00:03:08.310\nAnd technically that's all I need.\n\n76\n00:03:08.310 --> 00:03:11.110\nIf I install that,\nthat´s gonna install the BIND DNS server.\n\n77\n00:03:11.110 --> 00:03:17.050\nBut it´s a good idea to add one extra\nlittle package here called bind utils.\n\n78\n00:03:17.050 --> 00:03:18.460\nTechnically I don´t need this.\n\n79\n00:03:18.460 --> 00:03:21.340\nIt´s a collection of command line\nutilities that help me to work with bind.\n\n80\n00:03:21.340 --> 00:03:24.270\nI could already have\nthose on my work station.\n\n81\n00:03:24.270 --> 00:03:25.610\nSo I don`t need to have\nthem on the server,\n\n82\n00:03:25.610 --> 00:03:27.180\nI just need them on a work station.\n\n83\n00:03:27.180 --> 00:03:29.450\nBut here I´m going to install\nthem both on the same machine.\n\n84\n00:03:29.450 --> 00:03:30.430\nIt doesn't hurt.\n\n85\n00:03:30.430 --> 00:03:33.050\nSome people don't like to increase their\nsecurity footprint, so they wanna keep\n\n86\n00:03:33.050 --> 00:03:36.650\nthe tools off the server, you can\ncertainly do that when you install both.\n\n87\n00:03:36.650 --> 00:03:39.510\nAll right, and then install should\nhappen pretty quick and I might find,\n\n88\n00:03:39.510 --> 00:03:42.130\nI actually don't know here, but I might\nfind that they're already installed.\n\n89\n00:03:42.130 --> 00:03:45.260\nAnd in my case, actually they are, so it's\ngonna go ahead and get those installed.\n\n90\n00:03:45.260 --> 00:03:46.160\nAnd get them put in place.\n\n91\n00:03:46.160 --> 00:03:48.170\nNow bind is not very big.\n\n92\n00:03:48.170 --> 00:03:50.510\nYou'll see 7.3 megabytes on the disk.\n\n93\n00:03:50.510 --> 00:03:51.490\nIt's very small.\n\n94\n00:03:51.490 --> 00:03:52.980\nBecause this was written a long time ago.\n\n95\n00:03:52.980 --> 00:03:57.020\nIt's very simple at what it does,\nbut it's very powerful.\n\n96\n00:03:57.020 --> 00:04:00.610\nAnd it is really one of the most\ncommon DNS servers now in the world.\n\n97\n00:04:01.890 --> 00:04:06.939\nOnce that command runs,\nit's installed and that was easy, right?\n\n98\n00:04:06.939 --> 00:04:09.110\n&gt;&gt; [LAUGH] That wasn't very easy,\nmy goodness.\n\n99\n00:04:09.110 --> 00:04:11.100\n&gt;&gt; But it's technically\nnot doing anything, right?\n\n100\n00:04:11.100 --> 00:04:13.860\nSo there's some basic configuration that\nwe need to do to get in there to tweak\n\n101\n00:04:13.860 --> 00:04:15.980\nthings and\njust kind of make it ready to work.\n\n102\n00:04:15.980 --> 00:04:19.280\nNow, I'm not gonna start BIND just yet.\n\n103\n00:04:19.280 --> 00:04:22.010\nUsually when we install a service\nlike this we immediately follow it up\n\n104\n00:04:22.010 --> 00:04:25.270\nwith a system CTL start, whatever, right?\n\n105\n00:04:25.270 --> 00:04:27.050\nBut in this case I'm gonna hold off for\njust a moment.\n\n106\n00:04:27.050 --> 00:04:30.100\nCuz there's some basic configuration\nthat we need to work on, right?\n\n107\n00:04:30.100 --> 00:04:34.280\nBinds primary configuration\nis stored in the ETC folder.\n\n108\n00:04:34.280 --> 00:04:36.990\nAnd if I'm going into /etc and\npoke around in here.\n\n109\n00:04:36.990 --> 00:04:40.640\nIt's a little bit hard to find because\nyou might jump in here looking to Bs and\n\n110\n00:04:40.640 --> 00:04:42.030\nlooking for BIND.\n\n111\n00:04:42.030 --> 00:04:43.070\nIt's not there.\n\n112\n00:04:43.070 --> 00:04:43.960\nWell, let me go look for DNS,\n\n113\n00:04:43.960 --> 00:04:47.500\nlet me jump over to the Ds and\nit's not there either, right?\n\n114\n00:04:47.500 --> 00:04:49.210\nSo where the heck is this thing?\n\n115\n00:04:49.210 --> 00:04:53.630\nWell, it's actually called\nthe naming daemon or named.\n\n116\n00:04:53.630 --> 00:04:58.130\nSo if you look in the n's which\nare around here, here we go.\n\n117\n00:04:58.130 --> 00:05:00.430\nWe've got named.conf.\n\n118\n00:05:00.430 --> 00:05:02.150\nThat's the one that I'm looking for.\n\n119\n00:05:02.150 --> 00:05:05.240\nThat's the primary configuration file for\nBIND.\n\n120\n00:05:05.240 --> 00:05:08.600\nSo when I want to work with it,\nI need to edit /etc/named.conf.\n\n121\n00:05:08.600 --> 00:05:13.430\nAnd that's one of those things\nthat you just have to memorize.\n\n122\n00:05:13.430 --> 00:05:15.670\nThe service itself is\nactually called named,\n\n123\n00:05:15.670 --> 00:05:17.990\nso named.conf is what I'm going for.\n\n124\n00:05:19.060 --> 00:05:22.460\nAnd in that file you're\ngonna see a lot of stuff.\n\n125\n00:05:22.460 --> 00:05:25.020\nThis file is packed full of\nconfiguration information.\n\n126\n00:05:25.020 --> 00:05:29.580\nBut what I want to focus on,\nhere is right at the very beginning.\n\n127\n00:05:29.580 --> 00:05:33.400\nYou've got this Options, and\nthen a listen on port, okay?\n\n128\n00:05:33.400 --> 00:05:36.110\nSee how it says listen on port 53?\n\n129\n00:05:36.110 --> 00:05:40.170\nWell, DNS uses UDP and\nTPC port 53 by default, right?\n\n130\n00:05:40.170 --> 00:05:41.460\nSo it's listening on port 53.\n\n131\n00:05:41.460 --> 00:05:44.260\nYou don't normally want to change that,\nbut\n\n132\n00:05:44.260 --> 00:05:48.300\nthis IP address is what I wanna change.\n\n133\n00:05:48.300 --> 00:05:50.060\nThe IP address is 127.0.0.1 So\n\n134\n00:05:50.060 --> 00:05:55.440\nby default this bind server is only\nlistening on the loop back interface.\n\n135\n00:05:55.440 --> 00:05:58.360\nSo that means on the server\nI can run lookups again so\n\n136\n00:05:58.360 --> 00:05:59.800\nit can get results, right.\n\n137\n00:05:59.800 --> 00:06:03.070\nBut if I was on a client connecting\nover the network it wouldn't work.\n\n138\n00:06:03.070 --> 00:06:06.100\nSo I need to change this address,\nI need to change it\n\n139\n00:06:06.100 --> 00:06:10.810\nto match the address of my server,\nthe address that I wanna be listening on.\n\n140\n00:06:10.810 --> 00:06:13.570\nAnd usually you wanna keep\nthe loop back in there so\n\n141\n00:06:13.570 --> 00:06:15.600\nthat you can do look ups\nfrom the server itself.\n\n142\n00:06:15.600 --> 00:06:19.860\nAnd you wanna add any\nextra IPs afterwards.\n\n143\n00:06:19.860 --> 00:06:24.890\nSo I'm gonna leave 127.0.0.1; and then\nafter that I'm gonna add 172.16.0.100,\n\n144\n00:06:24.890 --> 00:06:27.890\nthat's the IP address of this server.\n\n145\n00:06:27.890 --> 00:06:32.200\nif I had more than one network\ninterface I could just continue add.\n\n146\n00:06:32.200 --> 00:06:34.810\nDo another semicolon,\nadd the next address and so on.\n\n147\n00:06:34.810 --> 00:06:38.110\nYou're adding the IP address\nthat's attached to the interface.\n\n148\n00:06:38.110 --> 00:06:41.400\nSo now BIND is listening on the loopback\n\n149\n00:06:41.400 --> 00:06:44.030\nas well as listening on\nmy network interface.\n\n150\n00:06:44.030 --> 00:06:47.180\nAnd now the clients on my network will\nbe able to reach out to this server and\n\n151\n00:06:47.180 --> 00:06:48.500\nask it and say.\n\n152\n00:06:48.500 --> 00:06:53.100\nHey I have this name can you tell me the\nIP and my server will figure it out and\n\n153\n00:06:53.100 --> 00:06:54.220\ngive them an answer.\n\n154\n00:06:54.220 --> 00:06:56.060\nSo that's a key thing to get configured.\n\n155\n00:06:56.060 --> 00:06:57.710\nAnd a lot of people skip that step.\n\n156\n00:06:57.710 --> 00:06:59.170\nAnd then can't figure out\nwhy BIND doesn't work.\n\n157\n00:06:59.170 --> 00:07:01.060\nIt works fine from the server,\nit's not working for\n\n158\n00:07:01.060 --> 00:07:02.910\nmy client, must be a firewall issue.\n\n159\n00:07:02.910 --> 00:07:05.680\nAnd it's not a firewall issue,\nit's just DNS or\n\n160\n00:07:05.680 --> 00:07:08.610\nbind doesn't know to listen on that\ninterface until we plug this in.\n\n161\n00:07:08.610 --> 00:07:11.850\nSo, that's one of the most important\nthings that we need to configure in here.\n\n162\n00:07:11.850 --> 00:07:16.050\nWe get that set, and\nnow we're in pretty good shape.\n\n163\n00:07:16.050 --> 00:07:18.610\nThere is another entry here for\nIPv6 if you're using that.\n\n164\n00:07:18.610 --> 00:07:22.200\nSo we're got listen on v6 And\nit's doing the loop back also.\n\n165\n00:07:22.200 --> 00:07:24.420\nAnd I think we said colon\ncolon one is your loop back.\n\n166\n00:07:24.420 --> 00:07:27.820\nSo I need to add any other IPV\nsix addresses I was using.\n\n167\n00:07:27.820 --> 00:07:31.110\nI don't have that configured on my system,\nso I'm gonna leave that be, but\n\n168\n00:07:31.110 --> 00:07:32.310\nI would set that right there.\n\n169\n00:07:32.310 --> 00:07:35.970\nAnd once that's done, now we've got\nthe basic configuration on there that Vine\n\n170\n00:07:35.970 --> 00:07:37.430\nneeds to get up and running.\n\n171\n00:07:37.430 --> 00:07:40.660\n&gt;&gt; Now is that where we stop, or\nis there more that we could configure?\n\n172\n00:07:40.660 --> 00:07:42.640\n&gt;&gt; There's a lot more we can configure,\nfor\n\n173\n00:07:42.640 --> 00:07:44.620\nsome people that is where they would stop.\n\n174\n00:07:44.620 --> 00:07:45.310\nRight.\n\n175\n00:07:45.310 --> 00:07:48.530\nTechnically if we stop right here,\nwe've created a DS server.\n\n176\n00:07:48.530 --> 00:07:52.632\nRight, we've done the work, this could\nbe the shortest episode ever, right.\n\n177\n00:07:52.632 --> 00:07:53.997\n&gt;&gt; [LAUGH]\n&gt;&gt; But, there's a few problems\n\n178\n00:07:53.997 --> 00:07:54.684\nhere, right.\n\n179\n00:07:54.684 --> 00:07:56.560\nSo, problem number one,\nit's not very secure, so\n\n180\n00:07:56.560 --> 00:07:58.878\nthere's some things we will need\nto tweak on the security side.\n\n181\n00:07:58.878 --> 00:08:00.333\nAnd problem number two,\n\n182\n00:08:00.333 --> 00:08:04.010\nit doesn't actually have any\nnamed IP mappings in it, right?\n\n183\n00:08:04.010 --> 00:08:05.961\nSo it is missing those zone entries.\n\n184\n00:08:05.961 --> 00:08:08.000\nWell, that's okay.\n\n185\n00:08:08.000 --> 00:08:10.050\nA DNS server doesn't have to have those.\n\n186\n00:08:10.050 --> 00:08:12.430\nIf I ask this DNS server a question and\n\n187\n00:08:12.430 --> 00:08:15.350\nit doesn't know the answer,\nit'll use the root hint servers.\n\n188\n00:08:15.350 --> 00:08:17.960\nIt'll reach out to the Internet\nto find those answers.\n\n189\n00:08:17.960 --> 00:08:20.350\nAnd then it will cache\nthe results right here.\n\n190\n00:08:20.350 --> 00:08:24.237\nWhat we've created so\nfar is a caching DNS server.\n\n191\n00:08:24.237 --> 00:08:26.945\nSo that's good if maybe I'm an ISP, and\n\n192\n00:08:26.945 --> 00:08:30.541\nI'm just trying to speed\nup my customer's lookups.\n\n193\n00:08:30.541 --> 00:08:33.655\nI could have a caching DNS server\nconfigured just like this, and\n\n194\n00:08:33.655 --> 00:08:35.290\nit would work fine, okay.\n\n195\n00:08:35.290 --> 00:08:36.018\nBut most of us don't want that.\n\n196\n00:08:36.018 --> 00:08:39.040\nMost of us are setting up a DNS\nserver because we have zones.\n\n197\n00:08:39.040 --> 00:08:41.770\nBut I'm gonna hold off on the zones,\ncuz I've only got so\n\n198\n00:08:41.770 --> 00:08:42.570\nmuch time in this episode.\n\n199\n00:08:42.570 --> 00:08:44.230\nSo we'll do zones in the next episode.\n\n200\n00:08:44.230 --> 00:08:46.320\nBut I wanna focus on security here for\n\n201\n00:08:46.320 --> 00:08:49.580\na minute, because securing\na DNS server is important.\n\n202\n00:08:49.580 --> 00:08:53.920\nAnd there's two main ways that\nwe can secure our DNS server.\n\n203\n00:08:53.920 --> 00:08:55.870\nOne is through the use of a firewall,\nright?\n\n204\n00:08:55.870 --> 00:08:59.800\nSo you can have a firewall configured or\neven the software firewall in\n\n205\n00:08:59.800 --> 00:09:03.880\nLinux configured to control who's\nallowed to access this DNS server.\n\n206\n00:09:03.880 --> 00:09:04.395\nOkay.\n\n207\n00:09:04.395 --> 00:09:07.748\nBy default,\nanybody can access this DNS server.\n\n208\n00:09:07.748 --> 00:09:11.748\nIf I gave it a public IP on the Internet,\nanyone in the entire world could run\n\n209\n00:09:11.748 --> 00:09:15.810\nlookups against this DNS server,\nand I might not want that, right?\n\n210\n00:09:15.810 --> 00:09:18.738\nSo I can use a firewall to restrict it, or\n\n211\n00:09:18.738 --> 00:09:24.006\nI can actually do an access control\nlist right here inside of the config.\n\n212\n00:09:24.006 --> 00:09:27.290\nIf you look, there's already\nan access control list in place.\n\n213\n00:09:27.290 --> 00:09:30.269\nSee down here where it says allow-query?\n\n214\n00:09:30.269 --> 00:09:30.859\nRight?\n\n215\n00:09:30.859 --> 00:09:33.447\nAllow-query is an access list.\n\n216\n00:09:33.447 --> 00:09:39.040\nIt's restricting who's allowed to connect,\nand the default is localhost, right?\n\n217\n00:09:39.040 --> 00:09:42.260\nSo my network people,\nare they gonna be able to do lookups?\n\n218\n00:09:42.260 --> 00:09:43.040\nNo, right?\n\n219\n00:09:43.040 --> 00:09:44.640\nIt's tied to localhost.\n\n220\n00:09:44.640 --> 00:09:47.860\nSo what I really need\nto do is create an ACL,\n\n221\n00:09:47.860 --> 00:09:51.560\nan access control list, to dictate\nwho I want to be allowed to access.\n\n222\n00:09:51.560 --> 00:09:52.544\nI might want everybody too, right?\n\n223\n00:09:52.544 --> 00:09:54.520\nIf I want everybody,\nthen fine, I can do that.\n\n224\n00:09:54.520 --> 00:10:00.830\nBut if I just want particular subnets to\nbe able to access my internal systems,\n\n225\n00:10:00.830 --> 00:10:02.290\nI can come in and I can limit that.\n\n226\n00:10:02.290 --> 00:10:06.370\nSo what you do is notice how this\nup here it says options, and\n\n227\n00:10:06.370 --> 00:10:10.430\nyou've got a semi-colon, I mean not\na semi-colon, a curly brace, right?\n\n228\n00:10:10.430 --> 00:10:14.400\nAnd that curly brace is opening,\nso these are my options.\n\n229\n00:10:14.400 --> 00:10:17.725\nI need to find where that closes out,\nso I'm gonna, yeah,\n\n230\n00:10:17.725 --> 00:10:20.550\njust kinda keep scrolling down here a bit.\n\n231\n00:10:20.550 --> 00:10:24.640\nUntil I can figure out where the curly\nbrace for that stops, right?\n\n232\n00:10:24.640 --> 00:10:28.628\nAnd so, it stops right there,\nand I can add an ACL.\n\n233\n00:10:28.628 --> 00:10:31.084\nI can either add it right there\nafter that semi-colon, or\n\n234\n00:10:31.084 --> 00:10:34.540\nI can just go all the way to the bottom\nof the file and add it down there.\n\n235\n00:10:34.540 --> 00:10:37.860\nIt just can't be inside of the options.\n\n236\n00:10:37.860 --> 00:10:42.566\nSo I'm gonna come in here and just add it\nafter that curly brace, and I'm gonna say,\n\n237\n00:10:42.566 --> 00:10:44.571\nACL and I'll give it a name, okay?\n\n238\n00:10:44.571 --> 00:10:47.690\nI'm gonna call mine local networks.\n\n239\n00:10:47.690 --> 00:10:50.680\nAll right, I'm gonna create an ACL that\nlists everybody who's on my local network.\n\n240\n00:10:51.920 --> 00:10:53.300\nAnd I'm gonna open up a curly brace.\n\n241\n00:10:54.350 --> 00:10:57.830\nAnd then I'm gonna come through and\nspecify who's allowed to come in.\n\n242\n00:10:57.830 --> 00:10:59.902\nSo I'll say localhost.\n\n243\n00:10:59.902 --> 00:11:01.907\nI want localhost to come in, right?\n\n244\n00:11:01.907 --> 00:11:05.545\nI'm gonna say localnets, right?\n\n245\n00:11:05.545 --> 00:11:09.930\nlocalnets is an alias that allows any\nnetwork I have a network interface on,\n\n246\n00:11:09.930 --> 00:11:11.770\nthat I'm directly connected to.\n\n247\n00:11:11.770 --> 00:11:15.860\nBut my DNS server might not be\ndirectly connected to all my networks.\n\n248\n00:11:15.860 --> 00:11:17.800\nI may have five different subnets, and\n\n249\n00:11:17.800 --> 00:11:21.910\nthis DNS server only has one network\ncard so it's only on one subnet.\n\n250\n00:11:21.910 --> 00:11:24.178\nSo I would then need to\nadd any other subnets.\n\n251\n00:11:24.178 --> 00:11:31.476\nI could come in and\nI could say 172.16.0.0/24 or\n\n252\n00:11:31.476 --> 00:11:35.412\n172.16.1.0/24.\n\n253\n00:11:35.412 --> 00:11:40.818\nEven ones that are completely separate,\nright, like 10.0.0.0/8.\n\n254\n00:11:40.818 --> 00:11:44.760\nWhoever it is that I want to allow to be\nable to do lookups against this server.\n\n255\n00:11:44.760 --> 00:11:45.990\nThis is the client side.\n\n256\n00:11:47.380 --> 00:11:52.770\nAnd once I've got that specified, actually\ndon't need the semi-colon on the last one,\n\n257\n00:11:52.770 --> 00:11:56.200\ncuz I'm closing it out and\nI'll close that out, and\n\n258\n00:11:56.200 --> 00:12:00.960\nnow I've got an access control list\ndefined that's called local networks.\n\n259\n00:12:00.960 --> 00:12:05.110\nOr I might call it allowed clients or\nsomething of that nature.\n\n260\n00:12:05.110 --> 00:12:09.880\nWhatever it is that I want\nit to be called, right?\n\n261\n00:12:09.880 --> 00:12:11.620\nSo I'll do allowed clients.\n\n262\n00:12:11.620 --> 00:12:13.360\nAll right, now that I've got that defined,\n\n263\n00:12:13.360 --> 00:12:17.810\nI can go back up here to\nwhere that allow query is.\n\n264\n00:12:17.810 --> 00:12:18.810\nAnd I can change that.\n\n265\n00:12:18.810 --> 00:12:25.580\nAnd instead of saying localhost,\nI can say allowed clients, right?\n\n266\n00:12:25.580 --> 00:12:29.920\nAnd it's gonna look for\nan ACL that's named allowed clients.\n\n267\n00:12:29.920 --> 00:12:30.940\nlocalhost was an alias.\n\n268\n00:12:30.940 --> 00:12:32.140\nIt knew about that.\n\n269\n00:12:32.140 --> 00:12:34.390\nBut it's gonna look at this and\nsay, that's not an alias.\n\n270\n00:12:34.390 --> 00:12:40.680\nThis must be an ACL, and so then it'll\ncome down and find that ACL down here,\n\n271\n00:12:40.680 --> 00:12:44.790\nand that'll dictate whose allowed to\ndo a lookup against this DNS server.\n\n272\n00:12:44.790 --> 00:12:48.530\nIf a DNS query comes in sourced\nfrom an IP that's not on this list,\n\n273\n00:12:48.530 --> 00:12:49.754\nit'll get ignored.\n\n274\n00:12:49.754 --> 00:12:50.402\nIt just gets ignored.\n\n275\n00:12:50.402 --> 00:12:51.540\nIt gets dropped.\n\n276\n00:12:51.540 --> 00:12:53.530\nAnd it chucks it out, right?\n\n277\n00:12:53.530 --> 00:12:56.060\nSo that helps to secure\nthings a little bit.\n\n278\n00:12:56.060 --> 00:12:58.560\nIf I have a firewall, I probably\nwanna configure things there too,\n\n279\n00:12:58.560 --> 00:13:01.070\nand in fact I probably wanna do both.\n\n280\n00:13:01.070 --> 00:13:04.300\nI can configure an ACL right here and\na firewall, and\n\n281\n00:13:04.300 --> 00:13:05.770\nnow I've got defensive depth.\n\n282\n00:13:05.770 --> 00:13:07.830\nI've got defensive multiple layers.\n\n283\n00:13:07.830 --> 00:13:11.450\nGets a little more complex to manage but\nit gives you the best level of security.\n\n284\n00:13:11.450 --> 00:13:15.310\n&gt;&gt; Now that's a pretty complex file,\nso what happens if we make a mistake?\n\n285\n00:13:15.310 --> 00:13:18.310\n&gt;&gt; It is really, really easy to\nmake a mistake in this, right?\n\n286\n00:13:18.310 --> 00:13:19.713\nYou leave out a semi-colon.\n\n287\n00:13:19.713 --> 00:13:21.378\nYou put in a wrong bracket or something.\n\n288\n00:13:21.378 --> 00:13:21.910\n&gt;&gt; Yeah.\n\n289\n00:13:21.910 --> 00:13:23.650\n&gt;&gt; It's easy to make mistakes.\n\n290\n00:13:23.650 --> 00:13:26.710\nThe biggest mistakes for\nme are usually just simple typos.\n\n291\n00:13:26.710 --> 00:13:29.620\nI did allowed clients here, and\nI don't know if you noticed when I\n\n292\n00:13:29.620 --> 00:13:34.120\nwas typing the ACL up here, I left the s\noff at first and I did allowed client.\n\n293\n00:13:34.120 --> 00:13:37.790\nAnd it's a simple mistake,\neasy to make, and you don't see it.\n\n294\n00:13:37.790 --> 00:13:41.800\nWell if there's a mistake in this file,\nbind won't start.\n\n295\n00:13:41.800 --> 00:13:44.790\nSo, if I've already got bind\nconfigured and running and\n\n296\n00:13:44.790 --> 00:13:49.380\nI've got thousands of people using it,\nand I come in and I change this file and\n\n297\n00:13:49.380 --> 00:13:54.550\nI restart bind, and it crashes, I'm taking\nthousands of people offline, right?\n\n298\n00:13:54.550 --> 00:13:55.548\nThat's bad.\n\n299\n00:13:55.548 --> 00:13:59.220\nSo, I wanna make sure that everything\nin here is good before I load it,\n\n300\n00:13:59.220 --> 00:14:00.920\nbefore I actually restart bind.\n\n301\n00:14:00.920 --> 00:14:03.490\nAnd fortunately there's\na utility that helps us do this.\n\n302\n00:14:03.490 --> 00:14:07.480\nThis is one of the main reasons I wanted\nto install that bind-utils package.\n\n303\n00:14:07.480 --> 00:14:10.995\nWhen we installed bind,\nit's just the bind server.\n\n304\n00:14:10.995 --> 00:14:15.170\nBut bind-utils includes\na couple utilities and\n\n305\n00:14:15.170 --> 00:14:21.495\none of the best utilities that's\nin there is one that's called.\n\n306\n00:14:21.495 --> 00:14:23.110\nThat utility right there.\n\n307\n00:14:23.110 --> 00:14:26.310\nAnd when you run it,\nit looks at the configuration file and\n\n308\n00:14:26.310 --> 00:14:27.670\nit looks for mistakes.\n\n309\n00:14:27.670 --> 00:14:29.644\nAnd if it finds a problem in there,\nit lets you know.\n\n310\n00:14:29.644 --> 00:14:32.406\nIt'll tell you exactly which line it is\nthat's a problem and you can go in and\n\n311\n00:14:32.406 --> 00:14:33.280\nyou can fix it.\n\n312\n00:14:33.280 --> 00:14:37.265\nSo I'm gonna run that and\nsure enough, I've got, on line 13,\n\n313\n00:14:37.265 --> 00:14:39.510\nI'm missing a semi-colon.\n\n314\n00:14:39.510 --> 00:14:42.330\nAnd on line 51,\nI'm missing a semi-colon, right?\n\n315\n00:14:42.330 --> 00:14:46.210\nSo I can go right back into that file,\nand I can find those lines.\n\n316\n00:14:46.210 --> 00:14:47.910\nSo lines 13 and 51.\n\n317\n00:14:47.910 --> 00:14:51.280\nWell, I'm using and\ndoesn't show line numbers by default.\n\n318\n00:14:51.280 --> 00:14:52.530\nSo I'm gonna hit the colon.\n\n319\n00:14:52.530 --> 00:14:57.160\nI'll do set number so\nthat I get numbers, right?\n\n320\n00:14:57.160 --> 00:14:58.845\nAnd now I can come in and\nI can find line 13.\n\n321\n00:14:58.845 --> 00:15:00.160\nHere's line 13.\n\n322\n00:15:00.160 --> 00:15:03.208\nOkay, and what I did,\nI actually said this.\n\n323\n00:15:03.208 --> 00:15:05.376\nI said, you don't need\na semi-colon on that last entry.\n\n324\n00:15:05.376 --> 00:15:06.060\nWell guess what?\n\n325\n00:15:06.060 --> 00:15:06.890\nI'm wrong.\n\n326\n00:15:06.890 --> 00:15:08.500\nYou do need a semi-colon.\n\n327\n00:15:08.500 --> 00:15:12.690\nSo let me put that in there and\nthat's gonna fix that one, and\n\n328\n00:15:12.690 --> 00:15:16.630\nI bet line 51 is my ACL where\nI did the same exact thing.\n\n329\n00:15:16.630 --> 00:15:20.043\nYep, so after that last 10.0.0.0/8,\n\n330\n00:15:20.043 --> 00:15:23.304\nI didn't put a semi-colon,\nso let me do that.\n\n331\n00:15:23.304 --> 00:15:27.340\nIf I hadn't run name d-checkoff.\n\n332\n00:15:27.340 --> 00:15:30.120\nIf I had just restarted bind,\nit would have crashed.\n\n333\n00:15:30.120 --> 00:15:32.970\nAnd then I would be troubleshooting\nthis file, trying to find the problem.\n\n334\n00:15:32.970 --> 00:15:35.140\nSo by running that utility,\n\n335\n00:15:35.140 --> 00:15:39.780\nit helped me find the problem\nbefore I took bind offline.\n\n336\n00:15:39.780 --> 00:15:42.190\nAnd now I run it, and I get nothing back.\n\n337\n00:15:42.190 --> 00:15:43.210\nThat's exactly what I want.\n\n338\n00:15:43.210 --> 00:15:45.740\nI want to get nothing\nback from this utility,\n\n339\n00:15:45.740 --> 00:15:47.882\ncuz that tells me everything is fine.\n\n340\n00:15:47.882 --> 00:15:50.377\nAnd now I should be safe to\nstart up the client service.\n\n341\n00:15:50.377 --> 00:15:50.895\n&gt;&gt; Awesome.\n\n342\n00:15:50.895 --> 00:15:54.826\nAre there any extra steps we\nshould take to secure the server?\n\n343\n00:15:54.826 --> 00:15:57.666\nThere are, it kinda depends on\nthe operating system that you're running.\n\n344\n00:15:57.666 --> 00:15:59.044\nSo I'm running Red Hat, and\n\n345\n00:15:59.044 --> 00:16:02.960\non Red Hat there's a few different things\nthat we'll wanna tweak and mess with.\n\n346\n00:16:04.150 --> 00:16:06.390\nWe haven't brought in any zones, but\n\n347\n00:16:06.390 --> 00:16:08.740\na lot of times we're not\ncreating zones from scratch.\n\n348\n00:16:08.740 --> 00:16:12.000\nA lot of time we're bringing zones\nin from some other DNS server.\n\n349\n00:16:12.000 --> 00:16:12.760\nAnd so if you do that,\n\n350\n00:16:12.760 --> 00:16:15.700\nsometimes the permissions can get\na little wacked out for bind.\n\n351\n00:16:15.700 --> 00:16:18.290\nAnd I always make sure to go in and\nreset those permissions, and\n\n352\n00:16:18.290 --> 00:16:21.020\neven on a new install, a lot of times\nI'll do it just to make sure it's right,\n\n353\n00:16:21.020 --> 00:16:23.520\nbecause permissions can be\na little bit of a problem.\n\n354\n00:16:23.520 --> 00:16:27.395\nThere's also the firewall,\nif you're running Firewalld or IP tables,\n\n355\n00:16:27.395 --> 00:16:30.020\nyou'll want to make sure you\nopen up DNS in the firewall, so\n\n356\n00:16:30.020 --> 00:16:31.890\nthat's another extra step\nthat we need to take.\n\n357\n00:16:31.890 --> 00:16:32.960\nSo, a few different things.\n\n358\n00:16:32.960 --> 00:16:34.720\nLet me show you what I normally\ndo on permissions, and\n\n359\n00:16:34.720 --> 00:16:37.489\nagain, on a brand new install you\nprobably don't need to do this.\n\n360\n00:16:38.520 --> 00:16:40.210\nBut if you're importing\nzones from another server,\n\n361\n00:16:40.210 --> 00:16:41.730\nthese are steps that you'll want to do.\n\n362\n00:16:41.730 --> 00:16:45.894\nSo, one of the first things\nthat I do is I take a look at\n\n363\n00:16:45.894 --> 00:16:48.655\nthe /var/named folder, okay?\n\n364\n00:16:48.655 --> 00:16:53.580\nThat folder is where bind\nstores its zone files, right?\n\n365\n00:16:53.580 --> 00:16:57.400\nAnd even on a caching server,\nthis is where it will store its cache.\n\n366\n00:16:57.400 --> 00:16:59.920\nSo bind is writing to\nthis folder all the time.\n\n367\n00:16:59.920 --> 00:17:01.490\nIt needs to have access to it, right?\n\n368\n00:17:01.490 --> 00:17:04.360\nAnd if it doesn't,\nif there's something blocking its access,\n\n369\n00:17:04.360 --> 00:17:05.890\nthen it's not going to work.\n\n370\n00:17:05.890 --> 00:17:10.520\nSo you can use a few commands just to make\nsure that everything is right in here.\n\n371\n00:17:10.520 --> 00:17:16.610\nThe permissions are that the group for\nall of these files should be named.\n\n372\n00:17:16.610 --> 00:17:18.320\nSee how the group is named.\n\n373\n00:17:18.320 --> 00:17:22.790\nIf I copy the files from another\nserver though, then when I copy them,\n\n374\n00:17:22.790 --> 00:17:25.410\nthey might be owned by me because\nI'm the one who copied them.\n\n375\n00:17:25.410 --> 00:17:30.065\nOr if I sudo it,\nit might be user root, group root, and\n\n376\n00:17:30.065 --> 00:17:31.310\nnamed wouldn't have access, right?\n\n377\n00:17:31.310 --> 00:17:32.700\nSo that's something we\nneed to double check.\n\n378\n00:17:32.700 --> 00:17:37.160\nSo the easy way to do that is to use the\nchgrp command, the change group command.\n\n379\n00:17:37.160 --> 00:17:41.107\nAnd we can say,\nI wanna change the group to named.\n\n380\n00:17:41.107 --> 00:17:47.660\nI wanna do this recursively for\neverything in /var/named, okay?\n\n381\n00:17:47.660 --> 00:17:50.000\nAnd that way if you've\ncopied files in there,\n\n382\n00:17:50.000 --> 00:17:52.370\nit all gets setup with the right group.\n\n383\n00:17:52.370 --> 00:17:56.481\nI'm making sure that named is the assigned\ngroup for every file in that folder and\n\n384\n00:17:56.481 --> 00:17:58.310\nthat'll solve part of that.\n\n385\n00:17:58.310 --> 00:18:00.820\nThe owner should be root.\n\n386\n00:18:00.820 --> 00:18:04.140\nAnd in a lot of cases it is,\nin some cases it's not.\n\n387\n00:18:04.140 --> 00:18:07.430\nLike see these directories here\nwhere the owner is actually named?\n\n388\n00:18:07.430 --> 00:18:09.170\nThat's fine,\nthat's not gonna hurt anything.\n\n389\n00:18:09.170 --> 00:18:12.410\nBut if we want it all to be kind of\nconsistent we might wanna reassign that.\n\n390\n00:18:12.410 --> 00:18:18.220\nInstead of using change group I could've\nused chown and change the owner,\n\n391\n00:18:18.220 --> 00:18:22.440\ncuz when you use the change owner command\nyou can actually change the user and\n\n392\n00:18:22.440 --> 00:18:23.870\nthe group at the same time.\n\n393\n00:18:23.870 --> 00:18:29.064\nSo I could've said I wanna change\nthe owner, and I wanna do root:named.\n\n394\n00:18:29.064 --> 00:18:33.330\nI wanna set the user to root,\nand the group to named.\n\n395\n00:18:33.330 --> 00:18:38.250\nAnd then specify /var/named,\n\n396\n00:18:38.250 --> 00:18:41.065\nlike that, okay?\n\n397\n00:18:41.065 --> 00:18:47.208\nNow I am gonna do that for\n/etc/named.conf, okay?\n\n398\n00:18:47.208 --> 00:18:50.055\nIf I copied that from another server,\nthen those might be set wrong, so\n\n399\n00:18:50.055 --> 00:18:51.146\nI'm just gonna run that and\n\n400\n00:18:51.146 --> 00:18:54.340\nmake sure that the permissions are set\ncorrectly on the configuration file.\n\n401\n00:18:54.340 --> 00:18:56.360\nBind needs to be able to read\nthat configuration file.\n\n402\n00:18:56.360 --> 00:18:58.110\nIt should be right on your system already,\nbut\n\n403\n00:18:58.110 --> 00:19:00.700\nit's just something to double check and\nmake sure that it's there.\n\n404\n00:19:00.700 --> 00:19:04.610\nMore importantly, though,\nif you're running SE Linux.\n\n405\n00:19:04.610 --> 00:19:10.420\nIn SE Linux, Security Enhanced Linux, a\nservice is restricted so that it can only\n\n406\n00:19:10.420 --> 00:19:15.800\naccess certain folders and if you're doing\na clean install like I am, that's fine.\n\n407\n00:19:15.800 --> 00:19:20.530\nBut if you're bringing this over from\nanother system it usually breaks SE Linux.\n\n408\n00:19:20.530 --> 00:19:24.290\nAnd so we just need to kind of reset\nthe SE Linux context for these folders.\n\n409\n00:19:24.290 --> 00:19:27.310\nAnd there's two commands we can use for\nthat which are not too bad.\n\n410\n00:19:27.310 --> 00:19:31.420\nI'll say restorecon, right,\nI'm restoring the context.\n\n411\n00:19:31.420 --> 00:19:36.320\nAnd I'll do -rv, -r makes it recursive so\nI'll hit subfolders as well.\n\n412\n00:19:36.320 --> 00:19:39.980\nAnd v is verbose so I'll get extra output\non the screen if there's any errors.\n\n413\n00:19:39.980 --> 00:19:43.242\nAnd I'm gonna hit /var/named.\n\n414\n00:19:43.242 --> 00:19:48.505\nSo I'm gonna make sure that that\nfolder has the right SE Linux context,\n\n415\n00:19:48.505 --> 00:19:52.820\nand then I'll do the same thing for\n/etc/named.conf.\n\n416\n00:19:52.820 --> 00:19:56.009\nOkay, now hopefully you don't have to do\nthese commands on a clean installation.\n\n417\n00:19:56.009 --> 00:19:58.658\nBut realistically in the real world,\nyou've usually\n\n418\n00:19:58.658 --> 00:20:02.057\ngot one DNS server set up already and\nyou're setting up secondaries or\n\n419\n00:20:02.057 --> 00:20:05.860\nyou're moving to a new system and\nyou're copying your config files over.\n\n420\n00:20:05.860 --> 00:20:08.360\nAnd that's why I've gotten into\nthe habit of doing these commands even\n\n421\n00:20:08.360 --> 00:20:09.580\nthough they're not always necessary.\n\n422\n00:20:09.580 --> 00:20:12.360\nThis is just a way to make\nsure that we're protected.\n\n423\n00:20:12.360 --> 00:20:17.680\nOkay, now if I was having a problem,\nI wouldn't have been able to start bind.\n\n424\n00:20:17.680 --> 00:20:18.890\nNow, I should be able to start it, right?\n\n425\n00:20:18.890 --> 00:20:22.800\nSo, I should be able to\nfire in system CTL start.\n\n426\n00:20:22.800 --> 00:20:25.680\nWell, actually before I start,\nI need to do an enable, right?\n\n427\n00:20:25.680 --> 00:20:28.540\nI need to enable the bind service so\nthat system d will recognize it.\n\n428\n00:20:28.540 --> 00:20:33.548\nSo I'm going to say system CTL\nenable named.service, right?\n\n429\n00:20:33.548 --> 00:20:37.800\nNot bind.service, even if though\nbind is what we're actually running,\n\n430\n00:20:37.800 --> 00:20:38.660\nnamed is what it's called.\n\n431\n00:20:38.660 --> 00:20:43.470\nSo I'm gonna enable it, and\nthen I'm going to start it.\n\n432\n00:20:43.470 --> 00:20:48.160\nAnd so when I start that, if I get\nan error here, I know I've got a problem.\n\n433\n00:20:48.160 --> 00:20:51.641\nBut because we checked all our\npermissions, we used the named check\n\n434\n00:20:51.641 --> 00:20:55.258\nconfig, we knew our config was clean,\nit shouldn't get any errors.\n\n435\n00:20:55.258 --> 00:20:58.790\nThey should start right up which mine did,\nand it looks like we're good.\n\n436\n00:20:58.790 --> 00:21:01.220\nThe only thing I haven't\ndone is the firewall, right?\n\n437\n00:21:01.220 --> 00:21:05.240\nI am running firewall d,\nbecause Red Hat 7 runs it by default.\n\n438\n00:21:05.240 --> 00:21:07.700\nSo I need to open up some\nholes in the firewall.\n\n439\n00:21:07.700 --> 00:21:12.520\nI put that ACL in on bind to allow\nclients to be able to connect in, but if\n\n440\n00:21:12.520 --> 00:21:16.240\nthe firewall is blocking them then they'll\nnever even get to bind to hit that ACL.\n\n441\n00:21:16.240 --> 00:21:17.940\nSo I need to issue a couple\nof extra commands.\n\n442\n00:21:17.940 --> 00:21:20.679\nI'm gonna say\n\n443\n00:21:20.679 --> 00:21:28.901\nfirewall-cmd--add-service=dns.\n\n444\n00:21:28.901 --> 00:21:31.640\nNow, this is assuming that\nI've only got one zone.\n\n445\n00:21:31.640 --> 00:21:33.870\nIf you have more than one\nzone on your DNS server,\n\n446\n00:21:33.870 --> 00:21:38.280\nmaybe you have a zone that faces the\nInternet and a zone that faces the inside.\n\n447\n00:21:38.280 --> 00:21:41.845\nThen you might need to add\n--zone equals public, or\n\n448\n00:21:41.845 --> 00:21:44.680\n--zone equals private,\nwhatever the zone name is.\n\n449\n00:21:44.680 --> 00:21:47.890\nBut for me, I've just got the one zone,\nthe default zone.\n\n450\n00:21:47.890 --> 00:21:51.350\nSo I'm gonna add DNS to it,\nand that's gonna open that up.\n\n451\n00:21:51.350 --> 00:21:55.330\nRemember with firewall CMD though,\nthose commands don't get saved to disk,\n\n452\n00:21:55.330 --> 00:21:57.360\nthat's just modifying\nthe config in memory.\n\n453\n00:21:57.360 --> 00:22:03.340\nSo I need to run it a second time and\nadd the --permanent to it.\n\n454\n00:22:03.340 --> 00:22:08.090\nSo, let me add that, --permanent.\n\n455\n00:22:08.090 --> 00:22:11.290\nAnd don't think that you can just run\npermanent because that writes the disk but\n\n456\n00:22:11.290 --> 00:22:12.165\nit doesn't write to memory, right?\n\n457\n00:22:12.165 --> 00:22:13.810\n&gt;&gt; Mm-hm.\n&gt;&gt; So you really do need to run both.\n\n458\n00:22:13.810 --> 00:22:16.680\nSo that way it takes effect right now and\nit writes it to disk so\n\n459\n00:22:16.680 --> 00:22:18.620\nit'll be there after a reboot.\n\n460\n00:22:18.620 --> 00:22:25.758\nAnd you can kind of verify that real\nquick, by doing a firewall-cmd--list-all.\n\n461\n00:22:25.758 --> 00:22:28.172\nAnd you can take a look at everything\nthat's been allowed through.\n\n462\n00:22:28.172 --> 00:22:33.144\nAnd looking here at my active zone, I can\nsee that I've got DNS is now added to\n\n463\n00:22:33.144 --> 00:22:38.680\nthe services, to allow that to come in on\nmy interface, and be able to communicate.\n\n464\n00:22:38.680 --> 00:22:40.369\nSo that should do everything that we need.\n\n465\n00:22:42.200 --> 00:22:45.920\nIf we had already started\nnamed at some point,\n\n466\n00:22:45.920 --> 00:22:48.090\nwe might wanna restart it\njust to be on the safe side,\n\n467\n00:22:48.090 --> 00:22:51.170\nbut I haven't changed my configuration\nsince we started it so I'm fine there.\n\n468\n00:22:51.170 --> 00:22:54.215\nBut otherwise, we should now be up.\n\n469\n00:22:54.215 --> 00:22:57.485\nClients should be able to connect over\nthe network and start to do look ups.\n\n470\n00:22:57.485 --> 00:22:59.965\nWell, except we don't\nreally have any zones.\n\n471\n00:22:59.965 --> 00:23:02.115\nThat's gonna kinda be our\nnext step on that one.\n\n472\n00:23:02.115 --> 00:23:03.085\n&gt;&gt; Yes, zones are coming.\n\n473\n00:23:03.085 --> 00:23:06.680\nBecoming a Linux server administrator,\ninstalling bind.\n\n474\n00:23:06.680 --> 00:23:07.880\nDon, wonderful job.\n\n475\n00:23:07.880 --> 00:23:09.320\nNow is there any last words?\n\n476\n00:23:09.320 --> 00:23:10.821\n&gt;&gt; All right,\nI mentioned zones a few times.\n\n477\n00:23:10.821 --> 00:23:13.417\nThat is the logical next step we just\ndon't have enough time in this episode\n\n478\n00:23:13.417 --> 00:23:13.960\nto get to them.\n\n479\n00:23:13.960 --> 00:23:17.210\nSo stay tuned for the next episode because\nwe're going to take a look at how to setup\n\n480\n00:23:17.210 --> 00:23:19.410\nforward lookup zones and\nreverse lookup zones,\n\n481\n00:23:19.410 --> 00:23:21.700\nwhich is really where you'll\nspend most of your time.\n\n482\n00:23:21.700 --> 00:23:24.230\nEverything we saw on this episode,\nyou usually just do once.\n\n483\n00:23:24.230 --> 00:23:25.740\nYou do it once, it's setup, right?\n\n484\n00:23:25.740 --> 00:23:27.026\nAll the other work-\n&gt;&gt; Once and done.\n\n485\n00:23:27.026 --> 00:23:28.750\n&gt;&gt; -is gonna be done in the zone file.\n\n486\n00:23:28.750 --> 00:23:31.130\nSo stay tuned,\nthat's coming up in the next episode.\n\n487\n00:23:31.130 --> 00:23:32.210\n&gt;&gt; Awesome job as usual.\n\n488\n00:23:32.210 --> 00:23:34.160\nBecoming a Linux server administrator.\n\n489\n00:23:34.160 --> 00:23:36.430\nThere is a lot of video\ncontent in this series,\n\n490\n00:23:36.430 --> 00:23:37.890\nmake sure you watch all the videos.\n\n491\n00:23:37.890 --> 00:23:39.660\nYou'll be very glad you did.\n\n492\n00:23:39.660 --> 00:23:41.230\nAnd thank you for watching ITProTV.\n\n493\n00:23:41.230 --> 00:23:44.880\nRemember, a good ITPro is always learning.\n\n494\n00:23:44.880 --> 00:23:45.830\nI'm Zach Mendez.\n\n495\n00:23:45.830 --> 00:23:46.590\n&gt;&gt; And I'm Don Pezet.\n\n496\n00:23:46.590 --> 00:23:48.511\n&gt;&gt; And we will see you soon.\n\n497\n00:23:48.511 --> 00:23:54.397\n[MUSIC]\n\n498\n00:23:54.397 --> 00:23:57.926\n&gt;&gt; Thank you for watching ITPRO.TV.\n\n",
          "vimeoId": "226903514"
        },
        {
          "description": "Don and Zach explain getting started with Forward Lookup Zones, creating a Zone File, creating Core Records, what SOA is, Name Servers (NS), adding the Zone to BIND, Verify Syntax, and Cleanup Permissions.",
          "length": "1592",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-2-1-configuring_zones_and_records-072117-PGM.00_26_17_04.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-2-1-configuring_zones_and_records-072117-PGM.00_26_17_04.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-2-1-configuring_zones_and_records-072117-PGM.00_26_17_04.Still001-sm.jpg",
          "title": "Configuring Zones and Records",
          "transcript": "WEBVTT\n\n1\n00:00:00.008 --> 00:00:03.515\nWelcome to ITPRO.TV,\nI'm your host Don Pezet.\n\n2\n00:00:03.515 --> 00:00:06.546\n&gt;&gt; [CROSSTALK]\n\n3\n00:00:06.546 --> 00:00:08.528\n[MUSIC]\n\n4\n00:00:08.528 --> 00:00:12.093\n&gt;&gt; You're watching ITPRO.TV.\n\n5\n00:00:12.093 --> 00:00:14.365\n&gt;&gt; Hello and thank you for\nchoosing ITPRO.TV,\n\n6\n00:00:14.365 --> 00:00:16.170\nhelping you learn wherever you go.\n\n7\n00:00:16.170 --> 00:00:19.590\nI'm your host Zach Memos as we\ncontinue on with becoming a Linux\n\n8\n00:00:19.590 --> 00:00:20.970\nserver administrator.\n\n9\n00:00:20.970 --> 00:00:23.370\nConfiguring zones and records.\n\n10\n00:00:23.370 --> 00:00:24.630\nThat's a great topic and\n\n11\n00:00:24.630 --> 00:00:28.080\nDon Pezet right here, he's going to help\nus out with all of that, aren't you Don?\n\n12\n00:00:28.080 --> 00:00:30.780\n&gt;&gt; Absolutely, if you are watching all\nthese episodes in order, in the last\n\n13\n00:00:30.780 --> 00:00:34.380\nepisode we saw how to setup a DNS server\nand we brought up the bind service,\n\n14\n00:00:34.380 --> 00:00:37.080\nwhich is one of the most common\nDNS servers in the world.\n\n15\n00:00:37.080 --> 00:00:39.040\nBut we didn't set up a terribly\neffective one, right?\n\n16\n00:00:39.040 --> 00:00:44.070\nWe built what's called a caching DNS\nserver because it has no local zones.\n\n17\n00:00:44.070 --> 00:00:47.930\nAnd so we really need to get local\nzones created before we can actually\n\n18\n00:00:47.930 --> 00:00:49.260\nreally put this stuff to work.\n\n19\n00:00:49.260 --> 00:00:51.530\nSo a local zone,\nit's gonna take one of two forms, right.\n\n20\n00:00:51.530 --> 00:00:54.000\nYou've got forward lookup zones and\nreverse lookup zones.\n\n21\n00:00:54.000 --> 00:00:58.410\nForward zones are doing where it converts\na name to an IP address, and our reversal\n\n22\n00:00:58.410 --> 00:01:01.610\nlookup zone is just the opposite,\nconverts an IP address to a name.\n\n23\n00:01:01.610 --> 00:01:04.500\nWell, all that configuration\nis stored in files,\n\n24\n00:01:04.500 --> 00:01:08.965\nfiles that we need to create from bind\nto use to then be able to serve up.\n\n25\n00:01:08.965 --> 00:01:13.165\nIf you don't do that, it's just forwarding\nall those requests on to another DNS\n\n26\n00:01:13.165 --> 00:01:15.285\nserver somewhere and caching the result.\n\n27\n00:01:15.285 --> 00:01:19.230\nSo while we did actually set up an\neffective DNS server in the last episode.\n\n28\n00:01:19.230 --> 00:01:20.340\nWe really need to go a step further.\n\n29\n00:01:20.340 --> 00:01:22.280\nAnd that's what we're doing\nright here in this episode,\n\n30\n00:01:22.280 --> 00:01:24.240\nwe're looking at zones and records.\n\n31\n00:01:24.240 --> 00:01:27.930\n&gt;&gt; So Don, I'm excited, how do we get\nstarted with forward looking zones?\n\n32\n00:01:27.930 --> 00:01:30.290\n&gt;&gt; All right, let's start with forward\nbecause that is the most common.\n\n33\n00:01:30.290 --> 00:01:32.570\nIn fact most of the representatives\nare pretty much optional.\n\n34\n00:01:32.570 --> 00:01:34.080\nYou don't necessarily have to have them.\n\n35\n00:01:34.080 --> 00:01:35.850\nThey can speed up certain operations.\n\n36\n00:01:35.850 --> 00:01:38.230\nBut four lookup zones those\nare the ones you're going to want.\n\n37\n00:01:38.230 --> 00:01:40.330\nAnd you want to convert names to IP.\n\n38\n00:01:40.330 --> 00:01:43.120\nI can remember www.google.com.\n\n39\n00:01:43.120 --> 00:01:45.335\nI can't remember whatever\nIP address they have.\n\n40\n00:01:45.335 --> 00:01:46.810\nWhich I don't know [LAUGH].\n\n41\n00:01:46.810 --> 00:01:48.940\n&gt;&gt; It's long, whatever it is, it's long.\n\n42\n00:01:48.940 --> 00:01:50.410\n&gt;&gt; And that's what DNS helps us do, right?\n\n43\n00:01:50.410 --> 00:01:51.810\nIt's like the speed\ndial in your cellphone.\n\n44\n00:01:51.810 --> 00:01:53.530\nIt helps you not remember phone numbers.\n\n45\n00:01:53.530 --> 00:01:55.220\nSo I need to get that created.\n\n46\n00:01:55.220 --> 00:01:57.460\nSo I've already got my\nDNS server stood up.\n\n47\n00:01:57.460 --> 00:01:58.600\nNow, I just need those zone files.\n\n48\n00:01:58.600 --> 00:02:02.370\nAnd I mentioned in the last episode\nthose zone files are actually\n\n49\n00:02:02.370 --> 00:02:05.730\nstored in a folder /var/named, okay?\n\n50\n00:02:05.730 --> 00:02:08.800\nThat folder right there and\nthat's where you'll have your zone files.\n\n51\n00:02:08.800 --> 00:02:11.220\nNow, I don't have any zone\nfiles cuz I haven't made any.\n\n52\n00:02:11.220 --> 00:02:12.270\nSo I'm gonna need to do that.\n\n53\n00:02:12.270 --> 00:02:13.670\nI need to get them created.\n\n54\n00:02:13.670 --> 00:02:15.420\nAnd put in place right here.\n\n55\n00:02:15.420 --> 00:02:17.720\nSo, step one is to create a file here.\n\n56\n00:02:17.720 --> 00:02:19.900\nNow, you do need to be root to\nmess around in this directory,\n\n57\n00:02:19.900 --> 00:02:22.070\nor you need to be a member of\nthe name D group, one or the other.\n\n58\n00:02:23.490 --> 00:02:26.150\nI am, right now,\nI'm logged in as D pazet, but\n\n59\n00:02:26.150 --> 00:02:31.430\nI did a sudu /S to elevate my privileges,\nso I'm effectively running as root here.\n\n60\n00:02:31.430 --> 00:02:33.090\nAnd I'm going to create a file in here.\n\n61\n00:02:33.090 --> 00:02:37.310\nSo inside of the /var /name D,\nI'm going to create a file for my zone.\n\n62\n00:02:37.310 --> 00:02:41.170\nNow technically,\nyou can name the file whatever you want.\n\n63\n00:02:41.170 --> 00:02:43.400\nThe name can be literally anything.\n\n64\n00:02:43.400 --> 00:02:45.980\nAny extension,\nwhatever it is that you want.\n\n65\n00:02:45.980 --> 00:02:51.920\nBut normally most of us will name it as\nthe domain we're planning on serving.\n\n66\n00:02:51.920 --> 00:02:55.590\nFollowed by a .dns extension, but\nthat's not a hard and fast rule,\n\n67\n00:02:55.590 --> 00:02:58.000\nit's just what most people do\nbecause it makes life easy.\n\n68\n00:02:58.000 --> 00:03:00.810\nIf you're hosting more than one zone,\nyou need to tell them apart and\n\n69\n00:03:00.810 --> 00:03:03.530\nif you gave them nonsensical names,\nit's not gonna help you.\n\n70\n00:03:03.530 --> 00:03:07.780\nLike if I call it Zone 1, and\nthen I create a Zone 2, what is Zone 1?\n\n71\n00:03:07.780 --> 00:03:12.530\nSo it makes a lot more sense to call\nit something like Lab.itpro.tv cuz\n\n72\n00:03:12.530 --> 00:03:17.570\nthat's the zone that I might wanna\nhost example.com or whatever.\n\n73\n00:03:17.570 --> 00:03:21.030\nNow I could leave it at that but\nI'm gonna add a .DNS to it just so\n\n74\n00:03:21.030 --> 00:03:23.010\nthat I can remember that\nthis is a DNS zone file.\n\n75\n00:03:23.010 --> 00:03:26.070\nBut again this is just my own personal\npreference and what a lot of other\n\n76\n00:03:26.070 --> 00:03:28.859\nadministrators out there do you're\nwelcome to call it whatever you want.\n\n77\n00:03:30.160 --> 00:03:34.220\nNow when I edit that file I\nget a nice empty file and\n\n78\n00:03:34.220 --> 00:03:36.290\nthere's no hand holding in the DNS world.\n\n79\n00:03:36.290 --> 00:03:38.030\nYou got to know what to put in here and\n\n80\n00:03:38.030 --> 00:03:42.910\nthere's a couple of critical entries that\nyou have to have in every zone file.\n\n81\n00:03:42.910 --> 00:03:44.130\nA lot of entries are optional.\n\n82\n00:03:44.130 --> 00:03:45.420\nYou can kinda pick and choose.\n\n83\n00:03:45.420 --> 00:03:48.280\nBut there's a few entries that\nwe absolutely have to have.\n\n84\n00:03:48.280 --> 00:03:49.890\nSo let's start right there.\n\n85\n00:03:49.890 --> 00:03:52.600\nThe first one is you need what's\ncalled a start of authority.\n\n86\n00:03:52.600 --> 00:03:56.850\nA start of authority is an entry that\nsays, this server is responsible for\n\n87\n00:03:56.850 --> 00:03:57.530\nthis domain.\n\n88\n00:03:57.530 --> 00:03:58.760\nThat we're allowed to answer for\nthe domain.\n\n89\n00:03:58.760 --> 00:04:00.410\nWe don't have to go to somebody else.\n\n90\n00:04:00.410 --> 00:04:01.880\nWe are the authority.\n\n91\n00:04:01.880 --> 00:04:06.280\nAnd so whenever you refer to this server,\nyou can do that or\n\n92\n00:04:06.280 --> 00:04:10.260\nthis domain,\nby using an alias which is the at symbol.\n\n93\n00:04:10.260 --> 00:04:13.730\nThe at symbol says this domain,\nthe domain that I'm working with.\n\n94\n00:04:13.730 --> 00:04:18.710\nAnd I can come in and I can tell it\nthat I want it to be an SOA record.\n\n95\n00:04:18.710 --> 00:04:20.340\nNow when you create records in the for\n\n96\n00:04:20.340 --> 00:04:23.230\nlookup zone, the first entry\nis who you're referring to.\n\n97\n00:04:23.230 --> 00:04:27.740\nSo it might be a name or\nan alias like this with the app.\n\n98\n00:04:27.740 --> 00:04:30.030\nThen we need to tell it what\nkind of record I'm creating.\n\n99\n00:04:30.030 --> 00:04:32.960\nNow there's actually a number of\ndifferent record types out there,\n\n100\n00:04:32.960 --> 00:04:37.350\nbut there's only one that's really in use\non the Internet and that is the IM record.\n\n101\n00:04:37.350 --> 00:04:39.150\nI'm creating an Internet record.\n\n102\n00:04:39.150 --> 00:04:41.990\nBut if you ever wanna walk\ndown the history lane of DNS\n\n103\n00:04:41.990 --> 00:04:45.040\nthere's records like the Chaos records and\na few others.\n\n104\n00:04:45.040 --> 00:04:46.920\nThat were used for\ntesting and development,\n\n105\n00:04:46.920 --> 00:04:48.670\nall back in the early days of DNS.\n\n106\n00:04:48.670 --> 00:04:50.910\nWe don't need those any more so\nwe really just use IN.\n\n107\n00:04:52.290 --> 00:04:55.770\nThen I need to tell it what\nkind of record this is, and\n\n108\n00:04:55.770 --> 00:05:00.340\nthis Is an SOA, or\nstart of authority record.\n\n109\n00:05:00.340 --> 00:05:02.620\nOkay, so\nI'm creating a start of authority record.\n\n110\n00:05:02.620 --> 00:05:06.130\nAnd I'm gonna tell it that\nthere's a server out there,\n\n111\n00:05:06.130 --> 00:05:08.780\nusually this one, that is going\nto be the start of authority.\n\n112\n00:05:08.780 --> 00:05:14.750\nAnd so let's say that this server\nwas called dns1.lab.itpro.tv, okay?\n\n113\n00:05:14.750 --> 00:05:17.980\nSo I'm gonna be entering\ndns1.lab.itpro.tv,\n\n114\n00:05:17.980 --> 00:05:20.520\nright here is the start of authority.\n\n115\n00:05:20.520 --> 00:05:23.300\nAnd there's an interesting\nthing I have to do here.\n\n116\n00:05:23.300 --> 00:05:28.300\nWhen you write domain names inside a bind,\nyou have to include a trailing at the end.\n\n117\n00:05:28.300 --> 00:05:29.360\nNow, most of us don't do that, right?\n\n118\n00:05:29.360 --> 00:05:34.110\nIf I'm gonna go to Google's website,\nI go to www.google.com and that's it.\n\n119\n00:05:34.110 --> 00:05:36.410\nBut in reality, the actual address for\n\n120\n00:05:36.410 --> 00:05:41.030\nGoogle would be www.google.com.,\nthere's a trailing.\n\n121\n00:05:41.030 --> 00:05:43.320\nBut web browsers let you leave it off.\n\n122\n00:05:43.320 --> 00:05:44.740\nMost clients let you leave it off.\n\n123\n00:05:44.740 --> 00:05:46.250\nBut there is a trailing dot.\n\n124\n00:05:46.250 --> 00:05:51.050\nAnd that dot is what's actually\npointing to the root servers for DNS.\n\n125\n00:05:51.050 --> 00:05:52.330\nThe root hint servers.\n\n126\n00:05:52.330 --> 00:05:55.970\nAnd then TV,\nthat dot TV would be my top level domain.\n\n127\n00:05:55.970 --> 00:05:59.700\nAnd then .ITpro here that\nwould be my actual domain.\n\n128\n00:05:59.700 --> 00:06:03.270\nAnd then I've got my subdomain of\nunder it and my host under that.\n\n129\n00:06:03.270 --> 00:06:05.010\nSo it's all part of the DNS hierarchy.\n\n130\n00:06:05.010 --> 00:06:07.760\nSo in these files, though,\nthey're very literal and\n\n131\n00:06:07.760 --> 00:06:09.720\nthey expect that dot to be there.\n\n132\n00:06:09.720 --> 00:06:12.020\nSo we have to make sure\nwe train ourselves to do.\n\n133\n00:06:12.020 --> 00:06:15.270\nWe need to follow all the rules here so\nwe need that dot at the end.\n\n134\n00:06:16.360 --> 00:06:17.880\nThen you need the administrative contact.\n\n135\n00:06:17.880 --> 00:06:20.160\nAnd in the early days of the internet\nis referred to a server or\n\n136\n00:06:20.160 --> 00:06:22.360\na workstation that\nthe administrator controlled.\n\n137\n00:06:22.360 --> 00:06:25.570\nNow, it's usually completely ignored but\nyou do have to have something in here.\n\n138\n00:06:25.570 --> 00:06:30.860\nSo I put admin.lab.itpro.tv.\n\n139\n00:06:30.860 --> 00:06:34.220\nand I'm gonna open up a parenthesis here.\n\n140\n00:06:34.220 --> 00:06:37.360\nAnd the reason is the next couple of\nvalues that I provide with the start of\n\n141\n00:06:37.360 --> 00:06:40.650\nauthority are basically time limits.\n\n142\n00:06:40.650 --> 00:06:43.890\nThere's a series of time limits we\nneed to provide for certain criteria.\n\n143\n00:06:43.890 --> 00:06:45.900\nAnd so\nI'm gonna punch each of these in here.\n\n144\n00:06:45.900 --> 00:06:48.600\nAnd they might not make\na whole lot of sense.\n\n145\n00:06:48.600 --> 00:06:52.030\nIt kind of just looks like I'm\ntyping random numbers in here.\n\n146\n00:06:53.130 --> 00:06:57.310\nWhat I'm typing are pretty standard\nintervals for these values.\n\n147\n00:06:58.385 --> 00:07:03.750\nAnd each one kind of serves\na particular purpose.\n\n148\n00:07:03.750 --> 00:07:05.000\nIt does a certain job.\n\n149\n00:07:05.000 --> 00:07:08.590\nActually, I need a semi colon\nafter the parenthesis there.\n\n150\n00:07:08.590 --> 00:07:10.510\nSo what are these values?\n\n151\n00:07:10.510 --> 00:07:13.160\nThe first one is a serial number.\n\n152\n00:07:13.160 --> 00:07:16.710\nEvery time I modify this zone I'm\nsupposed to increase that number,\n\n153\n00:07:16.710 --> 00:07:17.240\nthe serial number.\n\n154\n00:07:17.240 --> 00:07:20.770\nSo it's a 1 right now, if I make a change\nI should make it a 2, and then a 3.\n\n155\n00:07:20.770 --> 00:07:23.280\nAnd that's how people will\nknow I've changed the zone.\n\n156\n00:07:23.280 --> 00:07:26.860\nSo if I have replica servers, they'll use\nthat to identify where there's changes.\n\n157\n00:07:26.860 --> 00:07:30.120\nSo that's the serial number,\nI'm just starting with 1, all right?\n\n158\n00:07:30.120 --> 00:07:32.820\nThen I have a refresh interval.\n\n159\n00:07:32.820 --> 00:07:37.160\nAnd that's set to 24 hours, it's in\nseconds, so 86,400 seconds in a day.\n\n160\n00:07:37.160 --> 00:07:41.264\nSo I'm saying that every 24 hours\nI need to refresh my database and\n\n161\n00:07:41.264 --> 00:07:45.087\nmake sure that what I have in\nmemory matches what I have on disk.\n\n162\n00:07:45.087 --> 00:07:47.766\nThen we've got a retry\ninterval which is set to\n\n163\n00:07:47.766 --> 00:07:52.297\n7200 seconds which says anytime I do\na look up, if I can't find an answer,\n\n164\n00:07:52.297 --> 00:07:56.854\nif I can't contact an upstream server\nI'll retry again in 7200 seconds.\n\n165\n00:07:56.854 --> 00:08:00.219\nThen we've got an expire,\nright, if I hold a record.\n\n166\n00:08:00.219 --> 00:08:07.320\nAnd it hasn't updated in 57,600 seconds,\nthen I'm gonna age it out.\n\n167\n00:08:07.320 --> 00:08:08.020\nLastly, 3,600.\n\n168\n00:08:08.020 --> 00:08:09.903\nThat's what's called a negative cache.\n\n169\n00:08:09.903 --> 00:08:12.511\nAnd so, as I cache something and\ngo to pull it out of cache,\n\n170\n00:08:12.511 --> 00:08:15.443\nI'll actually let it sit there\na little longer, tombstone, and\n\n171\n00:08:15.443 --> 00:08:19.248\nit can be flagged for up to, well, 3,600\nseconds is how this is set right here.\n\n172\n00:08:19.248 --> 00:08:21.020\nSo these are all pretty standard values.\n\n173\n00:08:21.020 --> 00:08:23.970\nYou can tweak these if you want, but\nmost people just rattle right through and\n\n174\n00:08:23.970 --> 00:08:25.640\nstick with the defaults on these.\n\n175\n00:08:25.640 --> 00:08:29.210\nSo I'm gonna punch those in, and that\nactually completes my start of authority.\n\n176\n00:08:29.210 --> 00:08:33.340\nThis closed parenthesis and semi-colon is\nwhat ends the start of authority record\n\n177\n00:08:33.340 --> 00:08:38.890\nand gets that first entry kind of in\nthere that I need as a core record.\n\n178\n00:08:38.890 --> 00:08:42.730\nThere's another core record that I need\nin place, which is a name server record.\n\n179\n00:08:42.730 --> 00:08:45.328\nI need to say who is responsible for\nthis, right?\n\n180\n00:08:45.328 --> 00:08:50.456\nAnd the domain is lab.itpro.tv., right?\n\n181\n00:08:50.456 --> 00:08:52.030\nThat's my domain.\n\n182\n00:08:52.030 --> 00:08:55.170\nAnd then I can tell it\nwho's responsible for that.\n\n183\n00:08:55.170 --> 00:08:59.640\nAnd so I'm basically creating yet\nanother Internet record.\n\n184\n00:08:59.640 --> 00:09:03.274\nAnd it's gonna be pointing\nto a name server,\n\n185\n00:09:03.274 --> 00:09:07.495\nwhich will be DNS1.lab.itpro.tv,\nall right?\n\n186\n00:09:07.495 --> 00:09:09.380\nThat's gonna be a name server.\n\n187\n00:09:09.380 --> 00:09:14.820\nYou need a start of authority,\nand at least one name server.\n\n188\n00:09:14.820 --> 00:09:17.200\nMost online systems require\nyou to have two name servers,\n\n189\n00:09:17.200 --> 00:09:19.420\nbut technically you only need one.\n\n190\n00:09:19.420 --> 00:09:22.004\nBut for fail-over, for availability,\nyou'll usually want two.\n\n191\n00:09:22.004 --> 00:09:23.862\nBut I'm gonna specify one here so far.\n\n192\n00:09:23.862 --> 00:09:26.380\nSo I've got one named server, okay?\n\n193\n00:09:26.380 --> 00:09:28.220\nOnce I've got those in place,\n\n194\n00:09:28.220 --> 00:09:30.960\nthose are the two critical\nrecords that I have to have.\n\n195\n00:09:30.960 --> 00:09:32.778\nI've got to have these two entries.\n\n196\n00:09:32.778 --> 00:09:34.736\nAn SOA and one name server.\n\n197\n00:09:34.736 --> 00:09:36.922\nAnd now I've got a forward lookup zone.\n\n198\n00:09:36.922 --> 00:09:39.450\nIt's just not a very good one\nbecause it doesn't have any other\n\n199\n00:09:39.450 --> 00:09:40.790\nentries in it, right?\n\n200\n00:09:40.790 --> 00:09:42.230\nBut that´s the bare minimum.\n\n201\n00:09:42.230 --> 00:09:46.710\nNow I've got the zone created, and that's\nkind of what's key to getting this done.\n\n202\n00:09:46.710 --> 00:09:48.736\n&gt;&gt; Well, now that the required\nstuff is out of the way,\n\n203\n00:09:48.736 --> 00:09:50.640\nwhat are some other things\nwe can add to the file?\n\n204\n00:09:50.640 --> 00:09:53.430\n&gt;&gt; All right, well, now we get into\nstuff we mess with all the time, right?\n\n205\n00:09:53.430 --> 00:09:56.157\nThose records that I just showed you,\nyou usually set those once,\n\n206\n00:09:56.157 --> 00:09:57.678\nnever mess with them again, right?\n\n207\n00:09:57.678 --> 00:10:01.228\nSo you get a boilerplate, a cookie cutter,\nand that's what you use over and over and\n\n208\n00:10:01.228 --> 00:10:02.432\nover again on your systems.\n\n209\n00:10:02.432 --> 00:10:05.180\nBut once they're in there,\nthat's it, you don't mess with it.\n\n210\n00:10:05.180 --> 00:10:07.010\nBut the next couple of records\nI'm gonna show you are ones we\n\n211\n00:10:07.010 --> 00:10:08.170\nmess with all the time.\n\n212\n00:10:08.170 --> 00:10:10.270\nThese are things like A records.\n\n213\n00:10:10.270 --> 00:10:14.340\nA records are host records where we take\na name and convert it to an IP, right?\n\n214\n00:10:14.340 --> 00:10:16.090\nThe key thing that\na forward lookup zone does.\n\n215\n00:10:16.090 --> 00:10:19.310\nSo for an A record, you would come in and\nyou would specify a name.\n\n216\n00:10:19.310 --> 00:10:20.640\nActually, I need to do one.\n\n217\n00:10:20.640 --> 00:10:23.306\nI keep referencing dns1.lab.tv.\n\n218\n00:10:23.306 --> 00:10:25.733\nI've never defined what\nit's IP address is, so\n\n219\n00:10:25.733 --> 00:10:27.696\nthat's not gonna make DNS very happy.\n\n220\n00:10:27.696 --> 00:10:29.676\nSo I need an A record for that, right?\n\n221\n00:10:29.676 --> 00:10:31.900\nI need to get that put in place.\n\n222\n00:10:31.900 --> 00:10:34.995\nI could have been referring to a DNS\nname that was outside of this domain,\n\n223\n00:10:34.995 --> 00:10:37.093\nin which case I wouldn't\nhave to define it here.\n\n224\n00:10:37.093 --> 00:10:41.224\nBut because this is going to\nbe the lab.itpro.tv zone, and\n\n225\n00:10:41.224 --> 00:10:46.480\nthis host resides inside of lab.itpro.tv,\nI've got to define it.\n\n226\n00:10:46.480 --> 00:10:50.310\nSo to define that, I just come down here,\nand I create an entry and\n\n227\n00:10:50.310 --> 00:10:52.690\nI say DNS 1, right?\n\n228\n00:10:52.690 --> 00:10:54.010\nThat's the name.\n\n229\n00:10:54.010 --> 00:10:57.970\nI don't have to specify the domain\nbecause this zone file is lab.itpro.tv.\n\n230\n00:10:57.970 --> 00:11:03.733\nSo I'm gonna save to that name, and\nI'm gonna create an Internet record,\n\n231\n00:11:03.733 --> 00:11:10.450\nand it's going to be an A record, and it's\ngoing to point to an IP address, right?\n\n232\n00:11:10.450 --> 00:11:13.347\nAnd it would be the IP\naddress of that server.\n\n233\n00:11:13.347 --> 00:11:15.677\nMine's 172.16.0.100.\n\n234\n00:11:15.677 --> 00:11:19.693\nIf this were Internet-facing, I'd need\nto use Internet IPs or public IPs.\n\n235\n00:11:19.693 --> 00:11:23.498\nBut here, I'm on the inside network, so\nI can use a private one like that, right?\n\n236\n00:11:23.498 --> 00:11:28.078\nSo now, when somebody does a lookup for\ndns1.lab.itpro.tv,\n\n237\n00:11:28.078 --> 00:11:31.443\nIt will to 172.16.0.100.\n\n238\n00:11:31.443 --> 00:11:34.929\nAnd all of the sudden these entries\nup here, like my start of authority,\n\n239\n00:11:34.929 --> 00:11:38.510\nthose will work now because they\nactually match a real name.\n\n240\n00:11:38.510 --> 00:11:42.340\nAnd as far as formatting, a lot of\npeople go kinda crazy on this stuff\n\n241\n00:11:42.340 --> 00:11:45.340\nwith their tabs and trying to keep\neverything nice and lined up.\n\n242\n00:11:45.340 --> 00:11:49.480\nIt's actually pretty challenging to keep\nthings lined up, but you certainly can.\n\n243\n00:11:49.480 --> 00:11:52.850\nAnd it does help for troubleshooting and\nreading the files if you\n\n244\n00:11:52.850 --> 00:11:56.220\nkeep everything nice and\ntabbed out and laid out like this.\n\n245\n00:11:56.220 --> 00:11:58.610\nIt's just a little difficult.\n\n246\n00:11:58.610 --> 00:12:01.110\nA records are something\nthat we work with a lot.\n\n247\n00:12:02.240 --> 00:12:07.090\nThere's a trend right now for websites\nto kinda break this rule a little bit.\n\n248\n00:12:07.090 --> 00:12:08.422\nLet me show you how websites work.\n\n249\n00:12:08.422 --> 00:12:13.590\nMaybe I wanted www.lab.itpro.tv, right?\n\n250\n00:12:13.590 --> 00:12:19.040\nSo I could create www, and I could\ncreate a Internet record, an A record,\n\n251\n00:12:19.040 --> 00:12:23.160\nand I could point it to whatever IP\naddress my web server had, right?\n\n252\n00:12:23.160 --> 00:12:25.220\nBut what if somebody doesn't type the www?\n\n253\n00:12:25.220 --> 00:12:27.400\nWhat if they just go to lab.itpro.tv,\nright?\n\n254\n00:12:27.400 --> 00:12:31.615\nLike our website, it's itpro.tv,\nnot www.itpro.tv.\n\n255\n00:12:31.615 --> 00:12:35.276\nWell, you can use an alias to\nrefer to the domain itself,\n\n256\n00:12:35.276 --> 00:12:37.500\nthe same alias that I used up here.\n\n257\n00:12:37.500 --> 00:12:40.980\nThis alias referred to lab.itpro.tv.\n\n258\n00:12:40.980 --> 00:12:45.278\nSo I can come in and\nI can say at is an A-record that points\n\n259\n00:12:45.278 --> 00:12:48.495\nto 172.16.0.101, right?\n\n260\n00:12:48.495 --> 00:12:52.477\nSo now it's linking right\nback to that web server and\n\n261\n00:12:52.477 --> 00:12:56.196\nyou can get there whether\nyou type the www or not.\n\n262\n00:12:56.196 --> 00:13:00.260\nSo that's another thing that we can do is\nuse that little alias there for a name.\n\n263\n00:13:00.260 --> 00:13:01.960\nNow these are all A-records.\n\n264\n00:13:01.960 --> 00:13:04.030\nA records have a little bit of a problem.\n\n265\n00:13:04.030 --> 00:13:09.010\nThe problem with an A record is if I\nwanna make a change to a server, right?\n\n266\n00:13:09.010 --> 00:13:12.320\nLike these two, it's two A records\nthat point to the same server.\n\n267\n00:13:12.320 --> 00:13:13.550\nIf I ever wanna change that server's IP,\n\n268\n00:13:13.550 --> 00:13:15.840\nI've gotta go modify\nboth of these records.\n\n269\n00:13:15.840 --> 00:13:18.720\nSo a lot of times,\nwe'll use aliases instead.\n\n270\n00:13:18.720 --> 00:13:22.130\nAn alias is not A, right?\n\n271\n00:13:22.130 --> 00:13:24.640\nA is actually referring to a host record.\n\n272\n00:13:24.640 --> 00:13:27.220\nAn alias is actually what's called\na CNAME or a canonical name.\n\n273\n00:13:27.220 --> 00:13:30.660\nAnd a canonical name is just where\nyou map one name to another.\n\n274\n00:13:30.660 --> 00:13:32.790\nSo, for example,\nI might not have a server called www.\n\n275\n00:13:32.790 --> 00:13:38.610\nI might have a server called webserve01,\nright?\n\n276\n00:13:38.610 --> 00:13:44.950\nAnd that webserve01 might be\nsitting at 172.16.0.101, right?\n\n277\n00:13:44.950 --> 00:13:51.270\nSo with www, instead of defining it as\nan A record, I could have said CNAME.\n\n278\n00:13:51.270 --> 00:13:58.180\nAnd as a CNAME, I could have\npointed it to webserve01 dot lab\n\n279\n00:13:58.180 --> 00:14:02.940\nat IT Pro dot TV dot, like that, okay?\n\n280\n00:14:02.940 --> 00:14:07.560\nAnd now, if I ever change\nweb serve 01's IP address,\n\n281\n00:14:07.560 --> 00:14:10.070\nit will change all the c names too, right?\n\n282\n00:14:10.070 --> 00:14:11.690\nThey are all linked together.\n\n283\n00:14:11.690 --> 00:14:13.870\nI make the change once,\nand it applies all over.\n\n284\n00:14:13.870 --> 00:14:15.500\nSo C names are really handy for that.\n\n285\n00:14:15.500 --> 00:14:18.090\nAnd they´re really defined\nthe same way as an A record except\n\n286\n00:14:18.090 --> 00:14:20.520\ninstead of appointing to an IP,\nthey just point to another name.\n\n287\n00:14:20.520 --> 00:14:22.330\nAnd I need to make sure\nthat name can resolve.\n\n288\n00:14:23.590 --> 00:14:25.080\nLet's see.\nWhat other ones can we create?\n\n289\n00:14:25.080 --> 00:14:26.412\nMail records, right?\n\n290\n00:14:26.412 --> 00:14:28.350\nI might have mail servers.\n\n291\n00:14:28.350 --> 00:14:32.660\nI might a mail1 and a mail2, so\nI've got two e-mail servers.\n\n292\n00:14:32.660 --> 00:14:34.850\nAnd you'll want A records for\nthese guys, right?\n\n293\n00:14:34.850 --> 00:14:36.965\nCuz you've gotta be able to touch them.\n\n294\n00:14:36.965 --> 00:14:41.880\nAnd so I will create some A records for\nthose guys real quick.\n\n295\n00:14:41.880 --> 00:14:43.010\nThere.\n\n296\n00:14:43.010 --> 00:14:45.400\nAnd when people want to send me e-mail,\n\n297\n00:14:45.400 --> 00:14:46.915\nhow do they know where\nmy mail servers are?\n\n298\n00:14:46.915 --> 00:14:47.919\nWe use MX records, right?\n\n299\n00:14:47.919 --> 00:14:51.747\nSo if I want to create an MX record\nin here, I can come in and say at,\n\n300\n00:14:51.747 --> 00:14:54.894\nbecause it's e-mail for\nthe whole domain, right?\n\n301\n00:14:54.894 --> 00:14:57.501\nIt's e-mail for lab.itpro.tv.\n\n302\n00:14:57.501 --> 00:14:58.574\nIt's an Internet record.\n\n303\n00:14:58.574 --> 00:14:59.980\nAnd it's an MX.\n\n304\n00:14:59.980 --> 00:15:01.508\nIt's a mail exchange record.\n\n305\n00:15:01.508 --> 00:15:05.021\nAnd with mail exchange records,\nyou actually have to specify a priority.\n\n306\n00:15:05.021 --> 00:15:07.635\nYou might prefer one mail\nserver over another one.\n\n307\n00:15:07.635 --> 00:15:08.812\nOr you might wanna load balance.\n\n308\n00:15:08.812 --> 00:15:09.694\nIt's up to you.\n\n309\n00:15:09.694 --> 00:15:14.755\nIf I want mail to go to mail1 by default,\nunless it fails and\n\n310\n00:15:14.755 --> 00:15:20.848\nthen go to mail2,\nI can just say 10mail.lab.itpro.tv, right?\n\n311\n00:15:20.848 --> 00:15:29.750\nAnd then I can say @in\nmx20mail2.lab.itpro.tv.\n\n312\n00:15:29.750 --> 00:15:32.720\nNow, when somebody tries to\nsend email to don@lab.itpro.tv,\n\n313\n00:15:32.720 --> 00:15:35.330\nit'll find this mx record and\n\n314\n00:15:35.330 --> 00:15:40.120\nit'll see that mail1 is preferred,\nbecause it's got a 10 before it.\n\n315\n00:15:40.120 --> 00:15:44.640\nAnd then mail2 is secondary, it'll only\ngo to mail2 if mail1 is down, right?\n\n316\n00:15:44.640 --> 00:15:48.470\nIf I made them both 10s, which you can do,\nI can make them both 10s, and now,\n\n317\n00:15:48.470 --> 00:15:50.325\nwhat kinda load balance between them,\nright?\n\n318\n00:15:50.325 --> 00:15:51.540\nWe'll round Robin.\n\n319\n00:15:51.540 --> 00:15:53.946\nBut usually you want a primary to backup,\nsomething like that.\n\n320\n00:15:53.946 --> 00:15:56.364\nAnd you can start to create\nthese additional records.\n\n321\n00:15:56.364 --> 00:16:01.962\n&gt;&gt; And, Don, does Bind see these files,\nor that file, rather, automatically?\n\n322\n00:16:01.962 --> 00:16:02.530\nGood question, right.\n\n323\n00:16:02.530 --> 00:16:04.937\nSo I'm defining this file,\nI'm defining all of these records.\n\n324\n00:16:04.937 --> 00:16:06.384\nAnd I guess,\nI haven't really saved it yet, right?\n\n325\n00:16:06.384 --> 00:16:08.035\nSo let's do that.\n\n326\n00:16:08.035 --> 00:16:09.180\n[LAUGH] I'm gonna save it, there.\n\n327\n00:16:09.180 --> 00:16:14.126\nSo I've saved lab.it.pro.tv.dns and\nit's right here in /var/named and\n\n328\n00:16:14.126 --> 00:16:17.238\nBIND knows that that folder belongs to it,\nokay?\n\n329\n00:16:17.238 --> 00:16:19.790\nSo is BIND gonna find this\nautomatically and run it?\n\n330\n00:16:19.790 --> 00:16:20.302\n&gt;&gt; Yeah.\n\n331\n00:16:20.302 --> 00:16:22.939\n&gt;&gt; Well, oddly enough it's not.\n\n332\n00:16:22.939 --> 00:16:25.426\n&gt;&gt; [LAUGH]\n&gt;&gt; So, you'd think it would,\n\n333\n00:16:25.426 --> 00:16:26.720\nthis is it's folder.\n\n334\n00:16:26.720 --> 00:16:30.745\nIf I get in here and I take a look at the\nfolder I've got two problems right now.\n\n335\n00:16:30.745 --> 00:16:33.160\nProblem one are the permissions, right?\n\n336\n00:16:33.160 --> 00:16:36.997\nThis file is owned by root,\nbecause I created it.\n\n337\n00:16:36.997 --> 00:16:39.590\nIt's not owned by nameD,\nlike it's supposed to.\n\n338\n00:16:39.590 --> 00:16:41.300\nI mentioned permissions\nin the last episode,\n\n339\n00:16:41.300 --> 00:16:43.390\nhow this is a problem\nthat we can run into.\n\n340\n00:16:43.390 --> 00:16:45.670\nSo I'm gonna need to fix\nthose permissions, all right?\n\n341\n00:16:45.670 --> 00:16:47.540\nSo that's problem number one.\n\n342\n00:16:47.540 --> 00:16:54.056\nProblem number two is, I need to tell\nBIND that this zone exists, right?\n\n343\n00:16:54.056 --> 00:17:00.365\nIn that zone, I never actually told it\nthat the domain was called lab@itpro.tv.\n\n344\n00:17:00.365 --> 00:17:01.934\nI never told her that, right?\n\n345\n00:17:01.934 --> 00:17:03.922\nI put that in the file name, but\nit doesn't care about the file name.\n\n346\n00:17:03.922 --> 00:17:07.570\nThe file name could be bob.txt,\nit doesn't care, right?\n\n347\n00:17:07.570 --> 00:17:11.915\nSo somewhere I need to tell it,\nwhat the name of the domain is, and\n\n348\n00:17:11.915 --> 00:17:13.740\nthen point it to this file.\n\n349\n00:17:13.740 --> 00:17:16.110\nSo it's missing that little\npiece of information.\n\n350\n00:17:16.110 --> 00:17:19.170\nAnd that's something that we take\ncare of in the nameD.com file.\n\n351\n00:17:19.170 --> 00:17:21.610\nSo I'm gonna edit /etc/named.com.\n\n352\n00:17:21.610 --> 00:17:25.470\nI'm gonna go into that file, and\n\n353\n00:17:25.470 --> 00:17:28.980\nyou'll see options and\nmy acl that I made in the last episode.\n\n354\n00:17:28.980 --> 00:17:32.490\nAnd right down here they've got\nan example of a zone, right?\n\n355\n00:17:32.490 --> 00:17:34.480\nThis zone is dot.\n\n356\n00:17:34.480 --> 00:17:36.620\nThat's the root zone.\n\n357\n00:17:36.620 --> 00:17:39.340\nThe root zone, the root hint server\nthat's out there on the internet.\n\n358\n00:17:39.340 --> 00:17:40.610\nSee how it says type hint.\n\n359\n00:17:40.610 --> 00:17:45.120\nThat's so we're able to go out there and\ndo those root hint look ups.\n\n360\n00:17:45.120 --> 00:17:48.780\nBut I'm gonna come in here and\ninsert another zone.\n\n361\n00:17:48.780 --> 00:17:50.601\nI'm gonna say zone.\n\n362\n00:17:50.601 --> 00:17:55.649\nAnd then in quotes,\nI'll add \"lab.itpro.tv\", right?\n\n363\n00:17:55.649 --> 00:17:57.256\nSo I'm telling it the zone that exists,\n\n364\n00:17:57.256 --> 00:18:00.310\nand oddly enough, you don't have to\nput the trailing dot on this one.\n\n365\n00:18:00.310 --> 00:18:03.360\nThat's the domain that\nI'm gonna be hosting and\n\n366\n00:18:03.360 --> 00:18:06.000\nthat it is a Internet domain, IN.\n\n367\n00:18:06.000 --> 00:18:09.010\nAnd then, I need to tell it the type.\n\n368\n00:18:09.010 --> 00:18:13.380\nSo I'll do a curly brace, type master.\n\n369\n00:18:13.380 --> 00:18:15.580\nI´m the one that controls that domain.\n\n370\n00:18:15.580 --> 00:18:17.180\nI might have secondary servers, right?\n\n371\n00:18:17.180 --> 00:18:19.220\nSlave servers and so\nthey would have a different entry here.\n\n372\n00:18:19.220 --> 00:18:20.232\nBut this one´s the master.\n\n373\n00:18:20.232 --> 00:18:25.589\nAnd then I´m getting the data\nfrom a file and then in quotes,\n\n374\n00:18:25.589 --> 00:18:30.422\nI need to tell that file\nis \"lab.itpro.tv.dns\" or\n\n375\n00:18:30.422 --> 00:18:33.510\nwhatever name you gave it, okay.\n\n376\n00:18:33.510 --> 00:18:38.210\nThat's how it knows to find that file and\nwhat domain name it is.\n\n377\n00:18:38.210 --> 00:18:43.410\nThat, \"at\" alias that I kept using, how\ndoes it know that \"at\" is lab@itpro.tv?\n\n378\n00:18:43.410 --> 00:18:46.410\nIt's from this line, right here,\n\"at\" is an alias for\n\n379\n00:18:46.410 --> 00:18:48.510\nwhatever I put right here, okay.\n\n380\n00:18:48.510 --> 00:18:50.620\nAnd then I just need to\nclose this line out.\n\n381\n00:18:50.620 --> 00:18:57.250\nI need to do a semi-colon and a close,\nlet's see, I close curly brace.\n\n382\n00:18:57.250 --> 00:19:00.450\nAnd one more semi-colon to\nclose that entry out, right?\n\n383\n00:19:00.450 --> 00:19:03.370\nSo there's my zone definition, okay?\n\n384\n00:19:03.370 --> 00:19:05.440\nSome people like to neaten\nthis up a little more and\n\n385\n00:19:05.440 --> 00:19:06.860\nspread it out over a couple of lines.\n\n386\n00:19:06.860 --> 00:19:09.570\nYou can certainly do that, but\nit all fits neatly on one line,\n\n387\n00:19:09.570 --> 00:19:11.201\nthat's what's defining the zone.\n\n388\n00:19:11.201 --> 00:19:14.600\nSo now BIND is gonna be able to\nfind it and know to start that up.\n\n389\n00:19:14.600 --> 00:19:15.870\nSo let me just get out of this and\nsave it.\n\n390\n00:19:17.050 --> 00:19:19.082\nAnd there we go.\n\n391\n00:19:19.082 --> 00:19:21.840\nAll right, I guess I never did\nfix those permissions, right?\n\n392\n00:19:21.840 --> 00:19:23.380\nSo I should probably fix those.\n\n393\n00:19:23.380 --> 00:19:26.030\nAll I really need to do is change\nthe group membership on that so\n\n394\n00:19:26.030 --> 00:19:27.510\nthat BIND will be able to read the file.\n\n395\n00:19:27.510 --> 00:19:29.210\nSo I'm going to do a quick CHGRP.\n\n396\n00:19:30.680 --> 00:19:32.070\nNameD.\n\n397\n00:19:32.070 --> 00:19:32.930\nFour slash.\n\n398\n00:19:32.930 --> 00:19:34.280\nActually, I'm already in the folder.\n\n399\n00:19:34.280 --> 00:19:38.500\nSo I can just point it to lab.ITVPro.TV.\n\n400\n00:19:38.500 --> 00:19:41.450\nAnd once I've done that, so\nI did CHGRP, and then nameD.\n\n401\n00:19:41.450 --> 00:19:43.324\nI need to change the group to nameD.\n\n402\n00:19:43.324 --> 00:19:48.305\nAnd now when I look in there, I'll see\nthat it's got the same user and group.\n\n403\n00:19:48.305 --> 00:19:49.565\nThe permissions are a little different.\n\n404\n00:19:49.565 --> 00:19:52.144\nSee how it's got read permission for\neveryone and the other files don't.\n\n405\n00:19:52.144 --> 00:19:54.805\nSo I probably want to tweak that,\nbut it's not the end of the world.\n\n406\n00:19:54.805 --> 00:19:57.043\nPermissions are something you need to\nkeep a handle on though in this folder.\n\n407\n00:19:57.043 --> 00:19:59.910\nIt's easy to get them mixed up.\n\n408\n00:19:59.910 --> 00:20:01.940\n&gt;&gt; Now Donnie, I hate to be a eeyore, but\n\n409\n00:20:01.940 --> 00:20:03.890\nwe could have made typos\n&gt;&gt; Yes.\n\n410\n00:20:03.890 --> 00:20:05.506\n&gt;&gt; Is there another utility to check for\nthat?\n\n411\n00:20:05.506 --> 00:20:07.625\n&gt;&gt; All right,\nI'm certainly not the best typist and\n\n412\n00:20:07.625 --> 00:20:09.400\nI am guilty of leaving out semi-colons.\n\n413\n00:20:09.400 --> 00:20:10.101\n&gt;&gt; Yeah.\nIn the last\n\n414\n00:20:10.101 --> 00:20:13.340\nepisode i should you guys how we\ninstall the BIND utils package.\n\n415\n00:20:13.340 --> 00:20:17.768\nIt gave the named-checkcof\nutility where we can check\n\n416\n00:20:17.768 --> 00:20:23.169\nthe configuration file which\njust looked at /etc/named.com.\n\n417\n00:20:23.169 --> 00:20:27.275\nWell, there's another utility\nwhich is named-checkzone that lets\n\n418\n00:20:27.275 --> 00:20:30.240\nyou check your zone files and\nlook for typos.\n\n419\n00:20:30.240 --> 00:20:33.899\nSo, I can come in and\nI can say named-checkzone.\n\n420\n00:20:35.230 --> 00:20:39.270\nAnd I can tell it I'm checking\nthe lab.itpro.tv domain\n\n421\n00:20:39.270 --> 00:20:41.080\ncuz I had to tell it a domain name.\n\n422\n00:20:41.080 --> 00:20:42.990\nAnd then I can tell it the file to check.\n\n423\n00:20:42.990 --> 00:20:47.440\nI'll say /var/named/ and\nthen whatever you called the file.\n\n424\n00:20:47.440 --> 00:20:50.430\nAll right, so\nthat's what I'm gonna point it at.\n\n425\n00:20:50.430 --> 00:20:53.050\nAnd it's gonna check and I got an error.\n\n426\n00:20:53.050 --> 00:20:55.840\nOkay, so\nI've got an error right on line one,\n\n427\n00:20:55.840 --> 00:20:59.240\nno TTL specified using start of\nauthority minimum TTL instead.\n\n428\n00:20:59.240 --> 00:21:02.026\nSo apparently I have an error\nin my start of authority and\n\n429\n00:21:02.026 --> 00:21:04.529\nthen it's giving me an entry\nabout my DNS server.\n\n430\n00:21:04.529 --> 00:21:08.770\nDNS1.lab@itprotv.\n\n431\n00:21:08.770 --> 00:21:11.590\nI did a double domain on that entry so\nit's doubled it up and\n\n432\n00:21:11.590 --> 00:21:12.730\nit's not finding our records.\n\n433\n00:21:12.730 --> 00:21:13.880\nSo I need to fix that, right?\n\n434\n00:21:13.880 --> 00:21:15.916\nSo I made a mistake and\nit's telling me it's not loaded.\n\n435\n00:21:15.916 --> 00:21:17.780\nIt's good that I noticed that now\n&gt;&gt; Yeah.\n\n436\n00:21:17.780 --> 00:21:19.160\n&gt;&gt; Before I reload the server.\n\n437\n00:21:19.160 --> 00:21:23.000\nSo let me go back into that file and\nfind my mistake.\n\n438\n00:21:23.000 --> 00:21:28.490\nSo, when I defined an entry for\nthat DNS server, right?\n\n439\n00:21:28.490 --> 00:21:32.020\nSo when I set my name server here,\nI put the domain after it.\n\n440\n00:21:32.020 --> 00:21:36.610\nAnd I didn't put a trailing\ndot on the end, so it assumed\n\n441\n00:21:36.610 --> 00:21:40.790\nthat that was just a host name, and\nthen it stuck the domain on the end of it.\n\n442\n00:21:40.790 --> 00:21:44.475\nSo I can fix this two ways,\nI could just leave off the domain, and\n\n443\n00:21:44.475 --> 00:21:48.379\nsay that the name server's DNS1,\nand then it would've found it.\n\n444\n00:21:48.379 --> 00:21:51.422\nOr I can say lab.itpro.tv.,\nlike that, okay?\n\n445\n00:21:51.422 --> 00:21:56.280\nAnd then I didn't specify a minimum TTL,\nbut it will actually get over that.\n\n446\n00:21:56.280 --> 00:22:00.600\nSo let me get that, and we'll just\nrerun that check, and there we go.\n\n447\n00:22:00.600 --> 00:22:04.520\nSo it's just telling me that I\ndidn't provide it a time to live\n\n448\n00:22:04.520 --> 00:22:06.610\non my specifications.\n\n449\n00:22:06.610 --> 00:22:07.480\n&gt;&gt; A time to live.\n\n450\n00:22:07.480 --> 00:22:10.760\n&gt;&gt; And we can certainly add\nthat one back in if we need it.\n\n451\n00:22:10.760 --> 00:22:13.260\nLet me do that, just for\ncompleteness here.\n\n452\n00:22:13.260 --> 00:22:17.270\nA time to live is how long I'll allow\nother servers to cache my records, right?\n\n453\n00:22:17.270 --> 00:22:19.030\nSo if you wanted to find a time to live,\n\n454\n00:22:19.030 --> 00:22:20.540\nit's usually done right\nat the top of the file.\n\n455\n00:22:20.540 --> 00:22:23.849\nSo you can come in and\nyou can say, dollar sign TTL.\n\n456\n00:22:23.849 --> 00:22:27.306\nAnd then the maximum time you want\nother people to cache your records.\n\n457\n00:22:27.306 --> 00:22:28.970\nMaybe you want it to be 15 minutes.\n\n458\n00:22:28.970 --> 00:22:32.438\nMaybe you want it to be 24 hours,\n48 hours, right?\n\n459\n00:22:32.438 --> 00:22:34.150\nI'll do 24 hours.\n\n460\n00:22:34.150 --> 00:22:35.760\nSo I'll say 86,400 seconds.\n\n461\n00:22:35.760 --> 00:22:37.790\nThat's the time to live, right?\n\n462\n00:22:37.790 --> 00:22:39.020\nSo that's just defined right there.\n\n463\n00:22:39.020 --> 00:22:41.450\nAnd that'll make it happy there too.\n\n464\n00:22:41.450 --> 00:22:46.100\nAnd now when I run that check, I get\nthat it loaded serial number 1OK, right.\n\n465\n00:22:46.100 --> 00:22:47.550\nMy zone checked out.\n\n466\n00:22:47.550 --> 00:22:49.230\n&gt;&gt; Very cool.\n&gt;&gt; But I didn't just modify\n\n467\n00:22:49.230 --> 00:22:50.015\nthe zone file did I?\n\n468\n00:22:50.015 --> 00:22:54.640\nI also modified /etc/named.com\nto add the zone to it.\n\n469\n00:22:54.640 --> 00:22:56.290\nSo I could've made a mistake there.\n\n470\n00:22:56.290 --> 00:23:00.900\nSo it's important to run\nnamed-checkcom as well,\n\n471\n00:23:00.900 --> 00:23:02.740\nto make sure we didn't mess up that line.\n\n472\n00:23:02.740 --> 00:23:05.110\nBut assuming that's all good,\nnow our files are clean and\n\n473\n00:23:05.110 --> 00:23:06.610\nclear, and we're good to go.\n\n474\n00:23:06.610 --> 00:23:11.570\nSo now, the forward lookup zone is\ndone and it's ready to be loaded.\n\n475\n00:23:11.570 --> 00:23:15.460\n&gt;&gt; So is it time to restart BIND,\nI mean we've already done that as well or?\n\n476\n00:23:15.460 --> 00:23:17.582\n&gt;&gt; We haven't restarted BIND,\nI could certainly do that right now.\n\n477\n00:23:17.582 --> 00:23:21.236\nAnd if we do a system CTL because I need\nto restart BIND to load those files.\n\n478\n00:23:21.236 --> 00:23:22.165\n&gt;&gt; Right, right, right.\n\n479\n00:23:22.165 --> 00:23:23.828\n&gt;&gt; It doesn't know the file is there yet.\n\n480\n00:23:23.828 --> 00:23:29.090\nSo, I can say system CTL restart,\nnamed.service.\n\n481\n00:23:29.090 --> 00:23:31.852\nAnd it'll restart it and\nnow I should be able to do lookups.\n\n482\n00:23:31.852 --> 00:23:34.598\nIf I were to do a NS lookup or a dig or\n\n483\n00:23:34.598 --> 00:23:38.623\nwhatever utilities I wanna\ndo a lookup with, and\n\n484\n00:23:38.623 --> 00:23:43.731\nI wanna look up,\nwe'll do webserve01.lap.itpro.tv,\n\n485\n00:23:43.731 --> 00:23:47.585\nand I wanna bounce that off of myself,\nright?\n\n486\n00:23:47.585 --> 00:23:49.249\nI'm testing off my own server.\n\n487\n00:23:49.249 --> 00:23:51.781\nI run the lookup, and\nI get a response back, right?\n\n488\n00:23:51.781 --> 00:23:57.750\nIt told me that webserver.01.lab.itpro.tv\nis in 172.16.0.101, right?\n\n489\n00:23:57.750 --> 00:24:00.360\nThe zone worked,\nI just resolved the name to an IP.\n\n490\n00:24:00.360 --> 00:24:04.320\nAnd I could continue testing with things\nlike, where the mail servers, mail one and\n\n491\n00:24:04.320 --> 00:24:06.900\nmail two, I could look them up.\n\n492\n00:24:06.900 --> 00:24:12.200\nWe could change our type, like if I do\nan NS lookup and I say type equals MX,\n\n493\n00:24:12.200 --> 00:24:17.480\nif I say set type equals MX,\nthere we go, and I look up,\n\n494\n00:24:17.480 --> 00:24:22.555\nI need to say server 127001 and\nthen I can say\n\n495\n00:24:22.555 --> 00:24:28.430\nlab.itpro.tv, and there it goes and\ngets my mail exchanges, right.\n\n496\n00:24:28.430 --> 00:24:31.520\nSo I see all those records are working,\nI'm getting the information back,\n\n497\n00:24:31.520 --> 00:24:34.070\nand my forward lookup zone is good.\n\n498\n00:24:34.070 --> 00:24:38.390\n&gt;&gt; Well forward lookup, that was great,\nwhat about reverse lookup?\n\n499\n00:24:38.390 --> 00:24:41.580\n&gt;&gt; All right,\nreverse lookup zones are much the same.\n\n500\n00:24:41.580 --> 00:24:43.352\n&gt;&gt; But we might be running out of time.\n\n501\n00:24:43.352 --> 00:24:46.400\n&gt;&gt; [LAUGH] We are running out of time, but\nI spent too long on forward lookup zones.\n\n502\n00:24:46.400 --> 00:24:50.070\nAll right, reverse lookup zones\nare much the same but reversed.\n\n503\n00:24:50.070 --> 00:24:51.394\nBut there are some weird\nlittle quirks to them.\n\n504\n00:24:51.394 --> 00:24:53.540\nSo I don't wanna just say something\ndumb like, just reverse it, and\n\n505\n00:24:53.540 --> 00:24:54.100\nend the episode.\n\n506\n00:24:54.100 --> 00:24:55.024\n&gt;&gt; [LAUGH]\n&gt;&gt; So-\n\n507\n00:24:55.024 --> 00:24:56.224\n&gt;&gt; Just turn it around and you're all set.\n\n508\n00:24:56.224 --> 00:24:56.877\nGood bye.\n\n509\n00:24:56.877 --> 00:24:58.150\n&gt;&gt; So let's do this Zack.\n\n510\n00:24:58.150 --> 00:24:59.710\n&gt;&gt; Yeah.\n&gt;&gt; Let's break up into a part two.\n\n511\n00:24:59.710 --> 00:25:00.685\n&gt;&gt; Okay.\n&gt;&gt; And in part two,\n\n512\n00:25:00.685 --> 00:25:04.070\nI wanna show you guys how to\ncreate those reverse lookup zones.\n\n513\n00:25:04.070 --> 00:25:05.564\nIt's very, very similar.\n\n514\n00:25:05.564 --> 00:25:08.420\nBut there are some subtle differences in\nthere that will make things a little more\n\n515\n00:25:08.420 --> 00:25:08.970\nchallenging.\n\n516\n00:25:08.970 --> 00:25:11.187\nSo I definitely wanna show you those,\nthen we'll get them loaded back in.\n\n517\n00:25:11.187 --> 00:25:14.066\nAnd I wanna cover just a little more\non those file permissions, just make\n\n518\n00:25:14.066 --> 00:25:17.038\nsure everything's set right before we\nturn this thing loose on the wild and\n\n519\n00:25:17.038 --> 00:25:18.420\nwe have a functioning DNS server.\n\n520\n00:25:18.420 --> 00:25:21.840\n&gt;&gt; Awesome job, Don, as usual,\nand no stone unturned.\n\n521\n00:25:21.840 --> 00:25:24.300\nConfiguring zones and records.\n\n522\n00:25:24.300 --> 00:25:26.650\nAny last words before we move on?\n\n523\n00:25:26.650 --> 00:25:30.330\n&gt;&gt; Do not forget to run those\nsyntax checking utilities.\n\n524\n00:25:30.330 --> 00:25:31.750\nThey will save you a lot of time.\n\n525\n00:25:31.750 --> 00:25:35.020\nThey will let you spot an error\nbefore you load it into BIND,\n\n526\n00:25:35.020 --> 00:25:36.560\nand it helps you avoid an outage.\n\n527\n00:25:36.560 --> 00:25:38.320\nSo definitely something\nyou wanna take a look at.\n\n528\n00:25:38.320 --> 00:25:41.340\nThe other thing is,\nall these config files are just text.\n\n529\n00:25:41.340 --> 00:25:42.710\nReally easy to back them up.\n\n530\n00:25:42.710 --> 00:25:46.110\nSo any time you're making a change, you\ncan back up the file before you change it.\n\n531\n00:25:46.110 --> 00:25:47.760\nAnd it's just a text file,\nyou can copy it right back.\n\n532\n00:25:47.760 --> 00:25:49.318\nAnd if you ever need to\nbring up a new server,\n\n533\n00:25:49.318 --> 00:25:50.974\nyou just copy the files\nover to the new server.\n\n534\n00:25:50.974 --> 00:25:52.223\nJust watch out for\nthose permissions, right?\n\n535\n00:25:52.223 --> 00:25:54.530\nOtherwise, pretty straightforward system.\n\n536\n00:25:54.530 --> 00:25:55.502\n&gt;&gt; Backup is important.\n\n537\n00:25:55.502 --> 00:26:00.352\nConfiguring zones and records, and this\nis becoming a Linux server administrator,\n\n538\n00:26:00.352 --> 00:26:02.729\nthis is part one of the zones and records.\n\n539\n00:26:02.729 --> 00:26:04.350\n&gt;&gt; [LAUGH]\n&gt;&gt; Part two's coming up,\n\n540\n00:26:04.350 --> 00:26:07.830\nand there's a lot of video content in\nbecoming a Linux server administrator.\n\n541\n00:26:07.830 --> 00:26:09.030\nMake sure you watch all of them.\n\n542\n00:26:09.030 --> 00:26:09.930\nYou'll be so glad you did.\n\n543\n00:26:09.930 --> 00:26:12.060\nAnd thanks for watching ITPRO.TV.\n\n544\n00:26:12.060 --> 00:26:15.310\nRemember a good IT pro is always learning.\n\n545\n00:26:15.310 --> 00:26:16.290\nI'm Zach Memos.\n\n546\n00:26:16.290 --> 00:26:17.030\n&gt;&gt; And I'm Don Pezet.\n\n547\n00:26:17.030 --> 00:26:19.254\n&gt;&gt; And we'll see you very soon.\n\n548\n00:26:19.254 --> 00:26:24.793\n[MUSIC]\n\n549\n00:26:24.793 --> 00:26:28.463\n&gt;&gt; Thank you for watching ITPROTV.\n\n",
          "vimeoId": "226903697"
        },
        {
          "description": "Don and Zach continue looking at Configuring Zones & Records, Reverse Lookup Records, creating Core Records, SOA, NS, Creating PTR Records, adding Zone to BIND, verify Syntax, Cleanup File Permissions, and restarting BIND.",
          "length": "929",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-2-2-configuring_zones_and_records_pt_2-072117-PGM.00_15_13_23.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-2-2-configuring_zones_and_records_pt_2-072117-PGM.00_15_13_23.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-4-2-2-configuring_zones_and_records_pt_2-072117-PGM.00_15_13_23.Still001-sm.jpg",
          "title": "Configuring Zones and Records Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.190 --> 00:00:01.284\nWelcome to ITPro TV.\n\n2\n00:00:01.284 --> 00:00:05.021\nI'm your host [CROSSTALK]\n\n3\n00:00:05.021 --> 00:00:08.283\n[MUSIC]\n\n4\n00:00:08.283 --> 00:00:11.912\n&gt;&gt; You're watching ITPro TV.\n\n5\n00:00:11.912 --> 00:00:14.449\n&gt;&gt; Hello again, thank you for\nwatching ITPro TV,\n\n6\n00:00:14.449 --> 00:00:16.610\nhelping you learn wherever you go.\n\n7\n00:00:16.610 --> 00:00:17.910\nI'm your host Zach Memos,\n\n8\n00:00:17.910 --> 00:00:21.730\nas we continue on with becoming\na Linux server administrator.\n\n9\n00:00:21.730 --> 00:00:24.620\nConfiguring zones and records, part two.\n\n10\n00:00:24.620 --> 00:00:27.420\nAnd bringing us all the information\nwe need is our IT pro,\n\n11\n00:00:27.420 --> 00:00:29.600\nresident good guy, Don Pezet.\n\n12\n00:00:29.600 --> 00:00:31.220\nDon good to see you again, sir.\n\n13\n00:00:31.220 --> 00:00:34.545\n&gt;&gt; Glad to be back, ready for\nrecords and zones part two.\n\n14\n00:00:34.545 --> 00:00:38.078\nThe zones strike back,\nattack of the zones?\n\n15\n00:00:38.078 --> 00:00:40.397\nSee I think I've got this worked out.\n\n16\n00:00:40.397 --> 00:00:41.385\n[LAUGH]\n&gt;&gt; Revenge of the zones.\n\n17\n00:00:41.385 --> 00:00:43.585\n&gt;&gt; There we go.\nSo we are jumping right back in here.\n\n18\n00:00:43.585 --> 00:00:47.105\nAnd in the last episode, we got a chance\nto see forward look up zones and\n\n19\n00:00:47.105 --> 00:00:49.735\nI wanted to make sure that I showed\nreverse lookup zones that aren't all\n\n20\n00:00:49.735 --> 00:00:51.865\nthat spectacular, but are still important.\n\n21\n00:00:51.865 --> 00:00:55.125\nI want to just make sure that I can\nspend the right amount of time on them.\n\n22\n00:00:55.125 --> 00:00:57.895\nSo we're gonna take a look at\nthose reverse zones right now and\n\n23\n00:00:57.895 --> 00:00:58.990\nget that fired up.\n\n24\n00:00:58.990 --> 00:01:02.685\nSo instead of doing the whole name to\nan IP we're going to go IP to a name and\n\n25\n00:01:02.685 --> 00:01:05.730\nget things put right into place\nright here in this episode.\n\n26\n00:01:05.730 --> 00:01:09.370\n&gt;&gt; That's right because the forward\nlook up that wasn't so bad, but\n\n27\n00:01:09.370 --> 00:01:11.510\nnow we're going to be looking\nat the reverse lookup.\n\n28\n00:01:11.510 --> 00:01:13.130\nIs that more complicated?\n\n29\n00:01:13.130 --> 00:01:15.741\n&gt;&gt; It's just a little,\nit's just a hair more complicated.\n\n30\n00:01:15.741 --> 00:01:16.750\n&gt;&gt; Okay.\n\n31\n00:01:16.750 --> 00:01:21.190\n&gt;&gt; Mostly what's so weird about it is that\nyour working with IPs instead of names.\n\n32\n00:01:21.190 --> 00:01:22.384\nSo that's what kind of causes the problem.\n\n33\n00:01:22.384 --> 00:01:28.200\nSo let's say for example my server\nis on the 172.16.0 network right.\n\n34\n00:01:28.200 --> 00:01:34.461\nI use this slash 24 subnet here and I want\nto create a reverse lookup zone for it.\n\n35\n00:01:34.461 --> 00:01:35.729\nSo when you go and\n\n36\n00:01:35.729 --> 00:01:41.655\ngive that a zone name theres a very\nspecific format that was assigned to that.\n\n37\n00:01:41.655 --> 00:01:43.836\nAnd remember a lot of the stuff\nwas designed a long time ago.\n\n38\n00:01:43.836 --> 00:01:47.296\nThat the Internet was really\na research project by DARPA,\n\n39\n00:01:47.296 --> 00:01:50.420\none of the United States\ngovernment projects.\n\n40\n00:01:50.420 --> 00:01:54.106\nAnd so DARPA actually assigned\nthe formats for a lot of this stuff, and\n\n41\n00:01:54.106 --> 00:01:56.744\nreverse lookup zones\nfollow that very strictly.\n\n42\n00:01:56.744 --> 00:01:58.890\nSo when we go in and\nassign a record like this,\n\n43\n00:01:58.890 --> 00:02:02.226\nthe naming of it gets really kinda quirky,\nthat's the hardest part.\n\n44\n00:02:02.226 --> 00:02:06.578\nSo one thing though is that the zone file\nwe create is very similar to a forward\n\n45\n00:02:06.578 --> 00:02:07.400\nlookup zone.\n\n46\n00:02:07.400 --> 00:02:10.063\nSo for example, in the last episode,\n\n47\n00:02:10.063 --> 00:02:14.180\nwe created a forward lookup zone for\nlab.itprotv.dns.\n\n48\n00:02:14.180 --> 00:02:16.910\nAnd most of the records that we\nput in here were pretty standard.\n\n49\n00:02:16.910 --> 00:02:20.430\nI needed a time to live,\nI needed an SOA, and\n\n50\n00:02:20.430 --> 00:02:23.580\nI needed at least one name server, right?\n\n51\n00:02:23.580 --> 00:02:27.040\nWell, when you create a reverse lookup\nzone, they need those same things.\n\n52\n00:02:27.040 --> 00:02:32.910\nWe need a time to live, an SOA,\nand a DNS server, right?\n\n53\n00:02:32.910 --> 00:02:34.960\nAfter that though,\nis where things get weird.\n\n54\n00:02:34.960 --> 00:02:36.140\nAll these other records here,\n\n55\n00:02:36.140 --> 00:02:41.130\nare not really in use, as far as or\nreverse lookup is called.\n\n56\n00:02:41.130 --> 00:02:44.250\nSo, what I'm gonna do is I'm\ngonna cheat just a little bit and\n\n57\n00:02:44.250 --> 00:02:46.690\nI'm just gonna copy my four lookup zones.\n\n58\n00:02:46.690 --> 00:02:49.890\nSo I'm gonna take that, that four lookup\nzone that I made in the last one, and\n\n59\n00:02:49.890 --> 00:02:52.810\nI'm gonna copy that to a file that\nI'll use for a reverse lookup zone.\n\n60\n00:02:52.810 --> 00:02:56.190\nThat way I've already got the SOA\nrecords and other things in place.\n\n61\n00:02:56.190 --> 00:02:57.640\nNow the file name, though.\n\n62\n00:02:57.640 --> 00:03:01.780\nI'm gonna give mine a file name and this\nis gonna seem a little weird at first.\n\n63\n00:03:01.780 --> 00:03:06.339\nBut I'm gonna call it\n\n64\n00:03:06.339 --> 00:03:14.360\n0.16.172.in/addr.arpa.\n\n65\n00:03:14.360 --> 00:03:16.700\nOkay now that's a strange name.\n\n66\n00:03:16.700 --> 00:03:17.740\n&gt;&gt; It's a strange name.\n\n67\n00:03:17.740 --> 00:03:22.476\n&gt;&gt; But what it is is that DARPA,\nthey assigned this format so\n\n68\n00:03:22.476 --> 00:03:27.014\nthat arpa right there at the end,\nso that's them, and\n\n69\n00:03:27.014 --> 00:03:29.792\nthen this is a Internet address.\n\n70\n00:03:29.792 --> 00:03:31.993\nAnd then the Internet\naddress is written backwards.\n\n71\n00:03:31.993 --> 00:03:36.946\nSo instead of 172.16.0 it's 0.16.172.\n\n72\n00:03:36.946 --> 00:03:41.390\nAnd the reason is,\nremember here where I just put mail1?\n\n73\n00:03:41.390 --> 00:03:44.970\nAnd then it stuck lab.ITPro.TV\non the end of it, right?\n\n74\n00:03:44.970 --> 00:03:48.100\nSo it's mail1.lab.ITPro.TV it makes sense.\n\n75\n00:03:48.100 --> 00:03:51.932\nWhile here, I can stick a number\non the left side, like 5 and\n\n76\n00:03:51.932 --> 00:03:54.497\nit would stick 0 to 16.172 on it.\n\n77\n00:03:54.497 --> 00:03:58.267\nAnd if you flip it around,\nthat would be 172.16.0.5, right?\n\n78\n00:03:58.267 --> 00:03:59.021\nSo it makes sense.\n\n79\n00:03:59.021 --> 00:04:03.700\nSo it used the same lookup mechanism from\nthe four lookup zones to apply to IPs.\n\n80\n00:04:03.700 --> 00:04:06.400\nBut in order to do it,\nyou had to put it backwards.\n\n81\n00:04:06.400 --> 00:04:09.330\nSo it seems really weird but\nit does need to be this way.\n\n82\n00:04:09.330 --> 00:04:10.370\nIt needs to be backwards.\n\n83\n00:04:10.370 --> 00:04:12.010\nNow I'm showing you here in the file name,\n\n84\n00:04:12.010 --> 00:04:14.550\nand the reality is the file\nname can be whatever you want.\n\n85\n00:04:14.550 --> 00:04:17.780\nI could call this Steve.txt,\nand it would work fine,\n\n86\n00:04:17.780 --> 00:04:21.590\nbut I like to call it by the actual zone\nname so I can remember what it is and\n\n87\n00:04:21.590 --> 00:04:23.670\nthen I just stick a .dns on the end,\nso that's what I'm gonna do.\n\n88\n00:04:23.670 --> 00:04:24.560\nI'm gonna copy my for\n\n89\n00:04:24.560 --> 00:04:28.590\nlook up zone into that and\nthen I'm gonna edit that file, right?\n\n90\n00:04:29.700 --> 00:04:33.710\nAnd when I edit that file,\nthere's a lot in here that I don't need so\n\n91\n00:04:33.710 --> 00:04:37.620\nI'm going to just wipe out all\nthese extra lines here, okay.\n\n92\n00:04:37.620 --> 00:04:39.660\nThese are the core records that we need,\nright.\n\n93\n00:04:39.660 --> 00:04:41.700\nTechnically I don't even\nneed all three of these.\n\n94\n00:04:41.700 --> 00:04:44.330\nI need the SOA and the DNS Server, right?\n\n95\n00:04:44.330 --> 00:04:45.190\nThe name server.\n\n96\n00:04:45.190 --> 00:04:47.071\nThat's it,\nthe time to live is optional, but\n\n97\n00:04:47.071 --> 00:04:51.010\nwe've got it in there cuz that clears up\none of the errors with the config checker.\n\n98\n00:04:51.010 --> 00:04:52.920\nSo after that,\n\n99\n00:04:52.920 --> 00:04:58.790\nnow I can start to add in my reverse look\nup short map's an IP to a name, right.\n\n100\n00:04:58.790 --> 00:05:01.840\nSo for example we have the mail servers.\n\n101\n00:05:01.840 --> 00:05:05.814\nThe mail servers that I added in\nwhose IPs I can't remember now.\n\n102\n00:05:05.814 --> 00:05:09.670\nWhatever, I probably should've paid\nmore attention to that, let me find out.\n\n103\n00:05:09.670 --> 00:05:15.410\nThe mail servers which were mail1 and\nmail2 which were 102 and 103.\n\n104\n00:05:15.410 --> 00:05:18.590\nOkay so I wanna create reverse\nlook up records for those guys so\n\n105\n00:05:18.590 --> 00:05:22.170\nthat we'll be able to look\nthem up based on their IP.\n\n106\n00:05:22.170 --> 00:05:28.560\nSo all I would do is come in here and\nI would say 101 is a Internet record.\n\n107\n00:05:28.560 --> 00:05:32.500\nIt is a ptr, a pointer record.\n\n108\n00:05:32.500 --> 00:05:33.790\nA pointer is reverse, right?\n\n109\n00:05:33.790 --> 00:05:37.830\nAn IP to name instead of name to IP and\nthen I would say who it points to.\n\n110\n00:05:37.830 --> 00:05:44.891\nAnd this one points to\nmail1.lab.itpro.tv.don, all right?\n\n111\n00:05:44.891 --> 00:05:46.530\nOr, I'm only with 102.\n\n112\n00:05:46.530 --> 00:05:48.251\nThey were with 102 and 103.\n\n113\n00:05:48.251 --> 00:05:51.470\nThis is the hardest part is just\nremembering what the IPs are.\n\n114\n00:05:51.470 --> 00:05:59.000\nSo then the next one 103, is a PTR that\npointing to mail2.lab.itpro.tv., right.\n\n115\n00:05:59.000 --> 00:06:02.160\nOr if I wanted to create one for the web\nserver, I think the web server was 101.\n\n116\n00:06:02.160 --> 00:06:10.820\nSo I could say 101 is a pointer\nto webserv01.lab.itprotv., right?\n\n117\n00:06:10.820 --> 00:06:14.830\nEach entry in there,\nnot really that difficult to do, right?\n\n118\n00:06:14.830 --> 00:06:21.060\nYou put the last octet of that IP address\nand then the name that it points to.\n\n119\n00:06:21.060 --> 00:06:26.830\nAnd it will know that it's 172.16.0\nfrom the actual zone name, right?\n\n120\n00:06:26.830 --> 00:06:29.200\nWhich is exactly how\nforward look up zones work.\n\n121\n00:06:29.200 --> 00:06:31.690\nThis really works the same\nway as forward look up zone.\n\n122\n00:06:31.690 --> 00:06:34.330\nWe're just doing PTR records\ninstead of A records.\n\n123\n00:06:34.330 --> 00:06:36.180\nAnd they flip things around.\n\n124\n00:06:36.180 --> 00:06:39.300\nSo it looks confusing and\nit looks intimidating, but\n\n125\n00:06:39.300 --> 00:06:40.600\nit's really not that bad.\n\n126\n00:06:40.600 --> 00:06:45.270\nOnce you get everything defined properly,\nit's really not that bad.\n\n127\n00:06:45.270 --> 00:06:50.247\nSo at this point I've created that\nreverse lookup zone and now I just need\n\n128\n00:06:50.247 --> 00:06:54.996\nto make sure that nameD is aware of it and\nis actually gonna load this.\n\n129\n00:06:54.996 --> 00:06:58.471\nAll right, so\nlet me get out of this config.\n\n130\n00:06:58.471 --> 00:07:01.260\nAnd that's the zone file.\n\n131\n00:07:01.260 --> 00:07:04.950\nI'm going to copy that file\nname to save me a little bit of\n\n132\n00:07:04.950 --> 00:07:07.370\neffort here in a minute.\n\n133\n00:07:07.370 --> 00:07:13.004\nAnd then I'm going to edit /etc/named.com.\n\n134\n00:07:13.004 --> 00:07:17.461\nAnd in that config file if we go all the\nway down to the bottom where I've added\n\n135\n00:07:17.461 --> 00:07:18.446\nthe other zone.\n\n136\n00:07:18.446 --> 00:07:21.456\nRight, so here's where I\nadded the lab.ITPro.TV zone,\n\n137\n00:07:21.456 --> 00:07:23.810\nI can add in the reverse look up zone.\n\n138\n00:07:23.810 --> 00:07:26.310\nI can come in and I can say zone, and\n\n139\n00:07:26.310 --> 00:07:27.450\nhere's where I need to\nput the domain name.\n\n140\n00:07:27.450 --> 00:07:29.440\nNow on a forward look up zone it's easy.\n\n141\n00:07:29.440 --> 00:07:31.150\nIt's your new menu, lab.itpro.tv.\n\n142\n00:07:31.150 --> 00:07:38.080\nOn a reverse look up zone here's\nwhere that arpa name comes in.\n\n143\n00:07:38.080 --> 00:07:43.264\nThis is where I've gotta say 0.16.172,\nI'm reversing the subnet.\n\n144\n00:07:43.264 --> 00:07:49.527\n.in-addr.arpa.\n\n145\n00:07:49.527 --> 00:07:50.997\nLike that, okay?\n\n146\n00:07:50.997 --> 00:07:53.264\nAnd I need a little trailing dot there.\n\n147\n00:07:53.264 --> 00:07:53.918\nOkay, all right.\n\n148\n00:07:53.918 --> 00:07:56.570\nActually, I think it's optional cuz\nI didn't include it up here, so.\n\n149\n00:07:56.570 --> 00:07:57.780\nWell, we'll put it in there anyway.\n\n150\n00:07:57.780 --> 00:07:58.560\nIt doesn't hurt.\n\n151\n00:07:58.560 --> 00:08:00.310\nSo I've got it in there, and\n\n152\n00:08:00.310 --> 00:08:05.120\nthat is how it's gonna know what subnet,\nall those individual numbers line up.\n\n153\n00:08:05.120 --> 00:08:07.500\nSo when it sees 101,\n\n154\n00:08:07.500 --> 00:08:12.530\nit'll actually know it's 172.16.0.101\nbecause of this line right here, okay?\n\n155\n00:08:12.530 --> 00:08:15.540\nThen I need to tell it about the file\nthat this is all coming from.\n\n156\n00:08:15.540 --> 00:08:20.280\nSo I'll come in and\nI'll say that this is an internet zone and\n\n157\n00:08:20.280 --> 00:08:25.280\ntype Master and then the file,\n\n158\n00:08:25.280 --> 00:08:33.280\nwhich I made as 0.16.172.in-addr.arpa.dns.\n\n159\n00:08:33.280 --> 00:08:38.160\nAnd then we can close that out like that.\n\n160\n00:08:38.160 --> 00:08:39.590\nAnd now it's defined, okay?\n\n161\n00:08:39.590 --> 00:08:43.080\nSo the definition of it, you really just\nlike the forward lookup zone, right?\n\n162\n00:08:43.080 --> 00:08:46.290\nThe key part, the part that makes it\nlook hard, is that right there, right?\n\n163\n00:08:46.290 --> 00:08:50.930\nReversing the subnet and sticking\nthe in addr arpa on the end of it and\n\n164\n00:08:50.930 --> 00:08:52.130\ngetting that put in place.\n\n165\n00:08:52.130 --> 00:08:56.620\nBut once that's done,\nthat's now defined, and that zone is up.\n\n166\n00:08:56.620 --> 00:08:58.360\nIt really wasn't that hard to make, okay.\n\n167\n00:08:59.500 --> 00:09:02.666\nBut, just like anything we still have\nall the other issues associated with\n\n168\n00:09:02.666 --> 00:09:04.940\nthe forward look up zone\nthat we might have mistakes.\n\n169\n00:09:04.940 --> 00:09:06.580\nWe might have other things\nthat we have to double check,\n\n170\n00:09:06.580 --> 00:09:12.227\nbut at that point bine knows about it,\nit sees the zone and it's ready to rock.\n\n171\n00:09:12.227 --> 00:09:15.985\n&gt;&gt; Don, that's exciting stuff as always,\nbut can you show us more?\n\n172\n00:09:15.985 --> 00:09:17.555\nCan you show us how we do all that?\n\n173\n00:09:17.555 --> 00:09:19.462\n&gt;&gt; Yeah, yeah, we've got time,\nwe're on part two now so\n\n174\n00:09:19.462 --> 00:09:20.485\nI can take all the time I want.\n\n175\n00:09:20.485 --> 00:09:23.415\nSo if I want to bring that online I'm\ngonna do the same thing I did with\n\n176\n00:09:23.415 --> 00:09:24.065\nforward look up zone.\n\n177\n00:09:24.065 --> 00:09:27.795\nI'm gonna fix my permissions first off,\nwhich actually might already be fixed.\n\n178\n00:09:27.795 --> 00:09:28.865\nLet's just double check.\n\n179\n00:09:28.865 --> 00:09:32.977\nI'm gonna make sure my zone file is\nowned by root with a group of name,\n\n180\n00:09:32.977 --> 00:09:33.795\nwhich mine does not.\n\n181\n00:09:33.795 --> 00:09:34.950\nSo I'm glad I checked.\n\n182\n00:09:34.950 --> 00:09:37.810\nSo I will change the group to name d for\n\n183\n00:09:37.810 --> 00:09:42.840\nthat 0.16.172 file so\nthat the group ownership is correct.\n\n184\n00:09:42.840 --> 00:09:45.797\nSo now it is, so that's how I want it.\n\n185\n00:09:45.797 --> 00:09:49.430\nOn the permission side,\nnotice how like root has read write and\n\n186\n00:09:49.430 --> 00:09:51.680\nbind doesn't bind will only have read,\nthat's fine.\n\n187\n00:09:51.680 --> 00:09:53.450\nBind doesn't actually change these files.\n\n188\n00:09:53.450 --> 00:09:57.480\nIt's just you're reading these files,\nso it doesn't need write to it, so.\n\n189\n00:09:57.480 --> 00:09:58.610\nSo that's good.\n\n190\n00:09:58.610 --> 00:10:04.140\nI doubt my permissions\nchanged inside of /etc.\n\n191\n00:10:04.140 --> 00:10:07.640\nSo if I take a look in there,\nyeah, it's owned by root, and\n\n192\n00:10:07.640 --> 00:10:10.400\nthe group is set to nameD,\nso that's perfectly fine.\n\n193\n00:10:10.400 --> 00:10:12.330\nSo I don't have to change those.\n\n194\n00:10:12.330 --> 00:10:17.040\nI copied a forward lookup zone, but\nit was from the same folder, so\n\n195\n00:10:17.040 --> 00:10:20.120\nmy SELinux context is\nmore than likely fine.\n\n196\n00:10:20.120 --> 00:10:21.660\nSo I probably don't\nhave to mess with that.\n\n197\n00:10:21.660 --> 00:10:26.175\nBut if I wanna be on safe side,\nI could come in and say,\n\n198\n00:10:26.175 --> 00:10:30.420\nrestorecon-rv/var/named and\n\n199\n00:10:30.420 --> 00:10:33.040\nrun that just to make sure\nthat my SELinux context ready.\n\n200\n00:10:33.040 --> 00:10:35.130\nIf you ever wanna see that.\n\n201\n00:10:35.130 --> 00:10:39.460\nI keep doing LS-LA, which gives me\nthe long output with permissions and\n\n202\n00:10:39.460 --> 00:10:40.620\nshows hidden files.\n\n203\n00:10:40.620 --> 00:10:43.180\nYou can add a capital Z on that one.\n\n204\n00:10:43.180 --> 00:10:46.020\nAnd when you do that,\nyou'll see the SE Linux context.\n\n205\n00:10:46.020 --> 00:10:51.008\nAnd see how some of these files show\nas having a name D conf T context, and\n\n206\n00:10:51.008 --> 00:10:54.845\nother files might show\nsomething like being unbound.\n\n207\n00:10:54.845 --> 00:10:58.507\nIf it's unbound, then it's gonna be in\na default context and bind, likely,\n\n208\n00:10:58.507 --> 00:11:00.050\nwon't be able to read from it.\n\n209\n00:11:00.050 --> 00:11:03.619\nSo, that file that I created\nhas that named zone T,\n\n210\n00:11:03.619 --> 00:11:07.023\nthat's what that restore\ncon command is doing.\n\n211\n00:11:07.023 --> 00:11:08.310\nIt's getting that context set up right.\n\n212\n00:11:08.310 --> 00:11:09.210\nSo, I need that in place.\n\n213\n00:11:10.300 --> 00:11:11.050\nSo, those are done.\n\n214\n00:11:11.050 --> 00:11:14.120\nI probably need to check my syntax,\nI haven't done that in a little while, so\n\n215\n00:11:14.120 --> 00:11:19.576\nI'll do a named -checkzone.\n\n216\n00:11:19.576 --> 00:11:23.581\nAnd I'll say that I'm checking\n\n217\n00:11:23.581 --> 00:11:29.669\nthe 0.16.172.in-addr.arpa zone.\n\n218\n00:11:29.669 --> 00:11:34.049\nAnd I need to tell it where the config\nfile for that is, which is /var/atc.\n\n219\n00:11:35.460 --> 00:11:36.660\nAnd right there.\n\n220\n00:11:36.660 --> 00:11:38.350\nSo I'm gonna point to that file.\n\n221\n00:11:38.350 --> 00:11:41.150\nAnd when I do that, it's just\ngonna run a quick check on it and\n\n222\n00:11:41.150 --> 00:11:43.300\nit's telling me that it's loading\nfrom master and it says it failed,\n\n223\n00:11:43.300 --> 00:11:47.700\nfile not found, which means I\nmust have messed up, the path.\n\n224\n00:11:47.700 --> 00:11:51.780\nIt's not /var/etc, it's /var/named,\nthat'll make a difference.\n\n225\n00:11:51.780 --> 00:11:53.430\nThere we go.\nAnd it's gonna look in there and\n\n226\n00:11:53.430 --> 00:11:57.230\nit's telling me that it has no name server\nrecords, which is kinda interesting, and\n\n227\n00:11:57.230 --> 00:11:58.740\ntelling me it's not loaded due to errors.\n\n228\n00:11:58.740 --> 00:12:00.680\nSo it failed, right?\n\n229\n00:12:00.680 --> 00:12:02.580\nAnd that, again is good that we checked.\n\n230\n00:12:02.580 --> 00:12:03.570\n&gt;&gt; Live action debugging.\n\n231\n00:12:03.570 --> 00:12:07.040\n&gt;&gt; [LAUGH] So interesting it says\nthere is no name record though because\n\n232\n00:12:07.040 --> 00:12:10.370\nwhen I made it I left\na name record in there.\n\n233\n00:12:10.370 --> 00:12:11.810\nUnless I got overzealous and deleted it.\n\n234\n00:12:11.810 --> 00:12:15.950\nSo let's just double check,\nshoot I did get overzealous.\n\n235\n00:12:15.950 --> 00:12:23.700\nI left this entry, which is\nlab.itpro.tv for the domain, right.\n\n236\n00:12:23.700 --> 00:12:27.380\nAnd it's a name server, but\nit's a name server for lab.itpro.tv.\n\n237\n00:12:27.380 --> 00:12:31.674\nIt's not a name server for 0.16.172.\n\n238\n00:12:31.674 --> 00:12:33.960\nSo I should have updated that and\nI didn't.\n\n239\n00:12:33.960 --> 00:12:36.970\nThe easiest way to update this\nis to just change this and\n\n240\n00:12:36.970 --> 00:12:40.260\nI should have done it in the other\nfile too and just done an at instead.\n\n241\n00:12:40.260 --> 00:12:42.040\nCuz then it would say, hey,\nthat's the nameserver for\n\n242\n00:12:42.040 --> 00:12:43.540\nwhatever this zone happens to be.\n\n243\n00:12:43.540 --> 00:12:44.638\nThat would've made this\na little more flexible.\n\n244\n00:12:44.638 --> 00:12:47.393\nAnd I could've just copied it over, or\n\n245\n00:12:47.393 --> 00:12:52.159\nI could actually put in here\n0.16.172 blah, blah, blah.\n\n246\n00:12:52.159 --> 00:12:53.573\nBut the @ symbol's usually an easier way.\n\n247\n00:12:53.573 --> 00:12:55.504\nSo that should fix that error.\n\n248\n00:12:55.504 --> 00:12:58.360\nI'm glad we checked and there we go.\n\n249\n00:12:58.360 --> 00:13:02.960\nNow it runs, loaded serial number one\njust fine, checked it, and that's good.\n\n250\n00:13:02.960 --> 00:13:08.750\nAnd I'll do the same thing for\nnamed -checkconf to make sure it's good.\n\n251\n00:13:08.750 --> 00:13:09.530\nAnd it is.\n\n252\n00:13:09.530 --> 00:13:15.813\nSo now, I can do a systemctl\nrestart named.conf, right?\n\n253\n00:13:15.813 --> 00:13:19.497\n[LAUGH] Named.service there we go and\nonce I restart that service,\n\n254\n00:13:19.497 --> 00:13:22.910\nnow it will have loaded\nthe reverse look up zone as well.\n\n255\n00:13:22.910 --> 00:13:27.962\nSo I should be able to do something\nlike this, I should be able to say\n\n256\n00:13:27.962 --> 00:13:33.401\nns lookup mail 1.lab.itprotv, and\ndo that look up against myself.\n\n257\n00:13:33.401 --> 00:13:36.420\nAnd it resolves name to IP.\n\n258\n00:13:36.420 --> 00:13:41.000\nBut then I should also be able to say and\n\n259\n00:13:41.000 --> 00:13:45.800\nlet's look up 172.16.0.102 or 103 for\nthat matter, I could do the other server.\n\n260\n00:13:45.800 --> 00:13:50.840\nAnd look that up against myself and\nit resolves it to a name.\n\n261\n00:13:50.840 --> 00:13:56.720\nAnd I can see that 172.16.0.103\nis now mailtwo.lab.itpro.tv.\n\n262\n00:13:56.720 --> 00:13:59.620\nSo the reverse lookup\nzone is doing it's job,\n\n263\n00:13:59.620 --> 00:14:01.680\nthe forward lookup zone is doing it's.\n\n264\n00:14:01.680 --> 00:14:04.930\nThe server is still cacheing, so\nwe still have that functionality too, but\n\n265\n00:14:04.930 --> 00:14:06.380\nnow we've got our own zones.\n\n266\n00:14:06.380 --> 00:14:10.640\nAnd now we've got a fully functional\nDNS server that's capable of\n\n267\n00:14:10.640 --> 00:14:12.160\nhosting out own zones.\n\n268\n00:14:12.160 --> 00:14:12.680\n&gt;&gt; Fantastic.\n\n269\n00:14:12.680 --> 00:14:14.730\nConfiguring zones, and records part two,\n\n270\n00:14:14.730 --> 00:14:17.025\nthere was a part one,\nmake sure you see that.\n\n271\n00:14:17.025 --> 00:14:19.460\nDon, before we move on, any last words?\n\n272\n00:14:19.460 --> 00:14:22.117\n&gt;&gt; After this,\nit's pretty smooth sailing, right?\n\n273\n00:14:22.117 --> 00:14:25.029\nYou just go and modify those zone files\nto add in your records as time goes on,\n\n274\n00:14:25.029 --> 00:14:26.460\nyou just need to update them.\n\n275\n00:14:26.460 --> 00:14:30.270\nThere are many, many more advanced\ntopics inside of the DNS world.\n\n276\n00:14:30.270 --> 00:14:35.260\nLike doing dynamic DNS, and using OMShell\nto modify the config without restarting\n\n277\n00:14:35.260 --> 00:14:37.340\nthe service, and\nthere's all sorts of other crazy things.\n\n278\n00:14:37.340 --> 00:14:40.788\nSo what I'm showing you is kinda\nthe minimum to get that DNS server up,\n\n279\n00:14:40.788 --> 00:14:42.844\nget it running, keep it secure, right.\n\n280\n00:14:42.844 --> 00:14:46.090\nWe saw the firewall and the permissions,\nso getting everything kinda set right,\n\n281\n00:14:46.090 --> 00:14:48.816\nthat's what you need to get up and\nrunning, but do be aware that DNS is\n\n282\n00:14:48.816 --> 00:14:51.610\na huge topic, there's a lot more\nto learn out there, so don't stop.\n\n283\n00:14:51.610 --> 00:14:53.840\nOnce you get this set up,\ncontinue exploring,\n\n284\n00:14:53.840 --> 00:14:55.180\nyou'll find it's really powerful stuff.\n\n285\n00:14:55.180 --> 00:14:56.770\n&gt;&gt; Fantastic job as always, Don.\n\n286\n00:14:56.770 --> 00:15:00.900\nBecoming a Linux server administrator,\na lot of video content in this series and\n\n287\n00:15:00.900 --> 00:15:03.400\nit's exciting and wonderful and\nyou wanna see every single video.\n\n288\n00:15:03.400 --> 00:15:05.610\nYou'll be very happy that you did that.\n\n289\n00:15:05.610 --> 00:15:10.760\nAnd thank you for watching ITProTV,\nremember a good IT pro is always learning.\n\n290\n00:15:10.760 --> 00:15:11.810\nI'm Zach Memos.\n\n291\n00:15:11.810 --> 00:15:12.570\n&gt;&gt; And I'm Don Pezet.\n\n292\n00:15:12.570 --> 00:15:15.037\n&gt;&gt; And we will see you very soon.\n\n293\n00:15:15.037 --> 00:15:21.037\n[MUSIC]\n\n294\n00:15:21.037 --> 00:15:24.070\nThank you for watching ITProTV.\n\n",
          "vimeoId": "227075193"
        }
      ],
      "title": "Configuring a DNS Server"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach discuss  DHCPD, standards based DHCP server, installation, minimum configuration needed to get started, configuring static DHCP leases, operations, troubleshoot fail to start, and tools for monitoring DHCP.",
          "length": "1733",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-5-1-installing_dhcpd-080717.00_28_40_17.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-5-1-installing_dhcpd-080717.00_28_40_17.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-5-1-installing_dhcpd-080717.00_28_40_17.Still001-sm.jpg",
          "title": "Installing dhcpd",
          "transcript": "WEBVTT\n\n1\n00:00:00.011 --> 00:00:02.402\nWelcome to ITPRoTV,\nI'm your host Don Pezet.\n\n2\n00:00:02.402 --> 00:00:10.510\n[CROSSTALK]\n&gt;&gt; You're watching ITProTV.\n\n3\n00:00:12.180 --> 00:00:14.867\n&gt;&gt; Hello, and thank you for\nwatching ITProTV,\n\n4\n00:00:14.867 --> 00:00:16.998\nhelping you learn wherever you go.\n\n5\n00:00:16.998 --> 00:00:18.773\nI'm your host, Zach Memos,\n\n6\n00:00:18.773 --> 00:00:22.537\nas we continue on with becoming\na Linux server administrator.\n\n7\n00:00:22.537 --> 00:00:25.491\nAnd this morning,\nwe're gonna be installing DHCPD.\n\n8\n00:00:25.491 --> 00:00:26.299\nWhat does it mean?\n\n9\n00:00:26.299 --> 00:00:29.702\nWell, Don Pezet is gonna give us\nthe answers, he's got the answers.\n\n10\n00:00:29.702 --> 00:00:31.023\nGood morning Don, good to see you again.\n\n11\n00:00:31.023 --> 00:00:32.050\n&gt;&gt; Thanks for having me back, Zach.\n\n12\n00:00:32.050 --> 00:00:35.368\nYeah, today, we're gonna be\ntaking a look at the DHCPD or\n\n13\n00:00:35.368 --> 00:00:38.771\nthe Dynamic Host Configuration\nProtocol Daemon, right.\n\n14\n00:00:38.771 --> 00:00:41.575\nWe didn't pick the name on that one,\nwhich is really useful, all right.\n\n15\n00:00:41.575 --> 00:00:45.298\nMost networks make use of DHCP, so\nwe kind of already know what it is.\n\n16\n00:00:45.298 --> 00:00:48.416\nBut you have a computer that fires up\non the network, it needs an IP address,\n\n17\n00:00:48.416 --> 00:00:51.364\nneeds to get it from somewhere,\na DHCP server can give it to it, right.\n\n18\n00:00:51.364 --> 00:00:55.711\nWell, a lot of us use our firewalls,\nor our routers, as a DHCP server, and\n\n19\n00:00:55.711 --> 00:00:56.609\nthat's fine.\n\n20\n00:00:56.609 --> 00:01:00.096\nBut if you've got a Linux server,\nyou can use that as a DHCP server as well.\n\n21\n00:01:00.096 --> 00:01:04.046\nAnd that's really handy in areas,\nlike especially in the cloud,\n\n22\n00:01:04.046 --> 00:01:07.923\nwhere you might have like\na AWS Virtual Private Cloud, a VPC, and\n\n23\n00:01:07.923 --> 00:01:10.200\nyou wanna set up your own DHCP server.\n\n24\n00:01:10.200 --> 00:01:13.535\nWell, you can use theirs with\nsomewhat limited options, or you can\n\n25\n00:01:13.535 --> 00:01:17.360\nspin up a Linux box to act as that DHCP\nserver, and it's really not that hard.\n\n26\n00:01:17.360 --> 00:01:19.790\nSo that's what we're gonna be taking\na look at right here in this episode,\n\n27\n00:01:19.790 --> 00:01:22.380\nis how to build a Linux based DHCP server.\n\n28\n00:01:22.380 --> 00:01:23.875\n&gt;&gt; So what software do we need?\n\n29\n00:01:23.875 --> 00:01:29.470\n&gt;&gt; Well, almost every distro that's\nout there includes a DHCP server that,\n\n30\n00:01:29.470 --> 00:01:32.430\nit's not usually installed by default,\nwe just need to install it, but\n\n31\n00:01:32.430 --> 00:01:35.370\nit's an open source DHCP\nserver created by ISC.\n\n32\n00:01:35.370 --> 00:01:38.364\nAnd ISC, if you're not familiar with them,\nI've got their webpage pulled up here,\n\n33\n00:01:38.364 --> 00:01:39.957\nthey're the Internet Systems Consortium.\n\n34\n00:01:39.957 --> 00:01:43.602\nAnd they make several different\nproducts that are out there,\n\n35\n00:01:43.602 --> 00:01:47.190\nbut the one that we're gonna\nbe using is ICS's DHCP server.\n\n36\n00:01:47.190 --> 00:01:51.960\nNow in pretty much every Linux distro,\nthis is the standard DHCP server.\n\n37\n00:01:51.960 --> 00:01:56.497\nSo when people talk about DHCPD, the DHCP\ndaemon, they're really talking about ISC\n\n38\n00:01:56.497 --> 00:02:00.152\nimplementation, but there are other\noptions that are out there, so\n\n39\n00:02:00.152 --> 00:02:03.260\ndon't feel like this show is\nthe only way to do it, right.\n\n40\n00:02:03.260 --> 00:02:06.270\nIf you got a different server you\nprefer you're welcome to tackle that.\n\n41\n00:02:06.270 --> 00:02:10.485\nEven ISC has an alternative, they have\nthe Kia server which they're working on,\n\n42\n00:02:10.485 --> 00:02:14.395\nwhich eventually may replace DHCP, but\nI don't know that it's gonna happen.\n\n43\n00:02:14.395 --> 00:02:16.155\n&gt;&gt; And not a bad car either.\n\n44\n00:02:16.155 --> 00:02:19.335\n&gt;&gt; [LAUGH] Yeah it's kind of\nalong the same lines there.\n\n45\n00:02:19.335 --> 00:02:24.705\nBut with ISC this software is packaged\nwith just about every distro,\n\n46\n00:02:24.705 --> 00:02:28.135\nso if you wanna get this installed you\ndon't have to download it from them or\n\n47\n00:02:28.135 --> 00:02:30.670\nanything, it's typically\nright there with your system.\n\n48\n00:02:30.670 --> 00:02:35.593\nRight, now I'm using a Red Hat\nEnterprise Linux 7 server on CentOS,\n\n49\n00:02:35.593 --> 00:02:38.780\nand on Red Hat and on Fedora really.\n\n50\n00:02:38.780 --> 00:02:40.520\nWe can use YUM or DNf to install it.\n\n51\n00:02:40.520 --> 00:02:43.609\nIf I was on Debian you could\nuse apt-get to install it, but\n\n52\n00:02:43.609 --> 00:02:47.405\nthey just call it DHCPD so you don't\nhave to know all the other details.\n\n53\n00:02:47.405 --> 00:02:51.160\nIf I wanna get it installed,\nI can just come in and I can say,\n\n54\n00:02:51.160 --> 00:02:56.196\nsudo yum install dhcp, like that, and\nwhen I do that, it's gonna reach out and\n\n55\n00:02:56.196 --> 00:02:59.909\nit's gonna install that and\nget me set up as a DHCP server.\n\n56\n00:02:59.909 --> 00:03:02.993\nNow there is another package of\navailable called dhcp-client and\n\n57\n00:03:02.993 --> 00:03:05.370\nyou've probably already\ngot that one installed.\n\n58\n00:03:05.370 --> 00:03:09.500\nThat's usually installed by default so\nyour system can request an IP address, but\n\n59\n00:03:09.500 --> 00:03:12.160\nwhat I'm doing is setting\nmyself up to be a server.\n\n60\n00:03:12.160 --> 00:03:17.152\nSo the package that's just called DHCP,\nthat's the server and it looks like\n\n61\n00:03:17.152 --> 00:03:20.955\nthere're gonna be updates for some of my\ndependencies and see how I got dhc-client\n\n62\n00:03:20.955 --> 00:03:24.930\nor dh-client, dhcp-common, dhcp-libs,\nthose are all being updated as well.\n\n63\n00:03:24.930 --> 00:03:28.330\nSo I'll go ahead and let those install and\n\n64\n00:03:28.330 --> 00:03:32.530\nwhen that's done,\nI've now got the DHCP server in place.\n\n65\n00:03:32.530 --> 00:03:34.160\nI can spin it up if I want.\n\n66\n00:03:34.160 --> 00:03:37.328\nThis is one of those services though that\nyou don't normally just turn it on, right?\n\n67\n00:03:37.328 --> 00:03:39.458\nIf I install Apache, I can start it and\n\n68\n00:03:39.458 --> 00:03:43.262\nit's got a default configuration\nthat works for most everything.\n\n69\n00:03:43.262 --> 00:03:45.961\nDHCP does not have a good\ndefault configuration,\n\n70\n00:03:45.961 --> 00:03:49.220\nit doesn't know what IP\naddresses to hand out, right?\n\n71\n00:03:49.220 --> 00:03:53.020\nSo if I try and jump in and immediately\nstart it, a lot of times you get errors.\n\n72\n00:03:53.020 --> 00:03:56.080\nLet's see if I get errors on this one.\n\n73\n00:03:56.080 --> 00:03:59.200\nA lot of times you get errors because\nthere's this lease database that needs to\n\n74\n00:03:59.200 --> 00:04:01.450\nexist, and it doesn't exist yet, and so\n\n75\n00:04:01.450 --> 00:04:05.240\nwhen you go to start it up,\nyou may find that it actually does start.\n\n76\n00:04:05.240 --> 00:04:07.580\nActually I guess I need\nto enable it first.\n\n77\n00:04:07.580 --> 00:04:10.770\nThat it may fire up on its own, or\nit may just return some errors.\n\n78\n00:04:11.860 --> 00:04:16.030\nLet's see, I got a access denied.\n\n79\n00:04:16.030 --> 00:04:18.250\nSo, all right,\nI made a pretty common mistake here.\n\n80\n00:04:18.250 --> 00:04:19.337\nSo let me just highlight this real quick.\n\n81\n00:04:19.337 --> 00:04:23.363\nThe service is called DHCP, right,\nbut the actual service is DHCPD, so\n\n82\n00:04:23.363 --> 00:04:24.423\nI should of known.\n\n83\n00:04:24.423 --> 00:04:25.003\n&gt;&gt; Right.\n\n84\n00:04:25.003 --> 00:04:29.420\n&gt;&gt; System CTL enabled DHCP Whoops,\nD.service.\n\n85\n00:04:29.420 --> 00:04:32.600\nSo it'll get that started up and\nthen I'll try and actually start it.\n\n86\n00:04:32.600 --> 00:04:36.430\nNow, I may pull an error here\nwhen it goes to start and I did.\n\n87\n00:04:36.430 --> 00:04:37.370\nThere, perfect.\n\n88\n00:04:37.370 --> 00:04:40.210\nAnd the reason is it doesn't really have\na good standard configuration, right?\n\n89\n00:04:40.210 --> 00:04:43.656\nSo it's not as easy as setting up a web\nserver, where I just install, patch, and\n\n90\n00:04:43.656 --> 00:04:45.092\nturn it on and the default works.\n\n91\n00:04:45.092 --> 00:04:49.230\nHere I've gotta get in and do some basic\nconfiguration first before it'll even run.\n\n92\n00:04:49.230 --> 00:04:51.830\n&gt;&gt; So what is the minimum\nconfiguration we need to get started?\n\n93\n00:04:51.830 --> 00:04:55.540\n&gt;&gt; So the bare minimum is\nthat I need to come in and\n\n94\n00:04:55.540 --> 00:04:56.970\nat least create one scope, right?\n\n95\n00:04:56.970 --> 00:04:59.580\nAnd a scope is a collection of\nIP addresses that we're gonna\n\n96\n00:04:59.580 --> 00:05:00.189\nhand out, right?\n\n97\n00:05:00.189 --> 00:05:03.420\nAnd that's kinda the bare minimum\nthat we need to get set up.\n\n98\n00:05:03.420 --> 00:05:05.250\nAnd to help us get started,\n\n99\n00:05:05.250 --> 00:05:08.020\nthere's actually a sample configuration\nthat's provided you can use.\n\n100\n00:05:08.020 --> 00:05:11.947\nIf you browse around, it's one of\nthose things kinda hard to find.\n\n101\n00:05:11.947 --> 00:05:16.832\nBut if you browse into /usr/share/doc,\ninside of the doc\n\n102\n00:05:16.832 --> 00:05:21.927\nfolder you're going to find\ndocumentation for a lot of stuff.\n\n103\n00:05:21.927 --> 00:05:26.293\nBut you can find your DHCP server listed\nin here and along with a version number.\n\n104\n00:05:26.293 --> 00:05:30.741\nSo I'm running DHCP 4.2.5 right?\n\n105\n00:05:30.741 --> 00:05:33.399\nAnd so if I, whoops, [LAUGH].\n\n106\n00:05:33.399 --> 00:05:39.155\nSo if I get into that folder,\nlet me get back into there,\n\n107\n00:05:39.155 --> 00:05:43.090\nand I will just do that, 4.2.5.\n\n108\n00:05:43.090 --> 00:05:44.570\nInside of there,\n\n109\n00:05:44.570 --> 00:05:48.990\nin that folder, what you'll find\nis an example configuration file.\n\n110\n00:05:48.990 --> 00:05:51.645\nThis guy right here,\ndhcpd.conf.example and\n\n111\n00:05:51.645 --> 00:05:55.840\nit's designed to kinda be a starting\npoint for your configuration.\n\n112\n00:05:55.840 --> 00:05:59.983\nNow, that example has a lot of stuff\nin it that's not necessary, right?\n\n113\n00:05:59.983 --> 00:06:01.810\nIt's just an example.\n\n114\n00:06:01.810 --> 00:06:05.660\nSo you could create your own config\nfile from scratch with a very\n\n115\n00:06:05.660 --> 00:06:07.020\nfew amount of lines.\n\n116\n00:06:07.020 --> 00:06:10.237\nBut if you're just learning,\nthis is a great place to start and\n\n117\n00:06:10.237 --> 00:06:13.148\nif we take a look at it,\nlet me just, well actually here,\n\n118\n00:06:13.148 --> 00:06:16.240\nwhat a lot of people do is\nthey just copy this file.\n\n119\n00:06:16.240 --> 00:06:18.150\nCopy it to where\nthe configuration's gonna be and\n\n120\n00:06:18.150 --> 00:06:20.630\nthen you can modify it as needed, right?\n\n121\n00:06:20.630 --> 00:06:23.350\nI typically don't do that cuz it's\ngot a lot of extra stuff in it, but\n\n122\n00:06:23.350 --> 00:06:25.180\nit is kind of useful, again,\nwhen you're learning.\n\n123\n00:06:25.180 --> 00:06:30.296\nSo I'm gonna go ahead and just copy\nthis and we can drop that to wherever\n\n124\n00:06:30.296 --> 00:06:36.124\nwe need it to be, which where we need it\nto be is actually, let me just copy that.\n\n125\n00:06:36.124 --> 00:06:41.374\nWe need it to be in /etc/dhcp/dhcpd.conf,\n\n126\n00:06:41.374 --> 00:06:46.370\nthat's where we need the file to reside.\n\n127\n00:06:46.370 --> 00:06:48.320\nOkay, so\nyou can just copy it right to there.\n\n128\n00:06:48.320 --> 00:06:53.065\nI'll need to sudo that to copy it over,\nand once it's there,\n\n129\n00:06:53.065 --> 00:06:55.362\nI can jump into /etc/dhcp.\n\n130\n00:06:55.362 --> 00:06:58.070\nAnd you know what let me do a little,\n\n131\n00:06:58.070 --> 00:07:01.805\nyou know what I think I made\nmy little mistake again.\n\n132\n00:07:01.805 --> 00:07:04.385\nWhen I go into /etc and take a look,\n\n133\n00:07:04.385 --> 00:07:10.409\nbecause we haven't actually started DHCP\nyet, nope, nope, my folder is there.\n\n134\n00:07:10.409 --> 00:07:12.412\nI just need to elevate my privileges.\n\n135\n00:07:12.412 --> 00:07:14.980\nI'm gonna bump over to a root shell\ncuz I keep hitting those permissions.\n\n136\n00:07:14.980 --> 00:07:15.866\n&gt;&gt; And you deserve to be elevated.\n\n137\n00:07:15.866 --> 00:07:16.902\n&gt;&gt; [LAUGH] It's true.\n\n138\n00:07:16.902 --> 00:07:20.993\nSo I'm gonna do a sudo -s here just so I\nstop having to sudo everything that I do.\n\n139\n00:07:20.993 --> 00:07:25.710\nAnd I'm gonna get into /etc/dhcp,\nand I'll take a look in there.\n\n140\n00:07:25.710 --> 00:07:29.150\nI sudo'd the copy command and so that\nfolder had root privileges set to it and\n\n141\n00:07:29.150 --> 00:07:30.680\nthat's why I wasn't able to get into it.\n\n142\n00:07:30.680 --> 00:07:34.761\nBut there's that dhcpd.conf\nfile that I wanna work with and\n\n143\n00:07:34.761 --> 00:07:36.688\nthat's the sample script.\n\n144\n00:07:36.688 --> 00:07:41.482\nAnd you'll see where there's dhcpd6.conf\nalso if we're doing IPv6, but\n\n145\n00:07:41.482 --> 00:07:43.670\nI just wanna take a look at this one.\n\n146\n00:07:43.670 --> 00:07:48.970\nSo I'm going to modify that file and\nonce we take.\n\n147\n00:07:48.970 --> 00:07:51.808\n[LAUGH] Once we take a look at it,\n\n148\n00:07:51.808 --> 00:07:56.406\nif I can actually type it correctly,\nthere we go.\n\n149\n00:07:56.406 --> 00:07:59.241\nWe can see all these different\noptions in here, right, and\n\n150\n00:07:59.241 --> 00:08:03.509\nsome of these are necessary, some of these\naren't, so for example default lease time.\n\n151\n00:08:03.509 --> 00:08:05.996\nWell, the default lease\ntime here is set to 600.\n\n152\n00:08:05.996 --> 00:08:08.879\nAnd that means that when somebody gets\na lease, they're gonna hold onto it for\n\n153\n00:08:08.879 --> 00:08:09.540\n600 seconds.\n\n154\n00:08:09.540 --> 00:08:11.510\nWell, that's not a terribly long time,\nright?\n\n155\n00:08:11.510 --> 00:08:12.430\nIt's ten minutes.\n\n156\n00:08:12.430 --> 00:08:15.720\nSo I may want to adjust that to\nmake it larger or shorter or\n\n157\n00:08:15.720 --> 00:08:16.810\nwhatever it is that I need.\n\n158\n00:08:17.820 --> 00:08:20.692\nYou'll see the max lease time,\nand again, we can adjust those.\n\n159\n00:08:20.692 --> 00:08:22.230\nYou can actually delete these out of here,\nthough.\n\n160\n00:08:22.230 --> 00:08:23.340\nCuz if you leave them out,\n\n161\n00:08:23.340 --> 00:08:26.860\nthere are default values that it\nwill use if you don't include them.\n\n162\n00:08:26.860 --> 00:08:30.870\nSo all of this here is really\ndesigned as kind of a learning file.\n\n163\n00:08:30.870 --> 00:08:32.425\nYou can empty out the majority of it.\n\n164\n00:08:32.425 --> 00:08:36.170\nThe key thing that you're gonna\nneed are what you see right here.\n\n165\n00:08:36.170 --> 00:08:39.370\nA subnet to tell it what\nsubnet to operate on, and\n\n166\n00:08:39.370 --> 00:08:42.470\nthen a scope of IPs to get it out, okay?\n\n167\n00:08:42.470 --> 00:08:44.960\nNow that subnet line,\nthat's really important.\n\n168\n00:08:44.960 --> 00:08:49.080\nBecause that's telling it what\nnetwork adapters to listen on.\n\n169\n00:08:49.080 --> 00:08:52.230\nYou might only have one network adapter or\nyou might have five network adapters.\n\n170\n00:08:52.230 --> 00:08:53.870\nAnd when you set up a DHCP server,\n\n171\n00:08:53.870 --> 00:08:58.910\nyou need to tell it to hand out addresses\non one or all of those adapters, okay?\n\n172\n00:08:58.910 --> 00:09:01.606\nSo what this line right here is saying,\n\n173\n00:09:01.606 --> 00:09:05.946\nis subnet 10.152.187.0\nwith a 24 bit net mask.\n\n174\n00:09:05.946 --> 00:09:07.071\nThat means look for\n\n175\n00:09:07.071 --> 00:09:11.860\nany network adapter with an IP\naddress that starts with 10.152.187.\n\n176\n00:09:11.860 --> 00:09:14.685\nAnd if I have any network\nadapters that match that,\n\n177\n00:09:14.685 --> 00:09:16.980\nI'll run DHCP on that interface.\n\n178\n00:09:16.980 --> 00:09:19.390\nOkay, well, I don't have any\ninterfaces that match that.\n\n179\n00:09:19.390 --> 00:09:27.810\nIn fact, my interfaces are 172.16.0.0\nwith a 24 bit subnet mask, right?\n\n180\n00:09:27.810 --> 00:09:30.090\nSo that's the subnet that\nI'm currently operating on.\n\n181\n00:09:30.090 --> 00:09:32.100\nSo I can modify this\nline to match that and\n\n182\n00:09:32.100 --> 00:09:34.240\nnow it'll see my network adapter, okay?\n\n183\n00:09:34.240 --> 00:09:37.266\nBut you'll need to adjust this accordingly\nto match whatever your network adapters\n\n184\n00:09:37.266 --> 00:09:37.786\nhappen to be.\n\n185\n00:09:37.786 --> 00:09:40.170\nSo we've gotta get that\nkind of put in place.\n\n186\n00:09:40.170 --> 00:09:41.990\nAnd then after that,\n\n187\n00:09:41.990 --> 00:09:46.870\nthe subnet isn't terribly useful\nunless I give it some IPs to hand out.\n\n188\n00:09:46.870 --> 00:09:47.690\nAnd that's the next part.\n\n189\n00:09:47.690 --> 00:09:48.460\nIf you look down here,\n\n190\n00:09:48.460 --> 00:09:52.300\nthe next example actually has\na range attached to it, right?\n\n191\n00:09:52.300 --> 00:09:55.320\nAnd that range is what we really\nneed to get this working.\n\n192\n00:09:55.320 --> 00:09:59.334\nSo I'm gonna add an extra line in here,\nand\n\n193\n00:09:59.334 --> 00:10:04.364\nI'll just say range, 172.16.0.150.\n\n194\n00:10:04.364 --> 00:10:09.260\nAnd then 172.16.0.160, right?\n\n195\n00:10:09.260 --> 00:10:12.630\nThat's gonna create\na pool of 10 addresses,\n\n196\n00:10:12.630 --> 00:10:15.760\nactually 11 addresses, 150 through 160.\n\n197\n00:10:15.760 --> 00:10:19.250\nAnd so\nthose are the IPs that I can now hand out.\n\n198\n00:10:19.250 --> 00:10:23.450\nAnd that right there, these three lines,\nthe third line is just a closed bracket,\n\n199\n00:10:23.450 --> 00:10:26.320\nbut these three lines are technically\nthe only thing I need in here.\n\n200\n00:10:26.320 --> 00:10:29.620\nI can delete everything else in this\nfile and just have these three lines and\n\n201\n00:10:29.620 --> 00:10:33.230\nthat'll be enough to get DHCP up and\ngoing.\n\n202\n00:10:33.230 --> 00:10:38.420\nIt knows what network adapter to watch and\nit knows a range of IPs to give out.\n\n203\n00:10:38.420 --> 00:10:42.950\nOkay, now the reason I don't like copying\nthis sample file, I mentioned I don't\n\n204\n00:10:42.950 --> 00:10:46.560\nnormally do this, is because there's\nall this other stuff, right?\n\n205\n00:10:46.560 --> 00:10:50.836\nSo like here it's looking for\nan interface that starts with 10.254.239.\n\n206\n00:10:50.836 --> 00:10:52.304\nI don't have one.\n\n207\n00:10:52.304 --> 00:10:54.170\nBut what if one day, down the road,\n\n208\n00:10:54.170 --> 00:10:58.740\njust through some crazy coincidence,\nI happen to add that interface?\n\n209\n00:10:58.740 --> 00:11:02.500\nAnd now I start handing out\nDHCP addresses on it and\n\n210\n00:11:02.500 --> 00:11:03.550\nnot even thinking about it, right?\n\n211\n00:11:03.550 --> 00:11:05.000\nThat's the kind of\naccident that can happen.\n\n212\n00:11:05.000 --> 00:11:09.295\nSo if you're gonna use this file,\nmake sure that you go through and\n\n213\n00:11:09.295 --> 00:11:12.280\ndouble-check everything\nmatches what you want.\n\n214\n00:11:12.280 --> 00:11:16.050\nNotice how most of the lines have a little\nhash or a pound symbol at the beginning.\n\n215\n00:11:16.050 --> 00:11:17.864\nThat means they're commented out, right?\n\n216\n00:11:17.864 --> 00:11:21.500\nSo I could easily just come in and\ncomment out anything that didn't match.\n\n217\n00:11:21.500 --> 00:11:26.570\nAnd then add in the things that I\nwanted to make it do what I need.\n\n218\n00:11:26.570 --> 00:11:30.070\nSo for example, I might not want to delete\nthis example because I might want to see\n\n219\n00:11:30.070 --> 00:11:31.110\nit in the future, right?\n\n220\n00:11:31.110 --> 00:11:32.590\nAnd I can't remember how\nto create a subnet, and\n\n221\n00:11:32.590 --> 00:11:34.360\nI can look right here and\nI can see a sample.\n\n222\n00:11:34.360 --> 00:11:35.510\nBut by commenting that out,\n\n223\n00:11:35.510 --> 00:11:39.548\nthat's gonna make sure that it doesn't\nimpact what I actually need to do, right?\n\n224\n00:11:39.548 --> 00:11:42.820\nOr I'm gonna be a little more\naggressive here and just go through and\n\n225\n00:11:42.820 --> 00:11:45.700\ndelete some of these lines and\nget them out of here.\n\n226\n00:11:45.700 --> 00:11:49.930\nBut you'll see they get much more\ncomplex as the examples go, right?\n\n227\n00:11:49.930 --> 00:11:53.370\nAnd each one is gonna add in\na little more, and a little more and\n\n228\n00:11:53.370 --> 00:11:55.125\ngetting more and more complex.\n\n229\n00:11:55.125 --> 00:11:57.965\nI don't really need any of this stuff,\nso I'm gonna come through and\n\n230\n00:11:57.965 --> 00:12:04.345\njust kinda wipe all that out and\nget us kind of a little more slim, right?\n\n231\n00:12:04.345 --> 00:12:07.325\nAnd you'll see, it takes a lot of effort\nto get this file kind of setup right,\n\n232\n00:12:07.325 --> 00:12:10.085\nit's usually easier just to\nstart with one from scratch.\n\n233\n00:12:10.085 --> 00:12:12.065\nAnd that makes life a little bit easier.\n\n234\n00:12:12.065 --> 00:12:13.845\nSo in fact, let's just do that.\n\n235\n00:12:13.845 --> 00:12:19.018\nLet's say that I want to start\ncompletely from scratch.\n\n236\n00:12:19.018 --> 00:12:26.440\nSo I will get rid of dhcpd.conf,\nAnd I will create a new one.\n\n237\n00:12:29.005 --> 00:12:33.290\nAnd I'm just gonna put in the brass tacks,\nright, the bare minimum on here.\n\n238\n00:12:33.290 --> 00:12:36.244\nSo I'll say subnet, and\nI'll specify the subnet for\n\n239\n00:12:36.244 --> 00:12:40.395\nthe network adapter that I'm gonna be\nwatching on and what its net mask is.\n\n240\n00:12:40.395 --> 00:12:43.530\nIn my case I'm using a class c.\n\n241\n00:12:43.530 --> 00:12:44.864\nI'll open a curly brace and\n\n242\n00:12:44.864 --> 00:12:48.010\nthen I'll provide the range of\nIPs I'm going to be handing out.\n\n243\n00:12:48.010 --> 00:12:51.051\nSo we did 150 through 160, right?\n\n244\n00:12:51.051 --> 00:12:54.027\nSo we'll punch that in again,\nand you'll do a semicolon there.\n\n245\n00:12:54.027 --> 00:12:56.289\nI'm guilty of forgetting\nthat semicolon a lot, so\n\n246\n00:12:56.289 --> 00:12:57.983\nthat's why I kind of mention it here.\n\n247\n00:12:57.983 --> 00:12:59.880\nAnd I'll close that out.\n\n248\n00:12:59.880 --> 00:13:02.360\nThat is really the minimum I need here.\n\n249\n00:13:02.360 --> 00:13:06.050\nAnd so if I get that set up,\nI can come out.\n\n250\n00:13:06.050 --> 00:13:08.440\nAnd now I should\n\n251\n00:13:08.440 --> 00:13:12.020\nhave everything that I need to be\nable to get DHCP up and running.\n\n252\n00:13:12.020 --> 00:13:15.430\nThere's a few more things that we might\nwanna configure and get this set up.\n\n253\n00:13:15.430 --> 00:13:19.210\nBut the simple side, right,\nthe really simple stuff is just\n\n254\n00:13:19.210 --> 00:13:23.210\ndefine the network adapter and define\nthe IP range, and you're in business.\n\n255\n00:13:23.210 --> 00:13:27.530\n&gt;&gt; So where does that configuration\nneed to go then at this point?\n\n256\n00:13:27.530 --> 00:13:31.300\n&gt;&gt; So where we need to go, if I was\nediting that sample file anywhere else,\n\n257\n00:13:31.300 --> 00:13:35.510\nit needs to go right where I've\nalready kinda put it here,\n\n258\n00:13:35.510 --> 00:13:38.120\nwhich is /etc/dhcp/dhcp.com.\n\n259\n00:13:38.120 --> 00:13:40.890\nAnd I know it sounds kind of redundant\nthat I'm mentioning it here, but\n\n260\n00:13:40.890 --> 00:13:43.380\nI wanted to make sure I drive that home,\ncuz I'm guilty of it.\n\n261\n00:13:43.380 --> 00:13:47.360\nI've already done it twice in this episode\nalone where I forget that last little d,\n\n262\n00:13:47.360 --> 00:13:48.710\nand I call it dhcp.com for something.\n\n263\n00:13:48.710 --> 00:13:53.640\nSo it needs to be, /etc/dhcp/dhcpd.conf.\n\n264\n00:13:53.640 --> 00:13:55.347\nAnd once it's there, it's ready to go and\n\n265\n00:13:55.347 --> 00:13:57.393\nwe can fire this up and\nnow we've got a DHCP server.\n\n266\n00:13:57.393 --> 00:13:58.440\n&gt;&gt; So that's pretty simple.\n\n267\n00:13:58.440 --> 00:13:59.570\nCan we do more?\n\n268\n00:13:59.570 --> 00:14:01.700\n&gt;&gt; Absolutely, so\nall those other options, right?\n\n269\n00:14:01.700 --> 00:14:03.750\nI kinda glazed over the other options.\n\n270\n00:14:03.750 --> 00:14:04.810\nThey're not essential.\n\n271\n00:14:04.810 --> 00:14:06.570\nI don't have to have them.\n\n272\n00:14:06.570 --> 00:14:08.230\nBut you're gonna use them, right?\n\n273\n00:14:08.230 --> 00:14:11.402\nMost people who set up a DHCP server at\na minimum you wanna hand out a default\n\n274\n00:14:11.402 --> 00:14:13.256\ngateway, and DNS servers to use, right?\n\n275\n00:14:13.256 --> 00:14:15.640\nThose are some of the elements\nthat we wanna give out.\n\n276\n00:14:15.640 --> 00:14:19.200\nSo I wanna go in and\nmodify my configuration so\n\n277\n00:14:19.200 --> 00:14:21.940\nthat it's got a little bit more\nmeat to it than what I've got.\n\n278\n00:14:21.940 --> 00:14:24.025\nSo let's get back into that file, and\n\n279\n00:14:24.025 --> 00:14:27.555\nlet's turn this into a little\nmore full featured DHCP circuit.\n\n280\n00:14:27.555 --> 00:14:28.608\n&gt;&gt; Yeah, let's do that.\n\n281\n00:14:28.608 --> 00:14:31.390\n&gt;&gt; All right,\na couple of things that I wanna give out.\n\n282\n00:14:31.390 --> 00:14:35.650\nSo basically what I've defined\nhere is a subnet and a range.\n\n283\n00:14:35.650 --> 00:14:39.030\nIn addition to this,\nwe can start to provide options.\n\n284\n00:14:39.030 --> 00:14:41.650\nAnd the options can indicate\nall sorts of crazy things.\n\n285\n00:14:41.650 --> 00:14:44.260\nSo I'm gonna come in here and\njust add a little more to it, right?\n\n286\n00:14:44.260 --> 00:14:50.896\nSo a lot of times we'll add a option\nto give out a subnet mask, right?\n\n287\n00:14:50.896 --> 00:14:51.700\nWhen we hand out an IP,\n\n288\n00:14:51.700 --> 00:14:55.250\noddly enough it doesn't actually\nhand out a subnet mask by default.\n\n289\n00:14:55.250 --> 00:14:57.109\nOr it'll feed off of the one\non the network adapter and\n\n290\n00:14:57.109 --> 00:14:59.350\nnot necessarily the one we wanna give out.\n\n291\n00:14:59.350 --> 00:15:03.960\nSo I can tell it what net mask I wanna\ngive to the connections and the clients.\n\n292\n00:15:05.000 --> 00:15:08.160\nThen I can specify things like\nthe router I wanna give out.\n\n293\n00:15:08.160 --> 00:15:10.760\nSo I'm going to say option-routers.\n\n294\n00:15:10.760 --> 00:15:15.510\nAnd then I can provide one or more routers\nthat I want people to be able to use.\n\n295\n00:15:15.510 --> 00:15:17.464\nOn my network it's 172.16.0.2.\n\n296\n00:15:17.464 --> 00:15:18.696\nThat's the one I wanna hand out.\n\n297\n00:15:18.696 --> 00:15:21.920\nAnd so\nI'm going to provide that option as well.\n\n298\n00:15:21.920 --> 00:15:28.780\nWe can go a little further and specify\nthings like default DNS suffix list,\n\n299\n00:15:28.780 --> 00:15:35.120\nwhich would be optiondomain-search,\nand then the name.\n\n300\n00:15:35.120 --> 00:15:39.184\nSo I might want to search based on\nlab.ITPro.TV, for example, right?\n\n301\n00:15:39.184 --> 00:15:42.190\nSo that's another option that\nI might choose to hand out.\n\n302\n00:15:42.190 --> 00:15:46.370\nA couple other ones that I might wanna do,\nif I'm doing a default DNS suffix,\n\n303\n00:15:46.370 --> 00:15:48.890\nI should probably provide\nsome DNS servers.\n\n304\n00:15:48.890 --> 00:15:52.340\nSo let's do that, and I'll say,\noption domain-name-servers,\n\n305\n00:15:52.340 --> 00:15:57.760\nand I can provide one or more servers.\n\n306\n00:15:57.760 --> 00:16:00.014\nI'll provide two.\n\n307\n00:16:00.014 --> 00:16:02.666\nAnd, in the other examples,\nI always provided one value.\n\n308\n00:16:02.666 --> 00:16:05.719\nIf you ever provide more than one value,\nyou just do a comma, right?\n\n309\n00:16:05.719 --> 00:16:12.627\nSo I did 8.8.8.8 And then a comma,\nand led into 8.8.4.4 and a semi-colon.\n\n310\n00:16:12.627 --> 00:16:15.120\nSo now, I'm little more typical, right?\n\n311\n00:16:15.120 --> 00:16:18.356\nA DHCP server is gonna\nto give an IP address,\n\n312\n00:16:18.356 --> 00:16:22.037\na subnet mask, a router and\nDNS servers, right?\n\n313\n00:16:22.037 --> 00:16:24.160\nThat's kind of the typical stuff\nthat we're gonna hand out.\n\n314\n00:16:24.160 --> 00:16:26.540\nThis makes it a little more complex,\nbut not much, right?\n\n315\n00:16:26.540 --> 00:16:30.360\nAs long as we know the option names, and\nfortunately the options do have a name.\n\n316\n00:16:30.360 --> 00:16:34.170\nWe don't have to know the old DHCP\nserver numbers for each of these things.\n\n317\n00:16:34.170 --> 00:16:36.190\nLike option 67, and all that crazy stuff.\n\n318\n00:16:36.190 --> 00:16:40.860\nHere it's just subnet mask,\nrouters, domain name servers.\n\n319\n00:16:40.860 --> 00:16:41.620\nPretty easy.\n\n320\n00:16:41.620 --> 00:16:44.560\nWe get that in place, and\nnow we've kind of got it fired up.\n\n321\n00:16:44.560 --> 00:16:48.260\n&gt;&gt; So, how do we go about\nconfiguring DHCP leases?\n\n322\n00:16:48.260 --> 00:16:51.480\n&gt;&gt; Okay, so what I'm doing here\nis creating a pool, right.\n\n323\n00:16:51.480 --> 00:16:55.439\nAnd it's gonna be giving out addresses\non a first-come, first-served basis.\n\n324\n00:16:55.439 --> 00:16:58.742\nSo somebody comes along, and\nthey'll get 172.16.0.150, and\n\n325\n00:16:58.742 --> 00:17:01.040\nthen the next person will get .151,\nand 152.\n\n326\n00:17:01.040 --> 00:17:03.766\nBut a lot of times you wanna go,\nagain, a little further, and\n\n327\n00:17:03.766 --> 00:17:05.879\ncreate what are called static leases,\nright.\n\n328\n00:17:05.879 --> 00:17:07.410\n&gt;&gt; Static leases, that's right.\n\n329\n00:17:07.410 --> 00:17:09.550\n&gt;&gt; And a static lease is where I say,\nyou know what,\n\n330\n00:17:09.550 --> 00:17:14.400\nI want Zack's laptop to always\nget the same IP, all right?\n\n331\n00:17:14.400 --> 00:17:16.530\nSo it's still dynamic.\n\n332\n00:17:16.530 --> 00:17:18.850\nHis laptop boots up,\nit requests an address, but\n\n333\n00:17:18.850 --> 00:17:20.180\nI always give him the same one.\n\n334\n00:17:20.180 --> 00:17:22.760\nNow, static addresses are a little weird,\nright?\n\n335\n00:17:22.760 --> 00:17:24.990\nSo far everything's been,\nI think, pretty simple.\n\n336\n00:17:24.990 --> 00:17:27.580\nThis configuration file is pretty\nsmall compared to a lot of other\n\n337\n00:17:27.580 --> 00:17:29.030\nservices that are out there.\n\n338\n00:17:29.030 --> 00:17:31.829\nBut static leases\nare technically their own pool.\n\n339\n00:17:31.829 --> 00:17:37.080\nYou have to create a custom DHCP\nscope just for that one system.\n\n340\n00:17:37.080 --> 00:17:39.300\nSo let me give you an example of that.\n\n341\n00:17:39.300 --> 00:17:42.989\nIf I wanted to create one just for\nsay, my laptop.\n\n342\n00:17:42.989 --> 00:17:44.458\nActually, I don't know.\n\n343\n00:17:44.458 --> 00:17:48.180\nLet me go in here and\nsee what my MAC address is.\n\n344\n00:17:48.180 --> 00:17:52.850\nSo the way static leases work is,\nthey're keyed off of your MAC address.\n\n345\n00:17:52.850 --> 00:17:56.370\nSo, I need to come in and find what\nthe MAC address is for my laptop.\n\n346\n00:17:56.370 --> 00:18:01.042\nAnd so, here's my network adapter and\nI can find my, actually let's use,\n\n347\n00:18:01.042 --> 00:18:04.478\nifconfig was always better for\nshowing MAC addresses.\n\n348\n00:18:04.478 --> 00:18:07.360\nSo we can come in here,\nwe can pull my MAC address, right?\n\n349\n00:18:07.360 --> 00:18:08.670\nRight there, that's what I want.\n\n350\n00:18:08.670 --> 00:18:12.325\nSo that right there is the MAC address for\nmy laptop.\n\n351\n00:18:12.325 --> 00:18:15.711\nAnd I wanna make sure that every\ntime my laptop gets an IP address,\n\n352\n00:18:15.711 --> 00:18:18.350\nthat it's always gonna be the same one.\n\n353\n00:18:18.350 --> 00:18:20.460\nAnd so I can come in, and\nI can add a new entry.\n\n354\n00:18:20.460 --> 00:18:22.053\nNow, up here, see how I said subnet?\n\n355\n00:18:22.053 --> 00:18:25.270\nFor this next intro,\nI'm gonna do it a little different.\n\n356\n00:18:25.270 --> 00:18:27.530\nI'm gonna come in, and\nI'm gonna say, host.\n\n357\n00:18:27.530 --> 00:18:30.100\nAll right, so this is gonna be a host.\n\n358\n00:18:30.100 --> 00:18:30.958\nAnd you can give it a name.\n\n359\n00:18:30.958 --> 00:18:32.600\nNow, the name doesn't matter.\n\n360\n00:18:32.600 --> 00:18:33.590\nYou can call it whatever you want.\n\n361\n00:18:33.590 --> 00:18:35.360\nThe client never sees this name.\n\n362\n00:18:35.360 --> 00:18:36.350\nThe name's never actually used.\n\n363\n00:18:36.350 --> 00:18:38.110\nIt's not registered with DNS, or anything.\n\n364\n00:18:38.110 --> 00:18:42.740\nIt's just to help you identify inside\nof the DHCP configuration file, right?\n\n365\n00:18:42.740 --> 00:18:46.330\nSo I'm just gonna call it Don's Laptop but\nagain, it could be anything.\n\n366\n00:18:46.330 --> 00:18:51.560\nAnd I'll open up a curly brace, and\nnow it's basically just like a subnet.\n\n367\n00:18:51.560 --> 00:18:56.020\nI can provide options and\nother things just for this client.\n\n368\n00:18:56.020 --> 00:18:59.890\nIf I wanted to provide specific DNS\nservers or a specific router for\n\n369\n00:18:59.890 --> 00:19:01.320\nthis client, I could do it.\n\n370\n00:19:01.320 --> 00:19:06.930\nBut the main thing I need to do is,\nI need to say, hardware ethernet,\n\n371\n00:19:08.250 --> 00:19:13.050\nand then provide that MAC address\nthat I copied a moment ago.\n\n372\n00:19:13.050 --> 00:19:16.530\nSo now it knows how to identify my laptop.\n\n373\n00:19:16.530 --> 00:19:20.280\nWhen it sees a client connect\nwith this MAC address,\n\n374\n00:19:20.280 --> 00:19:22.120\nthen here's what it's going to do.\n\n375\n00:19:22.120 --> 00:19:25.740\nAnd so I'll say, fixed dash address, and\n\n376\n00:19:25.740 --> 00:19:27.840\nthen the address that I\nwant that client to get.\n\n377\n00:19:27.840 --> 00:19:30.686\nSo maybe I want my laptop to always\nget 172.16.0.222, all right.\n\n378\n00:19:30.686 --> 00:19:34.100\nSo I'll assign that.\n\n379\n00:19:34.100 --> 00:19:36.660\nAnd that's gonna be\nthe address that I get, okay.\n\n380\n00:19:36.660 --> 00:19:42.345\nNow, if I leave it exactly\nlike it's written here?\n\n381\n00:19:42.345 --> 00:19:45.110\nThat's all I'm gonna get,\nis an IP address, okay.\n\n382\n00:19:45.110 --> 00:19:49.300\nSo, I would really need to provide\na DNS server, and a router, and\n\n383\n00:19:49.300 --> 00:19:50.950\nother things, okay.\n\n384\n00:19:50.950 --> 00:19:54.080\nBut the way I've defined it here,\nI haven't done that.\n\n385\n00:19:54.080 --> 00:19:56.397\nSo my laptop is just gonna get an IP.\n\n386\n00:19:56.397 --> 00:19:59.130\nAnd I don't wanna type\nall of this stuff twice.\n\n387\n00:19:59.130 --> 00:20:03.150\nSo with DHCP, you can get really\nadvanced with your configurations.\n\n388\n00:20:03.150 --> 00:20:06.040\nAnd you can create what\nare called global options.\n\n389\n00:20:06.040 --> 00:20:09.670\nIf I want options to apply to more\nthan one of these little groupings,\n\n390\n00:20:09.670 --> 00:20:10.860\nactually not hard to do.\n\n391\n00:20:10.860 --> 00:20:15.300\nAll I need to do is go up top and\nspecify settings up here.\n\n392\n00:20:15.300 --> 00:20:19.669\nIf I say option, domain name servers, and\n\n393\n00:20:19.669 --> 00:20:26.090\nspecify domain name server like that,\nand then I say option,\n\n394\n00:20:26.090 --> 00:20:30.680\nrouters, and\nspecify a router like that, okay.\n\n395\n00:20:30.680 --> 00:20:32.640\nThose are global options.\n\n396\n00:20:32.640 --> 00:20:34.370\nI'm putting them up the top.\n\n397\n00:20:34.370 --> 00:20:39.250\nA group in here can override them\nreally easy, and that's fine, right?\n\n398\n00:20:39.250 --> 00:20:42.110\nBut if I don't override them like\nI'm doing here in my laptop,\n\n399\n00:20:42.110 --> 00:20:44.550\nit'll just take whatever's up here.\n\n400\n00:20:44.550 --> 00:20:48.320\nIn the global options, and that way\nif I'm gonna create 20 static leases,\n\n401\n00:20:48.320 --> 00:20:50.872\nI don't have to go in to\nfind DNS servers 20 times.\n\n402\n00:20:50.872 --> 00:20:52.693\nIt's really annoying, right, so\n\n403\n00:20:52.693 --> 00:20:55.848\nthese are global options I put\nright at the top of the file, and\n\n404\n00:20:55.848 --> 00:20:59.910\nthen that gives us that kind of\nstability and ease of management, right?\n\n405\n00:20:59.910 --> 00:21:03.550\nThe only negative here is,\nI don't have granular control anymore.\n\n406\n00:21:03.550 --> 00:21:06.400\nI have granular control when\nI do it inside of each pool.\n\n407\n00:21:06.400 --> 00:21:09.680\nSo you gotta choose what do you want,\nright, do you want granular control or\n\n408\n00:21:09.680 --> 00:21:10.940\ndo you want ease of administration?\n\n409\n00:21:10.940 --> 00:21:13.770\nAnd you kind of define things\nthe way that you want there.\n\n410\n00:21:13.770 --> 00:21:17.070\n&gt;&gt; So now that we're all configured,\nhow do we start it all up?\n\n411\n00:21:17.070 --> 00:21:20.010\n&gt;&gt; All right,\nonce you've got this all set up and\n\n412\n00:21:20.010 --> 00:21:22.120\neverything is syntactically correct,\nright?\n\n413\n00:21:22.120 --> 00:21:23.230\n&gt;&gt; Syntactically, I like that.\n\n414\n00:21:23.230 --> 00:21:24.670\n&gt;&gt; That's part of our challenge.\n\n415\n00:21:24.670 --> 00:21:27.458\nYou get typos, things don't work,\nand then you got a problem, right.\n\n416\n00:21:27.458 --> 00:21:31.792\nSo I wanna come in here and\njust basically try and start it up, right?\n\n417\n00:21:31.792 --> 00:21:34.330\nMy configuration file should be good.\n\n418\n00:21:34.330 --> 00:21:37.490\nWhen I start this it should read the file,\nparse it, if there's any errors,\n\n419\n00:21:37.490 --> 00:21:38.620\nwe'll find out right there.\n\n420\n00:21:38.620 --> 00:21:42.600\nIf there aren't errors, then it will load\nit up, and it'll create the DHCP database.\n\n421\n00:21:42.600 --> 00:21:44.935\nSo, I'm going to go ahead and\ndo a systemctl.\n\n422\n00:21:44.935 --> 00:21:50.543\nI will start dhcpd.service.\n\n423\n00:21:50.543 --> 00:21:52.110\nAnd, no errors.\n\n424\n00:21:52.110 --> 00:21:52.946\nRight, that's a good sign, right?\n\n425\n00:21:52.946 --> 00:21:53.668\n&gt;&gt; Wonderful, wonderful.\n\n426\n00:21:53.668 --> 00:21:55.220\n&gt;&gt; If I had errors,\nwe'd have to go find my typo.\n\n427\n00:21:55.220 --> 00:21:57.450\nSo, looks like everything\nkinda went through clear.\n\n428\n00:21:57.450 --> 00:22:00.650\nI got an error earlier cuz I didn't\nhave a configuration file, right?\n\n429\n00:22:00.650 --> 00:22:05.452\nNow, I don't get an error, cuz it read\nthe config and it should be up and going.\n\n430\n00:22:05.452 --> 00:22:06.741\n&gt;&gt; So what if it fails to start?\n\n431\n00:22:06.741 --> 00:22:08.908\n&gt;&gt; All right, so if it fails to start\nthat's troubleshooting time, right?\n\n432\n00:22:08.908 --> 00:22:09.800\n&gt;&gt; I know.\n\n433\n00:22:09.800 --> 00:22:13.450\n&gt;&gt; Hopefully you get an error on your\nscreen, and then it tells you what to do.\n\n434\n00:22:13.450 --> 00:22:18.910\nIf not, there's a neat little utility\nwhich I probably should have run and\n\n435\n00:22:18.910 --> 00:22:22.563\ndidn't, which is DHCPD,\nspace, config test.\n\n436\n00:22:22.563 --> 00:22:26.324\nAnd what that'll do is it'll scan through\nyour configuration and it'll look for\n\n437\n00:22:26.324 --> 00:22:27.490\nany errors, okay?\n\n438\n00:22:27.490 --> 00:22:31.380\nAnd if it finds errors it'll report\nthem back to you here, okay?\n\n439\n00:22:31.380 --> 00:22:36.600\nSo when I ran it, notice it kind of\nshows that it wrote zero deleted hosts,\n\n440\n00:22:36.600 --> 00:22:38.120\nwrote zero new dynamic hosts.\n\n441\n00:22:38.120 --> 00:22:41.000\nThat's because no one's actually\nconnected to my server yet.\n\n442\n00:22:41.000 --> 00:22:45.320\nBut as I look down here, I do have a no\nsubnet declaration for config tests.\n\n443\n00:22:45.320 --> 00:22:48.875\nWhen I ran the command line, I didn't\nprovide any sub net information so\n\n444\n00:22:48.875 --> 00:22:50.870\nit's just telling me I didn't do that.\n\n445\n00:22:50.870 --> 00:22:52.329\nAnd so it was giving me a whine, there.\n\n446\n00:22:52.329 --> 00:22:56.350\nIt's also telling me not configured\nto listen on any interfaces.\n\n447\n00:22:56.350 --> 00:22:57.249\nWhat's that all about?\n\n448\n00:22:57.249 --> 00:23:00.309\nI thought I defined that in the summons,\nso I might have an error there that I need\n\n449\n00:23:00.309 --> 00:23:03.484\nto double check, if I'm not listening on\nan interface, that would be a problem.\n\n450\n00:23:03.484 --> 00:23:05.850\nI might have a syntax error.\n\n451\n00:23:05.850 --> 00:23:08.960\nI might have a mistake on my part, right?\n\n452\n00:23:08.960 --> 00:23:14.410\nSo when we looked at that configuration\nfile, I defined a subnet right here\n\n453\n00:23:14.410 --> 00:23:20.479\nof 172.16.0.0 with a net\nmask of 255.255.255.0, okay.\n\n454\n00:23:20.479 --> 00:23:24.380\nI thought I had an interface that was\n172.16.0.100 in that subnet mask, but\n\n455\n00:23:24.380 --> 00:23:26.670\nif I didn't, that might be a problem.\n\n456\n00:23:26.670 --> 00:23:29.230\nOr, it might just not be noticing that.\n\n457\n00:23:29.230 --> 00:23:32.300\nI might have changed the IP address and I\nhaven't restarted the server since then or\n\n458\n00:23:32.300 --> 00:23:33.290\nrestarted the network servers.\n\n459\n00:23:33.290 --> 00:23:34.680\nI might be able to fix it there.\n\n460\n00:23:34.680 --> 00:23:37.940\nBut neither of those are really critical\nissues as long as the server's up and\n\n461\n00:23:37.940 --> 00:23:42.430\nhanding out addresses the way we intended\nto, so we can always double check that.\n\n462\n00:23:42.430 --> 00:23:45.390\nI can double check my address too,\nI guess, real quick.\n\n463\n00:23:45.390 --> 00:23:47.850\nJust to look, and yeah,\nI've got an address in that range.\n\n464\n00:23:47.850 --> 00:23:50.500\nSo I think it's just that I haven't\nrestarted my network service on that one.\n\n465\n00:23:50.500 --> 00:23:54.780\nBut, the DHCP config test tool is a great\nway to see if you've got errors in it.\n\n466\n00:23:54.780 --> 00:23:57.756\nIf you missed a semi-colon,\nif you typed a option wrong,\n\n467\n00:23:57.756 --> 00:24:00.695\nit'll pick that up real fast and\nreport that back to you.\n\n468\n00:24:00.695 --> 00:24:03.191\n&gt;&gt; Now, John, are there tools for\nmonitoring DHCP and\n\n469\n00:24:03.191 --> 00:24:04.955\nmake sure it's working correctly?\n\n470\n00:24:04.955 --> 00:24:07.870\n&gt;&gt; Yeah, yeah, so what's gonna happen is,\nonce your server is up and\n\n471\n00:24:07.870 --> 00:24:10.339\nrunning It should start\nhanding out addresses, right?\n\n472\n00:24:10.339 --> 00:24:12.580\nAnd you'll see that if you do journalctl,\n\n473\n00:24:12.580 --> 00:24:16.140\nyou can look inside of your system\nD journal and see those going out.\n\n474\n00:24:16.140 --> 00:24:18.210\nOr your syslog, it'll be in there too.\n\n475\n00:24:18.210 --> 00:24:23.260\nYou can tail the syslog and you'll see\nthose DHCP leases being handed out.\n\n476\n00:24:23.260 --> 00:24:26.010\nAnother easy way to do it is you\ncan just look to see if the lease\n\n477\n00:24:26.010 --> 00:24:27.290\ndatabase was created.\n\n478\n00:24:27.290 --> 00:24:33.200\nIf I go into /var/lib/DHCP D.\n\n479\n00:24:33.200 --> 00:24:37.140\nThat folder right there, /var/lib/DHCP D.\n\n480\n00:24:37.140 --> 00:24:41.580\nWhat you should see in there is\na file called DHCPD.resources.\n\n481\n00:24:41.580 --> 00:24:44.540\nWhenever somebody requests an IP,\nI'm gonna hand them an IP and\n\n482\n00:24:44.540 --> 00:24:46.890\nI'm gonna log it right\nhere to keep track of it.\n\n483\n00:24:46.890 --> 00:24:49.620\nAnd it's stored right here on the disk,\nwhich is really important.\n\n484\n00:24:49.620 --> 00:24:53.130\nBecause if the server reboots,\nyou don't wanna forget all of your leases.\n\n485\n00:24:53.130 --> 00:24:55.450\nNow the nice part about this file is,\nit is just a plain text file,\n\n486\n00:24:55.450 --> 00:24:57.460\nyou're not supposed to edit it.\n\n487\n00:24:57.460 --> 00:25:01.420\nIf you edit it, it can cause all sorts\nof problems, but you can just cad it or\n\n488\n00:25:01.420 --> 00:25:04.510\nmore or less or whatever and you can\nactually see what's inside of there.\n\n489\n00:25:04.510 --> 00:25:08.290\nAnd so here it's telling me that I've\ngot my servers' DUID in place but\n\n490\n00:25:08.290 --> 00:25:10.380\nI haven't issued any releases.\n\n491\n00:25:10.380 --> 00:25:13.339\nNow I can go to a client and request a\nlease, they should start showing up here.\n\n492\n00:25:13.339 --> 00:25:16.741\nAnd I can see when they start,\nwhen they stop, that's usually what I do.\n\n493\n00:25:16.741 --> 00:25:21.720\nIf you wanna look at the logs,\ninside of /var/log,\n\n494\n00:25:21.720 --> 00:25:25.048\nyou'll find a dedicated DHCP log.\n\n495\n00:25:25.048 --> 00:25:27.400\nI don't have one yet\njust cuz nothing has happened.\n\n496\n00:25:27.400 --> 00:25:29.241\nBut it'll be called DHCP d.log.\n\n497\n00:25:29.241 --> 00:25:30.050\nIt will show up there.\n\n498\n00:25:30.050 --> 00:25:33.890\nOr you can do a journal CTL.\n\n499\n00:25:33.890 --> 00:25:37.930\nAnd you can filter by unit, so\nI can filter just by DHCPD and\n\n500\n00:25:37.930 --> 00:25:39.650\nnow I can start to see information.\n\n501\n00:25:39.650 --> 00:25:42.710\nHere's the output from when I\nran that config test, right?\n\n502\n00:25:42.710 --> 00:25:47.272\nAnd so it's showing the same kind of\nlittle error message that I saw in\n\n503\n00:25:47.272 --> 00:25:49.958\nthe config test, but, or actually no.\n\n504\n00:25:49.958 --> 00:25:51.483\nThose are from when I\ntried to start it earlier.\n\n505\n00:25:51.483 --> 00:25:53.059\n&gt;&gt; Right.\n&gt;&gt; Right, I tried to start it earlier and\n\n506\n00:25:53.059 --> 00:25:55.130\nI got a bunch of errors cuz\nit wasn't configured yet.\n\n507\n00:25:55.130 --> 00:25:58.135\nBut down here we can see that it\nactually was able to start, in the end.\n\n508\n00:25:58.135 --> 00:26:00.950\nSo you can start to look\nat all of that information.\n\n509\n00:26:01.980 --> 00:26:06.470\nAnother one that I'll do sometimes,\na lot of times the output here is good but\n\n510\n00:26:06.470 --> 00:26:07.610\nsometimes it's not great.\n\n511\n00:26:07.610 --> 00:26:10.120\nSo I might wanna come in and\nfilter this a little bit to change it and\n\n512\n00:26:10.120 --> 00:26:11.750\nI'll add x and e.\n\n513\n00:26:11.750 --> 00:26:13.760\nWhich gives you the extended display and\n\n514\n00:26:13.760 --> 00:26:17.168\nan explanation, so\nnow you get more detailed information.\n\n515\n00:26:17.168 --> 00:26:19.240\nIt helps you identify whether or\n\n516\n00:26:19.240 --> 00:26:22.740\nnot an error is something\nyou actually need to act on.\n\n517\n00:26:22.740 --> 00:26:25.480\nSome of this,\nI mean I've got multiple network adaptors.\n\n518\n00:26:25.480 --> 00:26:29.550\nSo I've got no subnet\ndeclaration on ENS 38, 37, 36.\n\n519\n00:26:29.550 --> 00:26:33.890\nBut that's okay because I've got another\nnetwork adapter that it is listening on,\n\n520\n00:26:33.890 --> 00:26:34.950\nand so I don't need to worry about that.\n\n521\n00:26:34.950 --> 00:26:38.540\nSo just because there's an error\nisn't necessarily meaning that your\n\n522\n00:26:38.540 --> 00:26:40.130\nsystem is dead in the water.\n\n523\n00:26:40.130 --> 00:26:45.140\nSo, for example, my main network adapter,\nif I pull it up,\n\n524\n00:26:45.140 --> 00:26:49.830\nis 33, and ENS 33 wasn't in these errors,\nso I can ignore that.\n\n525\n00:26:49.830 --> 00:26:54.090\nBut this is a great way to go and look and\nspot for those types of errors, messages,\n\n526\n00:26:54.090 --> 00:26:55.580\nthings that we need to worry about.\n\n527\n00:26:55.580 --> 00:26:57.340\nAnd go in and deal with that.\n\n528\n00:26:57.340 --> 00:26:58.230\n&gt;&gt; Fantastic.\n\n529\n00:26:58.230 --> 00:27:02.420\n&gt;&gt; That also explains why my config test\ngave those no subnet detected, errors.\n\n530\n00:27:02.420 --> 00:27:04.285\nWas because of those other\nnetwork adapters that I had.\n\n531\n00:27:04.285 --> 00:27:07.329\nI should probably go and disable those\nadapters, since I'm not using them, but\n\n532\n00:27:07.329 --> 00:27:09.586\nIt's no big deal,\nthat's something that can be ignored.\n\n533\n00:27:09.586 --> 00:27:13.441\n&gt;&gt; Wonderful, well, everything you\nneed to know for installing DHCPD,\n\n534\n00:27:13.441 --> 00:27:14.990\nbrought to you by Don Pezet.\n\n535\n00:27:14.990 --> 00:27:16.990\nDon, any last words before we move on?\n\n536\n00:27:16.990 --> 00:27:20.130\n&gt;&gt; Main thing with DHCP,\ndo know that it's pretty straightforward.\n\n537\n00:27:20.130 --> 00:27:21.600\nThe config files are simple.\n\n538\n00:27:21.600 --> 00:27:23.365\nIf you wanna back it up?\n\n539\n00:27:23.365 --> 00:27:27.037\nYou really just need that leases file and\nthe config file, and if you wanna move to\n\n540\n00:27:27.037 --> 00:27:30.494\nanother server, you can actually move\nthose to a new server and fire it up and\n\n541\n00:27:30.494 --> 00:27:33.240\nit works out fine, so\nthat's pretty straight forward.\n\n542\n00:27:33.240 --> 00:27:36.650\nThere are a number of attacks that are on\nthe network, or that are out in the wild\n\n543\n00:27:36.650 --> 00:27:40.085\nthat attack DHCP servers that can do\nwhat are called DHCP starvation attacks.\n\n544\n00:27:40.085 --> 00:27:43.160\nSo if you're gonna deploy this in\nthe wild, you'll probably want to step\n\n545\n00:27:43.160 --> 00:27:46.102\na little further and do things like\ndeploy the failed demand service.\n\n546\n00:27:46.102 --> 00:27:50.986\nWhich will let you detect when somebody\nis trying to just sap up too many IPs and\n\n547\n00:27:50.986 --> 00:27:53.410\nyou can kind of rate limit them.\n\n548\n00:27:53.410 --> 00:27:56.790\nAnd there's a few other things you can\ndo like that, that are very similar.\n\n549\n00:27:56.790 --> 00:28:00.050\nThere's also things like super scopes\n\n550\n00:28:00.050 --> 00:28:02.990\nwhere you can gather multiple scopes\ntogether and have option sets for them.\n\n551\n00:28:02.990 --> 00:28:05.880\nI showed you global options and\noptions inside of a scope.\n\n552\n00:28:05.880 --> 00:28:09.180\nWhere you can actually collect just a few\nscopes and give them some options that\n\n553\n00:28:09.180 --> 00:28:12.280\naren't global but aren't unique to\na scope, so really advanced stuff,\n\n554\n00:28:12.280 --> 00:28:15.620\nif you dig through the sample file for\nDHCP, you'll see a lot of that.\n\n555\n00:28:15.620 --> 00:28:18.470\nBut everything we've seen here is\nwhat you need to get a basic DHCP\n\n556\n00:28:18.470 --> 00:28:19.450\nserver up and running.\n\n557\n00:28:19.450 --> 00:28:20.890\n&gt;&gt; Great job as usual, Don.\n\n558\n00:28:20.890 --> 00:28:23.890\nTurning over every stone,\nmaking sure we know it all, and\n\n559\n00:28:23.890 --> 00:28:25.170\nwe appreciate it so very much.\n\n560\n00:28:25.170 --> 00:28:29.910\nAnd there's a lot of content in Becoming\na Linux Server Administrator series.\n\n561\n00:28:29.910 --> 00:28:31.480\nMake sure you watch each and every video.\n\n562\n00:28:31.480 --> 00:28:33.160\nYou'll be very glad you did.\n\n563\n00:28:33.160 --> 00:28:35.170\nAnd thank you for watching ITProTV.\n\n564\n00:28:35.170 --> 00:28:38.200\nRemember, a good IT pro\nis always learning.\n\n565\n00:28:38.200 --> 00:28:39.240\nI'm Zach Memos.\n\n566\n00:28:39.240 --> 00:28:40.030\n&gt;&gt; And I'm Don Pezet.\n\n567\n00:28:40.030 --> 00:28:42.453\n&gt;&gt; And we will see you soon.\n\n568\n00:28:42.453 --> 00:28:48.469\n[MUSIC]\n\n569\n00:28:48.469 --> 00:28:51.020\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "228812754"
        }
      ],
      "title": "Configuring a DHCP Server"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach discuss what software is needed, installing a minimal Apache web server, installing a 'feature rich' Apache web server, and the minimum configuration needed to get started.",
          "length": "1153",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-1-1-installing_httpd-080717-PGM.00_18_58_04.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-1-1-installing_httpd-080717-PGM.00_18_58_04.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-1-1-installing_httpd-080717-PGM.00_18_58_04.Still001-sm.jpg",
          "title": "Installing httpd",
          "transcript": "WEBVTT\n\n1\n00:00:00.220 --> 00:00:01.576\nWelcome to ITPROTV.\n\n2\n00:00:01.576 --> 00:00:02.234\nI'm your host.\n\n3\n00:00:02.234 --> 00:00:06.274\n[CROSSTALK]\n\n4\n00:00:06.274 --> 00:00:08.287\n[MUSIC]\n\n5\n00:00:08.287 --> 00:00:11.987\n&gt;&gt; You're watching ITPROTV.\n\n6\n00:00:11.987 --> 00:00:15.320\n&gt;&gt; Hello and thank you for watching ITPRO\nTV helping you learn where ever you go.\n\n7\n00:00:15.320 --> 00:00:17.610\nI am your host Zach Memos.\n\n8\n00:00:17.610 --> 00:00:21.620\nThis as we continue on becoming\nLinux server administrator.\n\n9\n00:00:21.620 --> 00:00:24.772\nIn this episode,\nwe will be installing HTTPD.\n\n10\n00:00:24.772 --> 00:00:29.260\n&gt;&gt; [LAUGH]\n&gt;&gt; [LAUGH] How is that and\n\n11\n00:00:29.260 --> 00:00:31.790\nwhat is that,\nDon Pezet's gonna tell us everything.\n\n12\n00:00:31.790 --> 00:00:33.440\nThank you, Don, good to see you.\n\n13\n00:00:33.440 --> 00:00:35.610\n&gt;&gt; All right, well, I don't blame you for\nbeing confused on this one, Zach,\n\n14\n00:00:35.610 --> 00:00:37.920\ncuz we could have named this show\na ton of different things, right?\n\n15\n00:00:37.920 --> 00:00:40.250\nIt could have been called\nlet's set up a web server,\n\n16\n00:00:40.250 --> 00:00:43.000\nit could have been called let's\ninstall Apache version two, right?\n\n17\n00:00:43.000 --> 00:00:47.260\nBecause A lot of this stuff,\nit really gets more than one name, right?\n\n18\n00:00:47.260 --> 00:00:50.160\nSo we are gonna be installing and\nsetting up HTTPD,\n\n19\n00:00:50.160 --> 00:00:54.195\nthe hypertext transport protocol daemon.\n\n20\n00:00:54.195 --> 00:00:54.854\n&gt;&gt; [LAUGH]\n&gt;&gt; There we go.\n\n21\n00:00:54.854 --> 00:00:56.083\n[LAUGH] It's hard for me.\n\n22\n00:00:56.083 --> 00:00:58.018\n&gt;&gt; [LAUGH] There's a few letters there.\n\n23\n00:00:58.018 --> 00:01:02.112\n&gt;&gt; Which Iis a web server and\nin turn is actually Apache version 2 and\n\n24\n00:01:02.112 --> 00:01:06.620\nApache is one of the most popular\nweb servers in the entire planet.\n\n25\n00:01:06.620 --> 00:01:11.530\nIt's not the only one there\nare other ones that are out there.\n\n26\n00:01:11.530 --> 00:01:13.680\nThere's Engine X which is\ntechnically a proxy server but\n\n27\n00:01:13.680 --> 00:01:16.630\nit is rapidly gaining as a web server.\n\n28\n00:01:16.630 --> 00:01:19.900\nYou've got IIS and Websphere and\nother products like that so\n\n29\n00:01:19.900 --> 00:01:21.148\nthere are plenty other ones.\n\n30\n00:01:21.148 --> 00:01:25.610\nA light HTTPD is another one but\nin most distros,\n\n31\n00:01:25.610 --> 00:01:29.250\nif you go to set up a web\nserver the default is Apache.\n\n32\n00:01:29.250 --> 00:01:30.720\nApache version two and\n\n33\n00:01:30.720 --> 00:01:34.210\nso when we say HTTPD,\nthat's what we're really talking about.\n\n34\n00:01:34.210 --> 00:01:38.840\nWhen want to get installed we referred\nto it as HTTPD even the config files and\n\n35\n00:01:38.840 --> 00:01:41.530\nso on but it is actually Apache\nyou very rarely actually\n\n36\n00:01:41.530 --> 00:01:44.490\nsee the name Apache mentioned\nwhile we're doing the set up.\n\n37\n00:01:44.490 --> 00:01:48.100\nBut, that is, is kind of,\nwhat it actually is.\n\n38\n00:01:48.100 --> 00:01:49.950\nSo, that's what we're going\nto look at in this episode.\n\n39\n00:01:49.950 --> 00:01:51.510\nOur longest intro ever.\n\n40\n00:01:51.510 --> 00:01:54.510\nWe're going to talk about getting that\nweb server stood up, get it in place,\n\n41\n00:01:54.510 --> 00:01:56.830\nand actually start providing\nweb pages to people.\n\n42\n00:01:56.830 --> 00:01:57.910\n&gt;&gt; And we're very excited about it.\n\n43\n00:01:57.910 --> 00:01:59.340\nSo, what software do we need?\n\n44\n00:01:59.340 --> 00:02:01.025\nAll right, so we need Apache, right?\n\n45\n00:02:01.025 --> 00:02:02.550\n&gt;&gt; Mm-hm, that's right.\n&gt;&gt; This is where the tricky name\n\n46\n00:02:02.550 --> 00:02:03.850\npart comes in,\ncuz we're gonna install them.\n\n47\n00:02:03.850 --> 00:02:05.400\nWe don't actually type\nApache at any point.\n\n48\n00:02:05.400 --> 00:02:10.060\nSo for example, here on my system, I'm\non a Red Hat Enterprise Linux server and\n\n49\n00:02:10.060 --> 00:02:13.450\nif I wanna get this\ninstalled I'm gonna type.\n\n50\n00:02:13.450 --> 00:02:17.230\nWell, actually before I even do that\nI need to sudo a lot of this stuff.\n\n51\n00:02:17.230 --> 00:02:18.150\nI need to be the root user.\n\n52\n00:02:18.150 --> 00:02:20.950\nSo I've done a pseudo-s\nto elevate my privileges.\n\n53\n00:02:20.950 --> 00:02:24.190\nSo just so you know If you're running this\na regular user you'll need to pseudo,\n\n54\n00:02:24.190 --> 00:02:25.570\nevery single command\nthat we have to do for\n\n55\n00:02:25.570 --> 00:02:29.770\nthis episode but\nI'm in an elevated show right now.\n\n56\n00:02:29.770 --> 00:02:36.950\nSo I'm going to say yum install HTTPD,\nnot Apache not Apache two just HTTPD.\n\n57\n00:02:36.950 --> 00:02:41.050\nAnd when you do that it's going to\nreach out and it's going to find it.\n\n58\n00:02:41.050 --> 00:02:44.520\nNotice that it never says Apache,\nbut it is what it is.\n\n59\n00:02:44.520 --> 00:02:47.610\nWe're actually gonna do a search, and\nsearch the description of the package,\n\n60\n00:02:47.610 --> 00:02:51.090\nwe're gonna see what it tells you\nthat it is Apache version too.\n\n61\n00:02:51.090 --> 00:02:53.260\nBut it's gonna reach out and\nit's gonna find it.\n\n62\n00:02:53.260 --> 00:02:55.845\nThis is the bare minimum then we need.\n\n63\n00:02:55.845 --> 00:03:01.205\nHTTPD then right along side the HTTPD,\nHTTPD tools right.\n\n64\n00:03:01.205 --> 00:03:02.455\nThose two things we need.\n\n65\n00:03:02.455 --> 00:03:08.325\nThey're not very big two packers super\nsmall, they install really really fast.\n\n66\n00:03:08.325 --> 00:03:12.195\nNow Zach's question was what\nsoftware do we really need?\n\n67\n00:03:12.195 --> 00:03:14.875\nAnd that's the answer right\nthere that's all we need.\n\n68\n00:03:14.875 --> 00:03:16.920\nBut if we change that a little bit.\n\n69\n00:03:16.920 --> 00:03:18.960\nLet's say,\nwhat software do we want, right?\n\n70\n00:03:18.960 --> 00:03:20.610\n&gt;&gt; That's another story.\n\n71\n00:03:20.610 --> 00:03:22.075\n&gt;&gt; Yeah, let's have some fun here.\n\n72\n00:03:22.075 --> 00:03:23.670\n&gt;&gt; [LAUGH]\n&gt;&gt; Apache by itself,\n\n73\n00:03:23.670 --> 00:03:25.400\ncan serve static web pages.\n\n74\n00:03:25.400 --> 00:03:26.790\nBut what do people do today?\n\n75\n00:03:26.790 --> 00:03:30.470\nRight, web 2.0 or 3.0, or whatever heck\nweb version we're up to these days.\n\n76\n00:03:30.470 --> 00:03:31.750\nPeople love dynamic languages.\n\n77\n00:03:31.750 --> 00:03:34.900\nThey love PHP and Pearl, and all these\nother things to be jammed into their\n\n78\n00:03:34.900 --> 00:03:38.470\nweb server well beyond what\na basic web server needs.\n\n79\n00:03:38.470 --> 00:03:41.220\nSo there are other\npackages we can install.\n\n80\n00:03:41.220 --> 00:03:44.490\nIn fact, if I had done,\ninstead of yum install http,\n\n81\n00:03:44.490 --> 00:03:50.110\nif I had done yum group\ninstall web server.\n\n82\n00:03:50.110 --> 00:03:52.880\nAnd I got to put web server in quotes\nbecause there's a space in between it.\n\n83\n00:03:52.880 --> 00:03:56.470\nBut if I told it to do a group install,\nit's going to install HTTPD\n\n84\n00:03:56.470 --> 00:03:59.640\nalong with several other\npackages that are pretty handy.\n\n85\n00:03:59.640 --> 00:04:02.930\nAnd let me just give you an example\nof that as it pulls up that list.\n\n86\n00:04:02.930 --> 00:04:05.770\nFirst off, you're going to notice there's\nmore than just two packages here.\n\n87\n00:04:05.770 --> 00:04:08.250\nRight?\nIt is getting HTTPD and\n\n88\n00:04:08.250 --> 00:04:10.260\nHTTPD tools, right?\n\n89\n00:04:10.260 --> 00:04:12.260\nBut it's also getting mod SSL.\n\n90\n00:04:12.260 --> 00:04:13.870\nDo you wanna do secure web pages?\n\n91\n00:04:13.870 --> 00:04:16.250\nYou're darn right you do,\nso we need that module.\n\n92\n00:04:16.250 --> 00:04:17.520\nSo we need that one.\n\n93\n00:04:17.520 --> 00:04:20.130\nThe manual,\nit's kinda nice to have documentation.\n\n94\n00:04:20.130 --> 00:04:21.390\nThat's a good one to have.\n\n95\n00:04:21.390 --> 00:04:24.210\nCrypto utils, again if you're gonna\nbe working with certificates,\n\n96\n00:04:24.210 --> 00:04:25.280\nyou're gonna need that one.\n\n97\n00:04:25.280 --> 00:04:28.510\nSo these are some extra\npackages that we need.\n\n98\n00:04:28.510 --> 00:04:33.150\nBut notice that it's still not\ndoing like PHP, for example.\n\n99\n00:04:33.150 --> 00:04:37.940\nSo if you're on a red hat basis or\nsense task,\n\n100\n00:04:37.940 --> 00:04:41.750\nthere's actually another group,\nwhich it almost seems contradictory.\n\n101\n00:04:41.750 --> 00:04:45.020\nBut instead of web server,\nyou can say basic web server.\n\n102\n00:04:45.020 --> 00:04:48.584\nAnd at first when it sounds like,\nthat's just basics,\n\n103\n00:04:48.584 --> 00:04:50.650\neven less than what we just saw.\n\n104\n00:04:50.650 --> 00:04:52.800\nWell, in actuality, it's more.\n\n105\n00:04:52.800 --> 00:04:56.070\nWhat Red Hat did is they said, look, what\nare the basic tools that everybody needs.\n\n106\n00:04:56.070 --> 00:04:58.440\nIf you're standing up a lamp stack,\n\n107\n00:04:58.440 --> 00:05:03.040\nwhat do you need to get Apache\nconfigured right to be put into use.\n\n108\n00:05:03.040 --> 00:05:05.320\nAnd so\nif we take a look at that group install,\n\n109\n00:05:05.320 --> 00:05:09.780\nyou'll see it adds quite a few packages,\nright, quite a bit more.\n\n110\n00:05:09.780 --> 00:05:11.190\nAnd just taking a look,\n\n111\n00:05:11.190 --> 00:05:14.630\nyou'll see where there's Python\nsupport that's being introduced.\n\n112\n00:05:14.630 --> 00:05:19.010\nWe got a lot of libraries that are being\nloaded into a error reporting tools.\n\n113\n00:05:19.010 --> 00:05:23.680\nThat's what the ABRT are that's\npart of their error reporting tool.\n\n114\n00:05:23.680 --> 00:05:29.060\nYou'll see a lot of other things that are\nbeing loaded in to get it up and going.\n\n115\n00:05:29.060 --> 00:05:30.230\nBut even this one,\n\n116\n00:05:30.230 --> 00:05:34.910\nthat's loading a ton of stuff, is still\nnot loading PHP, which most of us need.\n\n117\n00:05:34.910 --> 00:05:39.450\nSo bear in mind, that when you install\na web server, you need to understand\n\n118\n00:05:39.450 --> 00:05:42.790\nthe different modules, the different\ncomponents that your solution needs.\n\n119\n00:05:42.790 --> 00:05:44.660\nIf you're not gonna be hosting PHP pages,\n\n120\n00:05:44.660 --> 00:05:47.400\ndon't install PHP cuz you're\nincreasing your attack surface.\n\n121\n00:05:47.400 --> 00:05:50.700\nYou're giving hackers more room to work,\nright.\n\n122\n00:05:50.700 --> 00:05:52.330\nBut if you need PHP, you gotta install it.\n\n123\n00:05:52.330 --> 00:05:54.260\nIf I'm not gonna use Pearl,\ndon't install Pearl.\n\n124\n00:05:54.260 --> 00:05:56.420\nYou wanna do the bare minimum.\n\n125\n00:05:56.420 --> 00:05:59.400\nAnd so,\nthese group installs are kind of nice,\n\n126\n00:05:59.400 --> 00:06:02.020\nif you know you need all the components\nthat are inside of them.\n\n127\n00:06:02.020 --> 00:06:02.600\nOkay?\n\n128\n00:06:02.600 --> 00:06:06.070\nI'm not the biggest fan of\nthe Basic Web Server group.\n\n129\n00:06:06.070 --> 00:06:10.520\nI usually just do the regular Web Server\ngroup because that's gonna give us\n\n130\n00:06:10.520 --> 00:06:13.940\nthe Apache along with\nSSL which I always do.\n\n131\n00:06:13.940 --> 00:06:17.110\nSo those are kinda two components\nthat I know I'm gonna need.\n\n132\n00:06:17.110 --> 00:06:18.660\nAnd so I usually load that.\n\n133\n00:06:18.660 --> 00:06:20.580\nAnd then we'll typically\nhave to follow this up.\n\n134\n00:06:20.580 --> 00:06:23.560\nIf you're doing a LAMP stack,\nLAMP is Linux.\n\n135\n00:06:23.560 --> 00:06:25.430\nI've got Red Hat, done.\n\n136\n00:06:25.430 --> 00:06:27.420\nApache, well here's Apache.\n\n137\n00:06:29.530 --> 00:06:31.140\nLAMP, MySQL or MariaDB.\n\n138\n00:06:31.140 --> 00:06:33.290\nI need a database server,\nso I'd have to add that.\n\n139\n00:06:33.290 --> 00:06:35.860\nAnd then the P is PHP, right?\n\n140\n00:06:35.860 --> 00:06:39.370\nSo I would need to install each of those\ncomponents to build up that lampsec.\n\n141\n00:06:39.370 --> 00:06:40.640\nThis is just the Apache piece.\n\n142\n00:06:40.640 --> 00:06:43.990\nI'm gonna go ahead and say yes to that,\nand let that get installed.\n\n143\n00:06:43.990 --> 00:06:47.150\nAnd once it's done, once it's in there,\n\n144\n00:06:47.150 --> 00:06:51.790\nit's gonna install and\nnow I've got Apache.\n\n145\n00:06:51.790 --> 00:06:54.750\nRight, so I've installed it, and\nit really wasn't that big of a deal.\n\n146\n00:06:54.750 --> 00:06:57.585\n&gt;&gt; So what is the minimum\nconfiguration we need to get started?\n\n147\n00:06:57.585 --> 00:06:59.540\n&gt;&gt; So Apache's kind of nice.\n\n148\n00:06:59.540 --> 00:07:02.400\nIf you're watching these shows in order\nyou might have seen our DHCP show where we\n\n149\n00:07:02.400 --> 00:07:05.010\nhad to jump through all sorts of\nhoops just to get the server started.\n\n150\n00:07:05.010 --> 00:07:07.530\nWith Apache it's actually ready to go.\n\n151\n00:07:07.530 --> 00:07:13.050\nI can come in and\nI can say systemctl enable HTTPD or\n\n152\n00:07:13.050 --> 00:07:16.640\nreally if I wanna be fully accurate\nI should say httpd.service.\n\n153\n00:07:16.640 --> 00:07:20.190\nAnd then I can say start,\nand I can start it up.\n\n154\n00:07:20.190 --> 00:07:25.980\nA patchy comes with a default\nconfiguration, that is already setup.\n\n155\n00:07:25.980 --> 00:07:28.330\nIt's already got everything we need\njust to get the web server up and\n\n156\n00:07:28.330 --> 00:07:30.050\nrunning serving basic pages.\n\n157\n00:07:30.050 --> 00:07:30.870\nAnd so, it's up and running.\n\n158\n00:07:30.870 --> 00:07:31.960\nI don't have to configure a darn thing.\n\n159\n00:07:31.960 --> 00:07:34.520\nI just need to look at\nwhatever my IP address is.\n\n160\n00:07:34.520 --> 00:07:38.201\nAnd so, my IP address is 172.16.0.100.\n\n161\n00:07:38.201 --> 00:07:44.630\nAnd then on my work station,\nI can fire up a web browser.\n\n162\n00:07:44.630 --> 00:07:46.880\nSo now I can jump over to my client and\nI can tested out, right?\n\n163\n00:07:46.880 --> 00:07:48.250\nSo HTTP is up and running.\n\n164\n00:07:48.250 --> 00:07:51.140\nAnd if I punch in an IP address,\n\n165\n00:07:51.140 --> 00:07:55.690\nI'll punch in the IP of my server,\nand I get this, I can't be reached.\n\n166\n00:07:55.690 --> 00:07:56.570\nSorry.\n\n167\n00:07:56.570 --> 00:07:58.080\nI kinda forgot something important here.\n\n168\n00:07:59.280 --> 00:08:02.650\nI said, that Apache has a default\nconfiguration that works out of\n\n169\n00:08:02.650 --> 00:08:03.820\nthe box, and it does.\n\n170\n00:08:03.820 --> 00:08:05.930\nThe Apache is up and running.\n\n171\n00:08:05.930 --> 00:08:08.150\nI forgot to open it up in the firewall.\n\n172\n00:08:08.150 --> 00:08:09.680\nTechnically that's not\nApache's configuration,\n\n173\n00:08:09.680 --> 00:08:11.210\nthat's the firewall's configuration.\n\n174\n00:08:11.210 --> 00:08:15.170\nMost Linux systems have a firewall,\nmost of them are running Firewall D.\n\n175\n00:08:15.170 --> 00:08:17.850\nSome are still running IP tables,\nyou can jump into the configuration and\n\n176\n00:08:17.850 --> 00:08:19.030\nadd it to IP tables.\n\n177\n00:08:19.030 --> 00:08:21.610\nFirewall D is super easy though,\nI can just add that real quick.\n\n178\n00:08:21.610 --> 00:08:24.470\nSo I'm gonna switch back\nover to my server here.\n\n179\n00:08:24.470 --> 00:08:29.960\nAnd in my server I can just\ndo a quick firewall-cmd.\n\n180\n00:08:29.960 --> 00:08:34.964\nAnd I want to add-service=http.\n\n181\n00:08:34.964 --> 00:08:37.265\nSo I'm gonna open that one up.\n\n182\n00:08:37.265 --> 00:08:40.090\nAnd then I'll do the same\nthing with HTTPS.\n\n183\n00:08:40.090 --> 00:08:41.450\nI haven't set up SSL yet.\n\n184\n00:08:41.450 --> 00:08:44.250\nBut it actually does have\na default SSL certificate if\n\n185\n00:08:44.250 --> 00:08:46.870\nyou installed mod_ssl that it can use.\n\n186\n00:08:46.870 --> 00:08:50.030\nNow, be careful with firewall-cmd\nbecause that just modifies the temporary\n\n187\n00:08:50.030 --> 00:08:53.320\nconfiguration, which running in memory\nif I reboot I'm going to lose that, so\n\n188\n00:08:53.320 --> 00:08:58.233\nI'm going to re-run those\nlines with --permanent, okay.\n\n189\n00:08:58.233 --> 00:09:01.310\nAnd don't think you can just run the\npermanent line because that just modifies\n\n190\n00:09:01.310 --> 00:09:04.560\nwhat's saved on disk not what's in memory,\nso you really do need to run both sets\n\n191\n00:09:04.560 --> 00:09:07.800\nto get this up and going unless you\nplan on restarting the network service.\n\n192\n00:09:07.800 --> 00:09:09.210\nBut now, it's open on the firewall.\n\n193\n00:09:09.210 --> 00:09:13.640\nSo I can jump back to my client and\nI can browse that IP.\n\n194\n00:09:13.640 --> 00:09:14.480\nThere we go.\n\n195\n00:09:14.480 --> 00:09:19.950\nI'm getting the Red Hat Enterprise Linux\ntest page because I'm on Red Hat.\n\n196\n00:09:19.950 --> 00:09:22.910\nIf you were on CentOS or\nif you were on Debian,\n\n197\n00:09:22.910 --> 00:09:25.340\nUbuntu, you would see something\na little bit different there.\n\n198\n00:09:25.340 --> 00:09:27.770\nBut the overall page is pretty similar.\n\n199\n00:09:27.770 --> 00:09:31.480\nAnd here's the first real hint that\nI get that I'm running Apache.\n\n200\n00:09:31.480 --> 00:09:33.700\nI see this is powered by Apache 2.4.\n\n201\n00:09:33.700 --> 00:09:36.400\nUp until now, I keep seeing HTTPD.\n\n202\n00:09:36.400 --> 00:09:39.180\nHere, I can actually see that name.\n\n203\n00:09:39.180 --> 00:09:42.570\nThis is just a sample page that's\ninstalled by default to let you test and\n\n204\n00:09:42.570 --> 00:09:44.070\nmake sure the web server is working.\n\n205\n00:09:44.070 --> 00:09:46.170\nI haven't changed my configuration at all.\n\n206\n00:09:46.170 --> 00:09:47.460\nI installed Apache.\n\n207\n00:09:47.460 --> 00:09:49.890\nI opened it up on the firewall,\nand here I am.\n\n208\n00:09:49.890 --> 00:09:53.770\nSo that's all it really took to\nget this thing up and started.\n\n209\n00:09:53.770 --> 00:09:56.310\n&gt;&gt; Well that's pretty simple,\nI mean, can we do more?\n\n210\n00:09:56.310 --> 00:09:57.810\n&gt;&gt; Yeah, absolutely.\n\n211\n00:09:57.810 --> 00:10:01.440\nHopefully, if you're following along,\nall that went as a breeze, right?\n\n212\n00:10:01.440 --> 00:10:02.700\nBut things could have gone wrong.\n\n213\n00:10:02.700 --> 00:10:05.620\nYou can always double check and\nmake sure that, that things are working.\n\n214\n00:10:05.620 --> 00:10:11.705\nWe have a few ways to check status,\nlike I could have done systemctl status\n\n215\n00:10:11.705 --> 00:10:16.900\nhttpd.service, like that, just to check\nthe status to see if it's up and running.\n\n216\n00:10:16.900 --> 00:10:19.750\nI know mine is because it works and\nI don't have to have that.\n\n217\n00:10:19.750 --> 00:10:23.760\nOr I could have done just\na quick is-active just to take\n\n218\n00:10:23.760 --> 00:10:26.950\na look at whether it was active\nin running that way too.\n\n219\n00:10:26.950 --> 00:10:28.470\nSo those are ways I could\ncheck to make sure.\n\n220\n00:10:28.470 --> 00:10:32.140\nI saw a webpage, [LAUGH] so that's\nenough for me to know that it's working.\n\n221\n00:10:32.140 --> 00:10:33.730\nBut assuming that's good.\n\n222\n00:10:33.730 --> 00:10:35.490\nWe are now ready to start\nloading in content.\n\n223\n00:10:36.550 --> 00:10:41.005\nThe default is that it's going to be\nstoring our configuration in a folder\n\n224\n00:10:41.005 --> 00:10:45.105\n/var/www/html.\n\n225\n00:10:46.220 --> 00:10:49.170\nThat's where it's going\nto be storing content.\n\n226\n00:10:49.170 --> 00:10:52.030\nAnd so if I have webpages I wanna load\nI wanna throw them right here into this\n\n227\n00:10:52.030 --> 00:10:54.210\nfolder and if I take a look at it.\n\n228\n00:10:54.210 --> 00:10:55.470\nIt is empty.\n\n229\n00:10:56.520 --> 00:11:00.350\nThat default page that was being displayed\nfor us, that's actually a little module\n\n230\n00:11:00.350 --> 00:11:03.610\nthat it's got that says, if the folder\nis empty, display this default page.\n\n231\n00:11:03.610 --> 00:11:06.060\nAnd the default page is\nstored somewhere else.\n\n232\n00:11:06.060 --> 00:11:09.250\nThe configuration for\nApache is a little bit weird.\n\n233\n00:11:09.250 --> 00:11:11.310\nThings get stored in\na few different places.\n\n234\n00:11:11.310 --> 00:11:14.180\nSo before we dive in and\nstart throwing content in this folder,\n\n235\n00:11:14.180 --> 00:11:16.760\nI wanna show you guys where\nthose configurations are.\n\n236\n00:11:16.760 --> 00:11:23.603\nSo, the main configuration is\ninside of /etc/httpd/conf.\n\n237\n00:11:23.603 --> 00:11:25.120\nAll right?\n\n238\n00:11:25.120 --> 00:11:28.290\nThat folder is where the main\nconfiguration is stored.\n\n239\n00:11:28.290 --> 00:11:31.340\nAnd, in there,\nyou'll find a file called httpd.conf.\n\n240\n00:11:31.340 --> 00:11:34.620\nThis is considered\nthe global configuration.\n\n241\n00:11:34.620 --> 00:11:37.520\nChanges I make in here\naffect my entire web server.\n\n242\n00:11:37.520 --> 00:11:40.010\nAnd this is where the bulk of\nmy change is going to occur.\n\n243\n00:11:40.010 --> 00:11:40.670\nAll right.\n\n244\n00:11:40.670 --> 00:11:43.180\nBut, there are other files in here.\n\n245\n00:11:43.180 --> 00:11:45.190\nSo, if I move up one directory,\n\n246\n00:11:45.190 --> 00:11:50.400\nso now I'm in /etc/httpd,\nthe folder I was in was called conf.\n\n247\n00:11:50.400 --> 00:11:52.460\nThat's this guy right here.\n\n248\n00:11:52.460 --> 00:11:56.090\nBut, you'll also see where I've\ngot conf.d, where you can put\n\n249\n00:11:56.090 --> 00:11:58.880\nother configuration files that\nare included in the configuration.\n\n250\n00:11:58.880 --> 00:12:00.590\nYou can break them into smaller pieces.\n\n251\n00:12:00.590 --> 00:12:03.490\nAnd more importantly conf.modules.d.\n\n252\n00:12:03.490 --> 00:12:06.740\nThat's where you configure\nall the add on modules.\n\n253\n00:12:06.740 --> 00:12:10.570\nIf you've got PHP installed or\nmod ssl or all those other guys,\n\n254\n00:12:10.570 --> 00:12:12.420\nthey have configuration files\nthat get stored in there.\n\n255\n00:12:12.420 --> 00:12:16.130\nThat means your Apache install can\nget really complex, really fast.\n\n256\n00:12:16.130 --> 00:12:19.180\nYou might have many configuration files.\n\n257\n00:12:19.180 --> 00:12:23.250\nBe aware that they all get kind of\nbrought together and things that\n\n258\n00:12:23.250 --> 00:12:27.720\nare in these subdirectories can override\nwhat's in the main configuration.\n\n259\n00:12:27.720 --> 00:12:30.740\nSo if you're ever modifying the main\nconfiguration, and the change just isn't\n\n260\n00:12:30.740 --> 00:12:33.540\ntaking effect, and you don't know why,\nstart to look into these other\n\n261\n00:12:33.540 --> 00:12:37.490\ndirectories, cuz you may find where it's\nbeing overridden somewhere down the line.\n\n262\n00:12:37.490 --> 00:12:38.550\nNow, when we go in here and\n\n263\n00:12:38.550 --> 00:12:43.800\nstart making changes, these changes\ndon't take effect until Apache restarts.\n\n264\n00:12:43.800 --> 00:12:46.150\nSo before I make any changes,\nlet me show you how that works.\n\n265\n00:12:46.150 --> 00:12:48.810\nThe old way that we used to\ndo this is you would just\n\n266\n00:12:48.810 --> 00:12:50.260\nrestart the apache service, right?\n\n267\n00:12:50.260 --> 00:12:56.050\nI could easily come in here and\nsay systemctl restart httpd.service and\n\n268\n00:12:56.050 --> 00:12:58.160\nit's gonna restart that one and\n\n269\n00:12:58.160 --> 00:13:01.850\nanybody who's on the website\nright now Is getting kicked out.\n\n270\n00:13:01.850 --> 00:13:04.510\nAnd then it's restarting the service and\ncoming back up, and\n\n271\n00:13:04.510 --> 00:13:06.530\nnow when they come back in,\nit's an all new session.\n\n272\n00:13:06.530 --> 00:13:07.530\nThat can be a problem.\n\n273\n00:13:07.530 --> 00:13:10.680\nA lot of web applications aren't\ndesigned to survive that, and so\n\n274\n00:13:10.680 --> 00:13:12.410\npeople have sessions that are open,\n\n275\n00:13:12.410 --> 00:13:15.900\nnow they have to re-log in if you\nhave a webpage that requires a login.\n\n276\n00:13:15.900 --> 00:13:17.560\nSome websites are designed\nto handle that better.\n\n277\n00:13:17.560 --> 00:13:20.190\nMaybe you have like a reddist\ndatabase that's tracking sessions and\n\n278\n00:13:20.190 --> 00:13:21.160\nit'll survive it.\n\n279\n00:13:21.160 --> 00:13:24.430\nBut this way is what I\ncall a hard restart.\n\n280\n00:13:24.430 --> 00:13:26.680\nYou're kicking everybody out and\nrestarting.\n\n281\n00:13:26.680 --> 00:13:28.480\nThere are better ways to do it.\n\n282\n00:13:28.480 --> 00:13:33.729\nSo for example, I could say system\n\n283\n00:13:33.729 --> 00:13:40.780\nCTL reload httpd.service, there we go.\n\n284\n00:13:40.780 --> 00:13:43.390\nThis one's still gonna kick people out,\nbut\n\n285\n00:13:43.390 --> 00:13:46.060\nit's not gonna restart the actual service.\n\n286\n00:13:46.060 --> 00:13:48.660\nIt's gonna reload the configuration files,\nright?\n\n287\n00:13:48.660 --> 00:13:52.960\nSo it's faster, it's a smaller window, but\nyou're still kicking people out, okay?\n\n288\n00:13:52.960 --> 00:13:54.310\nIf you don't wanna kick people out though,\n\n289\n00:13:54.310 --> 00:13:59.550\nthe way to really do it is with\nanother utility called apachectl.\n\n290\n00:13:59.550 --> 00:14:02.650\nApache's CTL just for\nmanaging the web server.\n\n291\n00:14:02.650 --> 00:14:05.560\nAnd you could say Apache CTL, graceful.\n\n292\n00:14:05.560 --> 00:14:06.980\nAnd this one is really neat.\n\n293\n00:14:06.980 --> 00:14:10.920\nIf anyone's got an open session,\nit lets them finish that session and\n\n294\n00:14:10.920 --> 00:14:13.240\nthen it restarts as soon as it can.\n\n295\n00:14:13.240 --> 00:14:17.170\nAnd so this way will not interrupt\nthe users on your website.\n\n296\n00:14:17.170 --> 00:14:20.110\nNow there is still gonna be a brief\nmoment while the system's restarting but\n\n297\n00:14:20.110 --> 00:14:22.200\nif somebody tries to connect\nwhile it's restarting.\n\n298\n00:14:22.200 --> 00:14:24.570\nThey're not gonna be very happy, right?\n\n299\n00:14:24.570 --> 00:14:25.930\nBut it's very brief.\n\n300\n00:14:25.930 --> 00:14:28.220\nAnd so\nthis is really the best way to restart it.\n\n301\n00:14:28.220 --> 00:14:30.480\nIt reloads the configuration,\nand gets things going.\n\n302\n00:14:30.480 --> 00:14:34.010\nBut if you're in a hurry to push a change\nthrough like I'm gonna be the rest of\n\n303\n00:14:34.010 --> 00:14:34.940\nthis episode.\n\n304\n00:14:34.940 --> 00:14:37.130\n&gt;&gt; [LAUGH]\n&gt;&gt; [LAUGH] I got a lot to get through.\n\n305\n00:14:37.130 --> 00:14:40.380\nIn real life land,\nI use Apache CTL graceful.\n\n306\n00:14:40.380 --> 00:14:43.250\nThat's the way to impact\nyour users the least.\n\n307\n00:14:43.250 --> 00:14:46.500\nIf you're not worried about attacking\nusers, if it's an emergency change, or\n\n308\n00:14:46.500 --> 00:14:49.820\nif you have a cluster, and you know\nthe other nodes will pick up the slack,\n\n309\n00:14:49.820 --> 00:14:52.520\nthen you can just use\nthe system CTL restart.\n\n310\n00:14:52.520 --> 00:14:55.840\nThat's the fastest and you know you\nget a full configuration update and\n\n311\n00:14:55.840 --> 00:14:57.230\neverything's in business.\n\n312\n00:14:57.230 --> 00:15:01.960\nThose all different ways that we can\nmanipulate the service and get it going.\n\n313\n00:15:01.960 --> 00:15:06.140\nAnytime you modify your configuration,\nyou do need to reload the config file,\n\n314\n00:15:06.140 --> 00:15:09.660\nthough, otherwise it's just\nnot going to recognize it.\n\n315\n00:15:09.660 --> 00:15:15.160\nBut, if I just want to get the server\nup and going, I take my files,\n\n316\n00:15:15.160 --> 00:15:20.190\nI chuck them right into /var/www/html,\nI put my content right in there.\n\n317\n00:15:20.190 --> 00:15:21.300\nAnd my web server's done.\n\n318\n00:15:21.300 --> 00:15:23.570\nWe're up and we're running and\nwe're in business.\n\n319\n00:15:23.570 --> 00:15:27.850\n&gt;&gt; So Don, what if we modify\nthe configuration if it fails to start?\n\n320\n00:15:27.850 --> 00:15:28.750\n&gt;&gt; Good point.\n\n321\n00:15:28.750 --> 00:15:30.530\nRight.\nSo as we modify this files,\n\n322\n00:15:30.530 --> 00:15:32.530\nI haven't technically modified mine yet,\nright?\n\n323\n00:15:32.530 --> 00:15:38.757\nSo if I get back into /etc/httpd/conf and\n\n324\n00:15:38.757 --> 00:15:42.190\nI take a look at that file.\n\n325\n00:15:42.190 --> 00:15:45.810\nWell, the file itself,\nit's got a lot of settings in there.\n\n326\n00:15:45.810 --> 00:15:50.220\nAnd it's pretty well-documented, but you\ncould make mistakes, and I frequently do.\n\n327\n00:15:50.220 --> 00:15:55.060\nSo if I make some errors in there, and I\nmess things up, we do have a quick utility\n\n328\n00:15:55.060 --> 00:15:59.430\nwe can run that let's us check to see if\nthere's a mistake, or something like that.\n\n329\n00:15:59.430 --> 00:16:04.640\nYou can run apachectl config test, okay.\n\n330\n00:16:04.640 --> 00:16:06.320\nAnd that's going to test\nthat configuration,\n\n331\n00:16:06.320 --> 00:16:07.870\nit's going to look for any errors.\n\n332\n00:16:07.870 --> 00:16:11.100\nIf it gets to any errors\nit will let us know.\n\n333\n00:16:11.100 --> 00:16:13.860\nNow I haven't actually\nconfigured mines yet and\n\n334\n00:16:13.860 --> 00:16:17.030\nso there's still a lot of default\nvalues so I did get an error right.\n\n335\n00:16:17.030 --> 00:16:20.800\nI could not reliably determine\nthe service fully qualified domain name.\n\n336\n00:16:20.800 --> 00:16:23.870\nActually that's not the default\nconfig's problem, that's my server.\n\n337\n00:16:23.870 --> 00:16:26.495\nSee how my server is called localhost?\n\n338\n00:16:26.495 --> 00:16:28.110\n[LAUGH] I never gave it a name.\n\n339\n00:16:28.110 --> 00:16:31.120\nSo apache doesn't know what\nthe name of my server is, right?\n\n340\n00:16:31.120 --> 00:16:35.670\nIt could be lab.itpro.tv or\nwww.pets.com or whatever.\n\n341\n00:16:35.670 --> 00:16:36.730\nApache doesn't know.\n\n342\n00:16:36.730 --> 00:16:37.710\nSo I need to update that.\n\n343\n00:16:37.710 --> 00:16:38.980\nThat's the only error that I'm getting.\n\n344\n00:16:38.980 --> 00:16:43.890\nBut this is a neat utility because it'll\nhelp you spot any typos, any mistakes.\n\n345\n00:16:43.890 --> 00:16:48.410\nAnd when you're modifying\nthe configuration file, it's really super\n\n346\n00:16:48.410 --> 00:16:54.900\nimportant that you run this command\nprior to reloading the configuration.\n\n347\n00:16:54.900 --> 00:16:56.910\nYour web server's up and\nrunning right now.\n\n348\n00:16:56.910 --> 00:16:58.580\nYou modify the configuration file.\n\n349\n00:16:58.580 --> 00:17:00.200\nWeb server is still up and running.\n\n350\n00:17:00.200 --> 00:17:04.020\nIf you restart the config and there's an\nerror, now your web server is not running\n\n351\n00:17:04.020 --> 00:17:07.710\nand you're doing all the troubleshooting\nwhile the web server is not running.\n\n352\n00:17:07.710 --> 00:17:12.590\nYour users are impacted, okay, so it's\nbetter to say the web server is running.\n\n353\n00:17:12.590 --> 00:17:17.300\nI modify the configuration and\nthen I run the config check, right?\n\n354\n00:17:17.300 --> 00:17:21.170\nWe run that config test,\napachectl configtest.\n\n355\n00:17:21.170 --> 00:17:22.280\nIf there's an error.\n\n356\n00:17:22.280 --> 00:17:25.280\nI can now fix it and\nthe web server's still running.\n\n357\n00:17:25.280 --> 00:17:28.750\nAnd once I fix all the errors,\nnow I reload the configuration.\n\n358\n00:17:28.750 --> 00:17:31.120\nThat'll really help you\nminimize that at down time.\n\n359\n00:17:31.120 --> 00:17:31.960\nWhen I did the install.\n\n360\n00:17:31.960 --> 00:17:39.280\nRemember there was HTTPD and there was\nHTTPD-tools while Apache CTL is the tool.\n\n361\n00:17:39.280 --> 00:17:42.730\nThat's the main tool that we get\nfrom the HTTPD-tools package.\n\n362\n00:17:42.730 --> 00:17:45.300\nThere's other tools too but\nthis is the main one that we care about.\n\n363\n00:17:45.300 --> 00:17:48.100\nAnd it's real important because it'll\nhelp you to minimize that downtime.\n\n364\n00:17:48.100 --> 00:17:51.270\n&gt;&gt; So Don, at this point you really\nhaven't configured anything at all.\n\n365\n00:17:51.270 --> 00:17:54.060\nSo what do we need to modify\nto move forward here?\n\n366\n00:17:54.060 --> 00:17:54.820\n&gt;&gt; All right,\n\n367\n00:17:54.820 --> 00:17:57.410\nthere are a lot of default settings\nthat we will want to change, right?\n\n368\n00:17:57.410 --> 00:17:58.640\nTechnically the web server's up, right?\n\n369\n00:17:58.640 --> 00:17:59.630\nIt was the easiest thing ever.\n\n370\n00:17:59.630 --> 00:18:02.500\nYou install HTTPD, you start the service,\nopening the firewall.\n\n371\n00:18:02.500 --> 00:18:06.850\nCopy your files to /var/www/html and\nyou're done.\n\n372\n00:18:06.850 --> 00:18:09.380\nBut there are a lot of things we\nmight wanna tweak and alter, and\n\n373\n00:18:09.380 --> 00:18:10.480\nI wanna show you guys that, right?\n\n374\n00:18:10.480 --> 00:18:13.670\nBecause not every web server's the same\nand some get a little more advanced, so\n\n375\n00:18:13.670 --> 00:18:15.180\nwe wanna take a look at those settings.\n\n376\n00:18:15.180 --> 00:18:16.580\nBut I know we're a bit low on time, and\n\n377\n00:18:16.580 --> 00:18:18.400\nI don't wanna have to try and\nrush through it.\n\n378\n00:18:18.400 --> 00:18:20.220\nSo let's break into a part two, Zach.\n\n379\n00:18:20.220 --> 00:18:20.740\n&gt;&gt; Okay.\n\n380\n00:18:20.740 --> 00:18:24.950\n&gt;&gt; And in this episode we gotta chance to\nsee setting up that basic web server and\n\n381\n00:18:24.950 --> 00:18:26.310\ngetting it up and running.\n\n382\n00:18:26.310 --> 00:18:30.220\nIn our next episode we'll see the more\nadvanced features, or in part two,\n\n383\n00:18:30.220 --> 00:18:31.240\nmore advanced features.\n\n384\n00:18:31.240 --> 00:18:34.600\nThings that we can tweak and customize to\nmake it run the way that we want it to,\n\n385\n00:18:34.600 --> 00:18:37.020\nwhich is often a little bit\ndifferent than those defaults.\n\n386\n00:18:37.020 --> 00:18:39.735\n&gt;&gt; Awesome, so part one, installing HTTPD,\n\n387\n00:18:39.735 --> 00:18:44.575\nthere'll be a part 2 installing\nHTTPD as you wanted with\n\n388\n00:18:44.575 --> 00:18:48.615\nbecoming a Linux server administrator and\nthere's a lot of videos in this series.\n\n389\n00:18:48.615 --> 00:18:49.615\nMake sure you watch them all.\n\n390\n00:18:49.615 --> 00:18:50.765\nYou're going to be really glad you did.\n\n391\n00:18:50.765 --> 00:18:51.945\nGreat job Don.\n\n392\n00:18:51.945 --> 00:18:53.815\nI thank you for watching IT Pro TV.\n\n393\n00:18:53.815 --> 00:18:56.035\nremember a good IT pro is always learning.\n\n394\n00:18:56.035 --> 00:18:58.075\nI'm Zach Memos\n&gt;&gt; And I'm Don Pezet.\n\n395\n00:18:58.075 --> 00:18:59.042\n&gt;&gt; And we'll see you soon.\n\n396\n00:18:59.042 --> 00:19:06.152\n[MUSIC]\n\n397\n00:19:06.152 --> 00:19:08.698\n&gt;&gt; Thank you for watching ITPRO.TV.\n\n",
          "vimeoId": "228812551"
        },
        {
          "description": "Don and Zach continue installing httpd, loading custom content, typical server configuration, troubleshoot fail to start after modifying configuration, storing content elsewhere, hosting multiple websites on same server, and name-based virtual hosts.",
          "length": "1890",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-1-2-installing_httpd_pt_2-080717-PGM.00_31_13_26.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-1-2-installing_httpd_pt_2-080717-PGM.00_31_13_26.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-1-2-installing_httpd_pt_2-080717-PGM.00_31_13_26.Still001-sm.jpg",
          "title": "Installing httpd Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:01.240 --> 00:00:01.985\nWelcome to ITProTV.\n\n2\n00:00:01.985 --> 00:00:05.154\nI'm your host, Don Pezet coming at you\nlive from San Francisco, California.\n\n3\n00:00:05.154 --> 00:00:07.133\n[CROSSTALK]\n\n4\n00:00:07.133 --> 00:00:08.324\n[MUSIC]\n\n5\n00:00:08.324 --> 00:00:11.892\n&gt;&gt; You're watching ITProTV.\n\n6\n00:00:11.892 --> 00:00:13.280\n&gt;&gt; Hello, and thank you for\n\n7\n00:00:13.280 --> 00:00:16.960\nwatching ITProTV,\nhelping you learn wherever you go.\n\n8\n00:00:16.960 --> 00:00:17.800\nI'm Zach Memos,\n\n9\n00:00:17.800 --> 00:00:21.740\nyour host as we continue on with\nbecoming a Linux server administrator.\n\n10\n00:00:21.740 --> 00:00:25.561\nThis is part two of installing httpd.\n\n11\n00:00:25.561 --> 00:00:27.655\nYes, we can say it together, ready?\n\n12\n00:00:27.655 --> 00:00:30.695\nInstalling httpd, this is part two.\n\n13\n00:00:30.695 --> 00:00:33.355\nAnd Don Pezet is with us again to\ngive us all the information we need.\n\n14\n00:00:33.355 --> 00:00:34.155\nDon, hello.\n\n15\n00:00:34.155 --> 00:00:35.375\n&gt;&gt; Hey, thanks for having me back, Zach.\n\n16\n00:00:35.375 --> 00:00:37.510\nThey could have worked in a vowel or\nsomething in there.\n\n17\n00:00:37.510 --> 00:00:38.475\nWe have a name for it.\n\n18\n00:00:38.475 --> 00:00:40.212\nBut yeah, so\nwe're gonna take a look at it.\n\n19\n00:00:40.212 --> 00:00:43.293\nIf you're watching all of these\nepisodes in order, in the last episode,\n\n20\n00:00:43.293 --> 00:00:45.446\nyou saw where we went through and\ninstalled httpd.\n\n21\n00:00:45.446 --> 00:00:49.652\nWe got it, put up in place, kinda saw\nwhere the sample web page came up.\n\n22\n00:00:49.652 --> 00:00:51.602\nSo we saw the minimum to get it up and\ngoing.\n\n23\n00:00:51.602 --> 00:00:53.892\nIn this episode, we wanna kind\nof move along a little bit and\n\n24\n00:00:53.892 --> 00:00:56.702\nsee some of the typical stuff\nthat we're going to do.\n\n25\n00:00:56.702 --> 00:01:00.330\nBecause it's not always as\neasy as you might lay out,\n\n26\n00:01:00.330 --> 00:01:02.680\ncuz it was pretty easy,\nin that last episode.\n\n27\n00:01:02.680 --> 00:01:04.650\n&gt;&gt; So in part one, we got things moving.\n\n28\n00:01:04.650 --> 00:01:08.170\nAnd it looks pretty simple,\nbut what more can we do?\n\n29\n00:01:08.170 --> 00:01:11.420\n&gt;&gt; So let me walk you through some\nof the typical setup that I'll do\n\n30\n00:01:11.420 --> 00:01:12.210\non a web server.\n\n31\n00:01:12.210 --> 00:01:15.070\nSo the first thing I need to do is I need\nto get into that global configuration file\n\n32\n00:01:15.070 --> 00:01:16.100\nwe talked about in the last episode.\n\n33\n00:01:16.100 --> 00:01:19.870\nIf you don't remember it, it is, and\nI'll just pull it up here on my computer.\n\n34\n00:01:19.870 --> 00:01:27.219\nIt is inside of\n/etc/httpd/conf/httpd.conf.\n\n35\n00:01:27.219 --> 00:01:31.710\nThat's kinda redundant there,\nbut that's where it is.\n\n36\n00:01:31.710 --> 00:01:33.090\nAnd I'm gonna edit that file now.\n\n37\n00:01:33.090 --> 00:01:34.790\nJust like I said in the last episode,\n\n38\n00:01:34.790 --> 00:01:36.640\ndo remember that I've\nelevated my privileges here.\n\n39\n00:01:36.640 --> 00:01:39.670\nYou need to be a root, or\nhave root privileges to modify this.\n\n40\n00:01:39.670 --> 00:01:41.702\nSo if you haven't\nelevated your privileges,\n\n41\n00:01:41.702 --> 00:01:43.170\nmake sure you sudo this command.\n\n42\n00:01:43.170 --> 00:01:46.300\nI did a sudo -s to elevate my whole shell.\n\n43\n00:01:46.300 --> 00:01:48.427\nAnd so I'm gonna go in and edit that file.\n\n44\n00:01:48.427 --> 00:01:51.600\nNow the file is full of a ton of stuff.\n\n45\n00:01:51.600 --> 00:01:55.665\nAnd we already saw on the default config\nthat it's kind of already setup for us.\n\n46\n00:01:55.665 --> 00:01:57.150\nIt does what we need to do.\n\n47\n00:01:57.150 --> 00:02:03.270\nI could put my web content in\n/var/www/html and it's gonna work.\n\n48\n00:02:03.270 --> 00:02:05.860\nSo I don't technically have\nto change anything in here.\n\n49\n00:02:05.860 --> 00:02:08.700\nBut on normal server, there's a few\nthings that I'm gonna mess with.\n\n50\n00:02:08.700 --> 00:02:10.946\nSo let me kind of run you\nthrough those different options.\n\n51\n00:02:10.946 --> 00:02:16.480\nFirst off, there's a line in here if\nwe kinda hunt through, that says this.\n\n52\n00:02:16.480 --> 00:02:19.240\nListen AD, Listen AD.\n\n53\n00:02:19.240 --> 00:02:23.740\nNow, what that's telling us is that\nApache's gonna be listening on TCP\n\n54\n00:02:23.740 --> 00:02:26.520\nport 80 for web connections.\n\n55\n00:02:26.520 --> 00:02:28.270\nHTTP uses port 80.\n\n56\n00:02:28.270 --> 00:02:29.550\nSSL uses port 443.\n\n57\n00:02:29.550 --> 00:02:31.050\nWe need to remember that.\n\n58\n00:02:31.050 --> 00:02:33.980\nAnd it is actually listening\non 443 by default as well.\n\n59\n00:02:33.980 --> 00:02:36.500\nBut it's got 80 here specifically.\n\n60\n00:02:36.500 --> 00:02:40.140\nIf I want to run my web\nserver on a nonstandard port,\n\n61\n00:02:40.140 --> 00:02:43.560\nwe see this with Intranet servers\na lot of times with clustered servers,\n\n62\n00:02:43.560 --> 00:02:45.500\nthen here's where I'll modify that.\n\n63\n00:02:45.500 --> 00:02:48.230\nNow I can just modify\nthe port number outright.\n\n64\n00:02:48.230 --> 00:02:51.040\nOr if I have more than one\nIP address on my server,\n\n65\n00:02:51.040 --> 00:02:54.200\nmore than one network interface,\nI might wanna hard set\n\n66\n00:02:54.200 --> 00:02:57.420\nwhich interface it is that I'm listening\non, and what port number from there.\n\n67\n00:02:57.420 --> 00:02:58.772\nSo they give me two examples here.\n\n68\n00:02:58.772 --> 00:03:02.700\nFor example, my server is 172.16.0.100.\n\n69\n00:03:02.700 --> 00:03:04.430\nIf I have five network adapters,\n\n70\n00:03:04.430 --> 00:03:06.970\nI might only want to listen\non one of those adapters.\n\n71\n00:03:06.970 --> 00:03:10.401\nMaybe it's an intranet site,\nI don't wanna expose it to the Internet.\n\n72\n00:03:10.401 --> 00:03:14.677\nSo I could come in and\nI could say something like,\n\n73\n00:03:14.677 --> 00:03:18.680\nlisten 172.16.0.100:80.\n\n74\n00:03:18.680 --> 00:03:23.830\nAnd now I will only be listening on that\none network adapter and not the others.\n\n75\n00:03:23.830 --> 00:03:25.500\nNow if you wanna listen\non all your adapters or\n\n76\n00:03:25.500 --> 00:03:28.000\nif you only have one adapter\nthen you don't need to do that.\n\n77\n00:03:28.000 --> 00:03:30.000\nAnd you can leave it right\nthere at that default of 80.\n\n78\n00:03:30.000 --> 00:03:32.117\nBut if you need to change the port number,\nyou certainly can.\n\n79\n00:03:32.117 --> 00:03:34.612\nSometimes we have more than more\nservice that creates a web server.\n\n80\n00:03:34.612 --> 00:03:37.090\nYou might need to modify it and\nyou can do that right here.\n\n81\n00:03:37.090 --> 00:03:40.030\nSo that's one setting that\nwe might want to modify.\n\n82\n00:03:41.240 --> 00:03:45.490\nAnother setting that I'll typically\nmodify is the directory index.\n\n83\n00:03:45.490 --> 00:03:48.903\nAnd this file can be a little\nbit crowded sometimes.\n\n84\n00:03:48.903 --> 00:03:52.482\nThere's a lot of neat stuff in here,\nthings like limiting what users and\n\n85\n00:03:52.482 --> 00:03:56.072\ngroups can detach to it or what user and\ngroup the Apache service runs as.\n\n86\n00:03:56.072 --> 00:03:58.500\nYou'll see that's defined right here.\n\n87\n00:03:58.500 --> 00:04:00.200\nYou'll see a few other entries.\n\n88\n00:04:00.200 --> 00:04:03.250\nSo a lot of times it's faster to\nkinda search through this file to\n\n89\n00:04:03.250 --> 00:04:04.290\nlook for something.\n\n90\n00:04:04.290 --> 00:04:06.700\nSo, for example if I want to look for\nthe directory index,\n\n91\n00:04:06.700 --> 00:04:08.690\nI know that's gonna be\nstored under my directory.\n\n92\n00:04:08.690 --> 00:04:10.430\nAnd I can browse through and find it.\n\n93\n00:04:10.430 --> 00:04:15.500\nBut remember if you're using like Vi,\nas your text editor or Vim, you\n\n94\n00:04:15.500 --> 00:04:19.550\ncan always do a forward slash to search\nand find the entries you're looking for.\n\n95\n00:04:19.550 --> 00:04:22.590\nSo one of the ones that I typically\nfind myself having to modify\n\n96\n00:04:22.590 --> 00:04:25.530\nis the directory index option.\n\n97\n00:04:25.530 --> 00:04:29.290\nAnd if I search through and find it,\nhere it is, directory index for\n\n98\n00:04:29.290 --> 00:04:30.520\nthe directory module.\n\n99\n00:04:30.520 --> 00:04:34.124\nAnd notice how it's set to index.html.\n\n100\n00:04:34.124 --> 00:04:36.330\nWell, that's fine for a lot of people.\n\n101\n00:04:36.330 --> 00:04:40.580\nBut if you're supporting various\nusers they may have different needs.\n\n102\n00:04:40.580 --> 00:04:42.530\nYou may want your default\npage to be index.htm.\n\n103\n00:04:42.530 --> 00:04:44.845\nSome people use the eight\nby three character names,\n\n104\n00:04:44.845 --> 00:04:47.120\ncuz they come from the Microsoft world.\n\n105\n00:04:47.120 --> 00:04:49.897\nOr maybe you've got a PHP web application.\n\n106\n00:04:49.897 --> 00:04:55.000\nAnd you want it to be index.php or\nindex.asp or index.whatever.\n\n107\n00:04:55.000 --> 00:04:57.350\nYou might need to add\nadditional names here for\n\n108\n00:04:57.350 --> 00:04:59.170\nwhat you want that default document to be.\n\n109\n00:04:59.170 --> 00:05:01.100\nSo that's something you can modify here.\n\n110\n00:05:01.100 --> 00:05:05.790\nThis is globally, we can also modify\ninside of our individual configuration.\n\n111\n00:05:05.790 --> 00:05:08.960\nIf I'm only running one web server,\nthis is the place to do it.\n\n112\n00:05:08.960 --> 00:05:12.640\nBut if I got more than one website,\nthen I can define this separately for\n\n113\n00:05:12.640 --> 00:05:13.640\neach individual website.\n\n114\n00:05:13.640 --> 00:05:16.662\nSo there is a few different ways\nthat we can modify this setting.\n\n115\n00:05:16.662 --> 00:05:19.300\nBut that is another one\nthat I normally look for.\n\n116\n00:05:19.300 --> 00:05:22.470\nAfter that, we've got a few other\nthings that we wanna pay attention to.\n\n117\n00:05:22.470 --> 00:05:24.680\nI wanna call out these\ndirectory statements.\n\n118\n00:05:24.680 --> 00:05:29.731\nAs you look through\nthe configuration you're\n\n119\n00:05:29.731 --> 00:05:36.868\ngonna see a couple of lines that\nstart with directory right here.\n\n120\n00:05:36.868 --> 00:05:43.864\nThis one's directory/directory/var/www and\nthen finally /var/www/html.\n\n121\n00:05:43.864 --> 00:05:47.926\nThese three sections are basically\ndefining permissions and options for\n\n122\n00:05:47.926 --> 00:05:49.470\nthese folders.\n\n123\n00:05:49.470 --> 00:05:52.050\nWhat do I want to allow people to do?\n\n124\n00:05:52.050 --> 00:05:56.320\nWell, /, that's the root of my hard drive.\n\n125\n00:05:56.320 --> 00:05:59.918\nWhat kind of access do you wanna give\npeople to the root of your hard drive?\n\n126\n00:05:59.918 --> 00:06:01.290\nNone at all, usually.\n\n127\n00:06:01.290 --> 00:06:06.480\nAnd if you look, it says AllowOverride\nnone, Require all denied.\n\n128\n00:06:06.480 --> 00:06:07.650\nOkay, what does that mean?\n\n129\n00:06:07.650 --> 00:06:09.850\nWell, the second is\nkinda self explanatory.\n\n130\n00:06:09.850 --> 00:06:12.000\nI'm requiring all users to be denied.\n\n131\n00:06:12.000 --> 00:06:17.090\nI do not want to allow web users to be\nable to hit the root of my file system.\n\n132\n00:06:17.090 --> 00:06:18.250\nThat makes sense, right?\n\n133\n00:06:18.250 --> 00:06:21.130\nSo my default on the root is\nthat everybody's blocked.\n\n134\n00:06:21.130 --> 00:06:22.450\nAnd AllowOverride none.\n\n135\n00:06:22.450 --> 00:06:26.220\nThere's these little files\ncalled htaccess files.\n\n136\n00:06:26.220 --> 00:06:29.800\nThey're normally hidden cuz they\nstart with a dot so it's .htaccess.\n\n137\n00:06:29.800 --> 00:06:32.590\nAnd in that file,\nyou can override permissions.\n\n138\n00:06:32.590 --> 00:06:35.840\nAnd that's really handy, because on\na website, you might want to give people\n\n139\n00:06:35.840 --> 00:06:39.190\nread permissions to one folder,\nor read and execute to another.\n\n140\n00:06:39.190 --> 00:06:43.100\nYou might want to do 301 redirects, or\nall sorts of advanced functionality.\n\n141\n00:06:43.100 --> 00:06:46.380\nThose are called overrides, and\nthey're done inside of an htaccess file.\n\n142\n00:06:46.380 --> 00:06:50.654\nWell, I'm saying here for my root, I\ndon't care if you create a htaccess file.\n\n143\n00:06:50.654 --> 00:06:52.240\nI'm not gonna allow you to overwrite it.\n\n144\n00:06:52.240 --> 00:06:55.360\nNobody gets access to\nthe root file system.\n\n145\n00:06:55.360 --> 00:06:59.580\nAnd then, I can do other directory\nstatements to override it.\n\n146\n00:06:59.580 --> 00:07:02.570\nI say I'm doing it, it's the default\nconfig, it's already done for me.\n\n147\n00:07:02.570 --> 00:07:08.540\nSo the next entry that I'd find if I\nscroll down a little bit more is /var/www.\n\n148\n00:07:08.540 --> 00:07:12.730\nOkay, that is technically\nthe working directory for Apache.\n\n149\n00:07:12.730 --> 00:07:17.060\nSo when Apache runs,\nit stores its information in /var/www.\n\n150\n00:07:17.060 --> 00:07:20.230\nBut notice, it's got AllowOverride none,\n\n151\n00:07:20.230 --> 00:07:23.750\nwe're still not allowing an override,\nand Require all granted.\n\n152\n00:07:23.750 --> 00:07:26.180\nNow I am giving people\naccess to this folder.\n\n153\n00:07:26.180 --> 00:07:27.970\nBut that is not where my\nweb content is stored.\n\n154\n00:07:27.970 --> 00:07:32.203\nMy web content is actually stored\nright here, /var/www/html.\n\n155\n00:07:32.203 --> 00:07:35.324\nAnd this is the one that's gonna be\nmost public because this is where\n\n156\n00:07:35.324 --> 00:07:38.227\nthe webpages are stored that our\nviewers are gonna be hitting or\n\n157\n00:07:38.227 --> 00:07:39.895\nour visitors are gonna be hitting.\n\n158\n00:07:39.895 --> 00:07:41.930\nSo we want to make sure\nthey've got that access.\n\n159\n00:07:41.930 --> 00:07:44.470\nAnd so it'll be the biggest of the three.\n\n160\n00:07:44.470 --> 00:07:49.050\nNow notice here that it says Further relax\naccess to the default document root.\n\n161\n00:07:49.050 --> 00:07:50.975\nHow do we know that's\nthe default document root?\n\n162\n00:07:50.975 --> 00:07:52.530\nWell, right up here.\n\n163\n00:07:52.530 --> 00:07:56.677\nDocumentRoot, this is where\nI'm storing my webpages.\n\n164\n00:07:56.677 --> 00:08:03.410\nAnd so /var/www/html and then the options\nin here, we can tweak to modify as needed.\n\n165\n00:08:03.410 --> 00:08:06.470\nAnd it's very well documented,\nbut typically,\n\n166\n00:08:06.470 --> 00:08:09.170\nI'm only gonna change a few\nthings inside of here.\n\n167\n00:08:09.170 --> 00:08:12.330\nI may come in and say, allow override.\n\n168\n00:08:12.330 --> 00:08:14.230\nAnd see how it's set to none, and\n\n169\n00:08:14.230 --> 00:08:18.850\nremember up above when I saw /var/www\nthere was allow override none, right?\n\n170\n00:08:18.850 --> 00:08:20.300\nWe keep seeing this allow override none,\n\n171\n00:08:20.300 --> 00:08:23.560\nwe're not allowing these\nthings to be overridden.\n\n172\n00:08:23.560 --> 00:08:27.390\nBut in the default folder like\nthis I might want to allow that.\n\n173\n00:08:27.390 --> 00:08:29.810\nI might want to allow people\nto override these settings.\n\n174\n00:08:29.810 --> 00:08:33.870\nSo I can come in and I can change that and\nand set it to allow it.\n\n175\n00:08:33.870 --> 00:08:37.110\nSee how it says allow\noverride can be all or none?\n\n176\n00:08:37.110 --> 00:08:41.760\nI'm gonna change that to all and,\nI'll say it's okay to use an htaccess\n\n177\n00:08:41.760 --> 00:08:45.060\nfile to override settings here because,\nyou might need to do a redirect.\n\n178\n00:08:45.060 --> 00:08:49.810\nYou might need to do some kind of,\nstream change, or\n\n179\n00:08:49.810 --> 00:08:51.780\nwhatever and\nhtaccess will allow you to do that.\n\n180\n00:08:51.780 --> 00:08:54.900\nSo, that's something that I'll\nfrequently change, right there.\n\n181\n00:08:54.900 --> 00:08:58.710\nYou've also got whether you\nallow index files, right?\n\n182\n00:08:58.710 --> 00:09:01.870\nA default document, or you require\npeople to provide a default document,\n\n183\n00:09:01.870 --> 00:09:05.200\nyou normally want it to be automatic so\nthey can just type your domain name and\n\n184\n00:09:05.200 --> 00:09:06.330\nthen follow symlinks.\n\n185\n00:09:06.330 --> 00:09:09.010\nIf there are symlinks in the folder that\npoint to another location on the hard\n\n186\n00:09:09.010 --> 00:09:11.080\ndrive, do you want to\nallow that to be followed?\n\n187\n00:09:11.080 --> 00:09:14.260\nSome people don't, usually you do,\nso that's an option that turned on.\n\n188\n00:09:14.260 --> 00:09:17.740\nBut we can tweak it and modify those\nas needed just the same, okay?\n\n189\n00:09:17.740 --> 00:09:20.460\nLet's see, what else do we normally do?\n\n190\n00:09:20.460 --> 00:09:24.010\nYou might wanna do a require all granted.\n\n191\n00:09:24.010 --> 00:09:26.900\nIn this case, I don't think it's\nset by default, no, there it is,\n\n192\n00:09:26.900 --> 00:09:28.560\nright there, require all granted.\n\n193\n00:09:28.560 --> 00:09:32.500\nThis is allowing everybody access to\nthese pages, it's a website, right?\n\n194\n00:09:32.500 --> 00:09:34.720\nIf I'm exposing to the internet or\neven my intranet,\n\n195\n00:09:34.720 --> 00:09:36.080\nI want people to be able to get it.\n\n196\n00:09:36.080 --> 00:09:39.950\nBut that's another one that we might\nwanna tweak and override, okay?\n\n197\n00:09:39.950 --> 00:09:44.980\nOn this website, I could override\nthe document index file names, so\n\n198\n00:09:44.980 --> 00:09:47.740\nif I wanna specify it right here, I can.\n\n199\n00:09:47.740 --> 00:09:50.150\nI showed you it globally,\nearlier, which is right down here,\n\n200\n00:09:50.150 --> 00:09:51.460\nhere's that global setting.\n\n201\n00:09:51.460 --> 00:09:54.550\nBut I can do it inside of this individual\nwebsite too, if I'm going to be managing\n\n202\n00:09:54.550 --> 00:09:57.550\nmore than one website we can\nkind of put it all in place.\n\n203\n00:09:57.550 --> 00:10:00.140\nBut basically those are some of\nthe standard settings that I'll modify\n\n204\n00:10:00.140 --> 00:10:01.090\nand I'll tweak.\n\n205\n00:10:01.090 --> 00:10:05.889\nA lot of people harp on you about\nupdating, where is it, the email address\n\n206\n00:10:05.889 --> 00:10:09.440\nyou'll see here, server admin,\nyou're suppose put a webmaster address.\n\n207\n00:10:09.440 --> 00:10:13.910\nThis actually isn't even used by Apache\nanymore so I never bother changing that,\n\n208\n00:10:13.910 --> 00:10:14.970\njust kind of ignore it.\n\n209\n00:10:14.970 --> 00:10:18.020\nAnd there's a few other\nthings like the server name.\n\n210\n00:10:18.020 --> 00:10:22.260\nI have a slight error on my system in that\nmy server is still called localhost, so\n\n211\n00:10:22.260 --> 00:10:24.340\nit doesn't actually know\nthe name of the server.\n\n212\n00:10:24.340 --> 00:10:27.805\nSo I could come in and can specify hey,\nI want my server name to be,\n\n213\n00:10:27.805 --> 00:10:31.445\nsay Lab.ITpro.tv, right?\n\n214\n00:10:31.445 --> 00:10:34.605\nSo that's gonna be the name of my server,\nlistening on port 80.\n\n215\n00:10:34.605 --> 00:10:37.615\nSo that's the name of the server, now\nit'll know what my DNS name should be and\n\n216\n00:10:37.615 --> 00:10:40.605\nit can check and make sure DNS\nresolution is working and all of that.\n\n217\n00:10:40.605 --> 00:10:43.785\nThat's another thing that's\ngood to modify on our system.\n\n218\n00:10:43.785 --> 00:10:45.815\n&gt;&gt; So Don, after these modifications, or\n\n219\n00:10:45.815 --> 00:10:48.980\nmodifications and configurations,\nwhat if it fails to start?\n\n220\n00:10:48.980 --> 00:10:49.840\nWhat do we do?\n\n221\n00:10:49.840 --> 00:10:51.930\n&gt;&gt; All right, so,\nI mentioned in the last episode but\n\n222\n00:10:51.930 --> 00:10:53.598\nI hadn't actually made any changes.\n\n223\n00:10:53.598 --> 00:10:57.820\nWe can always use apacheCTL configtest,\nright?\n\n224\n00:10:57.820 --> 00:11:02.640\nYou always want to run this and\ncheck your system before you get an error.\n\n225\n00:11:02.640 --> 00:11:05.400\nNow when I ran it in the last episode I\ndid get an error because it didn't know my\n\n226\n00:11:05.400 --> 00:11:07.480\nserver name, it saw localhost.\n\n227\n00:11:07.480 --> 00:11:10.110\nThis time, syntax okay, right?\n\n228\n00:11:10.110 --> 00:11:12.710\nIt's happy, it knows that it's good,\nand I can come in here and\n\n229\n00:11:12.710 --> 00:11:17.400\nI can do apacheCTL graceful and\nthat'll restart the server.\n\n230\n00:11:17.400 --> 00:11:19.690\nI've got nobody connected, so\nthat takes effect immediately.\n\n231\n00:11:19.690 --> 00:11:21.680\nIf you're really in a hurry and\nthere's people connected,\n\n232\n00:11:21.680 --> 00:11:27.090\nyou can do the systemCTL\nrestart httpd.service.\n\n233\n00:11:27.090 --> 00:11:29.680\nA little more aggressive, but\nthat'll also force it to restart and\n\n234\n00:11:29.680 --> 00:11:30.650\nkick everybody out.\n\n235\n00:11:30.650 --> 00:11:35.350\nSo now my changes are active, the server\nis up, and we're ready to go, right?\n\n236\n00:11:35.350 --> 00:11:39.775\nI'm ready to go and start dumping\ndocuments into /var/www/html and\n\n237\n00:11:39.775 --> 00:11:41.331\nget my web server going.\n\n238\n00:11:41.331 --> 00:11:44.541\n&gt;&gt; So, what if we wanna store\nour content somewhere else?\n\n239\n00:11:44.541 --> 00:11:46.790\n&gt;&gt; All right, so\nhere's where things get fun, right?\n\n240\n00:11:46.790 --> 00:11:49.080\nEverything here so\nfar is pretty basic, but\n\n241\n00:11:49.080 --> 00:11:51.590\na lot of times we do want to\nmove things somewhere else.\n\n242\n00:11:51.590 --> 00:11:53.360\nYour website can grow large, right?\n\n243\n00:11:53.360 --> 00:11:56.370\nOr you might want to have it in\na special file system that's\n\n244\n00:11:56.370 --> 00:11:57.670\ncompletely separate, right?\n\n245\n00:11:57.670 --> 00:12:00.270\nI had to put protection in to keep\npeople out of my root file system, so\n\n246\n00:12:00.270 --> 00:12:03.760\nwouldn't it be nice if the webpages were\nstored in a completely different place?\n\n247\n00:12:03.760 --> 00:12:08.138\nA lot of people have started storing their\nwebpages in a partition that's mounted\n\n248\n00:12:08.138 --> 00:12:09.227\nread only, right?\n\n249\n00:12:09.227 --> 00:12:13.462\nHard to deface a web page that's mounted\nread only, you can't modify it, right?\n\n250\n00:12:13.462 --> 00:12:15.800\nYou can try to modify it in memory,\nbut that doesn't always work.\n\n251\n00:12:15.800 --> 00:12:19.290\nSo if we wanna do that, we wanna\nstore the documents somewhere else.\n\n252\n00:12:19.290 --> 00:12:23.999\nSo if I get back into my configuration\nfile you'll notice there was an entry in\n\n253\n00:12:23.999 --> 00:12:26.471\nthere for where the directory root was.\n\n254\n00:12:26.471 --> 00:12:31.959\nAnd so if I scroll down and find it,\nit's buried in there somewhere,\n\n255\n00:12:31.959 --> 00:12:37.842\nlet's see the document right there,\ndocument root /var/www/html.\n\n256\n00:12:37.842 --> 00:12:39.700\nI can choose to store it somewhere else.\n\n257\n00:12:39.700 --> 00:12:42.808\nMaybe I wanna make a folder\ncalled /website, and\n\n258\n00:12:42.808 --> 00:12:46.750\n/website might actually be\na whole separate partition.\n\n259\n00:12:46.750 --> 00:12:50.180\nIn fact, if you go back and watch our\nepisode on the logical volume manager,\n\n260\n00:12:50.180 --> 00:12:52.170\nI show it how to create\na whole separate partition.\n\n261\n00:12:52.170 --> 00:12:53.550\nI put a website on it, so\n\n262\n00:12:53.550 --> 00:12:55.670\nI kind of ran through the example\nthere if you wanna see it.\n\n263\n00:12:55.670 --> 00:12:59.900\nI'll just do a regular folder here in this\nshow, but pick a folder anywhere, right?\n\n264\n00:12:59.900 --> 00:13:02.016\nI want this folder to store my website,\nall right,\n\n265\n00:13:02.016 --> 00:13:03.950\nso that's where I'm\ngonna put my documents.\n\n266\n00:13:03.950 --> 00:13:06.057\nNow, I do have a slight problem,\n\n267\n00:13:06.057 --> 00:13:11.418\nwhich is my directory statement's here\nexpecting everything to be in /var/www.\n\n268\n00:13:11.418 --> 00:13:14.612\nSo I'm gonna come down\nhere to /var/www/html and\n\n269\n00:13:14.612 --> 00:13:18.678\nI'm gonna change that to /website\ncuz that's where my documents\n\n270\n00:13:18.678 --> 00:13:22.830\nare gonna be stored now and\nI want those settings to carry over.\n\n271\n00:13:22.830 --> 00:13:24.920\nSo I have to change it in two places.\n\n272\n00:13:24.920 --> 00:13:26.710\nI technically didn't\nhave to change it here,\n\n273\n00:13:26.710 --> 00:13:29.465\nI could have added a whole new block,\nit's just a lot of work.\n\n274\n00:13:29.465 --> 00:13:31.510\n[LAUGH] So\nit's easier to change that path.\n\n275\n00:13:31.510 --> 00:13:35.080\nI'm not storing anything\nin /var/www/html anymore\n\n276\n00:13:35.080 --> 00:13:38.410\nbecause I modified the document root here,\nokay?\n\n277\n00:13:38.410 --> 00:13:41.818\nNow, once that's done,\nI do need to make that directory so\n\n278\n00:13:41.818 --> 00:13:44.288\nI guess that needs to\nget done there [LAUGH].\n\n279\n00:13:44.288 --> 00:13:46.150\nSo I made the directory, right?\n\n280\n00:13:46.150 --> 00:13:49.910\nAnd now if I restart Apache,\nit's gonna start using that directory.\n\n281\n00:13:49.910 --> 00:13:52.980\nBut, there is a little problem,\nthis is actually broken right now.\n\n282\n00:13:52.980 --> 00:13:56.129\nIf I were to restart Apache and\ntry and connect,\n\n283\n00:13:56.129 --> 00:14:00.790\nI probably will not get any webpage\nthat I've put in there, right?\n\n284\n00:14:00.790 --> 00:14:02.560\nI'll probably get the Apache test page.\n\n285\n00:14:02.560 --> 00:14:06.345\nAnd the reason is in Red Hat we have\na security system called SE Linux,\n\n286\n00:14:06.345 --> 00:14:08.360\ntheq security enhanced Linux.\n\n287\n00:14:08.360 --> 00:14:13.330\nAnd SE Linux says that each service only\nhas access to the directories it's suppose\n\n288\n00:14:13.330 --> 00:14:14.472\nto have access to.\n\n289\n00:14:14.472 --> 00:14:17.972\nSo for example, if I go into /var/www and\n\n290\n00:14:17.972 --> 00:14:22.457\nI take a look at the folder,\nthat HTML folder, right?\n\n291\n00:14:22.457 --> 00:14:24.750\nWhen I look at the HTML folder,\nsee how it's owned by root?\n\n292\n00:14:25.860 --> 00:14:31.345\nIf I do a laZ, I'm gonna add\na capital Z to my LS command.\n\n293\n00:14:31.345 --> 00:14:35.880\nAnd I look at it, that folder,\nthe HTML folder right here,\n\n294\n00:14:36.990 --> 00:14:40.390\nit's got an SE Linux\ncontext assigned to it.\n\n295\n00:14:40.390 --> 00:14:42.890\nA context defines who's\nallowed to access it and\n\n296\n00:14:42.890 --> 00:14:47.890\nthis one has a context of\nHTTPD sys content, right?\n\n297\n00:14:47.890 --> 00:14:52.150\nIt's content for the HTTPD service,\nit expects it to be there.\n\n298\n00:14:52.150 --> 00:14:54.280\nIf I do the same thing for\n\n299\n00:14:54.280 --> 00:14:58.350\nmy website folder that I just made,\nhere's the website folder.\n\n300\n00:14:58.350 --> 00:15:01.500\nIt's context is unconfined, right?\n\n301\n00:15:01.500 --> 00:15:04.500\nThat means that it's wild storage,\nit's not confined, and\n\n302\n00:15:04.500 --> 00:15:06.120\nit's got the default setting.\n\n303\n00:15:06.120 --> 00:15:09.640\nApache will not be able to access that,\nall right?\n\n304\n00:15:09.640 --> 00:15:13.530\nSo we need to tell SE Linux that\nit's okay for Apache to access this.\n\n305\n00:15:13.530 --> 00:15:16.690\nAnd the way we do it is by changing\nthe context of that folder.\n\n306\n00:15:16.690 --> 00:15:19.910\nSo I can just jump in\nreal quick with a chcon,\n\n307\n00:15:19.910 --> 00:15:22.620\nwhich is the change context command.\n\n308\n00:15:22.620 --> 00:15:25.832\nAnd I can do a -r, whoops,\ncuz I want this to be recursive,\n\n309\n00:15:25.832 --> 00:15:28.404\nif I've loaded it up with documents and\nstuff,\n\n310\n00:15:28.404 --> 00:15:31.842\nI want this to apply to the folder and\nall the stuff inside of it.\n\n311\n00:15:31.842 --> 00:15:34.552\nI'll do a v as well to get verbose output,\nif there's an error,\n\n312\n00:15:34.552 --> 00:15:36.372\nI'll get better error messages that way.\n\n313\n00:15:36.372 --> 00:15:42.990\nSo -rv and then I'm gonna say --Type=,\nand then I'm gonna provide the context.\n\n314\n00:15:42.990 --> 00:15:47.170\nNow, a lot of people say, how do I know\nwhat context it is, this is really hard?\n\n315\n00:15:47.170 --> 00:15:50.112\nWell, you just look at the other folder,\nthe preexisting folder,\n\n316\n00:15:50.112 --> 00:15:51.982\nyou can copy the context right from there.\n\n317\n00:15:51.982 --> 00:15:53.167\nOr you can memorize it or\n\n318\n00:15:53.167 --> 00:15:56.203\nyou can write it on a piece of\npaper like I did before the show.\n\n319\n00:15:56.203 --> 00:16:00.690\n&gt;&gt; [LAUGH]\n&gt;&gt; [LAUGH] And so I'm gonna do that, so\n\n320\n00:16:00.690 --> 00:16:05.903\nI'll say, httpd _sys_content_t.\n\n321\n00:16:05.903 --> 00:16:11.190\nRight, that's the context that I wanna\nassign to the slash website folder.\n\n322\n00:16:12.190 --> 00:16:16.190\nAnd once that's done,\nnow when I look at that context,\n\n323\n00:16:16.190 --> 00:16:20.420\nit's got the right context, and\nApache will be able to access that folder.\n\n324\n00:16:20.420 --> 00:16:22.160\nThat's a security protection.\n\n325\n00:16:22.160 --> 00:16:26.170\nApache shouldn't be accessing just\nrandom folders all over our hard drive.\n\n326\n00:16:26.170 --> 00:16:30.530\nIn the olden days,\nall you had to protect yourself\n\n327\n00:16:30.530 --> 00:16:34.500\nwas that direct restatement\ninside of the HTTP configuration.\n\n328\n00:16:34.500 --> 00:16:36.860\nNow we have SE Linux on\nthe backend enforcing it.\n\n329\n00:16:36.860 --> 00:16:40.580\nSo this is gonna guarantee that hackers\ncan't escape from our webpage and\n\n330\n00:16:40.580 --> 00:16:43.060\nstart accessing the rest\nof the file system.\n\n331\n00:16:43.060 --> 00:16:47.620\nSo now once that's done I\ncan run a quick apachectl\n\n332\n00:16:47.620 --> 00:16:50.700\nconfigtest to make sure I didn't\nscrew it up, and it's good.\n\n333\n00:16:50.700 --> 00:16:55.580\nAnd then I can do an apachectl graceful,\nor I could do a systemctl restart.\n\n334\n00:16:55.580 --> 00:16:58.880\nThat's gonna restart Apache,\nand now it's looking for\n\n335\n00:16:58.880 --> 00:17:02.400\nthe website Right here in\nthe website folder and\n\n336\n00:17:02.400 --> 00:17:07.320\nif I go into that website folder\nI can just create a quick file.\n\n337\n00:17:07.320 --> 00:17:10.930\nI'm not a HTML expert or anything but\n\n338\n00:17:10.930 --> 00:17:15.810\nI can maybe bang out a quick\nlittle document here.\n\n339\n00:17:15.810 --> 00:17:17.840\nThis is my test pay.\n\n340\n00:17:19.980 --> 00:17:23.250\nI actually took a college course on HTML.\n\n341\n00:17:23.250 --> 00:17:25.390\nAnd this is about the extent\nof what I learned.\n\n342\n00:17:25.390 --> 00:17:27.190\nIt was so\n\n343\n00:17:27.190 --> 00:17:30.580\nlong ago that I used a blinking text,\nwhich you're not allowed to do anymore.\n\n344\n00:17:30.580 --> 00:17:32.240\nNow I got an index file that's in there.\n\n345\n00:17:32.240 --> 00:17:35.130\nYou do wanna be a little bit\ncareful about permissions.\n\n346\n00:17:35.130 --> 00:17:40.200\nIf I look at this, see how it's user\nis root and the group is root as well.\n\n347\n00:17:40.200 --> 00:17:43.280\nWell, Apache doesn't run as the root user.\n\n348\n00:17:43.280 --> 00:17:44.990\nApache runs at its own user, right.\n\n349\n00:17:44.990 --> 00:17:49.770\nWhen we looked at that config file, one of\n\n350\n00:17:49.770 --> 00:17:55.230\nthe entries up towards the top was what\nuser and group it runs at right there.\n\n351\n00:17:55.230 --> 00:17:58.960\nSo I do wanna make sure that Apache\nis able to get to this stuff.\n\n352\n00:17:58.960 --> 00:18:01.980\nSo I'm gonna do a quick change owner.\n\n353\n00:18:01.980 --> 00:18:08.650\nAnd I'm gonna just attach the Apache\nuser and the Apache group to /website.\n\n354\n00:18:08.650 --> 00:18:12.850\nAnd let me add a -r to\nmake that recursive so\n\n355\n00:18:12.850 --> 00:18:16.990\nthat I know that, whoops,\nApache will be able to access that.\n\n356\n00:18:16.990 --> 00:18:17.620\nThere we go.\n\n357\n00:18:17.620 --> 00:18:20.180\nSo I can see Apache now\nhas access to that folder.\n\n358\n00:18:20.180 --> 00:18:22.090\nAnd so I can restart Apache.\n\n359\n00:18:24.050 --> 00:18:29.790\nAnd once that's done,\nit'll restart, it'll come up,\n\n360\n00:18:29.790 --> 00:18:34.120\nand if I browse to my server now, when I\nbrowse to it, hey this is my test page.\n\n361\n00:18:34.120 --> 00:18:36.000\n&gt;&gt; Hey.\n&gt;&gt; And so I know it's working, and\n\n362\n00:18:36.000 --> 00:18:39.150\nI know it's load from that other\ndirectory right, so now I can pull it in.\n\n363\n00:18:39.150 --> 00:18:41.180\nAnd that other directory can\nbe on a separate petition,\n\n364\n00:18:41.180 --> 00:18:42.910\nit can be mounted read only.\n\n365\n00:18:42.910 --> 00:18:46.005\nWhich again is an awesome technique\nto lock your pages in place.\n\n366\n00:18:46.005 --> 00:18:48.770\nMakes it a little harder\nwhen you want to edit them.\n\n367\n00:18:48.770 --> 00:18:53.320\n[LAUGH] But great way of protecting them\nso just another bit of kind of advance\n\n368\n00:18:53.320 --> 00:18:56.390\nconfiguration that we can do to\nget that system up and running.\n\n369\n00:18:56.390 --> 00:19:00.110\n&gt;&gt; So Don can we host more than\none website on the same server?\n\n370\n00:19:00.110 --> 00:19:02.400\n&gt;&gt; Yeah, yeah, so\nright now I'm just doing one, right?\n\n371\n00:19:02.400 --> 00:19:05.430\nAnd the default configurations is\nreally built around the idea of hosting\n\n372\n00:19:05.430 --> 00:19:06.890\none webpage.\n\n373\n00:19:06.890 --> 00:19:09.360\nBut you might wanna host more\nthan one web page, right?\n\n374\n00:19:09.360 --> 00:19:14.900\nMaybe I've got three different labs, so\ni wanna have lab1.itprotv, lab2 and lab3.\n\n375\n00:19:14.900 --> 00:19:17.090\nI want each to have their own web page.\n\n376\n00:19:17.090 --> 00:19:20.790\nWell, the old way was to have\nthree web servers, right?\n\n377\n00:19:20.790 --> 00:19:22.880\nJust go out and buy three servers,\nno big deal, right?\n\n378\n00:19:22.880 --> 00:19:24.050\nBut we don't have to do that.\n\n379\n00:19:24.050 --> 00:19:28.350\nWe can have more than one web\nserver on a single server.\n\n380\n00:19:28.350 --> 00:19:29.600\nIn a perfect world,\n\n381\n00:19:29.600 --> 00:19:33.940\nI mean ideal world you have a static\nIP address for each web server.\n\n382\n00:19:33.940 --> 00:19:36.530\nSo if I want three servers I\nneed three IP addresses, right?\n\n383\n00:19:36.530 --> 00:19:40.280\nAnd if I do that, we've gotta have web\nbrowser here and get back to this.\n\n384\n00:19:41.970 --> 00:19:44.630\nIf we do that we can create\nwhat we call virtual host.\n\n385\n00:19:44.630 --> 00:19:48.660\nA virtual host is like\na Virtual web server.\n\n386\n00:19:48.660 --> 00:19:51.500\nA sub web server that's tied\nto a single IP address.\n\n387\n00:19:51.500 --> 00:19:55.420\nAnd so I can say, any request that comes\nin IP address one, gets this website.\n\n388\n00:19:55.420 --> 00:19:57.850\nAnybody comes on IP address two,\ngets this other website.\n\n389\n00:19:57.850 --> 00:20:00.760\nAnybody comes on IP address three,\ngets this third website.\n\n390\n00:20:00.760 --> 00:20:04.840\nSo I can go to my network configuration,\nI use add multiple IPs.\n\n391\n00:20:04.840 --> 00:20:06.880\nIf you watch our network episode,\n\n392\n00:20:06.880 --> 00:20:09.170\nI showed that add more than\none IP address to a server.\n\n393\n00:20:09.170 --> 00:20:11.210\nYou just have to modify\nthe network hard scripts.\n\n394\n00:20:11.210 --> 00:20:14.540\nOnce you got more than one IP,\nthen we can go into our configuration,\n\n395\n00:20:14.540 --> 00:20:15.100\nwe can add them there.\n\n396\n00:20:15.100 --> 00:20:16.600\nNow there's two ways to do it and\n\n397\n00:20:16.600 --> 00:20:20.520\non the internet you'll hear people\nsay all sorts different of ways.\n\n398\n00:20:20.520 --> 00:20:25.940\nThe way that works on every distro is to\nsimply modify the main configuration.\n\n399\n00:20:25.940 --> 00:20:33.800\nSo if I modify /etc/htpd/conf/htpd.com and\n\n400\n00:20:33.800 --> 00:20:37.820\nyou kind of scroll down a little bit and\nyou see all these directory lines,\n\n401\n00:20:37.820 --> 00:20:39.990\nthose are the folds and the directories.\n\n402\n00:20:39.990 --> 00:20:42.710\nAnd as we get down towards the bottom\n\n403\n00:20:42.710 --> 00:20:46.830\nyou'll find something\nexamples somewhere in here.\n\n404\n00:20:46.830 --> 00:20:49.310\nAnd are the examples gone?\n\n405\n00:20:49.310 --> 00:20:49.830\nThey might be gone.\n\n406\n00:20:49.830 --> 00:20:54.600\nUsually you'll see some examples down\nhere for how to set up virtual hosts.\n\n407\n00:20:54.600 --> 00:20:57.030\nAnd a virtual host is that sub web server.\n\n408\n00:20:57.030 --> 00:21:00.270\nNow I'm on a red hat server, and they\ndon't even include the examples anymore,\n\n409\n00:21:00.270 --> 00:21:01.760\nbecause they handle them\na little bit different.\n\n410\n00:21:01.760 --> 00:21:03.582\nThere's a new way to handle it\nthat's a little bit preferred.\n\n411\n00:21:03.582 --> 00:21:07.840\nBut in your distro, if you scroll to\nthe bottom of this you may well find\n\n412\n00:21:07.840 --> 00:21:10.920\nwhere virtual host so\nto find right at the bottom.\n\n413\n00:21:10.920 --> 00:21:12.710\nAnd so you can specify those settings.\n\n414\n00:21:12.710 --> 00:21:15.990\nNow the syntax is the same\nif you do it the old way and\n\n415\n00:21:15.990 --> 00:21:17.490\nthe new way the difference\nis where you put it.\n\n416\n00:21:17.490 --> 00:21:18.910\nSo the old way is where\nyou put it right here.\n\n417\n00:21:18.910 --> 00:21:20.920\nYou just scroll all the way to\nthe bottom of this file and\n\n418\n00:21:20.920 --> 00:21:24.240\nadd all your virtual host right there\nat the bottom and that was that.\n\n419\n00:21:24.240 --> 00:21:27.620\nNow the new way to do it Is instead of\nsticking them here at the bottom of\n\n420\n00:21:27.620 --> 00:21:32.890\na file, we can stick them in their\nown files separate, modular.\n\n421\n00:21:32.890 --> 00:21:34.490\nAnd that way, it's easier to modify and\n\n422\n00:21:34.490 --> 00:21:37.020\nnot worry about messing up\nsomebody else's configuration.\n\n423\n00:21:37.020 --> 00:21:39.665\nRemember, I typoed here,\ncould bring down the whole server.\n\n424\n00:21:39.665 --> 00:21:42.675\nA typo in a module file would\njust bring down that module.\n\n425\n00:21:42.675 --> 00:21:45.275\nSo it kind of minimizes the risk.\n\n426\n00:21:45.275 --> 00:21:46.895\nSo I'm going to get out of this file.\n\n427\n00:21:46.895 --> 00:21:50.935\nAnd if I go back into /ETC/HTTPD,\n\n428\n00:21:50.935 --> 00:21:55.985\nwhat you'll find in here is that\nthere are other files tucked away.\n\n429\n00:21:55.985 --> 00:21:59.930\nIf I go into, well,\nI've been going into, right?\n\n430\n00:21:59.930 --> 00:22:02.670\nThat's been my main\nconfiguration location.\n\n431\n00:22:02.670 --> 00:22:05.140\nThis time I'm going to go into conf.d, and\n\n432\n00:22:05.140 --> 00:22:10.380\nwhen I go into that folder, here I see\na lot of other configuration files, right?\n\n433\n00:22:10.380 --> 00:22:11.620\nSome of these we use all the time.\n\n434\n00:22:11.620 --> 00:22:15.200\nThis guy right here, welcome.com, when\n\n435\n00:22:15.200 --> 00:22:19.390\nI went to the Apache webpage when I first\nlaunched the server I got a sample page.\n\n436\n00:22:19.390 --> 00:22:20.920\nBut when I looked in the folder,\nthe folder was empty.\n\n437\n00:22:20.920 --> 00:22:22.320\nWhere did it come from?\n\n438\n00:22:22.320 --> 00:22:23.165\nIt's defined right here.\n\n439\n00:22:23.165 --> 00:22:28.380\nWelcome.conf actually tells the system\nwhat do do when there's no webpage.\n\n440\n00:22:28.380 --> 00:22:32.160\nThis says hey, if there's no content,\nif there's no index file present,\n\n441\n00:22:32.160 --> 00:22:35.395\nthen go ahead and\nshow them this page right here.\n\n442\n00:22:35.395 --> 00:22:40.170\n/user/share/http/noindex/index.html.\n\n443\n00:22:40.170 --> 00:22:44.080\nSo if I want to change that default\npage I go and modify that file.\n\n444\n00:22:44.080 --> 00:22:46.550\nOr I can even change where\nit's pointed right here and\n\n445\n00:22:46.550 --> 00:22:48.630\nnow get a different looking page.\n\n446\n00:22:48.630 --> 00:22:50.950\nWell, you can create\nvirtual hosts right here.\n\n447\n00:22:50.950 --> 00:22:56.400\nEverything that's stored in D is included\nas part of the other configuration.\n\n448\n00:22:56.400 --> 00:23:02.170\nIf I looked at the end of\n/etc/http/conf/http.conf at\n\n449\n00:23:04.500 --> 00:23:10.930\nthe very end see this line right here?.\n\n450\n00:23:10.930 --> 00:23:14.970\nSo it's loading any config file\nfrom this folder right here.\n\n451\n00:23:14.970 --> 00:23:16.710\nAnd so I can add my virtual host here.\n\n452\n00:23:16.710 --> 00:23:17.880\nAnd that's the better way to do it.\n\n453\n00:23:17.880 --> 00:23:20.480\nThat's why I'm not seeing\nthose other examples anymore.\n\n454\n00:23:20.480 --> 00:23:21.760\nSo if I create a file in here.\n\n455\n00:23:21.760 --> 00:23:24.790\nI'm just gonna create one called\nlabone.ITPro.TV.com, all right.\n\n456\n00:23:24.790 --> 00:23:29.260\nNow, you can actually name\nit whatever you want.\n\n457\n00:23:29.260 --> 00:23:29.940\nIt can be called Bob.\n\n458\n00:23:29.940 --> 00:23:32.240\nIt does need to end in .com or\nit won't be included.\n\n459\n00:23:32.240 --> 00:23:33.725\nSo I can do Bob.com.\n\n460\n00:23:33.725 --> 00:23:35.315\n&gt;&gt; Mmm.\n&gt;&gt; But you normally name it after\n\n461\n00:23:35.315 --> 00:23:37.035\nthe web servers so\nyou can remember what the heck it is.\n\n462\n00:23:37.035 --> 00:23:39.245\nI am making lab one.ITpro.tv.\n\n463\n00:23:39.245 --> 00:23:41.105\nSo I will name it lab one.ITpro.tv.\n\n464\n00:23:41.105 --> 00:23:45.685\nAnd then inside of that I\ncan define my virtual host.\n\n465\n00:23:45.685 --> 00:23:49.888\nSo I am going to open a bracket here and\nI'll say virtual host and\n\n466\n00:23:49.888 --> 00:23:54.963\nI'll follow that by whatever IP address\nthat virtual host is going to have,\n\n467\n00:23:54.963 --> 00:24:00.200\nso I'll say 172.16.0.101 That's\nthe IP that it's gonna have,\n\n468\n00:24:00.200 --> 00:24:02.680\nand then I specify the settings.\n\n469\n00:24:02.680 --> 00:24:06.147\nI say document root, and I specify where\nits documents are gonna be stored.\n\n470\n00:24:06.147 --> 00:24:11.675\nSo maybe there's /var/www/HTML or\n\n471\n00:24:11.675 --> 00:24:17.878\nwhatever, and then /lab1.ITPRO.tv.\n\n472\n00:24:17.878 --> 00:24:19.258\nSo maybe that's the folder\nwhere I want the server, or\n\n473\n00:24:19.258 --> 00:24:20.078\nwherever you wanna point it to.\n\n474\n00:24:20.078 --> 00:24:22.746\nRemember, the SE Linux context has\nto allow it, but other than that,\n\n475\n00:24:22.746 --> 00:24:24.650\nyou can put this folder wherever you want.\n\n476\n00:24:24.650 --> 00:24:28.320\nSo I'm telling it, that's where I'm going\nto store the files for this website.\n\n477\n00:24:28.320 --> 00:24:33.870\nAnd then I can give it the server name,\nand this one is called lab1.\n\n478\n00:24:33.870 --> 00:24:37.560\nRemember, my default server\nwas called lab.ITPRO.TV, so\n\n479\n00:24:37.560 --> 00:24:40.540\nthis one's got a different name,\nso I need to specify that here.\n\n480\n00:24:40.540 --> 00:24:45.080\nAnd then I can give a server alias\nif I have one, you may not, but\n\n481\n00:24:45.080 --> 00:24:50.244\nmaybe I have an alias of www.itpro.tv,\nor www.lab1.itpro.tv.\n\n482\n00:24:50.244 --> 00:24:53.960\nWhatever the alias is, and\nyou might have more than one alias.\n\n483\n00:24:53.960 --> 00:24:57.509\nYou just put commas in there and\nadd all the aliases you want, and\n\n484\n00:24:57.509 --> 00:24:58.777\nyou get them in place.\n\n485\n00:24:58.777 --> 00:25:02.935\nBut once that's done, I can save that,\nand what's gonna happen is,\n\n486\n00:25:02.935 --> 00:25:06.893\nthe default site that I was modifying\nat the beginning of the show.\n\n487\n00:25:06.893 --> 00:25:11.391\nThat applies for everything that\ndoesn't match a virtual host,\n\n488\n00:25:11.391 --> 00:25:16.392\nthis virtual host only matches\ntraffic to 172.16.0.101.\n\n489\n00:25:16.392 --> 00:25:20.810\nAny traffic going to any other IP will\nmatch the default configurations.\n\n490\n00:25:20.810 --> 00:25:24.010\nAnything going to this IP,\nwe'll match the settings right here,\n\n491\n00:25:24.010 --> 00:25:26.970\nwe'll get this webpage and\nthat information.\n\n492\n00:25:26.970 --> 00:25:33.967\nAnd then I can create other files for\nother hosts, and I can keep doing this.\n\n493\n00:25:33.967 --> 00:25:36.854\nAnd so I can have 10, 20,\n100, 1000 servers, and\n\n494\n00:25:36.854 --> 00:25:39.425\nit's just limited by the amount\nof IP addresses I have.\n\n495\n00:25:39.425 --> 00:25:42.760\nI give each one their own IP, and\nnow the site exists right there.\n\n496\n00:25:42.760 --> 00:25:46.900\nWhen I restart Apache, though, I might be\nunhappy that I haven't made this folder.\n\n497\n00:25:46.900 --> 00:25:51.460\nBut other than that, Apache will load up,\nand now I've got a virtual host in place.\n\n498\n00:25:51.460 --> 00:25:56.070\n&gt;&gt; So what if though, what if,\nI only have one IP address?\n\n499\n00:25:56.070 --> 00:25:59.110\n&gt;&gt; Okay, all right, so\nI'm being a little generous with IPs here.\n\n500\n00:25:59.110 --> 00:26:01.020\nWhen they're private IPs,\nthat's easy, we just make them up.\n\n501\n00:26:01.020 --> 00:26:03.588\nBut public IPs cost us money, and so\n\n502\n00:26:03.588 --> 00:26:07.962\nif i want 100 servers,\nI might not want to buy 100 IPs.\n\n503\n00:26:07.962 --> 00:26:10.902\nSo you can actually manage\nthis off of a single IP,\n\n504\n00:26:10.902 --> 00:26:13.851\nI could have 100 web\nservers running on one IP.\n\n505\n00:26:13.851 --> 00:26:17.330\nAnd the way we do is by name matching,\nand name matching is tough.\n\n506\n00:26:17.330 --> 00:26:20.752\nIt works, a lot of people do it,\nand by a lot, I mean tons and\n\n507\n00:26:20.752 --> 00:26:23.680\ntons of people out there\nin the internet do it.\n\n508\n00:26:23.680 --> 00:26:27.129\nThere's a little bit of challenge,\nwhen a user browses to your site,\n\n509\n00:26:27.129 --> 00:26:28.655\nthey're using a web browser.\n\n510\n00:26:28.655 --> 00:26:33.410\nThey're using Firefox, Chrome, or Opera,\nor whatever it is, Safari, who knows?\n\n511\n00:26:33.410 --> 00:26:36.122\nAnd those web browsers,\nwhen they reach out to the server,\n\n512\n00:26:36.122 --> 00:26:37.811\nthey don't just reach out to the IP.\n\n513\n00:26:37.811 --> 00:26:41.883\nThey do a HTTP get request, and they say,\nhere's the name I'm trying to contact,\n\n514\n00:26:41.883 --> 00:26:43.890\ncan you give me that web page?\n\n515\n00:26:43.890 --> 00:26:47.630\nAnd so, we can key off of that\nname instead of the IP, but\n\n516\n00:26:47.630 --> 00:26:50.240\nwhat if the browser\ndoesn't give us the name?\n\n517\n00:26:50.240 --> 00:26:54.030\nSome old browsers don't do that, if\nan old browser doesn't give us the name,\n\n518\n00:26:54.030 --> 00:26:56.840\nwe don't know which site to give it,\nand we could give it the wrong site.\n\n519\n00:26:56.840 --> 00:27:01.006\nSo ten years ago, name matching\nreally wasn't the best practice,\n\n520\n00:27:01.006 --> 00:27:04.748\nIPs were, IPs are perfect,\nthat's what you wanted to use.\n\n521\n00:27:04.748 --> 00:27:09.714\nSo Amazon, Microsoft, the big websites,\nthey do IPs, but now,\n\n522\n00:27:09.714 --> 00:27:14.342\ntoday, 2017,\nevery modern browser hands out the name.\n\n523\n00:27:14.342 --> 00:27:18.763\nSo name matching is pretty safe, and with\nname matching, we can attach as many names\n\n524\n00:27:18.763 --> 00:27:21.710\nas we want to one IP, and\nwe'll use the name to match up.\n\n525\n00:27:21.710 --> 00:27:23.650\nLet me show you how that works,\nso a little bit different,\n\n526\n00:27:23.650 --> 00:27:28.560\nI'm going to edit that lab1, or\nactually, here, let's just do lab2.\n\n527\n00:27:28.560 --> 00:27:32.910\nI'll edit lab2.itprotv.com, so\nI'm gonna add this second one,\n\n528\n00:27:32.910 --> 00:27:36.826\nAnd instead of keying off of an IP,\nI'm gonna key off of a name.\n\n529\n00:27:36.826 --> 00:27:41.937\nSo on this one, I will open up\nmy virtual host like before, so\n\n530\n00:27:41.937 --> 00:27:48.100\nI'll say virtualhost, and\ninstead of an IP, I'm gonna say *:80.\n\n531\n00:27:48.100 --> 00:27:53.540\nI'm gonna match any traffic coming\nin on any interface on port 80.\n\n532\n00:27:53.540 --> 00:27:57.360\nNow, that sounds bad, that sounds like it\nwould override the default, wouldn't it?\n\n533\n00:27:57.360 --> 00:28:03.091\nWell, it's not going to if I\nproceed to provide a server name,\n\n534\n00:28:03.091 --> 00:28:06.886\ncuz server name's what we'll match on.\n\n535\n00:28:06.886 --> 00:28:11.445\nSo I'm gonna say, server name,\nlab2.itv.protv, so\n\n536\n00:28:11.445 --> 00:28:17.010\nit's going to be matching on the name and\nthen moving on from there.\n\n537\n00:28:17.010 --> 00:28:20.906\nAnd I can specify the rest of\nthe settings as I normally would, so\n\n538\n00:28:20.906 --> 00:28:23.808\nI can do server alias,\nif I have them, I might.\n\n539\n00:28:23.808 --> 00:28:28.417\nSo this might be another\nalias that I've got, and\n\n540\n00:28:28.417 --> 00:28:33.376\nthen the document root that\nI'm gonna be providing.\n\n541\n00:28:33.376 --> 00:28:36.921\nSo I'll provide\n/var/www/html/lab2.itpro.tv, or\n\n542\n00:28:36.921 --> 00:28:40.266\nit might be an entirely different name,\nlike pets.com.\n\n543\n00:28:40.266 --> 00:28:42.164\nWhatever it is that I\nhappen to be hosting,\n\n544\n00:28:42.164 --> 00:28:45.881\nI'll provide that as that document root,\nand then I'll close that virtual host.\n\n545\n00:28:45.881 --> 00:28:49.596\nNow, if you do this,\ncouple of words of caution,\n\n546\n00:28:49.596 --> 00:28:53.045\nif you've just got named hosts like this,\nand\n\n547\n00:28:53.045 --> 00:28:58.640\nthere isn't a match,\nthey'll get the default page, normally.\n\n548\n00:28:58.640 --> 00:29:03.453\nThere are some distros that change that\ndefault behavior, and what they do is\n\n549\n00:29:03.453 --> 00:29:07.909\nthey say, if there's no match,\nwe'll give you the first named host.\n\n550\n00:29:07.909 --> 00:29:11.270\nNow that's a bit of a weird behavior,\ncuz if you're loading config files this,\n\n551\n00:29:11.270 --> 00:29:12.740\nwhich on is the first?\n\n552\n00:29:12.740 --> 00:29:14.885\nYou don't know, it's actually loaded\nalphabetically, just for the record.\n\n553\n00:29:14.885 --> 00:29:18.452\nSo whichever one is alphabetically first,\nis what people would get served, and\n\n554\n00:29:18.452 --> 00:29:20.830\nthat's not necessarily what you want.\n\n555\n00:29:20.830 --> 00:29:24.162\nAnd so, what a lot of people will do is,\ninstead of using subfiles like I'm doing\n\n556\n00:29:24.162 --> 00:29:27.060\nhere, they'll go ahead and\nput them in the main configuration file.\n\n557\n00:29:27.060 --> 00:29:29.572\nAnd that way,\nyou can dictate the order right there, and\n\n558\n00:29:29.572 --> 00:29:32.090\nwhichever one is first will be loaded.\n\n559\n00:29:32.090 --> 00:29:35.970\nThe other option is, you can make sure\nthe first one is treated as your default.\n\n560\n00:29:35.970 --> 00:29:38.936\nYou can just make that one the default,\nand not have a default website defined,\n\n561\n00:29:38.936 --> 00:29:40.012\nyou can go that route, too.\n\n562\n00:29:40.012 --> 00:29:42.870\nSo there's a few different\nvariations how we handle this.\n\n563\n00:29:42.870 --> 00:29:47.210\nJust know that if you make\nmoney off of your website,\n\n564\n00:29:47.210 --> 00:29:50.350\nif your business is your website,\nyou'll wanna go the static IP route.\n\n565\n00:29:50.350 --> 00:29:51.600\nThat is the way to go,\n\n566\n00:29:51.600 --> 00:29:54.949\nand public IPs aren't that expensive\nanymore, that's typically what you want.\n\n567\n00:29:56.010 --> 00:29:58.520\nBut if you don't have a ton of public IPs,\n\n568\n00:29:58.520 --> 00:30:02.050\nif you're just trying to get by with\nwhat you've got, names are safe.\n\n569\n00:30:02.050 --> 00:30:05.064\nBut typically, it is safer to put\nthese names, put these virtual hosts,\n\n570\n00:30:05.064 --> 00:30:08.081\nin the main configuration file, so\nyou can dictate that order, [LAUGH] and\n\n571\n00:30:08.081 --> 00:30:09.170\nnot rely on the alphabet.\n\n572\n00:30:09.170 --> 00:30:12.661\nSo, but there's other ways to manipulate\nit, you can change the file names to put\n\n573\n00:30:12.661 --> 00:30:15.292\nnumbers before them, and\nthat would change the order too, so\n\n574\n00:30:15.292 --> 00:30:17.383\nthere's several different\nways to solve that.\n\n575\n00:30:17.383 --> 00:30:19.263\nBut just be aware of that behavior,\n\n576\n00:30:19.263 --> 00:30:23.652\nthat some distros will automatically\ndefault to whatever's in the main configs,\n\n577\n00:30:23.652 --> 00:30:26.420\nothers will default to\nthe very first virtual host.\n\n578\n00:30:26.420 --> 00:30:29.690\nSo just be aware of that behavior,\nit is something that I've bumped into.\n\n579\n00:30:29.690 --> 00:30:34.390\n&gt;&gt; Awesome info, Don,\nthis is installing HTTPD, part two.\n\n580\n00:30:34.390 --> 00:30:38.050\nThere is a part one, and\nbefore we move on, Don, any last words?\n\n581\n00:30:38.050 --> 00:30:39.295\n&gt;&gt; The only other thing\nI wanted to mention,\n\n582\n00:30:39.295 --> 00:30:41.261\nwe've kind of gone through all\nthe configs that I wanted to show.\n\n583\n00:30:41.261 --> 00:30:43.894\nBut some of you might be asking,\nwait a minute Don,\n\n584\n00:30:43.894 --> 00:30:46.050\nyou didn't talk about SSL a single time.\n\n585\n00:30:46.050 --> 00:30:50.087\nI did that on purpose, we're going to be\ntalking about SSL in a separate episode,\n\n586\n00:30:50.087 --> 00:30:51.327\nso not like a part three.\n\n587\n00:30:51.327 --> 00:30:53.113\nWe'll have a dedicated\nepisode just on SSL,\n\n588\n00:30:53.113 --> 00:30:55.752\ncuz it is really important that you\nhave security on your web page.\n\n589\n00:30:55.752 --> 00:30:58.670\nSo we're going to tackle that one\nspecifically, so stay tuned for that one.\n\n590\n00:30:58.670 --> 00:31:02.476\n&gt;&gt; Awesome, and we will, because there's\na lot of video content in the Becoming\n\n591\n00:31:02.476 --> 00:31:04.680\na Linux Server Administrator series.\n\n592\n00:31:04.680 --> 00:31:08.493\nYou want to make sure you watch every\nsingle video, you'll be glad you did.\n\n593\n00:31:08.493 --> 00:31:11.102\nAnd thank you for\nwatching ITProTV, remember,\n\n594\n00:31:11.102 --> 00:31:13.870\na good IT pro is always learning,\nI'm Zach Memos.\n\n595\n00:31:13.870 --> 00:31:14.576\n&gt;&gt; And I'm Don Pezet.\n\n596\n00:31:14.576 --> 00:31:15.598\n&gt;&gt; And we will see you soon.\n\n597\n00:31:15.598 --> 00:31:22.893\n[MUSIC]\n\n598\n00:31:22.893 --> 00:31:24.825\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "228812988"
        },
        {
          "description": "Don and Zach discuss SSL, if SSL is supported by default, installing SSL, generating our own certificates, define the certificate & key, multiple websites needing different certificates, and SSL versions that are compromised or weak.",
          "length": "1911",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-2-configuring_ssl-080817-PGM.00_31_35_03.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-2-configuring_ssl-080817-PGM.00_31_35_03.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-6-2-configuring_ssl-080817-PGM.00_31_35_03.Still001-sm.jpg",
          "title": "Configuring SSL",
          "transcript": "WEBVTT\n\n1\n00:00:00.280 --> 00:00:01.200\nWelcome to ITProTV.\n\n2\n00:00:01.200 --> 00:00:02.906\nI'm your host Don Pezet.\n\n3\n00:00:02.906 --> 00:00:03.672\n[CROSSTALK]\n[MUSIC]\n\n4\n00:00:03.672 --> 00:00:05.220\n&gt;&gt; You're watching ITProTV.\n\n5\n00:00:05.220 --> 00:00:10.548\n&gt;&gt; Hello and thank you for\nchoosing ITProTV,\n\n6\n00:00:10.548 --> 00:00:14.990\nhelping you learn wherever you go.\n\n7\n00:00:14.990 --> 00:00:15.998\nI'm your host,\n\n8\n00:00:15.998 --> 00:00:21.070\nZach Memos as we continue on with\nbecoming a Linux Server administrator.\n\n9\n00:00:21.070 --> 00:00:24.100\nAnd this subject today\nis really interesting.\n\n10\n00:00:24.100 --> 00:00:26.390\nWe're gonna be working with SSL,\nright, Don?\n\n11\n00:00:26.390 --> 00:00:28.930\nAnd Don Pezet is gonna bring us\nall the information we need.\n\n12\n00:00:28.930 --> 00:00:29.740\n&gt;&gt; All right, Doc.\n\n13\n00:00:29.740 --> 00:00:33.030\nYeah, SSL is what we're gonna talk about,\nand it's a really important one.\n\n14\n00:00:33.030 --> 00:00:36.380\nI know some of you might have watched our\nepisodes on standing up a web server.\n\n15\n00:00:36.380 --> 00:00:39.430\nAnd we did two episodes, we kind of walked\nthrough all the different components and\n\n16\n00:00:39.430 --> 00:00:42.530\nwe never once mentioned SSL and\nit wasn't a glaring oversight.\n\n17\n00:00:42.530 --> 00:00:45.229\nI just wanted to make sure that we address\nthis separately because, [CROSSTALK]\n\n18\n00:00:45.229 --> 00:00:46.084\n&gt;&gt; You teased us, you teased us.\n\n19\n00:00:46.084 --> 00:00:47.685\n&gt;&gt; That's right.\n\n20\n00:00:47.685 --> 00:00:50.797\nAnd it is, it's really,\nreally critical because in the old days,\n\n21\n00:00:50.797 --> 00:00:52.015\n[CROSSTALK]\n&gt;&gt; Old days.\n\n22\n00:00:52.015 --> 00:00:53.820\n&gt;&gt; The internet was a trusted place.\n\n23\n00:00:53.820 --> 00:00:54.430\nIt was safer.\n\n24\n00:00:54.430 --> 00:00:56.960\nWe didn't have to worry about any,\na lot of web pages were unencrypted and\n\n25\n00:00:56.960 --> 00:00:57.970\nthat's how it was.\n\n26\n00:00:57.970 --> 00:01:00.840\nIn today's world the surveillance and\n\n27\n00:01:00.840 --> 00:01:03.720\nhacking world it's almost\nan essentially thing.\n\n28\n00:01:03.720 --> 00:01:06.840\nThat when you go to a website even\nwebsites without critical data,\n\n29\n00:01:06.840 --> 00:01:09.070\nusers expect them to be encrypted.\n\n30\n00:01:09.070 --> 00:01:10.790\nThey expect to have SSL right?\n\n31\n00:01:10.790 --> 00:01:12.260\nAnd that's because it does two things.\n\n32\n00:01:12.260 --> 00:01:13.680\nOne it protects your privacy, and\n\n33\n00:01:13.680 --> 00:01:18.760\nthe second it helps you validate that the\nsite you're on is who they say they are.\n\n34\n00:01:18.760 --> 00:01:22.200\nSo if you're ever going to stand\nup a web server on a Linux system,\n\n35\n00:01:22.200 --> 00:01:25.960\nyou're usually going to be expected\nto attach an SSL Certificate,\n\n36\n00:01:25.960 --> 00:01:27.880\na Secure Socket Layer Certificate so\n\n37\n00:01:27.880 --> 00:01:30.590\nthat people can do that validation and\nprotection.\n\n38\n00:01:30.590 --> 00:01:33.890\nWell, unfortunately,\ngetting an SSL certificate set up is not\n\n39\n00:01:33.890 --> 00:01:36.770\nthe most intuitive process, so I wanna\nwalk you in here in this episode and\n\n40\n00:01:36.770 --> 00:01:39.910\nkinda show you guys how to create\nthe certificate, how to get it attached to\n\n41\n00:01:39.910 --> 00:01:43.220\nApache and make it where you're\nserving up your site securely.\n\n42\n00:01:43.220 --> 00:01:45.800\nSo those are all the things that we're\ngonna be taking a look at right here\n\n43\n00:01:45.800 --> 00:01:46.420\nin this episode.\n\n44\n00:01:46.420 --> 00:01:50.250\n&gt;&gt; So a question right up front,\nis SSL supported by Fault.\n\n45\n00:01:50.250 --> 00:01:52.460\n&gt;&gt; So like a lot of things in Linux.\n\n46\n00:01:52.460 --> 00:01:54.485\nThe answer unfortunately sometimes.\n\n47\n00:01:54.485 --> 00:01:57.949\n&gt;&gt; [LAUGH]\n&gt;&gt; So, when you install Apache depending\n\n48\n00:01:57.949 --> 00:02:01.370\non how you install you might\nactually have a cell support.\n\n49\n00:02:01.370 --> 00:02:06.440\nSo, in Redhand Enterprise Linux what I've\nbeen using in this show if I just do a Yam\n\n50\n00:02:06.440 --> 00:02:10.650\ninstall HTPD It actually\ndoesn't set up SSL,\n\n51\n00:02:10.650 --> 00:02:12.780\nit's just straight up HTTP and that's it.\n\n52\n00:02:12.780 --> 00:02:13.585\nAnd we can add support if we want.\n\n53\n00:02:13.585 --> 00:02:17.980\nBut if you did a group install web server,\nit does, right.\n\n54\n00:02:17.980 --> 00:02:21.140\nSo you might actually have that support,\nlet me show you what I mean.\n\n55\n00:02:21.140 --> 00:02:25.780\nSo here if I just do a, let's see, let\nme just point out real quick that I have\n\n56\n00:02:25.780 --> 00:02:28.010\nelevated my privileges here so\nI'm in a route shell.\n\n57\n00:02:28.010 --> 00:02:29.600\nI did a sudo-s.\n\n58\n00:02:29.600 --> 00:02:31.700\nJust cuz we're gonna be doing\na lot of administrative test.\n\n59\n00:02:31.700 --> 00:02:32.250\n&gt;&gt; Right.\n\n60\n00:02:32.250 --> 00:02:35.050\n&gt;&gt; If you don't elevate your privileges,\nyou just need to pseudo everything.\n\n61\n00:02:35.050 --> 00:02:36.900\n&gt;&gt; Right.\n&gt;&gt; But I'm gonna come in here and\n\n62\n00:02:36.900 --> 00:02:39.900\njust say like, yum install httpd, right?\n\n63\n00:02:39.900 --> 00:02:42.200\nAnd when I do that, it's gonna show\nme the packages its gonna install.\n\n64\n00:02:42.200 --> 00:02:44.330\nIt's only gonna install\na couple of things, right?\n\n65\n00:02:44.330 --> 00:02:48.970\nHTTPD and HTPD tools are kind of\nthe two main things that it installs.\n\n66\n00:02:48.970 --> 00:02:51.530\nAnd there's just couple, I got a little\npieces that getting brought along.\n\n67\n00:02:51.530 --> 00:02:54.250\nBut not SSL, right?\n\n68\n00:02:54.250 --> 00:02:58.170\nVersus if I had done\na group install web server,\n\n69\n00:02:58.170 --> 00:03:00.120\nwe'll see that's a little bit different.\n\n70\n00:03:00.120 --> 00:03:05.867\nWhen I do a group install web server like\nthat, it's gonna pull up The SSL module,\n\n71\n00:03:05.867 --> 00:03:09.763\nand that's the key piece,\nthis guy right here, mod_ssl.\n\n72\n00:03:09.763 --> 00:03:12.021\nAnd actually, there are two pieces.\n\n73\n00:03:12.021 --> 00:03:16.132\nmod_ssl is the most important, and\nwe need that, or SSL isn't gonna work.\n\n74\n00:03:16.132 --> 00:03:21.120\nAnd crypto_utils is another one that\nwe don't need, but if you're gonna\n\n75\n00:03:21.120 --> 00:03:24.640\ngenerate a certificate signing request,\nyou need those crypto_utils to do it.\n\n76\n00:03:24.640 --> 00:03:27.520\nSo those are two components that for\neverything I do in this episode,\n\n77\n00:03:27.520 --> 00:03:30.000\nI'd assume that you guys\nalready have installed.\n\n78\n00:03:30.000 --> 00:03:32.250\nSo if you don't have them,\nmake sure you install those.\n\n79\n00:03:32.250 --> 00:03:34.210\nThe cryto utils and mod SSL.\n\n80\n00:03:34.210 --> 00:03:38.490\nNow there is another option that we\ncould do which is basic web server\n\n81\n00:03:38.490 --> 00:03:40.280\nthat gets even more packages.\n\n82\n00:03:40.280 --> 00:03:41.310\nAnd so we can run that one.\n\n83\n00:03:41.310 --> 00:03:45.300\nJust gonna reach out and it's gonna pull\nin a ton of stuff which also includes SSL.\n\n84\n00:03:45.300 --> 00:03:47.236\n&gt;&gt; So is that default SSL good enough?\n\n85\n00:03:47.236 --> 00:03:49.422\nIs that all we need to use or can use or?\n\n86\n00:03:49.422 --> 00:03:50.546\n&gt;&gt; Not really.\n\n87\n00:03:50.546 --> 00:03:54.500\nSo I'm gonna go ahead and say yes to\nthis install While it's doing that.\n\n88\n00:03:54.500 --> 00:03:58.050\nThe default SSL that is set\nupped is not really ideal.\n\n89\n00:03:58.050 --> 00:03:59.790\nFirst off, it's self signed.\n\n90\n00:03:59.790 --> 00:04:02.732\nOkay, a self signed certificate\nis not him to trust anybody.\n\n91\n00:04:02.732 --> 00:04:06.570\nSo, anybody comes to the website and\nhits that secured page Is gonna\n\n92\n00:04:06.570 --> 00:04:09.300\nget a warning about the certificate\nbeing untrusted, that's not good.\n\n93\n00:04:09.300 --> 00:04:10.858\nThe other thing is that it's usually weak.\n\n94\n00:04:10.858 --> 00:04:16.410\nIt's usually 1.024 bytes, which I say\nis weak that's actually fairly strong,\n\n95\n00:04:16.410 --> 00:04:19.900\nbut it's theoretically breakable and there\nhave been some exploits out there that\n\n96\n00:04:19.900 --> 00:04:23.830\nhave taken advantage of weaknesses in the\nserver to break that So, we kind of like\n\n97\n00:04:23.830 --> 00:04:26.770\nto see two thousand and forty-eight bit or\nare higher out there in the wild today,\n\n98\n00:04:26.770 --> 00:04:30.500\nso that default certificate is\nreally just kind of a place holder.\n\n99\n00:04:30.500 --> 00:04:35.580\nAnd so, what we need to od, is once the\nSSL support is there, we can come in and\n\n100\n00:04:35.580 --> 00:04:37.510\nreplace it with our own certificate.\n\n101\n00:04:37.510 --> 00:04:41.620\nAnd that's kind of the important part,\nto get all this working right And\n\n102\n00:04:41.620 --> 00:04:43.090\ndoing what we need it to do.\n\n103\n00:04:43.090 --> 00:04:46.280\nSo I'm just gonna turn on\nthat service real quick.\n\n104\n00:04:46.280 --> 00:04:50.457\nAnd once I've got that done,\nI can browse to this server.\n\n105\n00:04:50.457 --> 00:04:54.870\nSo I'm gonna fire up a web browser,\nand I'm gonna browse to that server.\n\n106\n00:04:54.870 --> 00:04:58.130\nAnd I'm just gonna use an unencrypted\nconnection here first, right?\n\n107\n00:04:58.130 --> 00:05:01.250\nSo I can see that my\nweb server is working.\n\n108\n00:05:01.250 --> 00:05:05.925\nAnd then if I do an https/::,\nI get a warning,\n\n109\n00:05:05.925 --> 00:05:09.816\ntelling my connection's not private.\n\n110\n00:05:09.816 --> 00:05:12.492\nWell I'm going to throw caution\nto the wind and just hit advance,\n\n111\n00:05:12.492 --> 00:05:13.227\nthen proceed anyway.\n\n112\n00:05:13.227 --> 00:05:17.907\nBut what it's telling me if I look at\nthe details, is it's telling me that we\n\n113\n00:05:17.907 --> 00:05:23.780\ncouldn't validate the identity It's\na self-signed serve, so we don't trust it.\n\n114\n00:05:23.780 --> 00:05:29.500\nAnd so when I get there,\nit is secure, but it's not secure.\n\n115\n00:05:29.500 --> 00:05:31.790\nIt's kind of a conundrum there, right?\n\n116\n00:05:31.790 --> 00:05:33.520\nBut it's just because it's self-signed and\n\n117\n00:05:33.520 --> 00:05:36.030\nwe don't trust the people that issued it,\nright?\n\n118\n00:05:36.030 --> 00:05:40.160\nSo Well we do have SSL by default,\nit's not really useable in that form.\n\n119\n00:05:40.160 --> 00:05:43.130\nSo we need to replace it and\nget it set up with our own certificate.\n\n120\n00:05:43.130 --> 00:05:45.120\n&gt;&gt; So\nhow can we generate our own certificate?\n\n121\n00:05:45.120 --> 00:05:47.660\n&gt;&gt; All right,\nwell that's where the package comes in.\n\n122\n00:05:47.660 --> 00:05:51.473\nSo when we installed all this stuff\nit also installed the package, and\n\n123\n00:05:51.473 --> 00:05:54.260\nthat will let you generate\nyour own certificate.\n\n124\n00:05:54.260 --> 00:05:57.860\nAnd so to do that it's really\nnot that big of a deal.\n\n125\n00:05:57.860 --> 00:06:00.110\nIt seems intimidating cuz\nsome of the commands.\n\n126\n00:06:00.110 --> 00:06:05.390\nBut basically Apache is storing SSL\ninformation in a particular location.\n\n127\n00:06:05.390 --> 00:06:11.570\nIf you browse into /etc/httbd/ssl, okay?\n\n128\n00:06:11.570 --> 00:06:14.990\nThat folder right there, well,\nsee how mine doesn't exist?\n\n129\n00:06:14.990 --> 00:06:17.128\nAnd that's because I haven't create\ncertificate and placed it there yet\n\n130\n00:06:17.128 --> 00:06:20.957\nif I just go in to number folder\nI can see the folder exists but\n\n131\n00:06:20.957 --> 00:06:23.840\nI don't have that SSL folder right?\n\n132\n00:06:23.840 --> 00:06:29.072\nAnd if I go into like conf.d and start\nlooking at my configurations, I can see\n\n133\n00:06:29.072 --> 00:06:34.840\nthe SSL configuration right there where\nit's be looking for a certificate.\n\n134\n00:06:34.840 --> 00:06:39.213\nAnd so I need to create a certificate put\nit in the SSL folder that doesn't exist\n\n135\n00:06:39.213 --> 00:06:43.603\nand then I need to update this SSL comp to\nreflect that Ive got the certificate so\n\n136\n00:06:43.603 --> 00:06:49.458\nthat's where I need to start here\nI'm going to make the SSL folder so\n\n137\n00:06:49.458 --> 00:06:54.575\nthat I now have slash etc\nslash httpd slash SSL.\n\n138\n00:06:54.575 --> 00:06:56.830\nThat;s the folder that I need.\n\n139\n00:06:56.830 --> 00:06:58.660\nAnd now I need to create a certificate.\n\n140\n00:06:58.660 --> 00:07:01.980\nNow the process of creating\na certificate is a little tricky.\n\n141\n00:07:01.980 --> 00:07:05.960\nAnybody can create a certificate easily,\na self signed certificate.\n\n142\n00:07:05.960 --> 00:07:10.450\nBut normally we want the certificate\nto be signed by a valid provider.\n\n143\n00:07:10.450 --> 00:07:11.750\nSomebody out there in the internet.\n\n144\n00:07:11.750 --> 00:07:12.726\nUsually somebody like.\n\n145\n00:07:12.726 --> 00:07:17.120\nDigicert, Verisign, [INAUDIBLE] Geotrust.\n\n146\n00:07:17.120 --> 00:07:20.500\nThese are all companies out\nthere that sell certificates,\n\n147\n00:07:20.500 --> 00:07:23.220\nand they're not really\nselling a certificate.\n\n148\n00:07:23.220 --> 00:07:27.130\nIt's kind of a misnomer, because you make\nthe certificate and you give it to them.\n\n149\n00:07:27.130 --> 00:07:29.400\nAll they're doing is\nsigning the certificate.\n\n150\n00:07:29.400 --> 00:07:33.580\nThey're doing validation to prove that you\nare who you say you are, and then putting\n\n151\n00:07:33.580 --> 00:07:37.630\ntheir stamp of approval on the certificate\nto prove that you are who you say you are.\n\n152\n00:07:37.630 --> 00:07:40.050\nSo, you can't really generate\nyour own certificates.\n\n153\n00:07:40.050 --> 00:07:42.820\nAnd if you could, you shouldn't.\n\n154\n00:07:42.820 --> 00:07:45.870\nIf you look at Amazon or\nGoogle, for that matter.\n\n155\n00:07:45.870 --> 00:07:46.770\nThey're huge companies.\n\n156\n00:07:46.770 --> 00:07:48.428\nThey can generate their own certificate,\n\n157\n00:07:48.428 --> 00:07:50.141\nthey can create their\nown CA if they wanted.\n\n158\n00:07:50.141 --> 00:07:53.013\nBut it doesn't make sense because\nif I'm going to Google site,\n\n159\n00:07:53.013 --> 00:07:56.203\nwhy would I trust a certificate that\nwas issued by Google I don't know if\n\n160\n00:07:56.203 --> 00:07:57.713\nit that certificate's secure.\n\n161\n00:07:57.713 --> 00:08:00.118\nI don't know if they went through\nthe proper validation because they control\n\n162\n00:08:00.118 --> 00:08:01.030\nthe whole chain.\n\n163\n00:08:01.030 --> 00:08:05.580\nSo, even those guys will get their\ncertificate from someone else, and\n\n164\n00:08:05.580 --> 00:08:07.830\nit's to get that extra level of trust.\n\n165\n00:08:07.830 --> 00:08:09.580\nSo, if I want a certificate,\n\n166\n00:08:09.580 --> 00:08:12.820\nthe first thing I need to do is to\nactually make the certificate myself.\n\n167\n00:08:12.820 --> 00:08:17.710\nAnd the certificate's really two pieces,\nthere's a private key and a public key.\n\n168\n00:08:17.710 --> 00:08:18.980\nAnd when we talk about an SSL certificate,\n\n169\n00:08:18.980 --> 00:08:21.380\nwe're usually talking\nabout that public key.\n\n170\n00:08:21.380 --> 00:08:24.890\nThe public key can only encrypt data.\n\n171\n00:08:24.890 --> 00:08:27.910\nThe private key can decrypt the data.\n\n172\n00:08:27.910 --> 00:08:31.750\nSo on our server, we have this private key\nthat we're trying to keep safe and secure,\n\n173\n00:08:31.750 --> 00:08:33.290\nwe don't want anybody to see.\n\n174\n00:08:33.290 --> 00:08:35.840\nBut then, we have the public\nkey that we give to everybody.\n\n175\n00:08:35.840 --> 00:08:37.375\nWe hand that out like crazy, right?\n\n176\n00:08:37.375 --> 00:08:38.885\n&gt;&gt; [LAUGH]\n&gt;&gt; And that's the one that we're getting\n\n177\n00:08:38.885 --> 00:08:40.020\nsigned by that public provider.\n\n178\n00:08:40.020 --> 00:08:43.480\nSo I need to start by creating a key.\n\n179\n00:08:43.480 --> 00:08:47.250\nAnd so, I'm gonna do that right here with\na command that can be a little bit long,\n\n180\n00:08:47.250 --> 00:08:48.700\nbut it's not too bad.\n\n181\n00:08:48.700 --> 00:08:51.530\nWe're gonna say openssl, right?\n\n182\n00:08:51.530 --> 00:08:56.523\nThe open source secure\nsocket layer library, so\n\n183\n00:08:56.523 --> 00:09:01.070\nopenssl, and then I'm gonna say genpkey.\n\n184\n00:09:01.070 --> 00:09:02.910\nI'm creating a private key, right?\n\n185\n00:09:02.910 --> 00:09:06.280\nThat super secret key,\nI don't want anybody to know about.\n\n186\n00:09:06.280 --> 00:09:09.409\nThen I'll come in and say -algorithm.\n\n187\n00:09:09.409 --> 00:09:14.927\nAnd I need to use RSA, right, which\nactually I think needs to be capitalized.\n\n188\n00:09:14.927 --> 00:09:17.725\nThat's because the typical certificates\nwe use with SSL are the RSA standard.\n\n189\n00:09:17.725 --> 00:09:19.466\nSo I'll say RSA.\n\n190\n00:09:19.466 --> 00:09:23.922\nAnd then, I need to tell it my\nprivate key options if I've got any.\n\n191\n00:09:23.922 --> 00:09:30.957\nAnd I do, because I want to make sure\nthat my RSA keygen BITS are 2048.\n\n192\n00:09:30.957 --> 00:09:34.560\nIf I leave it at the default,\nit's gonna be 1024, right?\n\n193\n00:09:34.560 --> 00:09:35.740\nThat's what we default to do.\n\n194\n00:09:35.740 --> 00:09:39.530\nAnd that was fine years ago, but as time\ngoes on, that's not so good anymore.\n\n195\n00:09:39.530 --> 00:09:40.460\nSo I wanna bump that up to 2048 bits.\n\n196\n00:09:40.460 --> 00:09:45.800\nThen I just need to tell it the name\nof the file I wanna output, right?\n\n197\n00:09:45.800 --> 00:09:50.164\nSo I'll say -out, and\nI'll call this one lab.itpro.tv.key.\n\n198\n00:09:50.164 --> 00:09:53.146\nYou can name the file whatever you want,\nbut\n\n199\n00:09:53.146 --> 00:09:58.630\nI usually put .key as the extension so\nthat I remember it's the private key.\n\n200\n00:09:58.630 --> 00:10:00.540\nI don't wanna give this to anybody.\n\n201\n00:10:00.540 --> 00:10:03.990\nAnd then, I use the name of\nthe website as the file name, so\n\n202\n00:10:03.990 --> 00:10:06.060\nI can remember what it's\nthe private key for, right?\n\n203\n00:10:06.060 --> 00:10:07.950\nThis is gonna be the private key for\nthe lab.itpro.tv.\n\n204\n00:10:07.950 --> 00:10:11.850\nIf I have five websites,\nI might have five different keys, right?\n\n205\n00:10:11.850 --> 00:10:13.340\nSo how do you keep them straight?\n\n206\n00:10:13.340 --> 00:10:14.840\nI use the file names to do that.\n\n207\n00:10:14.840 --> 00:10:18.900\nSo that command right there is\ngonna generate the private key.\n\n208\n00:10:18.900 --> 00:10:20.020\nNow, the private key is secret.\n\n209\n00:10:20.020 --> 00:10:21.785\nI don't want to give that to anybody.\n\n210\n00:10:21.785 --> 00:10:22.908\nThat's my own key.\n\n211\n00:10:22.908 --> 00:10:25.640\nI keep it secret cuz I can\nuse it to decrypt data.\n\n212\n00:10:25.640 --> 00:10:30.880\nSo it should be secured and I should never\nlet anyone else have access to it, right?\n\n213\n00:10:30.880 --> 00:10:33.889\nIn fact, what you'll see a lot of people\ndo is they'll change the permissions\n\n214\n00:10:33.889 --> 00:10:34.397\non the file.\n\n215\n00:10:34.397 --> 00:10:38.704\nThey'll do a CH mod 600 or\n700, which gives us read and\n\n216\n00:10:38.704 --> 00:10:41.840\nwrite access to the file, but nobody else.\n\n217\n00:10:41.840 --> 00:10:43.390\nAnd so, I'll go ahead and do that.\n\n218\n00:10:43.390 --> 00:10:47.670\nYou don't have to, but it is a kind\nof a standard practice you'll see.\n\n219\n00:10:47.670 --> 00:10:51.240\nAnd see how that gives the owner,\nwhich right now is root, I get read and\n\n220\n00:10:51.240 --> 00:10:55.380\nwrite, and nobody else gets any\naccess to that private key at all.\n\n221\n00:10:55.380 --> 00:10:58.720\nOkay, now, that can cause some problems\nif I'm not running Apache as root.\n\n222\n00:10:58.720 --> 00:11:01.615\nMost of us are running Apache as,\nwell, as Apache,\n\n223\n00:11:01.615 --> 00:11:04.190\nso it won't be able to\nread the certificate.\n\n224\n00:11:04.190 --> 00:11:05.770\nSo that can be a bit of a problem.\n\n225\n00:11:05.770 --> 00:11:09.435\nSo I may need to loosen those permissions\nup a little bit to provide that access.\n\n226\n00:11:09.435 --> 00:11:13.110\nYou can change the group that's\nattached to it by doing a chown.\n\n227\n00:11:13.110 --> 00:11:19.150\nAnd I can just switch that over\nto Apache if I wanna do that.\n\n228\n00:11:19.150 --> 00:11:20.633\nSo now Apache, well, actually,\n\n229\n00:11:20.633 --> 00:11:23.870\nApache still wouldn't have access cuz\nmy group doesn't have any access.\n\n230\n00:11:23.870 --> 00:11:28.582\nSo we do need to be aware that as\nyou assign these permissions that\n\n231\n00:11:28.582 --> 00:11:33.500\nI might want to do something\nlike a chmod 650 for that key.\n\n232\n00:11:33.500 --> 00:11:36.250\nSo now, the group will have read and\nexecute.\n\n233\n00:11:36.250 --> 00:11:37.450\nI guess I didn't have to do execute.\n\n234\n00:11:37.450 --> 00:11:40.410\nI could do it on four,\nwhich would have been just read only.\n\n235\n00:11:40.410 --> 00:11:44.420\nBut now the permissions are set on that\nfile, and I'm ready to take that and\n\n236\n00:11:44.420 --> 00:11:45.870\ncreate a public key off of it.\n\n237\n00:11:45.870 --> 00:11:46.733\nThat's the second part.\n\n238\n00:11:46.733 --> 00:11:48.714\nSo now, what I need to do is\ngenerate that public key,\n\n239\n00:11:48.714 --> 00:11:50.040\nthe key that I am gonna hand out.\n\n240\n00:11:50.040 --> 00:11:53.050\nAnd so, I'm going to fire up\nthat open ssl utility again.\n\n241\n00:11:53.050 --> 00:11:56.364\nAnd it's kind of weird because\nwhen we generate this public key,\n\n242\n00:11:56.364 --> 00:11:58.787\nwe're not generating\nthe final certificate.\n\n243\n00:11:58.787 --> 00:12:01.060\nWhat we're actually\ngenerating is a request.\n\n244\n00:12:01.060 --> 00:12:05.030\nA request that we're gonna then send\non to another company to validate.\n\n245\n00:12:05.030 --> 00:12:10.050\nSo I need to say, openssl req, to let\nit know that I'm building a request.\n\n246\n00:12:10.050 --> 00:12:12.500\n&gt;&gt; Right.\n&gt;&gt; And I'll tell it that I want a new key,\n\n247\n00:12:12.500 --> 00:12:15.570\nright, so I'm generating a new key.\n\n248\n00:12:15.570 --> 00:12:19.264\nAnd I'm gonna generate it based off of\nthat lab.itpro.tv.key file that I just\n\n249\n00:12:19.264 --> 00:12:20.415\ngenerated a moment ago.\n\n250\n00:12:20.415 --> 00:12:22.170\nThat's the private key.\n\n251\n00:12:22.170 --> 00:12:26.655\nSo I'm feeding the private key in\nto this open SSL request, right?\n\n252\n00:12:26.655 --> 00:12:34.031\nFrom there, I need to give it an -out file\nand I'm gonna output a Lab.itpro.tv.csr.\n\n253\n00:12:34.031 --> 00:12:38.370\nAll right, now, csr, again, you can\nname this file whatever you wanted.\n\n254\n00:12:38.370 --> 00:12:42.530\nBut I'm doing csr because this is\na Certificate Signing Request.\n\n255\n00:12:42.530 --> 00:12:45.900\nThat request file needs to\ncontain a bunch of stuff.\n\n256\n00:12:45.900 --> 00:12:50.430\nIt needs to contain my public key,\nnot the private key, the public key.\n\n257\n00:12:50.430 --> 00:12:52.890\nAnd it needs to contain\nsome information about me\n\n258\n00:12:52.890 --> 00:12:55.040\nbecause they need to validate\nthat I am who I say I am.\n\n259\n00:12:55.040 --> 00:12:58.720\nSo when I run that, it's gonna\nstart asking me questions, right?\n\n260\n00:12:58.720 --> 00:12:59.840\nWhat country are you in?\n\n261\n00:12:59.840 --> 00:13:02.310\nAnd it's very particular about this stuff.\n\n262\n00:13:02.310 --> 00:13:04.390\nIt needs the two-letter country code.\n\n263\n00:13:04.390 --> 00:13:08.690\nSo the two-letter country code for\nthe US happens to be US, so that's easy.\n\n264\n00:13:08.690 --> 00:13:11.770\nMy State, or Province name,\nand see how it says Full Name?\n\n265\n00:13:11.770 --> 00:13:14.552\nIn the US, we always abbreviate our state,\nso I'd normally say FL.\n\n266\n00:13:14.552 --> 00:13:17.160\nBut here I need to say Florida.\n\n267\n00:13:17.160 --> 00:13:20.210\nThen the City that we're in,\nwe're in Gainesville.\n\n268\n00:13:20.210 --> 00:13:23.125\nAnd then the Organization Name,\nthis is ITProTV.\n\n269\n00:13:24.200 --> 00:13:28.327\nAnd the Organizational Unit,\nthis will be Don's Lab, right?\n\n270\n00:13:28.327 --> 00:13:29.085\n&gt;&gt; [LAUGH].\n&gt;&gt; Or whatever,\n\n271\n00:13:29.085 --> 00:13:30.177\nthe unit inside of your company.\n\n272\n00:13:30.177 --> 00:13:31.290\n&gt;&gt; Yeah, yeah.\n\n273\n00:13:31.290 --> 00:13:32.189\n&gt;&gt; After that, the Common Name.\n\n274\n00:13:32.189 --> 00:13:36.220\nThe common name is probably the most\nimportant piece of this whole certificate.\n\n275\n00:13:36.220 --> 00:13:40.690\nThis is gonna be the name that end users\ntype in when they browse to your website.\n\n276\n00:13:40.690 --> 00:13:44.517\nSo my server might be called\nrhelserver.lab.itpro.tv.\n\n277\n00:13:44.517 --> 00:13:48.069\nBut if people are going to\nmy website at www.pets.com,\n\n278\n00:13:48.069 --> 00:13:51.400\nthen that's the name\nthe certificate needs to have.\n\n279\n00:13:51.400 --> 00:13:53.497\nAnd you see whatever the end users type.\n\n280\n00:13:53.497 --> 00:13:56.170\nWell, in my case, it will be lab.itpro.tv.\n\n281\n00:13:56.170 --> 00:13:59.370\nThis is one thing that you\ncan't change after the fact.\n\n282\n00:13:59.370 --> 00:14:01.534\nYou'd have to generate a new request and\nsubmit it and\n\n283\n00:14:01.534 --> 00:14:02.838\nhave the certificate rekeyed.\n\n284\n00:14:02.838 --> 00:14:06.700\nAll right, then an Email Address\nthat will attach to the certificate.\n\n285\n00:14:06.700 --> 00:14:08.280\nThis is supposed to be the administrator.\n\n286\n00:14:08.280 --> 00:14:12.800\nYou'd usually say something\nlike admin@itprotv or whatever.\n\n287\n00:14:12.800 --> 00:14:16.290\nAgain, if you wanna change this,\nyou have to reissue the certificate, so\n\n288\n00:14:16.290 --> 00:14:17.300\nit's kind of a pain.\n\n289\n00:14:17.300 --> 00:14:19.820\nSo you generally wanna use an email\naddress that's attached to some kind of\n\n290\n00:14:19.820 --> 00:14:20.583\ndistribution group.\n\n291\n00:14:20.583 --> 00:14:23.980\nSo you can redirect it\nto whoever needs it.\n\n292\n00:14:23.980 --> 00:14:25.810\nAnd then, a password.\n\n293\n00:14:25.810 --> 00:14:28.220\nNow, the password is actually optional.\n\n294\n00:14:28.220 --> 00:14:29.440\nThis is a public key.\n\n295\n00:14:29.440 --> 00:14:32.670\nIf somebody gets a hold of\nyour public key, who cares?\n\n296\n00:14:32.670 --> 00:14:34.850\nIt's the public key,\nyou're giving it on anyway, right?\n\n297\n00:14:34.850 --> 00:14:37.270\nBut if you want extra\nsecurity on this file for\n\n298\n00:14:37.270 --> 00:14:39.890\nwhen you hand it off to that provider,\nyou can.\n\n299\n00:14:39.890 --> 00:14:41.470\nYou can provide that right here.\n\n300\n00:14:41.470 --> 00:14:44.042\nBut usually, you don't need to.\n\n301\n00:14:44.042 --> 00:14:45.560\nI'm gonna leave mine empty.\n\n302\n00:14:45.560 --> 00:14:48.460\nAnd then, it's gonna ask for\nan optional Company Name,\n\n303\n00:14:48.460 --> 00:14:50.360\nwhich I'll leave empty as well.\n\n304\n00:14:50.360 --> 00:14:54.170\nAll right, now that it's done,\nif I look in my folder,\n\n305\n00:14:54.170 --> 00:14:57.340\nI've got my key that I generated,\nand I've got my CSR.\n\n306\n00:14:57.340 --> 00:15:01.607\nAnd if you take a look at\nwhat's inside of these, so\n\n307\n00:15:01.607 --> 00:15:07.680\nif I pull up lab.itprotv.key there,\nright, I see BeginPrivateKey.\n\n308\n00:15:07.680 --> 00:15:10.070\nAnd then, a whole bunch of mess, right?\n\n309\n00:15:10.070 --> 00:15:11.360\nThat's the private key.\n\n310\n00:15:11.360 --> 00:15:14.010\nAnd if you were to get all this off of\nmy screen real quick and type it in.\n\n311\n00:15:14.010 --> 00:15:16.758\nAnd then,\nintercept any secure traffic to my server,\n\n312\n00:15:16.758 --> 00:15:19.130\nyou could use this key to decrypt it.\n\n313\n00:15:19.130 --> 00:15:23.540\nBut if I take a look at that CSR,\nthe CSR is different, right?\n\n314\n00:15:23.540 --> 00:15:25.580\nHere, begin the certificate sign request.\n\n315\n00:15:25.580 --> 00:15:28.760\nAnd here's a hash that is much,\nmuch smaller, right?\n\n316\n00:15:28.760 --> 00:15:32.753\nThis is my public key alongside\n\n317\n00:15:32.753 --> 00:15:35.880\nencoded versions of that\ninformation I just gave it.\n\n318\n00:15:35.880 --> 00:15:38.820\nMy name, my address and so on.\n\n319\n00:15:38.820 --> 00:15:40.470\nAnd this is not super secretive.\n\n320\n00:15:40.470 --> 00:15:41.550\nYou could take this and feed it,\n\n321\n00:15:41.550 --> 00:15:43.685\nthere's a number of websites out\nthere you can feed a CSR into.\n\n322\n00:15:43.685 --> 00:15:47.925\nAnd it'll extrapolate the name and address\nand all that, cuz it's public information.\n\n323\n00:15:47.925 --> 00:15:50.476\nNothing in the CSR is considered private.\n\n324\n00:15:50.476 --> 00:15:53.375\nThis is a public piece of data, right?\n\n325\n00:15:53.375 --> 00:15:57.166\nAnd so, technically, that's my public key,\nplus a few extra things, right?\n\n326\n00:15:57.166 --> 00:16:00.632\nBut this public key is not\ntrusted by anybody yet.\n\n327\n00:16:00.632 --> 00:16:03.833\nI need to sent it to a certificate\nauthority and get them to sign off on it,\n\n328\n00:16:03.833 --> 00:16:06.270\nand say,\nthis is now a trusted certificate.\n\n329\n00:16:06.270 --> 00:16:09.220\nSo I would take this CSR and\nsend it to DigiCert, or\n\n330\n00:16:09.220 --> 00:16:11.600\nwhoever, and pay them some money.\n\n331\n00:16:11.600 --> 00:16:14.030\nThey'll validate your identity,\nusually call you on the phone.\n\n332\n00:16:14.030 --> 00:16:15.668\nSometimes they make you\nsend in bank statements or\n\n333\n00:16:15.668 --> 00:16:17.910\nwhatever to prove that you\nare who you say you are.\n\n334\n00:16:17.910 --> 00:16:21.464\nAnd then they'll sign the request and\nthey'll send you back your key.\n\n335\n00:16:21.464 --> 00:16:24.231\nAll right, now to save a little bit\nof time, we're gonna go ahead and\n\n336\n00:16:24.231 --> 00:16:26.340\nsign the certificate ourselves, right?\n\n337\n00:16:26.340 --> 00:16:27.758\nYou can do that,\nyou can sign your own cert.\n\n338\n00:16:27.758 --> 00:16:29.160\nIt's just nobody's gonna trust it.\n\n339\n00:16:29.160 --> 00:16:31.370\nAnd so\nyou'll get the warnings on your web page.\n\n340\n00:16:31.370 --> 00:16:35.230\nSo what we need to do is\nwe need to say open SSL.\n\n341\n00:16:35.230 --> 00:16:36.890\nAnd now we're gonna\npretend like we're the CA.\n\n342\n00:16:36.890 --> 00:16:39.790\nAnd I'll say I'm gonna sign it and\ncreate an X509 certificate.\n\n343\n00:16:40.960 --> 00:16:44.672\nAnd I'm gonna feed in our request and\nI'm gonna authorize it for\n\n344\n00:16:44.672 --> 00:16:48.193\na certain amount of days and\nI'm gonna do two years, right?\n\n345\n00:16:48.193 --> 00:16:51.325\n365 days a year,\nnormally that would be 730.\n\n346\n00:16:51.325 --> 00:16:53.547\nI'm gonna allow one extra day for\nleap year.\n\n347\n00:16:53.547 --> 00:16:54.133\n&gt;&gt; That's right.\n\n348\n00:16:54.133 --> 00:16:55.227\n&gt;&gt; [LAUGH] 731.\n\n349\n00:16:55.227 --> 00:16:57.646\nIn reality, the shorter the certificate\nlifetime the better, but\n\n350\n00:16:57.646 --> 00:16:58.970\nit's more administrative effort.\n\n351\n00:16:58.970 --> 00:17:00.950\nYou've gotta replace it more frequently.\n\n352\n00:17:00.950 --> 00:17:04.720\nSystems like Let's Encrypt like\nto do 30 and 60 day certificates,\n\n353\n00:17:04.720 --> 00:17:06.280\ncuz they do automated renewals.\n\n354\n00:17:06.280 --> 00:17:08.120\nBut if you have manual renewals,\nit gets to be a bit of a pain.\n\n355\n00:17:08.120 --> 00:17:10.060\nSo you don't wanna go too long, though.\n\n356\n00:17:10.060 --> 00:17:13.936\nI think three years is usually about the\nmax you'll see most people issue because\n\n357\n00:17:13.936 --> 00:17:16.844\nit gives the attackers more time\nto work on the certificate.\n\n358\n00:17:16.844 --> 00:17:19.720\nAll right,\nthen I need to feed a file into it.\n\n359\n00:17:19.720 --> 00:17:23.030\nI'm gonna be feeding the certificate\nsigning request into it,\n\n360\n00:17:23.030 --> 00:17:24.060\nnot the private key.\n\n361\n00:17:24.060 --> 00:17:27.280\nBecause remember the signing authority\nnever actually gets the private key,\n\n362\n00:17:27.280 --> 00:17:29.430\nthey're signing your certificate.\n\n363\n00:17:29.430 --> 00:17:34.250\nAnd so then I'll tell it I wanna sign\nthe key, and we're gonna sign it.\n\n364\n00:17:34.250 --> 00:17:38.690\nAnd I'm gonna sign this one, and\nsince I'm doing it as self-signed,\n\n365\n00:17:38.690 --> 00:17:41.640\nI'm gonna feed in that private key to it,\nright?\n\n366\n00:17:41.640 --> 00:17:42.940\nAnd by doing that,\n\n367\n00:17:42.940 --> 00:17:47.991\nI can then tell it I want it output\ninto an actual certificate right there.\n\n368\n00:17:47.991 --> 00:17:49.993\nLab.ITpro.tv.crt.\n\n369\n00:17:49.993 --> 00:17:53.589\nAll right, so\nthat certificate right there is going to\n\n370\n00:17:53.589 --> 00:17:56.630\nbe the actual one that I\ncan use on my website.\n\n371\n00:17:56.630 --> 00:17:57.190\nThere it goes.\n\n372\n00:17:57.190 --> 00:17:58.390\nIt signs it.\n\n373\n00:17:58.390 --> 00:18:01.053\nAnd now it's been signed off on, okay?\n\n374\n00:18:01.053 --> 00:18:02.940\nNow I had to use my private key there.\n\n375\n00:18:02.940 --> 00:18:04.200\nWhen you use a CA,\n\n376\n00:18:04.200 --> 00:18:07.140\nthe CA has their own private key\nthat's up through their hierarchy, so\n\n377\n00:18:07.140 --> 00:18:11.310\nyou have a certificate authority and\na whole hierarchy that gets followed.\n\n378\n00:18:11.310 --> 00:18:14.640\nSo that's why it doesn't have to be\nnecessarily keyed off of your private key.\n\n379\n00:18:14.640 --> 00:18:17.480\nBut now that it's signed,\nI've got that certificate,\n\n380\n00:18:17.480 --> 00:18:21.640\nand it's ready to be used in place\nof the one that Apache was using.\n\n381\n00:18:21.640 --> 00:18:24.190\nSo it's time to go in and\nstart working with some of those files.\n\n382\n00:18:24.190 --> 00:18:28.590\nBut as far as generating a certificate,\nthat's really all we need and\n\n383\n00:18:28.590 --> 00:18:31.350\nnow we've got three files,\nthe key which is the private key,\n\n384\n00:18:31.350 --> 00:18:35.000\nthe certificate signing request, and\nthe CRT which is the actual certificate.\n\n385\n00:18:35.000 --> 00:18:36.950\nAnd you should save all three files.\n\n386\n00:18:36.950 --> 00:18:40.730\nYou absolutely have to save the key and\nthe CRT.\n\n387\n00:18:40.730 --> 00:18:42.320\nRight, you need those.\n\n388\n00:18:42.320 --> 00:18:45.010\nThe CSR you could throw away, but\nif you ever need to reissue the cert,\n\n389\n00:18:45.010 --> 00:18:47.820\nit's kinda nice to have it laying\naround cuz it makes it easy to reissue.\n\n390\n00:18:47.820 --> 00:18:51.350\n&gt;&gt; So now that we have the certificate,\nhow do we tell our server to use it?\n\n391\n00:18:51.350 --> 00:18:54.360\n&gt;&gt; All right, so now is when we need to\nmodify our configuration a little bit.\n\n392\n00:18:55.470 --> 00:19:00.667\nBack in the conf.d folder,\nso /etc/htpd/conf.d,\n\n393\n00:19:00.667 --> 00:19:04.600\nthere was a file in there called ssl.com.\n\n394\n00:19:04.600 --> 00:19:08.450\nAnd if this certificate is being\nattached to the entire server, well,\n\n395\n00:19:08.450 --> 00:19:09.780\nthis is where we modify it.\n\n396\n00:19:09.780 --> 00:19:12.960\nAnd so I'm gonna edit that ssl.conf file.\n\n397\n00:19:12.960 --> 00:19:17.655\nAnd I'm gonna come in here and the odds\nare you've already got an entry in here\n\n398\n00:19:17.655 --> 00:19:20.500\nbecause of the self-signed cert that\nthe server is using by default.\n\n399\n00:19:20.500 --> 00:19:22.550\nAnd so if you browse through here,\n\n400\n00:19:22.550 --> 00:19:27.070\nyou'll find where it's typically\nalready defining your certificate.\n\n401\n00:19:27.070 --> 00:19:28.270\nAnd the lines that I'm looking for\n\n402\n00:19:28.270 --> 00:19:30.430\nis actually two lines that\nare really important to me.\n\n403\n00:19:30.430 --> 00:19:33.410\nOne is this guy right here,\nSSL engine on, right?\n\n404\n00:19:33.410 --> 00:19:35.170\nThat tells me that SSL is enabled.\n\n405\n00:19:35.170 --> 00:19:37.840\nI knew it was enabled cuz I was able\nto browse to it earlier anyway.\n\n406\n00:19:37.840 --> 00:19:40.810\nBut if this said off,\nSSL is not going to work, okay?\n\n407\n00:19:40.810 --> 00:19:42.900\nAnd then the next thing I'm looking for\nare two lines,\n\n408\n00:19:42.900 --> 00:19:47.080\none that says SSL certificate file, and\none that says SSL certificate key file.\n\n409\n00:19:47.080 --> 00:19:51.340\nAnd so if we look in here,\nhere is SSL certificate file.\n\n410\n00:19:51.340 --> 00:19:55.920\nAnd then right after that,\nis SSL certificate key file, okay?\n\n411\n00:19:55.920 --> 00:20:01.640\nAnd right now,\nthey're pointed to /etc/pki/tls/certs and\n\n412\n00:20:01.640 --> 00:20:02.910\nthose certificates right there.\n\n413\n00:20:02.910 --> 00:20:04.870\nThose are the self-signed\nones that came with it.\n\n414\n00:20:04.870 --> 00:20:07.806\nI'm gonna change that and\nI'm just gonna come in and\n\n415\n00:20:07.806 --> 00:20:10.950\ntell it that I want it to be\nin a different place, right?\n\n416\n00:20:10.950 --> 00:20:14.020\nSo I'll just comment out\nthe line that's already there, so\n\n417\n00:20:14.020 --> 00:20:16.196\nI can remember where the default cert was.\n\n418\n00:20:16.196 --> 00:20:22.056\nAnd I'll just punch in\nthat my new certificate\n\n419\n00:20:22.056 --> 00:20:29.580\nis in /etc/http/ssl/lab.itpro.tv.crt,\nright?\n\n420\n00:20:31.470 --> 00:20:34.680\nCuz that's the actual signed certificate.\n\n421\n00:20:34.680 --> 00:20:38.150\nAnd then down here I'll do\nthe same basic thing, right?\n\n422\n00:20:38.150 --> 00:20:44.333\nSo I'm gonna come through and just tell\nit that I want this one to be my key.\n\n423\n00:20:44.333 --> 00:20:47.902\nAnd actually I could probably save\na little bit of time with some cut and\n\n424\n00:20:47.902 --> 00:20:49.630\npaste action.\n\n425\n00:20:49.630 --> 00:20:55.394\nAnd punch in where that key is located.\n\n426\n00:20:55.394 --> 00:20:59.606\nActually I just need to correct\nit just a little bit so it says,\n\n427\n00:20:59.606 --> 00:21:05.681\nSSL certificate key file, and then\n/etc/httpd/ssl/lab.itprotv.key, right?\n\n428\n00:21:05.681 --> 00:21:10.569\nSo now I've defined those two, and I'm\nset to be able to use my own certificate.\n\n429\n00:21:11.750 --> 00:21:14.860\nThis is mainly what we want\nto get this up and going.\n\n430\n00:21:14.860 --> 00:21:17.650\nNow it's attached,\nI can restart Apache and\n\n431\n00:21:17.650 --> 00:21:20.840\nit'll start to use these certificates as\nopposed to the one that I had before.\n\n432\n00:21:20.840 --> 00:21:23.410\nI do need to double check for\nerrors, if I have a typo in here or\n\n433\n00:21:23.410 --> 00:21:25.090\nif I have permissions\non the file set wrong.\n\n434\n00:21:25.090 --> 00:21:28.610\nIf Apache can't read these,\nthat can be a bit of a problem.\n\n435\n00:21:28.610 --> 00:21:32.360\nWe've always got the issue of potentially\nnot having the right SE Linux context or\n\n436\n00:21:32.360 --> 00:21:34.540\nwhatever that could interrupt with us.\n\n437\n00:21:34.540 --> 00:21:36.610\nThose are the kind of problems\nthat we can bump into.\n\n438\n00:21:36.610 --> 00:21:38.480\nBut as it stands, they're set.\n\n439\n00:21:38.480 --> 00:21:40.390\nIf you want to avoid some of that,\n\n440\n00:21:40.390 --> 00:21:44.330\nI could have just put them in /utc/pki and\ngone there.\n\n441\n00:21:44.330 --> 00:21:47.870\nBut these are certificate storage for\nseveral different things, not just Apache.\n\n442\n00:21:47.870 --> 00:21:49.920\nSo normally,\nwe have one that's just for Apache.\n\n443\n00:21:49.920 --> 00:21:53.279\nIt goes into /etc/httpd/ssl.\n\n444\n00:21:53.279 --> 00:21:55.230\nIt's kinda the normal location for it.\n\n445\n00:21:55.230 --> 00:21:55.792\n&gt;&gt; So, Don,\n\n446\n00:21:55.792 --> 00:21:59.802\nwhat if I had multiple websites and\nthey each needed their own certificate?\n\n447\n00:21:59.802 --> 00:22:00.760\nWhat do we do?\n\n448\n00:22:00.760 --> 00:22:03.660\n&gt;&gt; Okay, so good point, right,\ncuz what I'm doing here is global.\n\n449\n00:22:03.660 --> 00:22:05.220\nThis affects the server as a whole.\n\n450\n00:22:05.220 --> 00:22:09.585\nIf I've got 10 vHosts, each vHost\nprobably has a different domain name.\n\n451\n00:22:09.585 --> 00:22:10.770\nThey almost always do.\n\n452\n00:22:10.770 --> 00:22:13.660\nAnd so if they get different domain names,\nthey need different certificates.\n\n453\n00:22:13.660 --> 00:22:18.110\nI could potentially have one certificate\nwith a ton of alternative names.\n\n454\n00:22:18.110 --> 00:22:21.940\nThey have subject alternative names\nthat you can do, but that's not\n\n455\n00:22:21.940 --> 00:22:25.160\na great idea to share one certificate\nlike that across all the sites.\n\n456\n00:22:25.160 --> 00:22:28.630\nSo instead what you can do is these\nthree lines that I mentioned,\n\n457\n00:22:28.630 --> 00:22:31.460\nthe SSL engine on, this guy.\n\n458\n00:22:31.460 --> 00:22:34.590\nAnd then the other two that\nsaid SSL certificate file and\n\n459\n00:22:34.590 --> 00:22:36.600\nSSL certificate key file.\n\n460\n00:22:36.600 --> 00:22:39.830\nYou can actually put those\nlines in the vHost definition.\n\n461\n00:22:39.830 --> 00:22:43.765\nSo when you define a vHost, and you're\nsetting things like what the server name\n\n462\n00:22:43.765 --> 00:22:46.700\nis, you can just add the SSL\ncertificate right there.\n\n463\n00:22:46.700 --> 00:22:48.940\nSo it can be overwritten\nat the vHost level.\n\n464\n00:22:48.940 --> 00:22:49.930\nThis is global.\n\n465\n00:22:49.930 --> 00:22:51.390\nYou definitely want one\nattached to the global.\n\n466\n00:22:51.390 --> 00:22:52.597\nThis is my default tape.\n\n467\n00:22:52.597 --> 00:22:56.285\nIf there is no cert, this is what I use,\nbut then on each vHost, you can just\n\n468\n00:22:56.285 --> 00:23:00.053\noverwrite it, do those three settings,\nand then you'll be taken care of.\n\n469\n00:23:00.053 --> 00:23:02.530\nSo those are kind of the way that\nwe would handle that on the vHosts.\n\n470\n00:23:02.530 --> 00:23:04.855\n&gt;&gt; Is there anything else\nwe need to look out for?\n\n471\n00:23:04.855 --> 00:23:06.570\n&gt;&gt; There's a few other settings\nin here I like to mess with.\n\n472\n00:23:06.570 --> 00:23:08.529\nTechnically, we've done\neverything that's necessary.\n\n473\n00:23:08.529 --> 00:23:09.136\n&gt;&gt; Yeah.\n\n474\n00:23:09.136 --> 00:23:10.098\n&gt;&gt; The certificates are there.\n\n475\n00:23:10.098 --> 00:23:12.800\nBut you might have noticed\nas I scrolled through,\n\n476\n00:23:12.800 --> 00:23:17.320\nthere's one setting that I like to tweak\nin here which is the SSL protocol.\n\n477\n00:23:17.320 --> 00:23:18.032\nThis guy right here.\n\n478\n00:23:18.032 --> 00:23:23.580\nAll right, see how it says,\nSSL protocol all -SSL version 2.\n\n479\n00:23:23.580 --> 00:23:29.096\nOkay, when you install Apache,\nApache supports SSL version 2,\n\n480\n00:23:29.096 --> 00:23:33.935\nversion 3, and\nTLS version 1.0, 1.1 and 1.2.\n\n481\n00:23:33.935 --> 00:23:37.955\nThere's actually five different\ncypher suites that are all\n\n482\n00:23:37.955 --> 00:23:40.910\nsupported inside of the SSL module, okay?\n\n483\n00:23:40.910 --> 00:23:41.920\nLittle bit of history.\n\n484\n00:23:41.920 --> 00:23:43.510\nI don't wanna bore us too much.\n\n485\n00:23:43.510 --> 00:23:46.909\nSecure socket layer has been\naround a long, long time, right?\n\n486\n00:23:46.909 --> 00:23:50.579\nAnd SSL version 1, the original one,\nhas been completely broken.\n\n487\n00:23:50.579 --> 00:23:54.496\nSo there's ways that an attacker can\npenetrate that and steal your private key,\n\n488\n00:23:54.496 --> 00:23:56.410\nand then decrypt everything you send.\n\n489\n00:23:56.410 --> 00:24:00.026\nSo SSL 1 Is trivial to break.\n\n490\n00:24:00.026 --> 00:24:03.110\nSSL2 now is broken as well, right?\n\n491\n00:24:03.110 --> 00:24:05.810\nAttackers have found a way to\nget in there and compromise it.\n\n492\n00:24:05.810 --> 00:24:08.160\nAnd it was part of what\nspawned the heartbleed attack,\n\n493\n00:24:08.160 --> 00:24:10.700\nif you ever heard about\nthe heartbleed compromise.\n\n494\n00:24:10.700 --> 00:24:13.610\nThat exploit was built\naround an exploit on SSL2.\n\n495\n00:24:13.610 --> 00:24:15.654\nSo a lot of people just started\ndisabling SSL Version 2, and\n\n496\n00:24:15.654 --> 00:24:17.386\nthat's actually the default\nwe're seeing here.\n\n497\n00:24:17.386 --> 00:24:20.259\nSSL Version 1 is no longer supported,\nso it's gone.\n\n498\n00:24:20.259 --> 00:24:23.847\nAnd then they're saying, we wanna support\nall protocols except SSL Version 2,\n\n499\n00:24:23.847 --> 00:24:24.780\nall right?\n\n500\n00:24:24.780 --> 00:24:29.797\nWell, the thing is, turns out heartbleed\naffected SSL Version 3 as well.\n\n501\n00:24:29.797 --> 00:24:32.627\nAnd there's a few other types of\nexploits that are out there that affect\n\n502\n00:24:32.627 --> 00:24:33.298\nSSL Version 3.\n\n503\n00:24:33.298 --> 00:24:36.037\nSo a lot of people are turning it off,\ntoo.\n\n504\n00:24:36.037 --> 00:24:41.170\nSo all that leaves is TLS 1.0,\n1.1 and 1.2.\n\n505\n00:24:41.170 --> 00:24:43.280\nTLS is the Transport Layer Security.\n\n506\n00:24:43.280 --> 00:24:45.870\nIt's where SSL applies to\na lot more than just webpages.\n\n507\n00:24:45.870 --> 00:24:50.110\nIt applies to anything, FTP, email,\nwhatever you can use it for, everything.\n\n508\n00:24:50.110 --> 00:24:53.456\nSo it's funny cuz we keep calling it SSL,\nbut it really isn't SSL anymore.\n\n509\n00:24:53.456 --> 00:24:54.462\nNow it's TLS.\n\n510\n00:24:54.462 --> 00:24:57.019\n&gt;&gt; TLS.\n&gt;&gt; So a lot of people have started\n\n511\n00:24:57.019 --> 00:25:01.790\ndisabling SSL altogether and\ncoming in and saying, like this.\n\n512\n00:25:01.790 --> 00:25:06.627\nSSL protocol all- SSLV2- SSLV3.\n\n513\n00:25:06.627 --> 00:25:12.650\nAnd by doing that, now you're only\nsupporting TLS Version 1, 1.1 and 1.2.\n\n514\n00:25:12.650 --> 00:25:17.712\nBut we're filming this episode,\nit is August, 2017,\n\n515\n00:25:17.712 --> 00:25:21.995\nand there are some attacks\nagainst TLS Version 1.\n\n516\n00:25:21.995 --> 00:25:24.950\nAnd there's even some attacks being\ncrafted against TLS Version 1.2.\n\n517\n00:25:24.950 --> 00:25:28.430\nThey're not terribly practical,\nbut they will be eventually.\n\n518\n00:25:28.430 --> 00:25:33.500\nAnd so we are starting to see\npeople get really strict with TLS.\n\n519\n00:25:33.500 --> 00:25:35.510\nTLS 1.0 is starting to go away.\n\n520\n00:25:35.510 --> 00:25:39.240\nAnd so right now,\nif I stand up a web server today,\n\n521\n00:25:39.240 --> 00:25:43.260\nI really only wanna support\nTLS Version 1.1 and 1.2.\n\n522\n00:25:43.260 --> 00:25:46.580\nAnd in time, I'll only wanna support 1.2.\n\n523\n00:25:46.580 --> 00:25:51.330\nSo, I usually change this line to say\nsomething a little bit different.\n\n524\n00:25:51.330 --> 00:25:53.896\nI say SSL protocol -all.\n\n525\n00:25:53.896 --> 00:25:58.644\nI wanna turn off every protocol and\n\n526\n00:25:58.644 --> 00:26:04.707\nthen I can say +TLS v1.1 + TLS v1.2.\n\n527\n00:26:04.707 --> 00:26:05.859\nLike that, all right?\n\n528\n00:26:05.859 --> 00:26:08.242\nNow I'm only supporting TLS 1.1 and 1.2.\n\n529\n00:26:08.242 --> 00:26:11.810\nNow that's gonna give me\nthe strongest security on the server.\n\n530\n00:26:11.810 --> 00:26:15.871\nIf a client tries to connect and negotiate\na lower connection, I'll reject them.\n\n531\n00:26:15.871 --> 00:26:19.715\nNow, if you have users that are using\nmodern web browsers that were made in\n\n532\n00:26:19.715 --> 00:26:22.010\nthe last six years, that's not a problem.\n\n533\n00:26:22.010 --> 00:26:25.460\nI think, actually five years, last\nfive years, it's not a problem, right?\n\n534\n00:26:25.460 --> 00:26:27.530\nTLS 1.2 came out five years ago.\n\n535\n00:26:27.530 --> 00:26:31.250\nBut if you have users that\nare running Internet Explorer 6 or\n\n536\n00:26:31.250 --> 00:26:35.820\nold versions of Firefox,\nold versions of custom web browsers,\n\n537\n00:26:35.820 --> 00:26:39.250\nthey may still rely on TLS 1 or\neven SSL Version 3.\n\n538\n00:26:39.250 --> 00:26:41.920\nSo you're effectively breaking\nencryption for those users, and\n\n539\n00:26:41.920 --> 00:26:42.640\nthat can be a problem.\n\n540\n00:26:42.640 --> 00:26:44.060\nSo you gotta make a decision.\n\n541\n00:26:44.060 --> 00:26:46.447\nAnd depending on the level of\nsecurity you wanna maintain,\n\n542\n00:26:46.447 --> 00:26:50.370\nit is gonna dictate which\nprotocols you pick here.\n\n543\n00:26:50.370 --> 00:26:54.191\nBut, for me, if I have users that\nare accessing my site that are using old\n\n544\n00:26:54.191 --> 00:26:57.951\nbrowsers that support the older\nencryption, I kinda feel like it's my\n\n545\n00:26:57.951 --> 00:27:01.293\nmission to inform them, hey,\nyou're using old encryption.\n\n546\n00:27:01.293 --> 00:27:03.940\nIt's really no different than not\nusing encryption at all at this point.\n\n547\n00:27:03.940 --> 00:27:06.200\nSo, you really shouldn't do that.\n\n548\n00:27:06.200 --> 00:27:08.110\nI don't think it's too much\nto ask to restrict this.\n\n549\n00:27:08.110 --> 00:27:11.960\nIf you do 1.1 and 1.2, like I said,\n1.2 came out five years ago, so\n\n550\n00:27:11.960 --> 00:27:16.300\nany web browser made in the last five\nyears, or updated in the last five years,\n\n551\n00:27:16.300 --> 00:27:18.330\nis gonna be perfectly\nfine with these settings.\n\n552\n00:27:18.330 --> 00:27:23.050\nBut if you've got some kind of older\nbrowser, like Windows XP, which isn't\n\n553\n00:27:23.050 --> 00:27:27.150\nsupported anymore, has a defaulting IE6,\nI think, it's gonna be broken.\n\n554\n00:27:27.150 --> 00:27:30.280\nAnd that happens, but\nthis is something I like to change.\n\n555\n00:27:30.280 --> 00:27:31.718\nI like to alter that.\n\n556\n00:27:31.718 --> 00:27:34.580\nJust to kinda make it a little\nmore strict for me and\n\n557\n00:27:34.580 --> 00:27:36.270\nget that setting kind of in place.\n\n558\n00:27:36.270 --> 00:27:38.220\nSo that's one thing to think about.\n\n559\n00:27:38.220 --> 00:27:40.540\nThere is another thing\nthat is worth mentioning.\n\n560\n00:27:40.540 --> 00:27:41.550\nLet me get out of this.\n\n561\n00:27:41.550 --> 00:27:44.900\nIf you ever wanna test which\ncipher suites you're running,\n\n562\n00:27:44.900 --> 00:27:46.610\nthere's a neat little utility you can use.\n\n563\n00:27:46.610 --> 00:27:47.720\nA lot of people don't know this.\n\n564\n00:27:47.720 --> 00:27:50.490\nThe open ssl command that I've been using,\n\n565\n00:27:50.490 --> 00:27:52.750\nyou can actually use it\nto test certificates.\n\n566\n00:27:52.750 --> 00:27:54.850\nAnd so I can point it at a server.\n\n567\n00:27:54.850 --> 00:27:56.958\nIf you do open ssl_sclient,\n\n568\n00:27:56.958 --> 00:28:00.750\nthat's a little secure client that\nit's got built into the utility.\n\n569\n00:28:00.750 --> 00:28:04.780\nAnd I can try and\nconnect to a server, right?\n\n570\n00:28:04.780 --> 00:28:09.555\nSo if I create a, whoops,\nI wanna connect to local host.\n\n571\n00:28:09.555 --> 00:28:14.013\nI'm gonna connect to my own system\non port 443, and I'm gonna try and\n\n572\n00:28:14.013 --> 00:28:16.366\nconnect with SSL Version 3, right?\n\n573\n00:28:16.366 --> 00:28:20.941\nAnd if I try and connect, here I get\nsecure renegotiation is supported,\n\n574\n00:28:20.941 --> 00:28:24.870\nhere's my cipher,\nI'm able to connect with SSL Version 3.\n\n575\n00:28:24.870 --> 00:28:25.500\n&gt;&gt; Awesome.\n\n576\n00:28:25.500 --> 00:28:29.930\n&gt;&gt; If I try and connect to SSL Version 2,\nthat was disabled by default, right?\n\n577\n00:28:29.930 --> 00:28:31.284\nAnd so when I go and connect,\n\n578\n00:28:31.284 --> 00:28:35.940\nrenegotiation's not supported, compression\nnone, expansion none, SSL session.\n\n579\n00:28:35.940 --> 00:28:39.020\nAnd then it tries to build it up,\nbut it's not able to build it.\n\n580\n00:28:39.020 --> 00:28:40.920\nSee how I don't get a web page after this?\n\n581\n00:28:40.920 --> 00:28:44.390\nThe SSL handshake has read zero bytes,\nright?\n\n582\n00:28:44.390 --> 00:28:48.650\nI wasn't able to communicate with\nthe server using SSL Version 2.\n\n583\n00:28:48.650 --> 00:28:52.460\nSo you can use these utilities\nto test out whether or\n\n584\n00:28:52.460 --> 00:28:57.110\nnot your server supports\na particular protocol.\n\n585\n00:28:57.110 --> 00:29:01.400\nSo when you go and restrict it,\nlike here, I'm connecting with tls1.2,\n\n586\n00:29:01.400 --> 00:29:02.853\nI connect, I see the key.\n\n587\n00:29:02.853 --> 00:29:04.673\nAnd, in fact, if I press Enter,\n\n588\n00:29:04.673 --> 00:29:08.055\nI see where I actually start to\nget my web content coming back.\n\n589\n00:29:08.055 --> 00:29:10.320\nI'm communicating and doing it securely.\n\n590\n00:29:10.320 --> 00:29:14.929\nSo, that was open SSL S_client-connect.\n\n591\n00:29:14.929 --> 00:29:18.155\nAnd, then the server import you wanna\nconnect too followed by the protocol that\n\n592\n00:29:18.155 --> 00:29:19.010\nyou wanna use.\n\n593\n00:29:19.010 --> 00:29:21.240\nSo, if you start disabling protocols,\nuse this to test.\n\n594\n00:29:21.240 --> 00:29:25.338\nOr, if you just don't know, hey, does my\npublic website support SSL Version 2?\n\n595\n00:29:25.338 --> 00:29:26.713\nIt shouldn't, first off, right?\n\n596\n00:29:26.713 --> 00:29:27.834\nThat's a really bad one.\n\n597\n00:29:27.834 --> 00:29:33.535\nSo we can point to a website and\nsay, let's test it out for SSL 2.\n\n598\n00:29:33.535 --> 00:29:38.059\nAnd you can point to whatever\nit is you wanna connect to.\n\n599\n00:29:38.059 --> 00:29:41.740\nConnect to ITPro.TV for example, right?\n\n600\n00:29:41.740 --> 00:29:43.442\nSo I'll reach out to that server.\n\n601\n00:29:43.442 --> 00:29:44.563\nWe don't support it, right?\n\n602\n00:29:44.563 --> 00:29:46.130\nOn our main website,\nwe don't support it and\n\n603\n00:29:46.130 --> 00:29:47.860\nthat's because it's\na compromised protocol.\n\n604\n00:29:47.860 --> 00:29:49.780\nSo that's another thing\nto think about with SSL.\n\n605\n00:29:49.780 --> 00:29:53.100\nBut once they're in place,\nnow your system is secured.\n\n606\n00:29:53.100 --> 00:29:56.220\nIf you used a signed certificate,\nyour users won't get warnings anymore.\n\n607\n00:29:56.220 --> 00:29:58.710\nNow they access the site,\nand it's all taken care of.\n\n608\n00:29:58.710 --> 00:30:02.322\nBut it does take a little extra work,\nbut that's basically it in a nutshell.\n\n609\n00:30:02.322 --> 00:30:04.092\n&gt;&gt; Awesome presentation as usual, Don.\n\n610\n00:30:04.092 --> 00:30:07.172\nAny last words on configuring SSL?\n\n611\n00:30:07.172 --> 00:30:09.820\n&gt;&gt; The only other thing is once you're\ndone, it's kind of a set it and\n\n612\n00:30:09.820 --> 00:30:10.780\nforget thing, right?\n\n613\n00:30:10.780 --> 00:30:12.480\nYou walk away,\nthe certificate does its job.\n\n614\n00:30:12.480 --> 00:30:15.430\n&gt;&gt; Right.\n&gt;&gt; Make a calendar reminder for\n\n615\n00:30:15.430 --> 00:30:17.312\nwhen the certificate expires, right?\n\n616\n00:30:17.312 --> 00:30:20.720\nBecause what'll happen is two years\nfrom now or 731 days from now,\n\n617\n00:30:20.720 --> 00:30:23.120\nmy certificate's gonna expire, right?\n\n618\n00:30:23.120 --> 00:30:26.310\nAnd I need to renew it, and\nrenewing is not a big deal.\n\n619\n00:30:26.310 --> 00:30:28.090\nYou come in, you change your files here.\n\n620\n00:30:28.090 --> 00:30:30.010\nYou generate a new\ncertificate sign-in request,\n\n621\n00:30:30.010 --> 00:30:31.360\nyou just repeat that step earlier.\n\n622\n00:30:31.360 --> 00:30:32.880\nYou send the CSR up to your provider,\n\n623\n00:30:32.880 --> 00:30:34.610\nthey sign it and\nthey send you a new certificate.\n\n624\n00:30:34.610 --> 00:30:38.912\nYou change it in the configuration,\nand then you do an apachectl graceful.\n\n625\n00:30:38.912 --> 00:30:40.880\nIt does a graceful restart.\n\n626\n00:30:40.880 --> 00:30:43.290\nUser sessions, when they end,\nthey reconnect and\n\n627\n00:30:43.290 --> 00:30:44.490\nnow they're on the new certificate.\n\n628\n00:30:44.490 --> 00:30:47.950\nYour end users don't even notice,\nif you catch it ahead of time.\n\n629\n00:30:47.950 --> 00:30:50.320\nBut if you forget and\nit expires, there's no warning,\n\n630\n00:30:50.320 --> 00:30:51.930\nit just all of a sudden expires.\n\n631\n00:30:51.930 --> 00:30:54.820\nAnd now, your users start getting warnings\nwhen they come to the website and\n\n632\n00:30:54.820 --> 00:30:56.410\nthey think you've been hacked, right?\n\n633\n00:30:56.410 --> 00:31:00.010\nIn today's world, if they get even\na single warning on the website,\n\n634\n00:31:00.010 --> 00:31:01.820\nthey assume you've been hacked.\n\n635\n00:31:01.820 --> 00:31:02.700\nAnd you don't want that, right?\n\n636\n00:31:02.700 --> 00:31:04.440\nSo create a calendar reminder.\n\n637\n00:31:04.440 --> 00:31:06.790\nI usually set it for\ntwo months before expiration.\n\n638\n00:31:06.790 --> 00:31:08.170\nI don't like to wait for\nthe expiration day.\n\n639\n00:31:08.170 --> 00:31:09.500\nI always do two months early.\n\n640\n00:31:09.500 --> 00:31:11.830\nThey prorate certs and\nthey extend them out and all that, so\n\n641\n00:31:11.830 --> 00:31:13.080\nit's not like you lose money.\n\n642\n00:31:13.080 --> 00:31:16.900\nBut do it early, get them renewed,\ndon't let them lapse.\n\n643\n00:31:16.900 --> 00:31:18.480\n&gt;&gt; Great advice, Don.\n\n644\n00:31:18.480 --> 00:31:20.170\nAnd don't forget the leap year,\nby the way.\n\n645\n00:31:20.170 --> 00:31:22.000\nIf you're gonna be a Linux\nserver administrator,\n\n646\n00:31:22.000 --> 00:31:24.660\nthere's a whole bunch of\nvideos in this series.\n\n647\n00:31:24.660 --> 00:31:26.660\nMake sure you watch every\nsingle one of them.\n\n648\n00:31:26.660 --> 00:31:28.189\nYou'll be very glad that you did.\n\n649\n00:31:28.189 --> 00:31:30.412\nAnd thank you for watching ITProTV.\n\n650\n00:31:30.412 --> 00:31:33.500\nRemember a good IT Pro is always learning.\n\n651\n00:31:33.500 --> 00:31:34.450\nI'm Zach Memos.\n\n652\n00:31:34.450 --> 00:31:35.130\n&gt;&gt; And I'm Don Pezet.\n\n653\n00:31:35.130 --> 00:31:36.540\n&gt;&gt; And we will see you soon.\n\n654\n00:31:36.540 --> 00:31:43.680\n[MUSIC]\n\n655\n00:31:43.680 --> 00:31:46.769\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "228969663"
        }
      ],
      "title": "Configuring an Apache Web Server"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach discuss what MariaDB is, how to install, basic security settings, critical configuration options, getting the server on-line, and adding additional users to the server.",
          "length": "1596",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-1-1-installing_mariadb-080817-PGM.00_26_20_14.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-1-1-installing_mariadb-080817-PGM.00_26_20_14.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-1-1-installing_mariadb-080817-PGM.00_26_20_14.Still001-sm.jpg",
          "title": "Installing MariaDB",
          "transcript": "WEBVTT\n\n1\n00:00:00.360 --> 00:00:01.631\nWelcome to ITProTV.\n\n2\n00:00:01.631 --> 00:00:02.943\nI'm your host Don Pezet.\n\n3\n00:00:02.943 --> 00:00:06.452\n&gt;&gt; [CROSSTALK]\n\n4\n00:00:06.452 --> 00:00:08.361\n&gt;&gt; [MUSIC]\n\n5\n00:00:08.361 --> 00:00:11.988\n&gt;&gt; You're watching ITProTV.\n\n6\n00:00:11.988 --> 00:00:14.130\n&gt;&gt; Hello and thank you for\nchoosing ITProTV.\n\n7\n00:00:14.130 --> 00:00:16.560\nHelping you learn wherever you go.\n\n8\n00:00:16.560 --> 00:00:21.280\nI'm your host Zach Memos as we continue on\nwith becoming a Linux Sever Administrator.\n\n9\n00:00:21.280 --> 00:00:23.658\nWe're going to be installing\nMariaDB aren't we?\n\n10\n00:00:23.658 --> 00:00:26.960\nAnd Don Pezet is going to tell us\nhow to do just that, aren't you Don?\n\n11\n00:00:26.960 --> 00:00:27.530\n&gt;&gt; That's right.\n\n12\n00:00:27.530 --> 00:00:29.580\nSo, in this episode we're going\nto be taking a look at MariaDB,\n\n13\n00:00:29.580 --> 00:00:32.030\nwhich is a open source,\nrelational database engine.\n\n14\n00:00:32.030 --> 00:00:33.200\nIt's extremely popular.\n\n15\n00:00:33.200 --> 00:00:37.810\nIf you haven't heard of MariaDB you\nmight know it by its other name, or\n\n16\n00:00:37.810 --> 00:00:40.770\nyou know, sort of other name, MySQL.\n\n17\n00:00:40.770 --> 00:00:43.080\nMySQL is a open source,\nrelational database,\n\n18\n00:00:43.080 --> 00:00:45.640\nbeen around a long time,\nhuge install base out there.\n\n19\n00:00:45.640 --> 00:00:48.120\nUnfortunately it's\ncontrolled by Oracle and\n\n20\n00:00:48.120 --> 00:00:51.670\nOracle made some rule changes that\npeople are pretty unhappy with.\n\n21\n00:00:51.670 --> 00:00:55.680\nSo they forked it and split it off\ninto a separate project MariaDB.\n\n22\n00:00:55.680 --> 00:00:58.260\n&gt;&gt; I like the MariaDB better\nthan the other name, actually.\n\n23\n00:00:58.260 --> 00:01:00.080\n&gt;&gt; It rolls off the tongue\n&gt;&gt; Yes, it does.\n\n24\n00:01:00.080 --> 00:01:03.110\n&gt;&gt; Well what's important\nto us is that MariaDB and\n\n25\n00:01:03.110 --> 00:01:07.010\nMySQL are fully compatible with each\nother and a majority of the commands and\n\n26\n00:01:07.010 --> 00:01:09.440\npretty much everything I'm going\nto show you in this episode,\n\n27\n00:01:09.440 --> 00:01:14.240\nworks in either product, so\nif you want to do MySQL, you just usually\n\n28\n00:01:14.240 --> 00:01:17.920\nchange anywhere where I say MariaDB\nwith MySQL, and you get that result.\n\n29\n00:01:17.920 --> 00:01:20.750\nYou'll actually where see some\nof the commands that we run\n\n30\n00:01:20.750 --> 00:01:24.680\nin MariaDB still say MySQL for\nfull feature compatibility.\n\n31\n00:01:24.680 --> 00:01:28.730\nSo, this episode really could\nbe titled installing MariaDB or\n\n32\n00:01:28.730 --> 00:01:32.450\nMySQL because we're kind of\ngonna see both sides of it.\n\n33\n00:01:32.450 --> 00:01:34.650\nBut that's what we've got lined\nup right here in this show.\n\n34\n00:01:34.650 --> 00:01:36.270\n&gt;&gt; So what software do we need?\n\n35\n00:01:36.270 --> 00:01:38.900\n&gt;&gt; All right, well, there's two\ncomponents that we wanna get installed.\n\n36\n00:01:38.900 --> 00:01:40.540\nTechnically there's only one\ncomponent that we need and\n\n37\n00:01:40.540 --> 00:01:42.480\nthat's the MariaDB server, right.\n\n38\n00:01:42.480 --> 00:01:44.560\nThe actual server itself we can install.\n\n39\n00:01:44.560 --> 00:01:46.900\nBut it's kind of hard to work with\nit if you don't have the client.\n\n40\n00:01:46.900 --> 00:01:49.490\nSo normally when we get it set\nup you're gonna install both.\n\n41\n00:01:49.490 --> 00:01:53.480\nNow a lot of distros actually package the\nclient as part of their default install,\n\n42\n00:01:53.480 --> 00:01:55.440\nso you might already have the client.\n\n43\n00:01:55.440 --> 00:01:58.520\nBut most do not package the server, and\n\n44\n00:01:58.520 --> 00:02:01.110\nthe reason is they don't\ninstall it by default.\n\n45\n00:02:01.110 --> 00:02:02.690\nThey have a package, it's not installed.\n\n46\n00:02:02.690 --> 00:02:05.990\nAnd that's because the default\ninstall is not secure, and\n\n47\n00:02:05.990 --> 00:02:10.020\nthere's a number of exploits that are out\nthere that compromise these databases.\n\n48\n00:02:10.020 --> 00:02:12.730\nSo, if we're gonna deploy we'll\nneed to make sure to secure it and\n\n49\n00:02:12.730 --> 00:02:14.210\nthat's kind of a key component.\n\n50\n00:02:14.210 --> 00:02:17.810\nSo, if we only get this set up,\nwe just need to install the client and\n\n51\n00:02:17.810 --> 00:02:20.920\nthe server so I'm here on\na Red Hat Enterprise Linux box.\n\n52\n00:02:20.920 --> 00:02:24.570\nSo these are gonna be the steps for\nRed Hat and Centos for\n\n53\n00:02:24.570 --> 00:02:27.768\nFedora, anywhere I use YUM,\nyou would just change to DNF.\n\n54\n00:02:27.768 --> 00:02:31.210\nAnd for Devian or Ubuntu,\nanywhere I use YUM,\n\n55\n00:02:31.210 --> 00:02:34.540\nyou would just do APT,\nlike APT install instead of YUM install.\n\n56\n00:02:34.540 --> 00:02:37.690\nAnd the rest of the steps are all\nthe same after the installer.\n\n57\n00:02:37.690 --> 00:02:39.190\nThat's kind of the nice part of Linux,\nis that,\n\n58\n00:02:39.190 --> 00:02:40.590\nyou might have a different installer, but\n\n59\n00:02:40.590 --> 00:02:43.270\nonce they're installed,\nall the services kind of run the same.\n\n60\n00:02:43.270 --> 00:02:47.340\nSo I'm gonna do a YUM install and\nI guess before I do this,\n\n61\n00:02:47.340 --> 00:02:50.240\nlet me just point out that\nI am at a elevated prompt.\n\n62\n00:02:50.240 --> 00:02:54.950\nSo I logged in as regular user but\nI did a sudu-s to get to a root shell.\n\n63\n00:02:54.950 --> 00:02:57.740\nEvery command we're about to run\nneeds to be done as a root user\n\n64\n00:02:57.740 --> 00:02:59.000\nuntil the day this is up and running.\n\n65\n00:02:59.000 --> 00:03:04.390\nAnd then I could switch off to a regular\nuser if I wanted, but you can run MariaDB\n\n66\n00:03:04.390 --> 00:03:07.690\nas a user application but\nthen it's tied to your account.\n\n67\n00:03:07.690 --> 00:03:11.270\nAnd so you gotta do things to keep\nit running even if you log out\n\n68\n00:03:11.270 --> 00:03:15.410\nverses as a root user you can have it\nrunning as a service all the time.\n\n69\n00:03:15.410 --> 00:03:18.240\nSo I'm gonna do a YUM install and\nthere's two components I want.\n\n70\n00:03:18.240 --> 00:03:21.610\nThere's MariaDB which is the client.\n\n71\n00:03:21.610 --> 00:03:25.730\nAnd then there is MariaDB-server,\n\n72\n00:03:25.730 --> 00:03:29.652\nwhich you probably picked up\non was the server, right?\n\n73\n00:03:29.652 --> 00:03:30.470\n&gt;&gt; Hm-mm [LAUGH].\n\n74\n00:03:30.470 --> 00:03:32.470\n&gt;&gt; You may already have\nMariaDB as the client.\n\n75\n00:03:32.470 --> 00:03:35.753\nIf I was doing MySQL it would be MySQL and\nthen MySQL-server.\n\n76\n00:03:35.753 --> 00:03:37.960\nAnd so, basically, I'm going to run this.\n\n77\n00:03:37.960 --> 00:03:39.140\nAnd it's going to look, and\n\n78\n00:03:39.140 --> 00:03:41.490\nit'll probably find that I've\nalready got the client, and!\n\n79\n00:03:41.490 --> 00:03:42.060\nI don't!\n\n80\n00:03:42.060 --> 00:03:43.270\nActually, I don't have either.\n\n81\n00:03:43.270 --> 00:03:44.070\nThat's interesting.\n\n82\n00:03:44.070 --> 00:03:44.570\nSo [LAUGH].\n\n83\n00:03:44.570 --> 00:03:45.940\nI thought I'd have it by default.\n\n84\n00:03:45.940 --> 00:03:48.050\nBut either way,\nit's going to go ahead and install them.\n\n85\n00:03:48.050 --> 00:03:48.620\nReally small.\n\n86\n00:03:48.620 --> 00:03:51.540\nI mean, if you look here, we get about\n20 megs of data, which is tiny, so\n\n87\n00:03:51.540 --> 00:03:53.510\nI'll just go ahead and say yes to that.\n\n88\n00:03:53.510 --> 00:03:54.890\nIt's going to get installed.\n\n89\n00:03:54.890 --> 00:03:58.250\nAnd then I've now installed MariaDB,\nright?\n\n90\n00:03:58.250 --> 00:04:00.380\nShortest episode ever and that's it.\n\n91\n00:04:00.380 --> 00:04:01.661\n&gt;&gt; That was just too difficult.\n\n92\n00:04:01.661 --> 00:04:03.160\n&gt;&gt; [LAUGH] There is a little more to it,\n\n93\n00:04:03.160 --> 00:04:07.050\nbut it does have a default\nconfiguration that I can start.\n\n94\n00:04:07.050 --> 00:04:09.700\nSo I can come in here and\nI can do a system CTL enable.\n\n95\n00:04:09.700 --> 00:04:13.300\nActually I should probably start it first.\n\n96\n00:04:13.300 --> 00:04:16.510\nWell no I'll do a system\nCTL enable MariaDB.\n\n97\n00:04:16.510 --> 00:04:18.920\nAnd this is a little weird cuz remember\n\n98\n00:04:18.920 --> 00:04:21.892\nwhen I used to package\nMariaDB is the client.\n\n99\n00:04:21.892 --> 00:04:24.730\nAnd MariaDB-server is the server but\n\n100\n00:04:24.730 --> 00:04:28.960\nwhen I do the actual demon\nit's called just MariaDB.\n\n101\n00:04:28.960 --> 00:04:30.360\nThat's the server demon.\n\n102\n00:04:30.360 --> 00:04:35.020\nSo I'm gonna say system\nCTL enable MariaDB, and\n\n103\n00:04:35.020 --> 00:04:37.830\nthen I'll start it up as well.\n\n104\n00:04:37.830 --> 00:04:41.870\nAnd that's gonna start up the database\nserver with a default configuration.\n\n105\n00:04:41.870 --> 00:04:46.200\nAnd the default configuration\nis not terribly secure.\n\n106\n00:04:46.200 --> 00:04:47.420\nFor example, it's got a blank password.\n\n107\n00:04:47.420 --> 00:04:48.490\nThat's not a good idea.\n\n108\n00:04:48.490 --> 00:04:50.400\nSo there are some more steps\nwe'll need to go through.\n\n109\n00:04:50.400 --> 00:04:54.070\nBut as far as getting the database\ninstalled and up and running, that's it,\n\n110\n00:04:54.070 --> 00:04:54.630\nwe're done.\n\n111\n00:04:54.630 --> 00:04:57.610\nWe now have a MariaDB server,\nit's up and it's running.\n\n112\n00:04:57.610 --> 00:05:00.170\n&gt;&gt; So what is the minimum\nconfiguration we need to get started?\n\n113\n00:05:00.170 --> 00:05:03.300\n&gt;&gt; Well I guess, you could say we've\nkinda already done the minimum,\n\n114\n00:05:03.300 --> 00:05:04.040\nit really isn't, right?\n\n115\n00:05:04.040 --> 00:05:06.760\nSo I would say this is not the minimal\ninstall because it's not secure.\n\n116\n00:05:06.760 --> 00:05:07.280\nRight.\n\n117\n00:05:07.280 --> 00:05:08.590\nSo we need to take a step further.\n\n118\n00:05:08.590 --> 00:05:11.960\nAnd I'm not the only one who knows\nthe default installer is not secure.\n\n119\n00:05:11.960 --> 00:05:12.530\nThey know it, too.\n\n120\n00:05:12.530 --> 00:05:15.880\nAnd they have a script that we can run,\none that's built into the installer that\n\n121\n00:05:15.880 --> 00:05:19.330\ngoes through what is considered the actual\nminimal to get this up and running.\n\n122\n00:05:19.330 --> 00:05:20.600\nSo let me show you that.\n\n123\n00:05:20.600 --> 00:05:24.110\nThis script is one of the commands\nthat still retains the old name.\n\n124\n00:05:24.110 --> 00:05:25.820\nThis came from MySQL.\n\n125\n00:05:25.820 --> 00:05:31.643\nSo if you run MySQL _secure_installation.\n\n126\n00:05:31.643 --> 00:05:36.820\nThis is a script that was\ninstalled in /user/bin.\n\n127\n00:05:36.820 --> 00:05:37.790\nThat's where it's stored.\n\n128\n00:05:37.790 --> 00:05:40.040\nIf you messed with your path you\ncan do the full path if you want.\n\n129\n00:05:40.040 --> 00:05:43.155\nBut it should be in your path.\n\n130\n00:05:43.155 --> 00:05:45.450\n[LAUGH] So\nwe run MySQL_secure_installation.\n\n131\n00:05:45.450 --> 00:05:47.402\nIt's a simple script and\nit goes through and\n\n132\n00:05:47.402 --> 00:05:51.290\nfixes those basic security problems that\nwe might need to worry about all right.\n\n133\n00:05:51.290 --> 00:05:55.750\nSo if we run this it's gonna ask me\nfirst what's the current root password,\n\n134\n00:05:55.750 --> 00:05:58.040\nnow this is not root for your Linux box,\n\n135\n00:05:58.040 --> 00:06:01.990\nyou have a root user on your Linux\ndistros, that's not this one.\n\n136\n00:06:01.990 --> 00:06:05.330\nMySQL MariaDB maintain\ntheir own user database,\n\n137\n00:06:05.330 --> 00:06:07.850\nusers that are internal\nto the database server.\n\n138\n00:06:07.850 --> 00:06:09.430\nAnd the root user is created by default.\n\n139\n00:06:09.430 --> 00:06:11.830\nThey're one of only a couple\nusers created by default.\n\n140\n00:06:11.830 --> 00:06:15.200\nAnd they have full access to the system,\nand this is a critical account.\n\n141\n00:06:15.200 --> 00:06:18.020\nWell, guess what the current\npassword is by default?\n\n142\n00:06:18.020 --> 00:06:18.920\nIt's blank, all right?\n\n143\n00:06:18.920 --> 00:06:19.990\nSo it's empty.\n\n144\n00:06:19.990 --> 00:06:22.580\nAnd if I just press Enter\nit's gonna tell me, okay,\n\n145\n00:06:22.580 --> 00:06:25.540\nit was empty, do you wanna set a password?\n\n146\n00:06:25.540 --> 00:06:26.470\nWell heck yeah I do.\n\n147\n00:06:26.470 --> 00:06:27.720\n&gt;&gt; Yes you do.\n\n148\n00:06:27.720 --> 00:06:29.120\n&gt;&gt; So I'm gonna say yes to that and\n\n149\n00:06:29.120 --> 00:06:32.000\nI'm gonna assign a password\nto the root user account.\n\n150\n00:06:32.000 --> 00:06:36.610\nAt a minimum you want to assign\na password to your root user account.\n\n151\n00:06:36.610 --> 00:06:40.360\nYou can actually rename the root\nuser account later on if you want,\n\n152\n00:06:40.360 --> 00:06:42.230\nbut at a minimum we just need\nto change that password.\n\n153\n00:06:42.230 --> 00:06:42.890\nRight.\n\n154\n00:06:42.890 --> 00:06:45.800\nThen the root user isn't\nthe only user by default.\n\n155\n00:06:45.800 --> 00:06:49.240\nThere's another user that\nrepresents the anonymous users.\n\n156\n00:06:49.240 --> 00:06:50.780\nUsers that haven't logged in.\n\n157\n00:06:50.780 --> 00:06:52.290\nAnd that's enabled by default.\n\n158\n00:06:52.290 --> 00:06:54.370\nAnonymous users can connect and\nread the database.\n\n159\n00:06:54.370 --> 00:06:55.710\nAnd maybe that's what you want.\n\n160\n00:06:55.710 --> 00:06:56.680\nBut most of us, it isn't.\n\n161\n00:06:56.680 --> 00:07:00.280\nAnd so it offers,\ndo you wanna remove the anonymous users?\n\n162\n00:07:00.280 --> 00:07:01.230\nYes is the default.\n\n163\n00:07:01.230 --> 00:07:02.390\nI'm gonna go with that.\n\n164\n00:07:02.390 --> 00:07:04.090\nI wanna remove anonymous users.\n\n165\n00:07:04.090 --> 00:07:04.780\nAll right?\n\n166\n00:07:04.780 --> 00:07:08.950\nAnd then,\ndo I wanna disallow root login remotely?\n\n167\n00:07:08.950 --> 00:07:12.350\nNow by default, the root user\ncan connect from anywhere, and\n\n168\n00:07:12.350 --> 00:07:15.730\nattackers know that the root\nuser exists by default,\n\n169\n00:07:15.730 --> 00:07:18.580\nand they know that the root user\nhas a blank password by default.\n\n170\n00:07:18.580 --> 00:07:23.062\nSo there are worms that crawl the internet\nlooking for MySQL servers and\n\n171\n00:07:23.062 --> 00:07:25.060\nMariaDB servers that have\na root user with no password.\n\n172\n00:07:25.060 --> 00:07:26.760\nThey constantly scan and look for that.\n\n173\n00:07:26.760 --> 00:07:29.060\nSo it's a good idea to say, you know what?\n\n174\n00:07:29.060 --> 00:07:31.400\nI should never be using the root\nuser on the network anyway.\n\n175\n00:07:31.400 --> 00:07:34.080\nSo let's restrict it, so\nthat it can only log in locally.\n\n176\n00:07:34.080 --> 00:07:37.040\nAnd that's what we're gonna say here,\ndisallow root login remotely.\n\n177\n00:07:37.040 --> 00:07:40.860\nSo by doing that, now the root user can\nonly log in when they're on this machine,\n\n178\n00:07:40.860 --> 00:07:43.199\nin other words, like a service\non this machine that's running.\n\n179\n00:07:44.580 --> 00:07:48.130\nWhen you install it,\nit does create a test database by default.\n\n180\n00:07:48.130 --> 00:07:50.846\nNow the test database just\nhas some sample data in it.\n\n181\n00:07:50.846 --> 00:07:54.527\nIt's there just so you kinda see\nthe database server's working.\n\n182\n00:07:54.527 --> 00:07:57.549\nBecause it's a known entity,\nattackers know it exists, and\n\n183\n00:07:57.549 --> 00:07:59.940\nthey can formulate attacks based on that.\n\n184\n00:07:59.940 --> 00:08:02.190\nSo if this is a production server,\nit's a good idea to remove it.\n\n185\n00:08:02.190 --> 00:08:05.600\nIf you're just learning about MySQL or\nMariaDB, though, leave it, and\n\n186\n00:08:05.600 --> 00:08:08.230\nyou can mess around with it in C or\nyou can create your own.\n\n187\n00:08:08.230 --> 00:08:10.280\nI'm gonna go ahead and leave mine here.\n\n188\n00:08:10.280 --> 00:08:12.510\nBut know that in production,\nI always remove this.\n\n189\n00:08:12.510 --> 00:08:14.760\nI always say yes to get\nrid of that database.\n\n190\n00:08:15.760 --> 00:08:19.420\nAll right, then it’s gonna ask if we\nwanna reload the privilege table.\n\n191\n00:08:19.420 --> 00:08:20.660\nThis is really important.\n\n192\n00:08:20.660 --> 00:08:24.030\nAnytime you modify permissions\nin MariaDB or MySQL,\n\n193\n00:08:24.030 --> 00:08:25.590\nit doesn't take effect immediately.\n\n194\n00:08:25.590 --> 00:08:27.386\nYou have to reload the privilege table.\n\n195\n00:08:27.386 --> 00:08:29.290\nIt's called flushing the permissions.\n\n196\n00:08:29.290 --> 00:08:30.660\nAnd if I don't do it,\n\n197\n00:08:30.660 --> 00:08:33.270\nall the changes I just made don't\ntake effect until my next restart.\n\n198\n00:08:33.270 --> 00:08:34.220\nAnd that’s not something I want.\n\n199\n00:08:34.220 --> 00:08:36.850\nSo I wanna say yes to this so\nit reloads those privileges.\n\n200\n00:08:37.902 --> 00:08:44.220\nNow MariaDB is up and running, and\nit's at least got basic security on it.\n\n201\n00:08:44.220 --> 00:08:48.190\nAnd now I've got a functioning database\nserver that I can turn over to my DBAs or\n\n202\n00:08:48.190 --> 00:08:51.780\nwhoever it is that's gonna be working on\nthe system and give them that access.\n\n203\n00:08:51.780 --> 00:08:55.700\n&gt;&gt; Are there any other critical\nconfiguration options?\n\n204\n00:08:55.700 --> 00:08:56.340\n&gt;&gt; There's some.\nSo\n\n205\n00:08:56.340 --> 00:08:58.600\nit depends on how you\nwanna use the server.\n\n206\n00:08:58.600 --> 00:09:01.160\nBy default it's really set up for\nlocal access.\n\n207\n00:09:01.160 --> 00:09:04.010\nAnd if you've got a web server, and it's\nrunning right here on this system, and\n\n208\n00:09:04.010 --> 00:09:07.290\nit's accessing the database,\nthen it's probably set up well enough for\n\n209\n00:09:07.290 --> 00:09:08.670\nyou to make use of.\n\n210\n00:09:08.670 --> 00:09:12.390\nBut if your web servers are running on a\nseparate system, and they're reaching out\n\n211\n00:09:12.390 --> 00:09:16.300\nto the database server here, we're gonna\nneed to enable some network access.\n\n212\n00:09:16.300 --> 00:09:20.580\nAnd the network access takes\na few different sides.\n\n213\n00:09:20.580 --> 00:09:22.961\nFirst off, I might need to allow\nit through the firewall, right?\n\n214\n00:09:22.961 --> 00:09:30.385\nSo I could always come in and\nsay like firewall-cmd --add service=mysql.\n\n215\n00:09:30.385 --> 00:09:31.990\nAnd that will allow MySQL thru.\n\n216\n00:09:31.990 --> 00:09:36.190\nMySQL runs on TCP port 33 or 3306.\n\n217\n00:09:36.190 --> 00:09:40.260\n3306, however you wanna say it.\n\n218\n00:09:40.260 --> 00:09:41.290\nSo 3306 by default.\n\n219\n00:09:41.290 --> 00:09:42.770\nAnd so I can add that service in.\n\n220\n00:09:42.770 --> 00:09:48.260\nRemember if you do that,\nyou also want to do a --permanent so\n\n221\n00:09:48.260 --> 00:09:49.990\nthat it will be there after a reboot.\n\n222\n00:09:49.990 --> 00:09:52.260\nSo it'll write it to the config files.\n\n223\n00:09:52.260 --> 00:09:55.170\nSo I wanna make sure that I've got that\nin place if I want network access.\n\n224\n00:09:55.170 --> 00:09:58.680\nIf I don't want network access,\nthen certainly don't add that, right?\n\n225\n00:09:58.680 --> 00:10:00.280\nBut that's gonna enable network access.\n\n226\n00:10:00.280 --> 00:10:02.307\nNow, I've only got a root\nuser at this point, and\n\n227\n00:10:02.307 --> 00:10:03.960\nroot's only allowed to log in locally.\n\n228\n00:10:03.960 --> 00:10:06.650\nSo technically,\nnetwork access is still not working.\n\n229\n00:10:06.650 --> 00:10:07.840\nI'll need to create some user accounts.\n\n230\n00:10:07.840 --> 00:10:10.060\nWe'll see that here in a little bit.\n\n231\n00:10:10.060 --> 00:10:12.825\nBut that's kind of the basics\nto get it up and on the network.\n\n232\n00:10:12.825 --> 00:10:16.306\nSome of the other things we might wanna\nmess with, that port number 3306.\n\n233\n00:10:16.306 --> 00:10:19.407\nRemember the worms I mentioned that\nare crawling the Internet looking for\n\n234\n00:10:19.407 --> 00:10:20.475\nweak servers?\n\n235\n00:10:20.475 --> 00:10:24.285\nThey know MySQL runs on 3306, so\nthey're looking for that port.\n\n236\n00:10:24.285 --> 00:10:26.575\nSo you might wanna change the port number.\n\n237\n00:10:26.575 --> 00:10:27.325\nAnd you can do that.\n\n238\n00:10:27.325 --> 00:10:33.672\nInside of /etc you'll find a file\nin there called my.cnf, okay?\n\n239\n00:10:33.672 --> 00:10:37.170\nMy for MySQL, .cnf for config.\n\n240\n00:10:37.170 --> 00:10:42.620\nAnd if you look at that file,\nlet me just edit it, so it's /etc/my.cnf,\n\n241\n00:10:42.620 --> 00:10:47.830\nand, whoops,\napparently it doesn't exist yet.\n\n242\n00:10:47.830 --> 00:10:51.480\nLet me see if it's still here or missing.\n\n243\n00:10:51.480 --> 00:10:53.920\nIt is missing, darn it.\n\n244\n00:10:53.920 --> 00:10:56.122\nWell, typically,\nyou'll have a my.cnf file.\n\n245\n00:10:56.122 --> 00:10:58.570\nIt's created by default right there,\nit's got that information.\n\n246\n00:10:58.570 --> 00:11:00.500\nMine must have not created it.\n\n247\n00:11:00.500 --> 00:11:04.360\nI do have a my.cnf.d,\nwhich is an include folder, so\n\n248\n00:11:04.360 --> 00:11:07.530\neverything in here would\nbe included in the my.cnf.\n\n249\n00:11:07.530 --> 00:11:08.800\nSo mine's missing.\n\n250\n00:11:08.800 --> 00:11:10.545\nAnd that's a little bit of a problem.\n\n251\n00:11:10.545 --> 00:11:12.040\nIt means the server is\nrunning with default.\n\n252\n00:11:12.040 --> 00:11:16.197\nSo if I want to correct that,\nwhen I installed MySQL or\n\n253\n00:11:16.197 --> 00:11:20.210\nMariaDB, it actually installed\na bunch of sample templates as well.\n\n254\n00:11:20.210 --> 00:11:24.080\nSo, I can go and I can grab those and copy\nthem over here for that default config.\n\n255\n00:11:24.080 --> 00:11:27.670\nThose sample templates are tucked\naway in a sub-folder, and\n\n256\n00:11:27.670 --> 00:11:31.570\nthey've got several different templates\ndepending on the size of your server.\n\n257\n00:11:31.570 --> 00:11:34.470\nAnd you can kind of choose the appropriate\none based on what you need.\n\n258\n00:11:34.470 --> 00:11:38.060\nNow those templates, they are kind of\nhidden away, they're hard to find.\n\n259\n00:11:38.060 --> 00:11:42.135\nIt's /usr/share/mysql.\n\n260\n00:11:42.135 --> 00:11:47.800\nAnd if you browse into that folder and\ntake a look, you'll see all the CNF files.\n\n261\n00:11:47.800 --> 00:11:50.267\nAnd notice how they have strange names,\nright?\n\n262\n00:11:50.267 --> 00:11:54.894\nmy-innodb-heavy-4G, my-large,\nmy-medium, my-small.\n\n263\n00:11:54.894 --> 00:11:57.223\n&gt;&gt; [LAUGH]\n&gt;&gt; These are config files that are tune\n\n264\n00:11:57.223 --> 00:11:59.742\nfor different database sizes, right?\n\n265\n00:11:59.742 --> 00:12:02.440\nThe larger a database, you have\na different kind of a performance profile.\n\n266\n00:12:02.440 --> 00:12:06.010\nIf you're doing an InnoDB,\nit's got a different performance profile.\n\n267\n00:12:06.010 --> 00:12:08.920\nAnd so these are CNF files\nthat are tuned to that need.\n\n268\n00:12:08.920 --> 00:12:12.320\nIf you're ever bored take a look at\nthe big one here, my-innodb-heavy-4g.\n\n269\n00:12:12.320 --> 00:12:14.288\nIt's really well documented.\n\n270\n00:12:14.288 --> 00:12:16.830\nThey kind of explain what all of\nthe settings are, and it's pretty good.\n\n271\n00:12:16.830 --> 00:12:19.650\nFor me, I'm just spinning up a small\nserver, so I'll grab that one and\n\n272\n00:12:19.650 --> 00:12:21.235\nuse it as my template.\n\n273\n00:12:21.235 --> 00:12:29.314\nSo I'm gonna copy my-small.cnf\nto /etc/my.cnf like that, okay?\n\n274\n00:12:29.314 --> 00:12:31.265\nNow, I didn't expect\nthat file to be missing.\n\n275\n00:12:31.265 --> 00:12:34.115\nIt's usually put there during the install.\n\n276\n00:12:34.115 --> 00:12:38.875\nIn my case, it wasn't for whatever reason,\nso I'm just copying it from a template.\n\n277\n00:12:38.875 --> 00:12:42.850\nAnd once you've got it there,\nnow we can edit that file.\n\n278\n00:12:42.850 --> 00:12:45.660\nAnd you can take a look at those settings.\n\n279\n00:12:45.660 --> 00:12:48.000\nAnd you will see a lot of things\nin here that you can tweak,\n\n280\n00:12:48.000 --> 00:12:51.090\nmany of which are performance related so\nwe probably don't want to mess with.\n\n281\n00:12:51.090 --> 00:12:54.729\nBut right here at the top\nyou can see Port = 3306.\n\n282\n00:12:54.729 --> 00:12:55.914\nAnd that is what I\nwanted to show you guys.\n\n283\n00:12:55.914 --> 00:12:59.050\nIf you wanna change to a non-standard\nport, here's your chance.\n\n284\n00:12:59.050 --> 00:13:01.672\nYou can change it to a non-standard port,\nand that makes it harder for\n\n285\n00:13:01.672 --> 00:13:03.070\na worm to scan and detect you.\n\n286\n00:13:03.070 --> 00:13:06.810\nIt's not true security,\nit's called security through obscurity.\n\n287\n00:13:06.810 --> 00:13:09.670\nThe better option would be to\nuse a firewall rule to tailor\n\n288\n00:13:09.670 --> 00:13:12.130\nwho's allowed to connect on port 3306.\n\n289\n00:13:12.130 --> 00:13:14.460\nYou should allow your web servers,\nnot allow worms and\n\n290\n00:13:14.460 --> 00:13:15.760\npeople scanning on the Internet.\n\n291\n00:13:15.760 --> 00:13:17.370\nThat's a better way to address it.\n\n292\n00:13:17.370 --> 00:13:19.470\nBut that's something that\nwe can change in here.\n\n293\n00:13:19.470 --> 00:13:20.470\nThere's a few other things,\n\n294\n00:13:20.470 --> 00:13:23.600\nlike you can set a bind address in\nhere to say I only wanna listen for\n\n295\n00:13:23.600 --> 00:13:28.470\nconnections on this one interface or this\nother IP, not on all of my network cards.\n\n296\n00:13:28.470 --> 00:13:30.750\nYou can define that pretty easily.\n\n297\n00:13:30.750 --> 00:13:34.950\nAnd you can also do things like restrict\nfile access from inside of the database.\n\n298\n00:13:34.950 --> 00:13:37.960\nThe root user in the database\ntechnically has access to the file\n\n299\n00:13:37.960 --> 00:13:39.540\nsystem underneath it.\n\n300\n00:13:39.540 --> 00:13:40.740\nYou might not want that, and so\n\n301\n00:13:40.740 --> 00:13:42.790\nyou'll see options in here\nwhere you can restrict that.\n\n302\n00:13:42.790 --> 00:13:45.377\nThese are all optional,\nyou don't have to tweak anything in here.\n\n303\n00:13:45.377 --> 00:13:47.952\nThe default configuration will work for\nmost people.\n\n304\n00:13:47.952 --> 00:13:51.558\nBut again, there are a lot of options\nin here that you can tweak and change.\n\n305\n00:13:51.558 --> 00:13:53.838\nThat port number is the one\nI normally head for\n\n306\n00:13:53.838 --> 00:13:57.940\nif you're gonna be modifying that for\nwhat you connect with.\n\n307\n00:13:57.940 --> 00:14:01.620\n&gt;&gt; So, Don, now that the server's online,\nhow do we use it?\n\n308\n00:14:01.620 --> 00:14:04.570\n&gt;&gt; Okay, so the server's up, it's running,\n\n309\n00:14:04.570 --> 00:14:07.620\nand technically I'm done as far as that,\nright?\n\n310\n00:14:07.620 --> 00:14:10.490\nBut if you got DBAs that are coming\nto you, what are they gonna do?\n\n311\n00:14:10.490 --> 00:14:13.690\nThey're gonna say hey, I need you to\ncreate database and give me a user so\n\n312\n00:14:13.690 --> 00:14:14.963\nI can connect to it, right?\n\n313\n00:14:14.963 --> 00:14:17.915\nIf you wanna go ultimate hands off,\nthe server is up,\n\n314\n00:14:17.915 --> 00:14:21.522\nwe could have left the root user\nto allow remote connections, and\n\n315\n00:14:21.522 --> 00:14:24.684\nsaid here you go,\nhere is the root user and the password.\n\n316\n00:14:24.684 --> 00:14:26.540\nConnect up and do your work.\n\n317\n00:14:26.540 --> 00:14:28.390\nBut as a system administrator,\n\n318\n00:14:28.390 --> 00:14:31.440\nsometimes they'll come to you and\nthey'll actually give you a database file.\n\n319\n00:14:31.440 --> 00:14:34.770\nAnd they'll say here's\nthe data that I need.\n\n320\n00:14:34.770 --> 00:14:36.445\nMake a database,\nput this in the table, and\n\n321\n00:14:36.445 --> 00:14:38.470\nthen let me know when I can get at it,\nright?\n\n322\n00:14:38.470 --> 00:14:40.680\nSo now we've gotta extend\nour knowledge a little bit.\n\n323\n00:14:40.680 --> 00:14:43.934\nThis is where we get into that kinda like\nDevOps side of things where were not just\n\n324\n00:14:43.934 --> 00:14:46.267\nbeing a system administrator and\nspinning up a service,\n\n325\n00:14:46.267 --> 00:14:49.030\nnow I've gotta do some basic\ndatabase administration.\n\n326\n00:14:49.030 --> 00:14:52.790\nSo if we wanna do that, there's not\na whole lot of complexity here,\n\n327\n00:14:52.790 --> 00:14:54.860\nit's just new commands to us, right?\n\n328\n00:14:55.988 --> 00:15:00.010\nMySQL and\nMariaDB are relational databases, and\n\n329\n00:15:00.010 --> 00:15:04.860\nthey use the SQL or\nstructured query language.\n\n330\n00:15:04.860 --> 00:15:07.830\nAnd what SQL is is it's\na standard language that\n\n331\n00:15:07.830 --> 00:15:11.130\nhas certain commands that allow\nus to talk to the server.\n\n332\n00:15:11.130 --> 00:15:14.280\nAnd the commands aren't hard,\nthey're pretty easy if you know them.\n\n333\n00:15:14.280 --> 00:15:16.776\nAnd for most of us, we're coming from\na command line environment anyway.\n\n334\n00:15:16.776 --> 00:15:19.270\nSo it's not that big or a change,\nbut they are different.\n\n335\n00:15:19.270 --> 00:15:22.235\nSo if we wanna see how to do\nsome basic stuff, first off,\n\n336\n00:15:22.235 --> 00:15:24.642\nI'm gonna use the MySQL client, all right?\n\n337\n00:15:24.642 --> 00:15:28.480\nThis was installed when I\ndid the install for MariaDB.\n\n338\n00:15:28.480 --> 00:15:29.873\nNot MariaDB dash server.\n\n339\n00:15:29.873 --> 00:15:31.550\nSo this is the MySQL client.\n\n340\n00:15:31.550 --> 00:15:33.738\nAnd we use this with MySQL and MariaDB.\n\n341\n00:15:33.738 --> 00:15:35.880\nAnd then I need to tell\nit who I'm gonna be.\n\n342\n00:15:35.880 --> 00:15:39.245\nI'm gonna tell it -u root, right?\n\n343\n00:15:39.245 --> 00:15:40.847\nI might be logged in as DPezet, but\n\n344\n00:15:40.847 --> 00:15:43.680\nI'm now connecting as the root\nuser inside of the database.\n\n345\n00:15:43.680 --> 00:15:46.672\nSo this is my user account\ninside the database.\n\n346\n00:15:46.672 --> 00:15:48.906\nAnd then I need to tell it\nto prompt me for a password.\n\n347\n00:15:48.906 --> 00:15:52.232\nNow, normally I would follow this up by\nthe server I was connecting to But in this\n\n348\n00:15:52.232 --> 00:15:55.479\ncase, I'm on the server that's running\nMariaDB so I don't have to do that.\n\n349\n00:15:55.479 --> 00:16:00.840\nIf I just run mysql-u and my username,\nit'll connect to the local database.\n\n350\n00:16:00.840 --> 00:16:03.050\nAnd -po tel to prompt for a password.\n\n351\n00:16:03.050 --> 00:16:04.720\nNow it's asking for that password.\n\n352\n00:16:04.720 --> 00:16:06.040\nI can provide it.\n\n353\n00:16:06.040 --> 00:16:08.140\nAnd it's gonna connect\nright to the local server.\n\n354\n00:16:08.140 --> 00:16:08.730\nOr it's gonna fail.\n\n355\n00:16:08.730 --> 00:16:11.880\n[LAUGH] If it fails, your server's\nnot up and you can't connect, but\n\n356\n00:16:11.880 --> 00:16:16.160\nonce you're in there, now you can\nstart to issue your SQL commands.\n\n357\n00:16:16.160 --> 00:16:18.040\nYou can start talking to the server.\n\n358\n00:16:18.040 --> 00:16:22.950\nSo I can do things like SHOW DATABASES,\nall right?\n\n359\n00:16:22.950 --> 00:16:25.100\nNow when I run these commands,\n\n360\n00:16:25.100 --> 00:16:29.330\nthe first command here is actually\npart of the SQL language.\n\n361\n00:16:29.330 --> 00:16:32.070\nThe second part is me\njust getting information.\n\n362\n00:16:32.070 --> 00:16:34.340\nAnd when I type it,\nsee how I'm doing it in all capitals?\n\n363\n00:16:34.340 --> 00:16:35.820\nIt's actually not case sensitive.\n\n364\n00:16:35.820 --> 00:16:37.570\nWhen I run that,\nit's going to give me a list of databases.\n\n365\n00:16:37.570 --> 00:16:40.320\nI could have said show\ndatabases like that,\n\n366\n00:16:40.320 --> 00:16:43.330\nthe semicolon tells you it's\nthe end of the command.\n\n367\n00:16:43.330 --> 00:16:44.920\nAnd I get the same result, all right.\n\n368\n00:16:44.920 --> 00:16:49.240\nBut it's pretty standard for\ncode sanity that when people write SQL,\n\n369\n00:16:49.240 --> 00:16:52.430\nany time that it's an actual SQL command,\nthey do it in all capital letters.\n\n370\n00:16:52.430 --> 00:16:54.650\nSo that's why I write it that way.\n\n371\n00:16:54.650 --> 00:16:57.060\nSo the normal command that\nyou would see is this.\n\n372\n00:16:57.060 --> 00:17:00.070\nBut I can take a look at it and I can see\nI've got a couple of databases, right?\n\n373\n00:17:00.070 --> 00:17:04.240\nThe test database is the one it was\noffering to remove for me earlier.\n\n374\n00:17:04.240 --> 00:17:05.790\nI left it there, so it's there.\n\n375\n00:17:05.790 --> 00:17:09.400\nWe see some performance and information\nschemas and the MySQL control database.\n\n376\n00:17:09.400 --> 00:17:11.280\nThat's what actually\ncontrolling the server.\n\n377\n00:17:11.280 --> 00:17:15.760\nSo if I'd remove test, I would just\nsee these three right here, okay?\n\n378\n00:17:15.760 --> 00:17:18.510\nNow if I want my company\nto start using this server,\n\n379\n00:17:18.510 --> 00:17:21.760\nmy first job is going to be\nto create a new database.\n\n380\n00:17:21.760 --> 00:17:25.294\nAnd so we would come in and basically\nsay something like CREATE, whoops,\n\n381\n00:17:25.294 --> 00:17:26.328\nlet me get back here.\n\n382\n00:17:26.328 --> 00:17:29.720\nCREATE DATABASE and\nthen the name of the database.\n\n383\n00:17:29.720 --> 00:17:31.900\nI'm gonna create one called Company,\nall right?\n\n384\n00:17:31.900 --> 00:17:34.340\nAnd see how I did CREATE DATABASE\nin capital letters.\n\n385\n00:17:34.340 --> 00:17:37.774\nAgain, doesn't have to be but that lets\nme know if I'm looking at a script,\n\n386\n00:17:37.774 --> 00:17:39.127\nthat those are SQL commands.\n\n387\n00:17:39.127 --> 00:17:41.820\nAnd in Company, that's mixed case.\n\n388\n00:17:41.820 --> 00:17:43.940\nThat's me actually providing data or\nvalues to it.\n\n389\n00:17:43.940 --> 00:17:47.730\nSo I'm gonna create\na database called company.\n\n390\n00:17:47.730 --> 00:17:51.660\nAnd when I start issuing commands,\nI need to be connected to a database.\n\n391\n00:17:51.660 --> 00:17:58.990\nAnd so I can say, use Company, and see how\nmy prompt changed from none to Company?\n\n392\n00:17:58.990 --> 00:18:02.110\nWhen it says none, every command\nI'm issuing is being issued against\n\n393\n00:18:02.110 --> 00:18:04.220\nthe control database, this guy, right?\n\n394\n00:18:04.220 --> 00:18:05.600\nBut now that I said, use Company,\n\n395\n00:18:05.600 --> 00:18:08.240\nthe commands that I issue are being\nissued against this database.\n\n396\n00:18:08.240 --> 00:18:10.550\nAnd now I can start to work\nwith that database and\n\n397\n00:18:10.550 --> 00:18:12.490\nset up the infrastructure that I need or\n\n398\n00:18:12.490 --> 00:18:16.250\nwhatever it is that people are asking\nme to create and put in place, right?\n\n399\n00:18:16.250 --> 00:18:21.150\nSo that kinda gets me in and\nlets me start talking to the server.\n\n400\n00:18:21.150 --> 00:18:23.270\n&gt;&gt; Can we add other users to the server?\n\n401\n00:18:23.270 --> 00:18:25.850\n&gt;&gt; Yeah, in fact, that's usually one\nof the first things that I do, right?\n\n402\n00:18:25.850 --> 00:18:27.900\nWe've only got one user right now,\nRoot, and\n\n403\n00:18:27.900 --> 00:18:31.130\nI don't want to give that one user out\nto a bunch of different developers,\n\n404\n00:18:31.130 --> 00:18:33.600\nespecially since the user can\nonly log in locally anyway.\n\n405\n00:18:33.600 --> 00:18:35.710\nI don't want the developers\nlogging in locally to the server.\n\n406\n00:18:35.710 --> 00:18:37.448\nI want them to connect via the network.\n\n407\n00:18:37.448 --> 00:18:40.340\nSo I'm gonna need to create at least\none user account for me, right?\n\n408\n00:18:40.340 --> 00:18:42.980\nBetter yet, user accounts for\nthe developers or other people.\n\n409\n00:18:42.980 --> 00:18:44.520\nSo if we wanna do that,\n\n410\n00:18:44.520 --> 00:18:47.510\nthe first thing we should do is probably\nlook at what users we already have.\n\n411\n00:18:47.510 --> 00:18:50.460\nSo it's stored inside of the system.\n\n412\n00:18:50.460 --> 00:18:53.140\nNow all the user accounts are right\nhere inside of the database, and\n\n413\n00:18:53.140 --> 00:18:56.490\nI can use the SELECT command\nto pull this information.\n\n414\n00:18:56.490 --> 00:18:59.612\nNow I'm gonna say that I\nwanna select certain data.\n\n415\n00:18:59.612 --> 00:19:04.060\nI wanna get the User_Host_ Password.\n\n416\n00:19:04.060 --> 00:19:06.290\nThose are the three most important pieces.\n\n417\n00:19:06.290 --> 00:19:08.670\nWhen you create a user account in MySQL,\nor MariaDB,\n\n418\n00:19:08.670 --> 00:19:11.620\nthere's the username, right,\nwhich is called user.\n\n419\n00:19:11.620 --> 00:19:16.030\nThere's the host, which is what computer\nthey're allowed to connect from, because\n\n420\n00:19:16.030 --> 00:19:19.940\nthey might be local only, or network, or\nnetwork only from certain hosts, right?\n\n421\n00:19:19.940 --> 00:19:21.400\nSo I need to provide that.\n\n422\n00:19:21.400 --> 00:19:22.700\nAnd then lastly is their password.\n\n423\n00:19:22.700 --> 00:19:25.748\nThose are the three identifying pieces\nof information for a user that connects.\n\n424\n00:19:25.748 --> 00:19:29.700\nAnd I'm gonna pull that information\nfrom the control database,\n\n425\n00:19:29.700 --> 00:19:35.170\nMySQL, and inside of that control\ndatabase is a table called user, right?\n\n426\n00:19:35.170 --> 00:19:38.300\nSo I'm gonna reach into that table and\npull that data.\n\n427\n00:19:38.300 --> 00:19:41.080\nAnd I can see that I've only\ngot one user account, and\n\n428\n00:19:41.080 --> 00:19:43.360\nthat user account is called root, right?\n\n429\n00:19:43.360 --> 00:19:45.077\nBut they show up three times, right?\n\n430\n00:19:45.077 --> 00:19:45.980\nWhy three times?\n\n431\n00:19:45.980 --> 00:19:48.220\nCuz they're allowed to\nconnect from three places.\n\n432\n00:19:48.220 --> 00:19:54.540\nFrom the local host hostname,\nthe IPv4 loopback, and the IPv6 loopback.\n\n433\n00:19:54.540 --> 00:19:58.330\nAll three of these are right\nhere from the machine itself.\n\n434\n00:19:58.330 --> 00:20:00.560\nAnd if look at the password,\nit's a hashed password.\n\n435\n00:20:00.560 --> 00:20:01.915\nThat's not what I typed earlier.\n\n436\n00:20:01.915 --> 00:20:03.470\nBut see,\nall the three of them are the same.\n\n437\n00:20:03.470 --> 00:20:04.430\nIt's the same password.\n\n438\n00:20:04.430 --> 00:20:05.690\nIt's same user account.\n\n439\n00:20:05.690 --> 00:20:07.670\nJust three different host\nthey're allowed to connect from.\n\n440\n00:20:07.670 --> 00:20:10.820\nSo you can see one user listed\nmore than once depending on\n\n441\n00:20:10.820 --> 00:20:11.859\nhow it is that they connect, right?\n\n442\n00:20:13.100 --> 00:20:17.300\nNow when I go to add in more users,\nI need to give them a user name.\n\n443\n00:20:17.300 --> 00:20:20.890\nI need to give them a password and I need\nto specify the host they connect from.\n\n444\n00:20:20.890 --> 00:20:23.450\nWhen I do that, I get a choice.\n\n445\n00:20:23.450 --> 00:20:24.800\nI can provide a DNS name.\n\n446\n00:20:25.800 --> 00:20:28.190\nI can provide an IP address.\n\n447\n00:20:28.190 --> 00:20:30.340\nOr I can put a wild card in there.\n\n448\n00:20:30.340 --> 00:20:32.460\nThere's a wild card,\nit's the percent symbol.\n\n449\n00:20:32.460 --> 00:20:35.140\nAnd if I do a percent symbol,\nit means they can connect to any host.\n\n450\n00:20:35.140 --> 00:20:38.030\nAnd so a lot of times, if it's a network\nuser like this, like a developer,\n\n451\n00:20:38.030 --> 00:20:41.130\nyou'll just do the percent sign for the\nhost so they can connect from anywhere.\n\n452\n00:20:41.130 --> 00:20:44.700\nBut it's up to you how you wanna define\nthat, how restrictive you wanna be.\n\n453\n00:20:44.700 --> 00:20:48.790\nBut basically you'll just come in and\nyou'll say, CREATE USER.\n\n454\n00:20:48.790 --> 00:20:50.040\nI'm gonna add a user.\n\n455\n00:20:50.040 --> 00:20:51.100\nI'll create a user for me.\n\n456\n00:20:51.100 --> 00:20:53.270\nSo I'll just do dpezet.\n\n457\n00:20:53.270 --> 00:20:59.240\nRight, and actually because I'm providing\ntext values, I need to put a single quote\n\n458\n00:20:59.240 --> 00:21:04.940\nmark around them, so I'll do dpezet@ and\nthen the host they're gonna connect from.\n\n459\n00:21:04.940 --> 00:21:07.790\nAnd again, I could do a percent sign if\nI wanted it to allow me to connect from\n\n460\n00:21:07.790 --> 00:21:10.110\nanywhere, or I could say, you know what?\n\n461\n00:21:10.110 --> 00:21:11.920\nThis is just localhost.\n\n462\n00:21:11.920 --> 00:21:15.180\nI only want you to be able to connect\nif you're on the local host, right, or\n\n463\n00:21:15.180 --> 00:21:16.250\nwherever it is.\n\n464\n00:21:16.250 --> 00:21:19.430\nAnd I can run this command more than once\nto provide different hosts if I want.\n\n465\n00:21:19.430 --> 00:21:21.670\nIt's up to me to just\nspecify how I want that.\n\n466\n00:21:21.670 --> 00:21:24.130\nRight, so I'm gonna add myself just for\nlocal host.\n\n467\n00:21:24.130 --> 00:21:26.320\nAnd then this is where it\ngets a little bit weird.\n\n468\n00:21:26.320 --> 00:21:28.740\nWe say IDENTIFIED BY.\n\n469\n00:21:29.930 --> 00:21:31.685\nSo how do we identify the user?\n\n470\n00:21:31.685 --> 00:21:33.930\nWell, the password is what\nreally identifies them,\n\n471\n00:21:33.930 --> 00:21:35.630\ntheir name combined with a password.\n\n472\n00:21:35.630 --> 00:21:37.560\nThe name is public,\nthe password is private.\n\n473\n00:21:37.560 --> 00:21:39.710\nAnd so then I need to provide\nwhat that password is.\n\n474\n00:21:39.710 --> 00:21:43.299\nAnd again, I'll use the single quote mark\nand I'll just give myself a password of\n\n475\n00:21:43.299 --> 00:21:46.543\npassword123, cuz I'm employing\nproper security practices today.\n\n476\n00:21:46.543 --> 00:21:49.850\n&gt;&gt; [LAUGH] Strong,\nstrong with the force, yeah.\n\n477\n00:21:49.850 --> 00:21:54.590\n&gt;&gt; All right, so I'm gonna go ahead and\nrun that, and when it's done, I can rerun\n\n478\n00:21:54.590 --> 00:21:59.350\nthe select user command and there I\nsee my entry that dpezet right there.\n\n479\n00:21:59.350 --> 00:22:02.505\nI've got access, and notice how my\npassword is different than the root user?\n\n480\n00:22:02.505 --> 00:22:04.970\nAnd that's well,\ncuz my password's different.\n\n481\n00:22:04.970 --> 00:22:08.000\nBut that's password123,\nit's been hashed, stored right there and\n\n482\n00:22:08.000 --> 00:22:08.800\nnow I've got a user account.\n\n483\n00:22:08.800 --> 00:22:12.083\nAnd I can continue adding more users and\napproving different\n\n484\n00:22:12.083 --> 00:22:15.700\nhosts in setting whatever I want\nthere to give people that access.\n\n485\n00:22:15.700 --> 00:22:21.008\nAgain, if I wanted to allow\nmyself to connect from anywhere,\n\n486\n00:22:21.008 --> 00:22:26.723\nI can just rerun that command and\nI could specify the percent sign,\n\n487\n00:22:26.723 --> 00:22:29.800\nwhoops, inside the single ticks.\n\n488\n00:22:29.800 --> 00:22:32.740\nJust after telling everybody you need the\nsingle ticks, I forget to include them.\n\n489\n00:22:32.740 --> 00:22:34.540\nThere we go and it's now got that percent.\n\n490\n00:22:34.540 --> 00:22:37.870\nSo now I can connect from anywhere,\nlocalHost, or\n\n491\n00:22:37.870 --> 00:22:40.190\nremote, anywhere in the world, right?\n\n492\n00:22:40.190 --> 00:22:42.180\nAnd at first that might sound really bad,\nbut remember,\n\n493\n00:22:42.180 --> 00:22:44.540\nwe can use firewall rules to control this,\ntoo.\n\n494\n00:22:44.540 --> 00:22:47.400\nSo I might only allow connections\nfrom my local network.\n\n495\n00:22:47.400 --> 00:22:49.910\nAnd then the fact that I have a percent\nsign here would really just mean it's any\n\n496\n00:22:49.910 --> 00:22:52.249\nIP on my local network cuz the firewall's\npreventing everything else.\n\n497\n00:22:52.249 --> 00:22:57.173\nSo you use a firewall in combination\nwith this to control where people can\n\n498\n00:22:57.173 --> 00:22:58.150\naccess from.\n\n499\n00:22:58.150 --> 00:23:03.490\nAll right, now that I've got a user,\nthe user is in place, they're created.\n\n500\n00:23:03.490 --> 00:23:05.630\nI could go and\nchange a password if I want.\n\n501\n00:23:05.630 --> 00:23:07.510\nYou have to use the update\ncommand to change a password.\n\n502\n00:23:07.510 --> 00:23:09.055\nSo maybe I want to change\nmy password to password321.\n\n503\n00:23:09.055 --> 00:23:13.430\nI could say update MySQL.user.\n\n504\n00:23:13.430 --> 00:23:14.620\nSo I'm gonna update that table.\n\n505\n00:23:14.620 --> 00:23:17.140\nIt's in the control database.\n\n506\n00:23:17.140 --> 00:23:21.780\nAnd I'll say, SET Password=, and\nwhat I want that new password to be.\n\n507\n00:23:21.780 --> 00:23:24.510\nNow the password needs to\nbe hashed when it's stored.\n\n508\n00:23:24.510 --> 00:23:27.120\nSo I need to use the password command so\n\n509\n00:23:27.120 --> 00:23:29.460\nthat it knows to hash\nthe value that I provide.\n\n510\n00:23:29.460 --> 00:23:30.500\nThis is a little bit strange.\n\n511\n00:23:30.500 --> 00:23:32.810\nBut otherwise it'll put it in\nplain text in the database.\n\n512\n00:23:32.810 --> 00:23:34.868\nIt will work, but\nit's in plain text in the database.\n\n513\n00:23:34.868 --> 00:23:37.340\nSo use that password command\nto make sure it gets hashed.\n\n514\n00:23:37.340 --> 00:23:42.218\nAnd I'll set it to password321 this time,\nsuper secure.\n\n515\n00:23:42.218 --> 00:23:43.353\n&gt;&gt; Yes, it is.\n\n516\n00:23:43.353 --> 00:23:46.320\n&gt;&gt; And then I need to say where.\n\n517\n00:23:46.320 --> 00:23:48.772\nUser=dpezet.\n\n518\n00:23:48.772 --> 00:23:51.850\nIf I don't do that it doesn't know\nwhose password I wanna change.\n\n519\n00:23:51.850 --> 00:23:54.820\nAnd so I'll tell it that and\nwhen I run it,\n\n520\n00:23:54.820 --> 00:23:57.850\nit's gonna go through that database and\nit's gonna find my user account.\n\n521\n00:23:57.850 --> 00:24:02.680\nNow notice, in the message here,\nQuery OK, 2 rows affected.\n\n522\n00:24:02.680 --> 00:24:06.890\nI said anywhere the username equals\ndpezet, and I have two entries.\n\n523\n00:24:06.890 --> 00:24:08.390\nAnd so\nI wanted to change the password in both.\n\n524\n00:24:08.390 --> 00:24:11.120\nThat one command catches both entries.\n\n525\n00:24:11.120 --> 00:24:11.910\nAnd so if I go and\n\n526\n00:24:11.910 --> 00:24:16.440\nlook at that database, now I can see, my\ntwo entries still have the same password.\n\n527\n00:24:16.440 --> 00:24:18.160\nThat's an easy one to miss.\n\n528\n00:24:18.160 --> 00:24:21.580\nIf you don't specify correctly, you might\nchange the password when they're remote\n\n529\n00:24:21.580 --> 00:24:24.069\nbut not when they're local, or vice versa,\nand that can create a lot of confusion.\n\n530\n00:24:25.690 --> 00:24:29.190\nAll right now that that's done,\nthe database has a user,\n\n531\n00:24:29.190 --> 00:24:32.890\nI can start to provide access but this\nwhole thing is not terribly useful until\n\n532\n00:24:32.890 --> 00:24:35.860\nwe really get like some data in there and\nget some information in.\n\n533\n00:24:35.860 --> 00:24:40.760\nSo what we've seen up to this point\nis kinda setting these permissions,\n\n534\n00:24:40.760 --> 00:24:44.280\nwell we haven't really\neven set permissions yet.\n\n535\n00:24:44.280 --> 00:24:47.620\nI've created the user but\nI haven't given the user any access.\n\n536\n00:24:47.620 --> 00:24:50.870\nBut I know I'm running low on time here,\nso I was hoping to get through that but\n\n537\n00:24:50.870 --> 00:24:52.400\nI think what we might wanna do-\n&gt;&gt; Part two?\n\n538\n00:24:52.400 --> 00:24:56.200\n&gt;&gt; Is do a part two,\nbecause having the user is one thing, but\n\n539\n00:24:56.200 --> 00:24:58.660\nif you don't give them permission to\ndo anything, it's kind of useless.\n\n540\n00:24:58.660 --> 00:25:00.360\nSo we need to grant some permissions.\n\n541\n00:25:00.360 --> 00:25:01.807\nI wanna show you guys how to do that and\n\n542\n00:25:01.807 --> 00:25:04.940\nI wanna show you how to take backups of\nthe database and restore the databases cuz\n\n543\n00:25:04.940 --> 00:25:07.400\nthat's another thing we might\nhave to do as a administrator.\n\n544\n00:25:07.400 --> 00:25:09.962\nSo those are all things\nthat we need to tackle, and\n\n545\n00:25:09.962 --> 00:25:12.413\nI think I'm gonna need more time,\nZach [LAUGH].\n\n546\n00:25:12.413 --> 00:25:13.355\n&gt;&gt; And we can give you more time,\nabsolutely.\n\n547\n00:25:13.355 --> 00:25:15.575\nInstalling MariaDB, this is part one.\n\n548\n00:25:15.575 --> 00:25:18.992\nBefore we move on, any last words?\n\n549\n00:25:18.992 --> 00:25:21.880\n&gt;&gt; Main thing, everything we've done right\nhere, so far, is pretty standard, right?\n\n550\n00:25:21.880 --> 00:25:25.200\nSo if you are deploying database servers\nlike this frequently, you're basically\n\n551\n00:25:25.200 --> 00:25:28.440\ngonna take all the command that I've\nbeen showing you and create a playbook.\n\n552\n00:25:28.440 --> 00:25:31.340\nThey says when I deploy a new server,\nhere's the steps that I go through.\n\n553\n00:25:31.340 --> 00:25:33.260\nRight, you're gonna create users accounts,\n\n554\n00:25:33.260 --> 00:25:35.770\nyou're gonna want to change those\npasswords, restrict that access.\n\n555\n00:25:35.770 --> 00:25:37.120\nIt's all very critical.\n\n556\n00:25:37.120 --> 00:25:39.930\nDatabases are big targets for hackers.\n\n557\n00:25:39.930 --> 00:25:40.988\nThey use with the data\nthat's what they want.\n\n558\n00:25:40.988 --> 00:25:44.623\nSo we've gonna make sure to\npractice good security practices,\n\n559\n00:25:44.623 --> 00:25:47.800\neven though they might be\ninconvenient to or whatever.\n\n560\n00:25:47.800 --> 00:25:50.005\nAnd while this might seems\ndeveloper type work,\n\n561\n00:25:50.005 --> 00:25:52.658\nit really falls under the system\nadministrator side now.\n\n562\n00:25:52.658 --> 00:25:55.563\nThat whole DBA world has been\nrolled into the sys admin side.\n\n563\n00:25:55.563 --> 00:25:58.829\nAnd so if you're administering servers\nyou may well be expected to do this and\n\n564\n00:25:58.829 --> 00:26:00.660\nit's a good idea to be familiar with it.\n\n565\n00:26:00.660 --> 00:26:03.788\n&gt;&gt; So installing MariaDB part two,\nwe'll be looking at permissions and so\n\n566\n00:26:03.788 --> 00:26:04.420\nmuch more.\n\n567\n00:26:04.420 --> 00:26:08.010\nAnd speaking of more,\nthere is a whole lot of video content and\n\n568\n00:26:08.010 --> 00:26:10.780\nit becoming a Linux server\nadministrator series,\n\n569\n00:26:10.780 --> 00:26:14.290\nmake sure you watch every single one of\nthem and you'll be very glad that you did.\n\n570\n00:26:14.290 --> 00:26:15.870\nAnd thank you for watching ITProTV.\n\n571\n00:26:15.870 --> 00:26:18.800\nRemember, a good IT pro\nis always learning.\n\n572\n00:26:18.800 --> 00:26:19.810\nI'm Zach Memos.\n\n573\n00:26:19.810 --> 00:26:21.036\n&gt;&gt; And I'm Don Pezet.\n&gt;&gt; And we will see you soon.\n\n574\n00:26:21.036 --> 00:26:28.985\n[MUSIC]\n\n575\n00:26:28.985 --> 00:26:31.938\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "228970766"
        },
        {
          "description": "Don and Zach continue the discussion on using MariaDB, updating user privileges, adding user permissions, removing user permissions, grant full access, lift user access, backup database, and restore database.",
          "length": "1311",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-1-2-installing_mariadb_pt_2-080817-PGM.00_22_45_16.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-1-2-installing_mariadb_pt_2-080817-PGM.00_22_45_16.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-1-2-installing_mariadb_pt_2-080817-PGM.00_22_45_16.Still001-sm.jpg",
          "title": "Installing MariaDB Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.031 --> 00:00:02.778\nWelcome to ITPRO.TV,\nI'm your host, Don Pezet.\n\n2\n00:00:02.778 --> 00:00:06.262\n[CROSSTALK]\n\n3\n00:00:06.262 --> 00:00:08.166\n[MUSIC]\n\n4\n00:00:08.166 --> 00:00:12.271\n&gt;&gt; You're watching ITPRO.TV.\n\n5\n00:00:12.271 --> 00:00:13.456\n&gt;&gt; Hello and thank you for\n\n6\n00:00:13.456 --> 00:00:16.400\nchoosing ITPRO.TV helping\nyou learn wherever you go.\n\n7\n00:00:16.400 --> 00:00:17.565\nI'm you host, Zach Memos,\n\n8\n00:00:17.565 --> 00:00:20.150\nas we continue on with becoming\na Linux Server Administrator.\n\n9\n00:00:20.150 --> 00:00:23.580\nThis is installing MariaDB Part two.\n\n10\n00:00:23.580 --> 00:00:26.990\nI know it sounds ominous, but\nit's gonna be a lot of fun and\n\n11\n00:00:26.990 --> 00:00:29.800\nwe're gonna be looking at all kinds of\nthings like privileges and permissions.\n\n12\n00:00:29.800 --> 00:00:33.620\nAnd Don Pezet is gonna bring us that\ninformation because he's our IT pro.\n\n13\n00:00:33.620 --> 00:00:34.700\nDon, good to see you again.\n\n14\n00:00:34.700 --> 00:00:38.220\n&gt;&gt; Great to be back, if you watched\nthe last episode, I had one of my,\n\n15\n00:00:38.220 --> 00:00:38.720\none of my things.\n\n16\n00:00:38.720 --> 00:00:41.380\nI had this vision, all this stuff in my\nhead I wanted to impart on you guys and\n\n17\n00:00:41.380 --> 00:00:43.760\nI just couldn't do it in 30 minutes.\n\n18\n00:00:43.760 --> 00:00:47.280\nSo we're going on to part two, but just\nto kinda recap what we've done so far for\n\n19\n00:00:47.280 --> 00:00:49.640\nthose of you who might be\nwatching these spread apart.\n\n20\n00:00:49.640 --> 00:00:52.580\nIn the last episode we saw\nhow to install MariaDB,\n\n21\n00:00:52.580 --> 00:00:55.930\nwe got connected to it\nwith the My Eskimo Client.\n\n22\n00:00:55.930 --> 00:00:58.920\nWe created the database,\nwe created a user accounts,\n\n23\n00:00:58.920 --> 00:01:00.850\nwe saw some of that basic operation.\n\n24\n00:01:00.850 --> 00:01:04.684\nBut once that's done,\nwe've gotta take it a step further.\n\n25\n00:01:04.684 --> 00:01:07.504\nThere's a lot more stuff to do\njust as part of our routine\n\n26\n00:01:07.504 --> 00:01:09.252\noperations of a data base server.\n\n27\n00:01:09.252 --> 00:01:11.646\nAnd that's the stuff that we're gonna\nbe taking a look at right here in\n\n28\n00:01:11.646 --> 00:01:12.220\nthis episode.\n\n29\n00:01:12.220 --> 00:01:15.540\n&gt;&gt; That's right and as I was teasing\na second ago privileges and permissions,\n\n30\n00:01:15.540 --> 00:01:18.225\nuser privileges and permissions,\nI think that's where we left off.\n\n31\n00:01:18.225 --> 00:01:20.310\nAnd let's pick it up right there,\nwhat do you think?\n\n32\n00:01:20.310 --> 00:01:22.382\n&gt;&gt; All right, that's a great spot\nbecause at the end of the episode I had\n\n33\n00:01:22.382 --> 00:01:23.793\ncreated a user account,\nI created one for me.\n\n34\n00:01:23.793 --> 00:01:25.305\nRight, so a dpezet user account,\n\n35\n00:01:25.305 --> 00:01:27.505\nwhich I've still got pulled\nup on my screen here.\n\n36\n00:01:27.505 --> 00:01:30.659\nSo we can see where I've got\nthis dpezet user, right here,\n\n37\n00:01:30.659 --> 00:01:33.889\nthat's allowed to log in and\nconnect to the server, great.\n\n38\n00:01:33.889 --> 00:01:35.111\nWhat can they do?\n\n39\n00:01:35.111 --> 00:01:40.070\nNothing, a user can't do anything by\ndefault, so I kinda wasted my time.\n\n40\n00:01:40.070 --> 00:01:44.085\nThe next step after creating a user\nis to assign privileges to them.\n\n41\n00:01:44.085 --> 00:01:48.310\nYou gotta give them access and\nin the SQL world we call that granting.\n\n42\n00:01:48.310 --> 00:01:51.120\nI need to grant them privileges or\npermissions,\n\n43\n00:01:51.120 --> 00:01:53.560\naccess to a certain set of resources.\n\n44\n00:01:53.560 --> 00:01:57.490\nAnd until I do that they're really\nno different than an anonymous user.\n\n45\n00:01:57.490 --> 00:01:59.180\nAnd right now anonymous\nusers have no access.\n\n46\n00:01:59.180 --> 00:02:01.910\nThat means I have no access,\nso we need to fix that.\n\n47\n00:02:01.910 --> 00:02:04.980\nSo to fix that I need to get in and\n\n48\n00:02:04.980 --> 00:02:07.670\nrun a couple of commands\nto grant these permissions.\n\n49\n00:02:07.670 --> 00:02:12.390\nAnd it is important before I get started,\ncuz I forgot to do it in the last episode.\n\n50\n00:02:12.390 --> 00:02:15.455\nAnytime you mess with a user account,\nor anytime you mess with permissions,\n\n51\n00:02:15.455 --> 00:02:19.940\nit' really important that you tell\nthe server to reload permissions.\n\n52\n00:02:19.940 --> 00:02:24.450\nAnd you do that by\nsaying FLUSH PRIVILEGES.\n\n53\n00:02:24.450 --> 00:02:27.310\nAnd the hardest part about this\ncommand for me is spelling privileges.\n\n54\n00:02:27.310 --> 00:02:29.980\nBut there we go, so\nI'm gonna say FLUSH PRIVILEGES.\n\n55\n00:02:29.980 --> 00:02:31.164\n&gt;&gt; And it's almost counter intuitive,\n\n56\n00:02:31.164 --> 00:02:33.220\nit sounds like you're\ngetting rid of something.\n\n57\n00:02:33.220 --> 00:02:36.240\n&gt;&gt; That's right, yeah, and\ntechnically, I guess you are, right.\n\n58\n00:02:36.240 --> 00:02:38.620\nYou're getting rid of\nthe cached privileges and\n\n59\n00:02:38.620 --> 00:02:40.280\nreloading the ones from disk.\n\n60\n00:02:40.280 --> 00:02:43.702\nAnd that way, now the server\ndefinitely knows about my user account.\n\n61\n00:02:43.702 --> 00:02:46.482\nAnd I'll run that command\nagain here in a few minutes.\n\n62\n00:02:46.482 --> 00:02:50.762\nAny time I change permissions,\nI need to do that to make sure they go and\n\n63\n00:02:50.762 --> 00:02:52.300\ntake action right away.\n\n64\n00:02:52.300 --> 00:02:53.240\n&gt;&gt; Fantastic.\n\n65\n00:02:53.240 --> 00:02:56.239\n&gt;&gt; Yep, Sequel servers, I'm sorry,\n\n66\n00:02:56.239 --> 00:02:58.196\nSQL servers-\n&gt;&gt; That's right.\n\n67\n00:02:58.196 --> 00:03:01.230\n[LAUGH]\n&gt;&gt; SQL servers.\n\n68\n00:03:01.230 --> 00:03:04.102\n&gt;&gt; SQL servers, they cache a lot in\nmemory to optimize performance so\n\n69\n00:03:04.102 --> 00:03:05.034\nthey can run faster.\n\n70\n00:03:05.034 --> 00:03:08.183\nAnd that cache is a double edged sword,\nit makes them run faster but\n\n71\n00:03:08.183 --> 00:03:10.504\nit makes them slow to pick\nup changes sometimes.\n\n72\n00:03:10.504 --> 00:03:12.770\nSo that's what\nFLUSH PRIVILEGES is all about.\n\n73\n00:03:12.770 --> 00:03:13.552\n&gt;&gt; Fabulous.\n\n74\n00:03:13.552 --> 00:03:14.454\n&gt;&gt; All right now,\n\n75\n00:03:14.454 --> 00:03:18.487\nwhen I grant access, what I'm\ngranting access to are SQL commands.\n\n76\n00:03:18.487 --> 00:03:20.556\nAnd there's tons of SQL commands, but\n\n77\n00:03:20.556 --> 00:03:25.140\nthere's three that we normally care\nabout when we're doing permissions.\n\n78\n00:03:25.140 --> 00:03:27.100\nThere's the select command.\n\n79\n00:03:27.100 --> 00:03:31.050\nSelect is how we read data out of\na database, how we read data from a table.\n\n80\n00:03:31.050 --> 00:03:34.890\nThere's the update command,\nthat's how we change data in the table.\n\n81\n00:03:34.890 --> 00:03:39.170\nAnd there's the delete command, that's\nhow we remove data from the table, okay.\n\n82\n00:03:39.170 --> 00:03:43.050\nSo those three things, select,\nupdate, delete, actually,\n\n83\n00:03:43.050 --> 00:03:44.550\nthere's a fourth one, insert.\n\n84\n00:03:44.550 --> 00:03:46.540\nInsert is how we add new records, right.\n\n85\n00:03:46.540 --> 00:03:48.790\n&gt;&gt; Okay.\n&gt;&gt; So update changes an existing record,\n\n86\n00:03:48.790 --> 00:03:49.970\ninsert adds a new one.\n\n87\n00:03:49.970 --> 00:03:53.030\nSo those four,\n[LAUGH] I have to update myself here.\n\n88\n00:03:53.030 --> 00:03:57.590\nSo select, insert, update, delete, those\nare the four permissions that we normally\n\n89\n00:03:57.590 --> 00:04:00.050\nhave to hand out for people in control.\n\n90\n00:04:00.050 --> 00:04:06.430\nAnd so what you do is you say GRANT and\nthen permissions you want to give out.\n\n91\n00:04:06.430 --> 00:04:10.180\nSo I might say SELECT and UPDATE, right.\n\n92\n00:04:10.180 --> 00:04:13.680\nSo I'm gonna give these two permissions or\nI could add INSERT and DELETE.\n\n93\n00:04:13.680 --> 00:04:15.910\nWhatever it is that I wanna grant out.\n\n94\n00:04:15.910 --> 00:04:22.990\nSo I'll do select and update and I'm\ngonna grant that ON the Company database.\n\n95\n00:04:22.990 --> 00:04:25.450\nThat's the database that I\nadded in the last episode.\n\n96\n00:04:25.450 --> 00:04:28.060\nSo I'm gonna grant this\npermissions on the database.\n\n97\n00:04:28.060 --> 00:04:31.230\nAnd now what you normally do is\nyou follow it with a period and\n\n98\n00:04:31.230 --> 00:04:33.960\nthe name of the table you're\ngiving somebody access to.\n\n99\n00:04:33.960 --> 00:04:35.712\nInside of a database you\ngot multiple tables.\n\n100\n00:04:35.712 --> 00:04:38.990\nWell, you might only have one, but\nyou'll have at least one table.\n\n101\n00:04:38.990 --> 00:04:42.922\nAnd I might be giving somebody select\nan update just on a single table.\n\n102\n00:04:42.922 --> 00:04:46.501\nSo maybe I got a table called employees,\nand so I might specify that here,\n\n103\n00:04:46.501 --> 00:04:47.672\nCompany.Employees.\n\n104\n00:04:47.672 --> 00:04:51.472\nThat's the database followed by the table,\nor\n\n105\n00:04:51.472 --> 00:04:56.898\nI could say Company.* and\nthat would be all of the tables, right.\n\n106\n00:04:56.898 --> 00:05:01.650\nI want my user account to be able\nto read all of these tables.\n\n107\n00:05:01.650 --> 00:05:03.660\nAnd update them, go in and change records.\n\n108\n00:05:03.660 --> 00:05:06.940\nNot insert, I can't add new records and\nI can't delete records,\n\n109\n00:05:06.940 --> 00:05:09.670\nbut I can read and I can update.\n\n110\n00:05:09.670 --> 00:05:12.400\nSo I can grant that on all those tables.\n\n111\n00:05:12.400 --> 00:05:15.700\nAnd then I say To, and\nI specify who I'm granting access to.\n\n112\n00:05:15.700 --> 00:05:18.840\nAnd in my case,\nit's my user account up top.\n\n113\n00:05:18.840 --> 00:05:24.831\nI need to say dpezet @ and\nthen which host it is that I'm tied to.\n\n114\n00:05:24.831 --> 00:05:29.262\nNow I left my localhost entry inn but this\n% one is a wild card that's catching for\n\n115\n00:05:29.262 --> 00:05:29.925\nanywhere.\n\n116\n00:05:29.925 --> 00:05:32.890\nSo if I do that % one,\nthat'll take care of that.\n\n117\n00:05:32.890 --> 00:05:37.100\nI should really get rid of this localhost\none I don't really need it anymore.\n\n118\n00:05:37.100 --> 00:05:40.890\nBut either way I can grant that or\nmaybe I just want these permissions for\n\n119\n00:05:40.890 --> 00:05:42.900\nwhen I'm on the localhost.\n\n120\n00:05:42.900 --> 00:05:45.740\nAnd maybe I want different permissions\nwhen I'm coming in over the network.\n\n121\n00:05:45.740 --> 00:05:48.350\nMaybe over the network,\nI can only do select.\n\n122\n00:05:48.350 --> 00:05:51.820\nBut when I'm on the server itself I can\ndo updates and deletes and inserts.\n\n123\n00:05:51.820 --> 00:05:54.570\nThat's a great way to prevent network\nattacks if you're allowing remote\n\n124\n00:05:54.570 --> 00:05:56.360\nconnections to your server.\n\n125\n00:05:56.360 --> 00:05:59.720\nSo we can specify those permissions and\nwe can grant them out.\n\n126\n00:05:59.720 --> 00:06:03.640\nSo I've just granted the ability\nto do select an update on\n\n127\n00:06:03.640 --> 00:06:07.350\nevery table in the company database\nto my user account, all right.\n\n128\n00:06:07.350 --> 00:06:09.660\nBut it doesn't take effect right away.\n\n129\n00:06:09.660 --> 00:06:12.540\nI need to FLUSH PRIVILEGES and\n\n130\n00:06:12.540 --> 00:06:16.490\nnow that's gonna take effect and\nnow I've got access to be able to do that.\n\n131\n00:06:16.490 --> 00:06:19.380\nI can now reach in and\nstart to work with that data.\n\n132\n00:06:19.380 --> 00:06:23.427\nNow just because I grant data or access\none way doesn't mean I need it to stay\n\n133\n00:06:23.427 --> 00:06:25.752\nthat way I might need\nto change it later on.\n\n134\n00:06:25.752 --> 00:06:30.323\nI can always grant new permissions, I can\nsay grant delete and add that to myself.\n\n135\n00:06:30.323 --> 00:06:34.892\nAnd it would add onto the list ,and so\nnow I'd have select, update and\n\n136\n00:06:34.892 --> 00:06:38.190\ndelete as I go in and\nincrease my privileges.\n\n137\n00:06:38.190 --> 00:06:40.930\nI can go in and\nI can change my privileges.\n\n138\n00:06:40.930 --> 00:06:47.060\nMaybe I want to leave select, but I wanna\ntake away the ability to update, right.\n\n139\n00:06:47.060 --> 00:06:51.160\nWell there, instead of granting,\nyou're doing what's called revoking.\n\n140\n00:06:51.160 --> 00:06:54.760\nYou're taking away, right, so\nI can revoke a permission the same way.\n\n141\n00:06:54.760 --> 00:06:59.510\nNow before I do that,\nlet me show you the SHOW GRANTS command.\n\n142\n00:06:59.510 --> 00:07:02.540\nSHOW GRANTS has really handy to see\nwhat permissions somebody all ready has.\n\n143\n00:07:02.540 --> 00:07:03.520\nCuz once you run these commands,\n\n144\n00:07:03.520 --> 00:07:07.580\nit's kinda hard to see like what\ndid I give that account access to?\n\n145\n00:07:07.580 --> 00:07:12.150\nSo you can say SHOW GRANTS FOR,\nand then you can specify a user.\n\n146\n00:07:12.150 --> 00:07:16.010\nAnd so I'll say SHOW GRANTS FOR\ndpezet @ localhost.\n\n147\n00:07:16.010 --> 00:07:17.890\nAnd remember those single quote marks,\nright.\n\n148\n00:07:17.890 --> 00:07:19.950\nIt gets kinda finicky about those.\n\n149\n00:07:19.950 --> 00:07:23.540\n&gt;&gt; So if I do SHOW GRANTS it's,\noops, I forgot my semi colon, too.\n\n150\n00:07:23.540 --> 00:07:25.460\nIt's gonna go through and\nshow me what I've got.\n\n151\n00:07:25.460 --> 00:07:30.357\nAnd I can see that I've got SELECT and\nUPDATE ON Company, right.\n\n152\n00:07:30.357 --> 00:07:34.418\nI've also got GRANT USAGE, which is\nwhat's allowing me to log in, right.\n\n153\n00:07:34.418 --> 00:07:36.140\nSee that's where my\npassword is identified.\n\n154\n00:07:36.140 --> 00:07:39.090\nThat's what we were pulling\nfrom the user table.\n\n155\n00:07:39.090 --> 00:07:41.766\nBut as far as the company name is I\ncan see exactly what access I have.\n\n156\n00:07:41.766 --> 00:07:46.971\nAnd if I wanna take away\nthe update privilege,\n\n157\n00:07:46.971 --> 00:07:52.820\nI can come in and\nI can say REVOKE UPDATE ON Company.\n\n158\n00:07:52.820 --> 00:07:56.093\nStar or the specific table,\nmaybe I'm trying to be really particular.\n\n159\n00:07:56.093 --> 00:08:02.862\nFrom, and\nthen I'll do D Pezet at local host.\n\n160\n00:08:02.862 --> 00:08:06.940\nAll right, so I'm gonna take away\nthose privileges, all right.\n\n161\n00:08:06.940 --> 00:08:10.768\nNow that I have run that,\nif I do the show grants, and\n\n162\n00:08:10.768 --> 00:08:14.080\nI pull it back up,\nsee how I just have select?\n\n163\n00:08:14.080 --> 00:08:15.310\nThe updates go on.\n\n164\n00:08:15.310 --> 00:08:19.220\nOkay, but be careful, cuz when I ran this\ncommand, when I ran the show grants,\n\n165\n00:08:19.220 --> 00:08:22.610\nit was querying the table,\nnot necessarily what's cached in memory.\n\n166\n00:08:22.610 --> 00:08:25.003\nSo even though it's updated here,\n\n167\n00:08:25.003 --> 00:08:29.722\nit might not actually be in practice\nuntil I do that flush privileges.\n\n168\n00:08:29.722 --> 00:08:33.090\nGet used to that command, you'll wanna\nrun that anytime you modify privileges.\n\n169\n00:08:33.090 --> 00:08:34.290\nYou'll wanna make sure you do that.\n\n170\n00:08:34.290 --> 00:08:36.610\nAnd that way you've\ndefinitely got the latest and\n\n171\n00:08:36.610 --> 00:08:38.730\ngreatest privileges in use on your system.\n\n172\n00:08:38.730 --> 00:08:41.570\nBut here we've added\npermissions to a user.\n\n173\n00:08:41.570 --> 00:08:44.901\nWe've taken away permissions to a user,\nand we can modify those and\n\n174\n00:08:44.901 --> 00:08:46.601\nget really specific if we want to.\n\n175\n00:08:46.601 --> 00:08:48.590\nAnd it's all stored right\nhere in the database.\n\n176\n00:08:48.590 --> 00:08:50.140\nThat's another step\nthat you'll wanna take.\n\n177\n00:08:50.140 --> 00:08:51.200\nAny time you add a user,\n\n178\n00:08:51.200 --> 00:08:54.169\nyour very next step is going to be\nassigning them the permissions.\n\n179\n00:08:54.169 --> 00:08:59.487\nAnd you only want to give them access\nto what they need, to the bare minimum.\n\n180\n00:08:59.487 --> 00:09:04.296\nNow, maybe you've got a DBA, somebody\nwho's a database administrator, and\n\n181\n00:09:04.296 --> 00:09:06.705\nthey say, hey, I need a user account.\n\n182\n00:09:06.705 --> 00:09:09.160\nOr, let's create a generic\none called admin.\n\n183\n00:09:09.160 --> 00:09:10.690\nAnd I wanna have access to everything.\n\n184\n00:09:10.690 --> 00:09:12.520\nI wanna fully administer the server.\n\n185\n00:09:12.520 --> 00:09:15.020\nSo, we could come in and\nwe could create that user account, right?\n\n186\n00:09:15.020 --> 00:09:19.872\nI could say create user, and\nI'll create a user call admin, @,\n\n187\n00:09:19.872 --> 00:09:23.240\nand I'll specify that % wild card, right?\n\n188\n00:09:23.240 --> 00:09:25.450\nSo they can come from anywhere.\n\n189\n00:09:25.450 --> 00:09:30.440\nI'll say, identified by, and then I'll\ntell them that it's identified by\n\n190\n00:09:30.440 --> 00:09:32.470\na password and\nwhatever I want that password to be.\n\n191\n00:09:32.470 --> 00:09:33.767\nI'll do password123.\n\n192\n00:09:33.767 --> 00:09:35.630\nOkay, so I create the user.\n\n193\n00:09:36.720 --> 00:09:43.977\nAnd then I could say,\nGRANT ALL ON Company.*.\n\n194\n00:09:43.977 --> 00:09:47.068\nRight, so I'm giving them every command.\n\n195\n00:09:47.068 --> 00:09:50.620\nInsert, update, delete, I don't know,\nwhatever other ones I left out,\n\n196\n00:09:50.620 --> 00:09:52.297\nselect [LAUGH] all those other ones!\n\n197\n00:09:52.297 --> 00:09:54.824\nI'll be giving them all of\nthe different commands, and\n\n198\n00:09:54.824 --> 00:09:58.267\nthere's like 12 different commands\nthat are just for working with data,\n\n199\n00:09:58.267 --> 00:10:00.715\nnot even counting all\nthe administrative commands.\n\n200\n00:10:00.715 --> 00:10:03.180\nSo I'm giving them all of those commands.\n\n201\n00:10:03.180 --> 00:10:10.426\nOn Company.* and\nthen I need to say TO admin @ % and\n\n202\n00:10:10.426 --> 00:10:17.196\nso now that user will have\naccess to everything.\n\n203\n00:10:17.196 --> 00:10:21.876\nAnd if I do the SHOW GRANTS FOR,\nand I'll just pull up for\n\n204\n00:10:21.876 --> 00:10:26.270\nthat account and\ntake a look at what that looks like.\n\n205\n00:10:27.330 --> 00:10:30.920\nAnd now I can see it's got grant\nall privileges, right there.\n\n206\n00:10:30.920 --> 00:10:35.129\nThat user now has access to any command\nwhen they're working inside of the company\n\n207\n00:10:35.129 --> 00:10:36.470\ndatabase, right?\n\n208\n00:10:36.470 --> 00:10:40.710\nIf they switch to a different database,\nI didn't give those privileges, right?\n\n209\n00:10:40.710 --> 00:10:43.860\nSo I would have to go and\ndo this on a database by database level.\n\n210\n00:10:43.860 --> 00:10:48.340\nRight now, if I do a SHOW DATABASES,\nI've only got, well,\n\n211\n00:10:48.340 --> 00:10:49.860\nCompany is what I'm\nworking with right now.\n\n212\n00:10:49.860 --> 00:10:52.210\nAnd then there's the test database for\nexample, so\n\n213\n00:10:52.210 --> 00:10:54.750\nI would have to grant them\npermission there, as well.\n\n214\n00:10:54.750 --> 00:10:58.050\nAnd you can do wildcards on the databases\ntoo, but it's not usually a good idea.\n\n215\n00:10:58.050 --> 00:11:00.288\nTypically databases\nare managed individually and so\n\n216\n00:11:00.288 --> 00:11:02.434\nwe've got to manage\nthe permissions that way too.\n\n217\n00:11:02.434 --> 00:11:06.000\nBut once this is done I can go in and\njust flush my privileges.\n\n218\n00:11:06.000 --> 00:11:09.462\nAnd now that admin user has all\naccess to that particular database.\n\n219\n00:11:09.462 --> 00:11:13.410\n&gt;&gt; So Don, how can we back up and\nrestore a database?\n\n220\n00:11:13.410 --> 00:11:15.026\n&gt;&gt; You know, real important, right?\n\n221\n00:11:15.026 --> 00:11:17.189\nAs a system administrator, backing up and\n\n222\n00:11:17.189 --> 00:11:21.050\nrestoring data is probably the most\nimportant job that you have.\n\n223\n00:11:21.050 --> 00:11:23.454\nAnd even if you don't know\na single thing about SQL and\n\n224\n00:11:23.454 --> 00:11:26.447\nyou don't know how to run queries and\ninteract with the database,\n\n225\n00:11:26.447 --> 00:11:28.919\neven if you have a DBA who's\nmanaging all that for you.\n\n226\n00:11:28.919 --> 00:11:33.780\nThey typically still expect you to be\nbacking this up and restoring it, okay?\n\n227\n00:11:33.780 --> 00:11:38.363\nFortunately, you don't have to know a lot\nof SQL to get in there and do the backups.\n\n228\n00:11:38.363 --> 00:11:40.303\nTo restore it helps,\nbut on the backup side,\n\n229\n00:11:40.303 --> 00:11:42.900\nit's pretty easy cuz there's\na utility we can use.\n\n230\n00:11:42.900 --> 00:11:44.480\nI'm gonna get out of this client.\n\n231\n00:11:44.480 --> 00:11:48.420\nSo this whole time I've been in\nthe MySQL SQL client, right?\n\n232\n00:11:48.420 --> 00:11:52.190\nThere's another utility that's\ninstalled when you install MySQL or\n\n233\n00:11:52.190 --> 00:11:56.470\nMariaDB, and it's the MySQL dump command.\n\n234\n00:11:56.470 --> 00:12:00.440\nRight, and that dump command\nlets you export a database.\n\n235\n00:12:00.440 --> 00:12:05.530\nI can back up one or more or even all\nof my databases by using MySQL dump.\n\n236\n00:12:05.530 --> 00:12:08.190\nIt's a very simple command we can run,\nyou do need a user account,\n\n237\n00:12:08.190 --> 00:12:09.550\nyou need privileges.\n\n238\n00:12:09.550 --> 00:12:13.490\nAnd assuming you've got them,\nyou can then export all that data and\n\n239\n00:12:13.490 --> 00:12:14.970\ndump it into a simple file.\n\n240\n00:12:14.970 --> 00:12:18.740\nSo for example, if I wanna backup that\ncompany database, I could come in and\n\n241\n00:12:18.740 --> 00:12:23.860\nI could say mysql dump and then -u and\nthe user I'm gonna login as,\n\n242\n00:12:23.860 --> 00:12:27.170\nI'll use that root user account\nbecause it has access to everything.\n\n243\n00:12:28.370 --> 00:12:29.370\nSo I'll do root.\n\n244\n00:12:29.370 --> 00:12:33.870\nAnd then I need to tell it -p to prompt me\nfor the password so that I can provide it.\n\n245\n00:12:33.870 --> 00:12:37.190\nAnd I follow that up by\na list of databases.\n\n246\n00:12:37.190 --> 00:12:41.680\nAnd you can do one database, if I just\nwanna get company, or I can do commas, or\n\n247\n00:12:41.680 --> 00:12:44.870\nactually it's not even commas, just\nspaces, and specify each other database.\n\n248\n00:12:44.870 --> 00:12:47.920\nSo I can do test, and\nthe other ones if I wanted.\n\n249\n00:12:47.920 --> 00:12:49.800\nI'm just gonna back up company.\n\n250\n00:12:49.800 --> 00:12:53.890\nAll right, and what it actually does,\nif I were to just run it like this,\n\n251\n00:12:53.890 --> 00:12:56.780\nit outputs it to the screen which\nis not what we want, right?\n\n252\n00:12:56.780 --> 00:13:01.810\nSo we can redirect that output and\ndump it into a file.\n\n253\n00:13:01.810 --> 00:13:06.698\nSo I'm gonna dump it right into my own\nhome folder and I'll call it company.sql.\n\n254\n00:13:06.698 --> 00:13:10.070\nOkay, that's gonna take that database and\ndump it to a file.\n\n255\n00:13:10.070 --> 00:13:14.650\nNow, depending on the size of\nthe database, this could take seconds.\n\n256\n00:13:14.650 --> 00:13:19.440\nMine's empty, so\nit will happen almost instantaneously.\n\n257\n00:13:19.440 --> 00:13:20.800\nSo there we go.\n\n258\n00:13:20.800 --> 00:13:21.920\nIt's done.\n\n259\n00:13:21.920 --> 00:13:26.192\nBut if you've got a database that's a\nterabyte in size, this could take a while.\n\n260\n00:13:26.192 --> 00:13:28.460\nAnd it also depends on where\nyou're sending it to, right?\n\n261\n00:13:28.460 --> 00:13:32.580\nCuz you could even send it to an SSH host,\nuse like a secure copy and\n\n262\n00:13:32.580 --> 00:13:35.770\nthen shoot it right over the network and\nit could take 30 minutes, an hour,\n\n263\n00:13:35.770 --> 00:13:37.480\nit could take a long time, right?\n\n264\n00:13:37.480 --> 00:13:40.810\nBut if it's a small database,\ndatabases are typically text and so\n\n265\n00:13:40.810 --> 00:13:42.150\nthey backup pretty fast.\n\n266\n00:13:42.150 --> 00:13:45.120\nBut if you're storing binary data\nin the database, it can be huge.\n\n267\n00:13:45.120 --> 00:13:47.820\nOr if you just have a really,\nreally large database.\n\n268\n00:13:47.820 --> 00:13:50.121\nMaybe you're sequencing the human genome.\n\n269\n00:13:50.121 --> 00:13:51.596\n[LAUGH]\n&gt;&gt; Yeah, I've done that every day\n\n270\n00:13:51.596 --> 00:13:52.148\n&gt;&gt; You got to do\n\n271\n00:13:52.148 --> 00:13:53.724\nsomething with your spare time.\n\n272\n00:13:53.724 --> 00:13:54.471\n&gt;&gt; Yeah, a little hobby.\n\n273\n00:13:54.471 --> 00:13:57.771\n&gt;&gt; And so\nthat can take a while to back up, right.\n\n274\n00:13:57.771 --> 00:14:01.774\nBut when its done, you've got a file,\nand if I look in my home folder here,\n\n275\n00:14:01.774 --> 00:14:06.810\nI've now got this file called company.sql,\nthat's what I just backed up, right.\n\n276\n00:14:06.810 --> 00:14:11.280\nAnd if I look at it, it's just a text\nfile, and it's actually kind of a neat\n\n277\n00:14:11.280 --> 00:14:17.970\nfile because what its got is information\nhere dumped and then it's got\n\n278\n00:14:17.970 --> 00:14:23.750\nall of the SQL commands that it would take\nTo recreate your database from scratch.\n\n279\n00:14:23.750 --> 00:14:27.686\nI could take this server to any\nMySQL server in the world or\n\n280\n00:14:27.686 --> 00:14:32.372\nany MariaDB server in the world and\nI could run this SQL script on it?\n\n281\n00:14:32.372 --> 00:14:36.912\nAnd it would rebuild my database with all\nthe data, all the permissions, everything\n\n282\n00:14:36.912 --> 00:14:41.500\nthat was in that database would be brought\nright back into it right here, okay?\n\n283\n00:14:41.500 --> 00:14:44.270\nNow, my database is empty, so\nwe don't see all that much in here.\n\n284\n00:14:44.270 --> 00:14:47.541\nWe'll get some data in it in the next\nepisode, and actually see that.\n\n285\n00:14:47.541 --> 00:14:49.561\nBut this file right here\nis everything that I need.\n\n286\n00:14:49.561 --> 00:14:52.180\nNow, one word of caution.\n\n287\n00:14:52.180 --> 00:14:53.690\nThe file can get kind of big.\n\n288\n00:14:53.690 --> 00:14:55.840\nIt's, well, typically,\nthe size of your database, right?\n\n289\n00:14:55.840 --> 00:14:57.610\n&gt;&gt; Right.\n&gt;&gt; So it can be large.\n\n290\n00:14:57.610 --> 00:15:00.570\nBut database files like this\ntypically compress pretty well.\n\n291\n00:15:00.570 --> 00:15:05.160\nSo a lot of times when I do a MySQL dump\nlike this, I'm gonna dump out that file.\n\n292\n00:15:05.160 --> 00:15:07.210\nInstead of just dumping\nit straight to a file,\n\n293\n00:15:07.210 --> 00:15:09.990\na lot of times I'll feed it through gzip.\n\n294\n00:15:09.990 --> 00:15:13.501\nSo I'll take it, remember, this first\ncommand is outputting to screen.\n\n295\n00:15:13.501 --> 00:15:19.570\nAnd so I'll feed that through gzip and\nif you do -c, it tells us to compress it.\n\n296\n00:15:19.570 --> 00:15:23.020\nAnd then I'll send it\nto a file like that and\n\n297\n00:15:23.020 --> 00:15:27.630\nby doing that it's gonna take the backup,\ndump it to a file,\n\n298\n00:15:27.630 --> 00:15:32.060\ncompress it, and\nstore it on the disk as a gzip file.\n\n299\n00:15:32.060 --> 00:15:36.265\nAnd when I run it that way, that will\nmake it take up a lot less space.\n\n300\n00:15:36.265 --> 00:15:38.430\nOops, wrong password,\nlet's try that again.\n\n301\n00:15:39.470 --> 00:15:45.600\nThere we go, and if I take a look at\nit here, well, my database is empty.\n\n302\n00:15:45.600 --> 00:15:47.730\nSo these are really,\nreally small files, anyway.\n\n303\n00:15:47.730 --> 00:15:51.670\nBut it was 1.2 K in size and\nnow it's only 441 K in size.\n\n304\n00:15:51.670 --> 00:15:52.974\nSo it's a third of the size.\n\n305\n00:15:52.974 --> 00:15:54.259\nEither one was really small, anyway.\n\n306\n00:15:54.259 --> 00:15:57.906\nThe only negative of this Is\nwhen I wanna do a restore,\n\n307\n00:15:57.906 --> 00:16:02.100\nI've gotta decompress it first\nbefore I can restore it.\n\n308\n00:16:02.100 --> 00:16:04.280\nBut otherwise,\nit takes a lot less space on disk.\n\n309\n00:16:04.280 --> 00:16:08.051\nAnd that's really handy, cuz you might be\nwanting to store more than one day, right.\n\n310\n00:16:08.051 --> 00:16:12.416\nYou might wanna store backups every hour,\nor once a day, once a week, whatever.\n\n311\n00:16:12.416 --> 00:16:15.551\nAnd so you don't wanna consume a huge\namount of disk space with backups that\n\n312\n00:16:15.551 --> 00:16:17.870\nyou're rarely gonna go to, right.\n\n313\n00:16:17.870 --> 00:16:23.320\nBut when it comes time to go to them, you\ncan unzip that file and then restore it.\n\n314\n00:16:23.320 --> 00:16:25.760\nOr if you've already got\nit decompressed like this,\n\n315\n00:16:25.760 --> 00:16:29.140\nthen you can restore it back and\nget the database back in place.\n\n316\n00:16:29.140 --> 00:16:31.870\nNow, the script as it's written\n\n317\n00:16:31.870 --> 00:16:34.800\nactually starts by deleting\nthe database that's already there.\n\n318\n00:16:34.800 --> 00:16:36.640\nSo if you still have\nthe database it'll delete it.\n\n319\n00:16:36.640 --> 00:16:38.370\nIf you don't, then it doesn't do anything.\n\n320\n00:16:38.370 --> 00:16:41.290\nAnd then it rebuilds\nthe database from that script,\n\n321\n00:16:41.290 --> 00:16:43.860\nputting everything back\nthe way that it was.\n\n322\n00:16:43.860 --> 00:16:46.020\nAnd getting the database fully restored.\n\n323\n00:16:46.020 --> 00:16:48.740\nAnd if you wanna see that,\nwell, first of all,\n\n324\n00:16:48.740 --> 00:16:52.426\nlet's just assume that I only\nhave the compressed one, right?\n\n325\n00:16:52.426 --> 00:16:54.370\nLet me get rid of that there.\n\n326\n00:16:54.370 --> 00:16:56.010\nRight, so\nI've only got the compressed one.\n\n327\n00:16:56.010 --> 00:16:58.361\nSo I'm gonna come in here and just say,\n\n328\n00:16:58.361 --> 00:17:01.297\ngzip-d to decompress\nthat company.sql file.\n\n329\n00:17:01.297 --> 00:17:03.850\nAll right, so I'll decompress it.\n\n330\n00:17:03.850 --> 00:17:11.148\nAnd now I've got company.sql again,\nand from here, I can fire up MySQL.\n\n331\n00:17:11.148 --> 00:17:17.400\nThat's the MySQL client, not MySQL dump,\ndump just exports, it doesn't import.\n\n332\n00:17:17.400 --> 00:17:21.675\nSo I'm gonna say MySQL-u root,\nI wanna be that root user,\n\n333\n00:17:21.675 --> 00:17:23.820\n-p to prompt for a password.\n\n334\n00:17:23.820 --> 00:17:28.570\nAnd normally, I would just run this,\nit would take me into the database, right.\n\n335\n00:17:28.570 --> 00:17:32.965\nBut what I wanna do is I wanna\nconnect to the company database,\n\n336\n00:17:32.965 --> 00:17:34.581\nso I'll tell it that.\n\n337\n00:17:34.581 --> 00:17:39.694\nAnd then I wanna tell it to restore,\nand so I'm going to feed\n\n338\n00:17:39.694 --> 00:17:45.640\nin that backup that I did that\nwas called company.sql, right?\n\n339\n00:17:45.640 --> 00:17:49.540\nAnd so it's gonna read that file and\nrun it, and in that file\n\n340\n00:17:49.540 --> 00:17:54.157\nare all the commands that I need to\nexecute and get this data restored.\n\n341\n00:17:54.157 --> 00:17:57.615\nNow, I already have the company database,\nthat's why I'm specifying it here.\n\n342\n00:17:57.615 --> 00:17:59.535\nIf I didn't,\nI would just leave that out, and\n\n343\n00:17:59.535 --> 00:18:01.915\nit will recreate the company database for\nme.\n\n344\n00:18:01.915 --> 00:18:06.044\nSo this was an all new server, I could\njust leave that part out, log in and\n\n345\n00:18:06.044 --> 00:18:09.039\nthen it will feed the contents\nof that file in there.\n\n346\n00:18:09.039 --> 00:18:12.763\nBut if I've already got it I can\nconnect right to it and run that.\n\n347\n00:18:12.763 --> 00:18:16.225\nAnd that's gonna restore the database and\nget put back,\n\n348\n00:18:16.225 --> 00:18:18.790\nand now all that data is brought back in.\n\n349\n00:18:18.790 --> 00:18:21.970\nThe database is up and\nrunning, and users can go.\n\n350\n00:18:21.970 --> 00:18:25.987\nOn the backup, MySQL dump can be\nrun while users are in the system.\n\n351\n00:18:25.987 --> 00:18:27.290\nIt can be done online, right?\n\n352\n00:18:27.290 --> 00:18:29.040\nUsers are in there,\nthey're working, that's great.\n\n353\n00:18:29.040 --> 00:18:30.220\nYou do the dump.\n\n354\n00:18:30.220 --> 00:18:31.973\nThere might be an IO hit, right?\n\n355\n00:18:31.973 --> 00:18:34.423\nYou're doing a lot of disk access\nwhen you dump that database, and\n\n356\n00:18:34.423 --> 00:18:36.145\nthe larger that is,\nthe longer that happens.\n\n357\n00:18:36.145 --> 00:18:37.695\nSo you do get a performance hit.\n\n358\n00:18:37.695 --> 00:18:41.335\nBut otherwise, users can continue\nto work like normal, right?\n\n359\n00:18:41.335 --> 00:18:43.555\nThe restore,\na little bit different, right?\n\n360\n00:18:43.555 --> 00:18:46.230\nCuz the database is getting killed and\nrestored.\n\n361\n00:18:46.230 --> 00:18:47.680\nUsers need to be out of the system.\n\n362\n00:18:47.680 --> 00:18:49.669\nIf they're in there,\nthey're just gonna get kicked out, and\n\n363\n00:18:49.669 --> 00:18:50.950\nthat means you can get data loss.\n\n364\n00:18:50.950 --> 00:18:52.760\nSo be careful with that.\n\n365\n00:18:52.760 --> 00:18:54.580\nYou might wanna restore\nit to a different name.\n\n366\n00:18:54.580 --> 00:18:58.110\nAnd if you wanna restore it to a different\nname, you can just modify that SQL file.\n\n367\n00:18:58.110 --> 00:19:01.718\nThat's the text bar you can edit it and\nchange the database name and then they'll\n\n368\n00:19:01.718 --> 00:19:05.009\nrestore all the data to a different\ndatabase and then you can pick and chose\n\n369\n00:19:05.009 --> 00:19:08.600\nthe information out of it that you want,\nto restore it to your production line.\n\n370\n00:19:08.600 --> 00:19:11.509\nSo you don't have to take users offline,\nthat's kind of up to you.\n\n371\n00:19:11.509 --> 00:19:15.230\nThis first step is having\nthe backup in the first place.\n\n372\n00:19:15.230 --> 00:19:17.760\nSo if you're standing up MySQL servers,\n\n373\n00:19:17.760 --> 00:19:20.235\nyou need to be using\nMySQLdump to back that up, or\n\n374\n00:19:20.235 --> 00:19:25.780\na third party backup solutions out there\nthat all work well, they just cost money.\n\n375\n00:19:25.780 --> 00:19:28.220\nMySQLdump is free,\nit's built in, it's easy, and\n\n376\n00:19:28.220 --> 00:19:31.800\nif you combine it with SSH,\nyou can do encrypted network backups.\n\n377\n00:19:31.800 --> 00:19:33.570\nYou an dump them to any location.\n\n378\n00:19:33.570 --> 00:19:36.760\nYou can write a simple script to\nstick the date in the filename, so\n\n379\n00:19:36.760 --> 00:19:39.690\nnow you can kinda maintain\nmultiple days' worth of backups.\n\n380\n00:19:39.690 --> 00:19:41.470\nThen it's pretty easy to get going.\n\n381\n00:19:41.470 --> 00:19:45.540\nIf you don't do it, though,\ndatabases are really important.\n\n382\n00:19:45.540 --> 00:19:49.110\nAnd the moment something goes wrong in\nthat database goes off line, it's gonna\n\n383\n00:19:49.110 --> 00:19:52.160\nbe, we have a couple of names for it, but-\n&gt;&gt; [LAUGH]\n\n384\n00:19:52.160 --> 00:19:53.620\n&gt;&gt; It's what I like to call a-\n\n385\n00:19:53.620 --> 00:19:55.020\n&gt;&gt; Can you say them here?\n\n386\n00:19:55.020 --> 00:19:56.780\n&gt;&gt; Career changing event.\n\n387\n00:19:56.780 --> 00:19:58.200\n&gt;&gt; Okay.\n&gt;&gt; [LAUGH] That you wanna\n\n388\n00:19:58.200 --> 00:19:59.660\nmake sure you to the back up.\n\n389\n00:19:59.660 --> 00:20:00.360\nIt's so easy to do.\n\n390\n00:20:00.360 --> 00:20:01.780\nThere's really no reason not to have it.\n\n391\n00:20:01.780 --> 00:20:05.680\nSo definitely something they\nwanted to put some time into.\n\n392\n00:20:05.680 --> 00:20:06.970\nLet's see, did I miss anything on that?\n\n393\n00:20:06.970 --> 00:20:09.330\nI think it was pretty-\n&gt;&gt; Pretty comprehensive.\n\n394\n00:20:09.330 --> 00:20:09.960\n&gt;&gt; Pretty good there.\n\n395\n00:20:09.960 --> 00:20:13.330\nThere's obviously a lot more,\ndatabases are really complex.\n\n396\n00:20:13.330 --> 00:20:17.500\nNow you might have noticed in part one and\npart two we did a lot of stuff here\n\n397\n00:20:17.500 --> 00:20:20.720\nwith standing the server up and creating\nthe database and creating user accounts.\n\n398\n00:20:20.720 --> 00:20:23.310\nFor most sysadmins,\nthat's all you have to do.\n\n399\n00:20:23.310 --> 00:20:25.500\nThat's the extent of your job Frank.\n\n400\n00:20:25.500 --> 00:20:29.680\nBut what if the developers\nare coming to you with the data?\n\n401\n00:20:29.680 --> 00:20:32.030\nAnd like hey we need you to put\nthis data in the data base right.\n\n402\n00:20:32.030 --> 00:20:34.210\nThat doesn't happen to most sysadmins but\nit does happen to some.\n\n403\n00:20:34.210 --> 00:20:37.680\nSo what I wanna do is I've covered\neverything I wanna cover for\n\n404\n00:20:37.680 --> 00:20:40.330\njust basic like standing\nup a database server.\n\n405\n00:20:40.330 --> 00:20:42.570\nBut we're gonna do another episode,\nnot a part three.\n\n406\n00:20:42.570 --> 00:20:46.610\nBut this is just a separate episode on\nworking with the data inside of MariaDB.\n\n407\n00:20:46.610 --> 00:20:47.730\nSo stay tuned for that one.\n\n408\n00:20:47.730 --> 00:20:48.240\nI'm just gonna come up.\n\n409\n00:20:48.240 --> 00:20:50.760\nI'll show you how to load data in there,\nhow to query against it.\n\n410\n00:20:50.760 --> 00:20:55.130\nHow to do some basic SQL queries, it's not\nrequired knowledge for most sys admins,\n\n411\n00:20:55.130 --> 00:20:56.020\nbut I recommend you do it.\n\n412\n00:20:56.020 --> 00:20:58.680\nIt's a good idea to know how to\nwork with these databases so\n\n413\n00:20:58.680 --> 00:21:01.460\nthat you can kinda get a handle\non how they work, what they do.\n\n414\n00:21:01.460 --> 00:21:03.810\nAnd learn a little bit\nmore about that system.\n\n415\n00:21:03.810 --> 00:21:05.010\nI recommend everybody does that.\n\n416\n00:21:05.010 --> 00:21:07.410\nAnd it's a lot of fun, so\ndefinitely stay tuned for that.\n\n417\n00:21:07.410 --> 00:21:08.890\nBut as far as getting\na database server up,\n\n418\n00:21:08.890 --> 00:21:11.770\nI think we've seen\neverything we need here and.\n\n419\n00:21:11.770 --> 00:21:15.010\nHopefully you guys have nice, stable\ndatabases that are running like crazy.\n\n420\n00:21:15.010 --> 00:21:17.480\n&gt;&gt; Awesome information,\ngreat presentation as usual, Don.\n\n421\n00:21:17.480 --> 00:21:18.780\nThank you so very much.\n\n422\n00:21:18.780 --> 00:21:20.750\nInstalling MariaDB Part Two.\n\n423\n00:21:20.750 --> 00:21:23.010\nThere is a Part One,\nmake sure you watch both parts.\n\n424\n00:21:23.010 --> 00:21:27.350\nAnd there's a lot of video content inside\nof Becoming a Linux Server Administrator.\n\n425\n00:21:27.350 --> 00:21:30.380\nMake sure you watch every single video,\nyou'll be so glad that you did,\n\n426\n00:21:30.380 --> 00:21:32.410\nand thank you for watching ITProTV.\n\n427\n00:21:32.410 --> 00:21:35.360\nRemember, a good IT pro\nis always learning.\n\n428\n00:21:35.360 --> 00:21:36.340\nI'm Zach Memos.\n\n429\n00:21:36.340 --> 00:21:37.110\n&gt;&gt; And I'm Don Pezet.\n\n430\n00:21:37.110 --> 00:21:42.243\n&gt;&gt; And we will see you very soon.\n\n431\n00:21:42.243 --> 00:21:45.827\n[MUSIC]\n\n432\n00:21:45.827 --> 00:21:48.570\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "228970529"
        },
        {
          "description": "\"Don and Zach explain commands available when working with database data, creating a table, creating a database, enforcing 'uniqueness,' getting data into the table, and importing bulk data from CSV file.\"",
          "length": "2047",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-2-1-working_with_data-080917.00_33_52_21.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-2-1-working_with_data-080917.00_33_52_21.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-2-1-working_with_data-080917.00_33_52_21.Still001-sm.jpg",
          "title": "Working with Data",
          "transcript": "WEBVTT\n\n1\n00:00:00.320 --> 00:00:02.694\nWelcome to ITProTV,\nI'm your host, Don Pezet.\n\n2\n00:00:02.694 --> 00:00:06.457\n[CROSSTALK]\n\n3\n00:00:06.457 --> 00:00:08.199\n[MUSIC]\n\n4\n00:00:08.199 --> 00:00:11.973\n&gt;&gt; You're watching ITProTV.\n\n5\n00:00:11.973 --> 00:00:14.674\n&gt;&gt; Hello and thank you for\nchoosing ITProTV,\n\n6\n00:00:14.674 --> 00:00:16.932\nhelping you learn wherever you go.\n\n7\n00:00:16.932 --> 00:00:21.992\nI'm Zach Memos, as we continue on with\nbecoming a Linux server administrator.\n\n8\n00:00:21.992 --> 00:00:24.925\nAnd in this episode,\nwe're gonna be working with data, and\n\n9\n00:00:24.925 --> 00:00:26.950\nwho's gonna be showing us how to do that?\n\n10\n00:00:26.950 --> 00:00:28.190\nWell, Don Pezet.\n\n11\n00:00:28.190 --> 00:00:30.210\nHe's our IT pro, Don, good to see you.\n\n12\n00:00:30.210 --> 00:00:31.380\n&gt;&gt; Thanks for having me back, Zach.\n\n13\n00:00:31.380 --> 00:00:34.711\nAnd in the last episode or\nlast couple of episodes,\n\n14\n00:00:34.711 --> 00:00:37.349\nwe took a look at how to install MariaDB.\n\n15\n00:00:37.349 --> 00:00:40.431\nAnd really for that matter MySQL,\nright, cuz they've done the same.\n\n16\n00:00:40.431 --> 00:00:42.976\nAnd we stood a server up,\nwe got it up and running,\n\n17\n00:00:42.976 --> 00:00:46.799\nwe cleared it through the firewall,\nwe did all this basic configuration,\n\n18\n00:00:46.799 --> 00:00:49.488\nwhich are the typical\nsystem administrator tasks.\n\n19\n00:00:49.488 --> 00:00:53.028\nSo what's normally be expected of\nyou as a Linux server admin but,\n\n20\n00:00:53.028 --> 00:00:57.140\nI wanted to go a little bit further,\na little bit probably beyond what a normal\n\n21\n00:00:57.140 --> 00:01:01.650\nserver admin would have to do, because in\ntoday's world things are different now.\n\n22\n00:01:01.650 --> 00:01:04.953\nServer admins aren't strictly\nsystems admins like they used to.\n\n23\n00:01:04.953 --> 00:01:08.435\nNow, you might be expected to do a little\nbit of what in the past might be\n\n24\n00:01:08.435 --> 00:01:10.300\nconsidered developer work.\n\n25\n00:01:10.300 --> 00:01:12.810\nAnd so in this episode,\nI wanna take a moment and\n\n26\n00:01:12.810 --> 00:01:14.670\njust kinda go off the beaten path and\nshow you,\n\n27\n00:01:14.670 --> 00:01:17.720\nguys, not just how to stand up a database,\nwhich we've already done.\n\n28\n00:01:17.720 --> 00:01:21.170\nBut how to get the data into there and\nhow to work with some of that data.\n\n29\n00:01:21.170 --> 00:01:24.376\nNow, if this is not something that\nyou think you'll ever have to do,\n\n30\n00:01:24.376 --> 00:01:27.547\nthen you're not gonna hurt my feelings,\nyou can skip the episode.\n\n31\n00:01:27.547 --> 00:01:28.427\n&gt;&gt; [LAUGH]\n&gt;&gt; But,\n\n32\n00:01:28.427 --> 00:01:29.936\nI think you'll really benefit from it.\n\n33\n00:01:29.936 --> 00:01:31.600\n&gt;&gt; Right.\n&gt;&gt; Because in real life,\n\n34\n00:01:31.600 --> 00:01:37.270\nthe line between developer and operations\nis really boring, the whole DevOps thing.\n\n35\n00:01:37.270 --> 00:01:40.511\nAnd so this is a technology that\na lot of us need to work with more.\n\n36\n00:01:40.511 --> 00:01:43.990\nAnd databases are becoming more and\nmore critical to businesses.\n\n37\n00:01:43.990 --> 00:01:45.260\nSo I think it is important to learn.\n\n38\n00:01:45.260 --> 00:01:47.180\nSo we're just gonna take a look at\nthat right here in this episode and\n\n39\n00:01:47.180 --> 00:01:49.460\nget a chance to see how\nto work with that data.\n\n40\n00:01:49.460 --> 00:01:54.100\n&gt;&gt; So Don, what commands are available\nwhen you're working with database data?\n\n41\n00:01:54.100 --> 00:01:58.310\n&gt;&gt; All right, so when we're communicating\nwith a relational database we're using\n\n42\n00:01:58.310 --> 00:01:59.140\nSQL, right.\n\n43\n00:01:59.140 --> 00:02:02.234\nSQL, the structured query language,\nand with SQL you got\n\n44\n00:02:02.234 --> 00:02:06.103\na standard set of commands, a collection\nof commands you can issue out.\n\n45\n00:02:06.103 --> 00:02:10.511\nAnd they're really neat because they work\non anybody who follows the SQL standards.\n\n46\n00:02:10.511 --> 00:02:18.000\nSo they work on MariaDB, MySQL they work\non Oracle, they work on Microsoft SQL.\n\n47\n00:02:18.000 --> 00:02:21.722\nAll these different database platforms\nout there, use the same commands.\n\n48\n00:02:21.722 --> 00:02:25.236\nAnd we've kind of seen some of them,\nalready, like the create command,\n\n49\n00:02:25.236 --> 00:02:27.090\nthat I used to create a database.\n\n50\n00:02:27.090 --> 00:02:29.942\nBut, there's a ton of other ones,\nthat I wanna show you guys.\n\n51\n00:02:29.942 --> 00:02:33.750\nThere's the select command which lets\nus read data out of the database.\n\n52\n00:02:33.750 --> 00:02:35.990\nHow do you verify the data's\nactually there and readable?\n\n53\n00:02:35.990 --> 00:02:38.640\nYou use the select command to do it,\nthat's how we verify.\n\n54\n00:02:38.640 --> 00:02:39.630\nHow do you add data?\n\n55\n00:02:39.630 --> 00:02:44.000\nYou use the insert command, insert\nlets you add new data to the database.\n\n56\n00:02:44.000 --> 00:02:47.962\nThere's a update command which lets you\nchange data that's in the database,\n\n57\n00:02:47.962 --> 00:02:50.073\nand don't feverishly write these down.\n\n58\n00:02:50.073 --> 00:02:52.380\nI'm gonna show you examples of\nall these as the show goes on.\n\n59\n00:02:52.380 --> 00:02:54.103\n&gt;&gt; There'll be some production\nnotes too I'm sure.\n\n60\n00:02:54.103 --> 00:02:56.908\n&gt;&gt; Absolutely and they'll all be\nin the show notes as well, but\n\n61\n00:02:56.908 --> 00:02:59.060\nwe're gonna kinda run\nthrough each of those.\n\n62\n00:02:59.060 --> 00:03:01.870\nThere's the delete command for\ntaking things out, and\n\n63\n00:03:01.870 --> 00:03:03.520\nthen a lot of the commands have modifiers.\n\n64\n00:03:03.520 --> 00:03:07.495\nSo like the select command when I say I'm\ngonna read data We followed up with a from\n\n65\n00:03:07.495 --> 00:03:10.008\ncommand to say where we're\ngetting the data from,\n\n66\n00:03:10.008 --> 00:03:12.183\nor the where command, just like criteria.\n\n67\n00:03:12.183 --> 00:03:14.291\nI might not want every row of a table,\n\n68\n00:03:14.291 --> 00:03:17.691\nI might just want certain rows\nthat meet certain criteria.\n\n69\n00:03:17.691 --> 00:03:21.890\nAnd then you can always organize your data\nwith things like order buy and group buy.\n\n70\n00:03:21.890 --> 00:03:25.124\nThose are commands that let us change\nthe way the data's being presented.\n\n71\n00:03:25.124 --> 00:03:28.668\nThese are all part of SQL and\nif you have a basic understand of them,\n\n72\n00:03:28.668 --> 00:03:31.960\nit'll really help you with\nverifying if a server is working,\n\n73\n00:03:31.960 --> 00:03:34.140\nwhether the data actually accessible.\n\n74\n00:03:34.140 --> 00:03:39.350\nBecause just being able to ping\na database server is not enough right?\n\n75\n00:03:39.350 --> 00:03:43.950\nA database server might be online but\nnot accepting queries\n\n76\n00:03:43.950 --> 00:03:47.940\nit might be responding poorly and we don't\nknow that unless we actually do a query.\n\n77\n00:03:47.940 --> 00:03:51.510\nSo we're gonna take a look at that SQL\nthat structured query language and\n\n78\n00:03:51.510 --> 00:03:54.669\nsee how to use it to\ninteract with that system.\n\n79\n00:03:54.669 --> 00:03:56.965\n&gt;&gt; So Don I'm pretty exited about all\nthis can we start using these commands\n\n80\n00:03:56.965 --> 00:03:58.555\nright away?\n\n81\n00:03:58.555 --> 00:04:02.595\n&gt;&gt; Some of them yes, most of them are all\nbuilt around working with a table,\n\n82\n00:04:02.595 --> 00:04:06.165\nand in the last two episodes we\nnever actually created a table,\n\n83\n00:04:06.165 --> 00:04:07.465\nat least I don't remember creating one.\n\n84\n00:04:07.465 --> 00:04:09.127\nSo we created a database, and\n\n85\n00:04:09.127 --> 00:04:13.594\nwhen you create a database there's not\nall that much you can do with a database.\n\n86\n00:04:13.594 --> 00:04:16.390\nYou've really gotta have\nthe data put into it.\n\n87\n00:04:16.390 --> 00:04:22.344\nAnd most of us don't necessarily think\nof a database as what it really is,\n\n88\n00:04:22.344 --> 00:04:24.850\nwhich is a container, right?\n\n89\n00:04:24.850 --> 00:04:27.760\n&gt;&gt; Right.\n&gt;&gt; Think of a database as backpack.\n\n90\n00:04:27.760 --> 00:04:30.990\nIf I get a backpack,\na brand new one from the store,\n\n91\n00:04:30.990 --> 00:04:34.530\nit's not really useful while it's empty,\nright?\n\n92\n00:04:34.530 --> 00:04:37.760\nI have this potential to store data,\nbut otherwise it's useless.\n\n93\n00:04:37.760 --> 00:04:40.704\nBut once I start putting books in there,\nnow it's useful to me,\n\n94\n00:04:40.704 --> 00:04:44.191\nnow it makes it easier to carry those\nbooks and I get them when I need them, and\n\n95\n00:04:44.191 --> 00:04:46.173\nnow I've got the information in my hands.\n\n96\n00:04:46.173 --> 00:04:49.169\nSo really, if we want to truly\nstart working with the database,\n\n97\n00:04:49.169 --> 00:04:51.835\nwe've got to get some data in there first.\n\n98\n00:04:51.835 --> 00:04:54.972\nNow before I show you this,\nas we get in creating things,\n\n99\n00:04:54.972 --> 00:04:58.882\nI wanna make sure everybody's got a good\nunderstanding of how a database works.\n\n100\n00:04:58.882 --> 00:05:03.682\nI've fired up LibreOffice Calc, here,\nwhich is just a spreadsheet program.\n\n101\n00:05:03.682 --> 00:05:08.032\nSpreadsheets are actually really,\nreally simple databases.\n\n102\n00:05:08.032 --> 00:05:09.594\nAnd with a spreadsheet,\n\n103\n00:05:09.594 --> 00:05:12.631\nwhen we When we look at it we\nnormally see a table like this.\n\n104\n00:05:12.631 --> 00:05:15.094\nAnd you've got rows and\nyou've got columns.\n\n105\n00:05:15.094 --> 00:05:17.816\nAnd each row is an independent entity, and\n\n106\n00:05:17.816 --> 00:05:20.923\neach column is a characteristic\nof that entity.\n\n107\n00:05:20.923 --> 00:05:25.331\nSo when I lay in data into a database\nthis is kind of what it looks like.\n\n108\n00:05:25.331 --> 00:05:28.349\nBut the functionality a lot of people\ndon't take advantage of is down here at\n\n109\n00:05:28.349 --> 00:05:30.534\nthe bottom where we can have\nmore than one sheet right?\n\n110\n00:05:30.534 --> 00:05:32.380\nSheet one, sheet two, sheet three.\n\n111\n00:05:32.380 --> 00:05:34.740\nEach of these are really separate tables.\n\n112\n00:05:34.740 --> 00:05:39.160\nSo, the spreadsheet, itself,\nis like the database.\n\n113\n00:05:39.160 --> 00:05:43.320\nAnd each sheet inside of it,\nis like a table.\n\n114\n00:05:43.320 --> 00:05:45.620\nAnd so, when we build a database,\nwe start putting data into it,\n\n115\n00:05:45.620 --> 00:05:46.530\nthat's what we're doing.\n\n116\n00:05:46.530 --> 00:05:50.830\nMy first table, let's say we're gonna\ncreate a corporate directory, right?\n\n117\n00:05:50.830 --> 00:05:52.900\nSo, I want a directory\nof all of my employees.\n\n118\n00:05:52.900 --> 00:05:56.522\nSo I might have a table called employees.\n\n119\n00:05:56.522 --> 00:05:59.460\nAnd what's some of the information\nI might want about an employee?\n\n120\n00:05:59.460 --> 00:06:03.960\nI might want first name and last name.\n\n121\n00:06:03.960 --> 00:06:06.930\nI might want the department\nthat they work in, right?\n\n122\n00:06:06.930 --> 00:06:09.942\nThat's all information I\nmight want about an employee.\n\n123\n00:06:09.942 --> 00:06:11.740\nWell, what about the department?\n\n124\n00:06:11.740 --> 00:06:13.550\nThere might be information I want\nto know about the department.\n\n125\n00:06:13.550 --> 00:06:17.513\nSo I might create another\ntable called Departments.\n\n126\n00:06:17.513 --> 00:06:20.460\nAnd for department well departments\nis gonna to have a name.\n\n127\n00:06:20.460 --> 00:06:23.900\nIt probably has a manager, right whoever\nthe manager is for that department.\n\n128\n00:06:23.900 --> 00:06:26.170\nThat's information I wanna\ntrack on the department.\n\n129\n00:06:26.170 --> 00:06:31.620\nSo now I've got these two different tables\nwith two different types of data stored in\n\n130\n00:06:31.620 --> 00:06:35.180\nthem and once I get these populated I can\nstart querying and pulling the data right.\n\n131\n00:06:35.180 --> 00:06:38.570\nWell, in a spreadsheet you're pretty\nlimited with that ability to query,\n\n132\n00:06:38.570 --> 00:06:39.830\nin a database you're not.\n\n133\n00:06:39.830 --> 00:06:41.300\nYou can do all sorts of things.\n\n134\n00:06:41.300 --> 00:06:45.060\nAnd then a spreadsheet can only get so\nbig before performance starts dying down.\n\n135\n00:06:45.060 --> 00:06:47.984\nAnd a spreadsheet's really designed for\njust one person to use it.\n\n136\n00:06:47.984 --> 00:06:51.790\nA database server can store\nmillions upon millions of rows and\n\n137\n00:06:51.790 --> 00:06:53.702\nstill have high performance.\n\n138\n00:06:53.702 --> 00:06:56.461\nAnd it can have thousands of users in\nthere working with the database all at\n\n139\n00:06:56.461 --> 00:06:58.430\nthe same time, and\nstill have a great performance.\n\n140\n00:06:58.430 --> 00:07:01.916\nSo all of that is stuff that we need to\nbe thinking about when we work with these\n\n141\n00:07:01.916 --> 00:07:02.902\ndatabases, right?\n\n142\n00:07:02.902 --> 00:07:05.489\nSo going back to Zach's question,\nI'm doing a super-long answer for\n\n143\n00:07:05.489 --> 00:07:06.534\nwhat was a simple question.\n\n144\n00:07:06.534 --> 00:07:08.236\n&gt;&gt; It's okay, I like long answers.\n\n145\n00:07:08.236 --> 00:07:12.564\n&gt;&gt; Which is, when I create a database and\nI create a table, and\n\n146\n00:07:12.564 --> 00:07:17.688\nI load some data in it, then I can\nreally start working with that data.\n\n147\n00:07:17.688 --> 00:07:19.601\nSo, let's kinda get to that point, and\n\n148\n00:07:19.601 --> 00:07:23.410\nthen we'll actually be able to\nsee all of this stuff in action.\n\n149\n00:07:23.410 --> 00:07:26.060\n&gt;&gt; Okay, so\nhow do we create a database and a table?\n\n150\n00:07:26.060 --> 00:07:29.250\n&gt;&gt; All right so, I showed you guys\ncreating a database in the last episode.\n\n151\n00:07:29.250 --> 00:07:31.490\nBut, let's do it again here,\njust to remember.\n\n152\n00:07:31.490 --> 00:07:35.322\nI'm gonna use the MySQL client and\nI'm just gonna use the root user.\n\n153\n00:07:35.322 --> 00:07:36.798\nAgain, if you've set up a user accounts,\n\n154\n00:07:36.798 --> 00:07:38.848\nyou wanna make sure you use\nthe appropriate user account but\n\n155\n00:07:38.848 --> 00:07:40.620\nI'll use the user from mine.\n\n156\n00:07:40.620 --> 00:07:45.610\nAnd I'm gonna get connected to that\nserver, and once I'm in there,\n\n157\n00:07:45.610 --> 00:07:49.950\nI can do a show databases, right, and\nthat'll show me the databases that I have.\n\n158\n00:07:49.950 --> 00:07:51.471\nAnd I've got an information schema and\na performance schema.\n\n159\n00:07:51.471 --> 00:07:57.028\nThose are, Kind of metadata for the server\nitself for performance information.\n\n160\n00:07:57.028 --> 00:08:00.442\nMySQL is the control database,\nthat's the one that's actually running it.\n\n161\n00:08:00.442 --> 00:08:01.876\nI'm running MariaDB, but\n\n162\n00:08:01.876 --> 00:08:05.741\nagain we're going to see MySQL throughout\nall of this because is there for\n\n163\n00:08:05.741 --> 00:08:10.130\nbackwards compatibility and\ncompatibility with the other platform.\n\n164\n00:08:10.130 --> 00:08:12.240\nAnd in the test database which\nwe really never did get rid of,\n\n165\n00:08:12.240 --> 00:08:13.660\nI should probably get rid of that one.\n\n166\n00:08:13.660 --> 00:08:18.170\nI'll do a drop database test and\nI get rid of that one.\n\n167\n00:08:18.170 --> 00:08:20.920\nSo now I don't have a test\ndatabase anymore, right?\n\n168\n00:08:20.920 --> 00:08:23.740\nThat example right there\nis one of the first\n\n169\n00:08:23.740 --> 00:08:25.538\nSQL commands that I'm really using here.\n\n170\n00:08:25.538 --> 00:08:26.800\nUnlike the show command and\n\n171\n00:08:26.800 --> 00:08:30.850\nthe drop command, these are commands\nthat are used at the global level.\n\n172\n00:08:30.850 --> 00:08:35.060\nThese are part of a data definition\nlanguage that lets us define\n\n173\n00:08:35.060 --> 00:08:38.220\nhow we're going to be\nstructuring our database.\n\n174\n00:08:38.220 --> 00:08:41.270\nThose are not the commands we normally\nwork with when working with data.\n\n175\n00:08:41.270 --> 00:08:44.540\nI'm not truly working with data here,\nI'm working with a database.\n\n176\n00:08:44.540 --> 00:08:48.985\nAnd so I'm going to create a database and\nI'm just going to call it company, right?\n\n177\n00:08:48.985 --> 00:08:51.320\nBecause this is gonna be my\ncompany's database, right?\n\n178\n00:08:51.320 --> 00:08:52.150\n&gt;&gt; Sounds good.\n\n179\n00:08:52.150 --> 00:08:55.650\n&gt;&gt; So I'll go ahead and get that created,\nI'm just going to create database and\n\n180\n00:08:55.650 --> 00:08:56.570\nthen the name of the database.\n\n181\n00:08:56.570 --> 00:08:59.410\nAnd I'll do a semicolon afterwards\nto let it know the command is over.\n\n182\n00:08:59.410 --> 00:09:01.320\nAnd so now I've got that database,\n\n183\n00:09:01.320 --> 00:09:05.520\nand I'm pretty sure that's as far\nas I went in the last episode.\n\n184\n00:09:05.520 --> 00:09:10.400\nBut, if we want to start getting data in\nhere, notice how it says right here, none.\n\n185\n00:09:10.400 --> 00:09:12.830\nThat means I'm not actually\nconnected to a database right now,\n\n186\n00:09:12.830 --> 00:09:14.560\nI'm connected to the server.\n\n187\n00:09:14.560 --> 00:09:18.336\nTechnically, I'm connected to\nthe mysql control database, right?\n\n188\n00:09:18.336 --> 00:09:22.410\nSo I'm going to come in here and\ntell it use company, and\n\n189\n00:09:22.410 --> 00:09:24.560\nby doing that see how my prompt changes?\n\n190\n00:09:24.560 --> 00:09:26.610\nAnd instead of none now it says company.\n\n191\n00:09:26.610 --> 00:09:31.980\nSo now the SQL commands that I issue\nare being issued against that database.\n\n192\n00:09:31.980 --> 00:09:33.960\nAnd so now I can start working in here.\n\n193\n00:09:33.960 --> 00:09:38.590\nBut if I'm gonna work in here,\nI'm going to need at least one table,\n\n194\n00:09:38.590 --> 00:09:39.780\na table to load data.\n\n195\n00:09:39.780 --> 00:09:43.980\nSo as an example let's do,\n\n196\n00:09:43.980 --> 00:09:46.190\nlet's do the department's table\nI mentioned a moment ago.\n\n197\n00:09:46.190 --> 00:09:48.330\nI want a table for all of my departments.\n\n198\n00:09:48.330 --> 00:09:51.750\nAnd I want to store some basic\ninformation about those departments and\n\n199\n00:09:51.750 --> 00:09:53.760\nget it kind of placed in here.\n\n200\n00:09:53.760 --> 00:09:59.880\nSo, what I can do is I can\nissue a show tables command.\n\n201\n00:09:59.880 --> 00:10:02.090\nShow me the tables that\nare in this database.\n\n202\n00:10:02.090 --> 00:10:03.760\nWell, I just made this so its empty.\n\n203\n00:10:03.760 --> 00:10:05.580\nThere's no tables to see.\n\n204\n00:10:05.580 --> 00:10:07.060\nSo I need to create one.\n\n205\n00:10:07.060 --> 00:10:10.950\nSo I'll come in and\njust say, create table, and\n\n206\n00:10:10.950 --> 00:10:12.630\nthen I need to give it\nthe information now.\n\n207\n00:10:12.630 --> 00:10:14.180\nThink back to that spreadsheet.\n\n208\n00:10:14.180 --> 00:10:17.290\nWhen I had the spreadsheet open,\nthere were columns.\n\n209\n00:10:17.290 --> 00:10:21.430\nAnd I said one column was going to be\na name, and one might be a manager,\n\n210\n00:10:21.430 --> 00:10:22.670\nand so on.\n\n211\n00:10:22.670 --> 00:10:28.020\nThat is part of what defines a table,\nwhat columns it has.\n\n212\n00:10:28.020 --> 00:10:32.090\nSo when I create a table, I need to give\nthe table a name, it's got to have a name,\n\n213\n00:10:32.090 --> 00:10:34.980\nand then I've got to give\nit at least one column.\n\n214\n00:10:34.980 --> 00:10:38.060\nAnd you'll normally have more than one\ncolumn in a table based on whatever it is\n\n215\n00:10:38.060 --> 00:10:39.080\nyou're going to store.\n\n216\n00:10:39.080 --> 00:10:41.820\nNow I'm going to create\na table called departments.\n\n217\n00:10:43.240 --> 00:10:45.870\nAlright, if I were to stop right here\nit is not going to be very happy\n\n218\n00:10:45.870 --> 00:10:48.400\nbecause it does not have\nat least one column.\n\n219\n00:10:48.400 --> 00:10:52.600\nSo I need at least one column, I am going\nto say create table departments and then I\n\n220\n00:10:52.600 --> 00:10:57.860\nwill open a parenthesis and from here I\ncan provide each of the columns I want.\n\n221\n00:10:57.860 --> 00:10:59.490\nNow I know I want a column called name.\n\n222\n00:10:59.490 --> 00:11:04.120\nI need department name, but\nwhen we work with databases, we need a way\n\n223\n00:11:04.120 --> 00:11:09.370\nto find these records and you almost\nalways do it based on an identifier.\n\n224\n00:11:09.370 --> 00:11:11.600\nEvery row needs an identifier.\n\n225\n00:11:11.600 --> 00:11:14.540\nRemember in the spreadsheet on the left\nside of the screen, there were numbers,\n\n226\n00:11:14.540 --> 00:11:16.190\none, two, three, four, five, six.\n\n227\n00:11:16.190 --> 00:11:20.620\nI could pull row number six or row number\nthree, the row number identifies it.\n\n228\n00:11:20.620 --> 00:11:23.190\nWell, we can do the same thing in SQL.\n\n229\n00:11:23.190 --> 00:11:24.350\nWe just have to tell it to do it.\n\n230\n00:11:24.350 --> 00:11:25.810\nIt doesn't do it automatically.\n\n231\n00:11:25.810 --> 00:11:30.340\nRows don't have a number,\nrows have a GUID, a Global Unique ID.\n\n232\n00:11:30.340 --> 00:11:31.340\nAnd you don't want to use those,\n\n233\n00:11:31.340 --> 00:11:32.966\nthose are really long--\n&gt;&gt; Mm-hm.\n\n234\n00:11:32.966 --> 00:11:34.688\n&gt;&gt; Letter number combinations.\n\n235\n00:11:34.688 --> 00:11:35.690\n&gt;&gt; Mm-hm.\n&gt;&gt; So\n\n236\n00:11:35.690 --> 00:11:38.930\nI want each department to have an ID.\n\n237\n00:11:38.930 --> 00:11:40.640\nAnd I could manually assign it.\n\n238\n00:11:40.640 --> 00:11:42.740\nI could say this is going to\nbe the department number.\n\n239\n00:11:42.740 --> 00:11:44.730\nAnd this will be department one and\ndepartment two.\n\n240\n00:11:44.730 --> 00:11:47.950\nThe problem is by accident\nyou can make a mistake and\n\n241\n00:11:47.950 --> 00:11:49.840\nhave two departments with the same number.\n\n242\n00:11:49.840 --> 00:11:52.930\nSo a lot of times with a database we're\ntrying to be very careful to do what's\n\n243\n00:11:52.930 --> 00:11:57.890\ncalled enforcing uniqueness, enforcing we\ndon't use the same number twice, right?\n\n244\n00:11:57.890 --> 00:12:02.890\nImagine if you went to Amazon and\nyou signed up for a user account and\n\n245\n00:12:02.890 --> 00:12:05.229\nthey gave you the same user\nID as some other user.\n\n246\n00:12:06.240 --> 00:12:08.850\nNow you're sharing credit card\ninformation, you're sharing orders,\n\n247\n00:12:08.850 --> 00:12:10.500\nthat would be a really bad thing, right?\n\n248\n00:12:10.500 --> 00:12:14.720\nSo we need to enforce uniqueness and\nSQL lets us do that.\n\n249\n00:12:14.720 --> 00:12:16.360\nAnd Maria DB and so on.\n\n250\n00:12:16.360 --> 00:12:19.380\nThere's special options\nwe can apply to a column.\n\n251\n00:12:19.380 --> 00:12:21.130\nNow every column needs two things.\n\n252\n00:12:21.130 --> 00:12:24.280\nIt needs a name and\nit needs what we call a type.\n\n253\n00:12:24.280 --> 00:12:27.400\nThe type is the type of data\nyou're going to store in here.\n\n254\n00:12:27.400 --> 00:12:30.100\nSo like an ID,\nit's usually going to be a number.\n\n255\n00:12:30.100 --> 00:12:31.700\nAnd so\nI can tell it's just going to be a number.\n\n256\n00:12:31.700 --> 00:12:34.390\nI'll say it's an int or an integer, right?\n\n257\n00:12:34.390 --> 00:12:35.490\nIt might be text.\n\n258\n00:12:35.490 --> 00:12:37.370\nIf it's text,\nI would tell that it is character or\n\n259\n00:12:37.370 --> 00:12:40.540\na certain number of characters,\na variable character link or whatever.\n\n260\n00:12:40.540 --> 00:12:43.100\nIn this case, I'm doing\nan integer because it's a number.\n\n261\n00:12:43.100 --> 00:12:45.980\nAnd now,\nI can tell it to enforce that uniqueness.\n\n262\n00:12:45.980 --> 00:12:51.460\nI can say, not null, which means I'm not\ngoing to allow this column to be empty.\n\n263\n00:12:51.460 --> 00:12:54.030\nIf you create a department,\nit has to have an ID.\n\n264\n00:12:54.030 --> 00:12:57.525\nBut, I don't want people to type the ID\nin, because they could screw it up.\n\n265\n00:12:57.525 --> 00:12:58.040\n&gt;&gt; Uh-huh.\n\n266\n00:12:58.040 --> 00:13:02.930\n&gt;&gt; So, I'm going to add another option\nhere, that'll be auto-increment.\n\n267\n00:13:02.930 --> 00:13:05.150\nAnd that just means the first department\nis going to be number one, and\n\n268\n00:13:05.150 --> 00:13:07.310\nthe second department would be number two,\nand then number three.\n\n269\n00:13:07.310 --> 00:13:09.360\nAnd as I add departments\nthey'll each get a number.\n\n270\n00:13:09.360 --> 00:13:13.264\nAnd it'll never duplicate a number,\nwhich is exactly what I want.\n\n271\n00:13:14.853 --> 00:13:18.258\nNow in a database, or in a spreadsheet,\nin a spreadsheet each\n\n272\n00:13:18.258 --> 00:13:22.750\nsheet is really unique in that they're\nnot really tied to each other at all.\n\n273\n00:13:22.750 --> 00:13:27.000\nBut in a database we have what's\ncalled a relational database.\n\n274\n00:13:27.000 --> 00:13:29.900\nEach table can relate to\nother tables it can be some\n\n275\n00:13:29.900 --> 00:13:31.720\nkind of relationship in between them.\n\n276\n00:13:31.720 --> 00:13:35.150\nSo for example in my employees table,\n\n277\n00:13:35.150 --> 00:13:38.020\nI'll track which department\neach employee is in.\n\n278\n00:13:38.020 --> 00:13:40.220\nAnd in my department table\nI'm tracking the departments,\n\n279\n00:13:40.220 --> 00:13:43.040\nthose two are related they're\nboth referring to a department.\n\n280\n00:13:43.040 --> 00:13:45.940\nSo how do we match up the departments?\n\n281\n00:13:45.940 --> 00:13:47.820\nWell, we do it with what's\ncalled a primary key.\n\n282\n00:13:47.820 --> 00:13:52.900\nNow a primary key is some column in\nyour table that's really important,\n\n283\n00:13:52.900 --> 00:13:57.870\nthat uniquely identifies the row and\nallows us to tie it to other tables.\n\n284\n00:13:57.870 --> 00:14:00.120\nI want this ID number\nto be my primary key.\n\n285\n00:14:00.120 --> 00:14:04.100\nSo I'm going to add a little note\nhere that just says primary key.\n\n286\n00:14:05.230 --> 00:14:07.460\nNow that finishes my first column and\n\n287\n00:14:07.460 --> 00:14:11.490\nthat's a pretty complex column\nID that's the name, and\n\n288\n00:14:11.490 --> 00:14:14.775\nthen int, it's an integer it's going\nto be a number that's pretty simple.\n\n289\n00:14:14.775 --> 00:14:19.245\nBut then the non-null means I don't want\nit to be blank, and then auto increment\n\n290\n00:14:19.245 --> 00:14:23.455\nmeans I want it to have a number that's\nunique and it goes up with each row.\n\n291\n00:14:23.455 --> 00:14:27.205\nAnd then, primary key tells it that\nthis thing that relates to other tables.\n\n292\n00:14:27.205 --> 00:14:29.665\nThis is an important identifier, right?\n\n293\n00:14:29.665 --> 00:14:32.655\nBut, I didn't have to go all that complex,\nand in fact, I won't for\n\n294\n00:14:32.655 --> 00:14:34.780\nthe next one, I want a column called name.\n\n295\n00:14:34.780 --> 00:14:37.610\nThis is going to be\nthe name of the department.\n\n296\n00:14:37.610 --> 00:14:40.690\nAnd for this one,\nI just need to identify what type of data.\n\n297\n00:14:40.690 --> 00:14:41.620\nIt's going to be text.\n\n298\n00:14:41.620 --> 00:14:45.410\nThe problem is I don't know\nexactly how much text.\n\n299\n00:14:45.410 --> 00:14:48.790\nWhen you define this,\nif you know exactly how many letters or\n\n300\n00:14:48.790 --> 00:14:55.050\nwhatever it's going to be, you could\nsay something like character 10, right?\n\n301\n00:14:55.050 --> 00:14:57.390\nJust kind of wrapping on me here,\nbut character 10.\n\n302\n00:14:57.390 --> 00:14:59.970\nAnd by doing that, I'm saying that\nI'm going to store text in here,\n\n303\n00:14:59.970 --> 00:15:01.270\nit's going to be 10 characters.\n\n304\n00:15:01.270 --> 00:15:04.720\nNow if I type one character, it's going\nto consume 10 characters worth of space.\n\n305\n00:15:04.720 --> 00:15:07.880\nIt's always going to consume\n10 characters worth of space.\n\n306\n00:15:07.880 --> 00:15:11.520\nSo that's not the most efficient if\nyou've got a large amount of data.\n\n307\n00:15:11.520 --> 00:15:12.440\nWe've got a small amount of data.\n\n308\n00:15:12.440 --> 00:15:13.570\nIt probably doesn't matter.\n\n309\n00:15:13.570 --> 00:15:17.090\nBut I might also have some departments\nwith really long names and\n\n310\n00:15:17.090 --> 00:15:18.770\nsome departments with really short names.\n\n311\n00:15:18.770 --> 00:15:22.756\nSo normally what you'll see is people make\nuse of what's called a variable character.\n\n312\n00:15:22.756 --> 00:15:27.245\nSo I'm going to say varchar,\nit's variable character and\n\n313\n00:15:27.245 --> 00:15:30.040\nI'm going to create that up to 50.\n\n314\n00:15:30.040 --> 00:15:33.390\nSo a department can have up\nto 50 letters in the name.\n\n315\n00:15:33.390 --> 00:15:34.750\nBut we can have one letter in the name.\n\n316\n00:15:34.750 --> 00:15:38.770\nAnd the space will vary based\non how long that name is, right?\n\n317\n00:15:38.770 --> 00:15:41.650\nNow it sounds like you want to always\ndo that, which is not the case.\n\n318\n00:15:41.650 --> 00:15:43.430\nAnd there's performance concerns here.\n\n319\n00:15:43.430 --> 00:15:46.420\nYou can have fragmentation on the disk\nbecause of these variable links,\n\n320\n00:15:46.420 --> 00:15:48.800\nwhen you do a fixed link it\nhelps to avoid fragmentation.\n\n321\n00:15:48.800 --> 00:15:51.440\nSo that gets a little beyond the scope\nof what this show's going to cover.\n\n322\n00:15:51.440 --> 00:15:54.333\nBut there are reasons why you might want\nto do a fixed character link with this.\n\n323\n00:15:54.333 --> 00:15:57.977\nThere's a whole reason why\ndatabase design is a science.\n\n324\n00:15:57.977 --> 00:16:02.213\nLike you can get a master's degree in data\nbase design or data information services.\n\n325\n00:16:02.213 --> 00:16:06.845\nYou can get PhDs in it, because there is a\nlot extra that goes on behind the scenes,\n\n326\n00:16:06.845 --> 00:16:09.482\nso I'm just trying to\nshow us the basics here.\n\n327\n00:16:09.482 --> 00:16:11.528\n&gt;&gt; So Don,\nhow do we get data into the table?\n\n328\n00:16:11.528 --> 00:16:16.500\n&gt;&gt; Okay, so what I'm doing here is really\njust defining the table structure.\n\n329\n00:16:16.500 --> 00:16:20.540\nWe can't actually put data into it yet\nuntil the table is in place.\n\n330\n00:16:20.540 --> 00:16:21.840\nAnd then once the table's in place,\n\n331\n00:16:21.840 --> 00:16:23.610\nthen we'll actually be\nable to load some data in.\n\n332\n00:16:23.610 --> 00:16:25.570\nBut we can't do it at the same time, so\n\n333\n00:16:25.570 --> 00:16:27.510\nwe've gotta create that\nempty container first.\n\n334\n00:16:27.510 --> 00:16:30.660\nNow this command that I've written, I'm\nactually kind of done with it, I guess.\n\n335\n00:16:30.660 --> 00:16:34.140\nLet me just throw an extra close\nparenthesis in there to finish it,\n\n336\n00:16:34.140 --> 00:16:37.290\nand a semicolon on it, and I'll run that.\n\n337\n00:16:37.290 --> 00:16:40.240\nAnd my table should be created,\nI'm just gonna verify that it\n\n338\n00:16:40.240 --> 00:16:45.000\nis with a show tables, and\nI see that departments table.\n\n339\n00:16:45.000 --> 00:16:48.710\nI don't see a lot of information on it,\nso if I want some more information,\n\n340\n00:16:48.710 --> 00:16:52.520\nI can do something like\ndescribe departments.\n\n341\n00:16:52.520 --> 00:16:57.082\nSo there's another SQL command, describe,\ntell me about the departments table.\n\n342\n00:16:57.082 --> 00:17:00.378\nAnd, oop, [LAUGH] if I spell it right,\nit actually works.\n\n343\n00:17:00.378 --> 00:17:03.054\n&gt;&gt; [LAUGH]\n&gt;&gt; There we go, and so now I can see,\n\n344\n00:17:03.054 --> 00:17:05.510\nhere's the ID, which is an integer.\n\n345\n00:17:05.510 --> 00:17:10.310\nIt doesn't allow being null, it is\na primary key, it is auto-incrementing.\n\n346\n00:17:10.310 --> 00:17:13.914\nAnd there's the name, it's a variable\ncharacter 50, it can have nulls, and\n\n347\n00:17:13.914 --> 00:17:15.669\nit doesn't have any other option set.\n\n348\n00:17:15.669 --> 00:17:21.084\nSo that's the table, it's there, but\nit's empty, now, how do I know it's empty?\n\n349\n00:17:21.084 --> 00:17:24.830\nWell I know it's empty cuz I just made it,\nbut let's say I didn't know that.\n\n350\n00:17:24.830 --> 00:17:27.600\nHere's where that select command comes in,\n\n351\n00:17:27.600 --> 00:17:30.120\nnow I can actually start working with\ndata, even though it's not here.\n\n352\n00:17:30.120 --> 00:17:35.190\nSo select says I wanna read data out\nof a table, or more than one table.\n\n353\n00:17:35.190 --> 00:17:39.888\nSo select is really the most common query\nthat's ever run, cuz this is reading data.\n\n354\n00:17:39.888 --> 00:17:42.190\nSo I'm gonna select, and\nwhen you do a SELECT statement,\n\n355\n00:17:42.190 --> 00:17:44.110\nit's made up of a couple of pieces.\n\n356\n00:17:44.110 --> 00:17:47.258\nWe say SELECT, and we tell it what\nwe want to get, well, usually,\n\n357\n00:17:47.258 --> 00:17:50.434\nwe want to get everything, so\nI'll say something like SELECT *.\n\n358\n00:17:50.434 --> 00:17:52.676\nBut I could tell it to\njust get certain columns,\n\n359\n00:17:52.676 --> 00:17:56.330\nI could say I want to select just the\nname, I don't want the ID, or whatever.\n\n360\n00:17:56.330 --> 00:18:00.659\nSo I could pick individual columns, I\ndon't want the whole thing, I'm gonna say\n\n361\n00:18:00.659 --> 00:18:05.030\nSELECT * FROM, and then I need to tell\nit the table that I'm pulling from.\n\n362\n00:18:05.030 --> 00:18:09.614\nNow I'm attached to the company database,\nso if I just type departments,\n\n363\n00:18:09.614 --> 00:18:11.964\nit'll know where to find that table.\n\n364\n00:18:11.964 --> 00:18:14.394\nIf I was connected to\na different database, though,\n\n365\n00:18:14.394 --> 00:18:17.150\nI would need to come in here and\ntype company.departments.\n\n366\n00:18:17.150 --> 00:18:21.600\nSo it would know which database to look\nat, and then find a table inside of it.\n\n367\n00:18:21.600 --> 00:18:24.890\nBut since I'm already attached to\nthat database, I can just run that.\n\n368\n00:18:24.890 --> 00:18:27.520\nStick a semicolon on the end, and\nit's gonna open up that table.\n\n369\n00:18:29.000 --> 00:18:31.930\nWell, the table's empty, but\nI do know the table works,\n\n370\n00:18:31.930 --> 00:18:33.030\ncuz the SELECT command didn't fail.\n\n371\n00:18:33.030 --> 00:18:36.380\nSo now it's just up to me to\nget the data in there, and\n\n372\n00:18:36.380 --> 00:18:39.640\nthere's a few different\nways to put data in.\n\n373\n00:18:39.640 --> 00:18:41.440\nI'm gonna show you the manual way first,\n\n374\n00:18:41.440 --> 00:18:43.590\nit's the least likely one\nthat you'll have to do.\n\n375\n00:18:43.590 --> 00:18:47.610\nAs a server administrator, we're rarely\nadding data to the database manually.\n\n376\n00:18:47.610 --> 00:18:48.940\nNormally a developer comes to us and\n\n377\n00:18:48.940 --> 00:18:53.020\nsays, here's this collection of data,\nI need you to preload it for me.\n\n378\n00:18:53.020 --> 00:18:57.970\nBut if you have to manually add it, it's\nnot that hard, use the INSERT command.\n\n379\n00:18:57.970 --> 00:19:03.110\nINSERT lets you add new rows, UPDATE\nlets you change, INSERT lets you add.\n\n380\n00:19:03.110 --> 00:19:05.800\nSo I'm gonna insert data into this table,\nand\n\n381\n00:19:05.800 --> 00:19:12.360\nwe'll say INSERT INTO departments, so\nI'm inserting data into this table.\n\n382\n00:19:12.360 --> 00:19:18.100\nAnd then I need to tell it what I'm\ngoing to be inserting, and so I'm gonna\n\n383\n00:19:18.100 --> 00:19:23.900\nbe inserting some departments, and I need\nto tell it what columns I'm providing.\n\n384\n00:19:24.950 --> 00:19:29.820\nNow, my table only has two columns, ID and\nname, and ID is automatically being\n\n385\n00:19:29.820 --> 00:19:32.720\ngenerated for me, so\nI don't have to provide an ID number.\n\n386\n00:19:32.720 --> 00:19:34.480\nSo all I have to do is provide a name, so\n\n387\n00:19:34.480 --> 00:19:37.890\nI'm telling it that I'm about to give\nit the name of a few departments.\n\n388\n00:19:37.890 --> 00:19:41.440\nAnd then I need to tell it the values\nthat I want to add, and so\n\n389\n00:19:41.440 --> 00:19:44.293\nhere's where I start to\nlist the departments.\n\n390\n00:19:44.293 --> 00:19:48.469\nNow here's where things get a little bit\nweird, SQL is very sensitive about syntax,\n\n391\n00:19:48.469 --> 00:19:50.155\nit's very easy to make mistakes.\n\n392\n00:19:50.155 --> 00:19:52.216\nAny time you provide a text value,\n\n393\n00:19:52.216 --> 00:19:56.090\nyou need to put a single quote\nmark around the text value.\n\n394\n00:19:56.090 --> 00:19:59.760\nAnd that takes care of instances where you\nmight have spaces or special characters.\n\n395\n00:19:59.760 --> 00:20:01.470\nYou don't want those being interpreted, so\n\n396\n00:20:01.470 --> 00:20:04.640\nwe need to do that single\nlittle quote mark.\n\n397\n00:20:04.640 --> 00:20:10.784\nAnd so I'm going to create an accounting\ndepartment, and then I'll provide,\n\n398\n00:20:10.784 --> 00:20:15.518\nactually I need to drop the quotes,\nparentheses around that.\n\n399\n00:20:15.518 --> 00:20:21.608\nAnd then I'll do marketing, HR,\neach of the different departments\n\n400\n00:20:21.608 --> 00:20:26.753\nthat I want to create, and\nwe'll get each one put in here.\n\n401\n00:20:26.753 --> 00:20:31.148\nAnd you can start to see where this\nwould be really time consuming, and\n\n402\n00:20:31.148 --> 00:20:36.880\nthe more records I'm adding, the longer it\nwould take me to type in all this stuff.\n\n403\n00:20:36.880 --> 00:20:40.270\nAnd so that's why I say this is not\nnormally the way that we would do it,\n\n404\n00:20:40.270 --> 00:20:43.460\njust because of the sheer\namount of time it would take.\n\n405\n00:20:43.460 --> 00:20:46.150\nHere I'm just doing the name,\nlet's imagine I was providing more,\n\n406\n00:20:46.150 --> 00:20:47.770\nlike the manager and so on.\n\n407\n00:20:47.770 --> 00:20:54.320\nI would need to update this, and say that\nI'm providing name, manager, like that.\n\n408\n00:20:54.320 --> 00:20:58.885\nAnd then for each one of these values\nI would need to say accounting, and\n\n409\n00:20:58.885 --> 00:21:02.932\nthen a comma, and then dpezet,\nI'm the manager or whatever.\n\n410\n00:21:02.932 --> 00:21:05.788\nI'd have to provide that in for\neach one of these,\n\n411\n00:21:05.788 --> 00:21:09.240\nit really does start to\nbecome super time consuming.\n\n412\n00:21:09.240 --> 00:21:11.374\nSo I'll show you the faster way\nto do this here in just a moment.\n\n413\n00:21:11.374 --> 00:21:13.216\nBut what this command\nright here is gonna do,\n\n414\n00:21:13.216 --> 00:21:16.620\nit's gonna open up the departments table,\nand it's gonna add four departments.\n\n415\n00:21:16.620 --> 00:21:19.545\nAccounting, HR, marketing, and\nsales, and it's gonna add them.\n\n416\n00:21:19.545 --> 00:21:23.605\nAnd in theory, the ID should\nauto-increment and populate for us, and\n\n417\n00:21:23.605 --> 00:21:25.918\nget them in there, unless I made a typo.\n\n418\n00:21:25.918 --> 00:21:30.140\nSo, I'll run that and there we go,\nI see query, four rows affected,\n\n419\n00:21:30.140 --> 00:21:33.660\nthat's a good sign, and\nnow I can query that table again.\n\n420\n00:21:33.660 --> 00:21:37.152\nI'm just gonna SELECT * FROM departments,\nand when I run that,\n\n421\n00:21:37.152 --> 00:21:40.150\nI've got four departments,\nIDs 1, 2, 3, and 4.\n\n422\n00:21:40.150 --> 00:21:43.681\nI've auto-populated the ID, and I've got\naccounting, HR, marketing, and sales.\n\n423\n00:21:43.681 --> 00:21:47.602\nThey're all defined right in there, so I\njust inserted data into this database, and\n\n424\n00:21:47.602 --> 00:21:50.020\nnow I can query it, and\nread that data back out.\n\n425\n00:21:50.020 --> 00:21:53.051\nSo this is kind of my first foray\ninto getting data into that database.\n\n426\n00:21:53.051 --> 00:21:57.690\n&gt;&gt; And what if I have a large data set,\nthere has to be something faster, right?\n\n427\n00:21:57.690 --> 00:22:03.024\n&gt;&gt; Absolutely, so what I just showed you,\nthat's not something I like to do [LAUGH].\n\n428\n00:22:03.024 --> 00:22:05.247\n&gt;&gt; You said that to begin with,\nso we're covered.\n\n429\n00:22:05.247 --> 00:22:08.313\n&gt;&gt; I try and stay away from that\nINSERT command as much as I can.\n\n430\n00:22:08.313 --> 00:22:10.193\nSo what's usually going to happen,\n\n431\n00:22:10.193 --> 00:22:12.807\nis a developer's gonna come\nto you with a data set.\n\n432\n00:22:12.807 --> 00:22:15.940\nAnd there's two different ways that\ncan come to you with the data set.\n\n433\n00:22:15.940 --> 00:22:20.943\nThere's a super easy way and then a not so\neasy way, so let's start with the not so\n\n434\n00:22:20.943 --> 00:22:22.700\neasy way, I'm gonna get-\n&gt;&gt; [LAUGH]\n\n435\n00:22:22.700 --> 00:22:24.110\n&gt;&gt; Out of the client.\n\n436\n00:22:24.110 --> 00:22:25.330\n&gt;&gt; Because options are fantastic [LAUGH].\n\n437\n00:22:25.330 --> 00:22:28.850\n&gt;&gt; I'll be honest with you Zach, the not\nso easy way is the most common one.\n\n438\n00:22:28.850 --> 00:22:32.640\nWhat'll happen is, they'll bring you a set\nof data and the most common format for\n\n439\n00:22:32.640 --> 00:22:35.900\na set of data is a CSV.\n\n440\n00:22:35.900 --> 00:22:42.113\nA CSV, or a comma separated values file,\nand if I take a look at that file,\n\n441\n00:22:42.113 --> 00:22:46.136\nwhoopse, and here we go,\nand take a look at it.\n\n442\n00:22:46.136 --> 00:22:50.057\nWhat it's got is basically a table\ndefined, it's got an ID column,\n\n443\n00:22:50.057 --> 00:22:52.540\nfirst name, last name, department.\n\n444\n00:22:52.540 --> 00:22:57.920\nAnd then it's got it all laid out right\nhere with each entry, the ID number,\n\n445\n00:22:57.920 --> 00:23:01.680\nthe first name, the last name, and\nwhat department they happen to be in.\n\n446\n00:23:01.680 --> 00:23:04.893\nAnd notice that the department is just\na number, because we can relate that\n\n447\n00:23:04.893 --> 00:23:07.290\nto the department table, and\nget the name out of there.\n\n448\n00:23:07.290 --> 00:23:14.070\nSo I don't remember what departments\nwere what, so number four is sales.\n\n449\n00:23:14.070 --> 00:23:19.550\nSo I can look in here and\nI can see that Odessa, James is in sales.\n\n450\n00:23:19.550 --> 00:23:20.980\nThat's kinda how you relate that together,\n\n451\n00:23:20.980 --> 00:23:23.090\nthat's where the term\nrelational database comes from.\n\n452\n00:23:23.090 --> 00:23:25.228\nBut this is the most common way\nthat somebody will give you data.\n\n453\n00:23:25.228 --> 00:23:32.164\nThe problem is we don't have a super easy\nway to bring that into MySQL or MariaDB.\n\n454\n00:23:32.164 --> 00:23:34.366\nWell, there is a way,\nit's just not super easy,\n\n455\n00:23:34.366 --> 00:23:36.800\nit's kind of a long command\nthat we need to run.\n\n456\n00:23:36.800 --> 00:23:41.538\nThere's a utility that's\ninstalled with the MySQL client or\n\n457\n00:23:41.538 --> 00:23:45.100\nthe MariaDB client that\nlets you Import this.\n\n458\n00:23:45.100 --> 00:23:52.132\nIt's the MySQL import command, and it lets\nyou import data right into the database.\n\n459\n00:23:52.132 --> 00:23:57.320\nAnd it can accept a CSV file,\nwith a couple of little modifiers to it.\n\n460\n00:23:57.320 --> 00:24:02.301\nMySQL import, it actually expects you\nnot to have comma separated values But\n\n461\n00:24:02.301 --> 00:24:05.290\na tab-separated values file by default,\nbut\n\n462\n00:24:05.290 --> 00:24:10.040\nnot many people do tab-separated\nvalues files, it's pretty rare.\n\n463\n00:24:10.040 --> 00:24:14.270\nAnd then it also expects you to not\nhave quote marks anywhere in your file,\n\n464\n00:24:14.270 --> 00:24:16.360\nwhich is, again, not very common.\n\n465\n00:24:16.360 --> 00:24:19.560\nSo we'll want to change the default\nbehavior for it to work.\n\n466\n00:24:19.560 --> 00:24:21.470\nWell, there's also something\nelse I need to do,\n\n467\n00:24:21.470 --> 00:24:22.920\nI need to create the employees table.\n\n468\n00:24:22.920 --> 00:24:27.288\nIf I'm gonna import all these employees,\nthen I need to create the table first,\n\n469\n00:24:27.288 --> 00:24:29.804\na CSV doesn't really define the table for\nus.\n\n470\n00:24:29.804 --> 00:24:32.905\nI'm lucky here that my file\nactually has a header line.\n\n471\n00:24:32.905 --> 00:24:35.769\nIt actually has, whoops, this entry right\nhere that tells me what each of these\n\n472\n00:24:35.769 --> 00:24:38.250\ncolumns are, cuz sometimes,\nyou don't even have that.\n\n473\n00:24:38.250 --> 00:24:41.170\nAnd so now, you've really kind\nof do things from scratch.\n\n474\n00:24:41.170 --> 00:24:44.970\nSo I need to get that table created, and\nthen we'll be able to use the MySQL Import\n\n475\n00:24:44.970 --> 00:24:50.220\ncommand to import that, draw it all in,\nand get it loaded in that table.\n\n476\n00:24:50.220 --> 00:24:55.940\nSo I'm gonna get back into MySQL or\nMariaDB, in my case.\n\n477\n00:24:55.940 --> 00:25:01.780\nAnd I will use company, so I'm gonna\nget connected back to that database.\n\n478\n00:25:01.780 --> 00:25:06.832\nAnd then I'm going to create an employees\ntable, so I'm going to create table,\n\n479\n00:25:06.832 --> 00:25:10.193\nemployees, and\nthen I need to define what it's got.\n\n480\n00:25:10.193 --> 00:25:15.283\nIn my CSV, I looked at it, and\nit had ID, first name, last name,\n\n481\n00:25:15.283 --> 00:25:20.970\ndepartment, and so I want to create\ncolumns that correspond to that.\n\n482\n00:25:20.970 --> 00:25:23.850\nSo I'll come in and\nI'll say what I need, so\n\n483\n00:25:23.850 --> 00:25:29.590\nin my case, we need an ID,\nwhich is integer.\n\n484\n00:25:29.590 --> 00:25:31.440\nAnd I'm gonna dump this\ntable in a minute and\n\n485\n00:25:31.440 --> 00:25:33.560\nrecreate it, so I'm not gonna\nworry about enforcing uniqueness.\n\n486\n00:25:33.560 --> 00:25:35.960\nAnd all the other stuff that we'd normally\ndo, I showed you guys that a moment ago.\n\n487\n00:25:35.960 --> 00:25:39.960\nSo I'm gonna leave that off, to save\na little time here, and then I'll do first\n\n488\n00:25:39.960 --> 00:25:45.710\nname, which I will do as\na variable character 50.\n\n489\n00:25:45.710 --> 00:25:48.390\nIn real life land,\nI'd sanitize my data first and\n\n490\n00:25:48.390 --> 00:25:52.050\nfind out what the longest record was, and\nleave the appropriate amount of padding.\n\n491\n00:25:52.050 --> 00:25:54.254\nThere might be some records in there\nthat have more than 50 letters.\n\n492\n00:25:54.254 --> 00:25:56.732\nSo I want to make sure I\nprovide enough space for them,\n\n493\n00:25:56.732 --> 00:25:59.168\ncuz it's really hard to\nchange this after the fact.\n\n494\n00:25:59.168 --> 00:26:03.545\nYou wanna change these column definitions,\nyou've really gotta basically back up your\n\n495\n00:26:03.545 --> 00:26:07.761\ndata, delete the table, and recreate the\ntable, it's not an easy thing to change.\n\n496\n00:26:07.761 --> 00:26:10.930\nSo I need my first name,\nI need a last name,\n\n497\n00:26:10.930 --> 00:26:15.170\nwhich I'll just do the same,\nvariable character 50.\n\n498\n00:26:15.170 --> 00:26:18.570\nAnd then I need the department, and\n\n499\n00:26:18.570 --> 00:26:21.690\nthe department is just an integer,\nnothing too special there.\n\n500\n00:26:22.970 --> 00:26:27.000\nAnd that integer will correspond with\nan ID over in the department table.\n\n501\n00:26:27.000 --> 00:26:32.720\nSo that's gonna create that table for me,\nif I do a show tables, I can see that.\n\n502\n00:26:32.720 --> 00:26:34.360\nAnd if I do a describe,\n\n503\n00:26:34.360 --> 00:26:39.840\nI can check my work,\ndo that whole spelling thing, there we go.\n\n504\n00:26:39.840 --> 00:26:42.750\nSo now we can see it, I've got it defined,\nand now it's ready for\n\n505\n00:26:42.750 --> 00:26:45.570\nme to import that data,\nso I can get out of this.\n\n506\n00:26:45.570 --> 00:26:51.780\nAnd once I'm out, now I can use the\nMySQL Import utility to import that CSV.\n\n507\n00:26:51.780 --> 00:26:54.950\nSo that's what I'm going to do right now,\nI'm gonna come in.\n\n508\n00:26:54.950 --> 00:26:57.100\nAnd first off, I need to tell it,\n\n509\n00:26:57.100 --> 00:27:00.470\nmy CSV has a header line in it that\ntells me what each column name is.\n\n510\n00:27:00.470 --> 00:27:03.190\nI don't need to import that,\nthat's not a row, so\n\n511\n00:27:03.190 --> 00:27:07.480\nI need to tell it --ignore-lines=1.\n\n512\n00:27:07.480 --> 00:27:10.692\nSo ignore line number one, that's\na header line, we're not gonna use it.\n\n513\n00:27:10.692 --> 00:27:14.223\nIf your file doesn't have a header,\ndon't do this part,\n\n514\n00:27:14.223 --> 00:27:17.989\n[LAUGH] cuz line 1 will be a row,\nso I'm gonna ignore that one.\n\n515\n00:27:17.989 --> 00:27:24.334\nThen I'm gonna say\n--fields-terminated-by= and\n\n516\n00:27:24.334 --> 00:27:30.140\nthen inside of a single\nquote I'll do a comma.\n\n517\n00:27:30.140 --> 00:27:36.032\nIt defaults to a tab, it's expecting tabs\nin between each field, I've got commas.\n\n518\n00:27:36.032 --> 00:27:40.640\nThis is a CSV, not a TSV, so I need to\ntell it that, so I'm telling it, any time\n\n519\n00:27:40.640 --> 00:27:44.500\nyou see a comma, that's the end of one\nfield and the start of another field.\n\n520\n00:27:45.600 --> 00:27:49.580\nThat's one problem I had,\nthe other part were the quote marks.\n\n521\n00:27:49.580 --> 00:27:51.590\nThat, we'll typically use quote marks cuz,\n\n522\n00:27:51.590 --> 00:27:55.390\nwhat if somebody has a dual\nlast name with a space in it?\n\n523\n00:27:55.390 --> 00:27:59.690\nYou see that in a lot of Dutch last names,\n\n524\n00:27:59.690 --> 00:28:02.440\nwhere you've got Van der Schlood or\nwhatever.\n\n525\n00:28:02.440 --> 00:28:03.925\nThere might be a space in the name, and\n\n526\n00:28:03.925 --> 00:28:05.980\nthat can cause problems if\nyou put quotes around it.\n\n527\n00:28:05.980 --> 00:28:06.915\nSo I need to tell it,\n\n528\n00:28:06.915 --> 00:28:16.915\n--fields-optionally-enclosed-by=\n\n529\n00:28:18.010 --> 00:28:21.690\nand then inside a little single tick\nmark here, I'll put a double quote.\n\n530\n00:28:21.690 --> 00:28:24.990\nOn the screen it looks a little weird, but\nit's a single quote, a double quote, and\n\n531\n00:28:24.990 --> 00:28:26.080\nthen a single quote.\n\n532\n00:28:26.080 --> 00:28:30.912\nI'm saying anytime you find a double\nquote, that's starting a field, and\n\n533\n00:28:30.912 --> 00:28:32.410\nthen you'll see another\none to close the field.\n\n534\n00:28:32.410 --> 00:28:35.504\nBut it's optional,\nI don't have to have it, but\n\n535\n00:28:35.504 --> 00:28:40.530\nthat may be encountered in the file,\nanywhere somebody had a space or whatever.\n\n536\n00:28:40.530 --> 00:28:44.017\nSo we've got that kinda of defined,\nI'm gonna tell it --verbose, so\n\n537\n00:28:44.017 --> 00:28:47.861\nthat if there's any errors, I'll get\ndetailed information and I can see why.\n\n538\n00:28:47.861 --> 00:28:51.783\nI'll tell it --local, because I'm\nrunning this from the server, and\n\n539\n00:28:51.783 --> 00:28:55.532\nit's always better to run this from\nthe server for multiple reasons.\n\n540\n00:28:55.532 --> 00:28:59.028\nThe main one's performance, it'll run\na lot faster from the server itself, and\n\n541\n00:28:59.028 --> 00:29:01.930\nalso, you don't have to worry\nabout network interruptions.\n\n542\n00:29:01.930 --> 00:29:05.165\nThe import can continue on even\nif you drop a network connection,\n\n543\n00:29:05.165 --> 00:29:09.190\nversus if you're doing this over\na network, it could drop, and\n\n544\n00:29:09.190 --> 00:29:11.540\nthen it'll roll back\nthe entire transaction.\n\n545\n00:29:11.540 --> 00:29:15.615\nWhich is not necessarily something you\nwant, to take a performance hit twice.\n\n546\n00:29:15.615 --> 00:29:16.990\nSo I'm running it from the server,\n\n547\n00:29:18.330 --> 00:29:20.790\nthen I'll tell it the user\nthat I'm going to use.\n\n548\n00:29:20.790 --> 00:29:24.160\nI'm using the root user right now,\nI'll tell it to prompt me for a password.\n\n549\n00:29:24.160 --> 00:29:27.890\nAnd almost done, I need to tell\nit the database that I'm using,\n\n550\n00:29:27.890 --> 00:29:29.890\nI'm using the company database.\n\n551\n00:29:29.890 --> 00:29:32.940\nAnd then finally the file\nthat I'm gonna load, and\n\n552\n00:29:32.940 --> 00:29:36.010\nthe file I'm gonna load\nis in my home directory.\n\n553\n00:29:36.010 --> 00:29:40.660\nSo I'll just say till/employees.csv,\nthat's the file that I wanna load.\n\n554\n00:29:40.660 --> 00:29:44.290\nAll right, so that is one long command,\n\n555\n00:29:45.450 --> 00:29:48.950\nand each part is kind of important.\n\n556\n00:29:48.950 --> 00:29:52.270\nBut a lot of it is optional,\nif I didn't have a header,\n\n557\n00:29:52.270 --> 00:29:54.020\nI could have left this part off.\n\n558\n00:29:54.020 --> 00:29:57.602\nAnd if I had a tab-separated\nvalues with no quote marks,\n\n559\n00:29:57.602 --> 00:30:00.190\nI could have left these two parts off.\n\n560\n00:30:00.190 --> 00:30:03.830\nAnd now the command becomes very short,\nso if you've sanitized your data,\n\n561\n00:30:03.830 --> 00:30:06.560\nif you've gotten it in the right format,\nthis can be a pretty easy process.\n\n562\n00:30:06.560 --> 00:30:09.803\nBut I wanted to show you guys the most\nlikely, and this CSV is really\n\n563\n00:30:09.803 --> 00:30:13.425\nrepresentative of what almost every\ndeveloper's ever come to me with.\n\n564\n00:30:13.425 --> 00:30:16.528\n[LAUGH] It's just,\nMicrosoft Excel, LibraOffice,\n\n565\n00:30:16.528 --> 00:30:21.350\nthey all export CSVs very easy, and that's\nwhere your data normally comes from.\n\n566\n00:30:21.350 --> 00:30:24.190\nNow I could have errors in here, so\nI do need to be careful with that.\n\n567\n00:30:24.190 --> 00:30:26.960\nAnd the recommendation is,\nbefore you do any kind of bulk import,\n\n568\n00:30:26.960 --> 00:30:28.680\nyou should back up your database first.\n\n569\n00:30:28.680 --> 00:30:31.450\nAnd that way, if there's a problem,\nif you import bad data,\n\n570\n00:30:31.450 --> 00:30:33.050\nmaybe you labeled a column wrong.\n\n571\n00:30:33.050 --> 00:30:35.050\nIt's easy to just blow\naway the database and\n\n572\n00:30:35.050 --> 00:30:37.700\nrestore it, I showed how to\ndo that in the last episode.\n\n573\n00:30:37.700 --> 00:30:40.690\nBut if you know everything's gonna work,\nor if you're in a test environment,\n\n574\n00:30:40.690 --> 00:30:42.530\nthen it's easy to run through this,\nit's not a big deal.\n\n575\n00:30:42.530 --> 00:30:46.740\nAnd I'll normally restore data like\nthis to a test database first,\n\n576\n00:30:46.740 --> 00:30:50.080\nmake sure it works, and\nthen move it over into production, repeat.\n\n577\n00:30:50.080 --> 00:30:53.570\nSo, I'm gonna run that,\nit's gonna ask me for my password.\n\n578\n00:30:53.570 --> 00:30:57.149\nAnd there it goes, it's loading data from\nthe local file, it's reading through it.\n\n579\n00:30:57.149 --> 00:31:02.052\nIt found 101 records, it deleted zero,\nskipped zero, so that's good.\n\n580\n00:31:02.052 --> 00:31:07.105\nI did get four warnings,\nis what it's telling me, I did a verbose,\n\n581\n00:31:07.105 --> 00:31:12.130\nand I didn't see any on the screen,\nso they were just warnings.\n\n582\n00:31:12.130 --> 00:31:14.520\nI'd need to go back and\nlook at my data and make sure.\n\n583\n00:31:14.520 --> 00:31:18.654\nIf it were anything bad, like if I had\na name that was more than 50 characters or\n\n584\n00:31:18.654 --> 00:31:22.852\nwhatever, then it would've given me a red\nflag, it wouldn't be a warning, but\n\n585\n00:31:22.852 --> 00:31:23.804\nan actual error.\n\n586\n00:31:23.804 --> 00:31:26.540\nBut in my case, it looks like it's\nbrought it in, so we can go and\n\n587\n00:31:26.540 --> 00:31:29.802\nverify that real quick, and\nmake sure that it's actually there.\n\n588\n00:31:29.802 --> 00:31:34.390\nI'm gonna get back into my server, and\n\n589\n00:31:34.390 --> 00:31:39.406\nonce I'm in here, I'll do a USE company,\n\n590\n00:31:40.662 --> 00:31:46.860\nAnd I'll say SELECT * FROM employees.\n\n591\n00:31:46.860 --> 00:31:49.620\nOpen up that table, show me what's\nin there, let's see what happened.\n\n592\n00:31:49.620 --> 00:31:54.000\nI should have imported 101 records,\nthat's what it told me, at least.\n\n593\n00:31:54.000 --> 00:31:56.400\nAnd so when I look,\nwell there's my warning,\n\n594\n00:31:56.400 --> 00:31:58.980\nthat will actually be the four\nwarnings right there.\n\n595\n00:31:58.980 --> 00:32:02.150\nI must have had an extra carriage\nreturn at the end of the file,\n\n596\n00:32:02.150 --> 00:32:03.270\nwhich is a blank line.\n\n597\n00:32:03.270 --> 00:32:06.580\nAnd so that would have accounted for\nfour blank fields, and\n\n598\n00:32:06.580 --> 00:32:09.590\nthat would have been my four warnings,\nI should have cleaned the file.\n\n599\n00:32:09.590 --> 00:32:12.210\nYou do want to make sure your file\nis in the right state of mind, and\n\n600\n00:32:12.210 --> 00:32:15.470\nhaving that extra carriage return at\nthe end created an extra record here.\n\n601\n00:32:15.470 --> 00:32:16.980\nSo I did have 100 employees, though,\n\n602\n00:32:16.980 --> 00:32:21.280\nand if I look at my list here,\nI have 100 employees starting with 1,\n\n603\n00:32:21.280 --> 00:32:24.880\ngoing all the way up to 100,\nand they're all loaded in here.\n\n604\n00:32:24.880 --> 00:32:28.257\nNow I've actually got data in\nthe table and ready to work with, now,\n\n605\n00:32:28.257 --> 00:32:30.541\nthat's the hard way of\ngetting data in there.\n\n606\n00:32:30.541 --> 00:32:33.783\nThere are easier ways, but\nthis was kind of that hard example.\n\n607\n00:32:33.783 --> 00:32:35.288\nAnd it kinda took a little\nlonger than I planned, so\n\n608\n00:32:35.288 --> 00:32:37.039\nI think we're gonna go into\na part two to show the other way.\n\n609\n00:32:37.039 --> 00:32:37.677\n&gt;&gt; Part two.\n&gt;&gt; But\n\n610\n00:32:37.677 --> 00:32:39.599\nI wanna show you the easier\nway to bring it in,\n\n611\n00:32:39.599 --> 00:32:42.410\nthe way that you hope that\nthe developers bring it to you.\n\n612\n00:32:42.410 --> 00:32:45.320\nAnd then I wanna show you how\nwe can actually use this data,\n\n613\n00:32:45.320 --> 00:32:47.990\nwhat a SQL query actually looks like,\n\n614\n00:32:47.990 --> 00:32:51.550\nand how that data functions, so\nwe'll tackle that in part two.\n\n615\n00:32:51.550 --> 00:32:54.110\n&gt;&gt; And that will be in part two,\nworking with data, and\n\n616\n00:32:54.110 --> 00:32:56.180\nbecoming a Linux server administrator.\n\n617\n00:32:56.180 --> 00:32:58.500\nWonderful job as usual, Don, fantastic,\n\n618\n00:32:58.500 --> 00:33:00.895\nany last words you want\nto tease people with?\n\n619\n00:33:00.895 --> 00:33:03.487\n&gt;&gt; The main thing,\nwhen you do an import like this, again,\n\n620\n00:33:03.487 --> 00:33:05.170\nmake sure that you do a backup first.\n\n621\n00:33:05.170 --> 00:33:08.090\nIn case something goes wrong,\nyou can check it out, and find it out.\n\n622\n00:33:08.090 --> 00:33:12.990\nSanitize your file like I didn't do here,\nmake sure that stuff's accounted for.\n\n623\n00:33:12.990 --> 00:33:17.850\nAlso, make sure that you test the import\nsomewhere else first before doing it\n\n624\n00:33:17.850 --> 00:33:21.230\nin production, you don't wanna\nimpact your production database.\n\n625\n00:33:21.230 --> 00:33:24.950\nAnd remember performance,\nbecause the larger the import,\n\n626\n00:33:24.950 --> 00:33:26.550\nthe bigger a hit it's\ngonna put on the server.\n\n627\n00:33:26.550 --> 00:33:27.798\nSo it may slow down access for\n\n628\n00:33:27.798 --> 00:33:31.451\nother users if they're simultaneously in\nthe system, so be aware of all of those.\n\n629\n00:33:31.451 --> 00:33:32.892\n&gt;&gt; Fantastic, and don't forget,\n\n630\n00:33:32.892 --> 00:33:35.418\nwe're gonna be showing you\nthe easier way to import data.\n\n631\n00:33:35.418 --> 00:33:37.129\n&gt;&gt; [LAUGH]\n&gt;&gt; And that's gonna be in part two of\n\n632\n00:33:37.129 --> 00:33:39.802\nworking with data and\nbecoming a Linux server administrator.\n\n633\n00:33:39.802 --> 00:33:41.372\nAnd it's a whole bunch of videos,\n\n634\n00:33:41.372 --> 00:33:43.870\nin the becoming a Linux\nserver administrator series.\n\n635\n00:33:43.870 --> 00:33:47.050\nMake sure you watch every single one,\nyou'll be very glad you did.\n\n636\n00:33:47.050 --> 00:33:49.454\nAnd thank you for\nwatching ITProTV, remember,\n\n637\n00:33:49.454 --> 00:33:51.983\na good IT pro is always learning,\nI'm Zach Memos.\n\n638\n00:33:51.983 --> 00:33:52.573\n&gt;&gt; And I'm Don Pezet.\n\n639\n00:33:52.573 --> 00:33:55.309\n&gt;&gt; And we will see you very soon.\n\n640\n00:33:55.309 --> 00:34:00.761\n[MUSIC]\n\n641\n00:34:00.761 --> 00:34:03.360\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "229134904"
        },
        {
          "description": "Don and Zach discuss importing data via an SQL script, getting data loaded, looking at the data, view all data in a table, changing data, and joining results from multiple tables.",
          "length": "1546",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-2-2-working_with_data_pt_2-080917.00_25_33_29.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-2-2-working_with_data_pt_2-080917.00_25_33_29.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-7-2-2-working_with_data_pt_2-080917.00_25_33_29.Still001-sm.jpg",
          "title": "Working with Data Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.008 --> 00:00:02.842\nWelcome to ITProTV,\nI'm your host Don Pezet.\n\n2\n00:00:02.842 --> 00:00:06.323\n[CROSSTALK]\n\n3\n00:00:06.323 --> 00:00:08.107\n[MUSIC]\n\n4\n00:00:08.107 --> 00:00:12.117\n&gt;&gt; You're watching ITProTV.\n\n5\n00:00:12.117 --> 00:00:13.482\n&gt;&gt; Hello, and thank you for\n\n6\n00:00:13.482 --> 00:00:16.940\nchoosing ITProTV,\nhelping you learn wherever you go.\n\n7\n00:00:16.940 --> 00:00:17.700\nI'm Zach Memos,\n\n8\n00:00:17.700 --> 00:00:21.320\nyour host, as we continue with\nBecoming a Linux Server Administrator.\n\n9\n00:00:21.320 --> 00:00:23.780\nThis is Working With Data, part two.\n\n10\n00:00:23.780 --> 00:00:26.840\nWe had a part one, make sure you see\nboth parts, you'll be glad you did.\n\n11\n00:00:26.840 --> 00:00:30.510\nAnd giving us all the information\nwe need is Don Pezet, our IT pro.\n\n12\n00:00:30.510 --> 00:00:31.790\nDon, good to see you again, sir.\n\n13\n00:00:31.790 --> 00:00:32.950\n&gt;&gt; Hey, glad to be back, Zach.\n\n14\n00:00:32.950 --> 00:00:34.480\nAnd continuing on with\nour Working With Data.\n\n15\n00:00:34.480 --> 00:00:37.680\nRemember in this series what we're\ndoing is going a little bit beyond\n\n16\n00:00:37.680 --> 00:00:40.420\nwhat a normal Linux server\nadministrator would need to do.\n\n17\n00:00:40.420 --> 00:00:44.890\nAnd showing how we can actually interact\nwith the data inside of an SQL database,\n\n18\n00:00:44.890 --> 00:00:47.390\nand we've been working with MariaDB and\nMySQL.\n\n19\n00:00:47.390 --> 00:00:50.747\nWe saw in the last episode how to\nimport some data and get it in there.\n\n20\n00:00:50.747 --> 00:00:53.533\nAnd we're gonna continue along\nthose lines in this episode, and\n\n21\n00:00:53.533 --> 00:00:56.710\nlook at getting more data in there,\nand then actually kinda work with it.\n\n22\n00:00:56.710 --> 00:00:58.790\nSo that's all coming up\nright here in this episode.\n\n23\n00:00:58.790 --> 00:00:59.299\n&gt;&gt; And Don,\n\n24\n00:00:59.299 --> 00:01:03.756\nI'm very excited because you showed us a\nmore common way people do import the data.\n\n25\n00:01:03.756 --> 00:01:06.710\nBut now you're gonna show us the easier\nway to import the data, correct?\n\n26\n00:01:06.710 --> 00:01:10.950\n&gt;&gt; Yes, absolutely, and the example\nthat I ended the last show with was,\n\n27\n00:01:10.950 --> 00:01:16.470\nif a developer or somebody comes to you\nwith a CSV, a comma separated values file.\n\n28\n00:01:16.470 --> 00:01:19.473\nHow you can import that into\na table inside of MySQL and\n\n29\n00:01:19.473 --> 00:01:21.085\nthat is incredibly common.\n\n30\n00:01:21.085 --> 00:01:23.579\nNine times out of ten when somebody\ncomes to me with data with to load,\n\n31\n00:01:23.579 --> 00:01:24.832\nthat's the format that it's in.\n\n32\n00:01:24.832 --> 00:01:27.441\nSo that's why it was important and\nI wanted to show you guys that first.\n\n33\n00:01:27.441 --> 00:01:28.360\n&gt;&gt; Right, right.\n\n34\n00:01:28.360 --> 00:01:30.530\n&gt;&gt; Now I wanna show you what\nis called the easy way.\n\n35\n00:01:30.530 --> 00:01:34.100\nAnd I always know that I'm\nworking at a company with\n\n36\n00:01:34.100 --> 00:01:37.950\ngreat data handlers when they come\nto me with data in the right format.\n\n37\n00:01:37.950 --> 00:01:41.692\nAnd if you've got statisticians or\nactuaries or\n\n38\n00:01:41.692 --> 00:01:46.250\nwhatever who really know how to handle\ndata, they won't bring you data as a CSV,\n\n39\n00:01:46.250 --> 00:01:48.440\nthey'll bring it a different form, right?\n\n40\n00:01:48.440 --> 00:01:51.650\nAnd that form is an SQL script.\n\n41\n00:01:51.650 --> 00:01:55.450\nAn SQL script, it's a text file,\na lot like a CSV is.\n\n42\n00:01:55.450 --> 00:01:59.811\nExcept it's specifically designed to\nbe imported into a relational database.\n\n43\n00:01:59.811 --> 00:02:03.265\nAnd it's really amazing,\nit makes our job a lot easier, and\n\n44\n00:02:03.265 --> 00:02:06.510\nit minimizes the chance\nof us making a mistake.\n\n45\n00:02:06.510 --> 00:02:11.140\nIt lets the data handlers, they build and\ncraft the data the way they want.\n\n46\n00:02:11.140 --> 00:02:14.060\nAnd that way they ensure the data\ncomes in, in the right format.\n\n47\n00:02:14.060 --> 00:02:17.670\nSo if they bring you your\ndata in an SQL script, boy,\n\n48\n00:02:17.670 --> 00:02:21.720\nit just makes your job so much easier and\nyou can import that data.\n\n49\n00:02:21.720 --> 00:02:25.100\nSo I've got an example script\nlike that I wanna show you guys.\n\n50\n00:02:25.100 --> 00:02:29.048\nSo in the last episode I used\nthis employees.csv, right?\n\n51\n00:02:29.048 --> 00:02:33.550\nAnd with employees.csv, all it does is,\n\n52\n00:02:33.550 --> 00:02:36.980\nmaybe you have a header line,\nI do, you don't always have that.\n\n53\n00:02:36.980 --> 00:02:39.550\nAnd it just says, here's the data, right?\n\n54\n00:02:39.550 --> 00:02:41.550\nIt just kinda lays it out,\nand there it goes.\n\n55\n00:02:41.550 --> 00:02:45.970\nBut we saw that when we imported this\ndata that we had to do a lot more.\n\n56\n00:02:45.970 --> 00:02:49.687\nWe had to create the table first,\nwe had to set the data types, right?\n\n57\n00:02:49.687 --> 00:02:53.667\nAnd if I just have this, how do I know\nwhat data type I should be using for\n\n58\n00:02:53.667 --> 00:02:54.650\nthese, right?\n\n59\n00:02:54.650 --> 00:02:57.780\nWhat should be the maximum characters for\nfirst name?\n\n60\n00:02:57.780 --> 00:03:02.810\nAnd 1, is it just gonna be an integer or\nshould I make i this a big int?\n\n61\n00:03:02.810 --> 00:03:05.480\nThere's different types of\n\n62\n00:03:05.480 --> 00:03:09.850\nmathematical data types you can use\ndepending on the size of the number.\n\n63\n00:03:09.850 --> 00:03:12.620\nThis might be a number that\ncould get really, really large.\n\n64\n00:03:12.620 --> 00:03:14.560\nIt might not even be something\nwe wanna to treat as a number.\n\n65\n00:03:14.560 --> 00:03:17.990\nIf it's something like a Social Security\nnumber, where it's three digits and\n\n66\n00:03:17.990 --> 00:03:21.800\na hyphen, two digits and a hyphen,\nfour digits, that's not a normal number.\n\n67\n00:03:21.800 --> 00:03:24.750\nI wouldn't make that an integer,\nyou can't put a hyphen in an integer.\n\n68\n00:03:24.750 --> 00:03:27.850\nSo now I need to treat that\nas a string of some sort.\n\n69\n00:03:27.850 --> 00:03:33.986\nAs a server admin, we're not equipped\nto make those decisions, right?\n\n70\n00:03:33.986 --> 00:03:38.376\nSo in bigger data houses where they have\nprofessionals that are handling the data,\n\n71\n00:03:38.376 --> 00:03:42.790\nthey won't give it to you as a CSV,\nthey'll give it to you as an SQL script.\n\n72\n00:03:42.790 --> 00:03:45.399\nAnd that's what this other one is,\nemployees.sql,\n\n73\n00:03:45.399 --> 00:03:46.824\nso let's take a look at that.\n\n74\n00:03:46.824 --> 00:03:48.192\nAnd actually, you know what?\n\n75\n00:03:48.192 --> 00:03:50.157\nI'm going to open it up in vim,\n\n76\n00:03:50.157 --> 00:03:52.670\ncuz it will be, actually I don't\nknow if it will be colorized or not.\n\n77\n00:03:52.670 --> 00:03:55.470\nI don't remember if I installed\nthe full vim on this or not.\n\n78\n00:03:55.470 --> 00:03:56.340\nGood, it's colorized, there.\n\n79\n00:03:56.340 --> 00:03:57.000\n&gt;&gt; Wonderful.\n\n80\n00:03:57.000 --> 00:03:58.550\n&gt;&gt; So when it opens,\n\n81\n00:03:58.550 --> 00:04:01.500\nit's helpful to do this colorized,\ncuz you can actually see what's going on.\n\n82\n00:04:01.500 --> 00:04:05.406\nBut notice that right off the bat,\nit's got SQL commands,\n\n83\n00:04:05.406 --> 00:04:08.621\nit's got Structured Query Language\ncommands.\n\n84\n00:04:08.621 --> 00:04:12.263\nDrop table employees,\nif the employees table already exists,\n\n85\n00:04:12.263 --> 00:04:13.630\nit's gonna delete it.\n\n86\n00:04:13.630 --> 00:04:14.680\nWhy would I do that?\n\n87\n00:04:14.680 --> 00:04:16.790\nBecause right afterwards it's\ngoing to recreate the table and\n\n88\n00:04:16.790 --> 00:04:19.470\nmake sure that it's set the right way.\n\n89\n00:04:19.470 --> 00:04:22.320\nThey're creating it, they're saying,\nwe're gonna create an ID.\n\n90\n00:04:22.320 --> 00:04:25.260\nAnd it's not just an integer,\nit's a medium int,\n\n91\n00:04:25.260 --> 00:04:27.940\nthey've actually modified\nto a different type, right?\n\n92\n00:04:27.940 --> 00:04:31.690\nThen FirstName, LastName, they're\ndoing variable character 255, right?\n\n93\n00:04:31.690 --> 00:04:34.210\nMuch larger than I was\ndefining in the last episode.\n\n94\n00:04:34.210 --> 00:04:37.520\nHey, you might have somebody with a really\nlong last name or really long first name,\n\n95\n00:04:37.520 --> 00:04:39.435\nyou wanna be able to accommodate that.\n\n96\n00:04:39.435 --> 00:04:41.265\nThen we've got the department number,\n\n97\n00:04:41.265 --> 00:04:45.005\nthe primary key is that ID,\nit's set to auto increment.\n\n98\n00:04:45.005 --> 00:04:47.405\nAll those things that we had\nto define by hand last time,\n\n99\n00:04:47.405 --> 00:04:48.535\nthey've already defined for us.\n\n100\n00:04:48.535 --> 00:04:51.805\nThey know the table they want,\nthey know the way it needs to be designed,\n\n101\n00:04:51.805 --> 00:04:53.720\nthey just need us to import it.\n\n102\n00:04:53.720 --> 00:04:57.780\nAnd then right after it\nare insert into commands.\n\n103\n00:04:57.780 --> 00:04:59.850\nAnd look at these insert into commands.\n\n104\n00:04:59.850 --> 00:05:02.070\nThis is one actually,\nI guess, colorized here,\n\n105\n00:05:02.070 --> 00:05:03.770\nit doesn't necessarily help that much.\n\n106\n00:05:03.770 --> 00:05:07.438\nLet me pull this up not colorized.\n\n107\n00:05:07.438 --> 00:05:11.020\nI guess I could've turned off colors\nin vim, but we'll do it this way.\n\n108\n00:05:11.020 --> 00:05:16.100\nSo when I look at all these insert intos,\nsee how it's insert into employees?\n\n109\n00:05:16.100 --> 00:05:19.440\nAnd then FirstName,\nLastName, Department, and\n\n110\n00:05:19.440 --> 00:05:20.900\nthen here's the values that are coming in.\n\n111\n00:05:20.900 --> 00:05:24.532\nSo we've got Willis Later,\nTasha Travis, Aiden Rasmussen.\n\n112\n00:05:24.532 --> 00:05:28.929\nIt's bringing each of these people in, and\nthey're doing more than one insert into,\n\n113\n00:05:28.929 --> 00:05:30.210\nwhy is that?\n\n114\n00:05:30.210 --> 00:05:32.010\nWell, if an error occurs,\n\n115\n00:05:32.010 --> 00:05:36.390\nthe entire insert into gets rolled back,\nso they've broken it up into sections.\n\n116\n00:05:36.390 --> 00:05:40.650\nSo if an error occurs, they can\nidentify exactly which area it was, and\n\n117\n00:05:40.650 --> 00:05:42.118\nthen just fix that smaller piece.\n\n118\n00:05:42.118 --> 00:05:46.050\nIt makes it easier to handle the data,\nmakes it less likely to have errors.\n\n119\n00:05:46.050 --> 00:05:49.340\nYou can actually provide too much data\nsometimes, and the script doesn't process.\n\n120\n00:05:49.340 --> 00:05:52.940\nSo they've broken it up into\nseveral insert into statements.\n\n121\n00:05:52.940 --> 00:05:55.070\nIt looks like they're doing\nabout 10 records for each,\n\n122\n00:05:55.070 --> 00:05:58.850\nand there's a 100 records, so\nthere's 10 insert into statements.\n\n123\n00:05:58.850 --> 00:06:02.120\nAll of this is gonna build the table and\n\n124\n00:06:02.120 --> 00:06:06.520\nimport the data all in one\nhard-to-screw-up script, right?\n\n125\n00:06:06.520 --> 00:06:10.440\nIf they've written it the way that they\nwant it, now I just need to bring it in,\n\n126\n00:06:10.440 --> 00:06:12.080\nthat's why I call it the easy way.\n\n127\n00:06:12.080 --> 00:06:15.250\nIt's not easy for them,\nthey've got to do a lot of work.\n\n128\n00:06:15.250 --> 00:06:17.470\nIt's easy for us as a server admin.\n\n129\n00:06:17.470 --> 00:06:22.519\nAnd if I wanna import this,\nall I have to do is run mysql,\n\n130\n00:06:22.519 --> 00:06:25.760\nso I'm using the MySQL client.\n\n131\n00:06:25.760 --> 00:06:29.027\nRemember, I used mysqlimport\nwhen I imported that CSV,\n\n132\n00:06:29.027 --> 00:06:31.759\nhere I\"m just using\nstraight up MySQL client.\n\n133\n00:06:31.759 --> 00:06:35.403\nRemember with this one,\nI'd normally do something like -u root, or\n\n134\n00:06:35.403 --> 00:06:38.815\nwhatever user account I'm using,\n-p to prompt for a password.\n\n135\n00:06:38.815 --> 00:06:43.862\nAnd when I run that, I jump and I can\nstart working with the system, right?\n\n136\n00:06:43.862 --> 00:06:47.950\nBut what you can do is you can add\na little more to that command.\n\n137\n00:06:47.950 --> 00:06:49.070\nAnd you can say, you know what?\n\n138\n00:06:49.070 --> 00:06:53.040\nLet me do a reverse pipe,\nand a reverse pipe says,\n\n139\n00:06:53.040 --> 00:06:56.560\ninstead of me typing into this,\nI'm gonna be importing from a file.\n\n140\n00:06:56.560 --> 00:07:01.470\nAnd I can import from that\nemployees.sql file, right?\n\n141\n00:07:02.800 --> 00:07:05.710\nAnd so it'll take all the SQL\ncommands in that file and\n\n142\n00:07:05.710 --> 00:07:07.830\njust automatically run them for me.\n\n143\n00:07:07.830 --> 00:07:11.150\nSo when I run that it prompts for\na password, I'll punch that in.\n\n144\n00:07:11.150 --> 00:07:14.580\nAnd when that's done,\nit's gonna go through and do it, oops.\n\n145\n00:07:14.580 --> 00:07:18.070\nI forgot to specify a database,\nwe need to tell it what database, right?\n\n146\n00:07:18.070 --> 00:07:21.170\nWhen I usually run the client,\nI do a use company or whatever.\n\n147\n00:07:21.170 --> 00:07:25.360\nI didn't do that, so after the p,\nI just need to say, company, so\n\n148\n00:07:25.360 --> 00:07:26.860\nit knows where to put the data.\n\n149\n00:07:26.860 --> 00:07:27.650\n&gt;&gt; Right.\n\n150\n00:07:27.650 --> 00:07:29.040\n&gt;&gt; And now I can run it.\n\n151\n00:07:29.040 --> 00:07:33.211\nAnd when I run that,\nit's going to drop the employees table.\n\n152\n00:07:33.211 --> 00:07:37.284\nAnd then it's gonna reload all that data,\nand did you see how fast that was?\n\n153\n00:07:37.284 --> 00:07:39.456\n&gt;&gt; Yeah\n&gt;&gt; It's just done, right?\n\n154\n00:07:39.456 --> 00:07:42.895\nWell, if you have a million rows it\nmight take a little bit longer right?\n\n155\n00:07:42.895 --> 00:07:44.425\n&gt;&gt; [LAUGH]\n&gt;&gt; It's gotta run through all of that.\n\n156\n00:07:44.425 --> 00:07:48.055\nI just had 100, that's not a lot,\nthat's a trivial amount.\n\n157\n00:07:48.055 --> 00:07:49.985\nBut how do I know that it actually worked?\n\n158\n00:07:49.985 --> 00:07:52.095\nI didn't get an error,\nthat counts for something, right?\n\n159\n00:07:52.095 --> 00:07:55.410\nBut let's go and double check our work,\nand make sure that it is good.\n\n160\n00:07:55.410 --> 00:07:58.421\nSo I'm gonna get into the MySQL client.\n\n161\n00:07:58.421 --> 00:08:01.891\nI'll do a use company to\nselect that database.\n\n162\n00:08:01.891 --> 00:08:06.160\nAll right, and then once I'm in there\nI'll just do a show tables right?\n\n163\n00:08:06.160 --> 00:08:10.034\nBecause that script dropped the employees\ntable and then recreated it.\n\n164\n00:08:10.034 --> 00:08:13.830\nSo I should still have\nan employees table and I do.\n\n165\n00:08:13.830 --> 00:08:19.218\nI can do a describe, I think I've\nmisspelled that every time this show.\n\n166\n00:08:19.218 --> 00:08:23.080\n&gt;&gt; [LAUGH]\n&gt;&gt; Describe employees, there we go.\n\n167\n00:08:23.080 --> 00:08:24.592\nAnd I can see, it's defined and\n\n168\n00:08:24.592 --> 00:08:27.114\nit's not defined the way I\ndid it in the last episode.\n\n169\n00:08:27.114 --> 00:08:28.900\nIt's defined the way it was in the script.\n\n170\n00:08:28.900 --> 00:08:31.050\nThere is my id column, it's a medium int.\n\n171\n00:08:31.050 --> 00:08:34.060\nFirstName and\nLastName are variable characters 255 and\n\n172\n00:08:34.060 --> 00:08:35.970\ndepartment is also a medium int.\n\n173\n00:08:35.970 --> 00:08:40.170\nSo those are defined, they're in place\njust like we saw on that script file.\n\n174\n00:08:40.170 --> 00:08:43.851\nAnd if I do a SELECT * FROM employees,\n\n175\n00:08:43.851 --> 00:08:47.998\nand I take a look at it, there's the data.\n\n176\n00:08:47.998 --> 00:08:50.751\nAnd remember, when I imported it\nfrom my CSV in the last episode,\n\n177\n00:08:50.751 --> 00:08:52.340\nI had a stray line at the end.\n\n178\n00:08:52.340 --> 00:08:58.020\nAnd so I had an extra row down here that\nwas a null value, that didn't happen here.\n\n179\n00:08:58.020 --> 00:09:01.908\nBecause the people who wrote the import\nfile weren't dumb like me and\n\n180\n00:09:01.908 --> 00:09:05.500\ndid it the right way [LAUGH] and\nhad it properly formatted.\n\n181\n00:09:05.500 --> 00:09:08.410\nAnd so it again,\nhelps it to avoid the mistake, and\n\n182\n00:09:08.410 --> 00:09:13.310\nnow we get all of that data brought\nright in, and here's our information.\n\n183\n00:09:13.310 --> 00:09:16.570\nThis is a great way for the data\nanalyst to ensure the data is loaded in\n\n184\n00:09:16.570 --> 00:09:19.000\nthe database, the way they intended.\n\n185\n00:09:19.000 --> 00:09:21.840\nSo now they know the data's gonna\nwork the way they want it, and\n\n186\n00:09:21.840 --> 00:09:23.380\nthey can jump in and start using it.\n\n187\n00:09:23.380 --> 00:09:26.080\nAll we're doing is making it\navailable on the server, and\n\n188\n00:09:26.080 --> 00:09:29.360\nnow they are the ones who can actually\nconsume the data and make use of it.\n\n189\n00:09:29.360 --> 00:09:33.474\nSo this is my favorite way, this is the\nway that I prefer people to give me data.\n\n190\n00:09:33.474 --> 00:09:35.792\nAnd when you're dealing with\na professional data house,\n\n191\n00:09:35.792 --> 00:09:37.290\nthis is how they'll give it to you.\n\n192\n00:09:37.290 --> 00:09:39.069\nBut n9 ine times out of 10,\nthis is not how people give me data.\n\n193\n00:09:39.069 --> 00:09:42.630\nIt's normally a CSV, so\nthat's why I tackled that one first.\n\n194\n00:09:42.630 --> 00:09:46.450\nBut this way is a great way to get\ndata in, now's ready to rock and\n\n195\n00:09:46.450 --> 00:09:47.720\nyou're ready to make use of it.\n\n196\n00:09:47.720 --> 00:09:52.290\n&gt;&gt; Awesome, so now that our data\nis loaded, how can we look at it?\n\n197\n00:09:52.290 --> 00:09:56.052\n&gt;&gt; All right, so normally a server\nadmin's job is done at this point, right?\n\n198\n00:09:56.052 --> 00:09:59.200\nWe're done,\nwe turn the work over to other people.\n\n199\n00:09:59.200 --> 00:10:00.331\nBut thanks to the world of DevOps,\n\n200\n00:10:00.331 --> 00:10:02.522\nthere's a lot of times where we\nneed to get a little more involved.\n\n201\n00:10:02.522 --> 00:10:05.550\nAnd I'm not gonna talk about\nhere in our Linux show.\n\n202\n00:10:05.550 --> 00:10:09.454\nBut we do have some other database shows\nin the library that cover things like\n\n203\n00:10:09.454 --> 00:10:11.779\nperformance tuning and database indexing.\n\n204\n00:10:11.779 --> 00:10:14.115\nAnd all sorts of other technologies\nthat are a part of that,\n\n205\n00:10:14.115 --> 00:10:17.450\nthat you may want to take advantage of\nif you really get into that DVA world.\n\n206\n00:10:17.450 --> 00:10:22.419\nBut let me give you a quick tour of how\nqueries work, how common queries run.\n\n207\n00:10:22.419 --> 00:10:24.556\nCuz you might want do\nsome queries yourself,\n\n208\n00:10:24.556 --> 00:10:27.320\njust to be able to see the data and\nsee how it works, right?\n\n209\n00:10:27.320 --> 00:10:28.568\n&gt;&gt; Awesome.\n&gt;&gt; So up until now,\n\n210\n00:10:28.568 --> 00:10:30.411\nevery time I want to view the table,\n\n211\n00:10:30.411 --> 00:10:33.740\nI've been running select\nstar from employees, right?\n\n212\n00:10:33.740 --> 00:10:37.205\nAnd what that does it says SELECT *,\nin other words,\n\n213\n00:10:37.205 --> 00:10:40.835\ngive me every column from\nthe employees table, right?\n\n214\n00:10:40.835 --> 00:10:43.920\nI don't have to do it that way,\nI've just been doing it.\n\n215\n00:10:43.920 --> 00:10:49.940\nI could come through and say,\nfor example, instead of SELECT *,\n\n216\n00:10:49.940 --> 00:10:54.576\nI could say SELECT FirstName,\nLastName, right?\n\n217\n00:10:54.576 --> 00:10:58.960\nDon't give me everything, I don't need\nthe ID number or the department number.\n\n218\n00:10:58.960 --> 00:11:01.281\nI just want FirstName and\nLastName, and when I run it,\n\n219\n00:11:01.281 --> 00:11:02.553\nI get a different set of data.\n\n220\n00:11:02.553 --> 00:11:05.851\nThat's the neat part about a database is\nthat you choose the data that you want\n\n221\n00:11:05.851 --> 00:11:06.528\nrepresented.\n\n222\n00:11:06.528 --> 00:11:11.912\nAnd here, I'm pulling every person,\nevery person's first name and last name.\n\n223\n00:11:11.912 --> 00:11:17.458\nBut I don't have to do that I\ncould come in and I could say,\n\n224\n00:11:17.458 --> 00:11:24.530\nSELECT FirstName and LastName from\nemployees where departments = 4.\n\n225\n00:11:24.530 --> 00:11:26.360\nI just want the sales people, right?\n\n226\n00:11:26.360 --> 00:11:30.740\nThe sales department was department 4, and\nso I want everybody who's a sales person.\n\n227\n00:11:30.740 --> 00:11:36.228\nAnd I have a 100 rows, but\nwhen I run this, I get 33 rows back.\n\n228\n00:11:36.228 --> 00:11:38.770\nThis is only 33 people\nthat are sales people.\n\n229\n00:11:38.770 --> 00:11:41.869\nSo now I'm starting to shrink\nthe amount of data that I get back.\n\n230\n00:11:41.869 --> 00:11:43.984\nNow that's important to understand,\n\n231\n00:11:43.984 --> 00:11:47.578\nbecause from the data consumer side,\nit makes it more efficient.\n\n232\n00:11:47.578 --> 00:11:50.190\nIt's less data for them to sort through.\n\n233\n00:11:50.190 --> 00:11:54.050\nFrom your side on the server,\nthese queries take work, right?\n\n234\n00:11:54.050 --> 00:11:57.414\nYour sever's having to load this table\ninto RAM, it's having to filter it down to\n\n235\n00:11:57.414 --> 00:12:00.121\nget the data that people want and\nthen it's gotta hand it to them.\n\n236\n00:12:00.121 --> 00:12:03.711\nSo there's page scans going on,\nthere's Heap lookups.\n\n237\n00:12:03.711 --> 00:12:07.990\nThere's all sorts of stuff that goes on\nin the backend that impact performance.\n\n238\n00:12:07.990 --> 00:12:11.730\nThe more crazy a query gets,\nthe more CPU load it consumes.\n\n239\n00:12:11.730 --> 00:12:14.336\nThe more RAM it consumes as it\nstores virtual tables to work with.\n\n240\n00:12:14.336 --> 00:12:16.739\nSo the heavier a burden\nyou place on the server,\n\n241\n00:12:16.739 --> 00:12:18.970\nthe more beefy a server you're gonna need.\n\n242\n00:12:18.970 --> 00:12:23.299\nSo performance tuning on a server like\nthis is really important DiskIO is a big\n\n243\n00:12:23.299 --> 00:12:24.370\ndeal, right?\n\n244\n00:12:24.370 --> 00:12:27.302\nThe bigger your data set is the more\nlikely it's not gonna be in RAM,\n\n245\n00:12:27.302 --> 00:12:28.339\nit's gonna be on disk.\n\n246\n00:12:28.339 --> 00:12:32.039\nSo you gotta have your disk tuned to be\nable to perform these reads very quickly.\n\n247\n00:12:32.039 --> 00:12:35.248\nAnd RAM, you can never have too\nmuch RAM in a database server.\n\n248\n00:12:35.248 --> 00:12:38.953\nYou wanna have as much RAM as possible\nbecause when you start swapping a disk,\n\n249\n00:12:38.953 --> 00:12:40.615\nit really slows down the queries.\n\n250\n00:12:40.615 --> 00:12:43.228\nSo we've gotta always pay attention to\nthe RAM on our database servers and\n\n251\n00:12:43.228 --> 00:12:44.466\nmake sure we're not running out.\n\n252\n00:12:44.466 --> 00:12:48.553\nBut this query here, even this isn't\nreally as advanced as we can get.\n\n253\n00:12:48.553 --> 00:12:52.967\nWe can do a heck of a lot more,\nyou can do wildcards and things.\n\n254\n00:12:52.967 --> 00:12:54.741\nHere I'm saying, SELECT FirstName and\n\n255\n00:12:54.741 --> 00:12:56.967\nLastName from employees\nWHERE department=4.\n\n256\n00:12:56.967 --> 00:13:04.296\nI could go and say something like,\nWHERE LastName is LIKE,\n\n257\n00:13:04.296 --> 00:13:09.439\nand then I can specify a value, like S%.\n\n258\n00:13:09.439 --> 00:13:10.807\nOkay, so what is that?\n\n259\n00:13:11.850 --> 00:13:13.480\nS is a capital S, right?\n\n260\n00:13:13.480 --> 00:13:16.484\nAnd then % is a wildcard,\n% means anything.\n\n261\n00:13:16.484 --> 00:13:19.079\nSo what this line actually says is,\n\n262\n00:13:19.079 --> 00:13:23.840\ngive me everybody where their\nLastName starts with an S, right?\n\n263\n00:13:23.840 --> 00:13:28.213\nSo if your LastName starts with an S,\nI wanna get your FirstName and LastName,\n\n264\n00:13:28.213 --> 00:13:30.544\nthat's the query that is being written.\n\n265\n00:13:30.544 --> 00:13:35.281\nSo now the database server has to read\nthrough all hundred records to figure out\n\n266\n00:13:35.281 --> 00:13:37.890\nwhose LastName starts with an S.\n\n267\n00:13:37.890 --> 00:13:41.589\nAnd then provide the data to me, so\nthe server does a lot more work than I do.\n\n268\n00:13:41.589 --> 00:13:44.519\nBecause I'm just receiving\na smaller set of data, and\n\n269\n00:13:44.519 --> 00:13:49.117\nwhen I get back there's only 14 employees\nwhose last name starts with an S, right?\n\n270\n00:13:49.117 --> 00:13:52.685\nThe server did that filter and\nthen gave it over to me.\n\n271\n00:13:53.865 --> 00:13:57.263\nAnd we see that even more when we\nstart doing things like alphabetizing\n\n272\n00:13:57.263 --> 00:13:58.193\nthe data, right?\n\n273\n00:13:58.193 --> 00:14:00.781\nThese LastNames,\nthey're not alphabetized, right?\n\n274\n00:14:00.781 --> 00:14:02.867\nSo I might wanna add just\na little more to this,\n\n275\n00:14:02.867 --> 00:14:04.940\njust see how long I can make this line.\n\n276\n00:14:04.940 --> 00:14:10.290\nAnd I'll say ORDER BY LastName, okay?\n\n277\n00:14:10.290 --> 00:14:15.360\nAnd now I'm telling it, hey, give me\nthis data and alphabetize it for me.\n\n278\n00:14:15.360 --> 00:14:17.548\nSo now the server has to\nread the entire table,\n\n279\n00:14:17.548 --> 00:14:19.303\nfind everybody whose last name is S.\n\n280\n00:14:19.303 --> 00:14:22.340\nBuild a temporary table,\nsort them alphabetically and\n\n281\n00:14:22.340 --> 00:14:24.950\nthen provide that temporary table to me.\n\n282\n00:14:24.950 --> 00:14:28.200\nAnd so\nwhen I run that now I get the results, but\n\n283\n00:14:28.200 --> 00:14:31.780\nthe LastNames are all nice and\nalphabetized for me and they're in order.\n\n284\n00:14:32.850 --> 00:14:35.462\nSo that's kind of a nice\nthing that you can do.\n\n285\n00:14:35.462 --> 00:14:41.230\nThere's other stuff like I could, let's\ngo back to a SELECT * FROM employees.\n\n286\n00:14:41.230 --> 00:14:44.040\nI'm gonna pull all my employees again,\nright?\n\n287\n00:14:44.040 --> 00:14:48.431\nAnd this time I'm gonna do\na GROUP by department, right?\n\n288\n00:14:48.431 --> 00:14:49.720\nSo give me the data, and\n\n289\n00:14:49.720 --> 00:14:54.250\nI know I've got 4 departments, group\nthe people together by those departments.\n\n290\n00:14:54.250 --> 00:14:58.990\nAnd so when I run that, I get information\nback and see how it's being presented?\n\n291\n00:14:58.990 --> 00:15:00.961\nI've only got 4 users.\n\n292\n00:15:00.961 --> 00:15:03.180\nI've got more than 4 users, don't I?\n\n293\n00:15:03.180 --> 00:15:05.510\nI do, but\nI told it to group them by departments.\n\n294\n00:15:05.510 --> 00:15:08.258\nSo they just pulled the first\nperson in department 1,\n\n295\n00:15:08.258 --> 00:15:12.140\nthe first person in department 2,\nthe first person in department 3, and so\n\n296\n00:15:12.140 --> 00:15:14.613\non, and\nput them together into this list for me.\n\n297\n00:15:14.613 --> 00:15:18.997\nThese are again examples of what we can\ndo on the server to collect this data and\n\n298\n00:15:18.997 --> 00:15:22.020\npresent it to the user\nin a different format.\n\n299\n00:15:22.020 --> 00:15:24.996\nAnd all of it equates to\na lot of work on the server.\n\n300\n00:15:24.996 --> 00:15:27.870\nWhat we're effectively doing is\nasking the server a question.\n\n301\n00:15:27.870 --> 00:15:29.215\nNow I'm saying, hey,\ncould you do me a favor?\n\n302\n00:15:29.215 --> 00:15:32.135\nJust give me a list of all the employees\nwhose last name starts with S.\n\n303\n00:15:32.135 --> 00:15:34.703\nAnd then the server on the back end says,\n[SOUND].\n\n304\n00:15:34.703 --> 00:15:36.850\n[LAUGH]\n&gt;&gt; [LAUGH] With a sigh,\n\n305\n00:15:36.850 --> 00:15:38.945\nit definitely will do that.\n\n306\n00:15:38.945 --> 00:15:40.399\n&gt;&gt; I have my work cut out for me, right?\n\n307\n00:15:40.399 --> 00:15:43.115\nMaybe there's and index that can\nspeed it up or something, but\n\n308\n00:15:43.115 --> 00:15:45.650\notherwise it's gotta read\nthrough all the data.\n\n309\n00:15:45.650 --> 00:15:47.290\nIt's gotta find everybody\nwho just has a S,\n\n310\n00:15:47.290 --> 00:15:49.650\nit's gotta do all this work to\nthen give me the answer back.\n\n311\n00:15:49.650 --> 00:15:52.790\nSo all we see is question and\nan answer, right?\n\n312\n00:15:52.790 --> 00:15:56.089\nBut the database actually does\na lot of work on the backend.\n\n313\n00:15:56.089 --> 00:15:59.917\nSo those are some examples right there\nof ways that I can reach in and,\n\n314\n00:15:59.917 --> 00:16:02.303\nGet data out of the database and\nlook at it.\n\n315\n00:16:02.303 --> 00:16:05.984\nAnd this is useful for\na server admin to know.\n\n316\n00:16:05.984 --> 00:16:07.961\nBecause you might wanna just poke\nthrough the data a little bit,\n\n317\n00:16:07.961 --> 00:16:09.142\njust to make sure that it's working.\n\n318\n00:16:09.142 --> 00:16:12.215\nTo make sure that I could run a query and\nit doesn't take half an hour, right?\n\n319\n00:16:12.215 --> 00:16:13.357\nTo be able to look at that and\n\n320\n00:16:13.357 --> 00:16:16.163\nstart to get an understanding of\nwhat's going on in that back end.\n\n321\n00:16:16.163 --> 00:16:17.300\n&gt;&gt; That's a great way to look at the data.\n\n322\n00:16:17.300 --> 00:16:23.207\nBut what if we wanna change the data,\nDon, we can certainly do that.\n\n323\n00:16:23.207 --> 00:16:26.300\nFor example,\nwe'll take Samuel Samuel Fowler.\n\n324\n00:16:26.300 --> 00:16:27.464\nI should pick somebody\nwith an easier name.\n\n325\n00:16:27.464 --> 00:16:30.515\n&gt;&gt; [LAUGH]\n&gt;&gt; So Samuel Fowler, he's ID number 8,\n\n326\n00:16:30.515 --> 00:16:31.050\nright?\n\n327\n00:16:31.050 --> 00:16:37.854\nSo if I did a select * from\nemployees where ID = 8,\n\n328\n00:16:37.854 --> 00:16:42.619\nthat's basically Samuel Fowler.\n\n329\n00:16:42.619 --> 00:16:45.720\nSo when I run that,\nI get his record back, and there it is.\n\n330\n00:16:45.720 --> 00:16:48.184\nSo what if Samuel transfers?\n\n331\n00:16:48.184 --> 00:16:52.314\nHe's in department one, right now, which I\ncan't remember, that might be accounting.\n\n332\n00:16:52.314 --> 00:16:53.877\nWell, I guess we could find out.\n\n333\n00:16:53.877 --> 00:17:02.502\nWe could say select name from\ndepartments where ID equals 1.\n\n334\n00:17:02.502 --> 00:17:05.750\nSo, what department is Samuel in?\n\n335\n00:17:05.750 --> 00:17:06.950\nHe's in Accounting, right?\n\n336\n00:17:06.950 --> 00:17:09.130\nWell, he's so good with numbers and money,\n\n337\n00:17:09.130 --> 00:17:10.970\nthat I'm going to move him\nto the Sales Department.\n\n338\n00:17:10.970 --> 00:17:12.660\nSo, I want to move him over to Sales.\n\n339\n00:17:12.660 --> 00:17:15.590\nWell, which department is Sales?\n\n340\n00:17:15.590 --> 00:17:20.420\nSo, I might want to select\nid from departments\n\n341\n00:17:20.420 --> 00:17:25.090\nwhere name equals sales.\n\n342\n00:17:25.090 --> 00:17:26.820\nAlright, sales is department four.\n\n343\n00:17:26.820 --> 00:17:32.800\nI want to change Samuel,\nwhose ID is eight, into department four.\n\n344\n00:17:32.800 --> 00:17:37.680\nSo I could come in and\nsay update employees,\n\n345\n00:17:37.680 --> 00:17:41.450\nwhich is the employees table, so\nI am modifying the employees table.\n\n346\n00:17:41.450 --> 00:17:46.250\nAnd I'm going to set\ndepartment equals four,\n\n347\n00:17:46.250 --> 00:17:50.110\nall right so I'm going to change\nthe department over to four.\n\n348\n00:17:50.110 --> 00:17:52.750\nActually, I think I need to put\nthat in a single tic, there we go.\n\n349\n00:17:52.750 --> 00:17:59.040\nSo I'm going to set the department\nto four, where id equals 8.\n\n350\n00:17:59.040 --> 00:18:03.650\nI'm saying find ID number 8,\nwhich is Samuel Fowler.\n\n351\n00:18:03.650 --> 00:18:07.580\nAnd when you find him,\nchange his department to 4, right?\n\n352\n00:18:07.580 --> 00:18:09.200\nI'm updating that record.\n\n353\n00:18:09.200 --> 00:18:12.650\nWe saw insert in the last episode,\nthat was how we add new records.\n\n354\n00:18:12.650 --> 00:18:15.370\nOr actually we saw it in this episode,\nit was in that SQL script.\n\n355\n00:18:15.370 --> 00:18:17.210\nUpdate is how we change a record.\n\n356\n00:18:17.210 --> 00:18:18.730\nAnd when I run that, oops.\n\n357\n00:18:18.730 --> 00:18:20.270\nI forgot my semicolon.\n\n358\n00:18:20.270 --> 00:18:22.970\nIf you don't do a semicolon\nat the end of the line,\n\n359\n00:18:22.970 --> 00:18:24.670\nit assumes you have more to type, right?\n\n360\n00:18:24.670 --> 00:18:26.420\nAnd so it's giving me\nthe chance to continue typing.\n\n361\n00:18:26.420 --> 00:18:29.570\nI just press semicolon, so\nI'll just type a semicolon.\n\n362\n00:18:29.570 --> 00:18:30.680\nThat'll end the command.\n\n363\n00:18:30.680 --> 00:18:33.630\nAnd there we go it matched one row,\nit changed one row.\n\n364\n00:18:33.630 --> 00:18:37.970\nI can now select again and\npull Samuel's record and\n\n365\n00:18:37.970 --> 00:18:39.920\nnow he's in department four, right?\n\n366\n00:18:39.920 --> 00:18:43.070\nI just modified that one row,\nI didn't modify the whole table,\n\n367\n00:18:43.070 --> 00:18:43.910\nI didn't dump all the data.\n\n368\n00:18:43.910 --> 00:18:46.410\nI just go in, I change that one record.\n\n369\n00:18:46.410 --> 00:18:48.500\nAnd I used all SQL queries to do it,\n\n370\n00:18:48.500 --> 00:18:51.860\nto figure out where was Samuel Fowler,\nwhat department he was in.\n\n371\n00:18:51.860 --> 00:18:55.350\nWhat the name of the department was, what\nthe id for the new department was, and\n\n372\n00:18:55.350 --> 00:18:58.020\nthen to reassign it,\nall done With queries right here.\n\n373\n00:18:58.020 --> 00:19:00.720\nIf you know the commands it's\nreally easy to work with the data.\n\n374\n00:19:00.720 --> 00:19:02.321\nIt's just different commands\nthat we have to look.\n\n375\n00:19:02.321 --> 00:19:05.256\n&gt;&gt; Well Mr. Fowler,\nwill be very appreciative, I'm sure.\n\n376\n00:19:05.256 --> 00:19:08.770\nBut queries can get a lot more\ncomplex than that, right?\n\n377\n00:19:08.770 --> 00:19:09.980\n&gt;&gt; Yeah.\n&gt;&gt; Yeah.\n\n378\n00:19:09.980 --> 00:19:14.440\n&gt;&gt; What I'm showing you here is probably\nalready beyond what a normal server\n\n379\n00:19:14.440 --> 00:19:15.520\nadmin would need.\n\n380\n00:19:15.520 --> 00:19:18.430\nBut let me give you just one\nlast example to kinda sit on.\n\n381\n00:19:18.430 --> 00:19:21.754\nThe next time you make fun of a DBA,\n&gt;&gt; [LAUGH]\n\n382\n00:19:21.754 --> 00:19:22.804\n&gt;&gt; Understand that their job is\n\n383\n00:19:22.804 --> 00:19:23.600\nreally difficult.\n\n384\n00:19:23.600 --> 00:19:26.380\nAnd the queries they write\ncan be really advanced.\n\n385\n00:19:26.380 --> 00:19:32.379\nSo for example, right now if I\ndo a select star from employees.\n\n386\n00:19:33.630 --> 00:19:38.430\nRight I get all my employees back,\nand the department is just a number.\n\n387\n00:19:38.430 --> 00:19:40.110\nAnd I know I've got another table.\n\n388\n00:19:40.110 --> 00:19:43.420\nI know I've got the department's table.\n\n389\n00:19:44.950 --> 00:19:47.400\nAnd if I look at it,\nit matches the number to a name.\n\n390\n00:19:47.400 --> 00:19:50.210\nBut wouldn't it be nice to get\na copy of this table where it had\n\n391\n00:19:50.210 --> 00:19:52.620\nthe name of the department\nthere instead of the number?\n\n392\n00:19:52.620 --> 00:19:54.165\nThat would be nice.\n\n393\n00:19:54.165 --> 00:19:56.620\nI could actually do what's\ncalled a join query.\n\n394\n00:19:56.620 --> 00:19:59.780\nA join query is where I\npull data from one table.\n\n395\n00:19:59.780 --> 00:20:01.840\nI pull data from another table, and\n\n396\n00:20:01.840 --> 00:20:05.090\nI combine it to create one super table,\nright?\n\n397\n00:20:05.090 --> 00:20:08.700\nAnd this is where the whole relational\npart of a relational database\n\n398\n00:20:08.700 --> 00:20:09.860\nbecomes important.\n\n399\n00:20:09.860 --> 00:20:14.210\nThis number here, this department\nnumber in the employees table,\n\n400\n00:20:14.210 --> 00:20:20.340\nMatches an id number here\nin the departments table.\n\n401\n00:20:20.340 --> 00:20:25.340\nI can correlate those and match\nthe department name, and that way I can\n\n402\n00:20:25.340 --> 00:20:30.910\npull this data together and provide\nyou with that superset Of data, okay?\n\n403\n00:20:30.910 --> 00:20:33.330\nSo if I wanna do that, I can go through.\n\n404\n00:20:33.330 --> 00:20:35.340\nI do have to be careful with\ncertain comparisons here.\n\n405\n00:20:35.340 --> 00:20:36.670\nAnd actually, I might run into a problem.\n\n406\n00:20:38.030 --> 00:20:43.440\nThe department number that I defined\nhere is a medium ent, right?\n\n407\n00:20:43.440 --> 00:20:45.460\nI think it was a medium ent 9.\n\n408\n00:20:45.460 --> 00:20:50.630\nAnd when I defined this guy down here,\nI just defined it as a regular integer.\n\n409\n00:20:50.630 --> 00:20:51.880\nSo I might get a type mismatch.\n\n410\n00:20:51.880 --> 00:20:53.710\nWhat we'll see,\nthey're both integers though.\n\n411\n00:20:53.710 --> 00:20:55.580\nI think it will be fine with\nit at the end of the day.\n\n412\n00:20:55.580 --> 00:20:56.210\nSo we'll give it a shot.\n\n413\n00:20:56.210 --> 00:20:57.480\nBut when you're correlating data,\n\n414\n00:20:57.480 --> 00:20:59.720\nit's usually important to\nhave the types be the same.\n\n415\n00:20:59.720 --> 00:21:01.800\nAnd there's a way to convert\ndata types and stuff on the fly.\n\n416\n00:21:01.800 --> 00:21:06.120\nIt's not efficient, but let me just show\nyou how we can join that stuff together.\n\n417\n00:21:06.120 --> 00:21:07.414\nI could say select.\n\n418\n00:21:07.414 --> 00:21:08.600\nAnd I'm going to pull employees.firstname.\n\n419\n00:21:08.600 --> 00:21:11.419\nAnd I'm going to pull\n\n420\n00:21:11.419 --> 00:21:20.670\nemployees.lastname.\n\n421\n00:21:20.670 --> 00:21:21.750\nAnd notice how I'm writing this.\n\n422\n00:21:21.750 --> 00:21:23.160\nBefore, I would always say first name and\n\n423\n00:21:23.160 --> 00:21:25.180\nlast name because I would\nsay from one table.\n\n424\n00:21:25.180 --> 00:21:28.010\nBut I'm going to have to pull\ndata from two different tables.\n\n425\n00:21:28.010 --> 00:21:32.470\nAnd since I'm pulling from two tables\nI have to specify the table name, and\n\n426\n00:21:32.470 --> 00:21:34.450\na dot, and then the column name.\n\n427\n00:21:34.450 --> 00:21:36.760\nSo it knows which table\nthis data is coming from.\n\n428\n00:21:36.760 --> 00:21:40.490\nSo I'm gonna pull the first name and\nlast name from the employees table.\n\n429\n00:21:40.490 --> 00:21:44.190\nAnd I will then pull departments.name.\n\n430\n00:21:44.190 --> 00:21:47.690\nI don't want to get the department\n\n431\n00:21:47.690 --> 00:21:50.380\nfrom the employees table\ncuz it's just a number.\n\n432\n00:21:50.380 --> 00:21:53.390\nI wanna get the department from the\ndepartments table because it's actually\n\n433\n00:21:53.390 --> 00:21:54.870\ngot the name.\n\n434\n00:21:54.870 --> 00:21:57.140\nSo I'm gonna get first name and\nlast name from the employees and\n\n435\n00:21:57.140 --> 00:22:00.120\nthen I'll get the department\nname from the departments table.\n\n436\n00:22:00.120 --> 00:22:04.800\nNow the challenge here is the departments\ntable only has four entries in it\n\n437\n00:22:04.800 --> 00:22:06.440\nversus the employees that has 100 entries.\n\n438\n00:22:06.440 --> 00:22:08.510\nSo it's gotta be able to\nmatch this stuff up, and\n\n439\n00:22:08.510 --> 00:22:10.010\nthis is where things get a little weird.\n\n440\n00:22:10.010 --> 00:22:13.300\nI'm gonna say that I'm pulling\nfrom the employee's table\n\n441\n00:22:13.300 --> 00:22:14.780\ncuz that's where the bulk of my data is.\n\n442\n00:22:15.830 --> 00:22:18.880\nBut then I need to say join.\n\n443\n00:22:18.880 --> 00:22:22.360\nI'm gonna join the data\ntogether with this other table.\n\n444\n00:22:22.360 --> 00:22:24.860\nAnd I'll say I'm gonna join departments.\n\n445\n00:22:24.860 --> 00:22:30.180\nThat's my second table that I'm gonna be\npulling from and I'm gonna do this On, and\n\n446\n00:22:30.180 --> 00:22:32.120\nnow I need to tell it\nwhere the relationship is.\n\n447\n00:22:32.120 --> 00:22:33.580\nWhat ties these two together?\n\n448\n00:22:33.580 --> 00:22:38.070\nAnd I'm gonna say that\nemployees.department,\n\n449\n00:22:38.070 --> 00:22:41.770\nright, that column, the department\ncolumn which just has numbers,\n\n450\n00:22:41.770 --> 00:22:47.220\nequals departments.id, right,\nthe primary key for that department.\n\n451\n00:22:47.220 --> 00:22:50.550\nSo I'm saying that this column here\n\n452\n00:22:50.550 --> 00:22:55.090\nIs equal to this column over\nhere in the other table.\n\n453\n00:22:55.090 --> 00:22:57.350\nThey're related together, right?\n\n454\n00:22:57.350 --> 00:23:02.410\nAnd by doing that, that's going to tell\nit how to combine these together and\n\n455\n00:23:02.410 --> 00:23:04.630\ncreate the super table that I want.\n\n456\n00:23:04.630 --> 00:23:11.700\nAnd when I run that, now I get this\nnice list of all of my employees.\n\n457\n00:23:11.700 --> 00:23:14.280\nAnd it did the join.\n\n458\n00:23:14.280 --> 00:23:18.080\nI can see each of them, and it's actually\nsorted by the join there because of\n\n459\n00:23:18.080 --> 00:23:19.890\nthe order of the departments table.\n\n460\n00:23:19.890 --> 00:23:23.600\nIt's only alphabetized because I created\nit that way in the departments table.\n\n461\n00:23:23.600 --> 00:23:26.610\nWe could sort it if we wanted,\nsort by last name or whatever.\n\n462\n00:23:26.610 --> 00:23:30.620\nAnd by doing this, it's now created\na table that doesn't exist.\n\n463\n00:23:30.620 --> 00:23:32.890\nThis isn't a table that\nexists in the database.\n\n464\n00:23:32.890 --> 00:23:35.790\nThis is a table that was created just for\nme.\n\n465\n00:23:35.790 --> 00:23:38.480\nThat has exactly the information\nthat I want, first name,\n\n466\n00:23:38.480 --> 00:23:40.740\nlast name and\nthe name of the department they're in.\n\n467\n00:23:40.740 --> 00:23:42.090\nNo cryptic information here.\n\n468\n00:23:42.090 --> 00:23:44.700\nI know exactly what I see and\nI can work with it.\n\n469\n00:23:44.700 --> 00:23:48.090\nThat's the power of these databases and\nthat's why they're used so\n\n470\n00:23:48.090 --> 00:23:49.930\nfrequently in businesses today.\n\n471\n00:23:49.930 --> 00:23:52.834\nAnd really you couldn't\nhave sites like Amazon.com,\n\n472\n00:23:52.834 --> 00:23:55.005\nlike, heck you couldn't have ITProTV.\n\n473\n00:23:55.005 --> 00:23:58.490\nOur stuff is all driven off a database\nthat when you come to our course library\n\n474\n00:23:58.490 --> 00:24:01.680\nand see our course list,\nthat's all being pulled from a database.\n\n475\n00:24:01.680 --> 00:24:04.780\nThat's what's driving all\nthe technology we use today.\n\n476\n00:24:04.780 --> 00:24:07.090\nThis stuff is super important and\n\n477\n00:24:07.090 --> 00:24:09.840\nI want to make sure you guys had\na chance to get your feet wet.\n\n478\n00:24:09.840 --> 00:24:12.650\nAnd get a change to be exposed to\nwhat's going on behind the scenes,\n\n479\n00:24:12.650 --> 00:24:14.800\ncuz it's really neat stuff,\nI enjoy working with it.\n\n480\n00:24:14.800 --> 00:24:18.220\nBut it also benefits you as a server\nadministrator to better understand\n\n481\n00:24:18.220 --> 00:24:19.800\nwhat's going on behind the scenes.\n\n482\n00:24:19.800 --> 00:24:21.170\n&gt;&gt; Awesome information Don,\n\n483\n00:24:21.170 --> 00:24:25.140\nand working with the data,\nanything else you'd like to add?\n\n484\n00:24:25.140 --> 00:24:29.520\nBeing a database administrator is\na whole field in and of itself.\n\n485\n00:24:29.520 --> 00:24:32.010\nIt's a lot of fun,\nthere's a lot of really cool stuff there.\n\n486\n00:24:32.010 --> 00:24:35.420\nThere's always new things coming out,\nso definitely jump in and learn it.\n\n487\n00:24:35.420 --> 00:24:39.540\nWe focused on MariaDB and MySQL because\nthey're the most common in the Linux world\n\n488\n00:24:39.540 --> 00:24:40.970\nand this is a Linux series.\n\n489\n00:24:40.970 --> 00:24:44.360\nBut there is PostgreSQL,\nit's another database that's very popular,\n\n490\n00:24:44.360 --> 00:24:47.230\nalso a relational database that uses SQL.\n\n491\n00:24:47.230 --> 00:24:49.510\nThere are other database\nservers out there,\n\n492\n00:24:49.510 --> 00:24:52.630\nwhat I just showed you,\nwill work on pretty much all of them.\n\n493\n00:24:52.630 --> 00:24:55.611\nAnybody that follows the SQL,\nthe structured query language,\n\n494\n00:24:55.611 --> 00:24:58.713\ncan do everything that we did in\nthis episode and the last episode.\n\n495\n00:24:58.713 --> 00:25:03.045\nBut there are other ones that\nare even more different, right?\n\n496\n00:25:03.045 --> 00:25:07.715\nThe NoSQL databases and other things like\nthat that use a different language in and\n\n497\n00:25:07.715 --> 00:25:08.265\nof themselves.\n\n498\n00:25:08.265 --> 00:25:10.465\nSo be careful there,\nthere are some different ones.\n\n499\n00:25:10.465 --> 00:25:13.980\nBut from what we just saw, we'll apply\nthe majority Database server's on.\n\n500\n00:25:13.980 --> 00:25:16.070\n&gt;&gt; Awesome so\nonce again working with data part two.\n\n501\n00:25:16.070 --> 00:25:18.420\nThere is a part one,\nmake sure you watch both of them.\n\n502\n00:25:18.420 --> 00:25:20.190\nYou'll be very glad that you did.\n\n503\n00:25:20.190 --> 00:25:23.450\nAnd there's a lot of episodes in\nthe series of becoming a Linux server\n\n504\n00:25:23.450 --> 00:25:24.310\nadministrator.\n\n505\n00:25:24.310 --> 00:25:27.200\nMake sure you watch all of them,\nyou'll be happy that you did.\n\n506\n00:25:27.200 --> 00:25:29.460\nAnd thank you for watching ITProTV.\n\n507\n00:25:29.460 --> 00:25:31.410\nRemember a good IT pro is always learning.\n\n508\n00:25:31.410 --> 00:25:32.480\nI'm Zach Memos.\n\n509\n00:25:32.480 --> 00:25:33.300\n&gt;&gt; And I'm Don Pezet.\n\n510\n00:25:33.300 --> 00:25:35.582\n&gt;&gt; And we will see you soon.\n\n511\n00:25:35.582 --> 00:25:38.710\n[MUSIC]\n\n512\n00:25:38.710 --> 00:25:45.084\n&gt;&gt; Thank you for watching ITPro.TV.\n\n",
          "vimeoId": "229134584"
        }
      ],
      "title": "Configuring a MariaDB Database Server"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach cover what is needed to get Samba installed, installing Samba, configuration files, configuring Samba, using 'Testparm' to verify config file, starting/stopping Samba Daemon (SMBD), starting/stopping NetBIOS Name Server (NMBD), and allowing access through the firewall.",
          "length": "1966",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-8-1-1-installing_samba-080917.00_32_32_14.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-8-1-1-installing_samba-080917.00_32_32_14.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-8-1-1-installing_samba-080917.00_32_32_14.Still001-sm.jpg",
          "title": "Installing Samba",
          "transcript": "WEBVTT\n\n1\n00:00:00.260 --> 00:00:02.920\nWelcome to ITProTV,\nI'm your host Don Pezet.\n\n2\n00:00:02.920 --> 00:00:06.131\nWe're coming at you live from\nSan Francisco, California.\n\n3\n00:00:06.131 --> 00:00:06.715\n[CROSSTALK]\n\n4\n00:00:06.715 --> 00:00:08.214\n[MUSIC]\n\n5\n00:00:08.214 --> 00:00:12.177\n&gt;&gt; You're watching ITProTV.\n\n6\n00:00:12.177 --> 00:00:16.680\n&gt;&gt; Thank you for choosing ITProTV where\nwe help you learn wherever you go.\n\n7\n00:00:16.680 --> 00:00:17.460\nI'm Zach Memos.\n\n8\n00:00:17.460 --> 00:00:21.590\nAs we continue on with becoming\na Linux server administrator.\n\n9\n00:00:21.590 --> 00:00:24.080\nWe're gonna be doing\nsomething fun right now.\n\n10\n00:00:24.080 --> 00:00:26.087\nIt's installing Samba.\n\n11\n00:00:26.087 --> 00:00:27.860\nOoh, Samba, what's that all about?\n\n12\n00:00:27.860 --> 00:00:30.790\nWell, Don Pezet's gonna bring us\nall the information fit to print.\n\n13\n00:00:30.790 --> 00:00:32.363\nHey Don, good to see you again.\n\n14\n00:00:32.363 --> 00:00:33.430\n&gt;&gt; Yeah, glad to be back.\n\n15\n00:00:33.430 --> 00:00:36.160\nAnd don't worry,\nthere will be no dancing in this episode-\n\n16\n00:00:36.160 --> 00:00:37.110\n&gt;&gt; But it'd be wonderful!\n\n17\n00:00:37.110 --> 00:00:38.845\n[LAUGH]\n&gt;&gt; Dancing with the IT stars.\n\n18\n00:00:38.845 --> 00:00:39.962\n&gt;&gt; [LAUGH]\n&gt;&gt; So,\n\n19\n00:00:39.962 --> 00:00:44.180\nwe're gonna be taking a look at Samba\nwhich, if you're not familiar with it,\n\n20\n00:00:44.180 --> 00:00:48.940\nit's a play on words, or, I don't know,\neuphemism, whatever, for SMB.\n\n21\n00:00:48.940 --> 00:00:50.420\nSMB is Server Message Block,\n\n22\n00:00:50.420 --> 00:00:53.680\nthat's the file sharing protocol\nthat's used by Microsoft servers.\n\n23\n00:00:53.680 --> 00:00:56.430\nSo, if you have Windows as a workstation\nor Windows as a server and\n\n24\n00:00:56.430 --> 00:00:59.110\nyou share a folder, it's using SMB.\n\n25\n00:00:59.110 --> 00:01:03.470\nWell, in the Linux world, we want our\nsystems to be able to communicate with\n\n26\n00:01:03.470 --> 00:01:05.540\nother platforms, mostly Microsoft.\n\n27\n00:01:05.540 --> 00:01:09.670\nAnd so we can use an open-source\nkind of spin off, where they\n\n28\n00:01:09.670 --> 00:01:14.570\neffectively kind of reverse-engineered\na lot of what SMB does, and created Samba.\n\n29\n00:01:14.570 --> 00:01:18.370\nSo Samba is an open-source SMB server\nthat we can run on top of Linux.\n\n30\n00:01:18.370 --> 00:01:21.740\nAnd as a server I admit you'll\nfrequently be asked to set this up where\n\n31\n00:01:21.740 --> 00:01:24.430\nyou use a Linux server\nas your final server.\n\n32\n00:01:24.430 --> 00:01:26.570\nBut then you have Windows clients\nwho are connecting to it.\n\n33\n00:01:26.570 --> 00:01:28.810\nSo in this episode we're\ngonna see how to set that up,\n\n34\n00:01:28.810 --> 00:01:31.080\nget it put in place and\nstart using your network.\n\n35\n00:01:31.080 --> 00:01:34.270\n&gt;&gt; So Don, what do we need to\ndo to get Samba installed?\n\n36\n00:01:34.270 --> 00:01:39.560\nWell, it's open source and it is packaged\nwith just about every distro out there.\n\n37\n00:01:39.560 --> 00:01:44.200\nIn fact, a lot of distros will have\nthe Samba client installed by default, but\n\n38\n00:01:44.200 --> 00:01:45.680\nnot the Samba server.\n\n39\n00:01:45.680 --> 00:01:47.300\nAnd we're focused on\nthe server in this episode.\n\n40\n00:01:47.300 --> 00:01:49.750\nSo I wanna make sure\nwe get that installed.\n\n41\n00:01:49.750 --> 00:01:55.510\nThe first thing I need to decide, is how\nall in I wanna go with Samba, right?\n\n42\n00:01:55.510 --> 00:01:56.630\nBecause there's the different levels.\n\n43\n00:01:56.630 --> 00:01:58.081\nThere's being a Samba client, right?\n\n44\n00:01:58.081 --> 00:02:01.396\nI might have a Windows server, and I just\nhave a Linux box that I wanna connect to\n\n45\n00:02:01.396 --> 00:02:03.460\na file share, I can use the Samba client.\n\n46\n00:02:03.460 --> 00:02:05.380\nIt's installed by default\nwith most distros, so\n\n47\n00:02:05.380 --> 00:02:06.470\nyou're just kind of ready to go.\n\n48\n00:02:06.470 --> 00:02:07.420\n&gt;&gt; Right.\n\n49\n00:02:07.420 --> 00:02:10.600\n&gt;&gt; Or I can be a Samba server,\nwhere I'm sharing folders and\n\n50\n00:02:10.600 --> 00:02:12.380\nWindows clients can connect and\naccess them.\n\n51\n00:02:12.380 --> 00:02:13.900\nSo that's kind of the next step.\n\n52\n00:02:13.900 --> 00:02:17.930\nAnd then there's the super step where\nwe say look, I'm not just gonna create\n\n53\n00:02:17.930 --> 00:02:22.800\na file share, I'm gonna create\na full-blown domain controller.\n\n54\n00:02:22.800 --> 00:02:26.820\nI want my Linux server to actually run\nthe domain for my Windows environment.\n\n55\n00:02:26.820 --> 00:02:29.100\nNow Samba can do that.\n\n56\n00:02:29.100 --> 00:02:29.910\nIt's very powerful.\n\n57\n00:02:29.910 --> 00:02:31.340\nIt is able to do that.\n\n58\n00:02:31.340 --> 00:02:35.350\nBut I will tell you guys that\nit is not the best at it.\n\n59\n00:02:35.350 --> 00:02:39.170\nIn a corporate world, in a business world,\nyou don't wanna do that.\n\n60\n00:02:39.170 --> 00:02:41.742\nYou want to actually use\nWindows domain controller.\n\n61\n00:02:41.742 --> 00:02:44.566\nSo if you're investing in a Windows\ninfrastructure, you need to use\n\n62\n00:02:44.566 --> 00:02:48.110\nMicrosoft's active directory and\ntheir domain controllers for that.\n\n63\n00:02:48.110 --> 00:02:51.840\nSamba can do it, but\nit is not full-featured support.\n\n64\n00:02:51.840 --> 00:02:54.980\nMicrosoft does not just publish\nall of the documentation.\n\n65\n00:02:54.980 --> 00:02:56.860\nYou actually have people that\nare reverse engineering,\n\n66\n00:02:56.860 --> 00:02:58.760\ntrying to figure out how this stuff works.\n\n67\n00:02:58.760 --> 00:03:02.690\nMicrosoft publishes some documentation,\nso that's why it works pretty well, but\n\n68\n00:03:02.690 --> 00:03:04.300\nit's not perfect.\n\n69\n00:03:04.300 --> 00:03:06.660\nAnd so if you've got tens\nof thousands of employees,\n\n70\n00:03:06.660 --> 00:03:10.840\nyou don't wanna depend on something\nthat's not completely stable, right?\n\n71\n00:03:10.840 --> 00:03:12.320\nBut in a small office,\n\n72\n00:03:12.320 --> 00:03:15.290\nyou might not wanna invest in a server\nlicense to stand up a domain controller.\n\n73\n00:03:15.290 --> 00:03:17.700\nSo you can use Samba in that role and\nit will work well enough for\n\n74\n00:03:17.700 --> 00:03:20.130\nsmall businesses and\neven medium businesses.\n\n75\n00:03:20.130 --> 00:03:24.590\nI've seen some large enterprises that\nused it, but it's just not a great idea.\n\n76\n00:03:24.590 --> 00:03:28.760\nSo in this episode, what we're gonna do is\nwe're gonna focus more on the server side,\n\n77\n00:03:28.760 --> 00:03:31.410\nnot as a domain controller,\njust as a shared folder.\n\n78\n00:03:31.410 --> 00:03:33.990\nWe might film another series another\ntime where we actually tackle the domain\n\n79\n00:03:33.990 --> 00:03:34.660\ncontroller side.\n\n80\n00:03:34.660 --> 00:03:38.890\nBut I'm not the biggest fan of it, so\nI don't like to kinda promote that.\n\n81\n00:03:38.890 --> 00:03:41.580\nBut as far as standing up\njust shared folders though,\n\n82\n00:03:41.580 --> 00:03:43.850\nthat's actually really easy,\nSamba does a great job with it.\n\n83\n00:03:43.850 --> 00:03:46.930\nit's very stable for\nthe shared folder content, and you can\n\n84\n00:03:46.930 --> 00:03:50.660\nmake it where people can access not just\nshared folders but printers as well.\n\n85\n00:03:50.660 --> 00:03:52.870\nAnd gain access to be able to use it,\nall right.\n\n86\n00:03:52.870 --> 00:03:56.390\nSo if I wanna go that route, there's\na few things I need to get installed.\n\n87\n00:03:56.390 --> 00:04:00.230\nAnd so I'm using\na Red Hat Enterprise Linux server,\n\n88\n00:04:00.230 --> 00:04:02.730\nthis is a Red Hat Enterprise Linux 7.4,\n\n89\n00:04:02.730 --> 00:04:06.760\nand I'm going to,\nlet me get into a root shell real quick.\n\n90\n00:04:06.760 --> 00:04:09.240\nA lot of the stuff that we're gonna\nbe running needs elevated privileges.\n\n91\n00:04:09.240 --> 00:04:12.640\nI don't want to sudo every command,\nso I'll just do that real quick.\n\n92\n00:04:12.640 --> 00:04:15.580\nAnd now I'm gonna go in here and\nget it installed.\n\n93\n00:04:15.580 --> 00:04:20.610\nThere's three common packages that\nI install when I set up Samba.\n\n94\n00:04:20.610 --> 00:04:22.540\nWe don't necessarily need all of them.\n\n95\n00:04:22.540 --> 00:04:23.470\nBut let me explain each one.\n\n96\n00:04:23.470 --> 00:04:25.080\nSo I'm gonna do a yum install.\n\n97\n00:04:25.080 --> 00:04:28.680\nAnd the first one we need is\nthe Samba service, right?\n\n98\n00:04:28.680 --> 00:04:31.520\nThat's the actual Samba server,\nand if you wanna share folders and\n\n99\n00:04:31.520 --> 00:04:35.720\nshare printers as SMB shares\nthen you need Samba, right?\n\n100\n00:04:35.720 --> 00:04:38.940\nThere's the Samba client,\nwhich you very well may already have.\n\n101\n00:04:38.940 --> 00:04:42.740\nYou don't technically need\nthe client on a server, but\n\n102\n00:04:42.740 --> 00:04:45.460\nI usually install it anyway because I\nneed to test to make sure it's working.\n\n103\n00:04:45.460 --> 00:04:46.360\nAnd you need a client to test.\n\n104\n00:04:46.360 --> 00:04:48.490\nYou can test from your own machine.\n\n105\n00:04:48.490 --> 00:04:50.240\nBut if you're troubleshooting\nfirewall issues,\n\n106\n00:04:50.240 --> 00:04:52.140\nit's kinda nice to have\nthe client on the server.\n\n107\n00:04:52.140 --> 00:04:54.505\nSo I'm gonna install\nthe Samba client as well.\n\n108\n00:04:54.505 --> 00:04:59.026\nThe next one is samba-winbind.\n\n109\n00:04:59.026 --> 00:05:01.420\nAll right, now this one is optional.\n\n110\n00:05:01.420 --> 00:05:03.228\nIf you have a Windows domain controller,\n\n111\n00:05:03.228 --> 00:05:08.280\nThe Samba Winbind service\nwill let us join that domain.\n\n112\n00:05:08.280 --> 00:05:10.910\nWe can join the domain and\nshare the user database.\n\n113\n00:05:10.910 --> 00:05:14.020\nSo you know, as far as authenticating\nour users inside of Samba.\n\n114\n00:05:14.020 --> 00:05:16.230\nWhich is pretty handy in\na domain environment, right?\n\n115\n00:05:16.230 --> 00:05:19.020\nIf I don't have a domain environment,\nthough.\n\n116\n00:05:19.020 --> 00:05:21.620\nThen I can just use my standard\nUnix users right here.\n\n117\n00:05:21.620 --> 00:05:24.780\nSo if I'm just standing up a simple file\nserver I want people to have access to,\n\n118\n00:05:24.780 --> 00:05:26.870\nI can define the users\nright here on the server.\n\n119\n00:05:26.870 --> 00:05:29.320\nAnd I don't need Winbind for that, okay?\n\n120\n00:05:29.320 --> 00:05:32.580\nI'm gonna go ahead and install Winbind but\nI'm not gonna use it in this episode.\n\n121\n00:05:32.580 --> 00:05:35.210\nWe might take a look\nat it at a later date.\n\n122\n00:05:35.210 --> 00:05:36.450\nBut for now I'll go ahead and install it.\n\n123\n00:05:36.450 --> 00:05:37.660\nSo those three packages right there,\n\n124\n00:05:37.660 --> 00:05:39.855\nthat's pretty much what\nmost of us are gonna need.\n\n125\n00:05:39.855 --> 00:05:43.560\nWinbind also gives us that ability to go\nbeyond and create a domain controller and\n\n126\n00:05:43.560 --> 00:05:46.490\ndo all the extra stuff if we\nwanna go full blown Samba.\n\n127\n00:05:46.490 --> 00:05:50.120\nAll right, so when I install that\nit will likely find that some\n\n128\n00:05:50.120 --> 00:05:52.820\nof the packages are already installed or\nit might not.\n\n129\n00:05:52.820 --> 00:05:55.900\nLooks like it has to install all three.\n\n130\n00:05:55.900 --> 00:05:57.132\nI didn't have any of them.\n\n131\n00:05:57.132 --> 00:05:57.673\n&gt;&gt; What do you know?\n\n132\n00:05:57.673 --> 00:05:59.470\n&gt;&gt; So, yeah, I get surprised sometimes.\n\n133\n00:05:59.470 --> 00:06:02.270\nMust have done a minimal install\non this server cuz I keep\n\n134\n00:06:02.270 --> 00:06:03.690\nexpecting packages to be there and\nthey aren't.\n\n135\n00:06:03.690 --> 00:06:04.820\nBut I'll go ahead and install it.\n\n136\n00:06:04.820 --> 00:06:09.370\nYou just see it's bringing in a lot of\nother things that kind of come along with\n\n137\n00:06:09.370 --> 00:06:12.358\nit, but it's those three packages\nthat I really care about.\n\n138\n00:06:12.358 --> 00:06:14.110\nSo it's gonna install those.\n\n139\n00:06:14.110 --> 00:06:18.940\nNow once they're installed we need\nto go through our normal type of set\n\n140\n00:06:18.940 --> 00:06:21.170\nup to get everything up and\nrunning and get it in place.\n\n141\n00:06:21.170 --> 00:06:23.880\nBut those packages make up\nthe server that we need and\n\n142\n00:06:23.880 --> 00:06:26.060\nnow we've got the Samba server system.\n\n143\n00:06:26.060 --> 00:06:29.480\n&gt;&gt; So is this one ready to go or\nis there some assembly required?\n\n144\n00:06:29.480 --> 00:06:31.110\n&gt;&gt; And there's some assembly required,\nright?\n\n145\n00:06:31.110 --> 00:06:35.810\nSo there's some services like Apache,\nright, where we can install httpd, and\n\n146\n00:06:35.810 --> 00:06:38.719\nall we need to do is jump in there and\nstart it and we're in business, right?\n\n147\n00:06:38.719 --> 00:06:42.660\nWhich I mean, we can try it right here,\nyou can come through and say, all right,\n\n148\n00:06:42.660 --> 00:06:45.670\nsystemctl enable samba.\n\n149\n00:06:45.670 --> 00:06:49.560\nAnd then actually try and start it, right?\n\n150\n00:06:49.560 --> 00:06:51.575\nIf I do that though,\nit's likely gonna fail.\n\n151\n00:06:51.575 --> 00:06:54.540\nAll right, and\nthere's a few reasons why it might fail.\n\n152\n00:06:54.540 --> 00:06:58.090\nThere's some basic configurations\nthat we need to change to make sure\n\n153\n00:06:58.090 --> 00:06:59.680\neverything is right.\n\n154\n00:06:59.680 --> 00:07:02.850\nThe main thing that's a problem\nis usually the host name.\n\n155\n00:07:02.850 --> 00:07:05.310\nSo, I've got a host name\ndefined on my server.\n\n156\n00:07:05.310 --> 00:07:07.840\nIt's called lab-server01, right?\n\n157\n00:07:07.840 --> 00:07:11.715\nBut when you install Linux, they usually\njust default to being called localhost.\n\n158\n00:07:11.715 --> 00:07:12.945\nAnd Samba hates that.\n\n159\n00:07:12.945 --> 00:07:15.480\nSamba when it tries to start,\nit has to figure your server name.\n\n160\n00:07:15.480 --> 00:07:17.705\nAnd it doesn't like localhost as a name.\n\n161\n00:07:17.705 --> 00:07:21.682\nAnd so that will cause it to not run even\nif you have a host name defined though.\n\n162\n00:07:21.682 --> 00:07:22.791\nI could probably start at the server.\n\n163\n00:07:22.791 --> 00:07:25.099\nIt would probably start right now but\nit's not gonna do anything,.\n\n164\n00:07:25.099 --> 00:07:26.225\nIt's not gonna share anything.\n\n165\n00:07:26.225 --> 00:07:28.515\nSo I've gotta get in there and\ndo a basic configuration first.\n\n166\n00:07:28.515 --> 00:07:32.580\nAnd just starting it right off\nthe bat is not really a useful thing.\n\n167\n00:07:32.580 --> 00:07:33.700\nSo let's get in here and\n\n168\n00:07:33.700 --> 00:07:37.170\ntake a look at what we need to\nactually get this configured.\n\n169\n00:07:37.170 --> 00:07:41.180\nHere in the beginning, there's two config\nfiles that I really need to worry about.\n\n170\n00:07:41.180 --> 00:07:44.740\nAnd they're both in the same\nplace which is kind of nice,\n\n171\n00:07:44.740 --> 00:07:46.680\nwhich is /etc/samba, all right?\n\n172\n00:07:46.680 --> 00:07:49.530\nIf you go into that folder,\nyou'll find a couple of different files.\n\n173\n00:07:49.530 --> 00:07:55.043\nAnd the files that I care about\nare these first two, lmhosts and\n\n174\n00:07:55.043 --> 00:08:01.301\nsmb.com Okay, LM hosts, that stands for\nLAN manager hosts, right?\n\n175\n00:08:01.301 --> 00:08:04.352\nThe neat little history\nstory here about SMB.\n\n176\n00:08:04.352 --> 00:08:05.500\nI don't wanna bore you too much.\n\n177\n00:08:05.500 --> 00:08:07.434\nBut-\n&gt;&gt; [CROSSTALK] Love the history lesson.\n\n178\n00:08:07.434 --> 00:08:08.270\nKeep going.\n\n179\n00:08:08.270 --> 00:08:11.740\n&gt;&gt; When Microsoft released DOS,\nit didn't have networking.\n\n180\n00:08:11.740 --> 00:08:15.095\nAnd when they released Windows,\nWindows 1, Windows 2, Windows 3,\n\n181\n00:08:15.095 --> 00:08:17.050\nthey didn't have networking.\n\n182\n00:08:17.050 --> 00:08:19.600\nIt wasn't until Windows 3.11 for\nworkgroups that\n\n183\n00:08:19.600 --> 00:08:23.120\nthey actually introduced networking, and\nMicrosoft didn't write that from scratch.\n\n184\n00:08:23.120 --> 00:08:26.920\nIntel had a product called Intel LAN\nManager and Microsoft just licensed it.\n\n185\n00:08:26.920 --> 00:08:29.320\nNow, ultimately, they bought\nthat whole division from Intel.\n\n186\n00:08:29.320 --> 00:08:32.750\nAnd so all the networking inside\nof Windows really came from Intel.\n\n187\n00:08:32.750 --> 00:08:33.330\n&gt;&gt; Wow.\n\n188\n00:08:33.330 --> 00:08:35.589\n&gt;&gt; And that old LAN manager\nname has stuck around.\n\n189\n00:08:35.589 --> 00:08:38.320\nEven to today, you'll find it digging\nthrough config files and stuff.\n\n190\n00:08:38.320 --> 00:08:45.341\nSo LM hosts, that's the super ancient old\nway for resolving a name to an address.\n\n191\n00:08:45.341 --> 00:08:46.753\nWe do that with DNS now, right?\n\n192\n00:08:46.753 --> 00:08:48.710\nDNS does a name to an IP.\n\n193\n00:08:48.710 --> 00:08:52.617\nBut back then, a lot of times you were\nusing NetBEUI or NetBios names or\n\n194\n00:08:52.617 --> 00:08:55.896\nother different types of\naddressing on the network.\n\n195\n00:08:55.896 --> 00:08:59.920\nAnd so you could use LM hosts to map that,\nwhere you'd map a name to an address.\n\n196\n00:08:59.920 --> 00:09:01.105\nSo we still have that.\n\n197\n00:09:01.105 --> 00:09:03.909\nAnd if I don't have a way to do\nname lookups on the network,\n\n198\n00:09:03.909 --> 00:09:06.043\nI might need to come in here and\nadd entries.\n\n199\n00:09:06.043 --> 00:09:08.352\nBut most of us aren't gonna\nhave to mess with that file.\n\n200\n00:09:08.352 --> 00:09:11.212\nBut that's one of them that we\nhave to worry about with Samba.\n\n201\n00:09:11.212 --> 00:09:15.445\nPretty much everything else we need is\nright here in this file, SMB.com, right?\n\n202\n00:09:15.445 --> 00:09:16.949\nAnd so I'm gonna edit that.\n\n203\n00:09:16.949 --> 00:09:21.945\nSo I'm editing /etc/samba/smb.com.\n\n204\n00:09:21.945 --> 00:09:26.190\nAnd when you go in here, it actually\ndoes have a sample configuration.\n\n205\n00:09:26.190 --> 00:09:30.830\nAnd it's not very well documented,\nthey don't really explain the options.\n\n206\n00:09:30.830 --> 00:09:33.820\nBut they do have pretty\nstandard options defined here\n\n207\n00:09:33.820 --> 00:09:38.050\nby default that we can look at and\nmake use of and change and configure.\n\n208\n00:09:38.050 --> 00:09:40.040\nSo here's the Samba assembly required,\nright?\n\n209\n00:09:40.040 --> 00:09:42.750\nLet me highlight some of\nthe things that we need to set.\n\n210\n00:09:42.750 --> 00:09:44.670\nFirst off, we've got our global settings.\n\n211\n00:09:44.670 --> 00:09:49.680\nYou see it's divided up into sessions,\nglobal, homes, printers and print, right?\n\n212\n00:09:49.680 --> 00:09:52.070\nSo global, that's the server itself.\n\n213\n00:09:52.070 --> 00:09:55.900\nThat's the part that I need to fix\nup before I can start this thing.\n\n214\n00:09:55.900 --> 00:10:01.290\nThen, homes, by default,\nSamba doesn't share anything.\n\n215\n00:10:01.290 --> 00:10:04.440\nBut we can customize it to\nshare the user's home folders.\n\n216\n00:10:04.440 --> 00:10:06.780\nIf you got 1,000 users, they've all\ngot a home folder in the server,\n\n217\n00:10:06.780 --> 00:10:08.022\nwe can share it on the network, right?\n\n218\n00:10:08.022 --> 00:10:10.708\nSo that's what the homes section is,\nfor sharing home folders.\n\n219\n00:10:10.708 --> 00:10:14.564\nPrinters, we can share any CUPS printer.\n\n220\n00:10:14.564 --> 00:10:18.417\nSo if you're using the common Linux print\nsubsystem and you've got printers defined,\n\n221\n00:10:18.417 --> 00:10:19.727\nwe can have Samba share them.\n\n222\n00:10:19.727 --> 00:10:23.325\nAnd so now we're a Windows print server,\neven though we're running Linux, right?\n\n223\n00:10:23.325 --> 00:10:24.775\nSo that's what printers is.\n\n224\n00:10:24.775 --> 00:10:29.075\nAnd then with Windows, when it connects to\na network printer, if it needs a driver it\n\n225\n00:10:29.075 --> 00:10:33.115\nlooks for a special share called print$\nand it tries to find the driver there.\n\n226\n00:10:33.115 --> 00:10:35.530\nAnd so that's defined right here,\nthe printer drivers.\n\n227\n00:10:35.530 --> 00:10:38.740\nIn the Windows world, any share that\nends with a dollar sign is hidden.\n\n228\n00:10:38.740 --> 00:10:39.553\nSo it's hidden on the network.\n\n229\n00:10:39.553 --> 00:10:41.308\nYou have to know it's there to get to it.\n\n230\n00:10:41.308 --> 00:10:42.870\nYou won't be able to browse and find it.\n\n231\n00:10:42.870 --> 00:10:45.870\nSo those are things that\nare set up by default that each\n\n232\n00:10:45.870 --> 00:10:48.040\nsection kind of has its\nown little configuration.\n\n233\n00:10:48.040 --> 00:10:50.680\nWell, we'll take a look at each\nof these throughout the episode,\n\n234\n00:10:50.680 --> 00:10:54.380\nor probably multiple episodes\ncuz we got a lot to get through.\n\n235\n00:10:54.380 --> 00:10:57.640\nBut the part I wanna focus on right now is\nthe global part, right up here at the top.\n\n236\n00:10:57.640 --> 00:11:00.020\nOkay, the first entry here is workgroup,\nand\n\n237\n00:11:00.020 --> 00:11:02.390\nthis is gonna be the name\nof your workgroup.\n\n238\n00:11:02.390 --> 00:11:04.670\nIn the Windows world,\nwhen you browse the network and\n\n239\n00:11:04.670 --> 00:11:08.090\nyou look at machines, they're categorized\neither by a workgroup or a domain.\n\n240\n00:11:08.090 --> 00:11:12.045\nWell, this workgroup actually counts\nas both, as a workgroup or a domain.\n\n241\n00:11:12.045 --> 00:11:15.370\nBecause Linux doesn't really care, so\nI just need to put what the name is.\n\n242\n00:11:15.370 --> 00:11:16.918\nIf I don't have a workgroup or\n\n243\n00:11:16.918 --> 00:11:21.250\na domain in place right now, I can pick\nwhatever name I want, well, within limits.\n\n244\n00:11:21.250 --> 00:11:24.620\nIt has to be less than 15 characters,\ncan't have spaces.\n\n245\n00:11:24.620 --> 00:11:27.532\nIt can have underscores and hyphens.\n\n246\n00:11:27.532 --> 00:11:29.870\nThey recommend you don't do underscores,\nbut you can.\n\n247\n00:11:29.870 --> 00:11:33.860\nAnd so I do have certain limits,\nbut I can put whatever name I want.\n\n248\n00:11:33.860 --> 00:11:36.110\nNow if you're just trying to\nstand something up very quickly,\n\n249\n00:11:36.110 --> 00:11:38.740\nand you've got Windows hosts\nthat you wanna connect,\n\n250\n00:11:38.740 --> 00:11:43.330\nWindows defaults to\na workgroup name of Workgroup.\n\n251\n00:11:43.330 --> 00:11:45.190\nSo if I just wanted a quick and easy,\n\n252\n00:11:45.190 --> 00:11:48.600\nget machines connected, I should\nname the workgroup that, Workgroup.\n\n253\n00:11:48.600 --> 00:11:50.900\nBut you'll probably wanna\ncall it something different.\n\n254\n00:11:50.900 --> 00:11:55.290\nI'll call mine like Don's Lab or\nsomething, just so I can identify this and\n\n255\n00:11:55.290 --> 00:11:58.296\nother people in the building here don't\nstart wondering why I've got some crazy\n\n256\n00:11:58.296 --> 00:11:59.540\nworkgroup set up.\n\n257\n00:11:59.540 --> 00:12:03.880\nBut now any client who connects will need\nto know to look for that different name.\n\n258\n00:12:03.880 --> 00:12:06.500\nTo look for that workgroup\nthat's called Don's Lab, right?\n\n259\n00:12:06.500 --> 00:12:07.990\nSo we just need to give it a name.\n\n260\n00:12:09.470 --> 00:12:12.390\nThere's the security entry, which says\nhow we're gonna do authentication.\n\n261\n00:12:12.390 --> 00:12:15.050\nOn the authentication side,\nyou can set this up for anonymous access,\n\n262\n00:12:15.050 --> 00:12:17.710\nwhich is anybody can access anything and\noff you go.\n\n263\n00:12:17.710 --> 00:12:19.257\nBut normally, we do user security.\n\n264\n00:12:19.257 --> 00:12:21.246\nThat says people have to\nprovide a username and\n\n265\n00:12:21.246 --> 00:12:22.980\na password to gain access to the system.\n\n266\n00:12:22.980 --> 00:12:25.930\nSo that's kind of an important\none that we wanna set.\n\n267\n00:12:25.930 --> 00:12:28.200\nThere's another entry,\nsee these spaces here?\n\n268\n00:12:28.200 --> 00:12:31.550\nThere's extra slots where\nyou can put in other values.\n\n269\n00:12:31.550 --> 00:12:34.470\nIt kind of deleted out,\nI'm not quite sure why.\n\n270\n00:12:34.470 --> 00:12:37.480\nBut you can add in these other\nentries that are kind of useful.\n\n271\n00:12:37.480 --> 00:12:41.880\nA lot of Windows servers like\nto have a server string,\n\n272\n00:12:41.880 --> 00:12:44.020\nwhich is a description that\ndescribes what the server is.\n\n273\n00:12:44.020 --> 00:12:45.974\nWhen you browse, you see the server name.\n\n274\n00:12:45.974 --> 00:12:50.344\nAnd then you see this kind of description,\nand so\n\n275\n00:12:50.344 --> 00:12:55.365\nI'll call this one my Linux\nbased file server, right?\n\n276\n00:12:55.365 --> 00:12:59.125\nSo when people look at it, hey, they'll\nknow it's a Linux based file server.\n\n277\n00:12:59.125 --> 00:13:01.759\nNow, I mentioned host name\na few moments ago, and\n\n278\n00:13:01.759 --> 00:13:03.780\nhow I need to have a host name defined.\n\n279\n00:13:03.780 --> 00:13:07.490\nNotice there's nothing in here that\nreally says what the server's name is.\n\n280\n00:13:07.490 --> 00:13:09.944\nBy default, it's gonna try and\nuse the defined host name,\n\n281\n00:13:09.944 --> 00:13:13.249\nwhich if it's set to localhost or not set\nat all, it's not gonna be happy with.\n\n282\n00:13:13.249 --> 00:13:15.133\nI don't have to change the host\nname on my box, though.\n\n283\n00:13:15.133 --> 00:13:16.820\nI can just define it right in here.\n\n284\n00:13:16.820 --> 00:13:23.110\nJust like server string, I can come in and\nI can say that I want the NetBios name for\n\n285\n00:13:23.110 --> 00:13:26.060\nthe server to be whatever I want it.\n\n286\n00:13:26.060 --> 00:13:28.020\nI could call it file server, right?\n\n287\n00:13:28.020 --> 00:13:32.010\nI don't want people to know\nthat this is lab-rhelo1, or\n\n288\n00:13:32.010 --> 00:13:33.550\nwhatever my server's name is, right?\n\n289\n00:13:33.550 --> 00:13:36.070\nI can change it and\ncall it whatever I want.\n\n290\n00:13:36.070 --> 00:13:39.570\nAnd this way, the Unix host name\nis not impacting Samba anymore.\n\n291\n00:13:39.570 --> 00:13:41.250\nIt's got its own designation.\n\n292\n00:13:41.250 --> 00:13:44.610\nBut I am, just for my own sanity,\ngonna call it Lab Server One,\n\n293\n00:13:44.610 --> 00:13:47.400\nsince that is the name [LAUGH] of\nmy box and I wanna remember that.\n\n294\n00:13:47.400 --> 00:13:49.900\nSo defining that right there is\ngonna be a pretty handy thing.\n\n295\n00:13:49.900 --> 00:13:53.600\nSo for me, the three values\nthat I'm normally looking for\n\n296\n00:13:53.600 --> 00:13:57.310\nhere are workgroup,\nNetBios name and server string.\n\n297\n00:13:57.310 --> 00:13:58.930\nI wanna define those three things.\n\n298\n00:13:58.930 --> 00:14:00.930\nServer string is completely optional,\nyou can leave it off, but\n\n299\n00:14:00.930 --> 00:14:02.900\nit's nice to have that\ndescription to find it.\n\n300\n00:14:02.900 --> 00:14:07.198\nOnce you punch those three in, that's\nreally enough for Samba to be happy.\n\n301\n00:14:07.198 --> 00:14:10.140\nAnd now we can start it up and\nit'll be able to run.\n\n302\n00:14:10.140 --> 00:14:11.960\nBut that's kinda the key thing there.\n\n303\n00:14:11.960 --> 00:14:13.140\nBut before I get out of this file,\n\n304\n00:14:13.140 --> 00:14:16.270\nlet me just run through a few\nof these other entries.\n\n305\n00:14:16.270 --> 00:14:17.760\nThere's the printing section, and\n\n306\n00:14:17.760 --> 00:14:19.740\nsee how it's defining here\nwhat we're using for printing?\n\n307\n00:14:19.740 --> 00:14:22.950\nAlmost every distribution today uses CUPS.\n\n308\n00:14:22.950 --> 00:14:27.296\nBut in the old days, you had all sorts\nof various file forms are out there,\n\n309\n00:14:27.296 --> 00:14:29.695\nlike the LPD, the line printer deamon.\n\n310\n00:14:29.695 --> 00:14:33.149\nAnd so you could actually switch to one of\nthose other systems if you still need it.\n\n311\n00:14:33.149 --> 00:14:37.639\nBut really for the last probably ten\nyears, CUPS has kinda been king.\n\n312\n00:14:37.639 --> 00:14:41.279\nSo, that's normally what you'll see right\nthere, so you've got the options for\n\n313\n00:14:41.279 --> 00:14:42.550\nhow CUPS is gonna function.\n\n314\n00:14:42.550 --> 00:14:46.530\nBut after that, we get our other settings\nin here, like the Home Directories, right?\n\n315\n00:14:46.530 --> 00:14:49.506\nYou might be trying to set up\na centralized file share for your team, or\n\n316\n00:14:49.506 --> 00:14:52.837\ncompany, or whatever, you just want to\nhave this shared folder available for\n\n317\n00:14:52.837 --> 00:14:53.552\nthem to access.\n\n318\n00:14:53.552 --> 00:14:55.205\nYou don't wanna share home directories.\n\n319\n00:14:55.205 --> 00:15:00.230\nWell, that's okay, because if you\nlook it's got here browsable, no.\n\n320\n00:15:00.230 --> 00:15:03.100\nSo it's not making them browsable and\naccessible.\n\n321\n00:15:03.100 --> 00:15:06.360\nPeople would have to know they\nwere there to get to them.\n\n322\n00:15:06.360 --> 00:15:10.250\nAnd it's inheriting ACL, so\nany access list that I have in place\n\n323\n00:15:10.250 --> 00:15:12.010\non those user home directories\nare going to apply,\n\n324\n00:15:12.010 --> 00:15:14.030\nso people will be tied\nto their own directory.\n\n325\n00:15:14.030 --> 00:15:17.552\nSo, it's actually pretty secured by\ndefault here the way that it's configured\n\n326\n00:15:17.552 --> 00:15:18.701\nif I just wanna needed be.\n\n327\n00:15:18.701 --> 00:15:22.521\nBut there's a few entries in here\nwe might want to tweak a bit.\n\n328\n00:15:22.521 --> 00:15:27.159\nValid users, you can actually\nlist who you want to have access.\n\n329\n00:15:27.159 --> 00:15:29.677\nYou can do usernames separated by commas.\n\n330\n00:15:29.677 --> 00:15:30.903\nYou can do groups.\n\n331\n00:15:30.903 --> 00:15:34.260\nA group is listed just like a user,\nexcept you put a plus before it.\n\n332\n00:15:34.260 --> 00:15:38.065\nSo if I had a group called accountants,\nI would say +accountants, and\n\n333\n00:15:38.065 --> 00:15:39.215\nthat would add them.\n\n334\n00:15:39.215 --> 00:15:40.271\nAnd so you punch them in.\n\n335\n00:15:40.271 --> 00:15:45.028\nThis %s is actually a wild card that\nmeans any user defined in the system.\n\n336\n00:15:45.028 --> 00:15:48.589\nSo this is effectively saying,\neverybody is able to log in.\n\n337\n00:15:48.589 --> 00:15:51.632\nNow the ACL still applies, so they only\nhave access to their own home directory,\n\n338\n00:15:51.632 --> 00:15:52.721\nbut they're able to log in.\n\n339\n00:15:52.721 --> 00:15:58.652\nThis %d, % w, %s,\nThat's the old net bios structure for\n\n340\n00:15:58.652 --> 00:16:02.955\na name, its domain\\username, right, so\n\n341\n00:16:02.955 --> 00:16:07.000\nthat's what DWS is referring to.\n\n342\n00:16:07.000 --> 00:16:09.620\nI could change that and\nI could say for example,\n\n343\n00:16:09.620 --> 00:16:11.710\nI only want one particular\ndomain to access.\n\n344\n00:16:11.710 --> 00:16:15.140\nYou might have 10 domains and\nI just want domain1 to have access.\n\n345\n00:16:15.140 --> 00:16:20.390\nSo I could change this to say\nsomething like domain1\\%s.\n\n346\n00:16:20.390 --> 00:16:23.831\nNow, only users in that domain\nwould be able to log in.\n\n347\n00:16:23.831 --> 00:16:27.827\nBut if I want them all to be able to log\nin, what we're really doing here is saying\n\n348\n00:16:27.827 --> 00:16:31.910\nthat I'll allow them to provide their\nuser name in two different formats.\n\n349\n00:16:31.910 --> 00:16:36.295\nEither just as a user name or as a user\nname combined with the domain name and\n\n350\n00:16:36.295 --> 00:16:39.080\nthen they can get in and\naccess their folders.\n\n351\n00:16:39.080 --> 00:16:40.990\nSo those are some things\nthat we might want to tweak.\n\n352\n00:16:40.990 --> 00:16:42.680\nWe do have to be careful\nwith a few things.\n\n353\n00:16:44.700 --> 00:16:46.506\nJust looking at this config,\n\n354\n00:16:46.506 --> 00:16:50.856\nit looks like those Home folders\nwill be available by default, right?\n\n355\n00:16:50.856 --> 00:16:53.386\nAnd on some distros they would be.\n\n356\n00:16:53.386 --> 00:16:55.639\nLke on a Ubuntu, they would be.\n\n357\n00:16:55.639 --> 00:16:58.902\nBut in Red Hat, we have SELinux.\n\n358\n00:16:58.902 --> 00:17:02.281\nAnd SELinux is a security sublayer\nthat runs in the background,\n\n359\n00:17:02.281 --> 00:17:06.548\nand it can actually control whether you\ncan get to these home directories or not.\n\n360\n00:17:06.548 --> 00:17:08.040\nLet me show you what I mean.\n\n361\n00:17:08.040 --> 00:17:10.000\nI'm gonna get out of this\nconfig file real quick.\n\n362\n00:17:11.280 --> 00:17:13.600\nAnd I saved it,\nbecause I made some changes.\n\n363\n00:17:13.600 --> 00:17:17.650\nBut in SELinux, we normally talk about\nSELinux when we talk about files,\n\n364\n00:17:17.650 --> 00:17:20.340\nright, the ability to access files and\nfolders.\n\n365\n00:17:20.340 --> 00:17:23.835\nSamba only has access to\ncertain things right,\n\n366\n00:17:23.835 --> 00:17:29.080\nIt has it's own SELinux context and\na lot of folders don't have that context.\n\n367\n00:17:29.080 --> 00:17:34.345\nAnd so when we share out home directories\nSELinux has to give Samba special\n\n368\n00:17:34.345 --> 00:17:38.130\npermissions to allow the service to even\nbe able to see those home directories.\n\n369\n00:17:38.130 --> 00:17:40.990\nAnd it does it through what\nare called SELinux Booleans.\n\n370\n00:17:40.990 --> 00:17:44.370\nBooleans are options that can\nbe turned on and off, right.\n\n371\n00:17:44.370 --> 00:17:48.280\nAnd we don't normally see these, but\nif you wanna take a look at them there's\n\n372\n00:17:48.280 --> 00:17:54.250\na get S-E-B-O-O-L, get sebool,\nor get SELinux Booleans command.\n\n373\n00:17:54.250 --> 00:17:56.940\nAnd if I just run it by itself,\nlike with a dash a,\n\n374\n00:17:56.940 --> 00:18:01.330\nit will show me all of the Booleans,\nand there's a lot of them.\n\n375\n00:18:01.330 --> 00:18:06.640\nSo I normally just pipe that into grep and\nI look for Samba.\n\n376\n00:18:06.640 --> 00:18:10.980\nSo I wanna see all the Booleans that have\nto Samba, and looking at the list here,\n\n377\n00:18:10.980 --> 00:18:17.660\nyou'll see things like Samba enable\nhome directories, and it's set to off.\n\n378\n00:18:17.660 --> 00:18:22.825\nIt really doesn't matter what\nI put in /etc/samba/smb.clnf,\n\n379\n00:18:22.825 --> 00:18:28.450\nbecause this Boolean is going to block\naccess to those home directories.\n\n380\n00:18:28.450 --> 00:18:31.307\nSo if I want Samba to be able\nto share those home directories,\n\n381\n00:18:31.307 --> 00:18:35.260\nI need to change this Boolean to On and\nthen we'll be able to browse and see it.\n\n382\n00:18:35.260 --> 00:18:38.070\nOkay now, I don't want to\nshare my home directory, so\n\n383\n00:18:38.070 --> 00:18:39.520\nI'm fine with this being Off.\n\n384\n00:18:39.520 --> 00:18:42.150\nIt's going to block it and that's good,\nbut if you do want to turn that on,\n\n385\n00:18:42.150 --> 00:18:47.430\nif that's what you're trying to do,\nwhat you would run here is setsebool.\n\n386\n00:18:47.430 --> 00:18:50.300\nSo we are going to set a set\nan SELinux Boolean, and\n\n387\n00:18:50.300 --> 00:18:55.170\nthen we would say dash capital P,\nfollowed by the name of the Boolean.\n\n388\n00:18:55.170 --> 00:19:03.750\nAnd this one is samba_enable_home_dirs,\nand then you would just tell it on.\n\n389\n00:19:03.750 --> 00:19:08.232\nAnd by doing that, that's going to\nreach in, change that Boolean, and\n\n390\n00:19:08.232 --> 00:19:12.066\nif I go and pull it back up,\nnow I can see enable home dirs is on.\n\n391\n00:19:12.066 --> 00:19:14.850\nRight, that's going to make\nthose directories share out and\n\n392\n00:19:14.850 --> 00:19:16.220\nallow them through SELinux.\n\n393\n00:19:16.220 --> 00:19:18.120\nNow I don't want that, so I'm just\ngoing to turn that back off again.\n\n394\n00:19:19.490 --> 00:19:22.080\nAnd there it goes,\nmy goal is not to share home directories,\n\n395\n00:19:22.080 --> 00:19:25.070\nI want to create a centralized file share\nthat's available for people to access.\n\n396\n00:19:25.070 --> 00:19:28.540\nSo that doesn't require dealing\nwith the home directories.\n\n397\n00:19:28.540 --> 00:19:31.550\nWe do need to be careful with that because\nthere's plenty of user's home directories\n\n398\n00:19:31.550 --> 00:19:33.390\nthat might not expect to share out.\n\n399\n00:19:33.390 --> 00:19:35.700\nBut at least the ACLs the access\ncontrol list applies,\n\n400\n00:19:35.700 --> 00:19:37.410\nwe still have controlled permissions.\n\n401\n00:19:37.410 --> 00:19:41.450\nSo I did want to point that out,\nbe careful in here, because there are some\n\n402\n00:19:41.450 --> 00:19:44.910\nBooleans that you can change that can\nreally significantly weaken security.\n\n403\n00:19:44.910 --> 00:19:49.830\nYou can subvert SELinux in here\npretty easily if you're not careful.\n\n404\n00:19:49.830 --> 00:19:54.085\nSo we do need to be careful with that but\nyou'll see other things you like allowing\n\n405\n00:19:54.085 --> 00:19:56.700\nSamba to be a domain controller,\nyou can turn that on or off.\n\n406\n00:19:56.700 --> 00:19:59.680\nAnd it's not actually configuring\nthe domain controller for\n\n407\n00:19:59.680 --> 00:20:01.910\nyou it's just allowing it through SELinux.\n\n408\n00:20:01.910 --> 00:20:06.170\nSo it's a whole back end subsystem\nmost people would never even see.\n\n409\n00:20:07.330 --> 00:20:10.056\nAll right, so those are a few things.\n\n410\n00:20:10.056 --> 00:20:10.696\nLet's see, what else?\n\n411\n00:20:10.696 --> 00:20:11.856\nThere were the printers, right?\n\n412\n00:20:11.856 --> 00:20:12.890\n&gt;&gt; Printers, right.\n\n413\n00:20:12.890 --> 00:20:16.420\n&gt;&gt; Let me pull that config file back up.\n\n414\n00:20:16.420 --> 00:20:19.980\nThe printers, there's not a whole\nlot we need to mess with here.\n\n415\n00:20:19.980 --> 00:20:22.970\nThe path is kind of a useful one.\n\n416\n00:20:22.970 --> 00:20:24.200\nWhen you look at the path here,\n\n417\n00:20:24.200 --> 00:20:26.860\nthis is basically where it's\ngonna spool print jobs.\n\n418\n00:20:26.860 --> 00:20:28.800\nSo when a print job is\nsent to the print server,\n\n419\n00:20:28.800 --> 00:20:30.460\nit's gotta store it on the disk somewhere.\n\n420\n00:20:30.460 --> 00:20:32.000\nHere it's just going to go to /var/temp.\n\n421\n00:20:32.000 --> 00:20:36.010\nYou might want to move it somewhere else,\nand you certainly can.\n\n422\n00:20:36.010 --> 00:20:38.559\nIf you move it somewhere else,\nmake sure you clear it with SELinux so\n\n423\n00:20:38.559 --> 00:20:40.901\nthat it has access,\notherwise that'll have some problems.\n\n424\n00:20:40.901 --> 00:20:44.180\nAgain, on a Ubuntu or Debian,\nyou don't have SELinux by default, so\n\n425\n00:20:44.180 --> 00:20:45.610\nit's not a problem.\n\n426\n00:20:45.610 --> 00:20:49.620\nBut if you've installed SELinux on them,\nthen you need to enable there too.\n\n427\n00:20:49.620 --> 00:20:51.430\nAnd in Red Hat we just have it by default.\n\n428\n00:20:51.430 --> 00:20:53.190\nSo those are some of\nthe things that we can tweak,\n\n429\n00:20:53.190 --> 00:20:54.900\nyou can choose to make it browsable.\n\n430\n00:20:54.900 --> 00:20:57.740\nRight now it's set to no, and that means\nif people are browsing the network,\n\n431\n00:20:57.740 --> 00:20:59.460\nthey're not gonna see my printers.\n\n432\n00:20:59.460 --> 00:21:02.990\nSo I might want to change that to yes,\nthat says hey,\n\n433\n00:21:02.990 --> 00:21:06.220\nif someone's trying to just find\na printer, they can browse the network and\n\n434\n00:21:06.220 --> 00:21:08.210\nI'll advertise my printers out so\nthey can find them.\n\n435\n00:21:08.210 --> 00:21:10.470\nAnd on a print server,\nyou typically want that.\n\n436\n00:21:10.470 --> 00:21:15.110\nSo that's a configuration option that's\neasy enough to change and modify.\n\n437\n00:21:15.110 --> 00:21:18.200\nIn fact, you might even wanna change\na few different settings in here that\n\n438\n00:21:18.200 --> 00:21:20.170\ntailor how this stuff works.\n\n439\n00:21:20.170 --> 00:21:23.020\nThere's options that don't\nshow up in here by default.\n\n440\n00:21:23.020 --> 00:21:28.512\nSo for example, let's see,\nwhat are some that we might want to do?\n\n441\n00:21:28.512 --> 00:21:30.311\nGuest, OK.\n\n442\n00:21:30.311 --> 00:21:33.710\nDo you want to allow anonymous\npeople to print, right.\n\n443\n00:21:33.710 --> 00:21:35.430\nI could come in and say yes, and\n\n444\n00:21:35.430 --> 00:21:38.560\nnow people don't need to\nsign in to be able to print.\n\n445\n00:21:38.560 --> 00:21:41.021\nIf I just want people on my local\nnetwork to be able to print and\n\n446\n00:21:41.021 --> 00:21:43.306\nI don't want to mess with user accounts,\nI can do that.\n\n447\n00:21:43.306 --> 00:21:46.409\nThe default is no, and so,\nI can leave it that way, and\n\n448\n00:21:46.409 --> 00:21:49.920\nthat way you have to\nauthenticate in order to print.\n\n449\n00:21:49.920 --> 00:21:55.240\nAnd that makes sure we don't get rogue\npeople on our network, sending print jobs.\n\n450\n00:21:55.240 --> 00:21:59.510\nWe've got writable,\nthis is an interesting one.\n\n451\n00:21:59.510 --> 00:22:01.390\nWritable equals yes, is the default.\n\n452\n00:22:01.390 --> 00:22:03.260\nI want people to be able\nto send print jobs.\n\n453\n00:22:03.260 --> 00:22:08.090\nBut you can actually say writable equals\nno and that will still share the printers,\n\n454\n00:22:08.090 --> 00:22:09.480\nbut it won't let people submit print jobs.\n\n455\n00:22:10.490 --> 00:22:11.930\nWhy the heck would I want to do that?\n\n456\n00:22:13.040 --> 00:22:15.960\nMaintenance, if I ever have\na problem with a printer,\n\n457\n00:22:15.960 --> 00:22:19.160\nI can flip this to writeable no and\nthat will stop\n\n458\n00:22:19.160 --> 00:22:22.290\npeople from submitting print jobs\nwhile I fix whatever the problem is.\n\n459\n00:22:22.290 --> 00:22:24.080\nAnd then I can start this back up.\n\n460\n00:22:24.080 --> 00:22:27.260\nI could stop the Samba service,\nbut if I have a bunch of shares,\n\n461\n00:22:27.260 --> 00:22:29.610\nlike shared folders, I don't want to\nkeep people out of the shared folders,\n\n462\n00:22:29.610 --> 00:22:31.270\nI just want to stop them from printing.\n\n463\n00:22:31.270 --> 00:22:33.300\nSo writeable no is a nice little option.\n\n464\n00:22:33.300 --> 00:22:37.010\nI normally put this in here and\nstick like a hash mark before it so\n\n465\n00:22:37.010 --> 00:22:37.770\nit doesn't take effect.\n\n466\n00:22:37.770 --> 00:22:40.010\nAnd that way if I ever have\na problem I can just come in and\n\n467\n00:22:40.010 --> 00:22:41.810\nreal quick delete that hash mark.\n\n468\n00:22:41.810 --> 00:22:43.560\nAnd that takes care of it, okay?\n\n469\n00:22:43.560 --> 00:22:47.010\nSo that's another one that we can\nstick in there if we needed to.\n\n470\n00:22:48.410 --> 00:22:52.560\nLet's see, and you'll see up here,\nprintable equals yes.\n\n471\n00:22:52.560 --> 00:22:56.250\nThat's another one I could say printable\nequals no and stop people from doing that.\n\n472\n00:22:56.250 --> 00:22:59.620\nThey're very similar so\nlet me explain the difference there.\n\n473\n00:22:59.620 --> 00:23:02.020\nI mentioned like writeable\nbeing able to print.\n\n474\n00:23:02.020 --> 00:23:03.780\nWriteable actually lets you do a lot more.\n\n475\n00:23:03.780 --> 00:23:06.690\nIt lets you print but\nyou can also modify print jobs.\n\n476\n00:23:06.690 --> 00:23:08.955\nI can change it so a user might\nbe able to cancel their own job.\n\n477\n00:23:08.955 --> 00:23:12.910\nPrintable would say I'm going\nto allow you to print but\n\n478\n00:23:12.910 --> 00:23:14.630\nnot necessarily allow you to modify a job.\n\n479\n00:23:14.630 --> 00:23:16.520\nI couldn't cancel somebody else's job.\n\n480\n00:23:16.520 --> 00:23:19.420\nSo those two are just kinda different\nlevels of permission so you can use\n\n481\n00:23:19.420 --> 00:23:23.292\nthem the same way you can kinda modify\nthose with yes and no if you want.\n\n482\n00:23:23.292 --> 00:23:27.040\nAll right, so\nI am going to leave those there.\n\n483\n00:23:27.040 --> 00:23:29.670\nI think that's pretty well set,\nthe way that I want.\n\n484\n00:23:29.670 --> 00:23:32.350\nI've got kind of things, I usually\nI don't mess with the drivers here.\n\n485\n00:23:32.350 --> 00:23:35.220\nYou know, that folder is already cleared\nthrough SELinux and you shouldn't\n\n486\n00:23:35.220 --> 00:23:39.060\nput any drivers you have in that folder\nright, there so people have access to it.\n\n487\n00:23:39.060 --> 00:23:44.902\nBut once we've got this set up, our config\nis good, assuming we didn't screw it up.\n\n488\n00:23:44.902 --> 00:23:47.225\n&gt;&gt; [LAUGH]\n&gt;&gt; And I'm not the best typer so\n\n489\n00:23:47.225 --> 00:23:48.110\nI make mistakes.\n\n490\n00:23:48.110 --> 00:23:52.488\nSo fortunately there's a utility\nthat's installed with the Samba\n\n491\n00:23:52.488 --> 00:23:57.399\nclient which is test Parm, or test\nparameters, and it will test that out and\n\n492\n00:23:57.399 --> 00:24:00.320\ntell you if there's a mistake in there.\n\n493\n00:24:00.320 --> 00:24:04.950\nAnd so mine's running, it sees the file,\nit's processing each of these sections.\n\n494\n00:24:04.950 --> 00:24:08.460\nEveryone seems fine, so, and\nyou know that its services file is okay.\n\n495\n00:24:08.460 --> 00:24:11.955\nAnd then I can press Enter, and\nit will show me my actual definitions,\n\n496\n00:24:11.955 --> 00:24:13.210\neverything looks good.\n\n497\n00:24:13.210 --> 00:24:16.231\nIf I had a mistake in there,\nthis would identify the mistake and\n\n498\n00:24:16.231 --> 00:24:20.122\nlet me fix it before I go and restart\nthe service, and potentially break things.\n\n499\n00:24:20.122 --> 00:24:23.335\n&gt;&gt; So now that it's all configured, are we\nready to go ahead and start it all up?\n\n500\n00:24:23.335 --> 00:24:25.129\n&gt;&gt; Yeah, might as well I guess [LAUGH].\n\n501\n00:24:25.129 --> 00:24:26.059\n&gt;&gt; [LAUGH]\n&gt;&gt; So\n\n502\n00:24:26.059 --> 00:24:29.015\nthis is kinda like that moment of truth,\nis it all working?\n\n503\n00:24:29.015 --> 00:24:36.632\nSo we can do a systemctl, and\nI'm going to enable the smb.service.\n\n504\n00:24:36.632 --> 00:24:43.869\nAnd I'll fire that one up, and\nI'll do a systemctl start the smb service.\n\n505\n00:24:43.869 --> 00:24:48.800\nIf I don't get any errors, then Samba just\nstarted, and things should be working.\n\n506\n00:24:48.800 --> 00:24:53.703\nNow, before I move on any further,\nthere is one other sister\n\n507\n00:24:53.703 --> 00:24:59.007\nservice that goes along with Samba\nthat we haven't really seen.\n\n508\n00:24:59.007 --> 00:25:03.771\nThis is SMB, then there's NMB,\nNMB, which is for net BIOS.\n\n509\n00:25:03.771 --> 00:25:07.080\nNow, normally, you've got Windows\nmachines on your network.\n\n510\n00:25:07.080 --> 00:25:10.640\nAnd those Windows machines will elect\nwhat's called a master browser.\n\n511\n00:25:10.640 --> 00:25:12.650\nIt'll be one system,\nit's usually a server, but\n\n512\n00:25:12.650 --> 00:25:14.510\nit could just be a workstation.\n\n513\n00:25:14.510 --> 00:25:17.380\nAnd that master browser is\nkeeping track of the name of\n\n514\n00:25:17.380 --> 00:25:20.270\nall of the net BIOS machines\nthat are on that network.\n\n515\n00:25:20.270 --> 00:25:22.172\nWe typically use DNS for this now, but\n\n516\n00:25:22.172 --> 00:25:25.218\nolder WIndows machines used\nthis master browser solution.\n\n517\n00:25:25.218 --> 00:25:28.976\nIf you don't have any Windows machines on\nyour network, if you've got all Linux or\n\n518\n00:25:28.976 --> 00:25:32.548\nLinux and Mac, and you just happen to be\nusing Samba because, because [LAUGH].\n\n519\n00:25:32.548 --> 00:25:34.567\n&gt;&gt; [LAUGH]\n&gt;&gt; Well, that can be a problem,\n\n520\n00:25:34.567 --> 00:25:37.760\nbecause you need at least one\nmaster browser on the network.\n\n521\n00:25:37.760 --> 00:25:41.840\nSo if I want my system to be\nable to perform that role,\n\n522\n00:25:41.840 --> 00:25:44.570\nI'll wanna turn on\nthe NMB service as well.\n\n523\n00:25:44.570 --> 00:25:47.200\nFortunately, it doesn't really have any\nconfiguration that we need to mess with by\n\n524\n00:25:47.200 --> 00:25:49.140\ndefault, it works pretty\nwell out of the box.\n\n525\n00:25:49.140 --> 00:25:56.270\nSo I'm gonna enable the NMB service, and\nI'm gonna go ahead and start it as well.\n\n526\n00:25:56.270 --> 00:25:59.200\nThat's going to allow me to become\nthe master browser, and I need to do that\n\n527\n00:25:59.200 --> 00:26:02.880\nbecause I have this server that's\nrunning Red Hat Enterprise Linux.\n\n528\n00:26:02.880 --> 00:26:06.706\nI've got my desktop that's running\nRed Hat Enterprise Linux Workstation.\n\n529\n00:26:06.706 --> 00:26:08.990\nI think I've got another virtual\nmachine that's running Ubuntu,\n\n530\n00:26:08.990 --> 00:26:10.970\nso I'm in an all Linux environment.\n\n531\n00:26:10.970 --> 00:26:14.670\nI need that master browser, so\nI'm gonna start up the NMB service.\n\n532\n00:26:14.670 --> 00:26:17.584\nEven if I had Windows machines,\nI could still do this and\n\n533\n00:26:17.584 --> 00:26:20.008\nhave it potentially\nbecome a master browser.\n\n534\n00:26:20.008 --> 00:26:23.720\nBut it will normally get outvoted, one of\nthe Windows machines will typically win.\n\n535\n00:26:23.720 --> 00:26:26.306\nSo that's up,\nI'm technically running Samba,\n\n536\n00:26:26.306 --> 00:26:29.455\nthere's a couple commands we\ncan use to check it real quick.\n\n537\n00:26:29.455 --> 00:26:33.563\nSo for example, I could try and\nconnect to my user account,\n\n538\n00:26:33.563 --> 00:26:37.520\nusers aren't authorized in\nSamba by default, though.\n\n539\n00:26:37.520 --> 00:26:39.220\nSo if I wanna test with like my account,\n\n540\n00:26:39.220 --> 00:26:42.620\nmy dpezet account,\nI would need to assign a Samba password.\n\n541\n00:26:43.860 --> 00:26:47.870\nIf I was connected to a domain, that's\nwhere the Samba passwords would come from.\n\n542\n00:26:47.870 --> 00:26:52.401\nI'm not connected to a domain,\nso I need to do smb passwd,\n\n543\n00:26:52.401 --> 00:26:55.092\nand point that at my, oops, -a.\n\n544\n00:26:55.092 --> 00:26:58.191\nSo I'm gonna add a Samba\npassword to my user account, and\n\n545\n00:26:58.191 --> 00:27:00.980\nI'll just provide what I\nwant that password to be.\n\n546\n00:27:00.980 --> 00:27:03.890\nAnd that's gonna enable\nmy user account in Samba.\n\n547\n00:27:03.890 --> 00:27:07.220\nIf I've got ten user accounts,\nI'll need to enable each one of them.\n\n548\n00:27:07.220 --> 00:27:09.690\nIt becomes a burden after awhile, so\nwhen your network grows large enough,\n\n549\n00:27:09.690 --> 00:27:12.850\nthey expect you to have a Windows domain\ncontroller to pull all this from.\n\n550\n00:27:12.850 --> 00:27:14.002\nBut in a small environment,\n\n551\n00:27:14.002 --> 00:27:16.940\nyou can just attach that\npassword right here to each one.\n\n552\n00:27:16.940 --> 00:27:21.340\nSo, now I can use the SMB client\nto be able to connect and look and\n\n553\n00:27:21.340 --> 00:27:22.280\nsee how things are doing.\n\n554\n00:27:22.280 --> 00:27:28.920\nSo for example, I can say smb-l localhost,\n\n555\n00:27:28.920 --> 00:27:32.070\nand I can examine the local host and\nsee how things are going.\n\n556\n00:27:32.070 --> 00:27:39.590\nNow, shoot, it's, I forgot, I did a sudo\nshell, so I'm actually running as root.\n\n557\n00:27:39.590 --> 00:27:43.420\nAnd so what you'll see here is that my\nroot user is gonna fail, because I didn't\n\n558\n00:27:43.420 --> 00:27:48.925\ndo an smb passwd for my root user.\n\n559\n00:27:48.925 --> 00:27:52.640\nCuz normally, you wouldn't want your\nroot user functioning inside of Samba.\n\n560\n00:27:52.640 --> 00:27:56.330\nSo I'm gonna exit out of my root shell,\nso now I'm back to being good old dpezet.\n\n561\n00:27:57.330 --> 00:28:02.940\nAnd I'll do a Samba client-Localhost,\n\n562\n00:28:02.940 --> 00:28:06.720\nand I'll provide my password, and there.\n\n563\n00:28:06.720 --> 00:28:10.102\nSo what we should see is that\nit shows each of the shares.\n\n564\n00:28:10.102 --> 00:28:14.898\nPrint$, dpezet,\nthat's my home directory, and\n\n565\n00:28:14.898 --> 00:28:19.592\nI'm seeing the server,\nDonsLab is my workgroup.\n\n566\n00:28:19.592 --> 00:28:22.950\nAnd then Lab/Server01 is\nthe master browser on the network.\n\n567\n00:28:22.950 --> 00:28:27.060\nI can see that it's up, I can see\nthat it's working and it's running.\n\n568\n00:28:28.110 --> 00:28:33.020\nIt is, however, not the best view that\nI've got, cuz remember, SE Linux,\n\n569\n00:28:33.020 --> 00:28:36.670\nhow I set it not to do home directories,\nbut I see my home directory right here.\n\n570\n00:28:36.670 --> 00:28:40.420\nIf I were to browse into it, it is gonna\nbe blocked, so it is being advertised,\n\n571\n00:28:40.420 --> 00:28:42.690\nbut I can't get to it,\ncuz SE Linux is stopping it.\n\n572\n00:28:42.690 --> 00:28:44.230\nAnd this is a local view, so\n\n573\n00:28:44.230 --> 00:28:46.550\nit's not necessarily indicative\nof what we'd get on the network.\n\n574\n00:28:46.550 --> 00:28:49.748\nBut it is a quick way to test and\nmake sure that everything is up and\n\n575\n00:28:49.748 --> 00:28:53.611\nrunning, and I at least think that I'm\nadvertising this out to the network.\n\n576\n00:28:53.611 --> 00:28:56.717\n&gt;&gt; So Don, do we have time for\ntalking about firewall access, or\n\n577\n00:28:56.717 --> 00:28:58.670\nshould we save that for a part two?\n\n578\n00:28:58.670 --> 00:29:02.152\n&gt;&gt; Yeah, in an ideal world,\nwe just enough time [LAUGH].\n\n579\n00:29:02.152 --> 00:29:04.119\n&gt;&gt; [LAUGH]\n&gt;&gt; In an ideal world,\n\n580\n00:29:04.119 --> 00:29:06.900\nwe'd test this from\nthe network if I had more time.\n\n581\n00:29:06.900 --> 00:29:09.890\nRight now I know I've go a problem with\nthe firewall, like Zach mentioned.\n\n582\n00:29:09.890 --> 00:29:13.990\nIt might look great right here from the\nserver itself, but when I go to my client,\n\n583\n00:29:13.990 --> 00:29:15.370\nit doesn't look so great anymore.\n\n584\n00:29:15.370 --> 00:29:19.970\nSo I do need to do a little bit more,\nI'm gonna switch back to\n\n585\n00:29:19.970 --> 00:29:24.980\na root shell, and I'm gonna do a quick\n\n586\n00:29:24.980 --> 00:29:31.680\nfirewall-cmd--permanent--add-service=sa-\nmba.\n\n587\n00:29:31.680 --> 00:29:34.370\nI need to add the Samba\nservice to the firewall list,\n\n588\n00:29:34.370 --> 00:29:36.230\nto allow it to pass through.\n\n589\n00:29:36.230 --> 00:29:40.403\nAnd if I'm on a client, or even on\nthe server, I need to do -client as well,\n\n590\n00:29:40.403 --> 00:29:44.170\nbecause that's gonna allow\nthe client protocols to connect in.\n\n591\n00:29:44.170 --> 00:29:47.342\nSo I want to be able to have\nthose cleared and authorized.\n\n592\n00:29:47.342 --> 00:29:50.090\nNow, I did those as permanent, so\nit'll only take effect after reboot.\n\n593\n00:29:50.090 --> 00:29:54.450\nI could reload the firewall, or I can\njust run it again without permanent, and\n\n594\n00:29:54.450 --> 00:29:56.060\nthat'll get that going, so\nthat clears the firewall.\n\n595\n00:29:56.060 --> 00:29:57.050\nSo now in theory,\n\n596\n00:29:57.050 --> 00:30:01.250\npeople on the network should be able\nto browse through and get to me.\n\n597\n00:30:01.250 --> 00:30:05.480\nNow, to test from somebody else, I could\nuse the Samba client to connect and\n\n598\n00:30:05.480 --> 00:30:06.540\nlook and see how things are going.\n\n599\n00:30:06.540 --> 00:30:10.280\nI could test a few other things,\nI didn't test NMB, so\n\n600\n00:30:10.280 --> 00:30:14.430\nI did a smb client-Localhost.\n\n601\n00:30:14.430 --> 00:30:17.890\nThat was how I tested that\na few moments ago, and\n\n602\n00:30:17.890 --> 00:30:20.130\njust kinda checked it on the SMB side.\n\n603\n00:30:20.130 --> 00:30:26.790\nIf I want to check on the NMB side,\nI could, get back to my user account.\n\n604\n00:30:26.790 --> 00:30:29.897\nI'll do an nmb lookup, and\n\n605\n00:30:29.897 --> 00:30:34.502\nI can do a name lookup against my server.\n\n606\n00:30:34.502 --> 00:30:38.378\nNow when I do a name lookup, I can say -u\nlocalhost, so I'm just gonna do a lookup\n\n607\n00:30:38.378 --> 00:30:41.638\nright here against the local host,\nand then I could provide a name.\n\n608\n00:30:41.638 --> 00:30:44.637\nI'm gonna have a little problem here,\nmy lm host file is empty, so\n\n609\n00:30:44.637 --> 00:30:46.043\nI haven't defined any names.\n\n610\n00:30:46.043 --> 00:30:47.857\nAnd it hasn't learned any\nnames from the network,\n\n611\n00:30:47.857 --> 00:30:49.300\ncuz I don't have any Windows machines.\n\n612\n00:30:49.300 --> 00:30:51.130\nBut if there was a Windows\nmachine on the network,\n\n613\n00:30:51.130 --> 00:30:52.670\nI could type something like labserver02.\n\n614\n00:30:52.670 --> 00:30:55.370\nAnd it would test that lookup and\n\n615\n00:30:55.370 --> 00:30:59.360\nrespond back if it could find some\nkind of answer for what that was.\n\n616\n00:30:59.360 --> 00:31:02.400\nSo that's a way that we could\ntest that other side, but\n\n617\n00:31:02.400 --> 00:31:05.010\nat this point,\nwe've got the server up and running.\n\n618\n00:31:05.010 --> 00:31:09.860\nWe've cleared it through security,\nSE Linux is happy, the firewall is happy.\n\n619\n00:31:09.860 --> 00:31:10.700\nWe're up and running,\n\n620\n00:31:10.700 --> 00:31:15.000\nbut we haven't actually created\na shared file, a shared folder.\n\n621\n00:31:15.000 --> 00:31:17.500\nWe got the default stuff,\nwhich most of it, we're not using.\n\n622\n00:31:17.500 --> 00:31:21.245\nI don't have any printers,\nI'm not sharing my home directory, so\n\n623\n00:31:21.245 --> 00:31:23.690\nwe haven't really achieved anything yet.\n\n624\n00:31:23.690 --> 00:31:28.570\nBut we have brought the server up, and\nso we're gonna go on to a part two.\n\n625\n00:31:28.570 --> 00:31:29.329\n&gt;&gt; There you go.\n\n626\n00:31:29.329 --> 00:31:32.030\n&gt;&gt; And in part two I'll walk you through\nwhat's more of the day to day stuff.\n\n627\n00:31:32.030 --> 00:31:34.850\nSo everything that you saw here on this\nepisode is just kind of a one-time thing.\n\n628\n00:31:34.850 --> 00:31:38.160\nWe go through and we do this stuff one\ntime, we get it set up and it's done.\n\n629\n00:31:38.160 --> 00:31:41.999\nAnd then after that, the rest of time is\nspent adding shares, changing permissions,\n\n630\n00:31:41.999 --> 00:31:45.483\nand maintaining the server, and so\nthat's what we're gonna see in part two.\n\n631\n00:31:45.483 --> 00:31:49.101\nI'll show you guys how to add a share, and\nwe'll actually get a client connected up\n\n632\n00:31:49.101 --> 00:31:52.630\nto it and see that access over the network\nand kind of run through that process.\n\n633\n00:31:52.630 --> 00:31:57.034\nSo I would do it now, but we've run\nour time out, so I will save that for\n\n634\n00:31:57.034 --> 00:31:57.717\npart two.\n\n635\n00:31:57.717 --> 00:32:01.075\n&gt;&gt; So in part two of installing Samba,\nwe'll actually be using Samba, and\n\n636\n00:32:01.075 --> 00:32:02.462\nthat will be exciting to see.\n\n637\n00:32:02.462 --> 00:32:05.124\nYou wanna add anything else,\nor are we ready to go?\n\n638\n00:32:05.124 --> 00:32:07.777\n&gt;&gt; I think we're ready to go on this one,\neverything that we did here was pretty\n\n639\n00:32:07.777 --> 00:32:09.864\nimportant, pretty standard\nacross the various distros.\n\n640\n00:32:09.864 --> 00:32:13.785\nWhat we'll see next is where things get\ncustomized based on your environment.\n\n641\n00:32:13.785 --> 00:32:17.353\n&gt;&gt; Okay, so installing Samba part\ntwo coming up, you did see part one.\n\n642\n00:32:17.353 --> 00:32:18.530\nAnd there'll be a lot more,\n\n643\n00:32:18.530 --> 00:32:21.528\nand there is a lot more in becoming\na Linux server administrator series.\n\n644\n00:32:21.528 --> 00:32:25.555\nSo make sure you watch all the episodes,\nyou'll be very glad that you did.\n\n645\n00:32:25.555 --> 00:32:28.608\nAnd thank you for\nwatching ITProTV, remember,\n\n646\n00:32:28.608 --> 00:32:31.890\na good IT pro is always learning,\nI'm Zach Memos.\n\n647\n00:32:31.890 --> 00:32:32.636\n&gt;&gt; And I'm Don Pezet.\n\n648\n00:32:32.636 --> 00:32:33.720\n&gt;&gt; And we will see you soon.\n\n649\n00:32:33.720 --> 00:32:41.148\n[MUSIC]\n\n650\n00:32:41.148 --> 00:32:43.576\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "229134124"
        },
        {
          "description": "Don and Zach talk about practical usage of Samba, sharing folders, adding folder to Samba's config file, testing to see if the share is advertised, end user access to folder, mounting a Samba share in Linux, and using GUI.",
          "length": "1545",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-8-1-2-installing_samba_pt_2-080917.00_25_57_28.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-8-1-2-installing_samba_pt_2-080917.00_25_57_28.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-8-1-2-installing_samba_pt_2-080917.00_25_57_28.Still001-sm.jpg",
          "title": "Installing Samba Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.290 --> 00:00:02.704\nWelcome to ITPro TV,\nI'm your host Don Pezet.\n\n2\n00:00:02.704 --> 00:00:06.397\n&gt;&gt; [CROSSTALK]\n\n3\n00:00:06.397 --> 00:00:08.183\n&gt;&gt; [MUSIC]\n\n4\n00:00:08.183 --> 00:00:11.954\n&gt;&gt; You're watching ITProTV.\n\n5\n00:00:11.954 --> 00:00:15.908\n&gt;&gt; Hello, you're watching ITProTV,\nwhere we help you learn wherever you go.\n\n6\n00:00:15.908 --> 00:00:17.610\nI'm your host, Zach Memos.\n\n7\n00:00:17.610 --> 00:00:20.700\nAs we continue on with becoming\na Linux Server Administrator,\n\n8\n00:00:20.700 --> 00:00:23.980\nthis is installing Samba Part Two.\n\n9\n00:00:23.980 --> 00:00:25.680\nAnd it's exciting as we\nmove forward with that.\n\n10\n00:00:25.680 --> 00:00:29.070\nAnd Don Pezet is gonna bring us all\nthat information because he knows so\n\n11\n00:00:29.070 --> 00:00:30.057\nmuch more than I do.\n\n12\n00:00:30.057 --> 00:00:31.867\n&gt;&gt; [LAUGH]\n&gt;&gt; He really does.\n\n13\n00:00:31.867 --> 00:00:33.110\n[LAUGH]\n&gt;&gt; At least about Samba.\n\n14\n00:00:33.110 --> 00:00:34.164\n&gt;&gt; About Samba.\n\n15\n00:00:34.164 --> 00:00:37.560\n&gt;&gt; Not the dance, but the protocol.\n\n16\n00:00:37.560 --> 00:00:40.587\nYep, so in this episode we are picking\nback up where we left off in part one,\n\n17\n00:00:40.587 --> 00:00:42.574\nwhich is,\nin part one we stood up a Samba server.\n\n18\n00:00:42.574 --> 00:00:43.141\n&gt;&gt; Yes.\n&gt;&gt; But\n\n19\n00:00:43.141 --> 00:00:47.132\nit wasn't terribly exciting because we\ndidn't actually create any shared content.\n\n20\n00:00:47.132 --> 00:00:49.475\nSo that the server is up and\nrunning but it's somewhat useless.\n\n21\n00:00:49.475 --> 00:00:53.391\n[LAUGH] So in this episode we're gonna\nfix that, we're going to make it less\n\n22\n00:00:53.391 --> 00:00:57.694\nuseless and actually share out a folder,\nand make it where our users can get to it.\n\n23\n00:00:57.694 --> 00:00:59.890\nSo that's what we've got coming\nup right here in this episode.\n\n24\n00:00:59.890 --> 00:01:02.230\n&gt;&gt; That's right.\nSo we got all the assembly out of the way.\n\n25\n00:01:02.230 --> 00:01:04.690\nWe're all set to go to actually use Samba.\n\n26\n00:01:04.690 --> 00:01:06.410\nSo how do we get started?\n\n27\n00:01:06.410 --> 00:01:08.543\n&gt;&gt; All right, so\nI wanna run through a scenario here.\n\n28\n00:01:08.543 --> 00:01:11.692\nAnd the scenario is I wanna\ncreate a shared folder that my\n\n29\n00:01:11.692 --> 00:01:13.460\nemployees can get to.\n\n30\n00:01:13.460 --> 00:01:16.908\nSo this folder will be available for\nthem to get to and store all their data,\n\n31\n00:01:16.908 --> 00:01:18.902\ncuz I don't wanna back up 100 laptops.\n\n32\n00:01:18.902 --> 00:01:20.936\nI want them all store the data\non the central share so\n\n33\n00:01:20.936 --> 00:01:22.507\nI could just back up the central share.\n\n34\n00:01:22.507 --> 00:01:24.028\nSo that's what I want to create.\n\n35\n00:01:24.028 --> 00:01:27.964\nSo step one,\nwe need to create that folder.\n\n36\n00:01:27.964 --> 00:01:30.123\nNow where we create\nthe folder is important.\n\n37\n00:01:30.123 --> 00:01:32.561\nSamba by default,\nif you have SE Linux in place,\n\n38\n00:01:32.561 --> 00:01:35.300\nSamba does not have access\nto your file system.\n\n39\n00:01:35.300 --> 00:01:38.480\nIt only has access to a couple of folders,\nthe folder where its configuration is\n\n40\n00:01:38.480 --> 00:01:41.760\nstored and the folder where\nthe printers are stored, that's it.\n\n41\n00:01:41.760 --> 00:01:43.899\nSo if I wanna share a file or\nshare a folder,\n\n42\n00:01:43.899 --> 00:01:47.475\nI've got to mess around with SE Linux\na little bit and get that cleared.\n\n43\n00:01:47.475 --> 00:01:48.960\nSo that's where I'm gonna start.\n\n44\n00:01:48.960 --> 00:01:52.820\nNow the most common place, and I'm on\nmy server, same server from part one.\n\n45\n00:01:52.820 --> 00:01:56.970\nI'm gonna bump up to a elevated\nprivilege shell here with sudo-s.\n\n46\n00:01:56.970 --> 00:02:00.816\nThe most common place to put\nthe shared folders is in /var, right?\n\n47\n00:02:00.816 --> 00:02:03.290\n/var might be a separate partition for\nyou.\n\n48\n00:02:03.290 --> 00:02:05.380\nIt might be on the same\npartition as your root.\n\n49\n00:02:05.380 --> 00:02:06.971\nIt just depends on how you set things up.\n\n50\n00:02:06.971 --> 00:02:09.267\nBut /var is where various data goes,\n\n51\n00:02:09.267 --> 00:02:12.147\nand this is certainly\ngoing to be various data.\n\n52\n00:02:12.147 --> 00:02:16.570\n[LAUGH] So I'm gonna go into /var and I'm\njust gonna make a folder which I'll call,\n\n53\n00:02:16.570 --> 00:02:17.910\nwe'll do corp, right?\n\n54\n00:02:17.910 --> 00:02:19.545\nSo this is gonna be my corporate data.\n\n55\n00:02:19.545 --> 00:02:24.850\nAnd i'm not creative with names so\nI'll just call it corp So /var/corp.\n\n56\n00:02:24.850 --> 00:02:28.990\nNow if I do a ls -l with a capital Z,\n\n57\n00:02:30.000 --> 00:02:34.760\nI can see the SE Linux context\nof that file, or folder.\n\n58\n00:02:34.760 --> 00:02:38.084\nAnd in this case, I can see that\nit's currently unconfined, right?\n\n59\n00:02:38.084 --> 00:02:40.180\nSo it's just a standard object.\n\n60\n00:02:40.180 --> 00:02:43.541\nAnd that means that Samba\nwill not have access to it.\n\n61\n00:02:43.541 --> 00:02:48.302\nSo in order for Samba to get to that, I'm\ngonna have to adjust those permissions and\n\n62\n00:02:48.302 --> 00:02:52.871\nmake sure that it's set so that it will\nhave that access and be able to get there.\n\n63\n00:02:52.871 --> 00:02:57.400\nSo we can fix that pretty easy with\na chcon, which is change context.\n\n64\n00:02:57.400 --> 00:03:01.160\nAnd I will just punch that in with a,\nI'm gonna do a -r,\n\n65\n00:03:01.160 --> 00:03:04.160\ncuz I'm in the habit of doing it,\nwhich is make it recursive.\n\n66\n00:03:04.160 --> 00:03:06.540\nIf there were subfolders I'd\nwanna change their context, too.\n\n67\n00:03:06.540 --> 00:03:10.080\nI just made this, so I don't need the -r,\nbut I'll do it anyway.\n\n68\n00:03:10.080 --> 00:03:11.740\nAnd then a v for verbose.\n\n69\n00:03:11.740 --> 00:03:15.090\nIf there's any errors I wanna\nsee the errors in detail.\n\n70\n00:03:15.090 --> 00:03:16.624\nAnd the context type is,\n\n71\n00:03:16.624 --> 00:03:20.726\nthis is really the tricky part\nis remembering the context_type.\n\n72\n00:03:20.726 --> 00:03:25.924\nThe context_type here is samba_share_t,\nright?\n\n73\n00:03:25.924 --> 00:03:31.280\nThat's the context_type that\nI wanna assign to /var/corp.\n\n74\n00:03:31.280 --> 00:03:34.111\nSo that's what's gonna clear\nit to be able to get in there.\n\n75\n00:03:34.111 --> 00:03:37.943\nAnd then I can verify that took\neffect by looking back in here.\n\n76\n00:03:37.943 --> 00:03:40.542\nAnd sure enough,\nI can see that samba share is defined.\n\n77\n00:03:40.542 --> 00:03:43.240\nIt's got the right context on that folder.\n\n78\n00:03:43.240 --> 00:03:46.870\nSo now we're clear there to be able to use\nthis folder in the way that we attended.\n\n79\n00:03:46.870 --> 00:03:48.970\nNow I might need to change\nthe permissions on the folder.\n\n80\n00:03:48.970 --> 00:03:53.220\nRemember that Samba does obey\nthe Unix ACLs, the Access Control Lists.\n\n81\n00:03:53.220 --> 00:03:55.550\nAnd right now, looking at that file,\n\n82\n00:03:55.550 --> 00:04:00.210\nit's set where it's owned by root,\nand it's got those privileges set.\n\n83\n00:04:00.210 --> 00:04:01.530\nThat's not what I want.\n\n84\n00:04:01.530 --> 00:04:04.200\nThis is gonna be a central share for\nmy employees.\n\n85\n00:04:04.200 --> 00:04:06.060\nSo I need my employees to\nbe able to access this.\n\n86\n00:04:06.060 --> 00:04:09.800\nSo we're going to have to worry about\nfixing the ACL a little bit to match more\n\n87\n00:04:09.800 --> 00:04:13.740\nof what we need to have\ninside of our environment.\n\n88\n00:04:13.740 --> 00:04:16.890\nSo as we go through and get this set up,\n\n89\n00:04:16.890 --> 00:04:19.850\npermissions will be kind of\na recurring theme that we run into.\n\n90\n00:04:19.850 --> 00:04:22.320\nSo let's do a little\nbit of groundwork here.\n\n91\n00:04:22.320 --> 00:04:24.860\nI've got a user account myself,\nDPezet, right?\n\n92\n00:04:24.860 --> 00:04:28.240\nAnd I've already given myself a Samba\npassword in the first episode so\n\n93\n00:04:28.240 --> 00:04:29.750\nthat I could test this stuff out.\n\n94\n00:04:29.750 --> 00:04:33.070\nBut if I have other employees,\nI need to define them.\n\n95\n00:04:33.070 --> 00:04:35.442\nSo maybe I want Zach to be able to log in.\n\n96\n00:04:35.442 --> 00:04:36.052\n&gt;&gt; Thank you.\n\n97\n00:04:36.052 --> 00:04:38.687\n&gt;&gt; So I would come in, yeah, well,\nyou know you need access, so\n\n98\n00:04:38.687 --> 00:04:40.527\nI would want to have a user account for\nhim.\n\n99\n00:04:40.527 --> 00:04:42.714\nBut I don't want to manage\npermissions based on users,\n\n100\n00:04:42.714 --> 00:04:44.120\nI want to manage it based on groups.\n\n101\n00:04:44.120 --> 00:04:45.720\nThat's the better way to go about it.\n\n102\n00:04:45.720 --> 00:04:49.320\nSo for the groups,\nI need to create a group there, too.\n\n103\n00:04:49.320 --> 00:04:53.020\nSo I'm gonna say group add corp.\n\n104\n00:04:53.020 --> 00:04:54.800\nNow I'm using the same name as the folder.\n\n105\n00:04:54.800 --> 00:04:55.700\nYou certainly don't have to do that.\n\n106\n00:04:55.700 --> 00:04:57.760\nThis is just gonna be my corporate users,\nright?\n\n107\n00:04:57.760 --> 00:04:59.850\nI could call it that, corporate users, but\n\n108\n00:04:59.850 --> 00:05:02.030\nI'll just call it corp\ncuz it's less to type.\n\n109\n00:05:02.030 --> 00:05:03.850\nSo I'm gonna create that group.\n\n110\n00:05:03.850 --> 00:05:07.320\nAnd then I'll come in and\nI'll say, user add, and\n\n111\n00:05:07.320 --> 00:05:10.850\nI'll do Zach, and you do Z-A-C-H, right?\n\n112\n00:05:10.850 --> 00:05:12.952\n&gt;&gt; That's exactly right.\n\n113\n00:05:12.952 --> 00:05:13.845\n&gt;&gt; No K, Z-A-C-K.\n\n114\n00:05:13.845 --> 00:05:17.860\nSo I'll do user as Zach and\nwe're gonna create that account for him.\n\n115\n00:05:17.860 --> 00:05:25.377\nAnd then I'm gonna do\na usermod -a -g corp Zach.\n\n116\n00:05:25.377 --> 00:05:28.383\nI'm gonna add Zach to the corp group,\nright?\n\n117\n00:05:28.383 --> 00:05:32.047\nAnd I can go ahead and\nadd myself while I'm in here.\n\n118\n00:05:32.047 --> 00:05:33.903\nOops, I'm gonna do it one at a time.\n\n119\n00:05:33.903 --> 00:05:37.410\nAnd I can get myself added to it so\nthat we're both in that corporate group.\n\n120\n00:05:37.410 --> 00:05:41.030\nAnd that way when I assign permissions\nto the group, we'll both get it.\n\n121\n00:05:41.030 --> 00:05:43.500\nAnd as I hire new employees,\nI just throw them in that group and\n\n122\n00:05:43.500 --> 00:05:44.710\nthey'll get the access, too, right?\n\n123\n00:05:44.710 --> 00:05:48.180\nSo this is a little bit better\nof a structure for me to have.\n\n124\n00:05:48.180 --> 00:05:50.477\nNow in order for\nsomebody to be able to log in,\n\n125\n00:05:50.477 --> 00:05:52.542\nthey're gonna have to have a password.\n\n126\n00:05:52.542 --> 00:05:55.110\nAnd there's actually two different\npasswords we have to worry about here.\n\n127\n00:05:55.110 --> 00:05:58.757\nThere's the Unix password that\nwe set with the passwd command.\n\n128\n00:05:58.757 --> 00:06:00.876\nSo I need to set a password for Zach.\n\n129\n00:06:00.876 --> 00:06:03.510\nAnd so I'll come in and\nI'll set a password so\n\n130\n00:06:03.510 --> 00:06:05.920\nthat he'll be able to use\nhis user account, okay?\n\n131\n00:06:05.920 --> 00:06:09.902\nBut then there's the Samba password.\n\n132\n00:06:09.902 --> 00:06:13.000\nAnd so I need to define that\nSamba password for him.\n\n133\n00:06:13.000 --> 00:06:15.990\nAnd they can be the same thing if\nyou want, or they can be different.\n\n134\n00:06:16.990 --> 00:06:18.476\nAnd so, oops, sorry, sorry.\n\n135\n00:06:18.476 --> 00:06:21.635\nSome of the password -a,\nI'm adding a password to his account.\n\n136\n00:06:21.635 --> 00:06:23.145\nI am not actually creating his account.\n\n137\n00:06:23.145 --> 00:06:24.050\nSo there we go.\n\n138\n00:06:24.050 --> 00:06:27.045\nThat'll fix that error, and\nwe'll get that in place.\n\n139\n00:06:27.045 --> 00:06:27.627\nThere we go.\n\n140\n00:06:27.627 --> 00:06:32.047\nSo now we've added Zach to the Samba list\nof people that are allowed to use Samba.\n\n141\n00:06:32.047 --> 00:06:36.157\nI'm in, from the last episode,\nhe's in, and groups are in my default.\n\n142\n00:06:36.157 --> 00:06:40.854\nSo the corp group is gonna be available\nfor permissions and set there, too.\n\n143\n00:06:40.854 --> 00:06:44.244\nSo I've now kinda set up my user\nstructure the way that I want, and\n\n144\n00:06:44.244 --> 00:06:47.407\nnow I need to update\nthe directory to reflect that.\n\n145\n00:06:47.407 --> 00:06:52.960\nThe directory right now Is owned by root,\nand the group is root.\n\n146\n00:06:52.960 --> 00:06:57.821\nAnd the permissions, actually I don't\nremember looking at the permissions.\n\n147\n00:06:57.821 --> 00:06:59.655\nLet me just pull those back up.\n\n148\n00:06:59.655 --> 00:07:01.550\n[LAUGH] So\nthe root user has rewrite and execute.\n\n149\n00:07:01.550 --> 00:07:03.920\nThe group only has read and\nexecute right now.\n\n150\n00:07:03.920 --> 00:07:05.630\nWrong folder, this one.\n\n151\n00:07:05.630 --> 00:07:08.830\nSo if I were to set the group to\ncorp it wouldn't be able to write,\n\n152\n00:07:08.830 --> 00:07:09.980\nit would only have read access.\n\n153\n00:07:09.980 --> 00:07:11.900\nSo I wanna fix that, too.\n\n154\n00:07:11.900 --> 00:07:17.245\nSo what I'm gonna do is\nI'm gonna say chmod 770.\n\n155\n00:07:17.245 --> 00:07:19.608\nI want the owner to have read,\nwrite, and execute, and\n\n156\n00:07:19.608 --> 00:07:22.140\nI want the group to have read,\nwrite, and execute.\n\n157\n00:07:22.140 --> 00:07:26.521\nAnd I want everybody else to\nhave nothing for /var /corp.\n\n158\n00:07:26.521 --> 00:07:29.070\nAnd if I had subfolders I'd\ndo this recursively, but\n\n159\n00:07:29.070 --> 00:07:30.259\nI don't have any cuz I just made this.\n\n160\n00:07:31.500 --> 00:07:34.850\nThen I'm gonna do a change owner, and\n\n161\n00:07:34.850 --> 00:07:40.220\nI'm gonna make myself the owner, and\nI'll make corp the group, right?\n\n162\n00:07:40.220 --> 00:07:43.140\nAnd I'll set that on /var/corp.\n\n163\n00:07:43.140 --> 00:07:46.000\nBut again, I just made this,\nso there's no subfolders.\n\n164\n00:07:46.000 --> 00:07:48.436\nOtherwise I would do this recursively\nto get everything inside it as well.\n\n165\n00:07:48.436 --> 00:07:52.931\nBut now, Zach and I are both in the corp\ngroup, and so he and I are gonna get read,\n\n166\n00:07:52.931 --> 00:07:54.696\nwrite, and execute, right?\n\n167\n00:07:54.696 --> 00:07:55.722\nWe'll have access to that folder.\n\n168\n00:07:55.722 --> 00:07:58.549\nAnd then I'm the owner so I'll have read,\nwrite and execute anyway.\n\n169\n00:07:58.549 --> 00:08:03.279\nBut if I have ten or a hundred\nemployees I don't want to list each one\n\n170\n00:08:03.279 --> 00:08:07.854\nindividual it becomes tough you\nhave to do the Unix FACLs facts.\n\n171\n00:08:07.854 --> 00:08:11.036\nBut here I have used manage\nit with a simple group and\n\n172\n00:08:11.036 --> 00:08:15.921\nI'm done so that makes life a lot easier\nso now the permissions are set right and\n\n173\n00:08:15.921 --> 00:08:20.810\nif I take a look at the permissions\non that folder again right here.\n\n174\n00:08:20.810 --> 00:08:25.650\nI can see where I'm the owner, Corp is\nthe group and we both get read, write and\n\n175\n00:08:25.650 --> 00:08:26.530\nexecute.\n\n176\n00:08:26.530 --> 00:08:27.864\nI might wanna drop execute on this.\n\n177\n00:08:27.864 --> 00:08:30.794\nUsually it doesn't matter cuz it's\na network share, if they try and\n\n178\n00:08:30.794 --> 00:08:34.550\nexecute, it's gonna execute on their own\nmachine anyway or at least through Samba.\n\n179\n00:08:34.550 --> 00:08:36.061\nSo I'm not so worried about that there.\n\n180\n00:08:36.061 --> 00:08:40.733\nBut I've got the privileges assigned and\nthat's good.\n\n181\n00:08:40.733 --> 00:08:45.010\nAll right, so\nnext we've already setup Samba.\n\n182\n00:08:46.220 --> 00:08:49.140\nI do want to,\nI mean we already setup SELinux.\n\n183\n00:08:49.140 --> 00:08:51.415\nI do wanna throw out one\nquick word of warning.\n\n184\n00:08:51.415 --> 00:08:57.040\nYou'll find a lot of tutorials on\nthe internet for how to setup Samba.\n\n185\n00:08:57.040 --> 00:09:02.850\nAnd what I showed you earlier where\nI did the ch con, right here,\n\n186\n00:09:02.850 --> 00:09:08.180\nI changed the context to this folder to\ngive Samba access to this one folder.\n\n187\n00:09:08.180 --> 00:09:10.250\nSamba already had access\nto its config folder and\n\n188\n00:09:10.250 --> 00:09:12.600\nthe printers now it has\naccess to this one.\n\n189\n00:09:12.600 --> 00:09:16.770\nI don't want samba to be able\nto access the entire hard drive,\n\n190\n00:09:16.770 --> 00:09:17.560\nright you want limited.\n\n191\n00:09:17.560 --> 00:09:18.790\nThat's what SC Linux is all about.\n\n192\n00:09:20.260 --> 00:09:22.630\nYou'll see tutorials\nthat do this differently.\n\n193\n00:09:22.630 --> 00:09:25.000\nSome of them will use a different command.\n\n194\n00:09:25.000 --> 00:09:29.317\nThey'll change an SELinux Boolean,\nright, and\n\n195\n00:09:29.317 --> 00:09:34.558\nI talked about the Booleans in\nthe last episode, but you'll\n\n196\n00:09:34.558 --> 00:09:41.680\nsee where they'll tell you to do set\nsebool-p samba export all rw1, like that.\n\n197\n00:09:43.080 --> 00:09:47.880\nWhat that does is it gives\nSamba read write access\n\n198\n00:09:47.880 --> 00:09:51.970\nto the entire file system and that will\nsolve your problem that will you get\n\n199\n00:09:51.970 --> 00:09:52.535\nin there\n&gt;&gt; Yeah.\n\n200\n00:09:52.535 --> 00:09:55.170\n&gt;&gt; But it's not really ideal.\n\n201\n00:09:55.170 --> 00:09:58.231\nOkay and\nI do wanna explain I wanna show you this\n\n202\n00:09:58.231 --> 00:10:02.171\noption cuz there is one time\nwhere you might want this okay?\n\n203\n00:10:02.171 --> 00:10:06.997\nWhat if,\nI wanna share a folder in Samba, but\n\n204\n00:10:06.997 --> 00:10:13.730\nthat folder already has a SELinux\ncontext for something else.\n\n205\n00:10:14.750 --> 00:10:19.575\nMaybe it's a folder where\nI store my webpages.\n\n206\n00:10:19.575 --> 00:10:26.560\nSo I've got Apache set up, and the folder\nhas the SELinux context for Apache.\n\n207\n00:10:26.560 --> 00:10:28.455\nAnd so, Samba isn't allowed to access it.\n\n208\n00:10:28.455 --> 00:10:31.523\nAnd if I change the context of the folder,\nit'll give Samba access and\n\n209\n00:10:31.523 --> 00:10:34.680\ntake it away from Apache, that would\nbe bad there's a conflict right?\n\n210\n00:10:34.680 --> 00:10:37.423\nSo, if that happens,\nI've now got a problem.\n\n211\n00:10:37.423 --> 00:10:41.120\nAnd so, a lot of people do this right\nhere, where they say, you know what,\n\n212\n00:10:41.120 --> 00:10:44.233\nlet me just give Samba access to\nthe whole stinking hard drive,\n\n213\n00:10:44.233 --> 00:10:45.429\nthe whole file system.\n\n214\n00:10:45.429 --> 00:10:48.280\nAnd now I don't have to worry\nabout that context anymore.\n\n215\n00:10:48.280 --> 00:10:51.521\nAnd then it works but\nit's not very secure, all right.\n\n216\n00:10:51.521 --> 00:10:55.945\nSo a better option, if you run into a\nscenario like that where you're trying to\n\n217\n00:10:55.945 --> 00:10:58.895\nshare a folder and\nit's already got a context on it,\n\n218\n00:10:58.895 --> 00:11:03.050\nwould be to create a custom context\ninside of SE Linux that gives Apache and\n\n219\n00:11:03.050 --> 00:11:05.578\nSamba access to that folder, right.\n\n220\n00:11:05.578 --> 00:11:09.201\nIf you wanna learn more about that,\nit goes a little bit outside the scope of\n\n221\n00:11:09.201 --> 00:11:12.840\nthis show, as an ITProTV subscriber\nyou have access to our whole library.\n\n222\n00:11:12.840 --> 00:11:16.540\nSo jump over to\nthe Redhat Enterprise Linus show.\n\n223\n00:11:16.540 --> 00:11:18.010\nAnd I do a whole section on SELinux.\n\n224\n00:11:18.010 --> 00:11:20.130\nAnd I show you how to create\ncustom modules in there.\n\n225\n00:11:20.130 --> 00:11:23.970\nIt's really not that hard but it is\nabout ten steps to go ahead and do it.\n\n226\n00:11:23.970 --> 00:11:26.141\nI don't have the time in\nthis episode to tackle that,\n\n227\n00:11:26.141 --> 00:11:27.684\nbut check out that episode-\n&gt;&gt; Good advice.\n\n228\n00:11:27.684 --> 00:11:29.890\n&gt;&gt; Cuz I show you exactly\nhow to create it.\n\n229\n00:11:29.890 --> 00:11:31.724\nThis command right here, I never do it.\n\n230\n00:11:31.724 --> 00:11:35.115\nYou'll see a lot of people on the internet\nthat say it's a good idea and\n\n231\n00:11:35.115 --> 00:11:38.140\nthere's a reason why they\ndo it I just explained why.\n\n232\n00:11:38.140 --> 00:11:42.060\nI just don't like it,\nit really weakens security because Samba\n\n233\n00:11:42.060 --> 00:11:44.550\nis not a perfect protocol,\nit's got problems.\n\n234\n00:11:44.550 --> 00:11:47.500\nAnd if you've been following\nthe security news lately there was\n\n235\n00:11:47.500 --> 00:11:51.060\nthe eternal blue exploit which\nactually did apply to Samba.\n\n236\n00:11:51.060 --> 00:11:55.110\nAnd would effectively allow a remote\nattacker full access to your file system\n\n237\n00:11:55.110 --> 00:11:56.890\nmove it back, right?\n\n238\n00:11:56.890 --> 00:11:58.750\nUnless you haven't done this and\n\n239\n00:11:58.750 --> 00:12:02.220\nthen the attacker would only have access\nto the folders that Samba had access to.\n\n240\n00:12:02.220 --> 00:12:05.310\nSo it's all about limiting our exposure so\nthat's why don't like that one.\n\n241\n00:12:05.310 --> 00:12:08.340\nBut I did wanna point that out though\nbefore I just breezed right past it and\n\n242\n00:12:08.340 --> 00:12:11.150\nsome of you are wondering why\nI'm doing this different than\n\n243\n00:12:11.150 --> 00:12:12.055\nwhat the internet says.\n\n244\n00:12:12.055 --> 00:12:13.645\n[LAUGH]\n&gt;&gt; That's very good advice Dan thank\n\n245\n00:12:13.645 --> 00:12:14.291\nyou very much.\n\n246\n00:12:14.291 --> 00:12:16.550\n&gt;&gt; All right, so\nlet's see what else we wanna do?\n\n247\n00:12:16.550 --> 00:12:20.060\nOkay, I've created a folder,\nI've cleared it through SELinux,\n\n248\n00:12:20.060 --> 00:12:21.250\nI've assigned the permission.\n\n249\n00:12:21.250 --> 00:12:23.035\nWe created the users and\nthen group, and we got that set.\n\n250\n00:12:23.035 --> 00:12:26.260\nSo kinda move to a lot of the steps\nthat we need to get this ready.\n\n251\n00:12:26.260 --> 00:12:29.305\nNow I need to tell Samba about it.\n\n252\n00:12:29.305 --> 00:12:36.619\nOkay, so I need to edit\nthe /etc/samba/smb.conf file.\n\n253\n00:12:36.619 --> 00:12:39.787\nAnd each of these little\nsquare braced options,\n\n254\n00:12:39.787 --> 00:12:43.380\neach of these are kinda defining a share.\n\n255\n00:12:43.380 --> 00:12:44.908\nWell, except for\nthe global one that's just settings.\n\n256\n00:12:44.908 --> 00:12:46.980\nSo I'm gonna come in and\nI'm gonna add a new entry.\n\n257\n00:12:46.980 --> 00:12:49.980\nAnd I'm gonna call it, corp, right.\n\n258\n00:12:49.980 --> 00:12:52.920\nCuz this is my corp folder that I'm\ngonna be sharing out, all right.\n\n259\n00:12:52.920 --> 00:12:54.900\nAnd now I need to define this share,\n\n260\n00:12:54.900 --> 00:12:58.060\nletting you know what it is that I\nwanna make available to everybody.\n\n261\n00:12:58.060 --> 00:13:01.980\nThe options here, comment is actually\nan optional one, but again if\n\n262\n00:13:01.980 --> 00:13:05.340\nsomebody's browsing the network, they can\nkinda see the description of what this is.\n\n263\n00:13:05.340 --> 00:13:12.263\nSo I'll call it my central\ncorporate storage.\n\n264\n00:13:12.263 --> 00:13:16.469\nAfter a comment, I can specify the path\nthat's not optional I have to have a path.\n\n265\n00:13:16.469 --> 00:13:20.490\nThis one's /var/corp all right.\n\n266\n00:13:20.490 --> 00:13:25.042\nThen I can go and\ngive it a read only = no.\n\n267\n00:13:25.042 --> 00:13:28.170\nI need people to be able to write\nto this if they have permissions.\n\n268\n00:13:28.170 --> 00:13:30.160\nIf they don't have permissions,\nthey won't be able to write.\n\n269\n00:13:30.160 --> 00:13:32.645\nBut if I do readonly equals yes,\nI could create a read only share.\n\n270\n00:13:32.645 --> 00:13:37.810\nAnd, then regardless of what the ACLs say,\nthey will only have read access.\n\n271\n00:13:37.810 --> 00:13:41.630\nAnd sometimes you want that but,\nin this case, I don't.\n\n272\n00:13:43.880 --> 00:13:47.670\nAnd actually, I believe that is\nthe default, is read only no.\n\n273\n00:13:47.670 --> 00:13:49.234\nAnd so, what we'll see is,\nwhen I test this later,\n\n274\n00:13:49.234 --> 00:13:50.383\nthat option probably won't show up.\n\n275\n00:13:50.383 --> 00:13:52.640\nIf something is a default,\nit just won't show up.\n\n276\n00:13:52.640 --> 00:13:55.397\nBut, I like to put it here,\njust so I know that it is set.\n\n277\n00:13:55.397 --> 00:13:57.620\nAfter that we've got browseable.\n\n278\n00:13:58.660 --> 00:14:00.030\nAnd I'll say that browseable = yes.\n\n279\n00:14:00.030 --> 00:14:01.660\nI want people to be able to browse and\nfind it.\n\n280\n00:14:01.660 --> 00:14:02.900\nAnd that one actually is a default.\n\n281\n00:14:02.900 --> 00:14:04.530\nSo I know that one will disappear.\n\n282\n00:14:04.530 --> 00:14:10.170\nAnd then valid users, now here's where\nthings are gonna be a little different.\n\n283\n00:14:10.170 --> 00:14:13.812\nUp top where we had the home directory\nexample up here, see how it's got\n\n284\n00:14:13.812 --> 00:14:17.467\nthe valid users in its really this\nbig wild cards that catch everybody.\n\n285\n00:14:17.467 --> 00:14:19.680\nAll right I don't want that.\n\n286\n00:14:19.680 --> 00:14:24.831\nI want things to be a little more specific\nso down here I could say like Dpozet,\n\n287\n00:14:24.831 --> 00:14:27.857\nZack right I can add\neach of us individually.\n\n288\n00:14:27.857 --> 00:14:33.951\nOr I could say deposit me because I\nalways wanna make sure that I had access,\n\n289\n00:14:33.951 --> 00:14:35.616\nyou can say + corp.\n\n290\n00:14:35.616 --> 00:14:38.891\nAnd that plus sign is what tells\nit that it's a group not a user\n\n291\n00:14:38.891 --> 00:14:41.718\nif I just say corp it would\nlook very username corp but\n\n292\n00:14:41.718 --> 00:14:44.894\nI have a group named corp and\nthat's what I wanna point to.\n\n293\n00:14:44.894 --> 00:14:47.402\nOr you might have called yours\ncorporate users or whatever so\n\n294\n00:14:47.402 --> 00:14:49.772\nyou would just say plus followed\nby the name of the group.\n\n295\n00:14:49.772 --> 00:14:54.148\nSo if I log in for\nanybody in the corporate group they'll be\n\n296\n00:14:54.148 --> 00:14:58.542\nallowed access and\nthey'll be able to reach in and log in.\n\n297\n00:14:58.542 --> 00:14:59.422\nOnce they log in,\n\n298\n00:14:59.422 --> 00:15:02.900\ntheir user account will also be used\nto determine their permissions.\n\n299\n00:15:02.900 --> 00:15:06.508\nAnd I've kind of assigned mine wide open\nwith the read and rights, but you might be\n\n300\n00:15:06.508 --> 00:15:10.290\nmuch more restrictive on the Unix ACLs and\nthat will control their access from there.\n\n301\n00:15:11.730 --> 00:15:15.360\nAll right, once that's done,\nwe're pretty well in business.\n\n302\n00:15:15.360 --> 00:15:19.940\nThe configuration file is only read when\nSamba starts, so I do need to restart it.\n\n303\n00:15:19.940 --> 00:15:26.248\nSo I'll do a systemctl restart\nsmb.service and we'll restart that.\n\n304\n00:15:26.248 --> 00:15:29.502\nQuick little note here I left out.\n\n305\n00:15:29.502 --> 00:15:33.544\nIt's always a good idea to run\ntestparm first in case you made a typo\n\n306\n00:15:33.544 --> 00:15:35.870\nin the config file right?\n\n307\n00:15:35.870 --> 00:15:39.660\nIf I had tested first then\neverything would have shown okay and\n\n308\n00:15:39.660 --> 00:15:41.340\nI would know it's safe to restart.\n\n309\n00:15:41.340 --> 00:15:42.674\nI didn't test so if there was a problem,\n\n310\n00:15:42.674 --> 00:15:44.139\nit would have just\nbrought the server down.\n\n311\n00:15:44.139 --> 00:15:46.930\nAnd now the server's down\nwhile I'm troubleshooting.\n\n312\n00:15:46.930 --> 00:15:49.044\nSo I should have test it first I didn't\nfollow standard practices there.\n\n313\n00:15:49.044 --> 00:15:53.870\nSo let me just kinda stress that here\nrun testparm it'll check for errors.\n\n314\n00:15:53.870 --> 00:15:55.846\nAnd see how it's processing\nsection corp And\n\n315\n00:15:55.846 --> 00:15:58.969\nletting me know if there's a problem\nthere, and everything's okay.\n\n316\n00:15:58.969 --> 00:16:02.902\nAnd then it dumps it out and\nI can see it, and here's where I can see.\n\n317\n00:16:02.902 --> 00:16:06.817\nNotice how browseable equals yes is gone,\nbecause it was a default, so\n\n318\n00:16:06.817 --> 00:16:08.100\nI didn't need it.\n\n319\n00:16:08.100 --> 00:16:09.810\nBut it's putting the other things in here,\nand\n\n320\n00:16:09.810 --> 00:16:11.360\nit's actually written a little\ndifferent than I did.\n\n321\n00:16:11.360 --> 00:16:12.620\nI had a comma after my name,\n\n322\n00:16:12.620 --> 00:16:15.550\nit got rid of that, that means that\nI didn't actually need the comma.\n\n323\n00:16:15.550 --> 00:16:19.981\nSo it does a little bit of syntax clean\nup, it'll still be wrong in the file.\n\n324\n00:16:19.981 --> 00:16:24.519\n[LAUGH] But it's right in the runtime,\nso it kinda cleans that up for me.\n\n325\n00:16:24.519 --> 00:16:28.885\nRead only equals no, turns out that's\nnot a default, I thought it was.\n\n326\n00:16:28.885 --> 00:16:31.508\nSo anyhow, it would have been read\nonly if I hadn't put that in there, so\n\n327\n00:16:31.508 --> 00:16:33.160\ngood thing that I defined that.\n\n328\n00:16:33.160 --> 00:16:36.430\nSo now It's restarted,\nI'm sharing this out,\n\n329\n00:16:36.430 --> 00:16:37.730\nit should be available on the network.\n\n330\n00:16:37.730 --> 00:16:41.760\nPeople should be able to connect to it,\nI can test that right from here,\n\n331\n00:16:41.760 --> 00:16:43.380\nright from the server.\n\n332\n00:16:43.380 --> 00:16:45.440\nNot a good way to test if it's\ncleared through the firewall, but\n\n333\n00:16:45.440 --> 00:16:48.000\nit's a good way to test SELinux and\neverything else.\n\n334\n00:16:48.000 --> 00:16:55.250\nI can say smbclient, and specify -l\nlocalhost, shoot, I'm logged in as root.\n\n335\n00:16:55.250 --> 00:16:57.810\nLet me drop back to a regular user,\nthere we go.\n\n336\n00:16:57.810 --> 00:17:01.265\nAnd I'll say smbclient -l localhost, and\n\n337\n00:17:01.265 --> 00:17:06.370\nthis is gonna show me what is\nbeing advertised on my system.\n\n338\n00:17:06.370 --> 00:17:10.110\nAnd so I'll authenticate as my user,\nI'm dpezet,\n\n339\n00:17:10.110 --> 00:17:14.010\nand here I can see Corp, right there.\n\n340\n00:17:14.010 --> 00:17:17.050\nCentral corporate storage,\nso there's my share,\n\n341\n00:17:17.050 --> 00:17:20.580\nit's being advertised on the network,\nso that worked, that's good.\n\n342\n00:17:20.580 --> 00:17:24.590\nAnd I can see this is my lab server 01,\nso that's good.\n\n343\n00:17:24.590 --> 00:17:31.650\nThen I can even try and connect to it,\nI can say smbclient -u dpezet.\n\n344\n00:17:31.650 --> 00:17:32.190\nSo I'm gonna try and\n\n345\n00:17:32.190 --> 00:17:36.100\nlogin as the dpezet user, and\nthen I'll point to //localhost/corp.\n\n346\n00:17:36.100 --> 00:17:40.840\nThis is the hardest part for\n\n347\n00:17:40.840 --> 00:17:43.938\nmost Windows users, cuz Windows\nusually uses back slashes for this.\n\n348\n00:17:43.938 --> 00:17:47.902\nIn the Unix world, we use forward slashes,\nso // and the name of the server,\n\n349\n00:17:47.902 --> 00:17:50.080\nthen / and the name of the folder.\n\n350\n00:17:50.080 --> 00:17:54.130\nAnd that's gonna open up a connection\nto it, I'll authenticate it, and\n\n351\n00:17:54.130 --> 00:17:56.850\nthen I should be in that folder.\n\n352\n00:17:56.850 --> 00:17:59.642\nOkay, now how do I know\nif I'm in the folder?\n\n353\n00:17:59.642 --> 00:18:04.401\nWell, it's empty, so I probably should\nhave created something in there, so\n\n354\n00:18:04.401 --> 00:18:07.190\nlet me park that one in the background.\n\n355\n00:18:07.190 --> 00:18:10.350\nAnd I'm going to go into /var/corp and\n\n356\n00:18:10.350 --> 00:18:13.850\nI'll make a few files,\nlike test1.txt, test2.txt.\n\n357\n00:18:13.850 --> 00:18:17.750\nSo I'm just putting some files in there,\nand\n\n358\n00:18:17.750 --> 00:18:24.160\nthen if I go back to my client and\nI pull up a directory, there it is.\n\n359\n00:18:24.160 --> 00:18:28.920\nSo I'm connected with the SMB client to\nthat share, and I can see the files, and\n\n360\n00:18:28.920 --> 00:18:31.770\nI could copy them,\nedit them, work with them.\n\n361\n00:18:31.770 --> 00:18:34.958\nThis way of using the command\nline client is not very flexible,\n\n362\n00:18:34.958 --> 00:18:36.952\nthis isn't what an end user would use.\n\n363\n00:18:36.952 --> 00:18:40.560\nBut on the server side, it's a great way\nto test and just make sure we can connect.\n\n364\n00:18:40.560 --> 00:18:43.580\nAnd you can try different user accounts\nand authenticate and clear, and\n\n365\n00:18:43.580 --> 00:18:44.600\nthen get into it.\n\n366\n00:18:44.600 --> 00:18:46.620\nBut right here,\nI can see the share is working, and\n\n367\n00:18:46.620 --> 00:18:48.239\nI'm able to access my content.\n\n368\n00:18:48.239 --> 00:18:51.792\n&gt;&gt; So speaking of end user,\nhow would an end user access the folder?\n\n369\n00:18:51.792 --> 00:18:55.130\n&gt;&gt; Okay, so there's two real\nways the end users could do it.\n\n370\n00:18:55.130 --> 00:18:59.880\nLet me, all right, so this screen,\nI'm SSHed into the server.\n\n371\n00:18:59.880 --> 00:19:02.380\nSo I'm gonna minimize that and\ngo down to just my regular desktop.\n\n372\n00:19:02.380 --> 00:19:06.370\nThis is my actual laptop,\nI'm running RedHat workstation.\n\n373\n00:19:06.370 --> 00:19:10.531\nAnd if I'm an end user and\nI wanna browse and\n\n374\n00:19:10.531 --> 00:19:14.816\nconnect to that Samba\nshare on the network.\n\n375\n00:19:14.816 --> 00:19:18.634\nWhat I would do is just go\ninto my file browser here, and\n\n376\n00:19:18.634 --> 00:19:24.032\nif you go to other locations, this is\nwhere you can kinda browse the network.\n\n377\n00:19:24.032 --> 00:19:27.906\nAnd I can browse the Windows network,\nand I can try and find that node.\n\n378\n00:19:27.906 --> 00:19:30.986\nIf you have a lot of systems on a network,\nbrowsing isn't very convenient, so\n\n379\n00:19:30.986 --> 00:19:33.020\nright down here I can\ndo connect to server.\n\n380\n00:19:33.020 --> 00:19:38.810\nAnd I can just punch in that server,\nI'll say smb:// and\n\n381\n00:19:38.810 --> 00:19:41.205\nI'm gonna punch in that server.\n\n382\n00:19:41.205 --> 00:19:43.535\nLet me zoom in on that,\nit's a little bit on the small side, so\n\n383\n00:19:43.535 --> 00:19:44.981\nI'm just gonna type it in right here.\n\n384\n00:19:44.981 --> 00:19:49.065\nsmb:// I'm doing the IP\naddress of this server,\n\n385\n00:19:49.065 --> 00:19:50.325\nbecause I haven't set up name lookups.\n\n386\n00:19:50.325 --> 00:19:53.995\nSo if you had DNS you could just\ndo the host name, and then /corp.\n\n387\n00:19:53.995 --> 00:19:58.776\nThat's the folder that I wanna connect to,\nso I'm just gonna type that in.\n\n388\n00:19:58.776 --> 00:20:01.726\nYou could browse to find it in\na network that's not too big,\n\n389\n00:20:01.726 --> 00:20:04.744\nbut in a huge network,\nit's usually easier just to type it.\n\n390\n00:20:04.744 --> 00:20:07.688\nAnd then I'll go ahead and hit that\nConnect button, now when I go to connect,\n\n391\n00:20:07.688 --> 00:20:09.630\nI've got to authenticate.\n\n392\n00:20:09.630 --> 00:20:12.390\nAnd it's gonna try anonymous, but\nI disabled anonymous access, so\n\n393\n00:20:12.390 --> 00:20:13.860\nI need to authenticate.\n\n394\n00:20:13.860 --> 00:20:20.558\nAnd I have a username dpezet, I have\na workgroup whose name I can't remember.\n\n395\n00:20:20.558 --> 00:20:24.059\n[LAUGH] Let's see,\nwhat did we call that one?\n\n396\n00:20:24.059 --> 00:20:27.065\nIt was in the last episode, so\nit's been too long for me to remember.\n\n397\n00:20:28.425 --> 00:20:32.945\nI'll just pull that up real quick, I\ncalled my workgroup donslab, that's right.\n\n398\n00:20:32.945 --> 00:20:37.035\nSo let me get back over here, and\nI'll just change that to donslab.\n\n399\n00:20:38.340 --> 00:20:41.120\nAnd then I'll punch in that password,\n\n400\n00:20:41.120 --> 00:20:44.820\nor I will try and punch in my password,\nzoom is going crazy.\n\n401\n00:20:44.820 --> 00:20:47.990\nSo I'll punch in that password,\nand I'll go ahead and connect, and\n\n402\n00:20:47.990 --> 00:20:50.610\nwhen I do that, there it is.\n\n403\n00:20:50.610 --> 00:20:55.290\nSo as an end user, they can just\nuse the GUI and browse right to it.\n\n404\n00:20:55.290 --> 00:20:58.660\nThere's the files,\nthey can open them up, edit them,\n\n405\n00:20:58.660 --> 00:21:00.770\nthey've got that rewrite access.\n\n406\n00:21:00.770 --> 00:21:06.960\nThey can go in and do that, and then work\nwith the file, and now, off they go.\n\n407\n00:21:06.960 --> 00:21:08.895\nSo this is the way they're\nnormally going to do it,\n\n408\n00:21:08.895 --> 00:21:10.110\nend users are going to use a GUI.\n\n409\n00:21:10.110 --> 00:21:11.342\n&gt;&gt; They're going to use a GUI.\n\n410\n00:21:11.342 --> 00:21:13.024\n&gt;&gt; But what if it's another server,\n\n411\n00:21:13.024 --> 00:21:16.910\nwhat if I have a server that I want to\nconnect over, or something of that nature?\n\n412\n00:21:16.910 --> 00:21:19.230\nAnd you could have Macs and\nWindows that do it too, and\n\n413\n00:21:19.230 --> 00:21:22.700\nthen they have a GUI that lets them\nnavigate and connect into these.\n\n414\n00:21:22.700 --> 00:21:27.300\nBut in the Linux word, you can actually\nmount a Samba share, or even a Windows\n\n415\n00:21:27.300 --> 00:21:30.190\nshare, for that matter, using the mount\ncommand from the command line.\n\n416\n00:21:30.190 --> 00:21:31.590\nSo let's say, for example,\n\n417\n00:21:31.590 --> 00:21:36.910\nthat I wanted to connect to\nthis from my own command line.\n\n418\n00:21:36.910 --> 00:21:43.220\nWhat I could do is, I could install\nwhat we call the CIFS utils,\n\n419\n00:21:43.220 --> 00:21:47.290\nCIFS is Common Internet File Sharing\nprotocol.\n\n420\n00:21:47.290 --> 00:21:53.940\nAnd really, Samba, parts of it got opened\nup in open source, and became CIFS.\n\n421\n00:21:53.940 --> 00:21:54.960\nSo if I install that,\n\n422\n00:21:54.960 --> 00:21:59.310\nI can actually mount a folder like\nthis right to my file system.\n\n423\n00:21:59.310 --> 00:22:03.560\nSo let me just give you a quick example\nof that, and show how that works.\n\n424\n00:22:03.560 --> 00:22:08.983\nWhat I would do is, first off,\nI would install the cifs-utils package.\n\n425\n00:22:08.983 --> 00:22:12.190\nSo I'm gonna install that package,\nit is not normally installed by default.\n\n426\n00:22:12.190 --> 00:22:17.825\nSo I just need to get that installed,\nit was C-I-F-S, dash, U-T-I-L-S,\n\n427\n00:22:17.825 --> 00:22:22.790\ncifs-utils, and once I've got it,\nI can make a directory somewhere.\n\n428\n00:22:22.790 --> 00:22:26.932\nI'm gonna do /mnt/corp, so\nI'm gonna go into my mount folder.\n\n429\n00:22:26.932 --> 00:22:30.815\nAnd now I can mount that\nSamba share to that folder,\n\n430\n00:22:30.815 --> 00:22:36.974\nall I have to do is say mount -t cifs, so\nI'm specifying the type of file system.\n\n431\n00:22:36.974 --> 00:22:40.974\nIt won't auto-detect, some distros,\nlike Ubuntu is really good about\n\n432\n00:22:40.974 --> 00:22:44.350\nauto-detecting, Redhat not so\nmuch, so I'll do -t cifs.\n\n433\n00:22:44.350 --> 00:22:51.260\nAnd then I need to tell it that I have\nto use a user account to connect.\n\n434\n00:22:51.260 --> 00:22:56.130\nSo I'm gonna tell it to log in as dpezet,\nand I need to provide it the password, so\n\n435\n00:22:56.130 --> 00:22:56.790\nthat it can connect.\n\n436\n00:22:56.790 --> 00:23:00.210\nYou'll see my super secure password, and\n\n437\n00:23:00.210 --> 00:23:03.100\nthen I need to tell it the server\nthat I'm connecting to.\n\n438\n00:23:03.100 --> 00:23:07.607\nSo that might be an IP,\nit might be a host name or whatever, and\n\n439\n00:23:07.607 --> 00:23:11.706\nthen we'll follow that up\nwith the folder name itself.\n\n440\n00:23:11.706 --> 00:23:15.160\nAnd then lastly, I need to tell\nit where I wanna mount it to,\n\n441\n00:23:15.160 --> 00:23:17.312\nI'm gonna mount it to /mnt/corp.\n\n442\n00:23:17.312 --> 00:23:20.876\nWhen I run that, it's gonna reach out,\nconnect to the server,\n\n443\n00:23:20.876 --> 00:23:23.340\nauthenticate, and then mount it.\n\n444\n00:23:23.340 --> 00:23:29.230\nAnd once it's mounted, I can browse\ninto that folder, and there's the data.\n\n445\n00:23:29.230 --> 00:23:34.330\nThere's test1.txt, test2.txt,\nI can edit those, work with them.\n\n446\n00:23:34.330 --> 00:23:35.930\nThey're stored right there,\n\n447\n00:23:35.930 --> 00:23:38.270\nand now I've got access to it\nright here from my file system.\n\n448\n00:23:38.270 --> 00:23:39.980\nSo that's another way\nthat we can reach out and\n\n449\n00:23:39.980 --> 00:23:43.725\nconnect, you can actually\nadd this to your fstab file.\n\n450\n00:23:43.725 --> 00:23:46.596\nYour file system table, and\nthat way, when your system boots up,\n\n451\n00:23:46.596 --> 00:23:48.049\nit will automatically mount it.\n\n452\n00:23:48.049 --> 00:23:51.355\nThe only problem there is,\nyou have to credentials in a text file,\n\n453\n00:23:51.355 --> 00:23:55.340\nwhich is not really the greatest\nthing to do, but it can work.\n\n454\n00:23:55.340 --> 00:23:59.120\nSome distros load the file systems before\nthey load the network stack, though.\n\n455\n00:23:59.120 --> 00:24:01.985\nSo that will cause them\nproblems mounting there,\n\n456\n00:24:01.985 --> 00:24:06.563\nit's usually better to just mount it\nwhen you need it, like I'm showing here.\n\n457\n00:24:06.563 --> 00:24:10.320\nAnd that works out,\nthis works in several different platforms.\n\n458\n00:24:10.320 --> 00:24:14.128\nIn Windows, you don't need a client like\nthis, because it's built into Windows.\n\n459\n00:24:14.128 --> 00:24:18.288\nThey can connect right to it by using\nthe netuse command from the command line\n\n460\n00:24:18.288 --> 00:24:20.051\nthere, so all different ways.\n\n461\n00:24:20.051 --> 00:24:23.319\nThe GUI is really what your end users are\ngonna use, but there's several different\n\n462\n00:24:23.319 --> 00:24:25.571\nother ways we can mount to it and\nget access to that share.\n\n463\n00:24:25.571 --> 00:24:29.102\n&gt;&gt; Installing Samba part two,\nmake sure you watch part one.\n\n464\n00:24:29.102 --> 00:24:32.752\nNow before we move on,\nDon, any final thoughts?\n\n465\n00:24:32.752 --> 00:24:36.354\n&gt;&gt; The main thing here is that Samba does\nwork really well if you need to stand up\n\n466\n00:24:36.354 --> 00:24:37.105\na file server.\n\n467\n00:24:37.105 --> 00:24:41.259\nNo need to buy a Windows license,\nyou could just fire up Samba right here,\n\n468\n00:24:41.259 --> 00:24:43.212\nit does a great job at what it does.\n\n469\n00:24:43.212 --> 00:24:47.496\nIt's not the best domain controller, which\nI didn't really tackle in this series, but\n\n470\n00:24:47.496 --> 00:24:49.220\nit does a great job as a file server.\n\n471\n00:24:49.220 --> 00:24:53.950\nIt's not that hard to get set up, and\nonce it's done, you kind of set it and\n\n472\n00:24:53.950 --> 00:24:55.470\nforget it, you let it run and\ndo its thing.\n\n473\n00:24:55.470 --> 00:24:57.820\nSo definitely something that's useful,\n\n474\n00:24:57.820 --> 00:25:02.110\na lot of large organizations make\nuse of it on a regular basis.\n\n475\n00:25:02.110 --> 00:25:06.050\nBut always be aware that\nyou've got security concerns,\n\n476\n00:25:06.050 --> 00:25:08.840\nyou've got other things that you need to\npay attention to when you get it set up.\n\n477\n00:25:08.840 --> 00:25:13.380\nAnd Samba can be misconfigured, and\nif it is, you can really weaken security,\n\n478\n00:25:13.380 --> 00:25:14.910\nso be very careful with that.\n\n479\n00:25:14.910 --> 00:25:19.429\n&gt;&gt; That's right, so be careful, so there's\na whole lot of videos in the series\n\n480\n00:25:19.429 --> 00:25:22.012\nof becoming a Linux server administrator.\n\n481\n00:25:22.012 --> 00:25:24.511\nMake sure you watch every\nsingle one of those episodes,\n\n482\n00:25:24.511 --> 00:25:26.011\nbecause you'll be glad you did.\n\n483\n00:25:26.011 --> 00:25:30.121\nAnd thank you for watching ITProTV,\nremember, a good IT pro's always learning,\n\n484\n00:25:30.121 --> 00:25:31.013\nI'm Zach Memos.\n\n485\n00:25:31.013 --> 00:25:31.783\n&gt;&gt; And I'm Don Pezet.\n\n486\n00:25:31.783 --> 00:25:34.167\n&gt;&gt; We'll see you very soon.\n\n487\n00:25:34.167 --> 00:25:40.135\n[MUSIC]\n\n488\n00:25:40.135 --> 00:25:43.685\n&gt;&gt; Thank you for watching ITProTV.\n\n",
          "vimeoId": "229135321"
        }
      ],
      "title": "Configuring a Samba File Server"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach cover why we would use NFS instead of SAMBA, what it takes to get NFS up & running, how to share a folder via NFS, modify the firewall rules, getting a client connected to the folder, and adding to FSTAB during boot.",
          "length": "1634",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-9-1-installing_nfs-081017.00_27_00_24.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-9-1-installing_nfs-081017.00_27_00_24.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-9-1-installing_nfs-081017.00_27_00_24.Still001-sm.jpg",
          "title": "Installing NFS",
          "transcript": "",
          "vimeoId": "229281250"
        }
      ],
      "title": "Configuring an NFS File Server"
    },
    {
      "episodes": [
        {
          "description": "Don and Zach discuss what it takes to get FTP up & running, install VSFTPD, how to configure FTP, what data users see when they connect, monitoring people's access, restricting who is allowed to use the server, SELinux interfering with VSFTP, and can we make VSFTP use encryption.",
          "length": "2013",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-10-1-configuring_an_ftp_server-081017-PGM.00_35_50_22.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-10-1-configuring_an_ftp_server-081017-PGM.00_35_50_22.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-10-1-configuring_an_ftp_server-081017-PGM.00_35_50_22.Still001-sm.jpg",
          "title": "Configuring an FTP Server",
          "transcript": "",
          "vimeoId": "229280542"
        },
        {
          "description": "Don and Zach discuss what it takes to get SFTP up & running, enable SSH, default configuration not ideal, access SSH Shells, FTP, update SELinux, restart SSHD, and testing out the SFTP server.",
          "length": "1501",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-10-2-configuring_an_sftp_server-081017.00_24_48_03.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-10-2-configuring_an_sftp_server-081017.00_24_48_03.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-linuxserveradmin/techskills-linuxserveradmin-10-2-configuring_an_sftp_server-081017.00_24_48_03.Still001-sm.jpg",
          "title": "Configuring an SFTP Server",
          "transcript": "",
          "vimeoId": "229280976"
        }
      ],
      "title": "Configuring a FTP Server"
    }
  ],
  "url": "becominglinux-server-admin",
  "vLab": false
}
