{
  "description": "The Implementing Cisco IP Switched Networks exam is the second of three exams required to obtain the Cisco Certified Network Professional certification. This exam focuses on Cisco switch implementation in medium and large environment. The topics covered range from HSRP, STP, VTP to Etherchannel and how and why we use them.. The typical viewer would be anyone responsible for the maintenance and implementation of Cisco Switches in a large or enterprise organization. This SWITCH  emphasizes planning, configuring, and verifying the implementation of complex enterprise switching solutions that use the Cisco Enterprise Campus Architecture.",
  "descriptionMD": "",
  "length": "43691",
  "name": "CCNP Routing and Switching - SWITCH",
  "practiceExam": true,
  "subtitle": "Implementing Cisco IP Switched Networks",
  "tagUrl": "network-admin",
  "topics": [
    {
      "episodes": [
        {
          "description": "The Implementing Cisco IP Switched Networks exam is the second of three exams required to obtain the Cisco Certified Network Professional certification. This exam focuses on Cisco switch implementation in medium and large environment. The topics covered range from HSRP, STP, VTP to Etherchannel and how and why we use them.. The typical viewer would be anyone responsible for the maintenance and implementation of Cisco Switches in a large or enterprise organization. This SWITCH  emphasizes planning, configuring, and verifying the implementation of complex enterprise switching solutions that use the Cisco Enterprise Campus Architecture.",
          "length": "370",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-0-0-0-overview-113017-PGM.00_00_05_22.Still001.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-0-0-0-overview-113017-PGM.00_00_05_22.Still001-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-0-0-0-overview-113017-PGM.00_00_05_22.Still001-sm.jpg",
          "title": "Overview",
          "transcript": "WEBVTT\n\n1\n00:00:00.025 --> 00:00:04.906\n[SOUND] Hello and thank you for\n\n2\n00:00:04.906 --> 00:00:08.368\nchoosing ITProTV.\n\n3\n00:00:08.368 --> 00:00:11.246\nWe're talking about\nCisco Switch with Don Pezet.\n\n4\n00:00:11.246 --> 00:00:13.435\nDon, could you tell us a little\nbit about Cisco Switch?\n\n5\n00:00:13.435 --> 00:00:17.989\n&gt;&gt; All right, the Cisco Switch series\nis part of our Cisco Track that focuses\n\n6\n00:00:17.989 --> 00:00:22.486\nspecifically on, well yeah,\nas the name implies, switches, right?\n\n7\n00:00:22.486 --> 00:00:25.479\nIn the Cisco world, a lot of times we\nthink about routers because that's where\n\n8\n00:00:25.479 --> 00:00:26.622\nthey have a really big focus.\n\n9\n00:00:26.622 --> 00:00:30.067\nBut their switching platform is actually\nmassive, amazing, they have a lot\n\n10\n00:00:30.067 --> 00:00:33.200\nof technology in there, and\nthis course focuses specifically on it.\n\n11\n00:00:33.200 --> 00:00:36.532\nNow we refer to the course as\nCisco Switch, a lot of people do.\n\n12\n00:00:36.532 --> 00:00:40.281\nThe actual official name of the course,\na little more involved,\n\n13\n00:00:40.281 --> 00:00:44.985\nis the Implementing Cisco IP Switch\nNetworks Course., A nice long title there,\n\n14\n00:00:44.985 --> 00:00:48.940\nbut basically what it's hinting at\nis that switches do a lot more than\n\n15\n00:00:48.940 --> 00:00:50.674\njust basic frame switching.\n\n16\n00:00:50.674 --> 00:00:54.383\nNow they actually get involved with IP\nnetworks in a lot more complexity and so\n\n17\n00:00:54.383 --> 00:00:58.102\nthat's all some of the stuff that we're\ngonna see right here in this series.\n\n18\n00:00:58.102 --> 00:00:59.811\n&gt;&gt; So Don,\nwho is this show targeted towards?\n\n19\n00:00:59.811 --> 00:01:02.651\n&gt;&gt; It's targeted to a couple\nof different people.\n\n20\n00:01:02.651 --> 00:01:05.431\nSo people that are trying to\npass Cisco exams, right, and\n\n21\n00:01:05.431 --> 00:01:08.723\nit's gonna be one of them, but\nreally anybody whose responsible for\n\n22\n00:01:08.723 --> 00:01:11.187\nsupporting Cisco switches\nout there in the field.\n\n23\n00:01:11.187 --> 00:01:14.118\nAnd that means that you might be\na help desk or network engineer,\n\n24\n00:01:14.118 --> 00:01:17.918\neven the junior network engineers, the\npeople are just getting started in network\n\n25\n00:01:17.918 --> 00:01:20.546\nadministration are usually responsible for\nswitches.\n\n26\n00:01:20.546 --> 00:01:23.105\nLayer twos is where we'll\ntypically cut our teeth.\n\n27\n00:01:23.105 --> 00:01:26.521\nNow, if you've done the CCNA andn some\nof the earlier Cisco certifications,\n\n28\n00:01:26.521 --> 00:01:29.317\nyou already learned a bit about switches,\nand really enough for\n\n29\n00:01:29.317 --> 00:01:30.580\na junior engineer, right?\n\n30\n00:01:30.580 --> 00:01:34.944\nThose are focusing on small deployments,\na handful of switches.\n\n31\n00:01:34.944 --> 00:01:40.486\nIn the CCNP track, we take that and\nwe scale it up much, much larger.\n\n32\n00:01:40.486 --> 00:01:44.430\nAnd so here, we're talking about not\njust people that support Cisco switches,\n\n33\n00:01:44.430 --> 00:01:47.910\nthe people that support hundreds,\neven thousands of Cisco switches,\n\n34\n00:01:47.910 --> 00:01:51.115\ncuz the technologies change when\nyou have a network of that size.\n\n35\n00:01:51.115 --> 00:01:53.641\nThat's all stuff we take into\naccount right here in this course.\n\n36\n00:01:53.641 --> 00:01:56.213\n&gt;&gt; Is certification available for\nthe course?\n\n37\n00:01:56.213 --> 00:01:57.856\n&gt;&gt; Absolutely, and\nyou don't have to do it,\n\n38\n00:01:57.856 --> 00:02:00.835\nif you just wanna learn about Cisco\nswitches, this course is great for that.\n\n39\n00:02:00.835 --> 00:02:03.314\nWe really going into some of the advanced\nfeatures on what you can do.\n\n40\n00:02:03.314 --> 00:02:07.340\nBut most of the people that watch this\nshow are people that are seeking out\n\n41\n00:02:07.340 --> 00:02:11.105\nthe Cisco Certified Network\nProfessional Routing and Switching,\n\n42\n00:02:11.105 --> 00:02:12.639\nCCNP R&amp;S Certification.\n\n43\n00:02:12.639 --> 00:02:15.689\nThis is one of three exams\nto get that CCNP R&amp;S,\n\n44\n00:02:15.689 --> 00:02:18.677\nin fact let me bring up\nCisco's website here.\n\n45\n00:02:18.677 --> 00:02:22.307\nAnd I've got there the page for\nthe CCNP Routing and Switching and\n\n46\n00:02:22.307 --> 00:02:25.879\nin order to get this certification\nyou have to pass three exams.\n\n47\n00:02:25.879 --> 00:02:29.725\nThe three exams are the 300-101 Route,\n\n48\n00:02:29.725 --> 00:02:33.481\nwhich focuses just on\nrouting technologies.\n\n49\n00:02:33.481 --> 00:02:35.343\nAnd granted,\nsome switches are layer three switches,\n\n50\n00:02:35.343 --> 00:02:36.779\nthat means that the switch can do routing.\n\n51\n00:02:36.779 --> 00:02:38.393\nSo it's a bit of overlap between the two.\n\n52\n00:02:38.393 --> 00:02:42.605\nThen there's 300-1155 switch,\nthat's what this one is based on.\n\n53\n00:02:42.605 --> 00:02:45.736\nThis course is focused\non that particular exam.\n\n54\n00:02:45.736 --> 00:02:49.849\nAnd then there's a 300-135 TSHOOT,\nwhich is troubleshooting, and\n\n55\n00:02:49.849 --> 00:02:53.276\nyour troubleshooting not just routers,\nbut switches as well.\n\n56\n00:02:53.276 --> 00:02:57.104\nSo there's a little bit of switching\ntechnology in all three of these, but\n\n57\n00:02:57.104 --> 00:03:00.649\nthis course, Switch is the only one\nthat focuses on just switching.\n\n58\n00:03:00.649 --> 00:03:03.839\nSo if you are looking to get your CCNP and\nyou're studying for this exam,\n\n59\n00:03:03.839 --> 00:03:06.001\nthat's exactly what this\nis targeted towards.\n\n60\n00:03:06.001 --> 00:03:08.645\nIt's the only certification\nthat this exam counts towards.\n\n61\n00:03:08.645 --> 00:03:11.730\nCisco has a bunch of other\ncertifications with different exams.\n\n62\n00:03:11.730 --> 00:03:14.750\nThis one just counts towards\nCCNP routing and switches.\n\n63\n00:03:14.750 --> 00:03:18.478\n&gt;&gt; Don, that sounds great, now what\ntopics are covered in Cisco Switch?\n\n64\n00:03:18.478 --> 00:03:22.230\nIf you wanna see the actual topics that\nare on the exam, you can go to CISCO's\n\n65\n00:03:22.230 --> 00:03:24.880\nwebsite and they've got where you can\ndownload the exam objectives right there.\n\n66\n00:03:24.880 --> 00:03:27.570\nAnd they lay it all out piece by piece,\nevery individual technology.\n\n67\n00:03:27.570 --> 00:03:30.760\nWhen we built this course, we actually\nstructured it around those exam objectives\n\n68\n00:03:30.760 --> 00:03:32.230\nto make sure we covered every single one.\n\n69\n00:03:32.230 --> 00:03:34.940\nBut we did rearrange them a little bit.\n\n70\n00:03:34.940 --> 00:03:37.980\nWe put them in a slightly different\norder to make it a little more logical,\n\n71\n00:03:37.980 --> 00:03:39.690\nget a little more flow.\n\n72\n00:03:39.690 --> 00:03:42.836\nBasically the course is divided into\nthree sections, and in the first section,\n\n73\n00:03:42.836 --> 00:03:46.200\nwe're focusing on what's kinda generally\ncalled layer two technologies.\n\n74\n00:03:46.200 --> 00:03:50.280\nAnd what we really do is, we take\neverything that you learned about switches\n\n75\n00:03:50.280 --> 00:03:55.720\nin the CCNA and we blow it up on scale,\nand we see what it's like when we have far\n\n76\n00:03:55.720 --> 00:04:00.030\nmore greater amount of systems involved\nand we also learn a lot more detail.\n\n77\n00:04:00.030 --> 00:04:01.740\nSo we take things like VLANS,\n\n78\n00:04:01.740 --> 00:04:06.320\nexpanding tree protocol, we take trunking,\nlike 802.1Q trunking, and\n\n79\n00:04:06.320 --> 00:04:10.380\nthose technologies, and we go a lot\nmore in depth, into how they work,\n\n80\n00:04:10.380 --> 00:04:13.580\nhow they can be optimized and how they\ncan handle large scale networking.\n\n81\n00:04:13.580 --> 00:04:15.740\nSo that's where we start this series and\n\n82\n00:04:15.740 --> 00:04:19.900\nwhere really, about half the content\nfalls is right inside of there.\n\n83\n00:04:19.900 --> 00:04:22.480\nThe other half of the course\nis spent on two other areas.\n\n84\n00:04:22.480 --> 00:04:25.363\nWe've got switch security,\nCisco levels infrastructure security, but\n\n85\n00:04:25.363 --> 00:04:28.340\nwe're really talking about security\non the switches themselves.\n\n86\n00:04:28.340 --> 00:04:33.190\nThere are some amazing security features\nthat are included on every Cisco switch\n\n87\n00:04:33.190 --> 00:04:35.240\nand they're all turned off by default.\n\n88\n00:04:35.240 --> 00:04:36.663\nSo ifyou don't know they're there,\n\n89\n00:04:36.663 --> 00:04:38.714\nyour switch is actually\nrunning in a pretty open mode.\n\n90\n00:04:38.714 --> 00:04:40.981\nSo you get in there and\nyou lock it down and\n\n91\n00:04:40.981 --> 00:04:45.250\nthere are a ton of network attacks\nthat you can kill right on the switch.\n\n92\n00:04:45.250 --> 00:04:48.100\nSo your workstations, your servers,\nthey never even see that attack,\n\n93\n00:04:48.100 --> 00:04:50.920\nthey're completely unaffected,\ncuz the switch protects them.\n\n94\n00:04:50.920 --> 00:04:52.480\nSo we take a look at some\nof those features and\n\n95\n00:04:52.480 --> 00:04:55.070\nhow they can be implemented and\nwhat you can do with them.\n\n96\n00:04:55.070 --> 00:04:58.580\nAnd then we wrap up the series by\ntalking about infrastructure services.\n\n97\n00:04:58.580 --> 00:05:02.590\nAnd these are other things that we can run\non our switches to improve our network.\n\n98\n00:05:02.590 --> 00:05:07.300\nOne of my favorite shows is in that\nsection, it's the first-hop redundancy.\n\n99\n00:05:07.300 --> 00:05:10.280\nWhen you have a router that's critical\nto your network and that router fails,\n\n100\n00:05:10.280 --> 00:05:11.120\nwhat happens?\n\n101\n00:05:11.120 --> 00:05:13.923\nWell, you lose remote connectivity.\n\n102\n00:05:13.923 --> 00:05:18.046\nBut if I'm using my switches to do layer\nthree switching, I can actually create\n\n103\n00:05:18.046 --> 00:05:22.354\nmany, many virtual routers and have it\nwhere entire switches, entire portions of\n\n104\n00:05:22.354 --> 00:05:26.433\nmy networking fail, and we'll just route\nright around it and get on through.\n\n105\n00:05:26.433 --> 00:05:30.194\nSo that's a technology that's really easy\nto do on switches if we plan for and so\n\n106\n00:05:30.194 --> 00:05:32.943\nwe take a look at how to do that and\nget a chance to see that and\n\n107\n00:05:32.943 --> 00:05:35.378\nwe learn about configuring\nlayer three switches.\n\n108\n00:05:35.378 --> 00:05:38.256\nSo we're not just focused on the layer\ntwo side, although that's where\n\n109\n00:05:38.256 --> 00:05:41.037\nthe bulk of the exam is, we do learn\nabout the layer three side as well,\n\n110\n00:05:41.037 --> 00:05:43.561\nand see how we can merge routing\nfunctionality right in there.\n\n111\n00:05:43.561 --> 00:05:46.570\nSo that's kind of a quick overview of all\nthe topics that we're gonna cover right\n\n112\n00:05:46.570 --> 00:05:47.379\nhere in this series.\n\n113\n00:05:47.379 --> 00:05:50.703\n&gt;&gt; Well thank you so much Don,\nCisco Switch sounds like an amazing show.\n\n114\n00:05:50.703 --> 00:05:54.799\nAnd you wanna catch all the episodes in\nour course library, and thank you for\n\n115\n00:05:54.799 --> 00:05:55.887\nwatching ITProTV.\n\n116\n00:05:55.887 --> 00:05:59.865\nRemember, ITProTV is binge-worthy.\n\n117\n00:05:59.865 --> 00:06:02.338\n[NOISE]\n\n",
          "vimeoId": "245433575"
        },
        {
          "description": "In this episode, Daniel and Don explain how to configure and verify some switch administration tasks. Watch as they detail the Ternary Content Addressable Memory (TCAM) table and how to use it to optimize switch functionality. Other topics include MAC address tables administration and troubleshooting.",
          "length": "2057",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-1-switch_administration-092815-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-1-switch_administration-092815-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-1-switch_administration-092815-1-sm.jpg",
          "title": "Switch Administration",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.596 --> 00:00:12.780\nAll right.\n\n3\n00:00:12.780 --> 00:00:16.211\nGreetings everyone, and welcome to\nanother great episode of ITProTV.\n\n4\n00:00:16.211 --> 00:00:17.744\nI'm your host, Daniel Lowrie.\n\n5\n00:00:17.744 --> 00:00:20.480\nHere with me today,\nthe illustrious Don Pezet.\n\n6\n00:00:20.480 --> 00:00:21.560\nHow's it going, Don?\n\n7\n00:00:21.560 --> 00:00:23.770\n>> Well, now I feel like I should\nbe wearing fancier clothes.\n\n8\n00:00:23.770 --> 00:00:24.670\n>> Well, you should.\n\n9\n00:00:24.670 --> 00:00:26.850\n>> Well, I'm excited to be\nback on the show, Daniel, and\n\n10\n00:00:26.850 --> 00:00:28.690\nexcited to kick off another series.\n\n11\n00:00:28.690 --> 00:00:32.400\nWe're diving into the world\nof CCNP switch today,\n\n12\n00:00:32.400 --> 00:00:36.360\nand this is a fun one, cuz we'll\nreally get a chance to take a look at\n\n13\n00:00:36.360 --> 00:00:38.640\nwhat's normally a pretty simple device,\nright?\n\n14\n00:00:38.640 --> 00:00:40.800\nA layer two switch,\nnot a whole lot to them.\n\n15\n00:00:40.800 --> 00:00:43.810\nSo you think you just throw them\non the network and you're done,\n\n16\n00:00:43.810 --> 00:00:46.390\nbut there's a lot of cool stuff in there.\n\n17\n00:00:46.390 --> 00:00:49.470\nWe're gonna run through all the various\nfeatures, and we gotta get started\n\n18\n00:00:49.470 --> 00:00:52.470\nsomewhere, so today we're gonna be\njumping into just switch administration.\n\n19\n00:00:52.470 --> 00:00:56.920\nThese are gonna be the things your switch\ndoes every single day that we just need to\n\n20\n00:00:56.920 --> 00:01:00.650\nbe aware of, and sometimes\ninfluences we work with the device.\n\n21\n00:01:00.650 --> 00:01:03.760\n>> Yeah, now Don,\nwe've learned in CCNA all about switching.\n\n22\n00:01:03.760 --> 00:01:05.500\nWell, at least we thought we did anyway.\n\n23\n00:01:05.500 --> 00:01:08.760\nBasically layer two device,\nworking with MAC addresses, and\n\n24\n00:01:08.760 --> 00:01:10.890\nthat was kind of about\nwhere they go us though.\n\n25\n00:01:10.890 --> 00:01:13.000\nBut in CCNP, we gotta dive deeper, right?\n\n26\n00:01:13.000 --> 00:01:14.520\nAnd that's what you're\ngonna show us today.\n\n27\n00:01:14.520 --> 00:01:18.650\n>> Absolutely, yeah, and\njust as an example, in the CCNA,\n\n28\n00:01:18.650 --> 00:01:23.450\nyou learn enough to implement switches in\nreally in any small, medium environment.\n\n29\n00:01:23.450 --> 00:01:25.260\nEven in some enterprise environments,\n\n30\n00:01:25.260 --> 00:01:27.910\nwhat's covered under CCNA\nis enough to get you by.\n\n31\n00:01:27.910 --> 00:01:31.380\nBut there are some interesting things\nthat happen in the background that,\n\n32\n00:01:31.380 --> 00:01:36.730\nas your network gets bigger and\nbigger and bigger, your switch just can't\n\n33\n00:01:36.730 --> 00:01:39.290\nkeep up unless you understand\nwhat's going on behind the scenes.\n\n34\n00:01:39.290 --> 00:01:43.480\nAnd so that's one of the topics\nthat I wanna lead off with today\n\n35\n00:01:43.480 --> 00:01:46.490\nis our good friend, the MAC address table.\n\n36\n00:01:46.490 --> 00:01:48.500\nAnd Daniel, you know all about\nthe MAC address table, right?\n\n37\n00:01:48.500 --> 00:01:51.216\n>> Every last stitch of that MAC,\nI've got it down.\n\n38\n00:01:51.216 --> 00:01:52.048\nSure, yeah.\n\n39\n00:01:52.048 --> 00:01:55.810\n>> [LAUGH] Now, we learned under\nthe CCNA that the MAC address table, or\n\n40\n00:01:55.810 --> 00:01:59.110\nthe media access control address,\nthe MAC address table,\n\n41\n00:01:59.110 --> 00:02:01.826\nit's the primary function of a switch,\nright?\n\n42\n00:02:01.826 --> 00:02:05.460\nA switch is a layer two device,\nthe MAC address is your layer two address.\n\n43\n00:02:05.460 --> 00:02:09.910\nSo everything that plugs into your\nnetwork, every router, every PC,\n\n44\n00:02:09.910 --> 00:02:14.410\nevery laptop, every television,\nprinter, whatever it is\n\n45\n00:02:14.410 --> 00:02:19.110\nthat has a network jack on it Is gonna\nhave a MAC address on your network.\n\n46\n00:02:19.110 --> 00:02:22.690\nAnd what your switch is doing,\ndeep down in its little layer two heart,\n\n47\n00:02:22.690 --> 00:02:26.460\nis it's watching for\nyour frames to go across the network.\n\n48\n00:02:26.460 --> 00:02:31.060\nIt looks at the layer two header to find\nthe source and destination MAC address.\n\n49\n00:02:31.060 --> 00:02:35.270\nIt then looks at the source MAC address\nand says, what port did this come in on?\n\n50\n00:02:35.270 --> 00:02:39.100\nAll right, well,\nthat is where that MAC address lives.\n\n51\n00:02:39.100 --> 00:02:43.390\nAnd it maps the source MAC address to\nthe port that that traffic came in on.\n\n52\n00:02:43.390 --> 00:02:46.570\nAnd then it finds the destination, right,\nthe destination MAC address that you're\n\n53\n00:02:46.570 --> 00:02:50.300\ngoing to, and it hopefully already\nknows what port that one's on so\n\n54\n00:02:50.300 --> 00:02:54.610\nwe can send it right to that interface and\nnot bother anybody else on the switch.\n\n55\n00:02:54.610 --> 00:02:59.630\nThat is the basic layer two functionality\nthat every switch performs, and\n\n56\n00:02:59.630 --> 00:03:03.080\nthe MAC address table\nis a key piece of that.\n\n57\n00:03:03.080 --> 00:03:05.930\nYou can view the MAC address\ntable on any switch.\n\n58\n00:03:05.930 --> 00:03:11.140\nThe command, if you think back to the old\n\n59\n00:03:11.140 --> 00:03:15.219\nit's just show mac address-table.\n\n60\n00:03:15.219 --> 00:03:16.735\nThere we go,\ngotta remember where my hyphen is.\n\n61\n00:03:16.735 --> 00:03:17.400\n>> [LAUGH]\n>> And\n\n62\n00:03:17.400 --> 00:03:21.240\nit'll give you a list of all the MAC\naddresses that it's learned and\n\n63\n00:03:21.240 --> 00:03:22.610\nthe interfaces that it's learned them.\n\n64\n00:03:22.610 --> 00:03:27.920\nSo you'll see my switch has learned\na handful here, and the ports they're tied\n\n65\n00:03:27.920 --> 00:03:33.958\nto, so for example, the MAC ending in\n0417 is plugged into Fa1/0/22, right?\n\n66\n00:03:33.958 --> 00:03:34.709\nThat's the port it's on.\n\n67\n00:03:34.709 --> 00:03:37.128\nAll right.\nThis is a key piece of what's going on in\n\n68\n00:03:37.128 --> 00:03:38.830\nthe background.\n\n69\n00:03:38.830 --> 00:03:44.070\nBut what a lot of people don't realize is\nthe MAC address table is just one table,\n\n70\n00:03:44.070 --> 00:03:47.720\nand it's actually nested\ninside of another table.\n\n71\n00:03:47.720 --> 00:03:50.760\nThis is where things get\nreally kinda squirrely.\n\n72\n00:03:50.760 --> 00:03:54.790\nSometimes, as you study for Cisco,\nyou hear about the MAC table.\n\n73\n00:03:54.790 --> 00:03:58.030\nAnd then other times you hear\npeople talk about the CAM table.\n\n74\n00:03:58.030 --> 00:03:59.760\nAnd you're like,\nwait a minute, the CAM table?\n\n75\n00:03:59.760 --> 00:04:01.430\nAre they writing MAC backwards?\n\n76\n00:04:01.430 --> 00:04:03.300\n>> I just thought it was\ndyslexic Cisco people.\n\n77\n00:04:03.300 --> 00:04:06.744\n>> Yeah, and you won't find a lot\nof information on it, that's what\n\n78\n00:04:06.744 --> 00:04:10.820\nmakes it even harder, so if you go to\nlook it up, Google will autocorrect you.\n\n79\n00:04:10.820 --> 00:04:12.353\nDid you mean MAC table?\n\n80\n00:04:12.353 --> 00:04:13.713\n>> No. [LAUGH] >> No, I typed CAM!\n\n81\n00:04:13.713 --> 00:04:18.330\nSo, when you talk about the CAM table,\nit's a bit different, right?\n\n82\n00:04:18.330 --> 00:04:22.570\nThe CAM table is talking about the\nhardware memory, the actual memory that's\n\n83\n00:04:22.570 --> 00:04:25.930\non the motherboard where the MAC\naddress table is stored.\n\n84\n00:04:25.930 --> 00:04:30.310\nAnd the CAM is actually\narranged as a table itself, and\n\n85\n00:04:30.310 --> 00:04:33.560\nit's got several things that\nare tucked away inside of it.\n\n86\n00:04:33.560 --> 00:04:37.460\nAnd so the thing as a whole,\nit gets a little weird.\n\n87\n00:04:37.460 --> 00:04:40.840\nThere's actually five\ndifferent sets of data\n\n88\n00:04:40.840 --> 00:04:44.510\nthat are collected into\nwhat's called your TCAM.\n\n89\n00:04:44.510 --> 00:04:48.922\nAnd TCAM, I'm just gonna throw out as\nmany acronyms as I can this episode,\n\n90\n00:04:48.922 --> 00:04:53.845\nwe're gonna go crazy, TCAM, it stands for\nternary content addressable memory.\n\n91\n00:04:53.845 --> 00:04:57.992\nNow, when you talk about\nyour regular CAM table,\n\n92\n00:04:57.992 --> 00:05:04.460\nyou run a query against it and you say,\nis this Mac address on this port?\n\n93\n00:05:04.460 --> 00:05:06.130\nYou get a true or a false back.\n\n94\n00:05:06.130 --> 00:05:07.300\nThat's the way that hardware works.\n\n95\n00:05:07.300 --> 00:05:08.836\nYou just get a yes or a no.\n\n96\n00:05:08.836 --> 00:05:14.020\nBut with ternary CAM,\nit actually has three states.\n\n97\n00:05:14.020 --> 00:05:15.700\nThat's where that ternary comes from.\n\n98\n00:05:15.700 --> 00:05:18.730\nAnd so it can do the true-false,\njust like a regular CAM table can, but\n\n99\n00:05:18.730 --> 00:05:22.950\nit can also return other data,\nwhich is more informative and\n\n100\n00:05:22.950 --> 00:05:26.090\nallows us to store things beyond\njust a regular CAM table.\n\n101\n00:05:26.090 --> 00:05:29.360\nSo, when you look inside of a Cisco\nrouter, if you were to crack open that\n\n102\n00:05:29.360 --> 00:05:33.310\nhardware and look at the memory chips\nthat are soldered onto that motherboard,\n\n103\n00:05:33.310 --> 00:05:37.780\none of the chips somewhere on that board\nis a very special one, which is our TCAM.\n\n104\n00:05:37.780 --> 00:05:41.050\nAnd in it are five different things, okay.\n\n105\n00:05:41.050 --> 00:05:43.540\nThe MAC address table is a part of that,\nright.\n\n106\n00:05:43.540 --> 00:05:46.420\nAnd we wanna run through each of it.\n\n107\n00:05:46.420 --> 00:05:50.350\nThe very first thing that's found inside\nof a TCAM is what's called the layer\n\n108\n00:05:50.350 --> 00:05:52.540\ntwo learning table, all right.\n\n109\n00:05:52.540 --> 00:05:55.150\nThis is what sets the rules for\nhow we learn.\n\n110\n00:05:55.150 --> 00:05:58.620\nRemember what I said, if you see a friend\ncome in a port, you look at the source MAC\n\n111\n00:05:58.620 --> 00:06:01.870\naddress and you say that MAC address\nis on port five, or port seven.\n\n112\n00:06:01.870 --> 00:06:07.660\nWell, the rules for how you learn that\nare in that layer two learning table.\n\n113\n00:06:07.660 --> 00:06:12.170\nThen you go to your ACL table,\nyour access control list table.\n\n114\n00:06:12.170 --> 00:06:16.320\nIf you're doing layer three switching or\nif you're doing layer two switching with\n\n115\n00:06:16.320 --> 00:06:22.130\nVLAN ACLs, it builds the ACLs, it compiles\nthem, and it stores them in the ACL table.\n\n116\n00:06:22.130 --> 00:06:24.170\nThat's in the TCAM also.\n\n117\n00:06:24.170 --> 00:06:27.720\nThe third thing you'll find in there\nis the layer three routing table.\n\n118\n00:06:27.720 --> 00:06:30.480\nIf you're doing layer two switching,\nthis is empty.\n\n119\n00:06:30.480 --> 00:06:34.090\nBut if you're doing layer three routing,\nyour dynamic routing protocol,\n\n120\n00:06:34.090 --> 00:06:35.230\nyour routing table,\n\n121\n00:06:35.230 --> 00:06:38.320\nall that memory is stored right there\nin the layer three routing table.\n\n122\n00:06:39.400 --> 00:06:42.400\nThen we've got the quality\nof service table.\n\n123\n00:06:42.400 --> 00:06:47.120\nSo if you're doing QoS,\nif you're doing service tagging and\n\n124\n00:06:47.120 --> 00:06:51.690\nprioritization, queuing, weighted round\nrobin, all that other good stuff.\n\n125\n00:06:51.690 --> 00:06:54.870\nThe configuration for all of that, and\nthe rules that apply are stored in there.\n\n126\n00:06:54.870 --> 00:06:56.110\nAnd then lastly,\n\n127\n00:06:56.110 --> 00:06:59.980\nthe very last thing that we have in there\nis the layer two forwarding table, and\n\n128\n00:06:59.980 --> 00:07:03.810\nthe layer two forwarding table,\nthat's where your MAC address table is.\n\n129\n00:07:03.810 --> 00:07:06.338\nThat's where it says this MAC\naddress is on this interface and\n\n130\n00:07:06.338 --> 00:07:08.270\nwe're gonna start sending traffic there.\n\n131\n00:07:08.270 --> 00:07:13.490\nThe key thing about the TCAM is\nit is super mega insane-o fast.\n\n132\n00:07:13.490 --> 00:07:15.175\nThat's the official terminology there.\n\n133\n00:07:15.175 --> 00:07:17.530\n>> [LAUGH]\n>> It's really fast.\n\n134\n00:07:17.530 --> 00:07:19.770\nWhen we talk about RAM,\nright, you can go out and\n\n135\n00:07:19.770 --> 00:07:22.310\nyou can get, what's fast RAM these days?\n\n136\n00:07:22.310 --> 00:07:23.790\nIs it 3,200 megahertz or something?\n\n137\n00:07:23.790 --> 00:07:25.590\n>> Yeah, something like that,\nyeah, it's super fast.\n\n138\n00:07:25.590 --> 00:07:27.360\n>> It's getting up there,\nit's pretty fast.\n\n139\n00:07:27.360 --> 00:07:28.590\nThe TCAM is faster.\n\n140\n00:07:28.590 --> 00:07:32.720\nIt's really just designed\nto do things at wire speed.\n\n141\n00:07:32.720 --> 00:07:35.240\nSo if you're trying to look up a MAC\naddress and what port it's on and\n\n142\n00:07:35.240 --> 00:07:39.740\napply an ACL and apply some routing,\nthat's a lot to do, but the TCAM's so\n\n143\n00:07:39.740 --> 00:07:41.220\nfast, it happens very fast.\n\n144\n00:07:41.220 --> 00:07:45.170\nAnd you see near wire speed communication\nwith a lot of logic applied.\n\n145\n00:07:45.170 --> 00:07:48.230\nThat's what the TCAM does,\nit's borderline magic.\n\n146\n00:07:48.230 --> 00:07:51.852\n>> We're not talking about some\noff the shelf, network store,\n\n147\n00:07:51.852 --> 00:07:53.672\ngrab your $10 switch here.\n\n148\n00:07:53.672 --> 00:07:55.816\nWe're talking Cisco Enterprise equipment.\n\n149\n00:07:55.816 --> 00:07:58.840\n>> That's it, and\nthis will happen to you sooner or later.\n\n150\n00:07:58.840 --> 00:08:01.693\nYou'll go to a CIO, and\nyou'll say I need a new switch.\n\n151\n00:08:01.693 --> 00:08:04.440\nI want to get this 24-port Cisco switch.\n\n152\n00:08:04.440 --> 00:08:08.097\nIt costs $2,000 And the CIO says,\nwait a minute, wait a minute.\n\n153\n00:08:08.097 --> 00:08:12.792\nI was down at Best Buy just the other day,\nthey had a 24 port Linksys or NETGEAR or\n\n154\n00:08:12.792 --> 00:08:14.890\nsomething, it was 200 bucks.\n\n155\n00:08:14.890 --> 00:08:16.770\nWhy is this one so much more?\n\n156\n00:08:16.770 --> 00:08:20.430\nAnd this is why,\nthat accelerated hardware,\n\n157\n00:08:20.430 --> 00:08:22.750\nthe dedication to engineering\nthat you have inside of it.\n\n158\n00:08:22.750 --> 00:08:25.290\nNow we do you need to\nbe aware of one thing.\n\n159\n00:08:25.290 --> 00:08:28.670\nThe T cam is just one set of memory, and\n\n160\n00:08:28.670 --> 00:08:30.580\nI said there were five\nthings stored in there.\n\n161\n00:08:30.580 --> 00:08:33.960\nSo that memory's being\ndivided up five ways.\n\n162\n00:08:33.960 --> 00:08:37.022\nNow in a small or a medium business,\nwe don't worry about that.\n\n163\n00:08:37.022 --> 00:08:38.813\nWe're not never going\nto use all that memory.\n\n164\n00:08:38.813 --> 00:08:43.385\nBut in an enterprise, you have to be\ncareful because one table could grow too\n\n165\n00:08:43.385 --> 00:08:46.385\nlarge and make another table not function.\n\n166\n00:08:46.385 --> 00:08:51.720\nSo, inside of your Cisco switches,\nall of your higher end Cisco switches,\n\n167\n00:08:51.720 --> 00:08:55.100\nyou've got a little thing running\nin the background called the SDM.\n\n168\n00:08:55.100 --> 00:08:59.570\nAnd the SDM lets you manage\nthe memory on the switch and\n\n169\n00:08:59.570 --> 00:09:04.070\nkind of dictate how you want that\nto be divvied up across the system.\n\n170\n00:09:04.070 --> 00:09:06.300\nAnd SDM stands for\nSwitching Database Manager.\n\n171\n00:09:06.300 --> 00:09:09.477\nDon't confuse that with the, was it\nsecurity and device manager, the GY?\n\n172\n00:09:09.477 --> 00:09:13.386\n>> Yes which I did [LAUGH].\n\n173\n00:09:13.386 --> 00:09:15.017\n>> Cisco is using the same acronym twice.\n\n174\n00:09:15.017 --> 00:09:16.873\n>> Thanks a lot Cisco, thanks a lot\n>> Within the same\n\n175\n00:09:16.873 --> 00:09:17.650\ncompany\n>> [LAUGH]\n\n176\n00:09:17.650 --> 00:09:20.070\n>> Yeah but it's the switching device\n\n177\n00:09:20.070 --> 00:09:23.150\nsorry switching data base manager and\nwe can actually see it.\n\n178\n00:09:23.150 --> 00:09:30.650\nIt's a command like here I've got on\nmy switch if I do show SDM prefer okay.\n\n179\n00:09:30.650 --> 00:09:34.040\nThe way the SDM works,\nis it has these things called templates.\n\n180\n00:09:34.040 --> 00:09:38.080\nAnd the templates define how\nthat memory is divided up.\n\n181\n00:09:38.080 --> 00:09:42.123\nSo, when I do show SDM prefer,\nit shows me what template I'm using,\n\n182\n00:09:42.123 --> 00:09:44.630\nI'm using desktop default.\n\n183\n00:09:44.630 --> 00:09:49.240\nAnd then beneath it, it shows me\nhow my TCAM is being divided up.\n\n184\n00:09:49.240 --> 00:09:51.000\nWhat's getting what memory?\n\n185\n00:09:51.000 --> 00:09:54.250\nSo my number of unicast mac addresses.\n\n186\n00:09:55.750 --> 00:10:00.340\nIf I have mac addresses mapped to a port,\nI've got a 48-bit mac address,\n\n187\n00:10:00.340 --> 00:10:02.600\nI got a port number,\nI got to tie them together.\n\n188\n00:10:02.600 --> 00:10:06.000\nIt's allocating six kilobytes\nof memory for that.\n\n189\n00:10:06.000 --> 00:10:07.420\nAnd then as we start to look down,\nactually sorry,\n\n190\n00:10:07.420 --> 00:10:09.390\nthis is not the actually the raw memory.\n\n191\n00:10:09.390 --> 00:10:12.040\nThis is 6,000 addresses.\n\n192\n00:10:12.040 --> 00:10:18.800\nSo, right now it's portioned out enough\nmemory for me to hold 6,000 MAC addresses.\n\n193\n00:10:18.800 --> 00:10:21.935\nIn a small and medium business, am I going\nto have more than 6,000 MAC addresses?\n\n194\n00:10:21.935 --> 00:10:23.314\nProbably not.\n\n195\n00:10:23.314 --> 00:10:25.990\n>> That's a lot [LAUGH]\n>> In an enterprise, I might.\n\n196\n00:10:25.990 --> 00:10:27.250\nAll right?\n\n197\n00:10:27.250 --> 00:10:32.620\nIn an enterprise, I might need more\nthan 6,000 Mac addresses on one VLAN.\n\n198\n00:10:32.620 --> 00:10:34.680\nAnd just not all my VLANs together.\n\n199\n00:10:34.680 --> 00:10:37.630\nThis switch might be able\nto see over 6,000 Macs and\n\n200\n00:10:37.630 --> 00:10:39.769\nit's gonna run out of memory and\nit's not gonna be able to handle it.\n\n201\n00:10:40.850 --> 00:10:43.400\nAnd as you look down you'll see\nother things in here like IPv6,\n\n202\n00:10:43.400 --> 00:10:46.530\nyou've got IPv4 unicast routes.\n\n203\n00:10:46.530 --> 00:10:50.608\nNow, this switch the way it's set,\nhas enough room for 8,000 routes,\n\n204\n00:10:50.608 --> 00:10:53.400\n8,000 unicast routes and\nthat's great right?\n\n205\n00:10:53.400 --> 00:10:55.530\nBut what if I have more than 8000 rounds?\n\n206\n00:10:55.530 --> 00:10:57.960\nWell, you shouldn't be doing it on switch,\nfirst off, right?\n\n207\n00:10:57.960 --> 00:10:59.350\nThat's a bad design.\n\n208\n00:10:59.350 --> 00:11:02.250\nBut it's also an example\nwhere we might be wasting.\n\n209\n00:11:02.250 --> 00:11:06.710\nI might be wasting this if\nI'm not even doing routing.\n\n210\n00:11:06.710 --> 00:11:10.220\nI could take some of that memory that's\nbeing used for routing and give it over to\n\n211\n00:11:10.220 --> 00:11:15.070\nthe MAC addresses, and now I can have even\nmore Mac addresses available, alright?\n\n212\n00:11:15.070 --> 00:11:17.980\nAnd we do that by manipulating that,\nthat cam table.\n\n213\n00:11:17.980 --> 00:11:19.690\nOr not, sorry not cam table.\n\n214\n00:11:19.690 --> 00:11:21.360\nI mean you are manipulating the T cam,\n\n215\n00:11:21.360 --> 00:11:23.630\njust manipulating how it's divided up,\nright?\n\n216\n00:11:23.630 --> 00:11:26.950\nBy manipulating which template is applied.\n\n217\n00:11:26.950 --> 00:11:28.430\nAnd so we can change those.\n\n218\n00:11:28.430 --> 00:11:33.720\nIf you do SDM, sorry, gotta get into\nconfig, if I get in the right place here.\n\n219\n00:11:33.720 --> 00:11:37.990\nYou can do SDM question mark, and\nyou'll see we've got that prefer command.\n\n220\n00:11:37.990 --> 00:11:41.240\nAnd if you do SDM prefer question mark,\n\n221\n00:11:41.240 --> 00:11:43.290\nyou'll see the templates\nthat are available.\n\n222\n00:11:43.290 --> 00:11:48.960\nNow, the template names are pretty much\nthe same across all the Cisco hardware,\n\n223\n00:11:48.960 --> 00:11:50.850\nbut the amount of memory is different.\n\n224\n00:11:50.850 --> 00:11:53.687\nSo if you want to see exactly how\nmuch memory you get from each one,\n\n225\n00:11:53.687 --> 00:11:56.320\nyou really need to go and\npull the hardware documentation for\n\n226\n00:11:56.320 --> 00:11:57.520\nyour switch to find it out.\n\n227\n00:11:57.520 --> 00:12:01.690\nIt's no the same for all of them, but\nit gives you a hint as to what they do.\n\n228\n00:12:01.690 --> 00:12:02.210\nRight?\n\n229\n00:12:02.210 --> 00:12:04.080\nWe're in default desktop right now.\n\n230\n00:12:04.080 --> 00:12:06.730\nAnd, default desktop kind of,\nis middle of the line, right?\n\n231\n00:12:06.730 --> 00:12:09.650\nCovers all the different bases\nto make sure that you've got\n\n232\n00:12:09.650 --> 00:12:11.110\nthe functionality you need.\n\n233\n00:12:11.110 --> 00:12:13.470\nBut, you can go to Access.\n\n234\n00:12:13.470 --> 00:12:17.430\nIf I'm in Access switch,\nI don't need all that routing area, right?\n\n235\n00:12:17.430 --> 00:12:21.100\nI can just go Access and I don't have to\nworry about needing that extra memory.\n\n236\n00:12:21.100 --> 00:12:25.500\nI can do dual IPv4 and\nIPv6 to split that up.\n\n237\n00:12:25.500 --> 00:12:28.290\nI can do routing to give a little\nmore memory to routing and\n\n238\n00:12:28.290 --> 00:12:30.160\ntake memory away from other things.\n\n239\n00:12:30.160 --> 00:12:33.040\nOr we can VLANs to support\nlarge VLAN tables.\n\n240\n00:12:33.040 --> 00:12:35.500\nYou pick what's more accurate for\nyour environment.\n\n241\n00:12:36.880 --> 00:12:40.660\nAnd when you set that, so\nif I set mine to SDM prefer access,\n\n242\n00:12:41.880 --> 00:12:45.300\nI'm gonna set that and\nit warns me this is a hardcore change.\n\n243\n00:12:45.300 --> 00:12:47.610\nYou're changing the way\nit's handling memory.\n\n244\n00:12:47.610 --> 00:12:50.070\nYou gotta reboot for\nthat to take effect, right?\n\n245\n00:12:50.070 --> 00:12:56.220\nSo, it's set though and if I get out of\nmy config, I can now run show SDM prefer\n\n246\n00:12:58.760 --> 00:13:03.570\nand when I run it this time, it's gonna\nshow me way down here at the bottom\n\n247\n00:13:03.570 --> 00:13:07.670\non next reload template will\nbe desktop access IPv4.\n\n248\n00:13:08.950 --> 00:13:11.490\nThat's the new template\nthat's going to apply, and\n\n249\n00:13:11.490 --> 00:13:13.200\nthese numbers are gonna change, right?\n\n250\n00:13:13.200 --> 00:13:16.120\nSo let's just remember,\nI'm gonna put it in the back of my mind.\n\n251\n00:13:16.120 --> 00:13:17.725\nI say I'm gonna remember,\nI'm totally gonna forget.\n\n252\n00:13:17.725 --> 00:13:20.820\n>> [LAUGH]\n>> That we've got 6,000 MAC\n\n253\n00:13:20.820 --> 00:13:25.320\naddresses right now available and\nwe've got 8,000 routes available.\n\n254\n00:13:25.320 --> 00:13:26.830\nSo those are the numbers that I've got,\nbut\n\n255\n00:13:26.830 --> 00:13:29.200\nI just told it I wanna focus on access.\n\n256\n00:13:29.200 --> 00:13:33.130\nSo I'm gonna leave that, and\nI'm gonna save my config.\n\n257\n00:13:34.760 --> 00:13:38.290\nSo we'll just back that up real quick,\nand then I'm going to reboot the switch.\n\n258\n00:13:38.290 --> 00:13:41.790\nAnd while it reboots,\nit's gonna take the OS down.\n\n259\n00:13:41.790 --> 00:13:44.590\nAnd then when it comes up it's\ngoing to apply this new template.\n\n260\n00:13:44.590 --> 00:13:48.180\nAnd when the system boots the rest of the\nway, the new template will be in place,\n\n261\n00:13:48.180 --> 00:13:52.700\nand we'll have a different\nset off memory available.\n\n262\n00:13:52.700 --> 00:13:55.500\nIt's the same memory it's\njust divided differently.\n\n263\n00:13:55.500 --> 00:13:56.580\nSo we'll let that turkey reboot.\n\n264\n00:13:56.580 --> 00:13:59.550\nAnd then there it goes.\n\n265\n00:13:59.550 --> 00:14:02.110\nNow while we're waiting on that,\nlet me jump over to another switch.\n\n266\n00:14:02.110 --> 00:14:03.220\nYou'll see that was core two.\n\n267\n00:14:03.220 --> 00:14:05.250\nI'm gonna jump over to this guy.\n\n268\n00:14:05.250 --> 00:14:12.300\nAnd [COUGH] on this one, this switch\nright here is set up as just the default.\n\n269\n00:14:12.300 --> 00:14:14.290\nSo kind of what we saw\non the one a moment ago.\n\n270\n00:14:14.290 --> 00:14:18.320\nSo if I do show SDM prefer,\nwe can see that it will\n\n271\n00:14:18.320 --> 00:14:20.630\njust have that standard desktop\ndefault like the other one.\n\n272\n00:14:21.780 --> 00:14:27.360\nNow if I do show MAC address table and\nI run that.\n\n273\n00:14:27.360 --> 00:14:29.180\nWhen it starts to display\nthe MAC address table,\n\n274\n00:14:29.180 --> 00:14:32.570\nsee how it doesn't really tell me\nanything about the memory up here.\n\n275\n00:14:32.570 --> 00:14:37.110\nIt doesn't give you any warnings like\nhere's how much memory you have available.\n\n276\n00:14:37.110 --> 00:14:40.990\nIt just starts filling up, and you'll\nsee I've got static entries here for\n\n277\n00:14:40.990 --> 00:14:42.960\nsome of the VLANs that I've got.\n\n278\n00:14:42.960 --> 00:14:44.960\nAnd some of the other ones\nthat I'm mapping, and\n\n279\n00:14:44.960 --> 00:14:48.120\nI've got my total Mac addresses available.\n\n280\n00:14:48.120 --> 00:14:48.950\nBut that's it, right.\n\n281\n00:14:48.950 --> 00:14:51.610\nSo you don't really get any warnings.\n\n282\n00:14:51.610 --> 00:14:54.990\nYou just kind of have to look\nat that SDM template and\n\n283\n00:14:54.990 --> 00:14:56.970\nmake sure you've got the right one for\nyour environment.\n\n284\n00:14:56.970 --> 00:15:00.170\nAnd you do really need to look at the\nhardware documentation for your switch.\n\n285\n00:15:00.170 --> 00:15:04.640\n>> So it's really all about fine tuning\nthe switch and its role, where it's at.\n\n286\n00:15:04.640 --> 00:15:08.420\nAll that stuff comes into play, when\nyou're trying to figure out how you want\n\n287\n00:15:08.420 --> 00:15:10.650\nto maybe change what's going on in C CAM.\n\n288\n00:15:10.650 --> 00:15:12.310\n>> Yeah, yep, absolutely.\n\n289\n00:15:12.310 --> 00:15:15.460\nAnd while we're waiting on that other\nswitch to reboot, cuz you know switches do\n\n290\n00:15:15.460 --> 00:15:18.840\ntake a while to reboot, a few other\nthings about this Mac address table.\n\n291\n00:15:18.840 --> 00:15:21.400\nLet me show you guys just some tricks\nthat can be helpful out there in\n\n292\n00:15:21.400 --> 00:15:22.300\nthe real world.\n\n293\n00:15:22.300 --> 00:15:25.230\nI always just run show Mac address-table,\nand\n\n294\n00:15:25.230 --> 00:15:30.240\nthat's it, but in real life land,\nI usually throw a little filter on there.\n\n295\n00:15:30.240 --> 00:15:32.410\nI'm usually looking for\na particular Mac address.\n\n296\n00:15:32.410 --> 00:15:32.990\nAnd you guys see that.\n\n297\n00:15:32.990 --> 00:15:34.890\nThere's a lot of output\nthat comes out here.\n\n298\n00:15:34.890 --> 00:15:37.720\nSo for example, if I'm just looking for\n\n299\n00:15:37.720 --> 00:15:42.850\none Mac address in particular, I might\njust get the last four digits of the Mac\n\n300\n00:15:42.850 --> 00:15:45.940\nbecause in most networks\nthat's enough to identify it.\n\n301\n00:15:45.940 --> 00:15:48.190\nSo I might be looking for 0418.\n\n302\n00:15:48.190 --> 00:15:52.351\nAnd so,\nyou could run show mac address-table And\n\n303\n00:15:52.351 --> 00:15:59.401\nadd the little pipe character, then do\nI for include, then just look for 0418.\n\n304\n00:15:59.401 --> 00:16:03.158\nAnd then it can look through and\njust return those values that you want.\n\n305\n00:16:03.158 --> 00:16:06.842\nA quick,\neasy way to find the ones that you need.\n\n306\n00:16:06.842 --> 00:16:12.930\nThe other thing is Each VLAN technically\nhas its own MAC address table.\n\n307\n00:16:12.930 --> 00:16:15.800\nSo when I do a show mac address-table,\n\n308\n00:16:15.800 --> 00:16:19.370\nit's actually showing me the MAC table for\nall of the different VLANs.\n\n309\n00:16:19.370 --> 00:16:22.280\nBut when you do show mac address-table,\n\n310\n00:16:22.280 --> 00:16:26.970\nif you do a little question mark at\nthe end, see how you can specify a VLAN?\n\n311\n00:16:26.970 --> 00:16:31.200\nI can come in and I can say, just show\nme the MAC address table for VLAN 16,\n\n312\n00:16:31.200 --> 00:16:33.410\nand that's it.\n\n313\n00:16:33.410 --> 00:16:36.310\nDon't show me the other ones,\nand now I'm looking at it, and\n\n314\n00:16:36.310 --> 00:16:38.060\nI'm just seeing vlan 16.\n\n315\n00:16:38.060 --> 00:16:41.750\nThere's some special ones, like these\nguys, that are flagged as all, but\n\n316\n00:16:41.750 --> 00:16:43.920\notherwise, I've got those\ndown there that are just 16,\n\n317\n00:16:43.920 --> 00:16:45.820\nthat's leading the others out.\n\n318\n00:16:45.820 --> 00:16:48.360\nSo, just a couple of ways to\nkind of filter that output,\n\n319\n00:16:48.360 --> 00:16:52.600\nbecause If you've got 6000 MAC\naddresses in your MAC address table,\n\n320\n00:16:52.600 --> 00:16:54.690\nyou're never going to want\nto view the whole thing.\n\n321\n00:16:54.690 --> 00:16:58.870\nYou're always going to want to view\na single VLAN or a single MAC address.\n\n322\n00:16:58.870 --> 00:17:01.820\n>> Now Don, once those entries get\nput into the MAC address table how,\n\n323\n00:17:01.820 --> 00:17:03.440\nhow long do they stick around?\n\n324\n00:17:03.440 --> 00:17:07.120\n>> So, as long as the machine\nis plugged in and working, it,\n\n325\n00:17:07.120 --> 00:17:08.380\nit's always going to stay there right,\n\n326\n00:17:08.380 --> 00:17:12.870\nbecause the switch is constantly seeing\nthat Mac address and seeing it active.\n\n327\n00:17:12.870 --> 00:17:13.600\nAlright.\n\n328\n00:17:13.600 --> 00:17:15.900\nBut there's two scenarios where\nthat becomes a little problematic.\n\n329\n00:17:15.900 --> 00:17:17.620\nOne is if you turn the machine off.\n\n330\n00:17:17.620 --> 00:17:20.360\nRight, if we turn it off,\nwe're not going to see it anymore.\n\n331\n00:17:20.360 --> 00:17:21.180\nRight?\n\n332\n00:17:21.180 --> 00:17:24.840\nOr two,\nif you have a machine that doesn't chat.\n\n333\n00:17:24.840 --> 00:17:27.980\nMaybe you've got something like\nan intrusion detection device, and\n\n334\n00:17:27.980 --> 00:17:31.120\nit doesn't talk on the network at all,\nit just listens that's all it does.\n\n335\n00:17:31.120 --> 00:17:34.200\nI've seen some printers like this\nwhere they listen, they never talked.\n\n336\n00:17:34.200 --> 00:17:38.250\nRight and if that happens the switch will\nnever learn the macadisk never makes it to\n\n337\n00:17:38.250 --> 00:17:39.940\nthe macadisk table in the first place.\n\n338\n00:17:39.940 --> 00:17:42.840\nSo in those scenarios you might need to\nstatically map they're like what we saw\n\n339\n00:17:42.840 --> 00:17:44.070\nback in the CC and A.\n\n340\n00:17:45.150 --> 00:17:48.890\nFor a device that's idled out though,\none that's been turned off or taken away,\n\n341\n00:17:48.890 --> 00:17:50.190\nthere's actually a little timer.\n\n342\n00:17:50.190 --> 00:17:52.190\nOn most switches,\nit's set to five minutes.\n\n343\n00:17:52.190 --> 00:17:54.930\nAfter five minutes the MAC address will\ncome out of the MAC address table.\n\n344\n00:17:54.930 --> 00:17:57.670\nNow, is that a good thing or a bad thing?\n\n345\n00:17:57.670 --> 00:17:58.590\nUsually a good thing, right?\n\n346\n00:17:58.590 --> 00:18:01.110\nSomebody might unplug and\ngo plug in somewhere else, and\n\n347\n00:18:01.110 --> 00:18:04.040\nyou want it to age out, or they're\njust gone and they're not coming back.\n\n348\n00:18:04.040 --> 00:18:08.410\nBut, it does create a little\nMac address table instability.\n\n349\n00:18:08.410 --> 00:18:11.510\nYour Mac address table can be constantly\nupdating as these macs change.\n\n350\n00:18:11.510 --> 00:18:13.630\nSo you might want to increase that time.\n\n351\n00:18:13.630 --> 00:18:15.070\nYou can set it to whatever you want.\n\n352\n00:18:15.070 --> 00:18:17.610\nI'll show you on this\none while we're waiting.\n\n353\n00:18:17.610 --> 00:18:20.700\nSo if I just jump into my config,\nif I went to adjust that,\n\n354\n00:18:20.700 --> 00:18:24.070\nwell, actually, I guess I should have\nshown you the time in the first place,\n\n355\n00:18:24.070 --> 00:18:25.930\nright, because we don't\nnecessary know what it is.\n\n356\n00:18:25.930 --> 00:18:33.120\nIf you do a, it's show mac\naddress-table aging-time, all right.\n\n357\n00:18:33.120 --> 00:18:37.860\nSo they're the same command to show\nthe Mac table, you just add aging-time to\n\n358\n00:18:37.860 --> 00:18:43.078\nthe end, and I can see mine is set to 300\nseconds, which is five minutes, right?\n\n359\n00:18:43.078 --> 00:18:44.400\nGood.\nSo [LAUGH] I'm\n\n360\n00:18:44.400 --> 00:18:46.950\nusually bad about\nremembering those timers.\n\n361\n00:18:46.950 --> 00:18:49.140\nYep, so five minutes on this one.\n\n362\n00:18:49.140 --> 00:18:53.940\nAll right, now notice how you can\nset the aging time per Vlan too.\n\n363\n00:18:53.940 --> 00:18:56.240\nSo, I might have a VLan\nthat's a guest network.\n\n364\n00:18:56.240 --> 00:18:58.770\nA wireless network that\npeople jump on as they visit.\n\n365\n00:18:58.770 --> 00:19:03.570\nAnd so, I might ant that one to come and\ngo as time permits.\n\n366\n00:19:03.570 --> 00:19:04.260\nRight?\n\n367\n00:19:04.260 --> 00:19:06.970\nBut, my main network is pretty stable, so\n\n368\n00:19:06.970 --> 00:19:09.030\nI might want to have\na larger time on that one.\n\n369\n00:19:09.030 --> 00:19:10.650\nMaybe I want it to be 15 minutes.\n\n370\n00:19:10.650 --> 00:19:11.940\nSomething a little bit longer.\n\n371\n00:19:11.940 --> 00:19:15.930\nSo we can go in and start to manipulate\nthat to increase it to something to create\n\n372\n00:19:15.930 --> 00:19:17.630\nhigher MAC address stability.\n\n373\n00:19:17.630 --> 00:19:22.590\nAnd so we do that here in our config,\nif we use the MAC command, so\n\n374\n00:19:22.590 --> 00:19:24.450\nI'm not using show,\nI'm, I'm in config now.\n\n375\n00:19:24.450 --> 00:19:27.220\nSo I'm just saying MAC address dash table,\n\n376\n00:19:28.550 --> 00:19:32.170\naging dash time, and\nthen we can specify time.\n\n377\n00:19:32.170 --> 00:19:34.240\nI like this command,\nbecause it's the same as the show command,\n\n378\n00:19:34.240 --> 00:19:37.620\nyou just leave show off, and\nthen you add what time you want.\n\n379\n00:19:37.620 --> 00:19:39.090\nAnd the time's in seconds.\n\n380\n00:19:39.090 --> 00:19:41.510\nAnd so, I'll just specify,\nwhat'd I say, 15 minutes?\n\n381\n00:19:41.510 --> 00:19:43.330\nThat would be 900 seconds?\n\n382\n00:19:43.330 --> 00:19:44.070\n>> Yes.\n\n383\n00:19:44.070 --> 00:19:45.590\n>> My bad math again.\n\n384\n00:19:45.590 --> 00:19:47.970\nSo, I'm going to set it to 900.\n\n385\n00:19:47.970 --> 00:19:48.490\nOkay.\n\n386\n00:19:48.490 --> 00:19:54.080\nNow when I did that, if I take a look,\nthat was my global aging time.\n\n387\n00:19:54.080 --> 00:19:57.370\nIt just changed the aging time for\nevery vlan.\n\n388\n00:19:57.370 --> 00:19:59.520\nAnd that might not be\nwhat I really wanted.\n\n389\n00:19:59.520 --> 00:20:03.890\nWhat I might have wanted was to\nlimit that to a particular vlan.\n\n390\n00:20:03.890 --> 00:20:07.060\nI might vlan 1 to have\nan aging time of 300.\n\n391\n00:20:07.060 --> 00:20:09.690\nSo I'm just going to add\nvlan one to the end of that.\n\n392\n00:20:09.690 --> 00:20:14.520\nVersus everybody else to have the aging\ntime of 300, which was the default.\n\n393\n00:20:16.020 --> 00:20:19.480\nNow, I entered these in out of order,\nbut I'm pretty sure it preserves that.\n\n394\n00:20:19.480 --> 00:20:21.080\nLet's very.\n\n395\n00:20:21.080 --> 00:20:22.340\nTrust, but verify, right?\n\n396\n00:20:22.340 --> 00:20:23.090\n>> That is exactly right.\n\n397\n00:20:23.090 --> 00:20:26.030\n>> Let's just see, and sure enough,\nit overwrote my individual one.\n\n398\n00:20:26.030 --> 00:20:27.800\nSo let me put by individual one back in.\n\n399\n00:20:27.800 --> 00:20:31.454\nAlways good to verify your commands and\nmake sure they actually take effect,\n\n400\n00:20:31.454 --> 00:20:33.400\nbecause you might override\nthem like I just did.\n\n401\n00:20:33.400 --> 00:20:34.360\nThere we go.\n\n402\n00:20:34.360 --> 00:20:38.720\nNow my global aging time is 300 seconds,\nbut on Vlan one it's 900 seconds.\n\n403\n00:20:38.720 --> 00:20:40.540\nSo we can tweak that.\n\n404\n00:20:40.540 --> 00:20:43.390\nNow, I just changed that on one switch.\n\n405\n00:20:43.390 --> 00:20:45.730\nI've got three switches in my topology.\n\n406\n00:20:45.730 --> 00:20:50.610\nSo it's a good idea to be consistent\nwith your MAC address aging times\n\n407\n00:20:50.610 --> 00:20:53.250\nacross your switches,\nbut you don't have to.\n\n408\n00:20:53.250 --> 00:20:56.720\nIt's not really going to\nbreak anything too crazy.\n\n409\n00:20:56.720 --> 00:21:00.064\nIt can just create some instability if my\nswitch assumes a client is one direction,\n\n410\n00:21:00.064 --> 00:21:03.364\nbut there's another switch somewhere else\nthat's luring the clients in another\n\n411\n00:21:03.364 --> 00:21:06.883\ndirection, we just haven't learned it yet\nbecause we haven't aged this record out.\n\n412\n00:21:06.883 --> 00:21:10.134\nSo, you want to avoid that\nnormally whenever you can.\n\n413\n00:21:10.134 --> 00:21:13.129\n>> So if you like confusing yourself, make\nsure to change them all into crazy times.\n\n414\n00:21:13.129 --> 00:21:14.012\n[LAUGH]\n>> Yeah.\n\n415\n00:21:14.012 --> 00:21:15.985\n[CROSSTALK]\n>> What is this doing?\n\n416\n00:21:15.985 --> 00:21:19.440\n>> [LAUGH] [COUGH] All right, now my\nother switch should be rebooted by now.\n\n417\n00:21:19.440 --> 00:21:21.370\nSo I'm going to jump back over,\ncheck that one out.\n\n418\n00:21:21.370 --> 00:21:23.710\nAnd sure enough looks like he's back up.\n\n419\n00:21:23.710 --> 00:21:26.090\nI've got some nice little\nstatus messages here.\n\n420\n00:21:26.090 --> 00:21:27.660\nSo I'm just going to jump in here.\n\n421\n00:21:27.660 --> 00:21:31.000\nAnd this was the one that I\nadjusted the SDM template on.\n\n422\n00:21:31.000 --> 00:21:34.170\nAnd so, I should have some slightly\ndifferent memory configurations.\n\n423\n00:21:34.170 --> 00:21:36.650\nAnd now I have to think all the way\nback to the beginning of the show.\n\n424\n00:21:36.650 --> 00:21:39.630\nSo before, we had 6,000 Mac addresses.\n\n425\n00:21:39.630 --> 00:21:41.538\nAnd was it 8,000 routes?\n\n426\n00:21:41.538 --> 00:21:43.458\n>> 6,000, did we say just the 8,000?\n\n427\n00:21:43.458 --> 00:21:44.289\nIt was 6,000.\n\n428\n00:21:44.289 --> 00:21:46.760\n[CROSSTALK]\n>> 6,000 Macs.\n\n429\n00:21:46.760 --> 00:21:48.570\nSo we'll show sdm prefer.\n\n430\n00:21:48.570 --> 00:21:50.810\nAnd now when I look,\nlook what I ended up with.\n\n431\n00:21:50.810 --> 00:21:55.531\nUnicast Mac address actually\ndropped to 4K, down to 4,000.\n\n432\n00:21:55.531 --> 00:22:00.010\nAnd then if I look at my routes,\nthey went from 8K down to 6K.\n\n433\n00:22:00.010 --> 00:22:01.770\nNow, why did that happen?\n\n434\n00:22:01.770 --> 00:22:03.080\nIf I'm going to be an access switch,\n\n435\n00:22:03.080 --> 00:22:05.880\nisn't an access switch going\nto have more Mac addresses?\n\n436\n00:22:05.880 --> 00:22:07.870\nWell, not necessarily.\n\n437\n00:22:07.870 --> 00:22:11.690\nAn access switch is, generally we\nwant high port density, so yes,\n\n438\n00:22:11.690 --> 00:22:15.510\nyou're going to have a lot of Mac\naddresses, but we're also applying things\n\n439\n00:22:15.510 --> 00:22:20.080\nlike ACLs before hitting a layer three\nswitch to act as our distribution layer.\n\n440\n00:22:20.080 --> 00:22:23.520\nAnd the distribution layers will often\ntimes be aware of the most Mac addresses.\n\n441\n00:22:23.520 --> 00:22:26.895\nThey actually need more Mac addresses\nthan like an access switch would,\n\n442\n00:22:26.895 --> 00:22:29.590\nbecause access switches\njust get divided up.\n\n443\n00:22:29.590 --> 00:22:34.850\nSo when we look down here, we'll start\nto see some other things have gone up,\n\n444\n00:22:34.850 --> 00:22:41.160\nlike our IPv4/MAC security ACDs,\nthe access control entries, have gone up.\n\n445\n00:22:41.160 --> 00:22:44.431\nSo we get a little bit more of some things\nand a little bit less of the other.\n\n446\n00:22:44.431 --> 00:22:48.543\nSo this is definitely why you want to jump\nin and check the documentation in your\n\n447\n00:22:48.543 --> 00:22:52.552\nhardware and see what member you're\ngoing to get with each configuration.\n\n448\n00:22:52.552 --> 00:22:55.253\n>> Now Don, we've going over this\ngreat switch administration,\n\n449\n00:22:55.253 --> 00:22:58.130\nthis is something that we\ndefinitely need to know about.\n\n450\n00:22:58.130 --> 00:23:01.180\nOne of the things that I've realized\nin my career is that a lot of switch\n\n451\n00:23:01.180 --> 00:23:05.960\nadministration comes down to, I've got\na device plugged in, it's turned on, and\n\n452\n00:23:05.960 --> 00:23:08.110\nit's not showing up in the table.\n\n453\n00:23:08.110 --> 00:23:10.430\nAnd that can be extremely frustrating.\n\n454\n00:23:10.430 --> 00:23:12.050\nYou had to do a lot of troubleshooting.\n\n455\n00:23:12.050 --> 00:23:12.890\nYou're going to help us out with this.\n\n456\n00:23:12.890 --> 00:23:15.730\nYou're going to give us some\nnice things to follow, right?\n\n457\n00:23:15.730 --> 00:23:19.690\n>> Yeah, normally if you plug\na device in and it gets a link light,\n\n458\n00:23:19.690 --> 00:23:22.820\nthen usually that means your MAC\naddress is going to be detected.\n\n459\n00:23:22.820 --> 00:23:25.110\nYou're going to be in the MAC table,\nright?\n\n460\n00:23:25.110 --> 00:23:27.040\nThe link light is all you need.\n\n461\n00:23:27.040 --> 00:23:29.990\nBut there is a certain condition that\ncan happen on a Cisco switch that\n\n462\n00:23:29.990 --> 00:23:33.530\ncan cause you to have a link light and\nnot show up in the Mac table,\n\n463\n00:23:33.530 --> 00:23:35.180\nnot be able to communicate, all right?\n\n464\n00:23:35.180 --> 00:23:37.407\nIt's called err-disable, right?\n\n465\n00:23:37.407 --> 00:23:40.290\nE-R-R-disable, err-disable.\n\n466\n00:23:40.290 --> 00:23:42.630\nAnd err-disable is a status.\n\n467\n00:23:42.630 --> 00:23:45.000\nIt's just short for error disabled.\n\n468\n00:23:45.000 --> 00:23:48.820\nAnd it means that the interface might\nlook like it's functioning, but\n\n469\n00:23:48.820 --> 00:23:52.340\nan error occurred that\nmade the switch disabled.\n\n470\n00:23:52.340 --> 00:23:55.530\nAnd oftentimes this can cause\nthe link light to turn off, so\n\n471\n00:23:55.530 --> 00:23:57.130\nyou don't get a link light at all.\n\n472\n00:23:57.130 --> 00:24:00.990\nBut there are times when the link light\nstays on, and you just can communicate,\n\n473\n00:24:00.990 --> 00:24:02.980\nit creates a really tricky situation.\n\n474\n00:24:02.980 --> 00:24:06.374\nSo, if you have a client plugged in and\nyou're just not learning their Mac\n\n475\n00:24:06.374 --> 00:24:09.127\naddress, it's a good idea to\nsee if the port got disabled.\n\n476\n00:24:09.127 --> 00:24:11.826\nI know, I said there's a couple of\nsituations that can cause this.\n\n477\n00:24:11.826 --> 00:24:16.230\nThere's actually a lot of\nsituations that can cause it.\n\n478\n00:24:16.230 --> 00:24:21.120\nRanging from bad cabling,\nunidirectional links,\n\n479\n00:24:21.120 --> 00:24:24.120\nmaybe you've got eight wires\ninside of a cat five cable and\n\n480\n00:24:24.120 --> 00:24:26.660\nmaybe one of them is loose,\nthat can cause error disabled.\n\n481\n00:24:26.660 --> 00:24:31.160\nYou could have a duplex mismatch that's\nsignificant and that could cause it.\n\n482\n00:24:31.160 --> 00:24:34.940\nThat's not so common anymore but\non older switches it is.\n\n483\n00:24:34.940 --> 00:24:37.240\nWe can have security violations.\n\n484\n00:24:37.240 --> 00:24:39.440\nIf you've configured port security, and\n\n485\n00:24:39.440 --> 00:24:42.150\nyou've restricted a port to\na particular MAC address.\n\n486\n00:24:42.150 --> 00:24:45.620\nAnd you plug in somebody else's\nmachine with a different MAC address,\n\n487\n00:24:45.620 --> 00:24:46.870\nit's gonna trigger port security, right?\n\n488\n00:24:46.870 --> 00:24:51.230\nWe saw that in the CCNA Well,\nwhen port security locks down a port,\n\n489\n00:24:51.230 --> 00:24:52.260\nthat's air disabled.\n\n490\n00:24:52.260 --> 00:24:53.560\nThat's another one.\n\n491\n00:24:53.560 --> 00:24:55.960\nAnd when a port goes air disabled,\nit's going to lock it, and\n\n492\n00:24:55.960 --> 00:24:59.020\nit's going to stay locked\nforever by default.\n\n493\n00:24:59.020 --> 00:25:01.100\nUntil one of two things happens.\n\n494\n00:25:01.100 --> 00:25:04.440\nEither one, an administrator shuts\nthe port down and turns it back on.\n\n495\n00:25:04.440 --> 00:25:05.660\nThat resets it.\n\n496\n00:25:05.660 --> 00:25:07.490\nOr two, somebody reboots the switch.\n\n497\n00:25:07.490 --> 00:25:09.350\nWhich hopefully you never do.\n\n498\n00:25:09.350 --> 00:25:11.940\nSo, those are the two conditions\nthat'll bring that port back up, but\n\n499\n00:25:11.940 --> 00:25:15.740\nif the error condition still exists it's\njust going to go error disabled again,\n\n500\n00:25:15.740 --> 00:25:17.740\nit's not going to help anything.\n\n501\n00:25:17.740 --> 00:25:20.706\nSo you normally need to\nresolve the issue first and\n\n502\n00:25:20.706 --> 00:25:22.832\nthen resolve it by doing shut down.\n\n503\n00:25:22.832 --> 00:25:25.510\nNow I've had these happen\nin production before,\n\n504\n00:25:25.510 --> 00:25:28.000\nI'll give you one that happened to me.\n\n505\n00:25:28.000 --> 00:25:32.190\nIs what if you're doing span,\nright, the switchport analyzer.\n\n506\n00:25:32.190 --> 00:25:34.590\nYou're mirroring traffic from\none port to another port.\n\n507\n00:25:35.690 --> 00:25:39.100\nWhat if you're monitoring a gigabit port,\nand\n\n508\n00:25:39.100 --> 00:25:41.580\nyou're sending its traffic\nto a 100 meg port?\n\n509\n00:25:41.580 --> 00:25:42.750\nWhat's gonna happen?\n\n510\n00:25:42.750 --> 00:25:44.060\nYou're gonna overwhelm the port.\n\n511\n00:25:44.060 --> 00:25:46.260\nAnd when that happens, they're disabled.\n\n512\n00:25:46.260 --> 00:25:48.320\nAnd it's beautiful because\nit takes both ports down.\n\n513\n00:25:48.320 --> 00:25:49.280\n>> Oh, that's amazing.\n\n514\n00:25:49.280 --> 00:25:50.660\n>> It doesn't just take\nthe 100 meg one down.\n\n515\n00:25:50.660 --> 00:25:52.344\nThat would be too convenient.\n\n516\n00:25:52.344 --> 00:25:53.683\n>> If we're gonna fail,\nwe're gonna fail epically.\n\n517\n00:25:53.683 --> 00:25:55.450\n[LAUGH]\n>> That's right, it goes all out.\n\n518\n00:25:55.450 --> 00:25:57.520\nSo you know it can really\nput you in a bind.\n\n519\n00:25:57.520 --> 00:26:01.140\nSo you always wanna remember that\nthere's a special error status\n\n520\n00:26:01.140 --> 00:26:03.780\nthat's not necessarily reflected\non the front of the switch.\n\n521\n00:26:03.780 --> 00:26:06.830\nIf you have a Syslog set up,\nit will generate Syslog messages.\n\n522\n00:26:06.830 --> 00:26:10.750\nYou will see that unless the error's\naffecting your connectivity to\n\n523\n00:26:10.750 --> 00:26:16.030\nthe Syslog Server, so there's potential\nhere that err-disabled could occur and\n\n524\n00:26:16.030 --> 00:26:17.580\nyou'd be locked out of the switch.\n\n525\n00:26:17.580 --> 00:26:19.650\nAnd now, you've gotta get a console\ncable and plug right into it.\n\n526\n00:26:19.650 --> 00:26:20.668\nSo it's a pretty deal.\n\n527\n00:26:20.668 --> 00:26:22.346\nIt's definitely something\nyou wanna watch out for.\n\n528\n00:26:22.346 --> 00:26:25.201\nFortunately, there's a couple of\ncommands we can use to evaluate whether\n\n529\n00:26:25.201 --> 00:26:26.270\nwe've got this.\n\n530\n00:26:26.270 --> 00:26:30.010\nIf you've plugged in a device,\nand it is not showing up.\n\n531\n00:26:30.010 --> 00:26:35.190\nOne of the easiest commands is to\ndive right out here to enable your\n\n532\n00:26:35.190 --> 00:26:41.250\nprivileged user prompt, and\njust run a show interface status.\n\n533\n00:26:41.250 --> 00:26:45.540\nShow interface status is a neat\ncommand because it gives you a summary\n\n534\n00:26:45.540 --> 00:26:49.450\nof all of your interfaces, and\nit should show them as connected.\n\n535\n00:26:49.450 --> 00:26:50.780\nThat they are up and healthy and\n\n536\n00:26:50.780 --> 00:26:55.200\nhappy, but you might see not connect\nif it's not plugged in, right?\n\n537\n00:26:55.200 --> 00:26:58.030\nIf you know the device is plugged\nin that's almost guaranteed to be\n\n538\n00:26:58.030 --> 00:26:58.810\na bad cable.\n\n539\n00:26:58.810 --> 00:27:01.110\nThe cable is just not working.\n\n540\n00:27:01.110 --> 00:27:06.413\nOr you might see one like\nmyFA1/0/12 right here.\n\n541\n00:27:06.413 --> 00:27:07.270\nError disabled.\n\n542\n00:27:08.520 --> 00:27:12.200\nIf I look at the front of that switch,\nit might have a link light.\n\n543\n00:27:12.200 --> 00:27:13.130\nIt very well might.\n\n544\n00:27:14.980 --> 00:27:18.472\nBut whatever MAC address is on it is not\nshowing up in my MAC address table and\n\n545\n00:27:18.472 --> 00:27:20.370\nthat device is not able to communicate.\n\n546\n00:27:20.370 --> 00:27:24.660\nYou cannot communicate on an air disabled\nport so I'm definitely locked there.\n\n547\n00:27:24.660 --> 00:27:27.275\nSo I need to resolve this, well step one.\n\n548\n00:27:27.275 --> 00:27:29.085\nOne, I need to figure\nout what the problem is.\n\n549\n00:27:29.085 --> 00:27:34.125\nWe saw show interface status which\nis a great way to quickly see if\n\n550\n00:27:34.125 --> 00:27:36.995\nports are healthy or if they're in\nan error disabled state like that.\n\n551\n00:27:38.265 --> 00:27:41.130\nYou can then do show interface and\n\n552\n00:27:41.130 --> 00:27:44.110\nspecify the interface that's\nyour problem child, right?\n\n553\n00:27:45.180 --> 00:27:47.766\nSo I'll point it right at fa1/0/12.\n\n554\n00:27:47.766 --> 00:27:50.109\nAnd we're gonna get a lot of data here,\n\n555\n00:27:50.109 --> 00:27:53.800\na lot of which we don't\nnecessarily care about, right?\n\n556\n00:27:53.800 --> 00:27:57.180\nBut some of it can give us\nhints as to what our error is.\n\n557\n00:27:57.180 --> 00:27:59.520\nAnd so what I'm looking for\nis right here on this first line,\n\n558\n00:27:59.520 --> 00:28:02.380\nwhere it says that it's down,\nand that it's air disabled.\n\n559\n00:28:02.380 --> 00:28:04.120\nAll right.\nWell I kind of already knew that,\n\n560\n00:28:04.120 --> 00:28:05.350\nbut now I can see it.\n\n561\n00:28:05.350 --> 00:28:08.810\nMaybe I skipped that show interface status\nand I knew this was my problem port, so\n\n562\n00:28:08.810 --> 00:28:11.370\nI just ran show interface on that one.\n\n563\n00:28:11.370 --> 00:28:13.950\nBut what I'm really looking for\nis that move down a little bit.\n\n564\n00:28:13.950 --> 00:28:18.060\nRight down here is where you start\nto get your port statistics.\n\n565\n00:28:18.060 --> 00:28:21.220\nAnd this is where we can start to look for\nthings like errors.\n\n566\n00:28:21.220 --> 00:28:25.430\nSo I've got output errors, collisions,\ninterface resets, these things.\n\n567\n00:28:25.430 --> 00:28:26.020\nRight?\n\n568\n00:28:26.020 --> 00:28:31.120\nThese are great indicators of\nbad cabling or failing NICs.\n\n569\n00:28:31.120 --> 00:28:32.540\nNetwork interface cards, they do fail.\n\n570\n00:28:32.540 --> 00:28:35.230\nIt happens, and you get all sorts\nof craziness when that occurs.\n\n571\n00:28:35.230 --> 00:28:38.050\nSo we definitely wanna keep an eye out for\nthat.\n\n572\n00:28:38.050 --> 00:28:43.210\nIf you see things like collisions,\ncollisions shouldn't happen on a switch.\n\n573\n00:28:43.210 --> 00:28:45.730\nEach port is its own collision domain.\n\n574\n00:28:45.730 --> 00:28:48.640\nIt's just the switch and\nthe client that's on that port.\n\n575\n00:28:48.640 --> 00:28:50.230\nYou shouldn't have collisions.\n\n576\n00:28:50.230 --> 00:28:53.440\nIf you do,\nthat's an indicator of a problem, right.\n\n577\n00:28:53.440 --> 00:28:57.220\nBut on mine, I don't have any of those so\nI'm actually looking okay here.\n\n578\n00:28:57.220 --> 00:28:58.830\nI've got an interface reset.\n\n579\n00:28:58.830 --> 00:29:02.450\nThat just means I maybe rebooted the\ncomputer on the other side, or plugged and\n\n580\n00:29:02.450 --> 00:29:03.270\nunplugged the cable.\n\n581\n00:29:03.270 --> 00:29:05.000\nThat doesn't necessarily mean a problem.\n\n582\n00:29:05.000 --> 00:29:09.000\nBut all my error stuff,\nmy buffer failures, all that.\n\n583\n00:29:09.000 --> 00:29:09.930\nIt's all clear.\n\n584\n00:29:09.930 --> 00:29:12.590\nSo I'm pretty sure I don't\nhave a hardware error here.\n\n585\n00:29:12.590 --> 00:29:16.520\nIf I do have a hardware error, then it's\nprobably time to call system attack and\n\n586\n00:29:16.520 --> 00:29:19.190\nstart going through that process\nbecause you've got to figure out\n\n587\n00:29:19.190 --> 00:29:22.580\nis it the client that's the problem or\nis it your switch or is it the cable?\n\n588\n00:29:22.580 --> 00:29:24.000\nWell, you can replace a cable.\n\n589\n00:29:24.000 --> 00:29:25.730\nYou can try another client.\n\n590\n00:29:25.730 --> 00:29:28.130\nBut if it's the switch,\nyou're gonna have to get Cisco involved.\n\n591\n00:29:29.400 --> 00:29:32.320\nAll right, now, in my case I still\ndon't know what the problem is.\n\n592\n00:29:32.320 --> 00:29:33.560\nSo I need to go a little bit further.\n\n593\n00:29:33.560 --> 00:29:37.640\nWell, now I need to start thinking about\nall the different things that can cause\n\n594\n00:29:37.640 --> 00:29:39.320\nan error disabled state.\n\n595\n00:29:39.320 --> 00:29:44.780\nSo I mentioned doing monitoring,\nthe span monitoring.\n\n596\n00:29:44.780 --> 00:29:47.120\nSo I might look and\nsee if I've got any of those configured.\n\n597\n00:29:47.120 --> 00:29:50.850\nBut I know that I have port\nsecurity turned on in this switch.\n\n598\n00:29:50.850 --> 00:29:53.667\nSo I might just want to check the security\nstate of this particular port.\n\n599\n00:29:53.667 --> 00:29:58.197\nSo I could do a show, port dash security,\nI could just run the whole thing, or\n\n600\n00:29:58.197 --> 00:30:02.450\nI could point it to an interface,\nand just look at that one interface,\n\n601\n00:30:02.450 --> 00:30:06.821\nwhich was what was it 12,\nsomething it was 12, that sounds right.\n\n602\n00:30:06.821 --> 00:30:09.398\nSo we can take a look at it and\nsure enough,\n\n603\n00:30:09.398 --> 00:30:14.640\nright here I see port security is enabled,\nport status, secure shutdown.\n\n604\n00:30:14.640 --> 00:30:19.450\nThat means that it violated the\nlimitations, and now we have a violation.\n\n605\n00:30:19.450 --> 00:30:22.760\nSo I can see the last source\naddress on this particular MAC.\n\n606\n00:30:22.760 --> 00:30:25.650\nSo this is the MAC that's\non that port right now.\n\n607\n00:30:25.650 --> 00:30:28.130\nThis guy right here.\n\n608\n00:30:28.130 --> 00:30:31.412\nIf I check the port's configuration,\n\n609\n00:30:31.412 --> 00:30:35.887\nlet's go see what its actually\nset to on that one, and\n\n610\n00:30:35.887 --> 00:30:42.269\nI can see that it's set with port\nsecurity limited, it's one MAC address.\n\n611\n00:30:42.269 --> 00:30:44.780\nThis Mac address right here doesn't match.\n\n612\n00:30:44.780 --> 00:30:49.715\nSo now I know I either need to change\nthis MAC address, update it to reflect\n\n613\n00:30:49.715 --> 00:30:55.128\nthe existing one, or I could go and take\nthis rogue machine off of my network, but\n\n614\n00:30:55.128 --> 00:31:00.569\nin my case I'll just go and change the MAC\naddress so we can get that back in there.\n\n615\n00:31:00.569 --> 00:31:05.553\nAnd so I'll just say switchport\nport-security mac-address and\n\n616\n00:31:05.553 --> 00:31:08.850\nthen I'm gonna punch\nin the one from above.\n\n617\n00:31:08.850 --> 00:31:10.902\nWhich is kind of nice to\nhave it on the screen.\n\n618\n00:31:10.902 --> 00:31:13.364\n>> [LAUGH]\n>> So it makes it a little easier to type.\n\n619\n00:31:13.364 --> 00:31:15.200\nAll right, so I'm go ahead and\npunch that one in.\n\n620\n00:31:15.200 --> 00:31:19.150\nSo that's gonna update it and\noh, shoot, I've hit my maximum so\n\n621\n00:31:19.150 --> 00:31:21.060\nI need to do a switchport.\n\n622\n00:31:22.310 --> 00:31:23.810\nActually, here we need to do a shutdown.\n\n623\n00:31:23.810 --> 00:31:29.470\nLet's take that down, and we'll re-run\nthat command and oh, you know what?\n\n624\n00:31:29.470 --> 00:31:33.080\nI need to clear the address\nthat was in there first.\n\n625\n00:31:33.080 --> 00:31:37.190\nSo let me do a no switchport port-securty.\n\n626\n00:31:37.190 --> 00:31:40.469\nProbably just been easier to disable the\nwhole thing, but we'll do it the hard way.\n\n627\n00:31:42.460 --> 00:31:44.310\nSo I'm just gonna MAC address off.\n\n628\n00:31:44.310 --> 00:31:45.800\nI guess I could have raised the maximum.\n\n629\n00:31:45.800 --> 00:31:48.815\nI could have said, switchport\nport-security maximum 2, and bumped it up.\n\n630\n00:31:48.815 --> 00:31:50.075\nThat would have worked also.\n\n631\n00:31:50.075 --> 00:31:52.160\nBut, I'm just gonna tack this one on.\n\n632\n00:31:52.160 --> 00:31:55.430\nI did a shutdown on the port,\nso that turned it off, and\n\n633\n00:31:55.430 --> 00:31:57.980\nnow when I do a no shutdown,\nit's gonna bring it back up.\n\n634\n00:31:57.980 --> 00:32:02.700\nNow, if I didn't fix the problem,\nit's just gonna go error, disabled again.\n\n635\n00:32:02.700 --> 00:32:05.189\nBut I did fix my problem,\nso it should come up.\n\n636\n00:32:06.720 --> 00:32:09.656\nOnce it comes up it should no\nlonger show as error disabled.\n\n637\n00:32:09.656 --> 00:32:14.530\nSo there it goes,\nit's a POE phone on the other side, so\n\n638\n00:32:14.530 --> 00:32:17.850\nthat's power over ethernet\nkicking into the phone there.\n\n639\n00:32:17.850 --> 00:32:23.630\nSo just grant it a power, interface came\nup, and if I do a show interface status\n\n640\n00:32:23.630 --> 00:32:29.470\nI should be able to see that port,\nright there, is now connected.\n\n641\n00:32:29.470 --> 00:32:32.340\nIt's got full duplex,\nand it's up and happy.\n\n642\n00:32:32.340 --> 00:32:36.650\nSo that's another thing to keep an eye\nout for on the back end of the switch.\n\n643\n00:32:36.650 --> 00:32:39.822\nThese are things that\nhappen every single day.\n\n644\n00:32:39.822 --> 00:32:44.340\nThis isn't magic, this is not high-end\nstuff that you do not have to worry about.\n\n645\n00:32:44.340 --> 00:32:45.510\nIf you are a small business,\n\n646\n00:32:45.510 --> 00:32:49.290\nmedium business, enterprise,\nyou potentially run into these.\n\n647\n00:32:49.290 --> 00:32:50.970\nYou could get air-disabled ports,\n\n648\n00:32:50.970 --> 00:32:54.850\nyou could exceed the amount of mac\naddresses in your mac address table.\n\n649\n00:32:54.850 --> 00:32:59.510\nYou could, have the configured wrong\nto not allow certain features to work.\n\n650\n00:32:59.510 --> 00:33:03.010\nI see this with policy based routing\na lot, is where people will call me and\n\n651\n00:33:03.010 --> 00:33:06.840\nsay, well Don,\nyou showed how I could use PBR,\n\n652\n00:33:06.840 --> 00:33:09.010\npolicy based routing on\na layer three switch.\n\n653\n00:33:09.010 --> 00:33:10.500\nAnd I tried, and it doesn't work.\n\n654\n00:33:10.500 --> 00:33:13.710\nIf you did something special on a switch,\nyou didn't show us.\n\n655\n00:33:13.710 --> 00:33:17.270\nAnd in a way they're wong,\nin a way they're right.\n\n656\n00:33:17.270 --> 00:33:19.910\nIn a lot of switches they\nship from the factory,\n\n657\n00:33:19.910 --> 00:33:23.830\non the PBR table is allocated zero memory.\n\n658\n00:33:23.830 --> 00:33:27.330\nAnd so unless you change your template it\nhas no memory to use and it can't get out.\n\n659\n00:33:27.330 --> 00:33:31.420\nRight so I probably did, either my\nswitch shipped with that as a default or\n\n660\n00:33:31.420 --> 00:33:33.080\nI did modify the template to account for\n\n661\n00:33:33.080 --> 00:33:35.690\nthat and this is that missing\npiece of knowledge right there.\n\n662\n00:33:35.690 --> 00:33:38.450\nRight, so these are all things we\nneed to be aware of on our switches.\n\n663\n00:33:38.450 --> 00:33:39.830\n>> Well very very cool, Don.\n\n664\n00:33:39.830 --> 00:33:41.140\nSwitch administration?\n\n665\n00:33:41.140 --> 00:33:44.680\nDefinitely a bulk of what we can be doing\ninside of an enterprising environment.\n\n666\n00:33:44.680 --> 00:33:47.720\nI know I've done plenty of these\nMac addresses not show showing.\n\n667\n00:33:47.720 --> 00:33:50.060\nThey're not, I know it's connected and\nit's not working.\n\n668\n00:33:50.060 --> 00:33:53.610\nHad to do a little bit of that\nsometimes it, Nick going crazy.\n\n669\n00:33:53.610 --> 00:33:55.810\nLot of times it's the cable,\nother times it's other things.\n\n670\n00:33:55.810 --> 00:33:58.470\nSo gotta be aware of how to\ntake care of those problems.\n\n671\n00:33:58.470 --> 00:34:00.740\nDon, great demonstrations for us today.\n\n672\n00:34:00.740 --> 00:34:02.180\nHopefully you guys have\nenjoyed it as well.\n\n673\n00:34:02.180 --> 00:34:05.470\nLooks like we've come to the end of\nanother great episode here at ITProTV, so\n\n674\n00:34:05.470 --> 00:34:07.080\nwe're gonna go ahead and sign off.\n\n675\n00:34:07.080 --> 00:34:08.610\nI've been your host Daniel Lowry.\n\n676\n00:34:08.610 --> 00:34:09.407\n>> And I'm Don Pezet.\n\n677\n00:34:09.407 --> 00:34:11.179\n>> And we'll see you next time.\n\n678\n00:34:11.179 --> 00:34:16.800\n[SOUND]\n\n",
          "vimeoId": "140813828"
        },
        {
          "description": "In this episode, Don and Daniel discuss a few Layer 2 protocols that are supported by Cisco switches. They begin the show by explaining the Cisco Discovery Protocol, then contrast CDP to LLDP (Link-Layer Discovery Protocol). Lastly, they cover Unidirectional Link Detection (UDLD) used to verify failed links.",
          "length": "2049",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-2-layer_2_protocols-092815-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-2-layer_2_protocols-092815-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-2-layer_2_protocols-092815-1-sm.jpg",
          "title": "Layer 2 Protocols",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.791 --> 00:00:13.461\nAll right, greetings everyone.\n\n3\n00:00:13.461 --> 00:00:15.870\nWelcome to another great episode ITProTV.\n\n4\n00:00:15.870 --> 00:00:17.360\nI'm your host, Daniel Lowry.\n\n5\n00:00:17.360 --> 00:00:20.100\nHere with me today,\nit is the nefarious Don Pezet.\n\n6\n00:00:20.100 --> 00:00:20.940\nHow's it going today, Don?\n\n7\n00:00:20.940 --> 00:00:22.195\n>> Wanted in seven states.\n\n8\n00:00:22.195 --> 00:00:24.043\n>> [LAUGH]\n>> I ordered the seven star system.\n\n9\n00:00:24.043 --> 00:00:26.470\n>> [LAUGH]\n>> All right, well ladies and gentlemen,\n\n10\n00:00:26.470 --> 00:00:27.580\nI am glad to be back on the show.\n\n11\n00:00:27.580 --> 00:00:31.160\nWe're continuing on with\nour CCNP switch adventure.\n\n12\n00:00:31.160 --> 00:00:35.070\nAnd today we're gonna be taking a look\nat some of the layer two protocols,\n\n13\n00:00:35.070 --> 00:00:38.600\nwhich I know what you're thinking, come\non Don a switch is a layer two device,\n\n14\n00:00:38.600 --> 00:00:40.070\nwhat do we need to know there?\n\n15\n00:00:40.070 --> 00:00:41.720\nWell there's actually some\n\n16\n00:00:42.890 --> 00:00:46.810\nmysterious kind of hidden protocols\nthat run in the background on a switch.\n\n17\n00:00:46.810 --> 00:00:51.700\nThat can operate even If your layer\nthree network isn't even configured.\n\n18\n00:00:51.700 --> 00:00:55.330\nYour things like IP,\nIPX, SPF3, those guys.\n\n19\n00:00:55.330 --> 00:00:58.840\nIf they are not even functioning, there\nare some layer 2 protocols that run in\n\n20\n00:00:58.840 --> 00:01:02.420\nthe background that do\nsome pretty neat stuff.\n\n21\n00:01:02.420 --> 00:01:04.950\nAt a minimum, we need to be aware of them,\nbecause they're running, and\n\n22\n00:01:04.950 --> 00:01:05.910\nyou should know it.\n\n23\n00:01:05.910 --> 00:01:08.650\nBut also because we might want\nto manipulate them, change them,\n\n24\n00:01:08.650 --> 00:01:09.500\ndisable them, and so on.\n\n25\n00:01:09.500 --> 00:01:11.990\nSo that's what we're gonna\ntake a look at today.\n\n26\n00:01:11.990 --> 00:01:14.480\n>> Now, Don, because we wanna\ndo that voodoo that you do,\n\n27\n00:01:14.480 --> 00:01:18.150\nwhere do we begin with these\nmysterious liturgy protocol?\n\n28\n00:01:18.150 --> 00:01:18.810\n>> All right.\n\n29\n00:01:18.810 --> 00:01:22.095\nLet's take a trip down memory\nlane back to the CCNA.\n\n30\n00:01:22.095 --> 00:01:25.140\n>> [LAUGH]\n>> And back when you needed the CCNT and\n\n31\n00:01:25.140 --> 00:01:26.760\nCCNA certifications.\n\n32\n00:01:26.760 --> 00:01:30.230\nYou learned about CDP,\nthe Cisco Discovery Protocol.\n\n33\n00:01:30.230 --> 00:01:34.700\nCDP is on by default on\nalmost every Cisco switch.\n\n34\n00:01:34.700 --> 00:01:36.840\nAnd what it is, is a layer 2 protocol.\n\n35\n00:01:36.840 --> 00:01:40.800\nIt runs regardless of whether you even\nhave IP addresses in your network.\n\n36\n00:01:40.800 --> 00:01:45.460\nAnd it will help to find\ndirect attach hardware.\n\n37\n00:01:45.460 --> 00:01:49.060\nIf I've two switches plugged into each\nother, right, cross over cable or\n\n38\n00:01:49.060 --> 00:01:50.420\nwhatever between them.\n\n39\n00:01:50.420 --> 00:01:51.700\nThey'll actually see each other and\n\n40\n00:01:51.700 --> 00:01:54.320\nknow that there's a Cisco switch\non the other side of that link.\n\n41\n00:01:54.320 --> 00:01:55.990\nAnd that's what CDP does.\n\n42\n00:01:55.990 --> 00:01:57.370\nCisco Discovery Protocol.\n\n43\n00:01:57.370 --> 00:02:01.310\nIt's a broadcast-based protocol,\nso it doesn't need addresses.\n\n44\n00:02:01.310 --> 00:02:04.230\nIt just sends out a broadcast.\n\n45\n00:02:04.230 --> 00:02:06.480\nAnd I don't mean like an IP broadcast,\n255.255.255.255.\n\n46\n00:02:06.480 --> 00:02:08.730\nIt's a Mac addressed broadcast.\n\n47\n00:02:08.730 --> 00:02:10.390\nSo it uses the Mac address of all apps.\n\n48\n00:02:10.390 --> 00:02:12.900\nAnd as a switch will receive that,\nand, and\n\n49\n00:02:12.900 --> 00:02:14.750\nknow to kind of send it\nout of all its ports.\n\n50\n00:02:14.750 --> 00:02:17.810\nNow, CDP is just looking for\nwho else is out there.\n\n51\n00:02:17.810 --> 00:02:19.910\nAnd this can be a good thing.\n\n52\n00:02:19.910 --> 00:02:23.740\nI know I, I've gone to networks where,\nsomebody called me and\n\n53\n00:02:23.740 --> 00:02:25.040\nsaid Don we've got a real problem.\n\n54\n00:02:25.040 --> 00:02:26.070\nStuff just isn't working.\n\n55\n00:02:26.070 --> 00:02:27.180\nYou need to come out and help.\n\n56\n00:02:27.180 --> 00:02:28.770\nAnd I say, all right,\nwell, let me swing on by.\n\n57\n00:02:28.770 --> 00:02:31.920\nSo, I drive over there or fly or\nhowever it is that I get there.\n\n58\n00:02:31.920 --> 00:02:35.730\nAnd I get there, and I say, okay,\ncan you give me a topology diagram?\n\n59\n00:02:36.780 --> 00:02:38.882\nAnd they say, boy,\nwe would really love to do that.\n\n60\n00:02:38.882 --> 00:02:42.470\n>> [LAUGH]\n>> But, yeah, we don't have one.\n\n61\n00:02:42.470 --> 00:02:47.180\nOr, here's the topology diagram from seven\nyears ago, and it just doesn't help you.\n\n62\n00:02:47.180 --> 00:02:51.810\nSo now you're staring at this network and\nyou could start tracing cables, or\n\n63\n00:02:51.810 --> 00:02:54.020\nyou could use something like\nCDP to learn the network,\n\n64\n00:02:54.020 --> 00:02:55.860\nto find how the devices are plugged in.\n\n65\n00:02:55.860 --> 00:02:58.510\nAnd it'll tell you exactly what port\nyou're connected to on both ends\n\n66\n00:02:58.510 --> 00:02:59.470\nof the cable.\n\n67\n00:02:59.470 --> 00:03:03.670\nSo your switch might have another\nswitch plugged into it and it'll show.\n\n68\n00:03:03.670 --> 00:03:04.790\nLet me show you on one of these.\n\n69\n00:03:04.790 --> 00:03:08.680\nSo I got a switch fired up right here.\n\n70\n00:03:08.680 --> 00:03:15.470\nAnd if I do a show CDP neighbors, right,\nI can run that and I'm in core 1.\n\n71\n00:03:15.470 --> 00:03:19.210\nAnd I can see that I've got\ntwo connections to core 2.\n\n72\n00:03:19.210 --> 00:03:21.910\nAnd I've got one connection to access one.\n\n73\n00:03:21.910 --> 00:03:23.840\nAnd I can see my local interface.\n\n74\n00:03:23.840 --> 00:03:26.355\nSo on this switch, port 22.\n\n75\n00:03:26.355 --> 00:03:32.000\nIs connected way over here on the side\nto port 24 on the other switch,\n\n76\n00:03:32.000 --> 00:03:33.190\nI don't have to go trace a cable.\n\n77\n00:03:33.190 --> 00:03:34.440\nI know.\nI know exactly what\n\n78\n00:03:34.440 --> 00:03:35.710\nport I'm in on both sides.\n\n79\n00:03:35.710 --> 00:03:36.820\nThat's what CDP does.\n\n80\n00:03:38.410 --> 00:03:42.040\nAll right but\nthere's two problems with CDP.\n\n81\n00:03:42.040 --> 00:03:44.050\nTwo reasons why most people don't use it.\n\n82\n00:03:44.050 --> 00:03:45.220\n>> Say it ain't so, Don.\n\n83\n00:03:45.220 --> 00:03:45.900\n>> I know, it's crazy.\n\n84\n00:03:45.900 --> 00:03:47.920\nLike if Cisco made this, isn't it great?\n\n85\n00:03:47.920 --> 00:03:49.500\nWell, it does have some problems.\n\n86\n00:03:49.500 --> 00:03:51.160\nFirst off, Cisco made this.\n\n87\n00:03:51.160 --> 00:03:52.510\nExactly what I said a second ago.\n\n88\n00:03:52.510 --> 00:03:54.900\nNot that Cisco makes bad, well, all right.\n\n89\n00:03:54.900 --> 00:03:58.580\nSo, but the problem here is\nit's Cisco proprietary, right.\n\n90\n00:03:58.580 --> 00:04:00.710\nOnly Cisco supports CDP.\n\n91\n00:04:00.710 --> 00:04:05.190\nSo when I run show CDP neighbor, I'm only\nseeing other Cisco devices out there.\n\n92\n00:04:05.190 --> 00:04:06.830\nAnd it might be switches like this,\n\n93\n00:04:06.830 --> 00:04:12.450\nor, let me see, I think I have a VoIP\nphone plugged into somebody somewhere.\n\n94\n00:04:12.450 --> 00:04:16.340\nSo if I do a show cdp neighbor,\nlet's see if I got a VoIP phone.\n\n95\n00:04:16.340 --> 00:04:21.280\nYeah, I got a VoIP phone on this one so\nI can see its little zip ID or whatever.\n\n96\n00:04:21.280 --> 00:04:24.720\nThe MAC address is part of its name,\nand I can spot that phone.\n\n97\n00:04:24.720 --> 00:04:26.180\nIf it's a Cisco phone.\n\n98\n00:04:26.180 --> 00:04:32.800\nBut, if I've got Microtel phones or\nHP Procur switches that are in the mix.\n\n99\n00:04:32.800 --> 00:04:34.560\nThey don't respond to CDP.\n\n100\n00:04:34.560 --> 00:04:36.360\nThat's problem number one.\n\n101\n00:04:36.360 --> 00:04:40.420\nProblem number two,\nCDP shares a lot of information.\n\n102\n00:04:40.420 --> 00:04:42.660\nIf I do show cdp nei detail.\n\n103\n00:04:42.660 --> 00:04:47.680\nAll right,\nthat's gonna add a little bit more.\n\n104\n00:04:47.680 --> 00:04:51.190\nAnd now I can see things like\nthe IP address of the device.\n\n105\n00:04:51.190 --> 00:04:54.880\nI can see the model that it is, right?\n\n106\n00:04:54.880 --> 00:04:56.350\nThe hardware that it's got.\n\n107\n00:04:56.350 --> 00:04:59.000\nAnd buried in here somewhere,\nif I look hard enough.\n\n108\n00:04:59.000 --> 00:04:59.830\nIs this guy right here.\n\n109\n00:04:59.830 --> 00:05:02.910\nThis is the most dangerous part,\nthe iOS version.\n\n110\n00:05:02.910 --> 00:05:06.130\nAll right,\nif I'm an attacker on a network.\n\n111\n00:05:06.130 --> 00:05:09.350\nI can plug in and\nI can run a packet sniffer.\n\n112\n00:05:09.350 --> 00:05:13.320\nThese CDP announcements are broadcasts,\nso they're gonna go out every interface.\n\n113\n00:05:13.320 --> 00:05:17.430\nAnd so I'm gonna listen and hear those,\nand I can then interpret them.\n\n114\n00:05:17.430 --> 00:05:19.980\nAnd I can find the version of the iOS, and\n\n115\n00:05:19.980 --> 00:05:24.560\nI can say all right this switch\nis 12.2 release 55 SE 5.\n\n116\n00:05:24.560 --> 00:05:28.300\nLet me go to Cisco's website, and\nI'll see if there's a 12.2 release 56.\n\n117\n00:05:28.300 --> 00:05:28.820\nAll right?\n\n118\n00:05:28.820 --> 00:05:31.020\nWhat do they fix in 56?\n\n119\n00:05:31.020 --> 00:05:34.270\nWhatever they fixed is broken here.\n\n120\n00:05:34.270 --> 00:05:36.195\nI know have an exploit to try and\nget into the switch.\n\n121\n00:05:36.195 --> 00:05:37.150\nRight?\n\n122\n00:05:37.150 --> 00:05:39.370\nIt's that simple, and\n\n123\n00:05:39.370 --> 00:05:43.590\nthat's information that's being reported\nthat you'll spot as you look at it.\n\n124\n00:05:43.590 --> 00:05:44.920\nAnd my other switch would be the same way.\n\n125\n00:05:44.920 --> 00:05:46.180\nSo here's the other one.\n\n126\n00:05:46.180 --> 00:05:49.070\nThis one I can just use a 3750.\n\n127\n00:05:49.070 --> 00:05:52.600\nIt's got IP services on it,\nit's layer three, right?\n\n128\n00:05:52.600 --> 00:05:57.270\nAnd it's running version 15.0 release 2,\nSE2.\n\n129\n00:05:57.270 --> 00:06:00.200\nSo again, is there a 15.0 relaease 3,\nor release 4?\n\n130\n00:06:00.200 --> 00:06:01.300\nIs there a 15.1?\n\n131\n00:06:01.300 --> 00:06:07.380\nI can go and look those up, see what was\nfixed, and now I've got an attack vector.\n\n132\n00:06:07.380 --> 00:06:10.950\nSo a lot of people disable CDP,\nand that's a very common thing.\n\n133\n00:06:10.950 --> 00:06:11.470\nRight?\n\n134\n00:06:11.470 --> 00:06:15.590\nSo when you take a Cisco switch,\nand you jump into your config.\n\n135\n00:06:15.590 --> 00:06:19.410\nYou can do, whoops, I kind of left out\nthat part about jumping in the config.\n\n136\n00:06:19.410 --> 00:06:24.560\nAnd then you can do a cdp\nrun would turn it on or\n\n137\n00:06:24.560 --> 00:06:27.450\na no cdp run will turn it off.\n\n138\n00:06:27.450 --> 00:06:31.810\nAnd that's globally, you can turn it on\nand off by individual interface also.\n\n139\n00:06:31.810 --> 00:06:34.390\nOn the interface it's cdp enable.\n\n140\n00:06:34.390 --> 00:06:35.620\nSo I can go into an interface and say,\n\n141\n00:06:35.620 --> 00:06:38.950\nCDP enable or\nno CDP enable to turn it on and off.\n\n142\n00:06:38.950 --> 00:06:42.130\nAnd so you might choose to\nrun CDP just on your trunks.\n\n143\n00:06:42.130 --> 00:06:43.810\nAnd not on your access supports.\n\n144\n00:06:43.810 --> 00:06:47.010\nI don't want clients to get those CDP\nannouncements, but I do want switches.\n\n145\n00:06:47.010 --> 00:06:48.020\nSo you might do that.\n\n146\n00:06:48.020 --> 00:06:49.060\nRight.\n\n147\n00:06:49.060 --> 00:06:51.780\nBut it has a security weakness.\n\n148\n00:06:51.780 --> 00:06:52.920\nIt's Cisco proprietary.\n\n149\n00:06:52.920 --> 00:06:56.550\nThere's a lot of reasons there that most\npeople just disable it out of hand and\n\n150\n00:06:56.550 --> 00:06:57.810\ndon't run CDP.\n\n151\n00:06:57.810 --> 00:07:01.455\n>> So Don, it sounds like we should change\nit to a crappy detrimental protocol\n\n152\n00:07:01.455 --> 00:07:02.361\n[LAUGH] Cisco.\n\n153\n00:07:02.361 --> 00:07:07.110\n[LAUGH] Because it's leaving us\nout in the weeds a little bit.\n\n154\n00:07:07.110 --> 00:07:09.890\n>> We're totally editing\nthe Wikipedia page after this show.\n\n155\n00:07:09.890 --> 00:07:11.180\n>> Right now, that's right.\n\n156\n00:07:11.180 --> 00:07:14.230\nBut, obviously,\nthat can't be the only game in town.\n\n157\n00:07:14.230 --> 00:07:16.010\nThere's gotta be something\nelse that we can use.\n\n158\n00:07:16.010 --> 00:07:17.980\n>> Yeah, it really is a good protocol.\n\n159\n00:07:17.980 --> 00:07:19.225\nIt does a good service.\n\n160\n00:07:19.225 --> 00:07:20.070\nRight?\n\n161\n00:07:20.070 --> 00:07:22.820\nSo it was only a matter of time before\nsomebody kind of created something to help\n\n162\n00:07:22.820 --> 00:07:23.670\nfix that.\n\n163\n00:07:23.670 --> 00:07:24.400\nAnd they did.\nSo\n\n164\n00:07:24.400 --> 00:07:29.235\nthere's a protocol out there called LLDP,\nthe Link Layer Discovery Protocol.\n\n165\n00:07:29.235 --> 00:07:35.030\nAnd LLDP,\nit's just a open standard vision of CDP.\n\n166\n00:07:35.030 --> 00:07:39.300\nIn fact, on a Cisco router, the way you\nconfigure LLDP, is the exact same as CDP.\n\n167\n00:07:39.300 --> 00:07:41.310\nYou just take those CDP commands.\n\n168\n00:07:41.310 --> 00:07:43.920\nAnd you delete CDP, put in LLDP.\n\n169\n00:07:43.920 --> 00:07:47.220\nSo I can do LLDP run or no LLDP run.\n\n170\n00:07:47.220 --> 00:07:48.780\nShow LLDP neighbor.\n\n171\n00:07:48.780 --> 00:07:50.850\nShow LLDP neighbor detail.\n\n172\n00:07:50.850 --> 00:07:53.054\nThose commands are all\npretty much the same.\n\n173\n00:07:53.054 --> 00:07:55.965\nAll right.\nBut LLDP fixed things by adding a few neat\n\n174\n00:07:55.965 --> 00:07:57.655\nfeatures, all right.\n\n175\n00:07:57.655 --> 00:08:00.522\nFirst off, it's not Cisco proprietary.\n\n176\n00:08:00.522 --> 00:08:05.335\nSo you can have HP ProCurve switches and\nJuniper routers and\n\n177\n00:08:05.335 --> 00:08:08.230\nCisco switches and Cisco routers.\n\n178\n00:08:08.230 --> 00:08:12.060\nYou can have a mixture and they can\nall use LLVP to talk to each other and\n\n179\n00:08:12.060 --> 00:08:12.920\ndiscover each other, right?\n\n180\n00:08:12.920 --> 00:08:14.160\nSo that's big benefit number one.\n\n181\n00:08:14.160 --> 00:08:17.760\nAnd then benefit number two, with LLDP,\n\n182\n00:08:18.900 --> 00:08:22.290\nyou can tailor what data is\nincluded in the announcement.\n\n183\n00:08:23.290 --> 00:08:25.670\nCDP has one format.\n\n184\n00:08:25.670 --> 00:08:27.000\nOne set of data that it presents.\n\n185\n00:08:27.000 --> 00:08:28.580\nAnd you get it all or you get nothing.\n\n186\n00:08:28.580 --> 00:08:32.200\nWith LLDP you can pick and\nchoose the individual pieces.\n\n187\n00:08:32.200 --> 00:08:35.623\nSo, maybe I want to share\nwhat the platform is, right?\n\n188\n00:08:35.623 --> 00:08:36.770\nWhat hardware I have.\n\n189\n00:08:36.770 --> 00:08:39.020\nAnd I wanna share what my host name is.\n\n190\n00:08:39.020 --> 00:08:41.430\nBut I don't wanna share what\nversion of iOS I'm running,\n\n191\n00:08:41.430 --> 00:08:44.900\nI don't want to share what\nfeatures my system has.\n\n192\n00:08:44.900 --> 00:08:49.230\nI might want to limit that down,\nand we can do that with LLDP.\n\n193\n00:08:49.230 --> 00:08:53.150\nSo, for a lot of people that have just\ngotten used to not having CDP at all,\n\n194\n00:08:53.150 --> 00:08:56.910\nnow you can implement LLDP and\nit's a little bit more safe.\n\n195\n00:08:56.910 --> 00:08:58.133\nYou might still choose to turn it off.\n\n196\n00:08:58.133 --> 00:09:01.260\nI know a lot of security professionals\nsay, turn it on when you need it and\n\n197\n00:09:01.260 --> 00:09:03.080\nthen turn it off when you're done.\n\n198\n00:09:03.080 --> 00:09:04.890\nAnd that's usually what I\ndo with Network Discovery.\n\n199\n00:09:04.890 --> 00:09:09.300\nIs go and turn it, map out the network and\nthen turn it all off again, right?\n\n200\n00:09:09.300 --> 00:09:13.110\nBut, if you wanna run it long term,\nLLDP is a better solution.\n\n201\n00:09:14.300 --> 00:09:16.870\nSo, let's take a look at getting\nLLDP kind of turned on for\n\n202\n00:09:16.870 --> 00:09:20.490\na system and how that works.\n\n203\n00:09:20.490 --> 00:09:22.930\nFirst off, on a lot of Cisco equipment,\n\n204\n00:09:22.930 --> 00:09:27.100\nCDP is running by default,\nLLDP usually is not.\n\n205\n00:09:27.100 --> 00:09:32.610\nSo, if I do something like, show lldp ?.\n\n206\n00:09:32.610 --> 00:09:33.910\nI'll see some of the different commands.\n\n207\n00:09:33.910 --> 00:09:38.460\nshow lldp entry, errors,\nneighbors, interface, traffic.\n\n208\n00:09:38.460 --> 00:09:43.820\nAnd if I do show lldp neighbors,\nwell, I get lldp is not enabled.\n\n209\n00:09:43.820 --> 00:09:48.100\nSo on this switch,\nCDP was on by default, LLDP was not.\n\n210\n00:09:48.100 --> 00:09:49.340\nI wanna change that.\n\n211\n00:09:49.340 --> 00:09:52.630\nSo, at a minimum,\nif I just wanna get LLDP running and\n\n212\n00:09:52.630 --> 00:09:55.520\nbe done with it, I can jump into config.\n\n213\n00:09:55.520 --> 00:10:00.106\nI can say no cdp run.,\nI'm gonna turn cdp off, right?\n\n214\n00:10:00.106 --> 00:10:04.980\nSo that's it, and then I'll say, lldp run.\n\n215\n00:10:04.980 --> 00:10:06.053\nAnd now that's on.\n\n216\n00:10:06.053 --> 00:10:08.250\nYou can actually run both at\nthe same time if you want.\n\n217\n00:10:08.250 --> 00:10:10.580\nIf you like that kind of stuff you can.\n\n218\n00:10:10.580 --> 00:10:15.740\nBut really, LLDP completely replaces CDP,\nso there's not a lot of need to run both.\n\n219\n00:10:15.740 --> 00:10:17.700\nI can't think of a scenario where I would.\n\n220\n00:10:17.700 --> 00:10:19.730\nOf course now I need to go\nto my other devices and\n\n221\n00:10:19.730 --> 00:10:22.670\ndo the same basic thing on\neach of my other devices.\n\n222\n00:10:22.670 --> 00:10:27.450\nI need to jump in to the config and\nturn off CDP if I don't want it, and\n\n223\n00:10:27.450 --> 00:10:30.820\nturn on LLDP if I do.\n\n224\n00:10:30.820 --> 00:10:33.980\nI'll just jump to each one of\nmy three switches here and\n\n225\n00:10:33.980 --> 00:10:35.130\nget that kind of put in place.\n\n226\n00:10:36.335 --> 00:10:41.075\nAnd now, I'll be a, whoops, a nice and\n\n227\n00:10:41.075 --> 00:10:44.545\nshiny LLDP environment\ninstead of a CDP environment.\n\n228\n00:10:45.725 --> 00:10:50.100\nNow, most Cisco switches\nhave CDP on by default.\n\n229\n00:10:50.100 --> 00:10:55.419\nMost routers have it off by default, all\nASA's have it off by default, all right?\n\n230\n00:10:55.419 --> 00:10:59.210\nSo there's different base configurations\nthat you can expect to see out there.\n\n231\n00:10:59.210 --> 00:11:02.293\nBut if we just go through and\ndo the configuration like this,\n\n232\n00:11:02.293 --> 00:11:05.450\nthen we know how it's set,\nit's up and it's running.\n\n233\n00:11:05.450 --> 00:11:06.990\nIf I do a show lldp neighbor,\n\n234\n00:11:06.990 --> 00:11:11.620\nit shouldn't take too long for me to start\npicking up neighbors, and there they are.\n\n235\n00:11:11.620 --> 00:11:13.900\nAnd look at that output.\n\n236\n00:11:13.900 --> 00:11:15.520\nIt looks just like CDP.\n\n237\n00:11:15.520 --> 00:11:17.250\nI see the host name.\n\n238\n00:11:17.250 --> 00:11:18.970\nI see the local interface.\n\n239\n00:11:18.970 --> 00:11:23.000\nI see the remote interface, and\nI see the capabilities of that device.\n\n240\n00:11:23.000 --> 00:11:25.190\nThese are bridges,\nI'm seeing switches on the network.\n\n241\n00:11:25.190 --> 00:11:26.020\nYou might see routers.\n\n242\n00:11:26.020 --> 00:11:27.105\nYou'd see an r, right?\n\n243\n00:11:27.105 --> 00:11:29.100\nAnd each of the other devices you detect.\n\n244\n00:11:29.100 --> 00:11:34.415\nAnd if I do a show lldp nei detail, right?\n\n245\n00:11:34.415 --> 00:11:37.080\nThere's all the additional information.\n\n246\n00:11:37.080 --> 00:11:41.680\nJust like CDP, I'm seeing that version\nnumber, IP address and all of that.\n\n247\n00:11:41.680 --> 00:11:46.167\nSo it really is a true replacement for\nCDP, okay?\n\n248\n00:11:46.167 --> 00:11:48.070\nBut I haven't really fixed anything,\nhave I?\n\n249\n00:11:48.070 --> 00:11:51.110\nWell, I guess I did,\nI fixed the vendor neutral part.\n\n250\n00:11:51.110 --> 00:11:54.440\nSo, now I am vendor neutral,\nso that's cool.\n\n251\n00:11:54.440 --> 00:11:56.510\nBut I'm still giving out\nmore info than I want.\n\n252\n00:11:56.510 --> 00:12:00.810\nSo with LLDP, we can go a little bit\nfurther, and we can start to restrict it.\n\n253\n00:12:00.810 --> 00:12:04.120\nIn LLDP,\n\n254\n00:12:04.120 --> 00:12:08.520\nall the data that you see on the screen is\nactually broken up into individual pieces.\n\n255\n00:12:08.520 --> 00:12:12.370\nAnd they're called TLVs, and TLVs, it's\none of those acronyms I always forget.\n\n256\n00:12:12.370 --> 00:12:18.000\nIt's type length value, and\nthat's just a reference or\n\n257\n00:12:18.000 --> 00:12:20.320\na name that describes kinda how\nthe data is stored on the backend.\n\n258\n00:12:20.320 --> 00:12:21.700\nWe don't normally care about that.\n\n259\n00:12:21.700 --> 00:12:24.040\nBut we need to know that it's\nTLV because it's in the command.\n\n260\n00:12:24.040 --> 00:12:25.590\nSo that's how we remember\nthe command to type.\n\n261\n00:12:25.590 --> 00:12:30.220\nSo, I can restrict which TLVs I hand out.\n\n262\n00:12:30.220 --> 00:12:33.263\nAnd you can restrict it per interface\nif you really wanna go crazy.\n\n263\n00:12:33.263 --> 00:12:35.373\nOr you can do it globally,\nand just say hey,\n\n264\n00:12:35.373 --> 00:12:39.100\nwhen I share out LLDP data from this\nswitch, this is all I want to provide.\n\n265\n00:12:39.100 --> 00:12:42.200\nAnd so you can get kind of specific\nwith it and designate all of that.\n\n266\n00:12:42.200 --> 00:12:44.730\nSo, kind of neat stuff\nthat you can do in there.\n\n267\n00:12:44.730 --> 00:12:48.260\nOne difference I want to point out\nbefore I show restricting TLVs,\n\n268\n00:12:49.490 --> 00:12:54.320\nin CDP at the global prompt,\nyou have CDP run or no CDP run.\n\n269\n00:12:54.320 --> 00:12:57.850\nAnd on the interface you have\nCDP enable or no CDP enable.\n\n270\n00:12:58.930 --> 00:13:05.560\nWith LLDP, at the global prompt,\nyou've got LLDP run, no LLDP run.\n\n271\n00:13:06.880 --> 00:13:09.320\nBut on the interface\nit's a little different.\n\n272\n00:13:09.320 --> 00:13:16.740\nInstead of LLDP enable, it actually allows\nyou to do LLDP transmit and receive.\n\n273\n00:13:16.740 --> 00:13:19.820\nYou could set it so\nyour switch receives but doesn't transmit.\n\n274\n00:13:20.820 --> 00:13:23.220\nMaybe I wanna learn about VOIP\nphones that are out there but\n\n275\n00:13:23.220 --> 00:13:25.720\nI don't wanna talk to\nthe VOIP phones themselves.\n\n276\n00:13:25.720 --> 00:13:28.720\nSo I might have certain interfaces where\nI've got VOIP phones and I set it so\n\n277\n00:13:28.720 --> 00:13:33.240\nI'm receiving their announcements but\nI'm not telling them anything.\n\n278\n00:13:33.240 --> 00:13:34.890\nThat can be a useful feature.\n\n279\n00:13:34.890 --> 00:13:37.683\nAnd it's much harder for\nan attacker to exploit that, right?\n\n280\n00:13:37.683 --> 00:13:39.633\nBecause they could send\nyou some LLDP stuff,\n\n281\n00:13:39.633 --> 00:13:41.390\nbut it doesn't really matter, right?\n\n282\n00:13:41.390 --> 00:13:44.330\nLLDP doesn't actually change\nthe function of your switch.\n\n283\n00:13:44.330 --> 00:13:46.330\nIt just learns information.\n\n284\n00:13:46.330 --> 00:13:49.090\nSo, that's kind of a neat\nlittle change there.\n\n285\n00:13:49.090 --> 00:13:51.870\nBut it does mean that syntax\nis a little bit different.\n\n286\n00:13:51.870 --> 00:13:57.260\nIf I'm on a interface like,\nwhich switch am I on here?\n\n287\n00:13:57.260 --> 00:13:58.600\nI've jumped around on switches.\n\n288\n00:13:58.600 --> 00:13:59.260\nThere we go.\n\n289\n00:13:59.260 --> 00:14:02.870\nSo if I jump into fao/1, and\n\n290\n00:14:02.870 --> 00:14:07.300\nI take a look at my LLDP syntax,\nsee how I can do receive or transmit, and\n\n291\n00:14:07.300 --> 00:14:09.810\nthat's how you would set it so\nit only did one or the other, all right?\n\n292\n00:14:09.810 --> 00:14:12.980\nAnd, you don't do that globally,\nyou do that on the interface itself.\n\n293\n00:14:12.980 --> 00:14:16.364\n>> Probably pretty important not to get\nthe two confused when you're sitting\n\n294\n00:14:16.364 --> 00:14:19.277\nbehind an exam cubicle going,\nwhy is this command not working?\n\n295\n00:14:19.277 --> 00:14:21.030\n>> Yeah.\n>> It tends to happen.\n\n296\n00:14:21.030 --> 00:14:22.060\n>> Absolutely.\n\n297\n00:14:22.060 --> 00:14:24.180\nNow, I mentioned restricting the TLVs.\n\n298\n00:14:24.180 --> 00:14:26.935\nAnd this is actually a great spot to\nsee it uz you can see it right there,\n\n299\n00:14:26.935 --> 00:14:27.555\ntlv-select.\n\n300\n00:14:27.555 --> 00:14:31.750\nAnd that's where you get\nthe selection of LLDP TLVs to send.\n\n301\n00:14:31.750 --> 00:14:32.782\nSo, acronym soup, right?\n\n302\n00:14:32.782 --> 00:14:33.390\n>> [LAUGH]\n>> So\n\n303\n00:14:33.390 --> 00:14:35.010\nthese are those type, length, values.\n\n304\n00:14:35.010 --> 00:14:36.800\nAgain, don't worry about\nwhat that stands for.\n\n305\n00:14:36.800 --> 00:14:38.920\nThis is just the data that we present.\n\n306\n00:14:38.920 --> 00:14:45.530\nAnd so if I run lldp tlv-select ?,\n\n307\n00:14:45.530 --> 00:14:48.730\nwell, you'll see one that I can find here,\npower management.\n\n308\n00:14:48.730 --> 00:14:52.230\nAm I sharing power management\nwith whoever is connected to me,\n\n309\n00:14:52.230 --> 00:14:55.200\nso am I letting them know I support POE?\n\n310\n00:14:55.200 --> 00:14:58.658\nWell if I have a VOIP phone that relies\non LLDP to find out whether they\n\n311\n00:14:58.658 --> 00:15:01.035\nget POE service,\nthen we can do this, right?\n\n312\n00:15:01.035 --> 00:15:03.504\nBut, none of them do, right?\n\n313\n00:15:03.504 --> 00:15:07.070\nIt's kind of baked into 802.3AF and\nsome of the other standards.\n\n314\n00:15:07.070 --> 00:15:10.431\nTo auto detect power, so\nwe don't need LLDP for that.\n\n315\n00:15:10.431 --> 00:15:13.809\nBut we might choose to advertise that\nfunctionality for the support and so\n\n316\n00:15:13.809 --> 00:15:15.180\nwe can specify it right here.\n\n317\n00:15:16.380 --> 00:15:18.375\nYou can also jump up globally though.\n\n318\n00:15:18.375 --> 00:15:21.525\nSo if I get out of the interface and\n\n319\n00:15:21.525 --> 00:15:26.220\nI take a look at LLDP here,\nyou'll see I've got TLV selected.\n\n320\n00:15:26.220 --> 00:15:28.690\nAnd this is where we can do it globally.\n\n321\n00:15:28.690 --> 00:15:31.930\nAnd on this one,\nthis will effect all of our interfaces.\n\n322\n00:15:31.930 --> 00:15:34.400\nAnd here's where all\nthe other data comes from.\n\n323\n00:15:34.400 --> 00:15:37.920\nAnd if you look at the list, here's the\nmac address and physical configuration.\n\n324\n00:15:37.920 --> 00:15:40.190\nThe management address, that's your IP.\n\n325\n00:15:40.190 --> 00:15:44.260\nThe port-description, port-vlan,\npower-management, system-capabilities,\n\n326\n00:15:44.260 --> 00:15:48.059\nsystem-description, that's where that\niOS version number is coming from, and\n\n327\n00:15:48.059 --> 00:15:49.470\nsystem-name.\n\n328\n00:15:49.470 --> 00:15:53.350\nThese are the different values that\nit's gonna provide by default.\n\n329\n00:15:53.350 --> 00:15:57.758\nSo you can go through and tweak these to\nremove things that you don't want, right?\n\n330\n00:15:57.758 --> 00:16:00.242\nYou can take those out so\nthey don't get passed along.\n\n331\n00:16:00.242 --> 00:16:04.317\nAnd you can hard set it to say,\nthis is exactly what I want to provide.\n\n332\n00:16:04.317 --> 00:16:09.078\nAnd so we would just say lldp tlv-select,\nand you'd specify, so\n\n333\n00:16:09.078 --> 00:16:13.380\nmaybe I want to do the system name,\nthat's a nice one.\n\n334\n00:16:13.380 --> 00:16:14.430\nAnd hard for\n\n335\n00:16:14.430 --> 00:16:17.900\nan attacker to exploit just the system\nname if it's a host name like mine.\n\n336\n00:16:17.900 --> 00:16:20.390\nIf it's a fully qualified name, maybe.\n\n337\n00:16:20.390 --> 00:16:24.760\nIf you have that NDNS macro management\naddress, it's usually a bad idea, but\n\n338\n00:16:24.760 --> 00:16:26.330\nif you've done that,\nthat might be an exploit.\n\n339\n00:16:26.330 --> 00:16:27.840\nWe have to think about that.\n\n340\n00:16:27.840 --> 00:16:29.110\nAnd we can add that, and\n\n341\n00:16:29.110 --> 00:16:32.600\nthen we can continue on,\njust add the other ones that I want.\n\n342\n00:16:32.600 --> 00:16:37.490\nMaybe I want the system capabilities so\nI can recognize that it's a switch, or\n\n343\n00:16:37.490 --> 00:16:39.820\na router or whatever.\n\n344\n00:16:39.820 --> 00:16:43.870\nI might want the physical\nconfiguration information, though.\n\n345\n00:16:43.870 --> 00:16:45.638\nThe MAC and physical.\n\n346\n00:16:45.638 --> 00:16:48.210\nWe kind of need that if we're\ngoing to keep track of what\n\n347\n00:16:48.210 --> 00:16:50.700\nport we're connected to on the other side.\n\n348\n00:16:50.700 --> 00:16:52.320\nBut I might want to stop there.\n\n349\n00:16:52.320 --> 00:16:58.240\nNo description, no individual port\ninformation, no management address.\n\n350\n00:16:58.240 --> 00:16:59.376\nAll right, I don't want hand that's about.\n\n351\n00:16:59.376 --> 00:17:02.270\nI'm just going to really\nfilter that down and\n\n352\n00:17:02.270 --> 00:17:05.670\nnow, we've locked down lldp\nto be a little more secure.\n\n353\n00:17:05.670 --> 00:17:08.560\nIf an attacker intercepts this,\nthey'll see there's a switch.\n\n354\n00:17:08.560 --> 00:17:13.530\nThey'll see it's called NYACCESS1,\nand they'll see what port they're\n\n355\n00:17:13.530 --> 00:17:17.760\nplugged into, but that's not really going\nto help them with what they've got.\n\n356\n00:17:17.760 --> 00:17:22.080\nSo now we got a much safer protocol and\nthat's one of the big advantages of LLDP,\n\n357\n00:17:22.080 --> 00:17:24.170\nand you can go and\ncustomize on each of your switches, so\n\n358\n00:17:24.170 --> 00:17:27.320\nyou might be really restrictive\non your access layer switches.\n\n359\n00:17:27.320 --> 00:17:30.380\nAnd they're not very restrictive at all\non your distributing and course switches,\n\n360\n00:17:30.380 --> 00:17:32.110\nbecause end users can't get at those.\n\n361\n00:17:32.110 --> 00:17:34.290\nSince this is a broadcast,\n\n362\n00:17:34.290 --> 00:17:39.110\nit's not going to pass an end user all\nthe way up to distribution or core,\n\n363\n00:17:39.110 --> 00:17:43.120\nthat's going to get filtered out at later,\nand you're nice and safe.\n\n364\n00:17:43.120 --> 00:17:44.280\nLGP, great protocol,\n\n365\n00:17:44.280 --> 00:17:47.380\nit's one of those that runs in the\nbackground if you choose to turn it on.\n\n366\n00:17:47.380 --> 00:17:50.620\nIt kind of solves a lot of\nthe problems we have with CDP.\n\n367\n00:17:50.620 --> 00:17:52.620\n>> Quick question about\nthe commands there for LODP.\n\n368\n00:17:52.620 --> 00:17:55.540\nI understand you don't have\nto do any LODP this that.\n\n369\n00:17:55.540 --> 00:17:57.940\nYou said these are the default\nglobal commands.\n\n370\n00:17:57.940 --> 00:18:00.480\nYou don't have to turn anything off.\n\n371\n00:18:00.480 --> 00:18:01.970\nAs soon as you started typing in one,\n\n372\n00:18:01.970 --> 00:18:06.560\nand you set that,\nIt's saying this is now my entire global.\n\n373\n00:18:06.560 --> 00:18:07.450\n>> Right.\n\n374\n00:18:07.450 --> 00:18:10.073\nThe alternative, what I could have done,\nif I just wanted to turn one or\n\n375\n00:18:10.073 --> 00:18:12.564\ntwo of them off, I could have done\nno commands to turn those off, and\n\n376\n00:18:12.564 --> 00:18:14.048\nthe others would have stayed enabled.\n\n377\n00:18:14.048 --> 00:18:15.887\nSo it's kind of up to you\nhow you want to do that.\n\n378\n00:18:15.887 --> 00:18:16.940\n>> Very, very cool.\n\n379\n00:18:16.940 --> 00:18:19.840\nAlright Don, now we talk about CDP,\nwe talked about LLDP,\n\n380\n00:18:19.840 --> 00:18:24.760\nare there any other mystical cool layer 2\nprotocols out there we need to know about.\n\n381\n00:18:24.760 --> 00:18:26.730\n>> There is one more I want to tackle.\n\n382\n00:18:26.730 --> 00:18:29.620\nI said that would be acronym soup right,\nso that was CDP, LLDP,\n\n383\n00:18:29.620 --> 00:18:32.220\nnow we are going to talk about UDLD.\n\n384\n00:18:32.220 --> 00:18:32.830\nAlright.\n\n385\n00:18:32.830 --> 00:18:37.160\nUDLD is one of those protocols that\npeople mention from time to time, but\n\n386\n00:18:37.160 --> 00:18:39.090\na lot a people never actually use.\n\n387\n00:18:39.090 --> 00:18:40.710\nIt's a pretty neat one.\n\n388\n00:18:40.710 --> 00:18:43.186\n>> You've seen a doctor about that right?\n\n389\n00:18:43.186 --> 00:18:45.705\n>> [LAUGH] If UDLD lasts for\nmore than four hours.\n\n390\n00:18:45.705 --> 00:18:46.790\n>> [LAUGH] That's right.\n\n391\n00:18:46.790 --> 00:18:49.740\n>> So it's stands for\nunidirectional link detection.\n\n392\n00:18:50.820 --> 00:18:55.610\nWhen you plug in a cable onto a network\nand you go to communicate, well,\n\n393\n00:18:55.610 --> 00:18:59.150\nthe system's either going to be\nhalf-duplex or full-duplex, right?\n\n394\n00:18:59.150 --> 00:19:02.500\nIn full duplex, you can send and\nreceive data at the same time.\n\n395\n00:19:02.500 --> 00:19:06.120\nIn half duplex you can send data or\nyou can receive data,\n\n396\n00:19:06.120 --> 00:19:07.600\nbut you can't do them\nboth at the same time.\n\n397\n00:19:08.820 --> 00:19:12.000\nWell, it is possible,\nwhether you're half or\n\n398\n00:19:12.000 --> 00:19:14.650\nfull duplex,\nthat something could go wrong.\n\n399\n00:19:14.650 --> 00:19:15.970\nUsually something wrong with the cable.\n\n400\n00:19:15.970 --> 00:19:18.990\nThis is usually a physical\nproblem that causes this.\n\n401\n00:19:18.990 --> 00:19:21.850\nSomething go wrong with the physical\ncable and you plug it in, and\n\n402\n00:19:21.850 --> 00:19:25.570\nmaybe you're able to send,\nbut not receive.\n\n403\n00:19:25.570 --> 00:19:27.820\nMaybe you're able to receive,\nbut not send.\n\n404\n00:19:29.080 --> 00:19:32.630\nNow, on a workstation, it's going\nto make the workstation not work.\n\n405\n00:19:32.630 --> 00:19:34.960\nSo, it's pretty recognizable.\n\n406\n00:19:34.960 --> 00:19:40.030\nBut on a switch it actually cause some\nreal problems, because there are many\n\n407\n00:19:40.030 --> 00:19:44.440\ntimes on a switch where we want to be\nable to send traffic but not receive.\n\n408\n00:19:44.440 --> 00:19:46.070\nOr we want to be able to\nreceive traffic but not send.\n\n409\n00:19:46.070 --> 00:19:49.220\nAnd a great example of that\nis spanning tree protocol.\n\n410\n00:19:49.220 --> 00:19:53.210\nWith spanning tree protocol,\nwe identify loops in the network.\n\n411\n00:19:53.210 --> 00:19:57.780\nAnd when there's a loop, the switches\nonly shut down one side of the loop.\n\n412\n00:19:57.780 --> 00:20:00.300\nOkay.\nNow, why do they only shut down one side?\n\n413\n00:20:00.300 --> 00:20:04.400\nIf the other side shut down\nthe link would be truly down, and\n\n414\n00:20:04.400 --> 00:20:05.830\nyou'd never know to bring it back up.\n\n415\n00:20:05.830 --> 00:20:07.510\nYou'd think there was nothing on there.\n\n416\n00:20:07.510 --> 00:20:12.130\nBut if we keep one end of the link up and\nthe other end is down, the switch that's\n\n417\n00:20:12.130 --> 00:20:15.830\nholding it down will know that link\nis actually up and functioning.\n\n418\n00:20:15.830 --> 00:20:17.210\nIt'll know it's there.\n\n419\n00:20:17.210 --> 00:20:19.870\nAnd it's not sending any data,\nbecause it's got the link held down.\n\n420\n00:20:19.870 --> 00:20:23.130\nBut it's receiving data, and\nthat's how it knows it's awake, right.\n\n421\n00:20:23.130 --> 00:20:27.460\nWell, imagine if you will,\npicture if you will, that\n\n422\n00:20:27.460 --> 00:20:32.260\nwe're holding down that port and we're\nreceiving data from the other side, right.\n\n423\n00:20:32.260 --> 00:20:35.540\nThings are going like they're supposed to,\nand I have a network failure somewhere.\n\n424\n00:20:35.540 --> 00:20:38.310\nAnd all of a sudden,\nthat loop Isn't a loop any more.\n\n425\n00:20:38.310 --> 00:20:39.880\nAnd I say boy I could\nreally use that cable.\n\n426\n00:20:39.880 --> 00:20:40.540\nLet me bring it up.\n\n427\n00:20:40.540 --> 00:20:42.300\nRight?\nThat's what spanning tree protocol does.\n\n428\n00:20:42.300 --> 00:20:46.870\nI'm going to bring that link up and\nthen we find, hey something's fishy here.\n\n429\n00:20:46.870 --> 00:20:49.320\nI'm receiving the BPDUs\nfrom the other side,\n\n430\n00:20:49.320 --> 00:20:53.730\nI'm getting the switch announcements,\nbut they're not responding.\n\n431\n00:20:53.730 --> 00:20:55.190\nI'm sending data,\nI'm not getting responses.\n\n432\n00:20:55.190 --> 00:20:56.370\nWhat's going on?\n\n433\n00:20:56.370 --> 00:20:59.060\nThere could be problems with the cable\nwhere you're able to receive and\n\n434\n00:20:59.060 --> 00:21:00.890\nnot send, all right?\n\n435\n00:21:00.890 --> 00:21:02.510\nAnd your switch won't know it.\n\n436\n00:21:02.510 --> 00:21:05.030\nIt won't know it by default,\nthe switch doesn't know to look for that.\n\n437\n00:21:05.030 --> 00:21:06.900\nIt assumes the cable is healthy.\n\n438\n00:21:06.900 --> 00:21:09.510\nOn a CAT 5 cable there's 5 wires,\n\n439\n00:21:09.510 --> 00:21:12.860\nit really only take two of them being\nconnected to create a link light.\n\n440\n00:21:12.860 --> 00:21:15.460\nYou could have several cables\nthat are damaged in there.\n\n441\n00:21:15.460 --> 00:21:18.420\nYou could be running at half duplex\neven though you think you're at full.\n\n442\n00:21:18.420 --> 00:21:21.720\nOn a gigabit cable, you're using\nall eight wires and there could\n\n443\n00:21:21.720 --> 00:21:25.930\nbe a couple that are damaged and now you\nget uni-directional traffic, all right?\n\n444\n00:21:25.930 --> 00:21:27.580\nSo we need a way to watch that.\n\n445\n00:21:27.580 --> 00:21:31.500\nAnd UDLD is a service that runs in\nthe background that watches that.\n\n446\n00:21:31.500 --> 00:21:34.890\nAnd Cisco originally created it for\nfiber optic networks, right?\n\n447\n00:21:34.890 --> 00:21:37.900\nWhen you do fiber,\nyou got a transmit and receive.\n\n448\n00:21:37.900 --> 00:21:40.220\nEvery fiber's always done in a pair,\nright?\n\n449\n00:21:40.220 --> 00:21:43.190\nTwo strains of fiber, and so\nwhen you plug it into the GBIC,\n\n450\n00:21:43.190 --> 00:21:46.810\nyou get two little glass tubes,\ntwo laser beams on the receiver.\n\n451\n00:21:46.810 --> 00:21:49.440\nAnd one's send, one's receive.\n\n452\n00:21:49.440 --> 00:21:51.010\nAnd so in fiber,\n\n453\n00:21:51.010 --> 00:21:54.030\nit actually is not uncommon to end\nup with unidirectional traffic.\n\n454\n00:21:54.030 --> 00:21:55.230\nIt does happen a lot.\n\n455\n00:21:56.250 --> 00:21:57.790\nBut Cisco looked at it over the years and\n\n456\n00:21:57.790 --> 00:22:00.770\nsaid boy, this could actually work for\ncopper too.\n\n457\n00:22:00.770 --> 00:22:02.750\nThere's a lot of stuff that\ncan go wrong with copper.\n\n458\n00:22:02.750 --> 00:22:05.190\nAnd it can be a squirrel\nchewing through a wire,\n\n459\n00:22:05.190 --> 00:22:09.320\nit can be a poorly crimped RJ 45,\nand it could be all sorts of things.\n\n460\n00:22:10.330 --> 00:22:13.360\nSo we can use UDLD to monitor the links.\n\n461\n00:22:13.360 --> 00:22:17.920\nAnd to see hey, if unidirectional traffic\nstarts happening, we need to pull this,\n\n462\n00:22:17.920 --> 00:22:18.920\nwe don't need to use this.\n\n463\n00:22:18.920 --> 00:22:21.060\nIt's a bad port, right.\n\n464\n00:22:21.060 --> 00:22:23.160\nI recommend using it\nwith every fiber link.\n\n465\n00:22:23.160 --> 00:22:25.458\nSo if you ever have fiber, use UDLD there.\n\n466\n00:22:25.458 --> 00:22:27.368\nTrunk-links.\n\n467\n00:22:27.368 --> 00:22:30.920\nAnytime you have trunks in either channel.\n\n468\n00:22:30.920 --> 00:22:33.880\nAnytime you're bonding ports together,\nthat's where,\n\n469\n00:22:33.880 --> 00:22:36.990\nnow you're relying on multiple cables,\nyou're just increasing your odds of\n\n470\n00:22:36.990 --> 00:22:40.245\nUDLD happening, and\nthen load balancing gets broken.\n\n471\n00:22:40.245 --> 00:22:41.880\nBecause you're trying to send\nstuff over one link, but\n\n472\n00:22:41.880 --> 00:22:43.850\nnow you're having to re-transmit\nbecause it didn't get there,\n\n473\n00:22:43.850 --> 00:22:47.060\nand sometimes the re-transmit needs\nanother cable, sometimes it doesn't,\n\n474\n00:22:47.060 --> 00:22:48.460\nit gets really inconsistent.\n\n475\n00:22:48.460 --> 00:22:51.930\nUDLD can help with that,\nbut you got to turn it on.\n\n476\n00:22:51.930 --> 00:22:55.380\nit's one of those services, that works,\nit's really cool, it's super easy but\n\n477\n00:22:55.380 --> 00:22:57.740\nyou got to turn it on.\n\n478\n00:22:57.740 --> 00:23:00.750\nUnfortunately, the command\nis a little bit different\n\n479\n00:23:00.750 --> 00:23:04.930\nbased on weather you're on a fiber\ninterface or on a copper interface.\n\n480\n00:23:04.930 --> 00:23:06.860\nSo there's actually two\ndifferent commands to remember.\n\n481\n00:23:06.860 --> 00:23:10.370\nThey're very, very similar,\nwhich is good and bad.\n\n482\n00:23:10.370 --> 00:23:12.970\nGood, and then you can use\nthe question mark to kind of guess it.\n\n483\n00:23:12.970 --> 00:23:15.060\nBad, and it's easy to confuse them.\n\n484\n00:23:15.060 --> 00:23:20.220\nSo on the exam if you get a scenario lab\nwhere you're actually working on a switch,\n\n485\n00:23:20.220 --> 00:23:23.410\nuse your question mark on this one to\nmake sure you're getting the right one.\n\n486\n00:23:23.410 --> 00:23:26.830\nBut let me show you the configures,\nit's really not that bad.\n\n487\n00:23:26.830 --> 00:23:30.510\nSo if I had an interface, and I mentioned\ndoing this on trunks and EtherChannel,\n\n488\n00:23:30.510 --> 00:23:35.230\nwe're normally going to see this\nwith systems where we have, nice,\n\n489\n00:23:35.230 --> 00:23:38.040\nbig fiber GBICs, or whatever, on them.\n\n490\n00:23:38.040 --> 00:23:40.300\nSo we've got these bigger ports.\n\n491\n00:23:40.300 --> 00:23:44.030\nSo if I take a look at this switch here,\nthis is one of my core switches, and\n\n492\n00:23:44.030 --> 00:23:45.888\nI got a bunch of fast ethernet interfaces,\n\n493\n00:23:45.888 --> 00:23:49.770\none through 24, then we got some gig\nguys down there at the end, right?\n\n494\n00:23:49.770 --> 00:23:52.273\nAnd I've got some of these\nother ports that are available.\n\n495\n00:23:52.273 --> 00:23:56.160\nI can jump in and turn on UDLD on any\none of these to start monitoring and\n\n496\n00:23:56.160 --> 00:23:59.054\nmaking sure that my connections are safe,\nright?\n\n497\n00:23:59.054 --> 00:24:03.800\nSo, Actually, I'll just take port two,\nright here, so I'll just take that guy.\n\n498\n00:24:03.800 --> 00:24:07.890\nNow, port two is a copper port, right?\n\n499\n00:24:07.890 --> 00:24:09.930\nIt's just a fast ethernet copper port.\n\n500\n00:24:09.930 --> 00:24:12.660\nThese gigabit links down here,\nthey're copper also,\n\n501\n00:24:12.660 --> 00:24:14.000\nthe switch is just all copper.\n\n502\n00:24:14.000 --> 00:24:18.670\nIf I had fiber, they would show as\ngigabit Ethernet, 1/0/1 or whatever.\n\n503\n00:24:18.670 --> 00:24:20.180\nAlso, so\njust based on the name we don't know,\n\n504\n00:24:20.180 --> 00:24:22.110\nnecessarily, if it's copper or fiber.\n\n505\n00:24:22.110 --> 00:24:23.150\nI know cuz I've seen the switch.\n\n506\n00:24:24.740 --> 00:24:28.690\nBut if it is fiber, we just need to\nremember that slightly different command.\n\n507\n00:24:28.690 --> 00:24:33.160\nSo, to turn it on,\nwe jump into our configuration and\n\n508\n00:24:33.160 --> 00:24:34.880\nwe get into our interface, right.\n\n509\n00:24:34.880 --> 00:24:37.460\nSo, I'm gonna jump into port two, okay.\n\n510\n00:24:37.460 --> 00:24:40.330\nAnd I mention how UDLD is off by default,\nso\n\n511\n00:24:40.330 --> 00:24:43.380\nwe just need to get it turned on and\nput into place.\n\n512\n00:24:43.380 --> 00:24:49.870\nSo, the way we do it is by saying udld,\nand then if we do a question mark,\n\n513\n00:24:49.870 --> 00:24:52.230\nhere's where things start to\nget a little bit different.\n\n514\n00:24:52.230 --> 00:24:53.250\nOkay.\n\n515\n00:24:53.250 --> 00:24:57.370\nFor fiber, you just say udld enable,\nand that's it.\n\n516\n00:24:57.370 --> 00:25:03.932\nBut for copper, you have to say udld\nport and then specify the mode.\n\n517\n00:25:03.932 --> 00:25:07.557\nIt's a little bit different okay\nUDLD enabled versus UDLD port, but\n\n518\n00:25:07.557 --> 00:25:11.304\nif you do the question mark it will tell\nyou which one you need to use and so\n\n519\n00:25:11.304 --> 00:25:14.370\nit kind of guides you\nin the right direction.\n\n520\n00:25:14.370 --> 00:25:19.950\nI have seen some newer IOS's where they\njust use UDLD port for all of them.\n\n521\n00:25:19.950 --> 00:25:20.570\nOkay.\n\n522\n00:25:20.570 --> 00:25:22.900\nAnd so this one maybe like that or\nthis one may not.\n\n523\n00:25:22.900 --> 00:25:27.250\nBut sometimes you'll get it where it is\njust one consistent config but be aware.\n\n524\n00:25:27.250 --> 00:25:30.265\nIf you're working like\n4,500 series switches, or\n\n525\n00:25:30.265 --> 00:25:35.190\n6,500 series, it's often that you'll\nhave those two different commands.\n\n526\n00:25:35.190 --> 00:25:37.430\nNow I mentioned the mode.\n\n527\n00:25:37.430 --> 00:25:38.492\nWhat was I talking about there?\n\n528\n00:25:38.492 --> 00:25:40.600\nWell there's actually two\ndifferent modes for UDLD.\n\n529\n00:25:40.600 --> 00:25:43.770\nThere's normal mode and\nthere's aggressive mode.\n\n530\n00:25:43.770 --> 00:25:46.920\nAnd you'll see this one isn't\nletting me do normal mode.\n\n531\n00:25:46.920 --> 00:25:50.100\nThat's because normal mode\nreally only works with fiber.\n\n532\n00:25:50.100 --> 00:25:54.408\nAggressive mode we can use everywhere, so\naggressive's the only one I'm seeing here.\n\n533\n00:25:54.408 --> 00:25:57.670\nIf I run UDLD port aggressive\nthat's going to turn it on and\n\n534\n00:25:57.670 --> 00:25:58.380\nput it in aggressive mode.\n\n535\n00:25:59.420 --> 00:26:03.310\nIn normal mode, what UDLD does\n\n536\n00:26:03.310 --> 00:26:08.240\nis it sends these little frames, and it\nsends them along with a fake Mac address.\n\n537\n00:26:08.240 --> 00:26:13.616\nAnd the Mac address, I always forget it\nbut I got it written down right here,\n\n538\n00:26:13.616 --> 00:26:19.258\nis 0100 and then, lets see, 0100.0 and\nthen everything else is a C.\n\n539\n00:26:19.258 --> 00:26:24.773\nSo 0100.0CCC.CCCC.\n\n540\n00:26:24.773 --> 00:26:27.688\nSo if you're ever sniffing a network and\nyou see traffic with that MAC address,\n\n541\n00:26:27.688 --> 00:26:29.050\nthat's UDLD traffic.\n\n542\n00:26:29.050 --> 00:26:32.540\nSo it's gonna send a frame across\nthe network with that MAC address, and\n\n543\n00:26:32.540 --> 00:26:36.180\na switch on the other side\nwill see that MAC address, and\n\n544\n00:26:36.180 --> 00:26:38.940\njust respond to it, and\nsay, yep, I got it.\n\n545\n00:26:38.940 --> 00:26:42.940\nSo we sent and\nthen we get a response, all right?\n\n546\n00:26:42.940 --> 00:26:46.800\nAnd this works, even if Spanning Tree\nProtocol is holding the port down.\n\n547\n00:26:46.800 --> 00:26:47.320\nRight?\n\n548\n00:26:47.320 --> 00:26:51.100\nEven in those error states, because\nUDLD ls running down at that layer,\n\n549\n00:26:51.100 --> 00:26:51.970\nlayer two, right?\n\n550\n00:26:51.970 --> 00:26:53.350\nBeneath all of our other protocols.\n\n551\n00:26:53.350 --> 00:26:54.350\nIt's running down there.\n\n552\n00:26:54.350 --> 00:26:56.540\nAnd making sure we have\nbi-directional traffic, right?\n\n553\n00:26:56.540 --> 00:26:57.390\nAnd it's as simple as that.\n\n554\n00:26:57.390 --> 00:26:59.040\nIt just sends a message, gets it back.\n\n555\n00:26:59.040 --> 00:27:05.000\nIn normal mode, if we don't get a message\nback, we go into a warning status, right?\n\n556\n00:27:05.000 --> 00:27:08.140\nBut a warning status doesn't\ntake the port offline.\n\n557\n00:27:08.140 --> 00:27:11.040\nIt just generates a sys log message and\nso now you've got in your logs,\n\n558\n00:27:11.040 --> 00:27:12.140\nand you know about it.\n\n559\n00:27:12.140 --> 00:27:14.650\nBut it doesn't actually\ndo anything about it.\n\n560\n00:27:14.650 --> 00:27:16.230\nAggressive mode is different.\n\n561\n00:27:16.230 --> 00:27:19.200\nAggressive mode waits for eight failures.\n\n562\n00:27:19.200 --> 00:27:23.905\nIf it gets eight failures in a row,\nit puts the port into err-disabled.\n\n563\n00:27:23.905 --> 00:27:25.565\nMoves it into that disabled state.\n\n564\n00:27:25.565 --> 00:27:26.655\nSo now the port's out.\n\n565\n00:27:26.655 --> 00:27:29.425\nWe know it's damaged and\nwe have to take action on it.\n\n566\n00:27:29.425 --> 00:27:31.255\nBut it's eight attempts.\n\n567\n00:27:32.305 --> 00:27:35.795\nAnd these little broadcast messages\nthey're being sent out every so often.\n\n568\n00:27:35.795 --> 00:27:36.935\nThere's a little timer that runs.\n\n569\n00:27:36.935 --> 00:27:38.015\nAnd you can adjust the timer.\n\n570\n00:27:38.015 --> 00:27:41.615\nIf you're really worried about that\ntime and you want this to happen fast,\n\n571\n00:27:41.615 --> 00:27:45.610\nyou can adjust the timer for it and\nshrink that down if you need to.\n\n572\n00:27:45.610 --> 00:27:48.150\nYou can leave it at its\ndefault if you want.\n\n573\n00:27:48.150 --> 00:27:49.760\nThat's what a lot of people do.\n\n574\n00:27:49.760 --> 00:27:52.070\nBut you can kind of manipulate\nit a few different ways.\n\n575\n00:27:52.070 --> 00:27:56.450\nAnd we actually have, if I get out of my\nconfig here, a couple of show commands\n\n576\n00:27:56.450 --> 00:28:02.020\nbuilt around UDLD, where you can pull it\nup and look at the individual interfaces\n\n577\n00:28:02.020 --> 00:28:07.060\nand see what their current configuration\nis and you can see UDLD neighbors.\n\n578\n00:28:07.060 --> 00:28:10.860\nSo for the person on the other end,\nthey gotta be replying back, right,\n\n579\n00:28:10.860 --> 00:28:12.570\nso they're your UDLD neighbor.\n\n580\n00:28:12.570 --> 00:28:15.166\nAnd you'll see that and\nget that information and\n\n581\n00:28:15.166 --> 00:28:17.133\nsee what's going on there, right.\n\n582\n00:28:17.133 --> 00:28:20.030\nSo if I run show UDLD,\nit's gonna give me all the interfaces,\n\n583\n00:28:20.030 --> 00:28:21.662\nwhich is a little more than I want.\n\n584\n00:28:21.662 --> 00:28:26.009\nBut right here is Fa1/0/2,\nand I can see that it is and\n\n585\n00:28:26.009 --> 00:28:28.600\nI'm in aggressive mode, right.\n\n586\n00:28:28.600 --> 00:28:30.480\nSo it's up and it's doing its job.\n\n587\n00:28:30.480 --> 00:28:33.220\nCurrent by directional state, unknown.\n\n588\n00:28:33.220 --> 00:28:35.330\nWhy's it unknown?\nThe switch on the other side is\n\n589\n00:28:35.330 --> 00:28:36.070\nnot running UDLD.\n\n590\n00:28:36.070 --> 00:28:36.890\nRight.\nWe ought to be able to\n\n591\n00:28:36.890 --> 00:28:37.850\ntalk back and forth.\n\n592\n00:28:37.850 --> 00:28:40.680\nThe other side doesn't know to\nreflect these messages back to me.\n\n593\n00:28:40.680 --> 00:28:42.960\nBut here's where I can\nsee the message interval.\n\n594\n00:28:42.960 --> 00:28:46.830\nRight now and in seven seconds and\nI've got a time out interval of\n\n595\n00:28:46.830 --> 00:28:51.140\nfive seconds which is smaller so\nif i miss just one I'm going to time out.\n\n596\n00:28:51.140 --> 00:28:55.257\nSo it's going to keep an eye on that and\nright now it's just running and waiting.\n\n597\n00:28:55.257 --> 00:28:56.553\nAnd then we can go in and\n\n598\n00:28:56.553 --> 00:29:00.247\nkind of customize that on the interface\nsome more if we need too.\n\n599\n00:29:00.247 --> 00:29:02.380\nActually, this switch might not allow me.\n\n600\n00:29:02.380 --> 00:29:05.490\nWhen I looked in there\nI didn't see any other,\n\n601\n00:29:05.490 --> 00:29:07.450\nlet's see if they give\nme any other settings.\n\n602\n00:29:07.450 --> 00:29:11.660\nNot every switch has the full\nfeatures set of UDLD, and\n\n603\n00:29:11.660 --> 00:29:15.490\nit kind of goes back to that whole design\nfor fiber stuff where you'll see certain\n\n604\n00:29:15.490 --> 00:29:20.330\nports that just don't\nhave that functionality.\n\n605\n00:29:20.330 --> 00:29:21.400\nThe fiber was what?\n\n606\n00:29:21.400 --> 00:29:24.760\n2/0/1, whoops.\n\n607\n00:29:24.760 --> 00:29:26.810\nMy typing skills are gonna\nbe the limitation today.\n\n608\n00:29:28.210 --> 00:29:31.415\nNow it's just gonna kill me if\nI can't figure out what port.\n\n609\n00:29:31.415 --> 00:29:35.260\n>> [LAUGH]\n>> This is gonna be how many bad commands\n\n610\n00:29:35.260 --> 00:29:37.565\ncan I type in a row, and\nthat was the right one.\n\n611\n00:29:37.565 --> 00:29:38.355\nThere we go.\n\n612\n00:29:38.355 --> 00:29:40.905\nSo if I jump into one of these other ones,\nI'm pretty sure they're copper too.\n\n613\n00:29:40.905 --> 00:29:43.475\nI'm almost positive.\n\n614\n00:29:43.475 --> 00:29:46.115\nLet's just go take a look at that.\n\n615\n00:29:46.115 --> 00:29:47.855\nAnd yeah, so these are the same.\n\n616\n00:29:47.855 --> 00:29:49.655\nSo yeah, nothing special there.\n\n617\n00:29:49.655 --> 00:29:53.167\nSo if If we jump in, some switches will\nhave addition options in there where\n\n618\n00:29:53.167 --> 00:29:54.987\nyou can kind of tweak some of that.\n\n619\n00:29:54.987 --> 00:29:57.507\nSome actually have global options,\nwell this one does,\n\n620\n00:29:57.507 --> 00:30:00.897\nUDLD enable just to turn it\non on all fiber ports, right?\n\n621\n00:30:00.897 --> 00:30:03.470\nThere's that UDLD enable\nthat I was talking about.\n\n622\n00:30:03.470 --> 00:30:04.740\nAnd UDLD aggressive, so\n\n623\n00:30:04.740 --> 00:30:07.790\nyou can have it default to aggressive\nmode instead of normal mode.\n\n624\n00:30:07.790 --> 00:30:12.220\nAnd then we can say UDLD message,\nand there's our timer.\n\n625\n00:30:12.220 --> 00:30:15.470\nAnd so we can jump in and\nset that timer for how many seconds.\n\n626\n00:30:15.470 --> 00:30:18.720\nIf this is a mission critical link,\nI might want to monitor it once a second,\n\n627\n00:30:18.720 --> 00:30:20.220\nset it to the lowest.\n\n628\n00:30:20.220 --> 00:30:22.350\nI might want to go 90 seconds,\njust every minute and a half.\n\n629\n00:30:22.350 --> 00:30:23.960\nI don't need to go crazy on it.\n\n630\n00:30:23.960 --> 00:30:25.840\nOr middle of the road,\nwhich is 45 seconds,\n\n631\n00:30:25.840 --> 00:30:28.890\nwhich I believe is what the default\nis on most of these switches.\n\n632\n00:30:28.890 --> 00:30:29.500\nAll right?\n\n633\n00:30:29.500 --> 00:30:31.830\nSo, we can get that configured and\nput in place.\n\n634\n00:30:31.830 --> 00:30:38.045\nNow, for me, if I do a,\noh we turned off CDP.\n\n635\n00:30:38.045 --> 00:30:42.765\nIf I do a show LDP neighbor,\nwho is plugged in on port two for me?\n\n636\n00:30:42.765 --> 00:30:43.525\nNot a switch.\n\n637\n00:30:43.525 --> 00:30:44.845\nSo that's gonna be a problem too.\n\n638\n00:30:44.845 --> 00:30:47.875\nMy UDLD status will never be happy if\nit's turned on on a port that's not\n\n639\n00:30:47.875 --> 00:30:49.190\npointing to a switch.\n\n640\n00:30:49.190 --> 00:30:54.660\nSo I would need to turn it on actually\nsomewhere else like my connection to core\n\n641\n00:30:54.660 --> 00:30:58.810\ntwo and you know what,\nlet's do, we'll do it on both.\n\n642\n00:30:58.810 --> 00:31:01.400\nRight, so I'm gonna turn it on for\nboth of these guys.\n\n643\n00:31:01.400 --> 00:31:06.900\nI'll just come in here and\nsay UDLD port aggressive,\n\n644\n00:31:06.900 --> 00:31:11.500\nand we'll turn it on globally too to just.\n\n645\n00:31:11.500 --> 00:31:12.730\nFor giggles.\n\n646\n00:31:12.730 --> 00:31:14.060\nSo there we go.\nWe're up and we're running.\n\n647\n00:31:14.060 --> 00:31:16.178\nRight?\nSo we're running UDLD, and\n\n648\n00:31:16.178 --> 00:31:19.622\nif I do a show UDLD, and\nlook at those interfaces,\n\n649\n00:31:19.622 --> 00:31:23.322\nactually let me just jump\nahead to those interfaces.\n\n650\n00:31:26.571 --> 00:31:28.059\nAnd take a look at, whoops.\n\n651\n00:31:32.288 --> 00:31:35.660\nSorry, I don't need the interface command\nthere, so let me just take that out.\n\n652\n00:31:35.660 --> 00:31:37.840\nAnd we take a look at\none of those interfaces.\n\n653\n00:31:37.840 --> 00:31:38.630\nI'll see it is running.\n\n654\n00:31:38.630 --> 00:31:39.330\nI'm in aggressive mode.\n\n655\n00:31:39.330 --> 00:31:42.470\nIt's unknown, but now I can jump\nover to my other core switch and\n\n656\n00:31:42.470 --> 00:31:46.800\nI can get it turned on over here too and\nget the same basic effect, right?\n\n657\n00:31:46.800 --> 00:31:51.160\nSame configuration, and so I'm just\ngonna jump in here and do a range and,\n\n658\n00:31:51.160 --> 00:31:54.570\noh, you know what?\n\n659\n00:31:54.570 --> 00:31:55.670\nI'm gonna do a bad thing, Daniel.\n\n660\n00:31:55.670 --> 00:31:58.690\nI'm gonna assume that it's\nthe same port numbers.\n\n661\n00:31:58.690 --> 00:32:00.055\n>> Well,\nthat'll be interesting if it's not.\n\n662\n00:32:00.055 --> 00:32:02.900\n[LAUGH]\n>> And, yeah, we'll find out.\n\n663\n00:32:02.900 --> 00:32:04.640\nSo I'm just gonna go ahead and\nhit enable these.\n\n664\n00:32:04.640 --> 00:32:08.820\nSo I'm doing UDLD port aggressive on the\nport, and really, that's all I need to do.\n\n665\n00:32:08.820 --> 00:32:13.330\nBut I'm also doing a UDLD enable globally,\njust to turn it on there.\n\n666\n00:32:14.550 --> 00:32:17.630\nBut once that's done,\nit's gonna start sending those messages.\n\n667\n00:32:17.630 --> 00:32:21.300\nNow, based on the timer, I might have to\nwait up to 90 seconds before I actually\n\n668\n00:32:21.300 --> 00:32:23.330\nstart getting information back.\n\n669\n00:32:23.330 --> 00:32:26.250\nSo I might have to be\na little patient here.\n\n670\n00:32:26.250 --> 00:32:28.620\nBut assuming I got my port numbers right.\n\n671\n00:32:28.620 --> 00:32:30.500\nWhich, oh they're all the same, good.\n\n672\n00:32:30.500 --> 00:32:36.300\nSo I should be able to\nrun show UDLD FA1/0/23,\n\n673\n00:32:36.300 --> 00:32:41.900\nand we should see, there we go,\ncurrent neighbor state, bidirectional.\n\n674\n00:32:41.900 --> 00:32:45.410\nI sent my broadcast, I got it back\nfrom them, and we're sending and\n\n675\n00:32:45.410 --> 00:32:49.090\ncommunicating back and forth and\nwe can see that device is out there.\n\n676\n00:32:49.090 --> 00:32:51.260\nAnd it's up, and it's happy.\n\n677\n00:32:51.260 --> 00:32:54.010\nAnd my message interval right now has\nactually dropped down to 15 seconds.\n\n678\n00:32:54.010 --> 00:32:56.060\nI thought it was 45 to the default.\n\n679\n00:32:56.060 --> 00:32:57.390\nThis one is pretty low.\n\n680\n00:32:57.390 --> 00:32:59.410\nAnd my timeout interval is set to 5.\n\n681\n00:32:59.410 --> 00:33:01.880\nSo, if we have 5 failures,\n\n682\n00:33:01.880 --> 00:33:05.010\nthen it is going to identify that\nas a failure and take it out.\n\n683\n00:33:05.010 --> 00:33:09.470\nSo it's up, it's going, and now we're\nrunning unidirectional link detection.\n\n684\n00:33:09.470 --> 00:33:11.460\nThis is one of those set it and\nforget it protocols.\n\n685\n00:33:11.460 --> 00:33:13.670\nYou turn it on, you put it in place, and\n\n686\n00:33:13.670 --> 00:33:16.620\nyou never worry about it again until\nyou have a physical cable failure.\n\n687\n00:33:16.620 --> 00:33:19.000\nI know a lot of you guys\nare probably out there saying, boy,\n\n688\n00:33:19.000 --> 00:33:21.430\nI've worked with fiber and\nnever had a problem with it.\n\n689\n00:33:21.430 --> 00:33:22.820\nWell, one day you will.\n\n690\n00:33:22.820 --> 00:33:24.480\nAnd this is how you'll know.\n\n691\n00:33:24.480 --> 00:33:26.840\n>> Just a matter of time before\nthose failures start to happen.\n\n692\n00:33:26.840 --> 00:33:28.940\nIt's nice to be able to\nknow things like this so\n\n693\n00:33:28.940 --> 00:33:31.360\nthat you can troubleshoot those issues.\n\n694\n00:33:31.360 --> 00:33:32.580\nGreat demonstrations, Don,\n\n695\n00:33:32.580 --> 00:33:37.660\nit's really taken us into becoming\nCCMP wizards such as yourself who'll\n\n696\n00:33:37.660 --> 00:33:42.100\nbe talking about the magical little layer\ntwo protocols that we're using today.\n\n697\n00:33:42.100 --> 00:33:42.841\nVery cool stuff.\n\n698\n00:33:42.841 --> 00:33:44.606\n>> Yeah,\nit's not crazy unattainable stuff,\n\n699\n00:33:44.606 --> 00:33:46.835\nit's just knowing a little\nbit more about the switched,\n\n700\n00:33:46.835 --> 00:33:49.760\na little bit more about the protocols and\nwhat we learn on the CCNA side, but\n\n701\n00:33:49.760 --> 00:33:52.892\notherwise it's actually very parallel\nto what you guys have already learned.\n\n702\n00:33:52.892 --> 00:33:53.800\n>> That's right.\n\n703\n00:33:53.800 --> 00:33:56.190\nWell everyone, it looks like we've\ncome to the end of another great show.\n\n704\n00:33:56.190 --> 00:33:57.580\nHopefully you've enjoyed it.\n\n705\n00:33:57.580 --> 00:33:59.060\nSigning off for ITProTV.\n\n706\n00:33:59.060 --> 00:34:00.850\nI've been your host Daniel Lowery.\n\n707\n00:34:00.850 --> 00:34:01.480\n>> I'm Don Pazet.\n\n708\n00:34:01.480 --> 00:34:04.400\n>> We'll see you next time.\n\n",
          "vimeoId": "140813831"
        },
        {
          "description": "In this episode, Don and Daniel explore the exciting world of Virtual Local Area Networks or VLANs. Here they describe VLAN details such as the VLAN database, default ranges, and how to crate and name a VLAN. They also show you some VLAN options when dealing with VoIP traffic.",
          "length": "1940",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_092915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_092915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_092915-1-sm.jpg",
          "title": "VLANs and Trunking",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.850 --> 00:00:16.645\nAll right, greetings everyone and welcome\nto another exciting episode of ITProTV.\n\n3\n00:00:16.645 --> 00:00:21.250\nI'm your host Daniel Lowrie and here with\nme today is none other than Mr. Don Pezet.\n\n4\n00:00:21.250 --> 00:00:22.220\nHow's it going Don?\n\n5\n00:00:22.220 --> 00:00:23.320\n>> It is going great, Daniel.\n\n6\n00:00:23.320 --> 00:00:24.870\nI'm glad to be back on the show.\n\n7\n00:00:24.870 --> 00:00:29.310\nAnd today we're going to be jumping into\na pretty neat topic which are VLANs or\n\n8\n00:00:29.310 --> 00:00:31.856\nVirtual Local Area Networks.\n\n9\n00:00:31.856 --> 00:00:34.310\nNow VLANS are one of those topics.\n\n10\n00:00:34.310 --> 00:00:36.525\nAgain, we learned about them in the CCNA.\n\n11\n00:00:36.525 --> 00:00:39.483\nBut we're gonna go a little more in depth\non here in this series to make sure we've\n\n12\n00:00:39.483 --> 00:00:42.110\ngot a really good understanding of\nwhat's going on behind the scenes.\n\n13\n00:00:42.110 --> 00:00:46.380\nAnd some of the things that we might bump\ninto as we implement them on the network.\n\n14\n00:00:46.380 --> 00:00:48.220\nNow, let's start with a real,\n\n15\n00:00:48.220 --> 00:00:53.420\njust kind of basic refresher over what\na VLAN is, because maybe you've forgotten.\n\n16\n00:00:53.420 --> 00:00:56.689\nIt's not something you necessarily\nwork with every single day.\n\n17\n00:00:56.689 --> 00:01:00.507\nWhen you buy a Cisco switch, a Cisco\nswitch is actually ready to be deployed in\n\n18\n00:01:00.507 --> 00:01:02.166\nproduction right out of the box.\n\n19\n00:01:02.166 --> 00:01:05.383\nYou can cut open the box,\ntake that switch, throw it in your rack,\n\n20\n00:01:05.383 --> 00:01:06.484\nplug devices into it.\n\n21\n00:01:06.484 --> 00:01:09.549\nAnd if you plug two devices into it\nthey' ll be able to see each other.\n\n22\n00:01:09.549 --> 00:01:11.443\nRight?\nThat's the basic layer two\n\n23\n00:01:11.443 --> 00:01:12.869\nswitch functionality.\n\n24\n00:01:12.869 --> 00:01:17.079\nBut what we can do is take\nthat physical switch and\n\n25\n00:01:17.079 --> 00:01:21.398\nwe can divide it into\nmultiple virtual switches.\n\n26\n00:01:21.398 --> 00:01:23.962\nRight?\nThink of it, it's like virtualization,\n\n27\n00:01:23.962 --> 00:01:27.830\nlike hyper V, or VM ware, or any kind\nof operating system virtualization.\n\n28\n00:01:27.830 --> 00:01:30.651\nVLANs are like that for your switch.\n\n29\n00:01:30.651 --> 00:01:34.309\nSo I might have a 48-port switch,\nbut I divide it in half.\n\n30\n00:01:34.309 --> 00:01:40.060\nAnd the first 24 ports are on one VLAN and\nthe other 24 ports are on a second VLAN.\n\n31\n00:01:40.060 --> 00:01:44.770\nAnd when I plug my computers into it,\nit's as if I had two 24-port switches.\n\n32\n00:01:44.770 --> 00:01:46.090\nAnd you don't have to divide it in half.\n\n33\n00:01:46.090 --> 00:01:47.370\nIt doesn't have to be even.\n\n34\n00:01:47.370 --> 00:01:49.820\nI could say these three\nports are in one VLAN,\n\n35\n00:01:49.820 --> 00:01:52.010\nthese seven ports are in another VLAN.\n\n36\n00:01:52.010 --> 00:01:56.055\nAnd continue on like that creating as many\nvirtual local area networks as I need.\n\n37\n00:01:56.055 --> 00:01:57.030\nRight?\n\n38\n00:01:57.030 --> 00:02:00.169\nNow, what are some scenarios\nwhere I need VLANs?\n\n39\n00:02:00.169 --> 00:02:02.371\nThere's a few reasons why\nwe might create these,\n\n40\n00:02:02.371 --> 00:02:05.265\none example might be I'm creating a DMZ,\na demilitarized zone.\n\n41\n00:02:05.265 --> 00:02:06.580\nRight?\nI need to have\n\n42\n00:02:06.580 --> 00:02:09.170\nservers that are exposed to the Internet.\n\n43\n00:02:09.170 --> 00:02:13.650\nAnd I'm plugging them into a switch\nthat I have maybe workstations or\n\n44\n00:02:13.650 --> 00:02:16.570\nother servers plugged into that\naren't exposed to the Internet.\n\n45\n00:02:16.570 --> 00:02:18.710\nWell, I don't wanna have\ncross contamination.\n\n46\n00:02:18.710 --> 00:02:21.150\nIf somebody hacks into one\nof my Internet servers,\n\n47\n00:02:21.150 --> 00:02:24.290\nI don't want them being able to\nleapfrog into the rest of my network.\n\n48\n00:02:24.290 --> 00:02:29.880\nSo I might create a VLAN, a separate\nDMZ VLAN to isolate those servers,\n\n49\n00:02:29.880 --> 00:02:33.190\nand then a VLAN for all of my other\nmachines and it's nice and separate.\n\n50\n00:02:33.190 --> 00:02:35.010\nRight?\nThat's one scenario.\n\n51\n00:02:35.010 --> 00:02:36.580\nPersonally, I like to do\ndedicated switches for\n\n52\n00:02:36.580 --> 00:02:38.320\na DMZ just to be on\nthe absolute safe side.\n\n53\n00:02:38.320 --> 00:02:40.960\nBut you don't necessarily have to.\n\n54\n00:02:40.960 --> 00:02:43.530\nA VLAN is a true separation.\n\n55\n00:02:43.530 --> 00:02:49.030\nWhen you do a VLAN, one VLAN cannot\nsee another VLAN by default.\n\n56\n00:02:49.030 --> 00:02:54.010\nIf you want traffic to move between VLANs,\nyou need, well there's two solutions I\n\n57\n00:02:54.010 --> 00:02:57.610\nguess, one's kinda ridiculous, which\nis you can take a crossover cable and\n\n58\n00:02:57.610 --> 00:02:59.980\nyou can plug one end into\na port on one VLAN and\n\n59\n00:02:59.980 --> 00:03:03.960\nanother end into a port on a second\nVLAN and now it merges them together.\n\n60\n00:03:03.960 --> 00:03:04.611\n>> That's how I do it.\n\n61\n00:03:04.611 --> 00:03:06.450\n[LAUGH] That's the fun one.\n\n62\n00:03:06.450 --> 00:03:09.830\n>> And I say it's ridiculous because it\nkinda negates the whole point of having\n\n63\n00:03:09.830 --> 00:03:10.340\nthe VLAN.\n\n64\n00:03:10.340 --> 00:03:11.350\n>> So what are you doing.\n\n65\n00:03:11.350 --> 00:03:13.870\n>> Yeah, it's basically just bonding those\nswitches there's not really a whole lot\n\n66\n00:03:13.870 --> 00:03:15.110\nof point in doing that.\n\n67\n00:03:15.110 --> 00:03:16.940\nThe other solution is to put in a router.\n\n68\n00:03:16.940 --> 00:03:21.370\nI can have have a router with an interface\non one VLAN an interface on another VLAN\n\n69\n00:03:21.370 --> 00:03:22.960\nand now I can route traffic between them.\n\n70\n00:03:22.960 --> 00:03:25.140\nAll right,\nnow you might be thinking again,\n\n71\n00:03:25.140 --> 00:03:28.020\nwell doesn't that kinda defeat\nthe purpose I got that connectivity?\n\n72\n00:03:28.020 --> 00:03:31.330\nWell you actually get a few different\nbenefits by doing these things.\n\n73\n00:03:31.330 --> 00:03:35.371\nThe first benefit is when traffic passes\nthrough a router, we can filter it.\n\n74\n00:03:35.371 --> 00:03:35.923\nRight?\n\n75\n00:03:35.923 --> 00:03:39.008\nOr that router might be a firewall,\nwe always say router these days but\n\n76\n00:03:39.008 --> 00:03:40.330\nmost firewalls are routers.\n\n77\n00:03:40.330 --> 00:03:44.255\nSo, we could actually be filtering traffic\nas it passes between those VLANS because\n\n78\n00:03:44.255 --> 00:03:46.148\nit goes through an intelligent engine.\n\n79\n00:03:46.148 --> 00:03:46.705\nRight?\n\n80\n00:03:46.705 --> 00:03:48.329\nrouter or a layer three or higher device.\n\n81\n00:03:49.410 --> 00:03:52.350\nOr another benefit even if we don't route\n\n82\n00:03:52.350 --> 00:03:56.020\nis that what you're doing is you're\ncreating separate broadcast domains.\n\n83\n00:03:56.020 --> 00:04:00.130\nRemember when a work station sends out a\nbroadcast, which they do all the time, or\n\n84\n00:04:00.130 --> 00:04:01.860\na server, a printer, whatever.\n\n85\n00:04:01.860 --> 00:04:05.700\nWhen they send out a broadcast it goes\nto everybody on the whole network\n\n86\n00:04:05.700 --> 00:04:07.540\nuntil it hits the edge of the network.\n\n87\n00:04:07.540 --> 00:04:09.080\nAnd where's that edge?\n\n88\n00:04:09.080 --> 00:04:09.730\nYour router.\n\n89\n00:04:09.730 --> 00:04:12.130\nIf you've got one your router\nis the edge of your network.\n\n90\n00:04:12.130 --> 00:04:13.700\nThat's the end of that broadcast.\n\n91\n00:04:13.700 --> 00:04:16.020\nYour broadcast says within your subnet.\n\n92\n00:04:16.020 --> 00:04:19.730\nIf I have more than one VLAN,\nI've now got more than one subnet.\n\n93\n00:04:19.730 --> 00:04:22.830\nAnd broadcasts on one don't\nmake it to the other.\n\n94\n00:04:22.830 --> 00:04:24.820\nAnd if I have a router in between it,\n\n95\n00:04:24.820 --> 00:04:28.620\nonly unicast traffic will pass\nfrom one VLAN to the other.\n\n96\n00:04:28.620 --> 00:04:30.790\nSo if you've got a massive network.\n\n97\n00:04:30.790 --> 00:04:34.450\nLet's say you have 10,000 workstations,\nand maybe you're\n\n98\n00:04:34.450 --> 00:04:38.690\nsome kind of corporate campus,\nfactory environment, a large college and\n\n99\n00:04:38.690 --> 00:04:42.008\nyou've got 10,000 computers and\nyou don't want those all on one segment.\n\n100\n00:04:42.008 --> 00:04:45.895\nImagine having 10,000 computers all\njust doing their regular chatter,\n\n101\n00:04:45.895 --> 00:04:47.236\ntheir regular broadcast.\n\n102\n00:04:47.236 --> 00:04:48.340\nRight?\n\n103\n00:04:48.340 --> 00:04:50.000\nWindows machines can be\npretty bad about it,\n\n104\n00:04:50.000 --> 00:04:51.650\nLinux machines are pretty good about it.\n\n105\n00:04:51.650 --> 00:04:54.170\nMacs are the worst,\nthey broadcast all the time.\n\n106\n00:04:54.170 --> 00:04:57.360\nAnd that's because of the convenience of\nthe auto configuring protocols they have.\n\n107\n00:04:57.360 --> 00:04:58.730\nIt's a lot of chatter.\n\n108\n00:04:58.730 --> 00:05:02.760\nBut even firewalls are sending\nout broadcasts, that's how they\n\n109\n00:05:02.760 --> 00:05:06.590\nfind things on the network at a minimum\nAddress Resolution Protocol, ARP.\n\n110\n00:05:06.590 --> 00:05:07.400\nSo when I'm looking for\n\n111\n00:05:07.400 --> 00:05:11.316\nwhat IP is tied to a MAC address,\nI send out an ARP broadcast.\n\n112\n00:05:11.316 --> 00:05:13.980\nAnd every computer is gonna\ndo that at least once when it\n\n113\n00:05:13.980 --> 00:05:18.790\nboots up to find its default gateway, or\nDNS servers, or other entries like that.\n\n114\n00:05:18.790 --> 00:05:21.510\nAnd those broadcasts will be\nconstant on your network.\n\n115\n00:05:21.510 --> 00:05:24.000\nIf you have 10,000\ncomputers there's too much.\n\n116\n00:05:24.000 --> 00:05:25.561\nRight?\nIt's a ton of chatter.\n\n117\n00:05:25.561 --> 00:05:27.695\nSo we use VLANs to divide\nthat network up and\n\n118\n00:05:27.695 --> 00:05:29.960\nmaybe I'll divide it up into 50 networks.\n\n119\n00:05:29.960 --> 00:05:31.380\nSo we've got 10,000 computers,\n\n120\n00:05:31.380 --> 00:05:32.910\nyou should have picked easier math\n>> [LAUGH]\n\n121\n00:05:32.910 --> 00:05:34.729\n>> If I divide it into 50 networks,\n\n122\n00:05:34.729 --> 00:05:39.137\nnow things start to get a little crazy and\nwe end up with, I don't know what is that?\n\n123\n00:05:39.137 --> 00:05:39.799\n>> 8 million.\n\n124\n00:05:39.799 --> 00:05:41.342\nYeah, something like that [LAUGH].\n\n125\n00:05:41.342 --> 00:05:44.335\n[CROSSTALK]\n>> If I have 10,000 computers and\n\n126\n00:05:44.335 --> 00:05:46.726\nI divide it into, say, 100 networks.\n\n127\n00:05:46.726 --> 00:05:47.330\nRight?\n\n128\n00:05:47.330 --> 00:05:50.840\nNow we end up with 100\ncomputers on each segment.\n\n129\n00:05:50.840 --> 00:05:52.550\nAnd that's a much more manageable number,\n\n130\n00:05:52.550 --> 00:05:56.009\na much smaller number, and\nthings usually work out better that way.\n\n131\n00:05:56.009 --> 00:05:58.290\nRight?\nSo those are some of the uses for VLANs.\n\n132\n00:05:58.290 --> 00:05:59.200\nThere's others.\n\n133\n00:05:59.200 --> 00:06:00.730\nRight?\nYou may have other reasons for\n\n134\n00:06:00.730 --> 00:06:03.690\nusing VLANs on your network, but\nthose are two of the big ones.\n\n135\n00:06:03.690 --> 00:06:05.559\nRight?\nImplementing security,\n\n136\n00:06:05.559 --> 00:06:09.987\nas we filter traffic going between VLANs,\nand minimizing your broadcast domain.\n\n137\n00:06:09.987 --> 00:06:11.379\nSo those are the two big ones.\n\n138\n00:06:11.379 --> 00:06:14.490\nAll right,\nI guess I could throw out some other uses.\n\n139\n00:06:14.490 --> 00:06:17.560\nIt might be things like isolating clients.\n\n140\n00:06:17.560 --> 00:06:20.600\nIf you're a service provider you\nmight have multiple customers and\n\n141\n00:06:20.600 --> 00:06:24.120\nyou wanna separate the customers from each\nother so you can use VLANs for that too,\n\n142\n00:06:24.120 --> 00:06:25.710\nassigning a VLAN to each customer.\n\n143\n00:06:25.710 --> 00:06:27.770\nIt does all sorts of neat\nstuff you can do with VLANs.\n\n144\n00:06:27.770 --> 00:06:31.317\n>> So Don, it's just all about segregating\nthe networks apart from each other.\n\n145\n00:06:31.317 --> 00:06:33.795\nThat broadcast domain stuff,\nthat's basically the whole,\n\n146\n00:06:33.795 --> 00:06:35.519\nwell one of the major\npurposes of a router.\n\n147\n00:06:35.519 --> 00:06:36.481\nRight?\nIs to say we\n\n148\n00:06:36.481 --> 00:06:38.353\nare separating these broadcast domains.\n\n149\n00:06:38.353 --> 00:06:41.627\nI don't want this traffic from this\nnetwork to go to this network,\n\n150\n00:06:41.627 --> 00:06:44.030\nwell at least the broadcast\ntraffic [INAUDIBLE].\n\n151\n00:06:44.030 --> 00:06:45.457\n>> Yeah, that is basically it.\n\n152\n00:06:45.457 --> 00:06:47.534\nI mean that's kind of\nthe nature of the design and\n\n153\n00:06:47.534 --> 00:06:49.015\nthis really solves that problem.\n\n154\n00:06:49.015 --> 00:06:52.710\nSo, remember that a lot of these\nnetworks and the ethernet itself\n\n155\n00:06:52.710 --> 00:06:56.740\nwere all designed back in the 70s and\n80s, when networks were very small.\n\n156\n00:06:56.740 --> 00:07:00.550\nAnd now networks are massive, way beyond\nwhat they even envisioned back then.\n\n157\n00:07:00.550 --> 00:07:02.977\nAnd so we've got to have tools\nlike this to make that work.\n\n158\n00:07:02.977 --> 00:07:07.610\nAll right, now on your switch,\nwhen you go in and start to configure it.\n\n159\n00:07:07.610 --> 00:07:10.250\nWe need to think about what\nthat switch is being used for.\n\n160\n00:07:10.250 --> 00:07:11.100\nAnd let me give you an example.\n\n161\n00:07:11.100 --> 00:07:15.569\nI've got a diagram pulled up here of kind\nof the topology that I'm working with.\n\n162\n00:07:15.569 --> 00:07:20.221\nAnd so what you can kind of see\nhere is I've got a few switches\n\n163\n00:07:20.221 --> 00:07:22.466\nthat are in my environment.\n\n164\n00:07:22.466 --> 00:07:26.732\nAnd I've got, I kinda,\nI call them my core and access switches,\n\n165\n00:07:26.732 --> 00:07:29.610\nthey're really all kind of the same.\n\n166\n00:07:29.610 --> 00:07:34.380\nBut when you have core switches, core\nswitches are focused on moving data from\n\n167\n00:07:34.380 --> 00:07:36.760\npoint A to point B as fast as possible.\n\n168\n00:07:36.760 --> 00:07:40.160\nThey're all about moving data,\nand moving it quickly.\n\n169\n00:07:40.160 --> 00:07:45.035\nWe don't normally do VLANs up here at the\ncore because their just moving data fast.\n\n170\n00:07:45.035 --> 00:07:47.295\nAnd so\nthese might me layer three switches,\n\n171\n00:07:47.295 --> 00:07:49.685\nthey might be routers instead of switches.\n\n172\n00:07:49.685 --> 00:07:51.766\nSometimes your core you just have routers.\n\n173\n00:07:51.766 --> 00:07:53.746\nThen you may have a separate\ndistribution layer and\n\n174\n00:07:53.746 --> 00:07:55.505\nI don't have a distribution\nlayer in my lab.\n\n175\n00:07:55.505 --> 00:07:57.825\nI've kinda merged my core distribution.\n\n176\n00:07:57.825 --> 00:08:00.404\nYour distribution layers almost\nalways layer three switches.\n\n177\n00:08:00.404 --> 00:08:04.255\nThey're switches that act as routers and\nso they see more than one VLAN, and\n\n178\n00:08:04.255 --> 00:08:08.250\nthey control access between them,\nthat's kind of their purpose.\n\n179\n00:08:08.250 --> 00:08:12.188\nBut where VLANs are really prevalent\nis down here at the access layer,\n\n180\n00:08:12.188 --> 00:08:15.602\nwhere we actually plug our\nworkstations into that network.\n\n181\n00:08:15.602 --> 00:08:20.413\nSo I've got PCs, I've got laptops,\nprinters, whatever devices that I have,\n\n182\n00:08:20.413 --> 00:08:22.554\nI plug into these access switches.\n\n183\n00:08:22.554 --> 00:08:27.994\nAnd an access switch might be\na 24-port 2950 or 2960, right?\n\n184\n00:08:27.994 --> 00:08:29.119\nA really low end switch.\n\n185\n00:08:29.119 --> 00:08:36.080\nOr it might be a massive\n6512 with 288 ports on it.\n\n186\n00:08:36.080 --> 00:08:40.420\nIt could be insanely large if I\nwant it to be or really small.\n\n187\n00:08:40.420 --> 00:08:44.190\nBut those ports can easily be divided up\n\n188\n00:08:44.190 --> 00:08:46.250\ninto VLANs to create\nthose virtual networks.\n\n189\n00:08:47.610 --> 00:08:50.355\nNow, when we go and start creating\nthese virtual networks, well,\n\n190\n00:08:50.355 --> 00:08:53.230\nyou've actually already got the first one.\n\n191\n00:08:53.230 --> 00:08:55.752\nRemember how I said we could take\na Cisco switch out of the box and\n\n192\n00:08:55.752 --> 00:08:56.711\nplug it in and it works.\n\n193\n00:08:56.711 --> 00:09:01.110\nWell all the ports are in the same VLAN.\n\n194\n00:09:01.110 --> 00:09:04.500\nYou've got one VLAN,\nVLAN 1, VLAN number one.\n\n195\n00:09:04.500 --> 00:09:06.540\nAnd that's what all\nthe ports are in by default.\n\n196\n00:09:06.540 --> 00:09:11.253\nSo, if I were to take one of my switches,\nlike if I were to jump back to this guy\n\n197\n00:09:11.253 --> 00:09:14.218\nhere and\ntake a look at its VLAN configuration.\n\n198\n00:09:14.218 --> 00:09:18.790\nSo, if I jump into its config,\nI do a show vlan.\n\n199\n00:09:18.790 --> 00:09:21.670\nIt's gonna show me all\nthe VLANs on this system and\n\n200\n00:09:21.670 --> 00:09:23.570\nI've got one VLAN in particular.\n\n201\n00:09:23.570 --> 00:09:26.038\nVLAN 1 is my default VLAN.\n\n202\n00:09:26.038 --> 00:09:30.348\nAnd if I look at my port list,\nall my ports are right there, right?\n\n203\n00:09:30.348 --> 00:09:33.726\nSo I got a bunch of ports,\nport 1 through 24, and then my gig ports,\n\n204\n00:09:33.726 --> 00:09:35.518\nmy uplinks at the end of this switch.\n\n205\n00:09:35.518 --> 00:09:36.778\nAnd they're all in VLAN 1.\n\n206\n00:09:36.778 --> 00:09:41.352\nAnd that's why, when I plug a computer in,\nwell it's gonna be able to see anybody\n\n207\n00:09:41.352 --> 00:09:44.885\nelse's plugin cuz they're all\nin that same virtual network.\n\n208\n00:09:44.885 --> 00:09:48.085\n>> Now Don,\nyou said there's one VLAN on this switch,\n\n209\n00:09:48.085 --> 00:09:50.975\nbut I don't mean to be corrective or\nanything, but\n\n210\n00:09:50.975 --> 00:09:55.900\nit seems like there might be more than\none VLAN on this switch by default here.\n\n211\n00:09:55.900 --> 00:09:57.740\n>> Damn you, Daniel,\n[INAUDIBLE] your ability to read.\n\n212\n00:09:57.740 --> 00:09:58.938\n>> [LAUGH]\n>> So-\n\n213\n00:09:58.938 --> 00:10:00.341\n>> [LAUGH] Stinking school!\n\n214\n00:10:00.341 --> 00:10:01.154\n[LAUGH]\n>> So\n\n215\n00:10:01.154 --> 00:10:03.890\nright here on the screen you can see,\nthere is one VLAN.\n\n216\n00:10:03.890 --> 00:10:07.027\nIt is called default, and\nthat's where all of my ports are.\n\n217\n00:10:07.027 --> 00:10:08.967\nBut there's a few more VLANs\non this screen, right?\n\n218\n00:10:08.967 --> 00:10:11.126\nThere's 1,002 through 1,005.\n\n219\n00:10:11.126 --> 00:10:12.560\nWhat are these guys all about?\n\n220\n00:10:12.560 --> 00:10:13.260\nRight?\n\n221\n00:10:13.260 --> 00:10:17.340\nWell on a brand new Cisco switch, and it\nreally doesn't matter what model you get.\n\n222\n00:10:17.340 --> 00:10:18.700\nThey're all the same.\n\n223\n00:10:18.700 --> 00:10:20.530\nYou actually do have\nfive VLANs by default.\n\n224\n00:10:20.530 --> 00:10:21.610\nAll right?\n\n225\n00:10:21.610 --> 00:10:24.600\nThere's four more VLANs that are created,\nbut\n\n226\n00:10:24.600 --> 00:10:29.450\nyou'll notice their status\nis active/unsupported.\n\n227\n00:10:29.450 --> 00:10:29.990\nAll right?\n\n228\n00:10:29.990 --> 00:10:33.425\nThat's kind of an odd little thing to say\nunsupported when they're right here on\n\n229\n00:10:33.425 --> 00:10:35.052\nthe screen like they're supported.\n\n230\n00:10:35.052 --> 00:10:37.048\nAnd there's no port assigned to them.\n\n231\n00:10:37.048 --> 00:10:38.802\nSee how the port area over here is empty.\n\n232\n00:10:38.802 --> 00:10:41.427\nSo, why are these guys even here?\n\n233\n00:10:41.427 --> 00:10:44.011\nWell, the reason they're\nhere is these are VLANs,\n\n234\n00:10:44.011 --> 00:10:46.890\nspecial VLANs that were created\nby Cisco back in the day.\n\n235\n00:10:46.890 --> 00:10:50.340\nBack in the early 1990s, so\nwe're talking 20 years ago.\n\n236\n00:10:50.340 --> 00:10:52.910\nAnd it was to support\nparticular technologies.\n\n237\n00:10:52.910 --> 00:10:54.705\nAnd you can kinda see\nthe technologies here.\n\n238\n00:10:54.705 --> 00:10:57.566\nToken-ring and fddi, fiberoptics.\n\n239\n00:10:57.566 --> 00:11:01.490\nAnd fddi and token-ring are kind of,\n\n240\n00:11:01.490 --> 00:11:05.330\nI know there's still some people\nthat use fddi today, but not many.\n\n241\n00:11:05.330 --> 00:11:09.260\nAnd token-ring is by and\nlarge completely dead in today's world.\n\n242\n00:11:09.260 --> 00:11:12.670\nSo these are really designed\nto support older technologies.\n\n243\n00:11:12.670 --> 00:11:17.500\nMy switch, the switch that I'm on,\ndoesn't have any fddi ports.\n\n244\n00:11:17.500 --> 00:11:19.540\nIn fact, I don't think you\ncan even buy those anymore.\n\n245\n00:11:19.540 --> 00:11:22.880\nI could be wrong, but on normal switches,\nI'm not aware of any.\n\n246\n00:11:22.880 --> 00:11:25.630\nAnd then token-ring, my switch\ndefinitely doesn't support token-ring.\n\n247\n00:11:25.630 --> 00:11:29.680\nSo Cisco reserved these VLANs and\nnow they're not used.\n\n248\n00:11:29.680 --> 00:11:31.340\nThey're unsupported.\n\n249\n00:11:31.340 --> 00:11:34.260\nBut if this switch doesn't support it,\n\n250\n00:11:34.260 --> 00:11:36.430\nwhat if I still have an old\nswitch on my network?\n\n251\n00:11:36.430 --> 00:11:39.990\nI might have an old switch on my network\nsomewhere that's still using these.\n\n252\n00:11:39.990 --> 00:11:42.690\nAnd so what Cisco does is they\nsay better safe than sorry.\n\n253\n00:11:42.690 --> 00:11:46.255\nWe're just gonna reserve those VLANs and\nblock them off on all of our switches.\n\n254\n00:11:46.255 --> 00:11:48.055\nAnd that way if you've\nstill got the old stuff,\n\n255\n00:11:48.055 --> 00:11:51.110\nyou'll be okay we won't\noverlap our VLAN numbers.\n\n256\n00:11:51.110 --> 00:11:52.860\nAnd if you don't have the old stuff,\n\n257\n00:11:52.860 --> 00:11:55.630\nthere's plenty of other numbers\nout there for us to use, right.\n\n258\n00:11:55.630 --> 00:12:00.527\nI'm using VLAN 1 and then we skip\nall the way to 1002 through 1005.\n\n259\n00:12:00.527 --> 00:12:04.136\nI still have VLAN 2, VLAN 3, VLAN 4,\n\n260\n00:12:04.136 --> 00:12:08.603\nall the way up to VLAN 1000 and then 1001.\n\n261\n00:12:08.603 --> 00:12:11.040\nI've got a ton of VLAN numbers.\n\n262\n00:12:11.040 --> 00:12:13.310\nAnd they're all available for me to use.\n\n263\n00:12:13.310 --> 00:12:17.750\nNow, you might be thinking how many\nVLANs am I actually going to use?\n\n264\n00:12:17.750 --> 00:12:20.000\nHow many times do I need\nto divide my network?\n\n265\n00:12:20.000 --> 00:12:22.210\nAnd there's no good clean answer for that.\n\n266\n00:12:22.210 --> 00:12:23.670\nIt's kinda up to you.\n\n267\n00:12:23.670 --> 00:12:27.940\nCisco has this kinda like rule of thumb\nthat no one switch should really have more\n\n268\n00:12:27.940 --> 00:12:31.590\nthan 16 VLANs on it, but\nit's not gonna stop you from doing it.\n\n269\n00:12:31.590 --> 00:12:35.770\nAnd, when I say 16 VLANs, I mean VLANs\nthat you actually have ports assigned to,\n\n270\n00:12:35.770 --> 00:12:37.620\nand that is just a rule of thumb.\n\n271\n00:12:37.620 --> 00:12:41.890\nIt's not a set fast rule I've used\nswitches with over a hundred VLANs with\n\n272\n00:12:41.890 --> 00:12:43.250\nport assignments on them.\n\n273\n00:12:43.250 --> 00:12:45.126\nThe Cisco switches handle it great.\n\n274\n00:12:45.126 --> 00:12:46.785\nIt's really more of\na management side of things.\n\n275\n00:12:46.785 --> 00:12:49.629\nGets kind of confusing remembering\nwhat ports are in what VLANs.\n\n276\n00:12:49.629 --> 00:12:51.847\nAnd that's why we have output like this.\n\n277\n00:12:51.847 --> 00:12:54.561\nBut, I know one of\nthe things that was hard for\n\n278\n00:12:54.561 --> 00:12:59.350\nme when I was learning this was, all\nright, well, if I have a 48 port switch,\n\n279\n00:12:59.350 --> 00:13:01.949\nwhy would I ever need more than 24 VLANs?\n\n280\n00:13:01.949 --> 00:13:03.368\nIf you think about it,\n\n281\n00:13:03.368 --> 00:13:07.498\nwhat good is a VLAN if there's\nonly one computer plugged into it?\n\n282\n00:13:07.498 --> 00:13:09.055\nNot much good, right?\n\n283\n00:13:09.055 --> 00:13:10.169\nYou're trying to gather computers.\n\n284\n00:13:10.169 --> 00:13:12.801\n>> [LAUGH]\n>> So, we might have a VLAN with two\n\n285\n00:13:12.801 --> 00:13:16.509\nports, so we isolate these two computers\nso they can talk to each other privately\n\n286\n00:13:16.509 --> 00:13:19.029\nbut it's pretty rare that\nthey have a VLAN of one port.\n\n287\n00:13:19.029 --> 00:13:23.672\nI mean maybe you got some super\nrisky computer, a honey pot, right?\n\n288\n00:13:23.672 --> 00:13:26.723\nAnd you want to expose that to\nthe Internet and keep it isolated,\n\n289\n00:13:26.723 --> 00:13:29.562\nso you put one computer in that VLAN and\nthat's what you do.\n\n290\n00:13:29.562 --> 00:13:32.276\nSo, even going with that model,\nif I have a 48-port switch,\n\n291\n00:13:32.276 --> 00:13:33.904\nwhy would I need more than 48 VLANs?\n\n292\n00:13:33.904 --> 00:13:37.231\nWell, I might have 48 VLANs on one switch,\nbut\n\n293\n00:13:37.231 --> 00:13:41.100\nI might have other switches\nin my organization.\n\n294\n00:13:41.100 --> 00:13:45.970\nAnd I might not want to reuse VLAN\nnumbers, to keep things straight.\n\n295\n00:13:45.970 --> 00:13:49.117\nSo, on this switch,\nI might have VLANs 1 through 48.\n\n296\n00:13:49.117 --> 00:13:52.171\nAnd then on the next switch,\nI might go 49 through 98.\n\n297\n00:13:52.171 --> 00:13:54.760\nAnd then on the next switch\nI go 99 through whatever,\n\n298\n00:13:54.760 --> 00:13:56.190\nmy math starts to breakdown.\n\n299\n00:13:56.190 --> 00:13:59.163\nBut, just kind of assigning out\n48 ports to each switch and\n\n300\n00:13:59.163 --> 00:14:00.971\nnever reusing the same VLAN number,\n\n301\n00:14:00.971 --> 00:14:04.553\nthat way in my documentation I can\nkeep it straight and kind of remember.\n\n302\n00:14:04.553 --> 00:14:08.403\nSo, that's why we have such a big\nspace here to use VLANs and\n\n303\n00:14:08.403 --> 00:14:10.564\nwe got a thousand numbers there.\n\n304\n00:14:10.564 --> 00:14:14.375\nThat's a lot of space.\n>> Now, Don, I'm not the Cisco wizard at\n\n305\n00:14:14.375 --> 00:14:19.123\nthou art, but I could swear I\nhave seen VLAN numbers that\n\n306\n00:14:19.123 --> 00:14:23.284\nare well above that 1,005 marker.\n\n307\n00:14:23.284 --> 00:14:26.309\n>> There are plenty of times that\nwe see numbers that are above that.\n\n308\n00:14:26.309 --> 00:14:29.524\nIf you go through and read in\nthe textbooks and a lot of standards,\n\n309\n00:14:29.524 --> 00:14:33.630\nyou'll oftentimes see what I mentioned\nthat the VLAN number is a 12 byte number.\n\n310\n00:14:33.630 --> 00:14:39.008\nAnd as a 12 byte number,\nit can actually be 1 through 4,090,\n\n311\n00:14:39.008 --> 00:14:42.175\ntechnically, 0 through 4,095.\n\n312\n00:14:42.175 --> 00:14:43.256\nThere we go, that's what I mean.\n\n313\n00:14:43.256 --> 00:14:45.797\nComputers they use binary,\nthey start with zeroes.\n\n314\n00:14:45.797 --> 00:14:47.470\nSo, 0 through 4,095.\n\n315\n00:14:47.470 --> 00:14:48.351\nThat's a big number.\n\n316\n00:14:48.351 --> 00:14:52.830\nAnd here I am saying 1 through 1,005,\nso what's that all about?\n\n317\n00:14:52.830 --> 00:14:57.177\nWell, in the earlier Cisco switches,\nyou had standard VLANs.\n\n318\n00:14:57.177 --> 00:15:01.717\nAnd the VLANs ran from 1 to 1001.\n\n319\n00:15:01.717 --> 00:15:05.791\nAnd then 1002 through 1005, were reserved\nfor these technologies that we see today.\n\n320\n00:15:05.791 --> 00:15:08.929\nAnd then on the oldest switches,\n\n321\n00:15:08.929 --> 00:15:13.755\n1006 through 1024, were reserved also.\n\n322\n00:15:13.755 --> 00:15:17.017\nSo, you really just had 1 through 1024,\nbut\n\n323\n00:15:17.017 --> 00:15:21.069\nit was only 1 through 1001\nthat you could actually used.\n\n324\n00:15:21.069 --> 00:15:22.718\nAnd zero you weren't allowed to use.\n\n325\n00:15:22.718 --> 00:15:28.558\nEven today, technically the first and\nthe last VLAN numbers are reserved.\n\n326\n00:15:28.558 --> 00:15:33.242\nSo, when I say that address\nspace is 0 through 4095,\n\n327\n00:15:33.242 --> 00:15:36.695\nwell, it's really 1 through 4094.\n\n328\n00:15:36.695 --> 00:15:39.500\nWe drop the number, we drop the last\nnumber, those are reserved.\n\n329\n00:15:39.500 --> 00:15:43.870\nNow, what about 1006 through 4094?\n\n330\n00:15:43.870 --> 00:15:46.010\nWell, as time went on,\n\n331\n00:15:46.010 --> 00:15:50.470\nCisco was one of the early companies to\nsay, we really need to support more VLANs.\n\n332\n00:15:50.470 --> 00:15:53.569\nWe have some big customers,\nthey've got big needs, we need more VLANs.\n\n333\n00:15:53.569 --> 00:15:57.312\nAnd so,\nthey created this extended VLAN range, and\n\n334\n00:15:57.312 --> 00:16:01.069\nthat's the 1006 all the way through 4094.\n\n335\n00:16:01.069 --> 00:16:06.803\nYou will find some websites that\nsay it's 1,025 through 4,094.\n\n336\n00:16:06.803 --> 00:16:12.304\nIt just depends on whether they flag\nthat 1,006 through 1,024 as reserved.\n\n337\n00:16:12.304 --> 00:16:14.470\nNot everybody does that,\nbut some people do.\n\n338\n00:16:14.470 --> 00:16:18.370\nSo, that extra space is\ncompletely available and\n\n339\n00:16:18.370 --> 00:16:20.370\nfree to be used on Cisco equipment.\n\n340\n00:16:20.370 --> 00:16:24.030\nIf you've got HP or extreme networks or\n\n341\n00:16:24.030 --> 00:16:27.270\nsome of the other guys,\na lot of them support it too.\n\n342\n00:16:27.270 --> 00:16:30.000\nSome of them don't, and so\nif you're worried about that,\n\n343\n00:16:30.000 --> 00:16:32.600\nif you're worried about\ncompatibility it's usually safest\n\n344\n00:16:32.600 --> 00:16:35.530\nto stay under 1000 because you\nknow those will always work.\n\n345\n00:16:35.530 --> 00:16:37.050\nThose will work with everything.\n\n346\n00:16:37.050 --> 00:16:38.000\nIf you go over one thousand,\n\n347\n00:16:38.000 --> 00:16:42.110\nyou start getting into that range you know\nCisco supports, but now you've got to\n\n348\n00:16:42.110 --> 00:16:44.870\ncheck with your third party stuff and\nmake sure they support it too.\n\n349\n00:16:44.870 --> 00:16:47.060\nMost of them do it,\nit's usually pretty safe to do that, but\n\n350\n00:16:47.060 --> 00:16:48.975\nthat's why you see\nnumbers that are higher.\n\n351\n00:16:48.975 --> 00:16:54.850\nAnd, as we look at this output here, when\nI do show VLAN, I see 1,002 through 1,005.\n\n352\n00:16:54.850 --> 00:16:59.970\nI don't really see anything on here\ntelling me about stuff higher, right?\n\n353\n00:16:59.970 --> 00:17:01.590\nSo it's not really showing me that limit.\n\n354\n00:17:01.590 --> 00:17:07.580\nBut if I were to do show VLAN question\nmark, you'll see where I can specify\n\n355\n00:17:07.580 --> 00:17:12.462\nadditional entries here to look\nat a particular VLAN or whatever.\n\n356\n00:17:12.462 --> 00:17:18.450\nAnd so, we can do our brief output,\nour name, and on some of these screens,\n\n357\n00:17:18.450 --> 00:17:22.890\nyou'd actually see where it'll offer\nup to let you pick a VLAN number.\n\n358\n00:17:22.890 --> 00:17:25.780\nLike here where I do show VLAN id number.\n\n359\n00:17:25.780 --> 00:17:29.420\nAnd see how it shows that 1-4094 so\nwe can jump in and\n\n360\n00:17:29.420 --> 00:17:31.070\nlook at that VLAN specifically.\n\n361\n00:17:32.310 --> 00:17:35.570\nAll right so, those are our VLAN numbers.\n\n362\n00:17:35.570 --> 00:17:39.520\nAnd we're welcome to use them and when\nyou create VLANs, when you create these\n\n363\n00:17:39.520 --> 00:17:43.310\nseparate networks you're just assigning\nthese numbers and that's that.\n\n364\n00:17:43.310 --> 00:17:45.210\nBut they're numbers and\nwhen we look at them,\n\n365\n00:17:45.210 --> 00:17:48.140\nthey don't necessarily mean a whole\nheck of a lot to us, right?\n\n366\n00:17:48.140 --> 00:17:50.800\nSo a lot of times we'll\nattach a name to them also.\n\n367\n00:17:50.800 --> 00:17:52.590\nSo for\nexample if I were to go on this switch and\n\n368\n00:17:52.590 --> 00:17:56.870\nstart to create VLANs, I would assign\nthe numbers to actually create the VLAN,\n\n369\n00:17:56.870 --> 00:17:59.310\nand then I would assign names afterwards.\n\n370\n00:17:59.310 --> 00:18:01.040\nNow there's two ways to create VLANs.\n\n371\n00:18:01.040 --> 00:18:07.170\nThe first way, if I jump into config,\nI can just type VLAN 2, and press Enter.\n\n372\n00:18:07.170 --> 00:18:08.240\nPow, I just made a VLAN.\n\n373\n00:18:08.240 --> 00:18:08.980\n>> That was easy.\n\n374\n00:18:08.980 --> 00:18:09.880\n>> Yeah, that easy, right.\n\n375\n00:18:09.880 --> 00:18:10.640\n>> I like that.\n\n376\n00:18:10.640 --> 00:18:13.380\n>> Now, a couple of interesting\nthings about what just happened in\n\n377\n00:18:13.380 --> 00:18:14.560\nthe background, all right?\n\n378\n00:18:14.560 --> 00:18:17.130\nFirst, well,\nwhat just happened in the background?\n\n379\n00:18:17.130 --> 00:18:18.650\nAbsolutely nothing.\n\n380\n00:18:18.650 --> 00:18:19.310\nIt's kind of odd.\n\n381\n00:18:19.310 --> 00:18:21.860\nNormally, you issue a command and\nconfig, and something happens.\n\n382\n00:18:21.860 --> 00:18:23.700\nThis one didn't, okay?\n\n383\n00:18:23.700 --> 00:18:26.625\nThe is the equivalent of\ndoing like interface FA0/1.\n\n384\n00:18:26.625 --> 00:18:31.635\nI got into the interface but\nI haven't actually changed anything.\n\n385\n00:18:31.635 --> 00:18:34.465\nTechnically every VLAN already exists.\n\n386\n00:18:34.465 --> 00:18:36.215\nThey already exist,\nwe're just not using them.\n\n387\n00:18:36.215 --> 00:18:39.310\nSo when I say VLAN 2\nNothing really happens.\n\n388\n00:18:39.310 --> 00:18:43.190\nNow Cisco assumes since I went in to\nit that obviously I want it to work.\n\n389\n00:18:43.190 --> 00:18:48.030\nAnd so when I get out of this prompt,\nthat's when something happens.\n\n390\n00:18:48.030 --> 00:18:52.930\nWhen I exit in the background\nnow it activates that VLAN.\n\n391\n00:18:52.930 --> 00:18:57.010\nNow, I don't see anything dramatic on my\nscreen here, so why do I mention this?\n\n392\n00:18:57.010 --> 00:19:01.640\nSo that on the exam, if you're using\ndo commands to do show vlan or\n\n393\n00:19:01.640 --> 00:19:04.990\nwhatever, and you haven't\nactually exited that VLAN prompt,\n\n394\n00:19:04.990 --> 00:19:07.580\nyou might not be showing\nyour current changes.\n\n395\n00:19:07.580 --> 00:19:09.820\nYou might not actually show what's\nhappened in the background.\n\n396\n00:19:09.820 --> 00:19:14.250\nSo you gotta be really careful with\nthat as you go and set these, all right?\n\n397\n00:19:14.250 --> 00:19:15.870\nNow, that was VLAN two.\n\n398\n00:19:15.870 --> 00:19:19.070\nI could type VLAN 3, and\nnow I created VLAN 3.\n\n399\n00:19:19.070 --> 00:19:22.260\nAnd in here I could do something,\nlike I could say name, and\n\n400\n00:19:22.260 --> 00:19:22.910\nI could give it a name.\n\n401\n00:19:22.910 --> 00:19:24.580\nI'm gonna call this one marketing, right?\n\n402\n00:19:24.580 --> 00:19:26.510\nThis is the VLAN for\nmy marketing department.\n\n403\n00:19:26.510 --> 00:19:31.470\nAnd so I can assign that, or\nI could say, VLAN 4, and give it a name.\n\n404\n00:19:31.470 --> 00:19:33.930\nMaybe this will be my DMZ, right?\n\n405\n00:19:33.930 --> 00:19:36.430\nSo I'm setting those names,\nI'm creating those VLANs.\n\n406\n00:19:37.640 --> 00:19:39.500\nThat's one way to make them, all right?\n\n407\n00:19:39.500 --> 00:19:41.240\nAnother way is to make them on the fly.\n\n408\n00:19:41.240 --> 00:19:49.440\nI can jump into a port, right, so I can\njump into like interface fa1/0/19, okay.\n\n409\n00:19:49.440 --> 00:19:50.300\nOr I'll take maybe 12.\n\n410\n00:19:50.300 --> 00:19:53.480\nThink there's actually something\nplugged into 12, so I'll use that one.\n\n411\n00:19:53.480 --> 00:19:57.730\nSo, if I jump into one of these other\nports, I can just go into the port, and\n\n412\n00:19:57.730 --> 00:20:05.570\nI can say, switchport access VLAN and\nI'll do VLAN 5.\n\n413\n00:20:05.570 --> 00:20:08.820\nOkay now VLAN 5 didn't exist so\n\n414\n00:20:08.820 --> 00:20:12.450\nwhen I run it, it says access VLAN\ndoesn't exist creating VLAN 5.\n\n415\n00:20:12.450 --> 00:20:15.910\nIt's not really creating it, it's just\nturning it on, it already existed.\n\n416\n00:20:15.910 --> 00:20:20.160\nSo it turns it on and now I've got\nVLAN five that's up and operational.\n\n417\n00:20:20.160 --> 00:20:26.040\nSo that's the equivalent of running VLAN\n5, pressing enter and then typing exit.\n\n418\n00:20:26.040 --> 00:20:30.440\nBut it has the added benefit of\nassigning that port to the VLAN, right?\n\n419\n00:20:30.440 --> 00:20:33.910\nIf I do that to a port for\na VLAN that already exists, right?\n\n420\n00:20:33.910 --> 00:20:41.150\nSo, if I jump to port 13 and\nI say switchboard access vlan 2, right?\n\n421\n00:20:41.150 --> 00:20:43.480\nSo it doesn't create the VLAN there,\nit's already made.\n\n422\n00:20:43.480 --> 00:20:46.750\nSo you can make it in advance or\nyou can make it on the fly.\n\n423\n00:20:46.750 --> 00:20:48.120\nWhat's the difference?\n\n424\n00:20:48.120 --> 00:20:51.380\nIf you make it in advance you can\nassign a name, if I make it on the fly,\n\n425\n00:20:51.380 --> 00:20:53.530\nit assigns a dynamic name.\n\n426\n00:20:53.530 --> 00:20:57.190\nSo it's just going to get a generic\nname and it might not be what I want,\n\n427\n00:20:57.190 --> 00:20:59.940\nbut the end result is\nthe VLAN is created the same.\n\n428\n00:20:59.940 --> 00:21:01.770\nIt's up and it's operational.\n\n429\n00:21:01.770 --> 00:21:04.180\nAnd if I get out of my config and\nI do a show VLAN.\n\n430\n00:21:05.440 --> 00:21:08.690\nWell, remember how I ran VLAN two?\n\n431\n00:21:08.690 --> 00:21:12.090\nSo it created VLAN two and\nit gave it a generic name, VLAN0002.\n\n432\n00:21:12.090 --> 00:21:15.340\nAnd it's got four digits because\nit knows that 4,094 is the highest\n\n433\n00:21:15.340 --> 00:21:16.510\none that I might use, all right?\n\n434\n00:21:16.510 --> 00:21:19.510\nSo that's the generic name they made for\nit.\n\n435\n00:21:19.510 --> 00:21:23.260\nVersus the VLAN three and\nfour that have nice names marketing, DMZ.\n\n436\n00:21:23.260 --> 00:21:27.950\nAnd then VLAN 5, that's the one I created\non the fly and it got that generic name.\n\n437\n00:21:27.950 --> 00:21:31.240\nSo I can always jump back into my\nconfig and I can go into VLAN 2 and\n\n438\n00:21:31.240 --> 00:21:33.820\nI can give it a name.\n\n439\n00:21:33.820 --> 00:21:36.190\nMaybe this is my sales department.\n\n440\n00:21:36.190 --> 00:21:41.320\nAnd I can go into VLAN 5 and I can give\nit a name and maybe this is my executive.\n\n441\n00:21:41.320 --> 00:21:43.310\nSweet sir, or whatever, right?\n\n442\n00:21:43.310 --> 00:21:45.870\nSo we get in; we define that, and\n\n443\n00:21:45.870 --> 00:21:51.450\nthen we can do a show VLAN, and now all\nmy VLANs have nice, neat little names.\n\n444\n00:21:51.450 --> 00:21:53.890\nRight, couple things about the name.\n\n445\n00:21:53.890 --> 00:21:56.920\nThere's a limit to how big the names can\nbe you've only got so many characters.\n\n446\n00:21:56.920 --> 00:21:58.950\nI think it's fifteen characters\nif I remember right.\n\n447\n00:21:58.950 --> 00:22:01.130\nSo don't go too crazy long on them.\n\n448\n00:22:01.130 --> 00:22:02.830\nIt doesn't like spaces,\nthat's another thing.\n\n449\n00:22:02.830 --> 00:22:04.820\nIt gets a little angry with that.\n\n450\n00:22:04.820 --> 00:22:08.860\nBut another thing is no one\never sees these except you.\n\n451\n00:22:08.860 --> 00:22:13.015\nThese names, they're just for\nyou as a network admin, you see them.\n\n452\n00:22:13.015 --> 00:22:14.395\nThe end users never see the name.\n\n453\n00:22:14.395 --> 00:22:17.095\nThe end users don't even know they're\non VLAN, they don't see that at all.\n\n454\n00:22:17.095 --> 00:22:19.395\nSo this is just to help\nus keep it straight,\n\n455\n00:22:19.395 --> 00:22:22.885\nwhat was the purpose of this VLAN why\ndid I make that in the first place?\n\n456\n00:22:22.885 --> 00:22:25.532\nSo we'll get it you know that Kinda\nput in there and we'll see it,\n\n457\n00:22:25.532 --> 00:22:27.472\nand we'll know what it's all about.\n\n458\n00:22:27.472 --> 00:22:31.522\nAll right, so that's kind of how we\ncreate VLANs so we can put in place.\n\n459\n00:22:31.522 --> 00:22:33.942\nThere's one more kind of important thing\n\n460\n00:22:33.942 --> 00:22:36.302\nunlike every other change\nthat we make on a switch.\n\n461\n00:22:37.381 --> 00:22:40.721\nWhen we create these VLANs\nit doesn't go in the config.\n\n462\n00:22:40.721 --> 00:22:45.221\nIf I get out of my configuration and\nI do a show running-config and\n\n463\n00:22:45.221 --> 00:22:47.331\nI take a look at my running config, right?\n\n464\n00:22:47.331 --> 00:22:50.541\nLet's just look through here and\nsee if we can find where vlan 2, 3, 4 and\n\n465\n00:22:50.541 --> 00:22:52.401\n5 were created, right?\n\n466\n00:22:52.401 --> 00:22:54.361\nSo here I see my host name.\n\n467\n00:22:54.361 --> 00:22:58.001\nI see some basic other data,\nthere's spanning tree.\n\n468\n00:22:58.001 --> 00:23:01.080\nHere's my vlan allocation policy.\n\n469\n00:23:01.080 --> 00:23:02.960\nNothing too crazy there.\n\n470\n00:23:02.960 --> 00:23:04.440\nI can see I've got some ports configured.\n\n471\n00:23:04.440 --> 00:23:08.410\nThat's great, I can see where ports 12 and\n13 are assigned to vlan 2 and 5.\n\n472\n00:23:08.410 --> 00:23:12.190\nSo if I were to reboot the switch and\nvlan 2 and 5 didn't exist,\n\n473\n00:23:12.190 --> 00:23:14.030\nthat would create them on the fly,\nwouldn't it?\n\n474\n00:23:14.030 --> 00:23:19.170\nI don't see the VLAN names and I don't see\nVLAN 3 and 4 either, where those guys go?\n\n475\n00:23:19.170 --> 00:23:20.680\nKind of missing, right?\n\n476\n00:23:20.680 --> 00:23:23.460\nAnd so\nif I keep looking through my config,\n\n477\n00:23:23.460 --> 00:23:25.570\nI never do see anymore Vlan commands.\n\n478\n00:23:25.570 --> 00:23:28.270\nAll right, so where does that all go?\n\n479\n00:23:28.270 --> 00:23:31.700\nWell, your VLANs are actually stored in\na separate file in which called your VLAN\n\n480\n00:23:31.700 --> 00:23:36.740\ndatabase, and if you take a look at your\nflash, if you want to flash colon or dir.\n\n481\n00:23:36.740 --> 00:23:38.670\nYou can look in there, and in your flash,\n\n482\n00:23:38.670 --> 00:23:42.470\nyou'll see a file called vlan.dat,\nall right?\n\n483\n00:23:42.470 --> 00:23:46.990\nThat's the VLAN database, that where\nyour VLAN configuration is stored.\n\n484\n00:23:46.990 --> 00:23:50.420\nThat's where the names are, that's where\nthe numbers for which ones are active,\n\n485\n00:23:50.420 --> 00:23:51.802\nthat's where those are stored.\n\n486\n00:23:51.802 --> 00:23:54.321\nIt's all right there in the VLAN database.\n\n487\n00:23:54.321 --> 00:23:58.465\nAnd that's why it's important, if you're\never gonna get rid of a switch or\n\n488\n00:23:58.465 --> 00:24:02.937\ndecommission it, You don't just do\nan erase startup-config because that wipes\n\n489\n00:24:02.937 --> 00:24:06.740\nout the config, but\nyour VLAN database is still there.\n\n490\n00:24:06.740 --> 00:24:10.510\nSo it's important that if you're\nimplementing a new switch, or if you're\n\n491\n00:24:10.510 --> 00:24:14.510\ngetting rid of of one of your switches\nthat you do an erase startup-config and\n\n492\n00:24:14.510 --> 00:24:19.770\nthen you do a delete slash\ncolon slash dot VLAN dot dat.\n\n493\n00:24:19.770 --> 00:24:23.450\nGotta delete that database file,\notherwise that configuration comes back.\n\n494\n00:24:23.450 --> 00:24:26.650\nWe're going to talk later about a neat\nprotocol called the VLAN trunking\n\n495\n00:24:26.650 --> 00:24:28.280\nprotocol, or VTP.\n\n496\n00:24:28.280 --> 00:24:32.370\nIt's configuration is also stored in\nthat database including passwords.\n\n497\n00:24:32.370 --> 00:24:35.450\nAnd so that's another reason why it's\ndoubly important to get rid of that\n\n498\n00:24:35.450 --> 00:24:37.500\nwhen you get rid of a switch.\n\n499\n00:24:37.500 --> 00:24:41.237\n>> Now Don, can you upload and download\nthose files, like you can the flash,\n\n500\n00:24:41.237 --> 00:24:43.032\nlike if you were upgrading the iOS?\n\n501\n00:24:43.032 --> 00:24:44.386\n>> You can certainly try.\n\n502\n00:24:44.386 --> 00:24:45.088\n>> You can certainly try.\n\n503\n00:24:45.088 --> 00:24:47.330\n[LAUGH]\n>> It's not a great idea to do that.\n\n504\n00:24:47.330 --> 00:24:50.300\nSo, first off,\nthe VLAN database is different.\n\n505\n00:24:50.300 --> 00:24:55.052\nFor different switches right, because\non this switch I've got 48 ports but\n\n506\n00:24:55.052 --> 00:24:57.942\non another switch I might\nonly have 24 ports.\n\n507\n00:24:57.942 --> 00:25:02.097\nThe VTP configuration that we do might\nbe different on each switch and so\n\n508\n00:25:02.097 --> 00:25:06.880\nyou don't normally wanna copy\nthat VLAN database between them.\n\n509\n00:25:06.880 --> 00:25:09.670\nWell we'll see later on that there's\nanother protocol that we can use to\n\n510\n00:25:09.670 --> 00:25:11.230\nsynchronize the database.\n\n511\n00:25:11.230 --> 00:25:13.050\nWhich eliminates the need to copy, right?\n\n512\n00:25:13.050 --> 00:25:14.590\nSo there is a way to get around that, but\n\n513\n00:25:14.590 --> 00:25:16.430\nyou don't wanna manually\ncopy it yourselves.\n\n514\n00:25:16.430 --> 00:25:17.710\nNot a great idea.\n\n515\n00:25:17.710 --> 00:25:23.200\nYou can back it up, and even restore it\nto a switch, but it's read boot time.\n\n516\n00:25:23.200 --> 00:25:26.440\nAnd so when you reload that database file,\nit doesn't immediately take effect.\n\n517\n00:25:26.440 --> 00:25:28.720\nAnd so\nyou really end up needing to reboot again.\n\n518\n00:25:28.720 --> 00:25:30.830\nAnd sometimes that works,\nsometimes it doesn't.\n\n519\n00:25:30.830 --> 00:25:32.647\nBut usually,\nyou don't mess with that file.\n\n520\n00:25:32.647 --> 00:25:33.820\n>> Okay.\n>> Yep.\n\n521\n00:25:33.820 --> 00:25:36.930\nAll right.\nSo, I do want to mention one other thing.\n\n522\n00:25:36.930 --> 00:25:40.610\nThere's another special kind\nof VLAN that's out there,\n\n523\n00:25:40.610 --> 00:25:42.710\nand it's called a voice VLAN.\n\n524\n00:25:42.710 --> 00:25:46.260\nAnd Cisco has a special set of\ncommands that are available for it.\n\n525\n00:25:46.260 --> 00:25:48.390\nBut at the end of the day it's\nreally just a regular VLAN.\n\n526\n00:25:48.390 --> 00:25:49.420\n>> They're voice commands?\n\n527\n00:25:49.420 --> 00:25:50.928\nWe get to just speak to the switch now?\n\n528\n00:25:50.928 --> 00:25:54.255\n[LAUGH]\n>> That's right, it's like Siri or\n\n529\n00:25:54.255 --> 00:25:55.275\nCortona.\n\n530\n00:25:55.275 --> 00:25:57.225\nSwitch can you work please?\n\n531\n00:25:57.225 --> 00:25:59.931\n[LAUGH]\n>> Can you create those VLAN's for me?\n\n532\n00:25:59.931 --> 00:26:01.990\n>> So.\nWith voice VLANs,\n\n533\n00:26:01.990 --> 00:26:05.800\nthey're special VLANs only in the sense\nthat they're designed for voice traffic.\n\n534\n00:26:05.800 --> 00:26:07.760\nWe might wanna separate our VOIP,\n\n535\n00:26:07.760 --> 00:26:10.760\nour Voice Over IP traffic, to make\nit easier to do quality of service.\n\n536\n00:26:10.760 --> 00:26:13.693\nIf you've ever done quality of service,\nit's kinda hard.\n\n537\n00:26:13.693 --> 00:26:15.001\nCuz what do you have to do?\n\n538\n00:26:15.001 --> 00:26:18.760\nYou have to tell your switches and your\nrouters how to identify the voice traffic.\n\n539\n00:26:18.760 --> 00:26:20.000\nHow do they identify it?\n\n540\n00:26:20.000 --> 00:26:22.810\nThey can look at the protocol\nif they're looking that deep.\n\n541\n00:26:22.810 --> 00:26:24.360\nSwitches don't look that deep.\n\n542\n00:26:24.360 --> 00:26:30.890\nSo they might have a TOS value or\nQOS that you might have a DSCP value set,\n\n543\n00:26:30.890 --> 00:26:34.370\nsomething that lets the switch quickly\nidentify oh this is voice traffic and\n\n544\n00:26:34.370 --> 00:26:37.270\nI need to give it priority\nover other traffic.\n\n545\n00:26:37.270 --> 00:26:40.180\nWell that's challenging if we have\nto actually look at the data because\n\n546\n00:26:40.180 --> 00:26:42.890\nnormally a switch just looks\nat the layer two data,\n\n547\n00:26:42.890 --> 00:26:45.920\nsource map, destination map,\nthat's all it looks at, right.\n\n548\n00:26:45.920 --> 00:26:48.180\nBut if we have a designated VLAN just for\n\n549\n00:26:48.180 --> 00:26:53.880\nvoice traffic, then we can say any\ntraffic on this VLAN gets priority.\n\n550\n00:26:53.880 --> 00:26:55.220\nNow we don't have to look\nat the packets at all.\n\n551\n00:26:55.220 --> 00:26:59.350\nI don't care what the packet is,\nif it's on this VLAN it gets priority.\n\n552\n00:26:59.350 --> 00:27:00.870\nSo it makes QoS super simple.\n\n553\n00:27:01.920 --> 00:27:05.130\nAnd so that's why Cisco kinda\nspecifically calls out these vice VLANs,\n\n554\n00:27:05.130 --> 00:27:07.020\ncuz of how simple they make things.\n\n555\n00:27:07.020 --> 00:27:11.280\nWell at the end of the day a voice\nVLAN really is just a regular VLAN.\n\n556\n00:27:11.280 --> 00:27:17.270\nThe big difference is, normally a physical\nport on your switch is tied to one VLAN,\n\n557\n00:27:17.270 --> 00:27:21.770\nbut with a voice VLAN you might\nhave one of those phones where\n\n558\n00:27:21.770 --> 00:27:25.940\nit’s got two network jacks on it and\nso your phone plugs into the wall and\n\n559\n00:27:25.940 --> 00:27:29.470\nthen your PC plugs into the phone,\nyou daisy chain off of the phone.\n\n560\n00:27:29.470 --> 00:27:32.830\nWell I want the phone to\nbe on the voice VLAN.\n\n561\n00:27:32.830 --> 00:27:36.129\nAnd I want my PC to be on my data VLAN.\n\n562\n00:27:36.129 --> 00:27:39.360\nHow do I do that if they're plugged\ninto the same port on the switch?\n\n563\n00:27:39.360 --> 00:27:42.140\nIt's a voice VLAN that does that, okay?\n\n564\n00:27:42.140 --> 00:27:43.990\nLet me show you how that kinda works.\n\n565\n00:27:43.990 --> 00:27:47.200\nI'm gonna take my VLAN 5, right?\n\n566\n00:27:47.200 --> 00:27:50.300\nI'm gonna change it's name and\nI'm gonna call it VOIP.\n\n567\n00:27:50.300 --> 00:27:50.850\nRight.\n\n568\n00:27:50.850 --> 00:27:53.680\nHere I'll actually do it proper,\nthere we go.\n\n569\n00:27:53.680 --> 00:27:56.940\nSo that's gonna be my voice VLAN.\n\n570\n00:27:56.940 --> 00:28:01.130\nAnd if I do a show a VLAN and take a look\nat what I've got created on this one.\n\n571\n00:28:01.130 --> 00:28:07.825\nYou can see that I've got that void VLAN\nand I've got port Fa1/0/12 assigned to it.\n\n572\n00:28:07.825 --> 00:28:10.996\nNow that whole port is on that voice VLAN,\nso\n\n573\n00:28:10.996 --> 00:28:15.400\nif I plug my PC into my phone,\nmy PC is on the voice VLAN.\n\n574\n00:28:15.400 --> 00:28:16.630\nMy PC is gonna get prioritized.\n\n575\n00:28:16.630 --> 00:28:18.590\nNow as an end user I like that.\n\n576\n00:28:18.590 --> 00:28:19.670\nThat's a good thing.\n\n577\n00:28:19.670 --> 00:28:21.560\nAs a network admin we don't like that.\n\n578\n00:28:21.560 --> 00:28:22.900\nThat's not what we wanted.\n\n579\n00:28:22.900 --> 00:28:24.390\nWe need it to be separate.\n\n580\n00:28:24.390 --> 00:28:28.840\nNow when I put that port into VLAN 5.\n\n581\n00:28:28.840 --> 00:28:30.490\nI use the switchboard command.\n\n582\n00:28:30.490 --> 00:28:33.660\nI'm going to move that port over to sales.\n\n583\n00:28:33.660 --> 00:28:37.720\nSo I'm going to get back into fa\none slash zero slash twelve and\n\n584\n00:28:37.720 --> 00:28:39.440\nwe'll say it's a sales person.\n\n585\n00:28:39.440 --> 00:28:46.264\nSo i'm going to move their port by\nsaying switchport access VLAN 2.\n\n586\n00:28:46.264 --> 00:28:48.230\nRight, so now they're in VLAN 2.\n\n587\n00:28:48.230 --> 00:28:53.290\nThat's where they are and\nif I do a show VLAN and\n\n588\n00:28:53.290 --> 00:28:58.400\njust take a look at it, I'll see that,\nthat port is now right here.\n\n589\n00:28:58.400 --> 00:28:59.780\nOn VLAN 2, okay?\n\n590\n00:29:00.780 --> 00:29:02.970\nBut I need the phone to be on my voice.\n\n591\n00:29:02.970 --> 00:29:05.730\nI need the phone on VLAN 5, all right?\n\n592\n00:29:05.730 --> 00:29:06.660\nSo, to do that.\n\n593\n00:29:06.660 --> 00:29:11.000\nRight here in the same port,\nI just issues, switch ports.\n\n594\n00:29:11.000 --> 00:29:11.810\nVoice.\n\n595\n00:29:11.810 --> 00:29:13.950\nIt was switchboard access a moment ago.\n\n596\n00:29:13.950 --> 00:29:17.200\nNow switchboard voice VLAN five.\n\n597\n00:29:17.200 --> 00:29:21.945\nAlright, now the port is one two different\n\n598\n00:29:21.945 --> 00:29:27.340\nVLAN and it gets very weird\nbecause if I do a show VLAN.\n\n599\n00:29:27.340 --> 00:29:29.980\nAnd take a look at it, right.\n\n600\n00:29:29.980 --> 00:29:35.100\nI can see on sales right there\ni've got FA 1 slash 0 slash 12.\n\n601\n00:29:35.100 --> 00:29:39.010\nAnd then down here on VOIP I\ngot FA 1 slash 0 slash 12.\n\n602\n00:29:39.010 --> 00:29:41.030\nIt's showing up on two\nVLAN's at the same time.\n\n603\n00:29:42.200 --> 00:29:44.870\nOne for voice, and one for data.\n\n604\n00:29:44.870 --> 00:29:51.424\nAnd if I look how that made it into the\nconfig I can pull that up if I can type.\n\n605\n00:29:51.424 --> 00:29:53.145\n>> I don't think that was a valid command.\n\n606\n00:29:53.145 --> 00:29:54.640\n>> [LAUGH] It's a new port type.\n\n607\n00:29:54.640 --> 00:29:56.110\n>> You're gonna love it.\n\n608\n00:29:56.110 --> 00:29:59.860\n>> So I can see right here to retain\nthose commands, I got VLAN two and five.\n\n609\n00:29:59.860 --> 00:30:04.358\nSo now I'm on two different ones at\nthe same time, and if I plug a Cisco VoIP\n\n610\n00:30:04.358 --> 00:30:08.225\nphone in, the Cisco phone is gonna\nsay voice data on VLAN five.\n\n611\n00:30:08.225 --> 00:30:11.620\nThis PC that's plugged into me,\nI'm gonna stick them on VLAN two.\n\n612\n00:30:11.620 --> 00:30:13.760\nAnd so the phone takes care\nof separating that data and\n\n613\n00:30:13.760 --> 00:30:17.110\nmaking sure the phone gets prioritized and\nnot the PC.\n\n614\n00:30:17.110 --> 00:30:19.130\nAnd so now we kind of achieve that goal.\n\n615\n00:30:19.130 --> 00:30:21.135\nIf we have Cisco phones.\n\n616\n00:30:21.135 --> 00:30:25.195\n>> I was gonna say Don, this seems very\nmuch like trunking, to be honest with you.\n\n617\n00:30:25.195 --> 00:30:27.325\n>> It's a limited form of trunking, right?\n\n618\n00:30:27.325 --> 00:30:30.655\nSo normally when you trunk, if you don't\nknow what trunk is, well shame on you.\n\n619\n00:30:30.655 --> 00:30:32.524\nYou should have passed the CCNA, but-\n>> [LAUGH]\n\n620\n00:30:32.524 --> 00:30:34.554\n>> But a trunk is just when we send more\n\n621\n00:30:34.554 --> 00:30:37.634\nthan one VLAN over the same\nsame interface, right?\n\n622\n00:30:37.634 --> 00:30:39.100\nAnd that's what I'm doing here.\n\n623\n00:30:39.100 --> 00:30:41.450\nI'm sending VLAN two and\nfive over the same interface.\n\n624\n00:30:42.450 --> 00:30:44.290\nSo why do I say it's limited?\n\n625\n00:30:44.290 --> 00:30:47.380\nI'm only sending VLANS two and five.\n\n626\n00:30:47.380 --> 00:30:48.850\nWhat about VLAN three and four?\n\n627\n00:30:48.850 --> 00:30:49.880\nI'm not sending those.\n\n628\n00:30:49.880 --> 00:30:53.950\nIf I create a trunk,\na trunk by default sends all VLAN's.\n\n629\n00:30:53.950 --> 00:30:55.720\nThis one only sends two.\n\n630\n00:30:55.720 --> 00:30:58.280\nAnd so\nthe phone on the other side only sees two,\n\n631\n00:30:58.280 --> 00:31:01.880\nand a Cisco phone will know which\none is voice and which one is data.\n\n632\n00:31:01.880 --> 00:31:03.700\nIt learns it via CDP from the switch.\n\n633\n00:31:04.760 --> 00:31:10.240\nIf I plug a third party phone it,\nif I plug a Microtel or Polycom or\n\n634\n00:31:10.240 --> 00:31:15.160\nsomebody like that, it see's the VLAN's\nbut it doesn't know which is which.\n\n635\n00:31:15.160 --> 00:31:18.438\nAnd so you actually have to go into\nthe configuration and tell it, okay,\n\n636\n00:31:18.438 --> 00:31:20.609\nvoice data on VLAN5,\nregular data on VLAN2.\n\n637\n00:31:20.609 --> 00:31:21.720\nYou tell it that.\n\n638\n00:31:21.720 --> 00:31:26.380\nAnd it sees the link as a trunk,\nit'll see it as a 802.1Q trunk and\n\n639\n00:31:26.380 --> 00:31:27.590\nit just sees it as that.\n\n640\n00:31:27.590 --> 00:31:32.336\nBut it's only carrying two VLANs, so\nmuch more limited form of a trunk.\n\n641\n00:31:32.336 --> 00:31:34.720\nAll right, and\nwe're gonna talk more about trunks.\n\n642\n00:31:34.720 --> 00:31:36.120\nI know we're outta time on this episode.\n\n643\n00:31:36.120 --> 00:31:37.365\nDaniel's giving me the evil eye over here.\n\n644\n00:31:37.365 --> 00:31:38.700\n>> [LAUGH]\n>> So I need to wrap it up.\n\n645\n00:31:38.700 --> 00:31:40.520\nBut I definitely wanna\ntalk about trunks and\n\n646\n00:31:40.520 --> 00:31:43.190\nhow we can extend VLANs between switches.\n\n647\n00:31:43.190 --> 00:31:44.460\nSo let's do this.\n\n648\n00:31:44.460 --> 00:31:46.560\nLet's do a part two on this one.\n\n649\n00:31:46.560 --> 00:31:49.530\nAnd we'll continue on our VLANs and\n\n650\n00:31:49.530 --> 00:31:52.300\nstart to see how to exchange that\ninformation between the switches.\n\n651\n00:31:52.300 --> 00:31:55.496\nAnd, I definitely want to touch on\nsynchronizing that VLAN.DAT file like\n\n652\n00:31:55.496 --> 00:31:56.925\nyour were mentioning, Daniel.\n\n653\n00:31:56.925 --> 00:31:57.440\n>> Mm-hm.\n\n654\n00:31:57.440 --> 00:31:59.130\n>> Without doing the risky copy operation.\n\n655\n00:31:59.130 --> 00:32:00.870\nSo, we'll get a chance to see that too.\n\n656\n00:32:00.870 --> 00:32:02.690\nWe'll just have to make room for\nit in another episode.\n\n657\n00:32:02.690 --> 00:32:05.670\n>> That's right, hopefully we'll see you\nguys in that episode as for this one,\n\n658\n00:32:05.670 --> 00:32:07.050\nwe're gonna go ahead and wrap it up.\n\n659\n00:32:07.050 --> 00:32:11.230\nThanks for watching, signing off for ITPro\nTV I've been your host, Daniel Lowrie.\n\n660\n00:32:11.230 --> 00:32:12.080\n>> And I'm Don Pezet.\n\n661\n00:32:12.080 --> 00:32:14.212\n>> We'll see you next time.\n\n662\n00:32:14.212 --> 00:32:20.070\n[MUSIC]\n\n",
          "vimeoId": "141587039"
        },
        {
          "description": "In this episode, Daniel and Don continue explaining switch configuration, here specifically detailing the different ways in which you can create a trunk link between switches. They start off with explaining the Dynamic Trunking Protocol (DTP) to set up auto trunking and then move into manual trunking methods for more control.",
          "length": "1837",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_pt2-092915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_pt2-092915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_pt2-092915-1-sm.jpg",
          "title": "VLANs and Trunking Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.697 --> 00:00:16.620\nAll right, greetings everyone and welcome\nto another great episode of IT Pro TV.\n\n3\n00:00:16.620 --> 00:00:17.820\nI'm your host Daniel Lowry.\n\n4\n00:00:17.820 --> 00:00:19.850\nHere with me yet again, Mr. Don Pezet.\n\n5\n00:00:19.850 --> 00:00:21.290\nHow's it going Don?\n\n6\n00:00:21.290 --> 00:00:24.020\n>> It is going great Daniel,\nexcited to be back on the show and\n\n7\n00:00:24.020 --> 00:00:27.100\nready to continue on with\npart two of our VLAN and\n\n8\n00:00:27.100 --> 00:00:30.390\ntrunking episode that we started well,\nyou know, earlier.\n\n9\n00:00:30.390 --> 00:00:33.310\nWe go in to VLAN, we talked a little\nbit about how they were used.\n\n10\n00:00:33.310 --> 00:00:35.660\nI showed you guys how\nto configure them and\n\n11\n00:00:35.660 --> 00:00:38.830\nsome of the little, I don't know,\nthings to know there.\n\n12\n00:00:38.830 --> 00:00:41.920\nBut, one of the big challenges that we're\ngonna have is if your network is big\n\n13\n00:00:41.920 --> 00:00:47.560\nenough to need more than,\nto need VLAN in general,\n\n14\n00:00:47.560 --> 00:00:51.820\nit probably means that your network is big\nenough that you got more than one switch.\n\n15\n00:00:51.820 --> 00:00:55.100\nAnd Daniel, in the last episode,\nyou had brought up that all this VLAN\n\n16\n00:00:55.100 --> 00:00:59.010\nstuff is getting stored in that one\nconfiguration by the VLAN.dat file and.\n\n17\n00:00:59.010 --> 00:01:02.470\nWhat if I want the configuration to\nbe present on more than one switch.\n\n18\n00:01:02.470 --> 00:01:05.140\nI need some way to share\nVLANS between the switch.\n\n19\n00:01:05.140 --> 00:01:08.240\nAnd so that's what we're gonna\ntake a look at in this episode.\n\n20\n00:01:08.240 --> 00:01:10.970\nHow do we get that VLAN data\nto cross between systems?\n\n21\n00:01:10.970 --> 00:01:13.130\nHow do we get it to be\npresent where we need it?\n\n22\n00:01:14.490 --> 00:01:15.470\n>> Proliferate.\n\n23\n00:01:15.470 --> 00:01:19.380\n>> Yeah, and be able to do it safely right\nbecause I mentioned the dangers of copying\n\n24\n00:01:19.380 --> 00:01:20.630\nthe VLAN.dat file and stop.\n\n25\n00:01:20.630 --> 00:01:23.330\nSo, let's start with the traffic, and\n\n26\n00:01:23.330 --> 00:01:26.500\nthen we'll get to the configuration\nafterwards, right, so the traffic.\n\n27\n00:01:26.500 --> 00:01:32.040\nIf I've got five VLANs, I could have\nall those VLANs present on one switch.\n\n28\n00:01:32.040 --> 00:01:33.650\nRight, that's what we\ndid in the last show.\n\n29\n00:01:33.650 --> 00:01:36.216\nAnd in fact, here,\nlet's bring up my switch and\n\n30\n00:01:36.216 --> 00:01:38.105\nI'll kinda recap where we're at.\n\n31\n00:01:38.105 --> 00:01:42.088\nSo in the last show, we created\na couple of VLANs, VLANs two, three,\n\n32\n00:01:42.088 --> 00:01:43.584\nfour, and five, right?\n\n33\n00:01:43.584 --> 00:01:45.300\nSales, marketing DMZ, VoIP.\n\n34\n00:01:45.300 --> 00:01:48.240\nThese are some of the VLANs that I made,\nright?\n\n35\n00:01:48.240 --> 00:01:51.000\nI threw a couple of ports in there just\nto kinda have fun and that was that.\n\n36\n00:01:51.000 --> 00:01:55.490\nNow these VLANs exist\nright here on this switch.\n\n37\n00:01:55.490 --> 00:01:58.030\nBut I've got more than one\nswitch floating around, right.\n\n38\n00:01:58.030 --> 00:01:59.860\nSo I did that right here on NYCORE1.\n\n39\n00:01:59.860 --> 00:02:04.730\nWhat if I want VLANS two, three,\nfour, and five over here on CORE2?\n\n40\n00:02:04.730 --> 00:02:07.530\nAnd what if I want VLANS two, three,\nfour, and five down here on ACCESS1?\n\n41\n00:02:07.530 --> 00:02:10.310\nIf I just go to those switches and\n\n42\n00:02:10.310 --> 00:02:13.580\nstart to create those VLANS\nthere They're separate VLANs.\n\n43\n00:02:13.580 --> 00:02:16.990\nThat's their own VLAN,\non the other side, they're isolated.\n\n44\n00:02:16.990 --> 00:02:18.990\nSo I need to do two things.\n\n45\n00:02:18.990 --> 00:02:21.750\nFirst off, I need to get\nthe traffic over there, right?\n\n46\n00:02:21.750 --> 00:02:24.130\nThat's what's gonna link\nthese two things together.\n\n47\n00:02:24.130 --> 00:02:27.340\nAnd then, secondly, I need to make sure\nthe VLAN configuration on the other\n\n48\n00:02:27.340 --> 00:02:30.480\nside is identical to mine so\nwe all know about the same VLANs, right?\n\n49\n00:02:30.480 --> 00:02:32.950\nSo we've gotta get that put in place.\n\n50\n00:02:32.950 --> 00:02:36.950\nOn the traffic side we\nachieve that with a trunk.\n\n51\n00:02:36.950 --> 00:02:40.550\nA normal interface on a switch\nis called an access interface.\n\n52\n00:02:40.550 --> 00:02:44.100\nAnd an access interface is on one VLAN and\none VLAN only.\n\n53\n00:02:44.100 --> 00:02:45.460\nAnd that's what we see with computers.\n\n54\n00:02:45.460 --> 00:02:47.900\nSo I've got this computer plugged\ninto FA0/1 on this switch.\n\n55\n00:02:47.900 --> 00:02:51.490\nIt's on one VLAN, that's what I want.\n\n56\n00:02:51.490 --> 00:02:54.450\nBut when I have a link\nrunning between two switches,\n\n57\n00:02:54.450 --> 00:02:57.020\nI might want it to carry\nmore than one VLAN.\n\n58\n00:02:57.020 --> 00:03:00.610\nAnd we do that with trunking and\nCisco switch actually do it automatically.\n\n59\n00:03:00.610 --> 00:03:04.760\nCisco switch has run a technology\ncalled Dynamic Trunking Protocol and\n\n60\n00:03:04.760 --> 00:03:08.860\nDTP will allow the switches\nautomatically set up a trunk.\n\n61\n00:03:08.860 --> 00:03:12.740\nNow I say it's automatic, sometimes\nit's automatic, sometimes it's not.\n\n62\n00:03:12.740 --> 00:03:16.340\nLet me show how it works,\nit kind of depends on the switch.\n\n63\n00:03:16.340 --> 00:03:21.880\nSo, taking a look at this switch,\nI want to look at a, an individual port.\n\n64\n00:03:21.880 --> 00:03:26.170\nSo if I take a look at these two\nconnections here, between core 1 and\n\n65\n00:03:26.170 --> 00:03:29.960\ncore 2, right, so it's port 23 between\nboth of these switches, and port 24.\n\n66\n00:03:29.960 --> 00:03:33.400\nI wanna make those trunks, trunks\nbetween these two switches, all right.\n\n67\n00:03:33.400 --> 00:03:36.840\nWell, to set that up,\nI don't really have to do much\n\n68\n00:03:36.840 --> 00:03:40.370\nif they're gonna automatically\nbecome a trunk for me, right?\n\n69\n00:03:40.370 --> 00:03:49.110\nSo if I jump over here and\nI do a show run interface fa1/0/23 and 24.\n\n70\n00:03:49.110 --> 00:03:52.450\nRight now I've got those ports\nhard set as an access port.\n\n71\n00:03:52.450 --> 00:03:55.990\nAnd as an access port they're\non one VLAN and one VLAN only.\n\n72\n00:03:55.990 --> 00:04:00.000\nAnd I haven't designated a VLAN number,\nso that means they're on VLAN 1,\n\n73\n00:04:00.000 --> 00:04:01.140\nthat's the default.\n\n74\n00:04:01.140 --> 00:04:04.590\nIf it said switchport access VLAN and\n\n75\n00:04:04.590 --> 00:04:06.100\na number then it'd be on a different VLAN,\nright?\n\n76\n00:04:06.100 --> 00:04:07.800\nBut this one is just on VLAN 1.\n\n77\n00:04:07.800 --> 00:04:11.790\nAnd they're hard set as access, so\nthat's how they're gonna function.\n\n78\n00:04:11.790 --> 00:04:14.640\nBut, I'm gonna remove that hard setting,\nokay?\n\n79\n00:04:14.640 --> 00:04:17.360\nSo if I jump into my configuration and\nI get into fa1/0/23, or\n\n80\n00:04:17.360 --> 00:04:20.670\nwe can do them at the same time, right?\n\n81\n00:04:20.670 --> 00:04:26.060\nIf I use my good old range command,\nand jump into both of them.\n\n82\n00:04:26.060 --> 00:04:32.407\nAnd I'm gonna say no\nswitchboard mode access.\n\n83\n00:04:32.407 --> 00:04:35.390\nOkay, when I do that, what happens?\n\n84\n00:04:35.390 --> 00:04:42.280\nWell, if I look at the configuration,\nI can see now the configuration for\n\n85\n00:04:42.280 --> 00:04:45.660\nthat interface is absolutely nothing,\nit's at all the defaults.\n\n86\n00:04:45.660 --> 00:04:50.210\nAll right and by default DTP,\nthe dynamic trunking protocol,\n\n87\n00:04:50.210 --> 00:04:51.100\nis running on that interface.\n\n88\n00:04:51.100 --> 00:04:53.590\nAll right, so\nam I trunking to my other switch?\n\n89\n00:04:54.590 --> 00:04:56.010\nMaybe, right?\n\n90\n00:04:56.010 --> 00:05:00.110\nProbably not because the other\nswitch is set to access also.\n\n91\n00:05:00.110 --> 00:05:03.110\nSo I'm gonna jump over\nto my other switch and,\n\n92\n00:05:03.110 --> 00:05:04.890\nI'll do basically the same\nthing on this one, right?\n\n93\n00:05:04.890 --> 00:05:06.250\nSo, whoops,\nI'll get into my configuration,\n\n94\n00:05:06.250 --> 00:05:11.410\nI'll get into those same\nports on this side.\n\n95\n00:05:11.410 --> 00:05:17.210\nAnd I'm gonna go in here and say,\nno switchport mode access, okay.\n\n96\n00:05:17.210 --> 00:05:20.160\nSo now we've got the defaults.\n\n97\n00:05:20.160 --> 00:05:22.280\nDynamic trunking protocol is running.\n\n98\n00:05:22.280 --> 00:05:24.420\nAm I gonna build a trunk\nbetween these switches?\n\n99\n00:05:24.420 --> 00:05:25.805\nThe answer is maybe.\n\n100\n00:05:25.805 --> 00:05:27.020\n>> [LAUGH]\n>> You gotta love that.\n\n101\n00:05:27.020 --> 00:05:27.860\n>> I love that answer.\n\n102\n00:05:27.860 --> 00:05:29.367\nAbsolutely, the positively, maybe.\n\n103\n00:05:29.367 --> 00:05:33.740\n[LAUGH]\n>> So the reason it's a maybe is because\n\n104\n00:05:33.740 --> 00:05:36.940\nsome switches will\nautomatically build a trunk.\n\n105\n00:05:38.240 --> 00:05:44.630\nOther switches will only automatically\nbuild a trunk if somebody else asks.\n\n106\n00:05:44.630 --> 00:05:46.810\nThere's two different states for DTP.\n\n107\n00:05:46.810 --> 00:05:49.010\nThere's auto and desirable.\n\n108\n00:05:50.160 --> 00:05:55.280\nWhen you're auto, that says if somebody\nelse asks me to build a trunk, I'll do it.\n\n109\n00:05:55.280 --> 00:06:00.190\nIf it's desirable I'll say, I'll reach out\nand I'll try to build the trunk myself,\n\n110\n00:06:00.190 --> 00:06:01.620\nall right?\n\n111\n00:06:01.620 --> 00:06:04.210\nSo if we have two desirables\nplugged into each other,\n\n112\n00:06:04.210 --> 00:06:05.140\nthey're going to build a trunk.\n\n113\n00:06:05.140 --> 00:06:06.910\nThey both ask and they both do it.\n\n114\n00:06:06.910 --> 00:06:09.910\nIf I have one desirable and one auto.\n\n115\n00:06:09.910 --> 00:06:14.890\nThe auto guy just listens, the desirable\nasks and there they go, right.\n\n116\n00:06:14.890 --> 00:06:19.780\nBut if I have two autos plug into each\nother neither one is gonna ask and\n\n117\n00:06:19.780 --> 00:06:20.840\nthey're not going to build a trunk.\n\n118\n00:06:21.850 --> 00:06:23.350\nSo what do I have here.\n\n119\n00:06:23.350 --> 00:06:25.551\nWell, the honest answer,\nI don't really know.\n\n120\n00:06:25.551 --> 00:06:29.420\n[LAUGH] So different Cisco switches\nare configured differently by default and\n\n121\n00:06:29.420 --> 00:06:31.980\ndifferent IOSs have different default.\n\n122\n00:06:31.980 --> 00:06:35.070\nGenerally, the older switches\nare desirable by default and\n\n123\n00:06:35.070 --> 00:06:38.850\nthe newer switches are auto by default,\nbut that's not set in stone.\n\n124\n00:06:38.850 --> 00:06:42.230\nSo you'll have to check the documentation\nin your switch to see which is which but\n\n125\n00:06:42.230 --> 00:06:45.200\none easy way to find out is just to\nlook and see if you built the trunk.\n\n126\n00:06:45.200 --> 00:06:46.600\nIf I built the trunk then.\n\n127\n00:06:46.600 --> 00:06:47.370\n>> We know it happened.\n\n128\n00:06:47.370 --> 00:06:48.210\n>> There you go.\n\n129\n00:06:48.210 --> 00:06:50.100\nSo, there's a few ways we can see that.\n\n130\n00:06:50.100 --> 00:06:56.550\nI usually just jump right to the trunk\ncommand which is show interface trunk.\n\n131\n00:06:56.550 --> 00:06:58.990\nThat will show you any trunk\ninterface on your switch.\n\n132\n00:06:58.990 --> 00:07:02.770\nAnd if I look at mine,\nI've got a trunk on fa1/0/22.\n\n133\n00:07:02.770 --> 00:07:06.570\nBut I don't have it on 23 or\n24, all right.\n\n134\n00:07:06.570 --> 00:07:08.250\nSo I'm not trunking on those guys.\n\n135\n00:07:08.250 --> 00:07:10.760\nBut if I look at this one port\nthat I've already got, 1/0/22,\n\n136\n00:07:10.760 --> 00:07:13.140\nsee how it's got a mode of auto?\n\n137\n00:07:13.140 --> 00:07:15.480\nThis switch more than\nlikely defaults to auto.\n\n138\n00:07:15.480 --> 00:07:18.500\nAnd the fact that the other\nswitch hasn't gone and\n\n139\n00:07:18.500 --> 00:07:20.660\nbuilt the trunk forming means\nthat it's probably auto also.\n\n140\n00:07:20.660 --> 00:07:22.570\nSo I haven't got a dynamic trunk.\n\n141\n00:07:22.570 --> 00:07:24.870\nNow, there's another thing\nthat we can use to see this.\n\n142\n00:07:24.870 --> 00:07:31.310\nIf we do a show DTP interface, and\nthen we specify the interface, right?\n\n143\n00:07:31.310 --> 00:07:33.520\nDTP is Dynamic Trunking Protocol.\n\n144\n00:07:33.520 --> 00:07:36.500\nShow me Dynamic Trunking Protocol for\nthis interface and\n\n145\n00:07:36.500 --> 00:07:39.410\nwhen I look at that,\nit's gonna tell me how it's set.\n\n146\n00:07:40.810 --> 00:07:44.820\nRight now it's an access port\naccording to configuration.\n\n147\n00:07:45.900 --> 00:07:48.762\nIt's set to auto for negotiation and\n\n148\n00:07:48.762 --> 00:07:52.741\nthe result is that it's\ncurrently an access port.\n\n149\n00:07:52.741 --> 00:07:56.327\nI'm auto and the other side is auto so\nwe're not coming up,\n\n150\n00:07:56.327 --> 00:07:58.426\nneither one's asking to come up.\n\n151\n00:07:58.426 --> 00:08:00.787\nAll I have to do is change one add.\n\n152\n00:08:00.787 --> 00:08:04.816\nIf I change one side to desirable\nthe other side can stay auto and\n\n153\n00:08:04.816 --> 00:08:07.870\nnow that trunk's gonna come up and\nthat's it.\n\n154\n00:08:07.870 --> 00:08:09.920\nAnd I'm gonna have a trunk\nbetween the systems.\n\n155\n00:08:09.920 --> 00:08:12.060\nSo let me show you that.\n\n156\n00:08:12.060 --> 00:08:15.000\nIf I just take, I'm already here\non core 2 so I'll use this end.\n\n157\n00:08:15.000 --> 00:08:17.070\nIt doesn't really matter which end we do.\n\n158\n00:08:17.070 --> 00:08:21.060\nJust one of them has to be set to\ndesirable to initiate the trunk.\n\n159\n00:08:21.060 --> 00:08:26.830\nSo on this end, I'm gonna come in here and\njust say, switchport mode.\n\n160\n00:08:26.830 --> 00:08:29.380\nAnd I'm not saying I\nwant it to be a trunk,\n\n161\n00:08:29.380 --> 00:08:33.030\nI'm not saying I want it to be an access\nport, I just want it to negotiate.\n\n162\n00:08:33.030 --> 00:08:34.200\nAnd so that's what I'm modifying here.\n\n163\n00:08:34.200 --> 00:08:36.220\nWhen you say switch port mode\nyou're modifying how it negotiates.\n\n164\n00:08:36.220 --> 00:08:40.390\nAnd I'm gonna say switch\nport mode dynamic.\n\n165\n00:08:40.390 --> 00:08:42.830\nNow it's already dynamic.\n\n166\n00:08:42.830 --> 00:08:44.730\nIt's dynamic auto.\n\n167\n00:08:44.730 --> 00:08:47.050\nI need it to be dynamic desirable.\n\n168\n00:08:47.050 --> 00:08:49.580\nAnd if you do a little question\nmark you'll see auto and desirable.\n\n169\n00:08:49.580 --> 00:08:50.840\nThose are my two choices.\n\n170\n00:08:50.840 --> 00:08:54.210\nAnd so I'll go ahead and\nspecify desirable.\n\n171\n00:08:54.210 --> 00:08:56.300\nNow on lot of Cisco switches,\nthat's all I need.\n\n172\n00:08:56.300 --> 00:08:59.800\nI can press Enter, but there are some\nCisco switches that actually have\n\n173\n00:08:59.800 --> 00:09:01.225\nan extra little setting on the end.\n\n174\n00:09:01.225 --> 00:09:02.380\nThis one doesn't have it.\n\n175\n00:09:02.380 --> 00:09:06.864\nWhich is where you can go into\nsome different alternate modes,\n\n176\n00:09:06.864 --> 00:09:09.571\nlike a silent and a non-silent mode,\n\n177\n00:09:09.571 --> 00:09:14.260\nwhich affects how the switch\nreacts when it's first coming up.\n\n178\n00:09:14.260 --> 00:09:19.160\nSo normally a Cisco switch when it first\ncomes up, it's gonna be an access port.\n\n179\n00:09:19.160 --> 00:09:21.730\nAnd then it'll negotiate\nto become a trunk.\n\n180\n00:09:21.730 --> 00:09:25.420\nBut on switches that support\na non-silent mode, when those come up,\n\n181\n00:09:25.420 --> 00:09:28.480\nthey'll actually launch and\nthey'll go right into trunking first.\n\n182\n00:09:28.480 --> 00:09:31.600\nAnd then, if negotiation fails,\nthey'll drop back to an access port.\n\n183\n00:09:31.600 --> 00:09:33.510\nSo you may see some additional options.\n\n184\n00:09:33.510 --> 00:09:34.960\nThis switch, this is a 3750.\n\n185\n00:09:34.960 --> 00:09:38.510\nIt doesn't have that option so,\nor at least this iOS doesn't so\n\n186\n00:09:38.510 --> 00:09:41.950\nI'll just stop right there at desirable.\n\n187\n00:09:41.950 --> 00:09:44.910\n>> Now, Don, I know Don Pezet pretty well.\n\n188\n00:09:44.910 --> 00:09:48.060\nI've known Don for a couple years now.\n\n189\n00:09:48.060 --> 00:09:51.424\nIf I know anything about him,\nhe hates auto because auto\n\n190\n00:09:51.424 --> 00:09:55.076\ncan leave you open to the switch\ndoing things it wants to do and\n\n191\n00:09:55.076 --> 00:09:57.816\nmaybe not necessarily\nwhat you want it to do.\n\n192\n00:09:57.816 --> 00:09:59.683\nIs there any way that we can\ncontrol this trunking and\n\n193\n00:09:59.683 --> 00:10:01.647\nnot have to worry about these\nauto negotiation stuff?\n\n194\n00:10:01.647 --> 00:10:06.530\n>> Yeah, in my world [LAUGH]\n>> Auto is fine on a work station.\n\n195\n00:10:06.530 --> 00:10:07.690\nAuto is fine on a printer.\n\n196\n00:10:07.690 --> 00:10:09.990\nAuto is fine on a server for all I care.\n\n197\n00:10:09.990 --> 00:10:12.230\nBut on my switches I like\nto know what's happening.\n\n198\n00:10:12.230 --> 00:10:16.340\nI don't like to leave things up to chance,\nI do not like DTP.\n\n199\n00:10:16.340 --> 00:10:19.740\nI don't, now I'm starting to\nsound like Green Eggs and Ham.\n\n200\n00:10:19.740 --> 00:10:22.416\n[CROSSTALK] I don't like inconsistency, so\n\n201\n00:10:22.416 --> 00:10:26.623\nif I have a port that I want to be\na trunk, I want it to always be a trunk.\n\n202\n00:10:26.623 --> 00:10:29.660\nI don't want it to negotiate,\nI don't want it to figure it out.\n\n203\n00:10:29.660 --> 00:10:30.980\nI want it to be a trunk.\n\n204\n00:10:30.980 --> 00:10:33.270\nAnd so I usually don't use these.\n\n205\n00:10:33.270 --> 00:10:33.780\nIt's up to you.\n\n206\n00:10:33.780 --> 00:10:35.640\nIn real life you can take\nadvantage of whatever you want,\n\n207\n00:10:35.640 --> 00:10:39.530\nbut remember when you set up something\nthat's dynamic it's gonna negotiate.\n\n208\n00:10:39.530 --> 00:10:41.170\nSo that trunk port you created,\n\n209\n00:10:41.170 --> 00:10:43.980\nsomething could happen that\ncould make it negotiate access.\n\n210\n00:10:43.980 --> 00:10:46.660\nAnd all of a sudden only one\nVLAN is going over that link.\n\n211\n00:10:46.660 --> 00:10:51.500\nThat's a problem right, or if you have\nall of your ports set to negotiate right.\n\n212\n00:10:51.500 --> 00:10:54.290\nWhich is the default, this switch,\nthis switch that I've got\n\n213\n00:10:54.290 --> 00:10:58.690\nhere is a 3750 running the 15.0 IOS\nit's the latest for the switch.\n\n214\n00:10:58.690 --> 00:11:02.780\nAnd, all of its ports are set to\ndynamically negotiate by default.\n\n215\n00:11:02.780 --> 00:11:06.610\nAn attacker could plug in their laptop,\nand\n\n216\n00:11:06.610 --> 00:11:12.420\nthey could simulate being\na desirable DTP switch,\n\n217\n00:11:12.420 --> 00:11:15.510\nwhich is gonna tell my switch to\nmake a trunk, and my switch is gonna\n\n218\n00:11:15.510 --> 00:11:18.970\ntrunk to them, and now all of my VLAN\ntraffic is gonna go to that attacker.\n\n219\n00:11:18.970 --> 00:11:20.030\nI don't want that.\n\n220\n00:11:20.030 --> 00:11:21.400\nThat's not something I want.\n\n221\n00:11:21.400 --> 00:11:24.620\nSo I almost always\ndisable the negotiation.\n\n222\n00:11:25.760 --> 00:11:29.040\nAnd we do that by hard-setting\nwhether it's a trunk or not.\n\n223\n00:11:29.040 --> 00:11:33.730\nRemember when I started, each of these\ninterfaces said switchboard, mode, access.\n\n224\n00:11:33.730 --> 00:11:34.940\nIt's an access port.\n\n225\n00:11:34.940 --> 00:11:38.330\nIt doesn't matter if DTP is on or off,\nwhatever desirable auto, doesn't matter.\n\n226\n00:11:38.330 --> 00:11:39.160\nWe're an access port.\n\n227\n00:11:39.160 --> 00:11:41.540\nYou guys saw my switches,\nthey did not trunk.\n\n228\n00:11:41.540 --> 00:11:46.460\nI could also say switchboard, mode,\ntrunk and now they're hard set as a trunk.\n\n229\n00:11:46.460 --> 00:11:50.740\nThey will trunk, and if the trunk\ndoesn't form then the port's just dead,\n\n230\n00:11:50.740 --> 00:11:52.340\nit won't be an access port, right.\n\n231\n00:11:52.340 --> 00:11:56.300\nSo I can hard set my client\naccess ports as access ports and\n\n232\n00:11:56.300 --> 00:11:57.930\nI can hard set my trunks as trunks.\n\n233\n00:11:57.930 --> 00:11:58.570\nThat's what I do.\n\n234\n00:11:58.570 --> 00:11:59.670\nI always do that.\n\n235\n00:11:59.670 --> 00:12:01.910\nI never use DTP in the field.\n\n236\n00:12:01.910 --> 00:12:05.310\nBut on the exam, we need to be aware of\nall the features, so this is available,\n\n237\n00:12:05.310 --> 00:12:07.040\nand actually looking at my switch here,\nyou'll see it.\n\n238\n00:12:07.040 --> 00:12:08.260\nIt does work pretty well.\n\n239\n00:12:08.260 --> 00:12:11.035\nYou'll see my ports went down\nwhen the negotiation started and\n\n240\n00:12:11.035 --> 00:12:12.480\nthen they came back up.\n\n241\n00:12:12.480 --> 00:12:12.980\nRight?\n\n242\n00:12:12.980 --> 00:12:16.860\nSo negotiation was successful one way or\nanother, right?\n\n243\n00:12:16.860 --> 00:12:18.000\nI might have trunked, or\n\n244\n00:12:18.000 --> 00:12:20.880\nit might have gone back to access\nbecause it is negotiating.\n\n245\n00:12:20.880 --> 00:12:25.970\nSo if I do a show int\ntrunk I hopefully see,\n\n246\n00:12:25.970 --> 00:12:29.960\nyep there we go,\nI'm trunking on ports 23 and 24 now.\n\n247\n00:12:29.960 --> 00:12:33.710\nAnd if I look up here at the mode,\nsee how 22 is auto but 23 and\n\n248\n00:12:33.710 --> 00:12:39.680\n24 are desirable and so\nthey're up and they're trunking.\n\n249\n00:12:39.680 --> 00:12:44.140\nAlso if I do a show DTP interface for\none of those guys or.\n\n250\n00:12:44.140 --> 00:12:45.460\nYou know both of them whatever.\n\n251\n00:12:45.460 --> 00:12:47.300\nAnd I go and look at it here.\n\n252\n00:12:47.300 --> 00:12:49.710\nI can see where it is a trunk.\n\n253\n00:12:49.710 --> 00:12:50.880\nIt was desirable.\n\n254\n00:12:50.880 --> 00:12:55.380\nIt's come up, it's negotiated and\nnow I'm passing all of my VLANs across it.\n\n255\n00:12:55.380 --> 00:12:55.930\nRight?\n\n256\n00:12:55.930 --> 00:12:57.940\nYou probably saw that note up here.\n\n257\n00:12:57.940 --> 00:13:01.780\nWhere it shows on port 23 and\n24, VLANs allowed on trunk.\n\n258\n00:13:01.780 --> 00:13:02.310\n1 through 4094.\n\n259\n00:13:02.310 --> 00:13:04.130\nAll right?\n\n260\n00:13:04.130 --> 00:13:06.479\nVLANs allowed and active.\n\n261\n00:13:06.479 --> 00:13:08.460\nThose are ones that I\nactually have ports for.\n\n262\n00:13:08.460 --> 00:13:10.990\nAnd this switch only has ports in VLAN 1.\n\n263\n00:13:10.990 --> 00:13:13.820\nIf I take a look at this\nfrom my other switch.\n\n264\n00:13:13.820 --> 00:13:16.820\nThe other switch is where I created\nall those other VLANs, right?\n\n265\n00:13:16.820 --> 00:13:19.410\nWe had the sales and\nmarketing, and all those guys.\n\n266\n00:13:19.410 --> 00:13:23.550\nSo if I do a show VLAN on this guy and\n\n267\n00:13:23.550 --> 00:13:28.170\ntake a look at what's in there, I've\ngot VLAN one two three four five and so\n\n268\n00:13:28.170 --> 00:13:33.379\non this one if I do\na show interface trunk.\n\n269\n00:13:34.970 --> 00:13:39.680\nI'll see that it's got one through 4,094\nis allowed, but only one through five\n\n270\n00:13:39.680 --> 00:13:42.900\nare actually crossing it right now because\nthose are the ones that are active.\n\n271\n00:13:42.900 --> 00:13:47.030\nSo when I talked about my original\ntopology here, I said, one of the things I\n\n272\n00:13:47.030 --> 00:13:50.350\nneed to do, is I need to get all these\nVLANs crossing to the other side.\n\n273\n00:13:50.350 --> 00:13:52.110\nI need to get that traffic on the wire.\n\n274\n00:13:52.110 --> 00:13:53.630\nI just did that.\n\n275\n00:13:53.630 --> 00:13:56.330\nNow, traffic for VLAN one,\ntwo, three, four and\n\n276\n00:13:56.330 --> 00:13:59.670\nfive are crossing this\nline to the other side.\n\n277\n00:13:59.670 --> 00:14:01.240\nAll right.\nIt's making it over there and\n\n278\n00:14:01.240 --> 00:14:02.300\nthe switch is getting that traffic.\n\n279\n00:14:03.360 --> 00:14:05.770\nNow I do have a bit of a challenge here.\n\n280\n00:14:05.770 --> 00:14:10.698\nWhen traffic is being sent over the link\nlike this I've got more than one VLAN\n\n281\n00:14:10.698 --> 00:14:14.715\nbeing mixed together on one cable and\nhitting the other side.\n\n282\n00:14:14.715 --> 00:14:15.640\nAll right?\n\n283\n00:14:15.640 --> 00:14:19.850\nSo, how does the other side know\nwhat VLAN this traffic is on?\n\n284\n00:14:21.000 --> 00:14:25.171\nWell, we have a nice little VLAN\nprotocol in the background called\n\n285\n00:14:25.171 --> 00:14:28.783\n802.1q VLAN tagging.\n\n286\n00:14:28.783 --> 00:14:30.660\nAnd it's an IEEE standard.\n\n287\n00:14:30.660 --> 00:14:33.477\nThat's why it's got the number, 802.1q.\n\n288\n00:14:33.477 --> 00:14:37.690\nVLAN tagging is a system that your switch\nuses to be able to identify traffic and\n\n289\n00:14:37.690 --> 00:14:39.060\nwhat VLAN it came from.\n\n290\n00:14:39.060 --> 00:14:42.600\nSo basically what it does is it takes\nyour frame that has your data in it,\n\n291\n00:14:42.600 --> 00:14:43.910\nthe network frame.\n\n292\n00:14:43.910 --> 00:14:48.080\nAnd it takes your VLAN number and\nit tags the frame with it.\n\n293\n00:14:48.080 --> 00:14:52.340\nIt sticks that number into the frame,\ninto the header of that frame and\n\n294\n00:14:52.340 --> 00:14:53.240\nsends it along.\n\n295\n00:14:53.240 --> 00:14:54.640\nYour data's untouched.\n\n296\n00:14:54.640 --> 00:14:56.480\nBut the header of the frame is modified.\n\n297\n00:14:56.480 --> 00:14:57.960\nIt's in the layer two header.\n\n298\n00:14:57.960 --> 00:14:59.220\nAnd that's sent to the other side.\n\n299\n00:14:59.220 --> 00:15:03.860\nAnd when the other switch receives it,\nit can look at that header, it can see\n\n300\n00:15:03.860 --> 00:15:09.360\nthe VLAN tag, identify it, and put it\non the right VLAN on the other side.\n\n301\n00:15:09.360 --> 00:15:14.105\nMy other switch only has VLAN one, so when\nit receives stuff for VLAN 2, 3, 4, 5,\n\n302\n00:15:14.105 --> 00:15:15.734\nyou know what it's gonna do?\n\n303\n00:15:15.734 --> 00:15:16.440\nIt's gonna throw it away.\n\n304\n00:15:17.600 --> 00:15:19.100\nIt's gonna receive it, but on its trunks,\n\n305\n00:15:19.100 --> 00:15:21.540\nit's only allowing VLAN 1 so\nit just throws the traffic away.\n\n306\n00:15:21.540 --> 00:15:25.470\nSo I need to get it aware of these other\nVLANs, which we'll do in a minute, but\n\n307\n00:15:25.470 --> 00:15:26.560\nthe traffic is flowing.\n\n308\n00:15:26.560 --> 00:15:30.080\nIt is making it over there and 802.1q\nVLAN tagging is what makes that possible.\n\n309\n00:15:31.970 --> 00:15:34.580\nNow, a couple of things about tagging.\n\n310\n00:15:34.580 --> 00:15:36.880\nIt's an IEEE standard, so\nevery vendor supports it.\n\n311\n00:15:36.880 --> 00:15:40.240\nIf you have HP, if you have\nExtreme Network, Cisco, Juniper,\n\n312\n00:15:40.240 --> 00:15:43.571\nwhatever, they all support\n802.1Q VLAN tagging very common.\n\n313\n00:15:43.571 --> 00:15:44.790\nAll right.\n\n314\n00:15:44.790 --> 00:15:47.820\nBut the way that it works is not\nnecessarily the most efficient.\n\n315\n00:15:47.820 --> 00:15:51.660\nWhat it does, it takes that header and\nit injects the tag number in there, right?\n\n316\n00:15:51.660 --> 00:15:53.880\nSo make sure you frame\na little bit bigger.\n\n317\n00:15:53.880 --> 00:15:55.638\nYou might remember MTU sizes.\n\n318\n00:15:55.638 --> 00:15:59.231\nNormally when you send a frame on\nthe network, it needs to be below,\n\n319\n00:15:59.231 --> 00:16:04.168\nthere's some debate over this number but,\nnormally it needs to be below 1,518 bytes.\n\n320\n00:16:04.168 --> 00:16:05.411\nSo 1518.\n\n321\n00:16:05.411 --> 00:16:10.168\nAnd that's kinda your maximum MTU, but if\nyou look on a computer like on workstation\n\n322\n00:16:10.168 --> 00:16:13.124\nor even your router what's\nthe default MTU set too?\n\n323\n00:16:13.124 --> 00:16:14.691\nUsually 1500.\n\n324\n00:16:14.691 --> 00:16:19.630\nWhy 1500 if I can go even\nbigger to 1518 or even 1524?\n\n325\n00:16:19.630 --> 00:16:23.560\nWell, the reason is we need extra room for\nthings like these VLAN tags, and\n\n326\n00:16:23.560 --> 00:16:24.770\nquality of service.\n\n327\n00:16:24.770 --> 00:16:27.990\nThat stuff where we add data to\nthe header to identify traffic.\n\n328\n00:16:27.990 --> 00:16:32.960\nSo these VLAN tags, remember your VLAN\nnumber, it could be one through 4,094, and\n\n329\n00:16:32.960 --> 00:16:37.260\nthat we need a couple of bytes\nto be able to write that.\n\n330\n00:16:37.260 --> 00:16:41.030\nAnd so, that's why our MTU sizes are a\nlittle bit smaller, to leave that room.\n\n331\n00:16:41.030 --> 00:16:45.625\nBut when the switch injects that\ntag number into the header,\n\n332\n00:16:45.625 --> 00:16:47.635\nit changes the length of the frame.\n\n333\n00:16:47.635 --> 00:16:50.305\nAnd every frame has\na checksum attached to it.\n\n334\n00:16:50.305 --> 00:16:53.546\nAnd the checksum is the result of\na mathematical equation that's running\n\n335\n00:16:53.546 --> 00:16:57.615\nagainst the data, and you can use it to\nsee if the frame has gotten corrupted.\n\n336\n00:16:57.615 --> 00:17:01.840\nIf you run the formula and get a different\nnumber then what's stored in the checksum,\n\n337\n00:17:01.840 --> 00:17:03.556\nthen that means the data changed.\n\n338\n00:17:03.556 --> 00:17:06.342\nWell, when we inject a tag,\nwhat happens to the checksum?\n\n339\n00:17:06.342 --> 00:17:08.580\nIt's bad, it invalidates it.\n\n340\n00:17:08.580 --> 00:17:12.641\nSo the switch has to recalculate that\nchecksum every time it injects a tag.\n\n341\n00:17:12.641 --> 00:17:15.495\nAnd then, on the other side\nit's gonna take the tag off and\n\n342\n00:17:15.495 --> 00:17:18.364\nrecalculate the checksums and\nstick it on the right VLAN.\n\n343\n00:17:18.364 --> 00:17:20.240\nWith no tag anymore.\n\n344\n00:17:20.240 --> 00:17:22.940\nSo we're having to constantly\nrecalculate checksums.\n\n345\n00:17:22.940 --> 00:17:26.980\nAnd Cisco switches have dedicated hardware\nspecifically to handle that, and so\n\n346\n00:17:26.980 --> 00:17:29.550\nthey do it at near wired speed,\nwe don't even notice.\n\n347\n00:17:29.550 --> 00:17:32.010\nBut on older switches\nthat was a real problem.\n\n348\n00:17:32.010 --> 00:17:34.590\nIt kinda created a bit\nof a performance hit.\n\n349\n00:17:34.590 --> 00:17:38.750\nAnd so, 802.1Q VLAN tagging got off\nto a bit of a rocky start back in\n\n350\n00:17:38.750 --> 00:17:39.510\nthe beginning.\n\n351\n00:17:39.510 --> 00:17:42.930\nBut now it's widely accepted, it's used by\npretty much every vendor out there, but\n\n352\n00:17:42.930 --> 00:17:44.250\nthat's basically the way\nthat it functions.\n\n353\n00:17:44.250 --> 00:17:49.220\n>> Yeah, Don I remember back in the day we\nused the ISL to do this kind of operation.\n\n354\n00:17:49.220 --> 00:17:50.300\nWhatever happened to that?\n\n355\n00:17:50.300 --> 00:17:51.144\n>> I'm glad you mentioned it-.\n\n356\n00:17:51.144 --> 00:17:52.279\n>> [LAUGH]\n>> Cuz if you,\n\n357\n00:17:52.279 --> 00:17:54.627\nyou guys in TV land might\nhave already noticed this.\n\n358\n00:17:54.627 --> 00:17:56.488\nIf you look at my switches back here,\n\n359\n00:17:56.488 --> 00:17:59.921\nremember how I said they auto\nnegotiated and it built up that trunk?\n\n360\n00:17:59.921 --> 00:18:04.613\nWell, notice on the trunk I\nhad built before the show,\n\n361\n00:18:04.613 --> 00:18:09.104\nthis guy, /22 Encapsulation n-802.1q.\n\n362\n00:18:09.104 --> 00:18:12.680\nThat means it negotiated,\nthat's the n-802.1q.\n\n363\n00:18:12.680 --> 00:18:14.670\nSo it's using that standard.\n\n364\n00:18:14.670 --> 00:18:19.021\nBut the two that I just set up,\nthey negotiated ISL.\n\n365\n00:18:19.021 --> 00:18:20.230\nNow, what the heck is that?\n\n366\n00:18:20.230 --> 00:18:22.342\nWell, that's Inter-Switch Link.\n\n367\n00:18:22.342 --> 00:18:25.800\nAnd inter-switch link is a Cisco\nproprietary trunking method.\n\n368\n00:18:25.800 --> 00:18:27.306\nIt's one they created.\n\n369\n00:18:27.306 --> 00:18:30.847\nThey created it before\nthere was an 802.1q.\n\n370\n00:18:30.847 --> 00:18:33.630\nWhen there was no way to\nsend this VLAN traffic.\n\n371\n00:18:33.630 --> 00:18:36.340\nIf I have five VLANs and\nI want them to go between switches,\n\n372\n00:18:36.340 --> 00:18:40.070\nI had to run five uplinks and that sucks-\n>> [LAUGH]\n\n373\n00:18:40.070 --> 00:18:40.775\n>> That's not a good time.\n\n374\n00:18:40.775 --> 00:18:47.120\nSo ISL fixed that, but the hardware\nwasn't available to do tagging back then.\n\n375\n00:18:47.120 --> 00:18:49.890\nSo what Cisco did is they said,\nyou know what we are gonna do?\n\n376\n00:18:49.890 --> 00:18:53.550\nInstead of modifying the frame,\nlet's just encapsulate it.\n\n377\n00:18:53.550 --> 00:18:55.110\nLet's just wrap it up.\n\n378\n00:18:55.110 --> 00:18:57.000\nWe'll take our own frame and\n\n379\n00:18:57.000 --> 00:18:59.600\nwe'll put your data inside\nof our frame as the payload.\n\n380\n00:18:59.600 --> 00:19:01.173\nAnd that way when we send it along,\n\n381\n00:19:01.173 --> 00:19:03.944\nyou just got a regular frame\nthat comes along the other side,\n\n382\n00:19:03.944 --> 00:19:07.550\nstrip that frame off and inside of it is\nyour frame in its original intact form.\n\n383\n00:19:07.550 --> 00:19:10.100\nWe don't have to recalculate checksum.\n\n384\n00:19:10.100 --> 00:19:11.260\nPretty neat.\n\n385\n00:19:11.260 --> 00:19:13.964\nWell, it sounds great but\nit has a problem.\n\n386\n00:19:13.964 --> 00:19:17.676\nWhen we have this maximum MTU size, most\nof the time the frames that we send on\n\n387\n00:19:17.676 --> 00:19:19.892\nthe network aren't\nthe full size of the MTU.\n\n388\n00:19:19.892 --> 00:19:22.515\nThey're usually good bit\nsmaller because of the data.\n\n389\n00:19:22.515 --> 00:19:25.275\nLike when you type in\na URL to go to a website,\n\n390\n00:19:25.275 --> 00:19:29.555\nit doesn't need 1,518 bytes or\nwhatever to send a URL, so\n\n391\n00:19:29.555 --> 00:19:32.335\nthey're usually a lot smaller and\nthose can be encapsulated just fine.\n\n392\n00:19:33.440 --> 00:19:38.440\nBut if I have a frame that's full,\nand now I've gotta stick it inside of\n\n393\n00:19:38.440 --> 00:19:41.970\nanother frame, I gotta encapsulate it,\nI'm gonna have to break it in half.\n\n394\n00:19:41.970 --> 00:19:43.590\nAnd now it's gonna go as two frames.\n\n395\n00:19:43.590 --> 00:19:46.870\nAnd so, that makes for\nsome reassembly on the other side, and\n\n396\n00:19:46.870 --> 00:19:48.530\nit's still a little bit of work.\n\n397\n00:19:48.530 --> 00:19:51.393\nBut it's actually more\nefficient than 802.1q.\n\n398\n00:19:51.393 --> 00:19:53.210\nBut it is Cisco proprietary and\n\n399\n00:19:53.210 --> 00:19:57.100\nCisco switches a lot of them default\nto it and that's what I've got here.\n\n400\n00:19:57.100 --> 00:20:00.930\nProblem is, Cisco proprietary, so\nit's not really gonna work with 3COM or\n\n401\n00:20:00.930 --> 00:20:03.980\nHP or\nwhoever else it is that you're using.\n\n402\n00:20:03.980 --> 00:20:07.050\nSo ISL's fine,\non a Cisco network you can leave it be.\n\n403\n00:20:07.050 --> 00:20:10.032\nBut I usually switch to 802.1q.\n\n404\n00:20:10.032 --> 00:20:11.715\nUnfortunately, this is a negotiated link,\n\n405\n00:20:11.715 --> 00:20:14.630\nso I didn't get to pick,\nit figured it out on its own.\n\n406\n00:20:14.630 --> 00:20:18.760\nSo if I want to hard set it to one,\nit goes back to what I said earlier.\n\n407\n00:20:18.760 --> 00:20:20.020\nDon't use DTP.\n\n408\n00:20:20.020 --> 00:20:21.551\nJust hard set the trunk.\n\n409\n00:20:21.551 --> 00:20:24.480\nAnd when you hard set the trunk,\nthat'll solve it.\n\n410\n00:20:24.480 --> 00:20:28.280\nYou can actually use a mix\nwhere you hard set one side and\n\n411\n00:20:28.280 --> 00:20:29.440\nleave the other side to auto.\n\n412\n00:20:30.440 --> 00:20:32.060\nHere, I'm on core one.\n\n413\n00:20:32.060 --> 00:20:34.250\nAnd core one is set to auto.\n\n414\n00:20:34.250 --> 00:20:37.080\nCore one is not going to trunk\nunless somebody asks it.\n\n415\n00:20:37.080 --> 00:20:40.240\nSomebody has to ask it to trunk,\nand then it'll negotiate.\n\n416\n00:20:40.240 --> 00:20:42.690\nI'm gonna leave core one like that.\n\n417\n00:20:42.690 --> 00:20:45.790\nIf I pull up the interfaces and\ntheir config.\n\n418\n00:20:46.840 --> 00:20:50.450\nSo if I just look at these, you'll see\nports 23 and 24 completely at default.\n\n419\n00:20:50.450 --> 00:20:51.780\nHaven't entered any commands.\n\n420\n00:20:51.780 --> 00:20:52.605\nFeel like a magician.\n\n421\n00:20:52.605 --> 00:20:54.960\n>> [LAUGH]\n>> Nothing up my sleeve right..\n\n422\n00:20:54.960 --> 00:21:01.490\nBut if I jump to core two, core two is\nthe one that I put into desirable mode.\n\n423\n00:21:01.490 --> 00:21:02.050\nAnd so,\n\n424\n00:21:02.050 --> 00:21:07.130\nif I take a look at the configuration\nover here, this is the one where, again,\n\n425\n00:21:07.130 --> 00:21:10.840\nall defaults except I set it to\ndesirable and that's why we're trunking.\n\n426\n00:21:12.170 --> 00:21:16.170\nBut I could also come in here and\nI could hard set it.\n\n427\n00:21:16.170 --> 00:21:23.970\nWhen you use that switchport command, you\ncan say, switchport trunk encapsulation.\n\n428\n00:21:23.970 --> 00:21:27.150\nAnd then, you can designate\nwhich standard you wanna run.\n\n429\n00:21:27.150 --> 00:21:28.475\nNegotiate's the default.\n\n430\n00:21:28.475 --> 00:21:32.061\n.1Q and ISL are my other choices.\n\n431\n00:21:32.061 --> 00:21:34.638\nNotice it does still say negotiate.\n\n432\n00:21:34.638 --> 00:21:38.365\nI can still leave it that way if I\nwant for DTP, or I can hard set it.\n\n433\n00:21:38.365 --> 00:21:42.010\nNow, not every Cisco switch\nsupports ISL anymore.\n\n434\n00:21:42.010 --> 00:21:44.240\nSome of the newer ones,\nthis is a newer switch here, but\n\n435\n00:21:44.240 --> 00:21:45.820\nit just happens to burn both.\n\n436\n00:21:45.820 --> 00:21:48.651\nSome of the newer low-end\nswitches just do .1q.\n\n437\n00:21:48.651 --> 00:21:50.420\nSo they don't all do both.\n\n438\n00:21:50.420 --> 00:21:52.120\nSo you might only have one option there.\n\n439\n00:21:52.120 --> 00:21:54.420\nBut in my case I've got the two and\nI can pick.\n\n440\n00:21:54.420 --> 00:21:57.489\nNow, if I set that, if I come in here and\n\n441\n00:21:57.489 --> 00:22:01.582\nI set the encapsulation .1q,\nnow it's hard set.\n\n442\n00:22:01.582 --> 00:22:03.590\nThere go my ports,\nmy ports just went down.\n\n443\n00:22:03.590 --> 00:22:07.131\nThe other side's set to ISL,\nI'm set to .1q.\n\n444\n00:22:07.131 --> 00:22:09.850\nNow, the other side's\nset to negotiate though.\n\n445\n00:22:09.850 --> 00:22:13.552\nSo it's gonna see that I'm using .1q,\nand it's gonna switch to .1q.\n\n446\n00:22:13.552 --> 00:22:17.880\nAnd so,\nif I jump back over to the other guy, and\n\n447\n00:22:17.880 --> 00:22:23.090\ntake a look at it here,\nI can pull up my trunking status.\n\n448\n00:22:23.090 --> 00:22:24.330\nThere we go.\n\n449\n00:22:24.330 --> 00:22:27.600\nAnd I'll see that I'm set to auto and\nnow I'm doing it at .1q.\n\n450\n00:22:27.600 --> 00:22:30.083\nSo it negotiated it and\nnow we're in business.\n\n451\n00:22:30.083 --> 00:22:34.858\nAnd I can even go a step further,\nif I go back to my other switch and\n\n452\n00:22:34.858 --> 00:22:37.960\nI just wanna stop DTP altogether.\n\n453\n00:22:37.960 --> 00:22:41.610\nI need to add one more command,\nswitchport mode trunk.\n\n454\n00:22:41.610 --> 00:22:42.170\nAll right?\n\n455\n00:22:42.170 --> 00:22:43.970\nWhen I say switchport mode trunk,\n\n456\n00:22:43.970 --> 00:22:47.820\nthis port is now a trunk all the time,\nnot an access port.\n\n457\n00:22:47.820 --> 00:22:48.750\nIt's gonna trunk.\n\n458\n00:22:48.750 --> 00:22:53.033\nAnd because I hard set 802.1q,\nit's always going to do 802.1q.\n\n459\n00:22:53.033 --> 00:22:55.356\nSo now, I don't negotiate.\n\n460\n00:22:55.356 --> 00:23:00.430\nIf I take at look at that configuration,\nI can see where\n\n461\n00:23:00.430 --> 00:23:05.350\nI've got hard set, the trunking protocol,\nand hard set to be a trunk.\n\n462\n00:23:06.780 --> 00:23:07.720\nNo negotiation.\n\n463\n00:23:07.720 --> 00:23:09.303\n>> We do not negotiate with\nterrorists around here.\n\n464\n00:23:09.303 --> 00:23:10.117\n>> [LAUGH] That's right.\n>> [LAUGH]\n\n465\n00:23:10.117 --> 00:23:10.930\n>> That's right.\n\n466\n00:23:10.930 --> 00:23:14.200\nAnd there's usually one more command that\nI like to throw in just to be on the safe\n\n467\n00:23:14.200 --> 00:23:18.640\nside, which is switchport nonegotiate.\n\n468\n00:23:20.520 --> 00:23:23.930\nI hard set the trunk,\nI hard set the encapsulation.\n\n469\n00:23:23.930 --> 00:23:25.403\nWhat else is there to negotiate?\n\n470\n00:23:25.403 --> 00:23:28.283\nWell, there are actually a few other\nlittle things that can be negotiated,\n\n471\n00:23:28.283 --> 00:23:31.450\nand so by setting this, I completely\ndisable negotiation altogether.\n\n472\n00:23:31.450 --> 00:23:33.655\nNow, that can cause\na little bit of a problem.\n\n473\n00:23:33.655 --> 00:23:35.560\nThe other side's set to auto.\n\n474\n00:23:35.560 --> 00:23:37.620\nAnd I'm not negotiating with them anymore.\n\n475\n00:23:37.620 --> 00:23:40.395\nSo I'm not gonna share my\nsettings with the other side.\n\n476\n00:23:40.395 --> 00:23:43.130\nNow, going back to me, I like that.\n\n477\n00:23:43.130 --> 00:23:44.336\nI don't like sharing.\n\n478\n00:23:44.336 --> 00:23:48.190\nI don't like something they attack or\ncould take advantage of.\n\n479\n00:23:48.190 --> 00:23:49.140\nI like to hard set it.\n\n480\n00:23:49.140 --> 00:23:51.939\nAnd I control the other side, so I'm gonna\nhard set it there too and it's fine.\n\n481\n00:23:51.939 --> 00:23:54.839\nBut now I'm not sharing anything so\nI need to make\n\n482\n00:23:54.839 --> 00:23:59.671\nsure the other side still works and my\ninterface has never went down so I'm okay.\n\n483\n00:23:59.671 --> 00:24:02.551\nAnd mostly my interface has never went\ndown, cuz I was already a trunk, so\n\n484\n00:24:02.551 --> 00:24:05.542\nI really didn't tell it to do anything\ndifferent than it was already doing.\n\n485\n00:24:05.542 --> 00:24:07.288\nSo I'm up.\n\n486\n00:24:07.288 --> 00:24:11.200\nAnd if I look at that configuration,\neverything's nice and static.\n\n487\n00:24:11.200 --> 00:24:15.678\nAnd if I do a show interface\ntrunk on this switch,\n\n488\n00:24:15.678 --> 00:24:22.249\nI can see that my mode is not auto,\nmy mode is not desirable my mode is on.\n\n489\n00:24:22.249 --> 00:24:22.817\nIt's on.\n\n490\n00:24:22.817 --> 00:24:24.990\nI am a trunk, right?\n\n491\n00:24:24.990 --> 00:24:27.959\nAnd under encapsulation,\nit's not n dash 802.1Q,\n\n492\n00:24:27.959 --> 00:24:31.010\nit's just 802.1Q,\nwe are static all the way.\n\n493\n00:24:31.010 --> 00:24:31.880\nThis is set.\n\n494\n00:24:31.880 --> 00:24:34.045\nThis is how it's gonna be, all right.\n\n495\n00:24:34.045 --> 00:24:37.515\nBut the other side,\nif I jump back to my core, right?\n\n496\n00:24:37.515 --> 00:24:43.349\nThis guy, and I do a show interface trunk,\nI can see that it's still set to auto.\n\n497\n00:24:43.349 --> 00:24:46.609\nIt's still negotiating a 2.lq,\nit's still up, and it's happy but\n\n498\n00:24:46.609 --> 00:24:48.847\nit's always a good idea to do a test,\nall right.\n\n499\n00:24:48.847 --> 00:24:51.355\nI'm gonna shut these interfaces down.\n\n500\n00:24:51.355 --> 00:24:56.270\nI'm gonna take them down and bring them\nback up so it re-does the negotiation.\n\n501\n00:24:56.270 --> 00:24:57.558\nAnd this is to see whether or\n\n502\n00:24:57.558 --> 00:25:00.750\nnot I'll survive having negotiation\nturned off on the other side.\n\n503\n00:25:00.750 --> 00:25:03.557\nIf I try and negotiate and\nthe other side doesn't answer me back,\n\n504\n00:25:03.557 --> 00:25:04.587\nwhat's gonna happen?\n\n505\n00:25:04.587 --> 00:25:05.481\nWell it's kind of a crap shoot.\n\n506\n00:25:05.481 --> 00:25:08.062\n>> [LAUGH]\n>> It depends on the IOS what's going to\n\n507\n00:25:08.062 --> 00:25:08.597\nhappen.\n\n508\n00:25:08.597 --> 00:25:14.670\nBut if we do a no shut down and\nget this guy back up and going all right.\n\n509\n00:25:14.670 --> 00:25:17.980\nIt's gonna come up and\nit's gonna try and negotiate.\n\n510\n00:25:17.980 --> 00:25:19.880\nAnd the other side's not gonna help us.\n\n511\n00:25:19.880 --> 00:25:23.540\nAnd so now, we're gonna have to guess.\n\n512\n00:25:23.540 --> 00:25:25.710\nI start to see some messages\ncoming up about spanning tree.\n\n513\n00:25:25.710 --> 00:25:26.510\nI didn't see these earlier.\n\n514\n00:25:26.510 --> 00:25:28.060\nWhat's going on here?\n\n515\n00:25:28.060 --> 00:25:33.670\nWell, a trunk technically doesn't\nform a loop, but access ports do.\n\n516\n00:25:33.670 --> 00:25:35.430\nAccess ports can form loops.\n\n517\n00:25:35.430 --> 00:25:38.640\nAnd so when these came up,\nthey came up as access ports and\n\n518\n00:25:38.640 --> 00:25:40.870\nthere was a loop detect on the network and\nit protected me.\n\n519\n00:25:40.870 --> 00:25:44.470\nStop the loop and\nthen it went into negotiate and\n\n520\n00:25:44.470 --> 00:25:46.970\nhopefully they became trunks and\nthen it restores connectivity.\n\n521\n00:25:46.970 --> 00:25:50.950\nI do see that they unblocked and we've\nrestored, but I don't know if I trunked or\n\n522\n00:25:50.950 --> 00:25:52.180\nnot, right?\n\n523\n00:25:52.180 --> 00:25:53.180\nSo I want to find that out.\n\n524\n00:25:53.180 --> 00:25:59.602\nSo I'm gonna do, show interface trunk,\nand when I look, I did not trunk right?\n\n525\n00:25:59.602 --> 00:26:01.901\nSo, what happened is I tried to negotiate,\nbut\n\n526\n00:26:01.901 --> 00:26:04.465\nthe other side's not\nnegotiating with me anymore.\n\n527\n00:26:04.465 --> 00:26:08.930\nAnd so it's not telling me the settings to\nuse, I don't know what to do and the trunk\n\n528\n00:26:08.930 --> 00:26:13.030\ngoes down, but if you're like me that's\na good thing, that's exactly what I want.\n\n529\n00:26:13.030 --> 00:26:14.980\nSo on this side I just need\nto statically set things,\n\n530\n00:26:14.980 --> 00:26:20.630\nI can say switch port\ntrunk encapsulation .1q.\n\n531\n00:26:20.630 --> 00:26:22.220\nSwitch port mode trunk.\n\n532\n00:26:23.770 --> 00:26:24.478\nWhoops, Turk.\n\n533\n00:26:24.478 --> 00:26:29.014\nA new technology, and then we'll\nsay switch port no negotiate and\n\n534\n00:26:29.014 --> 00:26:30.960\nnow I'm hard set as a trunk.\n\n535\n00:26:30.960 --> 00:26:33.837\nThe interfaces go down,\nthe interfaces come back up.\n\n536\n00:26:33.837 --> 00:26:35.266\nThey're a trunk right away.\n\n537\n00:26:35.266 --> 00:26:40.089\nSo I don't get any spanning\npre-loop stuff right,\n\n538\n00:26:40.089 --> 00:26:44.620\nand we should be in business,\nand there we go.\n\n539\n00:26:44.620 --> 00:26:47.200\nSo we're up, we're trunking,\nand we're happy.\n\n540\n00:26:47.200 --> 00:26:52.610\nNow, as far as getting the trunk up and\ngoing, that's basically it.\n\n541\n00:26:52.610 --> 00:26:54.340\nThere's another thing\nI do want to mention.\n\n542\n00:26:54.340 --> 00:26:58.930\nI guess we have enough time, I kind of\ntalked longer than I planned, is a trunk\n\n543\n00:26:58.930 --> 00:27:05.680\nby default will carry traffic for every\nsingle VLAN, and I don't always want that.\n\n544\n00:27:05.680 --> 00:27:08.790\nThe other switch, the switch that's on\nthe other side of this core two, maybe\n\n545\n00:27:08.790 --> 00:27:12.570\nit's only got VLANs one, two, and three,\nand it doesn't have VLANs four, and five.\n\n546\n00:27:13.660 --> 00:27:16.740\nWell, I might want to prone\noff some that traffic,\n\n547\n00:27:16.740 --> 00:27:21.010\nto not send it, to save a little bit of\nban wave then kind of optimize that link.\n\n548\n00:27:21.010 --> 00:27:22.860\nSo, we can control that too.\n\n549\n00:27:22.860 --> 00:27:25.850\nThat's just a extra\nsetting here in our trunk.\n\n550\n00:27:25.850 --> 00:27:29.345\nSo the default is to carry everything and\nthen we can go and modify that.\n\n551\n00:27:29.345 --> 00:27:32.226\nIt's not on the interface, so you go\ninto the interface like I am right here.\n\n552\n00:27:32.226 --> 00:27:35.797\nAnd, I've been in the range command this\nwhole time, which is making sure that I'm\n\n553\n00:27:35.797 --> 00:27:38.380\ndoing the same configuration\non these two different ports.\n\n554\n00:27:38.380 --> 00:27:41.206\nIf you ever want to configure common\nports It's a great way to do it so.\n\n555\n00:27:41.206 --> 00:27:46.570\nSo I'm gonna set it here and I just\nwanna change what VLANs are present,\n\n556\n00:27:46.570 --> 00:27:52.390\nand so I'm gonna say switch\nport trunk allowed and\n\n557\n00:27:52.390 --> 00:27:57.700\nnow we can specify the VLANs that\nwe want to allow on the link, okay?\n\n558\n00:27:57.700 --> 00:28:00.540\nAnd, you can add and\nremove them several different ways.\n\n559\n00:28:00.540 --> 00:28:03.710\nYou'll see we've got the add and\nremove commands, so that's a start,\n\n560\n00:28:03.710 --> 00:28:07.500\nand then you can specify\nentire ranges if you want.\n\n561\n00:28:07.500 --> 00:28:13.629\nSo I might come in and say,\nlike, allowed VLAN 1-3 and\n\n562\n00:28:13.629 --> 00:28:19.906\ncomma, I don't know, 1,000 through 4,094.\n\n563\n00:28:19.906 --> 00:28:22.080\nRight, and when I do that,\n\n564\n00:28:22.080 --> 00:28:25.788\nnow there's this nice big range\nof stuff that I'm approving.\n\n565\n00:28:25.788 --> 00:28:30.880\nAnd I used a comma kind of format\nthere to separate those ranges and\n\n566\n00:28:30.880 --> 00:28:33.960\nspecify them, and\nyou can remove them the same way.\n\n567\n00:28:33.960 --> 00:28:39.096\nSo for example if I had said the default\nis switchport trunk allowed VLAN,\n\n568\n00:28:39.096 --> 00:28:41.780\none through 4,094, right?\n\n569\n00:28:41.780 --> 00:28:46.995\nBy default we allow the whole thing and\nwe saw that in our output up here, right?\n\n570\n00:28:46.995 --> 00:28:50.340\nVLAN allowed on trunk and\nhere's that nice big list.\n\n571\n00:28:50.340 --> 00:28:55.650\nWell what I did here was I\nexcluded four through 999.\n\n572\n00:28:55.650 --> 00:29:02.930\nI could've done the same thing by saying,\nswitchport trunk allowed VLAN,\n\n573\n00:29:02.930 --> 00:29:07.960\nand instead of adding the VLAN,\nwe could've done a remove\n\n574\n00:29:09.000 --> 00:29:12.320\nand specified the range, and\nmy head is going this up a little bit.\n\n575\n00:29:12.320 --> 00:29:15.970\nBut if I do a remove,\nI can specify, what did I do?\n\n576\n00:29:15.970 --> 00:29:21.219\nIt was like 4 through 999, right, and\nit's gonna remove that from that list.\n\n577\n00:29:21.219 --> 00:29:24.161\nSo now when I do that\nshow interface trunk,\n\n578\n00:29:24.161 --> 00:29:28.251\nI'll see that one through\n4,094 allowed by default,\n\n579\n00:29:28.251 --> 00:29:33.180\nbut now I'm only allowing 1-3 and\n1,000-4094, right?\n\n580\n00:29:33.180 --> 00:29:35.190\nThat's what I'm allowing, and\n\n581\n00:29:35.190 --> 00:29:38.860\ndown here see how the VLANs\nactive drop to one through three.\n\n582\n00:29:38.860 --> 00:29:42.910\nAnd that's because four and\nfive are being trimmed off of that link.\n\n583\n00:29:42.910 --> 00:29:46.465\nThat's called pruning a VLAN, and what I\njust did there is a manual prune to take\n\n584\n00:29:46.465 --> 00:29:48.389\nthose off and just save bandwidth of link.\n\n585\n00:29:48.389 --> 00:29:50.316\nDon't bother sending VLAN\ntraffic to that switch,\n\n586\n00:29:50.316 --> 00:29:51.943\ncuz it doesn't have any\nports in that VLAN.\n\n587\n00:29:51.943 --> 00:29:52.964\nYou're just wasting time.\n\n588\n00:29:52.964 --> 00:29:54.734\nAll right, so\nthat's a way that we can do it by hand.\n\n589\n00:29:54.734 --> 00:29:56.397\nJust kind of an additional trump command.\n\n590\n00:29:56.397 --> 00:29:59.406\n>> Well Don, we love having control\nover our switches saying hey,\n\n591\n00:29:59.406 --> 00:30:03.080\nthis is the traffic I wanna allow,\nthis is the traffic I wanna disallow.\n\n592\n00:30:03.080 --> 00:30:06.570\nBecause there are some security\nissues when it comes to the VLAN\n\n593\n00:30:06.570 --> 00:30:07.335\ntagging specifically.\n\n594\n00:30:07.335 --> 00:30:11.220\nWe want to avoid those like\nthe black death, that is for sure.\n\n595\n00:30:11.220 --> 00:30:13.195\n>> [LAUGH]\n>> Don, anything else we need to add for\n\n596\n00:30:13.195 --> 00:30:13.745\nthis episode?\n\n597\n00:30:13.745 --> 00:30:16.415\n>> You know,\nI actually have quite a bit more to add so\n\n598\n00:30:16.415 --> 00:30:18.835\nI think we're gonna have to move onto\na part three on this one, Daniel.\n\n599\n00:30:18.835 --> 00:30:20.535\n>> Yeah, well you know,\nit's one of those days.\n\n600\n00:30:20.535 --> 00:30:21.700\nWe're feeling good about it.\n\n601\n00:30:21.700 --> 00:30:24.170\nHopefully we'll see everybody\nout there in part three.\n\n602\n00:30:24.170 --> 00:30:26.490\nAs for this episode,\nwe're gonna go ahead and sign off.\n\n603\n00:30:26.490 --> 00:30:27.230\nThanks for watching.\n\n604\n00:30:27.230 --> 00:30:28.740\nI've been your host Daniel Lowrey.\n\n605\n00:30:28.740 --> 00:30:29.340\n>> And I'm Don Pezet.\n\n606\n00:30:29.340 --> 00:30:32.172\n>> And we'll see you next time.\n\n607\n00:30:32.172 --> 00:30:36.740\n[MUSIC]\n\n",
          "vimeoId": "141658132"
        },
        {
          "description": "In this episode, Daniel and Don finish up by explaining about Native VLANs and then discussing how to setup the VLAN Trunking Protocol (VTP). They go in depth about the different versions of VTP and then walk you through setting up VTP to automatically propagate VLAN information between trunked switches.",
          "length": "3248",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_pt3-092915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_pt3-092915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-3-vlans_and_trunking_pt3-092915-1-sm.jpg",
          "title": "VLANs and Trunking Part 3",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.723 --> 00:00:12.880\n>> All right.\n\n3\n00:00:12.880 --> 00:00:16.420\nGreetings everyone and welcome to\nanother great episode of IT Pro TV.\n\n4\n00:00:16.420 --> 00:00:17.850\nI'm your host Daniel Lowry, and\n\n5\n00:00:17.850 --> 00:00:21.780\nhere with me today is, well, I think\nwe all know who we have here today.\n\n6\n00:00:21.780 --> 00:00:22.490\nMr Don Pezet.\n\n7\n00:00:22.490 --> 00:00:23.400\nHow's it going Don?\n\n8\n00:00:23.400 --> 00:00:25.525\n>> The random stranger\nhas entered the studio.\n\n9\n00:00:25.525 --> 00:00:26.882\n>> That's right [LAUGH].\nWho are you again, sir?\n\n10\n00:00:26.882 --> 00:00:27.860\n[LAUGH]\n>> Do you have a badge, or did you just,\n\n11\n00:00:27.860 --> 00:00:29.280\ntailgated in?\n\n12\n00:00:29.280 --> 00:00:33.860\nGlad to be back on the show, Daniel,\nand excited to wrap up our what's\n\n13\n00:00:33.860 --> 00:00:38.300\nnow turned into a three part\nseries on VLANs and VLAN Trunking.\n\n14\n00:00:38.300 --> 00:00:40.930\nNow, in the last episode,\nif you haven't watched already,\n\n15\n00:00:40.930 --> 00:00:43.780\nwe kinda left off with getting\nsome trunks up and going and\n\n16\n00:00:43.780 --> 00:00:46.610\nlooking at dynamic trunking protocol and\nhow it works.\n\n17\n00:00:46.610 --> 00:00:50.248\nAnd now we're gonna switch, well, actually\nwe're not gonna switch gears quite yet\n\n18\n00:00:50.248 --> 00:00:51.800\ncuz there is one thing I left out.\n\n19\n00:00:51.800 --> 00:00:54.684\nI had a good question in between\nthe episodes from a viewer about\n\n20\n00:00:54.684 --> 00:00:56.010\n802.1q tagging.\n\n21\n00:00:56.010 --> 00:01:00.150\nAnd I made the comment in\nthe last episode about how we're\n\n22\n00:01:00.150 --> 00:01:01.980\ninjecting a tag into a frame.\n\n23\n00:01:01.980 --> 00:01:05.000\nAnd that means the CRC has\nto be recalculated, right?\n\n24\n00:01:05.000 --> 00:01:06.830\nSo, we have to do\na mathematical operation and\n\n25\n00:01:06.830 --> 00:01:09.925\nthat doesn't necessarily make\nthings go as smooth as possible.\n\n26\n00:01:09.925 --> 00:01:13.345\nAnd so, one of the viewers had asked if\nthere is anything that can help that.\n\n27\n00:01:13.345 --> 00:01:17.021\nAnd there actually is one way and\nthis used to be a big deal.\n\n28\n00:01:17.021 --> 00:01:19.965\nNow it isn't anymore, so\nwe don't really worry about it.\n\n29\n00:01:19.965 --> 00:01:25.050\nBut if you've got one VLAN in\nparticular that's pushing tons of data,\n\n30\n00:01:25.050 --> 00:01:27.830\nmaybe you've got iSCSI equipment, right?\n\n31\n00:01:27.830 --> 00:01:31.110\nAnd so, you're pushing storage data across\nthe network and it's just tons of it.\n\n32\n00:01:31.110 --> 00:01:32.560\nAnd you're doing superframes, so\n\n33\n00:01:32.560 --> 00:01:36.960\nthey're like 9,000 bytes instead of 1,500\nbytes, and it's just huge amounts of data.\n\n34\n00:01:36.960 --> 00:01:38.350\nAnd you don't wanna calculate CRCs.\n\n35\n00:01:38.350 --> 00:01:40.610\nYou don't want to recalculate CRCs.\n\n36\n00:01:40.610 --> 00:01:46.740\nIf you are doing 802.12q VLAN tagging,\nthere is one VLAN that's special.\n\n37\n00:01:46.740 --> 00:01:48.040\nThere's a VLAN that's\ncalled the native VLAN.\n\n38\n00:01:48.040 --> 00:01:52.870\nAnd the native VLAN is untagged traffic.\n\n39\n00:01:52.870 --> 00:01:55.500\nIt's the only VLAN that doesn't get a tag.\n\n40\n00:01:55.500 --> 00:02:01.229\nNormally, it injects a tag that says\nI'm on VLAN7, or VLAN700, or VLAN2000.\n\n41\n00:02:01.229 --> 00:02:03.804\nIt designates that.\nBut with the native VLAN it just leaves it\n\n42\n00:02:03.804 --> 00:02:04.550\nuntagged.\n\n43\n00:02:05.810 --> 00:02:09.880\nSo there's a nice little benefit\nthere in that and since it's untagged\n\n44\n00:02:09.880 --> 00:02:13.580\nit doesn't have to recalculate the CRC and\nyou get a little bit better performance.\n\n45\n00:02:13.580 --> 00:02:15.912\nNow, that used to be absolutely true.\n\n46\n00:02:15.912 --> 00:02:18.300\nIn fact, back in the 1990s,\nand even the early 2000s,\n\n47\n00:02:18.300 --> 00:02:20.560\nI used to plan networks around that.\n\n48\n00:02:20.560 --> 00:02:22.460\nLike, all right,\nwhich one's gonna be my native VLAN?\n\n49\n00:02:22.460 --> 00:02:23.100\nRight?\n\n50\n00:02:23.100 --> 00:02:26.660\nBut in today's world the hardware\nacceleration in CISCO switches is so\n\n51\n00:02:26.660 --> 00:02:30.020\ngreat that the CRC calculation\nis next to nothing.\n\n52\n00:02:30.020 --> 00:02:33.120\nAnd so,\nwe typically don't use the native VLAN.\n\n53\n00:02:33.120 --> 00:02:36.620\nAnd the reason we don't is\nbecause it's untagged traffic.\n\n54\n00:02:36.620 --> 00:02:40.220\nThere's a few types of attacks\nthat a hacker can try and\n\n55\n00:02:40.220 --> 00:02:45.900\npull off where they can malform a tag so\nthat the packet,\n\n56\n00:02:45.900 --> 00:02:50.700\nor the frame, is admitted into a switch\nand then it jumps to the native VLAN.\n\n57\n00:02:50.700 --> 00:02:53.300\nAnd one of the problems of the native\nVLAN is if that's where you're\n\n58\n00:02:53.300 --> 00:02:56.680\nputting your sensitive data,\nyour stuff that needs to move fast,\n\n59\n00:02:56.680 --> 00:02:59.680\nthat just became an attack target and\nthat's not normally what we want.\n\n60\n00:02:59.680 --> 00:03:03.370\nSo, a lot of people will set that native\nVLAN to be some useless number they never\n\n61\n00:03:03.370 --> 00:03:05.380\nuse and it just sits there empty.\n\n62\n00:03:05.380 --> 00:03:06.750\nBut we need to be aware of that,\n\n63\n00:03:06.750 --> 00:03:10.910\nthat in 802.1Q VLAN tagging,\nyou can define a native VLAN.\n\n64\n00:03:10.910 --> 00:03:11.999\nThe default is VLAN1.\n\n65\n00:03:11.999 --> 00:03:16.000\nRight?\nNow VLAN1 is also your management VLAN\n\n66\n00:03:16.000 --> 00:03:16.640\nby default.\n\n67\n00:03:16.640 --> 00:03:20.730\nIf you're gonna into a switch,\nit's usually the IP assigned to VLAN1.\n\n68\n00:03:20.730 --> 00:03:23.900\nBut it could be the IP assigned to other\nVLANs if you wanna set it up that way.\n\n69\n00:03:23.900 --> 00:03:28.500\nSo, the native VLAN kind of has a purpose,\nbut it's not required.\n\n70\n00:03:28.500 --> 00:03:29.880\nWe can always switch it to something else.\n\n71\n00:03:29.880 --> 00:03:32.760\nSo let me show you real quick\nhow we would switch that.\n\n72\n00:03:32.760 --> 00:03:35.816\nIn the last episode, I took my core\nswitch here and I set up some trunks.\n\n73\n00:03:35.816 --> 00:03:40.133\nAnd if I do a show interface trunk, we can\nsee those trunks are still up and running,\n\n74\n00:03:40.133 --> 00:03:43.850\nthat I've got that FA1/0/23 port and\n/24 that are trunking.\n\n75\n00:03:43.850 --> 00:03:50.320\nThey're doing 802.1q and, hang on let\nme get this where we can all see it.\n\n76\n00:03:50.320 --> 00:03:50.880\nThere we go.\n\n77\n00:03:50.880 --> 00:03:53.850\nAnd way over here we've\ngot this native VLAN.\n\n78\n00:03:53.850 --> 00:03:55.730\nAnd the native VLAN for\n\n79\n00:03:55.730 --> 00:03:59.250\nall of my trunks right now is 1 because\nthey're all set to the default.\n\n80\n00:03:59.250 --> 00:04:03.440\nBut I can change that to\na different native VLAN if I want.\n\n81\n00:04:03.440 --> 00:04:05.116\nBut I've gotta be really careful.\n\n82\n00:04:05.116 --> 00:04:05.749\nAll right?\n\n83\n00:04:05.749 --> 00:04:12.350\nThe reason I've gotta be careful is\nbecause this switch, my core one switch,\n\n84\n00:04:12.350 --> 00:04:16.150\nit's gonna receive untagged traffic and\nsay this is on VLAN 1.\n\n85\n00:04:16.150 --> 00:04:19.460\nAnd it's gonna send it untagged\nto the other end of the trunk.\n\n86\n00:04:19.460 --> 00:04:22.480\nAt the other end, it's gonna receive it\nand say, oh, this doesn't have a tag,\n\n87\n00:04:22.480 --> 00:04:23.460\nit must be on VLAN 1.\n\n88\n00:04:23.460 --> 00:04:25.770\nSo, they both know it's on VLAN 1.\n\n89\n00:04:25.770 --> 00:04:30.270\nBut what happens if I change one side and\nnot the other?\n\n90\n00:04:30.270 --> 00:04:31.150\nWell, let me show you.\n\n91\n00:04:31.150 --> 00:04:35.820\nSo here on CORE1, I've got my\nnative VLAN is VLAN 1 on all these.\n\n92\n00:04:35.820 --> 00:04:39.750\nIf I jump over to CORE2 and look for\nthat same information, right?.\n\n93\n00:04:39.750 --> 00:04:43.450\nSo I'm just going to do\na show interface trunk, and\n\n94\n00:04:43.450 --> 00:04:47.330\nI'll see those same trunks over here,\nand they're native VLAN 1.\n\n95\n00:04:47.330 --> 00:04:50.610\nSo, both sides know if traffic\nis not tagged put it on VLAN 1.\n\n96\n00:04:50.610 --> 00:04:52.090\nThey both know that.\n\n97\n00:04:52.090 --> 00:04:52.950\nAll right?\n\n98\n00:04:52.950 --> 00:04:58.360\nBut if I take CORE2 and\nI jump into its configuration and\n\n99\n00:04:58.360 --> 00:05:01.860\nI modify, or\nhere I'll just do one of the ports.\n\n100\n00:05:01.860 --> 00:05:06.890\nSo I'll take one of the ports, port 23,\nand I'm gonna change it's native VLAN.\n\n101\n00:05:06.890 --> 00:05:11.610\nI'm gonna come in here and\njust say switchport trunk native VLAN,\n\n102\n00:05:11.610 --> 00:05:14.755\nand I'm gonna set it to 5.\n\n103\n00:05:14.755 --> 00:05:15.554\nRight?\n\n104\n00:05:15.554 --> 00:05:18.050\nVLAN 5 was my voiceover IP VLAN.\n\n105\n00:05:18.050 --> 00:05:22.260\nAnd so,\nI'm gonna set that as my new native VLAN.\n\n106\n00:05:22.260 --> 00:05:23.030\nOkay?\n\n107\n00:05:23.030 --> 00:05:27.520\nAnd if I take a look at my\ninterface trunk information,\n\n108\n00:05:27.520 --> 00:05:30.640\nI can see right here my\nnative VLAN is VLAN 5.\n\n109\n00:05:30.640 --> 00:05:33.100\nSo now when I send data over that link,\n\n110\n00:05:33.100 --> 00:05:36.860\nif I have traffic on VLAN 5 I'll\nsend it untagged over that link.\n\n111\n00:05:36.860 --> 00:05:41.090\nAnd then that's gonna go to\nmy other switch over here,\n\n112\n00:05:41.090 --> 00:05:45.130\nand it's gonna come in\nuntagged on this port.\n\n113\n00:05:45.130 --> 00:05:47.055\nAnd it's going to say, oh,\nit's untagged, I'll put it on VLAN 1.\n\n114\n00:05:48.090 --> 00:05:50.540\nI just bridged VLAN 1 and VLAN 5.\n\n115\n00:05:50.540 --> 00:05:53.080\nAnd that's bad, right?\n\n116\n00:05:53.080 --> 00:05:54.810\nIt's bad if it's sensitive data,\nif it's private data,\n\n117\n00:05:54.810 --> 00:05:56.520\nif I don't want people\njumping that border.\n\n118\n00:05:56.520 --> 00:05:57.850\nBroadcasts are going between them.\n\n119\n00:05:57.850 --> 00:06:01.590\nThey're effectively linked now,\nVLAN 1 and VLAN 5 are effectively linked.\n\n120\n00:06:01.590 --> 00:06:02.850\nThat's a problem.\n\n121\n00:06:02.850 --> 00:06:05.930\nSo, if you ever adjust your native VLAN,\n\n122\n00:06:05.930 --> 00:06:10.950\nyou gotta do it on both ends of the line,\notherwise you end up with VLAN jumping and\n\n123\n00:06:10.950 --> 00:06:13.620\nyou're jumping from one VLAN to\nthe next and that's not a good thing.\n\n124\n00:06:13.620 --> 00:06:15.700\nSo, always double check, all right?\n\n125\n00:06:15.700 --> 00:06:19.360\nIt's a good idea to look in the show\ninterface trunk output to make sure you've\n\n126\n00:06:19.360 --> 00:06:21.970\ngot the native VLAN defined\non both ends correctly.\n\n127\n00:06:21.970 --> 00:06:23.860\nOr just look at\nthe interface configuration.\n\n128\n00:06:23.860 --> 00:06:25.370\nIt just needs to be the same on both ends.\n\n129\n00:06:25.370 --> 00:06:29.330\nYou can pick whatever VLAN you want,\nbut it needs to be the same.\n\n130\n00:06:29.330 --> 00:06:33.040\nAnd I mentioned how a lot of people pick\na dummy VLAN, a VLAN that's not in use.\n\n131\n00:06:33.040 --> 00:06:35.140\nWell, that's an easy way to do it,\n\n132\n00:06:35.140 --> 00:06:38.270\nis just set it to some high number that\nyou're not gonna use as a port anywhere.\n\n133\n00:06:38.270 --> 00:06:42.920\nAnd now, if somebody tries to do an attack\nto strip off their tag, well, they're\n\n134\n00:06:42.920 --> 00:06:45.840\ngonna end up on this dummy VLAN that has\nno ports, and so they didn't get anywhere.\n\n135\n00:06:45.840 --> 00:06:47.569\nIt's a great way to get\naround that attack.\n\n136\n00:06:47.569 --> 00:06:48.270\nAll right?\n\n137\n00:06:48.270 --> 00:06:52.470\nNow, if you're running CVP\nyou will get status messages.\n\n138\n00:06:52.470 --> 00:06:55.310\nSee my status message is coming up\nhere letting me know there's a native\n\n139\n00:06:55.310 --> 00:06:56.740\nVLAN mismatch.\n\n140\n00:06:56.740 --> 00:07:00.040\nBut if I'm not running CVP,\nI'm not gonna get these messages.\n\n141\n00:07:00.040 --> 00:07:01.500\nAnd so, I might not see that.\n\n142\n00:07:01.500 --> 00:07:03.570\nAnd also, I need to be logged\ninto the switch to see it.\n\n143\n00:07:03.570 --> 00:07:05.300\nI might not be logged\ninto the switch at all.\n\n144\n00:07:05.300 --> 00:07:07.510\nSo, these types of things\ncan go unnoticed for\n\n145\n00:07:07.510 --> 00:07:08.980\na little while and\nreally cause some problems.\n\n146\n00:07:08.980 --> 00:07:10.020\nAll right.\n\n147\n00:07:10.020 --> 00:07:13.620\nSo, I'm gonna set my native VLAN\nto one of those kind of random\n\n148\n00:07:13.620 --> 00:07:15.100\nhigh number type things.\n\n149\n00:07:15.100 --> 00:07:18.280\nSo, one of the ones I like to use is 999,\nright?\n\n150\n00:07:18.280 --> 00:07:21.520\nIt's just an odd number that\nmost people never make use of.\n\n151\n00:07:21.520 --> 00:07:23.340\nIt's a good one to use for a dummy VLAN.\n\n152\n00:07:23.340 --> 00:07:30.900\nAnd so we can get into an interface and we\ncan say switchport trunk native VLAN 999.\n\n153\n00:07:30.900 --> 00:07:31.400\nOkay.\n\n154\n00:07:32.540 --> 00:07:36.220\nNow, I never created VLAN 999.\n\n155\n00:07:36.220 --> 00:07:37.280\nBut I'm okay with that.\n\n156\n00:07:37.280 --> 00:07:38.700\nBecause I don't actually\ncare about this traffic.\n\n157\n00:07:38.700 --> 00:07:40.270\nI'm just trying to make\nthe native VLAN nothing.\n\n158\n00:07:40.270 --> 00:07:42.580\nAnd that way, if somebody attacks\nit they get into nothing.\n\n159\n00:07:42.580 --> 00:07:45.090\nSo, I don't really care if\nthe VLAN exists or not.\n\n160\n00:07:45.090 --> 00:07:46.770\nI'm just gonna designate it.\n\n161\n00:07:46.770 --> 00:07:49.081\nAnd now, I need to jump to the other\nswitch and set that same thing.\n\n162\n00:07:49.081 --> 00:07:52.896\nSo, I'll jump over to my other one here,\nand I'll say switchport, or\n\n163\n00:07:52.896 --> 00:07:55.517\nactually here,\nI've just got it in my history.\n\n164\n00:07:55.517 --> 00:07:57.793\nAnd I'll change that to 999 also.\n\n165\n00:07:57.793 --> 00:08:01.064\nSo now they match, and I'm gonna\nstop getting those error messages.\n\n166\n00:08:01.064 --> 00:08:05.050\nAll right, and if I verify,\nI can come in here and\n\n167\n00:08:05.050 --> 00:08:09.950\nI can see that on those ports\nthat native VLAN is now 999.\n\n168\n00:08:09.950 --> 00:08:13.270\nAnd only traffic on VLAN\n999 will be untagged.\n\n169\n00:08:13.270 --> 00:08:16.191\nI don't have a VLAN 999, so\nthere should be no untagged traffic.\n\n170\n00:08:16.191 --> 00:08:18.938\nAnd that means if somebody\ntries to damage their tag,\n\n171\n00:08:18.938 --> 00:08:20.840\ntheir traffic will get thrown away.\n\n172\n00:08:20.840 --> 00:08:23.412\nIt will go to this dead VLAN with\nno ports, and it'll go away.\n\n173\n00:08:23.412 --> 00:08:27.203\nAll right, so that's kind of a tactic\nthere, so that's a kind of a long answer\n\n174\n00:08:27.203 --> 00:08:31.061\nto what was a short question, of is there\na way to optimize the tagging process.\n\n175\n00:08:31.061 --> 00:08:31.704\n>> Yeah, Don,\n\n176\n00:08:31.704 --> 00:08:35.679\nwe don't wanna be jumping from one VLAN\nto the other without the proper procedure\n\n177\n00:08:35.679 --> 00:08:39.378\nbeing in place, that's why we made VLAN,\nto segregate that traffic out.\n\n178\n00:08:39.378 --> 00:08:42.523\nAnd then you gotta go through\na router while it's filtering and\n\n179\n00:08:42.523 --> 00:08:45.975\nits intelligent engine that it has\nto move that traffic as it should.\n\n180\n00:08:45.975 --> 00:08:49.506\nIf we just link the two together, if I'm\nan attacker I can sit on one VLAN that you\n\n181\n00:08:49.506 --> 00:08:52.195\ndon't care about, but\nnow I have access to the other VLAN and\n\n182\n00:08:52.195 --> 00:08:55.773\nI can start sniffing that traffic and\nmaybe pull something sensitive out of it.\n\n183\n00:08:55.773 --> 00:08:56.890\nRight?\n>> Absolutely.\n\n184\n00:08:58.090 --> 00:08:59.739\nSo that's basically it for native VLANs.\n\n185\n00:08:59.739 --> 00:09:03.716\nIt's just one extra thing we might need\nto configure as we start to setup our\n\n186\n00:09:03.716 --> 00:09:04.291\nnetwork.\n\n187\n00:09:04.291 --> 00:09:11.030\nAll right, now, I mentioned that I don't\nhave VLAN 999 actually in existence.\n\n188\n00:09:11.030 --> 00:09:14.094\nSo, if I wanna go ahead and create it I\ncan, so I can remember what it was or\n\n189\n00:09:14.094 --> 00:09:17.180\notherwise I just see a 999,\nI don't really know what that is.\n\n190\n00:09:17.180 --> 00:09:21.796\nAnd on my switch, like if I take this guy\nhere, and I do a show VLAN, when I look\n\n191\n00:09:21.796 --> 00:09:26.653\nin here, I know that 999 is my default,\nbut it didn't make it into the table.\n\n192\n00:09:26.653 --> 00:09:29.430\nRight?\n999 doesn't actually exist.\n\n193\n00:09:29.430 --> 00:09:32.850\nSo, I might choose to go ahead and\ncreate it, even though I'm not using it.\n\n194\n00:09:32.850 --> 00:09:33.999\nAnd it's not a hard thing to do.\n\n195\n00:09:33.999 --> 00:09:38.679\nBut you can just jump in to your\nconfig and you can say, VLAN 999, and\n\n196\n00:09:38.679 --> 00:09:43.127\nthen I can give it a name, and\nI can call it whatever it is that I want.\n\n197\n00:09:43.127 --> 00:09:45.085\nRight?\nSo, fake VLAN, native,\n\n198\n00:09:45.085 --> 00:09:46.808\nI'm gonna call it Dead end.\n\n199\n00:09:46.808 --> 00:09:47.585\nRight?\n\n200\n00:09:47.585 --> 00:09:50.444\nBecause effectively this\nis a dead end network.\n\n201\n00:09:50.444 --> 00:09:52.021\nRight?\nWe don't use it for anything.\n\n202\n00:09:52.021 --> 00:09:56.342\nNow, when you create a VLAN like this,\nit is actually a real VLAN.\n\n203\n00:09:56.342 --> 00:09:57.762\nRight?\nI've defined it,\n\n204\n00:09:57.762 --> 00:10:00.990\nit exists I could potentially\nput some ports in there.\n\n205\n00:10:00.990 --> 00:10:02.610\nAnd maybe I want that.\n\n206\n00:10:02.610 --> 00:10:06.050\nMaybe I've got some ports that\ndon't have PCs plugged into it and\n\n207\n00:10:06.050 --> 00:10:08.631\ninstead of disabling them I\njust put them on VLAN 999.\n\n208\n00:10:08.631 --> 00:10:09.150\nRight?\n\n209\n00:10:09.150 --> 00:10:11.020\nYou might do that.\n\n210\n00:10:11.020 --> 00:10:12.955\nI usually just disable the port.\n\n211\n00:10:12.955 --> 00:10:16.835\nBut when you configure a VLAN, there's\nactually a lot of little settings in here\n\n212\n00:10:16.835 --> 00:10:20.215\nthat a lot of us never quite mess with.\n\n213\n00:10:20.215 --> 00:10:22.015\nAnd one of these is the state.\n\n214\n00:10:22.015 --> 00:10:25.900\nSee this right here where I've got state,\nthe operational state of the VLAN?\n\n215\n00:10:25.900 --> 00:10:31.480\nThat you can come in and you can say state\nand you can set it to active or suspended.\n\n216\n00:10:31.480 --> 00:10:38.860\nI can suspend the VLAN and so\nnow VLAN 999 exists but it's suspended.\n\n217\n00:10:38.860 --> 00:10:43.640\nAnd that way if I put a port in there\nthe VLAN doesn't actually work.\n\n218\n00:10:43.640 --> 00:10:45.710\nAnd it is truly a dead end.\n\n219\n00:10:45.710 --> 00:10:48.750\nAnd so it's a good idea to do that,\njust kind of cut off that VLAN.\n\n220\n00:10:48.750 --> 00:10:55.380\nAnd if I do a show VLAN and take a look\nat that output when I come in here,\n\n221\n00:10:55.380 --> 00:10:59.530\nI can see VLAN 999 is my dead\nend network and it's suspended.\n\n222\n00:10:59.530 --> 00:11:00.830\nIt's not active.\n\n223\n00:11:00.830 --> 00:11:04.480\nIt's up and it's running,\nit's just not allowing communications.\n\n224\n00:11:04.480 --> 00:11:05.230\n>> Yeah.\n\n225\n00:11:05.230 --> 00:11:08.070\nNow, Don, I was watching you,\nyou've been doing some configuration.\n\n226\n00:11:08.070 --> 00:11:10.440\nWe're getting the switch, we're getting\nthe VLANs the way we want them.\n\n227\n00:11:10.440 --> 00:11:14.870\nWe got a nice dead end VLAN there so\nwe can put ports in there if we need to.\n\n228\n00:11:14.870 --> 00:11:19.080\nBut if I need to do that across the board\nlike when we set up just a second ago for\n\n229\n00:11:19.080 --> 00:11:20.985\nthe VLAN hopping,\nwe didn't want that to occur.\n\n230\n00:11:20.985 --> 00:11:24.060\nIt'll go to this switch, type in all\nthe commands, get everything to work.\n\n231\n00:11:24.060 --> 00:11:26.050\nYou had to go to the other switch and\ndo the same thing.\n\n232\n00:11:26.050 --> 00:11:27.582\nThere's gotta be better way to do this.\n\n233\n00:11:27.582 --> 00:11:32.350\n>> Yeah and we mentioned it a little bit\nin the last episode about how all our VLAN\n\n234\n00:11:32.350 --> 00:11:34.470\nconfigurations going\nto that VLAN.dat file.\n\n235\n00:11:34.470 --> 00:11:37.710\nAnd the VLAN.dat you can't just\ncopy that between switches,\n\n236\n00:11:37.710 --> 00:11:39.510\nit causes all sorts of problems.\n\n237\n00:11:39.510 --> 00:11:42.227\nBut my configuration is\nnot common right now.\n\n238\n00:11:42.227 --> 00:11:44.320\nRight?\nI'm creating a configuration on one\n\n239\n00:11:44.320 --> 00:11:46.190\nswitch, it stays on that one switch.\n\n240\n00:11:46.190 --> 00:11:48.650\nFortunately there's a protocol\nthat can help us with that\n\n241\n00:11:48.650 --> 00:11:50.450\ncalled the VLAN Trunking Protocol.\n\n242\n00:11:50.450 --> 00:11:53.390\nAll right, let's look at my switches\nbefore we dive into this too far.\n\n243\n00:11:53.390 --> 00:11:57.067\nSo on this switch on core two I\ncreated VLAN 999, that's the dead end.\n\n244\n00:11:57.067 --> 00:11:59.029\nBut what about my other VLANS?\n\n245\n00:11:59.029 --> 00:12:01.496\nRight?\nIf we remember over on core one,\n\n246\n00:12:01.496 --> 00:12:06.205\nI had some more VLANS over here, if I\ndo a show vlan brief and pull this up,\n\n247\n00:12:06.205 --> 00:12:10.317\nwhat you'll see is I've got VLAN two,\nthree, four and five.\n\n248\n00:12:10.317 --> 00:12:12.449\nRight?\nSales, marketing, DMZ, VoIP.\n\n249\n00:12:13.520 --> 00:12:14.114\nWhere are those?\n\n250\n00:12:14.114 --> 00:12:15.914\nThose didn't show up on the other switch.\n\n251\n00:12:15.914 --> 00:12:16.437\nRight?\n\n252\n00:12:16.437 --> 00:12:18.671\nAnd Vlan 999,\nI created that on the other switch.\n\n253\n00:12:18.671 --> 00:12:19.649\nThat doesn't show up here.\n\n254\n00:12:19.649 --> 00:12:20.205\nRight?\n\n255\n00:12:20.205 --> 00:12:23.460\nThey're not sharing their VLAN database.\n\n256\n00:12:23.460 --> 00:12:24.970\nAll they're doing is building up a trunk.\n\n257\n00:12:24.970 --> 00:12:29.420\nSo I'm sending the other switch traffic\nfor VLANS two, three, four and five.\n\n258\n00:12:29.420 --> 00:12:31.180\nBut the other side is just throwing\nit away because it doesn't know\n\n259\n00:12:31.180 --> 00:12:32.000\nabout those VLANS.\n\n260\n00:12:32.000 --> 00:12:34.390\nAnd they're sending me\ntraffic on VLAN 999 and\n\n261\n00:12:34.390 --> 00:12:38.030\nI'm throwing it away because I\ndon't know about that VLAN either.\n\n262\n00:12:38.030 --> 00:12:39.900\nRight?\nI have it set as a native VLAN but\n\n263\n00:12:39.900 --> 00:12:42.448\nit's not actually in my VLAN database so\nit doesn't matter.\n\n264\n00:12:42.448 --> 00:12:46.940\nAll right, so what I really need is a way\nto commonly share configuration between\n\n265\n00:12:46.940 --> 00:12:47.970\nthese switches.\n\n266\n00:12:47.970 --> 00:12:52.760\nAnd the easiest way to do that is\nwith VTP, the VLAN Trunking Protocol.\n\n267\n00:12:52.760 --> 00:12:55.400\nNow VTP is Cisco proprietary,\nCisco made this.\n\n268\n00:12:55.400 --> 00:12:58.490\nI've never encountered a third party\nvendor that supported it although\n\n269\n00:12:58.490 --> 00:13:01.880\ntechnically anybody can license it from\nCisco, I just don't know anybody who has.\n\n270\n00:13:01.880 --> 00:13:03.770\nPeople don't like to pay Cisco I guess.\n\n271\n00:13:03.770 --> 00:13:07.030\nBut anybody can support it if they want.\n\n272\n00:13:07.030 --> 00:13:09.870\nCisco, they're really the only\nones that do it right now.\n\n273\n00:13:09.870 --> 00:13:12.980\nAnd what VTP is just a common\nlanguage that switches can use to\n\n274\n00:13:12.980 --> 00:13:14.100\ntalk to each other.\n\n275\n00:13:14.100 --> 00:13:15.577\nAnd when they talk to each other,\nthey share information.\n\n276\n00:13:15.577 --> 00:13:18.156\nThey say hey, I know about VLAN 999,\nhow about you?\n\n277\n00:13:18.156 --> 00:13:20.555\nAnd the other switch can say,\nI didn't know that.\n\n278\n00:13:20.555 --> 00:13:22.525\nLet me add that to my database.\n\n279\n00:13:22.525 --> 00:13:26.935\nSo, now you can create a VLAN in one\nplace, and it gets created everywhere.\n\n280\n00:13:26.935 --> 00:13:28.585\nRight?\nThat's a big deal.\n\n281\n00:13:28.585 --> 00:13:31.235\nThat really helps us\nwith our configuration,\n\n282\n00:13:31.235 --> 00:13:32.985\nespecially if you have a lot of switches.\n\n283\n00:13:32.985 --> 00:13:35.305\nEven if you just have two switches though,\nit can save you time.\n\n284\n00:13:35.305 --> 00:13:36.463\nBut imagine if you had 200 switches.\n\n285\n00:13:36.463 --> 00:13:39.805\nYou don't wanna have to go in to find\na VLAN on every single one of them,\n\n286\n00:13:39.805 --> 00:13:40.535\nthat creates a problem.\n\n287\n00:13:40.535 --> 00:13:41.805\nAll right.\n\n288\n00:13:41.805 --> 00:13:46.580\nAnd then, with trunking, remember, I said\nwe could prune off VLAN's if we wanted?\n\n289\n00:13:46.580 --> 00:13:48.880\nWe could manually disable some of those.\n\n290\n00:13:48.880 --> 00:13:50.455\nVTP can actually do that automatically.\n\n291\n00:13:50.455 --> 00:13:54.921\nIt can look and it can say, that switch\nover there, it doesn't have any ports that\n\n292\n00:13:54.921 --> 00:13:58.317\nare in VLAN7, so,\nI'm not gonna send VLAN7 traffic to it.\n\n293\n00:13:58.317 --> 00:14:01.233\nVTP can do automatic pruning of VLANs.\n\n294\n00:14:01.233 --> 00:14:05.010\nAnd that's a really handy thing because\nit really reserves on bandwidth.\n\n295\n00:14:05.010 --> 00:14:06.718\nSo VTP does a lot of great stuff and\n\n296\n00:14:06.718 --> 00:14:09.646\nmy favorite feature of VTP is\nhow easy it is to configure.\n\n297\n00:14:09.646 --> 00:14:11.713\nIt only takes a few commands and\nyou're done.\n\n298\n00:14:11.713 --> 00:14:14.459\nRight?\nSo, really easy to get it set up and\n\n299\n00:14:14.459 --> 00:14:15.980\nin place.\n\n300\n00:14:15.980 --> 00:14:18.615\nNow, before I dive into\nactually how to configure VTP,\n\n301\n00:14:18.615 --> 00:14:22.320\nit's important to understand that\nCisco has evolved it over the years.\n\n302\n00:14:22.320 --> 00:14:24.559\nThe current version of\nVTP is VTP version three.\n\n303\n00:14:24.559 --> 00:14:27.813\nAnd there have been subtle\nchanges over the years, and\n\n304\n00:14:27.813 --> 00:14:32.765\nthere are some well known text books that\nare out there right now that say use VTP2,\n\n305\n00:14:32.765 --> 00:14:34.406\nit's the most common one.\n\n306\n00:14:34.406 --> 00:14:37.786\nAll right, well that might have been\ntrue when that book was written,\n\n307\n00:14:37.786 --> 00:14:41.110\nalthough it's a pretty recent book,\nVTP3 is the most common.\n\n308\n00:14:41.110 --> 00:14:43.720\nThat's the one that you see today,\nthat's the one you really wanna use and\n\n309\n00:14:43.720 --> 00:14:45.390\nit gives you the most features.\n\n310\n00:14:45.390 --> 00:14:47.773\nVTP version one,\nthat was just the base version and\n\n311\n00:14:47.773 --> 00:14:50.333\nit was written a long time ago,\nback in the 1990s.\n\n312\n00:14:50.333 --> 00:14:53.331\nIt only supports VLANS one through 1024.\n\n313\n00:14:53.331 --> 00:14:55.710\nAll right, not the extended range.\n\n314\n00:14:55.710 --> 00:14:59.076\nSo it doesn't support the newer vlan\nnumbers, and that's gonna be a problem.\n\n315\n00:14:59.076 --> 00:15:01.677\nSo you don't wanna run VTP\nversion one if you can avoid it.\n\n316\n00:15:01.677 --> 00:15:04.680\nAll right, VTP version two, same problem.\n\n317\n00:15:04.680 --> 00:15:07.900\nStill one through 1024 and that's\nwhy I say don't run VTP version two,\n\n318\n00:15:07.900 --> 00:15:09.540\ndo version three if you can.\n\n319\n00:15:09.540 --> 00:15:10.490\nAll right.\n\n320\n00:15:10.490 --> 00:15:11.390\nBut it did add some other score.\n\n321\n00:15:11.390 --> 00:15:13.073\nIt added score for things like Token Ring.\n\n322\n00:15:13.073 --> 00:15:14.586\nI know we're all dying for\nthat feature right now.\n\n323\n00:15:14.586 --> 00:15:15.108\nRight?\n\n324\n00:15:15.108 --> 00:15:15.886\n>> Yeah, I need it.\n\n325\n00:15:15.886 --> 00:15:16.945\n>> [LAUGH]\n>> But\n\n326\n00:15:16.945 --> 00:15:19.751\nI mentioned it because it gives you\nan idea of how old this protocol is.\n\n327\n00:15:19.751 --> 00:15:20.367\nRight?\n\n328\n00:15:20.367 --> 00:15:23.950\nSo that's definitely not something\nwe're necessarily going to jump on.\n\n329\n00:15:23.950 --> 00:15:27.910\nVTP version three, that's where we got\nthe extended VLAN range supporter.\n\n330\n00:15:27.910 --> 00:15:29.100\nThat's an important one to us.\n\n331\n00:15:29.100 --> 00:15:32.350\nWe have better authentication\nmechanisms as a part of it.\n\n332\n00:15:32.350 --> 00:15:34.000\nIt's a more reliable version.\n\n333\n00:15:34.000 --> 00:15:35.760\nVTP version three is the one that we want.\n\n334\n00:15:36.910 --> 00:15:39.520\nAll right,\ngetting it configured is pretty easy.\n\n335\n00:15:39.520 --> 00:15:43.490\nIn fact, on your switches,\nVTP might already be configured and\n\n336\n00:15:43.490 --> 00:15:44.665\nyou don't even know it.\n\n337\n00:15:44.665 --> 00:15:46.241\nRight?\nIt's not on mine, I know it's not,\n\n338\n00:15:46.241 --> 00:15:47.641\ncuz I'm not sharing my configuration.\n\n339\n00:15:47.641 --> 00:15:50.985\nBut on some switches,\nthey can auto-configure.\n\n340\n00:15:50.985 --> 00:15:54.468\nAll it takes is having one switch set up.\n\n341\n00:15:54.468 --> 00:15:56.627\nAnd your other switches\nwill learn about VTP.\n\n342\n00:15:56.627 --> 00:16:00.280\nIt actually teaches them about VTP,\nwhich is pretty awesome.\n\n343\n00:16:00.280 --> 00:16:03.530\nBut you can always go and manually\nset it up on your switches too and\n\n344\n00:16:03.530 --> 00:16:05.120\nget this put in place.\n\n345\n00:16:05.120 --> 00:16:07.640\nVTP works off of a simple principle.\n\n346\n00:16:07.640 --> 00:16:10.330\nWhen you have VTP set up,\nyou have what's called a domain name.\n\n347\n00:16:10.330 --> 00:16:12.990\nIt's just a name,\nit's a name that you assign it.\n\n348\n00:16:12.990 --> 00:16:18.330\nAnd every other switch that has the same\ndomain name shares its config, super easy.\n\n349\n00:16:18.330 --> 00:16:19.180\nWe can add a password,\n\n350\n00:16:19.180 --> 00:16:23.050\ntoo, if we want authentication,\nbut it only runs on trunks.\n\n351\n00:16:23.050 --> 00:16:25.442\nAnd so\nif you're controlling your trunk ports,\n\n352\n00:16:25.442 --> 00:16:29.761\nthen you usually don't need authentication\nfor this because your attackers can't get\n\n353\n00:16:29.761 --> 00:16:32.642\nat a trunk unless they get\nphysical access on the network.\n\n354\n00:16:32.642 --> 00:16:34.859\nAnd if they have physical\naccess to the network,\n\n355\n00:16:34.859 --> 00:16:36.590\nI mean physical access to the switch,\n\n356\n00:16:36.590 --> 00:16:40.235\nthen you've got bigger problems and\nyour VTP password's not going to matter.\n\n357\n00:16:40.235 --> 00:16:41.804\nAll right.\n>> I'm guessing Cisco wants you to know\n\n358\n00:16:41.804 --> 00:16:43.110\nhow to put a password on it though.\n\n359\n00:16:43.110 --> 00:16:46.400\n>> Yeah, for the exam we need to know,\nand it only takes a moment so\n\n360\n00:16:46.400 --> 00:16:48.820\nyou might as well state a password\non there, it doesn't matter.\n\n361\n00:16:48.820 --> 00:16:49.560\nAll right.\n\n362\n00:16:49.560 --> 00:16:51.370\nBut beginning vtp setup\nis as simple as this.\n\n363\n00:16:51.370 --> 00:16:53.320\nSo I'm gonna start here on core one.\n\n364\n00:16:53.320 --> 00:16:56.810\nAnd core one, if you look at it,\nI've got vlan one, two, three, four, five.\n\n365\n00:16:56.810 --> 00:16:58.440\nI don't have vlan 999.\n\n366\n00:16:58.440 --> 00:17:02.850\nIf I do a show vtp status,\n\n367\n00:17:02.850 --> 00:17:06.282\nI can take a look at how vtp is\nconfigured on this switch right now.\n\n368\n00:17:06.282 --> 00:17:09.000\nAll right, and I can see that\nit's actually running on VTP and\n\n369\n00:17:09.000 --> 00:17:10.930\non the VTP server.\n\n370\n00:17:11.980 --> 00:17:17.130\nThere's three modes of VTP, server,\nclient, and transparent, all right?\n\n371\n00:17:17.130 --> 00:17:20.710\nServer, that's somebody who controls\nthe database, and can make changes.\n\n372\n00:17:20.710 --> 00:17:24.100\nI can make changes and I can advertise\nthe database, and that's the default.\n\n373\n00:17:24.100 --> 00:17:27.820\nClient, client is somebody who\ncan learn the database, but\n\n374\n00:17:27.820 --> 00:17:30.020\nis not allowed to change it.\n\n375\n00:17:30.020 --> 00:17:32.280\nWe can only make changes on a server.\n\n376\n00:17:32.280 --> 00:17:33.520\nWe can't make changes on a client.\n\n377\n00:17:34.812 --> 00:17:38.990\nSo what we normally do is, we pick\none switch to act as the server and\n\n378\n00:17:38.990 --> 00:17:41.190\nwe put all of our other\nswitches as clients.\n\n379\n00:17:41.190 --> 00:17:44.120\nAnd then we just go to that one switch\nto make changes and it propagates out.\n\n380\n00:17:44.120 --> 00:17:45.410\nIt creates a nice, stable network.\n\n381\n00:17:46.640 --> 00:17:48.170\nThe default is server,\nthough, and in theory,\n\n382\n00:17:48.170 --> 00:17:50.390\nyou could have all of your\nswitches be at server.\n\n383\n00:17:50.390 --> 00:17:54.490\nBut the more switches you have as\na server, the more likelihood you have\n\n384\n00:17:54.490 --> 00:17:58.380\nof somebody making a change on two\ndifferent switches at the same time and\n\n385\n00:17:58.380 --> 00:17:59.080\ncreating a conflict.\n\n386\n00:17:59.080 --> 00:18:01.540\nYou know, maybe Daniel is working\non one of the access switches and\n\n387\n00:18:01.540 --> 00:18:06.380\ncreates vlan 999 and makes it a dead end,\nand then I configure\n\n388\n00:18:06.380 --> 00:18:11.720\na new advertising department, and\nI make it vlan 999 on a different switch.\n\n389\n00:18:11.720 --> 00:18:13.230\nNow we got a duplicate, right?\n\n390\n00:18:13.230 --> 00:18:16.690\nAnd we conflict, so it's kinda nice\nto have it consolidated in one place.\n\n391\n00:18:16.690 --> 00:18:21.460\nNow, I usually get a question about this,\nabout, what about redundancy?\n\n392\n00:18:21.460 --> 00:18:22.680\nWhat if my server goes down?\n\n393\n00:18:22.680 --> 00:18:24.980\nIf I only have one server,\nwhat happens when it goes down?\n\n394\n00:18:24.980 --> 00:18:27.160\nThe short answer, absolutely nothing.\n\n395\n00:18:27.160 --> 00:18:29.980\nIf it goes down, everything's fine,\nall your clients keep running.\n\n396\n00:18:29.980 --> 00:18:32.070\nYou just can't make changes.\n\n397\n00:18:32.070 --> 00:18:35.590\nAnd if you want to make changes,\nyou just go to one of your clients and\n\n398\n00:18:35.590 --> 00:18:36.270\nchange it to a server.\n\n399\n00:18:36.270 --> 00:18:37.970\nNow you can make changes, it's that easy.\n\n400\n00:18:37.970 --> 00:18:39.938\nYou can go to any client,\nflag it as a server,\n\n401\n00:18:39.938 --> 00:18:43.090\nmake your change, and then you can turn\nit back to a client again if you want.\n\n402\n00:18:43.090 --> 00:18:44.810\nYou can do that, it works, right?\n\n403\n00:18:44.810 --> 00:18:45.840\nSo you've got that control.\n\n404\n00:18:47.060 --> 00:18:50.506\nNow the third mode is transparent,\nand transparent is a special one.\n\n405\n00:18:50.506 --> 00:18:56.420\nAll right, transparent says I'm a part\nof VTP, but I'm kind of ignoring it.\n\n406\n00:18:57.680 --> 00:19:00.100\nIt says,\nI'm not going to learn VLANs from you and\n\n407\n00:19:00.100 --> 00:19:04.050\nI'm not going to tell you about my VLANs,\nbut what I am gonna do is I'm gonna take\n\n408\n00:19:04.050 --> 00:19:08.200\nyour advertisements and I'm gonna pass\nthem on to other switches that I know.\n\n409\n00:19:08.200 --> 00:19:12.610\nA transparent switch allows the VTP\nadvertisements to pass right through it.\n\n410\n00:19:12.610 --> 00:19:14.880\nAnd we'd really only do that\non switches that were used for\n\n411\n00:19:14.880 --> 00:19:18.690\nthings like DMZs, where we didn't\nwant them participating in VTP but\n\n412\n00:19:18.690 --> 00:19:20.880\nwe didn't want them to block\nthe VTP communications.\n\n413\n00:19:20.880 --> 00:19:23.640\nAll right, so that's where you\nuse that transparent mode,\n\n414\n00:19:23.640 --> 00:19:26.170\notherwise we don't really use\ntransparent mode very much.\n\n415\n00:19:26.170 --> 00:19:31.240\n>> So switch could be in line with another\nswitch, even though this one's in,\n\n416\n00:19:31.240 --> 00:19:34.460\nwe put that one in transparent mode,\nthat way it still passes that along\n\n417\n00:19:34.460 --> 00:19:37.500\neven though it's not really\ncaring about that information.\n\n418\n00:19:37.500 --> 00:19:39.175\n>> That's exactly it,\nyou just don't want it to get in the way.\n\n419\n00:19:39.175 --> 00:19:42.035\nCuz normally your switches are only\ntalking to their immediate neighbors,\n\n420\n00:19:42.035 --> 00:19:46.360\ncuz they talk over the trunk ports and\nthat's it, so, it's kind of like RIP or\n\n421\n00:19:46.360 --> 00:19:48.709\nany of the distance vector protocols,\nthey only talk to their neighbor.\n\n422\n00:19:50.050 --> 00:19:55.020\nNow when we get a system set up,\nbasically it creates a database, and\n\n423\n00:19:55.020 --> 00:19:56.030\nthe database has a version number.\n\n424\n00:19:56.030 --> 00:20:01.280\nAnd if you look at mine, see how I've got\nmaximum VLAN supported locally, 1005?\n\n425\n00:20:01.280 --> 00:20:02.530\nWell, that's the old numbering, right?\n\n426\n00:20:02.530 --> 00:20:04.608\nAnd that's cuz I'm in\na lower version of VTP.\n\n427\n00:20:04.608 --> 00:20:08.508\nAnd I can see number of existing VLANs,\nVLAN 9, right?\n\n428\n00:20:08.508 --> 00:20:11.370\nI can see, or\nI've had nine created, I guess.\n\n429\n00:20:11.370 --> 00:20:12.820\nAnd then Configuration Revision 7.\n\n430\n00:20:12.820 --> 00:20:15.110\nWhat does that mean?\n\n431\n00:20:15.110 --> 00:20:18.020\nThat means when VTP was\noriginally configured,\n\n432\n00:20:18.020 --> 00:20:21.790\nI've made seven changes since then,\nand so it's tracking those changes.\n\n433\n00:20:21.790 --> 00:20:25.100\nAnd it's that version number\nthat gets shared between clients\n\n434\n00:20:25.100 --> 00:20:27.040\nto let them know who has\nthe latest copy of the database.\n\n435\n00:20:27.040 --> 00:20:30.660\nAnd we have to be careful with that\nbecause if you buy a switch off of Ebay,\n\n436\n00:20:31.660 --> 00:20:36.630\nyou could get one that had 100,\n200, 1,000 changes made to it and\n\n437\n00:20:36.630 --> 00:20:40.350\nit's revision number might be really high,\nand you put it on your network and\n\n438\n00:20:40.350 --> 00:20:44.570\nyour production switches might have,\nyou know, 90 changes.\n\n439\n00:20:44.570 --> 00:20:46.880\nThey see this new switch as\nhaving a newer database and\n\n440\n00:20:46.880 --> 00:20:48.940\nthey download that database and\noverwrite yours.\n\n441\n00:20:48.940 --> 00:20:50.430\nThat would be bad, right?\n\n442\n00:20:50.430 --> 00:20:53.290\nSo any time we bring a new\nswitch into the network,\n\n443\n00:20:53.290 --> 00:20:55.730\nit's a good idea to reset\nthe revision number.\n\n444\n00:20:55.730 --> 00:20:56.260\nAll right?\n\n445\n00:20:56.260 --> 00:20:58.330\nAnd the easiest way to do that\nis to make it transparent.\n\n446\n00:20:58.330 --> 00:21:01.650\nWhen you flip it to transparent mode,\nthe revision number becomes zero, and then\n\n447\n00:21:01.650 --> 00:21:04.800\nwhen you flip it back to server or client\nmode, it starts counting up from there.\n\n448\n00:21:04.800 --> 00:21:08.750\nSo that's a quick and easy way to reset\nthat, or deleting your VLAN.dat file and\n\n449\n00:21:08.750 --> 00:21:11.130\nrebooting is another way to do it.\n\n450\n00:21:11.130 --> 00:21:14.490\nSo that's what that revision number is.\n\n451\n00:21:14.490 --> 00:21:21.130\nNow that 1005 up here, that's because if I\nlook way up here, VTP Version running one.\n\n452\n00:21:21.130 --> 00:21:24.640\nMy switch is capable of running one to\nthree, but it's defaulting to one, so\n\n453\n00:21:24.640 --> 00:21:27.060\nI'm gonna wanna change that if I\nwant to support higher WLAN numbers.\n\n454\n00:21:28.730 --> 00:21:36.360\nNow the domain name, on a Cisco switch the\ndefault domain name is empty, it's null.\n\n455\n00:21:36.360 --> 00:21:39.450\nAnd what that means is this switch\nis gonna look out on the network and\n\n456\n00:21:39.450 --> 00:21:41.460\nlook for\nwhat VTP domain is already being used.\n\n457\n00:21:41.460 --> 00:21:45.460\nThis is that learning part, and\nthe first VTP advertisement it sees,\n\n458\n00:21:45.460 --> 00:21:48.360\nit'll steal that domain name and\nuse it, and now we're in that domain.\n\n459\n00:21:48.360 --> 00:21:49.690\nThat's how the switches\ncan auto-configure.\n\n460\n00:21:49.690 --> 00:21:54.300\nIf you have one switch configured for\nVTP, the others will learn.\n\n461\n00:21:54.300 --> 00:21:56.820\nIf you don't want that,\nyou can manually set the name, and\n\n462\n00:21:56.820 --> 00:21:59.510\nnow it can be in a separate domain or\ntogether.\n\n463\n00:21:59.510 --> 00:22:01.480\nNow all of this is built\noff of trunk ports, so\n\n464\n00:22:01.480 --> 00:22:04.830\nit's important to remember VTP\ndoes not pass through routers.\n\n465\n00:22:04.830 --> 00:22:09.760\nSo, you'll have VTP in one network,\nlike your home office, and\n\n466\n00:22:09.760 --> 00:22:12.860\neach branch office might\nhave its own VTP instance.\n\n467\n00:22:12.860 --> 00:22:16.650\nIt doesn't pass through routers, it's just\nover these trunk ports and that's it.\n\n468\n00:22:18.310 --> 00:22:19.770\nSo, let's get this turkey turned on.\n\n469\n00:22:21.440 --> 00:22:22.720\nTechnically it's already running but\n\n470\n00:22:22.720 --> 00:22:25.760\nI didn't do that, that's all just default\nstuff, so I wanna configure it my way.\n\n471\n00:22:25.760 --> 00:22:28.610\nSo I'm gonna start by\nsetting my VTP domain.\n\n472\n00:22:28.610 --> 00:22:32.080\nSo I'm just gonna say VTP domain and\nthen whenever I wanna call it,\n\n473\n00:22:32.080 --> 00:22:33.610\nmaybe I'll call mine ITProTV.\n\n474\n00:22:34.930 --> 00:22:38.630\nSo now it changed it from null,\nempty, into ITProTV.\n\n475\n00:22:38.630 --> 00:22:42.520\nI just became the new VTP domain.\n\n476\n00:22:42.520 --> 00:22:46.080\nIf my other switches are empty,\nthey're learning this right now, and\n\n477\n00:22:46.080 --> 00:22:49.405\nthey're gonna automatically join ITProTV,\nso they're gonna knock that out.\n\n478\n00:22:49.405 --> 00:22:54.963\nNow, I can continue on and\nset a few other things, right?\n\n479\n00:22:54.963 --> 00:23:00.710\nI can say VTP version, and then specify\nwhat version I want to run, okay?\n\n480\n00:23:00.710 --> 00:23:02.580\nAnd I want to run VTP version three.\n\n481\n00:23:02.580 --> 00:23:05.830\nSo i'm gonna go ahead and hit that so\nthat i can support my newer numbers and\n\n482\n00:23:05.830 --> 00:23:06.850\nall that other good stuff.\n\n483\n00:23:06.850 --> 00:23:10.620\nAnd so here i'm getting a warning telling\nme I've got an old config file, and\n\n484\n00:23:10.620 --> 00:23:13.540\nit's gonna convert it over to version\nthree, but I need to be careful and\n\n485\n00:23:13.540 --> 00:23:15.540\nmake sure my settings came over.\n\n486\n00:23:15.540 --> 00:23:18.210\nWell, I don't have a lot of settings,\nso there's not much to come over, so\n\n487\n00:23:18.210 --> 00:23:18.988\nit's no big deal.\n\n488\n00:23:18.988 --> 00:23:22.390\nBut, I could do a show VTP status and\na show VLAN brief and\n\n489\n00:23:22.390 --> 00:23:24.480\njust verify that all my\nconfigs are still fine.\n\n490\n00:23:24.480 --> 00:23:25.090\nThey're normally fine.\n\n491\n00:23:25.090 --> 00:23:28.120\nAll right, so we're good there.\n\n492\n00:23:28.120 --> 00:23:30.960\nAnd it tells me in the future it's gonna\nwrite version three files from now on, so\n\n493\n00:23:30.960 --> 00:23:31.870\nwe'll be good to go there.\n\n494\n00:23:32.880 --> 00:23:37.400\nAll right, then if I want to set\na password, I can say VTP password and\n\n495\n00:23:37.400 --> 00:23:38.770\nwhatever I want that password to be.\n\n496\n00:23:38.770 --> 00:23:41.762\nI'm gonna leave that off right now,\ncuz I want to see if my other switch\n\n497\n00:23:41.762 --> 00:23:44.684\nautolearned, and you can't\nautolearn when there's a password.\n\n498\n00:23:44.684 --> 00:23:47.306\nRight, it's not gonna teach\nsomebody the password,\n\n499\n00:23:47.306 --> 00:23:49.251\nthat kind of defeats the whole purpose.\n\n500\n00:23:49.251 --> 00:23:52.386\nAnd then lastly, I can say VTP mode.\n\n501\n00:23:52.386 --> 00:23:56.384\nAnd here's where I can specify,\nclient, server or transparent.\n\n502\n00:23:56.384 --> 00:23:59.610\nAnd we can also do off,\nwhere just disables VTP all together.\n\n503\n00:23:59.610 --> 00:24:00.610\nRight?\nYou just not gonna use it,\n\n504\n00:24:00.610 --> 00:24:02.540\nyou can turn it off and that's it.\n\n505\n00:24:02.540 --> 00:24:04.680\nOff and transparent are different.\n\n506\n00:24:04.680 --> 00:24:07.610\nTransparent, we don't participate in VTP,\nbut\n\n507\n00:24:07.610 --> 00:24:09.460\nwe allow the advertisements\nto pass through us.\n\n508\n00:24:09.460 --> 00:24:12.400\nRight?\nWhere we creating those advertisements.\n\n509\n00:24:12.400 --> 00:24:15.620\nFor off, we throw away the advertisements.\n\n510\n00:24:15.620 --> 00:24:18.720\nSo if there's another switch on our other\nside, we don't send it over to them and\n\n511\n00:24:18.720 --> 00:24:20.650\nthey don't bond together.\n\n512\n00:24:20.650 --> 00:24:23.450\nSo Office is a bit different.\n\n513\n00:24:23.450 --> 00:24:28.240\nBut now, I'm up and I'm running VTP and if\nI do a show VLAN brief, I can look in my\n\n514\n00:24:28.240 --> 00:24:33.860\nconfiguration, and I still have VLANs 1,\n2, 3, 4, and 5, so I'm good there.\n\n515\n00:24:33.860 --> 00:24:39.190\nAnd if I do a show vtp status, and\nI look at the output for that one.\n\n516\n00:24:39.190 --> 00:24:42.729\nWell I can look up here and\nI can see I am version three,\n\n517\n00:24:42.729 --> 00:24:45.732\nmy domain name is ITPROTV so\nI'm good there.\n\n518\n00:24:45.732 --> 00:24:50.402\nAnd if I look down a bit I'm in server\nmode, I've got, still seeing maximum vlan\n\n519\n00:24:50.402 --> 00:24:53.975\nsupported locally 1005,\nI guess that hasn't updated or\n\n520\n00:24:53.975 --> 00:24:58.345\nit might be that this particular\nswitch has that built in maximum.\n\n521\n00:24:58.345 --> 00:25:01.515\nBut everything else looks okay and\nwe should be all right.\n\n522\n00:25:01.515 --> 00:25:04.040\nMy revision number reset.\n\n523\n00:25:04.040 --> 00:25:07.360\nI mentioned going into transparent\nmode reset through a revision number.\n\n524\n00:25:07.360 --> 00:25:10.350\nChanging the domain resets\nthe revision number also, but\n\n525\n00:25:10.350 --> 00:25:12.000\nwe don't normally change the domain name.\n\n526\n00:25:12.000 --> 00:25:14.460\nSo to reset it, it's usually easier\nto go into transparent mode.\n\n527\n00:25:14.460 --> 00:25:16.050\nEither one works.\n\n528\n00:25:16.050 --> 00:25:17.820\nSo we're up and we're going.\n\n529\n00:25:17.820 --> 00:25:19.060\nNow we're in business, okay.\n\n530\n00:25:19.060 --> 00:25:21.240\nNow I'm gonna take a look\nat my other switch.\n\n531\n00:25:21.240 --> 00:25:22.600\nI'm gonna jump over to core two.\n\n532\n00:25:22.600 --> 00:25:26.360\nThis is my other switch,\nwhich is apparently timed out.\n\n533\n00:25:26.360 --> 00:25:31.030\nAnd on this one, I haven't configured VTP\nbut I'm gonna do a show VTP status anyway,\n\n534\n00:25:31.030 --> 00:25:32.650\nand when I look in here.\n\n535\n00:25:33.710 --> 00:25:35.720\nIt's already learned ITProTV.\n\n536\n00:25:35.720 --> 00:25:36.720\nThere it is.\nSo\n\n537\n00:25:36.720 --> 00:25:40.150\nit's already learned that domain name\nfrom the network cuz it was null before.\n\n538\n00:25:40.150 --> 00:25:43.390\nBut it's up as a server and\nthat might not be what I want.\n\n539\n00:25:43.390 --> 00:25:45.510\nAnd my revision number was zero.\n\n540\n00:25:45.510 --> 00:25:47.700\nThis guy's revision number is seven.\n\n541\n00:25:47.700 --> 00:25:49.180\nThat's dangerous isn't it?\n\n542\n00:25:49.180 --> 00:25:51.950\nIf I make another change on here, this\none's gonna overwrite my other database.\n\n543\n00:25:51.950 --> 00:25:52.690\nThat'd be bad.\n\n544\n00:25:52.690 --> 00:25:53.590\nI don't want that.\n\n545\n00:25:53.590 --> 00:25:55.990\nSo I got a couple of things I need to fix,\nand my version number is 1.\n\n546\n00:25:55.990 --> 00:25:57.270\nI need to fix that.\n\n547\n00:25:57.270 --> 00:25:59.470\nSo we gotta fix a couple of things.\n\n548\n00:25:59.470 --> 00:26:02.690\nSo I'm gonna jump into my configuration,\nand\n\n549\n00:26:02.690 --> 00:26:08.340\nI'm just gonna start by\nsaying vtp mode transparent.\n\n550\n00:26:08.340 --> 00:26:09.250\nOkay.\n\n551\n00:26:09.250 --> 00:26:12.890\nI'm going into transparent mode because\nI want to reset my revision number and\n\n552\n00:26:12.890 --> 00:26:19.320\nif I do a show VTP status I should see\nthat revision number is now reset.\n\n553\n00:26:19.320 --> 00:26:21.950\nIt was seven, now it's zero.\n\n554\n00:26:21.950 --> 00:26:22.770\nOkay?\n\n555\n00:26:22.770 --> 00:26:25.360\nThen I can say vtp version 3,\n\n556\n00:26:25.360 --> 00:26:28.270\nyou generally wanna use the same VTP\nversion across your organization.\n\n557\n00:26:28.270 --> 00:26:29.070\nThey are compatible.\n\n558\n00:26:29.070 --> 00:26:30.630\nI mean, you see I'm learning here.\n\n559\n00:26:30.630 --> 00:26:33.840\nBut it's ideal to have them\nbe the same across the board.\n\n560\n00:26:33.840 --> 00:26:35.050\nAll right?\n\n561\n00:26:35.050 --> 00:26:36.050\nSo I set that.\n\n562\n00:26:36.050 --> 00:26:39.710\nAnd then now I'm gonna put myself back\ninto either client or server mode.\n\n563\n00:26:39.710 --> 00:26:40.800\nAnd I can go into either one.\n\n564\n00:26:40.800 --> 00:26:42.610\nI'm gonna go into client mode.\n\n565\n00:26:42.610 --> 00:26:45.472\nSo I'll say VTP mode client.\n\n566\n00:26:45.472 --> 00:26:47.710\nAll right?\n\n567\n00:26:47.710 --> 00:26:51.430\nNow when that's done it's\nsynchronizing settings, right?\n\n568\n00:26:51.430 --> 00:26:54.110\nIt's getting information\nfrom the other switch.\n\n569\n00:26:54.110 --> 00:26:58.930\nAnd so if I add new VLANs, if I jump\nback to core 1 for example, all right?\n\n570\n00:26:58.930 --> 00:27:03.380\nAnd on CORE1, I come in here and\nI say, VLAN 6.\n\n571\n00:27:03.380 --> 00:27:06.570\nAnd what do we want to call this one?\n\n572\n00:27:06.570 --> 00:27:08.920\nOh, I just got a warning, right?\n\n573\n00:27:08.920 --> 00:27:13.320\nAnd the warning is VTP VLAN\nconfiguration not allowed when device is\n\n574\n00:27:13.320 --> 00:27:16.540\nnot the primary server for\nthe VLAN database.\n\n575\n00:27:16.540 --> 00:27:18.580\nWhat is it talking about?\n\n576\n00:27:18.580 --> 00:27:20.650\nWell, I've got a problem.\n\n577\n00:27:20.650 --> 00:27:23.120\nMy other switch came up, and\n\n578\n00:27:23.120 --> 00:27:27.900\nit was a server and I'm a server,\nand what happens there?\n\n579\n00:27:27.900 --> 00:27:31.620\nWell, somebody's gotta be the primary\nserver, and apparently it wasn't me.\n\n580\n00:27:31.620 --> 00:27:34.120\nWell, I just put the other\nswitch into client mode, so\n\n581\n00:27:34.120 --> 00:27:35.040\nit's not the server anymore.\n\n582\n00:27:35.040 --> 00:27:36.780\nSo what the heck's going on here?\n\n583\n00:27:36.780 --> 00:27:39.540\nWell, I've got a third\nswitch in the mix and\n\n584\n00:27:39.540 --> 00:27:43.530\nmy third switch, it's probably a server\ntoo so this is again why it's so\n\n585\n00:27:43.530 --> 00:27:45.480\nimportant to go and\ncheck all of our switches.\n\n586\n00:27:45.480 --> 00:27:47.650\nSo I'm going to jump\nover to my third switch,\n\n587\n00:27:47.650 --> 00:27:50.550\nthis access switch that I don't\nI've logged in to this whole show,\n\n588\n00:27:50.550 --> 00:27:53.360\nit's easy to forget about\nthe switches that you've got.\n\n589\n00:27:53.360 --> 00:27:55.000\nAnd I'm just going to take this guy.\n\n590\n00:27:55.000 --> 00:27:58.410\nAnd I'm just gonna double\ncheck his vtp status.\n\n591\n00:27:58.410 --> 00:27:59.666\n>> That will teach you\nto forget about him.\n\n592\n00:27:59.666 --> 00:28:00.490\n[LAUGH]\n>> I know.\n\n593\n00:28:00.490 --> 00:28:01.860\n[LAUGH] You will remember us.\n\n594\n00:28:01.860 --> 00:28:02.480\n>> Right.\n\n595\n00:28:02.480 --> 00:28:06.260\n>> So it's VTP version 1 and\nit's in ITProTV and it's a server,\n\n596\n00:28:06.260 --> 00:28:08.870\nit's like the perfect storm here, and\nit's got a higher revision number.\n\n597\n00:28:08.870 --> 00:28:12.440\nThere's all sorts of bad stuff here and\nso I definitely have a problem.\n\n598\n00:28:12.440 --> 00:28:15.750\nI need to fix this guy, so\nI'm gonna jump into configuration.\n\n599\n00:28:15.750 --> 00:28:19.100\nI'll do vtp mode\ntransparent to reset that.\n\n600\n00:28:19.100 --> 00:28:23.782\nI'll do vtp version 3, and\n\n601\n00:28:23.782 --> 00:28:29.630\nthen I'll do vtp mode client.\n\n602\n00:28:29.630 --> 00:28:30.240\nAll right?\n\n603\n00:28:30.240 --> 00:28:32.440\nSo now access one is a client, and\n\n604\n00:28:32.440 --> 00:28:36.560\ncore two is a client, and\ncore one is the only server.\n\n605\n00:28:36.560 --> 00:28:40.520\nSo if I want to add VLANs, I can go to\ncore one and that's where I can add it.\n\n606\n00:28:40.520 --> 00:28:42.740\nIf I try and add it on a client,\nlike this guy, right?\n\n607\n00:28:42.740 --> 00:28:48.450\nIf I pull up my VTP status,\nI can see in here that I am a client,\n\n608\n00:28:48.450 --> 00:28:50.850\nand my revision number is nice and\nlow now.\n\n609\n00:28:50.850 --> 00:28:52.950\nAnd on this switch, I can come in and\n\n610\n00:28:52.950 --> 00:28:57.980\nI can say something like vlan 6 to try and\ncreate it, and I get this error.\n\n611\n00:28:57.980 --> 00:29:01.040\nVTP VLAN configuration not allowed\nwhen device is in CLIENT mode.\n\n612\n00:29:01.040 --> 00:29:02.040\nSo it stopped me.\n\n613\n00:29:02.040 --> 00:29:03.430\nCouldn't do it.\n\n614\n00:29:03.430 --> 00:29:04.940\nIf I jump back to core one,\n\n615\n00:29:05.980 --> 00:29:10.702\ncore one should be the primary server I'll\nsay should just to cover me if it isn't.\n\n616\n00:29:10.702 --> 00:29:17.410\n[LAUGH] And if I'm going to say vlan 6 and\nwe're still not the primary.\n\n617\n00:29:17.410 --> 00:29:19.320\nI may have to reset this one too.\n\n618\n00:29:19.320 --> 00:29:23.030\nSo my VTP environments become a little\nbit destroying it at this point.\n\n619\n00:29:23.030 --> 00:29:24.080\nAnd this can happen, right?\n\n620\n00:29:24.080 --> 00:29:28.570\nWhere the kinda configurations get\na little bit mixed or messed up, and so\n\n621\n00:29:28.570 --> 00:29:30.570\nthere's a few ways to kinda deal without.\n\n622\n00:29:30.570 --> 00:29:33.180\nBut basically this one is\nsupposed to be the server.\n\n623\n00:29:33.180 --> 00:29:34.760\nSupposed to be the primary server.\n\n624\n00:29:34.760 --> 00:29:39.720\nAnd if I do a show vtp status and\ntake a look at it.\n\n625\n00:29:39.720 --> 00:29:42.440\nI can see that it is a server, right.\n\n626\n00:29:42.440 --> 00:29:44.290\nAnd then here's my device ID but\n\n627\n00:29:44.290 --> 00:29:49.410\ndown here we've got this Primary ID,\nwho's the primary, who's the boss?\n\n628\n00:29:49.410 --> 00:29:51.150\nAnd see how it's empty.\n\n629\n00:29:51.150 --> 00:29:55.330\nMy system is the boss but\nit doesn't seem to know it, does it?\n\n630\n00:29:55.330 --> 00:29:57.540\nIt doesn't seem to be acceptant of that.\n\n631\n00:29:57.540 --> 00:30:00.880\nSo, I've got a, kind of,\na bit of breakage here.\n\n632\n00:30:00.880 --> 00:30:06.110\nAnd, the main reason I have that is\nprobably the fact, it's kind of sad, but\n\n633\n00:30:06.110 --> 00:30:10.220\nthese switches kind of expect you to have\nat least one IP address assigned to them,\n\n634\n00:30:10.220 --> 00:30:13.110\nand I don't think I've assigned\nan IP address to my system.\n\n635\n00:30:13.110 --> 00:30:16.120\nSo, let me see if I have or not.\n\n636\n00:30:16.120 --> 00:30:18.026\nWe'll just go in here and take a look.\n\n637\n00:30:18.026 --> 00:30:22.560\nAnd, you know, as I scan down the list\nhere, yeah, I don't have an IP address.\n\n638\n00:30:22.560 --> 00:30:24.260\nSo that is likely going to be my problem.\n\n639\n00:30:24.260 --> 00:30:28.180\nNow, some switches will actually allow you\nto correct this without assigning an IP,\n\n640\n00:30:28.180 --> 00:30:31.690\nbut on mine I don't think\nit has support for that,\n\n641\n00:30:31.690 --> 00:30:36.000\nso, but if you look into the configs, here\nyou've got this VTP interface command.\n\n642\n00:30:36.000 --> 00:30:39.870\nAnd it says configure interface\nas the preferred source for\n\n643\n00:30:39.870 --> 00:30:43.410\nthe VTP IP updater address.\n\n644\n00:30:43.410 --> 00:30:47.020\nWell, if I don't have an IP address,\nI can't do IP updates.\n\n645\n00:30:47.020 --> 00:30:50.710\nIt's not that I need to statically set it,\nit's just that I need to have an address.\n\n646\n00:30:50.710 --> 00:30:52.350\nSo I'm gonna need to assign one.\n\n647\n00:30:52.350 --> 00:30:53.990\nSo, I'm gonna fix that real quick.\n\n648\n00:30:53.990 --> 00:30:57.090\nI'm just gonna get into\ninterface VLAN one.\n\n649\n00:30:57.090 --> 00:30:58.990\nAnd I'll give these guys some addresses.\n\n650\n00:30:58.990 --> 00:31:01.370\nAnd I'll just make up some addresses here,\n\n651\n00:31:01.370 --> 00:31:05.160\njust to get something in place on VLAN one\nand I'm gonna need to do that on each of\n\n652\n00:31:05.160 --> 00:31:07.630\nmy switches otherwise I'm not\ngonna have good communication.\n\n653\n00:31:07.630 --> 00:31:13.660\nSo, we'll just kind of repeat that same\nprocess on each one of these guys,\n\n654\n00:31:13.660 --> 00:31:17.040\ngiving them a nice IP so\nthey will be able to talk.\n\n655\n00:31:17.040 --> 00:31:19.050\nThey've got to be able to talk for\nthis to work.\n\n656\n00:31:19.050 --> 00:31:21.290\nThe other thing that can cause this\nkind of problem is if you don't have any\n\n657\n00:31:21.290 --> 00:31:22.170\ntrunks.\n\n658\n00:31:22.170 --> 00:31:25.160\nVTP only runs over trunk links.\n\n659\n00:31:25.160 --> 00:31:28.460\nAnd so, we've got a valid trunk so\nthis doesn't work.\n\n660\n00:31:28.460 --> 00:31:31.570\n>> Yeah, I used to get in trouble with\nVTP all the time when I was studying for\n\n661\n00:31:31.570 --> 00:31:32.830\nCisco exams.\n\n662\n00:31:32.830 --> 00:31:34.570\nI would set it up and\nhave everything going and\n\n663\n00:31:34.570 --> 00:31:35.810\nthen I would want to make a change, and\n\n664\n00:31:35.810 --> 00:31:37.615\nmake a change, and\neverything stopped working.\n\n665\n00:31:37.615 --> 00:31:39.912\nHad to go in, and\nhad to remember to myself,\n\n666\n00:31:39.912 --> 00:31:44.216\ndo not make changes without verifying that\neverything is going to actually work.\n\n667\n00:31:44.216 --> 00:31:45.563\nHave to have that logical order.\n\n668\n00:31:45.563 --> 00:31:48.788\nThen I have to go in and\nblow everything away, come back, and\n\n669\n00:31:48.788 --> 00:31:50.198\nrebuild the VTP domains.\n\n670\n00:31:50.198 --> 00:31:51.893\nAnd to make everything work after that.\n\n671\n00:31:51.893 --> 00:31:52.450\n>> Yup.\n\n672\n00:31:52.450 --> 00:31:55.682\nSo I've got my IPs on, I'm just verifying,\nthe whole trust but verify, so\n\n673\n00:31:55.682 --> 00:31:59.065\nI'm doing a couple of pings here to make\nsure I can hit those other switches, and\n\n674\n00:31:59.065 --> 00:32:00.610\nsure enough I am.\n\n675\n00:32:00.610 --> 00:32:02.460\nVTP is not the fastest\nprotocol in the world, so\n\n676\n00:32:02.460 --> 00:32:06.620\nI might have to wait a few moments for\nthis to kind of sift out, but what should\n\n677\n00:32:06.620 --> 00:32:11.070\nhappen is within a few moments, I should\nbe able to look at my VTP status and\n\n678\n00:32:11.070 --> 00:32:16.190\nI should start to see that my primary\nID fills in to reflect that I do\n\n679\n00:32:16.190 --> 00:32:21.970\nhave a proper status, that I am\nkind of the boss and ready to run.\n\n680\n00:32:21.970 --> 00:32:24.451\nWe changed our native VLANs, but\nthat was only on one port, so\n\n681\n00:32:24.451 --> 00:32:25.949\nthat shouldn't be my problem here.\n\n682\n00:32:25.949 --> 00:32:27.477\nSo I might have a different issue or\n\n683\n00:32:27.477 --> 00:32:29.862\nI'm more than likely just\nnot being patient enough.\n\n684\n00:32:29.862 --> 00:32:30.810\n>> Mm-hm.\n\n685\n00:32:30.810 --> 00:32:32.460\n>> There's ways you can force it along,\nright.\n\n686\n00:32:32.460 --> 00:32:36.510\nYou know, going to VTP transparent\nmode doesn't really force things on.\n\n687\n00:32:36.510 --> 00:32:41.390\nBut if you do VTP off, or\nmode off and you turn it off, you can\n\n688\n00:32:41.390 --> 00:32:44.220\nalways turn it back on again and that can\nkind of kick it in the butt sometimes.\n\n689\n00:32:45.580 --> 00:32:47.850\nThis is the hard part of being\na network guy right here.\n\n690\n00:32:47.850 --> 00:32:50.170\nI have to resist the temptation to get\nin there and start messing with it.\n\n691\n00:32:50.170 --> 00:32:51.492\nSometimes you just have\nto wait a little bit.\n\n692\n00:32:51.492 --> 00:32:55.160\nWe can also do debugs, there's debugs\ncommand for VTP to see what's going on,\n\n693\n00:32:55.160 --> 00:32:56.770\nbut it's such a simple protocol.\n\n694\n00:32:56.770 --> 00:33:00.980\nYou guys saw how it learns from itself,\nthat usually we wait for\n\n695\n00:33:00.980 --> 00:33:02.770\na second, let it clean itself out.\n\n696\n00:33:02.770 --> 00:33:04.095\n>> Give it time, young Windows.\n\n697\n00:33:04.095 --> 00:33:06.600\n[LAUGH]\n>> But just as an example,\n\n698\n00:33:06.600 --> 00:33:08.940\nlike here in this switch,\nI'm gonna do it, I'm gonna mess with it.\n\n699\n00:33:08.940 --> 00:33:14.230\nSo we can jump in here and we can do\nthings like say VTP mode off, and\n\n700\n00:33:14.230 --> 00:33:18.840\nthat's gonna turn VTP off and there it\ngoes off for VLANs and if I do a show VTP\n\n701\n00:33:18.840 --> 00:33:23.820\nstatus and take a look at it, we can see\nthat I still have my configuration, right.\n\n702\n00:33:23.820 --> 00:33:28.520\nI didn't lose that, but my mode is off,\nI'm not actually participating in VTP.\n\n703\n00:33:28.520 --> 00:33:33.550\nAnd then if I come back and I say VTP mode\nserver, then it's gonna kick that back on.\n\n704\n00:33:33.550 --> 00:33:36.715\nAnd there's not really a lot\nof options beyond this,\n\n705\n00:33:36.715 --> 00:33:38.580\nexcept you can specify\nwhether you're a server for\n\n706\n00:33:38.580 --> 00:33:43.520\nsome of these different services,\nlike MST, unknown services and for VLANs.\n\n707\n00:33:43.520 --> 00:33:46.410\nAnd VLAN is the default so\nwe don't have to provide that.\n\n708\n00:33:46.410 --> 00:33:48.430\nIf you leave that off,\nthat's what you're doing.\n\n709\n00:33:48.430 --> 00:33:52.280\nSo that command is effectively\nthe same as just VTP mode server.\n\n710\n00:33:52.280 --> 00:33:54.050\nSee how I get that same\nkind of output there?\n\n711\n00:33:54.050 --> 00:33:56.760\nAnd it's telling me I'm\nalready in that mode.\n\n712\n00:33:56.760 --> 00:33:59.120\nThe other ones, we're gonna talk about\nmultiple spanning tree in the spanning\n\n713\n00:33:59.120 --> 00:34:00.130\ntree episodes.\n\n714\n00:34:00.130 --> 00:34:03.859\nAnd then unknown, those are for\nother services that you might deploy.\n\n715\n00:34:03.859 --> 00:34:08.706\nAnd you can actually see those kick in\nwhen you have things like L2 tunnels,\n\n716\n00:34:08.706 --> 00:34:11.053\nwhich a lot of people don't use, but\n\n717\n00:34:11.053 --> 00:34:15.086\neven like layer 2 VPNs that\nare a part of NPLS can create those.\n\n718\n00:34:15.086 --> 00:34:17.911\nSo if you want to make sure\nyou're a server for all of them,\n\n719\n00:34:17.911 --> 00:34:21.198\nyou can always come in and\nspecify that for each one, but in my case,\n\n720\n00:34:21.198 --> 00:34:25.575\nI'm not even running those other\nprotocols, so it doesn't really matter.\n\n721\n00:34:25.575 --> 00:34:29.425\nBut now, oh, says I can't be a server for\nthe unknown instances, so there we go.\n\n722\n00:34:31.105 --> 00:34:34.455\nBut we can pull up our status and\nlet's see if that was enough to kick it.\n\n723\n00:34:34.455 --> 00:34:39.720\nAnd we are still up and running,\nstill not picking up that primary ID.\n\n724\n00:34:39.720 --> 00:34:42.040\nWhat have I done to break this thing?\n\n725\n00:34:42.040 --> 00:34:44.486\nWell when waiting patiently runs too thin,\n\n726\n00:34:44.486 --> 00:34:46.190\nthen it's time to jump in and\ndo something.\n\n727\n00:34:46.190 --> 00:34:48.510\nI have a theory as to what\nmight be going on here.\n\n728\n00:34:48.510 --> 00:34:50.220\nNormally, I should be done.\n\n729\n00:34:50.220 --> 00:34:52.430\nI should just be able to wait this out and\nit's done.\n\n730\n00:34:52.430 --> 00:34:54.940\nAnd things happen, actually,system\ninterface is changing status,\n\n731\n00:34:54.940 --> 00:34:57.420\nI might actually have some\nphysical network issues.\n\n732\n00:34:57.420 --> 00:35:00.880\nBut if the primary\ndoesn't actually get set,\n\n733\n00:35:00.880 --> 00:35:03.420\nwe can always just step in and force it.\n\n734\n00:35:03.420 --> 00:35:06.720\nThis might be an indicator that I may need\nto go and look at the iOS versions on my\n\n735\n00:35:06.720 --> 00:35:10.180\nother switches and\nI might have a VTP version three problem.\n\n736\n00:35:10.180 --> 00:35:13.430\nI might, I know I said earlier,\nVTP three, that's the one you wanna use,\n\n737\n00:35:13.430 --> 00:35:16.980\ndon't use version two or one, well I might\nhave a switch that doesn't support it.\n\n738\n00:35:16.980 --> 00:35:19.650\nAnd that might be what's throwing me\nhere and why I'm not becoming a primary,\n\n739\n00:35:19.650 --> 00:35:21.740\nyou end up with this,\nit's called a device conflict.\n\n740\n00:35:21.740 --> 00:35:24.500\nSo if that's the case,\nwhat I really should do is go and\n\n741\n00:35:24.500 --> 00:35:25.440\ncheck all the other switches.\n\n742\n00:35:25.440 --> 00:35:30.035\nBut this show is only so long, so instead,\nI'm gonna break the rules a little bit and\n\n743\n00:35:30.035 --> 00:35:31.055\njust kinda force it.\n\n744\n00:35:31.055 --> 00:35:34.125\nActually, now that I interfaced changed,\nlet me just double check and\n\n745\n00:35:34.125 --> 00:35:38.335\nmake sure that that didn't actually\nalready solve my problem, and so\n\n746\n00:35:38.335 --> 00:35:39.575\nI'll just double check, and nope.\n\n747\n00:35:39.575 --> 00:35:41.945\nSo sure enough, it did not.\n\n748\n00:35:41.945 --> 00:35:44.909\nOh, you know what, I'm on the wrong\nclient anyway, that's my problem, so\n\n749\n00:35:44.909 --> 00:35:46.015\nlet me jump back to this guy.\n\n750\n00:35:46.015 --> 00:35:49.030\nThis is the guy that I actually\nwant to be the server.\n\n751\n00:35:49.030 --> 00:35:55.360\nAnd if I do a show VTP status,\noops, I'm not in config,\n\n752\n00:35:55.360 --> 00:35:59.250\nso that's gonna make a difference, but\nit will show VTP status and look at it.\n\n753\n00:35:59.250 --> 00:36:01.270\nI am a server, but\nI'm still not the primary.\n\n754\n00:36:01.270 --> 00:36:04.350\nSo if I go in and try and\nmake that configuration change,\n\n755\n00:36:04.350 --> 00:36:06.530\nit's still not going to happen\ncuz it says I'm not the primary.\n\n756\n00:36:06.530 --> 00:36:08.170\nSo I'm going to kick it in the butt and\nmake it happen.\n\n757\n00:36:08.170 --> 00:36:11.000\nNow to do this,\nit's actually a pretty weird command.\n\n758\n00:36:11.000 --> 00:36:13.120\nBecause all the VPT\ncommands I've issued so\n\n759\n00:36:13.120 --> 00:36:17.790\nfar, have been right here in config, but\nthere is actually one command we can issue\n\n760\n00:36:17.790 --> 00:36:20.610\noutside of config in just\nour regular exec prompt.\n\n761\n00:36:20.610 --> 00:36:25.335\nIf I get out of the config, and I get\nright here, you can do VTP question mark\n\n762\n00:36:25.335 --> 00:36:29.770\nand you'll see you've got this\none command, VTP primary.\n\n763\n00:36:29.770 --> 00:36:33.120\nYou shouldn't need to use it, but\nif you've got a situation like mine and\n\n764\n00:36:33.120 --> 00:36:35.320\nyour switch is just not\nbecoming the primary and\n\n765\n00:36:35.320 --> 00:36:38.190\nyou're super impatient like me and\nyou don't want to wait, you can force it.\n\n766\n00:36:38.190 --> 00:36:39.830\nAnd so this is how we force it.\n\n767\n00:36:39.830 --> 00:36:41.820\nYou do not force it in the config.\n\n768\n00:36:41.820 --> 00:36:45.470\nI'm already in server mode in the config,\nso that's not something that I need.\n\n769\n00:36:45.470 --> 00:36:47.820\nBut I need to be the primary so\nI can make my changes.\n\n770\n00:36:47.820 --> 00:36:50.140\nSo I'm gonna say VTP primary, and\n\n771\n00:36:50.140 --> 00:36:53.950\nfrom there you can specify whether\nwe want it to be for MST or\n\n772\n00:36:53.950 --> 00:36:59.590\nVLAN, and VLAN is the one that I want,\nthat's the default, and I can force it.\n\n773\n00:36:59.590 --> 00:37:02.261\nBy default it's going to look and\nsee if somebody else is the primary and\n\n774\n00:37:02.261 --> 00:37:04.410\nthen it's going to ask them\nif we can become the primary.\n\n775\n00:37:04.410 --> 00:37:06.230\nIt's very nice, very cordial.\n\n776\n00:37:06.230 --> 00:37:08.420\nI'm beyond that point, I want to force it.\n\n777\n00:37:08.420 --> 00:37:12.120\nI want to become that primary, but\nI probably don't have to force it,\n\n778\n00:37:12.120 --> 00:37:14.060\nbecause if you look at\nmy output from earlier,\n\n779\n00:37:15.210 --> 00:37:19.570\nup here the primary is all zeroes,\nso there is no primary.\n\n780\n00:37:19.570 --> 00:37:23.020\nSo that's how I know I got a different\nissue going on like an iOS problem.\n\n781\n00:37:23.020 --> 00:37:28.040\nSo instead, I'm just gonna come in here,\nrun VTP primary VLAN, and\n\n782\n00:37:28.040 --> 00:37:32.070\nit's got nobody to ask, and so it should\nbe able to just reach out there and do it.\n\n783\n00:37:32.070 --> 00:37:34.890\nAnd so, here it says that the system\nis becoming the primary server for\n\n784\n00:37:34.890 --> 00:37:39.150\nfeature VLAN, and\nit should complete here in just a moment.\n\n785\n00:37:39.150 --> 00:37:42.067\nIt's trying to ask that primary,\nthat primary that doesn't exist.\n\n786\n00:37:42.067 --> 00:37:45.290\nAnd so I could have added the force\nkeyword and knocked that out,\n\n787\n00:37:45.290 --> 00:37:50.040\nbut, what I'll see is, I've got\nhere no conflicting devices found.\n\n788\n00:37:50.040 --> 00:37:54.060\nIt didn't find a primary, and so\nwe just became the primary for that.\n\n789\n00:37:55.290 --> 00:37:56.810\nKind of a fun thing to put in the show,\nI guess.\n\n790\n00:37:56.810 --> 00:37:58.140\nIt's not going to be on the exam,\n\n791\n00:37:58.140 --> 00:38:00.400\nbut something that you might\nsee out there in real life.\n\n792\n00:38:00.400 --> 00:38:03.160\nIt happened to me here on the show.\n\n793\n00:38:03.160 --> 00:38:08.410\nSo now, if I do a show VTP status, things\nshould look a little bit different for me.\n\n794\n00:38:08.410 --> 00:38:12.340\nFirst off, my configuration revision went\nup by one, because I'm now the primary.\n\n795\n00:38:12.340 --> 00:38:15.310\nSo I'm gonna start telling other people\nout there, hey, check your database,\n\n796\n00:38:15.310 --> 00:38:18.580\nif you're not on version one,\nget to version one, revision one.\n\n797\n00:38:18.580 --> 00:38:21.570\nAnd I'm the master now,\nthey'll start to learn that.\n\n798\n00:38:21.570 --> 00:38:22.330\n>> Who's the master?\n\n799\n00:38:22.330 --> 00:38:23.610\n>> That's right.\nWho's the baddest?\n\n800\n00:38:23.610 --> 00:38:24.110\n>> That's right.\n\n801\n00:38:24.110 --> 00:38:27.560\n>> And so it's got it, and you can see\nNYCORE1 there on the primary description.\n\n802\n00:38:27.560 --> 00:38:30.709\nI'm up and I'm going, I'm in server\nmode and I'm primary server, so\n\n803\n00:38:30.709 --> 00:38:31.873\nthat's pretty awesome.\n\n804\n00:38:31.873 --> 00:38:34.071\nBow I can start to make some changes,\nand so\n\n805\n00:38:34.071 --> 00:38:37.689\nI'm gonna jump into my configuration and\nI'm gonna say that VLAN 6.\n\n806\n00:38:37.689 --> 00:38:41.173\nThere we go, now I can create it,\nI can give it a name,\n\n807\n00:38:41.173 --> 00:38:43.920\nI want to call this one, I don't know.\n\n808\n00:38:43.920 --> 00:38:44.976\n>> Administration.\n\n809\n00:38:44.976 --> 00:38:47.940\n>> Administration, great, there we go.\n\n810\n00:38:47.940 --> 00:38:50.540\nThe unsung heroes of an organization.\n\n811\n00:38:50.540 --> 00:38:54.260\nSo I've created that VLAN, and\nmaybe I go crazy, create some more.\n\n812\n00:38:54.260 --> 00:38:56.750\nSo I'll create a facilities VLAN,\nand so on.\n\n813\n00:38:56.750 --> 00:39:01.080\nSo now I'm starting to create VLANs,\nand if I do a show VLAN brief,\n\n814\n00:39:01.080 --> 00:39:04.630\nI'll see these new VLANs that I made,\nVLAN 6, VLAN 7.\n\n815\n00:39:04.630 --> 00:39:10.620\nAnd if I look at my VTP status, with each\nchange, the revision number went up.\n\n816\n00:39:10.620 --> 00:39:14.300\nI added two VLANs,\nmy revision number is now revision three.\n\n817\n00:39:14.300 --> 00:39:17.075\nSo anybody on the network that\nhas revision zero or one or\n\n818\n00:39:17.075 --> 00:39:19.283\ntwo knows that this one's newer and\nthey download it.\n\n819\n00:39:19.283 --> 00:39:22.358\nThey're synchronizing that VLAN.dat file.\n\n820\n00:39:22.358 --> 00:39:24.831\nI don't have to copy it,\nit's just happening automatically.\n\n821\n00:39:24.831 --> 00:39:29.556\nAnd so I can jump over to some of my other\nswitches like CORE 2, this guy over here,\n\n822\n00:39:29.556 --> 00:39:34.095\nand notice it's got a status message\nabout that VTP primary server changing.\n\n823\n00:39:34.095 --> 00:39:37.829\nSo it's aware there's\na new big guy in town.\n\n824\n00:39:37.829 --> 00:39:40.503\nAnd if I do a show VTP status,\n\n825\n00:39:40.503 --> 00:39:45.641\nit'll show that it knows\nNYCORE1 is the new primary.\n\n826\n00:39:45.641 --> 00:39:47.336\nSo it knows somebody else\nis out there doing it.\n\n827\n00:39:47.336 --> 00:39:51.602\nAnd my revision number is three,\nwhich matches the primary, so\n\n828\n00:39:51.602 --> 00:39:56.579\nI've likely already synchronized,\nwhich we we can find out by doing a show\n\n829\n00:39:56.579 --> 00:40:01.560\nVLAN brief, and there's VLANs two,\nthree, four, five, six, seven.\n\n830\n00:40:01.560 --> 00:40:02.830\nThey're all there.\n\n831\n00:40:02.830 --> 00:40:03.910\nI just learned all those VLANs.\n\n832\n00:40:03.910 --> 00:40:05.690\nI didn't have to type them all in here,\nI learned them.\n\n833\n00:40:06.700 --> 00:40:08.530\nBut, there's a little problem here,\n\n834\n00:40:08.530 --> 00:40:09.950\nthere's a problem that doesn't\nshow up on the screen.\n\n835\n00:40:11.350 --> 00:40:13.990\nAnd that is, what happened to VLAN 999?\n\n836\n00:40:13.990 --> 00:40:16.350\n>> I was just thinking the same thing.\n\n837\n00:40:16.350 --> 00:40:17.720\n>> We created that VLAN.\n\n838\n00:40:17.720 --> 00:40:19.220\nI assigned a port to it, right?\n\n839\n00:40:19.220 --> 00:40:20.570\nThere is a port assigned to it.\n\n840\n00:40:20.570 --> 00:40:23.230\nIf I look at my numbers here,\nI got Fa1/0/1, and\n\n841\n00:40:23.230 --> 00:40:28.400\nas I follow that list down,\nI've got one, two,\n\n842\n00:40:28.400 --> 00:40:31.330\nthree, four, five, six, seven, eight,\nnine, and it kinda keeps going.\n\n843\n00:40:31.330 --> 00:40:35.240\nAnd eventually I'll see a number get\nskipped, whoever I put in that VLAN.\n\n844\n00:40:35.240 --> 00:40:38.390\nActually, I don't remember\nwho I put in that VLAN.\n\n845\n00:40:38.390 --> 00:40:41.018\nI don't see anybody skipped, but\nif you see somebody skipped,\n\n846\n00:40:41.018 --> 00:40:44.522\nthat's a great indicator right there that\nyou've got a port assigned to a dead VLAN,\n\n847\n00:40:44.522 --> 00:40:45.415\na VLAN that's gone.\n\n848\n00:40:45.415 --> 00:40:48.176\nAll right, so\nVLAN 999 sort of still exists but\n\n849\n00:40:48.176 --> 00:40:52.667\nit's not really active, cuz it just got\noverwritten by this new VLAN database.\n\n850\n00:40:52.667 --> 00:40:55.990\nThe VLAN database can\noverwrite that that exists.\n\n851\n00:40:55.990 --> 00:40:58.100\nIt won't overwrite the port assignment.\n\n852\n00:40:58.100 --> 00:41:03.370\nThe port might still be assigned to it,\nso in fact, here, I'll take Fa1/0/12,\n\n853\n00:41:03.370 --> 00:41:07.858\nand I'm going to say switch port\n\n854\n00:41:07.858 --> 00:41:13.000\naccess VLAN 12.\n\n855\n00:41:13.000 --> 00:41:16.570\nThere is no VLAN 12,\nI just assign this port to it.\n\n856\n00:41:16.570 --> 00:41:20.880\nNormally, I would see one of those on\nthe fly messages, VLAN 12 does not exist,\n\n857\n00:41:20.880 --> 00:41:21.390\ncreating VLAN.\n\n858\n00:41:22.420 --> 00:41:24.730\nI didn't get that because\nI'm on a client and\n\n859\n00:41:24.730 --> 00:41:27.160\nclients are not allowed to make changes.\n\n860\n00:41:27.160 --> 00:41:32.440\nWhen I look at my VTP status, and\n\n861\n00:41:32.440 --> 00:41:36.750\nI look at that mode,\nmy VTP operating mode is client.\n\n862\n00:41:36.750 --> 00:41:37.280\nRight?\n\n863\n00:41:37.280 --> 00:41:40.599\nAnd I filtered that, so I'm getting some\nof the other operating modes in there, but\n\n864\n00:41:40.599 --> 00:41:42.911\nthis one is client, so\nit's not allowed to make changes.\n\n865\n00:41:42.911 --> 00:41:47.862\nAnd if I do a show VLAN brief,\nthat VLAN 12 I just made, it's not here,\n\n866\n00:41:47.862 --> 00:41:49.899\nit didn't actually make it.\n\n867\n00:41:49.899 --> 00:41:54.980\nBut, the port, if I look up here,\nsee how port 11 then goes to port 13.\n\n868\n00:41:54.980 --> 00:41:55.980\nIt skips over port 12.\n\n869\n00:41:55.980 --> 00:41:57.190\nWhere is port 12?\n\n870\n00:41:57.190 --> 00:42:00.340\nIt's basically dead,\nit's a dead port, right?\n\n871\n00:42:00.340 --> 00:42:04.210\nSo, it remembers that I've assigned\nthese ports to a VLAN, but the VLANs,\n\n872\n00:42:04.210 --> 00:42:05.600\nthemselves are gone.\n\n873\n00:42:05.600 --> 00:42:08.470\nAnd all I have to do\nis go back to my core,\n\n874\n00:42:08.470 --> 00:42:12.235\ngo back to my server, whoever my\nserver is, and create the VLAN there.\n\n875\n00:42:12.235 --> 00:42:16.810\nAnd so on the core,\nif I go in here and I say VLAN 12 and\n\n876\n00:42:16.810 --> 00:42:20.530\nI give it a name of students,\nso this is my student VLAN,\n\n877\n00:42:21.610 --> 00:42:25.000\nI've now created that, it's pushing\nout to the other guys right now.\n\n878\n00:42:25.000 --> 00:42:27.600\nAnd so that other switch is\ngonna learn about it, and\n\n879\n00:42:27.600 --> 00:42:32.830\nit's gonna add it to its VLAN database,\nand then that port will come active again.\n\n880\n00:42:32.830 --> 00:42:36.250\nAnd it may take a moment,\nusually it happens pretty quick.\n\n881\n00:42:36.250 --> 00:42:41.070\nThere we go, VLAN12 is active, and\nthere's that port, already assigned to it,\n\n882\n00:42:41.070 --> 00:42:42.100\nwaiting and ready.\n\n883\n00:42:42.100 --> 00:42:46.540\nSo even if I overwrite my VLAN database,\nit's not like all is lost.\n\n884\n00:42:46.540 --> 00:42:48.900\nThe port assignments are still there,\nthey're still tied to the ports.\n\n885\n00:42:48.900 --> 00:42:52.830\nI just need to rebuild the VLAN,\nand now it's functional.\n\n886\n00:42:52.830 --> 00:42:56.060\nSo VTP provides us a great way to kinda\nsynchronize those settings between all\n\n887\n00:42:56.060 --> 00:42:57.900\nthe different systems and\nget that in place.\n\n888\n00:42:57.900 --> 00:42:59.920\nIt's definitely something\nthat's really useful.\n\n889\n00:42:59.920 --> 00:43:03.710\n>> Yeah, now Don, obviously that would\nbe very wasteful to be on a switch,\n\n890\n00:43:03.710 --> 00:43:07.240\nassign it to a VLAN that doesn't exist,\nyou're in a client mode, and\n\n891\n00:43:07.240 --> 00:43:08.230\nnow that port is kind of gone.\n\n892\n00:43:08.230 --> 00:43:11.760\nIt's not something we want to\nengage in as a common practice.\n\n893\n00:43:11.760 --> 00:43:15.140\nBut also the opposite might be true,\nto have VLANs with no ports in them, that\n\n894\n00:43:15.140 --> 00:43:18.783\nare doing nothing, they're just kind of\nsitting around, what do we do with that?\n\n895\n00:43:18.783 --> 00:43:20.472\n>> Yeah, and\nthat's exactly what I have, right?\n\n896\n00:43:20.472 --> 00:43:23.590\nIf we look at my switch here,\nthis is core two, right?\n\n897\n00:43:23.590 --> 00:43:26.190\nSo this isn't the actual server,\nthis is one of the clients.\n\n898\n00:43:26.190 --> 00:43:28.324\nAnd I've got a bunch of ports on VLAN 1,\nand\n\n899\n00:43:28.324 --> 00:43:30.602\nI've got this one port\ndown here on VLAN 12.\n\n900\n00:43:30.602 --> 00:43:33.440\nBut VLAN two, three, four,\nfive, six, they're all empty,\n\n901\n00:43:33.440 --> 00:43:34.890\nI don't have any ports on them.\n\n902\n00:43:34.890 --> 00:43:36.415\nWell, it doesn't matter.\n\n903\n00:43:36.415 --> 00:43:39.755\nThe core is still sending all that\ntraffic to me, all the traffic for\n\n904\n00:43:39.755 --> 00:43:41.665\nthese VLANs that I don't have ports for.\n\n905\n00:43:41.665 --> 00:43:44.785\nAnd so, in the last episode, I showed\nyou guys how we could come in and filter\n\n906\n00:43:44.785 --> 00:43:50.325\nthe trunks to say limit this, limit that,\nbut the problem with doing it that way is,\n\n907\n00:43:50.325 --> 00:43:53.095\nevery time you add a VLAN, you gotta go\nand edit those values, and if you're doing\n\n908\n00:43:53.095 --> 00:43:55.925\nthis all throughout your network,\nit becomes an administrative hassle.\n\n909\n00:43:55.925 --> 00:43:58.230\nBut we can tell VTP to do it for us.\n\n910\n00:43:58.230 --> 00:44:02.230\nWe can tell VTP, hey,\nlook at what's out there, and\n\n911\n00:44:02.230 --> 00:44:05.880\nif there's a VLAN that's not being\nused on a switch, prune it off,\n\n912\n00:44:05.880 --> 00:44:07.860\njust do it automatically so\nI don't have to worry about it.\n\n913\n00:44:07.860 --> 00:44:09.420\nAll right, and it can knock that out and\n\n914\n00:44:09.420 --> 00:44:12.020\nit's doing it all just kind of\nautomatically behind the scenes.\n\n915\n00:44:13.130 --> 00:44:14.870\nThe default is that that doesn't happen.\n\n916\n00:44:15.870 --> 00:44:22.100\nSo if I do a show VTP status and I look at\nthe status that comes out, in here you can\n\n917\n00:44:22.100 --> 00:44:27.660\nfind a setting which is VTP Pruning Mode\nand the default is disabled.\n\n918\n00:44:27.660 --> 00:44:30.550\nAnd that's because Cisco doesn't\nreally know your network design.\n\n919\n00:44:30.550 --> 00:44:34.270\nThere's a risk,\nlet's say you have three switches in line.\n\n920\n00:44:34.270 --> 00:44:38.230\nYou got a server that runs to\na client that runs to another client.\n\n921\n00:44:38.230 --> 00:44:40.080\nOn the server I have VLAN 5.\n\n922\n00:44:40.080 --> 00:44:44.400\nOn the first client, the middle switch,\nI don't have VLAN 5.\n\n923\n00:44:44.400 --> 00:44:47.700\nOn the last switch I do have VLAN 5.\n\n924\n00:44:47.700 --> 00:44:51.340\nSo, I have to skip\na switch to get to VLAN 5.\n\n925\n00:44:51.340 --> 00:44:55.280\nIf I turn on VTP pruning, it doesn't see\nall the way down to the end of the trail,\n\n926\n00:44:55.280 --> 00:44:59.990\nand it prunes the VLAN 5 before\nit gets to the second switch and\n\n927\n00:44:59.990 --> 00:45:02.250\nnever makes it to the third,\nyou isolate that network.\n\n928\n00:45:02.250 --> 00:45:07.110\nSo VTP pruning only works if\nyou've done some good planning.\n\n929\n00:45:07.110 --> 00:45:09.350\nIf you haven't done good planning,\nthen you need to need to do it manually.\n\n930\n00:45:09.350 --> 00:45:14.260\nUse those VTP allowed, I mean,\nnot VTP, allowed VLAN commands on\n\n931\n00:45:14.260 --> 00:45:17.010\nyour trunk to specify which VLANs\nare allowed and which ones aren't.\n\n932\n00:45:17.010 --> 00:45:18.240\nUse that.\n\n933\n00:45:18.240 --> 00:45:21.155\nBut if you've planned it out, if your\nnetwork is nice and hub and spoke and\n\n934\n00:45:21.155 --> 00:45:24.485\nwell designed, you can do automatic\nVTP pruning, it'll knock it out.\n\n935\n00:45:24.485 --> 00:45:27.915\nAs you add new VLANS, you don't have\nto worry about changing pruning.\n\n936\n00:45:27.915 --> 00:45:30.325\nAnd if you assign a new port to a VLAN,\nyou don't have to prune it off.\n\n937\n00:45:31.455 --> 00:45:33.455\nLet me just give you\na quick demonstration here.\n\n938\n00:45:33.455 --> 00:45:38.605\nSo on my core, if I take a look at my\ncore's trunks as they are right now,\n\n939\n00:45:38.605 --> 00:45:45.740\nif I do a show interface trunk, I'll see\nmy trunks and VLANs 1 through 7 and 12.\n\n940\n00:45:45.740 --> 00:45:48.580\nThose are the ones that I've defined.\n\n941\n00:45:48.580 --> 00:45:51.510\nAnd so, on all three of my trunks,\nI'm sending out all of this.\n\n942\n00:45:51.510 --> 00:45:56.110\nSee how it says, VLANs allowed and\nactive in the management domain, okay?\n\n943\n00:45:56.110 --> 00:45:59.690\nAnd then, down here, we can see, VLANs in\nthe spanning tree forwarding state, and\n\n944\n00:45:59.690 --> 00:46:00.308\nnot pruned.\n\n945\n00:46:00.308 --> 00:46:03.820\nAnd on FA1/0/22 I'm sending\none through seven and\n\n946\n00:46:03.820 --> 00:46:07.940\ntwelve, sending them all to\nthe other side of that line, right.\n\n947\n00:46:07.940 --> 00:46:12.710\nAnd same with my other ports here,\nso things are moving along there.\n\n948\n00:46:12.710 --> 00:46:16.400\nNow on these other two ports,\n23 and 24, see how they say none?\n\n949\n00:46:16.400 --> 00:46:18.640\nAnd that's because it's\ntalking about spanning tree.\n\n950\n00:46:18.640 --> 00:46:22.110\nSpanning tree is getting in and shutting\nsomethings off and kinda blocking them.\n\n951\n00:46:22.110 --> 00:46:26.398\nWell, that switch that's on the other\nside, that is my oldest switch.\n\n952\n00:46:26.398 --> 00:46:29.138\nThis guy, this one on port 22.\n\n953\n00:46:29.138 --> 00:46:31.580\nSo I'm gonna go kill\nthat port off real quick.\n\n954\n00:46:31.580 --> 00:46:35.330\nSo let me just shut that one off so\nthat I wont have that connection anymore.\n\n955\n00:46:35.330 --> 00:46:38.280\nAll right, that's gonna cause\nspanning tree to recalculate and so\n\n956\n00:46:38.280 --> 00:46:39.660\nwe'll see a little change.\n\n957\n00:46:39.660 --> 00:46:42.690\nI have two links between core one and\ncore two, and so\n\n958\n00:46:42.690 --> 00:46:46.720\nspanning tree's going to shut off one of\nthem, because it creates a loop, right?\n\n959\n00:46:46.720 --> 00:46:48.110\nBut I want the other one to be off, so\n\n960\n00:46:48.110 --> 00:46:49.450\nkilling off this other switch\nwill take care of that.\n\n961\n00:46:49.450 --> 00:46:51.920\nWe're going to talk more about\nspanning tree in another episode.\n\n962\n00:46:52.940 --> 00:46:56.030\nBut now, if I come in here and\nI take a look at my show interface trunk,\n\n963\n00:46:57.600 --> 00:47:03.480\nwhen I run that command I can see that\nI'm sending all these VLANs out, and down\n\n964\n00:47:03.480 --> 00:47:07.170\nhere it's telling me the VLANs in spanning\ntree forwarding state and not pruned.\n\n965\n00:47:07.170 --> 00:47:09.340\nWell, spanning tree is still\nkind of renegotiating, so\n\n966\n00:47:09.340 --> 00:47:12.140\nwhile we're waiting on that, I'm going\nto go ahead and configure VTP and\n\n967\n00:47:12.140 --> 00:47:14.550\nthen we'll come back and\nwe'll see that update.\n\n968\n00:47:14.550 --> 00:47:17.170\nSo as it stands now, I'm communicating,\n\n969\n00:47:17.170 --> 00:47:20.540\nI've got VTP running, I want to turn\non pruning, and it's really easy.\n\n970\n00:47:20.540 --> 00:47:24.630\nYou just jump into config,\nand you say VTP, and\n\n971\n00:47:24.630 --> 00:47:26.820\nyou'll just see it as an option\nright there, pruning.\n\n972\n00:47:26.820 --> 00:47:31.160\nVTP pruning, one of the easier commands,\nand that turns it on.\n\n973\n00:47:31.160 --> 00:47:33.640\nYou only need to turn\nit on on your server.\n\n974\n00:47:33.640 --> 00:47:36.770\nThe server puts it in its\nvlan.dat database, and\n\n975\n00:47:36.770 --> 00:47:38.740\nthen it starts replicating\nthat to the other guys.\n\n976\n00:47:38.740 --> 00:47:42.781\nAnd they learn it, so they learn to turn\npruning on because the server told them.\n\n977\n00:47:42.781 --> 00:47:46.098\nBut we do need to double check and\njust make sure that it propagates out.\n\n978\n00:47:46.098 --> 00:47:47.166\nBut basically, everybody should get that.\n\n979\n00:47:47.166 --> 00:47:53.500\nIf I go take a look at core two and\nPull up my VTP status.\n\n980\n00:47:53.500 --> 00:47:54.943\nAnd look in here,\n\n981\n00:47:54.943 --> 00:48:00.262\nwhat I should see is that pruning\nmode will go to enabled shortly.\n\n982\n00:48:00.262 --> 00:48:01.190\nAll right?\n\n983\n00:48:01.190 --> 00:48:04.140\nNow I could wait for that,\nor I could turn it on.\n\n984\n00:48:04.140 --> 00:48:06.120\nNow, we really don't have to\nturn it on in the server and\n\n985\n00:48:06.120 --> 00:48:11.130\nwait for it to propagate out, but if I\njump in to config, I can do VTP pruning.\n\n986\n00:48:11.130 --> 00:48:14.460\nAnd see how it thought for\na second, and then it turned it on?\n\n987\n00:48:14.460 --> 00:48:16.680\nI'm a client, but\nI can still turn pruning on.\n\n988\n00:48:16.680 --> 00:48:18.530\nYou can pick and\nchoose where you want to turn it on.\n\n989\n00:48:18.530 --> 00:48:21.100\nIf you turn it on at the server,\nit'll propagate out.\n\n990\n00:48:21.100 --> 00:48:24.300\nIf you turn it on in a client,\nit just sits right here and turns on, so\n\n991\n00:48:24.300 --> 00:48:29.442\nwe can actually do a specific\npoint to turn that on or off.\n\n992\n00:48:29.442 --> 00:48:32.450\nAll right.\nSo now that I've got pruning on, VTP's\n\n993\n00:48:32.450 --> 00:48:35.570\ngonna start looking at those trunks, and\nlooking at the switch on the other side.\n\n994\n00:48:35.570 --> 00:48:38.950\nAnd say do you actually have\nany ports on this VLAN?\n\n995\n00:48:38.950 --> 00:48:40.890\nIf you do,\nI'll send you that VLAN's traffic.\n\n996\n00:48:40.890 --> 00:48:43.830\nAnd if you don't, I'll prune that off and\nyou won't get it anymore.\n\n997\n00:48:43.830 --> 00:48:48.060\nAll right, and that helps to minimize\nthat traffic and it's all automatic.\n\n998\n00:48:48.060 --> 00:48:51.250\nBut now, we get to start that waiting game\nwhile it kinda synchronizes that out.\n\n999\n00:48:51.250 --> 00:48:53.160\nIt'll take it just a bit.\n\n1000\n00:48:53.160 --> 00:48:54.839\nIf I double check my status,\n\n1001\n00:48:56.640 --> 00:49:00.220\nI should see in my status that\npruning is indeed now turned on.\n\n1002\n00:49:00.220 --> 00:49:01.810\nSo there it is, it's on.\n\n1003\n00:49:01.810 --> 00:49:05.950\nAnd we're just kind of waiting\nto kind of parse that out.\n\n1004\n00:49:05.950 --> 00:49:11.020\nAnd if I do a show VLAN brief,\nwell my VLANs don't actually change.\n\n1005\n00:49:11.020 --> 00:49:16.370\nI'm still gonna know about all the VLANs,\nbut when I do a show interface trunk,\n\n1006\n00:49:16.370 --> 00:49:20.130\nwhat I expect to see is that some\nof the VLANs get pruned off.\n\n1007\n00:49:20.130 --> 00:49:20.760\nOkay.\n\n1008\n00:49:20.760 --> 00:49:25.020\nAnd if I look down here,\nsee how I've got fa1/0/23,\n\n1009\n00:49:25.020 --> 00:49:29.270\nand it's only showing VLAN 1 down\nhere in the forwarding state.\n\n1010\n00:49:29.270 --> 00:49:31.120\nAnd it's not showing all the other ones.\n\n1011\n00:49:31.120 --> 00:49:33.310\nThis guy up here, that's that\nconnection to that other switch again,\n\n1012\n00:49:33.310 --> 00:49:34.195\ngetting in my way.\n\n1013\n00:49:34.195 --> 00:49:35.800\n>> [LAUGH]\n>> And it's up.\n\n1014\n00:49:35.800 --> 00:49:37.530\nI'm going to shut that one\noff on this switch, too.\n\n1015\n00:49:38.550 --> 00:49:41.090\nWhen you have older switches,\nthere's some interesting problems that can\n\n1016\n00:49:41.090 --> 00:49:43.260\ncreep up because of the way\nspanning tree works.\n\n1017\n00:49:43.260 --> 00:49:44.300\nI want to tackle those right now.\n\n1018\n00:49:44.300 --> 00:49:45.850\nThat's why I'm just shutting this down,\nbut\n\n1019\n00:49:45.850 --> 00:49:48.510\nwe'll see those when we get\ninto the spanning tree episode.\n\n1020\n00:49:48.510 --> 00:49:50.280\nSo at that point, it shuts them down.\n\n1021\n00:49:50.280 --> 00:49:51.960\nAnd now,\nI just have my one connection, and\n\n1022\n00:49:51.960 --> 00:49:56.110\nI'll have to give that a second\nto kind of resort itself out.\n\n1023\n00:49:56.110 --> 00:49:57.850\nWhich it will do hopefully shortly.\n\n1024\n00:49:58.850 --> 00:50:01.150\nBut now, VTP is gonna kick in and\nstart pruning things.\n\n1025\n00:50:01.150 --> 00:50:02.200\nGetting that nice and clean, and\n\n1026\n00:50:02.200 --> 00:50:05.460\nI'm gonna stop wasting traffic\non the network, right?\n\n1027\n00:50:05.460 --> 00:50:11.320\nMy only trick here now is to just\nbe patient, which I am horrible at.\n\n1028\n00:50:11.320 --> 00:50:13.990\n>> Don says if you want patience\nbecome a doctor, right?\n\n1029\n00:50:13.990 --> 00:50:15.100\n[LAUGH]\n>> That's right.\n\n1030\n00:50:16.150 --> 00:50:21.718\nSo we could sit around here and wait all\nday, or let's see if it's kicked in here.\n\n1031\n00:50:21.718 --> 00:50:23.530\nIt usually doesn't take that long.\n\n1032\n00:50:23.530 --> 00:50:26.550\nMy bad typing is what's\ngonna take the longest.\n\n1033\n00:50:26.550 --> 00:50:30.134\nAnd when it's done,\nwe should see it start to open.\n\n1034\n00:50:30.134 --> 00:50:30.697\nOh, there it goes.\n\n1035\n00:50:30.697 --> 00:50:31.399\nAll right.\n\n1036\n00:50:31.399 --> 00:50:36.760\nSo now, I can look down here and\nsee on Fa1/0/23?\n\n1037\n00:50:36.760 --> 00:50:39.520\nSee how it's only forwarding VLANS 1 and\n12.\n\n1038\n00:50:39.520 --> 00:50:41.060\nWhy VLANs 1 and 12?\n\n1039\n00:50:41.060 --> 00:50:42.740\nWell, if I look at that switch.\n\n1040\n00:50:42.740 --> 00:50:47.323\nIf I look at Core 2,\nthe one at the other end of that trunk and\n\n1041\n00:50:47.323 --> 00:50:52.950\nI do a show VLAN brief, it's only\ngot ports assigned in VLAN 1 and 12.\n\n1042\n00:50:52.950 --> 00:50:57.650\nSo it's going to prune off 2 through 6\nbecause there's no ports over here for it.\n\n1043\n00:50:57.650 --> 00:51:00.659\nRight?\nSo VTP pruning is actively running and\n\n1044\n00:51:00.659 --> 00:51:05.082\nI can see it right there on that\ntrunk being pruned and optimized.\n\n1045\n00:51:05.082 --> 00:51:06.880\nAnd I didn't have to do it.\n\n1046\n00:51:06.880 --> 00:51:09.960\nAnd if I go and start adding more ports\non the other switch that are in VLAN that\n\n1047\n00:51:09.960 --> 00:51:12.540\nwere being pruned,\nit'll add those VLANs back in.\n\n1048\n00:51:12.540 --> 00:51:15.240\nSo if I go to Core 2 and I pick a port.\n\n1049\n00:51:16.400 --> 00:51:18.428\nDo I have any?\n\n1050\n00:51:18.428 --> 00:51:20.830\nLet's see if I have any\nother ports that are up.\n\n1051\n00:51:20.830 --> 00:51:24.070\nIt's kind of important for the port to\nactually be up too, it looks at that.\n\n1052\n00:51:24.070 --> 00:51:28.490\nSo, if I assign a port that's down to\na VLAN, it's not gonna bring it in.\n\n1053\n00:51:28.490 --> 00:51:29.703\nSo, let's see.\n\n1054\n00:51:29.703 --> 00:51:34.122\nPort 12 is up, and 23 and 24, great.\n\n1055\n00:51:34.122 --> 00:51:38.075\nSo I don't have any other ports that\nare kind of ready for me to use.\n\n1056\n00:51:38.075 --> 00:51:40.440\nI guess I could falsify Port 22.\n\n1057\n00:51:40.440 --> 00:51:41.400\nLet's do that.\n\n1058\n00:51:43.110 --> 00:51:46.400\nSo if I take this guy and\njust switch port mode access.\n\n1059\n00:51:46.400 --> 00:51:48.368\nI'm gonna hard set it to an access port.\n\n1060\n00:51:50.646 --> 00:51:54.860\nAnd I'll set it to vlan 5.\n\n1061\n00:51:54.860 --> 00:51:57.660\nI'm only getting VLAN 1 and\n12 across the link, but\n\n1062\n00:51:57.660 --> 00:52:01.450\nI'm gonna set this one to VLAN 5 and\nbring that up.\n\n1063\n00:52:01.450 --> 00:52:02.720\nActually, I'm gonna kill cdp on it too.\n\n1064\n00:52:02.720 --> 00:52:04.070\nOtherwise, I'm gonna get\na bunch of errors there.\n\n1065\n00:52:06.260 --> 00:52:10.152\nAnd so, we'll kill that off,\nand then we'll bring it online.\n\n1066\n00:52:10.152 --> 00:52:12.327\nAll right?\nAnd I don't know if we have LLDP running\n\n1067\n00:52:12.327 --> 00:52:13.096\non this thing.\n\n1068\n00:52:13.096 --> 00:52:16.280\nBut, we'll kill that off too just in case.\n\n1069\n00:52:16.280 --> 00:52:17.879\nAll right.\nSo, that interface is going to come up.\n\n1070\n00:52:17.879 --> 00:52:21.928\nAnd so now, when I do a show vlan br,\nI've got a port that's up and\n\n1071\n00:52:21.928 --> 00:52:26.165\nactive in VLAN 5 and that voiceover\nIP network that I made earlier.\n\n1072\n00:52:26.165 --> 00:52:27.330\nRight?\n\n1073\n00:52:27.330 --> 00:52:30.680\nBut, I'm not getting VLAN 5\ntraffic cuz it's being pruned off.\n\n1074\n00:52:30.680 --> 00:52:33.360\nThe VTP should learn that and\ncorrect it for me.\n\n1075\n00:52:33.360 --> 00:52:36.240\nSo if I jump back to my core over here,\n\n1076\n00:52:36.240 --> 00:52:39.620\nI can see in my history where\nI was just getting 1 and 12.\n\n1077\n00:52:39.620 --> 00:52:43.430\nAnd lets see if this patience pays off.\n\n1078\n00:52:43.430 --> 00:52:45.430\nNow, 1, 5, and 12.\n\n1079\n00:52:45.430 --> 00:52:48.260\nSo VTP pruning is nice\nbecause it's automatic.\n\n1080\n00:52:48.260 --> 00:52:50.710\nWe can just turn these things on and\nit fixes it, and\n\n1081\n00:52:50.710 --> 00:52:51.960\nit fixes it across our network.\n\n1082\n00:52:51.960 --> 00:52:54.180\nIt's really, pretty slick stuff.\n\n1083\n00:52:54.180 --> 00:52:58.138\nBut if you jump switches with a VLAN,\nso I have VLAN 5 on Switch 1.\n\n1084\n00:52:58.138 --> 00:53:02.083\nNo VLAN 5 on Switch 2, and\nthen VLAN 5 on Switch 3,\n\n1085\n00:53:02.083 --> 00:53:06.838\nswitch three can't communicate\nall the way back to switch one.\n\n1086\n00:53:06.838 --> 00:53:08.982\nYou only talk to your neighbors,\nand it's getting pruned.\n\n1087\n00:53:08.982 --> 00:53:10.427\nSo we just have to be careful with that.\n\n1088\n00:53:10.427 --> 00:53:12.617\nBut otherwise, it works pretty well.\n\n1089\n00:53:12.617 --> 00:53:14.343\n>> Don, this is fascinating stuff.\n\n1090\n00:53:14.343 --> 00:53:18.731\nI thoroughly enjoy getting behind the CLI\nof a switch or a router from Cisco, and\n\n1091\n00:53:18.731 --> 00:53:22.153\nplaying around trying to get\nthings to work as they need to be.\n\n1092\n00:53:22.153 --> 00:53:24.658\nDon, that was actually\nsome pretty amazing stuff.\n\n1093\n00:53:24.658 --> 00:53:29.029\nI have to be honest, I'm sure our viewers\nare just riveted to their seats as we are.\n\n1094\n00:53:29.029 --> 00:53:32.530\nAnd is there anything else we need to talk\nabout before we close this here episode?\n\n1095\n00:53:32.530 --> 00:53:33.340\n>> That's about it.\n\n1096\n00:53:33.340 --> 00:53:35.694\nJust remember the secret\nof VTP is patience.\n\n1097\n00:53:35.694 --> 00:53:37.700\n>> [LAUGH]\n>> It's supposed to be a simple protocol,\n\n1098\n00:53:37.700 --> 00:53:39.390\nyou turn it on, it just does its thing.\n\n1099\n00:53:39.390 --> 00:53:41.130\nBut, you do have to verify.\n\n1100\n00:53:41.130 --> 00:53:42.380\nAlways verify your configuration.\n\n1101\n00:53:42.380 --> 00:53:43.680\nDo that on the exam too.\n\n1102\n00:53:43.680 --> 00:53:46.580\nMake sure that you put the commands in,\nmake sure that they're actually\n\n1103\n00:53:46.580 --> 00:53:48.890\nworking because sometimes they\ndon't like you saw with mine.\n\n1104\n00:53:48.890 --> 00:53:51.470\n>> Yeah,\nyou'd hate to lose that exam just because\n\n1105\n00:53:51.470 --> 00:53:52.782\nwell you didn't verify your own work.\n\n1106\n00:53:52.782 --> 00:53:53.453\nAll right.\n\n1107\n00:53:53.453 --> 00:53:56.930\ntTat being said, we're gonna go ahead and\nsign off for ITProTV.\n\n1108\n00:53:56.930 --> 00:53:57.760\nThanks for watching.\n\n1109\n00:53:57.760 --> 00:53:59.280\nI've been your host Daniel Lowery.\n\n1110\n00:53:59.280 --> 00:54:00.110\n>> And I'm Don Pizet.\n\n1111\n00:54:00.110 --> 00:54:02.014\nWe'll see you next time.\n\n1112\n00:54:02.014 --> 00:54:08.190\n[MUSIC]\n\n",
          "vimeoId": "141104337"
        },
        {
          "description": "In this episode, Don and Daniel describe how to configure and verify Etherchannel in Cisco switches. They start off with a quick overview of what Etherchannel is and what its used for and then jump into configuring a switch using Etherchannel protocols such as LACP, PAgP, and the Etherchannel protocol itself.",
          "length": "1712",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch-1-5-ether_chanel-093015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch-1-5-ether_chanel-093015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch-1-5-ether_chanel-093015-1-sm.jpg",
          "title": "Ether Channel",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.813 --> 00:00:13.617\nAll right, greetings everyone.\n\n3\n00:00:13.617 --> 00:00:16.790\nWelcome to another exciting\nepisode of ITProTV.\n\n4\n00:00:16.790 --> 00:00:18.130\nI'm your host, Daniel Lowrie.\n\n5\n00:00:18.130 --> 00:00:21.032\nHere with me today is\nthe illustrious Don Pezet.\n\n6\n00:00:21.032 --> 00:00:22.310\nHow's it going today Don?\n\n7\n00:00:22.310 --> 00:00:24.600\n>> [LAUGH] I am doing great Daniel,\nglad to be back on this show.\n\n8\n00:00:24.600 --> 00:00:27.860\nAnd we're gonna be jumping into\na neat topic today as we take a look\n\n9\n00:00:27.860 --> 00:00:29.812\nat Cisco EtherChannel.\n\n10\n00:00:29.812 --> 00:00:33.080\nAnd EtherChannel's one of those\nneat features that's built into\n\n11\n00:00:33.080 --> 00:00:35.220\ndarn near every Cisco switch.\n\n12\n00:00:35.220 --> 00:00:38.480\nAnd it's something that a lot of people\ndon't take advantage of cuz it's\n\n13\n00:00:38.480 --> 00:00:41.350\nnot one of those\nautomatically enable things.\n\n14\n00:00:41.350 --> 00:00:44.920\nSo it's another one of those great\ntechnologies where if you know about it,\n\n15\n00:00:44.920 --> 00:00:46.020\nyou can jump in.\n\n16\n00:00:46.020 --> 00:00:49.260\nYou can configure it and you can really\nchange the performance of your network.\n\n17\n00:00:49.260 --> 00:00:52.715\nIf you don't know about it, you can\nactually be running in a sub optimal\n\n18\n00:00:52.715 --> 00:00:54.973\nnetwork and not even know it,\nnot realize it.\n\n19\n00:00:54.973 --> 00:00:58.660\nAnd so, it's a pretty cool technology and\nwe want to take a look at it today.\n\n20\n00:00:58.660 --> 00:01:00.540\n>> Yeah, definitely want\nto optimize my network Don.\n\n21\n00:01:00.540 --> 00:01:01.711\nTeach me, oh great one.\n\n22\n00:01:01.711 --> 00:01:04.960\n[LAUGH]\n>> Let me show you one of the common\n\n23\n00:01:04.960 --> 00:01:09.580\nthings that happens in a switch network\nis that as we start to build out our\n\n24\n00:01:09.580 --> 00:01:14.560\ntopology, it's not uncommon to\nhave loops in your network.\n\n25\n00:01:14.560 --> 00:01:16.840\nBut they're loops that we\ndon't think of as loops.\n\n26\n00:01:16.840 --> 00:01:19.550\nThey're loops that we\nthink of as redundancy.\n\n27\n00:01:19.550 --> 00:01:20.760\nAnd so let me show you what I mean.\n\n28\n00:01:20.760 --> 00:01:24.000\nSo I've got a little topology right\nhere that I wanna show you guys, and\n\n29\n00:01:24.000 --> 00:01:25.248\nI've got three switches.\n\n30\n00:01:25.248 --> 00:01:27.196\nSo I've got some core\nswitches up at the top.\n\n31\n00:01:27.196 --> 00:01:29.767\nI've got an access switch\ndown here at the bottom.\n\n32\n00:01:29.767 --> 00:01:35.872\nAnd if you look at these switches they've\ngot cabling that forms a triangle.\n\n33\n00:01:35.872 --> 00:01:37.414\nIt forms a circle.\n\n34\n00:01:37.414 --> 00:01:41.565\nIf the switch at the top left were to send\nout a broadcast it's gonna broadcast over\n\n35\n00:01:41.565 --> 00:01:42.490\nto this switch.\n\n36\n00:01:42.490 --> 00:01:46.460\nIt's gonna broadcast down to this switch\nand it's gonna broadcast back to core one\n\n37\n00:01:46.460 --> 00:01:49.730\nagain, back to this other switch and it's\njust gonna keep going in a circle over and\n\n38\n00:01:49.730 --> 00:01:51.360\nover and over again, and that's bad.\n\n39\n00:01:51.360 --> 00:01:54.630\nAnd so we have a protocol called\nspanning tree that we'll talk about in\n\n40\n00:01:54.630 --> 00:01:58.390\nanother episode that blocks that loop and\nit fixes that problem for us.\n\n41\n00:01:58.390 --> 00:01:59.274\nIt's great.\n\n42\n00:01:59.274 --> 00:02:02.672\nWe don't even have to configure that,\nit does it automatically.\n\n43\n00:02:02.672 --> 00:02:05.700\nNow that's normally a good thing but\nsometimes it's not.\n\n44\n00:02:05.700 --> 00:02:06.960\nMy two core switches.\n\n45\n00:02:06.960 --> 00:02:08.030\nThese guys up here.\n\n46\n00:02:08.030 --> 00:02:09.321\nSo I've got NewYork CORE1 and\n\n47\n00:02:09.321 --> 00:02:12.870\nNew York CORE2, see how I've got\ntwo links running between them?\n\n48\n00:02:12.870 --> 00:02:16.380\nWell, why do I have two links\nrunning between two switches?\n\n49\n00:02:16.380 --> 00:02:17.680\nIt could be bad design.\n\n50\n00:02:17.680 --> 00:02:19.210\nI could have where these aren't trunks.\n\n51\n00:02:19.210 --> 00:02:23.005\nOne's carrying VLAN 1, the other one's\ncarrying VLAN 2 and those are my uplinks.\n\n52\n00:02:23.005 --> 00:02:26.585\nKind of waste of ports,\nI could chunk those on a single line.\n\n53\n00:02:26.585 --> 00:02:29.135\nIt could be that I've done it for\nredundancy.\n\n54\n00:02:29.135 --> 00:02:33.415\nI run two cables so that if one fails,\nthe other can kick on,\n\n55\n00:02:33.415 --> 00:02:35.790\nthe other one can take over.\n\n56\n00:02:35.790 --> 00:02:36.720\nIt could be that I've done it for\n\n57\n00:02:36.720 --> 00:02:39.350\nextra bandwidth,\nmaybe these are gigabyte length here.\n\n58\n00:02:39.350 --> 00:02:40.097\nHere they're 100 megabit.\n\n59\n00:02:40.097 --> 00:02:41.840\nSo they're 100 megabit links.\n\n60\n00:02:41.840 --> 00:02:44.750\nIf I've got two of them,\nI wanna get 200 megabit of bandwidth.\n\n61\n00:02:44.750 --> 00:02:46.436\nMaybe that's what I want.\n\n62\n00:02:46.436 --> 00:02:49.848\nWell it doesn't really matter which\nscenario that we kind of fall under,\n\n63\n00:02:49.848 --> 00:02:52.070\nbecause the end result is the same.\n\n64\n00:02:52.070 --> 00:02:53.200\nThis creates a loop.\n\n65\n00:02:53.200 --> 00:02:56.230\nA loop right between these two switches.\n\n66\n00:02:56.230 --> 00:02:59.920\nAnd so in the background,\nspanning tree protocol's gonna kick in.\n\n67\n00:02:59.920 --> 00:03:01.510\nAnd what's it gonna do?\n\n68\n00:03:01.510 --> 00:03:03.500\nIt's gonna shut one of those ports off.\n\n69\n00:03:03.500 --> 00:03:07.740\nIt's gonna make it not function and\nthat's to block the loop.\n\n70\n00:03:07.740 --> 00:03:11.340\nSo even though I've got two links,\nI only end up with one.\n\n71\n00:03:11.340 --> 00:03:14.400\nNow if my goal was redundancy, I got it.\n\n72\n00:03:14.400 --> 00:03:18.980\nIf one link fails the loop is gone,\nso the other link comes back up and\n\n73\n00:03:18.980 --> 00:03:23.880\nnow I've got my redundancy so if that's\nwhat I've set out to do, I've achieved it.\n\n74\n00:03:23.880 --> 00:03:28.850\nBut if my goal was to get 200 megabits\nof bandwidth, I haven't done that.\n\n75\n00:03:28.850 --> 00:03:31.390\nThe second link is gonna be\nsitting there doing nothing.\n\n76\n00:03:31.390 --> 00:03:36.190\nAnd even in the redundancy model one link\ngoes down, it takes a little while for\n\n77\n00:03:36.190 --> 00:03:38.520\nSpanning Tree Protocol to\nrecognize the loop is gone and\n\n78\n00:03:38.520 --> 00:03:39.480\nbring the other link back up.\n\n79\n00:03:39.480 --> 00:03:41.390\nSo it's not instantaneous.\n\n80\n00:03:41.390 --> 00:03:45.782\nSo while this works, this does achieve\nwhat a lot of people want it to achieve,\n\n81\n00:03:45.782 --> 00:03:46.926\nit's not optimal.\n\n82\n00:03:46.926 --> 00:03:49.485\nFail over is slow,\nyou don't get the extra bandwidth and\n\n83\n00:03:49.485 --> 00:03:51.150\nit's kinda some wasted resources.\n\n84\n00:03:52.440 --> 00:03:54.630\nWhat if we could take advantage of that?\n\n85\n00:03:54.630 --> 00:03:58.270\nWhat if we could bring that second\nlink up, double up our bandwidth.\n\n86\n00:03:58.270 --> 00:04:00.560\nMake it where they're both running, so\n\n87\n00:04:00.560 --> 00:04:02.680\nif one fail the other one's\nalready running and we go?\n\n88\n00:04:02.680 --> 00:04:05.154\nThat would be great but\nthat's not the default.\n\n89\n00:04:05.154 --> 00:04:08.859\nLet's verify the default on our\nactual equipment here just to see,\n\n90\n00:04:08.859 --> 00:04:12.240\nso I'm gonna jump back here and\nI'm on core two.\n\n91\n00:04:12.240 --> 00:04:16.990\nAnd the two links between those switches,\nif I just look at that configuration.\n\n92\n00:04:16.990 --> 00:04:22.980\nIf I look at fa1/0/23 and 24.\n\n93\n00:04:22.980 --> 00:04:25.170\nI got them configured to\njust access ports right now.\n\n94\n00:04:25.170 --> 00:04:28.060\nThey're just pushing VLAN 1 and\nthat's it and that's fine.\n\n95\n00:04:28.060 --> 00:04:30.570\nI got these two links and there they are.\n\n96\n00:04:30.570 --> 00:04:32.189\nYou see nothing special.\n\n97\n00:04:32.189 --> 00:04:34.079\nNo cards up my sleeves or anything.\n\n98\n00:04:34.079 --> 00:04:37.440\n>> [LAUGH]\n>> Just regular basic configuration there.\n\n99\n00:04:37.440 --> 00:04:40.390\nAnd those interfaces\nare more than likely up.\n\n100\n00:04:40.390 --> 00:04:45.430\nIf we just take a look at\nour interface output here.\n\n101\n00:04:45.430 --> 00:04:48.347\nAnd find 23 and 24.\n\n102\n00:04:48.347 --> 00:04:52.780\nI can see those two guys right here,\nand they're both up, up.\n\n103\n00:04:52.780 --> 00:04:55.630\nSo those links are up,\nthey're happy and we're good.\n\n104\n00:04:55.630 --> 00:04:59.920\nAnd if I jump over to CORE1,\nI should basically see the same thing.\n\n105\n00:04:59.920 --> 00:05:05.313\nSo in CORE1, if I come in here and\nI do a show ip interface brief and\n\n106\n00:05:05.313 --> 00:05:09.152\nI'll just jump down and look at 23 and 24.\n\n107\n00:05:09.152 --> 00:05:12.496\nI should see that they are up,\nup, which sure enough I do.\n\n108\n00:05:12.496 --> 00:05:13.890\nSo those guys are up.\n\n109\n00:05:13.890 --> 00:05:19.830\nAnd if I do a show run for\ninterface fa1/0/23 and\n\n110\n00:05:19.830 --> 00:05:22.720\n24 again, same basic configuration\nnothing special here.\n\n111\n00:05:23.850 --> 00:05:26.480\nNow, it looks like both\nthose links are up.\n\n112\n00:05:26.480 --> 00:05:29.810\nThey're both up,\nup in the show ip interface brief output.\n\n113\n00:05:29.810 --> 00:05:32.820\nBut one of them is\nactually not gonna be up.\n\n114\n00:05:32.820 --> 00:05:36.940\nOne of them is going to be off, and it's\nspanning tree that's shutting that off.\n\n115\n00:05:36.940 --> 00:05:41.890\nIf I d o a show spanning-tree and\ntake a look at my spanning tree\n\n116\n00:05:41.890 --> 00:05:47.044\nconfiguration, I've got fa1/0/23 and\n1/0/24.\n\n117\n00:05:47.044 --> 00:05:49.490\nAnd see how they both show as forwarding?\n\n118\n00:05:49.490 --> 00:05:51.625\nYou might be thinking oh we've got them,\nwe've got Don, he's wrong!\n\n119\n00:05:51.625 --> 00:05:53.850\n>> [LAUGH]\n>> Well no they are both forwarding so\n\n120\n00:05:53.850 --> 00:05:58.190\nboth of these ports are up, but\nif I go take a look at the other switch,\n\n121\n00:05:58.190 --> 00:06:03.010\nI jump over to the other core switch\nhere and do a quick show spanning tree.\n\n122\n00:06:04.340 --> 00:06:10.903\nOn this one, I can see 23 and\n24 and look at port 24.\n\n123\n00:06:10.903 --> 00:06:13.281\nIt's an alternate and it's blocking.\n\n124\n00:06:13.281 --> 00:06:15.975\nThat status of BLK,\nthat lets me know it's blocking.\n\n125\n00:06:15.975 --> 00:06:18.472\nSpanning tree is shut\noff one of the ports.\n\n126\n00:06:18.472 --> 00:06:22.144\nNow, if I kill one of the other ports,\nif I kill port 23.\n\n127\n00:06:22.144 --> 00:06:28.850\nSo if I jump in to fa1/0/23 and\nI shut that one down, it's gonna go away.\n\n128\n00:06:28.850 --> 00:06:30.180\nThat kills the loop.\n\n129\n00:06:30.180 --> 00:06:35.320\nAnd now the other port can come back up\nand so that's where I get my redundancy.\n\n130\n00:06:35.320 --> 00:06:38.610\nSo if I watch my statuses\nhere I get that link down.\n\n131\n00:06:38.610 --> 00:06:45.340\nAnd then if I do a show spanning tree\nI can see that 24 is now in listening.\n\n132\n00:06:45.340 --> 00:06:47.720\nAnd it's gonna do listening and\nthen learning and\n\n133\n00:06:47.720 --> 00:06:49.150\nthen it's gonna go to forwarding.\n\n134\n00:06:49.150 --> 00:06:51.350\nListening and\nlearning take 15 seconds each.\n\n135\n00:06:51.350 --> 00:06:53.980\nSo after 30 seconds,\nit's gonna fail over and come up.\n\n136\n00:06:55.260 --> 00:06:59.910\nWell that means that I've got redundancy,\nbut I got a 30 second down time.\n\n137\n00:06:59.910 --> 00:07:03.310\nNow in our spanning tree episodes we're\ngonna see how we can optimize that and\n\n138\n00:07:03.310 --> 00:07:04.700\nmake it much, much shorter.\n\n139\n00:07:04.700 --> 00:07:07.590\nBut just with the default configuration\nof a Cisco switch which was\n\n140\n00:07:07.590 --> 00:07:09.580\nunfortunately what a lot\nof people are running.\n\n141\n00:07:09.580 --> 00:07:11.310\nExpect a 30 second down time.\n\n142\n00:07:11.310 --> 00:07:16.570\nSo if I run two links, I only get the band\nlength of one link cuz only one is active\n\n143\n00:07:16.570 --> 00:07:20.220\nand if it fails, I've got a 30 second\ndelay before the other one kicks in.\n\n144\n00:07:20.220 --> 00:07:25.800\nSo I get redundancy but it's not optimal,\nEtherChannel can fix that.\n\n145\n00:07:25.800 --> 00:07:29.992\nIt can solve that problem, because what\nEtherChannel does is it takes the two\n\n146\n00:07:29.992 --> 00:07:33.680\nnetwork cards or network interfaces,\nand it bonds them together.\n\n147\n00:07:33.680 --> 00:07:35.550\nThat's why they call it a channel.\n\n148\n00:07:35.550 --> 00:07:37.640\nYou hear them described as\na few different things,\n\n149\n00:07:37.640 --> 00:07:42.080\nyou'll hear them called Channel groups,\nyou'll hear them called port groups and\n\n150\n00:07:42.080 --> 00:07:45.090\nyou'll hear them called bonds and bundles.\n\n151\n00:07:45.090 --> 00:07:48.000\nAnd it just depends on which\nCisco document you're reading,\n\n152\n00:07:48.000 --> 00:07:49.630\nwhich one they decide to call them.\n\n153\n00:07:49.630 --> 00:07:50.800\nYou'll see several of the terms here.\n\n154\n00:07:50.800 --> 00:07:53.315\nBut the official standard\nname is a bundle.\n\n155\n00:07:53.315 --> 00:07:56.263\nSo it bundles the two\ninterfaces together so\n\n156\n00:07:56.263 --> 00:07:59.537\nthat spanning tree will\nsee it as one interface.\n\n157\n00:07:59.537 --> 00:08:01.418\nCan one interface make a loop?\n\n158\n00:08:01.418 --> 00:08:02.173\nNo.\n\n159\n00:08:02.173 --> 00:08:03.473\nThe loop goes away.\n\n160\n00:08:03.473 --> 00:08:06.073\nIt's so both interfaces come up.\n\n161\n00:08:06.073 --> 00:08:09.830\nAnd the cool part about that is I'm\nnow getting 200 megabits of bandwidth.\n\n162\n00:08:09.830 --> 00:08:11.080\nThat's pretty awesome.\n\n163\n00:08:11.080 --> 00:08:15.722\nAnd if one link fails, it should go\ndown to 100 megabit of bandwidth.\n\n164\n00:08:15.722 --> 00:08:17.242\nYou actually don't have downtime.\n\n165\n00:08:17.242 --> 00:08:18.840\nThere's no listening and\nlearning all that.\n\n166\n00:08:18.840 --> 00:08:21.510\nIt's still the same order,\nit just has less bandwidth.\n\n167\n00:08:21.510 --> 00:08:24.790\nAnd if that other port come back up,\nit goes back up to 200 megabit again.\n\n168\n00:08:24.790 --> 00:08:30.200\nAnd so, it's a great solution for\noptimal performance, fast failover.\n\n169\n00:08:30.200 --> 00:08:32.880\nThere's a lot of really good benefit for\ndoing EtherChannel.\n\n170\n00:08:32.880 --> 00:08:35.190\n>> Well Don,\ndo we have to get a credit reference?\n\n171\n00:08:35.190 --> 00:08:36.370\nWhat do we need to do to buy this?\n\n172\n00:08:36.370 --> 00:08:39.847\nBecause I am sold on EtherChannel being\nable to increase that bandwidth and\n\n173\n00:08:39.847 --> 00:08:41.012\nstill have redundancy.\n\n174\n00:08:41.012 --> 00:08:42.220\nThat's the way to fly.\n\n175\n00:08:42.220 --> 00:08:43.730\nI gotta know how to turn this on.\n\n176\n00:08:43.730 --> 00:08:46.062\n>> Yeah, and fortunately,\nit's actually pretty simple.\n\n177\n00:08:46.062 --> 00:08:51.180\nSo EtherChannel, it's built into\nevery Cisco switch I've ever touched.\n\n178\n00:08:51.180 --> 00:08:53.230\nI can't think of a Cisco\nswitch I've used that didn't.\n\n179\n00:08:53.230 --> 00:08:55.677\nWell, they got those Linksys ones.\n\n180\n00:08:55.677 --> 00:08:57.837\n[LAUGH] They're kinda branded Cisco.\n\n181\n00:08:57.837 --> 00:08:59.910\nAnd even some of those\nsupport EtherChannel.\n\n182\n00:08:59.910 --> 00:09:01.120\nThey just call it something different,\n\n183\n00:09:01.120 --> 00:09:02.810\nwhich we'll see a little\nlater in this show.\n\n184\n00:09:02.810 --> 00:09:06.540\nBut pretty much every\nsystem switch supports it.\n\n185\n00:09:06.540 --> 00:09:07.690\nThere are a few things to remember,\n\n186\n00:09:07.690 --> 00:09:11.490\na few little caveats,\nhow many ports you can bond.\n\n187\n00:09:11.490 --> 00:09:13.960\nIn my example here,\nI'm just doing two ports.\n\n188\n00:09:13.960 --> 00:09:17.880\nBut most Cisco switches\nsupport between 8 and 16.\n\n189\n00:09:17.880 --> 00:09:21.630\nYour low-end switches can usually\nbond up to eight ports together.\n\n190\n00:09:21.630 --> 00:09:26.993\nAnd your higher end ones can bond up to 16\nports together, so you may be able to take\n\n191\n00:09:26.993 --> 00:09:32.140\n16 1 gig ports and bond them\ntogether to create a 16 gig port.\n\n192\n00:09:32.140 --> 00:09:32.710\nThat's pretty sweet.\n\n193\n00:09:33.970 --> 00:09:39.370\nOr imagine if you had 8 10 gig ports and\nyou bond those turkeys together,\n\n194\n00:09:39.370 --> 00:09:42.410\nnow you've got an 80 gig connection\ncoming out of that switch.\n\n195\n00:09:42.410 --> 00:09:43.440\nThat's pretty impressive stuff.\n\n196\n00:09:44.450 --> 00:09:47.370\nSo you can bond some pretty\nbig things together.\n\n197\n00:09:47.370 --> 00:09:51.550\nKey thing to remember though is\nthat you can't mix bandwidth.\n\n198\n00:09:51.550 --> 00:09:53.580\nI shouldn't say it absolutely like this.\n\n199\n00:09:53.580 --> 00:09:54.508\nYou can mix bandwidth.\n\n200\n00:09:54.508 --> 00:09:56.330\n>> [LAUGH]\n>> It just doesn't work right.\n\n201\n00:09:56.330 --> 00:10:00.590\n[LAUGH] So rule of thumb,\nis try not to mix bandwidth.\n\n202\n00:10:00.590 --> 00:10:01.180\nHere's what happens.\n\n203\n00:10:01.180 --> 00:10:06.430\nSo let's say I bond 4 gig connections and\n400 meg connections.\n\n204\n00:10:06.430 --> 00:10:07.310\nSo I hit eight connections.\n\n205\n00:10:08.710 --> 00:10:13.318\nWhat's gonna happen is either channel's\ngonna hold down the 400 meg connections\n\n206\n00:10:13.318 --> 00:10:15.568\nand it's just gonna bomb the 4 gig ones.\n\n207\n00:10:15.568 --> 00:10:19.684\nAnd it's gonna wait until\nthe very last gig one fails, and\n\n208\n00:10:19.684 --> 00:10:24.911\nwhen the last gig port fails,\nthen it'll bring those 400 meg ones in.\n\n209\n00:10:24.911 --> 00:10:29.230\nSo it will suppress some of those\nconnections until they're all equal.\n\n210\n00:10:29.230 --> 00:10:30.230\nThat's what it's looking for.\n\n211\n00:10:30.230 --> 00:10:32.760\nSo if the EtherChannel really\nexpects that equal point,\n\n212\n00:10:32.760 --> 00:10:35.340\nit will let you add\nnon-equal interfaces to it.\n\n213\n00:10:35.340 --> 00:10:36.890\nIt just holds them down.\n\n214\n00:10:36.890 --> 00:10:40.030\nSo it's not that you can't mix bandwidth.\n\n215\n00:10:40.030 --> 00:10:43.080\nIt's that you shouldn't, unless you\nhave a really good reason for that.\n\n216\n00:10:43.080 --> 00:10:43.809\n>> Important side detail.\n\n217\n00:10:43.809 --> 00:10:44.826\n[LAUGH]\n>> Absolutely.\n\n218\n00:10:44.826 --> 00:10:45.686\n>> Keep that in mind.\n\n219\n00:10:45.686 --> 00:10:46.500\n[LAUGH]\n>> Now,\n\n220\n00:10:46.500 --> 00:10:49.870\non the configuration side,\nI said it was pretty simple.\n\n221\n00:10:49.870 --> 00:10:51.200\nIf we go and configure it,\n\n222\n00:10:51.200 --> 00:10:54.340\nwe have to remember that we've gotta\nconfigure it on both sides of the link.\n\n223\n00:10:55.400 --> 00:11:00.730\nSo if I've got a Cisco switch and it's\nplugged into a HP Broker or into a router,\n\n224\n00:11:00.730 --> 00:11:04.990\nfor that matter, I need to be able to\nconfigure EtherChannel on both sides, and\n\n225\n00:11:04.990 --> 00:11:06.830\nnot every router supports EtherChannel.\n\n226\n00:11:06.830 --> 00:11:09.180\nNot every Broker supports EtherChannel.\n\n227\n00:11:09.180 --> 00:11:12.080\nIt's not as widely accepted\n\n228\n00:11:12.080 --> 00:11:14.880\nas some of the other standards\nthat we'll see a little bit later.\n\n229\n00:11:14.880 --> 00:11:17.240\nSo we just have to make sure both sides\nsupport it and we get it configured.\n\n230\n00:11:17.240 --> 00:11:20.883\nNow, I've got two Cisco switches so\nI'm gonna have no problem what so ever.\n\n231\n00:11:20.883 --> 00:11:21.906\nI'm setting myself up for failure so.\n\n232\n00:11:21.906 --> 00:11:23.450\n>> [LAUGH] So it's not gonna work at all.\n\n233\n00:11:23.450 --> 00:11:24.761\n>> [LAUGH]\n>> [LAUGH] So\n\n234\n00:11:24.761 --> 00:11:26.310\nanyhow we can jump in we can figure it.\n\n235\n00:11:26.310 --> 00:11:30.030\nSo the first thing I wanna show you\nguys here is called Raw EtherChannel.\n\n236\n00:11:30.030 --> 00:11:32.040\nJust straight up EtherChannel\ngetting it set up and\n\n237\n00:11:32.040 --> 00:11:33.428\nbonding these two links together.\n\n238\n00:11:33.428 --> 00:11:37.129\nSo I'm gonna start out\nhere on my core router.\n\n239\n00:11:37.129 --> 00:11:39.280\nActually it doesn't really\nmatter which side I start on.\n\n240\n00:11:39.280 --> 00:11:41.670\nI can start on core 1 or\nI can start on core 2.\n\n241\n00:11:41.670 --> 00:11:45.360\nOne thing that I like to do is when\nI do a configuration like this\n\n242\n00:11:45.360 --> 00:11:49.580\nI like to shut the ports down while\nI put the configuration in, and\n\n243\n00:11:49.580 --> 00:11:51.650\nthen turn the ports on when I'm done.\n\n244\n00:11:51.650 --> 00:11:53.150\nYou don't have to do that.\n\n245\n00:11:53.150 --> 00:11:56.720\nBut the reason I do it is, if you're in\nan environment where you strictly monitor\n\n246\n00:11:56.720 --> 00:12:00.270\nyour syslogs and all that, you're gonna\ngenerate some errors while you're\n\n247\n00:12:00.270 --> 00:12:03.930\nconfiguring this, cuz if you think with\none side before the other so shutting off\n\n248\n00:12:03.930 --> 00:12:07.430\nthe interfaces kinda saves us that trouble\nand makes sure things run the right way.\n\n249\n00:12:07.430 --> 00:12:11.290\nSo that's what I'm gonna do, I'm gonna\nstart drilling port two, now when we\n\n250\n00:12:11.290 --> 00:12:15.210\nconfigure EtherChannel, we're normally\ngonna be bonding two or more connections.\n\n251\n00:12:15.210 --> 00:12:16.650\nYou can create an EtherChannel\nwith one connection.\n\n252\n00:12:17.930 --> 00:12:22.653\nThere's not a whole lot of point in that,\nbut let me just give you a scenario.\n\n253\n00:12:22.653 --> 00:12:25.043\nMaybe you're planning on\nadding more connections later,\n\n254\n00:12:25.043 --> 00:12:28.050\nyou don't have them now, but\nyou wanna add them later.\n\n255\n00:12:28.050 --> 00:12:29.950\nWell, when you configure EtherChannel,\n\n256\n00:12:29.950 --> 00:12:32.100\nyou've gotta take that\nlink down to configure it.\n\n257\n00:12:32.100 --> 00:12:33.990\nSo now you're gonna create downtime.\n\n258\n00:12:33.990 --> 00:12:36.120\nWell, what if I don't have\nthat other connection yet, but\n\n259\n00:12:36.120 --> 00:12:37.900\nI just wanna be set up for it?\n\n260\n00:12:37.900 --> 00:12:41.940\nI could create an EtherChannel, put\nthe one link in there and do it now, and\n\n261\n00:12:41.940 --> 00:12:43.150\njust run that way.\n\n262\n00:12:43.150 --> 00:12:46.199\nAnd then in the future, when I add\nthe second link, I can just add it,\n\n263\n00:12:46.199 --> 00:12:48.895\nthe EtherChannel and\nI can do it live without taking it down.\n\n264\n00:12:48.895 --> 00:12:50.455\nYou can do it in the middle of the day.\n\n265\n00:12:50.455 --> 00:12:52.815\nPeople would just all of\na sudden have more bandwidth.\n\n266\n00:12:52.815 --> 00:12:55.535\nSo that's one scenario where you might\nconfigure an EtherChannel with one link,\n\n267\n00:12:55.535 --> 00:12:56.895\nbut normally it's gonna be two.\n\n268\n00:12:56.895 --> 00:13:01.835\nSo when I configure this I almost\nalways use the interface range command.\n\n269\n00:13:01.835 --> 00:13:04.875\nWe can combine all the interfaces to make\nsure they have a common configuration.\n\n270\n00:13:04.875 --> 00:13:07.605\nNow, before you get started you\nwanna check those interfaces and\n\n271\n00:13:07.605 --> 00:13:10.160\nmake sure you actually do\nhave a common configuration.\n\n272\n00:13:10.160 --> 00:13:13.160\nI already did that at the beginning\nof the show when I looked at those\n\n273\n00:13:13.160 --> 00:13:15.640\nport configurations way back here and\n\n274\n00:13:15.640 --> 00:13:17.800\nI saw that they were just that up\nas access ports and that's it.\n\n275\n00:13:17.800 --> 00:13:20.711\nSo you do want them to be\nconfigured the same way.\n\n276\n00:13:20.711 --> 00:13:27.248\nSo now, I'm just gonna do\nan interface range fa1/0/23- 24.\n\n277\n00:13:27.248 --> 00:13:28.328\nSo now,\nI'm modifying both ports at the same time.\n\n278\n00:13:28.328 --> 00:13:33.620\nAnd I don't wanna force\nthem into a bundle.\n\n279\n00:13:33.620 --> 00:13:38.350\nSo the way we do that is we start\nby defining a channel group.\n\n280\n00:13:38.350 --> 00:13:42.920\nSo we say channel-group and\nwe give it a number.\n\n281\n00:13:42.920 --> 00:13:46.650\nWhat's gonna happen when I run this\ncommand is it's gonna create a virtual\n\n282\n00:13:46.650 --> 00:13:47.900\ninterface.\n\n283\n00:13:47.900 --> 00:13:52.100\nIt's gonna combine ports 23 and\n24 into 1 virtual interface.\n\n284\n00:13:52.100 --> 00:13:56.260\nThe channel-group command is what\ngroups the ports together, and\n\n285\n00:13:56.260 --> 00:13:59.680\nthe virtual interface is\nwhat's called a port channel.\n\n286\n00:13:59.680 --> 00:14:02.180\nSo remember I said there were\ndifferent terms for this, bundle,\n\n287\n00:14:02.180 --> 00:14:04.310\nbond, port channel, channel group.\n\n288\n00:14:04.310 --> 00:14:06.010\nRight?\nThis is where these terms are coming from.\n\n289\n00:14:06.010 --> 00:14:08.790\nThe channel group is what\ngroups the interfaces together.\n\n290\n00:14:08.790 --> 00:14:10.635\nThe port channel is the virtual interface.\n\n291\n00:14:10.635 --> 00:14:13.455\nHere, people use those terms as\nif they were interchangeable, and\n\n292\n00:14:13.455 --> 00:14:16.360\nthey are actually kinda two\ndifferent things there.\n\n293\n00:14:16.360 --> 00:14:17.770\nSo I'm gonna do a channel group.\n\n294\n00:14:17.770 --> 00:14:22.470\nNow, on this switch,\nI'm limited to 48 channel groups.\n\n295\n00:14:22.470 --> 00:14:23.070\nI say I'm limited.\n\n296\n00:14:23.070 --> 00:14:24.031\nThat's like way more\nthan anybody would need.\n\n297\n00:14:24.031 --> 00:14:25.840\n>> [LAUGH]\n>> On some switches,\n\n298\n00:14:25.840 --> 00:14:28.400\nyou might have as few\nas four channel groups.\n\n299\n00:14:28.400 --> 00:14:31.640\nOn some you might have even more,\nlike on a 6,512 you might have even more.\n\n300\n00:14:31.640 --> 00:14:35.520\nSo you can create more than one\nEtherChannel on your switch.\n\n301\n00:14:35.520 --> 00:14:37.160\nYou might divide up\nseveral different ports.\n\n302\n00:14:37.160 --> 00:14:42.015\nIf this is a core switch, I might have 48\nports and I create multiple bundles of\n\n303\n00:14:42.015 --> 00:14:45.480\n4 ports each to run to different\nfloors in my building or whatever.\n\n304\n00:14:45.480 --> 00:14:46.840\nI create that kind of redundancy.\n\n305\n00:14:46.840 --> 00:14:49.320\nSo you may have more than one channel\ngroup, but this is my first one, so\n\n306\n00:14:49.320 --> 00:14:50.250\nI'll just start here.\n\n307\n00:14:50.250 --> 00:14:51.153\nAnd let's give it a number.\n\n308\n00:14:51.153 --> 00:14:53.370\nI'm gonna call it channel-group 1.\n\n309\n00:14:53.370 --> 00:14:53.980\nAll right.\n\n310\n00:14:53.980 --> 00:14:57.832\nNow, when we define the channel-group\nwe can technically stop right there.\n\n311\n00:14:57.832 --> 00:15:01.791\nBut there is a little bit extra\nwe can provide like the mode\n\n312\n00:15:01.791 --> 00:15:03.380\nthat we are gonna use.\n\n313\n00:15:03.380 --> 00:15:05.640\nNow, the mode is kind of\nan interesting thing.\n\n314\n00:15:05.640 --> 00:15:09.650\nAnd if I'm just doing Raw EtherChannel,\nthere's only one mode.\n\n315\n00:15:09.650 --> 00:15:15.301\nRaw EtherChannel, we just say,\nchannel-group 1 mode on.\n\n316\n00:15:15.301 --> 00:15:19.260\nI'm turning on the channel-group and\nI'm running EtherChannel.\n\n317\n00:15:19.260 --> 00:15:20.460\nNo matter what.\n\n318\n00:15:20.460 --> 00:15:22.440\nI don't care if the other\nside is set up right or\n\n319\n00:15:22.440 --> 00:15:23.970\nwrong, we're gonna run EtherChannel.\n\n320\n00:15:25.220 --> 00:15:28.910\nAnd when I run that command, I'm gonna\nget a little status message pop up,\n\n321\n00:15:28.910 --> 00:15:29.950\nyou'll see it right here.\n\n322\n00:15:29.950 --> 00:15:33.700\nInterface Port-channel1,\nchanged state to up.\n\n323\n00:15:33.700 --> 00:15:35.380\nWhat the heck interface is that?\n\n324\n00:15:35.380 --> 00:15:37.772\nThat's the virtual interface it just made.\n\n325\n00:15:37.772 --> 00:15:41.973\nSo Port-channel1 is now a virtual\ninterface that is a combination of\n\n326\n00:15:41.973 --> 00:15:43.261\nports 23 and 24.\n\n327\n00:15:43.261 --> 00:15:45.190\nNow, the cool part about that?\n\n328\n00:15:45.190 --> 00:15:48.560\nSpanning tree doesn't see ports 23 and\n24 anymore.\n\n329\n00:15:48.560 --> 00:15:50.760\nIt just sees Port-channel1.\n\n330\n00:15:50.760 --> 00:15:52.960\nAnd Port-channel1 is a single link.\n\n331\n00:15:52.960 --> 00:15:53.504\nNo more loop.\n\n332\n00:15:53.504 --> 00:15:55.270\nLoop is gone.\n\n333\n00:15:55.270 --> 00:16:00.154\nAnd any traffic I send to Port-channel1 is\ngonna get load balanced across those two\n\n334\n00:16:00.154 --> 00:16:01.616\nlinks and distributed.\n\n335\n00:16:01.616 --> 00:16:04.716\nAnd if one link goes down,\nPort-channel1 is still up.\n\n336\n00:16:04.716 --> 00:16:07.108\nSo I just keep sending over\nthe links that still remain.\n\n337\n00:16:07.108 --> 00:16:11.473\nI could have 16 links in there, and\n8 of them or 9 of them have failed.\n\n338\n00:16:11.473 --> 00:16:13.323\nI'm just gonna run over the ones that\nare still up and running, right?\n\n339\n00:16:13.323 --> 00:16:15.180\nJust whatever's left,\nthat's the one I'm gonna use.\n\n340\n00:16:16.270 --> 00:16:19.230\nAll right, so\nI'm now running Etherchannel.\n\n341\n00:16:19.230 --> 00:16:22.412\nJust that one command is\nreally all I had to do.\n\n342\n00:16:22.412 --> 00:16:26.760\nWas channel-group and then a number,\nright, for whatever number we're using.\n\n343\n00:16:26.760 --> 00:16:30.860\nAnd then mode on, that turns it on,\nI'm now running Etherchannel.\n\n344\n00:16:30.860 --> 00:16:35.389\nAll right, now if I get out of my\nconfig and I take a look at my\n\n345\n00:16:35.389 --> 00:16:40.307\nrunning configuration for\nsome of those interfaces, right.\n\n346\n00:16:40.307 --> 00:16:43.970\nSo there's port 23, and there's port 24.\n\n347\n00:16:43.970 --> 00:16:48.015\nAll I added was that\nchannel-group 1 mode on, right?\n\n348\n00:16:48.015 --> 00:16:52.670\nAnd I shut down 23, I forgot,\nafter I tell everybody,\n\n349\n00:16:52.670 --> 00:16:56.150\nyeah I'd like to shut these ports\ndown I forgot shut down port 24.\n\n350\n00:16:56.150 --> 00:16:59.200\nSo anyhow, I have at least\none port that's up right now.\n\n351\n00:16:59.200 --> 00:17:00.760\nNormally I shut them down,\ndo that configuration,\n\n352\n00:17:00.760 --> 00:17:02.800\nand then do another shutdown, I forgot.\n\n353\n00:17:02.800 --> 00:17:05.300\nBut I also have another port now.\n\n354\n00:17:05.300 --> 00:17:10.470\nSo if I do a show run int po1,\nwhich is that port channel, there it is.\n\n355\n00:17:10.470 --> 00:17:14.290\nAnd see how it kind of adopted the same\nconfiguration from the child interfaces?\n\n356\n00:17:14.290 --> 00:17:17.330\nIt brought those in so\nthat it would be configured the same way.\n\n357\n00:17:17.330 --> 00:17:20.430\nAnd from now on, I'm just gonna do\nthe configuration on the port channel, and\n\n358\n00:17:20.430 --> 00:17:23.470\nnot the individual interfaces, right?\n\n359\n00:17:23.470 --> 00:17:25.380\nWith the exception of\nthe shutdown command.\n\n360\n00:17:25.380 --> 00:17:26.690\nSo I do need to go and do that.\n\n361\n00:17:26.690 --> 00:17:31.480\nSo I'm gonna get back into my\nconfiguration and we'll just jump into\n\n362\n00:17:31.480 --> 00:17:37.200\nthe range and\ndo a quick no shutdown to bring those up.\n\n363\n00:17:37.200 --> 00:17:39.580\nSo, now I've got Etherchannel up and\nrunning.\n\n364\n00:17:40.630 --> 00:17:42.210\nHow do I know it's actually running?\n\n365\n00:17:42.210 --> 00:17:45.406\nWell, the easiest command, one of the best\ncommands to troubleshoot this guy,\n\n366\n00:17:45.406 --> 00:17:49.840\nis show etherchannel summary.\n\n367\n00:17:49.840 --> 00:17:52.790\nIt'll show you a summary of\nall the different etherchannel\n\n368\n00:17:52.790 --> 00:17:55.870\ngroups that you've created and\nwhat their status is.\n\n369\n00:17:55.870 --> 00:17:58.660\nAnd it's got this really cool\nway of laying out the data.\n\n370\n00:17:58.660 --> 00:18:02.280\nIt shows your link down here,\nso here's port channel 1, and\n\n371\n00:18:02.280 --> 00:18:04.930\nmy current status is SU.\n\n372\n00:18:04.930 --> 00:18:09.470\nIf I look up here, I can see S tells\nme this is a Layer2 channel group.\n\n373\n00:18:09.470 --> 00:18:11.711\nI'm on a switch,\nthis is just a regular Layer2 port.\n\n374\n00:18:11.711 --> 00:18:16.220\nAnd U tells me it's in use,\nit means it's turned on.\n\n375\n00:18:16.220 --> 00:18:20.300\nBut I've got other statuses here, like\nif it was down or in standalone mode or\n\n376\n00:18:20.300 --> 00:18:22.340\nwhatever, then I would see that.\n\n377\n00:18:22.340 --> 00:18:25.732\nOver here I can see my two ports,\nFA1/0/23 and\n\n378\n00:18:25.732 --> 00:18:29.291\nFA1/0/24, and\nthey've both got a status of P.\n\n379\n00:18:29.291 --> 00:18:34.512\nAnd if I look up here I can see,\nBundled in the port-channel, okay?\n\n380\n00:18:34.512 --> 00:18:37.680\nSo I've got them bundled, they're up,\nthey're in the channel group.\n\n381\n00:18:37.680 --> 00:18:39.470\nWe should be good to go.\n\n382\n00:18:39.470 --> 00:18:42.970\nBut I do have a little problem in that the\nother side of my link is not configured.\n\n383\n00:18:42.970 --> 00:18:45.050\nSo I gotta jump over and\nget that guy set up too.\n\n384\n00:18:45.050 --> 00:18:51.650\nSo I'll jump over to CORE1, and on CORE1\nit's not running EtherChannel, right?\n\n385\n00:18:51.650 --> 00:18:56.880\nAnd so\non this one if I do a show etherchannel\n\n386\n00:18:56.880 --> 00:19:01.420\nsummary and pull that up, it doesn't\nhave any channel groups over here.\n\n387\n00:19:01.420 --> 00:19:04.430\nSo if I start receiving bonded\ncommunications over those links,\n\n388\n00:19:04.430 --> 00:19:05.780\nwhat's gonna happen?\n\n389\n00:19:05.780 --> 00:19:07.270\nThe switch is gonna get confused.\n\n390\n00:19:07.270 --> 00:19:10.440\nAnd it's gonna mess things up and\nthings are not gonna work right.\n\n391\n00:19:10.440 --> 00:19:13.940\nOne side is distributing across two links,\nthe other side isn't.\n\n392\n00:19:13.940 --> 00:19:16.080\nSo I gotta get this one set up too.\n\n393\n00:19:16.080 --> 00:19:20.123\nSo I'll basically repeat that\nsame configuration over here, and\n\n394\n00:19:20.123 --> 00:19:24.430\nI'm gonna shut those ports down,\nand I'll do channel-group.\n\n395\n00:19:24.430 --> 00:19:27.200\nNow, for the channel group,\nI can use a different number if I want.\n\n396\n00:19:27.200 --> 00:19:29.640\nIt doesn't have to be the same\nnumber on both sides.\n\n397\n00:19:29.640 --> 00:19:34.284\nThe channel group number is just local,\nit's unique to this particular switch,\n\n398\n00:19:34.284 --> 00:19:35.370\nnot the other one.\n\n399\n00:19:35.370 --> 00:19:40.375\nSo on this one maybe I\ndo channel-group 4 and,\n\n400\n00:19:40.375 --> 00:19:43.386\nwhoops [LAUGH] well, shoot.\n\n401\n00:19:43.386 --> 00:19:45.540\nLet me just redo that real quick.\n\n402\n00:19:45.540 --> 00:19:47.647\nSorry, my error messages got in the way.\n\n403\n00:19:47.647 --> 00:19:50.630\nSo I'm going to do channel-group 4, right.\n\n404\n00:19:50.630 --> 00:19:51.530\nAnd then I'll just say mode on.\n\n405\n00:19:51.530 --> 00:19:53.571\nAnd so\nit's got a different channel-group number.\n\n406\n00:19:53.571 --> 00:19:56.937\nInstead of creating Port-channel 1\nit created Port-channel 4, and so\n\n407\n00:19:56.937 --> 00:19:59.930\nnow I've got this po4 interface.\n\n408\n00:19:59.930 --> 00:20:05.220\nAnd if I do a no shutdown to bring those\ninterfaces up, and I get out of that.\n\n409\n00:20:05.220 --> 00:20:07.470\nThere we go, they're coming,\nwell, they went down so\n\n410\n00:20:07.470 --> 00:20:09.390\nnow I gotta give them\na minute to come back up.\n\n411\n00:20:09.390 --> 00:20:12.380\nAnd when they come back up,\nthey'll be in a port-channel.\n\n412\n00:20:12.380 --> 00:20:15.580\nThey're going to use EtherChannel\nto communicate to the other side.\n\n413\n00:20:15.580 --> 00:20:18.050\nThe other side's using it too,\nthey should bond, come up, be happy,\n\n414\n00:20:18.050 --> 00:20:20.560\nand everything should just work.\n\n415\n00:20:20.560 --> 00:20:23.990\n>> Now Don, I'm loving EtherChannel,\nthis is great stuff,\n\n416\n00:20:23.990 --> 00:20:27.720\nI'm getting that redundancy, I'm\ngetting that aggregation of the speeds.\n\n417\n00:20:27.720 --> 00:20:31.177\nBut, it's really kind of a lot of\nconfiguration and I can see where,\n\n418\n00:20:31.177 --> 00:20:33.321\nif I make a mistake on one side or\nthe other,\n\n419\n00:20:33.321 --> 00:20:36.023\nI'm gonna have a lot of\ntroubleshooting on my hands.\n\n420\n00:20:36.023 --> 00:20:38.180\nIs there an easier way to do this?\n\n421\n00:20:38.180 --> 00:20:40.868\nI know I'm a lazy admin, what can I say?\n\n422\n00:20:40.868 --> 00:20:44.580\n>> So, I kinda go back to a comment\nI've made on other shows, which is,\n\n423\n00:20:44.580 --> 00:20:45.325\nI hate automatic.\n\n424\n00:20:45.325 --> 00:20:46.650\n>> Yeah.\n>> Automatic\n\n425\n00:20:46.650 --> 00:20:51.122\nis there to make your life easy, but when\nthere's automatic settings, that means\n\n426\n00:20:51.122 --> 00:20:54.339\nsometimes things might be configured\ndifferently than what we expect.\n\n427\n00:20:55.510 --> 00:20:59.470\nSo, you can bump into problems and\nmaybe your EtherChannel drops back\n\n428\n00:20:59.470 --> 00:21:02.380\nto just a regular access port and\nyou don't know it.\n\n429\n00:21:02.380 --> 00:21:05.190\nAnd so, maybe your communications\nare sub-optimal and\n\n430\n00:21:05.190 --> 00:21:07.250\nyou just don't realize it cuz you\ndon't use that particular network.\n\n431\n00:21:07.250 --> 00:21:08.420\nThat's the stuff that happens.\n\n432\n00:21:08.420 --> 00:21:09.870\nSo, I normally manually set it.\n\n433\n00:21:09.870 --> 00:21:12.710\nWhat I just showed you guys,\nthat's how I normally do it in production.\n\n434\n00:21:13.870 --> 00:21:19.600\nBut, there are two dynamic protocols\nwe can use with EtherChannel.\n\n435\n00:21:19.600 --> 00:21:25.040\nThere's LACP, which is\nthe Link Aggregation Control Protocol,\n\n436\n00:21:25.040 --> 00:21:29.520\nand then there's PAgP,\nwhich is the Port Aggregation Protocol.\n\n437\n00:21:29.520 --> 00:21:31.560\nAll right, they both do the same thing.\n\n438\n00:21:31.560 --> 00:21:35.000\nWhat they do is they allow two\nswitches to talk to each other and\n\n439\n00:21:35.000 --> 00:21:38.630\nnegotiate out an EtherChannel connection.\n\n440\n00:21:38.630 --> 00:21:42.970\nAnd if one side is configured for\nEtherChannel and the other isn't,\n\n441\n00:21:42.970 --> 00:21:47.900\ninstead of breaking, it just makes\nthe EtherChannel side not do EtherChannel.\n\n442\n00:21:47.900 --> 00:21:50.080\nAnd it drops it back to\nbeing a regular port.\n\n443\n00:21:50.080 --> 00:21:54.004\nSo it kinda insulates us from that type of\nerror that we can get into when we bring\n\n444\n00:21:54.004 --> 00:21:56.985\nthe system up and\nmove through those different functions.\n\n445\n00:21:56.985 --> 00:21:59.460\nSo that's a way we can kinda resolve that.\n\n446\n00:21:59.460 --> 00:22:02.112\nNow, if we're gonna use one\nof those dynamic protocols,\n\n447\n00:22:02.112 --> 00:22:04.126\nwe've gotta choose between PAgP and LACP.\n\n448\n00:22:04.126 --> 00:22:05.242\nLet me just tell you about them.\n\n449\n00:22:05.242 --> 00:22:09.870\nSo, PAgP Port Aggregation Protocol,\nwas developed by Cisco, Cisco proprietary.\n\n450\n00:22:09.870 --> 00:22:14.852\nIt was developed, I wanna say it was 1994?\n\n451\n00:22:14.852 --> 00:22:17.886\nThis technology, EtherChannel,\nright, let's go,\n\n452\n00:22:17.886 --> 00:22:20.060\nwe'll do super history here, right.\n\n453\n00:22:20.060 --> 00:22:22.480\nCisco did not invent EtherChannel,\nbut they own it.\n\n454\n00:22:22.480 --> 00:22:25.383\nWhat happened was there was another\ncompany that created this technology,\n\n455\n00:22:25.383 --> 00:22:26.932\na company whose name I can't remember.\n\n456\n00:22:26.932 --> 00:22:31.105\nIt might have been called EtherChannel,\nbut Cisco acquired that company,\n\n457\n00:22:31.105 --> 00:22:34.117\nthey bought it, so\nthen it became a Cisco technology.\n\n458\n00:22:34.117 --> 00:22:37.672\nAnd so Cisco created PAgP, and this is\nway back, I'm pretty sure it was 1994.\n\n459\n00:22:37.672 --> 00:22:41.901\nIt was some time in the mid 1990s\nthat they created PAgP to do the port\n\n460\n00:22:41.901 --> 00:22:45.880\naggregation and\njust have the switches talk and learn.\n\n461\n00:22:45.880 --> 00:22:50.390\nWell it's good technology, and Cisco,\nunlike some Cisco technologies,\n\n462\n00:22:50.390 --> 00:22:52.480\nthey were really open with this one and\nsharing it.\n\n463\n00:22:52.480 --> 00:22:55.680\nThey wanted to get it IEEE ratified so\nit would be a standard.\n\n464\n00:22:55.680 --> 00:22:58.330\nAnd so\nthey kind of made motions towards that.\n\n465\n00:22:58.330 --> 00:23:01.960\nAnd at the end of the 90s,\nI believe it was actually in 2000,\n\n466\n00:23:01.960 --> 00:23:05.610\nthe IEEE ratified LACP,\nthe Link Aggregation Control Protocol,\n\n467\n00:23:05.610 --> 00:23:07.800\nwhose IEEE number I can never remember.\n\n468\n00:23:07.800 --> 00:23:10.413\nI think I've got it written down, 802.1AX,\n\n469\n00:23:10.413 --> 00:23:13.286\n802.1AX if you ever wanna\nlook it up that's LACP.\n\n470\n00:23:13.286 --> 00:23:13.831\n>> The ax.\n\n471\n00:23:13.831 --> 00:23:14.517\n>> The ax, that's right.\n\n472\n00:23:14.517 --> 00:23:15.595\n>> It sounds like a radio\nstation [LAUGH] 802.1AX.\n\n473\n00:23:15.595 --> 00:23:18.928\n>> We'll slice your network up!\n\n474\n00:23:18.928 --> 00:23:19.729\n>> That's right [LAUGH].\n\n475\n00:23:19.729 --> 00:23:21.633\n>> With this protocol that combines\nnetworks, never mind [LAUGH].\n\n476\n00:23:21.633 --> 00:23:24.093\n>> [LAUGH]\n>> It's like the opposite of an ax.\n\n477\n00:23:24.093 --> 00:23:26.790\n>> Our metaphor just crumbles\nat that point [LAUGH].\n\n478\n00:23:26.790 --> 00:23:30.350\n>> But the cool thing about LACP\nis it does everything PAgP does.\n\n479\n00:23:30.350 --> 00:23:35.720\nI mean, it really does, it's feature for\nfeature identical, except it's a standard.\n\n480\n00:23:35.720 --> 00:23:38.877\nPAgP, you can use it between two\nCisco switches, like what I've got.\n\n481\n00:23:38.877 --> 00:23:42.740\nBut with LACP, you can have a Cisco switch\non one side and a ProCurve on the other.\n\n482\n00:23:42.740 --> 00:23:47.180\nOr, a Juniper or an Extreme Networks or\nwhatever, almost all of them support LACP.\n\n483\n00:23:47.180 --> 00:23:50.510\nAnd so remember when I mentioned those\ncheap Linksys switches that you can get?\n\n484\n00:23:50.510 --> 00:23:53.120\nThey're sometimes branded\nas Cisco Small Business?\n\n485\n00:23:53.120 --> 00:23:55.042\nWhich, it's really consumer.\n\n486\n00:23:55.042 --> 00:23:59.766\nBut a lot of those will support LACP and\nthey won't support PAgP.\n\n487\n00:23:59.766 --> 00:24:02.526\nAnd it's kind of confusing,\nlike well, it's a Cisco switch,\n\n488\n00:24:02.526 --> 00:24:03.865\nwhy doesn't it support PAgP?\n\n489\n00:24:03.865 --> 00:24:06.941\nAnd the short answer is,\nit wasn't always a Cisco switch.\n\n490\n00:24:06.941 --> 00:24:08.431\nIt was a Linksys switch, and\n\n491\n00:24:08.431 --> 00:24:12.090\nLinxus didn't license PAgP\nbecause LACP was perfectly fine.\n\n492\n00:24:12.090 --> 00:24:16.270\nSo there's plenty of Cisco switches out\nthere that only support LACP and not PAgP.\n\n493\n00:24:16.270 --> 00:24:23.139\nBut if you've got 2960s, 3750s,\nif you've got 6500s, 4600s.\n\n494\n00:24:23.139 --> 00:24:23.840\nIf you've got those guys, they do both.\n\n495\n00:24:25.010 --> 00:24:26.330\nThey let you pick.\n\n496\n00:24:26.330 --> 00:24:30.250\nNow I typically don't use any of them,\nright, I just hard set it, turn it on,\n\n497\n00:24:30.250 --> 00:24:31.220\nand you're done.\n\n498\n00:24:31.220 --> 00:24:34.800\nBut if you want you can use LACP and\nthe switches will talk and\n\n499\n00:24:34.800 --> 00:24:38.920\nif one side doesn't bond,\nthen they just drop down and act like\n\n500\n00:24:38.920 --> 00:24:42.360\nregular ports expanding tree shots off the\nextra ports and at least you get one link.\n\n501\n00:24:42.360 --> 00:24:45.403\nSo it's better to have one\nlink than to have nothing.\n\n502\n00:24:45.403 --> 00:24:49.780\nSo for this, in my situation here,\nI've got a hard set and\n\n503\n00:24:49.780 --> 00:24:52.030\nturned on, I might want to use\none of those dynamic protocols.\n\n504\n00:24:52.030 --> 00:24:55.750\nAnd actually let's jump back to my\nswitches here because New York Core 1,\n\n505\n00:24:55.750 --> 00:24:57.760\nthis was the second one I configured.\n\n506\n00:24:57.760 --> 00:25:01.570\nI turned it on, and I got a status message\nup here letting me know that my links went\n\n507\n00:25:01.570 --> 00:25:04.640\ndown, and\nI did a show ether channel summary.\n\n508\n00:25:04.640 --> 00:25:07.910\nAnd my port channel's dead, all right?\n\n509\n00:25:07.910 --> 00:25:12.040\nSo I can see my port channel status is SD,\nright?\n\n510\n00:25:12.040 --> 00:25:14.060\nSo S is it's Layer 2, and D is it's Down,\n\n511\n00:25:14.060 --> 00:25:16.010\nand all of my interfaces have a D,\nit's down.\n\n512\n00:25:16.010 --> 00:25:17.950\nThere's something wrong\nwith my port channel.\n\n513\n00:25:17.950 --> 00:25:18.760\nOkay?\n\n514\n00:25:18.760 --> 00:25:23.620\nWell, in the background what's going\nto happen is the other side is set for\n\n515\n00:25:23.620 --> 00:25:24.530\nether channel.\n\n516\n00:25:24.530 --> 00:25:25.540\nI'm not.\n\n517\n00:25:25.540 --> 00:25:30.540\nAnd so, since they're not working,\nthis link's effectively dead in the water.\n\n518\n00:25:30.540 --> 00:25:31.450\nIt's not functioning.\n\n519\n00:25:31.450 --> 00:25:33.690\nIf I was using LACP or PAgP,\n\n520\n00:25:33.690 --> 00:25:36.980\nit might have failed back to\na regular connection and been fine.\n\n521\n00:25:36.980 --> 00:25:40.220\nNow as it stands I do need to\nkinda figure out this problem or\n\n522\n00:25:40.220 --> 00:25:41.800\nwe're going to have a hard\ntime getting this set up.\n\n523\n00:25:41.800 --> 00:25:44.705\n[LAUGH] So I'm just going to do\na quick show IP interface brief.\n\n524\n00:25:44.705 --> 00:25:46.870\nI have a theory as to what's going on.\n\n525\n00:25:46.870 --> 00:25:53.390\nI did a no shutdown on my interface range\nbut I don't think it accepted my command.\n\n526\n00:25:54.950 --> 00:25:59.800\nWell no it's, they're showing is down,\ndown, and it's completely dead.\n\n527\n00:25:59.800 --> 00:26:05.470\nNow, I have seen this before\nwhere the interfaces for\n\n528\n00:26:05.470 --> 00:26:08.800\nwhatever reason flipped\ninto error disabled.\n\n529\n00:26:08.800 --> 00:26:09.300\nRight?\n\n530\n00:26:09.300 --> 00:26:13.040\nRemember how I said I like to shut\nthe ports off, make the changes and\n\n531\n00:26:13.040 --> 00:26:15.490\nthen turn them back on,\nbecause if you don't,\n\n532\n00:26:15.490 --> 00:26:18.420\nwhen you do a partial configuration,\nweird things can happen.\n\n533\n00:26:18.420 --> 00:26:20.190\nWell, that may have happened to me.\n\n534\n00:26:20.190 --> 00:26:23.340\nMy ports are showing down, down,\nnot administratively down,\n\n535\n00:26:23.340 --> 00:26:24.270\nI didn't shut them down.\n\n536\n00:26:24.270 --> 00:26:27.200\nIt's possible somebody,\nsomebody back there in the data center,\n\n537\n00:26:27.200 --> 00:26:29.870\nwent and unplugged these cables,\nto pull a prank on me during the show.\n\n538\n00:26:29.870 --> 00:26:34.820\nI don't think that happened, but you know,\nwe very well could be in error disabled.\n\n539\n00:26:34.820 --> 00:26:38.900\nBut if I do like a show interface status,\nand take a look at my interfaces,\n\n540\n00:26:38.900 --> 00:26:41.380\nwe can spot whether it's in that status or\n\n541\n00:26:41.380 --> 00:26:44.840\nnot and\nlooking down the line here at 23 and 24.\n\n542\n00:26:44.840 --> 00:26:48.500\nActually I've got a not connect message.\n\n543\n00:26:48.500 --> 00:26:50.394\n>> Someone unplugged your cables,\ndidn't they?\n\n544\n00:26:50.394 --> 00:26:50.894\n[LAUGH]\n>> Now.\n\n545\n00:26:50.894 --> 00:26:51.394\n>> [LAUGH]\n\n546\n00:26:51.394 --> 00:26:52.474\n>> That is pretty amazing,\n\n547\n00:26:52.474 --> 00:26:53.101\nisn't it?\nSo,\n\n548\n00:26:53.101 --> 00:26:57.440\n[LAUGH] you don't see that every day.\nI'm gonna double down here\n\n549\n00:26:57.440 --> 00:27:02.300\non the safety net here and just do\na quick shut down and no shut down.\n\n550\n00:27:02.300 --> 00:27:04.695\nJust to make sure it's not something\nquirky that's not showing up.\n\n551\n00:27:04.695 --> 00:27:07.410\nYeah, I'm not in an error disabled state,\nI thought that's what happened.\n\n552\n00:27:07.410 --> 00:27:10.020\nBut, that is one of the reasons why I\nencouraged you guys to shut the interfaces\n\n553\n00:27:10.020 --> 00:27:11.290\ndown while you work on them.\n\n554\n00:27:11.290 --> 00:27:14.640\nAnd so, if I shut those interfaces down,\nwell they're already down.\n\n555\n00:27:14.640 --> 00:27:16.210\nSo that's not exciting.\n\n556\n00:27:16.210 --> 00:27:19.230\nAnd then if I do a no shutdown.\n\n557\n00:27:19.230 --> 00:27:19.930\nThat'll reset it.\n\n558\n00:27:19.930 --> 00:27:22.040\nIf it was error disabled,\nthat would come out of it.\n\n559\n00:27:22.040 --> 00:27:24.100\nBut I don't think I was.\n\n560\n00:27:24.100 --> 00:27:26.270\nAnd sure enough, change state to down and\nthey're already down.\n\n561\n00:27:26.270 --> 00:27:29.045\nSo I have a physical network issue.\n\n562\n00:27:29.045 --> 00:27:30.760\n>> Mm-hm.\n>> So I need to go check on those cables\n\n563\n00:27:30.760 --> 00:27:35.070\nand find out what the heck happened\nthere And [LAUGH] get that sorted.\n\n564\n00:27:35.070 --> 00:27:39.320\nWhat I want to show you guys,\nis I want to show you guys PAgP and LACP.\n\n565\n00:27:39.320 --> 00:27:42.650\nAnd it's actually kind of an extension of\nthe commands that we've already done, but\n\n566\n00:27:42.650 --> 00:27:46.045\nI've gotta check these cables real quick\nand I know we're short on time anyway-\n\n567\n00:27:46.045 --> 00:27:47.145\n>> That's the perfect spot for\n\n568\n00:27:47.145 --> 00:27:48.945\nus to go ahead and end this signal.\n\n569\n00:27:48.945 --> 00:27:52.755\nWe'll do a part two and come back and\nshow the other protocols that we have for\n\n570\n00:27:52.755 --> 00:27:53.795\nthis lovely EtherChannel stuff.\n\n571\n00:27:53.795 --> 00:27:55.195\n>> Yeah, we've got PAgP, we've got LACP,\n\n572\n00:27:55.195 --> 00:27:58.010\nwe got a lot of other advanced\nfeatures with Ether Channel.\n\n573\n00:27:58.010 --> 00:28:01.430\nAnd then at the very end of the show,\nif we ever manage to get there,\n\n574\n00:28:01.430 --> 00:28:05.210\nI wanna show you guys how we can protect\nourselves from configuration errors.\n\n575\n00:28:05.210 --> 00:28:07.020\nAnd so that's an important step too,\n\n576\n00:28:07.020 --> 00:28:09.610\nall kinda leading to kind of what\nI'm experiencing right here.\n\n577\n00:28:09.610 --> 00:28:12.580\nBut, I got some physical cables to check,\nso I'm gonna dash out and do that,\n\n578\n00:28:12.580 --> 00:28:13.140\nbut yes.\n\n579\n00:28:13.140 --> 00:28:16.520\nStay tuned for part two and see\nthe exciting conclusion of Ether Channel.\n\n580\n00:28:16.520 --> 00:28:19.070\n>> That's right, so everyone,\nhopefully we will see you there.\n\n581\n00:28:19.070 --> 00:28:21.590\nAs for this episode, we're going to\ngo ahead and sign off for ITProTV.\n\n582\n00:28:21.590 --> 00:28:23.300\nI've been your host Daniel Lowery.\n\n583\n00:28:23.300 --> 00:28:24.140\n>> And I'm Don Pezet.\n\n584\n00:28:24.140 --> 00:28:27.480\n>> We'll see you next time.\n\n",
          "vimeoId": "141104338"
        },
        {
          "description": "In this episode, Don and Daniel continue to describe how to configure and verify Etherchannel in Cisco switches using LACP and PAgP. They also show you how to implement Etherchannel for Layer 3 as well as protecting from errors using the misconfiguration guard.",
          "length": "2024",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-5-ether_channel_pt2-093015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-5-ether_channel_pt2-093015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-5-ether_channel_pt2-093015-1-sm.jpg",
          "title": "Ether Channel Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.067 --> 00:00:10.067\n[MUSIC]\n\n2\n00:00:11.815 --> 00:00:16.420\nAll right, greetings everyone, and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.420 --> 00:00:17.040\nI'm your host,\n\n4\n00:00:17.040 --> 00:00:21.861\nDaniel Lowery here with me again today\nis insert adjective here, Don Pezet.\n\n5\n00:00:21.861 --> 00:00:23.157\n[LAUGH]\n>> [LAUGH] Boy,\n\n6\n00:00:23.157 --> 00:00:24.527\nwe can think of some adjectives.\n\n7\n00:00:24.527 --> 00:00:26.129\n>> Yeah, we can really go far.\n\n8\n00:00:26.129 --> 00:00:29.663\n>> All right, well ladies and gentlemen,\nthanks for having me back on the show and\n\n9\n00:00:29.663 --> 00:00:32.730\nexcited to jump back into to\npart two of EtherChannel.\n\n10\n00:00:32.730 --> 00:00:35.290\nFor those of you who are watching these in\nsequence, you know at the end of the last\n\n11\n00:00:35.290 --> 00:00:37.420\nepisode, I had a little bit of\na physical networking issue so\n\n12\n00:00:37.420 --> 00:00:39.560\nwe kind of resolved that and\nplugged some cables in.\n\n13\n00:00:39.560 --> 00:00:40.870\nVery exciting.\n\n14\n00:00:40.870 --> 00:00:44.370\nAnd so, what we had left off with,\nis we had EtherChannel up and running,\n\n15\n00:00:44.370 --> 00:00:45.860\nbut it was statically assigned.\n\n16\n00:00:45.860 --> 00:00:48.610\nIt was just straight up EtherChannel,\nraw EtherChannel.\n\n17\n00:00:48.610 --> 00:00:51.660\nAnd Daniel had asked about if\nthere was a way we could kind of\n\n18\n00:00:51.660 --> 00:00:54.210\ndynamically get that configured,\nwhere the switches talk to each other.\n\n19\n00:00:54.210 --> 00:00:57.680\nSo we make sure those configurations\nmatch between the two.\n\n20\n00:00:57.680 --> 00:01:02.280\nAnd the short answer is yes and the long\nanswer is yeah, we have a lot of choices.\n\n21\n00:01:02.280 --> 00:01:05.060\nWe've got LACP and PAgP, right.\n\n22\n00:01:05.060 --> 00:01:09.480\nLink Aggregation Control Protocol and\nPort Aggregation Protocol.\n\n23\n00:01:09.480 --> 00:01:13.290\nNow, I talked about the two protocols and\ntheir differences in the last episode, but\n\n24\n00:01:13.290 --> 00:01:15.290\njust to summarize that real quick.\n\n25\n00:01:15.290 --> 00:01:17.650\nPAgP is the older one,\nit's Cisco proprietary.\n\n26\n00:01:17.650 --> 00:01:22.240\nIt was made before LAGP existed and\nthen, LAGP is the new IEEE standard.\n\n27\n00:01:22.240 --> 00:01:29.030\nI say new, it came out 15 years ago,\n802.1AX that basically supersedes PAgP.\n\n28\n00:01:29.030 --> 00:01:31.590\nSo there's really not\na reason to run PAgP anymore.\n\n29\n00:01:31.590 --> 00:01:35.900\nWe're usually going to use LAGP, but\nyour switch most likely supports both.\n\n30\n00:01:35.900 --> 00:01:37.530\nSo it's up to you if you\nwanna choose them, right?\n\n31\n00:01:37.530 --> 00:01:39.410\nLet me show you how it works.\n\n32\n00:01:39.410 --> 00:01:40.330\nNow in the last episode,\n\n33\n00:01:40.330 --> 00:01:44.922\nI configured some EtherChannels and\nhere on my core switch if I do a show\n\n34\n00:01:44.922 --> 00:01:49.050\nEtherChannel summary that we can jump\nin here and we can take a look at it.\n\n35\n00:01:49.050 --> 00:01:52.640\nAnd I've got port channel four and\nit has a status of SU.\n\n36\n00:01:52.640 --> 00:01:56.610\nAnd if I look up here it's a layer two and\nit is in use, right?\n\n37\n00:01:56.610 --> 00:01:57.530\nIt's up.\n\n38\n00:01:57.530 --> 00:02:01.570\nAnd if I look at my ports,\nmy two ports each have a P status.\n\n39\n00:02:01.570 --> 00:02:04.740\nAnd if I look up here,\nP means bundled in the port channel.\n\n40\n00:02:04.740 --> 00:02:07.600\nSo that it means part of it and\nwe're good to go.\n\n41\n00:02:07.600 --> 00:02:10.080\nBut it's just using regular EtherChannel.\n\n42\n00:02:10.080 --> 00:02:14.430\nAnd I know that cuz the protocol\njust has a dash, just a hyphen and\n\n43\n00:02:14.430 --> 00:02:15.810\nthat's it, right.\n\n44\n00:02:15.810 --> 00:02:19.280\nIf I was using LACP or PAgP it would\nsay it right there, all right.\n\n45\n00:02:19.280 --> 00:02:24.910\nAnd if I wanna change that, what I need to\ndo is I need to jump into my configuration\n\n46\n00:02:24.910 --> 00:02:27.860\nand I need to modify the command\nI use to turn it on.\n\n47\n00:02:27.860 --> 00:02:33.320\nNow if I look at the configuration for\none of those interfaces, the command I\n\n48\n00:02:33.320 --> 00:02:39.020\nused on the last show was channel-group 4,\nor whatever number you wanna use, mode on.\n\n49\n00:02:40.470 --> 00:02:44.560\nAnd that mode on, that's what told\nit to just do raw EtherChannel and\n\n50\n00:02:44.560 --> 00:02:45.960\nturn it on no matter what.\n\n51\n00:02:45.960 --> 00:02:49.450\nAll right, but I could have done\nthat a little bit differently.\n\n52\n00:02:49.450 --> 00:02:52.580\nSo I'm gonna jump into the range\nof ports 23 through 24.\n\n53\n00:02:52.580 --> 00:02:57.510\nI'm gonna shut them down because with\nan EtherChannel, it's always a good\n\n54\n00:02:57.510 --> 00:03:01.040\nidea to shut the interfaces down\nwhile you start to manipulate it.\n\n55\n00:03:01.040 --> 00:03:03.100\nWhich does cause down time, right?\n\n56\n00:03:03.100 --> 00:03:05.940\nSo if I was just adding a port,\nthat's one thing, right?\n\n57\n00:03:05.940 --> 00:03:08.950\nI don't need to shut down for that but\nif I'm changing the configuration of\n\n58\n00:03:08.950 --> 00:03:11.320\nthe channel,\nit's a good idea to shut it down first.\n\n59\n00:03:11.320 --> 00:03:20.130\nI'm gonna shut it down and then I'm going\nto do channel-group 4, whoops, mode.\n\n60\n00:03:20.130 --> 00:03:22.550\nAnd instead of on,\nI'm gonna do a question mark.\n\n61\n00:03:22.550 --> 00:03:25.801\nAnd you'll see that there's\nfour other modes to pick from.\n\n62\n00:03:25.801 --> 00:03:29.051\nTwo are PAgP and two are LACP.\n\n63\n00:03:29.051 --> 00:03:32.670\nAll right, if you look at it,\nauto and desirable.\n\n64\n00:03:32.670 --> 00:03:35.439\nThese two guys right here,\nthese are the PAgP ones, okay?\n\n65\n00:03:35.439 --> 00:03:36.934\nAuto.\n\n66\n00:03:36.934 --> 00:03:43.053\nAuto says We'll build a PagP\nbundle if the other side asks us.\n\n67\n00:03:43.053 --> 00:03:45.095\nIf somebody asks us to do it, we'll do it.\n\n68\n00:03:45.095 --> 00:03:49.552\nBut otherwise we're just going to\nbe regular old access ports and\n\n69\n00:03:49.552 --> 00:03:53.846\nthen desirable that says we're\ngoing to try and turn on PagP And\n\n70\n00:03:53.846 --> 00:03:58.120\nhopefully the other side's\nhappy with that, okay.\n\n71\n00:03:58.120 --> 00:04:01.110\nIf the other side's happy with it,\nyou're running PAgP, you build a bundle.\n\n72\n00:04:01.110 --> 00:04:04.850\nIf the other side's not happy with it,\nyou drop back to access ports, or\n\n73\n00:04:04.850 --> 00:04:06.670\nto regular switchboards, right.\n\n74\n00:04:06.670 --> 00:04:08.930\nSo unbundled ports.\n\n75\n00:04:08.930 --> 00:04:12.063\nThat's the nice part, that's what we\ndon't have with raw EtherChannels,\n\n76\n00:04:12.063 --> 00:04:14.070\nI don't fail back to just regular ports.\n\n77\n00:04:14.070 --> 00:04:15.870\nMy ports just don't work, right.\n\n78\n00:04:15.870 --> 00:04:17.090\nHere we can fail back.\n\n79\n00:04:17.090 --> 00:04:19.380\nSo think of this like with trunking,\n\n80\n00:04:19.380 --> 00:04:23.150\nwith trunking we had where you could do\nthe dynamic auto and dynamic desirable.\n\n81\n00:04:23.150 --> 00:04:24.840\nSame thing here with PAgP.\n\n82\n00:04:24.840 --> 00:04:26.750\nIf I have two sides configured for\n\n83\n00:04:26.750 --> 00:04:30.090\nauto, they will not bundle\nbecause neither of them ask.\n\n84\n00:04:30.090 --> 00:04:32.810\nAuto just answers, auto responds, right?.\n\n85\n00:04:32.810 --> 00:04:34.840\nDesirable will actually ask.\n\n86\n00:04:34.840 --> 00:04:37.380\nSo at least one side\nneeds to be desirable.\n\n87\n00:04:37.380 --> 00:04:41.360\nBoth sides can be desirable, or one can be\ndesirable and the other can be auto, but\n\n88\n00:04:41.360 --> 00:04:43.620\nif they're both auto, you got a problem.\n\n89\n00:04:43.620 --> 00:04:46.080\nLACP is the same way, but\ndifferent terminology.\n\n90\n00:04:46.080 --> 00:04:49.845\nWith LACP, we have active and\npassive, all right?\n\n91\n00:04:49.845 --> 00:04:51.820\nActive, that means we're gonna ask.\n\n92\n00:04:51.820 --> 00:04:53.870\nWe're gonna try and\nturn on LACP, we're gonna do it.\n\n93\n00:04:53.870 --> 00:04:57.151\nAnd if the other side's happy with it,\ngreat, we'll form a bundle.\n\n94\n00:04:57.151 --> 00:05:01.191\nIf the other side's not happy,\nthen we drop down to access boards.\n\n95\n00:05:01.191 --> 00:05:04.897\nPassive says we'll build a bundle\nif somebody else asks us but\n\n96\n00:05:04.897 --> 00:05:06.330\nwe're not gonna ask.\n\n97\n00:05:06.330 --> 00:05:08.090\nWe're the shy side, right?\n\n98\n00:05:08.090 --> 00:05:09.970\nSo we're just gonna be regular ports.\n\n99\n00:05:09.970 --> 00:05:11.760\nAnd if somebody asks us,\nthen we'll bundle.\n\n100\n00:05:11.760 --> 00:05:13.490\nSame thing as PAgP, right?\n\n101\n00:05:13.490 --> 00:05:18.810\nSo I just need to pick which mode I want,\nand depending on what term I use\n\n102\n00:05:18.810 --> 00:05:21.619\nis gonna determine whether I go PAgP or\nLACP, right?\n\n103\n00:05:21.619 --> 00:05:22.500\nI wanna do LACP.\n\n104\n00:05:22.500 --> 00:05:23.890\nThat's the most common.\n\n105\n00:05:23.890 --> 00:05:27.925\nAnd so\nI'm gonna set this side to go passive.\n\n106\n00:05:27.925 --> 00:05:32.725\nI want it to only go active if\nthe other side asks, all right?\n\n107\n00:05:32.725 --> 00:05:35.175\nOtherwise, I'm just\ngonna be a regular port.\n\n108\n00:05:35.175 --> 00:05:36.658\nNow, if I press enter right there,\nI'm done.\n\n109\n00:05:36.658 --> 00:05:37.761\nI'm using LACP.\n\n110\n00:05:37.761 --> 00:05:42.128\nIf you do a question mark, there are some\nof these modes that have an additional\n\n111\n00:05:42.128 --> 00:05:46.178\noption, where we can pick between\nsilent and non-silent, all right?\n\n112\n00:05:46.178 --> 00:05:49.045\nSilent mode is normal behavior,\nthat's the default, all right?\n\n113\n00:05:49.045 --> 00:05:51.936\nAnd if I don't have an option here,\nthen I'm gonna be silent mode, so\n\n114\n00:05:51.936 --> 00:05:53.170\nI don't have an option here.\n\n115\n00:05:54.220 --> 00:05:57.400\nBut if I do have the option to\ndo something like non-silent,\n\n116\n00:05:57.400 --> 00:06:04.120\nwhat that means is when I come up,\neven if I'm in auto mode where I would\n\n117\n00:06:04.120 --> 00:06:10.590\nnormally only bond if somebody asked me,\nI'll try and come up the first time.\n\n118\n00:06:10.590 --> 00:06:15.790\nSo when this port first comes up, we'll\ntry that one time and if it doesn't work\n\n119\n00:06:15.790 --> 00:06:19.230\nthen we go back to just being regular\nports until someone else asks us.\n\n120\n00:06:19.230 --> 00:06:20.700\nWe never ask again.\n\n121\n00:06:20.700 --> 00:06:22.580\nSo if you set that non-silent mode.\n\n122\n00:06:22.580 --> 00:06:24.269\nWait, we'll see if I have it for\nany of these modes.\n\n123\n00:06:24.269 --> 00:06:27.868\nIf I go to auto, and there we go.\n\n124\n00:06:27.868 --> 00:06:30.144\nSo under auto I've got that\nnon-silent right there.\n\n125\n00:06:30.144 --> 00:06:34.352\nSo with PAgP, if I were to do it this way,\nauto normally would not ask but\n\n126\n00:06:34.352 --> 00:06:37.507\nnow the first time the port comes up,\nit will ask, but\n\n127\n00:06:37.507 --> 00:06:40.964\nthat's the only time it will\nask is when the port comes up.\n\n128\n00:06:40.964 --> 00:06:43.950\nSo that's a little addition that\nyou may or may not want to use.\n\n129\n00:06:43.950 --> 00:06:48.200\nI'm not gonna use it, I'm just gonna\ngo in passive mode and in passive mode\n\n130\n00:06:48.200 --> 00:06:52.760\nI'm gonna try to become a port channel and\nif the other side asks me,\n\n131\n00:06:52.760 --> 00:06:55.820\nI'll do it, but otherwise I'm\njust gonna be a regular port.\n\n132\n00:06:55.820 --> 00:06:58.470\nNow I gotta command rejected,\nwhat's that all about?\n\n133\n00:06:58.470 --> 00:07:01.200\nWell it's telling me that I gotta problem,\nthe interface couldn't be added to\n\n134\n00:07:01.200 --> 00:07:03.660\nthe channel group,\nthe range command was terminated.\n\n135\n00:07:03.660 --> 00:07:05.030\nThis is bad news, all right.\n\n136\n00:07:06.280 --> 00:07:09.640\nWhat that tells me is that my command\nmight have worked on one interface and\n\n137\n00:07:09.640 --> 00:07:10.600\nnot the other.\n\n138\n00:07:10.600 --> 00:07:13.080\nIt might have not worked\non either interface, and\n\n139\n00:07:13.080 --> 00:07:15.060\nnow it says it's terminated\nmy range command.\n\n140\n00:07:15.060 --> 00:07:16.410\nI'm still in the range prompt but\n\n141\n00:07:16.410 --> 00:07:18.910\nI don't really know what I'm\nworking with anymore, right.\n\n142\n00:07:18.910 --> 00:07:20.224\nWe always need to watch out for\nthese errors.\n\n143\n00:07:20.224 --> 00:07:23.894\nIf this ever happens to you, the best\nthing to do is to get out of the range,\n\n144\n00:07:23.894 --> 00:07:25.507\nand then get back into it again.\n\n145\n00:07:25.507 --> 00:07:30.120\nSo, that way you know exactly\nwhat port you're working with.\n\n146\n00:07:30.120 --> 00:07:32.780\nOne negative of the range command is\nyou can't get it to refresh for you and\n\n147\n00:07:32.780 --> 00:07:35.490\nshow you what port you're working with,\nyou just kinda have to guess.\n\n148\n00:07:35.490 --> 00:07:39.242\nAnd now I need to double check my\nconfiguration to see what happened and\n\n149\n00:07:39.242 --> 00:07:41.666\nsee which commands may\nhave gotten refused.\n\n150\n00:07:41.666 --> 00:07:46.948\nOkay, and if I look, fa1/0/23,\nit's just an access port.\n\n151\n00:07:46.948 --> 00:07:50.828\nIt doesn't have any\nchannel group assigned.\n\n152\n00:07:50.828 --> 00:07:53.310\n24 still has a channel group assigned,\nall right?\n\n153\n00:07:53.310 --> 00:07:59.399\nSo I'm gonna go in here and I'm just\ngonna issue a no channel group four.\n\n154\n00:07:59.399 --> 00:08:01.009\nMode on.\n\n155\n00:08:01.009 --> 00:08:02.801\nAnd so I'm gonna take it out of that and\n\n156\n00:08:02.801 --> 00:08:06.380\nI'm just gonna verify those\nconfigurations are the same, right?\n\n157\n00:08:06.380 --> 00:08:08.450\nWe need our configurations to\nbe the same otherwise you end up\n\n158\n00:08:08.450 --> 00:08:09.970\nwith a broken channel group.\n\n159\n00:08:09.970 --> 00:08:13.260\nAnd now I'll repeat my command for\nchannel group four.\n\n160\n00:08:13.260 --> 00:08:15.670\nMode passive,\nwhich is going to [INAUDIBLE].\n\n161\n00:08:15.670 --> 00:08:16.380\nNow it's happy.\n\n162\n00:08:16.380 --> 00:08:19.250\nSo we've got to keep\nthe configurations consistent.\n\n163\n00:08:20.840 --> 00:08:24.010\nAll right, now notice how it didn't\ncreate me a new port channel.\n\n164\n00:08:24.010 --> 00:08:25.700\nThe port channel is a port channel.\n\n165\n00:08:25.700 --> 00:08:26.750\nIt doesn't care if you use [INAUDIBLE],\n[INAUDIBLE], or [INAUDIBLE].\n\n166\n00:08:26.750 --> 00:08:29.280\nThe port channel is always the same.\n\n167\n00:08:29.280 --> 00:08:31.500\nSo it's just reusing port channel four.\n\n168\n00:08:31.500 --> 00:08:32.960\nNothing changes there.\n\n169\n00:08:32.960 --> 00:08:34.450\nI'm gonna issue a no shutdown command.\n\n170\n00:08:34.450 --> 00:08:35.960\nActually I'm gonna leave\nthis one shutdown.\n\n171\n00:08:35.960 --> 00:08:38.040\nI'm gonna leave it shutdown\ncuz the other side,\n\n172\n00:08:38.040 --> 00:08:40.090\nI guess it doesn't really\nnecessarily matter.\n\n173\n00:08:40.090 --> 00:08:41.810\nThe other side's running ether\nchannel right now right now.\n\n174\n00:08:41.810 --> 00:08:43.380\nIt's not running LACP or PAgP.\n\n175\n00:08:43.380 --> 00:08:44.790\nSo, we could get some weird errors.\n\n176\n00:08:44.790 --> 00:08:46.750\nI'm gonna leave it shutdown for\nnow, just to be on the safe side.\n\n177\n00:08:46.750 --> 00:08:47.280\nAll right?\n\n178\n00:08:47.280 --> 00:08:49.350\nAnd we'll come back and turn it back\non when I get the other side set up.\n\n179\n00:08:50.510 --> 00:08:53.960\nOn the other side, I'm just going to\nkind of repeat that same process, right?\n\n180\n00:08:53.960 --> 00:08:58.280\nSo I need to jump in here and\nI'll get into those interfaces.\n\n181\n00:08:59.520 --> 00:09:01.684\nI'll do the range [SOUND].\n\n182\n00:09:01.684 --> 00:09:05.584\nAnd since I' got that error last time,\nI'm gonna play this one safe and\n\n183\n00:09:05.584 --> 00:09:09.030\nI'm gonna remove them\nfrom their channel group.\n\n184\n00:09:09.030 --> 00:09:10.440\nSo I'll say no channel group.\n\n185\n00:09:10.440 --> 00:09:16.330\nOne, which I'll try and\nspell right, mode on.\n\n186\n00:09:16.330 --> 00:09:18.210\nSo I'm gonna take them out\nof that channel group.\n\n187\n00:09:18.210 --> 00:09:20.850\nAnd then I'll redo\nthe channel group one mode,\n\n188\n00:09:20.850 --> 00:09:24.070\nand instead of passive I'm\ngonna make this one active.\n\n189\n00:09:24.070 --> 00:09:25.850\nIf I make it passive also,\nthey're both passive.\n\n190\n00:09:25.850 --> 00:09:26.690\nNeither side is gonna ask.\n\n191\n00:09:26.690 --> 00:09:27.890\nThis isn't gonna work.\n\n192\n00:09:27.890 --> 00:09:31.565\nIf I go active,\nnow I'm gonna ask the other side.\n\n193\n00:09:31.565 --> 00:09:36.135\nThe other side of this passive, but\nI'll ask, and we should build our channel.\n\n194\n00:09:36.135 --> 00:09:38.765\n>> Now Don, one of our views here on the\nchat rooms wondering what would happen if\n\n195\n00:09:38.765 --> 00:09:41.265\nwe set both of them to active.\n\n196\n00:09:41.265 --> 00:09:41.895\n>> It's fine.\n\n197\n00:09:41.895 --> 00:09:43.865\nYeah, you can set both to active,\nthat's cool.\n\n198\n00:09:43.865 --> 00:09:45.420\nThey'll both ask.\n\n199\n00:09:45.420 --> 00:09:47.330\nAnd you'll probably get\nthe fastest response time for\n\n200\n00:09:47.330 --> 00:09:50.760\nbuilding up that tunnel, so it's perfectly\nsafe to set them both to active.\n\n201\n00:09:50.760 --> 00:09:52.120\nYeah, that's not a big deal.\n\n202\n00:09:53.130 --> 00:09:54.290\nActive active is fine.\n\n203\n00:09:54.290 --> 00:09:55.750\nActive passive is fine.\n\n204\n00:09:55.750 --> 00:09:57.140\nPassive active is fine.\n\n205\n00:09:57.140 --> 00:09:59.030\nIt's passive passive,\nthat's one you've gotta watch out for\n\n206\n00:09:59.030 --> 00:09:59.730\ncuz that one will never work.\n\n207\n00:10:00.800 --> 00:10:02.630\nAll right, so\nI'm gonna do another shutdown here.\n\n208\n00:10:02.630 --> 00:10:05.860\nNow the channel group is\ngonna be happy here, but\n\n209\n00:10:05.860 --> 00:10:08.880\nit's not actually working because\nthe other side of the link is down, right?\n\n210\n00:10:08.880 --> 00:10:12.560\nSo, I did a node shutdown but see how\nthose links didn't come back up for me.\n\n211\n00:10:12.560 --> 00:10:17.210\nAnd if I jump over to the other side, it's\nover here that I need to issue that quick.\n\n212\n00:10:17.210 --> 00:10:18.890\nNo shutdown.\n\n213\n00:10:18.890 --> 00:10:20.800\nAnd so this side will come up too.\n\n214\n00:10:20.800 --> 00:10:23.900\nAnd once they're both up,\neverything should be happy.\n\n215\n00:10:23.900 --> 00:10:26.020\nThere, my interfaces just went up.\n\n216\n00:10:26.020 --> 00:10:27.680\nAnd now we can go verify\nthat configuration.\n\n217\n00:10:27.680 --> 00:10:33.292\nI'm gonna do,\nshow ether channel [SOUND] summary.\n\n218\n00:10:33.292 --> 00:10:37.274\nAnd we should see,\nmy port channel four is SU.\n\n219\n00:10:37.274 --> 00:10:40.820\nRight?\nSo layer two and it is in use.\n\n220\n00:10:40.820 --> 00:10:47.000\nMy ports are p, so they're in the bundle,\nand my protocol is now LACP, right?\n\n221\n00:10:47.000 --> 00:10:49.690\nHard to remember for the exam,\ncuz I never said LACP in the commands.\n\n222\n00:10:49.690 --> 00:10:54.310\nYou have to remember that active and\npassive means LACP.\n\n223\n00:10:54.310 --> 00:10:56.650\nAnd then auto and desirable means PagP.\n\n224\n00:10:56.650 --> 00:10:58.250\nThat's our difference.\n\n225\n00:10:58.250 --> 00:11:00.740\nBut at this point,\nmy port channel is up and\n\n226\n00:11:00.740 --> 00:11:02.590\nI now have that link to the other side.\n\n227\n00:11:02.590 --> 00:11:05.150\nAnd if I do a show spanning-tree,\nremember,\n\n228\n00:11:05.150 --> 00:11:08.140\nthis is where we started episode\none with show spanning-tree.\n\n229\n00:11:08.140 --> 00:11:11.930\nThat port 23 and\n24 were shut down because of.\n\n230\n00:11:11.930 --> 00:11:13.360\nSorry.\n\n231\n00:11:13.360 --> 00:11:16.160\nOne of them was shut down because\nit was blocking the loop.\n\n232\n00:11:16.160 --> 00:11:20.490\nWell now I look, and port channel\nfour is designated forwarding.\n\n233\n00:11:20.490 --> 00:11:23.830\nIt doesn't even show 23 and 24,\ncuz it doesn't see them anymore,\n\n234\n00:11:23.830 --> 00:11:26.140\nit sees the bonded interface.\n\n235\n00:11:26.140 --> 00:11:28.790\nAnd, we're going to talk about how\n\n236\n00:11:28.790 --> 00:11:31.790\ncost is calculated when we get in\nto the spanning-tree episodes.\n\n237\n00:11:31.790 --> 00:11:33.280\nBut this one has a cost of 12,\n\n238\n00:11:33.280 --> 00:11:38.630\nwhich is a weird number because normally\na 100 megabit link has a cost of 19.\n\n239\n00:11:38.630 --> 00:11:41.020\nThis has a cost of 12.\n\n240\n00:11:41.020 --> 00:11:42.270\nWhat's that all about?\n\n241\n00:11:42.270 --> 00:11:46.480\nWell, its 200 megabits,\nthat's better than 100 megabit so\n\n242\n00:11:46.480 --> 00:11:50.980\ninstead of having a cost of 19\nthis one has a lower cost of 12.\n\n243\n00:11:50.980 --> 00:11:52.020\nAll right.\n\n244\n00:11:52.020 --> 00:11:55.738\nSo I can see that, it's happy here,\nwe're up and running.\n\n245\n00:11:55.738 --> 00:11:59.590\nSo, that's LACP and if I wanted to\nswitch to PAGP I could just go reissue\n\n246\n00:11:59.590 --> 00:12:06.110\nthe command to change it over to desirable\nor auto, and then it would switch to PAGP.\n\n247\n00:12:06.110 --> 00:12:08.180\nBut I'd see no functional\ndifference beyond that.\n\n248\n00:12:08.180 --> 00:12:08.920\n>> Awesome.\n\n249\n00:12:08.920 --> 00:12:10.710\nNow Don this is obviously very cool stuff.\n\n250\n00:12:10.710 --> 00:12:14.460\nWe would probably wanna implement this\nin our networks like you said before.\n\n251\n00:12:14.460 --> 00:12:16.320\nLet's optimize, get things working.\n\n252\n00:12:16.320 --> 00:12:17.080\nWhat else can we do?\n\n253\n00:12:17.080 --> 00:12:18.710\nIs there anything else we can do with it?\n\n254\n00:12:18.710 --> 00:12:20.250\n>> There's a ton [INAUDIBLE].\n>> Oh, but wait there's more.\n\n255\n00:12:20.250 --> 00:12:21.950\n>> And you know one thing I wanna mention,\n\n256\n00:12:21.950 --> 00:12:25.220\nI don't know if this will make\nit on the exam but it might.\n\n257\n00:12:25.220 --> 00:12:29.020\nYou can actually do either channel\non layer three ports also.\n\n258\n00:12:30.050 --> 00:12:32.540\nIf you got a switch that's\na layer three switch,\n\n259\n00:12:32.540 --> 00:12:36.180\nthen you may have taken some of your ports\nand converted them over routed ports.\n\n260\n00:12:36.180 --> 00:12:37.970\nRouted ports are ones we\nassign an IP address to.\n\n261\n00:12:37.970 --> 00:12:40.360\nYou don't sign an IP address to\na switch port normally, right.\n\n262\n00:12:40.360 --> 00:12:41.690\nIt's a layer two port.\n\n263\n00:12:41.690 --> 00:12:44.200\nBut you might have layer three ports and\nyou can do either channel on them, too.\n\n264\n00:12:44.200 --> 00:12:47.930\nAnd I know what you might be thinking,\nwhy would I do that, right.\n\n265\n00:12:47.930 --> 00:12:51.550\nWell you might have a physical router that\nyou're plugging into or a firewall or\n\n266\n00:12:51.550 --> 00:12:55.950\nsomething that supports ether channel\nalso and so you want a bonded link\n\n267\n00:12:55.950 --> 00:12:59.660\nbetween your switch and that device and\nyou want it to do ether channel.\n\n268\n00:12:59.660 --> 00:13:00.770\nYou can do it.\n\n269\n00:13:00.770 --> 00:13:03.820\nThere's just one thing,\none little difference we need to remember.\n\n270\n00:13:03.820 --> 00:13:05.160\nLet me show you an example.\n\n271\n00:13:05.160 --> 00:13:10.770\nOkay, so on here on core one, and let's\nsay that ports 14 and 15, we're going to\n\n272\n00:13:11.790 --> 00:13:17.558\nbe connected to another device,\nI wanted this layer three either channel.\n\n273\n00:13:17.558 --> 00:13:21.770\nSo if I have a routed port, what we do\nis we get into an interface like that.\n\n274\n00:13:21.770 --> 00:13:25.022\nSo if I get into 1/0/14.\n\n275\n00:13:25.022 --> 00:13:25.624\nRight?\n\n276\n00:13:25.624 --> 00:13:27.070\nThe way we convert a switch.\n\n277\n00:13:27.070 --> 00:13:29.950\nSwitchport to a routed port,\nis we just say, no switchport.\n\n278\n00:13:31.210 --> 00:13:34.260\nThat takes it out of\nthe layer two environment.\n\n279\n00:13:34.260 --> 00:13:37.120\nThis port is now a routed port.\n\n280\n00:13:37.120 --> 00:13:37.910\nOkay?\n\n281\n00:13:37.910 --> 00:13:41.730\nAnd from here, now that it's routed\nI can assign it an IP address and\n\n282\n00:13:41.730 --> 00:13:46.720\nso I can make it whatever IP it\nis that I want it to have, right.\n\n283\n00:13:46.720 --> 00:13:50.270\nNow you can only do this on layer\nthree capable switches which most\n\n284\n00:13:50.270 --> 00:13:54.210\nof the four digit cisco switches\nare layer three capable these days.\n\n285\n00:13:54.210 --> 00:13:56.480\nBut now I've got an IP\naddress on that interface.\n\n286\n00:13:56.480 --> 00:13:59.630\nAnd if I enable routing on this thing,\n\n287\n00:13:59.630 --> 00:14:04.000\nthen I'll actually be able to see that\nwhich I doubt I have enabled on here.\n\n288\n00:14:05.110 --> 00:14:09.335\nSo I don't actually have any routing and\nthis interface might actually be shutdown.\n\n289\n00:14:09.335 --> 00:14:12.130\n[LAUGH] There's nothing plugged in to\nthe interface so it's not gonna turn on.\n\n290\n00:14:12.130 --> 00:14:13.280\nIt's a dead interface.\n\n291\n00:14:13.280 --> 00:14:15.410\nBut, either way,\nI've got this routed interface.\n\n292\n00:14:15.410 --> 00:14:20.570\nSo if I take a look at my running\nconfig for that, we can look at it.\n\n293\n00:14:20.570 --> 00:14:23.900\nAnd unlike a switch port,\nit's got an IP address associated with it.\n\n294\n00:14:23.900 --> 00:14:25.770\nIt's now capable of doing routing.\n\n295\n00:14:25.770 --> 00:14:28.820\nWell, if I wanna add a second and\na third port, I can do that.\n\n296\n00:14:29.840 --> 00:14:33.160\nBut the difference is,\nwhen I go to configure this.\n\n297\n00:14:33.160 --> 00:14:36.590\nThe IP address needs to be\nattached to the port channel.\n\n298\n00:14:36.590 --> 00:14:41.440\nSo the switch can get a little bit\nweird on us sometimes when we do that.\n\n299\n00:14:41.440 --> 00:14:43.590\nSo let me show you what I mean.\n\n300\n00:14:43.590 --> 00:14:46.740\nIf I jump to interface FAone/zero/15 and\nI do\n\n301\n00:14:48.730 --> 00:14:54.860\na no switchport, right, and\nI try and assign it an IP address.\n\n302\n00:14:54.860 --> 00:14:58.580\nLike if I try to make it the same\nas the other one, what do I get?\n\n303\n00:14:58.580 --> 00:14:59.820\nI get the middle overlap.\n\n304\n00:14:59.820 --> 00:15:03.809\nEven if I try to make it different,\nlike .two.\n\n305\n00:15:03.809 --> 00:15:05.341\nIt's going to overlap,right?\n\n306\n00:15:05.341 --> 00:15:09.540\nI can't give this interface an ip\naddress in the same network, right?\n\n307\n00:15:09.540 --> 00:15:14.960\nBut if I put them into a channel group,\nso if I take 14 and\n\n308\n00:15:14.960 --> 00:15:19.750\n15 and I do channel group two,\n\n309\n00:15:21.010 --> 00:15:25.030\nmode on or here, maybe I'll go,\nlet's go desirable on this one.\n\n310\n00:15:26.890 --> 00:15:30.600\nAlright so I want to create a channel\ngroup and it's gonna be PAGP right?\n\n311\n00:15:30.600 --> 00:15:32.350\nSo I'm gonna put those\nguys in a channel group.\n\n312\n00:15:32.350 --> 00:15:36.400\nWhen it does it, it creates it and\nmoves those interfaces to it.\n\n313\n00:15:36.400 --> 00:15:37.650\nWhat happens to my IP address, right?\n\n314\n00:15:38.710 --> 00:15:40.110\nThis is the tricky part.\n\n315\n00:15:40.110 --> 00:15:48.841\nIf you take a look at your interfaces, if\nI look at port 14, my IP address is gone.\n\n316\n00:15:48.841 --> 00:15:50.940\nAnd if I look at port 15,\nthere's no IP address there either.\n\n317\n00:15:50.940 --> 00:15:55.089\nAnd if I take a look at the port\nchannel that I made, POtwo,\n\n318\n00:15:55.089 --> 00:15:57.739\nthe IP address isn't there either.\n\n319\n00:15:57.739 --> 00:15:59.930\nIt deletes the IP address.\n\n320\n00:15:59.930 --> 00:16:04.972\nSo thing to remember in real life land,\nif you ever configure a layer 3 port\n\n321\n00:16:04.972 --> 00:16:10.810\nchannel or a layer 3 EtherChannel,\nthe IPs get deleted when you turn it on.\n\n322\n00:16:10.810 --> 00:16:16.041\nSo write down your IP, turn it on and\nthen attach the IP to the port channel.\n\n323\n00:16:16.041 --> 00:16:17.330\nThat's where it needs to be anyway.\n\n324\n00:16:17.330 --> 00:16:20.530\nSo I need to get into\ninterface port channel 2.\n\n325\n00:16:20.530 --> 00:16:26.510\nAnd add IP address 192.168.0.1 and\nI'll add it right to that port channel.\n\n326\n00:16:26.510 --> 00:16:29.570\nThat's where it needs to be,\ncuz the IP address is now being spread\n\n327\n00:16:29.570 --> 00:16:33.565\nacross those links as opposed to\nbeing attached to a physical link.\n\n328\n00:16:33.565 --> 00:16:38.065\nSo a little difference there as far\nas how we handle layer 2 and layer 3.\n\n329\n00:16:39.375 --> 00:16:43.605\nSo that's one example of something\nwe might do on the layer 3 side.\n\n330\n00:16:43.605 --> 00:16:48.077\nThere's other stuff that we might do on\nthe layer 2 side also like we configure\n\n331\n00:16:48.077 --> 00:16:51.896\nthis interface here and\nthese are really still just access ports.\n\n332\n00:16:51.896 --> 00:16:56.357\nIf I do a show vlan brief and\ntake a look at my VLANs,\n\n333\n00:16:56.357 --> 00:17:00.411\nthe port channel that we made,\nI can spot it.\n\n334\n00:17:00.411 --> 00:17:05.274\nI guess my head's on top of that, but\nyou can spot that port channel right here,\n\n335\n00:17:05.274 --> 00:17:06.593\nand it's in VLAN 1.\n\n336\n00:17:06.593 --> 00:17:10.660\nWhat about VLAN 5 or\nany other VLANs that I might have made?\n\n337\n00:17:10.660 --> 00:17:12.630\nWell, the port channel's\nnot a part of those.\n\n338\n00:17:12.630 --> 00:17:15.670\nSo it's really just acting\nlike a regular switch port.\n\n339\n00:17:15.670 --> 00:17:17.090\nWell, it doesn't have to.\n\n340\n00:17:17.090 --> 00:17:18.710\nWe could do other stuff with it.\n\n341\n00:17:18.710 --> 00:17:21.260\n>> Yeah, Don, I'm thinking trunks here.\n\n342\n00:17:21.260 --> 00:17:21.920\n>> Absolutely,\n\n343\n00:17:21.920 --> 00:17:26.280\nyeah, there's no reason we have to limit\nourselves to one VLAN, or regular port.\n\n344\n00:17:26.280 --> 00:17:27.880\nWe can set these guys up as a trunk.\n\n345\n00:17:27.880 --> 00:17:31.140\nThe key thing to remember is we have two\ndifferent sets of configurations now.\n\n346\n00:17:31.140 --> 00:17:35.070\nYou got the port channel configuration and\nyou've got the interfaced configurations.\n\n347\n00:17:35.070 --> 00:17:35.720\nAnd for\n\n348\n00:17:35.720 --> 00:17:39.330\nthe most part, we want our configurations\nto happen in the port channel.\n\n349\n00:17:40.900 --> 00:17:43.410\nShutdown and no shutdown,\nthose are interface things.\n\n350\n00:17:43.410 --> 00:17:45.080\nYou wanna do those on\nthe physical interface.\n\n351\n00:17:45.080 --> 00:17:48.610\nBut as far as the things like trunk or\n\n352\n00:17:48.610 --> 00:17:50.990\nwhatever, those we wanna\ndo on the port channel.\n\n353\n00:17:50.990 --> 00:17:55.774\nSo if I wanna take the port channel we\nmade earlier, which I've already forgotten\n\n354\n00:17:55.774 --> 00:17:59.115\nthe number of, so\nlet me do a show EtherChannel summary.\n\n355\n00:17:59.115 --> 00:18:00.380\nAnd what did we make here?\n\n356\n00:18:00.380 --> 00:18:01.450\nChannel group four.\n\n357\n00:18:01.450 --> 00:18:05.880\nSo if I get into po4, so\nI'm in port channel 4.\n\n358\n00:18:05.880 --> 00:18:09.078\nI can come in here and I can say,\n\n359\n00:18:09.078 --> 00:18:15.210\nswitchport trunk encap dot1q\nswitchport mode trunk.\n\n360\n00:18:15.210 --> 00:18:18.600\nSo I've now configured the port\nchannel to be a trunk.\n\n361\n00:18:18.600 --> 00:18:20.030\nAnd what just happened?\n\n362\n00:18:20.030 --> 00:18:21.630\nMy interfaces went down.\n\n363\n00:18:21.630 --> 00:18:23.740\nIt's renegotiating,\nbringing these things up.\n\n364\n00:18:23.740 --> 00:18:27.390\nDynamic trunking is kicking in and kinda\ndoing it's thing and figuring stuff out.\n\n365\n00:18:27.390 --> 00:18:30.060\nI kinda need to get the other side\nset up because I can guarantee that\n\n366\n00:18:30.060 --> 00:18:30.980\ntrunk is failing.\n\n367\n00:18:30.980 --> 00:18:34.610\nSo let me jump over to the other side and\n\n368\n00:18:34.610 --> 00:18:37.520\non this one,\nI need to basically do that same stuff.\n\n369\n00:18:37.520 --> 00:18:39.480\nRight?\nSo I need to get into\n\n370\n00:18:39.480 --> 00:18:40.930\nwhatever the port channel is on this one.\n\n371\n00:18:40.930 --> 00:18:46.525\nAnd I'm really bad about\nforgetting what the numbers are.\n\n372\n00:18:46.525 --> 00:18:50.809\nSo this show EtherChannel summary command\nis kind of one that you get used to\n\n373\n00:18:50.809 --> 00:18:51.855\nrunning.\n\n374\n00:18:51.855 --> 00:18:53.025\nAnd so, this one's port channel one.\n\n375\n00:18:54.175 --> 00:18:56.015\nSo I'll get into that interface, I'll say,\n\n376\n00:18:56.015 --> 00:19:01.295\nswitchport trunk encap dot1q and\nswitchport mode trunk.\n\n377\n00:19:01.295 --> 00:19:01.815\nWhoops.\n\n378\n00:19:01.815 --> 00:19:03.365\nOr turnk.\n\n379\n00:19:03.365 --> 00:19:04.325\n>> Your favorite new technology.\n\n380\n00:19:04.325 --> 00:19:05.219\n>> I know, it's great.\n\n381\n00:19:05.219 --> 00:19:07.283\n>> [LAUGH]\n>> So there I am, in switchboard trunk,\n\n382\n00:19:07.283 --> 00:19:10.330\nand the interfaces go down, they come\nback up right, they're renegotiating.\n\n383\n00:19:10.330 --> 00:19:13.130\nI could have shut the port channel\ndown while I put those commands in.\n\n384\n00:19:13.130 --> 00:19:15.530\nBut since it was one command, and\nI knew they were gonna reset anyway,\n\n385\n00:19:15.530 --> 00:19:16.710\nI didn't worry about it.\n\n386\n00:19:16.710 --> 00:19:18.010\nBut it's gonna renegotiate.\n\n387\n00:19:18.010 --> 00:19:22.800\nAnd when it's done,\nif I take a look at my configuration,\n\n388\n00:19:23.990 --> 00:19:31.630\nand I look at ports 23 and 24, I issued\nthe trunk command on the port channel.\n\n389\n00:19:31.630 --> 00:19:35.100\nBut here's the trunk command right\non the individual interfaces.\n\n390\n00:19:35.100 --> 00:19:36.650\nIt took care of that for me.\n\n391\n00:19:36.650 --> 00:19:38.437\nSo I don't need to worry about\nthose interface range anymore.\n\n392\n00:19:38.437 --> 00:19:41.612\nI just go right into the port channel and\nI put the changes there and\n\n393\n00:19:41.612 --> 00:19:42.830\nthey pass down.\n\n394\n00:19:42.830 --> 00:19:43.840\nThe interface is underneath.\n\n395\n00:19:43.840 --> 00:19:46.530\nThat's why it's so important that each of\nour interfaces is configured the same way\n\n396\n00:19:46.530 --> 00:19:48.110\nbefore we get started.\n\n397\n00:19:48.110 --> 00:19:50.840\nSo that it can then keep these things\nupdated and synchronized for me.\n\n398\n00:19:50.840 --> 00:19:54.120\nBut now if I do a show interface trunk,\nand\n\n399\n00:19:54.120 --> 00:19:58.451\nI take look at it, I don't see ports\n23 and 24, I see port channel 1.\n\n400\n00:19:58.451 --> 00:20:01.280\nPort channel 1 has trunking on and\ntrunking for\n\n401\n00:20:01.280 --> 00:20:06.175\n802.1q is carrying all my VLANs,\nand it's up and happy.\n\n402\n00:20:06.175 --> 00:20:10.459\nSo now I not only have this\nbonded link between the two,\n\n403\n00:20:10.459 --> 00:20:12.704\nI've also got a good trunk.\n\n404\n00:20:12.704 --> 00:20:14.785\nAnd I only have two VLANS.\n\n405\n00:20:14.785 --> 00:20:16.230\nVLAN one and five.\n\n406\n00:20:16.230 --> 00:20:20.600\nWhat I could of done,\nwhen I set all this up back in the day,\n\n407\n00:20:20.600 --> 00:20:24.890\nis I could of said, I'll make port\n23 VLAN 1 and port 24 VLAN 5,\n\n408\n00:20:24.890 --> 00:20:26.910\nthey each have their\nown 100 meg connection.\n\n409\n00:20:28.250 --> 00:20:31.970\nBut each one is limited to just 100 meg,\n\n410\n00:20:31.970 --> 00:20:34.750\nso VLAN 1 just gets 100 meg of bandwidth,\nVLAN 5 gets that.\n\n411\n00:20:34.750 --> 00:20:38.510\nAnd if one links fails, whatever VLAN\nthat was is now dead in the water.\n\n412\n00:20:38.510 --> 00:20:41.672\nBy bonding them, they share bandwidth, but\n\n413\n00:20:41.672 --> 00:20:46.392\nif VLAN 1 needs to spike\nup to 200 megs it can.\n\n414\n00:20:46.392 --> 00:20:49.600\nIf VLAN five needs to spike it can, as\nlong as they don't spike at the same time.\n\n415\n00:20:49.600 --> 00:20:51.810\nThen if one link goes\ndown both VLAN one and\n\n416\n00:20:51.810 --> 00:20:54.100\nfive share the same table across the link.\n\n417\n00:20:54.100 --> 00:20:55.590\nI've now got a self-healing network.\n\n418\n00:20:55.590 --> 00:20:57.452\nThis is a really kinda great solution.\n\n419\n00:20:57.452 --> 00:21:03.010\nAnd Daniel, you asked during the break\nif we have two links like this,\n\n420\n00:21:03.010 --> 00:21:04.830\nwhy wouldn't we use EtherChannel?\n\n421\n00:21:04.830 --> 00:21:06.340\nAnd the honest answer.\n\n422\n00:21:06.340 --> 00:21:07.630\nI can't think of a reason\nwhy you wouldn't.\n\n423\n00:21:07.630 --> 00:21:10.530\nLike you would use this any time you\nhave two links between switches.\n\n424\n00:21:11.730 --> 00:21:16.410\nWhere EtherChannel doesn't work is if you\ngot more than two switches in the mix.\n\n425\n00:21:16.410 --> 00:21:21.840\nFor example, if you look at my topology,\nCore1 has a connection to Access1.\n\n426\n00:21:21.840 --> 00:21:25.850\nIt's also got a connection\nindirectly through Core2 in Access1.\n\n427\n00:21:25.850 --> 00:21:28.730\nBut I can't use\nEtherChannel to bond those.\n\n428\n00:21:28.730 --> 00:21:30.730\nThere actually is a way\nto make it work but\n\n429\n00:21:30.730 --> 00:21:32.760\nyou wouldn't want that because\nthese links are different.\n\n430\n00:21:32.760 --> 00:21:33.970\nDifferent bandwidths.\n\n431\n00:21:33.970 --> 00:21:38.030\nAnd remember what I said way back in\nthe beginning, you want them to be equal.\n\n432\n00:21:38.030 --> 00:21:41.820\nThese might be 100 megs here and\n100 megs here, but it's 2 links that\n\n433\n00:21:41.820 --> 00:21:45.010\nyou're competing with versus 1 link here,\nso it's not a ideal situation.\n\n434\n00:21:45.010 --> 00:21:50.896\nSo really, anytime you have more\nthan one link between two switches,\n\n435\n00:21:50.896 --> 00:21:53.502\nyou want to use EtherChannel.\n\n436\n00:21:53.502 --> 00:21:55.990\nLet's see, what else do we have\nin our bag of tricks today?\n\n437\n00:21:55.990 --> 00:22:00.260\n>> Well, Don, I was thinking about your,\nthe whole fact that it has the multiple\n\n438\n00:22:00.260 --> 00:22:04.210\nlinks so I have data going across all\nthose, how does it split the links?\n\n439\n00:22:04.210 --> 00:22:05.382\nHow does it know what to do?\n\n440\n00:22:05.382 --> 00:22:06.570\nHow much data goes on this one?\n\n441\n00:22:06.570 --> 00:22:07.940\nHow much data goes on that one?\n\n442\n00:22:07.940 --> 00:22:10.330\nAnd make that decision,\nwhat is it doing there?\n\n443\n00:22:10.330 --> 00:22:11.542\n>> I'm glad you asked.\n\n444\n00:22:11.542 --> 00:22:12.560\n>> [LAUGH]\n>> Cuz I was running out of\n\n445\n00:22:12.560 --> 00:22:13.108\nstuff to talk about.\n\n446\n00:22:13.108 --> 00:22:15.065\n>> [LAUGH].\n>> [LAUGH] So way back in part one,\n\n447\n00:22:15.065 --> 00:22:19.656\nI mentioned that when we do EtherChannel\nit bonds the links together, and\n\n448\n00:22:19.656 --> 00:22:20.900\nit load balances.\n\n449\n00:22:20.900 --> 00:22:22.651\nIt distributes your traffic\nacross the two or eight.\n\n450\n00:22:22.651 --> 00:22:27.394\nSo if I have eight gig links, and\nI bond them into one port channel,\n\n451\n00:22:27.394 --> 00:22:30.440\nI have an eight gigabit connection.\n\n452\n00:22:30.440 --> 00:22:33.850\nAnd my traffic is being balanced\nacross those eight lines.\n\n453\n00:22:33.850 --> 00:22:35.170\nHow does it do that?\n\n454\n00:22:35.170 --> 00:22:37.120\nWhat's making that happen\nin the background?\n\n455\n00:22:37.120 --> 00:22:41.940\nWell, the short answer is Cisco Express\nForwarding, but that doesn't help us.\n\n456\n00:22:41.940 --> 00:22:45.570\nThe reality is there's different\nways that each switch can do it.\n\n457\n00:22:45.570 --> 00:22:47.740\nAnd depending on what switch you're\nusing it might be different than\n\n458\n00:22:47.740 --> 00:22:48.680\nthe switch I'm using.\n\n459\n00:22:48.680 --> 00:22:50.850\nSo let me show you how to figure it out.\n\n460\n00:22:50.850 --> 00:22:53.710\nBasically, if you're wondering\nhow it load balances,\n\n461\n00:22:53.710 --> 00:22:57.230\nyou can drop to one of your switches\nthat has an EtherChannel configured, and\n\n462\n00:22:57.230 --> 00:23:04.830\nthe command to run is show etherchannel,\nand then load-balance.\n\n463\n00:23:04.830 --> 00:23:06.890\nSo earlier I was doing\nshow EtherChannel summary,\n\n464\n00:23:06.890 --> 00:23:09.090\nnow I'm doing show either\nchannel load-balance.\n\n465\n00:23:09.090 --> 00:23:12.550\nAnd when you run that,\nit'll tell you how it's load balancing.\n\n466\n00:23:12.550 --> 00:23:14.360\nAnd so, it's telling me right here,\n\n467\n00:23:14.360 --> 00:23:19.290\nthat EtherChannel Load-Balancing is\ncurrently set to use source MAC address.\n\n468\n00:23:19.290 --> 00:23:24.970\nSo when traffic hits the EtherChannel,\nit looks at the Source MAC address.\n\n469\n00:23:24.970 --> 00:23:27.210\nThe MAC address where\nthis data is coming from.\n\n470\n00:23:27.210 --> 00:23:31.580\nAnd so, it might see the Source MAC of\nDaniel's laptop and put him on line one.\n\n471\n00:23:31.580 --> 00:23:34.964\nAnd it sees the Source MAC address from\nmy laptop and puts me on line two.\n\n472\n00:23:34.964 --> 00:23:37.564\nAnd then, somebody else's\nlaptop puts them on line three.\n\n473\n00:23:37.564 --> 00:23:39.290\nAnd you got eight lines.\n\n474\n00:23:39.290 --> 00:23:41.230\nAnd so, when it gets to the eight line,\nthe ninth person,\n\n475\n00:23:41.230 --> 00:23:43.530\nit just puts back on the first line again.\n\n476\n00:23:43.530 --> 00:23:45.798\nNow, that's good and bad.\n\n477\n00:23:45.798 --> 00:23:47.306\nThe good side is it's super easy.\n\n478\n00:23:47.306 --> 00:23:49.359\nThe switch can do it\nwith very little logic,\n\n479\n00:23:49.359 --> 00:23:52.427\ncuz it already looks at the MAC addresses,\nso there's no delay.\n\n480\n00:23:52.427 --> 00:23:57.232\nOn a bad side, it means that\none person can never get more\n\n481\n00:23:57.232 --> 00:24:01.960\nbandwidth than what a single\nline in EtherChannel is.\n\n482\n00:24:01.960 --> 00:24:04.564\nSo I might have eight gig links but\n\n483\n00:24:04.564 --> 00:24:09.400\nmy laptop is only gonna be able\nto get one gig going through it.\n\n484\n00:24:09.400 --> 00:24:11.930\nOther people will get the other lines,\nI'm being tied to one.\n\n485\n00:24:11.930 --> 00:24:13.950\nMy source MAC address is\nbeing tied to one link.\n\n486\n00:24:13.950 --> 00:24:14.580\nUnless that link fails.\n\n487\n00:24:15.730 --> 00:24:19.020\nBut on a good side it means that one\nperson can't monopolize the whole channel\n\n488\n00:24:19.020 --> 00:24:20.590\nand everybody else gets\nthe other bandwidth.\n\n489\n00:24:20.590 --> 00:24:23.040\nSo that's an interesting way for\nthat to behave.\n\n490\n00:24:23.040 --> 00:24:26.070\nNow, different switches\nhave different defaults and\n\n491\n00:24:26.070 --> 00:24:28.280\nI've seen some that have\nslightly different defaults.\n\n492\n00:24:28.280 --> 00:24:30.850\nAnd there's other modes we can switch to.\n\n493\n00:24:30.850 --> 00:24:34.500\nMost switches will support at least 4\nmodes, if you get to like the 6,500,\n\n494\n00:24:34.500 --> 00:24:37.060\nthe really big switches,\nthey've got something like 8\n\n495\n00:24:37.060 --> 00:24:40.340\ndifferent modes you can go to,\nsome that are really advanced.\n\n496\n00:24:40.340 --> 00:24:43.260\nSome that actually do create\na bit of a processor hit.\n\n497\n00:24:43.260 --> 00:24:45.240\nIf you don't have the right\nhardware to support it.\n\n498\n00:24:45.240 --> 00:24:48.004\nAnd that's why some of the lower end\nswitches only have four to pick from,\n\n499\n00:24:48.004 --> 00:24:49.936\ncuz they just can't handle\nsome of the other ones.\n\n500\n00:24:49.936 --> 00:24:51.870\nLet me show you how to change it.\n\n501\n00:24:51.870 --> 00:24:55.180\nSo the way we change it is,\nyou jump in your configuration,\n\n502\n00:24:55.180 --> 00:24:56.950\nand it's a global command.\n\n503\n00:24:56.950 --> 00:24:58.550\nIt changes for all your port channels.\n\n504\n00:24:58.550 --> 00:25:00.750\nYou can't change it for\njust one port channel or another.\n\n505\n00:25:00.750 --> 00:25:03.290\nSo you jump in your config and\n\n506\n00:25:03.290 --> 00:25:08.590\nyou do port-channel load-balance, and then\n\n507\n00:25:08.590 --> 00:25:11.550\nit's always a good idea to do a question\nmark here to see what's supported.\n\n508\n00:25:11.550 --> 00:25:13.780\nYou do a question mark and\nit'll show you the modes.\n\n509\n00:25:13.780 --> 00:25:14.680\nI've only got six here.\n\n510\n00:25:15.780 --> 00:25:19.440\nNow, I know for a fact there's at least\neight different ones that Cisco supports.\n\n511\n00:25:19.440 --> 00:25:21.710\nMy switch doesn't support all of them.\n\n512\n00:25:21.710 --> 00:25:23.915\nThis is a, actually what is this.\n\n513\n00:25:23.915 --> 00:25:25.203\nThis is a 3750, I think.\n\n514\n00:25:25.203 --> 00:25:27.120\nSo [LAUGH] I should know that.\n\n515\n00:25:27.120 --> 00:25:28.000\n>> What am I working with here?\n\n516\n00:25:28.000 --> 00:25:28.720\n>> I know. [LAUGH] >> [LAUGH].\n\n517\n00:25:28.720 --> 00:25:30.750\n>> So\nlet me take a look at what this switch is.\n\n518\n00:25:30.750 --> 00:25:32.520\nI'm pretty sure, yeah, it's a 3750.\n\n519\n00:25:32.520 --> 00:25:36.790\nAnd I've got IP services, so\nI've got the full feature set on this one.\n\n520\n00:25:36.790 --> 00:25:42.040\nAnd it by all means should support\na number of different ones.\n\n521\n00:25:42.040 --> 00:25:44.280\nAnd I see six,\nwhich is more than a lot of switches.\n\n522\n00:25:44.280 --> 00:25:46.960\nYour 2960s, they usually only have 4.\n\n523\n00:25:46.960 --> 00:25:50.025\nYour higher end switches\nare gonna have other ones.\n\n524\n00:25:50.025 --> 00:25:52.796\nBut for me,\nI do port-channel load-balance,\n\n525\n00:25:52.796 --> 00:25:55.980\nand a question mark,\nand here's my choices.\n\n526\n00:25:55.980 --> 00:26:01.140\nI've got source MAC address, I can also do\ndestination MAC address, but that means\n\n527\n00:26:01.140 --> 00:26:04.390\ngoing that destination, the destination\nwould always be tied to that one gig max.\n\n528\n00:26:05.540 --> 00:26:10.420\nI can also do source and\ndestination MAC address.\n\n529\n00:26:10.420 --> 00:26:11.180\nNow, that's different.\n\n530\n00:26:12.720 --> 00:26:17.076\nNow, when I talk to any one host,\nyes I'm gonna be held to one link.\n\n531\n00:26:17.076 --> 00:26:21.335\nBut if I start talking to a second host at\nthe same time, I can jump to another link.\n\n532\n00:26:21.335 --> 00:26:26.425\nNow, one laptop could potentially use all\neight gigs of bandwidth on that eight\n\n533\n00:26:26.425 --> 00:26:28.705\ngig link that I've created.\n\n534\n00:26:28.705 --> 00:26:31.685\nSo that gives me more flexibility and it's\nstill just looking at MAC addresses that\n\n535\n00:26:31.685 --> 00:26:34.522\nyour switch is already\ngonna be looking at anyway.\n\n536\n00:26:34.522 --> 00:26:36.082\nSo that might be a good switch for me.\n\n537\n00:26:37.212 --> 00:26:39.232\nYou can even go more advanced.\n\n538\n00:26:39.232 --> 00:26:42.744\nSource IP Address and\nDestination IP Address and\n\n539\n00:26:42.744 --> 00:26:45.747\nboth Source and Destination IP Address.\n\n540\n00:26:45.747 --> 00:26:47.722\nNow, that's more advanced.\n\n541\n00:26:47.722 --> 00:26:50.622\nIf you're a Layer 2 switch,\nare you looking at IPs?\n\n542\n00:26:50.622 --> 00:26:51.702\nNot normally.\n\n543\n00:26:51.702 --> 00:26:55.560\nSo if I'm a Layer 3 switch,\nI am looking at it, it's not a big deal.\n\n544\n00:26:55.560 --> 00:26:57.930\nIf I'm not a Layer 3 switch,\nI'm not looking at that.\n\n545\n00:26:57.930 --> 00:26:59.620\nThis is gonna create a processor burden.\n\n546\n00:26:59.620 --> 00:27:00.860\nSo I probably don't wanna\ngo with one of those.\n\n547\n00:27:02.510 --> 00:27:05.180\nOn other switches,\nyou might see even other options.\n\n548\n00:27:05.180 --> 00:27:08.740\nYou might see things like source and\ndestination port.\n\n549\n00:27:08.740 --> 00:27:10.660\nThat's when you have some real fun.\n\n550\n00:27:10.660 --> 00:27:14.621\nIf you do source port I might have five\nconnections to the same server but\n\n551\n00:27:14.621 --> 00:27:16.746\nthey're on different port numbers.\n\n552\n00:27:16.746 --> 00:27:20.655\nIf I open up five webpages and\nI point them all at ITPro.TV, I'm actually\n\n553\n00:27:20.655 --> 00:27:25.620\ngonna be using five different ports, it's\ngotta tell my tabs apart from each other.\n\n554\n00:27:25.620 --> 00:27:28.520\nAnd so, I could be getting a gig\non each one of those tabs,\n\n555\n00:27:28.520 --> 00:27:30.110\nyou really optimize things.\n\n556\n00:27:30.110 --> 00:27:31.560\nBut now I got to look at port number.\n\n557\n00:27:31.560 --> 00:27:35.150\nThat's like layer four, layer five in the\nOSI model, we're starting to get up there.\n\n558\n00:27:35.150 --> 00:27:40.800\nMy switch doesn't normally look at that\nand that's where if you got a 6500 with\n\n559\n00:27:40.800 --> 00:27:45.260\nthe filtering module or VPM modules and\nstuff that are in there and it's actually\n\n560\n00:27:45.260 --> 00:27:48.410\nlooking at that higher data already,\nyou can get some real performance.\n\n561\n00:27:48.410 --> 00:27:51.850\nIf you're on a 3750 like me, that's not\nsomething we're normally looking at.\n\n562\n00:27:51.850 --> 00:27:55.850\nIt's the equivalent of creating an ACL and\nyou access control is where we're starting\n\n563\n00:27:55.850 --> 00:27:57.940\nto look at port numbers and\nthe switch has to interpret that, so\n\n564\n00:27:57.940 --> 00:28:00.350\nit's the same type of performance\nhit as we'd see on an ACL.\n\n565\n00:28:01.620 --> 00:28:03.090\nBut we can come in and change it.\n\n566\n00:28:03.090 --> 00:28:07.381\nNow, it's a good idea to change it on both\nends of the link so they're the same,\n\n567\n00:28:07.381 --> 00:28:08.679\nbut you don't have to.\n\n568\n00:28:08.679 --> 00:28:10.167\nThey don't have to match, but\n\n569\n00:28:10.167 --> 00:28:14.580\nyou generally don't want the two\nsides load balancing different ways.\n\n570\n00:28:14.580 --> 00:28:18.120\nSo normally we configure it\nthe same on both ends of the link.\n\n571\n00:28:18.120 --> 00:28:19.800\nBut it will let you do differently.\n\n572\n00:28:19.800 --> 00:28:21.160\nAnd so, you just come in here and\nyou specify.\n\n573\n00:28:21.160 --> 00:28:26.101\nSo I wanna do, maybe Source and\nDestination MAC, I could come in and\n\n574\n00:28:26.101 --> 00:28:26.890\nadd that.\n\n575\n00:28:28.200 --> 00:28:31.458\nAnd now, my port channel's gonna switch\nover to load balancing that way.\n\n576\n00:28:31.458 --> 00:28:33.770\nAnd I can jump over to my other switch and\ndo the same thing and\n\n577\n00:28:33.770 --> 00:28:35.501\nnow I'll be [INAUDIBLE]\na different method.\n\n578\n00:28:35.501 --> 00:28:38.555\nSo just another way to handle how we look.\n\n579\n00:28:38.555 --> 00:28:40.425\n>> And Don, you were mentioning,\n\n580\n00:28:40.425 --> 00:28:44.065\nmake it sure you do things the right way\nand if you make a change on one side,\n\n581\n00:28:44.065 --> 00:28:45.960\nyou should go to the other\n>> Make the same change there.\n\n582\n00:28:45.960 --> 00:28:48.690\nEven though it would still work,\nwe like to be consistent.\n\n583\n00:28:48.690 --> 00:28:52.040\nJust like Tak likes to call me\nDaniel the human error Lawry,\n\n584\n00:28:52.040 --> 00:28:54.787\n[LAUGH] so\na lot of times you're looking through my\n\n585\n00:28:54.787 --> 00:28:58.271\nconfiguration you'll see I've\nmade a misconfiguration and\n\n586\n00:28:58.271 --> 00:29:02.563\nis there anything that we can do to help\nguide us and not make those mistakes?\n\n587\n00:29:02.563 --> 00:29:04.699\n>> Now, if you're like me-\n>> [LAUGH]\n\n588\n00:29:04.699 --> 00:29:06.606\n>> Then you statically set your\n\n589\n00:29:06.606 --> 00:29:07.745\nEtherChannel.\n\n590\n00:29:07.745 --> 00:29:09.085\nSo you don't use LACP or PAgP.\n\n591\n00:29:09.085 --> 00:29:10.848\nYou just statically set it and\nyou know it's on.\n\n592\n00:29:10.848 --> 00:29:13.102\nAnd if something goes wrong, what happens?\n\n593\n00:29:13.102 --> 00:29:15.052\nIt goes down and the ports don't work,\nand that's the end of the story.\n\n594\n00:29:16.182 --> 00:29:21.132\nBut if you are using LACP and PAgP, either\none, if something is wrong with your\n\n595\n00:29:21.132 --> 00:29:23.330\nconfiguration, your ports don't go down,\ndo they?\n\n596\n00:29:23.330 --> 00:29:25.520\nThey just flip back to\nbeing regular access ports.\n\n597\n00:29:25.520 --> 00:29:29.878\nNow, that can be tough because if they\nflip back to being regular ports,\n\n598\n00:29:29.878 --> 00:29:33.028\nyou might have connectivity but\njust over one link.\n\n599\n00:29:33.028 --> 00:29:35.332\nAnd the other link spanning\ntree shutting them off.\n\n600\n00:29:35.332 --> 00:29:38.960\nAnd if that happens you might\nnot notice the failure.\n\n601\n00:29:38.960 --> 00:29:40.040\nThat this happened.\n\n602\n00:29:40.040 --> 00:29:41.062\nYou've got a problem.\n\n603\n00:29:41.062 --> 00:29:43.465\nThere's an issue with the configuration\nbut you don't know it,\n\n604\n00:29:43.465 --> 00:29:44.810\ncuz traffic is flowing.\n\n605\n00:29:44.810 --> 00:29:47.600\nYou've got to run a bandwidth test to see\nthat you're not hitting all the links.\n\n606\n00:29:47.600 --> 00:29:49.060\nYou've got to log into\nthe switch to see it.\n\n607\n00:29:49.060 --> 00:29:51.880\nAnd so, there's an extra feature\n\n608\n00:29:51.880 --> 00:29:56.452\nin a Cisco switch that's called\nEtherChannel Misconfiguration Guard.\n\n609\n00:29:56.452 --> 00:29:58.720\nAnd [LAUGH] it's a nice long name.\n\n610\n00:29:58.720 --> 00:30:01.000\nMisconfiguration Guard and\njust like its name implies,\n\n611\n00:30:01.000 --> 00:30:03.590\nit guards you from misconfiguring things.\n\n612\n00:30:03.590 --> 00:30:08.580\nWhat it does is it says, if I'm using LACP\nor PAgP and the connection doesn't quite\n\n613\n00:30:08.580 --> 00:30:13.380\nwork out instead of dropping down to our\nregular port let's make it air disabled.\n\n614\n00:30:13.380 --> 00:30:15.214\nLet's go ahead and just disable the ports.\n\n615\n00:30:15.214 --> 00:30:17.370\nIt's pretty hard to ignore that one.\n\n616\n00:30:17.370 --> 00:30:19.560\nIt's gonna shut the ports off and\nstop them.\n\n617\n00:30:19.560 --> 00:30:22.530\nSo it ensure that it works\nthe way that you want it to work.\n\n618\n00:30:22.530 --> 00:30:24.410\nIt's not on by default,\ncuz most people don't need it.\n\n619\n00:30:24.410 --> 00:30:25.482\nThese are controlled links.\n\n620\n00:30:25.482 --> 00:30:26.460\nThey're your trunks.\n\n621\n00:30:26.460 --> 00:30:27.520\nRight.\nIt's not stuff you really mess\n\n622\n00:30:27.520 --> 00:30:28.520\naround with a lot.\n\n623\n00:30:28.520 --> 00:30:29.500\nSo most people don't worry about it.\n\n624\n00:30:29.500 --> 00:30:31.060\nIt is off by default.\n\n625\n00:30:31.060 --> 00:30:34.540\nBut we can turn it on if we want and\nit will help us kinda protect from that.\n\n626\n00:30:34.540 --> 00:30:37.706\nSo if you hire Daniel, for example, and\nyou just don't know what's gonna happen,\n\n627\n00:30:37.706 --> 00:30:40.103\nyeah, and here's your chance-\n>> It's a crap shoot.\n\n628\n00:30:40.103 --> 00:30:43.069\n[LAUGH]\n>> [LAUGH] Turning it on is a little bit\n\n629\n00:30:43.069 --> 00:30:48.880\nof work, because it's actually\nnot a part of EtherChannel.\n\n630\n00:30:48.880 --> 00:30:50.480\nIt's actually a part of Spanning Tree.\n\n631\n00:30:50.480 --> 00:30:54.433\nSpanning Tree can watch your EtherChannel\nto see when things are misconfigured and\n\n632\n00:30:54.433 --> 00:30:55.515\ndrop back to regular.\n\n633\n00:30:55.515 --> 00:30:59.080\nAnd normally it's gonna see that and\nblock off the loops.\n\n634\n00:30:59.080 --> 00:31:00.260\nBut this time we can tell statement chain,\n\n635\n00:31:00.260 --> 00:31:03.590\nhey, don't block off the loops,\njust turn the ports off.\n\n636\n00:31:03.590 --> 00:31:08.676\nSo what we do is, we get into our switch,\nand the command, it's one of\n\n637\n00:31:08.676 --> 00:31:14.801\nthe kinda longer ones, is we can just say\nspanning-tree, and then etherchannel,\n\n638\n00:31:14.801 --> 00:31:20.264\nso this is where we link the two\ntechnologies together, guard misconfig.\n\n639\n00:31:20.264 --> 00:31:23.048\nThat command right there's gonna turn\nthat misconfiguration guard on, so\n\n640\n00:31:23.048 --> 00:31:24.786\nnow it's gonna see that\nwe have a port channel,\n\n641\n00:31:24.786 --> 00:31:26.810\nit's gonna see that we\nhave these interfaces.\n\n642\n00:31:26.810 --> 00:31:30.450\nAnd if the port channel doesn't work out,\nit'll just block the ports and stop it.\n\n643\n00:31:30.450 --> 00:31:32.200\nAnd that'll be the end of it.\n\n644\n00:31:32.200 --> 00:31:33.940\nAnd so, we can turn that on.\n\n645\n00:31:33.940 --> 00:31:36.330\nYou usually would wanna turn this\non across your environment, so\n\n646\n00:31:36.330 --> 00:31:38.430\nyou have consistent behavior but\nyou don't have to.\n\n647\n00:31:38.430 --> 00:31:42.300\nIf it's on on this end and\nthe other end causes the problem,\n\n648\n00:31:42.300 --> 00:31:44.120\nthe end's gonna drop and\nwill block it here too.\n\n649\n00:31:44.120 --> 00:31:46.260\nSo I don't technically have\nto turn it on everywhere.\n\n650\n00:31:46.260 --> 00:31:48.755\nBut it's usually a good idea so\nyou have consistent behavior.\n\n651\n00:31:48.755 --> 00:31:51.231\nBut in this scenario\nI've got it turned off.\n\n652\n00:31:51.231 --> 00:31:54.203\nThere are some people out there who will\ntell you it's not a good idea to turn it\n\n653\n00:31:54.203 --> 00:31:56.940\non on both ends, and\nI understand why they're saying that.\n\n654\n00:31:56.940 --> 00:32:02.620\nBecause if I disable the ports here, and\nthe ports gets disabled on the other side,\n\n655\n00:32:02.620 --> 00:32:06.320\nwhen I fix one end,\nthe other end is still disabled.\n\n656\n00:32:06.320 --> 00:32:08.020\nIt doesn't know we fixed the problem.\n\n657\n00:32:08.020 --> 00:32:11.700\nSo if we leave one end not configured,\nwhen I fix the first end,\n\n658\n00:32:11.700 --> 00:32:14.580\nthe second end can see it and\nit can come back up.\n\n659\n00:32:15.600 --> 00:32:19.033\nBut it just kinda depends on your\nown opinion how you want to.\n\n660\n00:32:19.033 --> 00:32:20.978\nMy opinion is don't use it at all,\njust go and hard set stuff and\n\n661\n00:32:20.978 --> 00:32:22.440\nyou don't have to worry about it.\n\n662\n00:32:22.440 --> 00:32:23.555\nBut not everybody agreed.\n\n663\n00:32:23.555 --> 00:32:26.715\nSo just keep that in mind.\n\n664\n00:32:26.715 --> 00:32:29.425\nOnce we have that turned on, now spanning\ntree is gonna behave differently, and\n\n665\n00:32:29.425 --> 00:32:31.365\nit's that extra little\nadded layer of protection.\n\n666\n00:32:31.365 --> 00:32:33.835\nNow, we talk about a lot\nof commands on the show,\n\n667\n00:32:33.835 --> 00:32:37.615\nthe bulk of which I can assure you guys\nI've used many times in production.\n\n668\n00:32:37.615 --> 00:32:39.265\nI've never once turned\nthis on in production, and\n\n669\n00:32:39.265 --> 00:32:41.888\nit's just because of how\nI normally set things up.\n\n670\n00:32:41.888 --> 00:32:45.230\nBut you wanna know this one because it\nis specifically in the exam objective.\n\n671\n00:32:45.230 --> 00:32:47.655\nSo good chance it's gonna\nshow up on the exam.\n\n672\n00:32:47.655 --> 00:32:48.456\n>> Yeah, great stuff Don.\n\n673\n00:32:48.456 --> 00:32:49.942\nLet's me see, just one second.\n\n674\n00:32:49.942 --> 00:32:51.381\n[LAUGH]\n>> [LAUGH]\n\n675\n00:32:51.381 --> 00:32:52.169\n>> Put that in real quick.\n\n676\n00:32:52.169 --> 00:32:55.922\n>> [LAUGH]\n>> Don't mind me Don,\n\n677\n00:32:55.922 --> 00:32:57.615\njust making a config change.\n\n678\n00:32:57.615 --> 00:32:59.640\n>> [LAUGH]\n>> Episode to stop, that's it.\n\n679\n00:32:59.640 --> 00:33:01.525\n>> That's it.\nThe end of the show.\n\n680\n00:33:01.525 --> 00:33:03.400\nGreat stuff though,\nexcellent demonstrations.\n\n681\n00:33:03.400 --> 00:33:06.010\nIs there anything else we need to\nknow about this wonderful technology?\n\n682\n00:33:06.010 --> 00:33:07.950\n>> I think we are ether channeled out.\n\n683\n00:33:07.950 --> 00:33:08.474\nThat's it.\n\n684\n00:33:08.474 --> 00:33:11.287\n>> I think our good viewers\nout there now know that, hey,\n\n685\n00:33:11.287 --> 00:33:14.897\nif you do have some of these links\nthat you're setting up to have that,\n\n686\n00:33:14.897 --> 00:33:18.870\nwe want that redundancy, we also\nwant that aggregation of link speed.\n\n687\n00:33:18.870 --> 00:33:20.140\nThis is definitely the way to go.\n\n688\n00:33:20.140 --> 00:33:24.010\nSo now you know how to set that up,\nI know I'm gonna start employing this in\n\n689\n00:33:24.010 --> 00:33:27.560\nall of my trunk links that's\na great place to put that.\n\n690\n00:33:27.560 --> 00:33:30.150\nBut Don I say we'll go ahead and\ncall this an episode.\n\n691\n00:33:30.150 --> 00:33:30.900\n>> That's a good spot.\n\n692\n00:33:30.900 --> 00:33:32.164\n>> All right.\nSigning off for\n\n693\n00:33:32.164 --> 00:33:34.707\nITProTV, I've been your\nhost Daniel Lowrie.\n\n694\n00:33:34.707 --> 00:33:35.531\n>> And I'm Don Pezet.\n\n695\n00:33:35.531 --> 00:33:37.412\nWe will see you next time.\n\n696\n00:33:37.412 --> 00:33:43.710\n[MUSIC]\n\n",
          "vimeoId": "141104336"
        },
        {
          "description": "In this episode, Daniel and Don explain the Spanning Tree Protocol (STP) switch loop prevention system found in Cisco switches. They start with a quick review of STP functions and then get right to explaining how exactly it goes about keeping a switched network loop-free. Specifically here they cover the STP processes of Root Bridge election as well as the 5 STP port states.",
          "length": "1818",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree-093015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree-093015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree-093015-1-sm.jpg",
          "title": "Spanning Tree",
          "transcript": "WEBVTT\n\n1\n00:00:00.042 --> 00:00:10.042\n[MUSIC]\n\n2\n00:00:11.810 --> 00:00:16.950\nAll right, greeting everyone and welcome\nto another fantastic episode of ITProTV.\n\n3\n00:00:16.950 --> 00:00:18.130\nI'm your host, Daniel Lowry.\n\n4\n00:00:18.130 --> 00:00:22.690\nHere with me today, yet\nagain, is Mr. Don Pezet.\n\n5\n00:00:22.690 --> 00:00:23.420\nWelcome to the show, Don.\n\n6\n00:00:23.420 --> 00:00:25.210\n>> Thanks for having me back, Daniel.\n\n7\n00:00:25.210 --> 00:00:27.850\nYou said today, I thought you were gonna\nsay it was like nighttime outside.\n\n8\n00:00:27.850 --> 00:00:29.200\nWe don't have any windows in this place.\n\n9\n00:00:29.200 --> 00:00:30.123\nI have no idea what's going on.\n>> We're in a cellar.\n\n10\n00:00:30.123 --> 00:00:33.970\n[LAUGH]\n>> Well, I'm back on the show again, and\n\n11\n00:00:33.970 --> 00:00:36.770\nthe reason is we're jumping\ninto a new technology,\n\n12\n00:00:36.770 --> 00:00:40.610\nwhich is a pretty fun one,\nSpanning Tree Protocol.\n\n13\n00:00:40.610 --> 00:00:43.130\nSpanning Tree Protocol,\nit was covered in the CCNA,\n\n14\n00:00:43.130 --> 00:00:44.370\nmost of your guys already\nlearned about it.\n\n15\n00:00:44.370 --> 00:00:47.080\nIt's one of those cool protocols that,\nit's already running,\n\n16\n00:00:47.080 --> 00:00:49.220\nit's already configured, you just turn\non the switch and you're done, and\n\n17\n00:00:49.220 --> 00:00:52.080\nthat's really all we needed to know for\nthe CCNA.\n\n18\n00:00:52.080 --> 00:00:57.360\nBut in this show for the CCNP, we're going\nto revisit Spanning Tree Protocol and\n\n19\n00:00:57.360 --> 00:00:59.380\nthere's actually a lot you can do to it.\n\n20\n00:00:59.380 --> 00:01:02.790\nThere's a lot of stuff that we can\nmanipulate and change the behavior of it\n\n21\n00:01:02.790 --> 00:01:05.640\nto get it working the way that we want,\nand so here we're going to do the deep\n\n22\n00:01:05.640 --> 00:01:08.740\ndive on spanning tree and\nsee what's really under the hood.\n\n23\n00:01:08.740 --> 00:01:11.070\nNow if you've forgotten\nbecause it's been a while and\n\n24\n00:01:11.070 --> 00:01:15.270\nthis isn't something that we normally have\nto configure, Spanning Tree Protocol is\n\n25\n00:01:15.270 --> 00:01:20.600\na protocol running on your Cisco switches\nthat's designed to help prevent loops.\n\n26\n00:01:20.600 --> 00:01:26.235\nIt looks for loops on the network and\nanytime it finds one, it fixes it for us.\n\n27\n00:01:26.235 --> 00:01:29.655\nSo for example the topology I've\nbeen using in all these labs,\n\n28\n00:01:29.655 --> 00:01:33.335\nif we take a look at it here,\nI've got these three switches and\n\n29\n00:01:33.335 --> 00:01:36.285\nthere's actually two different\nloops in my environment.\n\n30\n00:01:36.285 --> 00:01:39.960\nI've got a loop right here\nbetween these two switches.\n\n31\n00:01:39.960 --> 00:01:44.230\nThese redundant links right here\nactually create a loop, but\n\n32\n00:01:44.230 --> 00:01:47.650\nthen I've got this big triangle.\n\n33\n00:01:47.650 --> 00:01:49.260\nThat's a loop also.\n\n34\n00:01:49.260 --> 00:01:53.950\nIf a broadcast comes out on my New York\nCore 1 switch, the broadcast hits Core 2;\n\n35\n00:01:53.950 --> 00:01:58.280\nthe broadcast then hits Access 1 and\nthe broadcast comes right back\n\n36\n00:01:58.280 --> 00:02:02.810\nto Core 1 again where it gets repeated\nover and over for all of eternity.\n\n37\n00:02:02.810 --> 00:02:04.890\nThe problem is broadcasts\nstart to stack up.\n\n38\n00:02:04.890 --> 00:02:07.600\nWe keep doing more and more and more,\nthey build up, build up, build up, and\n\n39\n00:02:07.600 --> 00:02:10.170\neventually you get a broadcast storm,\nyou run out of bandwidth,\n\n40\n00:02:10.170 --> 00:02:10.980\nand your network is dead.\n\n41\n00:02:12.020 --> 00:02:13.230\nWhen the happens, the solution?\n\n42\n00:02:13.230 --> 00:02:15.080\nYou gotta break the loop.\n\n43\n00:02:15.080 --> 00:02:17.450\nYou gotta figure out where the loop is and\nunplug that cable, and\n\n44\n00:02:17.450 --> 00:02:19.440\nthen it stops and your problem is solved.\n\n45\n00:02:19.440 --> 00:02:21.120\nBut who has time for that?\n\n46\n00:02:21.120 --> 00:02:24.880\nEspecially if you have a ton of switches,\nit really gets confusing.\n\n47\n00:02:24.880 --> 00:02:26.430\nIt really gets hard to\ntroubleshoot it down.\n\n48\n00:02:26.430 --> 00:02:30.780\nSo a lot of people will shut off all their\nswitches and then power them back on,\n\n49\n00:02:30.780 --> 00:02:32.650\nwhich is not a realistic thing.\n\n50\n00:02:32.650 --> 00:02:34.790\nAnd it's only a temporary solution\ncuz the loops still there.\n\n51\n00:02:34.790 --> 00:02:36.230\nIt's gonna come right back.\n\n52\n00:02:36.230 --> 00:02:39.730\nSo Spanning Tree runs\nin the background and\n\n53\n00:02:39.730 --> 00:02:44.490\nit picks a switch to act as like the head\nhoncho, the core of the network.\n\n54\n00:02:44.490 --> 00:02:47.580\nAnd from that core,\nit maps out the network and\n\n55\n00:02:47.580 --> 00:02:49.840\nfigures out where the loops are and\nstops them.\n\n56\n00:02:49.840 --> 00:02:52.650\nIt blocks the loops to\nprevent this from happening.\n\n57\n00:02:52.650 --> 00:02:54.520\nSo it's pretty neat stuff.\n\n58\n00:02:54.520 --> 00:02:56.825\nThe neatest part, in my opinion,\nis how it's all automatic.\n\n59\n00:02:56.825 --> 00:02:58.650\nCisco switches do this\nright out of the box.\n\n60\n00:02:58.650 --> 00:03:02.770\nYou just plug them in,\nSTP is already running and doing its work.\n\n61\n00:03:02.770 --> 00:03:04.395\nWe're done.\nShortest episode ever, right?\n\n62\n00:03:04.395 --> 00:03:05.540\n>> [LAUGH]\n>> Well,\n\n63\n00:03:05.540 --> 00:03:07.300\nthere is a lot more that we can do to it.\n\n64\n00:03:07.300 --> 00:03:08.160\n>> Yeah, that's right Don.\n\n65\n00:03:08.160 --> 00:03:09.910\nI mean, we've all CCNA-ed it up.\n\n66\n00:03:09.910 --> 00:03:10.430\nIt was great.\n\n67\n00:03:10.430 --> 00:03:15.750\nWe understand a little bit about STP,\nbut we want to go CCNP deep.\n\n68\n00:03:15.750 --> 00:03:19.220\nWe want to know how to configure it, how\nto optimize it, do all the great stuff,\n\n69\n00:03:19.220 --> 00:03:20.990\nhow the magic happens.\n\n70\n00:03:20.990 --> 00:03:21.840\nDon, that's where you come in.\n\n71\n00:03:21.840 --> 00:03:23.650\nWhere do we begin with STP?\n\n72\n00:03:23.650 --> 00:03:27.910\n>> All right,\nwell let's start with the root bridge.\n\n73\n00:03:27.910 --> 00:03:30.420\nI mentioned that with\nSpanning Tree Protocol,\n\n74\n00:03:30.420 --> 00:03:35.120\nit picks somebody to be the head honcho,\nto be the center of the network.\n\n75\n00:03:35.120 --> 00:03:37.310\nAnd a lot of people think\nof this as a server.\n\n76\n00:03:37.310 --> 00:03:38.660\nIt's not really a server.\n\n77\n00:03:38.660 --> 00:03:43.560\nAnd in the standards, they'll even say it\nacts as like the center of the network.\n\n78\n00:03:43.560 --> 00:03:45.100\nIt doesn't necessarily have to\nbe the center of the network,\n\n79\n00:03:45.100 --> 00:03:48.100\nit can be any switch in your entire\nenvironment can act as what's called\n\n80\n00:03:48.100 --> 00:03:48.950\nthe root bridge.\n\n81\n00:03:50.100 --> 00:03:53.240\nBut the root bridge is pretty\nimportant because it's sending out\n\n82\n00:03:53.240 --> 00:03:53.930\nannouncements, right.\n\n83\n00:03:53.930 --> 00:03:55.600\nIt's announcing that it's on the network.\n\n84\n00:03:56.710 --> 00:04:02.140\nIn spanning tree protocol we use these\nBPDUs, these bridge protocol data units,\n\n85\n00:04:02.140 --> 00:04:05.000\nand the BPDUs are just little\nannouncements that says, hey,\n\n86\n00:04:05.000 --> 00:04:06.920\nI'm a switch, and I'm here.\n\n87\n00:04:06.920 --> 00:04:11.230\nSo the root bridge sends out\nBPDUs out of all of its ports.\n\n88\n00:04:11.230 --> 00:04:13.140\nEvery single port on the switch,\nit sends out a BPDU.\n\n89\n00:04:14.540 --> 00:04:17.810\nIf another switch receives it,\nIt looks at it and\n\n90\n00:04:17.810 --> 00:04:21.400\nit says, oh, that guy's the head honcho,\nhe's the root.\n\n91\n00:04:21.400 --> 00:04:24.810\nThis interface that I just received the\nBPDU on, that's a connection to the root.\n\n92\n00:04:25.910 --> 00:04:31.280\nIf it sees a BPDU from the root\ncome in on two different lengths,\n\n93\n00:04:31.280 --> 00:04:32.710\nit knows there's a loop.\n\n94\n00:04:32.710 --> 00:04:33.840\nIt says wait a minute.\n\n95\n00:04:33.840 --> 00:04:38.120\nI've got two ways to get to the root,\nthere's a loop on this network.\n\n96\n00:04:38.120 --> 00:04:41.380\nSo as simple as that,\nwe can figure out where the loop is.\n\n97\n00:04:41.380 --> 00:04:43.870\nSo using my topology as an example.\n\n98\n00:04:43.870 --> 00:04:47.660\nLet's just pretend,\nthat Core 1 is the root.\n\n99\n00:04:49.110 --> 00:04:52.520\nIt's gonna send out BPDUs at\nall three of these interfaces.\n\n100\n00:04:52.520 --> 00:04:56.220\nWell one BPDU is gonna come down\nthis link on interface 22 down to\n\n101\n00:04:56.220 --> 00:04:57.830\nthis access switch and\nis gonna receive it.\n\n102\n00:04:57.830 --> 00:05:00.207\nSo the access switch says,\nhey I can get to the root right here.\n\n103\n00:05:00.207 --> 00:05:05.030\nThat's a good port but the BPU's\nare gonna out these two links also and\n\n104\n00:05:05.030 --> 00:05:07.160\nthose two links are gonna\ncome over here to CORE 2 and\n\n105\n00:05:07.160 --> 00:05:11.590\nCORE 2's gonna say wait a minute, I've\ngot two different ways to get to CORE 1.\n\n106\n00:05:11.590 --> 00:05:12.780\nThere's a loop.\n\n107\n00:05:12.780 --> 00:05:16.690\nI need to do something\nabout that to fix the loop.\n\n108\n00:05:16.690 --> 00:05:20.770\nMeanwhile, it takes that root BPU and\nforwards it along.\n\n109\n00:05:22.070 --> 00:05:28.190\nAll the child switches in spanning tree\nprotocol forward along the root BPDU.\n\n110\n00:05:28.190 --> 00:05:31.730\nSo it's receiving the root\nBPDU right here in Core 2, and\n\n111\n00:05:31.730 --> 00:05:34.290\nthen it sends it down to Access 1.\n\n112\n00:05:34.290 --> 00:05:35.820\nAnd so Access 1 is going to say,\n\n113\n00:05:35.820 --> 00:05:39.280\nwait a minute,\nI can get to the route two different ways.\n\n114\n00:05:39.280 --> 00:05:42.170\nI can get to the route this way and\nI can get to the route this way.\n\n115\n00:05:42.170 --> 00:05:44.220\nI have two different paths to take.\n\n116\n00:05:44.220 --> 00:05:46.490\nAnd so which one is better?\n\n117\n00:05:46.490 --> 00:05:47.410\nI know I've got a loop.\n\n118\n00:05:47.410 --> 00:05:49.100\nI've got two ways to get there.\n\n119\n00:05:49.100 --> 00:05:51.910\nI need to pick the better one and\nshut off the bad one.\n\n120\n00:05:53.100 --> 00:05:56.260\nAnd that stops the loop and ensures that\nwe've got the good connection going.\n\n121\n00:05:56.260 --> 00:05:57.720\nSo there's a lot that\ncomes into play here.\n\n122\n00:05:57.720 --> 00:06:01.010\nThink about all the different\nthings I just mentioned,\n\n123\n00:06:01.010 --> 00:06:04.460\nwe have to have a root bridge, so\nsomebody's got to be the head honcho.\n\n124\n00:06:04.460 --> 00:06:07.300\nEverybody else has to be\nlooking at these BPDUs and\n\n125\n00:06:07.300 --> 00:06:11.420\nkind of building their infrastructure, so\nthey have know which is their best port.\n\n126\n00:06:11.420 --> 00:06:14.420\nAnd then somehow, they have to make\na decision over which ports to shut off.\n\n127\n00:06:15.620 --> 00:06:19.750\nSo for the CCNA exam, we didn't really\nhave to know that all that well, but for\n\n128\n00:06:19.750 --> 00:06:20.910\nthe CCNP, you really do.\n\n129\n00:06:20.910 --> 00:06:24.720\nWe need to fully understand exactly\nhow these decisions get made.\n\n130\n00:06:24.720 --> 00:06:27.420\nAnd depending on how much information we\n\n131\n00:06:27.420 --> 00:06:30.200\nhave is going to determine if we can\nfigure this out on our own or not.\n\n132\n00:06:31.620 --> 00:06:33.010\nLet's start with that root bridge.\n\n133\n00:06:33.010 --> 00:06:34.880\nWho becomes the root.\n\n134\n00:06:34.880 --> 00:06:39.450\nWell if you've only got one switch and\nyou just turned it on, congratulations,\n\n135\n00:06:39.450 --> 00:06:41.540\nit's the root, that makes it easy.\n\n136\n00:06:41.540 --> 00:06:44.720\nBut if you have one switch do\nyou have a loop, probably not,\n\n137\n00:06:44.720 --> 00:06:46.710\nI guess you could have\na cable running out.\n\n138\n00:06:46.710 --> 00:06:47.450\n>> Looped to yourself.\n\n139\n00:06:47.450 --> 00:06:48.910\n>> You can loop to yourself, it happens.\n\n140\n00:06:50.010 --> 00:06:51.370\nIt shouldn't happen, but it does.\n\n141\n00:06:52.380 --> 00:06:57.570\nBut if you have more than one switch, the\nodds of creating a loop start to increase.\n\n142\n00:06:57.570 --> 00:06:59.690\nAnd sometimes we create loops on purpose.\n\n143\n00:06:59.690 --> 00:07:02.170\nIf you watched our ether channel episode,\n\n144\n00:07:02.170 --> 00:07:05.520\nwe had two links running between\na switch for redundancy purposes.\n\n145\n00:07:05.520 --> 00:07:08.950\nAnd that was a loop and\nwe did it on purpose for redundancy.\n\n146\n00:07:08.950 --> 00:07:11.530\nWell, Spinning Tree solves that problem,\nbut\n\n147\n00:07:11.530 --> 00:07:14.120\nkeeps the other cable available to\nbring it back up if we need it.\n\n148\n00:07:14.120 --> 00:07:16.620\nWe can use either channel to\nfix that between two switches.\n\n149\n00:07:16.620 --> 00:07:18.280\nBut if you have more than\ntwo switches in the loop,\n\n150\n00:07:18.280 --> 00:07:21.630\nlike what we've got here with Core1,\nCore2 and this access switch.\n\n151\n00:07:21.630 --> 00:07:25.890\nYou've got more than two switches here,\nether channel can't solve that problem.\n\n152\n00:07:25.890 --> 00:07:28.770\nI've got this triangle, or\nit might be a square or an octagon or\n\n153\n00:07:28.770 --> 00:07:31.420\nwhatever that creates\na giant loop in my network.\n\n154\n00:07:31.420 --> 00:07:32.560\nI need a way to fix that.\n\n155\n00:07:32.560 --> 00:07:35.160\nSo we have to elect somebody at the root.\n\n156\n00:07:35.160 --> 00:07:37.290\nAnd, assuming that all of\nthe switches are already up and\n\n157\n00:07:37.290 --> 00:07:41.700\nrunning, it could be just whatever\nswitch came up first is the root.\n\n158\n00:07:41.700 --> 00:07:46.180\nBut if that switch goes off,\nan election happens.\n\n159\n00:07:46.180 --> 00:07:49.030\nIt's election day on the old network.\n\n160\n00:07:49.030 --> 00:07:52.570\nAnd so some switch has to\nbasically get elected as the root.\n\n161\n00:07:52.570 --> 00:07:54.793\nAnd it boils down to\na few different factors.\n\n162\n00:07:54.793 --> 00:07:57.584\nIn Spanning Tree,\nyou have what's called a priority.\n\n163\n00:07:57.584 --> 00:08:00.751\nAnd the priority is really what\ndetermines who becomes the root.\n\n164\n00:08:00.751 --> 00:08:05.833\nPriority's a number.\nZero through 65,534.\n\n165\n00:08:05.833 --> 00:08:08.770\nIt's one of those,\nwhat is that 16 bit number?\n\n166\n00:08:08.770 --> 00:08:11.260\n>> Yeah.\n>> 65,000, yeah I think it's 16 bits.\n\n167\n00:08:11.260 --> 00:08:14.990\nSo, that's why the number stops at 65,534.\n\n168\n00:08:14.990 --> 00:08:18.210\nSo, every switch has a priority number.\n\n169\n00:08:18.210 --> 00:08:19.720\nAnd it's gonna be between those.\n\n170\n00:08:19.720 --> 00:08:23.110\nIf you make it a zero, that tells\nthe switch hey, you need to be the root.\n\n171\n00:08:23.110 --> 00:08:26.010\nIf you make it 65,534 that says,\nyou're not gonna be the root unless\n\n172\n00:08:26.010 --> 00:08:30.240\neverybody else is turned off,\nthen you're not gonna be the root.\n\n173\n00:08:30.240 --> 00:08:32.240\nSo we influence that priority.\n\n174\n00:08:32.240 --> 00:08:34.790\nRemember, this is where\nit's really challenging.\n\n175\n00:08:34.790 --> 00:08:37.120\nLower priority is better.\n\n176\n00:08:37.120 --> 00:08:38.920\nRight?\nThe lower the priority number,\n\n177\n00:08:38.920 --> 00:08:41.460\nthe more likely you are to become a root.\n\n178\n00:08:41.460 --> 00:08:47.870\nWell, on Cisco switches,\nthe default is 32,768.\n\n179\n00:08:47.870 --> 00:08:49.050\nNow it's a weird number.\n\n180\n00:08:49.050 --> 00:08:51.997\nRight?\nWhy do they pick 32,768?\n\n181\n00:08:51.997 --> 00:08:58.545\nIt's smack in the middle of zero and\n65,534.\n\n182\n00:08:58.545 --> 00:08:59.101\nSo it's right in the middle.\n\n183\n00:08:59.101 --> 00:09:03.572\n32,768, so if I have all Cisco equipment,\n\n184\n00:09:03.572 --> 00:09:08.047\nthey all default to 32,768 and it's a tie.\n\n185\n00:09:08.047 --> 00:09:09.767\nIt's a tie across all my equipment.\n\n186\n00:09:09.767 --> 00:09:13.960\nIf I have third party equipment,\nwho know what they're set to.\n\n187\n00:09:13.960 --> 00:09:20.388\nSpanning tree protocol is an open\nstandard, it's 802.1D, I 802.1D.\n\n188\n00:09:20.388 --> 00:09:22.614\nAnd it defines the way\nspanning tree works so\n\n189\n00:09:22.614 --> 00:09:26.225\nyou can have third parties and\nthey might have a lower priority number,\n\n190\n00:09:26.225 --> 00:09:29.140\nor they might have a higher\npriority number who knows.\n\n191\n00:09:29.140 --> 00:09:31.080\nYou'd need to read their manual and\ncheck it.\n\n192\n00:09:31.080 --> 00:09:34.540\nBut if it's all Cisco,\nit's one big fat tie.\n\n193\n00:09:34.540 --> 00:09:36.890\nSo I got two choices, all right?\n\n194\n00:09:36.890 --> 00:09:40.580\nOne, I can go and adjust the priority\nto dictate who's gonna be the root.\n\n195\n00:09:41.650 --> 00:09:44.280\nOr two, I can leave it to chance.\n\n196\n00:09:44.280 --> 00:09:46.950\nRight?\nThere is a tie-breaker mechanism.\n\n197\n00:09:46.950 --> 00:09:50.900\nIf the priority is equal\non all the switches\n\n198\n00:09:50.900 --> 00:09:52.970\nthen it goes to what's\ncalled the bridge ID.\n\n199\n00:09:52.970 --> 00:09:56.800\nNow the bridge ID is technically\nmade up of the port number,\n\n200\n00:09:56.800 --> 00:09:58.230\nI mean the priority number.\n\n201\n00:09:58.230 --> 00:10:02.350\nBut it's the priority number and\nthe MAC address, okay.\n\n202\n00:10:02.350 --> 00:10:05.550\nEvery switch has a MAC address, every\nswitch has a lot of MAC addresses, right.\n\n203\n00:10:05.550 --> 00:10:07.755\nBut it has one that's its\nprimary MAC address for\n\n204\n00:10:07.755 --> 00:10:11.300\nits management interface and\nit's gonna use that MAC address.\n\n205\n00:10:11.300 --> 00:10:13.560\nAnd so when I create that switch,\n\n206\n00:10:13.560 --> 00:10:18.520\nit's got a priority that might be equal,\nbut its MAC address is not gonna be equal.\n\n207\n00:10:18.520 --> 00:10:23.740\nAnd so it looks at the MAC address and,\nwhoever has the lowest MAC address, wins.\n\n208\n00:10:23.740 --> 00:10:24.600\nJust like priority,\n\n209\n00:10:24.600 --> 00:10:28.020\nthe lower the number the better,\nthe lower the MAC address, the better.\n\n210\n00:10:28.020 --> 00:10:32.230\nAnd so priority combined with\nMAC address is the bridge ID.\n\n211\n00:10:32.230 --> 00:10:36.010\nThat's what identifies that bridge, and\nthat's gonna be the tiebreaker for us.\n\n212\n00:10:36.010 --> 00:10:38.450\nNow here's the problem\nwith that as a tiebreaker.\n\n213\n00:10:38.450 --> 00:10:42.070\nWhen Cisco manufactures a switch\nthey assign to the MAC address.\n\n214\n00:10:42.070 --> 00:10:44.530\nAnd they don't use that\nMAC address any more.\n\n215\n00:10:44.530 --> 00:10:47.080\nSo if it gives a switch a MAC\naddress that ends in five,\n\n216\n00:10:47.080 --> 00:10:49.950\nthe next switch they\nmanufacture ends in six,\n\n217\n00:10:49.950 --> 00:10:53.570\nand the next one is seven, and\nthen seven, and it goes up, like that.\n\n218\n00:10:53.570 --> 00:10:54.400\nAll right.\n\n219\n00:10:54.400 --> 00:10:58.040\nThat means a switch that\nI bought ten years ago\n\n220\n00:10:58.040 --> 00:11:02.170\nis gonna have a lower MAC address\nthen a switch I buy today.\n\n221\n00:11:02.170 --> 00:11:08.075\nSo I might have this bright shiny 6500\nseries switch that cost 100 grand,\n\n222\n00:11:08.075 --> 00:11:11.415\nand I just put it in my network, and\nI want this to be that root bridge.\n\n223\n00:11:13.425 --> 00:11:16.595\nBut I got this old, crusty 1900\nthat's sitting in some lab somewhere.\n\n224\n00:11:16.595 --> 00:11:19.445\nIt's 10 megabit and its MAC address is so\n\n225\n00:11:19.445 --> 00:11:22.725\nlow that it becomes the root\non my network, right?\n\n226\n00:11:22.725 --> 00:11:25.533\nSo if you don't want to leave it\nto chance you'll want to go and\n\n227\n00:11:25.533 --> 00:11:28.460\nadjust your priority to dictate\nwho's gonna become that root.\n\n228\n00:11:28.460 --> 00:11:30.929\nAll right in my network I'm\nleaving it up to chance.\n\n229\n00:11:30.929 --> 00:11:33.721\nSo let's go into it and\nwe're gonna see who is the root.\n\n230\n00:11:33.721 --> 00:11:38.677\nNow to me I'm thinking New York core\none should be the root it's a core\n\n231\n00:11:38.677 --> 00:11:42.189\nright at least core two maybe but\nI want core one.\n\n232\n00:11:42.189 --> 00:11:47.406\nSo I want it to be the root,\nwell if I jump into core one and\n\n233\n00:11:47.406 --> 00:11:54.340\nI do a show stunning dash tree I can\nsee that I'm running spanning-tree.\n\n234\n00:11:54.340 --> 00:11:58.500\nAnd right here at the very beginning,\nit's gonna tell me what my ID is.\n\n235\n00:11:59.930 --> 00:12:01.230\nAnd I can see my priority.\n\n236\n00:12:01.230 --> 00:12:06.445\nNow, my priority is not set\nto the default, it's 24577.\n\n237\n00:12:06.445 --> 00:12:09.230\nAnd my address, that's my MAC address.\n\n238\n00:12:09.230 --> 00:12:14.950\nAnd so those two combined, my priority and\nmy address combine to make my bridge ID.\n\n239\n00:12:14.950 --> 00:12:16.520\nNow here it's saying the root ID.\n\n240\n00:12:16.520 --> 00:12:19.360\nThis is whoever is the root.\n\n241\n00:12:19.360 --> 00:12:20.030\nI am the root.\n\n242\n00:12:20.030 --> 00:12:21.880\nSee my bridge ID down here that's me.\n\n243\n00:12:21.880 --> 00:12:23.310\nI am the root.\n\n244\n00:12:23.310 --> 00:12:26.540\nAnd it even tells me\nthis bridge is the root.\n\n245\n00:12:26.540 --> 00:12:30.890\nI'm the root because I've\ngot that lower priority.\n\n246\n00:12:30.890 --> 00:12:34.300\nIf my priority was the default\nI'd tie with other people.\n\n247\n00:12:34.300 --> 00:12:39.297\nIf I go and look at core 2,\nI'll take this switch, and\n\n248\n00:12:39.297 --> 00:12:46.141\nwhen I look at this one, if I do a show\nspanning-tree, I can look in here and\n\n249\n00:12:46.141 --> 00:12:51.921\nhere's my bridge ID, and\nI've got a priority of 32768.\n\n250\n00:12:51.921 --> 00:12:53.506\nI've got the default.\n\n251\n00:12:53.506 --> 00:12:57.710\nAnd if I look up here the root\nhas a lower priority.\n\n252\n00:12:57.710 --> 00:12:59.120\nSo I'm not the root so.\n\n253\n00:12:59.120 --> 00:13:01.760\nSomebody else's and I've got that default.\n\n254\n00:13:03.020 --> 00:13:09.210\nBut if I look at my address,\nthe address here, it starts with 64d8.\n\n255\n00:13:09.210 --> 00:13:11.890\nMy address starts with f4aC.\n\n256\n00:13:11.890 --> 00:13:17.880\nWell, six is lower than F so\nif I had left this up to chance,\n\n257\n00:13:17.880 --> 00:13:20.910\nmy other switch still would have been\nthe root, it has the lower MAC address.\n\n258\n00:13:20.910 --> 00:13:25.530\nBut I've also got this access switch back\nhere, let me go take a look at that one.\n\n259\n00:13:25.530 --> 00:13:29.470\nAnd if I look at this access switch kind\nof way back here in the background and\n\n260\n00:13:29.470 --> 00:13:31.630\nI do a show spanning tree.\n\n261\n00:13:31.630 --> 00:13:32.370\nAll right.\n\n262\n00:13:32.370 --> 00:13:36.820\nI can see that it says\nthis bridge is the root.\n\n263\n00:13:36.820 --> 00:13:38.130\nWhat, that's odd.\n\n264\n00:13:38.130 --> 00:13:41.200\nThis one thinks it's the root for\nsome reason.\n\n265\n00:13:41.200 --> 00:13:43.230\nAnd it says spanning tree is enabled.\n\n266\n00:13:43.230 --> 00:13:49.160\nI can see that my priority is 32768,\nand its got a MAC address of 5ca.\n\n267\n00:13:49.160 --> 00:13:51.800\nFor some reason it thinks\nthat it is the root.\n\n268\n00:13:52.830 --> 00:13:54.350\nI got two roots in this network.\n\n269\n00:13:54.350 --> 00:13:56.400\nWell, one of two things is going on here.\n\n270\n00:13:56.400 --> 00:14:00.575\nEither one, one of the switches\nmessed up and I gotta go fix that or\n\n271\n00:14:00.575 --> 00:14:06.290\ntwo, I've switched roots\njust while I was talking.\n\n272\n00:14:06.290 --> 00:14:09.670\nIt's possible that this switch became\nthe root while I was talking and\n\n273\n00:14:09.670 --> 00:14:10.940\nthe other one isn't a root anymore.\n\n274\n00:14:10.940 --> 00:14:14.720\nI seriously doubt that's the case right\nbut if I jump back over to my main router,\n\n275\n00:14:14.720 --> 00:14:18.870\nI mean jump back to my main switch,\nif I jump back to my core right.\n\n276\n00:14:18.870 --> 00:14:22.020\nThis one thought it was root\nas early as just a moment ago.\n\n277\n00:14:22.020 --> 00:14:27.390\nAnd, if I do a show span on it now, and\ntake a look, it still think it's the root,\n\n278\n00:14:27.390 --> 00:14:32.870\nso I definitely have a problem\ngoing on here where core one and\n\n279\n00:14:32.870 --> 00:14:35.320\nthe access switch are not\nquite talking right.\n\n280\n00:14:35.320 --> 00:14:37.460\nSo I've got a configuration issue.\n\n281\n00:14:37.460 --> 00:14:39.540\nSo I'm going to have to\nresolve that all right.\n\n282\n00:14:39.540 --> 00:14:42.810\nAnd you can spot these issues sometimes\nwhen you look at spanning tree's\n\n283\n00:14:42.810 --> 00:14:43.500\nconfiguration.\n\n284\n00:14:43.500 --> 00:14:49.720\nWhen I look down here, I'm connected to\nthe access switch on port 22, but when\n\n285\n00:14:49.720 --> 00:14:54.170\nI look at my spanning tree configuration\ndown here, port 22's not in that list.\n\n286\n00:14:55.210 --> 00:14:57.790\nSo I may not be connected to that switch.\n\n287\n00:14:57.790 --> 00:15:01.060\nIf I'm not connected, sure it's gonna\nbecome the root because it doesn't see me.\n\n288\n00:15:01.060 --> 00:15:05.300\nAnd if I do a show cdp neighbor I\ncan look in here and sure enough,\n\n289\n00:15:05.300 --> 00:15:07.290\nI don't see that access switch.\n\n290\n00:15:07.290 --> 00:15:08.030\nRight.\n\n291\n00:15:08.030 --> 00:15:10.940\nSo, let's say I want to bring\nthat other switch into the fold.\n\n292\n00:15:10.940 --> 00:15:14.500\nApparently I've shut some ports down or\nsomething and so that one's now isolated.\n\n293\n00:15:14.500 --> 00:15:16.140\nI want to bring it into the fold.\n\n294\n00:15:16.140 --> 00:15:21.380\nWell, when I do that I should stay\nthe root because I have a lower priority.\n\n295\n00:15:21.380 --> 00:15:23.790\nBut let's leave it up to chance and\njust see what happens, right?\n\n296\n00:15:23.790 --> 00:15:27.320\nI'm gonna put my priority back to what\nit should be, back to the default.\n\n297\n00:15:27.320 --> 00:15:32.500\nSo I'm gonna jump into my configuration\non CORE1, and I'm just gonna adjust\n\n298\n00:15:32.500 --> 00:15:37.190\nthat priority number and set it to,\nwell what I want that default to be right.\n\n299\n00:15:37.190 --> 00:15:41.352\nSo the way we set that is in config,\nyou use the spanning-tree command and\n\n300\n00:15:41.352 --> 00:15:45.586\nwhen we configure spanning tree I'm\ngonna talk about this a little bit more\n\n301\n00:15:45.586 --> 00:15:48.294\nlatter but\nI'm gonna have to specify the VLAN.\n\n302\n00:15:48.294 --> 00:15:52.504\nOn a Cisco switch we actually manage\nspanning tree separately for each VLAN.\n\n303\n00:15:52.504 --> 00:15:55.130\nNow I've only got VLAN one right now so\nI'm not too worried about it.\n\n304\n00:15:55.130 --> 00:15:57.584\nBut I'm gonna say vlan 1.\n\n305\n00:15:57.584 --> 00:15:59.630\nAnd then I can say priority.\n\n306\n00:16:00.750 --> 00:16:03.310\nAnd I can specify what I\nwant that priority to be.\n\n307\n00:16:03.310 --> 00:16:06.944\nAll right, and\nI'm gonna set mine to 32,768.\n\n308\n00:16:06.944 --> 00:16:11.400\nAll right, I want to have the default\npriority just like everybody else.\n\n309\n00:16:11.400 --> 00:16:15.650\nRight, so now all three of my\nswitches have that same priority and\n\n310\n00:16:15.650 --> 00:16:18.830\nnobody is special anymore, all right.\n\n311\n00:16:18.830 --> 00:16:23.510\nAnd if I do a show spanning tree,\nI can see that my priority is 32768.\n\n312\n00:16:23.510 --> 00:16:25.580\nAnd, so I'm set at that default.\n\n313\n00:16:25.580 --> 00:16:29.510\nOkay, I'm still the root, and now I'm\ngonna get that other switch connected.\n\n314\n00:16:29.510 --> 00:16:33.250\nNow, if I pull up the interface\nconfiguration for\n\n315\n00:16:33.250 --> 00:16:35.660\nthat, I can see the interface\nis shut down right here.\n\n316\n00:16:35.660 --> 00:16:37.870\nSo that's why I'm not\nseeing that other one.\n\n317\n00:16:37.870 --> 00:16:43.540\nAnd so I'm gonna turn it on, and\nI'll do a quick new shutdown.\n\n318\n00:16:43.540 --> 00:16:44.720\nThat's going to bring it up.\n\n319\n00:16:44.720 --> 00:16:46.390\nSo now I'm connected to the other side.\n\n320\n00:16:46.390 --> 00:16:49.090\nThe other one is now joining with me.\n\n321\n00:16:49.090 --> 00:16:52.420\nIt thinks it's the root,\nI think I'm the root.\n\n322\n00:16:52.420 --> 00:16:53.740\nSo what's going to happen?\n\n323\n00:16:53.740 --> 00:16:54.370\nAn election.\n\n324\n00:16:54.370 --> 00:16:56.420\nWhen you have two roots,\nan election has to happen.\n\n325\n00:16:56.420 --> 00:16:59.750\nAnd technically this would happen\nany time you plug in a new switch.\n\n326\n00:16:59.750 --> 00:17:02.000\nYou'd have a new election and\n\n327\n00:17:02.000 --> 00:17:05.840\nto see what's going on so\nif I've two roots without an election.\n\n328\n00:17:05.840 --> 00:17:10.220\nNow if you power on the switch,\nthat'll go immediately to root.\n\n329\n00:17:10.220 --> 00:17:13.300\nSo it won't preempt somebody\nwho's already a root.\n\n330\n00:17:13.300 --> 00:17:15.790\nBut if both switches think they're\nthe root and they're already on and\n\n331\n00:17:15.790 --> 00:17:18.670\nyou connect it like I just did\na new election does occur.\n\n332\n00:17:18.670 --> 00:17:21.150\nSo they're sorting it out right\nnow whose gonna be the root.\n\n333\n00:17:21.150 --> 00:17:23.870\nAnd I didn't pay enough\nattention to the MAC addresses.\n\n334\n00:17:23.870 --> 00:17:27.490\nI'm pretty sure the other access\nswitch has a lower MAC address.\n\n335\n00:17:27.490 --> 00:17:33.990\nIf I look at my history,\nmy MAC address starts with 64d8.\n\n336\n00:17:33.990 --> 00:17:39.650\nIf I look at that other access switch,\nif I jump over to it,\n\n337\n00:17:39.650 --> 00:17:46.290\nits MAC address is 5ca4, 5 is lower than\n6, it has the lowest MAC address, right?\n\n338\n00:17:46.290 --> 00:17:49.415\nSo it very well may become the root,\nunless I screwed something up.\n\n339\n00:17:49.415 --> 00:17:52.348\n>> [LAUGH]\n>> So on it, if I do a show span and\n\n340\n00:17:52.348 --> 00:17:54.649\nI take a look at his configuration,\n\n341\n00:17:54.649 --> 00:17:57.890\nI can see that it still\nthinks that it's the root.\n\n342\n00:17:59.490 --> 00:18:03.290\nAnd if I jump back over to my core one.\n\n343\n00:18:04.310 --> 00:18:05.950\n>> It's busy writing\nits concession letter.\n\n344\n00:18:05.950 --> 00:18:07.490\n>> I know, it's like giving up.\n\n345\n00:18:07.490 --> 00:18:11.570\nSo if I come over here take a look at\nthis one, I can do a show span, and\n\n346\n00:18:11.570 --> 00:18:14.940\nwhen I look at its configuration,\nIt's no longer the root,\n\n347\n00:18:14.940 --> 00:18:18.750\nit lost the root because the access\nswitch had a lower MAC address.\n\n348\n00:18:18.750 --> 00:18:22.430\nSo, priority lets me override that, but\notherwise it comes down to MAC address and\n\n349\n00:18:22.430 --> 00:18:24.580\nthat's not always a good thing, right.\n\n350\n00:18:24.580 --> 00:18:26.870\nThis is a 37-50, this is a good switch.\n\n351\n00:18:26.870 --> 00:18:28.620\nMy other core switch is a 37-50.\n\n352\n00:18:28.620 --> 00:18:31.890\nThey're expensive,\nlike four or five grand.\n\n353\n00:18:31.890 --> 00:18:34.920\nThe access one switch though,\nit's just access, right?\n\n354\n00:18:34.920 --> 00:18:39.141\nSo if I do a show cdp real quick, actually\nI don't even remember what platform,\n\n355\n00:18:39.141 --> 00:18:40.275\noh it's a 2960.\n\n356\n00:18:40.275 --> 00:18:45.260\n2960s are good switches but they're not\nthe same level of hardware as a 3750.\n\n357\n00:18:45.260 --> 00:18:47.000\nI may not want that one to be the root.\n\n358\n00:18:47.000 --> 00:18:48.470\nAt the end of the day,\nit doesn't really matter.\n\n359\n00:18:48.470 --> 00:18:50.440\nEspecially if you have\na triangle like I do.\n\n360\n00:18:50.440 --> 00:18:52.990\nLike this,\nit doesn't really matter who the root is.\n\n361\n00:18:52.990 --> 00:18:56.830\nWe just need a root so that we can\nfigure out where our loops are.\n\n362\n00:18:56.830 --> 00:19:02.260\nBut one thing to remember about the root,\nthe root will never disable a port.\n\n363\n00:19:03.610 --> 00:19:04.600\nWell there's one exception.\n\n364\n00:19:04.600 --> 00:19:06.730\nIf you've done something really,\nreally stupid.\n\n365\n00:19:06.730 --> 00:19:09.892\nIf you run a cable out of the root\nright back into the root then it will\n\n366\n00:19:09.892 --> 00:19:10.692\nshut off a port.\n\n367\n00:19:10.692 --> 00:19:13.633\nCuz there's no other alternative,\nit can't do anything else.\n\n368\n00:19:13.633 --> 00:19:16.461\nBut as long as you haven't\ndone anything silly like that,\n\n369\n00:19:16.461 --> 00:19:19.000\nthe root will not shut\noff one of its ports.\n\n370\n00:19:19.000 --> 00:19:22.320\nSo whenever there's a loop and\nsomebody has to block a port it's somebody\n\n371\n00:19:22.320 --> 00:19:24.480\nother than the route\nthat shuts off the port.\n\n372\n00:19:24.480 --> 00:19:27.130\nSo, we normally want to\npick our core-switch,\n\n373\n00:19:27.130 --> 00:19:29.390\na switch that's in\nthe heart of our network.\n\n374\n00:19:29.390 --> 00:19:32.870\nIt's the heart, we don't want it shutting\noff ports, we want somebody else to do it.\n\n375\n00:19:32.870 --> 00:19:36.700\nSo you normally would pick one of your\nbetter switches and make it the root, and\n\n376\n00:19:36.700 --> 00:19:38.950\nto make it the root you just\nadjust that priority number and\n\n377\n00:19:38.950 --> 00:19:40.590\nyou've knocked it out, right.\n\n378\n00:19:40.590 --> 00:19:44.320\nAnd because we can set it per VLAN, I can\nactually have one switch be the root for\n\n379\n00:19:44.320 --> 00:19:46.840\none VLAN and another switch be\nthe root for a different VLAN.\n\n380\n00:19:46.840 --> 00:19:48.460\nYou can have more than one root.\n\n381\n00:19:48.460 --> 00:19:51.340\nBut only one per VLAN\nwhen you set that up.\n\n382\n00:19:51.340 --> 00:19:55.240\nSo, if I want CORE1 to become the root\nagain, I'm gonna need to go and\n\n383\n00:19:55.240 --> 00:19:57.150\nadjust its priority, right?\n\n384\n00:19:57.150 --> 00:20:05.510\nSo on CORE1 I can just run that\nspanning-tree which I'm gonna spell right.\n\n385\n00:20:05.510 --> 00:20:10.590\nVlan 1 priority, and\nthen I can set it to the lower priority.\n\n386\n00:20:10.590 --> 00:20:13.160\nNow there are some shortcuts\nwe can use for this.\n\n387\n00:20:13.160 --> 00:20:17.820\nThe priority number, I have to make\nit lower than the other guys, so\n\n388\n00:20:17.820 --> 00:20:20.660\nCisco actually created a few\nlittle aliases for us.\n\n389\n00:20:20.660 --> 00:20:24.070\nAnd so you'll see where I can come in and\ninstead of saying priority,\n\n390\n00:20:24.070 --> 00:20:28.880\nI can say root and then primary or\nsecondary, all right?\n\n391\n00:20:28.880 --> 00:20:30.380\nThese are really just aliases.\n\n392\n00:20:30.380 --> 00:20:33.750\nIt's going to lower my priority\nnumber to make me preferred.\n\n393\n00:20:33.750 --> 00:20:37.400\nAnd if I choose primary,\nit lowers me a good chunk.\n\n394\n00:20:37.400 --> 00:20:39.420\nIf I choose secondary it\nlowers me a little bit.\n\n395\n00:20:39.420 --> 00:20:43.270\nSecondary is second place if\nthe primary root were to fail,\n\n396\n00:20:43.270 --> 00:20:46.520\nthe secondary would kick in so\nI could set myself as the backup for\n\n397\n00:20:46.520 --> 00:20:49.780\none and the primary for another or\nhowever I wanted that to go.\n\n398\n00:20:49.780 --> 00:20:55.007\nSo if I say, I want to be the primary and\nthen I do a show spanning\n\n399\n00:20:55.007 --> 00:21:00.653\ntree when I take a look at it I'll\nsee that my priority has dropped.\n\n400\n00:21:00.653 --> 00:21:03.684\nTo 24577 and\nthat's what I'd done before the show and\n\n401\n00:21:03.684 --> 00:21:07.370\nthat's why it was set that way so\nthis guy would become the root.\n\n402\n00:21:07.370 --> 00:21:10.990\nAnd I can see this bridge\njust became the root so\n\n403\n00:21:10.990 --> 00:21:12.970\nit's already there it's the root and\nnow it's running.\n\n404\n00:21:12.970 --> 00:21:16.030\nSo that's how we can kinda predetermine\nwho's gonna be the root bridge.\n\n405\n00:21:16.030 --> 00:21:20.280\nAll right, now the root bridge, he's gonna\nturn on all his ports and start sending\n\n406\n00:21:20.280 --> 00:21:24.610\nout BPDUs and the other switches are gonna\nstart making decisions based on it.\n\n407\n00:21:24.610 --> 00:21:30.200\n>> Yeah, now Don, is it preferable\nto use the root primary type of\n\n408\n00:21:30.200 --> 00:21:33.550\nconfiguration or\njust set the priority list yourself?\n\n409\n00:21:33.550 --> 00:21:35.260\nOr does it matter?\n\n410\n00:21:35.260 --> 00:21:37.760\n>> It's kinda up to you,\nit depends on what result you wanna get.\n\n411\n00:21:37.760 --> 00:21:42.470\nIf you want full control it's a better\nidea to set the priority yourself.\n\n412\n00:21:42.470 --> 00:21:45.470\nYou can use the alias like I did,\nor you can set the numbers.\n\n413\n00:21:45.470 --> 00:21:48.020\nIf you use the alias it's just\nsetting the number in the background.\n\n414\n00:21:48.020 --> 00:21:51.870\nIn fact if I take a look at my config,\nif I do like a show run and\n\n415\n00:21:51.870 --> 00:21:57.830\nI do any kind of a spanning tree\ncommand it just sets the number.\n\n416\n00:21:57.830 --> 00:22:01.692\nSo it doesn't even remember\nthat that root primary command.\n\n417\n00:22:01.692 --> 00:22:04.696\nIt just sets it to the number and that\nmakes it in the config, so a lot of times\n\n418\n00:22:04.696 --> 00:22:07.465\nI don't mess with the aliases I just\nput the number in there because,\n\n419\n00:22:07.465 --> 00:22:09.400\nyou memorize the numbers\neventually you know.\n\n420\n00:22:09.400 --> 00:22:12.750\nAnd you just type them in, but it's kind\nof up to you how you want to do that.\n\n421\n00:22:12.750 --> 00:22:14.360\n>> Well, I guess it all comes down to now,\n\n422\n00:22:14.360 --> 00:22:18.540\nwhat happens when you plug in a cable\ninto a spanning tree enabled switch?\n\n423\n00:22:18.540 --> 00:22:19.460\nWhat goes on?\n\n424\n00:22:19.460 --> 00:22:22.450\n>> You know, let me,\nI missed a question in the chatroom,\n\n425\n00:22:22.450 --> 00:22:25.310\nI wanna tackle that real quick before we,\nthat's a good question too.\n\n426\n00:22:25.310 --> 00:22:27.940\nWe had the question in the chatroom,\nwhen you have a root bridge,\n\n427\n00:22:27.940 --> 00:22:30.690\ndoes all traffic have to pass\nthrough the root bridge?\n\n428\n00:22:30.690 --> 00:22:32.110\nAnd the answer to that is no.\n\n429\n00:22:32.110 --> 00:22:36.500\nSo when you look at my triangle here,\nlet's say that core 1 is the root.\n\n430\n00:22:37.560 --> 00:22:40.650\nAnd I've got a PC plugged into access 1,\nand\n\n431\n00:22:40.650 --> 00:22:44.340\nit needs to get to a PC\nplugged into core 2.\n\n432\n00:22:44.340 --> 00:22:47.980\nDoes the traffic have to\ngo through the route?\n\n433\n00:22:47.980 --> 00:22:48.890\nAnd the answer is no.\n\n434\n00:22:48.890 --> 00:22:53.780\nIf I've got a connection to core two\nthat doesn't make a loop, right?\n\n435\n00:22:53.780 --> 00:22:55.320\nThat isn't shut off because of a loop.\n\n436\n00:22:55.320 --> 00:22:58.040\nThen I can go straight from\none switch to another.\n\n437\n00:22:58.040 --> 00:23:02.430\nSpanning tree doesn't actually\ninfluence the path of your traffic,\n\n438\n00:23:02.430 --> 00:23:04.840\nexcept when it shuts down\nports to block a loop.\n\n439\n00:23:04.840 --> 00:23:07.840\nSo, in my scenario,\nbecause I have a triangle.\n\n440\n00:23:07.840 --> 00:23:10.600\nYeah, all the traffics going to go\nthrough the root just because I have\n\n441\n00:23:10.600 --> 00:23:11.940\na triangle, right.\n\n442\n00:23:11.940 --> 00:23:15.610\nAnd the only way to solve a triangle\nis to kill one end of the link, and\n\n443\n00:23:15.610 --> 00:23:16.960\nnow everything's gonna\ngo through the root.\n\n444\n00:23:16.960 --> 00:23:20.771\nSo in my topology yes traffic\nwill pass through the root, but\n\n445\n00:23:20.771 --> 00:23:25.535\nin real life land,\nif your network is bigger than mine,\n\n446\n00:23:25.535 --> 00:23:27.265\ntraffic doesn't have to\npass through the root.\n\n447\n00:23:27.265 --> 00:23:28.915\nIt's not a guarantee\nthat's gonna happen and\n\n448\n00:23:28.915 --> 00:23:31.515\nthat's why the root doesn't have to\nbe in the center of your network.\n\n449\n00:23:31.515 --> 00:23:33.465\nIt usually makes sense to have it\nin the center of your network but\n\n450\n00:23:33.465 --> 00:23:35.965\nit doesn't have to be cuz the traffic\nisn't going through there.\n\n451\n00:23:35.965 --> 00:23:40.005\nBut as it starts to block loops, it might\ncreate a network like mine where you end\n\n452\n00:23:40.005 --> 00:23:44.900\nup going through the route just as a,\nnot a coincidence but as a.\n\n453\n00:23:44.900 --> 00:23:46.970\nHappenstance or whatever other\nfact that it blocked the loop.\n\n454\n00:23:46.970 --> 00:23:48.807\nSo just be aware of that\ndifferent behavior.\n\n455\n00:23:48.807 --> 00:23:51.125\nAll right.\nBut Daniel, you had a great question also.\n\n456\n00:23:51.125 --> 00:23:53.330\nWhich is, what happens when\nwe plug something new in?\n\n457\n00:23:53.330 --> 00:23:55.600\nWhen we have a topology change?\n\n458\n00:23:55.600 --> 00:23:56.459\nTopology changes happen.\n\n459\n00:23:56.459 --> 00:23:58.273\nRight?\nAnd it could be a link failing,\n\n460\n00:23:58.273 --> 00:24:02.140\nit could be a new switch coming up,\nit could be a new root getting elected.\n\n461\n00:24:02.140 --> 00:24:06.095\nBut the most common topology change we\nhave is when we plug in a new computer.\n\n462\n00:24:06.095 --> 00:24:06.617\nRight?\n\n463\n00:24:06.617 --> 00:24:10.710\nAnd when you plug in that computer,\na new port comes up and\n\n464\n00:24:10.710 --> 00:24:13.710\na new potential for a loop comes up.\n\n465\n00:24:13.710 --> 00:24:15.450\nAll right,\nnow if I'm plugging in a laptop or\n\n466\n00:24:15.450 --> 00:24:18.880\nif I'm plugging in a PC,\nI'm not creating a loop there am I?\n\n467\n00:24:18.880 --> 00:24:23.162\nBut if I'm plugging in a switch,\nI could create a loop.\n\n468\n00:24:23.162 --> 00:24:27.390\nSo spanning-tree has to watch every\nsingle port on your switch, and\n\n469\n00:24:27.390 --> 00:24:30.230\nwhen that port state changes,\nwhen it come to a up,\n\n470\n00:24:30.230 --> 00:24:33.255\nup status, spanning-tree has\nto run to check it for a loop.\n\n471\n00:24:33.255 --> 00:24:36.690\nAll right, and the default behavior\nis a little bit odd, especially for\n\n472\n00:24:36.690 --> 00:24:39.110\npeople that haven't worked with\nhigher end switches before.\n\n473\n00:24:39.110 --> 00:24:42.040\nIf you've only worked with low\nend switches, you plug a PC in\n\n474\n00:24:42.040 --> 00:24:45.600\nthat switch port, the port comes up and\nyou're communicating right then.\n\n475\n00:24:46.760 --> 00:24:47.920\nBut if you take a laptop and\n\n476\n00:24:47.920 --> 00:24:51.750\nyou plug it into a brand new Cisco switch,\nyou don't communicate.\n\n477\n00:24:51.750 --> 00:24:53.170\nIt sits there and\nyou're not on the network and\n\n478\n00:24:53.170 --> 00:24:54.450\nyou're like what the heck's going on?\n\n479\n00:24:54.450 --> 00:24:56.120\nYou start running IPConfig.\n\n480\n00:24:56.120 --> 00:24:58.420\nYou start trying to ping or IFConfig.\n\n481\n00:24:58.420 --> 00:24:59.490\nYou start troubleshooting.\n\n482\n00:24:59.490 --> 00:25:01.274\nAnd all of the student it just\nmagically starts working.\n\n483\n00:25:01.274 --> 00:25:01.958\nAll right,\n\n484\n00:25:01.958 --> 00:25:07.000\nwhat happens is the default configuration\nof spanning-tree does a hold down.\n\n485\n00:25:07.000 --> 00:25:10.900\nWhen you plug in a new port it\nholds it down for 30 seconds, and\n\n486\n00:25:10.900 --> 00:25:14.747\nduring that 30 second period,\nit's checking to see if you're a loop.\n\n487\n00:25:14.747 --> 00:25:15.350\nRight?\n\n488\n00:25:15.350 --> 00:25:19.050\nWhat it's doing is it says if this is\na loop I should be getting BPDUs from\n\n489\n00:25:19.050 --> 00:25:20.330\nthe root switch on it.\n\n490\n00:25:20.330 --> 00:25:22.530\nSo am I seeing any BPDUs?\n\n491\n00:25:22.530 --> 00:25:24.660\nIf I do, I might have a loop.\n\n492\n00:25:24.660 --> 00:25:28.220\nIf I don't, then it's just a PC,\nor a laptop, or a printer, or\n\n493\n00:25:28.220 --> 00:25:30.759\nsomething like that or\nthey're not sending me BPDUs.\n\n494\n00:25:30.759 --> 00:25:33.300\nSo, if not a loop,\nI can let the port communicate.\n\n495\n00:25:33.300 --> 00:25:36.210\nBut it'll hold it down for 30 seconds,\nyou gotta wait for that to happen.\n\n496\n00:25:36.210 --> 00:25:37.270\nAll right?\n\n497\n00:25:37.270 --> 00:25:39.790\nAnd there's actually a good bit\ngoing on behind the scenes there.\n\n498\n00:25:39.790 --> 00:25:40.440\nRight?\n\n499\n00:25:40.440 --> 00:25:44.226\nThere's five steps to\nspanning-tree protocol by default.\n\n500\n00:25:44.226 --> 00:25:49.072\nAll right, and different text books kinda\nrefer to this different ways depending on\n\n501\n00:25:49.072 --> 00:25:50.720\nhow they want to arrange it.\n\n502\n00:25:50.720 --> 00:25:54.335\nCuz one of the states is\nthat the port is disabled.\n\n503\n00:25:54.335 --> 00:25:57.383\nOkay, and that usually means\nthe port is either unplugged or\n\n504\n00:25:57.383 --> 00:25:58.953\nadministratively shut down.\n\n505\n00:25:58.953 --> 00:25:59.470\nRight?\n\n506\n00:25:59.470 --> 00:26:01.930\nSo it's not really\nparticipating in spanning-tree.\n\n507\n00:26:01.930 --> 00:26:04.830\nSome people count that as the first phase,\nsome people count that as the last phase.\n\n508\n00:26:04.830 --> 00:26:06.480\nSo it kinda changes the numbers a bit, but\n\n509\n00:26:06.480 --> 00:26:08.750\nthe other four phases\nare all pretty set in stone.\n\n510\n00:26:08.750 --> 00:26:13.006\nBut just remember, a port doesn't have to\nparticipate in spanning-tree, it could be\n\n511\n00:26:13.006 --> 00:26:16.571\ndisabled for the port, and that is\neven though it's not participating,\n\n512\n00:26:16.571 --> 00:26:20.044\nthat is kind of a state of spanning-tree,\nnot being spanning-tree.\n\n513\n00:26:20.044 --> 00:26:21.140\n>> [LAUGH]\n>> It's kinda weird.\n\n514\n00:26:21.140 --> 00:26:23.510\n>> It's a non state of\nspanning tree [LAUGH]\n\n515\n00:26:23.510 --> 00:26:25.080\n>> Choosing not to be a part\n\n516\n00:26:25.080 --> 00:26:27.440\nis being a part, so, that's what happens.\n\n517\n00:26:27.440 --> 00:26:29.690\nBut the other states\nare pretty straightforward.\n\n518\n00:26:29.690 --> 00:26:31.550\nRight?\nSo as we move through the states,\n\n519\n00:26:32.600 --> 00:26:36.840\nthe very first state you have\nis what's called Blocking.\n\n520\n00:26:36.840 --> 00:26:39.700\nBlocking means,\nit's a valid port, it works but\n\n521\n00:26:39.700 --> 00:26:41.182\nI gotta block it cuz this created a loop.\n\n522\n00:26:41.182 --> 00:26:44.966\nAll right, if it's not a loop then I'm not\ngonna block, but if the port is up and\n\n523\n00:26:44.966 --> 00:26:48.375\nI just haven't checked it or\nanything like that yet then its blocking.\n\n524\n00:26:48.375 --> 00:26:49.681\nSo, blocking is the default.\n\n525\n00:26:49.681 --> 00:26:50.990\nRight?\n\n526\n00:26:50.990 --> 00:26:53.892\nWe wanna protect ourselves from loops by\ndefault, so blocking is where we start.\n\n527\n00:26:53.892 --> 00:26:56.770\nAll right, but\nwhen you plug in a new PC and\n\n528\n00:26:56.770 --> 00:27:00.770\nthat link comes up, then we move\nin to what's called Listening.\n\n529\n00:27:00.770 --> 00:27:03.650\nFor 15 seconds we just listen.\n\n530\n00:27:04.762 --> 00:27:07.350\nWhatever is on the other end, whatever\nyou just plugged in is gonna be talking.\n\n531\n00:27:07.350 --> 00:27:08.810\nIt's gonna be saying,\nplease give me a DHCP address.\n\n532\n00:27:08.810 --> 00:27:11.350\nAnd we're just gonna ignore that,\nwe're gonna listen.\n\n533\n00:27:11.350 --> 00:27:13.799\nAnd what we're doing is\nwe're listening for BPDUs.\n\n534\n00:27:13.799 --> 00:27:18.774\nAnd we listen for 15 seconds because most\nswitches defaults every ten seconds for\n\n535\n00:27:18.774 --> 00:27:19.277\nBPDUs.\n\n536\n00:27:19.277 --> 00:27:22.737\nAll right, but some go a little bit\nlonger, so we listen for 15 seconds and\n\n537\n00:27:22.737 --> 00:27:24.154\nwe wait to see if we hear a BPDU.\n\n538\n00:27:24.154 --> 00:27:29.445\nOkay, if we hear a BPDU, now we've gotta\nlook at our network and see whether\n\n539\n00:27:29.445 --> 00:27:34.920\nthis is a loop and we need to block it, or\nif it's a better way to get to the root.\n\n540\n00:27:34.920 --> 00:27:37.380\nThis might be a better connection and\nI wanna block my other one.\n\n541\n00:27:37.380 --> 00:27:38.428\nWe have to make that decision.\n\n542\n00:27:38.428 --> 00:27:41.100\nAll right, that happens during listening.\n\n543\n00:27:41.100 --> 00:27:46.600\nIf 15 seconds pass and I don't see\nany BPDUs, then we move to learning.\n\n544\n00:27:46.600 --> 00:27:48.405\nIn the learning stage\nwe're still listening for\n\n545\n00:27:48.405 --> 00:27:50.110\nBPDUs cuz it could be they're just late.\n\n546\n00:27:50.110 --> 00:27:51.980\nRight?\nSomeone may have a really long timer.\n\n547\n00:27:51.980 --> 00:27:55.040\nSo we keep listening,\nbut now we're learning.\n\n548\n00:27:55.040 --> 00:27:57.550\nWe're learning the MAC address on\nthe other end of the link, and\n\n549\n00:27:57.550 --> 00:28:01.070\nwe take that MAC address and\nwe stick it in our arc table.\n\n550\n00:28:01.070 --> 00:28:03.088\nRight?\nBecause people are not, well, and\n\n551\n00:28:03.088 --> 00:28:06.492\nit does into arc cable at some point but\nit goes in our Mac address table first.\n\n552\n00:28:06.492 --> 00:28:07.100\nRight?\n\n553\n00:28:07.100 --> 00:28:09.930\nSo it goes in the Mac address\ncable because as a switch,\n\n554\n00:28:09.930 --> 00:28:12.010\nhow do I move traffic from port to port?\n\n555\n00:28:12.010 --> 00:28:13.370\nBy knowing the Mac addresses.\n\n556\n00:28:13.370 --> 00:28:15.115\nSo here's a great chance for\n\n557\n00:28:15.115 --> 00:28:17.265\nme to pre-populate it in\norder to be ready to rock.\n\n558\n00:28:17.265 --> 00:28:17.895\nRight?\n\n559\n00:28:17.895 --> 00:28:21.215\nAnd so, we get that loaded in,\nthat happens during the learning phase.\n\n560\n00:28:21.215 --> 00:28:22.993\nAnd the learning phase\ntakes another 15 seconds.\n\n561\n00:28:22.993 --> 00:28:23.558\nRight?\n\n562\n00:28:23.558 --> 00:28:26.858\nSo for 30 seconds, listening and\nlearning, that device,\n\n563\n00:28:26.858 --> 00:28:29.913\nwhatever it is I just plugged in,\nis not allowed to talk.\n\n564\n00:28:29.913 --> 00:28:32.775\nSo it looks like the network's down for\n30 seconds.\n\n565\n00:28:32.775 --> 00:28:36.080\nAnd then we move into the last stage,\nwhich is Forwarding.\n\n566\n00:28:36.080 --> 00:28:40.908\nWhen we get to forwarding, now we\nallow traffic to flow over the port.\n\n567\n00:28:40.908 --> 00:28:44.811\nAll right, and it can send and receive and\nthe MAC address is already in our MAC\n\n568\n00:28:44.811 --> 00:28:47.590\naddress table and\nit's a good port, it's good to go.\n\n569\n00:28:47.590 --> 00:28:51.566\nAll right, so spanning-tree is doing that\nand it's by default on every Cisco switch.\n\n570\n00:28:51.566 --> 00:28:54.005\nWhen you take that brand new\nswitch out of the box and\n\n571\n00:28:54.005 --> 00:28:55.775\nplug in you have a 30 second delay.\n\n572\n00:28:55.775 --> 00:28:58.920\nAll right, now later,\nI've already rambled on too long.\n\n573\n00:28:58.920 --> 00:29:01.540\nBut later on, I wanna show you guys some\ntechniques we can use to make that a heck\n\n574\n00:29:01.540 --> 00:29:02.630\nof a lot faster.\n\n575\n00:29:02.630 --> 00:29:04.780\nWe've got a few different ways to do that.\n\n576\n00:29:04.780 --> 00:29:05.420\nBut for right now,\n\n577\n00:29:05.420 --> 00:29:08.750\nI'm just kinda describing the default\nway that spanning-tree works.\n\n578\n00:29:08.750 --> 00:29:12.634\nSo on the exam, if they show you\na picture like my triangle topology, and\n\n579\n00:29:12.634 --> 00:29:14.683\nthey ask you who's gonna be the root?\n\n580\n00:29:14.683 --> 00:29:16.140\nYou need to be able to figure that out.\n\n581\n00:29:16.140 --> 00:29:20.430\nAnd if they ask you, you plug in a PC and\nit holds you down for 30 seconds,\n\n582\n00:29:20.430 --> 00:29:21.710\nwhat's going on there?\n\n583\n00:29:21.710 --> 00:29:24.185\nThen you know that's the standard\nspanning-tree listening and\n\n584\n00:29:24.185 --> 00:29:26.621\nlearning interval, and\nthat's kinda what's going on there.\n\n585\n00:29:26.621 --> 00:29:27.264\nAll right, so\n\n586\n00:29:27.264 --> 00:29:31.370\nthat's the basic process, and that's what\nhappens when we plug in a new device.\n\n587\n00:29:31.370 --> 00:29:32.960\n>> Awesome.\nWell obviously spanning-tree\n\n588\n00:29:32.960 --> 00:29:36.480\nis something we need to know a little\nbit about, because it can't help us out.\n\n589\n00:29:36.480 --> 00:29:38.483\nWe definitely wanna avoid those loops.\n\n590\n00:29:38.483 --> 00:29:41.972\nBut Don, we got plenty more to talk about,\nyet so little time.\n\n591\n00:29:41.972 --> 00:29:43.471\n>> [LAUGH]\n>> [LAUGH]\n\n592\n00:29:43.471 --> 00:29:45.195\n>> Well, let's break this one up.\n\n593\n00:29:45.195 --> 00:29:47.523\nThis is gonna be our new standard plan.\n\n594\n00:29:47.523 --> 00:29:49.209\nRight?\nWe'll just go into part two.\n\n595\n00:29:49.209 --> 00:29:52.001\n>> That's right,\npart two mode, the STPing.\n\n596\n00:29:52.001 --> 00:29:53.081\n>> And we have a lot of spanning-trees.\n\n597\n00:29:53.081 --> 00:29:54.352\n>> We do.\n>> So I imagine we're going to have\n\n598\n00:29:54.352 --> 00:29:54.900\na part three.\n\n599\n00:29:54.900 --> 00:29:56.154\n>> Maybe.\n>> And who knows we might go crazy and\n\n600\n00:29:56.154 --> 00:29:56.720\ndo a part four.\n\n601\n00:29:56.720 --> 00:29:57.542\n>> That's right.\nThis guy right here,\n\n602\n00:29:57.542 --> 00:29:58.264\nhe loves to talk about this stuff.\n\n603\n00:29:58.264 --> 00:30:00.900\n>> [LAUGH]\n>> So, that is very, very likely.\n\n604\n00:30:00.900 --> 00:30:02.970\nHopefully we'll see you\nguys in those episodes.\n\n605\n00:30:02.970 --> 00:30:05.068\nThat's where this one,\nwe're going to call it a close.\n\n606\n00:30:05.068 --> 00:30:08.049\nThanks for watching today,\nsigning off for ITProTV.\n\n607\n00:30:08.049 --> 00:30:09.357\nI've been your host Daniel Lowrie.\n\n608\n00:30:09.357 --> 00:30:10.384\n>> And I'm Don Pezet.\n\n609\n00:30:10.384 --> 00:30:11.597\n>> And we'll see you next time.\n\n610\n00:30:11.597 --> 00:30:18.450\n[MUSIC]\n\n",
          "vimeoId": "141104335"
        },
        {
          "description": "In this episode, Daniel and Don continue explaining the switch loop prevention system called Spanning Tree Protocol found in Cisco switches. They pick back up exploring the topic of ports; root ports, designated ports, and non-designated ports and their timers. How and why they are utilized in STP is covered and then they show STP ports and timers in action.",
          "length": "1826",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt2-100115-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt2-100115-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt2-100115-1-sm.jpg",
          "title": "Spanning Tree Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:12.708 --> 00:00:16.570\nGreetings everyone and welcome to\nanother greet episode of ITProTV.\n\n3\n00:00:16.570 --> 00:00:17.710\nI'm your host, Daniel Lowrie.\n\n4\n00:00:17.710 --> 00:00:20.320\nHere with me today none other than Mr.\nDon Pezet.\n\n5\n00:00:20.320 --> 00:00:21.130\nHow's it going, Don?\n\n6\n00:00:21.130 --> 00:00:21.969\n>> It's going great.\n\n7\n00:00:21.969 --> 00:00:25.294\nI'm excited to be back on the show and\nready to continue on with our\n\n8\n00:00:25.294 --> 00:00:28.747\nSpanning Tree Protocol adventure\nthat we started back in part one.\n\n9\n00:00:28.747 --> 00:00:32.220\nIf you're watching the shows in series,\nthen you're in the right place.\n\n10\n00:00:32.220 --> 00:00:34.690\nBut if you're just starting out,\ndefinitely check out part one because\n\n11\n00:00:34.690 --> 00:00:37.990\nthat's where we introduced you guys to\nspanning tree protocol and kinda how it\n\n12\n00:00:37.990 --> 00:00:42.010\nfunctions, what it does or how it\nkinda works with this loop prevention.\n\n13\n00:00:42.010 --> 00:00:44.440\nNow, we left off with\nthe episode yesterday,\n\n14\n00:00:44.440 --> 00:00:47.560\nwe had talked about how\na root bridge is selected.\n\n15\n00:00:47.560 --> 00:00:50.290\nAnd that's one of the first things\nthat Spanning Tree Protocol does.\n\n16\n00:00:50.290 --> 00:00:55.550\nIt's gotta pick somebody, it's gotta\npick a switch to be the guy in charge.\n\n17\n00:00:55.550 --> 00:01:00.310\nAnd then, after that, all the other\nswitches are gonna form up in line against\n\n18\n00:01:00.310 --> 00:01:04.600\nthat main controlling switch,\nand they're gonna detect loops.\n\n19\n00:01:04.600 --> 00:01:08.840\nAnd once they spot the loops,\nthey gotta shut off ports to fix that.\n\n20\n00:01:08.840 --> 00:01:12.070\nAnd I made a comment on the last show,\nI said, the root bridge,\n\n21\n00:01:12.070 --> 00:01:16.680\nthat guy never shuts off a port, unless\nyou run a cable from it right back to it.\n\n22\n00:01:16.680 --> 00:01:18.940\nIt would have to be a direct\nloop on the root bridge.\n\n23\n00:01:18.940 --> 00:01:21.950\nBut otherwise the root bridge\nnever shuts off a port.\n\n24\n00:01:21.950 --> 00:01:22.760\nEverybody else has to.\n\n25\n00:01:23.810 --> 00:01:27.300\nSo there's obviously winners and\nlosers in this equation and\n\n26\n00:01:27.300 --> 00:01:33.010\nI always think of that Mel Brooks film\nwhere he says, it's good to be the king.\n\n27\n00:01:33.010 --> 00:01:34.400\nWell, that's how it is\nwith the root bridge.\n\n28\n00:01:34.400 --> 00:01:35.830\nIt's good to be the root bridge.\n\n29\n00:01:35.830 --> 00:01:37.050\nHe never makes a mistake.\n\n30\n00:01:37.050 --> 00:01:37.985\nDon't show off any ports.\n\n31\n00:01:37.985 --> 00:01:40.528\n>> [LAUGH]\n>> But all the other guys have to, and\n\n32\n00:01:40.528 --> 00:01:43.752\nso we need to understand the mechanism\nthat's in use to figure out\n\n33\n00:01:43.752 --> 00:01:46.460\nwhich ports get left on and\nwhich ports get turned off.\n\n34\n00:01:47.620 --> 00:01:52.210\nNow, looking at my topology,\nlet me bring up my topology diagram again.\n\n35\n00:01:52.210 --> 00:01:55.920\nAnd when we look at my topology\nhere I've got three switches.\n\n36\n00:01:55.920 --> 00:01:57.970\nAnd I've got two different\nloops that are involved here.\n\n37\n00:01:59.020 --> 00:02:03.912\nI've got New York Core 1 has two links\nto New York Core 2, and those 2 links,\n\n38\n00:02:03.912 --> 00:02:06.050\nthey are gonna create a loop.\n\n39\n00:02:06.050 --> 00:02:08.930\nSo there's one loop that's\ngonna have to be resolved.\n\n40\n00:02:08.930 --> 00:02:13.170\nAnd then, I've got a bigger loop right\nhere running as a triangle between\n\n41\n00:02:13.170 --> 00:02:14.980\nthe three switches that's a loop too.\n\n42\n00:02:14.980 --> 00:02:16.940\nThat's gonna have to be resolved.\n\n43\n00:02:16.940 --> 00:02:23.410\nNow, if New York Core 1, if that's my root\nbridge he's not gonna show off any ports.\n\n44\n00:02:23.410 --> 00:02:29.418\nHe's got three ports,\ntwo of which are involved in a loop.\n\n45\n00:02:29.418 --> 00:02:33.750\nWe don't necessarily know which two, but\nat least two are involved in a loop.\n\n46\n00:02:33.750 --> 00:02:36.630\nAnd something's gotta be turned off,\nit's not gonna do it.\n\n47\n00:02:36.630 --> 00:02:39.530\nSo these other switches are gonna\nhave to make some decisions.\n\n48\n00:02:39.530 --> 00:02:44.300\nNow, technically, New York Core 2\nhere could solve all my problems.\n\n49\n00:02:44.300 --> 00:02:48.790\nThis one switch could turn off\none of these two ports here.\n\n50\n00:02:48.790 --> 00:02:52.413\nAnd it can turn off this port\nrunning down to New York Access 1.\n\n51\n00:02:52.413 --> 00:02:55.774\nIt would still have one link to the core,\nso it would still be able to communicate,\n\n52\n00:02:55.774 --> 00:02:57.340\nand the loop would be gone.\n\n53\n00:02:57.340 --> 00:02:59.230\nOne switch could solve my problem.\n\n54\n00:02:59.230 --> 00:03:01.412\nBut that's not how it always works.\n\n55\n00:03:01.412 --> 00:03:03.665\nBecause there's a lot of criteria\nthat goes into figuring out\n\n56\n00:03:03.665 --> 00:03:05.330\nwhat ports to shut off.\n\n57\n00:03:05.330 --> 00:03:09.940\nSo when spanning tree fires up step one,\nreelect a route bridge, step two,\n\n58\n00:03:09.940 --> 00:03:16.600\nall the other bridges figure out what\nis their best connection to the root.\n\n59\n00:03:16.600 --> 00:03:18.320\nThey have to know the best\nconnection to the root,\n\n60\n00:03:18.320 --> 00:03:19.272\ncuz they don't wanna shut that off.\n\n61\n00:03:19.272 --> 00:03:22.230\nWe wanna keep that best link.\n\n62\n00:03:22.230 --> 00:03:26.970\nTechnically New York Core 2 can get to\nNew York Core 1 via 3 different links.\n\n63\n00:03:26.970 --> 00:03:28.530\nIt can jump over port 23, port 24, or\n\n64\n00:03:28.530 --> 00:03:32.910\nit can go over port 22\nthrough this other switch.\n\n65\n00:03:32.910 --> 00:03:35.300\nSo how does it know which one is better?\n\n66\n00:03:35.300 --> 00:03:37.880\nWell, it uses a couple\nof different things, but\n\n67\n00:03:37.880 --> 00:03:40.050\nthe main thing it uses is\nwhat's called a port cost.\n\n68\n00:03:41.130 --> 00:03:45.150\nSpanning tree protocol assigns\na cost to every single interface.\n\n69\n00:03:45.150 --> 00:03:48.960\nAnd despite what you'll find in some\nplaces out there on the Internet,\n\n70\n00:03:48.960 --> 00:03:51.390\nthe cost number is actually arbitrary.\n\n71\n00:03:51.390 --> 00:03:55.050\nIf you ever get bored and you go and\ncrack open IEEE 802.1D and\n\n72\n00:03:55.050 --> 00:03:59.760\nstart reading through the standard,\nit's really super mega boring.\n\n73\n00:03:59.760 --> 00:04:03.400\nBut in there you'll find where\nthey give you recommendations for\n\n74\n00:04:03.400 --> 00:04:05.470\nhow the cost should be measured.\n\n75\n00:04:05.470 --> 00:04:06.930\nBut they're not rules.\n\n76\n00:04:06.930 --> 00:04:07.980\nThey're not being forced on you.\n\n77\n00:04:07.980 --> 00:04:09.467\nThey're a recommendation.\n\n78\n00:04:09.467 --> 00:04:13.364\nAnd so, vendors like Cisco and\nHP and Extreme Networks, those guys,\n\n79\n00:04:13.364 --> 00:04:15.742\nthey might choose to\nfollow those rules and\n\n80\n00:04:15.742 --> 00:04:19.330\nthey might choose to create their own and\nset their own numbers.\n\n81\n00:04:19.330 --> 00:04:21.850\nSo you don't necessarily know\nhow the costs are measured,\n\n82\n00:04:21.850 --> 00:04:24.170\nyou need to break open\nthe documentation in your switches.\n\n83\n00:04:24.170 --> 00:04:27.190\nWell, fortunately on Cisco equipment,\nit's pretty cut and dry.\n\n84\n00:04:27.190 --> 00:04:30.750\nCisco has four main cost values that\nare assigned to every interface.\n\n85\n00:04:31.850 --> 00:04:33.810\nAnd think of cost as in dollars,\n\n86\n00:04:33.810 --> 00:04:37.380\nthe less money you have to\nspend the better that link is.\n\n87\n00:04:37.380 --> 00:04:41.520\nSo a small cost is good, a high cost\nis bad when we go to pick a port.\n\n88\n00:04:42.600 --> 00:04:48.630\nNow, if you have a ten megabit port, Cisco\nassigns a just arbitrary value to it.\n\n89\n00:04:48.630 --> 00:04:50.578\nThey assign a 100.\n\n90\n00:04:50.578 --> 00:04:54.500\nSo a 10 megabit port has a cost of 100,\nthink of it like dollars.\n\n91\n00:04:54.500 --> 00:04:57.100\nSo $100, or 100 euros, or whatever.\n\n92\n00:04:57.100 --> 00:04:59.512\nSo it's got a cost of 100.\n\n93\n00:04:59.512 --> 00:05:02.972\nA 100 megabit line,\nthat's a lot faster, and so\n\n94\n00:05:02.972 --> 00:05:06.208\nit gives a 100 megabit\nline that cost of 19.\n\n95\n00:05:06.208 --> 00:05:10.450\n19 that's significant less\nthan 100 I'm gonna prefer 19.\n\n96\n00:05:10.450 --> 00:05:15.750\nIf we get to a gigabit line,\na gigabit line it gives it a cost of four.\n\n97\n00:05:15.750 --> 00:05:18.010\n4 is substantially lower than 19.\n\n98\n00:05:18.010 --> 00:05:23.630\nAnd if I have a ten gig line,\nit gives it a cost of two.\n\n99\n00:05:23.630 --> 00:05:25.680\nTwo's getting really small.\n\n100\n00:05:25.680 --> 00:05:29.039\nSo I'm gonna prefer a 10 gig\nline over a 10 meg line,\n\n101\n00:05:29.039 --> 00:05:33.326\ncuz that 10 gig line is a cost of 2 and\n10 meg line is a cost of 100,\n\n102\n00:05:33.326 --> 00:05:37.574\nworld apart as far as difference there,\nwe'll use the 10 gig line.\n\n103\n00:05:37.574 --> 00:05:39.052\nSo that cost is pretty important.\n\n104\n00:05:39.052 --> 00:05:43.290\n>> Now Don,\nI might only have a third grade education.\n\n105\n00:05:43.290 --> 00:05:45.010\nBut [LAUGH] I'm taking a look at this.\n\n106\n00:05:45.010 --> 00:05:48.720\nAnd I'm remembering back to us\nmaking bonded ports, and all that.\n\n107\n00:05:48.720 --> 00:05:52.815\nBut if I make a bonded port with 2,\n10gig lines, what, does it, like,\n\n108\n00:05:52.815 --> 00:05:54.956\njump down to 1 or 0, or-\n>> [LAUGH]\n\n109\n00:05:54.956 --> 00:05:55.707\n>> Negative 14?\n\n110\n00:05:55.707 --> 00:05:57.715\n[LAUGH]\n>> You'd think so.\n\n111\n00:05:57.715 --> 00:05:58.740\n>> [LAUGH].\n\n112\n00:05:58.740 --> 00:06:03.378\n>> But it doesn't, it actually, those\nnumbers that I just gave you guys, 100,\n\n113\n00:06:03.378 --> 00:06:04.840\n19, 4, 2.\n\n114\n00:06:04.840 --> 00:06:08.204\nThose are the default costs on\na Cisco router, I mean a Cisco switch,\n\n115\n00:06:08.204 --> 00:06:09.548\nwhatever it is this thing.\n\n116\n00:06:09.548 --> 00:06:10.665\n>> [LAUGH]\n>> [LAUGH] And so,\n\n117\n00:06:10.665 --> 00:06:13.960\nthose are the default values and\nthere really are not other values.\n\n118\n00:06:13.960 --> 00:06:18.980\nSo if you bond 2, 10 gig links together,\nthey all have a cost of 2.\n\n119\n00:06:18.980 --> 00:06:23.400\nAnd it doesn't necessarily\nwork right in a lot of cases.\n\n120\n00:06:23.400 --> 00:06:24.910\nAnd there's a couple of problems here.\n\n121\n00:06:24.910 --> 00:06:30.060\nYou guys saw when we bonded those\n100 meg lines in another episode.\n\n122\n00:06:30.060 --> 00:06:34.890\nIt actually did recalculate a number\nthat was in between 19 and 4,\n\n123\n00:06:34.890 --> 00:06:37.240\nI think it went to like 12\nwhen I put 2 of them together.\n\n124\n00:06:37.240 --> 00:06:39.180\nSo it will try and create another number.\n\n125\n00:06:39.180 --> 00:06:42.460\nWhere it gets to be a real challenge\nis when it gets to fractions.\n\n126\n00:06:42.460 --> 00:06:45.500\nThe cost is a whole number,\nnot a fraction.\n\n127\n00:06:45.500 --> 00:06:49.080\nAnd so, when you bond 2, 10 gigs,\n\n128\n00:06:49.080 --> 00:06:52.640\nit might work out perfectly,\nwhere it goes to 1, but if it doesn't,\n\n129\n00:06:52.640 --> 00:06:57.230\nit just stays at 2, and it doesn't\nnecessarily reflect differently.\n\n130\n00:06:57.230 --> 00:07:00.093\nBut let's just say for the sake of\nargument that it does cut to one.\n\n131\n00:07:00.093 --> 00:07:03.604\nAnd then, I add a 3rd ten-gig line, or\na 4th one, and then I'm up to 30 or\n\n132\n00:07:03.604 --> 00:07:05.310\n40 gigabit, it's at 1.\n\n133\n00:07:05.310 --> 00:07:06.490\nOne's the lowest we can go.\n\n134\n00:07:06.490 --> 00:07:08.162\nIt doesn't have anywhere else to go.\n\n135\n00:07:08.162 --> 00:07:12.845\nThey've kinda built in this ceiling\nbasically on bandwidth, and so\n\n136\n00:07:12.845 --> 00:07:17.947\nas time goes on they have to update it,\nand this has already happened once.\n\n137\n00:07:17.947 --> 00:07:21.685\nBack in the 1990s,\ngigabit was a pipe dream, and\n\n138\n00:07:21.685 --> 00:07:26.368\nthey're like man, one day we're\ngonna have a gigabit networks.\n\n139\n00:07:26.368 --> 00:07:29.750\nWell, in today's world it's pretty\ncommon to have all your desk tops\n\n140\n00:07:29.750 --> 00:07:30.830\nusing gig connections.\n\n141\n00:07:30.830 --> 00:07:32.290\nIt's just pretty routine.\n\n142\n00:07:32.290 --> 00:07:33.850\nWell, now we look at ten gig and\n\n143\n00:07:33.850 --> 00:07:37.580\nwe're like ooh, I love it when I get\nmy servers and my storage on ten gig.\n\n144\n00:07:37.580 --> 00:07:40.172\nThere come a day where all of our\nwork stations are on 10 gig, and\n\n145\n00:07:40.172 --> 00:07:43.541\neverybody's looking out there going,\noh, yeah, I have that new 100 gig card.\n\n146\n00:07:43.541 --> 00:07:45.490\nOr what's after a gig?\n\n147\n00:07:45.490 --> 00:07:46.230\nA terabyte?\n\n148\n00:07:46.230 --> 00:07:49.181\n>> Terabyte. Yeah, a terabyte. >> So yeah,\nI got my new ten terabyte card stuck in my\n\n149\n00:07:49.181 --> 00:07:53.916\nlaptop, and so when you get to that point\nThey'll have to adjust these numbers, and\n\n150\n00:07:53.916 --> 00:07:58.449\nby they, I don't mean I triple E because\nthey didn't tell you what numbers to use\n\n151\n00:07:58.449 --> 00:07:59.610\nin the first place.\n\n152\n00:07:59.610 --> 00:08:03.160\nThey gave you suggestions, so it's up to\nthe vendors to come up with new numbers.\n\n153\n00:08:03.160 --> 00:08:04.440\nAnd you can set the numbers yourself.\n\n154\n00:08:04.440 --> 00:08:06.180\nYou can actually jump in there and\nmodify those numbers.\n\n155\n00:08:06.180 --> 00:08:08.380\nYou can override it on any interface.\n\n156\n00:08:08.380 --> 00:08:10.800\nThese are just the defaults\nthat Cisco uses.\n\n157\n00:08:10.800 --> 00:08:12.710\nSo if we were to jump into our config,\nwe'll see those.\n\n158\n00:08:12.710 --> 00:08:14.790\nLet's take a look at it.\n\n159\n00:08:14.790 --> 00:08:17.780\nSo on this switch if I,\nI'm on my core 1 switch here and\n\n160\n00:08:17.780 --> 00:08:20.150\nso if I just jump into my config.\n\n161\n00:08:20.150 --> 00:08:21.870\nWell here, but\nbefore I even get to configuration,\n\n162\n00:08:21.870 --> 00:08:23.500\nlet's just verify what its got already.\n\n163\n00:08:23.500 --> 00:08:27.680\nIf you do a show spanning-tree,\nwhen you run that,\n\n164\n00:08:27.680 --> 00:08:31.270\nit's gonna show you your interfaces\nthat are participating in spanning tree.\n\n165\n00:08:31.270 --> 00:08:34.400\nIn other words,\ninterfaces that we've received BPDUs on.\n\n166\n00:08:34.400 --> 00:08:37.720\nAnd notice I don't see\nall 24 of my interfaces,\n\n167\n00:08:37.720 --> 00:08:41.420\nI don't even see all the interfaces that\nare up because port 12 on my switch is up,\n\n168\n00:08:41.420 --> 00:08:42.820\nI've got something plugged into it.\n\n169\n00:08:42.820 --> 00:08:46.480\nBut port 12 is not here because\nI haven't received any BPDUs.\n\n170\n00:08:46.480 --> 00:08:49.240\nSo these are ports that\nI've received BPDUs on.\n\n171\n00:08:49.240 --> 00:08:56.620\nAnd over here, I can see each port\nhas a priority and an Nbr, a number.\n\n172\n00:08:56.620 --> 00:08:57.340\nOkay?\n\n173\n00:08:57.340 --> 00:08:59.420\nAnd, what is that?\n\n174\n00:08:59.420 --> 00:09:03.540\nWell, that priority and number is\ngonna come into play here in a minute.\n\n175\n00:09:03.540 --> 00:09:07.630\nIt's basically a way of influencing\nwhich port is preferred.\n\n176\n00:09:07.630 --> 00:09:12.940\nNow, it doesn't normally come into play\nbecause cost normally solves our problem.\n\n177\n00:09:12.940 --> 00:09:14.700\nAnd if you look at my cost\ncolumn I have 19, 19, 19, 19.\n\n178\n00:09:14.700 --> 00:09:17.126\nWhat does that mean?\n\n179\n00:09:17.126 --> 00:09:20.930\nIt means I've got 400 megabit links.\n\n180\n00:09:20.930 --> 00:09:25.970\nA 100 megabit has default cost of 19 and\nso all of mine are 19.\n\n181\n00:09:25.970 --> 00:09:30.350\nBut what happens if I\nhave two connections to\n\n182\n00:09:30.350 --> 00:09:36.130\na switch and\nthey have the exact same cost?\n\n183\n00:09:36.130 --> 00:09:38.850\nAnd I have that here,\nright, port 23 and port 24,\n\n184\n00:09:38.850 --> 00:09:42.040\nthese two ports both run to core two.\n\n185\n00:09:42.040 --> 00:09:44.100\nI'm on core one, these run to core two.\n\n186\n00:09:44.100 --> 00:09:48.290\nAnd they've both got a cost of 19 so\nwhich one is better?\n\n187\n00:09:48.290 --> 00:09:52.310\nWell it comes down to\nthe priority import number.\n\n188\n00:09:52.310 --> 00:09:54.600\nThe priority is an arbitrary\nnumber that you can assign.\n\n189\n00:09:54.600 --> 00:09:56.150\nWe can go into any interface and\n\n190\n00:09:56.150 --> 00:09:59.576\nwe can use the spanning tree command\nto set the priority number and we can.\n\n191\n00:09:59.576 --> 00:10:00.810\nThe default's 128.\n\n192\n00:10:00.810 --> 00:10:03.250\nAnd it ranges from I\nbelieve it's zero to 255.\n\n193\n00:10:03.250 --> 00:10:07.040\nYou just stick in a number in there and\nit influences which one you pick.\n\n194\n00:10:07.040 --> 00:10:07.800\nAll right.\n\n195\n00:10:07.800 --> 00:10:08.810\nLower is better.\n\n196\n00:10:08.810 --> 00:10:11.350\nIf you set it to a lower priority\nit's going to get accepted,\n\n197\n00:10:11.350 --> 00:10:12.770\na higher one it won't.\n\n198\n00:10:12.770 --> 00:10:13.890\nThen the number,\n\n199\n00:10:13.890 --> 00:10:17.970\nthat's the port number, if you look at\nthese they don't quite match up, though.\n\n200\n00:10:17.970 --> 00:10:20.790\nSee how I've got port 22\nis actually number 24?\n\n201\n00:10:20.790 --> 00:10:23.129\nAnd port 24 is number 26?\n\n202\n00:10:23.129 --> 00:10:27.290\nAnd that's because spanning tree\nassigns its own arbitrary port numbers.\n\n203\n00:10:27.290 --> 00:10:32.100\nSo port number 1 is probably like my my\nVLAN 1 interface, some virtual interface,\n\n204\n00:10:32.100 --> 00:10:33.240\nthose count too.\n\n205\n00:10:33.240 --> 00:10:36.230\nAnd then I've got those gigabit\ninterfaces that are in the play, and so\n\n206\n00:10:36.230 --> 00:10:37.570\nall those get numbers too.\n\n207\n00:10:37.570 --> 00:10:40.740\nSo these numbers don't always\nmatch up with your interfaces.\n\n208\n00:10:40.740 --> 00:10:42.410\nBut they are usually in order.\n\n209\n00:10:42.410 --> 00:10:46.518\nSo when you look at a switch port 1 is\ngoing to be a lower number than port 24\n\n210\n00:10:46.518 --> 00:10:48.097\nand that's what I see here.\n\n211\n00:10:48.097 --> 00:10:51.796\nI've got like 24, 25, 26, so if there's\na full on tie breaker it'll just pick\n\n212\n00:10:51.796 --> 00:10:53.770\nthe one with the lowest port number.\n\n213\n00:10:53.770 --> 00:10:54.330\nRight.\n\n214\n00:10:54.330 --> 00:10:57.610\nSo for these two ports,\nwhen they run to the same switch,\n\n215\n00:10:57.610 --> 00:11:02.550\nit would pick port 23 over port 24\njust because of that lower number.\n\n216\n00:11:02.550 --> 00:11:06.250\nSo those are three factors that\nare involved in choosing the best adapter.\n\n217\n00:11:06.250 --> 00:11:09.300\nFirst is cost,\ncost is really the important one, and\n\n218\n00:11:09.300 --> 00:11:12.560\nthen after that is priority and\nfinally the port number.\n\n219\n00:11:12.560 --> 00:11:16.260\nAll right, now this bridge is\ncurrently the root, right.\n\n220\n00:11:16.260 --> 00:11:21.070\nSo, I'm on core one,\nit is the root bridge, I'm up and\n\n221\n00:11:21.070 --> 00:11:23.810\nI'm running, and so\neveryone should be connecting to me.\n\n222\n00:11:23.810 --> 00:11:25.660\nI shouldn't be shutting off any ports.\n\n223\n00:11:25.660 --> 00:11:29.060\nAnd I know that's happening\nbecause if I look at my topology,\n\n224\n00:11:29.060 --> 00:11:30.520\nI know I've got two loops.\n\n225\n00:11:30.520 --> 00:11:34.060\nI've got these cables here creating a\nloop, and then I've got the big triangle.\n\n226\n00:11:34.060 --> 00:11:38.280\nBut, I don't see that when I look\nat the core because it is the root.\n\n227\n00:11:38.280 --> 00:11:39.590\nRight?\nAll of its ports are up.\n\n228\n00:11:39.590 --> 00:11:43.820\nI'd have to create a loop on the root\nitself to actually have something here.\n\n229\n00:11:43.820 --> 00:11:46.740\nSo, I expect to see all of these in\nthe forwarding state and that's what I do.\n\n230\n00:11:46.740 --> 00:11:48.330\nI see them in forwarding.\n\n231\n00:11:48.330 --> 00:11:50.080\nBut, if I jump over to core two,\n\n232\n00:11:50.080 --> 00:11:52.520\nI should see things a little\nbit differently, right?\n\n233\n00:11:52.520 --> 00:11:58.130\nWhen I jump over to this guy,\nif I come in here and, let me just get\n\n234\n00:11:58.130 --> 00:12:03.430\ninto this guy, all right, and\nI do, I show spanning-tree.\n\n235\n00:12:03.430 --> 00:12:08.540\nWhen I look at this one, I can see\nright down here that he's not the root,\n\n236\n00:12:08.540 --> 00:12:09.890\nsomebody else is the root.\n\n237\n00:12:09.890 --> 00:12:17.100\nAnd If I look at the ports on 23 and 24,\nit's blocking on one of the ports, right.\n\n238\n00:12:17.100 --> 00:12:20.860\nSo it's resolved that loop and\nit resolved it by first looking at cost.\n\n239\n00:12:20.860 --> 00:12:22.130\nWho's got the better cost?\n\n240\n00:12:22.130 --> 00:12:24.010\nI'm gonna go with that port.\n\n241\n00:12:24.010 --> 00:12:26.280\nAnd then it said all right\nwell the cost is a tie.\n\n242\n00:12:26.280 --> 00:12:28.580\nLet me go to the priority,\nwho's got the better priority.\n\n243\n00:12:28.580 --> 00:12:29.330\nThat's a tie.\n\n244\n00:12:29.330 --> 00:12:33.220\nAll right, let me go to the port numbers,\n25 and 26, 25 is lower.\n\n245\n00:12:33.220 --> 00:12:35.150\nYou can't have two ports\nwith the same port number,\n\n246\n00:12:35.150 --> 00:12:39.110\nit doesn't work, so that's my tiebreaker,\nthat's your ultimate tiebreaker.\n\n247\n00:12:39.110 --> 00:12:41.920\nIt's not the greatest science\nin the world, lowest port, fine.\n\n248\n00:12:41.920 --> 00:12:43.670\nIt's kinda like going with lowest MAC.\n\n249\n00:12:43.670 --> 00:12:46.950\nFor figuring out the root bridge but\nyou gotta have something and\n\n250\n00:12:46.950 --> 00:12:48.740\nthat's a good reliable\ntie breaker right there.\n\n251\n00:12:50.220 --> 00:12:54.955\nNow, I mentioned in the topology\nthat CORE 2 could solve all my\n\n252\n00:12:54.955 --> 00:13:00.070\nproblems.I have two loops but\nCORE 2 is only solving one of my loops.\n\n253\n00:13:00.070 --> 00:13:04.800\nSo when it closes this port,\nwhen it closes port 24,\n\n254\n00:13:04.800 --> 00:13:08.730\nport 23 is still connected,\nport 22 runs down to access one.\n\n255\n00:13:08.730 --> 00:13:11.110\nAccess one has a connection\nto port 22 on core one.\n\n256\n00:13:11.110 --> 00:13:13.920\nI still have this triangle,\nI still gotta loop in the network.\n\n257\n00:13:13.920 --> 00:13:16.710\nAnd core two didn't fix that.\n\n258\n00:13:16.710 --> 00:13:17.320\nAll right.\n\n259\n00:13:17.320 --> 00:13:19.300\nSo, who did?\n\n260\n00:13:19.300 --> 00:13:22.870\nWell, hopefully access one,\notherwise I gotta loop right here.\n\n261\n00:13:22.870 --> 00:13:25.640\nYou can create a loop in your lab and not\nrealize it because you don't have traffic\n\n262\n00:13:25.640 --> 00:13:27.080\nflowing over it, so\nthe network doesn't die.\n\n263\n00:13:27.080 --> 00:13:30.420\nIn real life you notice it real fast,\nin the lab sometimes you could miss it.\n\n264\n00:13:30.420 --> 00:13:33.080\nLet's make sure that access1 is\nactually closing off that loop.\n\n265\n00:13:33.080 --> 00:13:38.510\nSo if I jump over to access1, and\nlet me just get connected to it,\n\n266\n00:13:39.610 --> 00:13:43.370\nand I'll just take a look at\nits spanning tree topology, and\n\n267\n00:13:43.370 --> 00:13:47.350\nwhen I look at it It's got\nthese two connections here.\n\n268\n00:13:47.350 --> 00:13:48.373\nWell actually it's got three, doesn't it?\n\n269\n00:13:48.373 --> 00:13:50.130\nFA0/1, 23, and 24.\n\n270\n00:13:50.130 --> 00:13:52.640\nIt's got a few different connections.\n\n271\n00:13:52.640 --> 00:13:54.410\nAnd so lemme go in my topology diagram.\n\n272\n00:13:54.410 --> 00:13:58.600\nSo 23 is running to CORE2 and\n24 is running to CORE1.\n\n273\n00:13:59.730 --> 00:14:00.330\nAll right?\n\n274\n00:14:00.330 --> 00:14:06.030\nSo, access one is not the root,\nand it is resolving the issue.\n\n275\n00:14:06.030 --> 00:14:08.000\nSee how it's blocking one of my ports?\n\n276\n00:14:08.000 --> 00:14:12.500\nAll right, so it's blocking that\nport to solve the problem, okay?\n\n277\n00:14:12.500 --> 00:14:17.540\nWell, when I look at this,\nhow did it figure out what to shut off?\n\n278\n00:14:17.540 --> 00:14:21.150\nWell, it said, all right, I got two\ndifferent ways that I can get the root.\n\n279\n00:14:21.150 --> 00:14:23.000\nThey both have a cost of 19.\n\n280\n00:14:23.000 --> 00:14:24.630\nSame cost.\n\n281\n00:14:24.630 --> 00:14:29.300\nSince the cost is the same I'm\ngonna have to go to a tie breaker.\n\n282\n00:14:29.300 --> 00:14:31.130\nAnd it goes to priority and\nthey're the same and\n\n283\n00:14:31.130 --> 00:14:35.450\nit goes down to the individual\nport number and it looks there and\n\n284\n00:14:35.450 --> 00:14:39.740\nyou'll see where it's got one a root\nport and one as an alternate port.\n\n285\n00:14:39.740 --> 00:14:43.570\nAnd so in this case what we're\nactually seeing is port 23,\n\n286\n00:14:43.570 --> 00:14:48.250\nthis one that is blocking, if I look at\nmy topology, port 23 runs over to CORE2.\n\n287\n00:14:48.250 --> 00:14:52.950\nIt doesn't run over to CORE1, okay?\n\n288\n00:14:52.950 --> 00:14:59.100\nNow, it's picking this connection\neven though the port number is higher\n\n289\n00:14:59.100 --> 00:15:03.790\nbecause this connection is directly\nconnected to the root and it knows it.\n\n290\n00:15:03.790 --> 00:15:06.960\nAnd so it's gonna pick that one cuz\nit's directly connected to the root.\n\n291\n00:15:06.960 --> 00:15:11.150\nThe other one can get us to the root but\nit goes through the other switch.\n\n292\n00:15:11.150 --> 00:15:15.980\nNow, when it did that,\nthe cost is equal on these lines.\n\n293\n00:15:15.980 --> 00:15:19.940\nSo, how did it know that one port\nwas directly connected to the root\n\n294\n00:15:19.940 --> 00:15:20.860\nversus the other?\n\n295\n00:15:20.860 --> 00:15:25.470\nBecause what happens is core\none is sending out BPDUs.\n\n296\n00:15:25.470 --> 00:15:28.840\nThe BPDUs come right down this line\nto access one and it sees them.\n\n297\n00:15:28.840 --> 00:15:33.150\nBut it's also sending the BPDU out\nthese connections to core two.\n\n298\n00:15:33.150 --> 00:15:36.200\nAnd core two is forwarding them along.\n\n299\n00:15:36.200 --> 00:15:41.080\nSo, don't I see the same BTDUs coming in?\n\n300\n00:15:41.080 --> 00:15:42.727\nWell, not exactly.\n\n301\n00:15:42.727 --> 00:15:47.793\nThat's because the cost is actually\nwhat's called an aggregate metric and\n\n302\n00:15:47.793 --> 00:15:49.693\nWhat I mean by aggregate is,\n\n303\n00:15:49.693 --> 00:15:54.538\nit's actually adding up the bandwidth\nall the way down the line, okay.\n\n304\n00:15:55.650 --> 00:16:01.910\nSo when the core sends out it's BPDUs,\nthe cost is zero, there's no cost on it.\n\n305\n00:16:01.910 --> 00:16:07.035\nAnd then when we receive the frame with\nthat BPDU, we look at our line and\n\n306\n00:16:07.035 --> 00:16:09.925\nwe say it's 100 meg, so\nI give it a cost of 19.\n\n307\n00:16:09.925 --> 00:16:14.175\nYou assign your own cost, the other\nperson doesn't tell you what the cost is.\n\n308\n00:16:14.175 --> 00:16:17.239\nYou figure it out yourself based on\nthe link that you're on, all right.\n\n309\n00:16:17.239 --> 00:16:21.001\nBut when a switch like\ncore2 forwards a BPDU,\n\n310\n00:16:21.001 --> 00:16:26.940\nit actually puts in that BPDU what\nthe original cost was from it.\n\n311\n00:16:26.940 --> 00:16:29.350\nSo that you can add them together.\n\n312\n00:16:29.350 --> 00:16:33.910\nAnd so my port, when I see my port,\nmy port's got a cost of 19.\n\n313\n00:16:33.910 --> 00:16:37.860\nBut the BPDU I'm receiving,\n\n314\n00:16:37.860 --> 00:16:41.322\nalready has a cost of 19 attached\nto it cuz it's one hop away.\n\n315\n00:16:41.322 --> 00:16:44.541\nAnd so we're actually gonna\nadd those together, and\n\n316\n00:16:44.541 --> 00:16:46.694\nnow I gotta do strange method 38.\n\n317\n00:16:46.694 --> 00:16:47.553\n>> 19 and 19 [LAUGH].\n\n318\n00:16:47.553 --> 00:16:51.500\n>> Should be 38 yeah, so\nwe end up with this cost of 38.\n\n319\n00:16:51.500 --> 00:16:53.870\nWhich is a worst cost, but\nwe don't see that here,\n\n320\n00:16:53.870 --> 00:16:57.840\nbecause when I do a show Spanning Tree,\nI'm seeing the actual port cost.\n\n321\n00:16:57.840 --> 00:17:00.830\nThat port is a 100 megabit port,\nit's got the cost of 19.\n\n322\n00:17:00.830 --> 00:17:04.820\nBut the BPD coming in already had a 19 and\n\n323\n00:17:04.820 --> 00:17:08.080\nnow it bumps up to 38 when\nI add this cost to it.\n\n324\n00:17:08.080 --> 00:17:12.720\nAnd that's why this port up here is\nthe one that's being blocked cuz\n\n325\n00:17:12.720 --> 00:17:13.930\nit's got that cost of 38.\n\n326\n00:17:13.930 --> 00:17:18.313\nAnd this one just has a cost of 19,\nall right.\n\n327\n00:17:18.313 --> 00:17:21.970\nNow this output doesn't show it,\nwe could fire up some debugs and\n\n328\n00:17:21.970 --> 00:17:22.690\nreally dig in there.\n\n329\n00:17:22.690 --> 00:17:25.730\nBut even the debugs don't show up very\nwell, so it's a hard thing to demonstrate.\n\n330\n00:17:25.730 --> 00:17:27.560\nSo that's why it's so\nimportant to remember this for\n\n331\n00:17:27.560 --> 00:17:29.660\nthe exam, it is an aggregate metric.\n\n332\n00:17:29.660 --> 00:17:32.860\nYou gotta add that up, so\nthis one link is a 19.\n\n333\n00:17:32.860 --> 00:17:36.340\nThis link is a 19,\nplus this link is a 19, so\n\n334\n00:17:36.340 --> 00:17:39.550\nthat's 38 this way\nversus only 19 this way.\n\n335\n00:17:39.550 --> 00:17:41.440\nWe prefer that direct link, all right.\n\n336\n00:17:41.440 --> 00:17:44.780\nSo every switch figures out\nthe best connection to the root and\n\n337\n00:17:44.780 --> 00:17:48.570\nthat becomes what's called\ntheir root port, all right.\n\n338\n00:17:48.570 --> 00:17:49.860\nSo looking at this switch,\n\n339\n00:17:49.860 --> 00:17:54.320\nsee how it's labeled it with that role,\nroot port, all right.\n\n340\n00:17:54.320 --> 00:17:58.220\nFor a root bridge, every port is\nwhat is called a designated port,\n\n341\n00:17:58.220 --> 00:18:02.600\na designated port means you're valid and\nready to forward traffic, all right.\n\n342\n00:18:02.600 --> 00:18:09.770\nOn a non-root bridge, you pick one root\nport, just one, so it pick this root port.\n\n343\n00:18:09.770 --> 00:18:12.642\nEvery other port gets\nflagged as designated and\n\n344\n00:18:12.642 --> 00:18:16.393\na designated port again,\njust ready to forward, all right.\n\n345\n00:18:16.393 --> 00:18:20.184\nBut after this switch picks its root port,\nso it picks this port here 24,\n\n346\n00:18:20.184 --> 00:18:22.420\nthen it makes every other port designated.\n\n347\n00:18:22.420 --> 00:18:23.740\nSo port 23 becomes designated.\n\n348\n00:18:24.810 --> 00:18:26.270\nCORE2's doing the same thing, right?\n\n349\n00:18:26.270 --> 00:18:28.830\nIt picks a root port,\neverything else becomes designated.\n\n350\n00:18:28.830 --> 00:18:32.390\nThen they start noticing the loop,\nand they say, wait a minute.\n\n351\n00:18:32.390 --> 00:18:34.800\nNow that I'm forwarding on\nthese other designated ports,\n\n352\n00:18:34.800 --> 00:18:37.620\nI'm seeing the root BPDU\ncoming in on those guys.\n\n353\n00:18:37.620 --> 00:18:39.940\nI've got a loop, we gotta resolve it.\n\n354\n00:18:39.940 --> 00:18:45.292\nSo they've gotta pick ports to transition\nfrom being designated to non-designated.\n\n355\n00:18:45.292 --> 00:18:50.110\nA non-designated port is not a root port,\nit's not designated, it's not forwarding.\n\n356\n00:18:50.110 --> 00:18:52.000\nNon-designated means it's blocking, right?\n\n357\n00:18:54.540 --> 00:18:57.100\nIn traditional Spanning Tree Protocol,\n\n358\n00:18:57.100 --> 00:19:01.120\nthat's what you have,\nCisco changes the output a little bit.\n\n359\n00:19:01.120 --> 00:19:04.240\nSo notice this blocking one here,\nit doesn't say non-designated,\n\n360\n00:19:04.240 --> 00:19:05.690\nit says alternate.\n\n361\n00:19:05.690 --> 00:19:06.820\nCisco uses that terminology and\n\n362\n00:19:06.820 --> 00:19:09.550\nwe're gonna see why when we talk\nabout a different standard called\n\n363\n00:19:09.550 --> 00:19:12.140\nRapid Spanning Tree Protocol\nwhere the alternate comes in.\n\n364\n00:19:12.140 --> 00:19:17.078\nBut this name here, alternate, when you're\nrunning ieee spanning tree like I am,\n\n365\n00:19:17.078 --> 00:19:19.180\nsee how it says ieee right up there?\n\n366\n00:19:20.180 --> 00:19:22.710\nThis alternate really means\nnon-designated, right.\n\n367\n00:19:22.710 --> 00:19:26.940\nAnd I am blocking that port and that's\nthe one that would close off the loop.\n\n368\n00:19:26.940 --> 00:19:31.510\nNow, I said earlier CORE2 could solve my\nproblem, it could solve everything, right?\n\n369\n00:19:31.510 --> 00:19:33.580\nIt could block one of these ports and\nthen this port here, and\n\n370\n00:19:33.580 --> 00:19:35.420\nthen we'd be fine, right?\n\n371\n00:19:35.420 --> 00:19:38.876\nBut it didn't,\nsomebody has to block a port, and\n\n372\n00:19:38.876 --> 00:19:43.338\nthe person who blocks the port\nis considered the loser, right?\n\n373\n00:19:43.338 --> 00:19:45.723\n>> [LAUGH]\n>> So a winner, like the king, right,\n\n374\n00:19:45.723 --> 00:19:49.140\nat the root bridge,\nhe doesn't shut off ports.\n\n375\n00:19:49.140 --> 00:19:51.930\nSo everybody else is like oh,\nI kind of wanna be like the king,\n\n376\n00:19:51.930 --> 00:19:52.820\nI don't wanna shut off any ports.\n\n377\n00:19:52.820 --> 00:19:55.060\nNo switch wants to shut off a port.\n\n378\n00:19:55.060 --> 00:19:57.330\nSo somebody has to be the loser, right?\n\n379\n00:19:57.330 --> 00:20:02.430\nAnd the loser is the exact opposite\nof the root bridge election.\n\n380\n00:20:02.430 --> 00:20:06.540\nBasically you're picking the bridge\nleast likely to become root,\n\n381\n00:20:06.540 --> 00:20:08.150\nbecause you wouldn't want\nsomebody to become the root.\n\n382\n00:20:08.150 --> 00:20:11.096\nAnd all of a sudden have to turn on ports\nand do a full recap because of it, right?\n\n383\n00:20:11.096 --> 00:20:13.182\nYour whole topology would change, so\n\n384\n00:20:13.182 --> 00:20:16.516\nthey pick the bridge that's\nthe least likely to be the root.\n\n385\n00:20:16.516 --> 00:20:18.734\nWell, remember how your root's selected,\nright?\n\n386\n00:20:18.734 --> 00:20:23.545\nIt comes down to Priority,\nthat's the number one thing, and\n\n387\n00:20:23.545 --> 00:20:27.450\nthen it moves on to do well,\nMAC address, right?\n\n388\n00:20:27.450 --> 00:20:29.790\nSo Priority and MAC address is\nwhat makes up your Bridge ID.\n\n389\n00:20:29.790 --> 00:20:34.260\nWe see that here in the output of,\nwhoops, wherever my lab is, here we go.\n\n390\n00:20:34.260 --> 00:20:38.220\nIn the output here, where you've\ngot Your Priority right here and\n\n391\n00:20:38.220 --> 00:20:41.410\nthen we've got the address and\nthose combine to form the Bridge ID.\n\n392\n00:20:41.410 --> 00:20:43.890\nSo whoever's got the lowest Bridge ID.\n\n393\n00:20:43.890 --> 00:20:47.590\nSo it looks at Priority first and\nin my network, everybody's got the same\n\n394\n00:20:47.590 --> 00:20:50.410\npriority, so that's a tie and\nthen it goes to MAC address.\n\n395\n00:20:50.410 --> 00:20:54.240\nSo, whoever has the least\nattractive MAC address,\n\n396\n00:20:54.240 --> 00:20:57.500\nis gonna be the one that shuts off a port,\nall right.\n\n397\n00:20:57.500 --> 00:21:03.362\nAnd I can see here the address for\nthis bridge, it starts with f029.\n\n398\n00:21:03.362 --> 00:21:10.760\nAnd if I go and look at CORE2,\nit starts with 08cc, 0 is lower than f.\n\n399\n00:21:10.760 --> 00:21:16.640\nSo if CORE1 were to go down, CORE2 would\nbe the next candidate to become root.\n\n400\n00:21:16.640 --> 00:21:18.310\nAccess1 is the one that's gonna\nshut that port off, all right.\n\n401\n00:21:19.488 --> 00:21:21.910\nNow if Access1 is the one\nblocking the port,\n\n402\n00:21:21.910 --> 00:21:25.310\nwhy do I see this blocked\nport here on CORE2?\n\n403\n00:21:25.310 --> 00:21:29.993\nAnd the reason here is that\nAccess1 is not involved in\n\n404\n00:21:29.993 --> 00:21:34.066\nthe loop created between the root and\nCORE2.\n\n405\n00:21:34.066 --> 00:21:36.270\nIt's gotta be somebody\ninvolved in the loop.\n\n406\n00:21:36.270 --> 00:21:40.270\nYou might have a hundred switches, but\nonly five are involved in the loop.\n\n407\n00:21:40.270 --> 00:21:44.990\nAnd those five, it's the least likely to\nbecome the root bridge of those five.\n\n408\n00:21:44.990 --> 00:21:46.804\nNot of your whole network, right?\n\n409\n00:21:46.804 --> 00:21:50.825\nThere's some switches that are on a stick,\nright, it's like one connection to them.\n\n410\n00:21:50.825 --> 00:21:53.175\nThere's no way they can block a loop,\nthere's only one way in, one way out.\n\n411\n00:21:53.175 --> 00:21:54.965\nSo those guys can't help, right?\n\n412\n00:21:54.965 --> 00:21:59.095\nSo for the exam,\nyou need to understand this process, so\n\n413\n00:21:59.095 --> 00:22:01.810\nthat they can give you\na picture like this.\n\n414\n00:22:01.810 --> 00:22:06.478\nAnd they'd probably add MAC addresses to\nit, and ask you, who is the root bridge?\n\n415\n00:22:06.478 --> 00:22:08.256\nOkay, now that you know\nwho the root bridge is,\n\n416\n00:22:08.256 --> 00:22:09.468\nwhich port is it gonna shut off?\n\n417\n00:22:09.468 --> 00:22:12.602\nAnd on the Cisco exams,\nboy they do these tricky questions.\n\n418\n00:22:12.602 --> 00:22:14.630\nWhere they'll give you a topology and\n\n419\n00:22:14.630 --> 00:22:17.840\nthey'll have four questions\ntied to that same topology.\n\n420\n00:22:17.840 --> 00:22:20.691\nWell, if you pick the wrong root bridge,\n\n421\n00:22:20.691 --> 00:22:24.036\nare you gonna pick the right\nports to be shut off?\n\n422\n00:22:24.036 --> 00:22:25.520\nNo, it kinda cascades.\n\n423\n00:22:25.520 --> 00:22:29.050\nIf you get that first answer wrong, the\nother questions are wrong, too, so it's so\n\n424\n00:22:29.050 --> 00:22:30.920\nimportant to understand\nhow this process works.\n\n425\n00:22:30.920 --> 00:22:34.280\nIt's important in real life land too, cuz\nyou might need to manipulate it, right?\n\n426\n00:22:34.280 --> 00:22:38.830\nAnd we can use the spanning tree priority\nand influence who that root bridge is.\n\n427\n00:22:38.830 --> 00:22:41.380\nWhich is gonna influence\nwho shuts off what ports.\n\n428\n00:22:41.380 --> 00:22:44.810\nOr we can use either channel to bond\nports together and eliminate that, and\n\n429\n00:22:44.810 --> 00:22:45.687\nthat kind of solves that problem, right?\n\n430\n00:22:47.100 --> 00:22:49.725\nSo those are some of the things\nthat we need to kind of look at and\n\n431\n00:22:49.725 --> 00:22:50.406\nkeep an eye on.\n\n432\n00:22:50.406 --> 00:22:53.770\nI do wanna show you one\nmore thing on ACCESS1,\n\n433\n00:22:53.770 --> 00:22:57.450\nif I take that switch and\nlet me jump back over to it.\n\n434\n00:22:58.670 --> 00:23:00.750\nSo it's got these two connections, right?\n\n435\n00:23:00.750 --> 00:23:04.470\nAnd one of them is the root port,\nthat one's up.\n\n436\n00:23:04.470 --> 00:23:06.780\nAnd the other one is this blocking port,\nthat's the one that's down, right?\n\n437\n00:23:08.050 --> 00:23:10.600\nWhat happens if my root port goes down?\n\n438\n00:23:10.600 --> 00:23:16.440\nWell, I'm gonna jump into fa0/24, that's\nmy root port, and I'm gonna shut it down.\n\n439\n00:23:17.470 --> 00:23:23.060\nOkay, when that happens,\nI'm blocking the other link,\n\n440\n00:23:23.060 --> 00:23:25.395\nI'm blocking this link right here.\n\n441\n00:23:25.395 --> 00:23:29.670\nSo I just shut off the link to CORE1,\nbut I still have my link to CORE2 but\n\n442\n00:23:29.670 --> 00:23:31.040\nI'm blocking it.\n\n443\n00:23:31.040 --> 00:23:32.120\nJust because I'm blocking it,\n\n444\n00:23:32.120 --> 00:23:34.285\ndoesn't mean it's not working,\nit'll have the link light.\n\n445\n00:23:34.285 --> 00:23:36.248\nI'm receiving traffic,\nI'm just throwing it away.\n\n446\n00:23:36.248 --> 00:23:40.699\nWell, now I can transition to\nthe listening state in spanning tree and\n\n447\n00:23:40.699 --> 00:23:42.518\nwe listen for 15 seconds.\n\n448\n00:23:42.518 --> 00:23:45.038\nAnd then, after we've listened for\n15 seconds,\n\n449\n00:23:45.038 --> 00:23:48.773\nhopefully we seen a root BPDU on there And\nwe this might be a good port.\n\n450\n00:23:48.773 --> 00:23:53.320\nAnd we listen for 15 more seconds and\nwe start populating our MAC address table.\n\n451\n00:23:53.320 --> 00:23:56.507\nAnd assuming that all that's clear,\nthen we transition to forwarding.\n\n452\n00:23:56.507 --> 00:23:57.860\nAnd now, I'm back up again.\n\n453\n00:23:59.240 --> 00:24:01.720\nNow, Daniel had a great\nquestion before the show.\n\n454\n00:24:01.720 --> 00:24:04.710\nI talked about timers in the last episode.\n\n455\n00:24:04.710 --> 00:24:08.380\nAnd I talked about the listen timer and\nthe learning timer, and\n\n456\n00:24:08.380 --> 00:24:09.310\nthen how we transition.\n\n457\n00:24:10.550 --> 00:24:12.550\nOne timer I didn't mention\nwas the blocking timer.\n\n458\n00:24:12.550 --> 00:24:15.630\nThere is a blocking timer and\nit's 20 seconds.\n\n459\n00:24:15.630 --> 00:24:17.630\nSo every 20 seconds,\n\n460\n00:24:17.630 --> 00:24:22.900\nthat port transitions from blocking to\nlistening, because the loop might be gone.\n\n461\n00:24:22.900 --> 00:24:24.710\nAnd so that factors into this too.\n\n462\n00:24:24.710 --> 00:24:28.815\nSo it might take 20 seconds for it to\neven try to listen, and then listen for\n\n463\n00:24:28.815 --> 00:24:31.463\n15 seconds, and then learn for 15 seconds.\n\n464\n00:24:31.463 --> 00:24:35.608\nIt could be a total of 50 seconds\nbefore we actually switch over and\n\n465\n00:24:35.608 --> 00:24:39.840\nbring that line active, which is\nwhy I'm talking so much right now.\n\n466\n00:24:39.840 --> 00:24:43.335\n>> [LAUGH] Just making sure everything is\ndone before he shows you the magic behind\n\n467\n00:24:43.335 --> 00:24:44.290\nthe curtain.\n\n468\n00:24:44.290 --> 00:24:48.767\n>> So if I jump back to access one, the\nconnection to the core should be dead now.\n\n469\n00:24:48.767 --> 00:24:53.480\nIt should've unblocked the connection to\ncore two to give it that connection back\n\n470\n00:24:53.480 --> 00:24:54.670\nto the root.\n\n471\n00:24:54.670 --> 00:24:58.860\nAnd if I do a show spanning tree,\nI should see that.\n\n472\n00:24:58.860 --> 00:24:59.580\nAnd sure enough, I do.\n\n473\n00:24:59.580 --> 00:25:04.590\nI see root and that it's forwarding,\nand this is on port 23.\n\n474\n00:25:04.590 --> 00:25:06.485\nSo it came up,\nit just takes it a little bit of time.\n\n475\n00:25:06.485 --> 00:25:07.940\nIt's not an instantaneous thing.\n\n476\n00:25:07.940 --> 00:25:11.210\nAnd the same thing will happen\nwhen I turn that link back on.\n\n477\n00:25:11.210 --> 00:25:13.372\nWhen I turn it on,\nit'll immediately transition to list name,\n\n478\n00:25:13.372 --> 00:25:15.270\ncuz that's what happens with a new port.\n\n479\n00:25:15.270 --> 00:25:16.706\nAnd then it will listen, and then learn.\n\n480\n00:25:16.706 --> 00:25:20.690\nAnd it'll decide that port's better, and\nit'll flip us back over to the other one.\n\n481\n00:25:20.690 --> 00:25:25.124\nSo if I were to jump back into fa0/24 and\n\n482\n00:25:25.124 --> 00:25:30.800\ndo a no shutdown,\nI could then do a show spanning tree.\n\n483\n00:25:30.800 --> 00:25:35.600\nAnd what I should see is, as soon as\nthat port comes up, which it just did.\n\n484\n00:25:35.600 --> 00:25:37.144\nIt should transition to listening.\n\n485\n00:25:37.144 --> 00:25:39.547\nAnd we're gonna sit there in listening for\n15 seconds.\n\n486\n00:25:39.547 --> 00:25:42.241\nAnd then, as soon as that's done\nwe'll transition to learning.\n\n487\n00:25:42.241 --> 00:25:45.409\nAnd I should have caught that,\nstill in listening.\n\n488\n00:25:45.409 --> 00:25:47.209\nThis is where we have to be patient.\n\n489\n00:25:47.209 --> 00:25:49.624\nOh come on, longest listening phase ever.\n\n490\n00:25:49.624 --> 00:25:51.226\n>> [LAUGH]\n>> There we go, learning.\n\n491\n00:25:51.226 --> 00:25:51.981\nSo now we're learning.\n\n492\n00:25:51.981 --> 00:25:54.582\nI see that LRN, another 15 seconds.\n\n493\n00:25:54.582 --> 00:25:58.232\nAnd then, as soon as that's done,\nif it's a better port,\n\n494\n00:25:58.232 --> 00:26:01.820\nthe one I've already got,\nwe'll transition to it.\n\n495\n00:26:01.820 --> 00:26:04.710\nIf it's not a better port,\nit will block it.\n\n496\n00:26:04.710 --> 00:26:08.500\nOkay, but\nI see how my alternates already blocking.\n\n497\n00:26:08.500 --> 00:26:09.904\nThis one's learning, but\nmy other one's blocking.\n\n498\n00:26:09.904 --> 00:26:11.590\nMy network's actually dead right now.\n\n499\n00:26:11.590 --> 00:26:13.430\nIt creates a dead time.\n\n500\n00:26:13.430 --> 00:26:17.210\nYeah, that's one of the negatives\nof the IEEE spanning-tree protocol.\n\n501\n00:26:17.210 --> 00:26:20.600\nBut as soon as that's done,\nthen it should be up and there we go.\n\n502\n00:26:20.600 --> 00:26:22.551\nAnd now my root port's forwarding, and\nI've failed back to the other line.\n\n503\n00:26:22.551 --> 00:26:23.341\nSo that's all.\n\n504\n00:26:23.341 --> 00:26:26.935\n>> Now Don, it doesn't seem\nlike a lot of time, 50 seconds.\n\n505\n00:26:26.935 --> 00:26:31.177\nThat's the maximum amount of time I might\nhave to wait before all this does its\n\n506\n00:26:31.177 --> 00:26:34.080\nmagic and everything's back to normal.\n\n507\n00:26:34.080 --> 00:26:40.920\nBut like we've just seen, it does get to\nbecome, come on can we speed this up?\n\n508\n00:26:40.920 --> 00:26:43.864\nOr the defaults just hard set and\nthat's the end of it?\n\n509\n00:26:43.864 --> 00:26:45.385\n>> There's two ways to address it.\n\n510\n00:26:45.385 --> 00:26:48.163\nSo one way is, you can adjust the timers.\n\n511\n00:26:48.163 --> 00:26:49.806\nWe can get in and tweak the timers.\n\n512\n00:26:49.806 --> 00:26:52.429\nBut you need to be careful with that.\n\n513\n00:26:52.429 --> 00:26:54.842\nBecause you really need to do it\nacross your entire environment, and\n\n514\n00:26:54.842 --> 00:26:56.306\nyou don't wanna do it on just one switch.\n\n515\n00:26:56.306 --> 00:26:58.627\nYou can, but\nit can create some really erratic results.\n\n516\n00:26:58.627 --> 00:27:00.206\nSo you really want to\nconfigure it everywhere.\n\n517\n00:27:00.206 --> 00:27:03.761\nIt also requires a little bit of science.\n\n518\n00:27:03.761 --> 00:27:05.181\nYou got to make sure you're\nleaving enough time.\n\n519\n00:27:05.181 --> 00:27:07.920\nYou gotta think about,\nhow long MAC addresses are cached for?\n\n520\n00:27:07.920 --> 00:27:10.727\nHow long your interval for BPDU's is?\n\n521\n00:27:10.727 --> 00:27:13.820\nTo make sure you get\nthese timers set right.\n\n522\n00:27:13.820 --> 00:27:17.860\nA better option is to switch to one of the\nother versions of Spanning Tree Protocol.\n\n523\n00:27:17.860 --> 00:27:20.950\nOn a Cisco router, Cisco switch,\nI keep saying router.\n\n524\n00:27:20.950 --> 00:27:26.400\nOn a Cisco switch,\nthere's usually a minimum of\n\n525\n00:27:26.400 --> 00:27:29.430\nfour spanning tree protocol\ntypes implemented.\n\n526\n00:27:29.430 --> 00:27:31.228\nThere's really five on most switches.\n\n527\n00:27:31.228 --> 00:27:33.820\nOn your really low-end ones,\nthere's usually only four.\n\n528\n00:27:33.820 --> 00:27:37.971\nBut on most of your four-digit switches,\nyou're going to have a four-digit number.\n\n529\n00:27:37.971 --> 00:27:40.496\nThis were different\ntypes of spanning tree.\n\n530\n00:27:40.496 --> 00:27:42.760\nAnd there's other types of spanning\ntree that are much faster.\n\n531\n00:27:42.760 --> 00:27:43.930\nAnd we'll see later in the series,\n\n532\n00:27:43.930 --> 00:27:45.927\nthere are other ways to treat\nthis which make it much faster.\n\n533\n00:27:45.927 --> 00:27:49.228\nBut if I want to adjust the timers I can,\nI just encourage you not to do it.\n\n534\n00:27:49.228 --> 00:27:50.935\nBut let me show you how it would be done.\n\n535\n00:27:50.935 --> 00:27:53.157\nLet's say, I jump over here to core two.\n\n536\n00:27:53.157 --> 00:27:58.251\nAnd on this switch, I decide that I\nknow more than Cisco and the IEEE.\n\n537\n00:27:58.251 --> 00:28:01.224\nSo I want to, somebody's gonna\nedit that sound byte out and\n\n538\n00:28:01.224 --> 00:28:03.375\nI'm gonna regret that the rest of my life.\n\n539\n00:28:03.375 --> 00:28:04.633\n>> [LAUGH]\n>> So I wanna go in here and\n\n540\n00:28:04.633 --> 00:28:05.533\ntweak these timers.\n\n541\n00:28:05.533 --> 00:28:06.368\nOkay.\n\n542\n00:28:06.368 --> 00:28:10.427\nSo if I wanna tweak them, we can jump in,\nwe can start to mess with that.\n\n543\n00:28:10.427 --> 00:28:13.714\nAnd it's a few different\nways we can do it.\n\n544\n00:28:13.714 --> 00:28:16.135\nIf you do, before I even get started here,\n\n545\n00:28:16.135 --> 00:28:18.974\nI'm just gonna do a show\nspanning-tree vlan 1.\n\n546\n00:28:18.974 --> 00:28:21.777\nAnd I'm gonna take a look at that output.\n\n547\n00:28:21.777 --> 00:28:26.000\nAnd in here, you can see your hello timer.\n\n548\n00:28:26.000 --> 00:28:27.960\nThat's how often your sending BPDU's.\n\n549\n00:28:27.960 --> 00:28:30.270\nThis one's sending BPDU's\nevery two seconds.\n\n550\n00:28:30.270 --> 00:28:32.840\nMaximum age, 20 seconds.\n\n551\n00:28:32.840 --> 00:28:34.567\nThat's where our blocking comes in.\n\n552\n00:28:34.567 --> 00:28:36.922\nWe're not gonna stay blocking for\nmore than 20 seconds.\n\n553\n00:28:36.922 --> 00:28:40.359\nAnd then we get forwarding delay,\n15 seconds.\n\n554\n00:28:40.359 --> 00:28:43.000\nThat's where my listening and\nlearning timers are coming from.\n\n555\n00:28:43.000 --> 00:28:46.630\nSo it's telling me the times\nthat it's using right there.\n\n556\n00:28:46.630 --> 00:28:50.094\nAnd if I don't hear BPDU's from somebody,\nbut the link is still up and healthy.\n\n557\n00:28:50.094 --> 00:28:52.914\nWell, I need to get a BPDU\nwithin a certain amount of time.\n\n558\n00:28:52.914 --> 00:28:55.460\nI get this aging of five minutes.\n\n559\n00:28:55.460 --> 00:28:56.939\nAnd so I need to hear from them.\n\n560\n00:28:56.939 --> 00:28:59.699\nIf I don't, I'm gonna assume\nthat they're a dead link now and\n\n561\n00:28:59.699 --> 00:29:01.230\nI need to pull them out.\n\n562\n00:29:01.230 --> 00:29:01.750\nOkay.\n\n563\n00:29:01.750 --> 00:29:06.390\nSo these are some of the timers that are\nbeing put in use, and we can tweak those.\n\n564\n00:29:06.390 --> 00:29:08.828\nIf we jump in and if we want to do that.\n\n565\n00:29:08.828 --> 00:29:10.168\nAgain, I don't encourage you to do it.\n\n566\n00:29:10.168 --> 00:29:15.180\nBut if you do, it's actually set as\npart of the global configuration.\n\n567\n00:29:15.180 --> 00:29:19.718\nSo we say spanning- tree, and\nthen it's on a per vlan basis.\n\n568\n00:29:19.718 --> 00:29:22.890\nSo I'm gonna say per vlan 1,\nI want to adjust the timer.\n\n569\n00:29:22.890 --> 00:29:27.930\nSo spanning-tree vlan 1, and\nif you do a question mark, let's see.\n\n570\n00:29:27.930 --> 00:29:31.306\nIf you spell spanning tree right,\nthen you can do a question mark and\n\n571\n00:29:31.306 --> 00:29:33.807\nyou'll see the different\ntimers right in there.\n\n572\n00:29:33.807 --> 00:29:36.090\nYou've got, there we go.\n\n573\n00:29:36.090 --> 00:29:39.817\nYour maximum age or\nhello time, your forward time.\n\n574\n00:29:39.817 --> 00:29:41.570\nThere's those three timers.\n\n575\n00:29:41.570 --> 00:29:42.661\nAnd so you can come in and\nyou can adjust them.\n\n576\n00:29:42.661 --> 00:29:47.306\nYou can set a shorter age,\nyou can set a faster forward time and\n\n577\n00:29:47.306 --> 00:29:49.770\nspeed that process up.\n\n578\n00:29:49.770 --> 00:29:50.894\nBut there's better ways to do it.\n\n579\n00:29:50.894 --> 00:29:54.293\nSo if they ask you on the exam\nto adjust the timers, you can.\n\n580\n00:29:54.293 --> 00:29:55.292\nHere's how you do it.\n\n581\n00:29:55.292 --> 00:29:57.069\nBut there's better ways.\n\n582\n00:29:57.069 --> 00:29:57.986\n>> Not best practice.\n\n583\n00:29:57.986 --> 00:29:59.691\n>> [INAUDIBLE]\n>> [LAUGH] All right, Don.\n\n584\n00:29:59.691 --> 00:30:02.885\nWell, I know we have a lot more to\ncover when it comes to spanning tree.\n\n585\n00:30:02.885 --> 00:30:07.160\nIt's quite a lengthy bit of a dialogue for\nus to go through.\n\n586\n00:30:07.160 --> 00:30:09.940\nAnd looking at the time where we have\ncompletely exhausted our time for\n\n587\n00:30:09.940 --> 00:30:10.890\nthis episode.\n\n588\n00:30:10.890 --> 00:30:12.648\nSo we're gonna have to make a part three,\nand\n\n589\n00:30:12.648 --> 00:30:15.438\nhopefully we'll see everybody out there,\nas well, in that episode.\n\n590\n00:30:15.438 --> 00:30:17.127\nAs for this one,\nwe're gonna call it a close.\n\n591\n00:30:17.127 --> 00:30:18.570\nThanks for watching.\n\n592\n00:30:18.570 --> 00:30:19.497\nSigning off for IT-Pro TV.\n\n593\n00:30:19.497 --> 00:30:20.937\nI've been your host Daniel Lowry.\n\n594\n00:30:20.937 --> 00:30:22.075\n>> And I'm Don Pezett.\n\n595\n00:30:22.075 --> 00:30:22.899\n>> And we'll see you next time.\n\n596\n00:30:22.899 --> 00:30:25.370\n[MUSIC]\n\n",
          "vimeoId": "141195764"
        },
        {
          "description": "In this episode, Daniel and Don explain the switch loop prevention system called Spanning Tree Protocol found in Cisco switches. Specifically called out in this episode is the different versions of Spanning Tree; explaining the why and how you might employ one over the other. They go into great detail describing PVST+, RPVST+, and MST.",
          "length": "2365",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt3-100115-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt3-100115-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt3-100115-1-sm.jpg",
          "title": "Spanning Tree Part 3",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.914 --> 00:00:12.940\nAll right.\n\n3\n00:00:12.940 --> 00:00:16.990\nGreetings everyone and welcome to\nanother exciting episode of ITProTV.\n\n4\n00:00:16.990 --> 00:00:18.310\nI'm your host, Daniel Lowry.\n\n5\n00:00:18.310 --> 00:00:21.020\nHere with me yet again today,\nis Mr. Don Pezet.\n\n6\n00:00:21.020 --> 00:00:22.430\nHow's it going, Don?\n\n7\n00:00:22.430 --> 00:00:23.320\n>> It is going well Daniel.\n\n8\n00:00:23.320 --> 00:00:26.030\nI'm always surprised you\nmaintain that happy demeanour.\n\n9\n00:00:26.030 --> 00:00:28.850\nWe're on part three of this show and\nso its starting to run on.\n\n10\n00:00:28.850 --> 00:00:31.640\nBut it's really important that we have\nthat in-depth knowledge of spanning tree\n\n11\n00:00:31.640 --> 00:00:35.780\nprotocol for the exam and\nwe're gonna be continuing with it today.\n\n12\n00:00:35.780 --> 00:00:40.286\nWe're on part three, we've already\ndone two episodes on this, but\n\n13\n00:00:40.286 --> 00:00:44.949\nthose two episodes we focused on\nthe original spanning tree protocol,\n\n14\n00:00:44.949 --> 00:00:48.385\nwhich is IEEE802.1D\nspanning tree protocol.\n\n15\n00:00:48.385 --> 00:00:53.066\nReal important to understand the original\nbecause there's actually four other\n\n16\n00:00:53.066 --> 00:00:58.440\nversions of spanning tree protocol that\nare out there that we need to be aware of.\n\n17\n00:00:58.440 --> 00:01:02.860\nThere's several different implementations\nof spanning tree protocol and\n\n18\n00:01:02.860 --> 00:01:04.290\nthey serve different purposes.\n\n19\n00:01:04.290 --> 00:01:05.730\nThey have different uses.\n\n20\n00:01:05.730 --> 00:01:11.176\nWe need to understand each so\nwe know when to use one versus the other.\n\n21\n00:01:11.176 --> 00:01:16.610\nNow the original IEEE802.1D spanning tree\nprotocol is supported by darn near every\n\n22\n00:01:16.610 --> 00:01:21.730\npiece of equipment in the planet, and with\neach additional version of spanning tree\n\n23\n00:01:21.730 --> 00:01:26.400\nprotocol, they've done a really good job\nof maintaining backwards compatibility.\n\n24\n00:01:26.400 --> 00:01:30.660\nSo as we go through this episode,\nunderstand that you can configure\n\n25\n00:01:30.660 --> 00:01:33.910\ndifferent versions of spanning tree\nprotocol in different devices and\n\n26\n00:01:33.910 --> 00:01:35.300\nthey'll still work.\n\n27\n00:01:35.300 --> 00:01:36.590\nIt just won't work well.\n\n28\n00:01:36.590 --> 00:01:39.660\nIf you wanna get the optimum\nresults out of your network,\n\n29\n00:01:39.660 --> 00:01:44.050\nyou need to run the same type of spanning\ntree across all of your equipment.\n\n30\n00:01:44.050 --> 00:01:45.520\nNow if you have all Cisco equipment,\n\n31\n00:01:45.520 --> 00:01:47.340\nyou'll be able to choose\nfrom any one of these.\n\n32\n00:01:47.340 --> 00:01:51.280\nBut if you don't have Cisco equipment,\nif you've got third-party\n\n33\n00:01:51.280 --> 00:01:54.750\nvendors kinda in the mix, you might be\nlimited in the ones you can choose.\n\n34\n00:01:54.750 --> 00:01:57.540\nAlways remember that when you go and\nimplement this in real life land.\n\n35\n00:01:57.540 --> 00:01:59.720\nOn the exam, it's all Cisco, so\nwe don't have to worry about it there,\n\n36\n00:01:59.720 --> 00:02:02.310\nbut in real life land,\nwe do have to worry about it.\n\n37\n00:02:02.310 --> 00:02:02.850\nAll right.\n\n38\n00:02:02.850 --> 00:02:08.840\nNow let's talk about the original\nspanning tree protocol, IEE802.1D.\n\n39\n00:02:08.840 --> 00:02:12.680\nWe know that basically\nit lacks a root bridge.\n\n40\n00:02:12.680 --> 00:02:16.060\nWe know that it then\nallows the other bridges,\n\n41\n00:02:16.060 --> 00:02:20.090\nthe non-root bridges to do designated and\nnon-designated ports to block loops.\n\n42\n00:02:20.090 --> 00:02:21.560\nWe know it uses priority.\n\n43\n00:02:21.560 --> 00:02:23.950\nThese are all things we've seen\nin the first couple episodes.\n\n44\n00:02:23.950 --> 00:02:26.220\nAnd it does a pretty good job of it.\n\n45\n00:02:26.220 --> 00:02:27.630\nIt blocks loops.\n\n46\n00:02:27.630 --> 00:02:29.500\nIt's really only got a couple of faults.\n\n47\n00:02:30.550 --> 00:02:32.000\nOne fault is that it's slow.\n\n48\n00:02:32.000 --> 00:02:33.700\nWe've talked about that a little bit.\n\n49\n00:02:33.700 --> 00:02:38.230\nAnd then the other fault it that,\nit doesn't necessarily play nice with\n\n50\n00:02:38.230 --> 00:02:41.400\nsuper complex networks,\nwhich we'll see here in a minute.\n\n51\n00:02:41.400 --> 00:02:44.660\nBut it does work, and it is on by default.\n\n52\n00:02:44.660 --> 00:02:47.820\nWhen I take a look at old\nnew york core one here,\n\n53\n00:02:47.820 --> 00:02:51.780\nif I take a look at this switch and\nI do a show spanning tree, and I go in and\n\n54\n00:02:51.780 --> 00:02:54.730\nI look at it, I haven't configured\nspan tree on this switch.\n\n55\n00:02:54.730 --> 00:02:58.580\nActually before I even get into that,\nlet me just show a running dash config and\n\n56\n00:02:58.580 --> 00:03:02.810\nI'm gonna filter it for\nany line including spanning tree.\n\n57\n00:03:02.810 --> 00:03:07.747\nI'm not in config so\nI don't need the old do command there.\n\n58\n00:03:07.747 --> 00:03:09.320\nLet me just just get rid of that.\n\n59\n00:03:09.320 --> 00:03:10.680\nThere we go and I'm looking for\n\n60\n00:03:10.680 --> 00:03:15.060\nany command with spanning tree and there's\na couple of command's here default.\n\n61\n00:03:15.060 --> 00:03:18.980\nThese are once that expect to see in\nto switch to switch put these in here.\n\n62\n00:03:18.980 --> 00:03:24.810\nSo with my default configuration,\nif I do a show spanning-tree,\n\n63\n00:03:24.810 --> 00:03:30.260\nwell I'm running right here,\nspanning tree enabled protocol ieee.\n\n64\n00:03:30.260 --> 00:03:33.900\nWhen they say ieee,\nwhat they're talking about is ieee 801.d,\n\n65\n00:03:33.900 --> 00:03:35.880\nthe original spanning tree protocol.\n\n66\n00:03:37.360 --> 00:03:41.310\nIt does have another name,\nyou'll hear it called CST sometimes,\n\n67\n00:03:41.310 --> 00:03:42.900\nor just Common Spanning Tree.\n\n68\n00:03:44.180 --> 00:03:47.680\nJust remember you probably won't see it\nthat way on the exam, but in real life,\n\n69\n00:03:47.680 --> 00:03:50.200\nif you hear someone talking\nabout Common Spanning Tree,\n\n70\n00:03:50.200 --> 00:03:53.569\nthey're really just talking about\nregular Spanning Tree 802.2.1 D,\n\n71\n00:03:53.569 --> 00:03:56.330\nbut because there's more than one type of\nspanning tree, it gets a little confusing.\n\n72\n00:03:56.330 --> 00:03:58.710\nSo that's why some people refer\nto it as common spanning tree.\n\n73\n00:03:58.710 --> 00:04:01.830\nBut it's not a separate protocol,\nit's just this one right here.\n\n74\n00:04:01.830 --> 00:04:04.820\n>> Now Don, I don't wanna derail\nyour little loveliness about\n\n75\n00:04:04.820 --> 00:04:07.420\nspanning tree here, but\ntake a look at your output, and\n\n76\n00:04:07.420 --> 00:04:09.810\nthere's some interesting\nthings that I'm seeing there.\n\n77\n00:04:09.810 --> 00:04:13.980\nAnd one of them is the fact that there's a\nVLAN ID there, it's talking about VLAN 1,\n\n78\n00:04:13.980 --> 00:04:17.600\nand the other is the fact\nthat the priority,\n\n79\n00:04:17.600 --> 00:04:19.120\nwe talked about the priority\nin the other show.\n\n80\n00:04:19.120 --> 00:04:23.380\nThe priority there is, and\nI wrote it down, is 32769.\n\n81\n00:04:23.380 --> 00:04:30.250\nI could've swore you said that\nthe default priority is 32768.\n\n82\n00:04:30.250 --> 00:04:33.070\nWhat's with the discrepancy and\nwhy is that VLAN layer?\n\n83\n00:04:33.070 --> 00:04:36.870\n>> Both of those questions are actually\nanswered by the same problem.\n\n84\n00:04:36.870 --> 00:04:42.630\nSo I did I said that default priority is\n32,768 and if you look at my screen, every\n\n85\n00:04:42.630 --> 00:04:48.670\ntime I said that I pointed right here to\nthis little block where it says 32,768.\n\n86\n00:04:48.670 --> 00:04:53.330\nBut if you're astute like Daniel or\nbored like Daniel, then you can look and\n\n87\n00:04:53.330 --> 00:04:55.910\nyou can see,\nI mean it's plastered all over the place.\n\n88\n00:04:55.910 --> 00:05:00.704\nBridge ID priority 32769 and then right\nup here Root ID, well I'm the root so\n\n89\n00:05:00.704 --> 00:05:01.616\nthat's mine.\n\n90\n00:05:01.616 --> 00:05:02.640\nBut you know if there\nwas a different root.\n\n91\n00:05:02.640 --> 00:05:06.160\n32769, so what the heck is going on there?\n\n92\n00:05:06.160 --> 00:05:10.950\nAnd why does it say VLAN 1 up here,\nwhat does it care what VLAN I'm on.\n\n93\n00:05:10.950 --> 00:05:15.050\nWell, the funny story\nthere is that IEEE 802.1b,\n\n94\n00:05:15.050 --> 00:05:20.440\nspanning tree protocol,\nwas written before VLANs were popular.\n\n95\n00:05:20.440 --> 00:05:25.420\nAnd at the time, VLANs were only\nreally implemented by Cisco and\n\n96\n00:05:25.420 --> 00:05:27.100\na few other experimental vendors.\n\n97\n00:05:27.100 --> 00:05:29.370\nBut nobody was really pushing\nany commercial products.\n\n98\n00:05:29.370 --> 00:05:34.860\nSo the original Spanning Tree Protocol\ndoesn't understand VLANs.\n\n99\n00:05:34.860 --> 00:05:38.020\nNow you might not think that matters,\nand maybe it doesn't.\n\n100\n00:05:38.020 --> 00:05:40.250\nIf you've only got one VLAN,\nit doesn't matter.\n\n101\n00:05:40.250 --> 00:05:43.570\nIf you're not using VLANs, technically\nyour whole network is one big VLAN.\n\n102\n00:05:43.570 --> 00:05:48.310\nOr if you're taking Cisco's switches out\nof the box, how many VLANs do they have?\n\n103\n00:05:48.310 --> 00:05:48.850\nOne.\nVLAN 1.\n\n104\n00:05:48.850 --> 00:05:50.760\nAnd that's why I see that\nnote right there, VLAN001.\n\n105\n00:05:50.760 --> 00:05:54.550\nAll my stuff's in VLAN001, and here's\nspanning-tree protocol up and running for\n\n106\n00:05:54.550 --> 00:05:57.530\nthat, very exciting.\n\n107\n00:05:57.530 --> 00:06:00.810\nBut let me kind of paint a picture for\nyou here.\n\n108\n00:06:00.810 --> 00:06:02.410\nThis is my topology.\n\n109\n00:06:02.410 --> 00:06:05.860\nAnd I've got a very obvious\nloop between CORE1 and CORE2.\n\n110\n00:06:06.930 --> 00:06:10.760\nTraffic can go across port 23 and\ncome right back across port 24.\n\n111\n00:06:10.760 --> 00:06:13.270\nIn fact any broadcast I send\nwould actually do both.\n\n112\n00:06:13.270 --> 00:06:14.648\nIt'd be looping in both directions.\n\n113\n00:06:14.648 --> 00:06:17.210\nSo that's bad.\n\n114\n00:06:17.210 --> 00:06:20.570\nSpanning tree protocol spots that and\nit shuts one of them off.\n\n115\n00:06:20.570 --> 00:06:28.120\nBut what if the first link, what if port\n23 was on VLAN1 and port 24 was on VLAN2?\n\n116\n00:06:28.120 --> 00:06:32.500\nIf those two interfaces were on\ndifferent VLANS, do I have loop?\n\n117\n00:06:33.850 --> 00:06:35.200\nNo.\nThey're different VLANS.\n\n118\n00:06:35.200 --> 00:06:38.660\nDifferent broadcast domains,\nthey're separate segments on my network,\n\n119\n00:06:38.660 --> 00:06:42.800\nit's not a loop anymore cuz I've\ncreated two virtual switches.\n\n120\n00:06:42.800 --> 00:06:44.600\nBut spanning tree doesn't know that.\n\n121\n00:06:44.600 --> 00:06:48.380\nSpanning tree protocol is called\ncommon spanning tree protocol, because\n\n122\n00:06:48.380 --> 00:06:53.680\nyou have one common instance of spanning\ntree that runs for that whole switch.\n\n123\n00:06:53.680 --> 00:06:58.650\nSo this whole switch, regardless of VLAN\nis only running one copy of Spanning Tree.\n\n124\n00:06:58.650 --> 00:07:01.910\nAnd even though one link is on VLAN2 and\nthe other link is on VLAN1,\n\n125\n00:07:01.910 --> 00:07:06.380\nit's still gonna see it as a loop and\nit's still gonna shut off a port.\n\n126\n00:07:06.380 --> 00:07:07.300\nAnd that's not good.\n\n127\n00:07:07.300 --> 00:07:09.860\nBecause that means whichever\nVLAN gets shut off,\n\n128\n00:07:09.860 --> 00:07:13.190\nit all goes back to priority and\nport number and all that good stuff.\n\n129\n00:07:13.190 --> 00:07:18.400\nWhichever one gets shut off, that's the\none that's gonna kill one of those VLANs.\n\n130\n00:07:18.400 --> 00:07:20.932\nIf VLAN3 is only on this bottom link and\n\n131\n00:07:20.932 --> 00:07:25.530\nthe bottom link is shut off\nVLAN3's not dead, it's isolated.\n\n132\n00:07:25.530 --> 00:07:26.570\nWe don't want that.\n\n133\n00:07:26.570 --> 00:07:28.680\nTha's a flaw in\nthe original spanning tree.\n\n134\n00:07:29.730 --> 00:07:32.987\nCisco was one of the early\nproponents of VLAN,\n\n135\n00:07:32.987 --> 00:07:38.416\nthey really pushed that technology\nforward and so early on, and by early on,\n\n136\n00:07:38.416 --> 00:07:42.939\nwe're talking the early 1990s,\nkind of, 20 years ago.\n\n137\n00:07:42.939 --> 00:07:44.726\n>> Back when dinosaurs run the earth.\n\n138\n00:07:44.726 --> 00:07:45.303\n[LAUGH]\n>> That's right.\n\n139\n00:07:45.303 --> 00:07:48.150\n[LAUGH] Back when television\nsitcoms were actually funny.\n\n140\n00:07:48.150 --> 00:07:53.786\nSo back then they said, all right, we need\nSpanning Tree protocol to run different,\n\n141\n00:07:53.786 --> 00:07:57.098\nbut we don't wanna break\nour existing networks.\n\n142\n00:07:57.098 --> 00:08:00.460\nAnd so, what Cisco did is,\nthey created their own protocol.\n\n143\n00:08:00.460 --> 00:08:04.721\nThey create a protocol called PVST+,\nright.\n\n144\n00:08:04.721 --> 00:08:08.830\nWhich is Per VLAN Spanning Tree Plus.\n\n145\n00:08:10.050 --> 00:08:12.950\nIt's kind of an extension\nof Spanning tree protocol.\n\n146\n00:08:12.950 --> 00:08:17.260\nAnd I hate to call PVST+ a protocol,\ncuz it really isn't.\n\n147\n00:08:17.260 --> 00:08:19.920\nAll PVST+ is, is really a policy.\n\n148\n00:08:19.920 --> 00:08:25.340\nAnd it says hey, instead of running\none copy of Spanning tree for\n\n149\n00:08:25.340 --> 00:08:32.530\nall of my VLANs, let's let each VLAN\nmaintain its own copy of Spanning tree.\n\n150\n00:08:32.530 --> 00:08:35.990\nAnd by doing that, they're now separate.\n\n151\n00:08:35.990 --> 00:08:39.210\nAnd so, it can recognize that\nwhen we look at my topology,\n\n152\n00:08:39.210 --> 00:08:42.165\nif I've got one link on VLAN 2 and\none link on VLAN 3,\n\n153\n00:08:42.165 --> 00:08:46.960\nthey're separate copies of Spanning\ntree protocol, it's not a loop.\n\n154\n00:08:46.960 --> 00:08:51.040\nAnd in fact, I can have one bridge\nbe the root for VLAN 2, and\n\n155\n00:08:51.040 --> 00:08:52.500\na different bridge be the root for\n\n156\n00:08:52.500 --> 00:08:56.260\nVLAN 3, cuz they're completely separate\ncopies of Spanning tree protocol.\n\n157\n00:08:56.260 --> 00:09:00.540\nNow the cool part is, it is still regular\nSpanning tree protocol running, but\n\n158\n00:09:00.540 --> 00:09:02.430\nit's just running once per VLAN.\n\n159\n00:09:02.430 --> 00:09:07.560\nAnd that's why when you see the output on\nmy switch here, it says I'm running ieee.\n\n160\n00:09:07.560 --> 00:09:12.805\nIt says I'm running 802.1D,\nbut I'm running it for VLAN 1.\n\n161\n00:09:13.870 --> 00:09:16.632\nIf I were to create some more VLANs,\nright?\n\n162\n00:09:16.632 --> 00:09:21.782\nSo let's say I jump into my config,\nlet's see I'll need to\n\n163\n00:09:21.782 --> 00:09:28.376\nturn some ports up here to get this\nkind of working, we'll make some ports.\n\n164\n00:09:28.376 --> 00:09:29.125\nDo I have a trunk?\n\n165\n00:09:29.125 --> 00:09:30.338\nI think I have a trunk somewhere.\n\n166\n00:09:30.338 --> 00:09:32.201\nSo, I'll hit the trunk, it'll be fine.\n\n167\n00:09:32.201 --> 00:09:34.140\nAll right, so I'm gonna create VLAN 2.\n\n168\n00:09:34.140 --> 00:09:36.280\nAnd maybe that's marketing.\n\n169\n00:09:36.280 --> 00:09:40.275\nI can do VLAN 3, which I'll name Sales.\n\n170\n00:09:40.275 --> 00:09:44.545\nVLAN 4, we can name that Research.\n\n171\n00:09:44.545 --> 00:09:45.955\nSo, I'm starting to create VLANs.\n\n172\n00:09:47.335 --> 00:09:52.840\nAnd as long as the VLAN has\nat least one active port,\n\n173\n00:09:54.050 --> 00:09:57.100\nthen my switch is gonna run another\ncopy of Spanning tree for it.\n\n174\n00:09:57.100 --> 00:09:58.010\nYou have to have an active port.\n\n175\n00:09:58.010 --> 00:10:00.470\nNow if you have a trunk,\nthe trunk counts as the active port.\n\n176\n00:10:00.470 --> 00:10:03.820\nThat's why I was mumbling there\nabout trunks a second ago.\n\n177\n00:10:03.820 --> 00:10:05.220\nAs long as I have that, it'll come up.\n\n178\n00:10:05.220 --> 00:10:07.965\nOtherwise, I have to have at least one\nphysical interface that's tied to that\n\n179\n00:10:07.965 --> 00:10:09.300\nVLAN to bring this up.\n\n180\n00:10:09.300 --> 00:10:13.100\nBut when you do, it'll come up, and\nit'll start running Spanning trees.\n\n181\n00:10:13.100 --> 00:10:18.018\nSo if I do a show interface trunk,\n\n182\n00:10:18.018 --> 00:10:22.430\nI'm just gonna make sure.\n\n183\n00:10:22.430 --> 00:10:24.130\nAlright I do have a trunk, Port 22.\n\n184\n00:10:24.130 --> 00:10:26.580\nAnd see how it's moving VLANS 1 through 3.\n\n185\n00:10:26.580 --> 00:10:28.670\nSo I've got three active VLANs right now.\n\n186\n00:10:28.670 --> 00:10:34.262\nSo if I do a show spanning-tree, I'm gonna\nsee basically the same output, right.\n\n187\n00:10:34.262 --> 00:10:36.880\nHere's VLAN 1, I'm running ieee.\n\n188\n00:10:36.880 --> 00:10:41.270\nBut if I hit my space bar,\nthen I'll see here's VLAN 2,\n\n189\n00:10:41.270 --> 00:10:45.240\nand it's running ieee, and then I'm\nrunning VLAN 3, and it's running ieee.\n\n190\n00:10:45.240 --> 00:10:50.030\nI've got separate instances of Spanning\ntree protocol running, all right?\n\n191\n00:10:50.030 --> 00:10:52.010\nOne for each VLAN.\n\n192\n00:10:52.010 --> 00:10:56.130\nNow, I didn't have to turn that on, your\nCisco switch is running it by default.\n\n193\n00:10:56.130 --> 00:11:00.020\nYour Cisco switch actually can't run\nin common Spanning tree, or at least\n\n194\n00:11:00.020 --> 00:11:03.760\nnot the new ones, the older ones could,\nbut your new ones really just can't.\n\n195\n00:11:03.760 --> 00:11:06.470\nIf you want to run a common Spanning tree,\nthen you need one VLAN.\n\n196\n00:11:06.470 --> 00:11:10.350\nIf you just have VLAN 1, then you're now\ncommon and that's the end of it, right.\n\n197\n00:11:10.350 --> 00:11:12.330\nBut, if you have multiple VLANs,\n\n198\n00:11:12.330 --> 00:11:15.610\nyou're running separate copies of\nSpanning tree protocol, right.\n\n199\n00:11:15.610 --> 00:11:18.517\nSo, this is up, it's going,\nand it's running well.\n\n200\n00:11:18.517 --> 00:11:21.119\nNow, there's positives here, right.\n\n201\n00:11:21.119 --> 00:11:23.700\nIt's gonna be more accurate on\nthe network, but there's negatives too.\n\n202\n00:11:23.700 --> 00:11:28.630\nFor example, one negative is,\nit is Cisco proprietary.\n\n203\n00:11:28.630 --> 00:11:31.370\nSo, if I have third party equipment,\nthey don't support this.\n\n204\n00:11:31.370 --> 00:11:35.150\nSo there gonna be running common Spanning\ntree, here I'm running separate ones.\n\n205\n00:11:35.150 --> 00:11:38.110\nSo my Cisco switches are gonna make better\ndecisions than my third party equipment\n\n206\n00:11:38.110 --> 00:11:39.810\nand your network can end up kinda weird.\n\n207\n00:11:39.810 --> 00:11:41.940\nSo you gotta be careful there, right.\n\n208\n00:11:41.940 --> 00:11:44.400\nThe other problem is performance.\n\n209\n00:11:44.400 --> 00:11:47.960\nI got three VLANs, I'm running three\ncopies of Spanning tree protocol.\n\n210\n00:11:47.960 --> 00:11:52.640\nThe more VLANs I run, the more copies\nof Spanning tree protocol I'm running.\n\n211\n00:11:52.640 --> 00:11:56.790\nThe more BPDUs I'm sending out every\ntwo seconds here by default, right.\n\n212\n00:11:56.790 --> 00:11:58.310\nSo the more traffic I'm generating.\n\n213\n00:11:58.310 --> 00:12:01.050\nAnd that can be a problem in and\nof itself, right?\n\n214\n00:12:01.050 --> 00:12:02.490\nSo we need to be aware of that.\n\n215\n00:12:02.490 --> 00:12:03.810\nIt's Cisco proprietary,\n\n216\n00:12:03.810 --> 00:12:09.200\nand it can create a bit of a performance\nconcern on lower end hardware.\n\n217\n00:12:09.200 --> 00:12:11.970\n>> Now Don, it has some performance\nissues as you said, and\n\n218\n00:12:11.970 --> 00:12:13.270\nit's proprietary to Cisco.\n\n219\n00:12:13.270 --> 00:12:17.210\nIs there any configuration changes that we\ncan make to maybe boost that performance?\n\n220\n00:12:17.210 --> 00:12:20.290\nOr, is there anything we can\ndo to help out our situation?\n\n221\n00:12:20.290 --> 00:12:24.650\n>> All right so, there's a funny\nstory attached to this, right.\n\n222\n00:12:24.650 --> 00:12:32.131\nNormally when Cisco looks at a protocol\nand they want to make it better, right.\n\n223\n00:12:32.131 --> 00:12:33.994\nJust look at trunking in the beginning.\n\n224\n00:12:33.994 --> 00:12:36.879\nOr EtherChannel is a great example.\n\n225\n00:12:36.879 --> 00:12:40.483\nSo Cisco bought EtherChannel, and they\nmade it where they could bond these links\n\n226\n00:12:40.483 --> 00:12:43.293\ntogether, and they created that\nport aggregation protocol.\n\n227\n00:12:43.293 --> 00:12:45.894\nAnd then they turned around and\nthey worked with IEEE.\n\n228\n00:12:45.894 --> 00:12:48.774\nAnd they worked to create LACP,\nthe link aggregation and\n\n229\n00:12:48.774 --> 00:12:51.132\ncontrol protocol which\nwas an open standard.\n\n230\n00:12:51.132 --> 00:12:54.560\nSo Cisco always tries to get things,\nI shouldn't say always right EIGRP,\n\n231\n00:12:54.560 --> 00:12:55.350\nthey don't try it all.\n\n232\n00:12:55.350 --> 00:12:58.390\nBut other things they do try to\npush through with the IEEE, so\n\n233\n00:12:58.390 --> 00:12:59.950\nthat everybody can use it.\n\n234\n00:12:59.950 --> 00:13:03.610\nAnd for this Cisco thought it was\na great technology, they said boy, we\n\n235\n00:13:03.610 --> 00:13:08.190\nreally need to get people using VLANs, we\nreally need to have smart Spanning tree.\n\n236\n00:13:08.190 --> 00:13:10.380\nWe really need to get other\nvendors doing this too.\n\n237\n00:13:10.380 --> 00:13:13.320\nAnd we think it's so important,\nwe're ready to give it away.\n\n238\n00:13:13.320 --> 00:13:16.460\nAnd so, Cisco pushed this\nthrough the IEEE saying come on,\n\n239\n00:13:16.460 --> 00:13:18.110\nyou guys got to support it.\n\n240\n00:13:18.110 --> 00:13:20.290\nWell, Cisco's not the only\nperson in the IEEE.\n\n241\n00:13:20.290 --> 00:13:23.210\nWell, they are big, there's plenty of\nother big companies in there too, and\n\n242\n00:13:23.210 --> 00:13:25.390\nthe other guys,\nthis was back in the 1990s, right?\n\n243\n00:13:25.390 --> 00:13:31.450\nBack then they said, you know, Cisco, you\nguys put some really high end processors\n\n244\n00:13:31.450 --> 00:13:35.045\nin your stuff, and you can handle running\nall those Spanning tree instances.\n\n245\n00:13:36.075 --> 00:13:39.305\nBut we kind of use the cheap stuff and\nour switches can't handle it.\n\n246\n00:13:39.305 --> 00:13:42.094\nOur switches can't do this,\nand we do not want that.\n\n247\n00:13:42.094 --> 00:13:45.477\nThird parties,\nmost of which are out of business now.\n\n248\n00:13:45.477 --> 00:13:47.600\nBut the third party is in question here.\n\n249\n00:13:47.600 --> 00:13:50.280\nThey didn't want to put the hardware\nin there to support it.\n\n250\n00:13:50.280 --> 00:13:52.480\nAnd so the IEEE said no,\nwe're not gonna do it.\n\n251\n00:13:52.480 --> 00:13:56.340\nIt's one of those few occasions where\nthey don't take something for free.\n\n252\n00:13:56.340 --> 00:13:59.100\nSo, they said no, we're not gonna do it,\nnot enough people support it.\n\n253\n00:13:59.100 --> 00:14:00.830\nCisco was going back and\nforth with them over the years.\n\n254\n00:14:00.830 --> 00:14:02.010\nWe're gonna see this recurring.\n\n255\n00:14:02.010 --> 00:14:04.850\nIt's the reason why we have five\ndifferent choices for Spanning tree here.\n\n256\n00:14:04.850 --> 00:14:08.850\nIs that Cisco and the IEEE have never\nsynced up on this VLAN thing, right.\n\n257\n00:14:08.850 --> 00:14:13.080\nSo what the IEEE did is,\nthey finally later on down the line said,\n\n258\n00:14:13.080 --> 00:14:15.820\nokay, all right,\nwe understand this VLAN stuff,\n\n259\n00:14:15.820 --> 00:14:18.110\nwe understand it's important we\nunderstand it's not going away.\n\n260\n00:14:18.110 --> 00:14:20.830\nBut we just can't run that\nmany copies of Spanning tree.\n\n261\n00:14:20.830 --> 00:14:23.333\nSo, they created an IEEE standard.\n\n262\n00:14:23.333 --> 00:14:27.910\nIt's 802.1s, Multiple Spanning Tree, MST.\n\n263\n00:14:27.910 --> 00:14:33.090\nAnd what MST does,\nis it creates like a middle ground between\n\n264\n00:14:33.090 --> 00:14:35.970\ncommon Spanning tree and\nPer VLAN Spanning tree.\n\n265\n00:14:35.970 --> 00:14:39.350\nAnd what it does is it basically says,\nall right, we're gonna allow you to create\n\n266\n00:14:39.350 --> 00:14:44.540\na spanning tree instance, and\nattach more than one VLAN to it.\n\n267\n00:14:44.540 --> 00:14:46.470\nSo that you can pick and choose.\n\n268\n00:14:46.470 --> 00:14:50.280\nIf you wanna run one copy of Spanning\ntree for each VLAN, you can.\n\n269\n00:14:50.280 --> 00:14:53.930\nBut if you wanna put four\nVLANs in one Spanning tree and\n\n270\n00:14:53.930 --> 00:14:56.420\nfour more in another Spanning tree,\nyou can.\n\n271\n00:14:56.420 --> 00:15:02.160\nAnd now you've got eight VLANs, but\nonly two instances of Spanning tree.\n\n272\n00:15:02.160 --> 00:15:03.750\nIt's a middle ground, right.\n\n273\n00:15:03.750 --> 00:15:06.490\nAnd it's the best that Cisco\nwas able to get, and so\n\n274\n00:15:06.490 --> 00:15:08.210\nthat's where it kinda ended up.\n\n275\n00:15:08.210 --> 00:15:11.250\nSo if we want to go IEEE standard, but\n\n276\n00:15:11.250 --> 00:15:15.858\nstill want to have flexibility with\nour VLANs, MST is the way to go.\n\n277\n00:15:15.858 --> 00:15:20.350\nNow, MST itself does require resources,\nand\n\n278\n00:15:20.350 --> 00:15:24.212\nit's not the greatest for performance,\nIEEE didn't do us a ton of favors here.\n\n279\n00:15:24.212 --> 00:15:26.570\nBut it is supported by a lot of vendors.\n\n280\n00:15:26.570 --> 00:15:30.970\nOn Cisco equipment, it's not supported\non some of the lower end switches.\n\n281\n00:15:30.970 --> 00:15:34.156\nBut if you're on a 2960 or\nhigher you should have MST support, and\n\n282\n00:15:34.156 --> 00:15:36.264\nyou can go in and\nyou can turn that on and use it.\n\n283\n00:15:36.264 --> 00:15:41.050\nIf you're an all Cisco shop,\nstick with Per VLAN, stick with PVST+.\n\n284\n00:15:41.050 --> 00:15:44.100\nAnd that is the default here,\nwhen I look at this switch, yeah,\n\n285\n00:15:44.100 --> 00:15:48.330\nit's telling me IEEE, but remember\nthe command that I saw in my config?\n\n286\n00:15:48.330 --> 00:15:53.011\nIf I do show run, and\nI filter that for spanning-tree,\n\n287\n00:15:53.011 --> 00:15:59.798\nthat there was a default command in there\nthat said, spanning-tree mode PVST.\n\n288\n00:15:59.798 --> 00:16:02.690\nThat's that Per VLAN, so I'm in that mode.\n\n289\n00:16:02.690 --> 00:16:05.549\nI forgot to double back on why\nthe priority number was wrong.\n\n290\n00:16:05.549 --> 00:16:07.136\nYou answered the priority number.\n\n291\n00:16:07.136 --> 00:16:10.790\nHow does Spanning Tree know to\nrun on these separate VLANs,\n\n292\n00:16:10.790 --> 00:16:13.920\nI'm sending out BPDU's, how does it know?\n\n293\n00:16:13.920 --> 00:16:15.940\nWell it's not part of the standard.\n\n294\n00:16:15.940 --> 00:16:18.624\nIf we're gonna do backwards\ncompatible with other people,\n\n295\n00:16:18.624 --> 00:16:22.058\nI can't send another VLAN number if\nother people don't know what the VLANs.\n\n296\n00:16:22.058 --> 00:16:28.340\nSo what Cisco does is they nest\nthe VLAN number in with the priority.\n\n297\n00:16:28.340 --> 00:16:32.660\nSo if you look at the output here,\nif I do a show Spanning Tree and\n\n298\n00:16:32.660 --> 00:16:36.420\nwe take a look at it,\nmy priority is 32,768,\n\n299\n00:16:36.420 --> 00:16:42.030\nbut my actual priority is 32,769,\n\n300\n00:16:42.030 --> 00:16:46.470\nthat is the priority number\nplus the VLAN number.\n\n301\n00:16:46.470 --> 00:16:51.484\nThis is VLAN1, so 32,768 plus one is\n32,769 that's what I advertised and\n\n302\n00:16:51.484 --> 00:16:53.870\nCisco calls that the extended system ID.\n\n303\n00:16:55.250 --> 00:17:01.200\nNow it's important to remember\nthat the priority number is,\n\n304\n00:17:01.200 --> 00:17:03.870\nif I remember right, it's a 16 bit number.\n\n305\n00:17:03.870 --> 00:17:05.690\nIt's one through 65,534.\n\n306\n00:17:07.610 --> 00:17:10.370\nSo when Cisco adds this VLAN to it,\n\n307\n00:17:10.370 --> 00:17:14.840\nthey've gotta be able to keep it separate,\nbut a VLAN could be 1 through 4,094.\n\n308\n00:17:14.840 --> 00:17:18.820\nSo what Cisco had to do is they\nactually had to steal four bits from\n\n309\n00:17:18.820 --> 00:17:24.550\nthe 16 bit number, only leaving 12\nbits left over for the priorities.\n\n310\n00:17:24.550 --> 00:17:27.810\nIt kind of messed up the way\nthe numbering works.\n\n311\n00:17:27.810 --> 00:17:30.310\nOn a Cisco switch when\nyou set the priority,\n\n312\n00:17:30.310 --> 00:17:32.990\nyou can't just set the priority\nto whatever you want it.\n\n313\n00:17:32.990 --> 00:17:38.680\nIt has to be something that\nis divisible by 4,096.\n\n314\n00:17:38.680 --> 00:17:43.139\nBecause we took those 4,094 bits away,\nor those values away,\n\n315\n00:17:43.139 --> 00:17:48.470\nto get the view in number, the priority\nis left with what's after that.\n\n316\n00:17:48.470 --> 00:17:51.400\nAs we start to set our priorities,\nif you try and\n\n317\n00:17:51.400 --> 00:17:56.020\nset a number that's not accurate, the\nswitch hold will complain and correct you.\n\n318\n00:17:56.020 --> 00:18:01.170\nBut as I continue down here on my output\nI'm on VLAN1 and then down here is VLAN2.\n\n319\n00:18:01.170 --> 00:18:02.800\nMy priority is 32,768.\n\n320\n00:18:02.800 --> 00:18:06.080\nWe add two to it and it becomes 32,770.\n\n321\n00:18:06.080 --> 00:18:09.870\nSo it's adding that VLAN number\nto whatever your priority is.\n\n322\n00:18:09.870 --> 00:18:11.940\nThat's why those numbers don't match up,\n\n323\n00:18:11.940 --> 00:18:15.490\nbecause Cisco is trying to track\nthe VLAN number in the priority.\n\n324\n00:18:15.490 --> 00:18:18.210\nAnd that keeps us compatible with\nthird party hosts cuz they just think\n\n325\n00:18:18.210 --> 00:18:18.860\nthat's our priority.\n\n326\n00:18:18.860 --> 00:18:20.400\nLike, all right that's a priority number.\n\n327\n00:18:20.400 --> 00:18:21.980\nThey don't realize there's\na VLAN in there and\n\n328\n00:18:21.980 --> 00:18:24.490\ntheir common Spanning Tree can handle it.\n\n329\n00:18:24.490 --> 00:18:29.390\nBut if I jump into my config and\nI do spanning-tree\n\n330\n00:18:29.390 --> 00:18:33.240\nvlan 2 priority and\nI go to set my priority.\n\n331\n00:18:34.890 --> 00:18:40.206\nSee how it says 0-61440 bridge\npriority in increments of 4096.\n\n332\n00:18:40.206 --> 00:18:44.140\nIf I try to set it to 5000,\nit's not gonna like that.\n\n333\n00:18:44.140 --> 00:18:48.140\nAnd then it gives me all\nthe increments of 4096.\n\n334\n00:18:48.140 --> 00:18:50.110\nWe really only need three priorities.\n\n335\n00:18:50.110 --> 00:18:54.060\nOne for all of our switches, one for\nour back-up and one for our root.\n\n336\n00:18:54.060 --> 00:18:55.010\nThat's really all you need.\n\n337\n00:18:55.010 --> 00:18:55.970\nYou only need three.\n\n338\n00:18:55.970 --> 00:18:59.110\nSo Cisco left us with,\nwhat is that, like 12?\n\n339\n00:18:59.110 --> 00:19:02.140\nSo you got a bunch of them there to\npick from, and that works out fine.\n\n340\n00:19:02.140 --> 00:19:03.940\nAnd it leaves room for the VLAN.\n\n341\n00:19:03.940 --> 00:19:07.230\nSo there we're kind of covered and\nwe've got that.\n\n342\n00:19:07.230 --> 00:19:12.770\nSo Rick in the chat room just mentioned\nthere, so I had that backwards.\n\n343\n00:19:12.770 --> 00:19:14.950\nSo we've only got four bits for\nthe priority,\n\n344\n00:19:14.950 --> 00:19:18.480\nwhich is why we're left with\njust these 12 or 14 numbers, and\n\n345\n00:19:18.480 --> 00:19:21.850\nwe've got 12 bits for\nthe VLAN to get us one through 4,094.\n\n346\n00:19:21.850 --> 00:19:22.470\nThanks, Rick.\n\n347\n00:19:22.470 --> 00:19:24.120\nYeah, I do have that backwards.\n\n348\n00:19:24.120 --> 00:19:24.745\n>> Good catch, sir.\n\n349\n00:19:24.745 --> 00:19:29.780\n>> [LAUGH] All right, so\nthat's the difference of per VLAN and\n\n350\n00:19:29.780 --> 00:19:34.260\nif I want to go MST,\nMST is different because MST is\n\n351\n00:19:34.260 --> 00:19:37.390\nactually aware of the VLANs and\nit can see that kind of stuff.\n\n352\n00:19:37.390 --> 00:19:41.390\nAnd so if I want to convert over to MST,\nthere's a few things that I have to do.\n\n353\n00:19:41.390 --> 00:19:46.120\nMST's configuration is really weird,\nbecause I have to create the instances and\n\n354\n00:19:46.120 --> 00:19:49.180\nthen I have to attach my\nVLAN's to the instances.\n\n355\n00:19:49.180 --> 00:19:51.890\nAnd how many VLAN's do I have.\n\n356\n00:19:51.890 --> 00:19:54.290\nI created, I got four.\n\n357\n00:19:54.290 --> 00:19:58.260\nSo I'm gonna create two\ninstances of MST and\n\n358\n00:19:58.260 --> 00:20:00.600\nI'll attach VLAN's one and\ntwo to the first instance and\n\n359\n00:20:00.600 --> 00:20:04.290\nI'll attach VLAN's three and four to the\nsecond instance and we'll be up and going.\n\n360\n00:20:04.290 --> 00:20:08.270\nSo if I want to do that, I've got to\nstart off by switching to that mode.\n\n361\n00:20:08.270 --> 00:20:14.070\nSo I'm going to stay\nspanning-tree mode mst.\n\n362\n00:20:14.070 --> 00:20:15.470\nNow your switch may not support it, so\n\n363\n00:20:15.470 --> 00:20:18.410\nit's a good idea to do a question\nmark there and see if MST shows up.\n\n364\n00:20:18.410 --> 00:20:19.520\nAnd I can see that I've got it.\n\n365\n00:20:19.520 --> 00:20:20.110\nRight.\n\n366\n00:20:20.110 --> 00:20:21.960\nNot every switch does.\n\n367\n00:20:21.960 --> 00:20:28.650\nNow I'm switched over to MST, but\nall my VLANs, what are they attached to?\n\n368\n00:20:28.650 --> 00:20:30.240\nWell I haven't really\nattached them to anything so\n\n369\n00:20:30.240 --> 00:20:31.390\nsome weird stuff is gonna happen.\n\n370\n00:20:31.390 --> 00:20:32.930\nSee my porch just went down?\n\n371\n00:20:32.930 --> 00:20:35.110\nAnd so I need to get this\nconfiguration put in kinda quickly.\n\n372\n00:20:35.110 --> 00:20:36.900\nI need a plan for downtime.\n\n373\n00:20:36.900 --> 00:20:40.740\nSo the next thing I'm gonna do is I\nneed to get into my MST configuration.\n\n374\n00:20:40.740 --> 00:20:44.498\nAnd so I need to say,\nspanning-tree, there we go,\n\n375\n00:20:44.498 --> 00:20:48.520\nspanning-tree mst configuration.\n\n376\n00:20:48.520 --> 00:20:50.830\nIt's got its own special prompt\nthat we have to get in to.\n\n377\n00:20:51.850 --> 00:20:56.840\nOnce you're in there,\nyou've got to name, your mst domain.\n\n378\n00:20:56.840 --> 00:20:59.910\nIt's kind of like VTP where you have\na domain name and in MST, you do too.\n\n379\n00:20:59.910 --> 00:21:01.200\nSo I need to give it a name.\n\n380\n00:21:01.200 --> 00:21:03.500\nAnd you can call it whatever you want.\n\n381\n00:21:03.500 --> 00:21:08.080\nI might call mine ITProTV or something\nlike that, but you need to give it a name.\n\n382\n00:21:08.080 --> 00:21:11.230\nAnd that's because there might be other\ninstances of MST on the network that you\n\n383\n00:21:11.230 --> 00:21:14.380\nwant to keep separate, and\nit'll use these names to isolate that.\n\n384\n00:21:14.380 --> 00:21:17.190\nSo you could actually have two\ncompletely separate environments.\n\n385\n00:21:17.190 --> 00:21:20.170\nYou can't do that with Spanning Tree.\n\n386\n00:21:20.170 --> 00:21:24.230\nThen I need to come in and\ntell it just a few more little bits.\n\n387\n00:21:24.230 --> 00:21:26.490\nMST has updated a bit over the years,\n\n388\n00:21:26.490 --> 00:21:31.600\nand one of those problems they bumped into\nis sometimes you deploy a new switch.\n\n389\n00:21:31.600 --> 00:21:35.680\nAnd it might overwrite the configuration\nof switches or things like that.\n\n390\n00:21:35.680 --> 00:21:38.810\nSo there's a revision number that\nit uses to keep track of, and\n\n391\n00:21:38.810 --> 00:21:42.780\nit's not like version one of the protocol,\nit's version one of your database.\n\n392\n00:21:42.780 --> 00:21:45.970\nAgain, like VTP where you have\nthe revisions every time there's a change,\n\n393\n00:21:45.970 --> 00:21:47.230\nwe have that here too.\n\n394\n00:21:47.230 --> 00:21:50.330\nAnd so if you're just configuring this\nfrom the very beginning, it's a good idea\n\n395\n00:21:50.330 --> 00:21:52.240\nto just go ahead and make sure your\nrevision number is set to one and\n\n396\n00:21:52.240 --> 00:21:54.000\nthat that's where you're starting out.\n\n397\n00:21:54.000 --> 00:21:57.370\nBut you can have it other values, you\njust run the risk of getting overwritten.\n\n398\n00:21:58.580 --> 00:22:01.190\nSo I'm gonna set that and\nnow I need to create my instances.\n\n399\n00:22:01.190 --> 00:22:05.960\nAnd so I'm gonna say instance one,\nso this is my first instance of MST.\n\n400\n00:22:05.960 --> 00:22:08.170\nI'm gonna give it vlan 1,2.\n\n401\n00:22:08.170 --> 00:22:10.040\nAnd so you can just say 1, 2 or 1-10.\n\n402\n00:22:10.040 --> 00:22:13.900\nYou can use all the Cisco ranges.\n\n403\n00:22:13.900 --> 00:22:20.560\nAnd then I'll say instance 2,\nvlan 2, or vlan 3,4, there we go.\n\n404\n00:22:20.560 --> 00:22:26.190\nSo now I've divided up those two\nVLANs into these separate incidences.\n\n405\n00:22:26.190 --> 00:22:28.590\n>> Don would that have wigged it out\nif you had accidentally put tow and\n\n406\n00:22:28.590 --> 00:22:29.720\nthree instead of three and four?\n\n407\n00:22:29.720 --> 00:22:31.610\n>> It would've moved it\nover to the other instance.\n\n408\n00:22:31.610 --> 00:22:33.680\nSo I would've broken my own configuration.\n\n409\n00:22:34.810 --> 00:22:35.310\n>> Gotcha.\n>> Yep.\n\n410\n00:22:35.310 --> 00:22:36.860\nAlways a good idea to verify this.\n\n411\n00:22:36.860 --> 00:22:38.670\nActually with MST it does this neat thing,\n\n412\n00:22:38.670 --> 00:22:42.850\nwhen I'm here in the configuration this\nstuff's not actually applying yet.\n\n413\n00:22:42.850 --> 00:22:44.505\nIt waits till I get out of\nthe configuration to apply it.\n\n414\n00:22:44.505 --> 00:22:47.346\nSo you can run show pending and\nwhen you run that,\n\n415\n00:22:47.346 --> 00:22:51.990\nit'll show you what its planning on\ndoing so you can check your work.\n\n416\n00:22:51.990 --> 00:22:53.300\nBut it hasn't actually applied this.\n\n417\n00:22:53.300 --> 00:22:57.030\nSo see how this is revision 1 and these\nare the changes that I'm about to make.\n\n418\n00:22:57.030 --> 00:22:58.780\nAnd so I can verify and check.\n\n419\n00:22:58.780 --> 00:23:02.390\nSo one of the few times you can\nuse a show command in your config\n\n420\n00:23:02.390 --> 00:23:04.720\nbecause MST is technically\nlike a separate program.\n\n421\n00:23:05.720 --> 00:23:06.810\nAnd so we can look at that.\n\n422\n00:23:07.940 --> 00:23:11.600\nBut once it's good, we can exit out of\nthat, and now it's actually applying.\n\n423\n00:23:12.800 --> 00:23:15.120\nIt's happening and\nsee how my VLAN just went down.\n\n424\n00:23:15.120 --> 00:23:17.460\nThe VLAN didn't go down the whole\ntime I was rambling on there, but\n\n425\n00:23:17.460 --> 00:23:22.350\nnow it goes down and the changes go\ninto effect or at least they better.\n\n426\n00:23:22.350 --> 00:23:25.420\nSo if I get out of my config I\ncan do a show Spanning Tree.\n\n427\n00:23:25.420 --> 00:23:33.950\nAnd if I run show spanning-tree, I'm\ngonna see MST0, and the protocol's MSTP.\n\n428\n00:23:33.950 --> 00:23:36.197\nAnd I see these ports that are on here.\n\n429\n00:23:36.197 --> 00:23:40.040\nIt's not telling me a VLAN,\nbecause this is VLAN 1 and 2.\n\n430\n00:23:40.040 --> 00:23:43.770\nAnd then if I hit space and\nkind of move forward, here's MST1.\n\n431\n00:23:43.770 --> 00:23:46.018\nSo it's instance one and two,\nbut it starts with zero.\n\n432\n00:23:46.018 --> 00:23:50.262\nMST0 and MST1, and I can see them right\nin here, and I can spot them, and\n\n433\n00:23:50.262 --> 00:23:51.854\nthis is the next instance.\n\n434\n00:23:51.854 --> 00:23:54.391\nAnd see how it's using\nthat priority number?\n\n435\n00:23:54.391 --> 00:23:56.100\nThat 32,769.\n\n436\n00:23:56.100 --> 00:23:59.690\nIt's using that to track\nthe instances that I've got.\n\n437\n00:23:59.690 --> 00:24:04.257\nUp here my instance was 0,\nand we ended up with 32768.\n\n438\n00:24:04.257 --> 00:24:08.040\nSo the IEEE actually used Cisco's\ntechnique to provide this.\n\n439\n00:24:08.040 --> 00:24:09.910\nIt really is a middle\nground between the two.\n\n440\n00:24:11.090 --> 00:24:16.050\nBut just bare in mind that it\nis sharing these instances\n\n441\n00:24:16.050 --> 00:24:19.880\nbetween VLANs that we could have\ninaccurate loops be reported.\n\n442\n00:24:19.880 --> 00:24:21.260\nSo we gotta plan for that.\n\n443\n00:24:21.260 --> 00:24:26.520\nAnd the more MST instances you create\nthe more resources they consume,\n\n444\n00:24:26.520 --> 00:24:28.780\nso you just need to keep an eye\non the CPU on your switches.\n\n445\n00:24:28.780 --> 00:24:30.990\nOn your Cisco switches you really\ndon't have to worry about it.\n\n446\n00:24:30.990 --> 00:24:32.740\nIt's really the third party stuff\nwhere you have to watch that.\n\n447\n00:24:32.740 --> 00:24:37.770\nSo Cisco put some great hardware in their\nswitches and you're usually covered.\n\n448\n00:24:37.770 --> 00:24:40.968\nAfter this we pretty much treat everything\nlike normal, if you wanna go and\n\n449\n00:24:40.968 --> 00:24:42.134\nset one bridge a the route or\n\n450\n00:24:42.134 --> 00:24:45.570\nanother bridge as a secondary the commands\nare all kind of what you're used to.\n\n451\n00:24:46.940 --> 00:24:50.010\nSo after that, everything else\nis kind of treated the same.\n\n452\n00:24:50.010 --> 00:24:54.171\nMST is not really that hard, but\nit does take a little extra planning.\n\n453\n00:24:54.171 --> 00:25:00.650\nNow, we've configured CST or\ncommon or regular spanning tree.\n\n454\n00:25:00.650 --> 00:25:03.720\nWe've configured per VLAN Spanning Tree\nPlus which is what we were running by\n\n455\n00:25:03.720 --> 00:25:05.280\ndefault and now we've seen MST.\n\n456\n00:25:06.480 --> 00:25:11.460\nWell all three of them have one glaring\nweakness that I know I've referenced.\n\n457\n00:25:11.460 --> 00:25:13.180\nAnd it's just how slow they are.\n\n458\n00:25:13.180 --> 00:25:16.520\nIt takes them allow to recognize\nthe link being down and the flip over.\n\n459\n00:25:16.520 --> 00:25:21.460\nAnd so cuz usually it's some stuff\nthat we're we do to fix that.\n\n460\n00:25:23.170 --> 00:25:26.268\nUnfortunately, we kinda talk about\nthe last episode, you remember Daniel?\n\n461\n00:25:26.268 --> 00:25:27.807\nWhere we talked about\nadjusting this timers and\n\n462\n00:25:27.807 --> 00:25:29.650\nthat's you really don't wanna do that.\n\n463\n00:25:29.650 --> 00:25:35.260\nWell, there is another way to improve\nperformance in Spanning Tree and\n\n464\n00:25:35.260 --> 00:25:38.680\nit's called Rapid Spanning Tree Protocol.\n\n465\n00:25:38.680 --> 00:25:41.600\nWith Rapid Spanning Tree Protocol,\nbasically what we do is we\n\n466\n00:25:41.600 --> 00:25:44.380\nmake it happen a lot faster,\nit moves things along a lot more quickly.\n\n467\n00:25:44.380 --> 00:25:45.650\nIt's more suited for today's networks.\n\n468\n00:25:46.860 --> 00:25:48.780\nNot every switch supports it, and so\n\n469\n00:25:48.780 --> 00:25:52.020\nthat's why Cisco defaults to\nregular Spanning Tree Protocol.\n\n470\n00:25:52.020 --> 00:25:55.676\nBut Rapid Spanning Tree Protocol\nis a standard.\n\n471\n00:25:55.676 --> 00:26:00.328\nI've lost my note, it's 802.1W,\nI'm pretty certain.\n\n472\n00:26:00.328 --> 00:26:01.102\nI wanna make sure, I'm giving you\n\n473\n00:26:01.102 --> 00:26:01.687\nthe right standard-\n>> [LAUGH ]\n\n474\n00:26:01.687 --> 00:26:02.947\n>> Number.\n\n475\n00:26:02.947 --> 00:26:04.210\nIt is 802.1W.\n\n476\n00:26:04.210 --> 00:26:08.790\nSo 802.1W is the official standard for\nRapid Spanning Tree Protocol.\n\n477\n00:26:08.790 --> 00:26:12.444\nAnd this is one of the odd ones where it\nkind of came through the IEEE first and\n\n478\n00:26:12.444 --> 00:26:14.750\nCisco said oh, we wanna do that.\n\n479\n00:26:14.750 --> 00:26:17.350\nBut what\nRapid Spanning Tree Protocol does,\n\n480\n00:26:17.350 --> 00:26:20.200\nis it functions a little different\nthan regular Spanning Tree.\n\n481\n00:26:20.200 --> 00:26:22.827\nRemember with regular Spanning Tree\nwe had those five port states.\n\n482\n00:26:22.827 --> 00:26:27.740\nThere was blocking, listening,\nlearning, forwarding and disabled.\n\n483\n00:26:27.740 --> 00:26:29.060\nDisabled doesn't really count.\n\n484\n00:26:29.060 --> 00:26:33.085\nWell in Rapid Spanning Tree,\nit kinda cuts those phases down and\n\n485\n00:26:33.085 --> 00:26:36.300\nit says we don't need all\nthese different phases.\n\n486\n00:26:36.300 --> 00:26:39.290\nWe can kinda collapse that and\nget it really short.\n\n487\n00:26:39.290 --> 00:26:41.370\nAnd so\nit eliminates some of the phases and\n\n488\n00:26:41.370 --> 00:26:45.100\nit really just has discarding,\nlearning and forwarding.\n\n489\n00:26:46.140 --> 00:26:50.540\nSo discarding, you're discarding\non a port if you've got a loop,\n\n490\n00:26:50.540 --> 00:26:51.970\nyou discard that traffic.\n\n491\n00:26:51.970 --> 00:26:55.240\nLearning, we're learning the MAC addresses\nto get ready to bring this port up.\n\n492\n00:26:55.240 --> 00:26:57.890\nAnd then forwarding,\nwe're forwarding traffic.\n\n493\n00:26:57.890 --> 00:27:01.950\nSo we eliminated some phases to get things\nto go a little faster, but then the other\n\n494\n00:27:01.950 --> 00:27:05.310\nthing is that Rapid Spanning Tree is\na little more trusting by default.\n\n495\n00:27:05.310 --> 00:27:09.320\nWith traditional Spanning Tree,\nwe're blocking a port and\n\n496\n00:27:09.320 --> 00:27:11.840\nthen we do 30 seconds of listening and\nlearning and then we move forward.\n\n497\n00:27:11.840 --> 00:27:15.580\nWith rapid,\nit transitions to listening and\n\n498\n00:27:15.580 --> 00:27:20.860\nduring listening, it's actually all ready\nstarting to populate that table and\n\n499\n00:27:20.860 --> 00:27:24.260\nget things moving and\nit transitions much, much faster.\n\n500\n00:27:24.260 --> 00:27:26.505\nNow if I have one switch and\nI move it to rapid and\n\n501\n00:27:26.505 --> 00:27:30.085\nall my other switches are still regular,\nI can end up with some problems.\n\n502\n00:27:30.085 --> 00:27:31.891\nBecause you don't wanna\nmake a rapid decision and\n\n503\n00:27:31.891 --> 00:27:33.360\nyou just haven't seen a BPU come in yet.\n\n504\n00:27:34.460 --> 00:27:38.060\nBut with rapid when it sees that BPU it'll\njust jump right back to listening and\n\n505\n00:27:38.060 --> 00:27:38.600\nfix itself.\n\n506\n00:27:38.600 --> 00:27:42.933\nSo it's actually really good at that and\nit works much, much faster.\n\n507\n00:27:42.933 --> 00:27:48.116\nNow unfortunately when IEEE ratified\nRapid Spanning Tree when they did AO2.1W,\n\n508\n00:27:48.116 --> 00:27:51.920\nthey were still sticking by that\nstance of only one instance.\n\n509\n00:27:51.920 --> 00:27:53.790\nNo VLAN support.\n\n510\n00:27:53.790 --> 00:27:56.918\nSo Cisco said great,\nwe've got to take rapid and\n\n511\n00:27:56.918 --> 00:28:00.213\nwe've got to make it per\nVLAN Rapid Spanning Tree.\n\n512\n00:28:00.213 --> 00:28:04.290\nThat's where we have our last\nprotocol which is PVRSTP Plus.\n\n513\n00:28:04.290 --> 00:28:08.087\nSo RSTP is Rapid Spanning Tree Protocol.\n\n514\n00:28:08.087 --> 00:28:13.790\nPVRST Plus is Ciscos implementation\nwhich is just running it once per VLAN.\n\n515\n00:28:13.790 --> 00:28:17.920\nTo switch over to it's pretty easy on my\nCORE switch here I can just come in and\n\n516\n00:28:17.920 --> 00:28:23.200\nI can say spanning-tree mode, and\n\n517\n00:28:23.200 --> 00:28:26.160\nyou'll see right there rapid-pvst.\n\n518\n00:28:26.160 --> 00:28:27.778\nAnd so I'll designate that.\n\n519\n00:28:27.778 --> 00:28:31.150\nNow, that's gonna disable MST on\nmy system, so MST's gonna go away.\n\n520\n00:28:31.150 --> 00:28:32.770\nI'll see some interfaces go down.\n\n521\n00:28:32.770 --> 00:28:34.938\nAnd now, I'm gonna flip over to PVST.\n\n522\n00:28:34.938 --> 00:28:40.753\nWith PVST, I'll run one copy of Rapid\nSpanning Tree for each VLAN that I have.\n\n523\n00:28:40.753 --> 00:28:45.370\nAnd so if I do a show span I can go in\nhere and I can look and here's VLAN.\n\n524\n00:28:45.370 --> 00:28:46.500\nVLAN1 and\n\n525\n00:28:46.500 --> 00:28:52.210\nI'm running regular old Rapid Spanning\nTree protocol, once for each VLAN.\n\n526\n00:28:52.210 --> 00:28:55.046\nAnd if you look at my ports to see\nhow they're designated in learning.\n\n527\n00:28:55.046 --> 00:28:58.360\nThis is coming up and\nthat system is initializing.\n\n528\n00:28:58.360 --> 00:29:00.220\nI don't see listening,\nI see that learning.\n\n529\n00:29:00.220 --> 00:29:04.688\nNow I said, just a minute ago that we\ndon't really have that learning phase,\n\n530\n00:29:04.688 --> 00:29:05.940\nwell actually we do.\n\n531\n00:29:05.940 --> 00:29:06.780\nI think I got it backwards.\n\n532\n00:29:06.780 --> 00:29:09.711\nDid I say listening or learning earlier?\n\n533\n00:29:09.711 --> 00:29:10.320\nI don't know.\n\n534\n00:29:10.320 --> 00:29:11.699\nWe'll have to rewind.\n>> I didn't memorize it.\n\n535\n00:29:11.699 --> 00:29:13.319\n[LAUGH]\n>> Regardless of what I said,\n\n536\n00:29:13.319 --> 00:29:16.770\nit is actually the learning\nphase not the listening.\n\n537\n00:29:16.770 --> 00:29:19.291\nI'm pretty sure I've said that [INAUDIBLE]\n>> You probably got it right.\n\n538\n00:29:19.291 --> 00:29:20.980\n>> So listing basically is cut off.\n\n539\n00:29:20.980 --> 00:29:22.750\nWe don't need that anymore,\nnow we go to learning.\n\n540\n00:29:22.750 --> 00:29:24.180\nWe're learning these MACs,\n\n541\n00:29:24.180 --> 00:29:26.630\nwe're adding it to the MAC table but\nit's not actually allowed to talk.\n\n542\n00:29:26.630 --> 00:29:27.910\nBut it happens much faster.\n\n543\n00:29:27.910 --> 00:29:29.560\nIt transitions through that process.\n\n544\n00:29:29.560 --> 00:29:33.250\nNow, mine's still gonna go kinda slow\nbecause the other end of this link\n\n545\n00:29:33.250 --> 00:29:35.970\nis still running regular,\nit's not running rapid.\n\n546\n00:29:35.970 --> 00:29:39.358\nSo I really should jump over to CORE2 and\nthe other guys and\n\n547\n00:29:39.358 --> 00:29:40.822\nmove them to rapid also.\n\n548\n00:29:40.822 --> 00:29:43.490\nBut now I'm in this rapid mode things\nare gonna happen a lot faster and\n\n549\n00:29:43.490 --> 00:29:44.690\nwe give that better fail over.\n\n550\n00:29:44.690 --> 00:29:48.652\nSo if I jump over to the other guys and\ndo the same thing,\n\n551\n00:29:48.652 --> 00:29:52.357\nI'm not gonna go crazy on\ntheir configurations but\n\n552\n00:29:52.357 --> 00:29:56.769\nat a minimum I'll just say\nspanning-tree mode rapid PBST.\n\n553\n00:29:56.769 --> 00:29:59.818\nAnd then I'll jump down to that access\nswitch which I should have checked before\n\n554\n00:29:59.818 --> 00:30:01.840\nthe show to see if it even supported it.\n\n555\n00:30:01.840 --> 00:30:02.680\nIt probably does.\n\n556\n00:30:02.680 --> 00:30:07.618\nThis is a 2900 so it should or\nit's a 2960, 2900 is really old.\n\n557\n00:30:07.618 --> 00:30:09.540\nSo [LAUGH] I'll come in here and\n\n558\n00:30:09.540 --> 00:30:12.890\njust say mode and\nflip it to rapid also, there we go.\n\n559\n00:30:12.890 --> 00:30:17.300\nSo now all three of my switches\nare running rapid PVST and they've\n\n560\n00:30:17.300 --> 00:30:21.400\ngot it running once for each VLAN and they\nare starting to kind of negotiate out.\n\n561\n00:30:21.400 --> 00:30:23.469\nAnd things should be\ngoing a lot faster now.\n\n562\n00:30:23.469 --> 00:30:26.501\nWhen we were talking about regular\nSpanning tree, I pointed out how when\n\n563\n00:30:26.501 --> 00:30:29.870\na port got blocked sometimes it\nwas flagged as an alternate port.\n\n564\n00:30:29.870 --> 00:30:32.581\nBut regular Spanning Tree\nignores that stuff.\n\n565\n00:30:32.581 --> 00:30:34.650\nBut Rapid Spanning Tree doesn't.\n\n566\n00:30:34.650 --> 00:30:37.830\nWith Rapid Spanning Tree that\nalternate actually means something.\n\n567\n00:30:37.830 --> 00:30:40.340\nIt says, I know this alternate port\n\n568\n00:30:40.340 --> 00:30:43.280\ncan get me to the root just\nas well as the root port can.\n\n569\n00:30:43.280 --> 00:30:45.353\nAnd so if I ever lose the root port.\n\n570\n00:30:45.353 --> 00:30:47.460\nI'm not gonna learn.\nI'm not gonna listen.\n\n571\n00:30:47.460 --> 00:30:48.205\nI'm not gonna block.\n\n572\n00:30:48.205 --> 00:30:49.130\nI'm not gonna whatever.\n\n573\n00:30:49.130 --> 00:30:51.710\nI'm just gonna take this alternate\nport and immediately bring it up.\n\n574\n00:30:51.710 --> 00:30:55.530\nSo with Rapid Spanning Tree Protocol\nit fails over immediately.\n\n575\n00:30:55.530 --> 00:30:57.990\nWhen you plug in a new connection sure,\nit's gotta learn.\n\n576\n00:30:57.990 --> 00:31:00.930\nYou got a period, you've got 15 seconds,\nwhere it's gonna learn and\n\n577\n00:31:00.930 --> 00:31:03.260\nmake sure you're okay to\nbring you on the network.\n\n578\n00:31:03.260 --> 00:31:07.554\nBut if it's already holding you down and\nit knows you can get to the root and\n\n579\n00:31:07.554 --> 00:31:11.933\nthe root port fails, it doesn't need\nto learn it already knows about you.\n\n580\n00:31:11.933 --> 00:31:15.577\nAnd so it immediately fails over and\nthat's what makes Rapid Spanning Tree so\n\n581\n00:31:15.577 --> 00:31:16.690\nmuch faster.\n\n582\n00:31:16.690 --> 00:31:18.420\nAnd that's why we normally wanna use it.\n\n583\n00:31:18.420 --> 00:31:22.370\nIt's not really any more resource\nintensive because it's just\n\n584\n00:31:22.370 --> 00:31:23.480\nremembering this other port.\n\n585\n00:31:23.480 --> 00:31:25.600\nThat's all it's doing,\nthat's not hard work.\n\n586\n00:31:25.600 --> 00:31:27.480\nSo it just needs to know to be\nable to jump back over to it.\n\n587\n00:31:27.480 --> 00:31:30.260\nSo if I look at CORE2 for example.\n\n588\n00:31:30.260 --> 00:31:32.610\nSo here's my CORE2 switch.\n\n589\n00:31:32.610 --> 00:31:38.270\nAnd I do a show spanning-tree,\nit's got VLAN1.\n\n590\n00:31:38.270 --> 00:31:43.520\nAnd on VLAN1 port 23 and\n24 both point to core one.\n\n591\n00:31:43.520 --> 00:31:44.730\nCore one is the route.\n\n592\n00:31:44.730 --> 00:31:46.710\nSo see how port 23 is the route and\n\n593\n00:31:46.710 --> 00:31:51.110\nit's forwarding it, and port 24 is\nthe alternate and it's blocking.\n\n594\n00:31:51.110 --> 00:31:54.911\nWell, earlier in the show I shut one off,\nor I think it was in part two.\n\n595\n00:31:54.911 --> 00:31:58.358\nI shut one off and after 30 seconds\nthe other one was active and\n\n596\n00:31:58.358 --> 00:32:00.068\nI said it could take as long as.\n\n597\n00:32:00.068 --> 00:32:02.137\n50 seconds, right?\n\n598\n00:32:02.137 --> 00:32:04.046\nWell, watch what happens here.\n\n599\n00:32:04.046 --> 00:32:07.252\nSo I'm gonna do a show span and\nI'm gonna filter that so\n\n600\n00:32:07.252 --> 00:32:10.900\nthat I can actually see\nthe data that I really want.\n\n601\n00:32:10.900 --> 00:32:14.340\nI want to limit it to\njust showing me port 24.\n\n602\n00:32:14.340 --> 00:32:18.970\nOkay, so oops, and\nI need to make sure that's a do.\n\n603\n00:32:18.970 --> 00:32:21.860\nOh, it's capital F,\ncase sensitive searches.\n\n604\n00:32:21.860 --> 00:32:22.600\nThere we go.\n\n605\n00:32:22.600 --> 00:32:25.400\nAll right, so\nI can see that it's blocking, all right.\n\n606\n00:32:25.400 --> 00:32:31.356\nIf I get into fa1/0/23, this is\nthe one that's not blocking, right.\n\n607\n00:32:31.356 --> 00:32:35.163\nSo I guess we could do it this way and\nsee, whoops [LAUGH],\n\n608\n00:32:35.163 --> 00:32:37.550\nthat's not what I wanted.\n\n609\n00:32:37.550 --> 00:32:38.810\nIf we get in here, and\n\n610\n00:32:38.810 --> 00:32:43.470\nwe get it to show us all of the ports,\nI say, let's do it this way.\n\n611\n00:32:43.470 --> 00:32:49.730\nI want it to show me the root port and\nany alternate ports.\n\n612\n00:32:49.730 --> 00:32:50.390\nThere we go.\n\n613\n00:32:50.390 --> 00:32:54.210\nI can see ports 23 and\n24, 23 is forwarding.\n\n614\n00:32:54.210 --> 00:32:55.060\n24 is blocking.\n\n615\n00:32:56.290 --> 00:32:57.760\nI'm in 23.\nI'm gonna do a shutdown.\n\n616\n00:32:58.990 --> 00:33:00.970\nSo the root port just went down.\n\n617\n00:33:00.970 --> 00:33:04.120\nAnd now, I'm gonna watch\nwhat spanning-tree is doing.\n\n618\n00:33:04.120 --> 00:33:04.800\nOkay?\n\n619\n00:33:04.800 --> 00:33:09.317\nAnd what you can see is that 23 is gone,\n24 is already forwarding.\n\n620\n00:33:09.317 --> 00:33:12.590\nDidn't go to listening,\ndidn't go to learning, right?\n\n621\n00:33:12.590 --> 00:33:15.801\nWe don't have listening so\nit just skipped the learning phase and\n\n622\n00:33:15.801 --> 00:33:17.312\nwent immediately to forwarding.\n\n623\n00:33:17.312 --> 00:33:21.981\nIt knew this was a good port and\nit just held it down and said I'm.\n\n624\n00:33:21.981 --> 00:33:24.770\nThat's the big advantage of\nrapid spanning tree protocol.\n\n625\n00:33:24.770 --> 00:33:26.280\nAnd so we normally want that, right?\n\n626\n00:33:26.280 --> 00:33:28.460\nThat's a good thing,\nif your switches support it.\n\n627\n00:33:28.460 --> 00:33:32.550\nBut if some switches do and some switches\ndon't, you can end up with some trouble.\n\n628\n00:33:32.550 --> 00:33:34.730\nAnd so you might not be able\nto use it in your environment.\n\n629\n00:33:34.730 --> 00:33:37.400\nBut given a choice,\nI usually run rapid spanning tree,\n\n630\n00:33:37.400 --> 00:33:38.650\nthis is the one that you want.\n\n631\n00:33:38.650 --> 00:33:42.750\nAnd on a Cisco switch it's\nper-VLAN rapid spanning-tree that\n\n632\n00:33:42.750 --> 00:33:45.630\nyou're actually running, so PVRST-plus.\n\n633\n00:33:45.630 --> 00:33:50.090\n>> Yeah, I wouldn't want to have rapid\nspanning-tree running on just one VLAN.\n\n634\n00:33:50.090 --> 00:33:54.395\nI've probably got multiple running, so\nthat PVST is nice in those Cisco switches.\n\n635\n00:33:54.395 --> 00:33:54.895\nAll right, Don.\n\n636\n00:33:54.895 --> 00:33:57.555\nNow I know we still have more to cover.\n\n637\n00:33:57.555 --> 00:34:02.335\nWe got some enhancements to Spanning Tree\nthat we need to get through but again,\n\n638\n00:34:02.335 --> 00:34:05.420\nwe have eliminated all of our time for\nthis episode.\n\n639\n00:34:05.420 --> 00:34:07.720\nSo we're gonna have to make a part four.\n\n640\n00:34:07.720 --> 00:34:10.940\nThat's right,\nwe're getting into the bad sequels area.\n\n641\n00:34:10.940 --> 00:34:11.910\nIt's like Jaws part 4.\n\n642\n00:34:11.910 --> 00:34:14.290\nI'm going to break the rule and\nkill that timer.\n\n643\n00:34:14.290 --> 00:34:16.430\nSo I got two things I want to add.\n\n644\n00:34:16.430 --> 00:34:17.790\nWe had a good question in the chat room.\n\n645\n00:34:17.790 --> 00:34:20.947\nDoug was asked about, what is the cost?\n\n646\n00:34:20.947 --> 00:34:23.570\n200,000, right?\n\n647\n00:34:23.570 --> 00:34:27.140\nI mentioned earlier that cost\nis fairly small number, right?\n\n648\n00:34:27.140 --> 00:34:32.439\nThe cost is actually 0, which you'll\nnever see, so 1 through 65,555, right?\n\n649\n00:34:32.439 --> 00:34:34.310\nThat's what the cost is.\n\n650\n00:34:34.310 --> 00:34:39.570\nBut there is a special new cost mode\nyou can use called the long mode.\n\n651\n00:34:39.570 --> 00:34:43.130\nIf you're in the long mode it\nbumps it up to a 32 bit number but\n\n652\n00:34:43.130 --> 00:34:44.700\nit doesn't truly use it.\n\n653\n00:34:44.700 --> 00:34:48.030\nI believe it has\nthe maximum of 200 million.\n\n654\n00:34:48.030 --> 00:34:51.140\nWith a 32 bit number you should be\nable to go to like 4.3 billion.\n\n655\n00:34:51.140 --> 00:34:53.910\nBut you can actually have a cost\nthat goes as high as $200 million.\n\n656\n00:34:53.910 --> 00:34:55.570\nIf you switch to the long mode,\n\n657\n00:34:55.570 --> 00:34:57.050\nwhat you're doing is you're\nbasically saying, all right.\n\n658\n00:34:57.050 --> 00:34:59.950\nFrom now on, I'm gonna control the cost\nmyself and I'm gonna set it to whatever I\n\n659\n00:34:59.950 --> 00:35:03.920\nwant now I've got this huge\nnumber range to be able to use.\n\n660\n00:35:03.920 --> 00:35:05.700\nAll the Cisco net switches support it.\n\n661\n00:35:06.850 --> 00:35:08.023\nSome of the catalysts support.\n\n662\n00:35:08.023 --> 00:35:11.420\nThe 4500s, the 6500s, right?\n\n663\n00:35:11.420 --> 00:35:17.650\nThose guys do, on a 3750 like mine,\nyou know if I look at my hardware here.\n\n664\n00:35:17.650 --> 00:35:20.490\nI don't know if I support it,\nlet's find out if we do.\n\n665\n00:35:20.490 --> 00:35:21.920\nIt's kinda easy to find out.\n\n666\n00:35:21.920 --> 00:35:28.525\nIf you go into config, and\nyou do a spanning-tree cost,\n\n667\n00:35:28.525 --> 00:35:32.939\noops, all right I may not support it.\n\n668\n00:35:32.939 --> 00:35:39.830\nIt's, oh wait it's not cost,\nit's path cost.\n\n669\n00:35:39.830 --> 00:35:43.050\nIf you have the spanning-tree\npath cost command then that\n\n670\n00:35:43.050 --> 00:35:44.840\nmeans you support that new format.\n\n671\n00:35:44.840 --> 00:35:50.210\nAnd so you could come in here and you\ncould say, spanning-tree pathcost method.\n\n672\n00:35:50.210 --> 00:35:52.700\nAnd then there's long and short, right?\n\n673\n00:35:52.700 --> 00:35:54.550\nShort's the old method, 16-bit number,\n\n674\n00:35:54.550 --> 00:35:57.870\nit will be 1 to 65,535,\nlong is the new method.\n\n675\n00:35:57.870 --> 00:36:00.490\nIt can go as high as 200 million, right?\n\n676\n00:36:00.490 --> 00:36:02.860\nWay bigger cost number to be able to use.\n\n677\n00:36:02.860 --> 00:36:06.720\nAnd so, if I flip that,\nnow I'm running in long mode.\n\n678\n00:36:06.720 --> 00:36:08.620\nAnd the switch should support it.\n\n679\n00:36:08.620 --> 00:36:12.130\nSo, if I do a show spanning-tree.\n\n680\n00:36:12.130 --> 00:36:14.760\nNow my costs are gonna look\na bit different aren't they.\n\n681\n00:36:14.760 --> 00:36:18.980\nThere's that cost, 200,000 creeping in.\n\n682\n00:36:18.980 --> 00:36:21.790\nWhat used to be a 19 is now a 200,000.\n\n683\n00:36:21.790 --> 00:36:26.450\nAnd I can go in and start to manipulate\nthe cost of my interfaces to change that,\n\n684\n00:36:26.450 --> 00:36:32.150\nso I could jump into Fa1/0/24,\nthere we go.\n\n685\n00:36:32.150 --> 00:36:38.000\nAnd I could say spanning-tree and you'll\nsee right here we can set that cost.\n\n686\n00:36:38.000 --> 00:36:41.522\nAnd the cost would\nnormally be one to 65,535.\n\n687\n00:36:41.522 --> 00:36:44.353\nBut here you can see I can go all\nthe way up to, is it two million,\n\n688\n00:36:44.353 --> 00:36:45.647\ntwo hundred million right.\n\n689\n00:36:45.647 --> 00:36:50.604\nLet's see whatever are thousands\nare hundred thousands,\n\n690\n00:36:50.604 --> 00:36:54.766\ntwo hundred thousand I guess\nthis is the highest so\n\n691\n00:36:54.766 --> 00:36:57.960\nwe can set it to one hundred thousand.\n\n692\n00:36:57.960 --> 00:37:00.230\n>> That's two hundred million.\n\n693\n00:37:00.230 --> 00:37:01.140\n>> Is it two hundred million,\nam I screwing it up?\n\n694\n00:37:01.140 --> 00:37:03.420\nSo it's three right two hundred million.\n\n695\n00:37:03.420 --> 00:37:05.280\nBig number, I was right the first time.\n\n696\n00:37:05.280 --> 00:37:06.670\nSo anyway,\nnow we can adjust that cost, and\n\n697\n00:37:06.670 --> 00:37:08.610\nyou can set it to any arbitrary numbers.\n\n698\n00:37:08.610 --> 00:37:11.660\nAnd that helps to solve the number we\ntalked about earlier when you have\n\n699\n00:37:11.660 --> 00:37:12.830\neither channels and stuff.\n\n700\n00:37:12.830 --> 00:37:17.055\nAnd you end up with these numbers that are\nreally weird, here we can override that.\n\n701\n00:37:17.055 --> 00:37:19.605\nAnd now when we take a look\nat our spanning tree,\n\n702\n00:37:19.605 --> 00:37:22.095\nyou'll see that custom\ncost stuck in there and\n\n703\n00:37:22.095 --> 00:37:25.535\nsee how that port flipped to blocking\ncuz I gave it a high cost, right.\n\n704\n00:37:25.535 --> 00:37:28.125\nVersus before, I think it was forwarding\nbefore I messed with it, yeah.\n\n705\n00:37:28.125 --> 00:37:31.453\nThat was my root port until I\nmessed with it and now, you know,\n\n706\n00:37:31.453 --> 00:37:34.731\nit was a root port with\na forwarding cost of 200,000.\n\n707\n00:37:34.731 --> 00:37:38.865\nNow I made it a, what did I gave it a\nmillion, ten million, something like that.\n\n708\n00:37:38.865 --> 00:37:39.875\nSo, it's pretty high.\n\n709\n00:37:39.875 --> 00:37:41.710\nSo that's where you see those longer ones.\n\n710\n00:37:41.710 --> 00:37:45.160\nWith normal Spanning Tree and your\nnormal cost you don't see that, right?\n\n711\n00:37:45.160 --> 00:37:46.430\nBut if you're in that long form.\n\n712\n00:37:46.430 --> 00:37:49.280\nAnd just to refresh there,\nthat command that I used\n\n713\n00:37:49.280 --> 00:37:54.420\nwas spanning-tree pathcost method long.\n\n714\n00:37:54.420 --> 00:37:56.981\nThat's what got that in place and\ngot that working.\n\n715\n00:37:56.981 --> 00:37:59.059\nSo, the other thing I wanna mention here,\n\n716\n00:37:59.059 --> 00:38:01.497\njust cuz obviously I don't\ncare about the timer.\n\n717\n00:38:01.497 --> 00:38:04.170\n>> [LAUGH]\n>> [LAUGH] Is I just want to do a real\n\n718\n00:38:04.170 --> 00:38:07.430\nquick review of the different protocols\nwe talked about because there\n\n719\n00:38:07.430 --> 00:38:08.170\nwere a bunch of them right?\n\n720\n00:38:08.170 --> 00:38:11.180\nWe started with regular\nspanning tree protocol,\n\n721\n00:38:11.180 --> 00:38:14.216\nwhich is also called common\nspanning tree protocol.\n\n722\n00:38:14.216 --> 00:38:18.680\nThen we talked about per\nVLAN Spanning Tree Plus, PVST plus,\n\n723\n00:38:18.680 --> 00:38:20.140\nwhich is Cisco proprietary.\n\n724\n00:38:20.140 --> 00:38:22.220\nRight?\nNo I Triple E number there.\n\n725\n00:38:22.220 --> 00:38:27.924\nThen we talked about rapid spanning\ntree protocol, which is a 802.1W and\n\n726\n00:38:27.924 --> 00:38:35.300\nCisco's Per VLAN rapid spanning tree plus,\nor P VRST+, Cisco proprietary.\n\n727\n00:38:35.300 --> 00:38:42.564\nAnd we also talk about MST, multiple\nspanning tree protocol, which was 802.1S.\n\n728\n00:38:42.564 --> 00:38:43.689\nYes, 802.1S.\n\n729\n00:38:43.689 --> 00:38:44.280\n>> Yes.\n\n730\n00:38:44.280 --> 00:38:45.820\n>> And that was the last one.\n\n731\n00:38:45.820 --> 00:38:48.730\nSo those are the five different\nspanning tree protocols\n\n732\n00:38:48.730 --> 00:38:50.910\nwe talked about in this episode.\n\n733\n00:38:50.910 --> 00:38:52.940\nAnd they're all on the table,\n\n734\n00:38:52.940 --> 00:38:55.870\nyou have to decide which one is\nthe best for your environment.\n\n735\n00:38:55.870 --> 00:38:58.210\n>> All right, well Don,\nwe have definitely,\n\n736\n00:38:58.210 --> 00:39:01.450\nthis is the show to end all shows,\neven though we have part four coming.\n\n737\n00:39:01.450 --> 00:39:04.040\nYou would think that that would be\nthe end of spanning tree, it's not.\n\n738\n00:39:04.040 --> 00:39:06.110\nWe have plenty more to cover.\n\n739\n00:39:06.110 --> 00:39:08.760\nBut for this episode,\nwe're gonna go ahead and call it a day.\n\n740\n00:39:08.760 --> 00:39:12.540\nHopefully we will see you in part four,\nThe Reckoning of Spanning Tree.\n\n741\n00:39:12.540 --> 00:39:17.190\nYou guys have a good day signing off for\nITProTV I've been your host Daniel Lowry.\n\n742\n00:39:17.190 --> 00:39:17.850\n>> And I'm Don Pezet.\n\n743\n00:39:17.850 --> 00:39:20.939\n>> And we'll see you next time.\n\n744\n00:39:20.939 --> 00:39:25.210\n[MUSIC]\n\n",
          "vimeoId": "141813055"
        },
        {
          "description": "In this episode, Don and Daniel go over some of the enhancements to the Spanning Tree Protocol. They walk you through technologies like PortFast, BPDUguard and BPDUfilter, LoopGuard, and RootGuard. All of these technologies can help you optimize and/or secure your switched network running STP.",
          "length": "1719",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt4-100115-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt4-100115-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-6-spanning_tree_pt4-100115-1-sm.jpg",
          "title": "Spanning Tree Part 4",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.949 --> 00:00:16.680\nAll right, greetings everyone, and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.680 --> 00:00:21.240\nI'm your host Daniel Lowery, here with\nme yet again today is Mr. Don Pezet.\n\n4\n00:00:21.240 --> 00:00:22.150\nHow's it going, Don?\n\n5\n00:00:22.150 --> 00:00:23.340\n>> It is going great, Daniel.\n\n6\n00:00:23.340 --> 00:00:24.520\nI'm glad to be back on the show for\n\n7\n00:00:24.520 --> 00:00:28.200\nour, I promise, our final episode\non spanning tree protocol.\n\n8\n00:00:28.200 --> 00:00:32.540\nWe've got, just got a mixed bag of\nadvance features that Cisco gives us with\n\n9\n00:00:32.540 --> 00:00:34.730\nspanning that we can\nmodify the way it behaves.\n\n10\n00:00:34.730 --> 00:00:36.850\nAnd so we're going to be tackling those,\nhere in this episode.\n\n11\n00:00:36.850 --> 00:00:39.650\nNow just quick kind of caveat\nright at the beginning.\n\n12\n00:00:39.650 --> 00:00:42.840\nThe majority of these are Cisco\nproprietary, they're things that Cisco did\n\n13\n00:00:42.840 --> 00:00:45.700\non their equipment to try and\nmake Spanning Tree more reliable or\n\n14\n00:00:45.700 --> 00:00:48.520\nbehave a little bit more efficiently\nin certain environments.\n\n15\n00:00:48.520 --> 00:00:49.650\nYou don't have to use any of these.\n\n16\n00:00:49.650 --> 00:00:53.140\nAll of the features we talk about in\nthis episode are completely optional.\n\n17\n00:00:53.140 --> 00:00:56.300\nAnd most of them, I think actually\nall of them, are off by default.\n\n18\n00:00:56.300 --> 00:00:58.390\nSo we actually have to go and\nturn them on if we want them.\n\n19\n00:00:58.390 --> 00:01:02.400\nBut your third-party equipment might have\nsomething similar, but will typically not\n\n20\n00:01:02.400 --> 00:01:05.440\nuse the same name as there's no iTripoli\nstandards to throw out in this episode.\n\n21\n00:01:05.440 --> 00:01:08.030\nIt's just kind of a mixed bag of stuff.\n\n22\n00:01:08.030 --> 00:01:12.030\n>> Yeah, Don, we did talk a lot about\na lot of good stuff when it comes to\n\n23\n00:01:12.030 --> 00:01:13.430\nSpanning Tree protocol stuff.\n\n24\n00:01:13.430 --> 00:01:17.890\nWe even talked about a rapid Spanning Tree\nand a per-VLAN rapid spanning tree and\n\n25\n00:01:17.890 --> 00:01:19.245\nhow we can speed things up.\n\n26\n00:01:19.245 --> 00:01:21.260\nBut, But you know what,\nI'm the kind of guy, I like speed.\n\n27\n00:01:21.260 --> 00:01:25.140\nI like demon speed,\nI like greasy, fast speed.\n\n28\n00:01:25.140 --> 00:01:27.135\nIs there any way we can speed this up?\n\n29\n00:01:27.135 --> 00:01:28.700\n[LAUGH]\n>> All right, so speed.\n\n30\n00:01:29.970 --> 00:01:32.430\nIt's best measured from\nan end users perspective.\n\n31\n00:01:32.430 --> 00:01:34.620\nWhen we talked about speed in the earlier\nepisode we talked about rapid\n\n32\n00:01:34.620 --> 00:01:39.020\nSpanning Tree and I showed how quickly\nit could fail over to another port.\n\n33\n00:01:39.020 --> 00:01:42.500\nIt had that alternate root port that it\ncould flip over to it at a moments notice.\n\n34\n00:01:42.500 --> 00:01:44.830\nThat's great on you uplink's,\non your trunks.\n\n35\n00:01:44.830 --> 00:01:47.590\nRight, or they don't have to be a trunk\njust whatever your link is between\n\n36\n00:01:47.590 --> 00:01:49.220\nthe switches.\n\n37\n00:01:49.220 --> 00:01:50.550\nThat's nice and fast.\n\n38\n00:01:50.550 --> 00:01:53.130\nBut that doesn't help an end user.\n\n39\n00:01:53.130 --> 00:01:56.780\nWhen you plug in a device,\nwhen a port comes up the first time,\n\n40\n00:01:56.780 --> 00:02:00.640\neven rapid Spanning Tree still\ndoes it's learning phase.\n\n41\n00:02:00.640 --> 00:02:02.940\nSo you have listening and\nlearning under regular spanning.\n\n42\n00:02:02.940 --> 00:02:05.930\nYou have learning under rapid,\nbut it's still there.\n\n43\n00:02:05.930 --> 00:02:07.430\nThe reason that alternate fails over so\n\n44\n00:02:07.430 --> 00:02:09.400\nfast is that the ports\ntechnically are already up.\n\n45\n00:02:09.400 --> 00:02:12.090\nIt's being blocked, but it's already up\nit's already happy we already know it's\n\n46\n00:02:12.090 --> 00:02:13.960\ngood, we could flip over to it right away.\n\n47\n00:02:13.960 --> 00:02:18.170\nBut when a user plugs in their laptop or\nturns on their computer,\n\n48\n00:02:18.170 --> 00:02:22.570\nthere's gonna be a 30 second or\na 15 second window where they can't talk.\n\n49\n00:02:22.570 --> 00:02:24.700\nAnd they see that as slow and\nthey get frustrated.\n\n50\n00:02:24.700 --> 00:02:27.870\nIf it's 30 seconds, then maybe they, maybe\nthey dont' get a dhcp request done in\n\n51\n00:02:27.870 --> 00:02:30.950\ntime, they don't get an address, now they\ncan't communicate and they get frustrated.\n\n52\n00:02:30.950 --> 00:02:36.200\nSo one great way to improve speed is\nnot to mess with Spannng Tree itself,\n\n53\n00:02:36.200 --> 00:02:37.540\nnot to mess with our trunks.\n\n54\n00:02:37.540 --> 00:02:40.250\nBut to mess with our client access ports.\n\n55\n00:02:40.250 --> 00:02:43.920\nWhen I plug in a laptop can I\ncreate a loop with my laptop?\n\n56\n00:02:43.920 --> 00:02:44.870\nNo, it's a single net.\n\n57\n00:02:44.870 --> 00:02:48.250\nI mean you can do crazy things,\nbut functioning normally,\n\n58\n00:02:48.250 --> 00:02:50.830\na laptop can't create a loo,\nneither can a desktop.\n\n59\n00:02:50.830 --> 00:02:53.030\nYou plug it in and that's it, right.\n\n60\n00:02:53.030 --> 00:02:56.160\nSo do we really need to do all the checks?\n\n61\n00:02:56.160 --> 00:03:00.340\nThe watching for BPDU's and\nloop detection and all that.\n\n62\n00:03:00.340 --> 00:03:05.060\nCouldn't we give it the benefit of the\ndoubt and say alright it's an access port.\n\n63\n00:03:05.060 --> 00:03:07.100\nYou're plugging in the work\nstations whatever.\n\n64\n00:03:07.100 --> 00:03:08.490\nLet's just bring the port up.\n\n65\n00:03:08.490 --> 00:03:11.980\nAnd we'll keep an ear out, we'll\nlisten to see if there is a loop, but\n\n66\n00:03:11.980 --> 00:03:14.080\nwe're going to give you the benefit of\nthe doubt and just come up right away.\n\n67\n00:03:14.080 --> 00:03:19.500\nAll right, that function in a Cisco\nswitch is called port fast.\n\n68\n00:03:19.500 --> 00:03:24.090\nPort fast should only be used on access\nports not on trunk ports, right.\n\n69\n00:03:24.090 --> 00:03:26.470\nBecause a trunk,\nyou very well could have a loop on that or\n\n70\n00:03:26.470 --> 00:03:28.860\nan uplink between switches,\nyou could have a loop there.\n\n71\n00:03:28.860 --> 00:03:32.390\nOn a port that's connected to an end-user\nstation, you're not normally gonna have\n\n72\n00:03:32.390 --> 00:03:35.580\na loop, so we can tell it to\nbring it up first by default.\n\n73\n00:03:35.580 --> 00:03:37.420\nThere's two ways to do it.\n\n74\n00:03:37.420 --> 00:03:41.640\nMethod one is to turn it on globally,\nyou can turn it on for the whole switch.\n\n75\n00:03:41.640 --> 00:03:44.750\nAll right, but then you need to go and\nturn it off for\n\n76\n00:03:44.750 --> 00:03:46.120\nthe individual ports that are up links.\n\n77\n00:03:47.160 --> 00:03:51.740\nOption two is to just turn it\non on the ports themselves, and\n\n78\n00:03:51.740 --> 00:03:54.270\nthen you just don't turn it on on\nyour uplinks and that's that, right.\n\n79\n00:03:54.270 --> 00:03:57.340\nSo it really boils down to what\nyou're going to need to do more of.\n\n80\n00:03:57.340 --> 00:04:01.140\nIf you've got more access\nports than uplinks\n\n81\n00:04:01.140 --> 00:04:03.430\nthen you usually wanna\nturn it on globally.\n\n82\n00:04:03.430 --> 00:04:05.860\nIf you've got more uplinks\nthan you do access ports,\n\n83\n00:04:05.860 --> 00:04:07.720\nthen you usually wanna turn\nit on on the port itself.\n\n84\n00:04:07.720 --> 00:04:10.500\nBut at the end of the day it really just\ncomes down to how many commands you wanna\n\n85\n00:04:10.500 --> 00:04:11.650\ntype, right.\n\n86\n00:04:11.650 --> 00:04:13.240\nThe command is pretty simple.\n\n87\n00:04:13.240 --> 00:04:19.080\nOn my core switch here, if I wanna turn it\non globally, I can jump into my config.\n\n88\n00:04:19.080 --> 00:04:23.101\nAnd I can say, spanning-tree,\n\n89\n00:04:23.101 --> 00:04:28.790\nportfast default, and that's gonna\nturn on portfast for all of my ports.\n\n90\n00:04:28.790 --> 00:04:33.180\nIt's gonna be the default mode from\nnow on, ports will come up first.\n\n91\n00:04:33.180 --> 00:04:37.042\nAnd we just assume they're loop free,\nand then we check them for loops.\n\n92\n00:04:37.042 --> 00:04:39.830\nAll right now if I run that,\nit's turning it on for all my ports so\n\n93\n00:04:39.830 --> 00:04:42.400\nhere it warns me,\nit's doing it everywhere!\n\n94\n00:04:42.400 --> 00:04:43.800\nYou should go and fix your uplinks.\n\n95\n00:04:45.080 --> 00:04:48.073\nSo I can do a quick like\nshow CDP neighbor and\n\n96\n00:04:48.073 --> 00:04:51.575\nkinda see where I'm\nuplinked to other switches.\n\n97\n00:04:51.575 --> 00:04:56.415\nPorts 22, and Port 24, 23 also, but\nI think I've shut that one down.\n\n98\n00:04:56.415 --> 00:05:04.430\nSo, I can go and I can fix those ports,\nif I do FA 1/0/22 through 24.\n\n99\n00:05:04.430 --> 00:05:07.828\nThose are my trunks and\nso in here I can say,\n\n100\n00:05:07.828 --> 00:05:15.840\nno spanning-tree port fast.\n\n101\n00:05:15.840 --> 00:05:18.630\nSo now I've turned off port fast for\nthose.\n\n102\n00:05:18.630 --> 00:05:19.860\nIf I had gone the other way around,\n\n103\n00:05:19.860 --> 00:05:23.350\nthe default global value is\nthat port fast is not on.\n\n104\n00:05:23.350 --> 00:05:28.340\nAnd so I could have come into this port\nand said, spanning-tree port fast and\n\n105\n00:05:28.340 --> 00:05:30.010\nthat would have turned it on for\nthis port.\n\n106\n00:05:30.010 --> 00:05:31.370\nAll right, but I just turned it off for\n\n107\n00:05:31.370 --> 00:05:34.180\nthese, so now I'm running port\nfast on all of my access ports.\n\n108\n00:05:34.180 --> 00:05:38.490\nSo if I plug in a new computer, instead\nof going through listing and learning,\n\n109\n00:05:38.490 --> 00:05:40.930\nwe are going to bring that port up first.\n\n110\n00:05:40.930 --> 00:05:46.680\nSo if I take a look at like\ninterface fa1/00/12, too many zeros.\n\n111\n00:05:46.680 --> 00:05:48.160\nOh, it took it.\n\n112\n00:05:48.160 --> 00:05:51.080\nI can see that it's up and\nit's just a regular port.\n\n113\n00:05:51.080 --> 00:05:51.870\nIt's not a trunk.\n\n114\n00:05:52.950 --> 00:05:56.980\nSo if I do a show int trunk,\nI'll see that port 12 is not trunking.\n\n115\n00:05:56.980 --> 00:05:58.570\nThere's a voice over IP\nphone on the other side.\n\n116\n00:05:58.570 --> 00:06:00.300\nThat's why I have to check it for\ntrunking.\n\n117\n00:06:00.300 --> 00:06:02.790\nSo, a voice over IP\nphone could potentially\n\n118\n00:06:02.790 --> 00:06:05.571\ncreate a loop if it was misconfigured.\n\n119\n00:06:05.571 --> 00:06:07.550\nBut so here I can see it's okay.\n\n120\n00:06:07.550 --> 00:06:13.210\nIf I go into that interface and\nI shut it down, right?\n\n121\n00:06:13.210 --> 00:06:15.830\nSo it's going to come\nout of Spanning Tree and\n\n122\n00:06:15.830 --> 00:06:20.230\nthen when I do a no shutdown it's\na new port that's turning up.\n\n123\n00:06:20.230 --> 00:06:20.800\nRight?\n\n124\n00:06:20.800 --> 00:06:26.521\nAnd so, if I do shows Spanning Tree.\n\n125\n00:06:26.521 --> 00:06:27.483\nOops.\n\n126\n00:06:27.483 --> 00:06:30.220\nI need to do a do show Spanning Tree.\n\n127\n00:06:30.220 --> 00:06:33.320\nAnd I'm going to filter that to\n\n128\n00:06:33.320 --> 00:06:38.200\njust Fa1/0/12 which is not in Spanning\nTree right now cause it's shut down.\n\n129\n00:06:38.200 --> 00:06:42.640\nIf I do a no shutdown,\nthat port is gonna come back up.\n\n130\n00:06:42.640 --> 00:06:47.870\nAnd it's gonna come back up and\nit's gonna join Spanning Tree, or is it?\n\n131\n00:06:47.870 --> 00:06:50.930\nIt doesn't even show up in Spanning Tree.\n\n132\n00:06:50.930 --> 00:06:53.160\nSo there we go, now it's turning up.\n\n133\n00:06:54.360 --> 00:06:58.200\nWhat you'll find is some\ninteresting stuff happens.\n\n134\n00:06:58.200 --> 00:07:01.270\nThe port came up,\nit was up and it was running.\n\n135\n00:07:01.270 --> 00:07:02.550\nBut it wasn't in Spanning Tree.\n\n136\n00:07:02.550 --> 00:07:04.950\nAnd then all of a sudden it did appear.\n\n137\n00:07:04.950 --> 00:07:05.450\nWhy is that?\n\n138\n00:07:06.700 --> 00:07:07.450\nWell here what happens.\n\n139\n00:07:07.450 --> 00:07:09.761\nWith port fast, you're effectively\ndisabling spanning-tree,\n\n140\n00:07:09.761 --> 00:07:12.340\nyou're saying Spanning Tree's\nno longer running on this port.\n\n141\n00:07:12.340 --> 00:07:15.160\nSo when somebody plugs in,\nit comes up right away.\n\n142\n00:07:15.160 --> 00:07:16.320\nBut it listens.\n\n143\n00:07:16.320 --> 00:07:21.080\nIt listens in the background and\nit says, if at anytime, I see a BPDU.\n\n144\n00:07:21.080 --> 00:07:22.680\nOh, I'm doing something about it.\n\n145\n00:07:22.680 --> 00:07:24.550\nAnd so it puts it into Spanning Tree.\n\n146\n00:07:24.550 --> 00:07:26.350\nAnd now Spanning Tree's in effect.\n\n147\n00:07:26.350 --> 00:07:32.230\nSo what happened with me Is it came up,\nright and it's a phone.\n\n148\n00:07:32.230 --> 00:07:33.420\nAnd so it's got two ports on it.\n\n149\n00:07:33.420 --> 00:07:37.630\nIt does a trunk to be able to send that,\nand it's sends BPDU's.\n\n150\n00:07:37.630 --> 00:07:39.380\nIt participates in Spanning Tree.\n\n151\n00:07:39.380 --> 00:07:44.780\nAnd so it sent me a BPU and as soon as my\nswitch realized that, I said whoa buddy.\n\n152\n00:07:44.780 --> 00:07:48.480\nLet me throw you in Spanning Tree and\nnow we're gonna watch for that loop.\n\n153\n00:07:48.480 --> 00:07:50.091\nBut even then, it's stayed forwarding.\n\n154\n00:07:50.091 --> 00:07:53.155\nSee how when it first appeared it was\nforwarding it wasn't listening or\n\n155\n00:07:53.155 --> 00:07:55.056\nlearning or whatever, it was forwarding.\n\n156\n00:07:55.056 --> 00:07:58.659\nAnd now it's seeing those BPU's that\ncheck them and can I see the root.\n\n157\n00:07:58.659 --> 00:08:00.716\nThrough here and it can't, it's a phone.\n\n158\n00:08:00.716 --> 00:08:04.850\nThere's no bridge on the other side of it\nand so there's no loop and it stays up.\n\n159\n00:08:04.850 --> 00:08:05.530\nThis is fast.\n\n160\n00:08:05.530 --> 00:08:07.051\nYou plug in, you get your access.\n\n161\n00:08:07.051 --> 00:08:08.421\nThat's what PortFast is all about.\n\n162\n00:08:08.421 --> 00:08:12.620\n>> Now like I said, I am fast,\nI love the fast, the PortFast is awesome.\n\n163\n00:08:12.620 --> 00:08:16.670\nI use it a lot in my switch configurations\nbecause I like just being able to plug in,\n\n164\n00:08:16.670 --> 00:08:18.200\nand I know things are working.\n\n165\n00:08:18.200 --> 00:08:21.010\nBut sometimes I do get\na little ahead of myself and\n\n166\n00:08:21.010 --> 00:08:23.700\nI forgot that I've enabled\nPortFast on a port.\n\n167\n00:08:23.700 --> 00:08:25.365\nAnd I'll plug a switch into that port.\n\n168\n00:08:25.365 --> 00:08:27.375\nDon, what happens when that happens?\n\n169\n00:08:27.375 --> 00:08:31.040\n[LAUGH]\n>> Well you know it goes right back to,\n\n170\n00:08:31.040 --> 00:08:34.890\nwe see some BPDU's right we've picked\nthose BPDU's up and we try to react to it,\n\n171\n00:08:34.890 --> 00:08:37.440\nbut that can be a bad thing, right?\n\n172\n00:08:37.440 --> 00:08:41.030\nSo actually do have another technology\nwe can turn on, it's called BPDU Guard.\n\n173\n00:08:41.030 --> 00:08:44.550\nAnd BPDU Guard is where we\nbring in the iron fist, right?\n\n174\n00:08:44.550 --> 00:08:48.730\nSo the default is we get these BPDUs, and\nwe just move in the spanning tree and\n\n175\n00:08:48.730 --> 00:08:49.860\nwe deal with it.\n\n176\n00:08:49.860 --> 00:08:53.270\nSo with BPDU Guard,\nwe rain down with an iron hammer, and\n\n177\n00:08:53.270 --> 00:08:56.520\nwe say if I see a BPDU on this port,\nI'm shutting it off.\n\n178\n00:08:56.520 --> 00:08:59.525\nI'm gonna more to error disabled and\nit's dead in the water.\n\n179\n00:08:59.525 --> 00:09:02.873\nSo great way to kind of transition\nthat down and kill the port, right?\n\n180\n00:09:02.873 --> 00:09:08.621\nSo for example, if I were to go to\ninto one of my other interfaces,\n\n181\n00:09:08.621 --> 00:09:13.023\nsomebody that is uplinked like fa1/0/22.\n\n182\n00:09:13.023 --> 00:09:13.523\nThis guy all right.\n\n183\n00:09:14.770 --> 00:09:19.680\nIf I do a show spanning tree, and\n\n184\n00:09:19.680 --> 00:09:22.942\nI'll filter that down to just Fa1/0/22.\n\n185\n00:09:22.942 --> 00:09:25.860\nAll right, so here's this guy,\nooh it's my root port, this'll be fun.\n\n186\n00:09:25.860 --> 00:09:29.180\nSo, it's my root port, it's up,\nit's forwarding, right?\n\n187\n00:09:29.180 --> 00:09:31.070\nSo, it's a healthy port.\n\n188\n00:09:31.070 --> 00:09:33.160\nI could turn BPDU Guard on that.\n\n189\n00:09:33.160 --> 00:09:37.930\nAnd if I turn BPDU Guard on and I see\na BPDU, I'm gonna shut that turkey off.\n\n190\n00:09:37.930 --> 00:09:42.320\nNow a BPDU Guard is an extension\nof spanning tree, and\n\n191\n00:09:42.320 --> 00:09:45.420\nall we have to do is go into the interface\nwhere we want to turn it on.\n\n192\n00:09:45.420 --> 00:09:53.480\nAnd we can say,\nspanning-tree bpduguard enable.\n\n193\n00:09:53.480 --> 00:09:54.780\nAnd that's gonna turn it on.\n\n194\n00:09:54.780 --> 00:09:56.080\nAll right?\n\n195\n00:09:56.080 --> 00:10:00.110\nNow, if I've got access ports,\nshould I be seeing BPDUs on those?\n\n196\n00:10:00.110 --> 00:10:00.730\nNo.\n\n197\n00:10:00.730 --> 00:10:04.370\nAnd if I've got a ton of those,\nI might wanna make this the default.\n\n198\n00:10:04.370 --> 00:10:06.550\nSo I would go out to my global prompt and\n\n199\n00:10:06.550 --> 00:10:11.510\nI would say,\nspanning-tree bpduguard default enable.\n\n200\n00:10:11.510 --> 00:10:12.870\nAnd then that's gonna, or wait.\n\n201\n00:10:12.870 --> 00:10:15.210\nActually it's a little bit different,\n\n202\n00:10:15.210 --> 00:10:17.550\nI'll have to show you\nthe global command in a second.\n\n203\n00:10:17.550 --> 00:10:20.950\nBecause there's a little extra keyword\nin there that makes it different.\n\n204\n00:10:20.950 --> 00:10:25.270\nBut on the interface, we turn it on here,\nwe say no spanning-tree bpdgaurd enable.\n\n205\n00:10:25.270 --> 00:10:28.930\nAnd when we turn that on, it's gonna\nstart watching for that BPDU and\n\n206\n00:10:28.930 --> 00:10:32.830\nif it gets one, there we go, see how\nthat port just went to error disabled?\n\n207\n00:10:32.830 --> 00:10:33.370\nRight?\n\n208\n00:10:33.370 --> 00:10:36.590\nIt saw the BPDU from the other switch and\nit just shut it down.\n\n209\n00:10:36.590 --> 00:10:37.450\nIt killed it.\n\n210\n00:10:37.450 --> 00:10:38.180\nDead in the water.\n\n211\n00:10:38.180 --> 00:10:39.150\nThat's it.\n\n212\n00:10:39.150 --> 00:10:39.680\nThat port's out.\n\n213\n00:10:39.680 --> 00:10:43.070\nAll right, so that's how we can kind\nof rain down with an iron fist.\n\n214\n00:10:43.070 --> 00:10:46.660\nNow, if I, I'm going to turn that off just\ncause I don't want to freak out my switch.\n\n215\n00:10:46.660 --> 00:10:49.060\nIf we do it globally,\nthe command is different.\n\n216\n00:10:49.060 --> 00:10:52.470\nIf I can get out of the config,\nor out of the interface, and\n\n217\n00:10:52.470 --> 00:10:58.220\ndo a spanning-tree, and\nI try to do BPDU Guard, it's not there.\n\n218\n00:10:58.220 --> 00:11:00.070\nSo this one is kind of a weird one.\n\n219\n00:11:00.070 --> 00:11:04.390\nWhat we need to do is,\nit's actually a function of PortFast.\n\n220\n00:11:04.390 --> 00:11:06.910\nRight?\nIt's building off that same technology.\n\n221\n00:11:06.910 --> 00:11:10.160\nAnd so\nI'm going to say spanning-tree portfast.\n\n222\n00:11:10.160 --> 00:11:14.610\nAnd then we'll see where we've\ngot bpduguard right there.\n\n223\n00:11:14.610 --> 00:11:17.390\nAnd we can fire that up.\n\n224\n00:11:17.390 --> 00:11:20.430\nAnd we specify that we want\nit to be the default, right?\n\n225\n00:11:20.430 --> 00:11:24.010\nAnd now I turn it on for all of my ports,\nand I need to go and turn it off for\n\n226\n00:11:24.010 --> 00:11:26.138\nmy trunks, so\nthat they don't get busted there.\n\n227\n00:11:26.138 --> 00:11:29.113\nAnd then get shut down.\n\n228\n00:11:29.113 --> 00:11:32.200\n>> Yeah.\nNow Don, this is a bit of a hammer when\n\n229\n00:11:32.200 --> 00:11:36.770\nmaybe a scalpel might be\na little more our speed here.\n\n230\n00:11:36.770 --> 00:11:40.590\nIt's very aggressive,\nis basically what I'm trying to say.\n\n231\n00:11:40.590 --> 00:11:43.855\nWhat can we do, is that just our option,\nwe're either coming down with the iron\n\n232\n00:11:43.855 --> 00:11:46.607\nfist or we're just letting it go and\nhoping that nothing happens?\n\n233\n00:11:46.607 --> 00:11:49.274\n>> Yeah, so with this,\nit takes the port to error disabled.\n\n234\n00:11:49.274 --> 00:11:51.130\nThat port's dead in the water.\n\n235\n00:11:51.130 --> 00:11:55.270\nIf it was an honest mistake, well,\nthey gotta call the network admins or\n\n236\n00:11:55.270 --> 00:11:56.690\nwhatever and\nget that port turned back on, right?\n\n237\n00:11:56.690 --> 00:12:00.880\nError disabled, you gotta fix the problem,\nshut the port down, do a no shut down, and\n\n238\n00:12:00.880 --> 00:12:01.690\nit comes back up, right?\n\n239\n00:12:01.690 --> 00:12:05.535\nSo there's no automatic fixing unless\nyou've set, you can set error disabled\n\n240\n00:12:05.535 --> 00:12:08.350\ntime-outs and stuff, but if you\nhaven't set those, it'll last forever.\n\n241\n00:12:08.350 --> 00:12:12.800\nSo if I want to be a little less\naggressive, instead of BPDU guard,\n\n242\n00:12:12.800 --> 00:12:16.270\nyou probably saw that option\nwhere I had BPDU filter.\n\n243\n00:12:16.270 --> 00:12:19.200\nWhat BPDU filter does is it says\nI'm not supposed to be receiving\n\n244\n00:12:19.200 --> 00:12:21.760\nBPDUs on this link,\nyou're sending them to me?\n\n245\n00:12:21.760 --> 00:12:23.150\nI'm just gonna discard them.\n\n246\n00:12:23.150 --> 00:12:27.810\nIt allows the traffic to flow,\nbut it discards the BPDUs.\n\n247\n00:12:27.810 --> 00:12:28.390\nAll right?\n\n248\n00:12:28.390 --> 00:12:32.711\nSo that's a good way to stop people\nfrom trying to participate in your\n\n249\n00:12:32.711 --> 00:12:33.763\nspanning tree.\n\n250\n00:12:33.763 --> 00:12:36.211\nIt can be useful for stopping people\ntrying to attack your network.\n\n251\n00:12:36.211 --> 00:12:39.673\nYou know, trying to jump in and\nparticipate in a spanning tree, and\n\n252\n00:12:39.673 --> 00:12:43.016\nyou really shouldn't be getting\nBPDUs on an access port anyway,\n\n253\n00:12:43.016 --> 00:12:47.360\nunless it happens to be like a VoIP phone\nwhere you might be receiving those.\n\n254\n00:12:47.360 --> 00:12:50.565\nAnd so in those scenarios, maybe you\nneed them there, maybe you don't.\n\n255\n00:12:50.565 --> 00:12:55.826\nBut on a regular port, like I might just\ntake one of my other ports fa1/0/13 and\n\n256\n00:12:55.826 --> 00:12:58.210\nI might turn on the BPDU filter there.\n\n257\n00:12:58.210 --> 00:13:00.870\nIf you send me a BPDU,\nI'm just gonna discard it.\n\n258\n00:13:00.870 --> 00:13:05.920\nSo the way we do that is we just\ncome right in and we set it on\n\n259\n00:13:05.920 --> 00:13:10.943\nthe interface by saying spanning-tree\n\n260\n00:13:10.943 --> 00:13:15.330\nbpdufilter enable.\n\n261\n00:13:15.330 --> 00:13:17.036\nAll right?\nAnd that's gonna turn it on, and\n\n262\n00:13:17.036 --> 00:13:20.550\nif I get any BPD use here, it'll generate\na log message, but the port stays up.\n\n263\n00:13:20.550 --> 00:13:21.789\nWe filter it out, and that's it.\n\n264\n00:13:21.789 --> 00:13:25.061\nAnd, we can turn it on globally too, you\nprobably saw it just a second ago when I\n\n265\n00:13:25.061 --> 00:13:27.310\nwas showing you the global command for\nthe other one.\n\n266\n00:13:27.310 --> 00:13:33.950\nBut if we do a spanning-tree portfast\nyou'll see bpdufilter right there.\n\n267\n00:13:33.950 --> 00:13:39.000\nI'm gonna misspell that every time in\nthis show, so I can do bpdufilter and\n\n268\n00:13:39.000 --> 00:13:40.940\nwe can set that to be the default.\n\n269\n00:13:40.940 --> 00:13:44.698\nSo now our access ports,\nwe can set them to be PortFast default and\n\n270\n00:13:44.698 --> 00:13:46.450\nBPDU filter default.\n\n271\n00:13:46.450 --> 00:13:49.260\nAnd now they can really\nonly act as an access port.\n\n272\n00:13:49.260 --> 00:13:51.960\nIf somebody plugs in a switch, it can\nrunning spanning-tree all it wants, and\n\n273\n00:13:51.960 --> 00:13:53.170\nwe're gonna ignore it.\n\n274\n00:13:53.170 --> 00:13:54.740\nAnd then off they go.\n\n275\n00:13:54.740 --> 00:13:57.150\n>> Cool,\nthat's some nice technology we have there.\n\n276\n00:13:57.150 --> 00:13:58.810\nThank you Cisco very much.\n\n277\n00:13:58.810 --> 00:14:00.840\nNow a topic that comes up a lot,\n\n278\n00:14:00.840 --> 00:14:04.750\nespecially when you're talking about\nanything with a port on it, is, and one of\n\n279\n00:14:04.750 --> 00:14:10.010\nour viewers in the chatroom just brought\nthis up, is what about flapping ports?\n\n280\n00:14:10.010 --> 00:14:11.890\nThis is a common thing that happens.\n\n281\n00:14:11.890 --> 00:14:14.940\nHas Cisco comes to our\nrescue on this as well?\n\n282\n00:14:14.940 --> 00:14:18.040\n>> Yeah, there's actually a couple\nof solutions for flapping ports.\n\n283\n00:14:18.040 --> 00:14:22.410\nFirst off, a flapping port is a port\nthat comes up and it goes back down.\n\n284\n00:14:23.550 --> 00:14:25.110\nAnd then it comes back up,\nand then it goes back down.\n\n285\n00:14:25.110 --> 00:14:26.580\nAnd it just keeps doing that over and\nover and over again.\n\n286\n00:14:26.580 --> 00:14:28.040\nAnd it might be very fast.\n\n287\n00:14:28.040 --> 00:14:28.920\nUp down, up down, up down.\n\n288\n00:14:28.920 --> 00:14:29.562\n>> It's a good time.\n\n289\n00:14:29.562 --> 00:14:30.090\n[LAUGH]\n>> Or\n\n290\n00:14:30.090 --> 00:14:33.000\nthere might be a series of\nseconds in between it, right?\n\n291\n00:14:33.000 --> 00:14:38.140\nAnd it almost always is caused\nby unidirectional traffic.\n\n292\n00:14:38.140 --> 00:14:39.810\nIn other words, I see a link light.\n\n293\n00:14:39.810 --> 00:14:40.510\nI think the port is up.\n\n294\n00:14:40.510 --> 00:14:41.270\nI start sending data.\n\n295\n00:14:41.270 --> 00:14:43.370\nAnd I don't hear anything back.\n\n296\n00:14:43.370 --> 00:14:47.290\nAnd if I don't hear anything back for\nlong enough, then I shut the port down.\n\n297\n00:14:47.290 --> 00:14:49.080\nAnd then, I try and bring it back up.\n\n298\n00:14:49.080 --> 00:14:51.000\nI see that link light again, so\nI try and bring it back up but\n\n299\n00:14:51.000 --> 00:14:54.510\nit sort of sending traffic, I don't\nget anything back and we shut it down.\n\n300\n00:14:54.510 --> 00:14:57.290\nSo that's what almost always\ncauses a flapping port.\n\n301\n00:14:57.290 --> 00:14:59.615\nIt's usually a layer 2 protocol issue.\n\n302\n00:14:59.615 --> 00:15:02.025\nSo there's something with ethernet or\n\n303\n00:15:02.025 --> 00:15:03.925\none of your wires in your\ncable isn't connecting.\n\n304\n00:15:03.925 --> 00:15:05.165\nYou end up with that\nunidirectional traffic.\n\n305\n00:15:05.165 --> 00:15:07.815\nThat's what almost always\ncauses a flapping link.\n\n306\n00:15:07.815 --> 00:15:11.315\nThere's some route and tunnel\nmisconfiguration that can create the same\n\n307\n00:15:11.315 --> 00:15:13.750\nthing and\nit's still a layer two problem but\n\n308\n00:15:13.750 --> 00:15:15.470\nit's just virtual instead\nof physical at that point.\n\n309\n00:15:15.470 --> 00:15:16.830\nYou end up with the same result.\n\n310\n00:15:16.830 --> 00:15:20.570\nSo we can use technologies\nat UDLD to fix that.\n\n311\n00:15:20.570 --> 00:15:26.290\nUDLD can watch that link and make sure\nwe're getting bidirectional traffic.\n\n312\n00:15:26.290 --> 00:15:27.540\nUDLD sends a message.\n\n313\n00:15:27.540 --> 00:15:29.972\nIf it doesn't get the response back,\nit knows the port's not up and\n\n314\n00:15:29.972 --> 00:15:30.707\nit can hold it down.\n\n315\n00:15:30.707 --> 00:15:32.193\nAnd we don't have to worry\nabout the flapping port.\n\n316\n00:15:32.193 --> 00:15:35.610\nSo UDLD is how we normally solve this.\n\n317\n00:15:35.610 --> 00:15:39.545\nBut if we want to be on the safe side,\nthere is a secondary catch\n\n318\n00:15:39.545 --> 00:15:43.576\nthat we can do here in spanning\ntree that's called loop guard.\n\n319\n00:15:43.576 --> 00:15:47.828\nAnd loop guard can run and it can say,\nall right, this interface came back up but\n\n320\n00:15:47.828 --> 00:15:52.232\nI'm not gonna fully admit it in spanning\ntree until I'm sure there's not a loop.\n\n321\n00:15:52.232 --> 00:15:54.512\nSo I'm gonna wait until I hear a BPDU.\n\n322\n00:15:54.512 --> 00:15:58.567\nThe link might be up, but\nI'm gonna wait for that BPDU and\n\n323\n00:15:58.567 --> 00:16:02.804\nif I don't get BPDU,\nthen that link is probably not valid.\n\n324\n00:16:02.804 --> 00:16:05.544\nAnd maybe I'm receiving the BPDU, but\n\n325\n00:16:05.544 --> 00:16:10.370\nif I'm not able to send to the other\nside then it's unidirectional.\n\n326\n00:16:10.370 --> 00:16:11.830\nI'm not gonna allow that either.\n\n327\n00:16:11.830 --> 00:16:13.317\nAnd so loopguard is doing a double check.\n\n328\n00:16:13.317 --> 00:16:15.734\nNow loopguard slows things down a bit,\nright.\n\n329\n00:16:15.734 --> 00:16:19.555\nYou've got things like Rapid Spanning Tree\nthat speed up these connections.\n\n330\n00:16:19.555 --> 00:16:23.358\nLoopguard slows it back down again because\nit's doing that secondary check but\n\n331\n00:16:23.358 --> 00:16:24.108\nyou can use it.\n\n332\n00:16:24.108 --> 00:16:27.690\nUDLD is the preferred method, because it's\ngonna keep spanning tree out of the mix,\n\n333\n00:16:27.690 --> 00:16:30.842\nand that means spanning tree will have\nto do less recalculations, right.\n\n334\n00:16:30.842 --> 00:16:34.445\nBut if we do loopguard, spanning tree\nis not changing its topology, but\n\n335\n00:16:34.445 --> 00:16:38.348\nit's running loopguard, and so it's\nkinda creates a little extra burden for\n\n336\n00:16:38.348 --> 00:16:39.400\nthat process.\n\n337\n00:16:39.400 --> 00:16:41.950\nAnd if you're running more than\none instance of spanning tree,\n\n338\n00:16:41.950 --> 00:16:46.147\nyou're gonna have to run loopguard for\neach of those instances.\n\n339\n00:16:46.147 --> 00:16:47.980\nRight?\nSo that's why UDLD is preferred.\n\n340\n00:16:47.980 --> 00:16:50.812\nBut if you wanna use loopguard\nit's not It's not hard to enable.\n\n341\n00:16:50.812 --> 00:16:55.942\nBasically you can turn it on by\ndefault by doing spanning-tree\n\n342\n00:16:55.942 --> 00:17:01.517\nloopguard default, and that's gonna\nturn it on for all of my ports.\n\n343\n00:17:01.517 --> 00:17:02.429\nBut in reality,\n\n344\n00:17:02.429 --> 00:17:06.480\nit's not normally our access ports\nthat we care about with this, right.\n\n345\n00:17:06.480 --> 00:17:08.555\nWe normally care about our trunk and\nour uplink ports and\n\n346\n00:17:08.555 --> 00:17:10.470\nso that's where we normally turn it on.\n\n347\n00:17:10.470 --> 00:17:13.930\nAnd so, instead of enabling it globally,\nI don't want this enable for\n\n348\n00:17:13.930 --> 00:17:16.870\nall my access ports, so\nI'm gonna jump into a trunk port.\n\n349\n00:17:17.970 --> 00:17:21.880\nAnd in the trunk port,\nI can say spanning-tree and\n\n350\n00:17:21.880 --> 00:17:26.076\nthen we can come in and we can say\nthat we want to turn on loopguard for\n\n351\n00:17:26.076 --> 00:17:30.420\nit by just designating it,\nright here, spanning-tree loopguard.\n\n352\n00:17:30.420 --> 00:17:31.660\nOne of the easier commands.\n\n353\n00:17:31.660 --> 00:17:34.170\nAnd, oh, does my switch not support it?\n\n354\n00:17:34.170 --> 00:17:35.080\nThat would be funny.\n\n355\n00:17:35.080 --> 00:17:37.660\nNot every switch supports it,\nmine might not.\n\n356\n00:17:39.040 --> 00:17:42.140\nLet's designate a VLAN and\nsee if it's requiring it.\n\n357\n00:17:42.140 --> 00:17:44.560\nNo, shoot, my switch does not support it.\n\n358\n00:17:44.560 --> 00:17:47.060\nLet's see if it's nested\nunder portfast for me.\n\n359\n00:17:47.060 --> 00:17:50.770\nThis is why it's important to make\nsure you check your feature set and\n\n360\n00:17:50.770 --> 00:17:54.310\nuse the iOS feature navigator on Cisco's\nweb site to see what features you support.\n\n361\n00:17:54.310 --> 00:17:56.620\nLooks like I don't have\nloopguard support on this one.\n\n362\n00:17:56.620 --> 00:18:00.590\nSo for me, UDLD is gonna be my only\nchoice on this particular switch.\n\n363\n00:18:00.590 --> 00:18:02.900\nOn another switch I might be\nable to use loopguard, so\n\n364\n00:18:02.900 --> 00:18:04.910\ndefinitely check your IOS on that.\n\n365\n00:18:04.910 --> 00:18:09.280\nNow if you turn on loopguard it's gonna\nstart monitoring the system and you'll\n\n366\n00:18:09.280 --> 00:18:13.260\nsee whether or not, if there's a flapping\nlink it's not gonna impact spanning tree.\n\n367\n00:18:13.260 --> 00:18:17.420\nBut there are a few different kinda\ncommands that you can use to see\n\n368\n00:18:17.420 --> 00:18:18.060\nwhat's going on,\n\n369\n00:18:18.060 --> 00:18:20.870\nto see if that's happening because\nthese ports are now being suppressed.\n\n370\n00:18:20.870 --> 00:18:24.510\nAnd when you do show spanning-tree\nyou see that output for\n\n371\n00:18:24.510 --> 00:18:28.410\nall the different VLANs\nthat are on the network.\n\n372\n00:18:28.410 --> 00:18:32.160\nAnd so you can do other commands\nlike show spanning-tree summary.\n\n373\n00:18:32.160 --> 00:18:36.460\nAnd that will give you some more\nsummarized information for your VLANS and\n\n374\n00:18:36.460 --> 00:18:39.180\nin here you can see like\nwhat ports are blocking,\n\n375\n00:18:39.180 --> 00:18:42.650\nlistening, learning forwarding,\nwhich ones have spanning tree active.\n\n376\n00:18:42.650 --> 00:18:44.840\nAnd so you can get an idea of which\nVLAN are participating in that.\n\n377\n00:18:44.840 --> 00:18:48.950\nBut more importantly you can see right\nhere whether loopguard is on by default.\n\n378\n00:18:48.950 --> 00:18:51.640\nAnd you can see whether all these\nthings are turned on by default or not.\n\n379\n00:18:51.640 --> 00:18:54.200\nIt's a great way to\ncheck that really quick.\n\n380\n00:18:54.200 --> 00:18:55.780\nAnd you can do it on the interface too.\n\n381\n00:18:55.780 --> 00:19:00.080\nSo you can do show\nspanning-tree interface, and\n\n382\n00:19:00.080 --> 00:19:02.710\nyou can highlight one\ninterface in particular.\n\n383\n00:19:02.710 --> 00:19:07.190\nAnd so you can look at that and it'll\nshow you details about that interface and\n\n384\n00:19:07.190 --> 00:19:11.770\nif you add the detail command,\nyou'll see the real details.\n\n385\n00:19:11.770 --> 00:19:14.530\nAnd in here,\nif we had loopguard turned on,\n\n386\n00:19:14.530 --> 00:19:17.410\nit would say it in here,\nas well as portfast and the other things,\n\n387\n00:19:17.410 --> 00:19:21.650\nthey would show up in here as to whether\nor not they were actually being supported.\n\n388\n00:19:21.650 --> 00:19:24.580\nSo in my case apparently is not.\n\n389\n00:19:25.760 --> 00:19:28.531\n>> [LAUGH] UDLD for Don,\nno loopguard for him.\n\n390\n00:19:28.531 --> 00:19:31.065\n>> Maybe I just wanna try something\nDaniel, we'll experiment here,\n\n391\n00:19:31.065 --> 00:19:33.570\nI'm just gonna see if it will\nlet me turn it on globally.\n\n392\n00:19:33.570 --> 00:19:36.380\nIf I turn it on globally.\n\n393\n00:19:36.380 --> 00:19:44.080\nSo globally, we just say basically\nspanning-tree loopguard default.\n\n394\n00:19:44.080 --> 00:19:45.940\nIt is letting me turn it on globally.\n\n395\n00:19:45.940 --> 00:19:47.360\nThat is interesting.\n\n396\n00:19:47.360 --> 00:19:52.930\nSo now that it's on,\nwell let me turn it off,\n\n397\n00:19:52.930 --> 00:19:56.510\nI'm gonna learn something new on this, no.\n\n398\n00:19:56.510 --> 00:19:59.890\nSo I guess on this switch I just don't\nhave per-interface commands for it,\n\n399\n00:19:59.890 --> 00:20:02.620\nand it's odd because usually you'd\nwanna configure this per interface,\n\n400\n00:20:02.620 --> 00:20:03.380\nis where you'd want it.\n\n401\n00:20:03.380 --> 00:20:05.190\nBut this one doesn't seem to support it.\n\n402\n00:20:05.190 --> 00:20:09.600\nBut so I am now running loopguard, and so\nif I do that show spanning-tree summary,\n\n403\n00:20:09.600 --> 00:20:12.980\nwhen I go in there and look at\nthe details, I'll see that my loopguard,\n\n404\n00:20:12.980 --> 00:20:15.910\noh wait that's misconfiguration guard,\nwhere is loopguard, there.\n\n405\n00:20:15.910 --> 00:20:19.840\nLoopguard is enabled and\nup and running, there we go.\n\n406\n00:20:19.840 --> 00:20:23.210\n>> Now Don, this is one of, I've been\nthinking about this for a little bit now.\n\n407\n00:20:23.210 --> 00:20:25.830\nWe've been talking about spanning tree and\n\n408\n00:20:25.830 --> 00:20:29.010\nhow we can root to elections and\nthings like that.\n\n409\n00:20:29.010 --> 00:20:31.860\nBut if I'm a little more\non the nefarious side and\n\n410\n00:20:31.860 --> 00:20:35.880\nI've decided, I need to take over this\nnetwork, I need to get some access to it.\n\n411\n00:20:35.880 --> 00:20:39.821\nAnd I just grab a Cisco switch and\nI set the priority nice and low and\n\n412\n00:20:39.821 --> 00:20:42.699\nplug it into a port, and\nwhat's gonna happen?\n\n413\n00:20:42.699 --> 00:20:44.770\nI'm gonna become the root bridge, right?\n\n414\n00:20:44.770 --> 00:20:46.230\n>> Yeah, you certainly could.\n\n415\n00:20:46.230 --> 00:20:47.880\nYou guys might have noticed\nthrough all of this,\n\n416\n00:20:47.880 --> 00:20:50.500\nhow many passwords have we\nattached to spanning tree?\n\n417\n00:20:50.500 --> 00:20:51.190\nNone.\n\n418\n00:20:51.190 --> 00:20:51.740\nRight?\n\n419\n00:20:51.740 --> 00:20:54.760\nAnd that's why, way back in the first\nepisode, I said, I hate the dynamic stuff.\n\n420\n00:20:54.760 --> 00:20:57.249\nLet's just statically set\nwhat's gonna be a trunk or\n\n421\n00:20:57.249 --> 00:20:59.581\nwhat we're going to allow\nthese BPDUs to come in.\n\n422\n00:20:59.581 --> 00:21:03.003\nAnd that helps to protect us quite a bit,\nright?\n\n423\n00:21:03.003 --> 00:21:05.994\nBut if you're a little more open,\nthat can be a problem and\n\n424\n00:21:05.994 --> 00:21:09.106\nif an attacker comes in,\nthey could bring their own switch,\n\n425\n00:21:09.106 --> 00:21:12.930\nset that priority to 4096,\nconnect up and become the root.\n\n426\n00:21:12.930 --> 00:21:16.744\nAnd now, they're influencing where traffic\nflows and odds are a lot of traffic is\n\n427\n00:21:16.744 --> 00:21:19.965\ngonna flow through them that\nwouldn't normally flow through them.\n\n428\n00:21:19.965 --> 00:21:20.913\nNot all traffic, right?\n\n429\n00:21:20.913 --> 00:21:24.114\nAll traffic does not have to flow through\nthe root, but a good bit of it will and\n\n430\n00:21:24.114 --> 00:21:25.852\nthat's going to influence the network.\n\n431\n00:21:25.852 --> 00:21:31.070\nSo, if we want to prevent that there's\nanother technology called Root Guard.\n\n432\n00:21:31.070 --> 00:21:35.050\nNow if you're using BPDU guard, that'll\ntake care of the attacker right there.\n\n433\n00:21:35.050 --> 00:21:37.680\nBut it can be a little aggressive.\n\n434\n00:21:37.680 --> 00:21:40.890\nIf you use BPDU filter that can\ntake care of the attacker but\n\n435\n00:21:40.890 --> 00:21:44.060\nit's not aggressive at all and\nthey still can participate on the network.\n\n436\n00:21:44.060 --> 00:21:46.010\nThey just don't participate\nin spanning tree.\n\n437\n00:21:46.010 --> 00:21:48.850\nIf I'm okay with them\nparticipating in spanning tree\n\n438\n00:21:48.850 --> 00:21:52.270\nI just don't want them to be in the root,\nthat's where I can use root guard.\n\n439\n00:21:52.270 --> 00:21:53.688\nAnd root guard will step in and\n\n440\n00:21:53.688 --> 00:21:57.052\nsay I'm fine with receiving BPUs\njust don't try and become the root.\n\n441\n00:21:57.052 --> 00:21:58.691\nIf you try and tell me you're the root or\n\n442\n00:21:58.691 --> 00:22:01.738\nthat you got some better way to get\nto the root, I'm gonna block you off.\n\n443\n00:22:01.738 --> 00:22:03.727\nAll right, that's what root guard does and\n\n444\n00:22:03.727 --> 00:22:06.050\nit's another one that's\nconfigured basically.\n\n445\n00:22:06.050 --> 00:22:09.324\nI mean, you guys are kinda seeing the\npattern of how these things are enabled\n\n446\n00:22:09.324 --> 00:22:10.977\nand disabled, that we can turn it on.\n\n447\n00:22:10.977 --> 00:22:14.312\nRoot guard, you typically\nturn on the interface, right?\n\n448\n00:22:14.312 --> 00:22:18.596\nNot necessarily globally, so,\ncuz if you turn it on everywhere,\n\n449\n00:22:18.596 --> 00:22:21.590\nyou gotta have a root port somewhere,\nright?\n\n450\n00:22:21.590 --> 00:22:23.097\nSo that's why we don't\nnormally do it globally.\n\n451\n00:22:23.097 --> 00:22:25.286\nBut, you also usually\nonly do it on uplinks or\n\n452\n00:22:25.286 --> 00:22:27.659\nports that could potentially\nbecome an uplink.\n\n453\n00:22:27.659 --> 00:22:33.415\nSo if I take a port like, for\nme, fa1/0/22, that guy, right?\n\n454\n00:22:33.415 --> 00:22:34.770\nActually, who is my root port?\n\n455\n00:22:34.770 --> 00:22:36.597\nI'll take my current root port.\n\n456\n00:22:36.597 --> 00:22:40.541\nSo whoever my root port is, I'm gonna take\nothat one, my current root port is 22.\n\n457\n00:22:40.541 --> 00:22:41.351\nHow convenient.\n\n458\n00:22:41.351 --> 00:22:44.139\nSo I'm gonna get in this port and\nI'm gonna turn on root guard.\n\n459\n00:22:44.139 --> 00:22:47.956\nI'll just come in and\nI'll say spanning-tree and\n\n460\n00:22:47.956 --> 00:22:52.840\nunder spanning tree you'll see\nsome of our different options and\n\n461\n00:22:52.840 --> 00:22:56.500\nroot guard is not in the list but\nwe do have guard.\n\n462\n00:22:56.500 --> 00:23:00.300\nAnd that's how we switch to\nour guard mode and under guard\n\n463\n00:23:00.300 --> 00:23:04.615\nthat's where I can do the root, and\noh, there's loopguard, holy crap.\n\n464\n00:23:04.615 --> 00:23:07.820\nSo, I guess I just have the wrong\ncommand or that's changed, so.\n\n465\n00:23:07.820 --> 00:23:08.640\n>> You know what?\n\n466\n00:23:08.640 --> 00:23:11.690\nI was looking at this before the show, and\n\n467\n00:23:11.690 --> 00:23:17.111\nsome versions of the switches themselves\ndo have some kind of sweep soft.\n\n468\n00:23:17.111 --> 00:23:18.224\nWell, that's nice and confusing.\n\n469\n00:23:18.224 --> 00:23:19.354\n>> Yeah [LAUGH].\n\n470\n00:23:19.354 --> 00:23:20.780\nAll right, well, I screwed this one up.\n\n471\n00:23:20.780 --> 00:23:24.994\nOh, Alexander actually just look at\nthe same thing in the chatterman.\n\n472\n00:23:24.994 --> 00:23:26.810\n>> [LAUGH]\n>> That's too funny.\n\n473\n00:23:26.810 --> 00:23:29.110\nAll right, so\nif we want to turn on loopguard for\n\n474\n00:23:29.110 --> 00:23:30.380\nthe interface, well, there we go.\n\n475\n00:23:30.380 --> 00:23:32.790\nSo spanning-tree guard loop.\n\n476\n00:23:32.790 --> 00:23:33.330\nThat will do that.\n\n477\n00:23:33.330 --> 00:23:37.241\nBut the one I'm looking for,\nstumbled on this by accident,\n\n478\n00:23:37.241 --> 00:23:39.324\nis spanning-tree guard root.\n\n479\n00:23:39.324 --> 00:23:43.247\nAnd now if I see somebody sending me\nBPDUs and they're trying to be the root,\n\n480\n00:23:43.247 --> 00:23:44.978\nI'm gonna take offense to that.\n\n481\n00:23:44.978 --> 00:23:45.633\nAnd there it is.\n\n482\n00:23:45.633 --> 00:23:47.317\nYou can see my root guard changed.\n\n483\n00:23:47.317 --> 00:23:48.050\nIt enabled.\n\n484\n00:23:48.050 --> 00:23:50.200\nAnd then root guard blocking.\n\n485\n00:23:50.200 --> 00:23:51.062\nI just blocked that.\n\n486\n00:23:51.062 --> 00:23:52.520\nThey tried to become the root for VLAN 1.\n\n487\n00:23:52.520 --> 00:23:54.130\nHow dare they!\n\n488\n00:23:54.130 --> 00:23:55.434\nAnd I'm gonna stop that.\n\n489\n00:23:55.434 --> 00:23:58.140\nNow, when I stop that, what do I do?\n\n490\n00:23:58.140 --> 00:24:00.090\nI flag the port as inconsistent.\n\n491\n00:24:00.090 --> 00:24:01.200\nIt's a dangerous port.\n\n492\n00:24:01.200 --> 00:24:03.912\nNow, that switch has links\nto other switches,and so\n\n493\n00:24:03.912 --> 00:24:05.990\nit might still be\nconnecting in other ways.\n\n494\n00:24:05.990 --> 00:24:08.760\nIt could still potentially become\nthe root to another switch.\n\n495\n00:24:08.760 --> 00:24:09.900\nBut it's not doing it on this port.\n\n496\n00:24:09.900 --> 00:24:11.550\nIt's not doing it on my watch, right?\n\n497\n00:24:11.550 --> 00:24:15.120\nBut here it's been blocked out and\nthat's kind of there.\n\n498\n00:24:15.120 --> 00:24:17.960\nThere's a neat command\nyou can use to see this.\n\n499\n00:24:17.960 --> 00:24:21.959\nIf you run show spanning-tree, that guy,\n\n500\n00:24:21.959 --> 00:24:26.931\nthere's another little kind\nof tag on we can do which is\n\n501\n00:24:26.931 --> 00:24:32.390\nshow spanning-tree inconsistentports,\nall right?\n\n502\n00:24:32.390 --> 00:24:37.520\nSo, it's not like error disabled,\nwhere we see it on the interface itself.\n\n503\n00:24:37.520 --> 00:24:40.390\nHere it's just inconsistent\nin spanning tree.\n\n504\n00:24:40.390 --> 00:24:42.590\nThey try to become the root,\nand I don't like that.\n\n505\n00:24:42.590 --> 00:24:45.920\nAnd so when I look at it,\nthere it is on VLAN 1,\n\n506\n00:24:45.920 --> 00:24:49.810\nthat particular port,\nthe root is inconsistent.\n\n507\n00:24:49.810 --> 00:24:52.930\nWe think the root should be one thing,\nsomebody we're connected into\n\n508\n00:24:52.930 --> 00:24:56.660\nthinks it should be something different,\nand we're stopping that.\n\n509\n00:24:56.660 --> 00:24:58.390\nThat doesn't mean we're safe, right?\n\n510\n00:24:58.390 --> 00:24:59.670\nWe could still have a problem.\n\n511\n00:24:59.670 --> 00:25:01.440\nRemember, my topology.\n\n512\n00:25:01.440 --> 00:25:03.520\nI'm blocking that right here on this link.\n\n513\n00:25:03.520 --> 00:25:07.871\nI'm not allowing this switch to become\nthe root, my core is blocking that.\n\n514\n00:25:07.871 --> 00:25:11.499\nBut this guy could still say,\nhey I'm the root, Intel core 2, and\n\n515\n00:25:11.499 --> 00:25:13.440\nthen core 2 could pass it on.\n\n516\n00:25:13.440 --> 00:25:18.060\nAnd now, my switch is gonna accept that,\nand this guy still became the route.\n\n517\n00:25:18.060 --> 00:25:20.100\nSo it's not a perfect solution.\n\n518\n00:25:20.100 --> 00:25:23.688\nBut it does help, especially if you\nimplement it throughout your network.\n\n519\n00:25:23.688 --> 00:25:27.440\nYou implement root guard on what\nare called your edge ports,\n\n520\n00:25:27.440 --> 00:25:29.100\nthe edge of spanning tree.\n\n521\n00:25:29.100 --> 00:25:30.900\nIn other words, beyond these ports,\n\n522\n00:25:30.900 --> 00:25:33.300\nthere should be no switches\nparticipating as spanning tree.\n\n523\n00:25:33.300 --> 00:25:36.120\nSo that's my edge.\nAnd normally you'd use BPDU Filter or\n\n524\n00:25:36.120 --> 00:25:38.360\nBPDU Guard to designate that.\n\n525\n00:25:38.360 --> 00:25:42.310\nBut, if we're just concerned about\nthe root side, then that's were we do it.\n\n526\n00:25:42.310 --> 00:25:47.070\nIf I've got a switch that I know is\non a stick, it's got one connection,\n\n527\n00:25:47.070 --> 00:25:48.490\none way in and one way out.\n\n528\n00:25:48.490 --> 00:25:51.530\nI don't want it to become the root, so\nI might use root guard to prevent that.\n\n529\n00:25:51.530 --> 00:25:54.860\nBut, in reality, I just set a higher\npriority and that would be that, right?\n\n530\n00:25:54.860 --> 00:25:58.720\nSo, there's more than one way to solve the\nsolution, and it's kinda up to you to look\n\n531\n00:25:58.720 --> 00:26:02.850\nat these and figure out which one\nworks best in your environment.\n\n532\n00:26:02.850 --> 00:26:05.640\n>> All right, Don, well then, plenty\nof guards, lots of cool enhancements.\n\n533\n00:26:05.640 --> 00:26:09.350\nThank you Cisco for all the neat\nstuff that you put into your iOS for\n\n534\n00:26:09.350 --> 00:26:12.180\nus to learn and\nget our optimized networks.\n\n535\n00:26:12.180 --> 00:26:13.330\nThat's the way we like them.\n\n536\n00:26:13.330 --> 00:26:14.980\nNow, is there anything else\nthat we need to cover, or\n\n537\n00:26:14.980 --> 00:26:17.760\nhave we finally reached\nthe end of spanning tree?\n\n538\n00:26:17.760 --> 00:26:18.910\n>> I do wanna mention one more,\n\n539\n00:26:18.910 --> 00:26:22.780\nthis was one that was asked about\nduring the break, which is UplinkFast.\n\n540\n00:26:22.780 --> 00:26:25.450\nIt's not on the exam objectives,\nand I'm not a big fan of it,\n\n541\n00:26:25.450 --> 00:26:26.619\nI never use it myself.\n\n542\n00:26:27.720 --> 00:26:30.480\nPortFast, when you plug in a new PC,\n\n543\n00:26:30.480 --> 00:26:35.660\nit gives that port the benefit of\nthe doubt and it brings it up, right?\n\n544\n00:26:35.660 --> 00:26:38.720\nUplinkFast does the same thing for\nyour uplinks.\n\n545\n00:26:38.720 --> 00:26:40.650\nSo if you've got trunks,\nit's basically saying,\n\n546\n00:26:40.650 --> 00:26:43.090\nif you've got a trunk\nthat's an important line.\n\n547\n00:26:43.090 --> 00:26:45.030\nWe need it to come up fast, all right?\n\n548\n00:26:45.030 --> 00:26:48.300\nNow, that sounds like a good thing\nat first, and you can turn it on,\n\n549\n00:26:48.300 --> 00:26:50.690\nit's just kind of an addition to PortFast,\n\n550\n00:26:50.690 --> 00:26:54.410\nbut, there's a reason why we\ndon't do PortFast on trunks.\n\n551\n00:26:54.410 --> 00:26:56.460\nIf you're gonna have a loop,\nwhere's your loop gonna be?\n\n552\n00:26:56.460 --> 00:26:58.010\nIt's gonna be on the trunks, right?\n\n553\n00:26:58.010 --> 00:27:00.050\nYour uplinks between the switch,\nthat's where your loops come from,\n\n554\n00:27:00.050 --> 00:27:02.090\nthat's where your loop\nprotection needs to be.\n\n555\n00:27:02.090 --> 00:27:03.910\nIf you give it the benefit of\nthe doubt and bring it up,\n\n556\n00:27:03.910 --> 00:27:06.400\nyou're gonna have a loop for\na few moments.\n\n557\n00:27:06.400 --> 00:27:10.410\nAnd that loop could be 15 seconds,\nit could be 30 seconds.\n\n558\n00:27:10.410 --> 00:27:13.510\nBut if it's a high traffic network,\n\n559\n00:27:13.510 --> 00:27:16.220\nyour network can crawl to a halt\nwhile that loop is there.\n\n560\n00:27:16.220 --> 00:27:17.960\nAnd granted,\nit resolves itself in 30 seconds,\n\n561\n00:27:17.960 --> 00:27:21.340\nbut if you've got critical software,\nyou don't want 30 seconds of downtime.\n\n562\n00:27:21.340 --> 00:27:25.060\nYou would have been better off\nto have not done UplinkFast,\n\n563\n00:27:25.060 --> 00:27:30.385\nto have held that link down, because if\nwe've got other paths to follow, then\n\n564\n00:27:30.385 --> 00:27:33.770\nwe'll just keep you using those until this\none is clear, then we bring it up, right?\n\n565\n00:27:33.770 --> 00:27:35.790\nSo when you've got a triangle like mine,\n\n566\n00:27:35.790 --> 00:27:38.528\nyou've got another way to go while\nwaiting on this first one to come up.\n\n567\n00:27:38.528 --> 00:27:43.414\nSo UplinkFast is really only good\nwhen you have a single way in and\n\n568\n00:27:43.414 --> 00:27:45.100\na single way out, all right?\n\n569\n00:27:45.100 --> 00:27:48.410\nBut I always look at it this way,\nI think about what's happening here.\n\n570\n00:27:48.410 --> 00:27:51.377\nIf you got a single way in and\na single way out, and you're worried about\n\n571\n00:27:51.377 --> 00:27:55.030\nUplinkFast, how fast the link comes up,\nthat means your link was down, right?\n\n572\n00:27:55.030 --> 00:27:57.080\nSo you've already got a downtime.\n\n573\n00:27:57.080 --> 00:28:01.028\nAnd so really all you're doing is shaving\noff a few seconds on that downtime.\n\n574\n00:28:01.028 --> 00:28:03.170\nAnd the trade-off is not worth it,\nto me and\n\n575\n00:28:03.170 --> 00:28:04.480\nto a lot of network\nprofessionals out there.\n\n576\n00:28:04.480 --> 00:28:08.320\nSo, most people don't use UplinkFast\nin production, but it does exist,\n\n577\n00:28:08.320 --> 00:28:12.674\nit is there, you can use it, if you want\nthose uplinks to come up super mega fast,\n\n578\n00:28:12.674 --> 00:28:13.550\nso you can turn that on.\n\n579\n00:28:13.550 --> 00:28:16.620\n>> Well, very cool Don, thanks for\nthat info there on the UplinkFast, and\n\n580\n00:28:16.620 --> 00:28:18.400\neverything you've done today is great.\n\n581\n00:28:18.400 --> 00:28:19.700\nAwesome demonstrations.\n\n582\n00:28:19.700 --> 00:28:22.560\nHopefully everybody out there has\nfollowed along, enjoyed the show.\n\n583\n00:28:22.560 --> 00:28:26.330\nI know I certainly have, but\nwe're gonna go ahead and call it a day.\n\n584\n00:28:26.330 --> 00:28:27.220\nThanks for watching.\n\n585\n00:28:27.220 --> 00:28:30.400\nSigning off for ITProTV,\nI've been your host Daniel Lowry.\n\n586\n00:28:30.400 --> 00:28:31.070\n>> And I'm Don Pezet.\n\n587\n00:28:31.070 --> 00:28:31.970\n>> And we'll see you next time.\n\n588\n00:28:31.970 --> 00:28:32.876\n>> In part five.\n\n589\n00:28:32.876 --> 00:28:34.932\n[LAUGH] thousand.\n\n590\n00:28:34.932 --> 00:28:39.440\n[MUSIC]\n\n",
          "vimeoId": "141195761"
        },
        {
          "description": "In this episode, Daniel and Don explain and demonstrate how to monitor a switched network using Switch Port ANalyzer (SPAN). Here they detail reasons why you may wish to monitor network traffic and then walk you through configuring SPAN on a Cisco switch for those very reasons.",
          "length": "1867",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-7-span_and_rspan-100515-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-7-span_and_rspan-100515-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-7-span_and_rspan-100515-1-sm.jpg",
          "title": "SPAN and RSPAN",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.730 --> 00:00:16.500\nAll right, greetings everyone and\nwelcome to another episode of ITProTV.\n\n3\n00:00:16.500 --> 00:00:17.663\nI'm your host, Daniel Lowrie.\n\n4\n00:00:17.663 --> 00:00:21.195\nHere with me in the studio today\nis none other than Don Pezet.\n\n5\n00:00:21.195 --> 00:00:21.987\nHow's it going today, Don?\n\n6\n00:00:21.987 --> 00:00:23.310\n>> It is going great, Daniel.\n\n7\n00:00:23.310 --> 00:00:27.220\nExcited to be back on this show, and\njumping into a pretty neat topic.\n\n8\n00:00:27.220 --> 00:00:29.760\nIt's going to be one of those things\nthat your end users will never see,\n\n9\n00:00:29.760 --> 00:00:32.670\nbut you as an administrator\nmake a lot of use of, and\n\n10\n00:00:32.670 --> 00:00:37.030\nwhat I'm talking about is Span and R-Span,\nsome great port monitoring technologies.\n\n11\n00:00:37.030 --> 00:00:38.270\nSo it'll be a pretty good time.\n\n12\n00:00:38.270 --> 00:00:40.240\n>> Yeah, I'm looking forward to this one.\n\n13\n00:00:40.240 --> 00:00:44.392\nWe were talking about this a little while\nago and I was like, Span and R-Span, not\n\n14\n00:00:44.392 --> 00:00:48.555\nreally ringing any bells on there Don, and\nhe was like oh yeah, you know what it is.\n\n15\n00:00:48.555 --> 00:00:50.225\nIt's basically port right?\n\n16\n00:00:50.225 --> 00:00:53.465\n>> That's exactly it, and I run into it\nall the time where I tell people about\n\n17\n00:00:53.465 --> 00:00:56.635\nthe span which is switch,\nport, analyzer, right?\n\n18\n00:00:56.635 --> 00:00:58.890\nSo, on a Cisco system you got Span.\n\n19\n00:00:58.890 --> 00:01:02.400\nAnd people say I've never\nheard of that and they have.\n\n20\n00:01:02.400 --> 00:01:04.130\nIt's just cuz the only\none they call is a Span.\n\n21\n00:01:04.130 --> 00:01:08.020\nEverybody else calls it port mirroring and\nit's where we take the traffic on\n\n22\n00:01:08.020 --> 00:01:11.510\none switchboard and\nwe copy it to another port.\n\n23\n00:01:11.510 --> 00:01:16.080\nSo the switch has this hardware logic\nwhere as traffic comes in it looks at\n\n24\n00:01:16.080 --> 00:01:20.640\nthe frame, every frame is a source MAC\naddress and a destination MAC address.\n\n25\n00:01:20.640 --> 00:01:22.750\nAnd it looks at the destination\nMAC address, and\n\n26\n00:01:22.750 --> 00:01:27.550\nit says let me look at my MAC address\ntable and oh I see that MAC on port seven.\n\n27\n00:01:27.550 --> 00:01:30.650\nSo it sends the frames to port seven,\nand off it goes right?\n\n28\n00:01:30.650 --> 00:01:32.320\nThat's what a switch does.\n\n29\n00:01:32.320 --> 00:01:37.190\nWhen you use Span,\nyou say anytime I send traffic to\n\n30\n00:01:37.190 --> 00:01:40.940\nPort 7 also send a copy to Port 9.\n\n31\n00:01:40.940 --> 00:01:41.540\nRight?\n\n32\n00:01:41.540 --> 00:01:43.740\nWe just send another copy somewhere else.\n\n33\n00:01:43.740 --> 00:01:45.320\nPretty straight forward technology.\n\n34\n00:01:45.320 --> 00:01:48.350\nNow you might ask yourself,\nwhy do I use that?\n\n35\n00:01:48.350 --> 00:01:51.490\nAnd I can give you couple of great\nexamples of how you'd use it.\n\n36\n00:01:51.490 --> 00:01:53.410\nAnd the two most common\nthat I can think of,\n\n37\n00:01:53.410 --> 00:01:57.230\nwell let's start with the one that I\nuse the most, network troubleshooting.\n\n38\n00:01:57.230 --> 00:02:01.270\nIf you're troubling shooting your\nnetwork you want to have a good view\n\n39\n00:02:01.270 --> 00:02:05.020\nof what's going on in there, what kind\nof traffic is moving across the network?\n\n40\n00:02:05.020 --> 00:02:06.140\nAnd in an earlier episode,\n\n41\n00:02:06.140 --> 00:02:09.560\nactually it might even been part of the\nroute show where we talked about net flow,\n\n42\n00:02:09.560 --> 00:02:13.440\nnet flow is the system that works on\nthe switches and routers themselves.\n\n43\n00:02:13.440 --> 00:02:15.770\nAnd it monitors the communications\nthat are happening.\n\n44\n00:02:15.770 --> 00:02:17.700\nAnd it can report that\nto a reporting server.\n\n45\n00:02:17.700 --> 00:02:20.370\nYou can have third party monitoring\nsoftware that'll give you pie charts\n\n46\n00:02:20.370 --> 00:02:20.970\nand graphs.\n\n47\n00:02:20.970 --> 00:02:24.768\nAnd so, if your network is slow,\nyou can look at your bandwidth.\n\n48\n00:02:24.768 --> 00:02:28.431\nAnd you can say, all right,\nI've gotta 20MB Internet connection.\n\n49\n00:02:28.431 --> 00:02:30.630\nAnd I'm using 19MB of it.\n\n50\n00:02:30.630 --> 00:02:32.700\nThat's why my network's slow, right?\n\n51\n00:02:32.700 --> 00:02:35.520\nBut what is using the 19MB?\n\n52\n00:02:35.520 --> 00:02:36.480\nWhat protocols?\n\n53\n00:02:36.480 --> 00:02:37.420\nWhat workstations?\n\n54\n00:02:37.420 --> 00:02:38.910\nWho is it that's doing that?\n\n55\n00:02:38.910 --> 00:02:40.710\nThe switch in the router can't tell you.\n\n56\n00:02:40.710 --> 00:02:42.020\nNetflow can interpret it.\n\n57\n00:02:42.020 --> 00:02:43.760\nAnd it will show you, right?\n\n58\n00:02:43.760 --> 00:02:46.480\nBut netflow is just looking\nat the conversation.\n\n59\n00:02:46.480 --> 00:02:49.020\nIt doesn't actually carry any payload, so\n\n60\n00:02:49.020 --> 00:02:52.370\nit's not recording the actual\npackets that pass through.\n\n61\n00:02:52.370 --> 00:02:55.420\nSo if I want a full vision of that data,\n\n62\n00:02:55.420 --> 00:02:59.120\nincluding the payload,\nthat's where Span comes in.\n\n63\n00:02:59.120 --> 00:03:01.040\nSo if I get a call and they're saying,\n\n64\n00:03:01.040 --> 00:03:05.120\nlook, this network\nconnection is really slow.\n\n65\n00:03:05.120 --> 00:03:08.170\nI might mirror the port for\nthe Internet router so\n\n66\n00:03:08.170 --> 00:03:11.540\nthat way any traffic that's going to\nthe Internet also gets sent to my laptop.\n\n67\n00:03:12.570 --> 00:03:17.270\nAnd then I can run a sniffer and protocol\nanalyzer and look at that data and\n\n68\n00:03:17.270 --> 00:03:17.938\ninterpret it.\n\n69\n00:03:17.938 --> 00:03:21.190\nAll right now if you're not familiar with\nthose, you probably are if you're watching\n\n70\n00:03:21.190 --> 00:03:25.260\nthis show, but for those of you who aren't\nwhen it comes to network troubleshooting,\n\n71\n00:03:25.260 --> 00:03:28.840\nthere's two pieces of software that're\nsuper handy to have on your laptop for\n\n72\n00:03:28.840 --> 00:03:29.890\ntroubleshooting.\n\n73\n00:03:29.890 --> 00:03:32.390\nOne of them is what's\ncalled a packet sniffer.\n\n74\n00:03:32.390 --> 00:03:37.450\nWhen you plug your laptop into a network,\nyour laptop has a MAC address.\n\n75\n00:03:37.450 --> 00:03:40.140\nAnd when it received\ncommunications on the network,\n\n76\n00:03:40.140 --> 00:03:43.370\nit looks at the destination MAC\naddress to see if it matches yours.\n\n77\n00:03:43.370 --> 00:03:45.790\nAnd if it matches you receive the frame,\nand if it doesn't match,\n\n78\n00:03:45.790 --> 00:03:48.470\nyour network card will actually\ndiscard the traffic, throws it away.\n\n79\n00:03:48.470 --> 00:03:54.020\nAll right, if you want a packet sniffer,\nit can connect your network and\n\n80\n00:03:54.020 --> 00:03:56.530\nmove your network adapter into\nwhat's called promiscuous mode,\n\n81\n00:03:56.530 --> 00:03:58.190\nit's one of those funnier terms.\n\n82\n00:03:58.190 --> 00:04:00.825\nSo, we move it into promiscuous mode and\nit basically tells your network.\n\n83\n00:04:00.825 --> 00:04:04.845\nHey don't through away traffic that's\ndestined for a different MAC address.\n\n84\n00:04:04.845 --> 00:04:07.175\nGo ahead and\nreceive it because I want to record it.\n\n85\n00:04:07.175 --> 00:04:08.655\nAnd then the packet snipper can record it.\n\n86\n00:04:08.655 --> 00:04:09.845\nIt will record that data.\n\n87\n00:04:09.845 --> 00:04:13.035\nThat's what a packet snipper does,\nit just records.\n\n88\n00:04:13.035 --> 00:04:16.172\nNow this might be third party\nsoftware you've installed like on,\n\n89\n00:04:16.172 --> 00:04:19.902\non Windows there's WIN P Cap, right,\nthat's the packet capture for Windows.\n\n90\n00:04:19.902 --> 00:04:24.692\nIn Linux, Unix, Mac, we have TCP dump,\nthat can just dump that data right out and\n\n91\n00:04:24.692 --> 00:04:26.406\nthat's actually built into the OS.\n\n92\n00:04:26.406 --> 00:04:29.016\nSo, the thing though is\nit gathers that data,\n\n93\n00:04:29.016 --> 00:04:32.136\nand then it's just raw data in a file.\n\n94\n00:04:32.136 --> 00:04:34.496\nSo then we combine that with\na second piece of software called\n\n95\n00:04:34.496 --> 00:04:35.936\na protocol analyzer.\n\n96\n00:04:35.936 --> 00:04:39.860\nAnd a protocol analyzer can\ntake that dump of data and\n\n97\n00:04:39.860 --> 00:04:41.690\ntranslate into something\nthat is more human readable,\n\n98\n00:04:41.690 --> 00:04:44.480\nwhere we can see the layer,\ntwo layer, three layer, four headers.\n\n99\n00:04:44.480 --> 00:04:46.670\nYou can see the actual payload.\n\n100\n00:04:46.670 --> 00:04:48.870\nIf it's encrypted, it doesn't help you,\nbut if it's unencrypted,\n\n101\n00:04:48.870 --> 00:04:52.030\nyou can actually see what was going on\nin the network communication, right?\n\n102\n00:04:52.030 --> 00:04:53.750\nAnd that's really handy for\n\n103\n00:04:53.750 --> 00:04:57.614\nsomebody who's a network admin who's\ntrying to troubleshoot a problem.\n\n104\n00:04:57.614 --> 00:04:59.370\nNow, I used to do this in the past.\n\n105\n00:04:59.370 --> 00:05:02.290\nAnd Daniel, I worked with Daniel.\n\n106\n00:05:02.290 --> 00:05:03.450\nJeez, I don't know.\n\n107\n00:05:03.450 --> 00:05:04.428\nEight years ago,\nten [CROSSTALK] years ago?\n\n108\n00:05:04.428 --> 00:05:05.267\n>> Something like that.\n\n109\n00:05:05.267 --> 00:05:08.224\n>> And we were working at this\ntraining school and every now and\n\n110\n00:05:08.224 --> 00:05:11.030\nthen a machine would get\ninfected with a virus.\n\n111\n00:05:11.030 --> 00:05:13.240\nOr somebody would be running BitTorrent.\n\n112\n00:05:13.240 --> 00:05:15.420\nBitTorrent weren't as big,\nit was more like Napster back then.\n\n113\n00:05:15.420 --> 00:05:18.420\nAnd they'd be running something and\nconsuming our bandwidth and so.\n\n114\n00:05:18.420 --> 00:05:19.730\nWe'd get a report of that.\n\n115\n00:05:19.730 --> 00:05:21.690\nPeople'd think, boy the network is slow.\n\n116\n00:05:21.690 --> 00:05:24.150\nAnd, so, I'd breakout this hub.\n\n117\n00:05:24.150 --> 00:05:25.340\nIt had this little.\n\n118\n00:05:25.340 --> 00:05:25.950\nYou remember, Dan?\n\n119\n00:05:25.950 --> 00:05:27.900\n>> Oh yeah.\n>> It was a little five port, tan,\n\n120\n00:05:27.900 --> 00:05:29.280\npiece of junk hub.\n\n121\n00:05:29.280 --> 00:05:33.570\nAnd I would unplug our\nrouter from the switch.\n\n122\n00:05:33.570 --> 00:05:38.090\nI'd plug the router into the hub and then\nplug the hub into the switch, all right?\n\n123\n00:05:38.090 --> 00:05:42.258\nAnd then I could plug my laptop into that\nhub and intercept the communications.\n\n124\n00:05:42.258 --> 00:05:45.187\nNow why did I do that?\n\n125\n00:05:45.187 --> 00:05:45.863\n>> Cuz you're ghetto fabulous.\n\n126\n00:05:45.863 --> 00:05:46.583\n>> I know.\n\n127\n00:05:46.583 --> 00:05:47.745\n>> [LAUGH]\n>> Well,\n\n128\n00:05:47.745 --> 00:05:50.870\nit was cuz at the time we\ndidn't have a great switch.\n\n129\n00:05:50.870 --> 00:05:53.870\nBut the other thing was,\nif you think about a switch network,\n\n130\n00:05:55.230 --> 00:05:58.480\nwhen data is going from let's\nsay Daniel's laptop and\n\n131\n00:05:58.480 --> 00:06:03.210\nit's going to the router, well, his frames\nthat he builds up are gonna have a source\n\n132\n00:06:03.210 --> 00:06:07.250\nMAC address of his laptop and\na destination MAC address of the router.\n\n133\n00:06:07.250 --> 00:06:10.200\nSo when the switch receives that traffic,\n\n134\n00:06:10.200 --> 00:06:12.920\nit's gonna forward it right\nto the port with the router.\n\n135\n00:06:12.920 --> 00:06:16.350\nIf my laptop is plugged in\nto say the very next port.\n\n136\n00:06:16.350 --> 00:06:19.210\nMaybe Daniel's plugged into port one,\nI'm plugged into port two, and\n\n137\n00:06:19.210 --> 00:06:21.110\nthe router's plugged into port three.\n\n138\n00:06:21.110 --> 00:06:25.540\nWell, when Daniel communicates to the\nrouter it will skip my port entirely and\n\n139\n00:06:25.540 --> 00:06:26.980\ngo right to port three.\n\n140\n00:06:26.980 --> 00:06:28.980\nI don't even see the communication.\n\n141\n00:06:28.980 --> 00:06:30.960\nIf I were to just plug my\nlaptop into the switch and\n\n142\n00:06:30.960 --> 00:06:34.140\nstart monitoring,\nall I'm gonna see are broadcasts.\n\n143\n00:06:34.140 --> 00:06:36.010\nCuz those will send out to every part.\n\n144\n00:06:36.010 --> 00:06:38.420\nAnd unicasts destined for me.\n\n145\n00:06:38.420 --> 00:06:39.660\nThat's all I'm gonna see.\n\n146\n00:06:39.660 --> 00:06:41.618\nI'm not gonna see Daniel's communications.\n\n147\n00:06:41.618 --> 00:06:43.061\nSo it's not a useful way to monitor.\n\n148\n00:06:43.061 --> 00:06:46.195\nSo that's why I had this\ncrappy hub that I'd plug in.\n\n149\n00:06:46.195 --> 00:06:49.385\nAnd the worst part about it\nwas I had to unplug the router\n\n150\n00:06:49.385 --> 00:06:50.905\nto plug this thing in to get it in line.\n\n151\n00:06:50.905 --> 00:06:53.425\nI didn't wanna leave the hub in place all\nthe time cuz it was a cheap piece of junk.\n\n152\n00:06:53.425 --> 00:06:54.520\nI knew it was gonna fail.\n\n153\n00:06:54.520 --> 00:06:57.740\nSo, I had to create downtime to do this.\n\n154\n00:06:57.740 --> 00:07:01.950\nWouldn't it be nice if we could\nmonitor the network without downtime?\n\n155\n00:07:01.950 --> 00:07:03.210\nAnd that's what Span lets us do.\n\n156\n00:07:03.210 --> 00:07:06.700\nSpan would let me say I'm gonna take\nthe port that Daniel is plugged into or\n\n157\n00:07:06.700 --> 00:07:08.980\nI'm gonna take the port that\nthe router's plugged into, and\n\n158\n00:07:08.980 --> 00:07:12.150\njust send a copy of their traffic\nover to my port, and I can see it.\n\n159\n00:07:12.150 --> 00:07:14.470\nAnd, I didn't have to create any\ndowntime and I can turn it on and\n\n160\n00:07:14.470 --> 00:07:15.900\noff whenever I want.\n\n161\n00:07:15.900 --> 00:07:17.100\nAnd, that's that, right?\n\n162\n00:07:17.100 --> 00:07:20.030\nSo, it's a great way to monitor and\ntroubleshoot the network.\n\n163\n00:07:20.030 --> 00:07:21.720\nAnd that's what I'm gonna show\nyou guys in this episode today.\n\n164\n00:07:22.740 --> 00:07:24.860\nAnother use for Span, or\n\n165\n00:07:24.860 --> 00:07:29.410\nthe switchboard analyzer, is if you\nhave an intrusion detection system.\n\n166\n00:07:29.410 --> 00:07:30.920\nIDS, right?\n\n167\n00:07:30.920 --> 00:07:33.530\nNow, you'll hear these terms, IPS and IDS.\n\n168\n00:07:33.530 --> 00:07:37.000\nIntrusion prevention system and\nintrusion detection system.\n\n169\n00:07:37.000 --> 00:07:40.166\nAnd you hear a lot of people use them\ninterchangeably because the hardware\n\n170\n00:07:40.166 --> 00:07:40.735\nis the same.\n\n171\n00:07:40.735 --> 00:07:44.275\nIf you got to Cisco and you say, I want\nan IPS or if you go to Cisco and say,\n\n172\n00:07:44.275 --> 00:07:47.120\nI want an IDS,\nthey actually sell you the same hardware.\n\n173\n00:07:47.120 --> 00:07:51.453\nRight?\nYou know, maybe it's an IPS 4200 sensor or\n\n174\n00:07:51.453 --> 00:07:54.178\na An ASA with the IPS module in it.\n\n175\n00:07:54.178 --> 00:07:57.440\nAnd Cisco almost always calls them IPSs,\nright?\n\n176\n00:07:57.440 --> 00:08:02.120\nBut the only difference is\nreally where we install them.\n\n177\n00:08:02.120 --> 00:08:06.838\nAn IPS Intrusion Prevention System\nis a piece of hardware that\n\n178\n00:08:06.838 --> 00:08:09.387\nsits in the line of your traffic.\n\n179\n00:08:09.387 --> 00:08:13.574\nSo if you wanna protect yourself from your\nInternet host out there, Internet attacks,\n\n180\n00:08:13.574 --> 00:08:17.366\nyou'd plug your Internet router into\nthe IPS, then the IPS into the switch, so\n\n181\n00:08:17.366 --> 00:08:19.928\nall your Internet traffic\nwill flow through the IPS.\n\n182\n00:08:19.928 --> 00:08:23.659\nIt's in line, and\nit'll scan that traffic for attacks, and\n\n183\n00:08:23.659 --> 00:08:28.640\nif it finds an attack, it stops it, and\nit can stop it because it's in line.\n\n184\n00:08:28.640 --> 00:08:31.420\nI don't need port mirroring or\nanything for that, it's in line.\n\n185\n00:08:31.420 --> 00:08:32.850\nThese are physical connections, and\n\n186\n00:08:32.850 --> 00:08:37.320\nit filters, but\nit hurts performance a little bit.\n\n187\n00:08:37.320 --> 00:08:41.160\nIf you're doing things like voice over IP,\nit's scanning those packets,\n\n188\n00:08:41.160 --> 00:08:42.870\nit's looking for attacks, and\n\n189\n00:08:42.870 --> 00:08:47.000\nthat creates a little bit of lag while\nthat happens, and we might not want that.\n\n190\n00:08:47.000 --> 00:08:50.340\nSo the other option is to do an IDS,\nan Intrusion Detection System.\n\n191\n00:08:51.440 --> 00:08:56.280\nAnd an IDS scans the traffic, but\nit doesn't do anything about it.\n\n192\n00:08:56.280 --> 00:09:00.090\nIf it spots an attack,\nit just alerts us, and that's it, but\n\n193\n00:09:00.090 --> 00:09:01.810\nit doesn't hurt performance.\n\n194\n00:09:01.810 --> 00:09:05.380\nAnd the reason is, an IDS is not in line,\nan IDS sits off to the side.\n\n195\n00:09:05.380 --> 00:09:10.580\nAnd instead of the actual traffic going\nthrough it, we just take the traffic and\n\n196\n00:09:10.580 --> 00:09:11.390\nmirror it.\n\n197\n00:09:11.390 --> 00:09:13.920\nWe send a copy of the traffic to the IDS.\n\n198\n00:09:13.920 --> 00:09:16.590\nSo it can scan it and\nit doesn't slow our traffic down at all.\n\n199\n00:09:16.590 --> 00:09:19.810\nYour voice traffic, goes at nice\nfull speed, no big deal there.\n\n200\n00:09:19.810 --> 00:09:21.360\nAnd the IDS was scanning away.\n\n201\n00:09:21.360 --> 00:09:24.330\nAnd if the IDS gets a little bit behind,\nno big deal,\n\n202\n00:09:24.330 --> 00:09:28.950\ncuz if it spots an attack, it stop\nthe attack anyway, it's not inline.\n\n203\n00:09:28.950 --> 00:09:32.690\nAnd even if it tried to, the attack's\nalready passed through, right?\n\n204\n00:09:32.690 --> 00:09:35.580\nThe attack's already moved on, so\nit can't really do anything about it.\n\n205\n00:09:35.580 --> 00:09:39.200\nSo IDSs are good for performance,\nbut they can really benefit from\n\n206\n00:09:39.200 --> 00:09:42.790\nhaving monitor ports like this,\nwhere we can share that data,\n\n207\n00:09:42.790 --> 00:09:46.070\ncopy that data to another port, and\nget your IDS up and going, all right?\n\n208\n00:09:46.070 --> 00:09:49.287\nSo there's two different scenarios\nwhere we'd make use of a switch port\n\n209\n00:09:49.287 --> 00:09:50.140\nanalyzer or SPAN.\n\n210\n00:09:51.230 --> 00:09:55.540\nAll right, now, the configuration\nof it's really not that hard.\n\n211\n00:09:55.540 --> 00:09:57.980\nBasically, what we need to think about is,\n\n212\n00:09:57.980 --> 00:10:02.950\nwhat port has the data we want, and\nwhat port we want to send it to.\n\n213\n00:10:04.210 --> 00:10:07.760\nNow they don't have to be identical ports.\n\n214\n00:10:07.760 --> 00:10:08.940\nThey can be different ports.\n\n215\n00:10:08.940 --> 00:10:10.750\nThe can have different configurations.\n\n216\n00:10:10.750 --> 00:10:12.304\nThere can be all sorts of differences.\n\n217\n00:10:12.304 --> 00:10:15.429\nBut one key thing you want to watch\nout for is bandwidth, all right?\n\n218\n00:10:15.429 --> 00:10:20.246\nIf you're monitoring a 100 megabyte port,\nthen you're gonna need a 100 megabyte\n\n219\n00:10:20.246 --> 00:10:23.970\nport to monitor from to\nhandle all that bandwidth.\n\n220\n00:10:23.970 --> 00:10:30.130\nIf I take a gig port as my source, and I\nsend that to 100 meg port, I could exceed\n\n221\n00:10:30.130 --> 00:10:33.150\nits bandwidth, and what's gonna happen\nis my ports are gonna go error disable.\n\n222\n00:10:33.150 --> 00:10:36.100\nIt's gonna shut the ports off,\nand that's gonna cause downtime.\n\n223\n00:10:36.100 --> 00:10:37.190\nSo we definitely don't want that.\n\n224\n00:10:37.190 --> 00:10:42.510\nSo you definitely need your monitoring\nport to at least equal the same bandwidth\n\n225\n00:10:42.510 --> 00:10:45.410\nas the port you're monitoring, right?\n\n226\n00:10:45.410 --> 00:10:49.170\nPreferably your monitor port should\nhave more bandwidth than what you're\n\n227\n00:10:49.170 --> 00:10:52.060\nmonitoring, but it doesn't have to,\nthey at least have to be equal, right?\n\n228\n00:10:52.060 --> 00:10:53.340\n>> So the opposite is fine.\n\n229\n00:10:53.340 --> 00:10:57.200\nAs long as you're monitoring a port that\nis less than the bandwidth of the port\n\n230\n00:10:57.200 --> 00:10:59.990\nthat you're actually monitoring\nto then you're good to go.\n\n231\n00:10:59.990 --> 00:11:01.070\nBut if you do it the other way around,\n\n232\n00:11:01.070 --> 00:11:02.560\nyou're gonna get the error\ndisabled problem.\n\n233\n00:11:02.560 --> 00:11:05.390\n>> Yeah and that is no fun,\nbecause how do you clear error disabled?\n\n234\n00:11:05.390 --> 00:11:07.430\nYou got to shut the ports down and\ndo a no shut down.\n\n235\n00:11:07.430 --> 00:11:10.810\nYou gotta get into the switch and\nit's just a mess.\n\n236\n00:11:10.810 --> 00:11:13.770\nSo you don't want to deal with that\nif you can avoid it, all right?\n\n237\n00:11:13.770 --> 00:11:18.090\nThe other thing is,\nlet's say I plug my laptop into a port.\n\n238\n00:11:18.090 --> 00:11:20.910\nAnd I wanna copy all of\nthe traffic going to our router,\n\n239\n00:11:20.910 --> 00:11:23.040\nI wanna send it to my laptop, all right?\n\n240\n00:11:23.040 --> 00:11:28.260\nWell let's say the router's on a 100 meg\nport and my laptop's on a 100 meg port.\n\n241\n00:11:28.260 --> 00:11:31.080\nThe router could generate up\nto 100 megabits of traffic.\n\n242\n00:11:32.140 --> 00:11:35.200\nMy laptop is receiving that, and\nat a 100 megabit no big deal, right?\n\n243\n00:11:36.250 --> 00:11:40.520\nBut what if my laptop decides to do\nWindows updates in the background, or\n\n244\n00:11:40.520 --> 00:11:42.890\nI fire up a web browser,\nor check my email?\n\n245\n00:11:42.890 --> 00:11:45.310\nNow I'm generating my own bandwidth, and\n\n246\n00:11:45.310 --> 00:11:49.060\nmy own bandwidth combined with the routers\nbandwidth, might exceed a 100 megabit.\n\n247\n00:11:49.060 --> 00:11:50.950\nAnd now we're in that same problem.\n\n248\n00:11:50.950 --> 00:11:55.680\nSo by default when we\nmonitor a port using span,\n\n249\n00:11:55.680 --> 00:12:00.340\nthe port we send the traffic\nto is not allowed to talk.\n\n250\n00:12:00.340 --> 00:12:02.150\nIt can't talk on it's own.\n\n251\n00:12:02.150 --> 00:12:05.838\nThere's an option to turn that on,\nbut it's risky, all right?\n\n252\n00:12:05.838 --> 00:12:09.407\nIf you're gonna turn that option on to\nallow the receiver to actually talk on\n\n253\n00:12:09.407 --> 00:12:12.975\ntheir own, you gotta make sure the\nreceiver's port has more bandwidth than\n\n254\n00:12:12.975 --> 00:12:14.221\nwho you're monitoring.\n\n255\n00:12:14.221 --> 00:12:16.888\nThat's really important, okay?\n\n256\n00:12:16.888 --> 00:12:19.830\nBut what we normally do is just\nuse the dedicated connection.\n\n257\n00:12:19.830 --> 00:12:23.820\nSo for example on my laptop,\nI always have two network adapters.\n\n258\n00:12:23.820 --> 00:12:27.750\nI have physical thunderbolt adapter that\nI'll normally plug in for my own laptop.\n\n259\n00:12:27.750 --> 00:12:31.490\nAnd then I have a USB network adapter I\nuse for when I'm running Wire Shark or\n\n260\n00:12:31.490 --> 00:12:33.000\nsome other sniffer, right?\n\n261\n00:12:33.000 --> 00:12:35.550\nAnd that way that adapter\ndoesn't have to talk.\n\n262\n00:12:35.550 --> 00:12:39.590\nIt can just listen and receive traffic,\nand I'm still able to talk to my other\n\n263\n00:12:39.590 --> 00:12:42.710\nnetwork adapter, or you can use your\nwireless for that, or whatever.\n\n264\n00:12:42.710 --> 00:12:46.690\nIf you're setting up an IDS,\nan Intrusion Detection System,\n\n265\n00:12:46.690 --> 00:12:49.230\nthe port that's receiving the traffic\ndoesn't need to talk anyway.\n\n266\n00:12:49.230 --> 00:12:52.190\nIt'll have a separate management port for\ncontrolling it, and so\n\n267\n00:12:52.190 --> 00:12:53.930\nthat's why that's the default.\n\n268\n00:12:53.930 --> 00:12:56.980\nAnd I'll show you guys the option here in\na minute where we can turn that on to make\n\n269\n00:12:56.980 --> 00:12:57.750\nit work and talk, but\n\n270\n00:12:57.750 --> 00:13:01.552\nyou really don't want to use that\nin any production environment.\n\n271\n00:13:01.552 --> 00:13:06.082\nAll right, so, keep that in mind, as you\ngo through, and start to configure it.\n\n272\n00:13:06.082 --> 00:13:09.460\nAll right, now, before I jump into\nthe switch and start configuring things,\n\n273\n00:13:09.460 --> 00:13:12.550\nI wanna show you guys some\ninteresting stuff that\n\n274\n00:13:12.550 --> 00:13:14.772\nhappens when we just plug\ninto a switch like normal.\n\n275\n00:13:14.772 --> 00:13:18.590\nAll right, so,\nmy laptop is plugged into a switch.\n\n276\n00:13:18.590 --> 00:13:21.540\nAnd the switch and I,\nwe're both on Vlan 1.\n\n277\n00:13:21.540 --> 00:13:26.100\nAnd I can SSH into the switch, and\nget connected, and work with it, right?\n\n278\n00:13:26.100 --> 00:13:31.870\nIf I start monitoring the network,\nI'm only gonna see traffic\n\n279\n00:13:31.870 --> 00:13:36.450\nthat's destined for\nme or broadcasts, okay?\n\n280\n00:13:36.450 --> 00:13:38.320\nAnd so\nlet me show you an example of that here.\n\n281\n00:13:38.320 --> 00:13:40.410\nI'm gonna bring up Wireshark\nhere on my computer.\n\n282\n00:13:40.410 --> 00:13:42.280\nAnd I'm gonna use Wireshark.\n\n283\n00:13:42.280 --> 00:13:45.540\nThere's other packet sniffers and\nprotocol analyzers that are out there.\n\n284\n00:13:45.540 --> 00:13:48.700\nIf you're not familiar with Wireshark,\nyou can go to www.wireshark.org, and\n\n285\n00:13:48.700 --> 00:13:49.240\nyou can download it.\n\n286\n00:13:49.240 --> 00:13:50.250\nIt's free.\n\n287\n00:13:50.250 --> 00:13:54.570\nAnd it is both a packet sniffer and\na protocol analyzer all rolled into one.\n\n288\n00:13:54.570 --> 00:13:57.390\nAnd they make it for\nWindows, Linux, and Mac.\n\n289\n00:13:57.390 --> 00:14:00.700\nSo, it's really versatile, it's free.\n\n290\n00:14:00.700 --> 00:14:04.820\nThe first packet sniffer and protocol\nanalyzer I used, the very first one I used\n\n291\n00:14:04.820 --> 00:14:09.280\nwas a fluke network inspector which was\nhardware, and it costs a lot of money,\n\n292\n00:14:09.280 --> 00:14:12.220\nI can't remember exactly how much\nthat thing costs, like $15,000.\n\n293\n00:14:12.220 --> 00:14:16.760\nThe first software one I used\nwas from Network General, it was\n\n294\n00:14:16.760 --> 00:14:21.420\nNetwork General Sniffer Pro, and I think\nwe paid close to like $12,000 for that.\n\n295\n00:14:21.420 --> 00:14:23.800\nThis was back in the late 90's and\nearly 2000's, and\n\n296\n00:14:23.800 --> 00:14:26.660\nback then these were really\nincredibly expensive.\n\n297\n00:14:26.660 --> 00:14:29.790\nBut wire shark is a completely\nopen source, completely free, and\n\n298\n00:14:29.790 --> 00:14:31.140\nit does a lot.\n\n299\n00:14:31.140 --> 00:14:34.690\nIt does the majority of what any\nnetwork engineer is going to need.\n\n300\n00:14:34.690 --> 00:14:37.780\nSo now it's really only if you wanna\nrate cable, like certified cable and\n\n301\n00:14:37.780 --> 00:14:40.630\nstuff that you need to go up to some\nof the higher end devices, but for\n\n302\n00:14:40.630 --> 00:14:43.060\nyour average network admin,\nWireshark is great.\n\n303\n00:14:43.060 --> 00:14:44.000\nIt's free.\n\n304\n00:14:44.000 --> 00:14:45.020\nIt's open source.\n\n305\n00:14:45.020 --> 00:14:45.990\nDownload it and install it.\n\n306\n00:14:45.990 --> 00:14:46.710\nIt works great.\n\n307\n00:14:46.710 --> 00:14:48.050\nI use it all the time.\n\n308\n00:14:48.050 --> 00:14:51.820\n>> Now, Don, we gotta question in our chat\nroom that says does the switch buffer\n\n309\n00:14:51.820 --> 00:14:53.790\nthe traffic that comes into it, so\n\n310\n00:14:53.790 --> 00:14:56.310\nthat you get all the packets,\nand it can handle it?\n\n311\n00:14:56.310 --> 00:15:00.680\n>> So, because this is being done in\nhardware, right, it's basically saying,\n\n312\n00:15:00.680 --> 00:15:03.700\nokay, a frame just came in one port one,\nand\n\n313\n00:15:03.700 --> 00:15:06.910\nI'm gonna send the frame to port seven,\nall right.\n\n314\n00:15:06.910 --> 00:15:11.800\nIf I turn on mirroring and mirror port\nseven to port eight, now it says, okay\n\n315\n00:15:11.800 --> 00:15:16.820\na frame came in on port one, I'm gonna\nsend it to both port seven and eight.\n\n316\n00:15:16.820 --> 00:15:18.650\nSo, it's doing this in hardware.\n\n317\n00:15:18.650 --> 00:15:20.840\nAnd so it's just the normal buffers.\n\n318\n00:15:20.840 --> 00:15:22.520\nIt's the same data rate.\n\n319\n00:15:22.520 --> 00:15:26.510\nAnd it's shutting off communications\non that mirrored receiving port.\n\n320\n00:15:26.510 --> 00:15:29.160\nSo that data goes through the same rate\nas it's going through to the other port,\n\n321\n00:15:29.160 --> 00:15:31.560\nand it buffers exactly the same.\n\n322\n00:15:31.560 --> 00:15:34.080\nSo it doesn't need\na dedicated buffer on this.\n\n323\n00:15:34.080 --> 00:15:37.250\nIf there's a frame that doesn't make it\nto the mirror port, that's a frame that\n\n324\n00:15:37.250 --> 00:15:41.370\ndidn't make it to the actual destination\nport either, cuz it's the same data rate.\n\n325\n00:15:41.370 --> 00:15:45.228\nSo it doesn't have a dedicated\nbuffer on that one.\n\n326\n00:15:45.228 --> 00:15:47.805\nAll right, so, on my laptop here,\nI'm gonna fire this up.\n\n327\n00:15:47.805 --> 00:15:50.671\nAnd you'll see I've actually got\nseveral different network adapters.\n\n328\n00:15:50.671 --> 00:15:52.679\nAnd I've got this guy right here,\n\n329\n00:15:52.679 --> 00:15:57.329\nen6 That's my little USB network adapter\non my laptop that I use for sniffing.\n\n330\n00:15:57.329 --> 00:16:00.465\nNow when you're running\na packet capture like this,\n\n331\n00:16:00.465 --> 00:16:04.660\nit actually doesn't matter what IP\naddress you have on the interface.\n\n332\n00:16:04.660 --> 00:16:07.390\nYou could have pretty much any IP on there\nbecause you're not gonna be allowed to\n\n333\n00:16:07.390 --> 00:16:09.485\ntalk anyway and\nyour gonna be in promiscuous mode,\n\n334\n00:16:09.485 --> 00:16:13.360\nyou'll be receiving all traffic\nregardless of what IP it's destined for.\n\n335\n00:16:13.360 --> 00:16:17.170\nSo if I remember right I\nhave a fake IP on here,\n\n336\n00:16:17.170 --> 00:16:19.340\nlike I think it's actually 192.168.0.1.\n\n337\n00:16:19.340 --> 00:16:20.900\nBut it doesn't really\nmatter what IP you have.\n\n338\n00:16:20.900 --> 00:16:23.350\nYou just need to make sure you\nchoose the right adapter, and\n\n339\n00:16:23.350 --> 00:16:27.020\nI can see there's traffic hitting\nthat adapter, and this is going to be\n\n340\n00:16:27.020 --> 00:16:31.630\nbroadcast or other things, and I'm really\njust throwing most of it away, all right?\n\n341\n00:16:31.630 --> 00:16:33.570\nSo I'm gonna start that capture, and\n\n342\n00:16:33.570 --> 00:16:37.450\nnow I'll get a chance to see the traffic\nthat's coming in on that port, and\n\n343\n00:16:37.450 --> 00:16:43.155\nas I look, I see some UDP traffic, I see\nsome ASAP, I don't even know what ASAP is.\n\n344\n00:16:43.155 --> 00:16:46.235\n[LAUGH] We see some-\n>> It's fast traffic.\n\n345\n00:16:46.235 --> 00:16:46.770\n[LAUGH]\n>> So\n\n346\n00:16:46.770 --> 00:16:50.160\nDHCP v6,\nsome neighborhood discovery going on.\n\n347\n00:16:50.160 --> 00:16:57.760\nOh, I put a fake IPv4 address on here, but\nI bet I have IPv6 set up to autoconfigure.\n\n348\n00:16:57.760 --> 00:17:00.510\nSo I'm probably gonna see some\nmore IPv6 traffic on here.\n\n349\n00:17:00.510 --> 00:17:01.420\nBut if I stop this for\n\n350\n00:17:01.420 --> 00:17:05.340\na second and look at it, you're going\nto notice some commonalities, right?\n\n351\n00:17:05.340 --> 00:17:09.369\nSo for example I see 10.1.230.6 talking.\n\n352\n00:17:09.369 --> 00:17:10.770\nAll right?\n\n353\n00:17:10.770 --> 00:17:14.740\nOur studio network is 10.1.230 so\nthat's the real network here.\n\n354\n00:17:14.740 --> 00:17:16.390\nI don't know who that is, off hand.\n\n355\n00:17:16.390 --> 00:17:17.970\nThat could be your laptop for\nall I know but\n\n356\n00:17:17.970 --> 00:17:20.690\nI think it's one of our video switches or\nsomething.\n\n357\n00:17:20.690 --> 00:17:21.978\nBut look at the destination.\n\n358\n00:17:21.978 --> 00:17:24.787\n10.1.230.255, right?\n\n359\n00:17:24.787 --> 00:17:26.390\nThat's a broadcast.\n\n360\n00:17:26.390 --> 00:17:28.590\nSo I'm seeing broadcasts.\n\n361\n00:17:28.590 --> 00:17:32.262\nAnd if I look in here for\nany kind of unicast traffic, well, I see,\n\n362\n00:17:32.262 --> 00:17:37.202\nhere's something to 239.255.255.250,\nthat's multicast, right?\n\n363\n00:17:37.202 --> 00:17:39.893\nMulticast is basically like a broadcast,\nbut\n\n364\n00:17:39.893 --> 00:17:43.330\nI'm not seeing any unicast\ntraffic in here whatsoever.\n\n365\n00:17:43.330 --> 00:17:43.980\nRight?\n\n366\n00:17:43.980 --> 00:17:45.390\nAnd that's because I've got a fake IP.\n\n367\n00:17:45.390 --> 00:17:47.510\nWell, I guess I am seeing some IPv6.\n\n368\n00:17:47.510 --> 00:17:48.990\nNope, even that's a multicast.\n\n369\n00:17:48.990 --> 00:17:52.420\nFF02, that's the multicast range for IPv6.\n\n370\n00:17:52.420 --> 00:17:55.000\nSo I'm just seeing broadcasts.\n\n371\n00:17:55.000 --> 00:17:56.600\nAnd that's what you can expect.\n\n372\n00:17:56.600 --> 00:18:01.030\nWhen you plug your laptop into a switch\nyou'll see your own traffic and\n\n373\n00:18:01.030 --> 00:18:02.850\nyou'll see broadcasts, and that's it.\n\n374\n00:18:02.850 --> 00:18:04.310\nNot very useful for troubleshooting,\n\n375\n00:18:04.310 --> 00:18:08.060\ncuz broadcasts shouldn't make up\nthe bulk of your network traffic.\n\n376\n00:18:08.060 --> 00:18:08.780\nAll right.\n\n377\n00:18:08.780 --> 00:18:11.670\nAnd if I start generating other traffic on\nthe network it's not gonna matter cuz I'm\n\n378\n00:18:11.670 --> 00:18:12.350\nnot gonna see that.\n\n379\n00:18:12.350 --> 00:18:13.550\nIt's not gonna make it in here.\n\n380\n00:18:13.550 --> 00:18:15.422\nRight?\nSo for example,\n\n381\n00:18:15.422 --> 00:18:18.411\nif I start this live capture again.\n\n382\n00:18:18.411 --> 00:18:20.020\nAll right, so here I am capturing again.\n\n383\n00:18:20.020 --> 00:18:22.952\nAnd I'm gonna filter it to\njust show ICMP traffic.\n\n384\n00:18:22.952 --> 00:18:25.780\nI'm just showing pings, okay?\n\n385\n00:18:25.780 --> 00:18:29.090\nIf I were to generate some pings.\n\n386\n00:18:29.090 --> 00:18:34.990\nSo let's say I try to ping, remember\nI said I had 192.168.0.1 as my IP?\n\n387\n00:18:34.990 --> 00:18:36.260\nIf I were to try and ping .2.\n\n388\n00:18:36.260 --> 00:18:39.230\nWell, actually I guess\nI'm gonna generate an ARP\n\n389\n00:18:39.230 --> 00:18:41.130\nrequest to look up the MAC\naddress on that one.\n\n390\n00:18:41.130 --> 00:18:42.460\nAnd then I'll try and ping.\n\n391\n00:18:42.460 --> 00:18:44.340\nSo I might not actually\nsee the ICMPs on that one.\n\n392\n00:18:44.340 --> 00:18:48.020\nI would instead see the ARP\nthat happened for it.\n\n393\n00:18:48.020 --> 00:18:51.370\nAs I broadcast to try and\nfind who was 192.1680.2.\n\n394\n00:18:51.370 --> 00:18:52.870\nRight?\nSo there's those ARPs.\n\n395\n00:18:52.870 --> 00:18:54.300\nSo I am communicating.\n\n396\n00:18:54.300 --> 00:18:55.020\nI'm seeing.\n\n397\n00:18:55.020 --> 00:18:56.000\nI'm capturing.\n\n398\n00:18:56.000 --> 00:18:59.560\nBut it's not other people\nthat's gonna show up.\n\n399\n00:18:59.560 --> 00:19:04.110\nIf I put it back to ICMP, and I jump over\nto another host on that network, right, so\n\n400\n00:19:04.110 --> 00:19:04.970\nlike if I take.\n\n401\n00:19:04.970 --> 00:19:07.080\nThis is the switch that I'm plugged into.\n\n402\n00:19:07.080 --> 00:19:14.367\nAnd the switch,\nit has an IP address of 10.1.230.244.\n\n403\n00:19:14.367 --> 00:19:15.060\nAll right?\n\n404\n00:19:15.060 --> 00:19:19.780\nIf I get on this one and I start to ping\nsomebody else on the network, right, it's\n\n405\n00:19:19.780 --> 00:19:25.950\ngenerating pings, and if I look over here,\nwell, I'm starting to see those pings.\n\n406\n00:19:25.950 --> 00:19:26.530\nOkay?\n\n407\n00:19:26.530 --> 00:19:30.420\nNow, I'm seeing the pings in this case,\nbecause when the pings go out,\n\n408\n00:19:30.420 --> 00:19:32.930\nthese echos, pings are kind of special.\n\n409\n00:19:32.930 --> 00:19:36.160\nSwitches handle them specially and\nthey're sessionless.\n\n410\n00:19:36.160 --> 00:19:39.610\nAnd so it's going out and\nI'm seeing that traffic, right?\n\n411\n00:19:39.610 --> 00:19:41.680\nBecause pings are special.\n\n412\n00:19:41.680 --> 00:19:46.140\nBut if I do something that's unicast\nbased, like if I'm on this switch and\n\n413\n00:19:46.140 --> 00:19:49.960\nI try to ssh into that other device,\nright?\n\n414\n00:19:49.960 --> 00:19:54.730\nSo if I try and\nssh into 10.1.230.245, all right.\n\n415\n00:19:54.730 --> 00:19:55.869\nAnd I am 244.\n\n416\n00:19:55.869 --> 00:19:57.670\nSo this is the other switch.\n\n417\n00:19:57.670 --> 00:20:00.520\nWell, that's interesting.\n\n418\n00:20:00.520 --> 00:20:01.510\nUnknown command.\n\n419\n00:20:01.510 --> 00:20:02.710\nIt's SSH.\n\n420\n00:20:02.710 --> 00:20:04.140\nHow can that be unknown?\n\n421\n00:20:04.140 --> 00:20:07.540\nWell, we can try something\nelse like Telnet or whatever.\n\n422\n00:20:07.540 --> 00:20:13.220\nBut if I try and connect to that\nother device which I apparently\n\n423\n00:20:13.220 --> 00:20:17.487\ncan't even type, when I do something\nlike that, here I am, Telnet again.\n\n424\n00:20:18.560 --> 00:20:20.680\nAnd if I come back here and\nchange my filter,\n\n425\n00:20:20.680 --> 00:20:24.280\nlook, just for Telnet traffic,\nthat doesn't show up, right?\n\n426\n00:20:24.280 --> 00:20:26.130\nIt's unicast traffic,\n\n427\n00:20:26.130 --> 00:20:30.532\nit's got a destination MAC address of that\nother switch, I'm never gonna see that,\n\n428\n00:20:30.532 --> 00:20:35.890\nall right, but I can turn on SPAN and\nI will be able to see it, all right.\n\n429\n00:20:35.890 --> 00:20:40.220\nSo let's see that so when I connected to\nthis switch what you do is you kind of\n\n430\n00:20:40.220 --> 00:20:43.760\nhave to do a little bit of investigation.\n\n431\n00:20:43.760 --> 00:20:46.380\nI want to monitor that Telnet traffic.\n\n432\n00:20:46.380 --> 00:20:50.310\nI just went from switch 1 to switch 2,\nI want to see where that traffic went.\n\n433\n00:20:50.310 --> 00:20:52.200\nWell, what port do I need to monitor for\nthat?\n\n434\n00:20:53.540 --> 00:20:54.080\nI don't know.\n\n435\n00:20:54.080 --> 00:20:55.750\nI need to figure out what port.\n\n436\n00:20:55.750 --> 00:21:00.411\nSo on switch 1 it was\nreaching out to 10.1.230.245.\n\n437\n00:21:00.411 --> 00:21:01.470\nThat's who it was reaching out to.\n\n438\n00:21:02.550 --> 00:21:07.950\nIf I do a show arp,\nI can look in the arp table and\n\n439\n00:21:07.950 --> 00:21:14.220\nfind that IP address and that'll tell me\nwhat MAC address is associated with it.\n\n440\n00:21:15.460 --> 00:21:16.280\nOkay?\n\n441\n00:21:16.280 --> 00:21:22.140\nAnd once I have that mac address I\ncan look in the mac address table and\n\n442\n00:21:22.140 --> 00:21:27.830\nI can look for that mac address and now\nI'll know what port I used to get there.\n\n443\n00:21:27.830 --> 00:21:31.410\nSo I got there on port Fa0/24.\n\n444\n00:21:31.410 --> 00:21:34.550\nSo if I mirror the traffic\non fa0/24 to my laptop,\n\n445\n00:21:34.550 --> 00:21:38.180\nI should be able to see that Telnet,\nright?\n\n446\n00:21:38.180 --> 00:21:39.730\nCuz it goes over that port.\n\n447\n00:21:39.730 --> 00:21:44.380\nSo I can come in and I can set\nthat up by saying monitor session.\n\n448\n00:21:44.380 --> 00:21:47.250\nAnd then I need to give it a number,\nright?\n\n449\n00:21:47.250 --> 00:21:48.140\nSo this is gonna be session 1.\n\n450\n00:21:48.140 --> 00:21:50.470\nOh, I'm not even in config.\n\n451\n00:21:50.470 --> 00:21:54.390\nDifferent switches support different\namounts of monitoring sessions, so\n\n452\n00:21:54.390 --> 00:21:58.070\nif you do a monitor session and a question\nmark you'll see like, mine has up to 66.\n\n453\n00:21:58.070 --> 00:21:59.260\nRight?\n\n454\n00:21:59.260 --> 00:22:01.952\nYour switch might only have one.\n\n455\n00:22:01.952 --> 00:22:03.600\nLike a 2960 only has one.\n\n456\n00:22:03.600 --> 00:22:05.690\nBut there's a 3560 I can do 66.\n\n457\n00:22:05.690 --> 00:22:09.170\nMy other switch is a 3550, and\n\n458\n00:22:09.170 --> 00:22:12.750\nif we do monitor session,\nlet's see how many it does.\n\n459\n00:22:12.750 --> 00:22:13.540\nIt only does two.\n\n460\n00:22:13.540 --> 00:22:14.070\nRight?\n\n461\n00:22:14.070 --> 00:22:16.690\nDifferent switches support\ndifferent amounts of sessions.\n\n462\n00:22:16.690 --> 00:22:18.050\nSo on mine though I can do 66 of them.\n\n463\n00:22:18.050 --> 00:22:19.240\nI'm just gonna do the first one.\n\n464\n00:22:19.240 --> 00:22:20.540\nAll right?\n\n465\n00:22:20.540 --> 00:22:22.650\nAnd then I tell it where I\nwant the traffic to come from.\n\n466\n00:22:22.650 --> 00:22:27.150\nSo I'm gonna say the source\nis gonna be fa0/24.\n\n467\n00:22:27.150 --> 00:22:29.690\nI'm grabbing traffic from that interface.\n\n468\n00:22:29.690 --> 00:22:30.350\nAll right?\n\n469\n00:22:30.350 --> 00:22:32.070\nAnd if you do a question mark after that.\n\n470\n00:22:32.070 --> 00:22:33.827\nWhoops, sorry, I have to say interface.\n\n471\n00:22:33.827 --> 00:22:36.890\nThere we go.\nfa0/14.\n\n472\n00:22:36.890 --> 00:22:38.170\nAnd then if I do a question\nmark after that,\n\n473\n00:22:38.170 --> 00:22:41.150\nyou'll see where I can get\ntraffic going in both directions.\n\n474\n00:22:41.150 --> 00:22:44.950\nOr I can just do the receiving and\ntransmitting, the incoming and outgoing,\n\n475\n00:22:44.950 --> 00:22:46.050\nif I just want to get one of those.\n\n476\n00:22:46.050 --> 00:22:47.100\nAll right?\n\n477\n00:22:47.100 --> 00:22:48.970\nI want to get both.\n\n478\n00:22:48.970 --> 00:22:51.250\nAny traffic hitting that port,\nI want a copy of it.\n\n479\n00:22:52.310 --> 00:22:57.440\nAnd then we say monitor\nsession 1 destination and\n\n480\n00:22:57.440 --> 00:23:00.030\nwhere we want that traffic to go.\n\n481\n00:23:00.030 --> 00:23:00.810\nWhich is a great question.\n\n482\n00:23:00.810 --> 00:23:02.110\nWhich port am I even plugged into?\n\n483\n00:23:02.110 --> 00:23:03.995\nI'm plugged into port 1.\n\n484\n00:23:03.995 --> 00:23:06.340\nSo I'm gonna send it to fa0/1.\n\n485\n00:23:06.340 --> 00:23:09.210\nSo that's where I'm going to send it to,\nand\n\n486\n00:23:09.210 --> 00:23:13.330\nif I spell interface right\nthat'll work a little better.\n\n487\n00:23:13.330 --> 00:23:15.950\nAs soon as I do that command\nI'm plugged into port 1.\n\n488\n00:23:15.950 --> 00:23:18.050\nPort 1 is no longer able to talk.\n\n489\n00:23:18.050 --> 00:23:18.996\nAll right.\n\n490\n00:23:18.996 --> 00:23:20.540\nIf I want it to be able to talk,\n\n491\n00:23:20.540 --> 00:23:24.450\nthere is one little extra option\nout here where you can add ingress.\n\n492\n00:23:24.450 --> 00:23:28.190\nAnd that'll let traffic come in that port,\nwhich means it'll let me talk.\n\n493\n00:23:28.190 --> 00:23:30.858\nAnd that's the one that you can use\nif you've got enough bandwidth, but\n\n494\n00:23:30.858 --> 00:23:31.744\nI don't recommend it.\n\n495\n00:23:31.744 --> 00:23:33.500\nAll right.\n\n496\n00:23:33.500 --> 00:23:34.990\nSo now I've got that in place.\n\n497\n00:23:34.990 --> 00:23:36.590\nI should be good to go.\n\n498\n00:23:36.590 --> 00:23:38.094\nThere's nothing else\nthat I need to do here.\n\n499\n00:23:38.094 --> 00:23:40.029\nSo we're clear.\n\n500\n00:23:40.029 --> 00:23:41.122\nAnd I should be monitoring.\n\n501\n00:23:41.122 --> 00:23:41.774\nRight?\n\n502\n00:23:41.774 --> 00:23:46.562\nSo, now If I jump back to my protocol\nanalyzer, I'm going to stop it, and\n\n503\n00:23:46.562 --> 00:23:51.199\nlet me just start it again so\nwe have a nice, clean capture, alright and\n\n504\n00:23:51.199 --> 00:23:53.470\nI'm looking for telnet traffic.\n\n505\n00:23:54.690 --> 00:24:00.230\nWhen I did that telnet a few moments ago,\nI couldn't see it, right?\n\n506\n00:24:00.230 --> 00:24:04.100\nBut, now if I jump out here and\nI redo that telnet.\n\n507\n00:24:04.100 --> 00:24:05.990\nAnd I go to log in,\n\n508\n00:24:05.990 --> 00:24:10.440\nwell, I can look in the background and\nthere's that telnet data.\n\n509\n00:24:10.440 --> 00:24:13.400\nNow, I'm getting a copy of this\ndata that wasn't destined for\n\n510\n00:24:13.400 --> 00:24:17.350\nme, it was destined for the other switch.\n\n511\n00:24:17.350 --> 00:24:19.330\nAll right?\nNow, that works great and\n\n512\n00:24:19.330 --> 00:24:23.290\nnow I'm capturing the data and hey,\nthis is telnet, which is unencrypted, so\n\n513\n00:24:23.290 --> 00:24:28.240\nin my analyzer here, I can always\nlike follow the TCP stream and\n\n514\n00:24:28.240 --> 00:24:31.390\nit'll reassemble it, and there I can see\nthe login process, I can actually see\n\n515\n00:24:31.390 --> 00:24:35.610\nthe password I typed, right there in plain\ntext, because telnet is awesome, right?\n\n516\n00:24:35.610 --> 00:24:37.880\nBut, that's not really\nthe valuable part of this.\n\n517\n00:24:37.880 --> 00:24:40.050\nThe valuable part is if somebody calls and\nsays, hey,\n\n518\n00:24:40.050 --> 00:24:43.920\nwe're low on bandwidth,\nnow I can do a capture.\n\n519\n00:24:43.920 --> 00:24:46.070\nCapture five or ten minutes,\ncapture half an hour,\n\n520\n00:24:46.070 --> 00:24:49.600\nhowever as long it is you want, and\nthen I can go up here to analyze and\n\n521\n00:24:49.600 --> 00:24:53.630\nwe can really start to find a lot of\ndifferent things about our system.\n\n522\n00:24:53.630 --> 00:24:55.685\nOr, statistics is even better.\n\n523\n00:24:55.685 --> 00:24:56.550\nBecause I can come in here.\n\n524\n00:24:56.550 --> 00:24:57.770\nThere's this screen right here.\n\n525\n00:24:57.770 --> 00:24:59.410\nThe conversation screen.\n\n526\n00:24:59.410 --> 00:25:00.860\nThat's the one I like the most.\n\n527\n00:25:00.860 --> 00:25:02.010\nSomebody's using all my bandwidth.\n\n528\n00:25:02.010 --> 00:25:02.930\nWho is it?\n\n529\n00:25:02.930 --> 00:25:07.040\nIf you go to statistics and conversations,\nit'll analyze all that out and\n\n530\n00:25:07.040 --> 00:25:11.425\nlay it out for you here, and you can sort\nit by who is generating the most packets,\n\n531\n00:25:11.425 --> 00:25:13.635\nwho is generating the most bytes, and\n\n532\n00:25:13.635 --> 00:25:18.365\nyou can see where it's coming from and\nwhere it's going to, and so\n\n533\n00:25:18.365 --> 00:25:22.750\nif sort mine by bytes who is generating\nthe most bytes I can see that I've got\n\n534\n00:25:22.750 --> 00:25:26.490\nsome IPV six traffic on my network\nthat seems to be pretty far up there.\n\n535\n00:25:26.490 --> 00:25:33.070\nAnd if I do, let's see,\nI want to do, like, this guy here.\n\n536\n00:25:33.070 --> 00:25:33.850\nThere we go.\n\n537\n00:25:33.850 --> 00:25:37.250\nSo, we've got this my tack int, whatever.\n\n538\n00:25:37.250 --> 00:25:38.580\nI don't even know what that is.\n\n539\n00:25:38.580 --> 00:25:42.590\nSo if i have let me turn off name\nresolutions you can see IP's you\n\n540\n00:25:42.590 --> 00:25:47.140\nknow it's showing the Mac addresses here\nif I flip over the IP tab we will actually\n\n541\n00:25:47.140 --> 00:25:51.310\nsee my IP address and\nthat's a little bit easier for me so\n\n542\n00:25:51.310 --> 00:25:54.970\nwhoever has 10.1.230.124 is sending\na bunch of broadcasts if I sort by by\n\n543\n00:25:54.970 --> 00:25:58.880\nitself I will see that 10.1.230.6\nbroadcasting seems to be out there for me.\n\n544\n00:25:58.880 --> 00:26:02.580\nI am seeing a lot of broadcast, because\ni am monitoring a port that's only got\n\n545\n00:26:02.580 --> 00:26:06.610\na little traffic going on it right now,\nbut basically those are going to kind of\n\n546\n00:26:06.610 --> 00:26:12.000\njump up in there and kind of let me\nsee who it is that's talking and\n\n547\n00:26:12.000 --> 00:26:15.260\nkind of what protocols those are,\nwhat information it is that's being sent.\n\n548\n00:26:15.260 --> 00:26:16.329\nYou can really see some good data in here.\n\n549\n00:26:18.040 --> 00:26:20.228\nI checked, it's not me at this time.\n\n550\n00:26:20.228 --> 00:26:23.218\n[LAUGH]\n>> Alright.\n\n551\n00:26:23.218 --> 00:26:26.860\nSpan, as you've seen it right there,\nis not very hard.\n\n552\n00:26:26.860 --> 00:26:31.700\nOnce it's in place, you can monitor\nit with a few different commands.\n\n553\n00:26:31.700 --> 00:26:34.460\nThe hardest part for me is remembering\nthe monitor session command.\n\n554\n00:26:34.460 --> 00:26:38.200\nWhen you configure it,\nit's not span, it's monitor session.\n\n555\n00:26:38.200 --> 00:26:42.020\nSo, you've got to remember that and\nwhen you use the show commands.\n\n556\n00:26:42.020 --> 00:26:44.650\nAgain, it's show, monitor, session.\n\n557\n00:26:44.650 --> 00:26:46.660\nAnd you can go in and\nlook at your span sessions.\n\n558\n00:26:46.660 --> 00:26:50.020\nAnd it's nice because if you come in\nhere and do like pulling up that status,\n\n559\n00:26:50.020 --> 00:26:52.970\nyou can see the different information\nabout how that's configured and\n\n560\n00:26:52.970 --> 00:26:53.660\nhow it's working.\n\n561\n00:26:55.050 --> 00:26:59.450\nBe aware that it can be a little different\nif you're monitoring a trunk port.\n\n562\n00:26:59.450 --> 00:27:03.460\nI'm monitoring a trunk port here,\nthat Fa0/24 port that I'm monitoring?\n\n563\n00:27:03.460 --> 00:27:08.640\nIf I take a look at it's configuration,\nit's hard set to trunk.\n\n564\n00:27:08.640 --> 00:27:13.610\nAnd, if I do a show interface trunk, I'll\nsee that port 24 is trunking right now,\n\n565\n00:27:13.610 --> 00:27:14.640\nit's only carrying vlan one.\n\n566\n00:27:14.640 --> 00:27:18.430\nSo, if it's only carrying one VLAN,\nI don't have to worry about it too much.\n\n567\n00:27:18.430 --> 00:27:20.200\nI'm getting the traffic, it's working.\n\n568\n00:27:20.200 --> 00:27:23.150\nBut if I'm carrying more than one VLAN,\nright?\n\n569\n00:27:23.150 --> 00:27:28.290\nSo if I create VLAN two and\nVLAN three, right?\n\n570\n00:27:28.290 --> 00:27:30.880\nSo I start creating these other VLANs.\n\n571\n00:27:30.880 --> 00:27:38.020\nWhat I'll find is that now it's now\ncarrying more than one VLAN's traffic.\n\n572\n00:27:39.080 --> 00:27:39.930\nAnd because of that,\n\n573\n00:27:39.930 --> 00:27:44.130\nwhen I monitor the traffic,\nit's going to be tagged for a VLAN.\n\n574\n00:27:44.130 --> 00:27:46.740\nVLAN1's native, that's no big deal,\nbut VLAN2, VLAN3, they're tagged.\n\n575\n00:27:47.760 --> 00:27:52.290\nAnd so, that can cause some issues at a\nminimum, I can get more data than I want.\n\n576\n00:27:52.290 --> 00:27:57.740\nSo when we define that source, when we say\nmonitor session one source int fa0/24.\n\n577\n00:27:57.740 --> 00:28:00.950\nRight, that's what I typed earlier.\n\n578\n00:28:00.950 --> 00:28:05.690\nAnd then I said both to grab both\ndirections of that traffic, right.\n\n579\n00:28:05.690 --> 00:28:07.890\nSo that's what's being\nkind of put in there.\n\n580\n00:28:07.890 --> 00:28:13.210\nYou can also go an extra step and\nsay monitor session one,\n\n581\n00:28:13.210 --> 00:28:19.640\nfilter, and then once you filter it,\nyou can specify a particular vlan to get.\n\n582\n00:28:19.640 --> 00:28:22.380\nSo I don't necessarily\nwant to get all the vlans.\n\n583\n00:28:22.380 --> 00:28:23.930\nI just want to get vlan 1, and that's it.\n\n584\n00:28:23.930 --> 00:28:25.710\nDon't bother with the other ones, and\n\n585\n00:28:25.710 --> 00:28:27.840\nthat will kind of reduce\nthe load on my work station.\n\n586\n00:28:27.840 --> 00:28:30.160\nI'm not getting a much\nextra traffic I don't need.\n\n587\n00:28:30.160 --> 00:28:33.750\nAll right, the other thing that I might\nwant to do, so here, I'll filter down\n\n588\n00:28:33.750 --> 00:28:37.810\nthe vlan one, and the other thing I\nmight want to do is on the destination.\n\n589\n00:28:38.870 --> 00:28:43.110\nSo when I set the destination port\nas my machine, right, I said fa0/1.\n\n590\n00:28:43.110 --> 00:28:46.210\nYou can set the encapsulation, right?\n\n591\n00:28:46.210 --> 00:28:49.720\nSee how it says set encapsulation for\ndestination interface?\n\n592\n00:28:49.720 --> 00:28:56.990\nAnd if I set that encapsulation,\nI can specify 802.1q, ISL or replicate.\n\n593\n00:28:56.990 --> 00:28:58.730\nAnd the default is replicate.\n\n594\n00:28:58.730 --> 00:29:00.550\nWhatever it's encapsulated at right now,\n\n595\n00:29:00.550 --> 00:29:03.220\nthat's what it's going to\nsend to the other side.\n\n596\n00:29:03.220 --> 00:29:07.900\nBut if I'm capturing all the VLANs and\nthey're tagged for dot1q and\n\n597\n00:29:07.900 --> 00:29:12.530\nI'm sending it out of port, or if they're\ntagged for If they're encapsulated ISL,\n\n598\n00:29:12.530 --> 00:29:13.940\nsorry, the proprietary one.\n\n599\n00:29:13.940 --> 00:29:16.600\nAnd I'm sending it to a work station,\nit might not support ISL,\n\n600\n00:29:16.600 --> 00:29:19.320\nit might not be able to read that\non it's physical network adaptor.\n\n601\n00:29:19.320 --> 00:29:22.250\nSo I might need to change the\nencapsulation at that one queue to send\n\n602\n00:29:22.250 --> 00:29:24.810\nit and\nhave it be readable on the other side.\n\n603\n00:29:24.810 --> 00:29:27.620\nSo just be aware of some little caveats\nlike that when it comes to monitoring\n\n604\n00:29:27.620 --> 00:29:31.550\na trunk, mostly the vlan filter, but\nsometimes, changing encapsulation.\n\n605\n00:29:31.550 --> 00:29:34.420\nMost people just do dot one q so\nit's never a problem.\n\n606\n00:29:34.420 --> 00:29:37.820\nBut those are a couple extra little\noptions that we might want to add.\n\n607\n00:29:37.820 --> 00:29:42.717\n>> All right now Don, I understand that\nyou are plugged directly into the switch\n\n608\n00:29:42.717 --> 00:29:45.570\nand we do want to get into rsync.\n\n609\n00:29:45.570 --> 00:29:46.980\n>> RSPAN.\n>> I'm sorry, RSPAN.\n\n610\n00:29:46.980 --> 00:29:48.430\nYes.\n>> I love rsync too, but RSPAN is better.\n\n611\n00:29:48.430 --> 00:29:49.700\n>> Rsync is awesome, yes.\n\n612\n00:29:49.700 --> 00:29:50.826\nIt's on my mind apparently.\n\n613\n00:29:50.826 --> 00:29:54.710\n[LAUGH] RSPANs, well, should we go\ninto a super mega awesome supershow?\n\n614\n00:29:54.710 --> 00:29:57.370\nOr?\n>> Yeah, we should probably go onto a part\n\n615\n00:29:57.370 --> 00:30:00.710\ntwo, and but what Daniel's talking\nabout it, everything that I monitor was\n\n616\n00:30:00.710 --> 00:30:05.210\nright here on this switch, and it worked\ngreat in a single switch environment.\n\n617\n00:30:05.210 --> 00:30:08.950\nBut, like Daniel's laptop,\nhe's plugged into a different switch.\n\n618\n00:30:08.950 --> 00:30:12.070\nSo if I want to monitor\nhim I got two choices.\n\n619\n00:30:12.070 --> 00:30:15.280\nOne, I could take my laptop and\ngo plug into his switch, right?\n\n620\n00:30:15.280 --> 00:30:17.320\nBut what if he's in a different building,\n\n621\n00:30:17.320 --> 00:30:19.110\nhe's not in the same building as me,\nright?\n\n622\n00:30:19.110 --> 00:30:20.176\nAnd now it becomes different.\n\n623\n00:30:20.176 --> 00:30:23.710\nI've got to get up, I've got to walk all\nthe way over there, but you do real work.\n\n624\n00:30:23.710 --> 00:30:24.640\n>> Yeah, I know, it's crazy talk.\n\n625\n00:30:24.640 --> 00:30:26.090\n>> That's not what we got into this for.\n\n626\n00:30:26.090 --> 00:30:31.510\n>> So there's a different form of span\nthat we can use, called Rspan, that\n\n627\n00:30:31.510 --> 00:30:34.600\nlet's you monitor ports on a different\nswitch, and so it's pretty awesome.\n\n628\n00:30:34.600 --> 00:30:35.350\nWe definitely want to see it.\n\n629\n00:30:35.350 --> 00:30:38.220\nIt's a little bit more complex to get\nset up, which is why I definitely can't\n\n630\n00:30:38.220 --> 00:30:40.231\ncram it in the one minute I see\nwe have left on the clock here.\n\n631\n00:30:40.231 --> 00:30:41.072\n>> [LAUGH] You can do it.\n\n632\n00:30:41.072 --> 00:30:44.624\n>> So let's go on to a part two and\nwe'll get a chance to see RSPAN, and\n\n633\n00:30:44.624 --> 00:30:48.250\nhow we can get that setup and\nuse it to monitor on multiple switches.\n\n634\n00:30:48.250 --> 00:30:49.070\nWhich is pretty awesome.\n\n635\n00:30:49.070 --> 00:30:49.740\n>> Sounds good.\n\n636\n00:30:49.740 --> 00:30:50.380\nAll right everyone.\n\n637\n00:30:50.380 --> 00:30:52.340\nWe're going to go ahead and\nclose this episode out.\n\n638\n00:30:52.340 --> 00:30:54.470\nHopefully, we'll see you guys in part two.\n\n639\n00:30:54.470 --> 00:30:57.850\nFor signing off for ITProTV,\nI've been your host Daniel Lowry.\n\n640\n00:30:57.850 --> 00:30:58.520\n>> And I'm Don Pezet.\n\n641\n00:30:58.520 --> 00:30:59.773\n>> And we'll see you next time.\n\n642\n00:30:59.773 --> 00:31:06.980\n[MUSIC]\n\n",
          "vimeoId": "142150510"
        },
        {
          "description": "In this episode, Daniel and Don explain and demonstrate how to monitor a switched network using Remote Switch Port Analyzer (RSPAN). Building upon SPAN, RSPAN enables you to monitor switches that you are not directly connected to. This episode covers how to configure RSPAN for the times when being physically connected to a switch that needs monitoring isn't feasible.",
          "length": "1615",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-7-span_and_rspan_pt2-100515-high.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-7-span_and_rspan_pt2-100515-high-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-7-span_and_rspan_pt2-100515-high-sm.jpg",
          "title": "SPAN and RSPAN Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:06.280\n[MUSIC]\n\n2\n00:00:06.280 --> 00:00:10.504\nAll right, greetings everyone and\n\n3\n00:00:10.504 --> 00:00:16.570\nwelcome to another great\nepisode of ITPro.tv.\n\n4\n00:00:16.570 --> 00:00:20.540\nI'm your host Daniel Lowery,\njoining me again today is Mr. Don Pezet.\n\n5\n00:00:20.540 --> 00:00:21.380\nHow's it going today Don?\n\n6\n00:00:21.380 --> 00:00:22.360\n>> It is going great, Daniel.\n\n7\n00:00:22.360 --> 00:00:26.000\nI'm glad to be back for\npart two of our SPAN and RSPAN episode.\n\n8\n00:00:26.000 --> 00:00:28.990\nAnd if you didn't watch the first one\nyou really should because we tackled\n\n9\n00:00:28.990 --> 00:00:31.680\nthe switch port analyzer and\nwhat it does, how it works,\n\n10\n00:00:31.680 --> 00:00:35.700\nhow we capture traffic on one port and\nsend a copy of it to another port.\n\n11\n00:00:35.700 --> 00:00:38.280\nBut we stopped short of something\nthat's kinda important.\n\n12\n00:00:38.280 --> 00:00:40.800\nEverything we showed you in\nthe first episode was true, right,\n\n13\n00:00:40.800 --> 00:00:41.835\nwe're not doing a retraction.\n\n14\n00:00:41.835 --> 00:00:43.030\n>> [LAUGH]\n>> At least not yet.\n\n15\n00:00:43.030 --> 00:00:47.180\nIt all worked great on a single switch.\n\n16\n00:00:47.180 --> 00:00:50.130\nBut when you go into a multi-switch\nenvironment we start to have some little\n\n17\n00:00:50.130 --> 00:00:51.200\nproblems.\n\n18\n00:00:51.200 --> 00:00:53.550\nSo let's kinda recap where\nwe were in the last episode.\n\n19\n00:00:53.550 --> 00:00:54.840\nI whipped up a quick diagram.\n\n20\n00:00:54.840 --> 00:00:56.310\nLet me show you guys this.\n\n21\n00:00:56.310 --> 00:01:02.450\nAnd basically, in the last episode I\nhad my laptop plugged into the switch.\n\n22\n00:01:02.450 --> 00:01:06.700\nAnd I was monitoring this\ntrunk port right here,\n\n23\n00:01:06.700 --> 00:01:09.100\nthat's where I was running span,\non that guy right there.\n\n24\n00:01:09.100 --> 00:01:14.540\nAnd so when I took this switch and\nI tel-netted into the other switch,\n\n25\n00:01:14.540 --> 00:01:18.890\nso I did a telnet session across those,\nI was passing through that port.\n\n26\n00:01:18.890 --> 00:01:20.270\nAnd I was capturing that traffic.\n\n27\n00:01:20.270 --> 00:01:22.870\nIt was being sent to my laptop and\nwe saw it right on screen.\n\n28\n00:01:22.870 --> 00:01:23.560\nThat's what was happening.\n\n29\n00:01:25.040 --> 00:01:30.100\nThat works great and if I monitor that\nport and even if Daniel from his laptop\n\n30\n00:01:30.100 --> 00:01:33.810\nwere to Telnet into that switch, I'd see\nit because he's passing through that port.\n\n31\n00:01:35.460 --> 00:01:37.840\nBut not all traffic\npasses through the port.\n\n32\n00:01:37.840 --> 00:01:42.070\nSo for example, if Daniel were to Telnet\nfrom his laptop into this switch,\n\n33\n00:01:42.070 --> 00:01:44.190\nam I gonna see that?\n\n34\n00:01:44.190 --> 00:01:46.930\nNo, it never makes it to this trunk.\n\n35\n00:01:46.930 --> 00:01:51.330\nIt sees his frames coming in with\na destination MAC address of this switch.\n\n36\n00:01:51.330 --> 00:01:54.410\nIt delivers it right to that\nswitches management port and\n\n37\n00:01:54.410 --> 00:01:56.345\nit never crosses the trunk.\n\n38\n00:01:56.345 --> 00:02:00.695\nI might see his initial ARP broadcast as\nhe tries to find the Mac of the switch.\n\n39\n00:02:00.695 --> 00:02:02.375\nImagine his system would already know.\n\n40\n00:02:02.375 --> 00:02:04.625\nBut if it doesn't,\nI'll see the ARP broadcast.\n\n41\n00:02:04.625 --> 00:02:09.065\nBut the actual Telnet session will\njust go direct and I'll never see it.\n\n42\n00:02:09.065 --> 00:02:11.415\nSo I've got two choices, right?\n\n43\n00:02:11.415 --> 00:02:15.129\nChoice one involves physical labor so\nwe'll throw that one out.\n\n44\n00:02:15.129 --> 00:02:19.570\n>> [LAUGH] And then choice one, I unplug\nmy laptop and I plug it into this switch.\n\n45\n00:02:19.570 --> 00:02:22.510\nAnd I configure SPAN over here\nto be able to mirror him and\n\n46\n00:02:22.510 --> 00:02:23.610\nI'm plugged in on the same switch.\n\n47\n00:02:23.610 --> 00:02:24.170\nThat'll work.\n\n48\n00:02:24.170 --> 00:02:25.720\nThat's option one.\n\n49\n00:02:25.720 --> 00:02:29.150\nOption two is, we can use RSPAN.\n\n50\n00:02:29.150 --> 00:02:33.980\nAnd what RSPAN does is let me\nmonitor a port on one switch and\n\n51\n00:02:33.980 --> 00:02:37.780\nsend its traffic to\na port on another switch.\n\n52\n00:02:37.780 --> 00:02:38.470\nOkay.\n\n53\n00:02:38.470 --> 00:02:44.100\nNow to do that is a lot more complex than\njust grabbing traffic of a one switch and\n\n54\n00:02:44.100 --> 00:02:47.050\nthere's a lot of concerns we have to have.\n\n55\n00:02:47.050 --> 00:02:49.920\nThere needs to be some\nplanning when you do RSpan.\n\n56\n00:02:49.920 --> 00:02:50.560\nAll right.\n\n57\n00:02:50.560 --> 00:02:54.560\nThe way RSPAN works is\nnormally with regular span,\n\n58\n00:02:54.560 --> 00:02:58.990\nyou grab traffic from one port, right, so\nyour source is one physical interface, and\n\n59\n00:02:58.990 --> 00:03:01.570\nyour destination is another\nphysical interface.\n\n60\n00:03:01.570 --> 00:03:03.950\nAnd remember the warning I gave\nyou guys in the last episode,\n\n61\n00:03:03.950 --> 00:03:08.695\nwas make sure that the destination\ninterface has equal the bandwidth or\n\n62\n00:03:08.695 --> 00:03:11.435\nmore than the source interface.\n\n63\n00:03:11.435 --> 00:03:14.185\nYou never want the source interface\nto have more traffic than what\n\n64\n00:03:14.185 --> 00:03:17.235\nthe destination interface can handle,\ncuz your ports will go the same,\n\n65\n00:03:17.235 --> 00:03:18.199\nit'll turn them off.\n\n66\n00:03:18.199 --> 00:03:20.145\nRight, so\nthat's definitely not what you want.\n\n67\n00:03:20.145 --> 00:03:23.569\nWell, when we do our RSPAN,\nyou have a source and your source\n\n68\n00:03:23.569 --> 00:03:28.500\nis a physical interface, so the traffic\non one of your physical interfaces.\n\n69\n00:03:28.500 --> 00:03:32.560\nAnd instead of sending the copy\nto another physical interface,\n\n70\n00:03:32.560 --> 00:03:36.040\nyou send a copy of the data to a VLAN,\nall right?\n\n71\n00:03:36.040 --> 00:03:38.690\nWhat's called a remote SPAN VLAN.\n\n72\n00:03:38.690 --> 00:03:41.610\nSo you send that traffic to a VLAN, and\n\n73\n00:03:41.610 --> 00:03:45.840\nthe VLAN can then cross\nacross many switches.\n\n74\n00:03:45.840 --> 00:03:47.890\nCross switch to switch to switch.\n\n75\n00:03:47.890 --> 00:03:52.450\nAnd at another switch somewhere\nelse I configure a SPAN session\n\n76\n00:03:52.450 --> 00:03:57.015\nwhere the source is not a physical\ninterface, but is instead the VLAN, so\n\n77\n00:03:57.015 --> 00:03:59.835\na source of whatever this magic VLAN is.\n\n78\n00:03:59.835 --> 00:04:02.965\nAnd the destination would be\nthe physical interface on my own laptop.\n\n79\n00:04:04.145 --> 00:04:06.565\nSo there's a VLAN in the mix.\n\n80\n00:04:06.565 --> 00:04:10.455\nAnd the warning here, the reason we need\nso much planning, is that if we're gonna\n\n81\n00:04:10.455 --> 00:04:13.805\nbe sending VLANs across we usually don't\nhave dedicated interfaces for that, do we?\n\n82\n00:04:13.805 --> 00:04:15.185\nWe have trunks.\n\n83\n00:04:15.185 --> 00:04:17.425\nAnd so now you've gotta\nworry about trunk bandwidth.\n\n84\n00:04:17.425 --> 00:04:21.990\nIf we go back to my diagram, Daniel has\na 100 meg connection between himself and\n\n85\n00:04:21.990 --> 00:04:26.380\nthe switch and I have a 100 meg\nconnection between myself and the switch.\n\n86\n00:04:26.380 --> 00:04:31.870\nBut this trunk, it might be 100 megabit or\nit might be a gigabit, it can be bigger.\n\n87\n00:04:31.870 --> 00:04:32.610\nRight?\n\n88\n00:04:32.610 --> 00:04:35.080\nAnd there's more than\none VLAN running on it.\n\n89\n00:04:35.080 --> 00:04:38.250\nAnd so, I could end up with\nsome real problems there.\n\n90\n00:04:38.250 --> 00:04:42.690\nSo, I need to do one of two things either\none, make sure that the bandwidth is equal\n\n91\n00:04:42.690 --> 00:04:45.735\nthat my monitoring station has at\nleast the same bandwidth as the trunk.\n\n92\n00:04:45.735 --> 00:04:51.650\nOr two, do some kinda quality of\nservice rate limiting like ingress and\n\n93\n00:04:51.650 --> 00:04:56.620\negress filtering to hold that particular\nVLAN down to below 100 megabit and\n\n94\n00:04:56.620 --> 00:05:01.460\nto only be spamming just that\none VLAN using a VLAN filter.\n\n95\n00:05:01.460 --> 00:05:03.390\nSo you gotta really plan for that.\n\n96\n00:05:03.390 --> 00:05:06.820\nYou gotta think about making sure your\ninfrastructure is stable enough for it.\n\n97\n00:05:06.820 --> 00:05:12.110\nBut assuming that it is, we can get\nthis set up and it worked great, okay.\n\n98\n00:05:12.110 --> 00:05:18.010\nSo first, let's test what we've got\nwith just the regular network in place.\n\n99\n00:05:18.010 --> 00:05:24.660\nSo I'm gonna move that off and right now\nI'm already monitoring here on switch one.\n\n100\n00:05:24.660 --> 00:05:31.323\nIf I take a look at switch one and\na I do a show monitor session.\n\n101\n00:05:31.323 --> 00:05:37.260\n[LAUGH] If I look at my monitor sessions,\nthere we go,\n\n102\n00:05:37.260 --> 00:05:40.820\nI can see that my laptop\nis plugged into port 1.\n\n103\n00:05:40.820 --> 00:05:44.460\nAnd I'm monitoring port 24 which is\nthe trunk between the two switches, so\n\n104\n00:05:44.460 --> 00:05:46.480\nI'm monitoring that and it's up and\n\n105\n00:05:46.480 --> 00:05:50.620\nit's running right now so I am doing\nexactly what I said here in the diagram.\n\n106\n00:05:50.620 --> 00:05:53.960\nI am monitoring that port, all right.\n\n107\n00:05:53.960 --> 00:05:56.960\nSo I'm gonna start a capture and\n\n108\n00:05:56.960 --> 00:06:01.300\nlet me just get over to WireShark and\nI'm gonna start an all new capture.\n\n109\n00:06:02.360 --> 00:06:03.790\nAnd I'm gonna start\ncapturing that traffic and\n\n110\n00:06:03.790 --> 00:06:05.510\nI'm gonna filter it down to just Telnet.\n\n111\n00:06:05.510 --> 00:06:07.000\nSo I'm just looking at the Telnet traffic.\n\n112\n00:06:07.000 --> 00:06:11.390\nAll right, now Daniel,\ncan you Telnet into my switch?\n\n113\n00:06:11.390 --> 00:06:12.537\nSo Telnet into 10.1.230.244.\n\n114\n00:06:12.537 --> 00:06:13.110\n>> .244 no problem.\n\n115\n00:06:13.110 --> 00:06:14.440\nLet's see here, Telnet.\n\n116\n00:06:14.440 --> 00:06:18.740\n>> So let me get back to my diagram.\n\n117\n00:06:18.740 --> 00:06:21.025\nSo he's tel-netting from his laptop.\n\n118\n00:06:21.025 --> 00:06:22.480\nInto my switch over here.\n\n119\n00:06:22.480 --> 00:06:25.560\nSo he's gonna have to cross to\nthis band port to get there.\n\n120\n00:06:25.560 --> 00:06:28.290\nAnd sure enough,\nthere's that Telnet traffic passing by.\n\n121\n00:06:28.290 --> 00:06:29.630\nAnd he's logging in right now.\n\n122\n00:06:29.630 --> 00:06:31.905\nSo I see that traffic.\n\n123\n00:06:31.905 --> 00:06:35.970\nCuz he's passing through that port\nright there that I'm monitoring.\n\n124\n00:06:35.970 --> 00:06:37.136\nAnd that's exactly what I want.\n\n125\n00:06:37.136 --> 00:06:38.668\nAll right?\n\n126\n00:06:38.668 --> 00:06:42.290\nBut I'm gonna stop this and\ndid you end your?\n\n127\n00:06:42.290 --> 00:06:45.050\n>> Yes, I am done [LAUGH]\n>> So let me start a new one.\n\n128\n00:06:45.050 --> 00:06:46.150\nSo we'll continue without saving.\n\n129\n00:06:46.150 --> 00:06:48.540\nAnd here is all new filter, okay?\n\n130\n00:06:48.540 --> 00:06:52.762\nAnd this time Daniel Telnet\ninto the 10.1.230.245.\n\n131\n00:06:52.762 --> 00:06:53.630\n>> 45.\n\n132\n00:06:53.630 --> 00:06:56.060\nNow 245 is his switch right here.\n\n133\n00:06:56.060 --> 00:06:57.770\nHe's tel-netting into that one.\n\n134\n00:06:57.770 --> 00:07:03.190\nThat traffic's not gonna hit the trunk and\nso I'm not gonna see that.\n\n135\n00:07:03.190 --> 00:07:04.000\nAnd so you're logged in?\n\n136\n00:07:04.000 --> 00:07:05.070\n>> I'm logged in.\n\n137\n00:07:05.070 --> 00:07:06.400\n>> And I don't see the traffic.\n\n138\n00:07:06.400 --> 00:07:06.990\nOkay.\n\n139\n00:07:06.990 --> 00:07:10.320\nSo here we can see the situation.\n\n140\n00:07:10.320 --> 00:07:15.550\nAnd I wanna get that data so I'm gonna go\nand configure RSPAN to do it, all right.\n\n141\n00:07:15.550 --> 00:07:18.090\nSo let me stop this capture so its not\njust running in the background filling up\n\n142\n00:07:18.090 --> 00:07:23.310\nmy hard drive and I will jump over to my\nswitches and we'll get this set up, okay.\n\n143\n00:07:23.310 --> 00:07:27.330\nNow I'm gonna start on his switch so\nover here on his switch.\n\n144\n00:07:27.330 --> 00:07:29.040\nHe's on switch two.\n\n145\n00:07:29.040 --> 00:07:31.990\nAnd if I do a show monitor\n\n146\n00:07:31.990 --> 00:07:36.340\nsession actually here we'll just\ntake a look at the running config.\n\n147\n00:07:36.340 --> 00:07:39.780\nAnd I don't have any spam ports\nset up on his switch yet.\n\n148\n00:07:39.780 --> 00:07:42.310\nSo there's no monitor commands in there.\n\n149\n00:07:42.310 --> 00:07:44.260\nAnd what I'm gonna do is\nI'm gonna set up a monitor.\n\n150\n00:07:44.260 --> 00:07:48.830\nAnd I can monitor this different ways but\nlet's say his laptop is the problem.\n\n151\n00:07:48.830 --> 00:07:51.567\nSo I want to monitor his\nlaptop specifically.\n\n152\n00:07:51.567 --> 00:07:56.682\nWell, he is plugged into, I believe he\nis plugged into port one if I recall\n\n153\n00:07:56.682 --> 00:08:01.467\ncorrectly, and so he's plugged into\nport one, so I should be able to\n\n154\n00:08:01.467 --> 00:08:06.606\ncatch him right there on port one,\nand intercept those communications.\n\n155\n00:08:06.606 --> 00:08:09.755\nNow, if I want to be certain that he\nis in port one, I could say, Daniel,\n\n156\n00:08:09.755 --> 00:08:11.320\ndo you know what your IP address is?\n\n157\n00:08:11.320 --> 00:08:13.071\n>> No, but I can find out for\nyou in one second.\n\n158\n00:08:13.071 --> 00:08:17.014\n>> So, we can quickly check by\nlooking at our arp table and\n\n159\n00:08:17.014 --> 00:08:20.369\nour mac table and\nfigure out what port he is on.\n\n160\n00:08:20.369 --> 00:08:24.320\n>> .15, 10.1.230.15.\n\n161\n00:08:24.320 --> 00:08:29.190\n>> Okay, so if he's on 10.1.230.15,\nright and I can ping him.\n\n162\n00:08:29.190 --> 00:08:34.410\nI can do a show arp, and so there he\nis and I can find his MAC address.\n\n163\n00:08:34.410 --> 00:08:36.290\nThere's his MAC address.\n\n164\n00:08:36.290 --> 00:08:41.559\nAnd once I have his MAC address,\nI can do a show mac address and\n\n165\n00:08:41.559 --> 00:08:45.320\nI can look for his mac address and\nthere he is on port one.\n\n166\n00:08:45.320 --> 00:08:48.900\nSo if I didn't know what port he was on,\nif this was a big 6500 series switch and\n\n167\n00:08:48.900 --> 00:08:52.890\ncables all over the place, we can\nalways hunt and find them pretty quick.\n\n168\n00:08:52.890 --> 00:08:56.320\nAnd so, what I'm gonna do is,\nthat's gonna be my source.\n\n169\n00:08:56.320 --> 00:09:00.990\nI wanna get the traffic on port one and\nthen I wanna send it to a VLAN.\n\n170\n00:09:00.990 --> 00:09:03.910\nNow, for the VLAN I've got just one VLAN.\n\n171\n00:09:03.910 --> 00:09:07.150\nRight now I've got VLAN 1 and that's it.\n\n172\n00:09:07.150 --> 00:09:09.220\nI need to create, oh,\nactually I've got VLAN 2 and 3.\n\n173\n00:09:09.220 --> 00:09:10.690\nI got a couple of VLANs.\n\n174\n00:09:10.690 --> 00:09:16.610\nBut for our span we need to create\na special VLAN that is only used for\n\n175\n00:09:16.610 --> 00:09:18.030\nRSPAN and nothing else.\n\n176\n00:09:18.030 --> 00:09:21.530\nSo you don't wanna reuse some other VLAN\nthat you might have workstations on.\n\n177\n00:09:21.530 --> 00:09:23.701\nSo I'm gonna create an all new VLAN.\n\n178\n00:09:23.701 --> 00:09:27.934\nAnd I'll just give it a number like 999.\n\n179\n00:09:27.934 --> 00:09:30.550\nPick a number that you're\nnot using in your network.\n\n180\n00:09:30.550 --> 00:09:31.940\nAnd so I'll give it a name.\n\n181\n00:09:31.940 --> 00:09:33.670\nI'll call this one RSPAN.\n\n182\n00:09:33.670 --> 00:09:36.520\nYou can call it whatever you want,\nall right?\n\n183\n00:09:36.520 --> 00:09:37.710\nThat part is not important.\n\n184\n00:09:37.710 --> 00:09:45.180\nThe part that is important is that we need\nto come in here and say remote-span, okay?\n\n185\n00:09:45.180 --> 00:09:47.110\nThat command right there, remote-span,\n\n186\n00:09:47.110 --> 00:09:50.600\nif we look at our help That\nconfigures it as a Remote SPAN VLAN.\n\n187\n00:09:50.600 --> 00:09:52.151\nYou can't just use any old VLAN.\n\n188\n00:09:52.151 --> 00:09:54.411\nThat's why I'm not reusing\none of my other ones.\n\n189\n00:09:54.411 --> 00:09:57.390\nThe VLAN has to be flagged for RSPAN.\n\n190\n00:09:59.270 --> 00:10:05.480\nOnce that's done,\nnow if I do show VLAN and\n\n191\n00:10:05.480 --> 00:10:10.080\nI take a look at my VLANs, I've got\nthis 99 VLAN that I've named RSPAN, and\n\n192\n00:10:10.080 --> 00:10:12.980\nit shows up here in my VLAN output.\n\n193\n00:10:12.980 --> 00:10:13.670\nRight?\n\n194\n00:10:13.670 --> 00:10:16.760\nBut when I take a look at\nthings like spanning tree.\n\n195\n00:10:18.740 --> 00:10:22.160\nWhen I go and look at its config here's\nthe VLAN one and its information.\n\n196\n00:10:22.160 --> 00:10:24.948\nAnd then the VLAN 2 and VLAN 3.\n\n197\n00:10:24.948 --> 00:10:29.052\nAnd there's V VLAN 999,\nit's actually up and\n\n198\n00:10:29.052 --> 00:10:32.680\nworking as a true VLAN, but RSPAN enabled.\n\n199\n00:10:34.380 --> 00:10:39.490\nNow what I can do is I can say monitor\nsession and whatever number I want to use.\n\n200\n00:10:39.490 --> 00:10:43.030\nI used 1 in the other episode,\nso I'll use 2 this time.\n\n201\n00:10:43.030 --> 00:10:50.820\nSo I'll say monitor session 2,\nsource interface fa0/1, right?\n\n202\n00:10:50.820 --> 00:10:52.780\nThen I want traffic going\nin both directions, so\n\n203\n00:10:52.780 --> 00:10:54.560\nI'm going to grab Daniel's traffic.\n\n204\n00:10:54.560 --> 00:10:57.090\nHe's on port one and\nI want to capture all of that.\n\n205\n00:10:57.090 --> 00:11:01.700\nSo now, if I want to actually see\nDaniel's traffic, I need to set up RSPAN.\n\n206\n00:11:01.700 --> 00:11:04.600\nI need to be able to monitor that\nconnection on the other side.\n\n207\n00:11:04.600 --> 00:11:07.800\nAnd bring it into my system even though\nI'm not plugged into the same switch.\n\n208\n00:11:07.800 --> 00:11:10.980\nAnd the setup for it is really not\nthat hard, but it's a couple of\n\n209\n00:11:10.980 --> 00:11:14.260\nextra steps that we have to jump\nthrough to get that working, right?\n\n210\n00:11:14.260 --> 00:11:15.310\nFirst off,\n\n211\n00:11:15.310 --> 00:11:20.515\nI'm going to have to create a VLAN because\nI'm gonna capture Daniel's traffic and\n\n212\n00:11:20.515 --> 00:11:24.065\ninstead of throwing it to a destination\nport, I'm gonna throw it on a VLAN.\n\n213\n00:11:24.065 --> 00:11:26.915\nAnd the VLAN will carry it to my\nswitch and then I capture it there and\n\n214\n00:11:26.915 --> 00:11:27.775\nthrow it to my port.\n\n215\n00:11:27.775 --> 00:11:30.567\nSo we're gonna create this fake\nVLAN to carry the traffic, and\n\n216\n00:11:30.567 --> 00:11:32.567\nthat's where I start\nwith my configuration.\n\n217\n00:11:32.567 --> 00:11:33.127\nAll right?\n\n218\n00:11:33.127 --> 00:11:34.537\nSo here I am on my switch.\n\n219\n00:11:34.537 --> 00:11:35.717\nNow I'm gonna go and get that set up.\n\n220\n00:11:35.717 --> 00:11:40.027\nAnd actually even before I do that,\nI'm gonna do a no monitor session 1,\n\n221\n00:11:40.027 --> 00:11:41.557\njust to turn that session off.\n\n222\n00:11:41.557 --> 00:11:44.010\nSo now I'm not Monmitoring at all.\n\n223\n00:11:44.010 --> 00:11:49.270\nI don't wanna kinda taint my results\nhere on the experiment of itself.\n\n224\n00:11:49.270 --> 00:11:51.430\nAll right, so\nI'm gonna start off by creating VLAN.\n\n225\n00:11:51.430 --> 00:11:52.840\nI'll just do VLAN999.\n\n226\n00:11:52.840 --> 00:11:56.920\nYou pick any number that\nyou're not currently using.\n\n227\n00:11:56.920 --> 00:12:01.131\nNow, you might be tempted to reuse\na VLAN you already have, right?\n\n228\n00:12:01.131 --> 00:12:04.631\nSo, for example,\nI've got VLAN1, VLAN2, VLAN3.\n\n229\n00:12:04.631 --> 00:12:09.210\nBut, don't use your normal VLANs because\nthe VLAN is going to be a special one.\n\n230\n00:12:09.210 --> 00:12:11.228\nWe have an extra command for it.\n\n231\n00:12:11.228 --> 00:12:15.030\nWhich is remote-span and\n\n232\n00:12:15.030 --> 00:12:19.250\nthat tells it that this vlan is gonna be\nused for RSPAN and that makes it special.\n\n233\n00:12:19.250 --> 00:12:22.390\nRight, so you don't want normal\ndata on this network, just RSPAN.\n\n234\n00:12:22.390 --> 00:12:25.260\nSo pick a VLAN number you're not using,\nthere's plenty of them.\n\n235\n00:12:25.260 --> 00:12:26.760\nAnd then once we've got that.\n\n236\n00:12:26.760 --> 00:12:28.990\nI'm gonna give it a name just so\nI can remember.\n\n237\n00:12:28.990 --> 00:12:29.820\nI'll just call it RSPAN.\n\n238\n00:12:29.820 --> 00:12:31.981\nYou can call it whatever the heck\nyou want, but I'll call it RSPAN.\n\n239\n00:12:31.981 --> 00:12:33.641\nSo now I got that VLAN created.\n\n240\n00:12:33.641 --> 00:12:35.781\nI am going to do the same\nthing on Daniel's switch.\n\n241\n00:12:35.781 --> 00:12:39.891\nI'm going to jump over to his and\nsay VLAN 999.\n\n242\n00:12:39.891 --> 00:12:46.320\nI'll give it a name of RSPAN and\nflag it as a remote span view in.\n\n243\n00:12:46.320 --> 00:12:46.880\nThere he is.\n\n244\n00:12:46.880 --> 00:12:48.170\nI got this VLAN in place.\n\n245\n00:12:48.170 --> 00:12:49.272\nIt is ready for RSPAN.\n\n246\n00:12:49.272 --> 00:12:54.480\nAll right, on his side I need\nto create a monitor session\n\n247\n00:12:54.480 --> 00:12:59.390\nthat grabs his laptop's traffic and\nthrows it onto the VLAN, right.\n\n248\n00:12:59.390 --> 00:13:05.430\nSo I'm gonna say monitor session, and\nthen whatever number it is that I choose,\n\n249\n00:13:06.460 --> 00:13:12.200\nI'll do session 2 source int fa0/1\ncuz that's what he's plugged into.\n\n250\n00:13:12.200 --> 00:13:13.750\nAnd I want both directions.\n\n251\n00:13:13.750 --> 00:13:17.450\nAll right so far this is just like when\nwe set up regular spam, all right.\n\n252\n00:13:17.450 --> 00:13:22.880\nBut them I'm gonna say monitor\nsession 2 destination and\n\n253\n00:13:22.880 --> 00:13:28.980\ninstead of an interface I'm\ngonna say remote VLAN 999.\n\n254\n00:13:28.980 --> 00:13:33.110\nOkay, that's where I'm gonna be sending\nit to instead of an actual interface.\n\n255\n00:13:33.110 --> 00:13:35.390\nNow on older switches,\n\n256\n00:13:35.390 --> 00:13:37.920\nthere's actually a little bit more\nthat we have to do with this.\n\n257\n00:13:37.920 --> 00:13:41.890\nYou'll see there's options to set\nwhat's called a reflector port.\n\n258\n00:13:41.890 --> 00:13:45.300\nAnd that's because the older\nswitches didn't really have enough\n\n259\n00:13:45.300 --> 00:13:49.010\nhorsepower to be able to push this\nover vlans, over complex connections.\n\n260\n00:13:49.010 --> 00:13:50.980\nYou had to tie it to a physical port.\n\n261\n00:13:50.980 --> 00:13:53.610\nSo you had to go on and\nspecify that physical port, beyond here.\n\n262\n00:13:53.610 --> 00:13:56.940\nBut on the switches on the exam, on\nyour current switches that you go on and\n\n263\n00:13:56.940 --> 00:14:00.520\nbuy today, on your newer stuff,\nyou don't have to worry about that.\n\n264\n00:14:00.520 --> 00:14:03.700\nYou just designate the VLAN and\nthat's that.\n\n265\n00:14:03.700 --> 00:14:07.840\nRight now,\nit's capturing Daniel's laptop's traffic,\n\n266\n00:14:07.840 --> 00:14:09.640\nsending it along wherever\nit goes normally.\n\n267\n00:14:09.640 --> 00:14:14.775\nSo it's just capturing everything on\nfa0/1 and sending a copy to VLAN 999.\n\n268\n00:14:14.775 --> 00:14:15.515\nRight?\n\n269\n00:14:15.515 --> 00:14:21.295\nWell, VLAN 999 is gonna cross\nthis trunk to my switch.\n\n270\n00:14:21.295 --> 00:14:23.255\nAnd on my switch, right?\n\n271\n00:14:23.255 --> 00:14:26.035\nSo I just set up SPAN down\nhere to capture Daniel.\n\n272\n00:14:26.035 --> 00:14:32.575\nOn my switch, I can set up SPAN to capture\nnot a physical port, but that VLAN.\n\n273\n00:14:32.575 --> 00:14:35.315\nSo we can grab that VLAN and\nthen send it to my laptop and\n\n274\n00:14:35.315 --> 00:14:36.600\nwe'll be in business, right.\n\n275\n00:14:36.600 --> 00:14:42.780\nSo if I jump back over to my\nswitch which is switch 1 here,\n\n276\n00:14:42.780 --> 00:14:47.800\nI can come in and I can say monitor\nsession and whatever number.\n\n277\n00:14:47.800 --> 00:14:50.730\nI cleared out session 1, so I'll reuse it.\n\n278\n00:14:50.730 --> 00:14:54.390\nMonitor session 1 source and\n\n279\n00:14:54.390 --> 00:14:57.350\nI'm such in the habit of typing source\ninterface that I'm typing it already.\n\n280\n00:14:57.350 --> 00:15:01.410\nInstead of interface,\nI can say source remote, right.\n\n281\n00:15:01.410 --> 00:15:02.660\nMy remote span.\n\n282\n00:15:02.660 --> 00:15:04.240\nSee how I can do it in VLAN also.\n\n283\n00:15:04.240 --> 00:15:06.350\nI could say a local VLAN.\n\n284\n00:15:06.350 --> 00:15:07.480\nBut that's not what I am capturing.\n\n285\n00:15:07.480 --> 00:15:11.400\nThat is useful if you are trying to\ncapture like the traffic on VLAN 1 or\n\n286\n00:15:11.400 --> 00:15:13.810\nVLAN 2 for a layer 3 switch.\n\n287\n00:15:13.810 --> 00:15:16.110\nBut, in my case I need a remote vlan.\n\n288\n00:15:16.110 --> 00:15:19.180\nSo I got to say remove VLAN,\nand then that number.\n\n289\n00:15:19.180 --> 00:15:19.980\n999.\n\n290\n00:15:19.980 --> 00:15:22.480\nThat is the source.\n\n291\n00:15:22.480 --> 00:15:28.780\nThen monitor session 1 destination,\nnow it's going to be my laptop.\n\n292\n00:15:28.780 --> 00:15:30.160\nSo it's gonna monitor that VLAN,\n\n293\n00:15:30.160 --> 00:15:34.720\nany traffic it sees, it's gonna send\nto my laptop and now that's in place.\n\n294\n00:15:34.720 --> 00:15:38.990\nSo it's up and it's running and\nI'm capturing traffic, in theory.\n\n295\n00:15:38.990 --> 00:15:40.570\nI guess we can go and see.\n\n296\n00:15:40.570 --> 00:15:45.550\nLet me fire up my wireshark\nagain which is here and\n\n297\n00:15:45.550 --> 00:15:47.250\nI was running this capture earlier.\n\n298\n00:15:47.250 --> 00:15:49.630\nSo I was capturing telnet traffic and\n\n299\n00:15:49.630 --> 00:15:52.650\nI couldn't see Daniel\ntelnet into that switch.\n\n300\n00:15:52.650 --> 00:15:55.610\nLet me kinda reset this and start again.\n\n301\n00:15:55.610 --> 00:15:56.750\nIt's running.\n\n302\n00:15:56.750 --> 00:15:59.880\nAnd now, what I'm going to do\nis I'm going to have Daniel.\n\n303\n00:15:59.880 --> 00:16:04.686\nHe's going to telnet from his\nlaptop in to this switch.\n\n304\n00:16:04.686 --> 00:16:07.937\nNow over here,\nI'm not plugged in to his switch.\n\n305\n00:16:07.937 --> 00:16:10.584\nBut his traffic will get sent to VLAN 999.\n\n306\n00:16:10.584 --> 00:16:13.676\nThat'll cross the link to the other side,\nwe'll receive it and\n\n307\n00:16:13.676 --> 00:16:15.400\nwe'll send it to my laptop.\n\n308\n00:16:15.400 --> 00:16:18.430\nAnd so now I'm monitoring\nhis port even though I'm not\n\n309\n00:16:18.430 --> 00:16:20.000\nplugged into the same switch.\n\n310\n00:16:20.000 --> 00:16:20.590\nAll right.\n\n311\n00:16:20.590 --> 00:16:22.983\nSo if we jump back to my wire sharp,\n\n312\n00:16:22.983 --> 00:16:27.623\nDaniel can you telnet into 10.1.230.245,\nplease?\n\n313\n00:16:27.623 --> 00:16:30.025\n>> .245, let's give that a shot here.\n\n314\n00:16:30.025 --> 00:16:34.436\nTelnet into 245.\n\n315\n00:16:34.436 --> 00:16:35.930\nThere we go.\n\n316\n00:16:35.930 --> 00:16:38.080\nAnd it looks all good.\n\n317\n00:16:38.080 --> 00:16:39.220\nI'll type in my user name here I guess.\n\n318\n00:16:41.580 --> 00:16:44.400\nAnd then my super secret password.\n\n319\n00:16:45.660 --> 00:16:47.730\nNot such super secret passwords.\n\n320\n00:16:47.730 --> 00:16:48.610\nBut whatever.\n>> [LAUGH]\n\n321\n00:16:48.610 --> 00:16:49.110\n>> All right.\n\n322\n00:16:49.110 --> 00:16:49.610\n>> It's a lab environment.\n\n323\n00:16:49.610 --> 00:16:50.327\n[LAUGH]\n\n324\n00:16:50.327 --> 00:16:51.417\n>> Now when I did this earlier,\n\n325\n00:16:51.417 --> 00:16:52.140\nwhat did we see?\n\n326\n00:16:52.140 --> 00:16:52.720\nNothing.\n\n327\n00:16:52.720 --> 00:16:55.400\nI wasn't seeing his traffic,\ncuz I wasn't on the same switch.\n\n328\n00:16:55.400 --> 00:16:57.360\nAnd I couldn't capture his port.\n\n329\n00:16:57.360 --> 00:16:59.450\nNow I'm seeing that traffic.\n\n330\n00:16:59.450 --> 00:17:00.630\nI see his laptop.\n\n331\n00:17:00.630 --> 00:17:03.770\nHe's .15.\nAnd I see him talking to .245.\n\n332\n00:17:03.770 --> 00:17:06.430\nAnd I can follow that stream,\njust like I did before.\n\n333\n00:17:06.430 --> 00:17:08.000\nAnd I can actually see him logging in.\n\n334\n00:17:08.000 --> 00:17:09.340\nAnd everything he typed.\n\n335\n00:17:09.340 --> 00:17:10.880\nI see it happening, right.\n\n336\n00:17:10.880 --> 00:17:12.700\nEven though I'm remote.\n\n337\n00:17:12.700 --> 00:17:14.570\nNow, here's the thing about rspan.\n\n338\n00:17:14.570 --> 00:17:15.290\nIt works great.\n\n339\n00:17:15.290 --> 00:17:18.490\nI got it set up and\nin place and we're in business.\n\n340\n00:17:18.490 --> 00:17:23.665\nJust like regular span, when you're done\nwith it, it is important to turn if off.\n\n341\n00:17:23.665 --> 00:17:26.380\nCuz if I don't turn it off,\n\n342\n00:17:26.380 --> 00:17:28.860\nthere's some interesting things\nthat could happen, right.\n\n343\n00:17:28.860 --> 00:17:36.000\nLet's say that Daniel starts copying\na file to a machine that's on my switch.\n\n344\n00:17:36.000 --> 00:17:40.050\nSo Daniel starts copying a file from his\nlaptop to another machine that's plugged\n\n345\n00:17:40.050 --> 00:17:45.100\ninto this switch over here, so maybe here\nwe'll throw another laptop out here and\n\n346\n00:17:45.100 --> 00:17:47.330\nwe'll plug it into the network.\n\n347\n00:17:47.330 --> 00:17:52.210\nSo, when he starts to copy that file,\nhis path through the network\n\n348\n00:17:52.210 --> 00:17:56.900\nis to go up to this switch, over to\nthis switch, and to his destination.\n\n349\n00:17:56.900 --> 00:17:58.890\nRight.\nSo he's copying that file along and\n\n350\n00:17:58.890 --> 00:18:00.280\nthat's how it goes.\n\n351\n00:18:00.280 --> 00:18:05.090\nWell, when he sends that data up here,\nspan says okay.\n\n352\n00:18:05.090 --> 00:18:06.330\nLet's say he's on VLAN one.\n\n353\n00:18:06.330 --> 00:18:10.310\nSo he's coming across some VLAN one,\nit's gonna capture his traffic, and\n\n354\n00:18:10.310 --> 00:18:14.770\nstick it on VLAN 999 also, which is\ngonna cross this trunk and come to me.\n\n355\n00:18:14.770 --> 00:18:20.780\nSo now, when he copies a, let's say\nhe copies a gigabyte file, right?\n\n356\n00:18:20.780 --> 00:18:23.890\nIt's gonna be copied from\nVLAN 1 to VLAN 99 and\n\n357\n00:18:23.890 --> 00:18:27.150\nnow it's like topping 2 gigabyte\nfiles at the same time.\n\n358\n00:18:27.150 --> 00:18:27.650\nRight?\n\n359\n00:18:27.650 --> 00:18:32.080\nSo Daniel is gonna be occupying twice\nthe bandwidth when he crosses this\n\n360\n00:18:32.080 --> 00:18:33.890\ntrunk than normal.\n\n361\n00:18:33.890 --> 00:18:37.800\nAnd his local communications\nto other people on his switch\n\n362\n00:18:37.800 --> 00:18:39.320\nare gonna be coming across this trunk.\n\n363\n00:18:39.320 --> 00:18:41.820\nSo now he's occupying more\nbandwidth than normal, right?\n\n364\n00:18:41.820 --> 00:18:43.060\nSo if I just leave this on and\n\n365\n00:18:43.060 --> 00:18:45.400\nforget about it,\nI need a plan for that bandwidth.\n\n366\n00:18:45.400 --> 00:18:49.270\nI need a plan for the fact that I'm losing\nsome of the room cuz I'm cloning traffic.\n\n367\n00:18:49.270 --> 00:18:51.450\nAnd there's no good way around that,\n\n368\n00:18:51.450 --> 00:18:56.000\nother than actually me plugging my laptop\nin over there instead of using RSPAN.\n\n369\n00:18:56.000 --> 00:18:58.190\nSo with RSPAN,\nalways keep it in the back of your mind,\n\n370\n00:18:58.190 --> 00:19:02.280\nremember there's gonna be bandwidth on the\ntrunk, and it's gotta come from somewhere,\n\n371\n00:19:02.280 --> 00:19:05.750\nit's gonna be competing with\nthe other traffic on your network.\n\n372\n00:19:05.750 --> 00:19:07.520\nSo we put this in place, we use it.\n\n373\n00:19:07.520 --> 00:19:10.380\nAnd you'll notice the whole\ntime I configured that,\n\n374\n00:19:10.380 --> 00:19:12.330\nnone of my interfaces ever went down.\n\n375\n00:19:12.330 --> 00:19:16.230\nI can turn on RSPAN right in the middle\nof the day when Daniel's plugged in and\n\n376\n00:19:16.230 --> 00:19:18.870\nworking, and\nhe won't even know what happened.\n\n377\n00:19:18.870 --> 00:19:20.520\nThat's the fun part, right?\n\n378\n00:19:20.520 --> 00:19:22.360\nSo I can be monitoring someone's traffic.\n\n379\n00:19:22.360 --> 00:19:26.130\nSo when I get that report that hey,\nI think somebody's infected with a virus.\n\n380\n00:19:26.130 --> 00:19:29.040\nWe're seeing a bunch of SMTP\ntraffic on the network.\n\n381\n00:19:29.040 --> 00:19:32.135\nI can start monitoring ports and\nit doesn't shut them off.\n\n382\n00:19:32.135 --> 00:19:36.190\nCuz what happens is if\nyou shut a port off,\n\n383\n00:19:36.190 --> 00:19:39.510\nmaybe the malicious software or\nwhatever stops.\n\n384\n00:19:39.510 --> 00:19:42.150\nAnd then you can't tell\nwhere it came from, right?\n\n385\n00:19:42.150 --> 00:19:43.060\nSo we need it flowing,\n\n386\n00:19:43.060 --> 00:19:46.860\nwe need it running to be able to\ntrack it down RSpan lets us do that.\n\n387\n00:19:46.860 --> 00:19:50.440\nBut when we're done, it's not\nenough to shut off the destination,\n\n388\n00:19:50.440 --> 00:19:52.170\nyou can actually leave the destination on.\n\n389\n00:19:52.170 --> 00:19:56.280\nYou got to shut off the source so that\nyou're not receiving that flow of traffic.\n\n390\n00:19:56.280 --> 00:19:57.700\nNow I don't mean shut\nthe source port down,\n\n391\n00:19:57.700 --> 00:20:00.980\nI mean shut the source of\nthe monitor session down, right.\n\n392\n00:20:00.980 --> 00:20:04.940\nSo when you're done, you have to go back\nto each of your switches to kill that\n\n393\n00:20:04.940 --> 00:20:10.020\nsession by doing a no monitor session and\nwhatever the name is of that session.\n\n394\n00:20:10.020 --> 00:20:11.510\nAnd that will kill that off.\n\n395\n00:20:11.510 --> 00:20:14.030\nI will do the same over\nhere on the other switch\n\n396\n00:20:14.030 --> 00:20:15.480\nwhere I used the session number two.\n\n397\n00:20:15.480 --> 00:20:18.180\nAnd we will kill that one off.\n\n398\n00:20:18.180 --> 00:20:18.780\nRight.\n\n399\n00:20:18.780 --> 00:20:23.705\nNow that those are done, if I stop\nthis capture and kinda start it again.\n\n400\n00:20:23.705 --> 00:20:27.835\nI'm going to change that back\nto a tell net session, so\n\n401\n00:20:27.835 --> 00:20:32.230\nI'm looking for\njust tell net traffic, so there.\n\n402\n00:20:32.230 --> 00:20:35.525\nAnd Dano can you turn that into that\nswitch just one more time for me, please.\n\n403\n00:20:35.525 --> 00:20:36.280\n>> Turn them on.\n\n404\n00:20:36.280 --> 00:20:36.976\nThere we go.\n\n405\n00:20:36.976 --> 00:20:37.582\n>> 245.\n\n406\n00:20:37.582 --> 00:20:41.530\nAnd so I'm just verifying that I'm\nnot receiving his traffic anymore.\n\n407\n00:20:41.530 --> 00:20:45.050\nI still have VLAN 999 to find and\nit's still a remote span VLAN.\n\n408\n00:20:45.050 --> 00:20:47.940\nI can leave that because\nthere's no traffic on it.\n\n409\n00:20:47.940 --> 00:20:50.480\nAnd I can leave myself as\nthe destination cuz again,\n\n410\n00:20:50.480 --> 00:20:52.390\nthere's no traffic on that VLAN.\n\n411\n00:20:52.390 --> 00:20:53.760\nIt's really the source\nthat I gotta turn off.\n\n412\n00:20:53.760 --> 00:20:55.434\nSo I could leave my work\nstation configured,\n\n413\n00:20:55.434 --> 00:20:57.010\nI could leave the VLAN in there.\n\n414\n00:20:57.010 --> 00:21:00.280\nAnd just turn on and off different sources\non any of the switches in my network.\n\n415\n00:21:00.280 --> 00:21:04.010\nIf I define VLAN999 across\na hundred switches, and\n\n416\n00:21:04.010 --> 00:21:07.870\nI ever needed to monitor somebody,\nall I need to do is go to that switch and\n\n417\n00:21:07.870 --> 00:21:12.220\nsay monitor this port, send it to VLAN999.\n\n418\n00:21:12.220 --> 00:21:13.980\nAnd I'd start receiving that on my laptop.\n\n419\n00:21:13.980 --> 00:21:14.960\nAll right?\nSo it is kinda\n\n420\n00:21:14.960 --> 00:21:16.440\nuseful to leave it configured.\n\n421\n00:21:16.440 --> 00:21:20.100\nAnd if you're putting an IDS in place,\nwell,\n\n422\n00:21:20.100 --> 00:21:22.120\nyou really shouldn't be using RS band for\nthat, right?\n\n423\n00:21:22.120 --> 00:21:26.570\nTo get the best performance and\ntime sync and bandwidth consumption,\n\n424\n00:21:26.570 --> 00:21:30.300\nthe IDS should be plugged into the same\nswitch as the device it's monitoring.\n\n425\n00:21:30.300 --> 00:21:33.770\nBut you could use it with\nRSPAN if you really wanted to.\n\n426\n00:21:33.770 --> 00:21:37.130\nJust understand you're gonna take up\ntwice the bandwidth on your trunks.\n\n427\n00:21:37.130 --> 00:21:39.610\n>> Now Don, we have a great\nquestion from our chat room.\n\n428\n00:21:39.610 --> 00:21:43.390\nRick asked can you set up\na dedicated connection So\n\n429\n00:21:43.390 --> 00:21:45.610\nthe RSpan has its own bandwidth.\n\n430\n00:21:45.610 --> 00:21:47.813\nIt doesn't start saturating the.\n\n431\n00:21:47.813 --> 00:21:48.992\n>> Yeah you certainly can.\n\n432\n00:21:48.992 --> 00:21:52.378\nThere's a few different ways to handle it,\n\n433\n00:21:52.378 --> 00:21:56.385\nthere's, I'm trying to\nthink of the best way.\n\n434\n00:21:56.385 --> 00:21:59.295\nThe best way, honestly,\nis that these are just VLANs, right?\n\n435\n00:21:59.295 --> 00:22:01.875\nAnd when you set up a trunk,\n\n436\n00:22:01.875 --> 00:22:05.085\nyou can filter what VLAN is\nallowed on a trunk, right?\n\n437\n00:22:05.085 --> 00:22:10.170\nSo you could take a trunk and\nfilter it to just VLAN 999.\n\n438\n00:22:10.170 --> 00:22:12.730\nAnd then have another trunk that\ncarried all of the other VLANs.\n\n439\n00:22:12.730 --> 00:22:15.000\nSo now you've got a dedicated\ntrunk with just VLAN 99 and\n\n440\n00:22:15.000 --> 00:22:16.620\nyou can use that to hop\nbetween the switches.\n\n441\n00:22:16.620 --> 00:22:19.770\nNow, that works if you have two or\nthree switches but\n\n442\n00:22:19.770 --> 00:22:23.710\nif you have 100 switches, it's a lot of\ndedicated links that you're setting up and\n\n443\n00:22:23.710 --> 00:22:25.860\nRSPAM becomes a lot less practical.\n\n444\n00:22:25.860 --> 00:22:29.850\nAnd that's why I was hesitating to say\nthat is, it certainly can be done.\n\n445\n00:22:29.850 --> 00:22:36.250\nYou also could set up dedicated access\nports to try and move the traffic, too.\n\n446\n00:22:36.250 --> 00:22:40.180\nThat's a little bit flaky though, cuz your\nswitches start to get involved in layer 2\n\n447\n00:22:40.180 --> 00:22:43.280\nheaders and so\nthe packets aren't in their original form.\n\n448\n00:22:43.280 --> 00:22:45.020\nThat's why using the VLAN is so important.\n\n449\n00:22:45.020 --> 00:22:46.570\nThat's why you have to flag it that way.\n\n450\n00:22:46.570 --> 00:22:49.710\nWhen you say this is a remote span VLAN,\nit's saying,\n\n451\n00:22:49.710 --> 00:22:53.855\nwhen I move a frame onto it,\ndo not mess with the layer two header.\n\n452\n00:22:53.855 --> 00:22:56.100\nNormall, your VLANs will\nmess up a layer two header.\n\n453\n00:22:56.100 --> 00:22:57.420\nThis stops that.\n\n454\n00:22:57.420 --> 00:22:58.390\nSo, that's why we have that.\n\n455\n00:22:58.390 --> 00:23:01.520\nAnd you can filter the VLAN, that'll\nwork out, you can certainly do that and\n\n456\n00:23:01.520 --> 00:23:02.710\nmake the dedicated interfaces.\n\n457\n00:23:03.930 --> 00:23:08.087\nIf you want something that gives you even\nmore control, it's not on the exam, but\n\n458\n00:23:08.087 --> 00:23:11.110\nthere's something called a layer 2 tunnel,\nL2 tunnel.\n\n459\n00:23:12.530 --> 00:23:14.225\nOnly the higher end Cisco\nswitches support it.\n\n460\n00:23:14.225 --> 00:23:19.820\nI'm pretty sure mine don't, but you could\ngo in, and you could set up an L2 tunnel,\n\n461\n00:23:19.820 --> 00:23:24.408\nand you can actually tunnel traffic\nfrom one interface to another, or\n\n462\n00:23:24.408 --> 00:23:27.675\nreally across your network\nwith this tunnel, and\n\n463\n00:23:27.675 --> 00:23:31.500\nthen you can set up that as\nthe destination for the span.\n\n464\n00:23:31.500 --> 00:23:33.630\nSo a couple of different techniques there.\n\n465\n00:23:33.630 --> 00:23:37.280\nBut the VLAN filtering, that's probably\nthe easiest, just go on the trunk and\n\n466\n00:23:37.280 --> 00:23:39.530\ndo that, all right.\n\n467\n00:23:39.530 --> 00:23:42.970\nRick asked a question about,\ndid I add VLAN 999 to the trunk or\n\n468\n00:23:42.970 --> 00:23:44.490\ndid that happen automatically?\n\n469\n00:23:44.490 --> 00:23:45.980\nIt happened automatically.\n\n470\n00:23:45.980 --> 00:23:48.370\nJust because I haven't done any filtering,\nright.\n\n471\n00:23:48.370 --> 00:23:50.520\nSo let me bring that back up real quick.\n\n472\n00:23:50.520 --> 00:23:55.150\nSo I still have that VLAN\n999 defined right here.\n\n473\n00:23:55.150 --> 00:23:59.650\nSo by default on\n\n474\n00:23:59.650 --> 00:24:03.840\nCISCO equipment when you create VLAN\nit's automatically added to the trunks.\n\n475\n00:24:03.840 --> 00:24:06.690\nSo when you do a show interface trunk,\n\n476\n00:24:08.390 --> 00:24:11.290\nas you create VLANs they're\nautomatically added to the trunk.\n\n477\n00:24:11.290 --> 00:24:12.640\nNow they might not go active.\n\n478\n00:24:12.640 --> 00:24:15.980\nYou have to have at least one port\nin the VLAN for it to go active, but\n\n479\n00:24:15.980 --> 00:24:19.810\nassuming that you do,\nthen you'll see them active right there.\n\n480\n00:24:19.810 --> 00:24:22.910\nAnd so I've got that port 24 as my\ntrunk it's carrying one through 3999.\n\n481\n00:24:22.910 --> 00:24:25.580\nThat was automatic, right?\n\n482\n00:24:25.580 --> 00:24:28.020\nIf we have filters in place,\nit's not automatic and\n\n483\n00:24:28.020 --> 00:24:29.540\nthat's where we have to go and\ncustomize it.\n\n484\n00:24:29.540 --> 00:24:30.510\nSo for\n\n485\n00:24:30.510 --> 00:24:34.970\nexample, doubling back to your earlier\nquestion about having a dedicated one.\n\n486\n00:24:34.970 --> 00:24:39.298\nI could create another trunk so maybe\nlike fa0/23 and we could set that up for\n\n487\n00:24:39.298 --> 00:24:46.360\nthat one, we could set it to via trunk.\n\n488\n00:24:46.360 --> 00:24:51.410\nAnd we could set up no negotiation,\nso it's always a trunk, right?\n\n489\n00:24:51.410 --> 00:24:56.627\nAnd then you can say switchboard and\ntrunk and set the allowed VLANs and\n\n490\n00:24:56.627 --> 00:25:00.390\nyou could specify exactly\nwhat VLAN you want.\n\n491\n00:25:00.390 --> 00:25:06.180\nSo maybe on this one,\nI only want VLAN 999,\n\n492\n00:25:06.180 --> 00:25:11.524\nbut then on fa0/24, I might say switch\n\n493\n00:25:11.524 --> 00:25:16.580\nport trunk allowed VLAN except 999.\n\n494\n00:25:16.580 --> 00:25:17.550\nOkay?\n\n495\n00:25:17.550 --> 00:25:19.670\nSo now on port 23.\n\n496\n00:25:19.670 --> 00:25:24.240\nI only have VLAN 999 and\non port 24 I have everything except 999.\n\n497\n00:25:24.240 --> 00:25:28.480\nSo now, I've kinda split those out and\nbroken them apart.\n\n498\n00:25:28.480 --> 00:25:31.220\nNow, that interface for\nme doesn't have anything plugged into it.\n\n499\n00:25:31.220 --> 00:25:35.340\nSo I don't think that'll actually show for\nme in a show interface trunk now.\n\n500\n00:25:35.340 --> 00:25:37.800\nBut it will be in the config.\n\n501\n00:25:37.800 --> 00:25:42.440\nLet me just jump to that and of course\nit's gonna match my security token.\n\n502\n00:25:42.440 --> 00:25:43.120\nThere.\n\n503\n00:25:43.120 --> 00:25:45.110\nAll right.\nSo now you can see you're on port 23.\n\n504\n00:25:45.110 --> 00:25:47.034\nSee how it's doing just\nallowed VLAN 999 and\n\n505\n00:25:47.034 --> 00:25:50.320\nthen here it's doing allowed one\nthrough 998 and then 1000 to 4094.\n\n506\n00:25:50.320 --> 00:25:56.878\nSo that kinda achieves that goal of\na dedicated connection for that VLAN.\n\n507\n00:25:56.878 --> 00:25:57.456\n>> Great question.\n\n508\n00:25:57.456 --> 00:25:58.290\n>> Yeah.\n\n509\n00:25:58.290 --> 00:26:01.030\nAll right, well,\nthat in a nutshell is our spam.\n\n510\n00:26:01.030 --> 00:26:04.240\nI know I spent a lot longer on that than\nI intended to, but it is good stuff.\n\n511\n00:26:04.240 --> 00:26:05.860\nWe saw span in the first episode.\n\n512\n00:26:05.860 --> 00:26:07.020\nRSPAN in this one.\n\n513\n00:26:07.020 --> 00:26:08.060\nThey're both on the exam.\n\n514\n00:26:08.060 --> 00:26:09.930\nThey're both useful in real life land.\n\n515\n00:26:09.930 --> 00:26:11.155\nIt's just good stuff.\n\n516\n00:26:11.155 --> 00:26:14.740\n>> RSPAN's great for those lazy admins\nout there that don't wanna get up\n\n517\n00:26:14.740 --> 00:26:16.340\nfrom their desk, right [LAUGH]\n>> [LAUGH] Yeah, or\n\n518\n00:26:16.340 --> 00:26:18.590\nif you just have a really big,\ncomplex network.\n\n519\n00:26:18.590 --> 00:26:20.310\nSometimes physical access to the switch\n\n520\n00:26:20.310 --> 00:26:21.530\nisn't-\n>> Practical.\n\n521\n00:26:21.530 --> 00:26:22.340\n>> Yeah.\n\n522\n00:26:22.340 --> 00:26:24.270\n>> And in this case I didn't\nhave to move any cables.\n\n523\n00:26:24.270 --> 00:26:27.300\nI can just remote into another switch,\ncapture that traffic,\n\n524\n00:26:27.300 --> 00:26:29.500\nsend it to VLAN 999 and\nI start getting it.\n\n525\n00:26:29.500 --> 00:26:30.080\n>> Awesome.\n\n526\n00:26:30.080 --> 00:26:32.820\nWell Don is there anything else we need to\ntalk about this episode before we bring it\n\n527\n00:26:32.820 --> 00:26:33.610\nto a close?\n\n528\n00:26:33.610 --> 00:26:35.460\n>> I think that's it for SPAN and RSPAN.\n\n529\n00:26:35.460 --> 00:26:38.950\nWe do have more topics to cover but\nwe'll save those for another day.\n\n530\n00:26:38.950 --> 00:26:40.750\n>> All right.\nWell excellent demonstrations.\n\n531\n00:26:40.750 --> 00:26:41.670\nThanks for that.\n\n532\n00:26:41.670 --> 00:26:44.600\nThank for watching today, we're gonna\ngo ahead and sign off for IT Pro TV.\n\n533\n00:26:44.600 --> 00:26:46.550\nI've been your host Daniel Lowery.\n\n534\n00:26:46.550 --> 00:26:47.260\n>> And, I'm Don Pezet.\n\n535\n00:26:47.260 --> 00:26:49.970\n>> And, we'll see you next time.\n\n536\n00:26:49.970 --> 00:26:54.990\n[MUSIC]\n\n",
          "vimeoId": "145312791"
        },
        {
          "description": "In this episode, Ronnie and Don introduce the Cisco StackWise technology.  They discuss the advantage of using StackWise and it's benefits.  They also show how to configure a StackWise Master and provision other switches in the StackWise cluster.",
          "length": "2010",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-8-cisco_stackwise-101315-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-8-cisco_stackwise-101315-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-1-8-cisco_stackwise-101315-1-sm.jpg",
          "title": "Cisco StackWise",
          "transcript": "WEBVTT\n\n1\n00:00:00.171 --> 00:00:10.644\n[MUSIC]\n\n2\n00:00:10.644 --> 00:00:13.440\nWelcome to another great\nepisode here on ITProTV.\n\n3\n00:00:13.440 --> 00:00:17.340\nI'm your host, Ronnie Wong, and\nwe're taking a look at CCNP switch today.\n\n4\n00:00:17.340 --> 00:00:20.040\nTo help us out,\nhere with us, Mr. Don Pezet.\n\n5\n00:00:20.040 --> 00:00:20.960\nHow's it going, Don?\n\n6\n00:00:20.960 --> 00:00:22.020\n>> It is going great, Ronnie.\n\n7\n00:00:22.020 --> 00:00:25.690\nGlad to be back on the show and ready to\njump back into the world of CCNP switch.\n\n8\n00:00:25.690 --> 00:00:29.250\nToday we're gonna be taking a look at\ntechnology that not a lot of people get to\n\n9\n00:00:29.250 --> 00:00:33.220\nwork with, but it's kind of a cool one,\nand it's called Cisco StackWise.\n\n10\n00:00:33.220 --> 00:00:36.370\nNow, I know, actually Ronnie,\nyou remember we\n\n11\n00:00:36.370 --> 00:00:40.660\nworked together years ago in a building\nwhere we had a bunch of Cisco switches and\n\n12\n00:00:40.660 --> 00:00:43.615\nwe used a technology\ncalled Cisco GigaStack.\n\n13\n00:00:43.615 --> 00:00:45.175\n>> Right.\n>> Do you remember the GigaStack cables?\n\n14\n00:00:45.175 --> 00:00:46.335\n>> I do remember them.\n\n15\n00:00:46.335 --> 00:00:48.130\n>> They had a bit of a nickname.\n\n16\n00:00:48.130 --> 00:00:50.735\n>> [LAUGH]\n>> They were called GigaStack,\n\n17\n00:00:50.735 --> 00:00:52.355\na lot of people called them GigaCrap.\n\n18\n00:00:52.355 --> 00:00:52.950\n>> Right.\n\n19\n00:00:52.950 --> 00:00:55.200\n>> [LAUGH] The problem was\nthey weren't terribly great.\n\n20\n00:00:55.200 --> 00:00:58.700\nWhat they allowed you to do was\nto take more than one switch and\n\n21\n00:00:58.700 --> 00:01:01.960\nto run this special cable\nin-between each switch\n\n22\n00:01:01.960 --> 00:01:04.780\nto create kind of a strong\nbackbone in-between them.\n\n23\n00:01:04.780 --> 00:01:08.530\nAnd it was a way to get high port\ndensities in a Cisco environment.\n\n24\n00:01:08.530 --> 00:01:10.300\nWell, the technology wasn't very good and\n\n25\n00:01:10.300 --> 00:01:13.810\nthere is a better technology\nin Cisco Stackwise.\n\n26\n00:01:13.810 --> 00:01:16.280\nNow, before we dive into\nthat let's talk about kinda\n\n27\n00:01:16.280 --> 00:01:18.245\nthe problem that we're\ntrying to solve here.\n\n28\n00:01:18.245 --> 00:01:23.000\nRonnie, if I need to get a 24-port switch,\ndoes Cisco have one for me?\n\n29\n00:01:23.000 --> 00:01:26.410\n>> Cisco absolutely has a 24-port\nswitch for you somewhere, and\n\n30\n00:01:26.410 --> 00:01:29.700\nthey'll probably more than likely want\nto sell you multiple of them, yeah.\n\n31\n00:01:29.700 --> 00:01:31.860\n>> Yeah, and if I need 48 ports?\n\n32\n00:01:31.860 --> 00:01:34.880\n>> They'd love it, they'd love for\nyou to actually buy a 48 port one, too.\n\n33\n00:01:34.880 --> 00:01:37.113\n>> What if I need 72 ports?\n\n34\n00:01:37.113 --> 00:01:37.941\n>> 72 ports?\n\n35\n00:01:37.941 --> 00:01:39.044\nYes.\n>> [LAUGH]\n\n36\n00:01:39.044 --> 00:01:41.450\n>> No, no, there's not, there may be,\n\n37\n00:01:41.450 --> 00:01:42.005\nyeah.\n\n38\n00:01:42.005 --> 00:01:43.615\n[LAUGH]\n>> It starts to get a little iffy, right?\n\n39\n00:01:43.615 --> 00:01:46.430\n>> [LAUGH]\n>> So what happens is there's something\n\n40\n00:01:46.430 --> 00:01:48.295\nmagical that happens at 48 ports.\n\n41\n00:01:48.295 --> 00:01:49.540\n>> [LAUGH]\n>> If you need up to 48 ports,\n\n42\n00:01:49.540 --> 00:01:51.160\nyou can buy one Cisco switch.\n\n43\n00:01:51.160 --> 00:01:53.060\nYou get it, You got 48 ports,\nyou're in business.\n\n44\n00:01:53.060 --> 00:01:55.125\nIf you need a little bit more, right?\n\n45\n00:01:55.125 --> 00:01:58.100\nIf you needs 72 ports, if you need 100,\n200, 300 ports, right?\n\n46\n00:01:58.100 --> 00:02:02.535\nWell, then you need to move\nfrom what are called fixed\n\n47\n00:02:02.535 --> 00:02:07.540\nconfiguration switches to modular\nswitches, right, chassis-based switches.\n\n48\n00:02:07.540 --> 00:02:10.160\nAnd, for Cisco,\nthose are usually the 4500s and the 6500s.\n\n49\n00:02:10.160 --> 00:02:14.670\nThere's a few other specialized switches\nthey have, but for the CCNP routing and\n\n50\n00:02:14.670 --> 00:02:17.990\nswitching, the 4500s and the 6500s,\nthose are the ones to remember.\n\n51\n00:02:17.990 --> 00:02:20.670\nAnd if you go to Cisco's website and\nlook for them, what you're buying is,\n\n52\n00:02:20.670 --> 00:02:24.610\neffectively, a big box,\na big, fat, empty box.\n\n53\n00:02:24.610 --> 00:02:27.905\nAnd then it has no ports,\nno ports that are useful at all.\n\n54\n00:02:27.905 --> 00:02:31.835\nAnd you buy cards, modules,\nthat you slide into the switch so\n\n55\n00:02:31.835 --> 00:02:33.605\nyou get exactly what you want.\n\n56\n00:02:33.605 --> 00:02:38.675\nIf you need 72 ports, you buy\nenough blades to give you 72 ports.\n\n57\n00:02:38.675 --> 00:02:39.945\nOr if you need 224 ports,\n\n58\n00:02:39.945 --> 00:02:43.195\nor however many, you buy the right\namount of blades for that.\n\n59\n00:02:43.195 --> 00:02:48.030\nAnd the cool part about it is,\nyou can have a 192-port switch, and\n\n60\n00:02:48.030 --> 00:02:50.960\nit's just one switch,\none thing that you go and configure.\n\n61\n00:02:50.960 --> 00:02:52.130\nAnd it's got all these ports,\n\n62\n00:02:52.130 --> 00:02:56.320\nsuper high port density,\nwhich is great at the access layer.\n\n63\n00:02:57.330 --> 00:03:00.470\nExcept, if your remember Cisco's model,\nright, they want your network to have\n\n64\n00:03:00.470 --> 00:03:03.440\nthree layers, an access layer,\na distribution layer and a core layer.\n\n65\n00:03:03.440 --> 00:03:04.470\nAnd at the core,\n\n66\n00:03:04.470 --> 00:03:07.650\nyou're just trying to move data as\nfast as possible and that's it.\n\n67\n00:03:07.650 --> 00:03:10.370\nAt the distribution layer,\nyou're doing a lot of logic.\n\n68\n00:03:10.370 --> 00:03:11.900\nYou're layer three switching, routing,\n\n69\n00:03:11.900 --> 00:03:14.130\nthings like that's all\nhappening at distribution.\n\n70\n00:03:14.130 --> 00:03:19.480\nAnd at access layer, that's where you're\ndoing things like port security and\n\n71\n00:03:19.480 --> 00:03:23.150\nprotection from exploit, and\nthen just providing high port density.\n\n72\n00:03:23.150 --> 00:03:27.270\nWell, the problem with 4500s and\n6500s is they're great switches, but\n\n73\n00:03:27.270 --> 00:03:29.685\nthey're pretty expensive, right?\n\n74\n00:03:29.685 --> 00:03:32.735\nSpeced out with gigabit networks,\nthey can cost tens of thousands,\n\n75\n00:03:32.735 --> 00:03:36.101\neven hundreds of thousands, of dollars\nin some scenarios to get them speced\n\n76\n00:03:36.101 --> 00:03:38.854\nout exactly the way that you want,\nand that's a log of money.\n\n77\n00:03:38.854 --> 00:03:42.530\nSo for a lot of people out there,\nthey don't go that route.\n\n78\n00:03:42.530 --> 00:03:46.475\nThey just buy 3560s or 2960s, and\nthey start stacking those switches.\n\n79\n00:03:46.475 --> 00:03:49.624\nBut the problem is, if you go out and\nbuy a 2960 or a 3560,\n\n80\n00:03:49.624 --> 00:03:52.170\nthe maximum ports you're\ngonna get is 48 ports.\n\n81\n00:03:52.170 --> 00:03:56.800\nAnd if you need more than 48 ports,\nnow you've got two switches, and\n\n82\n00:03:56.800 --> 00:03:57.850\nwhat are you gonna do?\n\n83\n00:03:57.850 --> 00:04:01.795\nWell, we saw in earlier episodes that we\ncould run a trunk cable in-between them,\n\n84\n00:04:01.795 --> 00:04:04.460\na trunk VLANs across a single link.\n\n85\n00:04:04.460 --> 00:04:06.900\nBut your single link is gonna be,\nwhat, a gigabit?\n\n86\n00:04:06.900 --> 00:04:11.560\nMaybe a ten gig connection if you buy\nthe ten gig uplink module for it.\n\n87\n00:04:11.560 --> 00:04:14.870\nBut you could also do things\nlike EtherChannel, and\n\n88\n00:04:14.870 --> 00:04:16.650\nstart bonding interfaces together.\n\n89\n00:04:16.650 --> 00:04:20.824\nSo maybe I have 8 gigabyte interfaces I\nbond together to get 8 gigs of bandwidth\n\n90\n00:04:20.824 --> 00:04:22.960\non that link in-between two switches.\n\n91\n00:04:22.960 --> 00:04:24.170\nThat's great.\n\n92\n00:04:24.170 --> 00:04:26.190\nBut what if I've got five switches.\n\n93\n00:04:26.190 --> 00:04:28.659\nI'm gonna end up losing a lot\nof ports to EtherChannel, right?\n\n94\n00:04:28.659 --> 00:04:30.250\n>> [LAUGH]\n>> And You've seen this, Ronnie.\n\n95\n00:04:30.250 --> 00:04:31.770\n>> Yeah, no doubt.\nOnce you actually start doing\n\n96\n00:04:31.770 --> 00:04:34.400\nthe EtherChannel, if you start bonding\nthem together, if you can bond up to\n\n97\n00:04:34.400 --> 00:04:38.380\neight, you're actually taking\neight ports away from each switch.\n\n98\n00:04:38.380 --> 00:04:42.172\nSo even on a 48-port switch,\nall of a sudden it becomes, well, what,\n\n99\n00:04:42.172 --> 00:04:43.347\n40 ports at the max.\n\n100\n00:04:43.347 --> 00:04:44.040\n>> Yeah.\n>> And\n\n101\n00:04:44.040 --> 00:04:46.100\nthen if you're actually doing trunking for\nsomething else,\n\n102\n00:04:46.100 --> 00:04:49.440\nand you have some other issues, then you\njust kind of realize, you start losing it.\n\n103\n00:04:49.440 --> 00:04:52.740\nAnd that's why something like what we're\ntalking about in terms of StackWise\n\n104\n00:04:52.740 --> 00:04:55.000\nis really a neat technology for us.\n\n105\n00:04:55.000 --> 00:04:56.372\n>> All right, so\nlet's talk about StackWise.\n\n106\n00:04:56.372 --> 00:05:01.200\nWhat StackWise does is it lets you\ntake a Cisco switch or some routers.\n\n107\n00:05:01.200 --> 00:05:06.330\nIt's really supported on the 3750s, so\nif you have 3750, 3750E, 3750G, or 3750X.\n\n108\n00:05:06.330 --> 00:05:11.645\nBoy, that is harder to\nsay than it should be.\n\n109\n00:05:11.645 --> 00:05:13.630\n>> [LAUGH]\n>> Any of those four models,\n\n110\n00:05:13.630 --> 00:05:18.680\nthose switches have special StackWise\nconnectors on the back of them, right?\n\n111\n00:05:18.680 --> 00:05:20.170\nAnd there's some routers.\n\n112\n00:05:20.170 --> 00:05:22.410\nIf you have a Cisco 2900 and\n\n113\n00:05:22.410 --> 00:05:26.460\n3900 series routers, they have switch\nmodules that you can pop into them, right.\n\n114\n00:05:26.460 --> 00:05:27.930\nThey're called, what are they called?\n\n115\n00:05:27.930 --> 00:05:29.460\nEthernet switch modules?\n\n116\n00:05:29.460 --> 00:05:31.262\nThey got an actual name for it.\n\n117\n00:05:31.262 --> 00:05:32.210\nOh, EtherSwitch.\n>> EtherSwitch.\n\n118\n00:05:32.210 --> 00:05:33.485\n>> That's it, EtherSwitch module.\n\n119\n00:05:33.485 --> 00:05:37.340\nSo, the EtherSwitch modules, they also\nhave gigastacks, I mean, gigastacks,\n\n120\n00:05:37.340 --> 00:05:38.068\nthinking of the old stuff.\n\n121\n00:05:38.068 --> 00:05:40.328\n>> [LAUGH]\n>> The StackWise connector on them.\n\n122\n00:05:40.328 --> 00:05:43.220\nAnd the StackWise connector, if you look\nat it, it looks like an old school SCSI\n\n123\n00:05:43.220 --> 00:05:48.380\nconnector, and it allows you to put\na special cable on the back of the device.\n\n124\n00:05:48.380 --> 00:05:53.510\nAnd that cable can then connect over to\nthe other device to create a bonded back\n\n125\n00:05:53.510 --> 00:05:54.640\nplane, all right?\n\n126\n00:05:54.640 --> 00:05:56.410\nNow, if you've never seen this,\nlet me show you.\n\n127\n00:05:56.410 --> 00:05:59.270\nI've got some kind of Visio\nstencils here that Cisco provides.\n\n128\n00:05:59.270 --> 00:06:01.580\nAnd here I've got a stack of 3750s, right?\n\n129\n00:06:02.820 --> 00:06:04.280\nThese are 48 port 3750s.\n\n130\n00:06:04.280 --> 00:06:08.440\nThese are actually 3750Xs dash 48Ts.\n\n131\n00:06:08.440 --> 00:06:10.810\nI've got a 10 gig module in this one.\n\n132\n00:06:10.810 --> 00:06:13.390\nI've got a 4-port 1 gig\nmodule in this one, right, so\n\n133\n00:06:13.390 --> 00:06:15.060\nkind of different configurations.\n\n134\n00:06:15.060 --> 00:06:18.500\nI've got a 24-port model down\nhere as opposed to a 48.\n\n135\n00:06:18.500 --> 00:06:19.680\nThey don't have to match.\n\n136\n00:06:19.680 --> 00:06:23.250\nYou can mix and match the different\nmodels based on what you have.\n\n137\n00:06:23.250 --> 00:06:24.950\nNow, this is the front side of the switch.\n\n138\n00:06:24.950 --> 00:06:29.002\nAnd what I normally expect to see on the\nfront side are ports, right, as many ports\n\n139\n00:06:29.002 --> 00:06:33.950\nas I bought, in my case 48 ports or the\nuplink modules, right, so I've got those.\n\n140\n00:06:33.950 --> 00:06:37.981\nBut if we take a look at the backside\nof those switches, the 24-port,\n\n141\n00:06:37.981 --> 00:06:41.930\nthe 48- port, all those guys,\nthey all look the same, right?\n\n142\n00:06:41.930 --> 00:06:44.860\nYou may or may not have\nthe redundant power supply, right?\n\n143\n00:06:44.860 --> 00:06:47.060\nYou might just have one\npower supply on yours.\n\n144\n00:06:47.060 --> 00:06:51.110\nBut on the back of each, there\nare these little connectors over here.\n\n145\n00:06:51.110 --> 00:06:53.585\nAnd let me kind of zoom\nin on that a little,\n\n146\n00:06:53.585 --> 00:06:55.670\nit'll probably get\na little pixelated on me.\n\n147\n00:06:55.670 --> 00:06:59.190\nBut, actually, I've reached my max zoom.\n\n148\n00:06:59.190 --> 00:07:02.298\nThis is where we need the CSI guys,\nenhance.\n\n149\n00:07:02.298 --> 00:07:02.810\n>> Yeah.\n\n150\n00:07:02.810 --> 00:07:03.930\n>> But what you'll see are,\n\n151\n00:07:03.930 --> 00:07:07.850\nbasically, what look kind of\nlike two SCSI connectors, right?\n\n152\n00:07:07.850 --> 00:07:10.320\nThe original GigaStack ones actually\ndid use SCSI connectors, but\n\n153\n00:07:10.320 --> 00:07:13.530\nthe new ones it's a little bit different,\nit's Cisco's own proprietary thing.\n\n154\n00:07:13.530 --> 00:07:15.910\nBut you'll see two connectors, always two.\n\n155\n00:07:15.910 --> 00:07:18.380\nYou'll never see just one, all right?\n\n156\n00:07:18.380 --> 00:07:21.840\nAnd that's because GigaStack is\nsupposed to work by forming a ring,\n\n157\n00:07:21.840 --> 00:07:24.090\nkind of like a Tolkien ring in a way.\n\n158\n00:07:24.090 --> 00:07:26.680\nYou're gonna form a ring\nbetween these switches.\n\n159\n00:07:26.680 --> 00:07:30.710\nSo if I just had two switches, take\nthese first two switches, for example,\n\n160\n00:07:30.710 --> 00:07:33.100\nI could run a GigaStack cable [LAUGH]\n>> [LAUGH]\n\n161\n00:07:33.100 --> 00:07:35.090\n>> A Cisco StackWise cable.\n\n162\n00:07:35.090 --> 00:07:36.710\nSee, I mention the old stuff-\n>> Cascading cables, that's right.\n\n163\n00:07:36.710 --> 00:07:39.763\n>> There's so much anger in the back\nof my mind associated with that.\n\n164\n00:07:39.763 --> 00:07:41.180\n>> [LAUGH]\n>> It kind of stays in there.\n\n165\n00:07:41.180 --> 00:07:43.920\nI'm glad you mentioned cascade, Ronnie,\ncuz you'll hear people call them cascade\n\n166\n00:07:43.920 --> 00:07:46.670\ncables, also, it's another name for\nthe same thing.\n\n167\n00:07:46.670 --> 00:07:50.708\nCisco's branded name is StackWise,\nso remember that.\n\n168\n00:07:50.708 --> 00:07:51.604\nBut, basically,\n\n169\n00:07:51.604 --> 00:07:54.908\nyou run a connector from the port on\none switch to the port on the other.\n\n170\n00:07:54.908 --> 00:07:56.160\nAnd if you only got two switches,\n\n171\n00:07:56.160 --> 00:07:58.727\nyou'll run another cable from\nthe other port back to the first one.\n\n172\n00:07:58.727 --> 00:08:02.000\nAnd so you'll create a ring\nbetween the two switches.\n\n173\n00:08:02.000 --> 00:08:07.340\nAnd what you're connecting is not one\nEthernet port to another Ethernet port.\n\n174\n00:08:07.340 --> 00:08:10.630\nWhat you're connecting is\nthe back plane of one switch\n\n175\n00:08:10.630 --> 00:08:12.460\nto the back plane of another.\n\n176\n00:08:12.460 --> 00:08:14.670\nAnd this runs on the newer 3750's.\n\n177\n00:08:14.670 --> 00:08:16.720\nIt runs at 32 gigabits.\n\n178\n00:08:16.720 --> 00:08:18.830\nOkay.\n32 gigabit.\n\n179\n00:08:18.830 --> 00:08:22.670\nIf you've got a 48 port\nswitch with 48 gigabit ports,\n\n180\n00:08:22.670 --> 00:08:24.890\nyour maximum throughput\ngonna be 48 gigabits right?\n\n181\n00:08:24.890 --> 00:08:26.759\nAnd in reality it's not\neven gonna be that, but\n\n182\n00:08:26.759 --> 00:08:28.720\npotentially you could hit that 48 gigs.\n\n183\n00:08:28.720 --> 00:08:31.230\nThis is a 32 gig link\nbetween these switches.\n\n184\n00:08:31.230 --> 00:08:32.210\nThat's a ton of bandwidth.\n\n185\n00:08:32.210 --> 00:08:36.040\nMore than enough for uplinking in\nan access switch type of area.\n\n186\n00:08:36.040 --> 00:08:38.590\nMaybe not enough for\nyou and your core, right.\n\n187\n00:08:38.590 --> 00:08:41.040\nBut at your core, that's where\nyou'd have your 4500, your 6500,\n\n188\n00:08:41.040 --> 00:08:42.940\nyour higher end switches.\n\n189\n00:08:42.940 --> 00:08:45.810\nBut your access layer,\nthis is more than enough.\n\n190\n00:08:45.810 --> 00:08:50.260\nAnd you can build that connection and\nyou can scale it out to multiple switches.\n\n191\n00:08:50.260 --> 00:08:52.760\nSo you can have six switches or\nhowever many you need.\n\n192\n00:08:52.760 --> 00:08:55.960\nThere is actually an upper limit,\nwhich I believe is 15.\n\n193\n00:08:55.960 --> 00:09:00.330\nSo you can add each of these switches in,\nand build one big stack.\n\n194\n00:09:00.330 --> 00:09:03.840\nAnd there's two great advantages, I guess\nthere three great advantages, right?\n\n195\n00:09:03.840 --> 00:09:06.920\nOne great advantage is,\nwe're not having to buy a 6500, so\n\n196\n00:09:06.920 --> 00:09:09.600\nit's far less expensive to go this route.\n\n197\n00:09:09.600 --> 00:09:12.589\nThe second advantage is,\nwhen you connect these switches,\n\n198\n00:09:13.910 --> 00:09:19.140\nit elects a master switch, and the master\nswitch is in control of the whole thing.\n\n199\n00:09:19.140 --> 00:09:23.160\nAll the other switches\njust become members, and\n\n200\n00:09:23.160 --> 00:09:27.010\nas a member,\nall they do is provide port density.\n\n201\n00:09:27.010 --> 00:09:29.850\nSo when I bond these\ntwo switches together,\n\n202\n00:09:29.850 --> 00:09:34.500\ninstead of having one 48 port switch, I\nnow have one 96 port switch and that's it.\n\n203\n00:09:35.960 --> 00:09:36.790\n96 ports available for\n\n204\n00:09:36.790 --> 00:09:40.890\nme, and whoever's the master I\ndo all my configuration there.\n\n205\n00:09:40.890 --> 00:09:46.349\nI plug in my console cable there and\nif it had ports 1/0/1\n\n206\n00:09:46.349 --> 00:09:52.142\nthrough 48 now it also\nhas 2/0/1 through 2/0/48.\n\n207\n00:09:52.142 --> 00:09:53.309\nAll right there in one switch.\n\n208\n00:09:53.309 --> 00:09:53.809\nIt looks like one switch.\n\n209\n00:09:55.390 --> 00:09:58.870\nAnd if that one switch fails,\nthe other one becomes the master.\n\n210\n00:09:58.870 --> 00:10:01.550\nI've now got redundant supervisor modules,\nright?\n\n211\n00:10:01.550 --> 00:10:03.520\nIn a 6500 you buy supervisor modules.\n\n212\n00:10:03.520 --> 00:10:06.720\nThat's where the logic of the switch is,\nand if you want redundancy,\n\n213\n00:10:06.720 --> 00:10:08.080\nyou have to buy two of those modules.\n\n214\n00:10:08.080 --> 00:10:10.990\nWell, here,\nif I have six switches in this stack,\n\n215\n00:10:10.990 --> 00:10:13.600\nit's like having six\nredundant supervisor modules.\n\n216\n00:10:13.600 --> 00:10:17.210\nAny one could kick in and\ntake over the cluster if need be.\n\n217\n00:10:17.210 --> 00:10:18.630\nAnd now I'm up and running.\n\n218\n00:10:18.630 --> 00:10:20.590\nI get full switch redundancy.\n\n219\n00:10:20.590 --> 00:10:23.870\nI get great bandwidth in\nbetween the different systems,\n\n220\n00:10:23.870 --> 00:10:27.150\nand I'm doing it with mid-grade hardware.\n\n221\n00:10:27.150 --> 00:10:30.480\nThe 3750s are mid-tier switches and\nso I'm not breaking the bank.\n\n222\n00:10:30.480 --> 00:10:31.020\nRight?\n\n223\n00:10:31.020 --> 00:10:34.060\nThese switches will normally run\nyou Let's say $4,000 a piece.\n\n224\n00:10:34.060 --> 00:10:36.710\nSo a stack like this\nwould be about $24,000.\n\n225\n00:10:36.710 --> 00:10:40.711\nWell, a 6500, they usually start around-\n>> [LAUGH]\n\n226\n00:10:40.711 --> 00:10:41.654\n>> $24,000 and\n\n227\n00:10:41.654 --> 00:10:45.314\nthen you go up from there based on all the\nblades you buy it gets really expensive\n\n228\n00:10:45.314 --> 00:10:46.430\nreally fast.\n\n229\n00:10:46.430 --> 00:10:49.400\nHere, I'm getting the same\nresults With far less.\n\n230\n00:10:49.400 --> 00:10:52.430\nNow, you might be asking yourself,\nwait a minute Don.\n\n231\n00:10:52.430 --> 00:10:55.760\nWhy do we even sell the 6500s\nif I could just do this?\n\n232\n00:10:55.760 --> 00:10:57.770\nWell, the 6500s are modulars,\n\n233\n00:10:57.770 --> 00:10:59.680\nall sorts of different blades\nyou can buy to put in them.\n\n234\n00:10:59.680 --> 00:11:03.050\nLike you can get the IDS or\nIPS blade and stick it in there,\n\n235\n00:11:03.050 --> 00:11:05.650\nstart doing firewalling and\ntraffic inspection.\n\n236\n00:11:05.650 --> 00:11:08.120\nYou can't do that on a 3750.\n\n237\n00:11:08.120 --> 00:11:13.120\nAlso, on that great big 6500, you got\ntwo giant redundant power supplies.\n\n238\n00:11:13.120 --> 00:11:17.050\nHere I've got tons of little\npower supplies to worry about.\n\n239\n00:11:17.050 --> 00:11:21.920\nSo there's certain features that I\nhave in a 6500 that I don't have here.\n\n240\n00:11:21.920 --> 00:11:25.160\nSo there's still definitely a purpose for\nthose higher end switches.\n\n241\n00:11:25.160 --> 00:11:29.160\nBut this one is gonna serve to bridge\nthe gap between the two solutions, and\n\n242\n00:11:29.160 --> 00:11:29.700\ngive me what I need.\n\n243\n00:11:30.850 --> 00:11:32.590\nNow when we run the cabling across it,\n\n244\n00:11:32.590 --> 00:11:35.630\nthe cabling is not necessarily the most\nintuitive thing in the planet.\n\n245\n00:11:35.630 --> 00:11:38.390\nLet me kind of show you how\nthe cabling works on these.\n\n246\n00:11:38.390 --> 00:11:42.230\nAnd basically, we need to form\na ring between our switches.\n\n247\n00:11:42.230 --> 00:11:44.780\nAnd there's a few different\nways that you can hook it up.\n\n248\n00:11:44.780 --> 00:11:48.600\nBut Cisco's official recommendation\nis that you do it like this,\n\n249\n00:11:48.600 --> 00:11:53.510\nwe go between port one on the first\nswitch and port one on the second switch.\n\n250\n00:11:53.510 --> 00:11:56.490\nAnd then for\nevery other switch we go from port two\n\n251\n00:11:56.490 --> 00:11:59.910\ndown to port one on the next switch, and\nthen port two to port one, on the next.\n\n252\n00:11:59.910 --> 00:12:02.780\nPort two and so on,\nall the way down the line, and\n\n253\n00:12:02.780 --> 00:12:06.060\non the very last switch\nwe go from port two\n\n254\n00:12:06.060 --> 00:12:10.440\nall the way back up to port two on\nthe first switch, that forms a loop.\n\n255\n00:12:10.440 --> 00:12:12.000\nNow why do we need a loop?\n\n256\n00:12:12.000 --> 00:12:16.810\nWell, if one of these switches fails,\nI don't know which one it's gonna be.\n\n257\n00:12:16.810 --> 00:12:21.050\nand so I need all the switches to stay\nconnected and a loop will do that for me.\n\n258\n00:12:21.050 --> 00:12:23.270\nIf I didn't have this loop and\n\n259\n00:12:23.270 --> 00:12:26.930\nthe middle switch failed, the top switches\nwouldn't see the bottom switches.\n\n260\n00:12:26.930 --> 00:12:29.130\nSo now they would each elect a master.\n\n261\n00:12:29.130 --> 00:12:29.990\nThey would both come up and\n\n262\n00:12:29.990 --> 00:12:32.680\nbe isolated from the network and\nI'd have problems there.\n\n263\n00:12:32.680 --> 00:12:36.110\nSo by having a ring like\nthis we get that redundancy.\n\n264\n00:12:36.110 --> 00:12:38.000\nThere's a 32 gigabit ring, so\n\n265\n00:12:38.000 --> 00:12:41.750\nwe can be moving quite a bit of data over\nit, in between all these switches, right?\n\n266\n00:12:41.750 --> 00:12:43.000\nThat's what StackWise is all about.\n\n267\n00:12:44.030 --> 00:12:48.220\nNow, if you want to configure StackWise,\nit's actually pretty easy, right?\n\n268\n00:12:48.220 --> 00:12:51.610\nIn fact, it's turned on by default,\nand you may luck out, and\n\n269\n00:12:51.610 --> 00:12:53.110\nhook your cables up and it just works.\n\n270\n00:12:53.110 --> 00:12:56.210\nBut I'll tell you, I've always had some\nlittle issues pop up when I use this,\n\n271\n00:12:56.210 --> 00:13:00.090\nbecause the switch has a prior\nconfiguration, or something doesn't bond\n\n272\n00:13:00.090 --> 00:13:03.510\nright, so There's a few little\nprerequisites we need to worry about.\n\n273\n00:13:03.510 --> 00:13:05.950\nFirst off, the StackWise cable.\n\n274\n00:13:05.950 --> 00:13:08.630\nYou're not gonna buy it at your\nlocal computer electronics store,\n\n275\n00:13:08.630 --> 00:13:11.160\nyou need to order it from Cisco,\nmake sure you get the good ones.\n\n276\n00:13:11.160 --> 00:13:14.690\nThere's people that sell knockoffs online,\ndon't buy them it's not worth it,\n\n277\n00:13:14.690 --> 00:13:16.140\nthis is critical infrastructure.\n\n278\n00:13:16.140 --> 00:13:17.350\nYou want the Cisco cables.\n\n279\n00:13:17.350 --> 00:13:21.280\nThere is actually some logic in those\ncables, and the knockoffs don't have it,\n\n280\n00:13:21.280 --> 00:13:26.440\nand so they can fail to detect loop\nbreakage sometimes and it is problematic.\n\n281\n00:13:26.440 --> 00:13:29.620\nI've used them, they're not good.\n\n282\n00:13:29.620 --> 00:13:34.500\nNow, before we start connecting them,\nwe wanna do a little other prep work.\n\n283\n00:13:34.500 --> 00:13:40.630\nFirst off, ideally, your switches\nshould all be running the same iOS.\n\n284\n00:13:40.630 --> 00:13:43.150\nThey don't have to be, but they should.\n\n285\n00:13:44.610 --> 00:13:50.490\nBasically, when it elects a master, it has\nseveral tie breaker criteria that it uses.\n\n286\n00:13:50.490 --> 00:13:54.370\nWe can assign a priority, we can tell\nit who we want the master to be.\n\n287\n00:13:54.370 --> 00:13:57.490\nBut if we haven't,\nthen they're all set the same.\n\n288\n00:13:57.490 --> 00:13:59.610\nThey have a priority number,\nit's 1 through 15.\n\n289\n00:13:59.610 --> 00:14:03.110\nIf you're set to 15,\nyou will be the master.\n\n290\n00:14:03.110 --> 00:14:05.255\nIf you're set to one,\nyou might be the master.\n\n291\n00:14:05.255 --> 00:14:08.610\n1 is the lowest, 15 is the highest,\nthe switch is default to 1.\n\n292\n00:14:08.610 --> 00:14:11.569\nSo if I take a switch and flag it as\npriority 15, it will be the master.\n\n293\n00:14:12.890 --> 00:14:15.390\nBut after that it starts\ngoing through tie breakers.\n\n294\n00:14:15.390 --> 00:14:19.400\nAnd the next tie breaker is which\niOS feature set you're running.\n\n295\n00:14:19.400 --> 00:14:21.530\nOkay?\nBecause I might be running IP Advanced\n\n296\n00:14:21.530 --> 00:14:26.850\nServices on the first one, and I might\nbe running just IP Base on another one.\n\n297\n00:14:26.850 --> 00:14:29.790\nWell, the IP Advanced Services\none will win because\n\n298\n00:14:29.790 --> 00:14:33.030\nit's gonna have Layer 3 routing, and\nall the other features, and bells and\n\n299\n00:14:33.030 --> 00:14:35.680\nwhistles that we want,\nversus IP Base that might not have that.\n\n300\n00:14:36.700 --> 00:14:39.560\nSo that will influence\nwho becomes the master.\n\n301\n00:14:39.560 --> 00:14:43.560\nNow as far as version, well wait,\nlet's go back to that.\n\n302\n00:14:43.560 --> 00:14:44.910\nLet's say I have two switches.\n\n303\n00:14:44.910 --> 00:14:49.740\nOne is IP advanced, one's IP base,\nand the IP advanced one fails.\n\n304\n00:14:49.740 --> 00:14:51.900\nWell now the base one is going to\nkick in and take over as master, but\n\n305\n00:14:51.900 --> 00:14:52.930\nit's not running the advanced.\n\n306\n00:14:52.930 --> 00:14:53.896\nAnd so what's going to happen?\n\n307\n00:14:53.896 --> 00:14:55.680\nYou're gonna drop back to base, and\n\n308\n00:14:55.680 --> 00:14:58.585\nany advanced features you're using\nare gonna break, and it's not gonna work.\n\n309\n00:14:58.585 --> 00:15:00.690\nSo that's why I say they\nall should be the same.\n\n310\n00:15:00.690 --> 00:15:03.160\nThey don't have to be, but\nyou'd be crazy not to do it that way.\n\n311\n00:15:03.160 --> 00:15:06.040\nYou need them all to be\nrunning that same iOS, so\n\n312\n00:15:06.040 --> 00:15:08.530\nthat when you have\na fail-over it will work out.\n\n313\n00:15:08.530 --> 00:15:12.010\nNow version numbers can be different,\nbecause what's gonna happen is whoever's\n\n314\n00:15:12.010 --> 00:15:15.110\nthe master, they're running\nan iOS of a certain version.\n\n315\n00:15:15.110 --> 00:15:17.840\nAs the other switches come up if\nthey're running an older version,\n\n316\n00:15:17.840 --> 00:15:19.290\nit'll actually update them.\n\n317\n00:15:19.290 --> 00:15:21.010\nIt'll just push it right over to them so\n\n318\n00:15:21.010 --> 00:15:24.070\nthat they have a synchronized\niOS version across them.\n\n319\n00:15:24.070 --> 00:15:26.570\nPersonally, I like to get\nthem at the same iOS version\n\n320\n00:15:26.570 --> 00:15:30.370\nprior to adding them to the stack, but\nin the future when you do upgrades, you do\n\n321\n00:15:30.370 --> 00:15:34.190\nthe upgrade on the master, and it'll\nupgrade all of the other switches for you.\n\n322\n00:15:34.190 --> 00:15:36.180\nIt kind of knocks it all out,\nwhich is really nice.\n\n323\n00:15:36.180 --> 00:15:38.410\nYou're managing this as a single switch.\n\n324\n00:15:38.410 --> 00:15:41.390\nOnce they're clustered together you\nnever treat them independently,\n\n325\n00:15:41.390 --> 00:15:42.820\nunless there's a failure.\n\n326\n00:15:42.820 --> 00:15:45.580\n>> Now Don, I believe that also we have\none other feature that we have to worry\n\n327\n00:15:45.580 --> 00:15:48.520\nabout as a prerequisite\nwhich is the SDM template.\n\n328\n00:15:48.520 --> 00:15:49.350\n>> Oh, yeah.\n>> [LAUGH]\n\n329\n00:15:49.350 --> 00:15:50.856\n>> That is an easy one to forget\n\n330\n00:15:50.856 --> 00:15:51.776\nabout, right?\n\n331\n00:15:51.776 --> 00:15:55.369\nThink way back, I think it was episode\none or two of this series where we talked\n\n332\n00:15:55.369 --> 00:15:59.034\nabout the SDM template, and that's how\nmemory is allocated on the switches.\n\n333\n00:15:59.034 --> 00:16:01.816\nWell, when you cluster\nthem together like this,\n\n334\n00:16:01.816 --> 00:16:04.490\nit can't adjust the SDM template for you.\n\n335\n00:16:04.490 --> 00:16:07.000\nSo before you fire this up, you need to\nmake sure they're all set the same way.\n\n336\n00:16:07.000 --> 00:16:11.440\nAnd if you don't remember the SDM,\nthat was the database manager for\n\n337\n00:16:11.440 --> 00:16:15.081\nhow we were controlling memory\nallocation on the switch, right?\n\n338\n00:16:15.081 --> 00:16:19.315\nInside of its TCAM, that table where\nit stores everything in memory\n\n339\n00:16:19.315 --> 00:16:23.675\nas far as VLANs, as far as,\nwell, like here,\n\n340\n00:16:23.675 --> 00:16:28.205\nhow we're portioning it up for ACLs,\nroutes and MAC address table and\n\n341\n00:16:28.205 --> 00:16:30.710\nall those, they all have to have\na bit of memory available to them.\n\n342\n00:16:30.710 --> 00:16:34.501\nAnd so, if they're set differently on\ndifferent switches, that causes a problem.\n\n343\n00:16:34.501 --> 00:16:35.387\nAnd it breaks it, and\n\n344\n00:16:35.387 --> 00:16:38.658\nthat switch with a different SDM template\nwon't be allowed to join the stack.\n\n345\n00:16:38.658 --> 00:16:42.839\nSo it will be plugged in, but it won't be\ncommunicating in the stack wise cluster,\n\n346\n00:16:42.839 --> 00:16:43.770\nall right?\n\n347\n00:16:43.770 --> 00:16:45.645\nSo, we need to make sure that\nwe've set that SDM template.\n\n348\n00:16:45.645 --> 00:16:48.303\nNow if you haven't messed with it,\nthen they're all probably set the same.\n\n349\n00:16:48.303 --> 00:16:50.572\nBut there's some Cisco switches\nthat are different, right?\n\n350\n00:16:50.572 --> 00:16:53.170\nThere's the 3750 12.\n\n351\n00:16:53.170 --> 00:16:57.410\nThere's a model that just has fiber\nports on it and that's it, and\n\n352\n00:16:57.410 --> 00:17:00.605\nthat guy has some different SDM templates\non it than some of the other ones.\n\n353\n00:17:00.605 --> 00:17:02.460\nCuz you only got 12 ports to manage,\nright?\n\n354\n00:17:02.460 --> 00:17:04.172\nSo, they do different\nmemory allocations there.\n\n355\n00:17:04.172 --> 00:17:06.854\nSo you just need to make sure\nthey're all set the same, all right.\n\n356\n00:17:06.854 --> 00:17:10.820\nAnd then once they're the same,\nwe're pretty good to go.\n\n357\n00:17:10.820 --> 00:17:15.760\nNow personally, what I like to do is\nI like to set up one switch first.\n\n358\n00:17:15.760 --> 00:17:18.210\nSet up one switch,\nget things set the way that I want it.\n\n359\n00:17:18.210 --> 00:17:22.290\nMake it the master, and then we can\nstart adding in our other switches,\n\n360\n00:17:22.290 --> 00:17:24.010\nand I like to add them one at a time.\n\n361\n00:17:25.470 --> 00:17:28.910\nTechnically, [LAUGH] you could\njust hook up all your cables and\n\n362\n00:17:28.910 --> 00:17:32.310\nturn it on and let it go, and\nit will form a StackWise cluster.\n\n363\n00:17:32.310 --> 00:17:33.210\nIt'll do it, right.\n\n364\n00:17:33.210 --> 00:17:36.610\nWell, assuming the SDM templates\nare the same and all that.\n\n365\n00:17:36.610 --> 00:17:37.790\nBut it'll bring it up.\n\n366\n00:17:37.790 --> 00:17:39.480\nSomebody will become the master.\n\n367\n00:17:39.480 --> 00:17:40.810\nI don't know which one.\n\n368\n00:17:40.810 --> 00:17:43.920\nAnd then, the other guys will join up and\noff you go.\n\n369\n00:17:43.920 --> 00:17:44.880\nYou're in business.\n\n370\n00:17:44.880 --> 00:17:45.560\nRight?\n\n371\n00:17:45.560 --> 00:17:48.870\nAnd if you're looking at the physical\nswitch, if you're looking at the front,\n\n372\n00:17:48.870 --> 00:17:52.050\nwhoever the master is, they'll have\na green light on the front, and\n\n373\n00:17:52.050 --> 00:17:53.190\neverybody else will have an amber light.\n\n374\n00:17:53.190 --> 00:17:55.330\nAnd the amber light lets you\nknow that they're standby.\n\n375\n00:17:55.330 --> 00:17:59.190\nCuz the logic on that switch\nhas been turned off, but\n\n376\n00:17:59.190 --> 00:18:01.010\nthe ports are still active and\nit's still running.\n\n377\n00:18:01.010 --> 00:18:02.742\nThe master is kinda controlling that.\n\n378\n00:18:02.742 --> 00:18:03.600\n>> All right, so Don,\n\n379\n00:18:03.600 --> 00:18:08.690\nI know that we've talked a lot about\nthe overall way that StackWise works.\n\n380\n00:18:08.690 --> 00:18:11.860\nAnd we know what the configurations are\nand know what what the prerequisites are.\n\n381\n00:18:11.860 --> 00:18:15.620\nBut is there anything that I,\nas a technician, need to get configured on\n\n382\n00:18:15.620 --> 00:18:18.440\nthere to make sure that one\nactually gets chosen as master?\n\n383\n00:18:18.440 --> 00:18:19.880\nAnything else that we need to do?\n\n384\n00:18:19.880 --> 00:18:23.490\n>> Yeah, there's things we can do to\nmake this go a little more smoothly, and\n\n385\n00:18:23.490 --> 00:18:24.370\nthat's what I like to do.\n\n386\n00:18:24.370 --> 00:18:27.540\nI like to go in and define who is\ngoing to be the master, right?\n\n387\n00:18:27.540 --> 00:18:31.630\nSo, when we do that, what we're gonna have\nto do is jump into the switch that we\n\n388\n00:18:31.630 --> 00:18:33.760\nwant to be the master and\nbasically set the priority.\n\n389\n00:18:33.760 --> 00:18:34.970\nThat's the easiest way to do it, right?\n\n390\n00:18:34.970 --> 00:18:37.480\nPriority is the first tie breaker and\n\n391\n00:18:37.480 --> 00:18:39.690\nthe easiest way to influence\nwho the master is, all right.\n\n392\n00:18:39.690 --> 00:18:40.830\nSo let me show you how that's done.\n\n393\n00:18:40.830 --> 00:18:44.307\nI've got a switch pulled up here,\nand this is one of my core switches.\n\n394\n00:18:44.307 --> 00:18:47.699\nAnd if I do a show version, right,\nI can take a look at it and\n\n395\n00:18:47.699 --> 00:18:49.241\nsee what the hardware is.\n\n396\n00:18:49.241 --> 00:18:52.905\nThis one's a 3750, so\nI can see that I am running\n\n397\n00:18:52.905 --> 00:18:57.840\nhardware that supports that StackWise and\nall that good stuff.\n\n398\n00:18:57.840 --> 00:19:00.410\nEvery 3750 has the port\nphysically built into it.\n\n399\n00:19:00.410 --> 00:19:03.035\nIf you've got 3560s,\nit's not something you can add.\n\n400\n00:19:03.035 --> 00:19:06.610\nCisco has to build it in because it\nconnects directly to the backplane.\n\n401\n00:19:06.610 --> 00:19:07.260\nAll right.\n\n402\n00:19:07.260 --> 00:19:09.470\nSo I know that my switch\ndoes support it and\n\n403\n00:19:09.470 --> 00:19:11.770\nthat I could get it set up and configure.\n\n404\n00:19:11.770 --> 00:19:16.580\nNow it's not on by default, so,\nwell it sort of is, it's on,\n\n405\n00:19:16.580 --> 00:19:18.748\nit's just not configured by default.\n\n406\n00:19:18.748 --> 00:19:22.900\nIf you are on the show switch command,\nit's kind of a weird command, right?\n\n407\n00:19:22.900 --> 00:19:25.270\nShow switch, this is a switch,\nwhat are you going to show me?\n\n408\n00:19:25.270 --> 00:19:29.070\nWell, it actually gives you information\nabout the switch stack, right?\n\n409\n00:19:29.070 --> 00:19:32.450\nAnd this is the StackWise\ncluster that I'm talking about.\n\n410\n00:19:32.450 --> 00:19:34.827\nAnd so I can see right now\nthat this is switch number 1.\n\n411\n00:19:34.827 --> 00:19:38.287\nAnd its role is master, and\nthis is the MAC address on my switch.\n\n412\n00:19:38.287 --> 00:19:41.901\nMy priority is 1, right,\nI mentioned 15 would be the master, 1,\n\n413\n00:19:41.901 --> 00:19:43.420\nwe're just a member.\n\n414\n00:19:43.420 --> 00:19:47.460\nMy hardware version is 0, this is the\nfirst version of this particular switch,\n\n415\n00:19:47.460 --> 00:19:49.960\nand my current state is ready to rock.\n\n416\n00:19:49.960 --> 00:19:54.850\nOkay, if I had other switches\nconnected with StackWise cables,\n\n417\n00:19:54.850 --> 00:19:56.540\nI would see them in the list here.\n\n418\n00:19:56.540 --> 00:19:57.100\nOkay?\n\n419\n00:19:57.100 --> 00:19:59.440\nAnd I would see whether they were\nmembers that were joined up.\n\n420\n00:19:59.440 --> 00:20:01.990\nI would see if they were ready or\nif they failed to join,\n\n421\n00:20:01.990 --> 00:20:05.050\nbecause it would actually say SDM\ntemplate incorrect or something.\n\n422\n00:20:05.050 --> 00:20:08.500\nI would see that information,\nand I could spot it, right?\n\n423\n00:20:08.500 --> 00:20:11.700\nNow if I just got five brand new\nswitches and I powered on all five,\n\n424\n00:20:11.700 --> 00:20:14.660\nthey're all gonna think that they're\nswitch number 1, and they're all gonna\n\n425\n00:20:14.660 --> 00:20:17.100\nhave a priority number 1, and they're\nall gonna think they're the master.\n\n426\n00:20:17.100 --> 00:20:20.850\nAnd so when they fire up, they're gonna\nfight, and one person's gonna win.\n\n427\n00:20:20.850 --> 00:20:21.400\nRight?\n\n428\n00:20:21.400 --> 00:20:22.890\nAnd it's gonna run\nthrough the tie breakers.\n\n429\n00:20:22.890 --> 00:20:25.170\nNow let's assume that it's a super tie,\nright?\n\n430\n00:20:25.170 --> 00:20:27.830\nThat everybody's got the same priority,\n\n431\n00:20:27.830 --> 00:20:32.230\neverybody's got the same iOS feature set,\neverybody's kinda configured the same.\n\n432\n00:20:32.230 --> 00:20:35.150\nThat way then it starts\nboiling down to silly things,\n\n433\n00:20:35.150 --> 00:20:37.730\nlike whichever switch came up first.\n\n434\n00:20:37.730 --> 00:20:40.430\nSo whoever came up first,\nthat's the master, right?\n\n435\n00:20:40.430 --> 00:20:45.400\nOr if even that's a tie,\nit finally boils down to MAC address.\n\n436\n00:20:45.400 --> 00:20:48.876\nWhoever's got the lowest MAC address,\nthey become the master and that's it.\n\n437\n00:20:48.876 --> 00:20:50.320\nSo that's kind of the final tie breaker,\nand\n\n438\n00:20:50.320 --> 00:20:53.470\nthat's why my MAC address is listed here.\n\n439\n00:20:53.470 --> 00:20:58.670\nNow, whoever the master is will start\nassigning numbers to the other switches.\n\n440\n00:20:58.670 --> 00:21:01.450\nAnd it's done dynamically, and\nthis has frustrated me in the past.\n\n441\n00:21:01.450 --> 00:21:03.820\nIf you add the switches to\nthe stack one at a time,\n\n442\n00:21:03.820 --> 00:21:06.010\nyou know exactly what\nnumber they're gonna have.\n\n443\n00:21:06.010 --> 00:21:09.180\nBut if I have a switch fail and I take it\nout of the stack and I put a new switch\n\n444\n00:21:09.180 --> 00:21:14.450\nin, I might have had switches 1 through 6,\nthe new switch is gonna be switch 7.\n\n445\n00:21:14.450 --> 00:21:18.090\nWell, I replaced switch 3,\nso I want it to be switch 3.\n\n446\n00:21:18.090 --> 00:21:19.610\nI don't want it to be switch 7.\n\n447\n00:21:19.610 --> 00:21:22.800\nI just want it to be numbered so\nI can remember which switch is which.\n\n448\n00:21:22.800 --> 00:21:24.668\nWell, that's a hard sentence right there,\nbut.\n\n449\n00:21:24.668 --> 00:21:27.170\n>> [LAUGH]\n>> But they give you the MAC address, and\n\n450\n00:21:27.170 --> 00:21:29.860\nso Cisco says, well, you can use the MAC\naddress to know what switch it is.\n\n451\n00:21:29.860 --> 00:21:31.470\nI don't like that,\nI like the numbers to match.\n\n452\n00:21:31.470 --> 00:21:34.830\nSo if you wanna hard set those numbers,\nyou certainly can.\n\n453\n00:21:34.830 --> 00:21:35.330\nAll right.\n\n454\n00:21:35.330 --> 00:21:36.850\nAnd it's not even a difficult thing to do.\n\n455\n00:21:36.850 --> 00:21:40.130\nBasically, we need to jump\ninto our configuration,\n\n456\n00:21:40.130 --> 00:21:42.580\nand if we're on the master already, or\n\n457\n00:21:42.580 --> 00:21:47.000\nif this is gonna be the first switch that\nwe bring up, we just need to say, switch\n\n458\n00:21:47.000 --> 00:21:52.100\nfollowed by our number, and then priority\nand what we want that priority to be.\n\n459\n00:21:52.100 --> 00:21:55.750\nI want this one to be that master, so\nI'm gonna say switch 1, priority 15.\n\n460\n00:21:55.750 --> 00:21:59.290\nOkay, and when I run that,\nit's gonna say, are you sure?\n\n461\n00:21:59.290 --> 00:22:02.490\nBecause if we're not the master now,\nwe will be here in a second.\n\n462\n00:22:02.490 --> 00:22:04.280\nRight, I'm sure, I'll go ahead and do it.\n\n463\n00:22:04.280 --> 00:22:07.760\nAll right, and so it's now set it,\nmy priority is now 15.\n\n464\n00:22:07.760 --> 00:22:11.751\nAnd if I do show switch again,\nall right, I was already the master so\n\n465\n00:22:11.751 --> 00:22:15.197\nthat's not exciting, but\nI've got my priority of 15.\n\n466\n00:22:15.197 --> 00:22:19.690\nAll right, now, what if this switch\nhad been in another stack before?\n\n467\n00:22:19.690 --> 00:22:23.400\nI always test switches before I move them\ninto production, and so it's pretty often\n\n468\n00:22:23.400 --> 00:22:28.370\nthat I've already had the switch\nin some other StackWise cluster.\n\n469\n00:22:28.370 --> 00:22:29.940\nSo I might have a wrong number.\n\n470\n00:22:29.940 --> 00:22:31.190\nSo you can renumber it.\n\n471\n00:22:31.190 --> 00:22:34.480\nYou can come in, and\nyou can actually just say switch and\n\n472\n00:22:34.480 --> 00:22:35.910\nwhatever the current number is, right.\n\n473\n00:22:35.910 --> 00:22:38.120\nSo maybe it's switch number 6.\n\n474\n00:22:38.120 --> 00:22:41.940\nSo I can say, switch 6 renumber.\n\n475\n00:22:41.940 --> 00:22:43.940\nAnd then what number I want it to have.\n\n476\n00:22:43.940 --> 00:22:44.570\nOkay?\n\n477\n00:22:44.570 --> 00:22:47.642\nAnd notice I've got a maximum of 9,\nso on this cluster,\n\n478\n00:22:47.642 --> 00:22:50.330\nI can only have 9 switches in my cluster,\nright?\n\n479\n00:22:50.330 --> 00:22:52.800\nThat's how you tell how\nmany switches you can have.\n\n480\n00:22:52.800 --> 00:22:56.250\nI said 15 earlier because of the priority,\nand I've seen somewhere you can go to 15.\n\n481\n00:22:56.250 --> 00:22:57.550\nIn this one, it's just 9.\n\n482\n00:22:57.550 --> 00:22:58.470\nAll right.\n\n483\n00:22:58.470 --> 00:23:01.350\nSo I might want this one to be number 9,\nor I might want it to be number 2, or\n\n484\n00:23:01.350 --> 00:23:02.710\neven number 1, right?\n\n485\n00:23:02.710 --> 00:23:05.350\nAnd I can tell it to renumber that,\nand it'll change it.\n\n486\n00:23:05.350 --> 00:23:08.340\nThis command will be issued on\nthe master because it's the master\n\n487\n00:23:08.340 --> 00:23:09.920\nrenumbering the number.\n\n488\n00:23:09.920 --> 00:23:13.720\nIf I am the master,\nthen I just issue it right here on myself.\n\n489\n00:23:13.720 --> 00:23:16.620\nAnd I can say renumber it to 1,\nand that'll change his number.\n\n490\n00:23:16.620 --> 00:23:17.530\nAll right?\nSo you can always change\n\n491\n00:23:17.530 --> 00:23:18.200\nthat after the fact.\n\n492\n00:23:19.420 --> 00:23:21.130\nAll right now, at this point,\nmy priority is 15,\n\n493\n00:23:21.130 --> 00:23:25.190\nI was ordered the master, technically,\nI'm already in a StackWise cluster.\n\n494\n00:23:25.190 --> 00:23:26.710\nAnd I'm up and I'm running.\n\n495\n00:23:26.710 --> 00:23:30.460\nAnd if I plug another switch in and\nconnect its StackWise cable,\n\n496\n00:23:30.460 --> 00:23:33.680\nit's gonna join me and list it as\na better priority, which it can't.\n\n497\n00:23:33.680 --> 00:23:35.310\nBut if it ties me,\n\n498\n00:23:35.310 --> 00:23:38.600\nthen it's gonna boil down to things\nlike the MAC address, right?\n\n499\n00:23:38.600 --> 00:23:40.290\nSo is my MAC address lower than theirs?\n\n500\n00:23:40.290 --> 00:23:42.090\nOr is my uptime greater than theirs?\n\n501\n00:23:42.090 --> 00:23:45.320\nAnd figure out who is going\nto be the master, right.\n\n502\n00:23:45.320 --> 00:23:47.513\nBut if their priorities\nare the default priority 1,\n\n503\n00:23:47.513 --> 00:23:49.570\nthey're gonna leave me as the master.\n\n504\n00:23:49.570 --> 00:23:51.881\nAnd I can now start to\nassign them information.\n\n505\n00:23:51.881 --> 00:23:55.426\nAnd so when I'm ready to start adding\nother switches, what I need to do\n\n506\n00:23:55.426 --> 00:23:59.170\nis take the other switch, set its SDM\ntemplate to whatever my default is.\n\n507\n00:23:59.170 --> 00:24:02.745\nI need to change my IOS to\nbe the right version or\n\n508\n00:24:02.745 --> 00:24:06.450\nright feature set to\nmatch what this guy is.\n\n509\n00:24:06.450 --> 00:24:08.350\nStart getting that stuff set up.\n\n510\n00:24:08.350 --> 00:24:12.370\nAnd then, I can set its priority\nto be something different.\n\n511\n00:24:12.370 --> 00:24:14.930\nI can set its priority to be one,\nwhich is the default,\n\n512\n00:24:14.930 --> 00:24:18.190\nto make sure that it doesn't override\nthis one, if it's already been set.\n\n513\n00:24:18.190 --> 00:24:21.610\nAll right, now that switch, the new switch\nwill likely think that it's the master.\n\n514\n00:24:21.610 --> 00:24:23.630\nRight, if I jump over\nto another switch here.\n\n515\n00:24:23.630 --> 00:24:27.640\nThis is another switch that's\nnot connected with stack lines.\n\n516\n00:24:27.640 --> 00:24:29.840\nAnd so, on this one if I do a show switch.\n\n517\n00:24:29.840 --> 00:24:33.730\nIt thinks that it's switch 1,\nand it's priority one, right.\n\n518\n00:24:33.730 --> 00:24:37.560\nNow I could leave this one thinking\nit's switch 1, and when it hooks up\n\n519\n00:24:37.560 --> 00:24:41.670\nIt'll see there's already a switch 1, and\nthe switch 1 already has a priority of 15,\n\n520\n00:24:41.670 --> 00:24:45.360\nthe other guy's gonna win,\nwe'll get renumbered.\n\n521\n00:24:45.360 --> 00:24:48.760\nSo it will automatically renumber\nus to be switch 2 or whatever, or\n\n522\n00:24:48.760 --> 00:24:50.860\nI could even change it here if I wanted.\n\n523\n00:24:50.860 --> 00:24:54.520\nAll right, but back on this guy,\nif I'm gonna be adding a new switch,\n\n524\n00:24:54.520 --> 00:24:57.010\nyou can actually do what's called\nprovisioning, or preprovisioning,\n\n525\n00:24:57.010 --> 00:24:59.870\nwhere we can get that switch\nready even before we bought it,\n\n526\n00:24:59.870 --> 00:25:02.330\neven though that's not\nnecessarily a great idea.\n\n527\n00:25:02.330 --> 00:25:04.370\nSo, if I'm gonna be adding a new switch,\nI can come in, and\n\n528\n00:25:04.370 --> 00:25:06.724\nI can just say, switch,\nand then the numbers.\n\n529\n00:25:06.724 --> 00:25:13.550\nI'll I'll do switch 2 provision,\nand then what type of switch it is.\n\n530\n00:25:13.550 --> 00:25:15.502\nNow this is where it\ngets a little bit tricky.\n\n531\n00:25:15.502 --> 00:25:19.253\nI'm gonna see a list of all the 3750's,\n\n532\n00:25:19.253 --> 00:25:24.201\n3750E's and G's and the 3750X's, the V2's.\n\n533\n00:25:24.201 --> 00:25:25.733\nSo they're all going to come up here.\n\n534\n00:25:25.733 --> 00:25:29.051\nThese are all the different switches\nthat I can choose to add in,\n\n535\n00:25:29.051 --> 00:25:30.700\ncuz we can mix and match.\n\n536\n00:25:30.700 --> 00:25:33.830\nI need to know what type of switch\nI'm about to add, all right?\n\n537\n00:25:33.830 --> 00:25:36.830\nAnd there's a few different ways\nto find out what switch you have.\n\n538\n00:25:36.830 --> 00:25:39.760\nThe easiest is to look at the faceplate\nif you're physically there.\n\n539\n00:25:39.760 --> 00:25:43.460\nIf you're not physically there,\nyou see it a few other places, right?\n\n540\n00:25:43.460 --> 00:25:46.100\nSo if I come back to this other switch,\n\n541\n00:25:46.100 --> 00:25:48.880\nthis is where I ran\nthe show switch command.\n\n542\n00:25:48.880 --> 00:25:53.100\nOn this guy, you can always come in,\nand you can run, a few different\n\n543\n00:25:53.100 --> 00:25:57.670\nways to see it, but the easiest one\nI can think of is show inventory.\n\n544\n00:25:58.750 --> 00:26:00.500\nShow inventory's kind of a weird command.\n\n545\n00:26:00.500 --> 00:26:04.050\nWe use it on the modular switches,\nbecause it shows all the blades and\n\n546\n00:26:04.050 --> 00:26:05.230\ncards that you've inserted.\n\n547\n00:26:05.230 --> 00:26:06.970\nSo show inventory makes sense there.\n\n548\n00:26:06.970 --> 00:26:09.674\nOn a fixed configuration switch,\nwe never really use this,\n\n549\n00:26:09.674 --> 00:26:12.705\ncuz it's not stuff that you add in,\nexcept for the uplink modules.\n\n550\n00:26:12.705 --> 00:26:15.911\nBut if you do show inventory, it will\ntell you the name of your switch, and\n\n551\n00:26:15.911 --> 00:26:17.309\nright here in the description,\n\n552\n00:26:17.309 --> 00:26:21.176\nyou'll see the description of the switch,\nnow notice that's different then the PID.\n\n553\n00:26:21.176 --> 00:26:29.670\nThis is actually a 3750V2-24PS-S, right?\n\n554\n00:26:29.670 --> 00:26:33.295\nUp here it just says 3750V2-24PS,\nno dash s on the end.\n\n555\n00:26:33.295 --> 00:26:37.440\nOkay, this descriptor, or\ndescription is what we actually want.\n\n556\n00:26:37.440 --> 00:26:43.460\nAnd so, if I jump back over to core two,\nI can find that in the list.\n\n557\n00:26:43.460 --> 00:26:46.420\nIt's actually right here,\nup towards the top of my screen.\n\n558\n00:26:46.420 --> 00:26:49.558\nAnd I can go in and\nI can punch that in as my platform.\n\n559\n00:26:49.558 --> 00:26:53.030\nSo I'm gonna punch it in so\nit knows what switch I'm about to plug in.\n\n560\n00:26:53.030 --> 00:26:58.740\nNow, it would've figured that out on its\nown, but if I tell it this, and I now\n\n561\n00:26:58.740 --> 00:27:03.180\nplug in a 48, it'll make that one switch\n3, it'll assume that it's not this one.\n\n562\n00:27:03.180 --> 00:27:07.110\nAll right, so, I'm gonna preprovision\nthat, so now it's ready.\n\n563\n00:27:07.110 --> 00:27:10.800\nAnd if I do a show switch,\nand take a look at it.\n\n564\n00:27:10.800 --> 00:27:12.750\nI now show two switches in my stack,\nright?\n\n565\n00:27:12.750 --> 00:27:17.930\nI've got another member and the MAC\naddress is blank and it's provisioned.\n\n566\n00:27:17.930 --> 00:27:21.080\nWhen I plug in another 24 port 3750,\n\n567\n00:27:21.080 --> 00:27:26.470\nit'll auto populate this MAC address,\nand that switch will become the member.\n\n568\n00:27:26.470 --> 00:27:28.830\nAnd the reason we wanna do this\nis I might wanna come in and\n\n569\n00:27:28.830 --> 00:27:33.880\ndo something like this where I\nsay switch to priority 14, right?\n\n570\n00:27:33.880 --> 00:27:37.610\nI want that one to become the priority,\nthe backup, right?\n\n571\n00:27:37.610 --> 00:27:40.660\nAnd see what it's telling me here,\nthere is no switch number 2 in the stack.\n\n572\n00:27:40.660 --> 00:27:42.810\nIt's provisioned but\nit hasn't been detected yet, so\n\n573\n00:27:42.810 --> 00:27:44.470\nI can't assign that priority.\n\n574\n00:27:44.470 --> 00:27:47.080\nBut I'll know that I want\nthat one to be the backup, so\n\n575\n00:27:47.080 --> 00:27:50.480\nI'm gonna come and punch that in,\nafter it gets automatically detected.\n\n576\n00:27:50.480 --> 00:27:53.360\nThey actually don't let you, or at least\nI'm not aware of any way that you can\n\n577\n00:27:53.360 --> 00:27:55.810\nhard set the MAC address\nprior to adding it.\n\n578\n00:27:55.810 --> 00:27:58.050\nThat's why I add\nthe switches one at a time.\n\n579\n00:27:58.050 --> 00:27:58.580\nOne at a time so\n\n580\n00:27:58.580 --> 00:28:02.120\nyou make sure you know which one is\ngetting which number, all right.\n\n581\n00:28:02.120 --> 00:28:06.380\nBut once they're added in,\nthe switch bonds hold these together, and\n\n582\n00:28:06.380 --> 00:28:09.570\nthe ports now show up as\npart of your switch, and\n\n583\n00:28:09.570 --> 00:28:13.110\nit's kind of neat because when\nyou take a look at a switch.\n\n584\n00:28:13.110 --> 00:28:18.538\nIf I do show IP interface brief, right?\n\n585\n00:28:18.538 --> 00:28:23.300\nWhen we take a look at our interface\nbrief output, I've got my ports 1 slash 0\n\n586\n00:28:23.300 --> 00:28:28.180\nslash 1, all the way through, is this a 24\nport or a 48, tis is a 24 port switch.\n\n587\n00:28:28.180 --> 00:28:31.028\nSo, I see 1 through 24, and\nthen notice what happened after it.\n\n588\n00:28:31.028 --> 00:28:35.240\nFA2-0-1 and it's going all\n\n589\n00:28:35.240 --> 00:28:41.240\nthe way through 2-0-24 because I told\nit that switch 2 was a 24 port switch.\n\n590\n00:28:41.240 --> 00:28:44.780\nIf I told it I was gonna have a switch 3,\nand\n\n591\n00:28:44.780 --> 00:28:47.700\nI was gonna make it a 48 port switch,\nright.\n\n592\n00:28:47.700 --> 00:28:50.070\nSo, we'll just add in a switch 3.\n\n593\n00:28:50.070 --> 00:28:52.770\nIt's gonna update my config\nto reflect that, and\n\n594\n00:28:52.770 --> 00:28:57.680\nI can start doing port configurations,\nassigning VLANs, and all of that.\n\n595\n00:28:57.680 --> 00:29:01.420\nAnd it's gonna show all these\nextra ports available to me even\n\n596\n00:29:01.420 --> 00:29:03.290\nthough that switch is down, right?\n\n597\n00:29:03.290 --> 00:29:04.440\nAnd that's kinda how it views it.\n\n598\n00:29:04.440 --> 00:29:05.470\nOh, that switch failed.\n\n599\n00:29:05.470 --> 00:29:08.440\nThe ports exist, I need to know them,\nbut the switch has failed.\n\n600\n00:29:08.440 --> 00:29:12.180\nAnd so we're gonna save their\nconfig instead of losing it, and so\n\n601\n00:29:12.180 --> 00:29:14.510\nthere all that is, and we'll see that.\n\n602\n00:29:14.510 --> 00:29:16.690\nWell it might not show up in the VLANs,\ncuz they're all down,\n\n603\n00:29:16.690 --> 00:29:18.240\nbut we'll see if it shows up there.\n\n604\n00:29:18.240 --> 00:29:21.060\nYeah, it's not going to show up there yet,\nbut as soon as I bring those switches\n\n605\n00:29:21.060 --> 00:29:24.180\nonline they'll show up there too,\nand we'll be off and going.\n\n606\n00:29:24.180 --> 00:29:27.390\nAnd at this point I add in my switches,\nright?\n\n607\n00:29:27.390 --> 00:29:31.500\nI just plug in the stack wise cables and\nthey bond into the group, and that's it.\n\n608\n00:29:31.500 --> 00:29:33.670\nAnd I don't really see\nanything different here.\n\n609\n00:29:33.670 --> 00:29:37.630\nThe ports all show up just like normal,\nand when I do a show switch,\n\n610\n00:29:37.630 --> 00:29:41.390\nthe only real difference I'll see is these\nguys will switch from provision to ready.\n\n611\n00:29:41.390 --> 00:29:43.740\nAnd they'll have a Mac address populated.\n\n612\n00:29:43.740 --> 00:29:45.940\nBut from then on,\nif I wanna connect to the console,\n\n613\n00:29:45.940 --> 00:29:47.580\nI connect to the console\nof the master switch.\n\n614\n00:29:47.580 --> 00:29:49.110\nI plug into that.\n\n615\n00:29:49.110 --> 00:29:51.530\nWhen I assign an IP address\nto the switch stack,\n\n616\n00:29:51.530 --> 00:29:53.310\nthe IP address is being\nhandled by the master.\n\n617\n00:29:53.310 --> 00:29:56.390\nAnd if the master fails, well,\nthe other guys take it over.\n\n618\n00:29:56.390 --> 00:29:59.950\nI don't even have to configure HSRP or\nVRRP or any of that stuff.\n\n619\n00:29:59.950 --> 00:30:04.940\nIf this switch fails, the config is\nsynchronized across the entire stack.\n\n620\n00:30:04.940 --> 00:30:07.680\nSo any member in the stack can jump in,\n\n621\n00:30:07.680 --> 00:30:12.320\nand take over, and\nthat's all because of this ring.\n\n622\n00:30:13.430 --> 00:30:17.370\nThe config is synced across them, if one\nguy fails another one can step up and\n\n623\n00:30:17.370 --> 00:30:19.330\nsay, hey, I'm the new master,\nI've already got the config,\n\n624\n00:30:19.330 --> 00:30:21.450\nmy ports are configured this way.\n\n625\n00:30:21.450 --> 00:30:22.550\nWe're ready to rock.\n\n626\n00:30:22.550 --> 00:30:26.170\nSo, this is a great replacement for things\nlike first hop redundancy protocols.\n\n627\n00:30:26.170 --> 00:30:30.160\nVRRP, GLBP, HSRP.\n\n628\n00:30:30.160 --> 00:30:32.780\nIt's not a perfect replacement for GLBP,\n\n629\n00:30:32.780 --> 00:30:36.730\ncuz you're not really load balancing,\nbut you don't necessarily need to,\n\n630\n00:30:36.730 --> 00:30:40.080\ncuz this is one solid switch there's\nnothing to load balance or cross.\n\n631\n00:30:40.080 --> 00:30:41.650\nIt's really a great solution.\n\n632\n00:30:41.650 --> 00:30:43.940\n>> Now Don,\nyou had mentioned that some of the cables,\n\n633\n00:30:43.940 --> 00:30:46.510\nthese stackwise cables,\nthey have logic in them.\n\n634\n00:30:46.510 --> 00:30:49.200\nIs there a way that we can actually verify\nthat the cables are functioning the way\n\n635\n00:30:49.200 --> 00:30:50.710\nthat we believe they're supposed to be?\n\n636\n00:30:50.710 --> 00:30:52.090\n>> Yeah, there's a few extra commands.\n\n637\n00:30:52.090 --> 00:30:53.730\nI don't know if these will\nbe on the exam or not,\n\n638\n00:30:53.730 --> 00:30:57.800\nbut it doesn't hurt to kind of see them.\n\n639\n00:30:57.800 --> 00:30:59.490\nI ran the show switch command, right?\n\n640\n00:30:59.490 --> 00:31:03.550\nTo just look at my overall status but\nif you do a ?, you'll see where you can do\n\n641\n00:31:03.550 --> 00:31:08.550\na stack ports and stack ring and\nyou can see some additional information.\n\n642\n00:31:08.550 --> 00:31:14.180\nLike if I do stack ring, speed,\nthat'll show me information on my speed.\n\n643\n00:31:14.180 --> 00:31:16.920\nI can see that I've got a full\nring configuration, right,\n\n644\n00:31:16.920 --> 00:31:19.180\ncuz if there's a break,\nI end up like half duplex, right?\n\n645\n00:31:19.180 --> 00:31:21.690\nSo we end up at a partial.\n\n646\n00:31:21.690 --> 00:31:24.240\nBut I've got a full ring,\nit's running stack wise,\n\n647\n00:31:24.240 --> 00:31:26.630\nand I've got 32 gigs of bandwidth.\n\n648\n00:31:26.630 --> 00:31:27.395\nThat's sweet.\n\n649\n00:31:27.395 --> 00:31:29.680\nExtra bandwidth that we get right there.\n\n650\n00:31:29.680 --> 00:31:31.460\nSo that's one command to be aware of.\n\n651\n00:31:31.460 --> 00:31:35.605\nThere's also show switch detail,\nwhich is a pretty handy one,\n\n652\n00:31:35.605 --> 00:31:39.010\ncuz it gives you a little extra\ninformation about the devices.\n\n653\n00:31:39.010 --> 00:31:44.090\nNow, what I see up here, that's what I\ngot from show switch, so that's not new.\n\n654\n00:31:44.090 --> 00:31:45.560\nWhat's new is down here.\n\n655\n00:31:45.560 --> 00:31:47.570\nI can see the individual ports.\n\n656\n00:31:48.580 --> 00:31:50.030\nWhat's my port status?\n\n657\n00:31:50.030 --> 00:31:51.710\nWhat's my neighbor's port status?\n\n658\n00:31:51.710 --> 00:31:53.630\nAm I connected or what?\n\n659\n00:31:53.630 --> 00:31:55.950\nI can see that I am connected but\nmy neighbor is down,\n\n660\n00:31:55.950 --> 00:31:59.890\nwhich means either the other end of\nthe cable is unplugged or the other end is\n\n661\n00:31:59.890 --> 00:32:03.740\njust not functioning right, so I'm not\nseeing my neighbors on Port 1 or Port 2.\n\n662\n00:32:03.740 --> 00:32:05.170\nBut it gives us a chance to see that,\n\n663\n00:32:05.170 --> 00:32:08.200\nand the cables which\ncommunicating that information.\n\n664\n00:32:08.200 --> 00:32:11.700\n>> All right, Don, that's a lot of\ninformation just about StackWise.\n\n665\n00:32:11.700 --> 00:32:13.910\nAny other parting words for us?\n\n666\n00:32:13.910 --> 00:32:15.560\n>> It's a great technology,\n\n667\n00:32:15.560 --> 00:32:19.870\nif you're looking at high\nport density switches, right?\n\n668\n00:32:19.870 --> 00:32:24.450\n6500s, they're great switches, especially,\nin your core or distribution layer.\n\n669\n00:32:24.450 --> 00:32:27.490\nBut in your access layer if you're looking\nfor something less expensive that's still\n\n670\n00:32:27.490 --> 00:32:32.710\nvery feature rich, a 3750 cluster combined\nwith the stack wise cables, it's super\n\n671\n00:32:32.710 --> 00:32:36.970\neasy to configure, super easy to maintain,\nand a lot less expensive than the 6500's.\n\n672\n00:32:36.970 --> 00:32:39.079\nAnd I know for small and\nmedium businesses,\n\n673\n00:32:39.079 --> 00:32:42.955\nI'll use them even in the core sometimes\nbecause you can get some real power, and\n\n674\n00:32:42.955 --> 00:32:45.919\nsome real bandwidth out of them,\nwithout breaking the bank,\n\n675\n00:32:45.919 --> 00:32:48.262\nso definitely a technology\nyou wanna look into.\n\n676\n00:32:48.262 --> 00:32:51.539\n>> So in this episode, we took a look at\nStackWise as a technology for the Cisco\n\n677\n00:32:51.539 --> 00:32:54.867\nswitches, remember that it actually\nallows us to be able to aggregate those\n\n678\n00:32:54.867 --> 00:32:58.507\nswitches together, and really treat them\nalmost like a modular switch, as well,\n\n679\n00:32:58.507 --> 00:33:01.965\nwhere we get the functions that we\nnormally do see there, not every function.\n\n680\n00:33:01.965 --> 00:33:03.551\nBut it is a neat technology for\n\n681\n00:33:03.551 --> 00:33:07.994\nus where we actually don't have to worry\nabout things like trunking between them,\n\n682\n00:33:07.994 --> 00:33:12.309\nas well as, ether channel, but we actually\nget the full bandwidth that we need,\n\n683\n00:33:12.309 --> 00:33:16.230\nallows us to go to manage multiple\nswitches from one, as well.\n\n684\n00:33:16.230 --> 00:33:18.360\nSo that's a great place for use to end.\n\n685\n00:33:18.360 --> 00:33:21.300\n>> Signing off for\nITProTV, I'm Ronnie Wong.\n\n686\n00:33:21.300 --> 00:33:22.000\n>> And I'm Don Pezet.\n\n687\n00:33:22.000 --> 00:33:25.185\n>> And we'll see you next time.\n\n688\n00:33:25.185 --> 00:33:29.780\n[SOUND]\n\n",
          "vimeoId": "142420409"
        }
      ],
      "title": "Layer 2 Technologies"
    },
    {
      "episodes": [
        {
          "description": "In this episode, Daniel and Don show you how to secure a network by employing DHCP Snooping. DHCP Snooping allows you to configure your network to only allow dynamic IP addressing from the ports you specify protecting you from attacks via a rogue DHCP server",
          "length": "1927",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features-100215-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features-100215-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features-100215-1-sm.jpg",
          "title": "Switch Security Features",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.861 --> 00:00:16.560\nAll right, greetings everyone and welcome\nto another great episode of ITProTV.\n\n3\n00:00:16.560 --> 00:00:18.040\nI'm your host Daniel Lowrie.\n\n4\n00:00:18.040 --> 00:00:20.900\nJoining with me on the show today,\nyet again, Mr. Don Pezet.\n\n5\n00:00:20.900 --> 00:00:22.200\nHow's it going today Don?\n\n6\n00:00:22.200 --> 00:00:23.230\n>> It is going great Daniel.\n\n7\n00:00:23.230 --> 00:00:24.790\nGlad to be back on the show.\n\n8\n00:00:24.790 --> 00:00:27.405\nAnd ready to kick off\na new section on this one.\n\n9\n00:00:27.405 --> 00:00:28.740\nWe're jumping objectives and\n\n10\n00:00:28.740 --> 00:00:32.600\nwe're gonna move into some of\nthe switch security features.\n\n11\n00:00:32.600 --> 00:00:36.910\nYou'd be amazed how many really cool\nfeatures are built into Cisco switches,\n\n12\n00:00:36.910 --> 00:00:41.990\nto help to secure and protect your network\nthat just aren't turned on by default.\n\n13\n00:00:41.990 --> 00:00:44.390\nIf you don't know about them,\nyou don't think to turn it on, and\n\n14\n00:00:44.390 --> 00:00:47.220\nyour network runs, and\nyou deal with security issues.\n\n15\n00:00:47.220 --> 00:00:50.310\nBut as it turns out, there's,\nI don't know, five or\n\n16\n00:00:50.310 --> 00:00:54.310\nsix different things that we can turn on a\nswitch, that completely eliminate certain\n\n17\n00:00:54.310 --> 00:00:58.060\ntypes of attacks that a lot of people\nspend a lot of time worrying about.\n\n18\n00:00:58.060 --> 00:01:03.530\nAnd on layer two access switches, on your\nlayer three distribution in core switches,\n\n19\n00:01:03.530 --> 00:01:05.440\nwe can implement these technologies, and\n\n20\n00:01:05.440 --> 00:01:08.580\nwe can end up with a really,\nreally secure network.\n\n21\n00:01:08.580 --> 00:01:12.050\nNow, on our distribution in core, we\nnormally try to keep things moving as fast\n\n22\n00:01:12.050 --> 00:01:14.980\nas possible and try not to\nimplement too much crazy logic, so\n\n23\n00:01:14.980 --> 00:01:19.392\nthe majority of these we'll use on\nour access switches all the time, but\n\n24\n00:01:19.392 --> 00:01:21.780\nthen on our core and\ndistribution some of the time.\n\n25\n00:01:21.780 --> 00:01:23.118\nSo just be aware that as we look through,\n\n26\n00:01:23.118 --> 00:01:26.000\nyou don't necessary want to turn\nthese on for every single switch.\n\n27\n00:01:26.000 --> 00:01:29.130\nAnd the main reason is, you gonna think\nabout where your attacks come from.\n\n28\n00:01:29.130 --> 00:01:31.890\nYour attacks generally come from clients.\n\n29\n00:01:31.890 --> 00:01:35.320\nWhen clients plug in, to the access\nports on the switches, right?\n\n30\n00:01:35.320 --> 00:01:36.550\nThe access switches.\n\n31\n00:01:36.550 --> 00:01:38.180\nClients don't plug into distribution.\n\n32\n00:01:38.180 --> 00:01:39.840\nClients don't plug into core.\n\n33\n00:01:39.840 --> 00:01:41.980\nAnd so\nthese technologies are the most effective,\n\n34\n00:01:41.980 --> 00:01:44.830\nwhen implemented on the access switch,\nright?\n\n35\n00:01:44.830 --> 00:01:50.030\nNow, the first type of attack that\nI wanna get into is, one that is.\n\n36\n00:01:50.030 --> 00:01:53.150\nActually, you'll see several of\nthese are really easy to pull off.\n\n37\n00:01:53.150 --> 00:01:56.120\nBut one of the just super\nmega easy ones to pull off.\n\n38\n00:01:56.120 --> 00:01:58.650\nSo easy that people do it by accident.\n\n39\n00:01:58.650 --> 00:02:01.950\nIt's what called a rogue DHCP server,\nall right.\n\n40\n00:02:01.950 --> 00:02:03.320\nI'll give you a great example.\n\n41\n00:02:03.320 --> 00:02:07.680\nThere was one day,\nwhere I was at the office, and\n\n42\n00:02:07.680 --> 00:02:11.520\npeople started coming to me saying,\nDon, I can't get to the Internet.\n\n43\n00:02:11.520 --> 00:02:13.000\nI think the Internet's down.\n\n44\n00:02:13.000 --> 00:02:18.300\nAnd I can print, I can access the local\nstuff, but I can't get to the Internet.\n\n45\n00:02:18.300 --> 00:02:19.588\n>> You can't print.\n\n46\n00:02:19.588 --> 00:02:20.490\n[LAUGH]\n>> Printing, who can't print?\n\n47\n00:02:20.490 --> 00:02:23.804\nBut I said, well that then, that's odd,\nand then, I sat on my laptop and\n\n48\n00:02:23.804 --> 00:02:25.210\ngot right out to the Internet.\n\n49\n00:02:26.430 --> 00:02:30.010\nOkay, so that's working for\nme, and I couldn't print.\n\n50\n00:02:30.010 --> 00:02:31.130\nNow that's weird.\n\n51\n00:02:31.130 --> 00:02:33.070\nSo I'm getting to the Internet,\nthings are good for\n\n52\n00:02:33.070 --> 00:02:37.760\nme, but I can't print, they can't\nget to the Internet, they can print.\n\n53\n00:02:37.760 --> 00:02:39.900\nWhat the heck is going on here?\n\n54\n00:02:39.900 --> 00:02:42.690\nAnd so I started to take a look at what\nwas different between my machine, and\n\n55\n00:02:42.690 --> 00:02:45.860\ntheirs and my machine had a static IP,\ncuz I did network management,\n\n56\n00:02:45.860 --> 00:02:48.730\nhad a lot of ACL's that were\ntied to the IP on my laptop.\n\n57\n00:02:48.730 --> 00:02:52.370\nTheir machine was DHCP, and when I looked\nat the address that they got on their\n\n58\n00:02:52.370 --> 00:02:55.590\nmachine, it wasn't in the right network.\n\n59\n00:02:55.590 --> 00:02:57.470\nIt was a completely different network.\n\n60\n00:02:57.470 --> 00:03:02.830\nWe used some 10 dot networks there,\nand they had a 192.168 address.\n\n61\n00:03:02.830 --> 00:03:04.218\nI was like, man where did that come from?\n\n62\n00:03:04.218 --> 00:03:07.430\nAnd the DHCP server that was listed\nwas the server that I didn't know,\n\n63\n00:03:07.430 --> 00:03:09.820\nbecause I have a 192 at 168 address.\n\n64\n00:03:09.820 --> 00:03:13.350\nSomebody had brought up\na rouge DHCP server.\n\n65\n00:03:13.350 --> 00:03:16.005\nNow an attacker can do this.\n\n66\n00:03:16.005 --> 00:03:19.555\nBecause what happens is,\nclients get a DHCP address from them, and\n\n67\n00:03:19.555 --> 00:03:21.895\nthey set themselves as a default gateway,\nand\n\n68\n00:03:21.895 --> 00:03:25.285\na smart attacker makes it where they then\nconnect it back into the network, so\n\n69\n00:03:25.285 --> 00:03:27.750\nyou can just pass right through them and\ndon't even know it.\n\n70\n00:03:27.750 --> 00:03:31.280\nThey can then run a sniffer and capture\nall your traffic or manipulate your data,\n\n71\n00:03:31.280 --> 00:03:33.500\ndo man in the middle attacks, and\nyou know all that great stuff.\n\n72\n00:03:33.500 --> 00:03:35.750\nRight?\nAnd usually it doesn't even notice it.\n\n73\n00:03:35.750 --> 00:03:38.660\nBut this one, I didn't think was an attack\nbecause you couldn't communicate\n\n74\n00:03:38.660 --> 00:03:40.360\nthrough it, it was just too obvious.\n\n75\n00:03:40.360 --> 00:03:41.470\nAnd sure enough,\n\n76\n00:03:41.470 --> 00:03:45.560\nwhat happened is, there was a person\nthat was actually up in accounting,\n\n77\n00:03:45.560 --> 00:03:50.400\nit wasn't even in IT, where they had gone\nto the store during their lunch break.\n\n78\n00:03:50.400 --> 00:03:54.140\nAnd they had bought a wireless router for\nthem to use at home.\n\n79\n00:03:54.140 --> 00:03:56.990\nAnd, they brought it into the office,\nand they decided, you know what?\n\n80\n00:03:56.990 --> 00:04:00.160\nI wanna check and see if there's any\nupdates for it before I take it home.\n\n81\n00:04:00.160 --> 00:04:02.590\nAnd so they plugged it into our network.\n\n82\n00:04:02.590 --> 00:04:06.960\nAnd those home routers, those wireless\nrouters, they're DHCP servers.\n\n83\n00:04:06.960 --> 00:04:08.510\nAnd it's turned on by default, so\n\n84\n00:04:08.510 --> 00:04:12.920\nas soon as they plugged it into my\nnetwork, it started handing out addresses.\n\n85\n00:04:12.920 --> 00:04:16.220\nAnd my clients, that had DHCP addresses,\n\n86\n00:04:16.220 --> 00:04:20.570\nthey'd start getting new leases because\nthat router was responding faster\n\n87\n00:04:20.570 --> 00:04:23.690\nthan our corporate DHCP server which\nwas actually on a different subnet.\n\n88\n00:04:23.690 --> 00:04:26.140\nAnd so,\nthey started getting these bad addresses.\n\n89\n00:04:26.140 --> 00:04:30.085\nNow, it was an accident, in this case,\nbut it caused the denial of service.\n\n90\n00:04:30.085 --> 00:04:32.645\nMy client's couldn't work, right.\n\n91\n00:04:32.645 --> 00:04:35.715\nBut if it was malicious, it could\nhave been a man in the middle attack.\n\n92\n00:04:35.715 --> 00:04:38.895\nAnd that's a rogue DHCP server,\nand it's super easy to do,\n\n93\n00:04:38.895 --> 00:04:43.555\nanybody can fire up DHCP on their laptop,\nthey can run it in a virtual machine,\n\n94\n00:04:43.555 --> 00:04:44.737\nthey can bring in a router.\n\n95\n00:04:44.737 --> 00:04:48.735\nThere's any number of ways to do it\nthat don't even cost a penny, and\n\n96\n00:04:48.735 --> 00:04:51.460\nnow you're serving up DHCP\naddresses on the network,\n\n97\n00:04:51.460 --> 00:04:54.650\nand, people aren't able to\nget their real addresses.\n\n98\n00:04:54.650 --> 00:04:56.170\nThat's a real problem\nthat we have on networks.\n\n99\n00:04:57.270 --> 00:05:02.450\nNow, on Cisco switches, we have this\ntechnology called DHCP snooping.\n\n100\n00:05:02.450 --> 00:05:04.956\nAnd DHCP snooping,\non most switches these days,\n\n101\n00:05:04.956 --> 00:05:08.985\nit's actually turned on by default,\nbut it's not set to do anything.\n\n102\n00:05:08.985 --> 00:05:14.055\nAnd what DHCP snooping does is, it watches\nthe network for DHCP communications.\n\n103\n00:05:14.055 --> 00:05:18.380\nSo your switch is actually monitoring\nDHCP, and seeing this stuff happen.\n\n104\n00:05:18.380 --> 00:05:20.290\nAnd it just doesn't do anything about it.\n\n105\n00:05:20.290 --> 00:05:22.510\nBut we can get in there and\nchange the way it works, and\n\n106\n00:05:22.510 --> 00:05:28.580\nwe can tell it to get involved in the DHCP\nprocess to help protect our network.\n\n107\n00:05:28.580 --> 00:05:30.610\nAnd it's super simple to turn on.\n\n108\n00:05:30.610 --> 00:05:33.220\nIt doesn't take a lot of\nwork to get it going.\n\n109\n00:05:33.220 --> 00:05:37.220\nAnd it helps eliminate these rogue DHCP\nservers, it gives you that control.\n\n110\n00:05:38.540 --> 00:05:42.533\nNow to understand the attack and\nto understand how DHCP snooping works,\n\n111\n00:05:42.533 --> 00:05:44.824\nwe kinda need to understand the process,\n\n112\n00:05:44.824 --> 00:05:48.894\nand Daniel this goes back to like day\ntwo of a network plus certification.\n\n113\n00:05:48.894 --> 00:05:49.532\n>> Yeah.\n\n114\n00:05:49.532 --> 00:05:50.960\n>> What's the mnemonic we had.\n\n115\n00:05:50.960 --> 00:05:53.030\n>> Oh, the good old DORA, right?\n\n116\n00:05:53.030 --> 00:05:55.250\nIt's the discover, the offer.\n\n117\n00:05:55.250 --> 00:05:56.980\nThe request and acknowledge, right?\n\n118\n00:05:58.100 --> 00:05:59.975\n>> Exactly.\nYou're a good student.\n\n119\n00:05:59.975 --> 00:06:00.920\n>> [LAUGH]\n>> So,\n\n120\n00:06:00.920 --> 00:06:04.280\nwith DHCP,\nit's entirely based on broadcasts, right?\n\n121\n00:06:04.280 --> 00:06:08.550\nA client comes up and has no address,\nso they sent out a broadcast.\n\n122\n00:06:08.550 --> 00:06:10.790\nAnd what they're doing is a DHCP discover.\n\n123\n00:06:10.790 --> 00:06:13.210\nSo they're looking for a DHCP server.\n\n124\n00:06:13.210 --> 00:06:14.560\nThey don't know who it is.\n\n125\n00:06:14.560 --> 00:06:16.800\nSo they don't know if it's a rogue,\nor if it's one of ours.\n\n126\n00:06:16.800 --> 00:06:19.840\nThey just sent out a broadcast saying,\nhey, can somebody give me an address?\n\n127\n00:06:21.030 --> 00:06:25.870\nAnd one or more DHCP servers\nwill receive that request,\n\n128\n00:06:25.870 --> 00:06:29.403\nthat discover, and\nthey'll send a DHCP offer,\n\n129\n00:06:29.403 --> 00:06:34.130\nthey'll say hey, I'm a DHCP server,\nlet me offer you this address.\n\n130\n00:06:34.130 --> 00:06:36.701\nI've got an address right here waiting for\nyou, all right,\n\n131\n00:06:36.701 --> 00:06:40.730\nnow it does an offer because more\nthan one server might respond, and\n\n132\n00:06:40.730 --> 00:06:44.570\nwhat's gonna happen is your client,\nis gonna take the first one it gets.\n\n133\n00:06:44.570 --> 00:06:50.510\nIt doesn't care whether, there's a $20,000\nserver that serving things up for\n\n134\n00:06:50.510 --> 00:06:53.850\nyour company or\nif somebody's got a $50 wireless router.\n\n135\n00:06:53.850 --> 00:06:54.800\nThey don't know that.\n\n136\n00:06:54.800 --> 00:06:58.260\nThey just see these offers come in, and\nthey'll take the first offer they get.\n\n137\n00:06:58.260 --> 00:07:00.595\nYeah.\n>> All DHCP offers are created equally,\n\n138\n00:07:00.595 --> 00:07:01.291\ngentleman.\n\n139\n00:07:01.291 --> 00:07:03.050\n>> [LAUGH] And\nit's first come first serve.\n\n140\n00:07:03.050 --> 00:07:04.015\nOffer expires while you wait.\n\n141\n00:07:04.015 --> 00:07:04.730\n>> [LAUGH] That's right.\n\n142\n00:07:04.730 --> 00:07:06.110\n>> Operators are standing by.\n\n143\n00:07:06.110 --> 00:07:08.710\nSo that's basically how that system works.\n\n144\n00:07:08.710 --> 00:07:12.540\nAnd then the client takes that first one,\nand they send.\n\n145\n00:07:12.540 --> 00:07:16.140\nA request back, saying,\nall right, I'm taking that IP.\n\n146\n00:07:16.140 --> 00:07:17.340\nI'd like to use it.\n\n147\n00:07:17.340 --> 00:07:19.720\nThe other ones,\nit just ignores, all right?\n\n148\n00:07:19.720 --> 00:07:22.180\nThe other ones it ignores, and\neventually the server takes those back.\n\n149\n00:07:22.180 --> 00:07:23.630\nIt's fine,\nI didn't wanna give it to you anyway.\n\n150\n00:07:23.630 --> 00:07:24.820\nAnd gives it to somebody else.\n\n151\n00:07:24.820 --> 00:07:25.520\nRight?\n\n152\n00:07:25.520 --> 00:07:28.350\nBut we send the request to the server\nthat we're gonna accept, and\n\n153\n00:07:28.350 --> 00:07:30.720\nthat server then sends us and\nacknowledgement saying okay, I got you,\n\n154\n00:07:30.720 --> 00:07:34.310\nyou're in my database, your lease is\nnow good for X amount of time, right?\n\n155\n00:07:34.310 --> 00:07:36.820\nEight days or one hour or\nwhatever it is, right?\n\n156\n00:07:36.820 --> 00:07:38.780\nSo that's what normally happens.\n\n157\n00:07:38.780 --> 00:07:42.120\nIt's that DHCP offer that's the problem.\n\n158\n00:07:42.120 --> 00:07:44.870\nYour client sends out the DHCP discover,\nand\n\n159\n00:07:44.870 --> 00:07:49.300\nthey get offers from anybody,\nanybody who's willing to answer.\n\n160\n00:07:49.300 --> 00:07:51.662\nAnd a rogue DHCP server\nis willing to answer.\n\n161\n00:07:51.662 --> 00:07:57.015\nSo DHCP snooping can get in there, and\ninterfere with that process, right.\n\n162\n00:07:57.015 --> 00:07:59.858\nIf you ever wanna see this process,\nright, like here let me take this guy.\n\n163\n00:07:59.858 --> 00:08:00.659\nSo I've got.\n\n164\n00:08:00.659 --> 00:08:04.731\nNYWAN1, this is actually a router,\nand if I do a show IP interface\n\n165\n00:08:04.731 --> 00:08:09.194\nbrief you'll see on my gig interface\nhere I've got a static IP, right?\n\n166\n00:08:09.194 --> 00:08:12.282\nI know it's static because I\nsee the IP address here and\n\n167\n00:08:12.282 --> 00:08:14.430\nunder method it says manual.\n\n168\n00:08:14.430 --> 00:08:17.320\nSo that's a manual IP address on this one.\n\n169\n00:08:17.320 --> 00:08:22.601\nIf I flip it to DHCP,\nwell it's gonna start\n\n170\n00:08:22.601 --> 00:08:27.597\ncatching all the DHCP offer, the DHCP.\n\n171\n00:08:27.597 --> 00:08:31.347\nI can remember my DORA right, discover,\noffer, request, and acknowledgement.\n\n172\n00:08:31.347 --> 00:08:37.767\nSo if I jump into that interface and I'm\ngonna shut it down here while I do this.\n\n173\n00:08:37.767 --> 00:08:42.751\nAnd I just say IP address DHCP,\nnow it's set to get a DHCP\n\n174\n00:08:42.751 --> 00:08:47.370\naddress instead of using that static,\nright.\n\n175\n00:08:47.370 --> 00:08:49.810\nAnd it's not gonna have one right now\ncuz I shut the interface off, but\n\n176\n00:08:49.810 --> 00:08:53.750\nif I do a show ip int br this time,\nand look.\n\n177\n00:08:53.750 --> 00:08:57.079\nYou'll see it's still reflecting that\nold address because I haven't brought\n\n178\n00:08:57.079 --> 00:08:59.919\nthe interface up yet, so\nit hasn't actually changed, all right.\n\n179\n00:08:59.919 --> 00:09:01.670\nBut it is set to get that DHCP address.\n\n180\n00:09:01.670 --> 00:09:04.597\nNow before I turn that on,\nI'm gonna turn on debugging.\n\n181\n00:09:04.597 --> 00:09:07.880\nAnd I'm gonna debug DHCP detail.\n\n182\n00:09:07.880 --> 00:09:09.200\nThere we go, all right.\n\n183\n00:09:09.200 --> 00:09:12.480\nSo I'm now debugging the DHCP process.\n\n184\n00:09:12.480 --> 00:09:16.686\nAnd when we say DORA,\nit's four steps right?\n\n185\n00:09:16.686 --> 00:09:19.566\nIt doesn't seem like it's a whole lot but\nyou're gonna see here\n\n186\n00:09:19.566 --> 00:09:23.420\nin a second when debug DHCP, it's actually\nquite a bit of output that we get.\n\n187\n00:09:23.420 --> 00:09:27.098\nSo I'm gonna turn this interface on,\nall right, and as soon as it comes on,\n\n188\n00:09:27.098 --> 00:09:30.661\nDHCP is gonna try to get a see how\nit says waiting five seconds for\n\n189\n00:09:30.661 --> 00:09:32.470\nthat interface to come up?\n\n190\n00:09:32.470 --> 00:09:37.451\nIt just came up, and now we're kicking\noff that DORA process and you're going to\n\n191\n00:09:37.451 --> 00:09:42.370\nsee a lot scroll by here I'm going to kind\nof scroll back up so we actually see it.\n\n192\n00:09:42.370 --> 00:09:45.051\n>> There's nothing like debug to make\nyour output completely useless [LAUGH].\n\n193\n00:09:45.051 --> 00:09:49.058\n>> Yeah, and and this one unfortunately\ndoesn't have a good filter so\n\n194\n00:09:49.058 --> 00:09:53.430\nwhen you do the detail on it it's\nshowing you the actual packet contents.\n\n195\n00:09:53.430 --> 00:09:56.994\nI just wanted to see the name, this isn't\noffered but they show you everything.\n\n196\n00:09:56.994 --> 00:10:02.571\nSo as we look you can kind of see, if it\nwould stop moving I'm going crazy, so,\n\n197\n00:10:02.571 --> 00:10:08.251\nmy little Java applet here always scrolls\ndown so I have to wait for it to finish.\n\n198\n00:10:08.251 --> 00:10:09.495\n>> Time to turn debug off.\n\n199\n00:10:09.495 --> 00:10:11.730\n[LAUGH]\n>> Yeah, that would work.\n\n200\n00:10:11.730 --> 00:10:13.860\nWhen it's done, it'll actually say,\nsession closed.\n\n201\n00:10:13.860 --> 00:10:16.730\nSo I'm still kind of negotiating my\naddress here, and there it goes.\n\n202\n00:10:16.730 --> 00:10:19.781\nSo it just now got the address and\nthere's the socket is closed.\n\n203\n00:10:19.781 --> 00:10:26.049\nThere, it just actually finished,\nso now we can turn off the debug.\n\n204\n00:10:26.049 --> 00:10:29.460\nAll right, so\nif we look at what happened, right?\n\n205\n00:10:29.460 --> 00:10:32.507\nThe last thing that I saw was that DHCP\nacknowledgement that's right there.\n\n206\n00:10:32.507 --> 00:10:35.936\nRight, so I got my acknowledgement and\nI got an address,\n\n207\n00:10:35.936 --> 00:10:38.732\nmy address is 192.168.16.23.\n\n208\n00:10:38.732 --> 00:10:39.897\nThat's the address that I was given.\n\n209\n00:10:39.897 --> 00:10:44.155\nAnd I was given it by a server,\nwhich if we look up here that's\n\n210\n00:10:44.155 --> 00:10:48.429\nthe server that gave it to me,\n192.168.16.6.\n\n211\n00:10:48.429 --> 00:10:53.329\nAnd if I keep scrolling back,\nI'll see that it all started\n\n212\n00:10:53.329 --> 00:10:57.931\nway back in history here\nwith a DHCP discover, right.\n\n213\n00:10:57.931 --> 00:11:03.748\nSo, I can see this starting\nDHCP discover on Gig 0/0.\n\n214\n00:11:03.748 --> 00:11:06.980\nThat's where I kicked off the process and\nI sent out that message.\n\n215\n00:11:06.980 --> 00:11:09.710\nI should get a DHCP offer coming back.\n\n216\n00:11:09.710 --> 00:11:14.223\nAnd so if I scroll down here somewhere I\nshould find a DHCP offer coming in and\n\n217\n00:11:14.223 --> 00:11:16.097\nwe move through that process.\n\n218\n00:11:16.097 --> 00:11:19.658\nAll right, but there's no authentication\nthere's no other limitations here it's\n\n219\n00:11:19.658 --> 00:11:21.745\njust straight up going to\nsend that data through.\n\n220\n00:11:21.745 --> 00:11:26.850\nAll right, and you'll see,\nthe discover it's just a ton of data.\n\n221\n00:11:26.850 --> 00:11:30.234\nSo somewhere in here were\nreceiving a packet, right, so\n\n222\n00:11:30.234 --> 00:11:33.274\nthere's the receiving a packet and,\nthere it is.\n\n223\n00:11:33.274 --> 00:11:34.940\nDHCP Offer Message.\n\n224\n00:11:34.940 --> 00:11:39.638\nI was offered this address, 192.168.16.23.\n\n225\n00:11:39.638 --> 00:11:43.519\nNow I might have gotten other offers\nat the same time, or right afterwards,\n\n226\n00:11:43.519 --> 00:11:45.520\nthis is the one that I accepted.\n\n227\n00:11:45.520 --> 00:11:49.330\nSo, right after that, you'll see where\nI start to generate that request.\n\n228\n00:11:49.330 --> 00:11:52.390\nHere's request attempt number one cuz\nyou'll send more than one request if\n\n229\n00:11:52.390 --> 00:11:53.590\nthe first one doesn't work.\n\n230\n00:11:53.590 --> 00:11:57.200\nAnd so I'm sending that request,\nand after that, they're\n\n231\n00:11:57.200 --> 00:11:59.830\ngoing to send me the acknowledgement\nletting me know I got the address.\n\n232\n00:11:59.830 --> 00:12:05.240\nAnd that's what we saw way down here\nat the end was the DHCP acknowledge and\n\n233\n00:12:05.240 --> 00:12:07.240\nthen I actually got the address.\n\n234\n00:12:07.240 --> 00:12:11.010\nSo all of that happened in the background.\n\n235\n00:12:11.010 --> 00:12:16.450\nOkay now, what if I have a rogue\nDHCP server on my network?\n\n236\n00:12:16.450 --> 00:12:18.600\nI could have gotten that\nresponse when I get that address.\n\n237\n00:12:18.600 --> 00:12:22.770\nSo I can tell the switch, hey watch the\nDHCP traffic, it's probably already doing\n\n238\n00:12:22.770 --> 00:12:30.040\nit, and then only allow certain\nports to do DHCP offers.\n\n239\n00:12:30.040 --> 00:12:34.050\nWe can create what are called trusted and\nuntrusted ports.\n\n240\n00:12:34.050 --> 00:12:38.224\nA trusted port is one that's\nallowed to generate DHCP offers.\n\n241\n00:12:38.224 --> 00:12:43.170\nAnd an untrusted port is one that's\nnow allowed to generate DHCP offers.\n\n242\n00:12:43.170 --> 00:12:48.120\nSo if we restrict the offer and we just\napprove the ports that our DHCP server is\n\n243\n00:12:48.120 --> 00:12:52.460\nplugged into, then our DHCP server should\nbe the only one that's able to function.\n\n244\n00:12:52.460 --> 00:12:55.877\nIf somebody brings a rogue DHCP server and\nplugs it in,\n\n245\n00:12:55.877 --> 00:12:59.677\nthey'll see the DHCP discovers,\ncuz those are broadcast.\n\n246\n00:12:59.677 --> 00:13:03.241\nAnd they'll try to generate and offer\nan send it, and the switch will see it and\n\n247\n00:13:03.241 --> 00:13:04.110\nsay wait a minute.\n\n248\n00:13:04.110 --> 00:13:06.630\nThat's not a trusted port,\nI need to turn that turkey off.\n\n249\n00:13:06.630 --> 00:13:09.210\nAnd it will stop that DHCP\noffer from happening.\n\n250\n00:13:09.210 --> 00:13:12.350\nWhich is a great way to protect us\nfrom rogue DHCP servers, all right.\n\n251\n00:13:14.080 --> 00:13:18.720\nNow, I mention it's probably already\nturned on, so let's jump over to my core.\n\n252\n00:13:18.720 --> 00:13:23.820\nSo this workstation this is\nactually a wrapper so NYWAN1 and\n\n253\n00:13:23.820 --> 00:13:29.320\nif I take a look at my topology NYWAN1 is\nactually plugged right here into NYCORE1.\n\n254\n00:13:29.320 --> 00:13:31.670\nSo it's plugged into this switch and\n\n255\n00:13:31.670 --> 00:13:36.320\nit sent the DHCP request in here and\nthe server responded.\n\n256\n00:13:36.320 --> 00:13:42.324\nSo let's say that the server's plugged\ninto port five on NYCORE1, all right?\n\n257\n00:13:42.324 --> 00:13:45.191\nThen what I can do is I\ncan turn on DHCP snooping,\n\n258\n00:13:45.191 --> 00:13:49.781\nI can set all of my interfaces to\nuntrusted, which is actually the default,\n\n259\n00:13:49.781 --> 00:13:52.460\nand then I can go in and\nI can trust port five.\n\n260\n00:13:52.460 --> 00:13:56.084\nAnd when that's trusted,\nnow that one will be able to respond.\n\n261\n00:13:56.084 --> 00:13:58.534\nNobody else will be able to.\n\n262\n00:13:58.534 --> 00:14:03.325\nNow, the first thing I need to do is to\nmake sure that DHCP snooping is turned on\n\n263\n00:14:03.325 --> 00:14:06.290\nand it is on by default\non a lot of switches.\n\n264\n00:14:06.290 --> 00:14:09.069\nSo sometimes you can just do like a show.\n\n265\n00:14:11.922 --> 00:14:16.210\nShow [LAUGH] there we go, DHCP.\n\n266\n00:14:16.210 --> 00:14:19.684\nAnd under show dhcp, you see, if you're\na server, and you can see those settings.\n\n267\n00:14:19.684 --> 00:14:26.519\nAnd if we do show ip dhcp,\nyou'll see we can do snooping, right?\n\n268\n00:14:26.519 --> 00:14:29.370\nSo two different kind of places to go for\nDHCP information.\n\n269\n00:14:29.370 --> 00:14:32.980\nBut you can come in here and you can look\nat it and see whether it's turned on.\n\n270\n00:14:32.980 --> 00:14:37.650\nAnd so, here I can see\nSwitch DHCP snooping is disabled.\n\n271\n00:14:37.650 --> 00:14:41.890\nSo for this switch, it's not turned\non by default but on some it is so\n\n272\n00:14:41.890 --> 00:14:43.360\nyours might already be on.\n\n273\n00:14:43.360 --> 00:14:48.070\nIf it is on, on yours,\nthen it's likely not set to do anything so\n\n274\n00:14:48.070 --> 00:14:50.520\nyou still have to do the rest\nof the configuration all right?\n\n275\n00:14:50.520 --> 00:14:53.730\nBut I can see it's not turned on for\nme and I need to go and get that set up.\n\n276\n00:14:53.730 --> 00:14:55.700\nSo to get us set up,\nI'm gonna jump into my configuration.\n\n277\n00:14:55.700 --> 00:14:59.255\nOh, shoot, I know why it's turned on\nin this one, because I'm on a router.\n\n278\n00:14:59.255 --> 00:15:00.326\n>> [LAUGH]\n>> I'm on NYWAN1,\n\n279\n00:15:00.326 --> 00:15:02.010\nI forgot to switch over to the core.\n\n280\n00:15:02.010 --> 00:15:06.360\nSo let me jump over to the right device,\nand we'll kinda repeat that process.\n\n281\n00:15:06.360 --> 00:15:08.970\nA job worth doing is worth doing twice,\nI always say.\n\n282\n00:15:08.970 --> 00:15:13.037\nAnd I'm just gonna come in here and\n\n283\n00:15:13.037 --> 00:15:16.970\ndo a quick show ip dhcp snooping.\n\n284\n00:15:16.970 --> 00:15:19.885\nAnd on this one, disabled here too.\n\n285\n00:15:19.885 --> 00:15:21.287\nGood, all right, so\nat least we're consistent.\n\n286\n00:15:21.287 --> 00:15:23.910\n[LAUGH] So it's disabled here too so\nI'm gonna get in and configure that.\n\n287\n00:15:23.910 --> 00:15:27.170\n>> Cisco doesn't know what port\nwe want to snoop on [LAUGH]?\n\n288\n00:15:27.170 --> 00:15:31.404\n>> Now, on a switch where it's disabled\nby default, when I turn it on,\n\n289\n00:15:31.404 --> 00:15:34.870\nit's gonna make all of\nmy interfaces untrusted.\n\n290\n00:15:34.870 --> 00:15:40.320\nSo, if I turn this on, I'm immediately\nblocking all my DHCP servers.\n\n291\n00:15:40.320 --> 00:15:42.710\nAnd so that can be a little\nbit of a problem, right?\n\n292\n00:15:42.710 --> 00:15:44.950\nSo, go in here let's see that.\n\n293\n00:15:44.950 --> 00:15:49.946\nIf I come in here and I say ip dhcp\nsnooping, if I just type that and\n\n294\n00:15:49.946 --> 00:15:54.503\npress enter, it's going to turn it on for\nall of my VLANS.\n\n295\n00:15:54.503 --> 00:15:58.810\nAll right and then I can go and filter\nit down to run just on certain VLANS but\n\n296\n00:15:58.810 --> 00:16:00.285\nif you specify the VLAN.\n\n297\n00:16:00.285 --> 00:16:01.887\nFirst.\n\n298\n00:16:01.887 --> 00:16:04.530\nThat sets that will do double\ndhcp snooping on VLAN 1, but\n\n299\n00:16:04.530 --> 00:16:05.860\nit doesn't actually turn it on.\n\n300\n00:16:05.860 --> 00:16:07.120\nAll right?\n\n301\n00:16:07.120 --> 00:16:11.560\nIt just makes it that when\nI do run ip dhcp snooping\n\n302\n00:16:11.560 --> 00:16:13.650\nthat it's now gonna be enabled for\njust VLAN 1.\n\n303\n00:16:13.650 --> 00:16:14.680\nAll right?\n\n304\n00:16:14.680 --> 00:16:17.830\nSo, if you're trying to avoid downtime on\nyour other VLANs and you just want it for\n\n305\n00:16:17.830 --> 00:16:20.330\none, make sure you define the VLAN\nfirst and then turn it on.\n\n306\n00:16:20.330 --> 00:16:21.330\nYou can do it the other way,\n\n307\n00:16:21.330 --> 00:16:23.750\nit just creates temporary\ndowntime on the other VLANs.\n\n308\n00:16:23.750 --> 00:16:28.170\nSo, here I've turned on dhcp snooping,\nand I've turned it on for VLAN 1.\n\n309\n00:16:28.170 --> 00:16:33.344\nAnd if I just stop right here,\nI've got a very untrusting switch, right?\n\n310\n00:16:33.344 --> 00:16:35.420\nAll my ports are gonna go untrusting.\n\n311\n00:16:35.420 --> 00:16:39.320\nAnd if I do a show ip dhcp snooping, and\n\n312\n00:16:39.320 --> 00:16:44.250\nI run that, I can see here that\nDHCP snooping is now enabled.\n\n313\n00:16:44.250 --> 00:16:48.020\nIt's turned on, but\nit's only turned on for VLAN 1, right?\n\n314\n00:16:48.020 --> 00:16:49.000\nSo, it didn't get turned on for\n\n315\n00:16:49.000 --> 00:16:52.470\nall the other VLANs that I have\nout there in my environment.\n\n316\n00:16:52.470 --> 00:16:53.842\n>> You've turned him into a cynic, Don.\n\n317\n00:16:53.842 --> 00:16:55.120\n[LAUGH]\n>> Now he's just gonna deny everybody.\n\n318\n00:16:55.120 --> 00:16:56.670\n>> Yeah.\nHe hates everyone.\n\n319\n00:16:56.670 --> 00:16:59.610\n>> Now, if you'll notice I've already\nreceived one message right here.\n\n320\n00:16:59.610 --> 00:17:02.020\nDHCP snooping untrusted port.\n\n321\n00:17:02.020 --> 00:17:06.318\nI just got a big warning right there\nletting me know that it got an untrusted\n\n322\n00:17:06.318 --> 00:17:08.050\nconnection.\n\n323\n00:17:08.050 --> 00:17:11.210\nSomebody tried to issue a DHCP address and\nit blocked it.\n\n324\n00:17:11.210 --> 00:17:13.780\nRight?\nWe got a message on an untrusted port, and\n\n325\n00:17:13.780 --> 00:17:18.090\nit's giving me the MAC address\nof who generated that.\n\n326\n00:17:18.090 --> 00:17:20.630\nSo, now I know that,\nand I can look at what\n\n327\n00:17:20.630 --> 00:17:23.470\nport has that MAC address if I\njust look in my MAC address table.\n\n328\n00:17:23.470 --> 00:17:24.680\nAll right and I'll find that, right?\n\n329\n00:17:24.680 --> 00:17:26.770\nSo, this one ends in e8c0.\n\n330\n00:17:26.770 --> 00:17:29.978\nAnd so, if I do it show Mac address table,\n\n331\n00:17:29.978 --> 00:17:34.770\nand I'll just filter that and\nlook specifically for e8c0.\n\n332\n00:17:34.770 --> 00:17:36.623\nAnd I can look in here and\n\n333\n00:17:36.623 --> 00:17:42.477\nI see somebody on port 23 tried to issue\na DHCP address and I blocked them.\n\n334\n00:17:42.477 --> 00:17:43.340\nRight?\n\n335\n00:17:43.340 --> 00:17:47.553\nSo, if I were to go to NYWAN1 and\ntry and get a DHCP address over here,\n\n336\n00:17:47.553 --> 00:17:49.966\nthat worked for me earlier, right?.\n\n337\n00:17:49.966 --> 00:17:51.500\nI got an address.\n\n338\n00:17:51.500 --> 00:17:54.910\nBut now, let me go into gi0/0, and\n\n339\n00:17:54.910 --> 00:17:59.930\nI'm gonna switch back to\na static address real quick.\n\n340\n00:17:59.930 --> 00:18:04.710\nAnd that way I completely forget any\nDHCP lease that I might have had.\n\n341\n00:18:04.710 --> 00:18:06.550\nI just kinda get rid of that stuff.\n\n342\n00:18:06.550 --> 00:18:08.240\nSo, I'm gonna switch back to a static IP.\n\n343\n00:18:09.420 --> 00:18:13.470\nAnd then, now I'm not running DHCP.\n\n344\n00:18:13.470 --> 00:18:17.450\nAnd if I look at the interface,\nit shows as having that IP and\n\n345\n00:18:17.450 --> 00:18:18.720\nbeing manually configured.\n\n346\n00:18:19.820 --> 00:18:25.840\nAnd then, if I do a ip address DHCP,\nI'm gonna try and get a DHCP address.\n\n347\n00:18:25.840 --> 00:18:29.110\nI'm gonna send a discover,\nwhich is allowed.\n\n348\n00:18:29.110 --> 00:18:31.770\nYou can send a discover\non an untrusted port.\n\n349\n00:18:31.770 --> 00:18:35.470\nBut then the DHCP server on port 23\nis gonna try and reply to me, and\n\n350\n00:18:35.470 --> 00:18:40.802\nwhen they reply to me, they're gonna do\na DHCP offer and that's gonna get blocked.\n\n351\n00:18:40.802 --> 00:18:41.450\nAll right?\n\n352\n00:18:41.450 --> 00:18:44.460\nAnd I should be seeing\nthat over on the core.\n\n353\n00:18:45.530 --> 00:18:48.060\n>> Now, Don,\nif we're seeing these messages and\n\n354\n00:18:48.060 --> 00:18:49.260\nobviously it's blocking the port.\n\n355\n00:18:49.260 --> 00:18:51.840\nIt lets you know that\nthe port's being blocked, and\n\n356\n00:18:51.840 --> 00:18:53.990\nthat's how you knew that\nthat was happening.\n\n357\n00:18:53.990 --> 00:18:56.150\nBut what if I'm not sitting\nat the console, and\n\n358\n00:18:56.150 --> 00:18:59.170\nI don't have any alerts set up to\nmaybe email me or anything like that.\n\n359\n00:18:59.170 --> 00:19:01.650\nHow would I know if a port\nwas being blocked or not?\n\n360\n00:19:01.650 --> 00:19:04.150\n>> Yeah.\nSo, we see these messages here in our log.\n\n361\n00:19:04.150 --> 00:19:07.680\nIf you're on the console\nat the time you see it.\n\n362\n00:19:07.680 --> 00:19:10.390\nOr if you're logging, you can do a show\nlog and they show up there too, and\n\n363\n00:19:10.390 --> 00:19:11.370\nyou can spot those.\n\n364\n00:19:11.370 --> 00:19:12.300\nRight?\n\n365\n00:19:12.300 --> 00:19:15.430\nBut, if you just connected\nto a switch right now and\n\n366\n00:19:15.430 --> 00:19:18.490\nmaybe you don't necessarily have logs or\ndon't want to deal with them,\n\n367\n00:19:18.490 --> 00:19:21.670\nthere's a few other commands we can run\nto kinda see the node that is working.\n\n368\n00:19:21.670 --> 00:19:23.960\nWe just want to make sure it's working,\nright?\n\n369\n00:19:23.960 --> 00:19:27.720\nBecause maybe it is working but\nit just hasn't red flagged anybody yet.\n\n370\n00:19:27.720 --> 00:19:30.670\nSo, some of the commands we can use for\nthat, there's a,\n\n371\n00:19:30.670 --> 00:19:36.370\nwe saw show IP DHCP snooping, right?\n\n372\n00:19:36.370 --> 00:19:39.350\nAnd that showed us kind of our\nconfiguration where we could see that.\n\n373\n00:19:39.350 --> 00:19:43.060\nAnd so, I can tell that it's turned on,\nthat it's up and running.\n\n374\n00:19:43.060 --> 00:19:44.320\nAnd there we go, right?\n\n375\n00:19:44.320 --> 00:19:50.800\nI can also run show IP DHCP snooping.\n\n376\n00:19:52.090 --> 00:19:55.450\nAnd then you'll see you've got\na few other options like binding.\n\n377\n00:19:55.450 --> 00:19:56.090\nRight?\n\n378\n00:19:56.090 --> 00:20:00.300\nAnd binding is nice because this lets\nyou see what Mac address got what IP.\n\n379\n00:20:00.300 --> 00:20:02.920\nIt's basically a reflection of\nwhat your DHCP table would be.\n\n380\n00:20:02.920 --> 00:20:06.140\nThis is it keeping track of who got\nwhat IP and how long they've got it and\n\n381\n00:20:06.140 --> 00:20:07.100\nwhat interface.\n\n382\n00:20:07.100 --> 00:20:08.730\nAnd you might wonder\nwhy it's tracking that,\n\n383\n00:20:08.730 --> 00:20:12.580\nit's because we can actually use it for\na few other things we'll see later on.\n\n384\n00:20:12.580 --> 00:20:16.580\nBut that's one way we can see that it's\nat least tracking the DHCP addresses so\n\n385\n00:20:16.580 --> 00:20:17.830\nI know that it's working.\n\n386\n00:20:17.830 --> 00:20:20.260\nI don't have any bindings\nright now because\n\n387\n00:20:20.260 --> 00:20:22.665\nI'm blocking all these\nDHCP messages not working.\n\n388\n00:20:22.665 --> 00:20:23.860\nRight?\n\n389\n00:20:23.860 --> 00:20:28.715\nAnother command that is useful, instead\nof binding is you can do statistics.\n\n390\n00:20:28.715 --> 00:20:31.175\nSo, show IP DHCP snooping statistics.\n\n391\n00:20:31.175 --> 00:20:35.115\nAnd this will let you see\nthe forwarded and dropped ones.\n\n392\n00:20:35.115 --> 00:20:39.225\nSo this is a great way to see that\nmy trusted servers are working and\n\n393\n00:20:39.225 --> 00:20:40.875\nmy untrusted servers are being blocked.\n\n394\n00:20:40.875 --> 00:20:44.555\nSo I can tell, without seeing the logs I\nknow that I blocked fourteen responses.\n\n395\n00:20:44.555 --> 00:20:47.325\nIt was good to have this.\n\n396\n00:20:47.325 --> 00:20:48.710\nSo, I know it's working now.\n\n397\n00:20:48.710 --> 00:20:50.400\nI keep getting these error messages,\nright?\n\n398\n00:20:50.400 --> 00:20:53.120\nAnd these are letting me know that I've\ngot that server that's being blocked.\n\n399\n00:20:53.120 --> 00:20:55.400\nI want that server to\nbe able to communicate.\n\n400\n00:20:55.400 --> 00:20:57.830\nSo I need to go and\nmake it a trusted port.\n\n401\n00:20:57.830 --> 00:20:59.660\nSo I need to go to the port\nthat it's plugged into.\n\n402\n00:20:59.660 --> 00:21:05.560\nAnd I'll just jump over to fa0/23 since\nthat's my port that's being red flagged.\n\n403\n00:21:05.560 --> 00:21:10.843\nAnd, oh, wait, it's 1/0/23 isn't it?\n\n404\n00:21:10.843 --> 00:21:11.702\nYep.\n\n405\n00:21:11.702 --> 00:21:12.740\nHang on, let me make sure I've\ngot the right port number here.\n\n406\n00:21:13.860 --> 00:21:17.430\nSo, basically we need to identify\nthe port that thing's plugged into,\n\n407\n00:21:17.430 --> 00:21:20.230\nwhich I don't know off hand.\n\n408\n00:21:20.230 --> 00:21:25.270\nAnd, you know what, I just had a typo,\nthat's all that was.\n\n409\n00:21:25.270 --> 00:21:26.150\nWhere ever that went.\n\n410\n00:21:26.150 --> 00:21:26.840\nAll right.\n\n411\n00:21:26.840 --> 00:21:30.350\nSo, it was fa1/0/23.\n\n412\n00:21:30.350 --> 00:21:32.090\nThere we go, that got it.\n\n413\n00:21:32.090 --> 00:21:33.180\nAnd I need to trust this one.\n\n414\n00:21:33.180 --> 00:21:36.654\nI need to say it's okay for\nthis guy to have a DHCP server.\n\n415\n00:21:36.654 --> 00:21:42.134\nAnd so, I can come in here and\nI can say IP DHCP snooping trust.\n\n416\n00:21:42.134 --> 00:21:43.700\nAll right?\nI'm gonna trust this port.\n\n417\n00:21:43.700 --> 00:21:44.340\nIt's okay.\n\n418\n00:21:44.340 --> 00:21:48.550\nIt's okay for\nthis port to issue out DHCP offers.\n\n419\n00:21:48.550 --> 00:21:53.171\nSo now when somebody requests, this guy\ncan offer and we should get an address.\n\n420\n00:21:53.171 --> 00:21:53.905\nAll right?\n\n421\n00:21:53.905 --> 00:21:55.420\nAnd we can test that.\n\n422\n00:21:55.420 --> 00:22:00.650\nI'm gonna jump over to my NYWAN1 router,\nthis guy.\n\n423\n00:22:00.650 --> 00:22:04.800\nAnd he's set for a DHCP address right now,\nbut it's been getting blocked, right?\n\n424\n00:22:04.800 --> 00:22:06.160\nSo he hasn't been getting it.\n\n425\n00:22:06.160 --> 00:22:08.570\nWell, I'm gonna do a shutdown.\n\n426\n00:22:08.570 --> 00:22:11.030\nSo that's gonna take that interface down.\n\n427\n00:22:11.030 --> 00:22:13.885\nAnd then, as soon as that's down,\nthere we go, I can do a no shutdown.\n\n428\n00:22:13.885 --> 00:22:15.390\nThat's gonna bring it up.\n\n429\n00:22:15.390 --> 00:22:18.130\nAnd I could have just waited, I guess,\nbut this makes it do it right now.\n\n430\n00:22:18.130 --> 00:22:19.100\nSo it's gonna reach out and\n\n431\n00:22:19.100 --> 00:22:21.850\ndo that DHCP request as soon\nas that interface comes up.\n\n432\n00:22:22.930 --> 00:22:25.230\nAnd once it comes up, there we go,\nit sends the request.\n\n433\n00:22:25.230 --> 00:22:27.120\nNow, you guys saw it took a few\nseconds for this to respond.\n\n434\n00:22:27.120 --> 00:22:28.930\nI gotta wait for\nthe other side to respond.\n\n435\n00:22:28.930 --> 00:22:32.710\nWe get the address, we add it to the\ninterface, and then we'll be in business.\n\n436\n00:22:32.710 --> 00:22:36.550\nAnd I can just monitor my show\nIP interface brief output.\n\n437\n00:22:36.550 --> 00:22:40.500\nAnd I can see that GI00 is\nset to unassigned IP, but\n\n438\n00:22:40.500 --> 00:22:41.730\nit's trying to get one from DHCP.\n\n439\n00:22:41.730 --> 00:22:46.200\nAnd if I wait just a moment\nit'll get that, unless I'm.\n\n440\n00:22:46.200 --> 00:22:49.700\nUnless I guessed the wrong port,\nwhich is definitely possible.\n\n441\n00:22:49.700 --> 00:22:50.391\n[LAUGH]\n>> [LAUGH]\n\n442\n00:22:50.391 --> 00:22:51.801\n>> So, if I got the wrong port then it's\n\n443\n00:22:51.801 --> 00:22:53.950\nstill untrusted, and\nI'd see that back on core.\n\n444\n00:22:53.950 --> 00:22:57.000\nOn core, if I picked the wrong port\n\n445\n00:22:57.000 --> 00:23:00.470\nthen I should still see some\nblocked messages coming up, right?\n\n446\n00:23:00.470 --> 00:23:04.340\nAnd I haven't gotten any blocked\nmessages since I put on that trust.\n\n447\n00:23:04.340 --> 00:23:04.890\nRight?\nHere's\n\n448\n00:23:04.890 --> 00:23:06.986\nwhere I shut down that one interface and\nbrought it back up.\n\n449\n00:23:06.986 --> 00:23:08.390\n>> But otherwise, no blocked messages.\n\n450\n00:23:08.390 --> 00:23:12.400\nSo, it should be working fine and this is\none of those cases where I just have to be\n\n451\n00:23:12.400 --> 00:23:15.645\npatient and give it just a moment and\nwe should get that address.\n\n452\n00:23:15.645 --> 00:23:16.820\nAnd there it goes.\n\n453\n00:23:16.820 --> 00:23:18.520\nRight?\nSo I can see that I just got the address,\n\n454\n00:23:18.520 --> 00:23:19.830\nit's working again.\n\n455\n00:23:19.830 --> 00:23:24.350\nAnd if I do a show IP interface brief,\nI can see that I got the address, and\n\n456\n00:23:24.350 --> 00:23:26.882\nthat I got it from DHCP.\n\n457\n00:23:26.882 --> 00:23:29.054\nAll right?\n\n458\n00:23:29.054 --> 00:23:32.630\nSo, the trick with DHCP snooping,\nyou turn it on and\n\n459\n00:23:32.630 --> 00:23:34.330\nthat immediately kills all DHCP servers.\n\n460\n00:23:35.400 --> 00:23:40.460\nAnd then you trust just the ports\nthat a DHCP server is plugged into.\n\n461\n00:23:40.460 --> 00:23:44.600\nAnd now they work, and you've effectively\nkilled off rogue DHCP servers.\n\n462\n00:23:44.600 --> 00:23:47.245\nSomebody can't bring that in and\npull it up.\n\n463\n00:23:47.245 --> 00:23:49.274\n>> Now what happens if we're\ndown the line a little bit?\n\n464\n00:23:49.274 --> 00:23:50.933\nI mean,\nthis is specifically to this port, right?\n\n465\n00:23:50.933 --> 00:23:53.952\nWe've trusted the port now,\nany DHCP goes through.\n\n466\n00:23:53.952 --> 00:23:55.833\nBut all the others are untrusted.\n\n467\n00:23:55.833 --> 00:24:00.151\nIf I'm a smart hacker, I'm gonna try to\nfilter my way through the network and\n\n468\n00:24:00.151 --> 00:24:02.090\nget those DHCPs that way, right?\n\n469\n00:24:02.090 --> 00:24:04.730\n>> Good point, and\nlet me jump to my topology here.\n\n470\n00:24:04.730 --> 00:24:06.260\nMy topology is not like this, but\n\n471\n00:24:06.260 --> 00:24:09.830\nI wanna show you kinda how\nthis is in real life LAN.\n\n472\n00:24:09.830 --> 00:24:14.460\nSo in my case NY WAN1 was plugged into\nthis guy right here, into NYCORE1.\n\n473\n00:24:14.460 --> 00:24:18.927\nSo that's where I'm plugged in and my DHCP\nserver was plugged in here too, right?\n\n474\n00:24:20.330 --> 00:24:22.030\nWell, I thought it was.\n\n475\n00:24:22.030 --> 00:24:24.500\nOn NYCORE1, remember what port I trusted?\n\n476\n00:24:25.540 --> 00:24:26.640\nPort 23.\nAnd what's port 23?\n\n477\n00:24:26.640 --> 00:24:29.730\nIt's just an uplink to this other switch,\nright?\n\n478\n00:24:29.730 --> 00:24:31.680\nSo what I'm really saying is, yeah,\n\n479\n00:24:31.680 --> 00:24:34.340\nthere's a DHCP server on\nthe other side of this trunk.\n\n480\n00:24:34.340 --> 00:24:36.321\nWell, there's a lot more than\njust a DHCP server there,\n\n481\n00:24:36.321 --> 00:24:37.740\nthere's a 48 point switch over here.\n\n482\n00:24:37.740 --> 00:24:39.880\nAnd then there's more\nswitches down the line.\n\n483\n00:24:39.880 --> 00:24:40.800\nWe could have tons.\n\n484\n00:24:40.800 --> 00:24:43.230\nThere could be thousands of people\non the other side of this link and\n\n485\n00:24:43.230 --> 00:24:44.320\nI just trusted all of them.\n\n486\n00:24:44.320 --> 00:24:45.840\nAll right.\n\n487\n00:24:45.840 --> 00:24:51.352\nSo the trick with DHCP snooping is\nyou don't turn it on just one place.\n\n488\n00:24:51.352 --> 00:24:51.980\nAll right.\n\n489\n00:24:51.980 --> 00:24:56.500\nYou need to turn it on on each of your\nswitches and it goes down the line.\n\n490\n00:24:56.500 --> 00:25:00.520\nBecause when I trusted that port here,\nthat's too much trust.\n\n491\n00:25:00.520 --> 00:25:03.730\nBut if I go to this switch and\nI turn it on.\n\n492\n00:25:03.730 --> 00:25:05.970\nAnd that server is actually\nplugged into a port here and\n\n493\n00:25:05.970 --> 00:25:07.580\nthat's the only thing I trust.\n\n494\n00:25:07.580 --> 00:25:08.880\nNow I'm protected.\n\n495\n00:25:08.880 --> 00:25:11.350\nSo you gotta go through\neach of your switches, and\n\n496\n00:25:11.350 --> 00:25:16.830\nyou'll generally want to do a DHCP\nsnooping trust on your trunk links.\n\n497\n00:25:16.830 --> 00:25:19.880\nBecause you know your DHCP server is gonna\nhave to respond over those trunk links.\n\n498\n00:25:19.880 --> 00:25:20.560\nRight?\n\n499\n00:25:20.560 --> 00:25:24.660\nBut then on the access ports, the ports\nwhere you actually plug stuff in,\n\n500\n00:25:24.660 --> 00:25:27.730\nyou want those to all be untrusted,\nexcept for\n\n501\n00:25:27.730 --> 00:25:30.880\nthe ones that actually have DHCP\nservers plugged into them, right?\n\n502\n00:25:30.880 --> 00:25:32.370\nSo that's kind of the rule of thumb.\n\n503\n00:25:32.370 --> 00:25:36.410\nWith DHCP snooping you don't need to turn\nit on in your distribution and core.\n\n504\n00:25:36.410 --> 00:25:38.000\nYou need to turn it on\non your access side,\n\n505\n00:25:38.000 --> 00:25:40.940\nwhere you're actually\nplugging in access stations.\n\n506\n00:25:40.940 --> 00:25:44.230\nBut in my scenario, I'm using a client\nthat's up here on my core, and\n\n507\n00:25:44.230 --> 00:25:46.200\nmy DHCP server is actually\nup here on the core too.\n\n508\n00:25:46.200 --> 00:25:47.410\nSo mine's a little bit different, but\n\n509\n00:25:47.410 --> 00:25:51.530\nin real life LAN, you wouldn't be plugging\na workstation into your core switch.\n\n510\n00:25:51.530 --> 00:25:53.960\nSo the rogue DHCP attack\nreally wouldn't happen there.\n\n511\n00:25:53.960 --> 00:25:55.870\nIt would happen down\nhere on the access ports,\n\n512\n00:25:55.870 --> 00:25:59.540\ncuz these are the jacks that we have on\nour wall throughout our entire building.\n\n513\n00:25:59.540 --> 00:26:04.790\nBut with really two simple commands,\nIP DHCP snooping,\n\n514\n00:26:04.790 --> 00:26:09.640\nto turn that on, and then go to an\ninterface and say, IP DHCP snooping trust,\n\n515\n00:26:09.640 --> 00:26:13.370\nbetween those two commands, we've\neffectively killed off the ability for\n\n516\n00:26:13.370 --> 00:26:15.290\nsomebody to perform a rogue DHCP attack.\n\n517\n00:26:15.290 --> 00:26:18.330\n>> That's a very, very nice little trick\nthey've allowed us there with the little\n\n518\n00:26:18.330 --> 00:26:19.890\nCisco equipment they've given us.\n\n519\n00:26:19.890 --> 00:26:23.150\nNow, that being said,\nI'm playing the hacker here again today.\n\n520\n00:26:24.240 --> 00:26:26.280\nThere is an attack that\nwe've all heard of,\n\n521\n00:26:26.280 --> 00:26:29.790\nwell we may have all heard of,\nwe've heard of, DHCP starvation.\n\n522\n00:26:29.790 --> 00:26:34.130\nKind of a denial of service attack where\nwe just say, I'm just gonna saturate\n\n523\n00:26:34.130 --> 00:26:38.260\nthe network, I'm gonna strip all\nthe DHCP addresses out of your range.\n\n524\n00:26:38.260 --> 00:26:40.120\nYou're not gonna be able to get one.\n\n525\n00:26:40.120 --> 00:26:41.950\nCan I use this to stop them?\n\n526\n00:26:41.950 --> 00:26:43.070\n>> You can, yeah.\n\n527\n00:26:43.070 --> 00:26:46.610\nSo, I kinda pitched all this from\nthe angle of blocking a rogue DHCP\n\n528\n00:26:46.610 --> 00:26:47.710\nserver, right?\n\n529\n00:26:47.710 --> 00:26:51.700\nBut DHCP starvation, it's not a server\nthat does that, it's a client.\n\n530\n00:26:51.700 --> 00:26:53.330\nIt's a client attacking a server.\n\n531\n00:26:53.330 --> 00:26:56.920\nSo, anybody, it'll take you two\nminutes on Google to go out and\n\n532\n00:26:56.920 --> 00:26:59.170\nfind a DHCP starvation tool.\n\n533\n00:26:59.170 --> 00:27:02.820\nAnd what it is, is just a program you just\nrun on your laptop or desktop or whatever,\n\n534\n00:27:02.820 --> 00:27:08.730\nand it starts generating DHCP discover\nmessages with random MAC addresses.\n\n535\n00:27:08.730 --> 00:27:13.280\nAnd you can generate tens of thousands of\nthem per minute, it's really no big deal.\n\n536\n00:27:13.280 --> 00:27:17.890\nAnd because DHCPs are broadcasts,\nthere's no source IP tied to it, so\n\n537\n00:27:17.890 --> 00:27:20.870\nyou just spoof these MAC addresses and\nthrow them out, right?\n\n538\n00:27:20.870 --> 00:27:25.870\nAnd the DHCP servers will receive\nthose and do a DHCP offer to you.\n\n539\n00:27:25.870 --> 00:27:28.670\nAnd when there's an offer,\nthe offer lasts for, it can be two or\n\n540\n00:27:28.670 --> 00:27:30.710\nthree minutes depending on\nhow the server is configured.\n\n541\n00:27:30.710 --> 00:27:35.270\nAnd so, you're now holding that address as\nthey wait for you to accept or decline it.\n\n542\n00:27:35.270 --> 00:27:38.931\nAnd, if they have a DHCP\npool that has 500 addresses,\n\n543\n00:27:38.931 --> 00:27:44.040\nit's trivial to generate 500 requests,\nright, 500 discovers.\n\n544\n00:27:44.040 --> 00:27:47.790\nAnd so, you can reserve the whole pool.\n\n545\n00:27:47.790 --> 00:27:51.210\nAnd now the DHCP server is starved\nof IP addresses to give out.\n\n546\n00:27:51.210 --> 00:27:52.280\nIt doesn't have an IPs.\n\n547\n00:27:52.280 --> 00:27:55.010\nSo now when a legitimate client\ncomes up it can't get an IP.\n\n548\n00:27:56.500 --> 00:27:57.680\nSo that's a real problem.\n\n549\n00:27:57.680 --> 00:27:59.260\nAnd it's actually a two-fold problem,\n\n550\n00:27:59.260 --> 00:28:04.060\nbecause when you send out that DHCP\ndiscover, your source MAC address is\n\n551\n00:28:04.060 --> 00:28:08.760\ntied to that frame and your switch learns\nit and puts it in its MAC address table.\n\n552\n00:28:08.760 --> 00:28:11.200\nSo you could actually have a MAC\naddress flood on this also,\n\n553\n00:28:11.200 --> 00:28:13.740\nthere's too many MAC\naddresses in the table.\n\n554\n00:28:13.740 --> 00:28:17.580\nSo there's a couple of\ndifferent ways to fix it.\n\n555\n00:28:17.580 --> 00:28:20.120\nIn another episode we're gonna\ntalk about port security.\n\n556\n00:28:20.120 --> 00:28:24.090\nAnd so you can enforce a maximum\namount of MAC addresses on a port, and\n\n557\n00:28:24.090 --> 00:28:25.570\nthat'll stop this type of attack.\n\n558\n00:28:25.570 --> 00:28:29.140\nBecause each DHCP discover message\nhas to have a different source MAC.\n\n559\n00:28:29.140 --> 00:28:31.180\nAnd so,\nif you limit the amount of source MACs,\n\n560\n00:28:31.180 --> 00:28:33.820\nyou've limited the amount of\nIPs that one person could get.\n\n561\n00:28:33.820 --> 00:28:34.930\nRight?\nSo that's one way to solve it.\n\n562\n00:28:34.930 --> 00:28:36.550\nWe'll see that later.\n\n563\n00:28:36.550 --> 00:28:39.120\nBut, DHCP snooping can do it too.\n\n564\n00:28:40.130 --> 00:28:44.560\nYou can actually set, it's kind of like a\nrate limit, like with quality of service.\n\n565\n00:28:44.560 --> 00:28:48.381\nYou can limit the amount of\nthe DHCP traffic that's allowed\n\n566\n00:28:48.381 --> 00:28:52.355\non a particular port and\nyou can cut that down so that if I try and\n\n567\n00:28:52.355 --> 00:28:57.412\ndo 500 discovers I exceed the rate limit\nand it will trim off the extra ones.\n\n568\n00:28:57.412 --> 00:29:01.649\nSo if I rate limit it down to ten,\nyeah, I can grab ten addresses.\n\n569\n00:29:01.649 --> 00:29:04.690\nBut I won't be able to get 11.\n\n570\n00:29:04.690 --> 00:29:07.700\nSo we kind of put a limit on how\neffective that attack can be.\n\n571\n00:29:07.700 --> 00:29:12.390\nAnd the command to do it is pretty\nsimple here, let me switch back to one\n\n572\n00:29:12.390 --> 00:29:16.490\nof my core switches and\nI'll show you how to do it.\n\n573\n00:29:16.490 --> 00:29:18.140\nYou'll do this on your access ports.\n\n574\n00:29:18.140 --> 00:29:20.890\nWe don't wanna rate limit our DHCP server.\n\n575\n00:29:20.890 --> 00:29:22.320\nThat's not normally a good thing.\n\n576\n00:29:22.320 --> 00:29:24.220\nSo this would normally\nbe our access ports and\n\n577\n00:29:24.220 --> 00:29:29.080\nyou just want to limit how much\nthey can issue at any given time.\n\n578\n00:29:29.080 --> 00:29:32.990\nAnd so the way we do that is you get into\nan interface that a client's plugged into.\n\n579\n00:29:32.990 --> 00:29:36.330\nSo this client for me is plugged into,\nwhat is it plugged into?\n\n580\n00:29:36.330 --> 00:29:40.260\nHere, we'll find out real quick.\n\n581\n00:29:40.260 --> 00:29:42.990\nIt is plugged into port two.\n\n582\n00:29:42.990 --> 00:29:46.490\nSo I can get into interface fa1/0/2,\nall right?\n\n583\n00:29:46.490 --> 00:29:50.270\nAnd I can say ip dhcp snooping.\n\n584\n00:29:51.460 --> 00:29:53.870\nAnd then if you do a question mark\nyou'll see there's a limit command.\n\n585\n00:29:53.870 --> 00:29:55.500\nThere it is, limit.\n\n586\n00:29:55.500 --> 00:29:59.480\nAnd we can apply limits\nto the DHCP requests.\n\n587\n00:29:59.480 --> 00:30:02.010\nSo I can set a rate limit on here.\n\n588\n00:30:02.010 --> 00:30:06.392\nAnd I can specify how many requests I\nwant to allow to go through this port,\n\n589\n00:30:06.392 --> 00:30:09.210\nthrough its DHCP snooping interval.\n\n590\n00:30:09.210 --> 00:30:11.710\nAnd this will effectively\nkill that kind of attack, so\n\n591\n00:30:11.710 --> 00:30:13.480\nI can throw a ten on here or five.\n\n592\n00:30:13.480 --> 00:30:18.140\nYou can do one, but\nif somebody unplugs their laptop and\n\n593\n00:30:18.140 --> 00:30:23.410\nplugs in another laptop that might\nnot be enough time to get past it.\n\n594\n00:30:23.410 --> 00:30:24.620\nSo now they can't get an address.\n\n595\n00:30:24.620 --> 00:30:27.630\nSo you normally wanna give a little\nbit of leeway on those ports.\n\n596\n00:30:27.630 --> 00:30:28.960\nSo I'll do ten.\n\n597\n00:30:28.960 --> 00:30:33.000\nAnd now, if somebody plugs in\nthat port and starts going crazy.\n\n598\n00:30:33.000 --> 00:30:35.840\nThe first ten work and then they stop.\n\n599\n00:30:35.840 --> 00:30:38.870\nAnd that peels that off so\nit's not sending out those DHCP discovers.\n\n600\n00:30:38.870 --> 00:30:43.620\nMy MAC address table doesn't fill up,\nand my server only wasted ten IPs.\n\n601\n00:30:43.620 --> 00:30:46.200\nThat attack is effectively stopped.\n\n602\n00:30:46.200 --> 00:30:47.227\n>> Very very cool man.\n\n603\n00:30:47.227 --> 00:30:50.720\nDHCP snooping is apparently a very\npowerful tool for us to enable\n\n604\n00:30:50.720 --> 00:30:55.063\non our Cisco switches, tightening that\nsecurity down just like we'd like it.\n\n605\n00:30:55.063 --> 00:30:57.160\nWe get all the DHCP hacking stuff.\n\n606\n00:30:57.160 --> 00:30:59.920\nStop doing that people and\nif you do we can stop you.\n\n607\n00:30:59.920 --> 00:31:01.690\n>> Yeah, and you said it's powerful.\n\n608\n00:31:01.690 --> 00:31:04.530\nWe're actually going to continue\nusing DHCP snooping in some of our\n\n609\n00:31:04.530 --> 00:31:06.430\nother security features.\n\n610\n00:31:06.430 --> 00:31:09.300\nBecause that we've got several security\nfeatures that build off of the database\n\n611\n00:31:09.300 --> 00:31:10.430\nthat DHCP snooping builds.\n\n612\n00:31:10.430 --> 00:31:14.150\nRemember, it's keeping a record of\nwhat MAC addresses got what IPs and\n\n613\n00:31:14.150 --> 00:31:16.050\nyou can use that for\nall sorts of additional features.\n\n614\n00:31:16.050 --> 00:31:18.740\nSo we're going to see this\nagain as the series goes on.\n\n615\n00:31:18.740 --> 00:31:19.350\n>> Awesome.\nWell,\n\n616\n00:31:19.350 --> 00:31:22.060\nit looks like we're going to have to\nmake another part to this because\n\n617\n00:31:22.060 --> 00:31:24.300\napparently we have a lot\nmore to talk about.\n\n618\n00:31:24.300 --> 00:31:26.730\nDon, have we come to\nthe end of this episode?\n\n619\n00:31:26.730 --> 00:31:28.990\nOr do we have anything else we\nwould like to tack on the end?\n\n620\n00:31:28.990 --> 00:31:32.240\n>> I don't think I can fit anything\nelse in, in the time that I've got.\n\n621\n00:31:32.240 --> 00:31:33.100\nSo, let's wrap it here.\n\n622\n00:31:33.100 --> 00:31:34.040\nWe will continue on.\n\n623\n00:31:34.040 --> 00:31:35.680\nThis is going to be a multi part series.\n\n624\n00:31:35.680 --> 00:31:39.340\nWhat we showed you here was how we could\ntake two really common attacks, and\n\n625\n00:31:39.340 --> 00:31:40.040\njust eliminate them.\n\n626\n00:31:40.040 --> 00:31:41.900\nThey're not even valid\non your network anymore.\n\n627\n00:31:41.900 --> 00:31:44.360\nThere's several other attacks,\nwe're actually going to do the same thing.\n\n628\n00:31:44.360 --> 00:31:46.770\nSo these are prevalent attacks\nthat are easy to pull off.\n\n629\n00:31:46.770 --> 00:31:48.390\nThis is good stuff to know.\n\n630\n00:31:48.390 --> 00:31:51.495\nSo we'll two or three parts on this\none to make sure we cover them all.\n\n631\n00:31:51.495 --> 00:31:53.130\n>> Excellent.\nWell I'm looking forward to that.\n\n632\n00:31:53.130 --> 00:31:54.480\nHopefully you guys are as well.\n\n633\n00:31:54.480 --> 00:31:55.850\nThanks for watching today.\n\n634\n00:31:55.850 --> 00:31:57.968\nI've been your host Daniel Lowrie.\n\n635\n00:31:57.968 --> 00:31:59.084\n>> And I'm Don Pezet.\n\n636\n00:31:59.084 --> 00:32:00.627\n>> And we'll see you next time.\n\n637\n00:32:00.627 --> 00:32:07.300\n[MUSIC]\n\n",
          "vimeoId": "141326234"
        },
        {
          "description": "In this episode, Daniel and Don continue switch security configurations moving into the topics of IP Source Guard and Dynamic ARP Inspection. They explain how you can prevent IP Spoofing attacks using IP Source Guard and for MAC Spoofing or ARP poisoning attacks you can employ Dynamic ARP Inspection.",
          "length": "1840",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt2-100615-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt2-100615-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt2-100615-1-sm.jpg",
          "title": "Switch Security Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.765 --> 00:00:13.781\nAll right, greetings everyone.\n\n3\n00:00:13.781 --> 00:00:16.650\nAnd wlcome to another\ngreat episode of ITProTV.\n\n4\n00:00:16.650 --> 00:00:17.880\nI'm your host, Daniel Lowrie.\n\n5\n00:00:17.880 --> 00:00:21.130\nJoining me in the studio today is\nnone other than Mr. Don Pezet.\n\n6\n00:00:21.130 --> 00:00:22.510\nHow's it going today, Don?\n\n7\n00:00:22.510 --> 00:00:23.490\n>> It is going great, Daniel.\n\n8\n00:00:23.490 --> 00:00:24.780\nExcited to be back on this show and\n\n9\n00:00:24.780 --> 00:00:30.210\nready to continue our adventure into the\nwide world of switch security features.\n\n10\n00:00:30.210 --> 00:00:33.730\nIn part one, we had a chance to\ntake a look at DHTP snooping, and\n\n11\n00:00:33.730 --> 00:00:37.210\nhow we could use it and\na couple other little technologies to\n\n12\n00:00:37.210 --> 00:00:39.760\nprotect our switches from\ncertain DHCP attacks.\n\n13\n00:00:39.760 --> 00:00:43.305\nWe specifically saw rogue DHCP servers and\nDHCP starvation, and\n\n14\n00:00:43.305 --> 00:00:45.700\nit really wasn't that\nhard to get it set up.\n\n15\n00:00:45.700 --> 00:00:48.490\nAnd now, you don't have to worry\nabout those attacks on your network.\n\n16\n00:00:48.490 --> 00:00:50.360\nIt's a thing of the past, right?\n\n17\n00:00:50.360 --> 00:00:53.850\nBut, one of the things I said right\nat the end of the episode was\n\n18\n00:00:53.850 --> 00:00:59.220\nremember GHB snooping, because we can\nuse it for a lot of other stuff, too.\n\n19\n00:00:59.220 --> 00:01:02.110\nRight, well, in this episode,\nwe're gonna see some of that other stuff.\n\n20\n00:01:02.110 --> 00:01:04.130\nWhat are the other things we\ncan use that database for?\n\n21\n00:01:04.130 --> 00:01:08.631\nBecause that GHB Database,\nremember, it's got IPs and\n\n22\n00:01:08.631 --> 00:01:12.021\nMAC addresses and what port people are on.\n\n23\n00:01:12.021 --> 00:01:14.160\nAnd that's really valuable\ninformation to have.\n\n24\n00:01:14.160 --> 00:01:17.480\nIt goes beyond what the MAC address table\nor the ARP table would have by itself and\n\n25\n00:01:17.480 --> 00:01:18.630\nkind of combines it and\n\n26\n00:01:18.630 --> 00:01:21.850\ngives us a chance to use that for\nadditional client validation.\n\n27\n00:01:21.850 --> 00:01:24.770\nAnd so, we're gonna see that here in this\nepisode and we'll get a chance to kind\n\n28\n00:01:24.770 --> 00:01:26.700\nof jump in there and\nsee what we can do with that data.\n\n29\n00:01:26.700 --> 00:01:29.450\n>> Yeah, when it comes to IP\nthe first thing I usually think of,\n\n30\n00:01:29.450 --> 00:01:31.420\nDon, is IP spoofing.\n\n31\n00:01:31.420 --> 00:01:35.060\nIt's one of the most common types of\nattack because I want to hide myself and\n\n32\n00:01:35.060 --> 00:01:38.700\nIP is a great way to go ahead and\nshow everyone who I am.\n\n33\n00:01:38.700 --> 00:01:40.700\nSo if I can make that something else,\n\n34\n00:01:40.700 --> 00:01:42.830\nmake it think, well,\nmaybe I'm a server on your network.\n\n35\n00:01:42.830 --> 00:01:44.850\nDon't look at me,\nI'm over here stealing data.\n\n36\n00:01:44.850 --> 00:01:45.600\nThat's what I wanna do.\n\n37\n00:01:45.600 --> 00:01:47.770\nSo IP spoofing's probably\none of the biggest attacks.\n\n38\n00:01:47.770 --> 00:01:50.334\nAnd can DHCP snooping help us with that?\n\n39\n00:01:50.334 --> 00:01:51.312\nOr spoofing should I say.\n\n40\n00:01:51.312 --> 00:01:54.008\nSnooping and spoofing,\nsay that three times fast.\n\n41\n00:01:54.008 --> 00:01:56.090\n[LAUGH]\n>> Yeah, it absolutely can.\n\n42\n00:01:56.090 --> 00:01:56.620\nRight?\n\n43\n00:01:56.620 --> 00:02:00.850\nIf you think about IP spoofing, it's\none of the easiest attacks to pull off.\n\n44\n00:02:00.850 --> 00:02:03.410\nYou just change your\ncomputer's IP address.\n\n45\n00:02:03.410 --> 00:02:04.120\nProblem solved.\n\n46\n00:02:04.120 --> 00:02:06.920\nRight?\nSo it's not that hard to pull off, and\n\n47\n00:02:06.920 --> 00:02:08.390\nthere's plenty of attackers\nout there that do it.\n\n48\n00:02:08.390 --> 00:02:10.650\nSo how can we prevent that?\n\n49\n00:02:10.650 --> 00:02:13.870\nWell, if you're using DHCP snooping,\none of the things that's gonna happen is,\n\n50\n00:02:13.870 --> 00:02:16.930\na client's going to send out\na broadcast or request an address.\n\n51\n00:02:16.930 --> 00:02:20.990\nAnd the DHCP server's gonna respond,\nand attach the address to you.\n\n52\n00:02:20.990 --> 00:02:24.950\nIf you're running DHCP snooping\nthat makes it into the database and\n\n53\n00:02:24.950 --> 00:02:28.650\nwe can then use that\ndatabase to ensure security.\n\n54\n00:02:28.650 --> 00:02:33.110\nWe now know that IP address\nbelongs to that MAC address and\n\n55\n00:02:33.110 --> 00:02:34.845\nwe know what port it's on.\n\n56\n00:02:34.845 --> 00:02:37.435\nAnd the switch can enforce that.\n\n57\n00:02:37.435 --> 00:02:40.145\nSo if all of the sudden we see the IP\naddress appear somewhere else with\n\n58\n00:02:40.145 --> 00:02:42.645\na different MAC address, that's not right.\n\n59\n00:02:42.645 --> 00:02:44.665\nAnd so we stop them from using it.\n\n60\n00:02:44.665 --> 00:02:47.645\nOr if we see that IP address\nappear on a different port\n\n61\n00:02:47.645 --> 00:02:50.775\nwhile we still have the other one logged,\nthat's not right.\n\n62\n00:02:50.775 --> 00:02:54.005\nAnd so we know to step in and\ndeal with that.\n\n63\n00:02:54.005 --> 00:02:56.171\nSo we can use DHCP snooping\nto kinda prevent that.\n\n64\n00:02:56.171 --> 00:02:59.053\nAnd if you will remember the database,\nlet me show it to you here real quick.\n\n65\n00:02:59.053 --> 00:03:04.034\nIn the last episode, we took one of\nmy routers, it was an NYWAN1, right?\n\n66\n00:03:04.034 --> 00:03:05.314\nSo my New York WAN1 router.\n\n67\n00:03:05.314 --> 00:03:08.531\nAnd I switched it from\na static IP to DHCP.\n\n68\n00:03:08.531 --> 00:03:13.610\nAnd when I did that, it requested\na DHCP server and DHCP snooping\n\n69\n00:03:13.610 --> 00:03:18.984\non my system was able to record that and\nallow it and pass it through.\n\n70\n00:03:18.984 --> 00:03:25.250\nIf I run show IP DHCP snooping binding.\n\n71\n00:03:25.250 --> 00:03:27.975\nWhen I run that,\nsorry binding without an s.\n\n72\n00:03:27.975 --> 00:03:29.105\nThere we go.\n\n73\n00:03:29.105 --> 00:03:30.355\nWe can see the database.\n\n74\n00:03:30.355 --> 00:03:33.547\nAnd if you look at that database\nI've got a MAC address.\n\n75\n00:03:33.547 --> 00:03:36.442\n7C:0E:CE:5C:FE:C0, right?\n\n76\n00:03:36.442 --> 00:03:37.722\nThere's my MAC address.\n\n77\n00:03:37.722 --> 00:03:39.304\nHere's the IP I got.\n\n78\n00:03:39.304 --> 00:03:46.575\n192.168.16.22, I got a lease for,\nI don't know whatever 85,000 seconds is.\n\n79\n00:03:46.575 --> 00:03:49.307\nYou'll see DHCP snooping\nis how it was learned.\n\n80\n00:03:49.307 --> 00:03:54.310\nIt's on VLAN 1 and\nit's on interface FA1/0/2.\n\n81\n00:03:54.310 --> 00:03:58.210\nSo it knows IP, MAC, and port.\n\n82\n00:03:58.210 --> 00:04:01.790\nAnd we were just using DHCP snooping\nto control where servers were.\n\n83\n00:04:01.790 --> 00:04:04.630\nBut at the same time,\nit's recording all this information and\n\n84\n00:04:04.630 --> 00:04:06.030\nsticking it in a database.\n\n85\n00:04:06.030 --> 00:04:06.660\nRight?\n\n86\n00:04:06.660 --> 00:04:11.270\nA normal DHCP database, which you\nhave on here also, is just MAC to IP.\n\n87\n00:04:11.270 --> 00:04:13.190\nIt doesn't track ports.\n\n88\n00:04:13.190 --> 00:04:15.590\nAnd your MAC address table is MAC to port.\n\n89\n00:04:15.590 --> 00:04:17.760\nAnd your ARC table is IPs to MAC.\n\n90\n00:04:17.760 --> 00:04:19.670\nNone of them have all three components.\n\n91\n00:04:19.670 --> 00:04:21.450\nDHCP snooping does.\n\n92\n00:04:21.450 --> 00:04:25.690\nSo if I want to prevent IP spoofing,\nI can just tell the switch,\n\n93\n00:04:25.690 --> 00:04:29.650\nhey, pay attention to that DHCP\nsnooping database and enforce it.\n\n94\n00:04:29.650 --> 00:04:33.760\nIf you see somebody on a different port or\na different IP or a different MAC, and\n\n95\n00:04:33.760 --> 00:04:36.930\nthey don't match up right,\nblock that traffic.\n\n96\n00:04:36.930 --> 00:04:38.890\nAll right.\nNow I know what you're thinking is,\n\n97\n00:04:38.890 --> 00:04:43.110\nwell, what if I turn my machine off and\nI turn somebody else's machine on and\n\n98\n00:04:43.110 --> 00:04:44.950\nthey get the same address as me?\n\n99\n00:04:44.950 --> 00:04:48.215\nWell that would only happen\nif your lease had expired and\n\n100\n00:04:48.215 --> 00:04:49.646\nit's tracking the lease also.\n\n101\n00:04:49.646 --> 00:04:52.870\nThat's right here, and so\nit knows if your lease is expired.\n\n102\n00:04:52.870 --> 00:04:56.240\nNo other MAC address should be\nable to get this IP while your\n\n103\n00:04:56.240 --> 00:04:59.080\nlease is still ticking down\nunless you release it.\n\n104\n00:04:59.080 --> 00:05:00.614\nRight?\nLike on a Windows machine,\n\n105\n00:05:00.614 --> 00:05:04.663\nyou can do IPConfig/release but\nwhen you do that the switch sees that too.\n\n106\n00:05:04.663 --> 00:05:07.019\nRemember it's monitoring\nall the DHCP traffic, so\n\n107\n00:05:07.019 --> 00:05:10.260\nit knows that your lease ended and\nit removes you from the database.\n\n108\n00:05:10.260 --> 00:05:12.180\nRight?\nIt's watching, it's very smart stuff.\n\n109\n00:05:12.180 --> 00:05:12.870\nRight?\n\n110\n00:05:12.870 --> 00:05:14.910\nIf you turn it on, you gotta turn it on.\n\n111\n00:05:14.910 --> 00:05:19.084\nBut we can use that to enforce it and\nnow if somebody tries to spoof our IP,\n\n112\n00:05:19.084 --> 00:05:22.856\nthe switch will see it and\nit will stop it from happening, right?\n\n113\n00:05:22.856 --> 00:05:26.554\nNow the key component here,\nthe thing that I've kind of been banging\n\n114\n00:05:26.554 --> 00:05:30.540\ninto your heads is that it really is\ncombined with DHCP snooping, right?\n\n115\n00:05:30.540 --> 00:05:32.960\nThat's where the data is coming from,\nthat's where it gets this,\n\n116\n00:05:32.960 --> 00:05:38.350\nit kind of learns it and make sure to get\nthat put it in place and fire it along.\n\n117\n00:05:38.350 --> 00:05:42.150\nSo getting this configured is actually\npretty simple, we just turn it on and\n\n118\n00:05:42.150 --> 00:05:44.180\nit runs right off of that\nDHCP snooping database.\n\n119\n00:05:45.840 --> 00:05:51.720\nNow, the only time we have a problem with\nthat is, what if we're not using DHCP.\n\n120\n00:05:52.720 --> 00:05:53.220\nRight?\n\n121\n00:05:53.220 --> 00:05:57.050\nIf you're not using DHCP then you gotta go\nsome other route, and you got two choices.\n\n122\n00:05:57.050 --> 00:05:59.397\nOne you could do DHCP reservations, which,\n\n123\n00:05:59.397 --> 00:06:02.133\ndepending on your DHCP\nserver might be pretty good.\n\n124\n00:06:02.133 --> 00:06:05.487\nAnd now you reach out,\nyou get that address and it sees that, and\n\n125\n00:06:05.487 --> 00:06:07.244\nyou always get the same address.\n\n126\n00:06:07.244 --> 00:06:08.830\nYou have the affect of a static IP,\n\n127\n00:06:08.830 --> 00:06:11.420\nbut now you're dependent\non your DHCP server, right?\n\n128\n00:06:11.420 --> 00:06:15.435\nIf your DHCP server fails, you might have\na web server or a mail server and it tries\n\n129\n00:06:15.435 --> 00:06:19.290\nto get an IP that it has a reservation\nfor, but that server's not available.\n\n130\n00:06:19.290 --> 00:06:20.129\nYou don't get the address, right?\n\n131\n00:06:20.129 --> 00:06:21.230\nSo that'd be a problem.\n\n132\n00:06:23.120 --> 00:06:26.630\nBut if I don't wanna use DHCP at all,\nif I just want a static IP.\n\n133\n00:06:26.630 --> 00:06:30.760\nWell, in that scenario we can\nactually do a static binding.\n\n134\n00:06:30.760 --> 00:06:34.694\nAnd bind the IP to a MAC, to a port.\n\n135\n00:06:34.694 --> 00:06:37.949\nAnd so you can do it without the DHCP\nsnooping database it's just going to be\n\n136\n00:06:37.949 --> 00:06:39.198\na much more manual process.\n\n137\n00:06:39.198 --> 00:06:42.560\nAll right, I'm gonna show you both ways\njust so you guys know and you can see it.\n\n138\n00:06:42.560 --> 00:06:45.876\nSo let's jump in here and we'll get a\nchance to kind of get this configured and\n\n139\n00:06:45.876 --> 00:06:48.697\nright now I'm just going to verify\nmy configuration real quick.\n\n140\n00:06:48.697 --> 00:06:51.838\nI already know it's working cuz I\nsee the database right here, but\n\n141\n00:06:51.838 --> 00:06:53.475\nI just wanna jump back to NY WAN1.\n\n142\n00:06:53.475 --> 00:06:58.740\nSo this is my WAN router right here and\nif I do a show IP interface brief,\n\n143\n00:06:58.740 --> 00:07:05.170\nI can look at its IPs, and\nI can see that it's got 192.168.16.22.\n\n144\n00:07:05.170 --> 00:07:06.990\nAnd it got it from DHCP.\n\n145\n00:07:06.990 --> 00:07:11.472\nSo I know it is using DHCP to get this\naddress, and I saw it in the database, so\n\n146\n00:07:11.472 --> 00:07:12.742\nI know that's good.\n\n147\n00:07:12.742 --> 00:07:16.430\nAll right,\nnow I'm gonna turn on enforcement.\n\n148\n00:07:16.430 --> 00:07:19.370\nAnd you can turn on enforcement after\nthe fact cuz the database already has\n\n149\n00:07:19.370 --> 00:07:20.480\nthe information on there.\n\n150\n00:07:20.480 --> 00:07:23.290\nRight?\nSo I'm just gonna jump back to my core.\n\n151\n00:07:23.290 --> 00:07:24.500\nAnd I'm gonna turn this on.\n\n152\n00:07:24.500 --> 00:07:25.130\nAll right?\n\n153\n00:07:25.130 --> 00:07:29.200\nNow, on the core, to turn it on,\nwhat we need to do is basically jump\n\n154\n00:07:29.200 --> 00:07:34.080\ninto our configuration and\nyou can turn it on per port.\n\n155\n00:07:34.080 --> 00:07:38.010\nSo, you can use the range command and\nturn it on for a wide range of ports, for\n\n156\n00:07:38.010 --> 00:07:41.210\nme this guy is on my port FA1/0/2.\n\n157\n00:07:41.210 --> 00:07:43.130\nI'm just gonna turn it on for\nthat one port for now.\n\n158\n00:07:43.130 --> 00:07:46.110\nBut you can use the range command and\nknock them all out at once.\n\n159\n00:07:46.110 --> 00:07:47.380\nBut I'm just gonna get this one.\n\n160\n00:07:47.380 --> 00:07:49.584\nI wanna make sure that nobody\ncan spoof this address.\n\n161\n00:07:49.584 --> 00:07:53.340\nAnd maybe you only worry about it for\nservers and not for workstations.\n\n162\n00:07:53.340 --> 00:07:56.377\nSo you just wanna turn one on for\na few ports, you can certainly do that.\n\n163\n00:07:56.377 --> 00:07:59.084\nBut I'm gonna turn it on here just for\nthis one.\n\n164\n00:07:59.084 --> 00:08:03.861\nAnd I'll come in and I'll just say\n\n165\n00:08:03.861 --> 00:08:08.820\nip verify source port-security.\n\n166\n00:08:08.820 --> 00:08:10.980\nOkay, now when you do that verify source,\n\n167\n00:08:10.980 --> 00:08:15.020\nthat's the part that's turning on\nwhat's called IP Source Guard.\n\n168\n00:08:15.020 --> 00:08:17.068\nThe feature is IP Source Guard, and\n\n169\n00:08:17.068 --> 00:08:21.642\nit's gonna make sure that that source is\ncorrect, right, that when we see this\n\n170\n00:08:21.642 --> 00:08:26.584\naddress that's coming in that it's in the\nDHCP snooping database and it matches up.\n\n171\n00:08:26.584 --> 00:08:29.696\nSo, I'm just gonna come in and\nsay that I wanna verify that source and\n\n172\n00:08:29.696 --> 00:08:31.263\nit's coming from Port Security.\n\n173\n00:08:31.263 --> 00:08:37.100\nNow I'm not actually using Port Security\nright now, so do I need to turn that on?\n\n174\n00:08:37.100 --> 00:08:39.700\nWell it is a good idea to have it turned\non, we'll see a little bit later in\n\n175\n00:08:39.700 --> 00:08:41.670\nthe show, but\nI am not actually using it right now but\n\n176\n00:08:41.670 --> 00:08:45.350\nit will still be okay because\nthe DHCP snooping database\n\n177\n00:08:45.350 --> 00:08:48.980\nis a form of port security, and\nso it's going to tap into that.\n\n178\n00:08:48.980 --> 00:08:52.470\nNow, when I've got that turned on,\nI could stop here and\n\n179\n00:08:52.470 --> 00:08:56.530\nits just going to rely on what's in\nthe snooping database or import security.\n\n180\n00:08:56.530 --> 00:09:01.540\nBut if I'm not using those, I'm not using\nDHCP, I can statically map this thing.\n\n181\n00:09:01.540 --> 00:09:07.910\nAnd the command to statically map it is\nsimilar, except a little bit different.\n\n182\n00:09:07.910 --> 00:09:12.270\nIf you get out of the interface, you can\ndo the mapping from the global prompt, and\n\n183\n00:09:12.270 --> 00:09:13.410\nthis is something that I always forget.\n\n184\n00:09:13.410 --> 00:09:15.270\nI had to put it in my notes,\nlike, get out of the interface,\n\n185\n00:09:15.270 --> 00:09:16.920\ncuz I usually run it globally.\n\n186\n00:09:16.920 --> 00:09:20.110\nYou can run it from the interface, it'll\nactually turn around and put it global.\n\n187\n00:09:20.110 --> 00:09:22.740\nIt's just your question mark,\nif you need in-line help doesn't work.\n\n188\n00:09:22.740 --> 00:09:25.620\nSo It's better to get to\nthe global interface first.\n\n189\n00:09:25.620 --> 00:09:31.040\nAnd what I'm going to do here is I'm\ngoing to say, ip source binding, and\n\n190\n00:09:31.040 --> 00:09:35.610\nnow I can manually bind the MAC address,\nthe IP and\n\n191\n00:09:35.610 --> 00:09:38.450\nthe port, and the VLAN,\nyou can actually go a step further.\n\n192\n00:09:38.450 --> 00:09:41.940\nSo we can put all this in place\nmanually and not rely on DHCP snooping.\n\n193\n00:09:42.990 --> 00:09:46.370\nNow, for me to put this in, I'm going\nto need a few pieces of information.\n\n194\n00:09:46.370 --> 00:09:51.105\nSo before I get started,\nI'm gonna do a quick do show ip dhcp\n\n195\n00:09:51.105 --> 00:09:56.126\nsnooping binding, just so\nI can get the mac address and port and\n\n196\n00:09:56.126 --> 00:10:00.524\nall that because I'm going\nto need that information.\n\n197\n00:10:00.524 --> 00:10:03.415\nAnd now I'm gonna say ip source binding,\nand\n\n198\n00:10:03.415 --> 00:10:06.851\nI'm going to specify the MAC\naddress of that system.\n\n199\n00:10:06.851 --> 00:10:10.993\nNow, Cisco represents\naddresses as three four\n\n200\n00:10:10.993 --> 00:10:15.558\ndigit numbers [CROSSTALK] Yeah,\nwhatever they are.\n\n201\n00:10:15.558 --> 00:10:21.762\nSo I need to kind of change it\nfrom the way it's written up here,\n\n202\n00:10:21.762 --> 00:10:26.448\nso mine's gonna be 7c0e.ce5c.fec0, so\n\n203\n00:10:26.448 --> 00:10:32.205\nI am binding that MAC address and\nit's on VLAN 1, right?\n\n204\n00:10:32.205 --> 00:10:37.261\nSo I'm kind of binding the VLAN, and\nthen after that we can specify the IP and\n\n205\n00:10:37.261 --> 00:10:41.301\nin my case it's 192.168.16.22, all right?\n\n206\n00:10:41.301 --> 00:10:43.282\nAnd so\nI'm going to punch that one in there and\n\n207\n00:10:43.282 --> 00:10:46.100\nthen lastly I just need to tell\nthe interface that it's tied to,\n\n208\n00:10:46.100 --> 00:10:48.721\nbecause I'm not in the interface\nprompt anymore, right?\n\n209\n00:10:48.721 --> 00:10:53.563\nSo I'm just gonna add that, and my\nhead's kind of covering it up there, but\n\n210\n00:10:53.563 --> 00:10:57.421\nif I add it here on the end I\ncan say interface fa1/0/2 and\n\n211\n00:10:57.421 --> 00:11:02.760\nthen that's gonna tie it all together,\nMAC address, VLAN, IP, and port.\n\n212\n00:11:02.760 --> 00:11:04.350\nAll right?\n\n213\n00:11:04.350 --> 00:11:07.973\nAnd when I run that,\nI now have that binding in place.\n\n214\n00:11:07.973 --> 00:11:12.403\nOkay, now at this point I am connected,\nI have this IP, I have this MAC address,\n\n215\n00:11:12.403 --> 00:11:16.264\neverything is kind of working the way\nthat it's supposed to, right?\n\n216\n00:11:16.264 --> 00:11:20.944\nBut this is hard set, so if this is\na server, I expect that to always be true,\n\n217\n00:11:20.944 --> 00:11:24.968\nbut if something changes,\nif my IP changes, if my VLAN changes,\n\n218\n00:11:24.968 --> 00:11:26.651\nif my port number changes,\n\n219\n00:11:26.651 --> 00:11:31.380\nif any of those components change it's\ngonna send up a red flag, all right?\n\n220\n00:11:31.380 --> 00:11:35.050\nAnd the way these changes could happen is\nmaybe somebody does a warranty call on\n\n221\n00:11:35.050 --> 00:11:38.580\nthe server and changes the network card,\nyou get a new MAC address, or\n\n222\n00:11:38.580 --> 00:11:41.680\nsomebody goes into the server and\nchanges its IP, right?\n\n223\n00:11:41.680 --> 00:11:45.520\nThose could break it, but\nusually it's the port that changes.\n\n224\n00:11:45.520 --> 00:11:51.410\nSomebody tries to spoof my MAC or spoof\nmy IP and they go to another port and\n\n225\n00:11:51.410 --> 00:11:54.260\nthey put in that IP, cuz they're\nplugged into a different port and\n\n226\n00:11:54.260 --> 00:11:57.210\nthat doesn't match here and\nit gets red flagged.\n\n227\n00:11:57.210 --> 00:11:59.960\nSo this is kind of the way we\ncan statically set that and\n\n228\n00:11:59.960 --> 00:12:01.680\nmake sure that doesn't happen.\n\n229\n00:12:01.680 --> 00:12:05.470\nNow if I jump over to NYWAN1,\nit has that IP right now,\n\n230\n00:12:05.470 --> 00:12:07.850\nit has that MAC address,\neverything's on the up and up.\n\n231\n00:12:07.850 --> 00:12:10.310\nSo if I try and\nping into my network, if I try and\n\n232\n00:12:10.310 --> 00:12:13.960\njust ping some other host on that network,\nlet's try .1.\n\n233\n00:12:13.960 --> 00:12:16.670\nSo I'm gonna do a ping and, there we go.\n\n234\n00:12:16.670 --> 00:12:20.556\nI had to do a ARP broadcast there first,\nbut my other pings made it through,\n\n235\n00:12:20.556 --> 00:12:22.420\nso I'm able to talk to the network.\n\n236\n00:12:22.420 --> 00:12:24.814\nBut watch what happens if\nI change my IP address.\n\n237\n00:12:24.814 --> 00:12:32.540\nIf I get into, gi0/0, and I change my\nIP address to something else, right?\n\n238\n00:12:32.540 --> 00:12:37.010\nAnd we probably wouldn't go and\nchange a server IP address, but, just for\n\n239\n00:12:37.010 --> 00:12:39.060\nthe sake of this example, if I\n\n240\n00:12:41.250 --> 00:12:45.220\nput it on the right network,\n192.168.16., now let's go 222.\n\n241\n00:12:45.220 --> 00:12:53.324\nAnd now, what's gonna happen is my MAC\naddress is tied to a different IP.\n\n242\n00:12:53.324 --> 00:12:55.808\nAnd so, IP Source Guard is\ngonna see that as a problem,\n\n243\n00:12:55.808 --> 00:12:57.217\nthat these things dont match.\n\n244\n00:12:57.217 --> 00:13:01.587\nAnd so if I come out here and try that\nping that I saw just a moment ago it\n\n245\n00:13:01.587 --> 00:13:06.960\nworked just fine, right, if I redo\nthat ping, I am not getting anywhere.\n\n246\n00:13:06.960 --> 00:13:10.180\nI've got a valid IP, but\nI'm not getting anywhere and\n\n247\n00:13:10.180 --> 00:13:14.970\nif I jump back to the core switch,\nwell, what do I see?\n\n248\n00:13:14.970 --> 00:13:18.340\nI don't see anything, right, so\nI don't get any immediate notification or\n\n249\n00:13:18.340 --> 00:13:21.240\nanything telling me,\nunlike with DHCP snooping, where you saw\n\n250\n00:13:21.240 --> 00:13:25.690\nthose messages about a blocked DHCP\nserver, but I know I'm not working.\n\n251\n00:13:25.690 --> 00:13:26.740\nAnd why is that?\n\n252\n00:13:26.740 --> 00:13:29.150\nThat's because IP source\ncard is stopping it.\n\n253\n00:13:29.150 --> 00:13:30.690\nThe data doesn't add up.\n\n254\n00:13:31.780 --> 00:13:33.660\nThat's how I know I've got a problem here,\n\n255\n00:13:33.660 --> 00:13:36.030\nwe've got an issue that\nis being blocked off.\n\n256\n00:13:36.030 --> 00:13:39.040\nNow, I say it doesn't show you anything,\nit actually does show a little bit.\n\n257\n00:13:39.040 --> 00:13:43.450\nThere's a few different ways to\nsee that status of the red flag.\n\n258\n00:13:43.450 --> 00:13:47.150\nIf you look in show log,\nyou're not gonna see much in there.\n\n259\n00:13:47.150 --> 00:13:48.810\nAnd actually, did I turn on buffering?\n\n260\n00:13:48.810 --> 00:13:49.517\nYeah, there we go.\n\n261\n00:13:49.517 --> 00:13:52.070\nSo you're not gonna see\na whole heck of a lot in here.\n\n262\n00:13:52.070 --> 00:13:55.920\nThese DHCP snooping ones,\nthat's from our earlier lab.\n\n263\n00:13:55.920 --> 00:13:57.970\nBut, there's not much there.\n\n264\n00:13:57.970 --> 00:14:02.490\nBut, if you take a look at\nyour MAC address table, for\n\n265\n00:14:02.490 --> 00:14:07.310\nexample, or even your ARP table, it's\nnot gonna allow those entries in there.\n\n266\n00:14:07.310 --> 00:14:10.870\nThey're not gonna make it, it's basically\nbeing blocked off and it's cutting it, and\n\n267\n00:14:10.870 --> 00:14:14.460\njust keeping it from making it there, so-\n>> Now, Don, an attacker,\n\n268\n00:14:14.460 --> 00:14:18.360\nsomeone that is actually spoofing an IP\nand trying to gain access through those\n\n269\n00:14:18.360 --> 00:14:23.180\nmeans, would, they would just not get\nanything, or what would happen really?\n\n270\n00:14:23.180 --> 00:14:26.930\n>> So, effectively,\nthey go to do the spoof attack, and\n\n271\n00:14:26.930 --> 00:14:28.710\nthey just can't communicate, right?\n\n272\n00:14:28.710 --> 00:14:31.190\nAnd it's important that\nthe switch behaves that way,\n\n273\n00:14:31.190 --> 00:14:33.890\nthat it just outright stops them,\nbecause if it allows them to\n\n274\n00:14:33.890 --> 00:14:38.010\ncommunicate in any small way, then it's\ngonna corrupt the MAC table, you know,\n\n275\n00:14:38.010 --> 00:14:41.760\nnot like totally corrupt and ruin it but\nput a bad record in the MAC table cause\n\n276\n00:14:41.760 --> 00:14:44.050\nyou have to at least have a MAC address\nto be able to communicate with a device.\n\n277\n00:14:44.050 --> 00:14:45.600\nThat's why it's gotta cut it off early.\n\n278\n00:14:45.600 --> 00:14:49.491\nSo, somebody changes their IP or they\nchange their MAC, just move a server, and\n\n279\n00:14:49.491 --> 00:14:50.417\nthey can't talk.\n\n280\n00:14:50.417 --> 00:14:53.616\nIf they put themselves back to whatever\nthey had before then they can talk, but\n\n281\n00:14:53.616 --> 00:14:56.917\nas long as they're spoofing, it's\neffectively cut them off from the network.\n\n282\n00:14:56.917 --> 00:14:59.011\nYeah, it's really effective.\n\n283\n00:14:59.011 --> 00:15:04.457\nIt does a good job, and you guys see,\nit wasn't that hard to configure.\n\n284\n00:15:04.457 --> 00:15:09.041\nI went in and did a static mapping, so\nthat requires a little bit more work, but\n\n285\n00:15:09.041 --> 00:15:13.240\nif you're just using the DHB snooping\ntable, then it's no big deal.\n\n286\n00:15:13.240 --> 00:15:16.760\nIf we look at our show command, you'll see\nwhere you've got like a show IP source,\n\n287\n00:15:16.760 --> 00:15:19.290\nand that'll show you\na little bit of information\n\n288\n00:15:19.290 --> 00:15:21.990\nbecause it's gonna basically show\nyou the bindings you've defined.\n\n289\n00:15:21.990 --> 00:15:22.810\nBut if you look at it,\n\n290\n00:15:22.810 --> 00:15:26.900\nit's not all that different from\nthe DHCP snooping database, right?\n\n291\n00:15:26.900 --> 00:15:30.280\nExcept these are showing me bindings\nthat include things that aren't DHCP.\n\n292\n00:15:30.280 --> 00:15:32.470\nSee how this one is static?\n\n293\n00:15:32.470 --> 00:15:35.350\nAnd so I've got that mapping right there,\nI can see that binding, and\n\n294\n00:15:35.350 --> 00:15:36.380\nI know about it.\n\n295\n00:15:36.380 --> 00:15:42.380\nIf I do a show ip dhcp snooping bindings,\nright?\n\n296\n00:15:42.380 --> 00:15:43.876\nBinding, I keep doing that.\n\n297\n00:15:43.876 --> 00:15:45.209\nIt's not in there, right?\n\n298\n00:15:45.209 --> 00:15:47.821\nAnd that's because I did the static\nassignment instead of doing\n\n299\n00:15:47.821 --> 00:15:48.600\nthe snooping one.\n\n300\n00:15:48.600 --> 00:15:52.376\nAnd so it overrode the snooping one and\nthe snooping one's now gone, right?\n\n301\n00:15:52.376 --> 00:15:55.890\nAlso I changed that IP so\nit released its IP beforehand.\n\n302\n00:15:55.890 --> 00:15:58.380\nSo, a couple of different\nways to look at that, but\n\n303\n00:15:58.380 --> 00:16:02.260\nthere's not a outright giant\nred flag error that you see.\n\n304\n00:16:02.260 --> 00:16:04.300\nIt just stops the attack.\n\n305\n00:16:04.300 --> 00:16:08.600\n>> Yeah, now we've been talking mostly\nabout IP spoofing, but we've mentioned MAC\n\n306\n00:16:08.600 --> 00:16:12.190\naddress spoofing which is very common and\nit's a very pointed attack.\n\n307\n00:16:12.190 --> 00:16:15.090\nMan in the middle attacks\nuse IP ARP injection,\n\n308\n00:16:15.090 --> 00:16:17.630\nARP poisoning to make them happen.\n\n309\n00:16:17.630 --> 00:16:21.200\nAnd you've said that this can\nalso help with that as well?\n\n310\n00:16:21.200 --> 00:16:22.400\n>> Yeah, absolutely.\n\n311\n00:16:22.400 --> 00:16:24.300\nWhat we just saw there was IP source code,\nso\n\n312\n00:16:24.300 --> 00:16:27.925\nit is just IPs, but\nthe Mac side is just as important too.\n\n313\n00:16:27.925 --> 00:16:32.380\nAnd changing your MAC address can actually\ncause IP Source Guard to malfunction,\n\n314\n00:16:32.380 --> 00:16:35.230\ntoo, in some scenarios.\n\n315\n00:16:35.230 --> 00:16:39.220\nEspecially when you got statically\ndefined stuff like I did, but\n\n316\n00:16:39.220 --> 00:16:42.740\nit doesn't always catch the MAC address\nstuff because of the way that it works.\n\n317\n00:16:42.740 --> 00:16:45.620\nSo if somebody is spoofing\na MAC address and\n\n318\n00:16:45.620 --> 00:16:50.590\nwe want to stop that, we have this neat\ntool called dynamic ARP inspection,\n\n319\n00:16:50.590 --> 00:16:52.880\nor on the exam they'll\nusually just call it DAI.\n\n320\n00:16:52.880 --> 00:16:57.050\nAnd the way a MAC address attack works,\nthere's a few different ways.\n\n321\n00:16:57.050 --> 00:17:00.930\nIf there's already a server plugged into\nthe network that's up and running and\n\n322\n00:17:00.930 --> 00:17:03.750\nit's advertising it's information.\n\n323\n00:17:03.750 --> 00:17:06.830\nWhat can happen is an attacker can try and\nping the server or\n\n324\n00:17:06.830 --> 00:17:08.130\nwhatever to find it's MAC address.\n\n325\n00:17:08.130 --> 00:17:10.270\nReally easy to find a host MAC address.\n\n326\n00:17:10.270 --> 00:17:16.140\nAnd once they have that they\ncan stage a ARP intersect.\n\n327\n00:17:16.140 --> 00:17:22.110\nAnd the way it works is, if I'm a client,\nlet's say I want to ping Daniel's laptop.\n\n328\n00:17:22.110 --> 00:17:26.930\nSo, I need to know your IP\naddress which DNS will give you.\n\n329\n00:17:26.930 --> 00:17:31.080\nThen I type ping followed by whatever\nIP address is on Daniel's laptop.\n\n330\n00:17:31.080 --> 00:17:33.450\nWell, if I've never talked to him before,\n\n331\n00:17:33.450 --> 00:17:36.110\nthe first thing my computer does\nis send out an arch broadcast.\n\n332\n00:17:36.110 --> 00:17:38.960\nAnd it says hey I'm trying to\nget to this IP address and\n\n333\n00:17:38.960 --> 00:17:41.330\nwe broadcast it out and\nwe say who is that?\n\n334\n00:17:41.330 --> 00:17:45.550\nAnd Daniel's laptop sees it and\nresponds back and says oh that's me.\n\n335\n00:17:45.550 --> 00:17:47.320\nThis is my MAC address.\n\n336\n00:17:47.320 --> 00:17:51.420\nAnd now I take his IP and his MAC and\nI add it to my arch table.\n\n337\n00:17:51.420 --> 00:17:54.960\nAnd so I've got it and now I can talk\nto him and I have proper layer two and\n\n338\n00:17:54.960 --> 00:17:58.560\nlayer three headers to get\nstraight to his laptop, right.\n\n339\n00:17:58.560 --> 00:18:00.640\nBut when I send out that\ninitial broadcast and\n\n340\n00:18:00.640 --> 00:18:05.840\nI say I'm trying to get to this IP,\nan attacker could actually respond first.\n\n341\n00:18:05.840 --> 00:18:07.260\nThese are broadcasts.\n\n342\n00:18:07.260 --> 00:18:11.380\nAnd so what an attacker will often do\nis just start spamming the broadcast on\n\n343\n00:18:11.380 --> 00:18:12.360\nthe network, and\n\n344\n00:18:12.360 --> 00:18:18.580\nthat way their broadcast is already on the\nnetwork prior to you even requesting it.\n\n345\n00:18:18.580 --> 00:18:21.560\nAnd so prior to the over\nserver even hearing it and\n\n346\n00:18:21.560 --> 00:18:24.240\nbeing able to respond legitimately,\nthey're already sending it out.\n\n347\n00:18:24.240 --> 00:18:26.180\nThey'll send out 100 a second or\n\n348\n00:18:26.180 --> 00:18:28.830\nwhatever just to make sure\nthat they're first in line.\n\n349\n00:18:28.830 --> 00:18:32.110\nAnd so when you request that MAC address,\ninstead of getting the actual server's MAC\n\n350\n00:18:32.110 --> 00:18:34.700\naddress, you get\nthe attacker's MAC address.\n\n351\n00:18:34.700 --> 00:18:37.310\nAnd once you've added\nthat to your ARC table,\n\n352\n00:18:37.310 --> 00:18:39.720\nyou don't query it again\nas long as it's active.\n\n353\n00:18:39.720 --> 00:18:42.560\nAnd so, you might be thinking that\nyou're browsing to a web server or\n\n354\n00:18:42.560 --> 00:18:45.730\na file share or\na printer on your network and\n\n355\n00:18:45.730 --> 00:18:48.610\nyou're actually hitting\nthe attacker instead of the server.\n\n356\n00:18:48.610 --> 00:18:54.000\nBecause they responded with a fake ARP\nresponse that mapped a MAC address\n\n357\n00:18:54.000 --> 00:18:57.460\nto their system, all right?\n\n358\n00:18:57.460 --> 00:18:59.430\nThey mapped that IP to their MAC address.\n\n359\n00:18:59.430 --> 00:19:03.340\nSo, with this one, they don't\nhave to spoof the IP necessarily.\n\n360\n00:19:03.340 --> 00:19:04.920\nThey can, but they don't have to.\n\n361\n00:19:04.920 --> 00:19:09.390\nAnd they don't even technically have to\nspoof the MAC address they can have their\n\n362\n00:19:09.390 --> 00:19:13.700\nown MAC and their own IP but\nwhen you send out that ARP request for\n\n363\n00:19:13.700 --> 00:19:16.890\nthe IP, they respond and\nyou got their MAC address.\n\n364\n00:19:16.890 --> 00:19:19.450\nAnd if they're running a sniffer in\npromiscuous mode it doesn't even matter\n\n365\n00:19:19.450 --> 00:19:20.580\nthat their IP doesn't mater.\n\n366\n00:19:20.580 --> 00:19:24.460\nAnd that's why IP SourceGuard\nisn't 100% effective.\n\n367\n00:19:24.460 --> 00:19:29.450\nIP SourceGuard can catch some of this but\nIf they're not spoofing the IP and\n\n368\n00:19:29.450 --> 00:19:31.240\nthey have their own mac address,\n\n369\n00:19:31.240 --> 00:19:34.980\nthey may have a valid binding in the DHCP\nsnooping database just like you do.\n\n370\n00:19:34.980 --> 00:19:36.720\nSo, it can't catch it.\n\n371\n00:19:36.720 --> 00:19:40.520\nSo if we combine that with DAI,\ndynamic arc inspection,\n\n372\n00:19:40.520 --> 00:19:42.180\nthen we can really get a winner.\n\n373\n00:19:42.180 --> 00:19:47.560\nThe way DAI works is it watches the arc\nbroadcast, and it watches in your server.\n\n374\n00:19:47.560 --> 00:19:51.230\nYour server will usually have a static IP\nso it's constantly responding to clients\n\n375\n00:19:51.230 --> 00:19:54.180\nsaying, oh yeah,\nthat's my IP here's my MAC address.\n\n376\n00:19:54.180 --> 00:19:57.710\nAnd so the switch sees that and it says,\nyou're the first port to have ever\n\n377\n00:19:57.710 --> 00:20:03.290\nresponded on that, so I'm going to bind\nthat ARP response to your interface.\n\n378\n00:20:03.290 --> 00:20:08.140\nAnd if anybody on any other port tries to\ndo an ARP response for that MAC address or\n\n379\n00:20:08.140 --> 00:20:10.500\nfor that IP, we're gonna block it.\n\n380\n00:20:10.500 --> 00:20:13.410\nAnd that way when an attacker comes along\nand they plug into your network and\n\n381\n00:20:13.410 --> 00:20:17.550\nthey start trying to respond for somebody\nelse's IP, it knows that's not right and\n\n382\n00:20:17.550 --> 00:20:19.240\nknows to stop it, all right?\n\n383\n00:20:19.240 --> 00:20:22.420\nSo it's very effective because it's\njust kind of just watching what's\n\n384\n00:20:22.420 --> 00:20:23.040\nalready happening.\n\n385\n00:20:23.040 --> 00:20:27.660\nIt's watching those ARP communications and\nARP communications always happen.\n\n386\n00:20:27.660 --> 00:20:31.610\nIt doesn't matter if you're using DHCP,\nor if you're statically defined or\n\n387\n00:20:31.610 --> 00:20:34.100\nwhatever, ARP always happens.\n\n388\n00:20:34.100 --> 00:20:36.880\nThe exception are on things\nlike on a Frame Relay link.\n\n389\n00:20:36.880 --> 00:20:40.450\nAnd if you've got someone spoofing\na Frame Relay DLCI or whatever then\n\n390\n00:20:40.450 --> 00:20:44.300\nthat means your ISP has been compromised,\nthat's kind of beyond your control there.\n\n391\n00:20:44.300 --> 00:20:47.880\nBut on an ethernet network\nevery communication uses ARP.\n\n392\n00:20:47.880 --> 00:20:52.670\nAnd so they're going to be using that,\nand we just got to watch out for\n\n393\n00:20:52.670 --> 00:20:54.460\nit and put in this protection.\n\n394\n00:20:54.460 --> 00:20:57.260\nLet me show you how dynamic\narc inspection works, and\n\n395\n00:20:57.260 --> 00:21:00.560\nit's another one that's\nnot that hard to turn on.\n\n396\n00:21:00.560 --> 00:21:04.230\nThe first thing I need to\ndo is I need to turn it on.\n\n397\n00:21:04.230 --> 00:21:08.830\nAnd just like DHCP snooping\nit can be turned on per VLAN.\n\n398\n00:21:08.830 --> 00:21:10.180\nSo we can just go through and\n\n399\n00:21:10.180 --> 00:21:13.680\nwe identify whatever VLAN it is that\nwe can to configure and we turn it on,\n\n400\n00:21:13.680 --> 00:21:15.590\nand you can turn it on for\nmultiple VLAN's if you want.\n\n401\n00:21:15.590 --> 00:21:17.220\nI'm just going to turn it on for one.\n\n402\n00:21:17.220 --> 00:21:21.500\nSo I'm going to jump into my core\nswitch and I'm just going to say IP,\n\n403\n00:21:21.500 --> 00:21:25.780\nI'm at the global configuration prompt,\nnot per interface.\n\n404\n00:21:25.780 --> 00:21:28.070\nIt doesn't work per interface because.\n\n405\n00:21:28.070 --> 00:21:29.450\nYou get more than one interface involved.\n\n406\n00:21:29.450 --> 00:21:31.780\nYou might even have trunk links\ntoo that you gotta watch out for.\n\n407\n00:21:31.780 --> 00:21:33.310\nSo it's a global thing.\n\n408\n00:21:33.310 --> 00:21:38.630\nAnd we'll say ip arp inspection, and\n\n409\n00:21:38.630 --> 00:21:42.030\nthen vlan followed by\nthe vlans we wanna protect.\n\n410\n00:21:42.030 --> 00:21:44.600\nAnd if you wanna protect more than one,\nyou can use the various ranges.\n\n411\n00:21:44.600 --> 00:21:47.640\nSo I could say one dash 4094,\nit'll do them all, right.\n\n412\n00:21:47.640 --> 00:21:49.670\nOr 1, 2 and it'll do 1 and 2.\n\n413\n00:21:49.670 --> 00:21:51.610\nI'm just gonna do vlan 1, all right.\n\n414\n00:21:51.610 --> 00:21:55.690\nNow that that's on, in the background,\n\n415\n00:21:55.690 --> 00:21:59.220\nit's starting to watch these\nARP request and responses.\n\n416\n00:21:59.220 --> 00:22:02.960\nAnd when it sees a response on a port, it\nsays okay, that's a valid port for that.\n\n417\n00:22:02.960 --> 00:22:05.260\nAnd from now on, I shouldn't see\nthat response anywhere else,\n\n418\n00:22:05.260 --> 00:22:06.800\nthat's where the response\nshould come from.\n\n419\n00:22:06.800 --> 00:22:09.730\nSo, it's starting to pay attention\nto that and keep track of it and\n\n420\n00:22:09.730 --> 00:22:11.720\nunderstand what's going on.\n\n421\n00:22:11.720 --> 00:22:15.150\nNow where I am going to start running into\nproblems is if things start to change on\n\n422\n00:22:15.150 --> 00:22:19.750\nthe network if somebody starts to spoof\na mac or changes their mac address or\n\n423\n00:22:19.750 --> 00:22:22.726\nwhatever we can really start to\nend up with some issues right?\n\n424\n00:22:22.726 --> 00:22:27.030\nSo, from here,\nif I were to jump over to like NYWAN1,\n\n425\n00:22:27.030 --> 00:22:31.470\nall right, and try and\nping into my network,\n\n426\n00:22:31.470 --> 00:22:37.075\nwhen I do a ping to 192.168.16.1,\nI'm gonna ping across now.\n\n427\n00:22:37.075 --> 00:22:38.055\nI'm not getting through.\n\n428\n00:22:38.055 --> 00:22:40.755\nAnd actually I'm probably still\nshut down from IP Source Guard, so\n\n429\n00:22:40.755 --> 00:22:43.355\nI probably need to fix that first\nbefore I really do any test.\n\n430\n00:22:43.355 --> 00:22:48.235\nSo let me get in and fix that, and\nlet's see, yeah I still have that static.\n\n431\n00:22:48.235 --> 00:22:49.710\nSo, let me get in and\n\n432\n00:22:49.710 --> 00:22:54.000\nI'm gonna put myself back to DHCP,\nwhich will fix that problem, right?\n\n433\n00:22:54.000 --> 00:22:57.775\nSo if I just say, ip add dhcp.\n\n434\n00:22:57.775 --> 00:22:59.570\nNow I'll get a DHCP address.\n\n435\n00:22:59.570 --> 00:23:05.460\nI was 192.168.16.22, and so\nI got that address back again.\n\n436\n00:23:07.550 --> 00:23:12.150\nAnd that is the IP that was in\nthe DHCP snooping database, so\n\n437\n00:23:12.150 --> 00:23:13.270\nI should be on the up and up.\n\n438\n00:23:13.270 --> 00:23:17.130\nIt's also the one that I statically\ndefined with DHCP snooping,\n\n439\n00:23:17.130 --> 00:23:19.010\nwith IP Source Guard.\n\n440\n00:23:19.010 --> 00:23:24.240\nSo, if I try and communicate on\nthe network now, I can reach out and ping.\n\n441\n00:23:24.240 --> 00:23:27.590\nAnd I'm not getting anywhere.\n\n442\n00:23:27.590 --> 00:23:32.350\nWell, I just fixed the stuff with DHCP\nsnooping so I should be In the clear there\n\n443\n00:23:32.350 --> 00:23:36.130\nand I fixed the stuff with the IP Source\nGuard, why am I still getting blocked?\n\n444\n00:23:36.130 --> 00:23:41.480\nAll right, and\nthe reason is that I'm not a trusted port.\n\n445\n00:23:41.480 --> 00:23:45.960\nThat it doesn't recognize that\nI am allowed to communicate and\n\n446\n00:23:45.960 --> 00:23:49.870\nI'm allowed to respond for\nthis mapping that's already in place.\n\n447\n00:23:49.870 --> 00:23:51.626\nSo, I need to trust this port.\n\n448\n00:23:51.626 --> 00:23:54.534\nYour normal client access ports\nyou don't want to trust and\n\n449\n00:23:54.534 --> 00:23:57.918\nwhen somebody plugs in it'll learn\nthe first Person and that's it.\n\n450\n00:23:57.918 --> 00:24:01.870\nBut this port's already learned it's\ngot these static mappings in there.\n\n451\n00:24:01.870 --> 00:24:04.260\nAnd at that point when you\nhave a static mapping,\n\n452\n00:24:04.260 --> 00:24:07.060\nwe need to trust this port\nbecause it's statically mapped.\n\n453\n00:24:07.060 --> 00:24:08.950\nSo, I could take\nthe static mapping out but\n\n454\n00:24:08.950 --> 00:24:12.940\nI'm gonna trust the port,\nwhich is the better solution on a server.\n\n455\n00:24:12.940 --> 00:24:15.939\nBut if I jump back, look at all these\nmessages that are coming up here, right?\n\n456\n00:24:15.939 --> 00:24:20.820\nI've got DAI-4-DHCP_SNOOPING_DENY.\n\n457\n00:24:20.820 --> 00:24:21.390\nOkay?\n\n458\n00:24:21.390 --> 00:24:24.180\nI've got Invalid ARPs responses.\n\n459\n00:24:24.180 --> 00:24:26.510\nRight?\nYou'll see requests and responses.\n\n460\n00:24:26.510 --> 00:24:27.530\nI've got both.\n\n461\n00:24:27.530 --> 00:24:31.300\nI've got some of these are responses, down\nhere, let me move that up a bit, there,\n\n462\n00:24:31.300 --> 00:24:33.200\nwe've got requests that are coming in.\n\n463\n00:24:33.200 --> 00:24:34.896\nAnd notice it's failing\nmore than one port.\n\n464\n00:24:34.896 --> 00:24:41.187\nI'm getting failures on Fa1/0/1 and\nI'm getting failures on Fa1/0/22.\n\n465\n00:24:41.187 --> 00:24:42.470\nI'm getting some failures\non some of my trunk links.\n\n466\n00:24:44.090 --> 00:24:47.110\nSo we need to go through and\ntrust our trunk links, and\n\n467\n00:24:47.110 --> 00:24:50.730\nwe need to trust the interfaces\nthat our servers are on.\n\n468\n00:24:50.730 --> 00:24:51.320\nAll right.\n\n469\n00:24:51.320 --> 00:24:55.570\nAnd then we can deny anybody else, and\nwhen they plug in it'll learn them and\n\n470\n00:24:55.570 --> 00:25:00.220\nlet them communicate, but going forward,\nthey've gotta be learned.\n\n471\n00:25:00.220 --> 00:25:01.479\nIf it's statically mapped,\nwe just have to trust it.\n\n472\n00:25:01.479 --> 00:25:05.089\nSo, I'm gonna jump in and\ntrust that, so I'll get in to,\n\n473\n00:25:05.089 --> 00:25:08.354\nactually I can probably\nknock all these out at once.\n\n474\n00:25:08.354 --> 00:25:13.187\nSo, I'm gonna do Fa1/0/ 1 through 2.\n\n475\n00:25:13.187 --> 00:25:18.979\nAnd I'll do Fa1/0/22 through 24.\n\n476\n00:25:18.979 --> 00:25:22.267\nSo those are the ports\nthat my servers are on and\n\n477\n00:25:22.267 --> 00:25:25.062\nthat's the port that my trunks are on.\n\n478\n00:25:25.062 --> 00:25:27.061\nSo I'm gonna get all of those and\nI'm gonna trust them.\n\n479\n00:25:27.061 --> 00:25:32.271\nSo I'll just come in and say ip, I-P,\nI know, I'm creating new stuff here.\n\n480\n00:25:32.271 --> 00:25:37.520\nip arp inspection trust.\n\n481\n00:25:37.520 --> 00:25:39.470\nSo now I'm gonna trust those ports.\n\n482\n00:25:39.470 --> 00:25:43.840\nSo if they say this is their IP and\nthis is their MAC, I believe them, right?\n\n483\n00:25:43.840 --> 00:25:45.640\nThese are trustworthy ports.\n\n484\n00:25:45.640 --> 00:25:48.410\nOn any other port, when somebody connects,\n\n485\n00:25:48.410 --> 00:25:52.460\nthey have to be the first person\nwith that MAC and IP combo.\n\n486\n00:25:52.460 --> 00:25:53.570\nIf they're coming in with a MAC and\n\n487\n00:25:53.570 --> 00:25:56.380\nIP that's already in use somewhere else,\nwe don't trust them.\n\n488\n00:25:56.380 --> 00:25:58.080\nAnd we're not going to\nallow them to take it.\n\n489\n00:25:58.080 --> 00:25:58.600\nRight?\n\n490\n00:25:58.600 --> 00:26:01.160\nSo the only way we allow\nthem to take it is we go and\n\n491\n00:26:01.160 --> 00:26:02.690\nclear the mapping out from somewhere else,\n\n492\n00:26:02.690 --> 00:26:07.020\nwhich means whoever's actually using\nthat IP and MAC needs to give it up.\n\n493\n00:26:07.020 --> 00:26:08.890\nWell, that's kinda what we're\ntrying to prevent here.\n\n494\n00:26:08.890 --> 00:26:11.500\nWe don't want to give that up and\nwe don't want somebody else to take it.\n\n495\n00:26:11.500 --> 00:26:14.180\nSo DAI is doing exactly\nwhat we want it to do.\n\n496\n00:26:14.180 --> 00:26:17.770\n>> So, Don, this is why this worked the\nfirst time when you had everything set up\n\n497\n00:26:17.770 --> 00:26:18.550\nand you were able to ping.\n\n498\n00:26:18.550 --> 00:26:21.435\nAnd then when we changed the IP,\nobviously that shut it down,\n\n499\n00:26:21.435 --> 00:26:22.625\nbecause that's what it's supposed to do.\n\n500\n00:26:22.625 --> 00:26:25.675\nAnd when you change it back it's still\nshutting it down because now you have to\n\n501\n00:26:25.675 --> 00:26:26.675\nput the trust in.\n\n502\n00:26:26.675 --> 00:26:28.205\n>> That's right.\n>> Because it's technically not\n\n503\n00:26:28.205 --> 00:26:29.687\nthe first thing to plug into the port.\n\n504\n00:26:29.687 --> 00:26:30.479\n>> That's exactly it.\n\n505\n00:26:30.479 --> 00:26:31.271\n>> Okay.\n\n506\n00:26:31.271 --> 00:26:34.807\n>> Even though technically it\nstill had the same MAC address and\n\n507\n00:26:34.807 --> 00:26:39.396\nsame IP, because I have that static\nmapping there, it is viewing it that way.\n\n508\n00:26:39.396 --> 00:26:41.354\nIt's kind of interesting.\n\n509\n00:26:41.354 --> 00:26:46.854\nAnd the way it views it is, hey,\nyou were .222 and now you're .22.\n\n510\n00:26:46.854 --> 00:26:47.729\nSomething changed.\n\n511\n00:26:47.729 --> 00:26:48.522\nI don't trust that.\n\n512\n00:26:48.522 --> 00:26:49.146\n>> You're shady.\n\n513\n00:26:49.146 --> 00:26:50.397\n>> Yeah.\n>> [LAUGH]\n\n514\n00:26:50.397 --> 00:26:51.758\n>> So it knows something went wrong, and\n\n515\n00:26:51.758 --> 00:26:52.740\nit's blocking that port.\n\n516\n00:26:52.740 --> 00:26:56.020\nAnd it's cool, because unlike IP source\nguard where I can't really tell it\n\n517\n00:26:56.020 --> 00:26:58.930\nhappened, with DAI I know it happened.\n\n518\n00:26:58.930 --> 00:27:03.310\nAnd it continued to prevent it after\nthe attacker undid their attack,\n\n519\n00:27:03.310 --> 00:27:06.950\nit still continued to prevent it so\nit's a great solution.\n\n520\n00:27:06.950 --> 00:27:09.140\nAnd this one has a few\nbetter diagnostic tools,\n\n521\n00:27:09.140 --> 00:27:15.067\nlike if I do show IP Arp inspection.\n\n522\n00:27:15.067 --> 00:27:18.600\nYou've got interfaces,\nlog, statistics, vlan.\n\n523\n00:27:18.600 --> 00:27:20.300\nYou got a few different\nthings you can see.\n\n524\n00:27:20.300 --> 00:27:22.960\nSo like I might pull up the statistics.\n\n525\n00:27:22.960 --> 00:27:27.400\nAnd we can jump in there and see whether\nwe've had any destination MAC failures.\n\n526\n00:27:27.400 --> 00:27:29.280\nRight, anybody who wasn't mapped properly.\n\n527\n00:27:29.280 --> 00:27:32.410\nYou'll see your DHCP permits and failures.\n\n528\n00:27:32.410 --> 00:27:34.830\nSo any time there's been a spoof or\nanything,\n\n529\n00:27:34.830 --> 00:27:37.490\nit'll show up right here in this output.\n\n530\n00:27:37.490 --> 00:27:39.370\nThat's just statistics.\n\n531\n00:27:39.370 --> 00:27:40.930\nYou can also look on an interface.\n\n532\n00:27:40.930 --> 00:27:42.970\nIf there's an interface\nthat's being shut down for\n\n533\n00:27:42.970 --> 00:27:46.400\nwhatever reason, you can come in here and\ntake a look at it.\n\n534\n00:27:46.400 --> 00:27:51.320\nAnd it will tell you whether it's trusted\nor not, and what its current state is.\n\n535\n00:27:51.320 --> 00:27:55.430\nSo if I take a look at one of my other\nports, like this one, it's untrusted.\n\n536\n00:27:55.430 --> 00:27:57.208\nSo I can get a chance\nto kind of view that.\n\n537\n00:27:57.208 --> 00:27:59.900\nAnd, see how it's also rate limiting?\n\n538\n00:27:59.900 --> 00:28:01.480\nOn a trusted port it doesn't rate limit,\nbut\n\n539\n00:28:01.480 --> 00:28:07.250\non an untrusted port it only lets you\nsend 15 ARP responses per second.\n\n540\n00:28:07.250 --> 00:28:08.480\nSo it kind of holds you down to that.\n\n541\n00:28:08.480 --> 00:28:12.130\nIt says a normal workstation\nshouldn't be connecting to more\n\n542\n00:28:12.130 --> 00:28:15.620\nthan 15 brand new IPs simultaneously, vs.\n\n543\n00:28:15.620 --> 00:28:16.830\nan attacker who will.\n\n544\n00:28:16.830 --> 00:28:17.350\nRight?\n\n545\n00:28:17.350 --> 00:28:19.520\nAnd you can tweak those settings\nin there if you want, but\n\n546\n00:28:19.520 --> 00:28:22.410\nthe defaults are pretty accurate for\nwhat most networks need.\n\n547\n00:28:22.410 --> 00:28:25.250\n>> Puts the nix on that\nflooding the arp there, huh?\n\n548\n00:28:25.250 --> 00:28:25.968\n[LAUGH]\n>> Yeah.\n\n549\n00:28:25.968 --> 00:28:26.574\nIt really does.\n\n550\n00:28:26.574 --> 00:28:28.174\nYou know, all of these technologies,\n\n551\n00:28:28.174 --> 00:28:30.271\nthey sound like they do the same thing,\nyou know.\n\n552\n00:28:30.271 --> 00:28:32.324\nAnd you guys might be\nthinking that in TV land.\n\n553\n00:28:32.324 --> 00:28:37.300\nLike, if I've got DHV snooping and\nIP source guard and dynamic arp inspection\n\n554\n00:28:37.300 --> 00:28:41.870\nthey all kind of do the same thing,\nso can't I just pick one and be done?\n\n555\n00:28:41.870 --> 00:28:47.180\nYou can, but if you do all three,\neach one has like little things\n\n556\n00:28:47.180 --> 00:28:51.250\nthat they don't cover, and if you do all\nthree of them you get complete coverage.\n\n557\n00:28:51.250 --> 00:28:52.650\nAnd it gets you the best solution.\n\n558\n00:28:52.650 --> 00:28:55.440\nAnd they're all working off\nthat DHCP snooping database,\n\n559\n00:28:55.440 --> 00:28:57.560\nwhich makes them kind of all tie together.\n\n560\n00:28:57.560 --> 00:29:00.410\nAnd your switch has\nthe hardware to support this.\n\n561\n00:29:00.410 --> 00:29:01.570\nUse these features.\n\n562\n00:29:01.570 --> 00:29:05.620\nIf you're using these features,\nIP spoofing,\n\n563\n00:29:05.620 --> 00:29:10.950\nMac spoofing, ARP spoofing,\nrogue DHCP, DHCP starvation.\n\n564\n00:29:10.950 --> 00:29:14.640\nAll these attacks that you read about\nare no longer possible on your network.\n\n565\n00:29:14.640 --> 00:29:15.740\nYou've stopped it.\n\n566\n00:29:15.740 --> 00:29:18.560\nYou don't even have to, I mean,\nyou still wanna secure your endpoints,\n\n567\n00:29:18.560 --> 00:29:19.220\nyour servers and stuff.\n\n568\n00:29:19.220 --> 00:29:21.870\nBut you don't necessarily have to because\nthe attacks aren't even possible in\n\n569\n00:29:21.870 --> 00:29:23.030\nthe first place, right?\n\n570\n00:29:23.030 --> 00:29:26.410\nSo that's kinda the glory of this if\nwe get it configured on our switches.\n\n571\n00:29:26.410 --> 00:29:29.890\nAnd on our access switches, where people\nare plugging in their laptops and\n\n572\n00:29:29.890 --> 00:29:32.550\ndesktops and stuff,\nthat's where we want all this protection.\n\n573\n00:29:32.550 --> 00:29:33.890\nOn your core distribution switches,\n\n574\n00:29:33.890 --> 00:29:37.180\nyou might leave all this off,\njust to get the best performance possible.\n\n575\n00:29:37.180 --> 00:29:39.990\nThen on your access switches, that's\nwhere this stuff comes in really handy.\n\n576\n00:29:39.990 --> 00:29:41.610\n>> Yeah,\nnot using this is like having a vault and\n\n577\n00:29:41.610 --> 00:29:43.921\nputting all your money on top of it,\ninstead of inside of it.\n\n578\n00:29:43.921 --> 00:29:46.770\n>> [LAUGH]\n>> You've got the feature to secure it up,\n\n579\n00:29:46.770 --> 00:29:48.298\nmight as well implement it.\n\n580\n00:29:48.298 --> 00:29:50.106\nUse it.\nLet it secure you up, right?\n\n581\n00:29:50.106 --> 00:29:50.800\n>> Absolutely.\n\n582\n00:29:50.800 --> 00:29:51.970\nAbsolutely.\n\n583\n00:29:51.970 --> 00:29:54.670\nDaniel, that is certainly\nnot the last of the security\n\n584\n00:29:54.670 --> 00:29:56.050\nfeatures on the switch\nthat we want to cover.\n\n585\n00:29:56.050 --> 00:29:57.180\nBut, I know we're running low on time.\n\n586\n00:29:57.180 --> 00:30:00.920\nI want to jump into some other\nones that don't use DHCP snooping.\n\n587\n00:30:00.920 --> 00:30:04.250\nOur first two episodes covered stuff\nthat tied around that database.\n\n588\n00:30:04.250 --> 00:30:07.070\nBut there's plenty of other ways\nto implement security on our\n\n589\n00:30:07.070 --> 00:30:08.920\nswitches that we're\ngoing to take a look at.\n\n590\n00:30:08.920 --> 00:30:10.390\nAs we journey in to part three, and\n\n591\n00:30:10.390 --> 00:30:12.870\nmore than likely in to part\nfour cuz I can't shut up.\n\n592\n00:30:12.870 --> 00:30:15.560\n>> [LAUGH] Hey, well we all love\noptions for security, right?\n\n593\n00:30:15.560 --> 00:30:17.500\nAnything we can do to help ourselves,\n\n594\n00:30:17.500 --> 00:30:19.670\nkeep ourselves out of the weeds,\nI'm all about that.\n\n595\n00:30:19.670 --> 00:30:24.479\nSo I'm looking forward to part three and\nmaybe even part 4000, knowing Don.\n\n596\n00:30:24.479 --> 00:30:25.729\nAll right Don, well, we'll call it a day.\n\n597\n00:30:25.729 --> 00:30:27.271\nThanks for those great demonstrations.\n\n598\n00:30:27.271 --> 00:30:28.271\nThank you for watching.\n\n599\n00:30:28.271 --> 00:30:30.021\nSigning off for ITProTV.\n\n600\n00:30:30.021 --> 00:30:31.478\nI've been your host Daniel Lowrie.\n\n601\n00:30:31.478 --> 00:30:32.354\n>> And I'm Don Pezet.\n\n602\n00:30:32.354 --> 00:30:33.979\n>> And we'll see you next time.\n\n603\n00:30:33.979 --> 00:30:40.200\n[SOUND]\n\n",
          "vimeoId": "141782682"
        },
        {
          "description": "In this episode, Daniel and Don continue switch security, this time tackling port security for more granular control over what devices can access specific ports and disabling any ports experiencing unauthorized access. They then move into how to recover disabled ports back to working order using Err-Disable Recovery and finishing up with VLAN Access Control Lists.",
          "length": "1864",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt3-100615-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt3-100615-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt3-100615-1-sm.jpg",
          "title": "Switch Security Part 3",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC].\n\n2\n00:00:11.924 --> 00:00:16.181\nAll right, greetings everyone, welcome to\nanother exciting episode of IT Pro TV.\n\n3\n00:00:16.181 --> 00:00:17.631\nI'm your host Daniel Lowry,\n\n4\n00:00:17.631 --> 00:00:21.821\njoining me on the show today well is a man\nthat needs no introduction, Mr. Don Pezet.\n\n5\n00:00:21.821 --> 00:00:22.740\nHow's it going today Don?\n\n6\n00:00:22.740 --> 00:00:23.920\n>> It is going great Daniel,\n\n7\n00:00:23.920 --> 00:00:27.330\nand back again for part three of our\nswitch security features episode.\n\n8\n00:00:27.330 --> 00:00:30.680\nWe've seen a lot of bells and\nwhistles and features and\n\n9\n00:00:30.680 --> 00:00:33.950\nall sorts of stuff throughout these\ntwo episodes we've done so far.\n\n10\n00:00:33.950 --> 00:00:36.036\n>> Starting to feel like\na Highlander series or something.\n\n11\n00:00:36.036 --> 00:00:39.330\n>> [LAUGH] Which episode is the one\nwe're gonna forget about and\n\n12\n00:00:39.330 --> 00:00:40.230\npretend doesn't exist?\n\n13\n00:00:40.230 --> 00:00:44.150\nSo, So in this episode that we're gonna\ncontinue on and take a look at some\n\n14\n00:00:44.150 --> 00:00:47.180\nother security features that are,\nagain, just built into the switch.\n\n15\n00:00:47.180 --> 00:00:49.660\nWe just have to turn them\non if we want to use them.\n\n16\n00:00:49.660 --> 00:00:52.770\nAnd I wanna take us down memory lane for\na minute.\n\n17\n00:00:52.770 --> 00:00:55.640\nWe're gonna step back and we're going to\ntake a look at something we learned about\n\n18\n00:00:55.640 --> 00:00:58.570\nback in the CC and A level which\nwe should have learned about,\n\n19\n00:00:58.570 --> 00:01:01.910\nsomething called switch port,\nport security.\n\n20\n00:01:01.910 --> 00:01:02.557\nAll right,\n\n21\n00:01:02.557 --> 00:01:06.660\non a system switch all of your ports\nthat are configured is a switch board.\n\n22\n00:01:06.660 --> 00:01:10.260\nYou can have a level three switch\nthan can be configured as routers.\n\n23\n00:01:10.260 --> 00:01:11.030\nRight?\n\n24\n00:01:11.030 --> 00:01:14.110\nBut on the ones that\nare configured as switchboards,\n\n25\n00:01:14.110 --> 00:01:17.920\nthose guys we can turn on\na technology called port security.\n\n26\n00:01:17.920 --> 00:01:21.760\nAnd since this is our security feature\nshow it makes sense, this one being here,\n\n27\n00:01:21.760 --> 00:01:26.720\nit's a great way that we can do\nwell one of two things really.\n\n28\n00:01:26.720 --> 00:01:31.000\nOne we can restrict a port\nto a particular MAC address,\n\n29\n00:01:31.000 --> 00:01:34.990\nagain another great way to kind\nof stop MAC address spoofing.\n\n30\n00:01:34.990 --> 00:01:38.256\nOr we can limit the number of Mac\naddresses that are allowed to be\n\n31\n00:01:38.256 --> 00:01:39.673\nsimultaneously on a port,\n\n32\n00:01:39.673 --> 00:01:42.877\nwhich can help prevent people\nbringing switches from home and\n\n33\n00:01:42.877 --> 00:01:47.055\nplugging them in and adding more computers\nto your network than what you allow.\n\n34\n00:01:47.055 --> 00:01:50.070\nRight?\nIf you've got a voiceover IP phone, and\n\n35\n00:01:50.070 --> 00:01:52.320\nyou know it's got two jacks on it,\na in and out.\n\n36\n00:01:52.320 --> 00:01:55.080\nA lot of them do, so\nyou can daisy chain your computer off it.\n\n37\n00:01:55.080 --> 00:01:57.310\nBut you don't want people\nto use that feature.\n\n38\n00:01:57.310 --> 00:02:00.440\nYou could set that port to have\na maximum one MAC address.\n\n39\n00:02:00.440 --> 00:02:03.330\nAnd if anybody ever plugged\na second device into that phone,\n\n40\n00:02:03.330 --> 00:02:06.270\nthat would be a second MAC address, and\nit wouldn't be allowed to communicate.\n\n41\n00:02:06.270 --> 00:02:07.560\nIt'd be stopped, right?\n\n42\n00:02:07.560 --> 00:02:11.780\nThat's what port security allows us to do,\nand it's really effective.\n\n43\n00:02:11.780 --> 00:02:15.810\nIt's just a little cumbersome to get\nconfigured and kind of put in place.\n\n44\n00:02:15.810 --> 00:02:17.720\nSo I wanna show you guys that,\nkinda how it works,\n\n45\n00:02:17.720 --> 00:02:21.190\nwhat we can do with it, and you'll see\nit's a pretty straightforward practice.\n\n46\n00:02:21.190 --> 00:02:24.680\nMost of you guys have already seen\nthis one, so for those of you,\n\n47\n00:02:24.680 --> 00:02:26.100\nit's more of a refresher.\n\n48\n00:02:26.100 --> 00:02:28.870\nBut it's on the exam, so\nsomething we wanna learn.\n\n49\n00:02:28.870 --> 00:02:32.370\nSo I'll just take my core switch here and\nwe'll jump in and kinda see one of those\n\n50\n00:02:32.370 --> 00:02:36.450\nquick configurations If I take\na look at it here, I've got.\n\n51\n00:02:36.450 --> 00:02:42.180\nWe'll target that same router that I've\nbeen messing with this whole series.\n\n52\n00:02:42.180 --> 00:02:43.520\nOn my port fa1/0/2.\n\n53\n00:02:43.520 --> 00:02:46.310\nThat port has a connection to a router.\n\n54\n00:02:46.310 --> 00:02:49.370\nAnd that router is up and\nrunning, you know?\n\n55\n00:02:49.370 --> 00:02:50.910\nIt's the one that we were\ndoing ARP inspection, and\n\n56\n00:02:50.910 --> 00:02:52.540\nall those other things on earlier.\n\n57\n00:02:52.540 --> 00:02:56.110\nAnd it's just, it's a regular old system,\nit's out there.\n\n58\n00:02:56.110 --> 00:02:58.110\nIt's got an IP address and\nit's communicating.\n\n59\n00:02:58.110 --> 00:03:00.200\nAnd I wanna make sure that it's\nthe only one that's there.\n\n60\n00:03:00.200 --> 00:03:02.600\nNow, we normally configure\nthis on access ports,\n\n61\n00:03:02.600 --> 00:03:04.930\nyou don't normally do\nport security on a trunk.\n\n62\n00:03:04.930 --> 00:03:07.320\nBecause a trunk, well it,\n\n63\n00:03:07.320 --> 00:03:11.400\na trunk is going to have more than one\nMAC that's on it pretty normally, right?\n\n64\n00:03:11.400 --> 00:03:12.440\nEven an uplink well, right?\n\n65\n00:03:12.440 --> 00:03:13.800\nYou can spot those really easy.\n\n66\n00:03:13.800 --> 00:03:17.650\nIf you do a,\nshow mac address table, right?\n\n67\n00:03:17.650 --> 00:03:19.530\nWhen you look at your MAC address table,\nyou'll see,\n\n68\n00:03:19.530 --> 00:03:22.220\nwell you'll see all the static ones for\nthe switchboards, right?\n\n69\n00:03:22.220 --> 00:03:24.540\nBut after that, you'll see your dynamics.\n\n70\n00:03:24.540 --> 00:03:26.600\nAnd you can spot uplinks really easy.\n\n71\n00:03:26.600 --> 00:03:28.950\nBecause you'll have more than one port.\n\n72\n00:03:28.950 --> 00:03:32.280\nOh sorry, one port with more than one MAC\naddress if you are seeing more than one\n\n73\n00:03:32.280 --> 00:03:35.510\nMAC address what does that mean it usually\nmeans that someone brought a switch or\n\n74\n00:03:35.510 --> 00:03:39.080\na hub and stuck it on the end and that's\nwhy you are seeing more than one mac\n\n75\n00:03:39.080 --> 00:03:41.680\naddress, but\nthis is an uplink to one of my switches so\n\n76\n00:03:41.680 --> 00:03:43.990\nI know that's a trunk\nits going to have that.\n\n77\n00:03:43.990 --> 00:03:46.650\nNow, it's not necessarily a trunk,\nit could just be an uplink.\n\n78\n00:03:46.650 --> 00:03:49.740\nThe difference is a trunk carries\nmore than one VLAN, right?\n\n79\n00:03:49.740 --> 00:03:53.860\nI'm only seeing VLAN1 over here, if I\nsaw more than one VLAN on the same port,\n\n80\n00:03:53.860 --> 00:03:54.960\nI would know it was a trunk.\n\n81\n00:03:54.960 --> 00:03:58.740\nThat's the only time, you should\nsee more than one VLAN on a port.\n\n82\n00:03:58.740 --> 00:04:03.190\nSo, if I want to take a port and lock it\ndown, like fa1/0/2, that's an access port.\n\n83\n00:04:03.190 --> 00:04:07.620\nI've got a router on the other end of it,\nbut let's just say it's a workstation.\n\n84\n00:04:07.620 --> 00:04:11.090\nAnd I only want that one MAC address\nto be able to communicate there.\n\n85\n00:04:11.090 --> 00:04:12.650\nWell, I can go in and I can limit it.\n\n86\n00:04:12.650 --> 00:04:14.640\nOr maybe it's not even\nabout being specific.\n\n87\n00:04:14.640 --> 00:04:16.580\nI just don't want more\nthan one MAC address.\n\n88\n00:04:16.580 --> 00:04:20.530\nI just want it to be held to one system\nand it can't plug in a hub, right?\n\n89\n00:04:20.530 --> 00:04:21.560\nOr switch.\n\n90\n00:04:21.560 --> 00:04:23.000\nSo, I can jump into my configuration.\n\n91\n00:04:23.000 --> 00:04:29.840\nI can get into fa1/0/2 and I can come\nin here and I can tell it, switchport.\n\n92\n00:04:29.840 --> 00:04:31.800\nWell, I do need to make sure\nit's an access port here.\n\n93\n00:04:31.800 --> 00:04:35.130\nSo I'll do a switchboard mode access\njust to make sure, it already is.\n\n94\n00:04:35.130 --> 00:04:39.074\nAnd then I'll say\nswitchport port-security.\n\n95\n00:04:40.130 --> 00:04:42.780\nANd then how I want to configure\nthis is kind of up to me.\n\n96\n00:04:42.780 --> 00:04:45.830\nIf I am just trying to stop\npeople from bringing in switches.\n\n97\n00:04:45.830 --> 00:04:47.130\nI can just say maximum one.\n\n98\n00:04:48.140 --> 00:04:50.960\nAnd that's going to set it so\nthat this port,\n\n99\n00:04:50.960 --> 00:04:56.060\nif it ever has more than one MAC address\nthat's going to create a violation.\n\n100\n00:04:56.060 --> 00:04:58.700\nAnd I just need to add a little more\nto finish this off before it actually\n\n101\n00:04:58.700 --> 00:04:59.440\nworks, right.\n\n102\n00:04:59.440 --> 00:05:03.440\nI need to say, switchport, port-security,\n\n103\n00:05:03.440 --> 00:05:06.900\nviolation, and\nwhat do I want to do about it, right?\n\n104\n00:05:06.900 --> 00:05:09.740\nSo somebody brings in a switch,\nwhat am I gonna do?\n\n105\n00:05:09.740 --> 00:05:11.630\nI got a few choices, right?\n\n106\n00:05:11.630 --> 00:05:14.650\nMy choices boil down to,\njust down to three, right?\n\n107\n00:05:14.650 --> 00:05:15.620\nProtect.\n\n108\n00:05:15.620 --> 00:05:20.220\nProtect means I want to stop\nthis from happening, right?\n\n109\n00:05:20.220 --> 00:05:26.540\nSo if somebody jumps in and has more than\none MAC address, I want to know about it.\n\n110\n00:05:26.540 --> 00:05:29.250\nProtect me as I'm gonna get\na little warning about it.\n\n111\n00:05:29.250 --> 00:05:32.720\nBut even though it says protect\nit doesn't actually do anything.\n\n112\n00:05:32.720 --> 00:05:36.670\nIt doesn't stop them it still lets\nthe extra MAC addresses get on there, but\n\n113\n00:05:36.670 --> 00:05:39.170\nI at least know about it.\n\n114\n00:05:39.170 --> 00:05:40.300\nAll right.\nRestrict.\n\n115\n00:05:40.300 --> 00:05:45.260\nThat says I'm gonna let the first\nMAC address continue to work, but\n\n116\n00:05:45.260 --> 00:05:47.890\nthe second and third and fourth, and\nhowever many other MAC addresses,\n\n117\n00:05:47.890 --> 00:05:50.630\nI'm gonna stop them,\nI'm actually going to restrict them.\n\n118\n00:05:50.630 --> 00:05:52.140\nThat's a little more aggressive.\n\n119\n00:05:52.140 --> 00:05:53.490\nThe original host can still talk but\n\n120\n00:05:53.490 --> 00:05:56.260\nwhen they put that switch in,\nthe other host won't be able to.\n\n121\n00:05:56.260 --> 00:05:58.590\nThey get a little more protection.\n\n122\n00:05:58.590 --> 00:05:59.750\nBut my favorite?\n\n123\n00:05:59.750 --> 00:06:00.640\nShut down.\n\n124\n00:06:00.640 --> 00:06:03.940\nSo if another MAC address\nshows up on this board, or\n\n125\n00:06:03.940 --> 00:06:07.250\nmore than one MAC address in this\ncase I'm gonna shut that port down,\n\n126\n00:06:07.250 --> 00:06:09.820\nand then it's gonna stay shut down\nuntil I do something about it.\n\n127\n00:06:09.820 --> 00:06:10.800\nThat's how I'm gonna configure this one.\n\n128\n00:06:10.800 --> 00:06:12.300\nI'm just gonna say shutdown.\n\n129\n00:06:12.300 --> 00:06:14.850\nAnd so if we get a violation that's it,\nand I've got one more command I need to\n\n130\n00:06:14.850 --> 00:06:20.500\nthrow in there, which is switchport\nport-security and just press enter.\n\n131\n00:06:20.500 --> 00:06:21.330\nI forget this one all the time.\n\n132\n00:06:21.330 --> 00:06:23.080\nThis one actually turns the stuff on.\n\n133\n00:06:23.080 --> 00:06:24.060\nRight?\nSo, I was\n\n134\n00:06:24.060 --> 00:06:26.260\nadding configuration options before.\n\n135\n00:06:26.260 --> 00:06:30.510\nBut that last command is what\nactually gets it up and running and\n\n136\n00:06:30.510 --> 00:06:34.250\nat this point that port is now monitoring.\n\n137\n00:06:34.250 --> 00:06:38.300\nAnd if it sees more than one MAC address\nit's going to take some action and\n\n138\n00:06:38.300 --> 00:06:40.590\nI don't see a lot of that in my config,\nright?\n\n139\n00:06:40.590 --> 00:06:41.980\nWhere'd those commands go?\n\n140\n00:06:41.980 --> 00:06:45.300\nWell maximum one is the default.\n\n141\n00:06:45.300 --> 00:06:47.160\nAnd shutdown is the default and\n\n142\n00:06:47.160 --> 00:06:49.570\nsince they're defaults that's\nwhy they don't show up here.\n\n143\n00:06:49.570 --> 00:06:50.928\nIf I had put the other values they would.\n\n144\n00:06:50.928 --> 00:06:52.910\nBut switchport port-security\nto turn it on?\n\n145\n00:06:52.910 --> 00:06:56.150\nThat's not a default, and so\nthat's why that one stayed.\n\n146\n00:06:56.150 --> 00:06:57.520\nPort security's now on for this port.\n\n147\n00:06:57.520 --> 00:06:59.040\n>> Yeah, now, Don,\nthat sounds really cool.\n\n148\n00:06:59.040 --> 00:07:01.980\nI like the way I've got\nsomething plugged into a port,\n\n149\n00:07:01.980 --> 00:07:04.900\nI've limited it to one\ndevice on that port.\n\n150\n00:07:04.900 --> 00:07:08.100\nOnce that thing gets learned,\nanything else comes in,\n\n151\n00:07:08.100 --> 00:07:09.450\ntries to give me other stuff.\n\n152\n00:07:09.450 --> 00:07:13.650\nThe access in that port is just gonna\nshut it off and that's the way I like it.\n\n153\n00:07:13.650 --> 00:07:16.900\nBut, what if the first thing to to\nplug in isn't what I want it to be.\n\n154\n00:07:16.900 --> 00:07:18.690\nWhat if I accidentally\nleft something plugged in?\n\n155\n00:07:18.690 --> 00:07:22.170\nAnd they're like now it's all shut down,\nI got a lot of configuration to do,\n\n156\n00:07:22.170 --> 00:07:26.070\nhow can I make it say this\nis the device regardless?\n\n157\n00:07:26.070 --> 00:07:26.580\n>> Great point.\n\n158\n00:07:26.580 --> 00:07:29.610\nSo the problem with how I've\nconfigured it here is I said\n\n159\n00:07:29.610 --> 00:07:32.240\nit's got to be a maximum of\none MAC address all right?\n\n160\n00:07:32.240 --> 00:07:36.640\nWell if an attacker comes in and\nun-plugs a computer, the port goes down.\n\n161\n00:07:36.640 --> 00:07:40.300\nAnd when the port goes down,\nthe MAC address table entry for\n\n162\n00:07:40.300 --> 00:07:41.160\nit is immediately cleared.\n\n163\n00:07:41.160 --> 00:07:42.060\nIt doesn't even wait for a timer.\n\n164\n00:07:42.060 --> 00:07:42.930\nIt just clears it.\n\n165\n00:07:42.930 --> 00:07:43.500\nRight?\n\n166\n00:07:43.500 --> 00:07:46.800\nSo, when they plug in their computer,\nthey're the attacker.\n\n167\n00:07:46.800 --> 00:07:48.235\nIt's just one MAC address.\n\n168\n00:07:48.235 --> 00:07:50.865\nThat's going to pass and\nport security is not going to stop them.\n\n169\n00:07:50.865 --> 00:07:54.308\nBut what Daniel was saying was what\nif I want it to be one Mac address\n\n170\n00:07:54.308 --> 00:07:55.632\nspecifically, right?\n\n171\n00:07:55.632 --> 00:08:00.268\nWell, if I know the Mac address I can\ncome in here and I can punch it in.\n\n172\n00:08:00.268 --> 00:08:05.124\nSo when I looked at my MAC address table,\nway back when I got started, here.\n\n173\n00:08:05.124 --> 00:08:10.250\nOn Fa1/0/2, this right here was\nthe MAC address of that router, right?\n\n174\n00:08:10.250 --> 00:08:14.510\nSo if I have it, or if you haven't pulled\nit up, I usually do something like this,\n\n175\n00:08:14.510 --> 00:08:17.250\njust do a do command,\nshow mac address table.\n\n176\n00:08:19.300 --> 00:08:21.150\nAnd I usually do it\na little more gracefully.\n\n177\n00:08:21.150 --> 00:08:26.777\nAnd then I just filter it to include\nthe 1/0/22, the port that I'm looking for.\n\n178\n00:08:26.777 --> 00:08:28.577\nOh sorry, /2.\n\n179\n00:08:28.577 --> 00:08:32.350\nOh, shoot, it's gonna get,\nhow can we stop that?\n\n180\n00:08:32.350 --> 00:08:33.813\nOh, we can't.\n\n181\n00:08:33.813 --> 00:08:35.158\nWell, any how.\nYou guys can see it right there.\n\n182\n00:08:35.158 --> 00:08:37.435\n[LAUGH] So we can get that MAC address and\nwe can pull it up.\n\n183\n00:08:37.435 --> 00:08:40.095\nOr if I know that it ends in fec0,\nI can filter.\n\n184\n00:08:40.095 --> 00:08:43.300\nYou can filter various ways to try and\nget just the one that you want.\n\n185\n00:08:43.300 --> 00:08:44.195\nThere we go.\n\n186\n00:08:44.195 --> 00:08:49.515\nAnd so on the port, I can come in here and\nI can say, switchport port-security,\n\n187\n00:08:49.515 --> 00:08:52.891\nand then you can manually\nspecify the MAC address.\n\n188\n00:08:52.891 --> 00:08:59.033\nAnd so I can say mac-address 7c0e, and\nI can go in and I can type it, all right?\n\n189\n00:08:59.033 --> 00:09:05.220\nAnd if I manually set it,\nI set a maximum of one addresses.\n\n190\n00:09:05.220 --> 00:09:09.741\nAnd I'm manually setting that address\nright here so I'm already at my maximum.\n\n191\n00:09:09.741 --> 00:09:12.643\nAnd if somebody unplugs that cable,\nthe port goes down,\n\n192\n00:09:12.643 --> 00:09:16.830\nthe MAC address table empties,\nthis command will still be there.\n\n193\n00:09:16.830 --> 00:09:21.010\nAnd so when they plug their computer in,\nthis MAC address is there, and\n\n194\n00:09:21.010 --> 00:09:23.790\nnow their MAC address is there,\nand they're in violation.\n\n195\n00:09:23.790 --> 00:09:28.739\nSo now we know it, it's there,\nI just have to finish out this command and\n\n196\n00:09:28.739 --> 00:09:30.941\nit'll be set in stone, right?\n\n197\n00:09:30.941 --> 00:09:34.330\nThat's the MAC address that's\nallowed to talk on that port.\n\n198\n00:09:35.710 --> 00:09:39.543\nNow, when I ran it, I got found\na duplicate MAC address, Right?\n\n199\n00:09:39.543 --> 00:09:40.360\nWhat's that about?\n\n200\n00:09:40.360 --> 00:09:43.440\nWell it's already learned that\nMAC address in this port and\n\n201\n00:09:43.440 --> 00:09:46.690\nit's dynamic, I'm kind of like\nstatically defining it here, right?\n\n202\n00:09:46.690 --> 00:09:50.610\nSo, I probably need to shut the port down\nto clear it, and then put this in and\n\n203\n00:09:50.610 --> 00:09:51.920\nturn the port back on.\n\n204\n00:09:51.920 --> 00:09:54.304\nThat router has this MAC address,\nat least I hope it does, and so\n\n205\n00:09:54.304 --> 00:09:57.150\nthen it should be able to get in there and\ncommunicate.\n\n206\n00:09:57.150 --> 00:10:00.070\nBut this does bring up a good\nopportunity to show something else,\n\n207\n00:10:00.070 --> 00:10:01.588\none of the neater features.\n\n208\n00:10:01.588 --> 00:10:04.850\nIf you're rolling this out for\njust one system it's no big deal, but\n\n209\n00:10:04.850 --> 00:10:06.490\nwhere do we really need this feature?\n\n210\n00:10:06.490 --> 00:10:08.311\nWe need it on our access ports.\n\n211\n00:10:08.311 --> 00:10:11.190\nAnd in a large environment you might\nhave thousands of access ports.\n\n212\n00:10:11.190 --> 00:10:15.130\nYou might have tons of computers,\ncomputers that are getting replaced under\n\n213\n00:10:15.130 --> 00:10:17.970\nwarranty or upgraded,\nand these things change.\n\n214\n00:10:17.970 --> 00:10:22.150\nSo statically entering in these MAC\naddresses gets old really fast.\n\n215\n00:10:22.150 --> 00:10:26.110\nSo if you don't like to do that, you can\nactually tell the switch to learn the MAC\n\n216\n00:10:26.110 --> 00:10:28.560\naddress that's on there, then you don't\nhave to worry about this duplicate stuff,\n\n217\n00:10:28.560 --> 00:10:31.110\ncuz it's just gonna learn it and\nput it into the table, right?\n\n218\n00:10:31.110 --> 00:10:34.020\nSo I can come in here and\nrun the command a little bit differently.\n\n219\n00:10:34.020 --> 00:10:38.746\nWhen I said switchport port-security\nmac-address, if you do a question mark\n\n220\n00:10:38.746 --> 00:10:43.047\nafter mac-address, you'll see where\nyou can type in the MAC address or\n\n221\n00:10:43.047 --> 00:10:45.816\nyou can just type the word sticky,\nall right?\n\n222\n00:10:45.816 --> 00:10:47.320\nSticky, It's a neat command.\n\n223\n00:10:47.320 --> 00:10:49.970\nWhen you run sticky, that tells the port,\n\n224\n00:10:49.970 --> 00:10:54.400\nlook at whatever MAC address is on\nthere right now and just learn it.\n\n225\n00:10:54.400 --> 00:10:56.120\nStick in the table, all right?\n\n226\n00:10:56.120 --> 00:10:58.670\nAnd that way it becomes\nas if you typed it in.\n\n227\n00:10:58.670 --> 00:11:02.900\nIf you know the right computer\nis plugged into there right now,\n\n228\n00:11:02.900 --> 00:11:06.850\nyou can just use the sticky option and\nit'll learn that and put it in.\n\n229\n00:11:07.950 --> 00:11:12.320\nNow, if nothing is plugged into it and\nyou do a show run for\n\n230\n00:11:12.320 --> 00:11:15.100\nthat interface,\nyou'll see that sticky command.\n\n231\n00:11:15.100 --> 00:11:19.338\nBut if something is plugged into it,\nyou'll see it like this.\n\n232\n00:11:19.338 --> 00:11:22.728\nswitchport port-security\nmac-address sticky, and\n\n233\n00:11:22.728 --> 00:11:25.617\nthen there's the MAC\naddress that it learned.\n\n234\n00:11:25.617 --> 00:11:27.300\nAnd there's two good parts about this.\n\n235\n00:11:27.300 --> 00:11:30.940\nOne, if I reboot, it stays there, right?\n\n236\n00:11:30.940 --> 00:11:32.490\nSo it'll survive a reboot on the switch.\n\n237\n00:11:32.490 --> 00:11:35.524\nAnd two, I didn't have to type it\nbecause you guys have see me type,\n\n238\n00:11:35.524 --> 00:11:36.865\nI'm terrible at this stuff.\n\n239\n00:11:36.865 --> 00:11:37.400\n>> [LAUGH]\n>> So\n\n240\n00:11:37.400 --> 00:11:40.580\nthis really makes that a lot easier,\nand now it's punched in there.\n\n241\n00:11:40.580 --> 00:11:43.720\nSo if I define a maximum one MAC address,\nand I use the sticky option,\n\n242\n00:11:43.720 --> 00:11:45.190\nit's gonna learn that MAC.\n\n243\n00:11:45.190 --> 00:11:48.450\nIf I did a maximum of two,\nit would learn two, or however many, and\n\n244\n00:11:48.450 --> 00:11:51.270\nget those put in there, and\nnow it's gonna remember them.\n\n245\n00:11:51.270 --> 00:11:54.687\nAnd I don't have to go and type it now,\nonly if somebody replaces a computer or\n\n246\n00:11:54.687 --> 00:11:57.546\nreplaces a network card do I have\nto come in here and clear it out.\n\n247\n00:11:57.546 --> 00:11:59.010\nAnd then it'll relearn the new one.\n\n248\n00:11:59.010 --> 00:12:00.900\n>> I like that,\ncuz there if is one thing I hate to do,\n\n249\n00:12:00.900 --> 00:12:03.290\nit's trying to figure out what\nthe stinking MAC address is to something.\n\n250\n00:12:03.290 --> 00:12:06.790\nI just want to plug the thing in and\ngo, I know this is the right device for\n\n251\n00:12:06.790 --> 00:12:07.900\nthis port.\n\n252\n00:12:07.900 --> 00:12:10.549\nIt just makes it a little bit easier for\nme to be lazy, and thank you so much.\n\n253\n00:12:10.549 --> 00:12:12.190\n[LAUGH]\n>> Now,\n\n254\n00:12:12.190 --> 00:12:14.350\nI've got a router plugged in\non the other side of this and\n\n255\n00:12:14.350 --> 00:12:18.230\nI cant really change the router's\nIP address, I mean the MAC address.\n\n256\n00:12:18.230 --> 00:12:22.530\nSo there's not a great way, but\nthere are a few ways you could try.\n\n257\n00:12:22.530 --> 00:12:27.440\nSo if I wanna turn this off,\nif I do a no switchport port-security,\n\n258\n00:12:27.440 --> 00:12:29.550\nand I'll just wipe that out.\n\n259\n00:12:29.550 --> 00:12:34.250\nAnd if you take a look at the interface,\nand\n\n260\n00:12:34.250 --> 00:12:36.710\nwe look,\nsee how those commands kinda survived?\n\n261\n00:12:36.710 --> 00:12:39.620\nSo if you want to kind of reset or\nreprogram an interface,\n\n262\n00:12:39.620 --> 00:12:42.360\nyou kind of have to undo\na lot of the easier cells.\n\n263\n00:12:42.360 --> 00:12:46.390\nBut I'm gonna turn off that sticky mode.\n\n264\n00:12:46.390 --> 00:12:51.010\nAnd we'll get rid of that, and\neven turning off the sticky mode,\n\n265\n00:12:51.010 --> 00:12:53.240\nif I take a look at the interface,\nthere we go.\n\n266\n00:12:53.240 --> 00:12:55.790\nNow it's cleared off and\nit's removed and I can come in and\n\n267\n00:12:55.790 --> 00:12:56.640\nI can put in a static one.\n\n268\n00:12:56.640 --> 00:12:59.250\nI'm gonna put in the wrong address, right?\n\n269\n00:12:59.250 --> 00:13:04.874\nSo, I'm gonna shut this one down,\nand then I'm gonna do a switchport\n\n270\n00:13:04.874 --> 00:13:08.950\nport-security maximum 1,\n\n271\n00:13:08.950 --> 00:13:11.950\nwhich was the default,\ndidn't really have to put that in there.\n\n272\n00:13:11.950 --> 00:13:14.850\nAnd the violation is shut down so\nI don't really have to put that one in.\n\n273\n00:13:14.850 --> 00:13:19.120\nI can say switchport\nport-security to turn it on and\n\n274\n00:13:19.120 --> 00:13:23.973\nI'm gonna say switchport\nport-security mac-address,\n\n275\n00:13:23.973 --> 00:13:28.254\nand I'm just going to put\nin a fake address, right?\n\n276\n00:13:28.254 --> 00:13:33.989\nLike, AAAA.BBBB.CCCC, right,\njust a fake MAC address.\n\n277\n00:13:33.989 --> 00:13:39.176\nSo when I do that and I take a look at\nmy configuration now, I've got that\n\n278\n00:13:39.176 --> 00:13:44.730\nfake MAC address binded to it, and\nI've got that maximum of 1 MAC address.\n\n279\n00:13:44.730 --> 00:13:50.460\nAnd, if I do a, just a show port-security,\n\n280\n00:13:50.460 --> 00:13:53.410\nand take a look at my summary,\nI can see where its turned on.\n\n281\n00:13:53.410 --> 00:13:58.380\nIts got a maximum secure address account\nof 1 and its not violated right now.\n\n282\n00:13:58.380 --> 00:14:01.620\nOkay, and it's got a maximum of 1, and\n\n283\n00:14:01.620 --> 00:14:05.810\nit's already got 1 address because\nthe static mapping that I did.\n\n284\n00:14:05.810 --> 00:14:10.385\nNow, if I do a no shut down, that router\nis gonna wake back up, and try and\n\n285\n00:14:10.385 --> 00:14:11.663\nget a DACP address.\n\n286\n00:14:11.663 --> 00:14:14.859\nAnd its MAC address doesn't match,\nand so it gets caught, or\n\n287\n00:14:14.859 --> 00:14:19.320\nat least it will get caught here shortly,\nand port security's gonna nail it.\n\n288\n00:14:19.320 --> 00:14:22.470\nAnd it's gonna flag that port as off,\nall right.\n\n289\n00:14:22.470 --> 00:14:25.990\nNow you won't normally see a down message.\n\n290\n00:14:25.990 --> 00:14:27.531\nSee how I'm not getting that down message?\n\n291\n00:14:27.531 --> 00:14:31.950\nBut if I do a show port-security, there\nwas the message, it just went right by.\n\n292\n00:14:31.950 --> 00:14:34.070\nAnd there's the down appearing after it.\n\n293\n00:14:34.070 --> 00:14:36.640\nBut there's that port\nsecurity message coming up.\n\n294\n00:14:36.640 --> 00:14:40.200\nAnd if I look at my show\nport-security output,\n\n295\n00:14:40.200 --> 00:14:45.040\nI can see that I've got a violation\ncount of one and it shut the port down.\n\n296\n00:14:45.040 --> 00:14:48.170\nSo, it's in a shutdown state and\nthat port can't communicate.\n\n297\n00:14:49.380 --> 00:14:52.420\nNow it's going to stay shutdown forever,\n\n298\n00:14:52.420 --> 00:14:57.740\nuntil I go in and fix the MAC address\nproblem or remove the attacking machine.\n\n299\n00:14:57.740 --> 00:15:01.023\nAnd then you have to shut the port down\nand do a no shut down to bring it back up.\n\n300\n00:15:01.023 --> 00:15:01.970\nAnd it's back up and going.\n\n301\n00:15:01.970 --> 00:15:03.230\nSo if somebody violates this,\n\n302\n00:15:03.230 --> 00:15:06.520\nif somebody swaps out a computer,\nit's gonna get red flagged.\n\n303\n00:15:06.520 --> 00:15:10.370\nAnd the helpdesk team, at a minimum,\nis gonna have to get involved to fix it.\n\n304\n00:15:10.370 --> 00:15:13.260\nWhich means you will definitely be\naware that something happened that\n\n305\n00:15:13.260 --> 00:15:14.450\nshouldn't happen.\n\n306\n00:15:14.450 --> 00:15:16.000\n>> Now Don, that's nice.\n\n307\n00:15:16.000 --> 00:15:20.650\nWe get the alerts and the help desk gets\ninvolved, and a ticket gets generated.\n\n308\n00:15:20.650 --> 00:15:23.330\nGreat, but remember, lazy admin here.\n\n309\n00:15:23.330 --> 00:15:27.791\nI would much rather be able to, is there\nany automatic way we can set this to say,\n\n310\n00:15:27.791 --> 00:15:32.117\nyou know what, if it's been violated\nafter an amount of time or this or that,\n\n311\n00:15:32.117 --> 00:15:34.275\nsome sort of way we can automate this.\n\n312\n00:15:34.275 --> 00:15:35.930\n>> Yeah, you can.\n\n313\n00:15:35.930 --> 00:15:38.410\nThere's something called air disabled,\nthese ports,\n\n314\n00:15:38.410 --> 00:15:39.710\nthey end up being air disabled, right?\n\n315\n00:15:39.710 --> 00:15:41.970\nI know we've talked about\nthat in other episodes.\n\n316\n00:15:41.970 --> 00:15:46.407\nSo if I do a show interface fa1/0/2,\nwhen it shuts it down,\n\n317\n00:15:46.407 --> 00:15:50.195\nit's not actually doing\na shutdown command, right?\n\n318\n00:15:50.195 --> 00:15:53.490\nThe port is technically still up,\neven though it shows as down, down.\n\n319\n00:15:53.490 --> 00:15:55.693\nAnd it's just error disabled, okay?\n\n320\n00:15:55.693 --> 00:15:58.855\nSo that error disabled you\ncan set a timer on it and\n\n321\n00:15:58.855 --> 00:16:02.730\nyou can say do recovery after\na certain period of time.\n\n322\n00:16:02.730 --> 00:16:07.410\nSo on these access ports\nI stop the attack and\n\n323\n00:16:07.410 --> 00:16:10.340\nmaybe I just want it to self heal\nafter five minutes or whatever.\n\n324\n00:16:10.340 --> 00:16:12.240\nI go ahead and let that port come back up.\n\n325\n00:16:12.240 --> 00:16:16.880\nSo that would help for\nrun of the mill things, like an end\n\n326\n00:16:16.880 --> 00:16:21.760\nuser swaps out a network card, or\nyou know, something to fix their machine.\n\n327\n00:16:21.760 --> 00:16:24.380\nIt wasn't malicious,\nnow they can just wait and it clears it.\n\n328\n00:16:24.380 --> 00:16:27.210\nOr maybe you just got a new laptop and\nplugged it in.\n\n329\n00:16:27.210 --> 00:16:29.680\nBut, usually, the port goes down,\nwhich clears your MAC,\n\n330\n00:16:29.680 --> 00:16:31.010\nand you plug the other one in, it's fine.\n\n331\n00:16:31.010 --> 00:16:34.250\nSo, you don't always have to do it,\nbut we can set a timer on that.\n\n332\n00:16:34.250 --> 00:16:37.050\nThe way that timers work,\nit's actually pretty straight forward.\n\n333\n00:16:37.050 --> 00:16:40.210\nAnd it's not just for\nport security, right?\n\n334\n00:16:40.210 --> 00:16:45.680\nWe can get air disabled for UDLD,\nthe unit directional link detection.\n\n335\n00:16:45.680 --> 00:16:47.380\nThere's all sorts of, here I'll show you.\n\n336\n00:16:47.380 --> 00:16:50.350\nIt's easier to see in the switch, so\nlet me bring it up here in the switch so\n\n337\n00:16:50.350 --> 00:16:53.380\nyou guys can see that error\ndisabled recovery, all right?\n\n338\n00:16:53.380 --> 00:16:55.610\nIf you jump into your config.\n\n339\n00:16:55.610 --> 00:16:59.580\nYou've got this err disable command and\n\n340\n00:16:59.580 --> 00:17:03.310\ninside the err disable command you've got,\nyou know, how it's doing detection.\n\n341\n00:17:03.310 --> 00:17:06.380\nSo you can actually turn off some of\nthe error disable states if you want to.\n\n342\n00:17:06.380 --> 00:17:08.210\nThere's not a lot of reason for that, but\n\n343\n00:17:08.210 --> 00:17:10.540\nthe one that I want is\nthis recovery option.\n\n344\n00:17:10.540 --> 00:17:13.910\nAnd if you do error disable recovery,\nyou'll see where you can configure all\n\n345\n00:17:13.910 --> 00:17:18.340\nsorts of stuff, like the causes\nthat generate error disable state.\n\n346\n00:17:18.340 --> 00:17:21.050\nAnd the interval,\nwhich is the recovery timer,\n\n347\n00:17:21.050 --> 00:17:23.740\nhow long to leave it disabled\nbefore waking it back up.\n\n348\n00:17:23.740 --> 00:17:24.980\nAnd the default is forever.\n\n349\n00:17:24.980 --> 00:17:27.000\nIt'll just wait forever, all right?\n\n350\n00:17:27.000 --> 00:17:31.630\nBut if you do errdisable recovery\ncause and a question mark.\n\n351\n00:17:31.630 --> 00:17:34.690\nYou'll get a list of all the things\nthat can cause error disabled and\n\n352\n00:17:34.690 --> 00:17:36.800\nthere's a lot of stuff in here.\n\n353\n00:17:36.800 --> 00:17:43.460\nBpduguard, ARP inspection,\nMAC limits, pagp flaps.\n\n354\n00:17:43.460 --> 00:17:47.470\nAll these are different things\nthat can result in error disable.\n\n355\n00:17:47.470 --> 00:17:50.080\nThe one we're talking about\nhere is security-violation.\n\n356\n00:17:50.080 --> 00:17:52.170\nThat's the one we're talking about, right?\n\n357\n00:17:52.170 --> 00:17:55.500\nAnd so usually there's not a lot\nyou can configure on these.\n\n358\n00:17:55.500 --> 00:17:57.190\nSee there's nothing I can configure here.\n\n359\n00:17:57.190 --> 00:18:00.910\nI can either turn it off, if I don't wanna\ngo error disabled, or I can leave it on,\n\n360\n00:18:00.910 --> 00:18:01.930\nwhich is the default.\n\n361\n00:18:01.930 --> 00:18:03.510\nSo it's on, it's already monitoring.\n\n362\n00:18:03.510 --> 00:18:05.040\nAnd I don't need to mess with that.\n\n363\n00:18:05.040 --> 00:18:07.330\nBut what I wanna do is I\nwanna come in here and\n\n364\n00:18:07.330 --> 00:18:11.650\nsay, errdisable recovery interval.\n\n365\n00:18:11.650 --> 00:18:17.040\nAnd then, I can set the default interval\nfor what I want it to recover at, right.\n\n366\n00:18:17.040 --> 00:18:19.670\nAnd, the default is just forever, right.\n\n367\n00:18:19.670 --> 00:18:21.920\nBut, I might want to come in,\nwhat did you say like five minutes?\n\n368\n00:18:21.920 --> 00:18:23.050\n>> Yeah, five minutes is probably good.\n\n369\n00:18:23.050 --> 00:18:24.480\n>> So, it is in seconds,\nwhich is annoying.\n\n370\n00:18:24.480 --> 00:18:26.680\nBut, we'll put it in here as 300 seconds.\n\n371\n00:18:26.680 --> 00:18:31.170\nAnd so now, anytime a port goes into error\ndisabled, it'll wait 300 seconds and\n\n372\n00:18:31.170 --> 00:18:33.550\nthen it'll try to bring it back up.\n\n373\n00:18:33.550 --> 00:18:34.740\nAnd if the violation is still there,\n\n374\n00:18:34.740 --> 00:18:37.000\nit'll just put it right\nback into error disabled.\n\n375\n00:18:37.000 --> 00:18:40.370\nBut every 5 minutes, it's going to attempt\nto let the port go healthy again, and\n\n376\n00:18:40.370 --> 00:18:43.140\nthat kinda gets us through that.\n\n377\n00:18:43.140 --> 00:18:47.690\nYou can also verify this\nwith show err disable and\n\n378\n00:18:47.690 --> 00:18:50.510\nthere's a few different options in\nhere like show err disable recovery.\n\n379\n00:18:51.530 --> 00:18:53.630\nAnd that'll show your recovery settings.\n\n380\n00:18:53.630 --> 00:18:57.080\nAnd as you look down the list here,\nnotice these timers.\n\n381\n00:18:57.080 --> 00:18:57.630\nRight?\n\n382\n00:18:57.630 --> 00:19:02.530\nAnd how as I kinda go down it, I've got\na timer interval down here of 300 seconds.\n\n383\n00:19:02.530 --> 00:19:05.590\nSome of them allow you to set\ntimers individually and so\n\n384\n00:19:05.590 --> 00:19:07.960\nyou can come through and put those and\nthey'll show up over here.\n\n385\n00:19:07.960 --> 00:19:11.070\nBut right now, all of ours are disabled\nbecause none of ours are active.\n\n386\n00:19:11.070 --> 00:19:12.250\nI haven't customized them.\n\n387\n00:19:12.250 --> 00:19:14.110\nMy default is 300 seconds.\n\n388\n00:19:15.200 --> 00:19:22.570\nAnd then we can do show errdisable detect\nand it'll show us what we're monitoring.\n\n389\n00:19:22.570 --> 00:19:25.070\nAnd so I can see what each one\nof these guys are monitoring.\n\n390\n00:19:25.070 --> 00:19:28.330\nAnd I can see how the security\nviolation is enabled.\n\n391\n00:19:28.330 --> 00:19:30.050\nAnd it's watching each port.\n\n392\n00:19:30.050 --> 00:19:30.596\nRight?\n\n393\n00:19:30.596 --> 00:19:35.530\nSo now, oops [LAUGH] if I generate\na failure, if I have that Fake Mac address\n\n394\n00:19:35.530 --> 00:19:40.986\ncome up, whoops, then it's gonna violate\n[LAUGH], this is my terrible typing now.\n\n395\n00:19:40.986 --> 00:19:41.610\n>> [LAUGH]\n>> It's gonna violate,\n\n396\n00:19:41.610 --> 00:19:44.630\nwhich we already saw, but in five minutes,\nit's gonna try and wake it back up and\n\n397\n00:19:44.630 --> 00:19:48.942\nit's not gonna wake up unless I go\nremove that false address that I put in.\n\n398\n00:19:48.942 --> 00:19:55.310\nAll right, so, that's static, well, it's\nstatic port security, statically defining\n\n399\n00:19:55.310 --> 00:20:00.300\na MAC address and then having error\ndisable to try and auto recover, right.\n\n400\n00:20:00.300 --> 00:20:03.440\nIf we just look at those commands real\nquick as kind of a recap on that.\n\n401\n00:20:04.990 --> 00:20:05.940\nWe can take a look at it here.\n\n402\n00:20:05.940 --> 00:20:08.420\nSo I turn on that\nswitchboard port security.\n\n403\n00:20:08.420 --> 00:20:11.880\nYou can set maximum violation, but\nthey're defaulting to the values I want.\n\n404\n00:20:11.880 --> 00:20:14.320\nAnd there's where I statically\nassign that MAC address.\n\n405\n00:20:14.320 --> 00:20:16.400\nSticky addresses are easier but\nthis works.\n\n406\n00:20:16.400 --> 00:20:17.820\n>> I like it, I like it a lot.\n\n407\n00:20:17.820 --> 00:20:21.600\nDon, is there any other way in\nwhich we can control switch access?\n\n408\n00:20:21.600 --> 00:20:23.060\n>> You know, there are some neat things.\n\n409\n00:20:23.060 --> 00:20:26.170\nI think we've got enough time here so\nlet's try and cover another neat one.\n\n410\n00:20:26.170 --> 00:20:29.360\nYou've learned about access control lists,\nACLs, right?\n\n411\n00:20:29.360 --> 00:20:32.620\nIf you watch the Route Show or if you did\nyour CCNA, you've already learned about\n\n412\n00:20:32.620 --> 00:20:38.640\nACLs and ACLs filter based on a source\nIP going to a destination IP, right.\n\n413\n00:20:38.640 --> 00:20:41.580\nAnd ACLs only apply\n\n414\n00:20:41.580 --> 00:20:46.580\nwhen you pass from one routed interface\nto another routed interface, right.\n\n415\n00:20:46.580 --> 00:20:48.920\nSo, on a router we use them all the time.\n\n416\n00:20:48.920 --> 00:20:50.370\nOr on a layer three switch,\n\n417\n00:20:50.370 --> 00:20:53.470\nwhen you're routing between VLANs,\nyou use them there too.\n\n418\n00:20:53.470 --> 00:20:54.300\nRight?\n\n419\n00:20:54.300 --> 00:21:00.230\nBut what if I wanna filter traffic\nthat's just passing between two ports?\n\n420\n00:21:00.230 --> 00:21:01.950\nThat's a lot harder, all right?\n\n421\n00:21:01.950 --> 00:21:05.530\nThere's MAC address ACLs that you can use,\nbut those are really designed to just\n\n422\n00:21:05.530 --> 00:21:09.320\napply when you pass from Interface\nto interface on a router, right?\n\n423\n00:21:09.320 --> 00:21:11.430\nAnd they can do in-between VLANs too, so\n\n424\n00:21:11.430 --> 00:21:13.300\nthey're not necessarily\nthe most effective.\n\n425\n00:21:13.300 --> 00:21:17.740\nBut there's a special technology on\nswitches that's called a VLAN ACL.\n\n426\n00:21:17.740 --> 00:21:20.230\nA VLAN ACL is kinda like a magical ACL.\n\n427\n00:21:20.230 --> 00:21:25.710\nIt's one of the only ACLs present\non a Cisco Device, router switch,\n\n428\n00:21:25.710 --> 00:21:30.630\nfirewall, whatever, that allows you to\nfilter traffic that's not being routed.\n\n429\n00:21:30.630 --> 00:21:35.720\nI can have traffic going from one host\nto another host on the same VLAN,\n\n430\n00:21:35.720 --> 00:21:37.180\nand I can filter that traffic.\n\n431\n00:21:37.180 --> 00:21:38.250\nIt's pretty cool, right?\n\n432\n00:21:38.250 --> 00:21:39.540\nLet me show you how it works.\n\n433\n00:21:39.540 --> 00:21:41.890\nIt's actually kind of a two step process,\nright?\n\n434\n00:21:41.890 --> 00:21:46.570\nFirst off you have to create an ACL that\nidentifies the traffic you want to filter.\n\n435\n00:21:46.570 --> 00:21:50.370\nAnd then you have to create,\nit's kind of like a route map, right?\n\n436\n00:21:50.370 --> 00:21:52.010\nWe did route maps in the route show.\n\n437\n00:21:52.010 --> 00:21:53.860\nBut here it's called a VLAN map.\n\n438\n00:21:53.860 --> 00:21:57.790\nAnd a VLAN map applies to\ntraffic within a VLAN.\n\n439\n00:21:57.790 --> 00:21:58.380\nNot routed.\n\n440\n00:21:58.380 --> 00:21:59.830\nI mean, it can be routed.\n\n441\n00:21:59.830 --> 00:22:03.090\nBut it, routed or not, it's even local\ntraffic that it's gonna filter and\n\n442\n00:22:03.090 --> 00:22:04.370\nallow us to protect.\n\n443\n00:22:04.370 --> 00:22:07.990\nSo let's say I have two hosts that\nI absolutely do not want to be able\n\n444\n00:22:07.990 --> 00:22:08.990\nto communicate.\n\n445\n00:22:08.990 --> 00:22:09.530\nAll right.\n\n446\n00:22:09.530 --> 00:22:10.830\nAnd they're both on VLAN one.\n\n447\n00:22:10.830 --> 00:22:13.510\nIn other words,\nthey're not gonna route, right?\n\n448\n00:22:13.510 --> 00:22:17.180\nSo if I take a look at a ny wan one here,\nthis guy.\n\n449\n00:22:17.180 --> 00:22:18.440\nOh, his port is shutdown.\n\n450\n00:22:18.440 --> 00:22:22.230\nLet me fix his port real quick, otherwise\nhe's going to have a really boring day.\n\n451\n00:22:22.230 --> 00:22:25.820\nSo on this guy, I shut him down\nwith that port security, right?\n\n452\n00:22:25.820 --> 00:22:27.930\nSo I'm gonna go and fix that.\n\n453\n00:22:28.990 --> 00:22:31.920\nSo I'll just do a no port-security.\n\n454\n00:22:31.920 --> 00:22:32.880\nAnd switchport, port security.\n\n455\n00:22:34.979 --> 00:22:41.920\nAnd if I can get this, there we go.\n\n456\n00:22:41.920 --> 00:22:44.030\nOkay so I'm gonna turn that port back on.\n\n457\n00:22:45.170 --> 00:22:46.760\nSo that he'll be able to communicate.\n\n458\n00:22:46.760 --> 00:22:48.940\nAnd that router was 192.168.16.22, right?\n\n459\n00:22:51.060 --> 00:22:54.470\nAnd earlier in the show I was\nPing from it over to another IP,\n\n460\n00:22:54.470 --> 00:22:59.270\nlet me just go verify that that still\nworks since I'm hosing everything up here.\n\n461\n00:22:59.270 --> 00:23:04.690\nThis guy, if we take a look at\nour IP here, let's make sure.\n\n462\n00:23:04.690 --> 00:23:09.370\nIt's using DHCP so I have to give it\na second to get its DHCP address, but\n\n463\n00:23:09.370 --> 00:23:11.870\nas soon as it has it it\nwill get 192.168.16.22.\n\n464\n00:23:11.870 --> 00:23:16.940\nAnd I was pinging to 192.168.16.1,\nand it was successful.\n\n465\n00:23:16.940 --> 00:23:18.900\nLet's say I wanna block that.\n\n466\n00:23:18.900 --> 00:23:22.240\nI don't wanna allow the communication\nbetween these two hosts.\n\n467\n00:23:22.240 --> 00:23:24.390\nI can write an ACL that\nidentifies that traffic,\n\n468\n00:23:24.390 --> 00:23:26.510\nand I can use a VLAN map to filter it.\n\n469\n00:23:26.510 --> 00:23:27.540\nThere we go, I got my address.\n\n470\n00:23:27.540 --> 00:23:30.830\n>> Don, wouldn't it just be easier to\nstick the two hosts on different VLANs?\n\n471\n00:23:30.830 --> 00:23:35.430\n>> You certainly could,\nunless you actually need it for\n\n472\n00:23:35.430 --> 00:23:37.140\nsome other reason, right?\n\n473\n00:23:37.140 --> 00:23:40.000\nThere could be times where\nmaybe you've got something like\n\n474\n00:23:40.000 --> 00:23:41.420\na router on the network.\n\n475\n00:23:41.420 --> 00:23:44.270\nAnd you want all of your hosts to\nbe able to talk to the router but\n\n476\n00:23:44.270 --> 00:23:46.600\nyou don't want them to be\nable to talk to each other.\n\n477\n00:23:46.600 --> 00:23:47.895\nYou can use a VLAN ACL to do that.\n\n478\n00:23:47.895 --> 00:23:51.586\nThis is something that ISP's do a lot when\nthey have like Metro E networks to try and\n\n479\n00:23:51.586 --> 00:23:55.700\nprotect clients, this is an easy way to do\nit and everybody stays within one VLAN.\n\n480\n00:23:55.700 --> 00:23:58.400\nRight, so there's different reasons\nwhy you might want to do this.\n\n481\n00:23:58.400 --> 00:24:01.684\nBut if I jump in here and try and ping.\n\n482\n00:24:01.684 --> 00:24:06.076\nSo I'm coming from 192.168.16.22.\n\n483\n00:24:06.076 --> 00:24:07.610\nAnd I'm going to 192.168.16.1.\n\n484\n00:24:07.610 --> 00:24:10.490\nAnd there we go.\n\n485\n00:24:10.490 --> 00:24:13.170\nI can see that I am able to do that ping.\n\n486\n00:24:13.170 --> 00:24:14.230\nBut I want to stop that.\n\n487\n00:24:14.230 --> 00:24:18.825\nI don't want this particular router\nto be able to get to that host.\n\n488\n00:24:18.825 --> 00:24:23.366\nSo I can jump over to my core switch, and\nI can create an ACL that identifies that.\n\n489\n00:24:23.366 --> 00:24:28.624\nSo I'm just gonna jump in here and\nI'm going to say access-list and\n\n490\n00:24:28.624 --> 00:24:33.810\nyou can do a named ACL and extended,\nyou can do whatever you want.\n\n491\n00:24:33.810 --> 00:24:38.780\nIf we want to do something like a named\nACL, those really aren't that hard to do,\n\n492\n00:24:38.780 --> 00:24:40.880\nand it's kind of the best\nway to go these days.\n\n493\n00:24:40.880 --> 00:24:46.657\nSo, if I want to do that I'll just\ncome in and say IP access-list.\n\n494\n00:24:46.657 --> 00:24:52.574\nAnd then I'm gonna call\nthis one a acl-vlan1.\n\n495\n00:24:52.574 --> 00:24:56.490\nThat router and the host that\nit's pinging are both on vlan1.\n\n496\n00:24:56.490 --> 00:24:59.300\nAnd this is an ACL I'm gonna\nbe applying to vlan1, and so\n\n497\n00:24:59.300 --> 00:25:01.570\nI just wanna name it in a way that I\ncan remember what it's purpose is.\n\n498\n00:25:01.570 --> 00:25:03.140\nSo I'll just call it ACL vlan1.\n\n499\n00:25:03.140 --> 00:25:07.448\nAnd I'm gonna come in here and\nspecify traffic I wanna match.\n\n500\n00:25:07.448 --> 00:25:12.157\nAnd I wanna match, and use permits\nto say that you're matching, right.\n\n501\n00:25:12.157 --> 00:25:19.136\nSo I wanna match when 192.168.16.22\n\n502\n00:25:19.136 --> 00:25:24.824\nis going to 192.168.16.1.\n\n503\n00:25:24.824 --> 00:25:26.880\nAll right,\nwhen those two hosts are talking.\n\n504\n00:25:26.880 --> 00:25:30.910\nNow, I could go further and specify\nequaling certain ports or whatever,\n\n505\n00:25:30.910 --> 00:25:33.880\nbut I just want to kill these\ntwo hosts altogether, right?\n\n506\n00:25:33.880 --> 00:25:38.700\nAnd so I'm gonna permit IP for that, okay.\n\n507\n00:25:38.700 --> 00:25:42.460\nNow, be careful on this because\nsometimes you've got protocols like\n\n508\n00:25:42.460 --> 00:25:46.320\nping that fall outside of it and\nsee how I've got icmp right there?\n\n509\n00:25:46.320 --> 00:25:49.100\nAnd so you might need to add\na little bit more to it.\n\n510\n00:25:49.100 --> 00:25:52.520\nIf I just do IP that gets tcp and udp.\n\n511\n00:25:52.520 --> 00:25:54.230\nBut icmp is kind of special,\n\n512\n00:25:54.230 --> 00:25:58.590\nso I might need to match on that also\nif I want to go a little bit further.\n\n513\n00:25:58.590 --> 00:26:01.080\nBut, in my case, I'm really just\ntrying to match the IP address, so\n\n514\n00:26:01.080 --> 00:26:02.270\nthis will work for me.\n\n515\n00:26:02.270 --> 00:26:03.740\n>> Looks like it can go\nthe opposite way as well.\n\n516\n00:26:03.740 --> 00:26:06.400\nIf I just wanted to allow tcp,\nI could do that and not udp.\n\n517\n00:26:06.400 --> 00:26:08.130\n>> Yeah, you can be really specific.\n\n518\n00:26:08.130 --> 00:26:11.520\nAnd, you mentioned you're\ndoing it the other way.\n\n519\n00:26:11.520 --> 00:26:14.210\nVLAN ACLs are kind of magical,\ncuz you're not being routed.\n\n520\n00:26:14.210 --> 00:26:17.040\nSo you don't come from one interface and\ngo to another interface.\n\n521\n00:26:17.040 --> 00:26:20.270\nAnd that means that these ACLs apply\nto traffic in both directions.\n\n522\n00:26:20.270 --> 00:26:24.330\nAnd so, I need to write\nthe inverse of what I just did,\n\n523\n00:26:24.330 --> 00:26:26.020\nto make this actually work.\n\n524\n00:26:26.020 --> 00:26:28.990\nSo I'm gonna add one more line, which it's\nreally just gonna be the same as the line\n\n525\n00:26:28.990 --> 00:26:31.110\nabove except, I'm gonna flip the IP.\n\n526\n00:26:31.110 --> 00:26:35.250\nSo, this is gonna be dot one,\ngoing to dot 22.\n\n527\n00:26:35.250 --> 00:26:38.629\nSo, on the first one I did,\ndot 22 going to dot one, and\n\n528\n00:26:38.629 --> 00:26:42.867\non the second line I'm doing the other\nway around, dot one to dot 22.\n\n529\n00:26:42.867 --> 00:26:45.449\nTo get both directions of the traffic,\nright.\n\n530\n00:26:45.449 --> 00:26:48.491\nVLAN ACLs apply to both directions so\nyou gotta write both ways.\n\n531\n00:26:48.491 --> 00:26:51.570\nThat's a lot different then regular ACLs.\n\n532\n00:26:51.570 --> 00:26:54.870\nSo now I'm gonna match that traffic,\nall right?\n\n533\n00:26:54.870 --> 00:26:58.350\nI don't want anybody else to match this,\nand so there is a like an implicit deny\n\n534\n00:26:58.350 --> 00:27:02.440\nall, but you can punch one in if\nyou want to be on the safe side.\n\n535\n00:27:02.440 --> 00:27:04.866\nWe can just kinda fill\nthat in if you want.\n\n536\n00:27:04.866 --> 00:27:06.779\nUsually we do that if you want\nto tack logging onto it, or\n\n537\n00:27:06.779 --> 00:27:08.260\nwhatever to get a record of it, all right.\n\n538\n00:27:10.250 --> 00:27:11.950\nNow I've got an ACL, all right.\n\n539\n00:27:11.950 --> 00:27:16.537\nAnd if I do a show access-list, I can\nsee it and it's just matching those two\n\n540\n00:27:16.537 --> 00:27:19.850\ncommunications and\nit's not matching anybody else.\n\n541\n00:27:20.920 --> 00:27:22.970\nI'm not gonna attach this ACL though.\n\n542\n00:27:22.970 --> 00:27:26.324\nI need to create a map that applies it,\nand here's where things get different.\n\n543\n00:27:26.324 --> 00:27:31.574\nI'm gonna jump in here and\nI'm gonna say vlan access-map, all right.\n\n544\n00:27:31.574 --> 00:27:32.606\nNot an access list,\n\n545\n00:27:32.606 --> 00:27:37.242\nan access map, right that's the difference\nright that's what makes these things work.\n\n546\n00:27:37.242 --> 00:27:40.658\nAnd so I'm gonna punch that in here and\nI am gonna give it a name, and\n\n547\n00:27:40.658 --> 00:27:43.116\nI'll just call this map-vlan1, all right.\n\n548\n00:27:43.116 --> 00:27:47.310\nAnd like a named ACL, like a route map\nthey have line numbers that identify them,\n\n549\n00:27:47.310 --> 00:27:51.379\nand if you just leave it at the default\nthe first one will be ten, and then 20,\n\n550\n00:27:51.379 --> 00:27:52.199\nand then 30.\n\n551\n00:27:52.199 --> 00:27:54.482\nI usually like to type them in\njust to be on the safe side, but\n\n552\n00:27:54.482 --> 00:27:56.500\nthat's certainly optional.\n\n553\n00:27:56.500 --> 00:27:57.760\nThen I can specify what I want to do.\n\n554\n00:27:57.760 --> 00:28:00.117\nAnd I want a match based\non that IP address.\n\n555\n00:28:00.117 --> 00:28:06.741\nAnd so I'm gonna say,\nmatch IP address acl-vlan1, okay.\n\n556\n00:28:06.741 --> 00:28:10.045\nSo I want to match traffic that's\nfrom that's from that ACL, and\n\n557\n00:28:10.045 --> 00:28:11.890\nmy action is gonna be drop.\n\n558\n00:28:11.890 --> 00:28:14.360\nI'm gonna drop that traffic, all right?\n\n559\n00:28:14.360 --> 00:28:15.450\nThen I'm gonna add another line.\n\n560\n00:28:15.450 --> 00:28:18.020\nIf I stop right there,\nthis one will apply.\n\n561\n00:28:18.020 --> 00:28:20.610\nIt'll drop that traffic, and\nthere's nothing else to match on.\n\n562\n00:28:20.610 --> 00:28:23.640\nAnd so every bit of traffic\nwill be dropped from then on.\n\n563\n00:28:23.640 --> 00:28:25.995\nSo, I need to add one more line.\n\n564\n00:28:25.995 --> 00:28:29.695\nSo I'll do this vlan\naccess-map map-vlan1 20.\n\n565\n00:28:29.695 --> 00:28:33.215\nAnd on this one,\nI'm not gonna do a match statement at all.\n\n566\n00:28:33.215 --> 00:28:36.225\nAnd if you don't do a match statement,\nit means it matches everything.\n\n567\n00:28:36.225 --> 00:28:39.455\nAnd I'll set the action to forward,\nall right?\n\n568\n00:28:39.455 --> 00:28:41.815\nI'm gonna drop traffic\nthat matches the ACL, so\n\n569\n00:28:41.815 --> 00:28:47.225\nthe traffic between those two hosts,\nI'm gonna forward everything else, okay.\n\n570\n00:28:47.225 --> 00:28:50.350\nSo that should be pretty\nmuch all I need there.\n\n571\n00:28:50.350 --> 00:28:54.930\nThe last thing I need to do,\nis to attach this to the vlan itself.\n\n572\n00:28:54.930 --> 00:28:56.430\nI stop here, I'm not done.\n\n573\n00:28:56.430 --> 00:28:59.570\nSo, I need to say, and this is\na command that's completely unique.\n\n574\n00:28:59.570 --> 00:29:04.360\nWe need to say vlan filter,\nand then attach that map.\n\n575\n00:29:04.360 --> 00:29:08.020\nSo, I'll say map-vlan1.\n\n576\n00:29:08.020 --> 00:29:12.120\nAnd then, you can actually attach\na map to more than one vlan.\n\n577\n00:29:12.120 --> 00:29:16.640\nSo you have to say vlan-list, and\nthen which vlans this attaches to.\n\n578\n00:29:16.640 --> 00:29:18.010\nI'm just doing vlan1.\n\n579\n00:29:18.010 --> 00:29:20.490\nBut you can use commas and\nhyphens to specify ranges and\n\n580\n00:29:20.490 --> 00:29:22.000\napply this to more than one.\n\n581\n00:29:22.000 --> 00:29:27.350\nAnd when I attach that, now all\ntraffic passing through vlan1, whether\n\n582\n00:29:27.350 --> 00:29:31.770\nit's getting routed or not, even local\ntraffic is gonna pass through this filter.\n\n583\n00:29:31.770 --> 00:29:34.310\nAnd if it matches we're gonna kill it and\nstop it, and\n\n584\n00:29:34.310 --> 00:29:36.150\nthat's gonna be the end of it, all right?\n\n585\n00:29:36.150 --> 00:29:41.280\nSo, when this is done, I should no\nlonger be able to communicate, right?\n\n586\n00:29:41.280 --> 00:29:44.210\nThe traffic shouldn't match up,\nand I shouldn't be able to do it.\n\n587\n00:29:44.210 --> 00:29:50.630\nIf I jump over to NYWAN1, this guy who was\nsuccessfully pinging just a moment ago,\n\n588\n00:29:50.630 --> 00:29:55.110\nif I repeat that ping,\nits not working, right?\n\n589\n00:29:55.110 --> 00:29:59.280\nIts not hitting and its because\nwe've got that vlan filter in place.\n\n590\n00:29:59.280 --> 00:30:02.070\nSo, its neat way to restrict traffic or\npermit traffic,\n\n591\n00:30:02.070 --> 00:30:05.140\nyou could permit just certain things and\ndrop everything else.\n\n592\n00:30:05.140 --> 00:30:09.770\nYou can really get a lot of control here,\neven on non-routed traffic.\n\n593\n00:30:09.770 --> 00:30:11.280\nNow, be careful with this.\n\n594\n00:30:11.280 --> 00:30:14.610\nBecause non-routed traffic\nthat's all within a vlan,\n\n595\n00:30:14.610 --> 00:30:16.500\nthe switch doesn't normally\nget very involved in it.\n\n596\n00:30:16.500 --> 00:30:18.630\nIt looks at the layer two header and\nthat's it.\n\n597\n00:30:18.630 --> 00:30:22.340\nNow, I'm having to look at least the layer\nthree header caused I've matched some IPs.\n\n598\n00:30:22.340 --> 00:30:23.990\nAnd if I went even further on ports,\n\n599\n00:30:23.990 --> 00:30:25.600\nyou can start to get some\nperformance degradation.\n\n600\n00:30:25.600 --> 00:30:26.990\nSo just keep an eye on that.\n\n601\n00:30:26.990 --> 00:30:29.090\nBut otherwise it's a great technology and\n\n602\n00:30:29.090 --> 00:30:30.850\nanother wonderful way\nto filter that traffic.\n\n603\n00:30:30.850 --> 00:30:32.370\n>> Very cool stuff, Don.\n\n604\n00:30:32.370 --> 00:30:35.540\nNow we've gone through quite a few\ndifferent ways in which we can secure our\n\n605\n00:30:35.540 --> 00:30:39.590\nswitches, securing our network, through\nthe switch security that we've looked at.\n\n606\n00:30:39.590 --> 00:30:43.165\nWe got a little bit more to cover, and\nwe are well out of time for this episode.\n\n607\n00:30:43.165 --> 00:30:44.190\n>> [LAUGH]\n>> We do thank you for\n\n608\n00:30:44.190 --> 00:30:46.660\nall these cool demonstrations and\nbeing on the show today.\n\n609\n00:30:46.660 --> 00:30:48.050\nWe thank you guys for watching.\n\n610\n00:30:48.050 --> 00:30:50.370\nHopefully we'll see you in part four.\n\n611\n00:30:50.370 --> 00:30:51.520\nAs we'll see everybody else.\n\n612\n00:30:51.520 --> 00:30:55.532\nAnd signing off, for ITProTV,\nI've been your host, Daniel Lowrie.\n\n613\n00:30:55.532 --> 00:30:57.782\n>> And I'm Don Pezet.\n>> We'll see you next time.\n\n614\n00:30:57.782 --> 00:31:04.120\n[MUSIC]\n\n",
          "vimeoId": "141782686"
        },
        {
          "description": "In this episode, Don and Daniel finish out the switch security series with Private VLANs and Storm Control. Here they explain how you can use Private VLANs to isolate devices that are sharing the same switch without needing to route as in traditional VLANs. Then they finish by explaining how you can use Storm Control to eliminate accidental, or intentional broadcast storms.",
          "length": "2812",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt4-100715-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt4-100715-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-2-1-switch_security_features_pt4-100715-1-sm.jpg",
          "title": "Switch Security Part 4",
          "transcript": "WEBVTT\n\n1\n00:00:00.002 --> 00:00:10.002\n[MUSIC]\n\n2\n00:00:11.929 --> 00:00:16.357\nAll right, greetings everyone and welcome\nto another exciting episode of ITPro TV,\n\n3\n00:00:16.357 --> 00:00:20.722\nI'm your host Daniel Lowrie and joining me\nin the studio today is none other than Mr.\n\n4\n00:00:20.722 --> 00:00:21.360\nDon Pezet.\n\n5\n00:00:21.360 --> 00:00:22.770\nHow's it going this morning, Don?\n\n6\n00:00:22.770 --> 00:00:23.840\n>> It is going great, Daniel.\n\n7\n00:00:23.840 --> 00:00:25.507\nGlad to be back to the show and\n\n8\n00:00:25.507 --> 00:00:28.851\nready to wrap up our series\non switch security features.\n\n9\n00:00:28.851 --> 00:00:30.865\nThis is kind of like when\nyou get in the car and\n\n10\n00:00:30.865 --> 00:00:34.566\nyou go on a six hour drive and the first\ncouple of hours, you're a little antsy and\n\n11\n00:00:34.566 --> 00:00:38.052\nthen by the time you get to hour three,\nyour body just kinda resigns itself to\n\n12\n00:00:38.052 --> 00:00:40.421\nthe fact that you're gonna\nbe in that car forever.\n\n13\n00:00:40.421 --> 00:00:43.119\nYou guys have probably resigned yourself\nto the fact that we're gonna keep learning\n\n14\n00:00:43.119 --> 00:00:44.981\nabout security features forever,\nbut I assure you guys,\n\n15\n00:00:44.981 --> 00:00:46.380\nthis is kind of the end of it.\n\n16\n00:00:46.380 --> 00:00:49.990\nWe have two neat technologies to implement\nhere, we're gonna start off with private\n\n17\n00:00:49.990 --> 00:00:53.600\nVLANs which I think are really cool, and\nmost people don't even know about them.\n\n18\n00:00:53.600 --> 00:00:57.320\nSo it's kind of like this unsung\nfeature inside of most Cisco switches.\n\n19\n00:00:57.320 --> 00:00:59.360\nIt's really powerful and\nit's definitely a neat one to implement.\n\n20\n00:00:59.360 --> 00:01:03.720\nAnd then we'll wrap up talking about storm\ncontrol which is not so neat anymore.\n\n21\n00:01:03.720 --> 00:01:07.142\nBut it's still there we need to learn\nit and it is useful for some people.\n\n22\n00:01:07.142 --> 00:01:10.430\n>> All right, well I know I'm looking\nforward to this private VLAN business.\n\n23\n00:01:10.430 --> 00:01:12.760\nTom talks it up like it's\nthe second coming and\n\n24\n00:01:12.760 --> 00:01:14.245\nno one's using this stinking thing.\n\n25\n00:01:14.245 --> 00:01:16.130\n>> [LAUGH]\n>> So, I say we start with that.\n\n26\n00:01:16.130 --> 00:01:17.870\nDon, what is private VLAN's?\n\n27\n00:01:17.870 --> 00:01:18.700\n>> All right so,\n\n28\n00:01:18.700 --> 00:01:22.840\nprivate VLAN's are a special type of\nVLAN's supported in Cisco Switches.\n\n29\n00:01:22.840 --> 00:01:26.510\nThat is,\nit kind of provides a neat little feature.\n\n30\n00:01:27.640 --> 00:01:31.390\nFor most companies, most businesses,\nyou don't really bump into this problem.\n\n31\n00:01:31.390 --> 00:01:33.470\nFor internet service providers,\nthey bump into it all the time.\n\n32\n00:01:34.500 --> 00:01:39.280\nWhat if you have a switch and you've got\nmultiple people plugged into that switch\n\n33\n00:01:39.280 --> 00:01:41.600\nbut you wanna kinda keep them separated.\n\n34\n00:01:41.600 --> 00:01:42.160\nRight?\n\n35\n00:01:42.160 --> 00:01:45.740\nThink about an internet service provider\nwhere you've got customers, right?\n\n36\n00:01:45.740 --> 00:01:47.460\nOr at home.\n\n37\n00:01:47.460 --> 00:01:49.500\nI've got a cable modem at home so\n\n38\n00:01:49.500 --> 00:01:54.105\nI use high speed internet and I'm on this\nshared community cable network Work.\n\n39\n00:01:54.105 --> 00:01:57.545\nI pay for it and I access the network and\n\n40\n00:01:57.545 --> 00:02:00.065\nso do my neighbors, and\nall the other people in the same area.\n\n41\n00:02:00.065 --> 00:02:03.135\nAnybody who's a cable customer is\njumping on the same network and\n\n42\n00:02:03.135 --> 00:02:05.805\ngoing to the same hardware\nat the cable company.\n\n43\n00:02:05.805 --> 00:02:07.850\nBut they don't want me,\n\n44\n00:02:07.850 --> 00:02:11.180\nto be able to access one of their\nother customer's houses, right.\n\n45\n00:02:11.180 --> 00:02:14.691\nSo you have to have a way to isolate that\nand that creates a pretty big challenge.\n\n46\n00:02:14.691 --> 00:02:17.812\nSo ISP's deal with this all the time.\n\n47\n00:02:17.812 --> 00:02:21.544\nIn businesses we usually only bump\ninto this when we are dealing with\n\n48\n00:02:21.544 --> 00:02:22.820\nDMZ's, right.\n\n49\n00:02:22.820 --> 00:02:27.150\nIf you've got, internet facing\nweb servers or file servers,\n\n50\n00:02:27.150 --> 00:02:29.250\nemail servers, that kind of stuff.\n\n51\n00:02:29.250 --> 00:02:31.960\nYou may want to isolate\nthem from each other.\n\n52\n00:02:31.960 --> 00:02:34.930\nSo let's take this example here\nwhere I've got a DMZ switch.\n\n53\n00:02:34.930 --> 00:02:36.180\nSo this is a switch that\n\n54\n00:02:36.180 --> 00:02:38.570\nI'm gonna be plugging my\ninternet facing equipment in to.\n\n55\n00:02:38.570 --> 00:02:41.000\nAnd in my company,\nI might have a web server Right,\n\n56\n00:02:41.000 --> 00:02:44.980\nweb01, I've got another web server here,\nweb02, I've got a database server, right?\n\n57\n00:02:44.980 --> 00:02:47.750\nSo these are three different servers\nthat I've got on my network.\n\n58\n00:02:47.750 --> 00:02:50.500\nNow, I want each of these\nto be accessible from\n\n59\n00:02:50.500 --> 00:02:52.350\nthe internet to a certain degree, right?\n\n60\n00:02:52.350 --> 00:02:54.240\nThe web server, this guy, web01,\n\n61\n00:02:54.240 --> 00:02:58.195\nI want people from the internet to be able\nto come in an access that web server.\n\n62\n00:02:58.195 --> 00:03:01.425\nI've got another web server that I want\npeople from the internet to be able\n\n63\n00:03:01.425 --> 00:03:03.345\nto come in and access that web server.\n\n64\n00:03:03.345 --> 00:03:06.365\nBut this web server is\naccessing data from a database.\n\n65\n00:03:06.365 --> 00:03:09.470\nAnd so it's communicating over to\nthis database server and talking.\n\n66\n00:03:09.470 --> 00:03:15.160\nWeb01 doesn't need to talk to database01,\nright, but web02 does.\n\n67\n00:03:15.160 --> 00:03:18.990\nSo I've got different needs of\ncommunications here inside of the DMZ.\n\n68\n00:03:18.990 --> 00:03:22.100\nAnd if you're an ISP,\nit might not just be multiple servers,\n\n69\n00:03:22.100 --> 00:03:23.530\nit might be completely\ndifferent customers.\n\n70\n00:03:23.530 --> 00:03:26.540\nLike here's a web server for\ncustomer number 2, right?\n\n71\n00:03:26.540 --> 00:03:30.290\nSo, now I've got an entirely separate\ncustomer, all plugged into the same\n\n72\n00:03:30.290 --> 00:03:33.990\nswitch, all getting Internet access\nthrough the same firewall, and,\n\n73\n00:03:33.990 --> 00:03:35.256\nwe're allowing outside people to come in.\n\n74\n00:03:35.256 --> 00:03:36.960\nAll right, now [INAUDIBLE].\n\n75\n00:03:36.960 --> 00:03:38.100\nWhere are the risks here?\n\n76\n00:03:38.100 --> 00:03:40.080\nThere's a couple of risks, right?\n\n77\n00:03:40.080 --> 00:03:42.090\nLet's go with the multi\ncustomer model first.\n\n78\n00:03:42.090 --> 00:03:44.990\nSo these first three servers\nare all customer one.\n\n79\n00:03:44.990 --> 00:03:48.130\nAnd let's say that customer one\nis really security conscious and\n\n80\n00:03:48.130 --> 00:03:52.370\nthey've done a great job of giving me\nthe right firewall rules to put in.\n\n81\n00:03:52.370 --> 00:03:54.890\nTo only allow the bare minimum access.\n\n82\n00:03:54.890 --> 00:03:59.090\nAnd they're doing a great job maintaining\nsecurity on their servers, right?\n\n83\n00:03:59.090 --> 00:04:03.070\nMeanwhile, customer two,\nthey don't know what they're doing.\n\n84\n00:04:03.070 --> 00:04:04.940\nThey're not updated their server.\n\n85\n00:04:04.940 --> 00:04:08.220\nThey give me a list of ports to open for\ntheir server and\n\n86\n00:04:08.220 --> 00:04:10.640\nit's just all over the place, wide open.\n\n87\n00:04:10.640 --> 00:04:13.130\nAnd you can tell they're doing\nall sorts of unsecure stuff.\n\n88\n00:04:13.130 --> 00:04:17.990\nThey've got telemat open to their\nserver or something like that, well,\n\n89\n00:04:17.990 --> 00:04:22.000\nif a hacker can penetrate web 01 for\ncustomer two,\n\n90\n00:04:22.000 --> 00:04:25.920\nif they can penetrate this server right\nhere, they're now through the firewall,\n\n91\n00:04:25.920 --> 00:04:28.240\nand they can perform what is\ncalled a leapfrog attack.\n\n92\n00:04:28.240 --> 00:04:32.360\nLeapfrog, where their attack comes in and\nhits one server.\n\n93\n00:04:32.360 --> 00:04:37.860\nAnd then they use that server as a jumping\npoint to hit other servers internally.\n\n94\n00:04:37.860 --> 00:04:40.080\nAnd they can start to hit\nthese other servers and\n\n95\n00:04:40.080 --> 00:04:42.340\nthey're already behind the firewall.\n\n96\n00:04:42.340 --> 00:04:44.380\nSo, customer 1 might\nhave done a great job,\n\n97\n00:04:44.380 --> 00:04:48.690\nby giving me the bare minimum firewall\nrules to allow access to their system.\n\n98\n00:04:48.690 --> 00:04:52.700\nBut now the attacker's behind the firewall\nand they might have access to ports and\n\n99\n00:04:52.700 --> 00:04:56.000\nother services that they\nshouldn't have access to.\n\n100\n00:04:56.000 --> 00:04:58.510\nMaybe DB01 is not even\navailable to the internet, and\n\n101\n00:04:58.510 --> 00:05:00.590\ninternet hosts can't get to DB01.\n\n102\n00:05:00.590 --> 00:05:03.570\nBut now that the hacker's\npenetrated this other web server,\n\n103\n00:05:03.570 --> 00:05:07.540\nthey can leap right over into the database\nand start to attack it, right?\n\n104\n00:05:07.540 --> 00:05:08.800\nSo that's a big problem.\n\n105\n00:05:08.800 --> 00:05:11.470\nAnd that's one reason why we\nneed to isolate customers is\n\n106\n00:05:11.470 --> 00:05:14.600\nsome customers are responsible,\nmost aren't.\n\n107\n00:05:14.600 --> 00:05:17.500\nYou don't want to share a network\nwith those kinds of people.\n\n108\n00:05:17.500 --> 00:05:20.050\nEven within your own company\nthat can be a problem.\n\n109\n00:05:20.050 --> 00:05:22.850\nSo using this database\nserver's a great example here.\n\n110\n00:05:22.850 --> 00:05:24.420\nI don't want people on\nthe Internet to be able\n\n111\n00:05:24.420 --> 00:05:26.430\nto directly connect to\nthe database server.\n\n112\n00:05:26.430 --> 00:05:29.840\nI only want them to be able to\ngo through WEB02, this server.\n\n113\n00:05:29.840 --> 00:05:32.660\nAnd then communicate to the database\nthrough the webpage, all right?\n\n114\n00:05:32.660 --> 00:05:34.500\nJust the web server talks to it.\n\n115\n00:05:34.500 --> 00:05:36.570\nBut if an attacker can get in and\n\n116\n00:05:36.570 --> 00:05:39.070\npenetrate WEB01,\nthis guy that's unrelated, right?\n\n117\n00:05:39.070 --> 00:05:42.850\nCompletely separate website, they're able\nto jump over and start to attack it, too.\n\n118\n00:05:42.850 --> 00:05:46.660\nSo, you don't have to be an ISP to have\nthis problem, even a regular business can.\n\n119\n00:05:46.660 --> 00:05:51.160\nAll right, so\nwhat are the solutions at our disposal?\n\n120\n00:05:51.160 --> 00:05:55.170\nWell, on the customer side,\nwe could do customer VLANs.\n\n121\n00:05:55.170 --> 00:05:58.630\nRight, so, if I have servers for\n\n122\n00:05:58.630 --> 00:06:01.940\ncustomer one I could put them in a VLAN\nlike I've got them here in VLAN1.\n\n123\n00:06:01.940 --> 00:06:05.340\nAnd then I can take the servers for\ncustomer two and put them in VLAN2.\n\n124\n00:06:05.340 --> 00:06:08.100\nAnd other people VLAN three,\nfour, five and so on, right?\n\n125\n00:06:08.100 --> 00:06:09.330\nWe got plenty of VLANs.\n\n126\n00:06:09.330 --> 00:06:10.630\nSo you isolate them like this and\n\n127\n00:06:10.630 --> 00:06:15.630\nwhen you do that, now the hacker\nbreaks into Web01 for Customer 2.\n\n128\n00:06:15.630 --> 00:06:19.010\nThey're stuck inside of VLAN two and\nthey can't get out.\n\n129\n00:06:19.010 --> 00:06:19.570\nRight?\n\n130\n00:06:19.570 --> 00:06:22.880\nThat gives us protection by customer but\n\n131\n00:06:22.880 --> 00:06:27.020\nit doesn't necessarily protect us\nhere within being a single customer.\n\n132\n00:06:27.020 --> 00:06:29.650\nSomebody breaks into one web\nserver they can still jump and\n\n133\n00:06:29.650 --> 00:06:31.510\nleapfrog into some of these other servers.\n\n134\n00:06:31.510 --> 00:06:34.510\nIt still leaves us vulnerable there,\nright?\n\n135\n00:06:34.510 --> 00:06:36.190\nThere is another problem though.\n\n136\n00:06:36.190 --> 00:06:38.060\nThere's a lot of\nadministrative effort here.\n\n137\n00:06:38.060 --> 00:06:41.931\nIf we're gonna have multiple VLANs,\neach one has to have their own subnet.\n\n138\n00:06:41.931 --> 00:06:45.461\nSo I have to have a different IP range for\neach of these VLANs.\n\n139\n00:06:45.461 --> 00:06:47.040\nSo now I'm starting to\nhave multiple networks.\n\n140\n00:06:47.040 --> 00:06:50.580\nAnd if I have multiple networks\nI've gotta route for them, right?\n\n141\n00:06:50.580 --> 00:06:53.870\nSo I'm either gonna need a layer\nthree switch to do the routing.\n\n142\n00:06:53.870 --> 00:06:56.450\nOr I'm gonna need a firewall\nwith a trunk port on it, or\n\n143\n00:06:56.450 --> 00:06:59.790\nmultiple interfaces to be able to\nroute each of these guys separately.\n\n144\n00:06:59.790 --> 00:07:02.380\nAnd I'm gonna have to\nmaintain firewall rules and\n\n145\n00:07:02.380 --> 00:07:04.550\nfilters based on these separate networks.\n\n146\n00:07:04.550 --> 00:07:06.840\nIf I'm doing a layer three switch,\n\n147\n00:07:06.840 --> 00:07:09.830\nwhat access does a layer 3\nswitch block by default?\n\n148\n00:07:09.830 --> 00:07:11.620\nNone.\nIt allows everything by default.\n\n149\n00:07:11.620 --> 00:07:14.470\nSo it's fully routing between these VLANs,\nif we turn it on.\n\n150\n00:07:14.470 --> 00:07:16.401\nSo we gotta go and put in ACLs.\n\n151\n00:07:16.401 --> 00:07:18.851\nIt's pretty challenging to go through and\ndo that.\n\n152\n00:07:18.851 --> 00:07:20.920\nSo there's a lot of administrative\nburden with this solution.\n\n153\n00:07:20.920 --> 00:07:23.150\nBut it does work,\nyou certainly can do this.\n\n154\n00:07:23.150 --> 00:07:26.030\nAnd I know a lot of people that\nare doing this right now even\n\n155\n00:07:26.030 --> 00:07:27.530\nthough there is a better way.\n\n156\n00:07:27.530 --> 00:07:28.730\nRight?\n\n157\n00:07:28.730 --> 00:07:30.840\nIf we really wanted to go hard core,\n\n158\n00:07:30.840 --> 00:07:33.470\nwe could start breaking it\nup into even more VLAN's.\n\n159\n00:07:33.470 --> 00:07:36.630\nSo customer two over here,\nthey are in their own VLAN, that's fine.\n\n160\n00:07:36.630 --> 00:07:39.660\nBut customer one, maybe I split\noff one of their web servers,\n\n161\n00:07:39.660 --> 00:07:42.130\nthat one that's separate,\ninto one VLAN and\n\n162\n00:07:42.130 --> 00:07:45.370\nI start splitting the other web server and\nits database into a separate one.\n\n163\n00:07:45.370 --> 00:07:47.740\nSo now I'm starting to isolate\nmy servers a little more.\n\n164\n00:07:47.740 --> 00:07:50.990\nBut now, the administrative\nefforts are getting even higher.\n\n165\n00:07:50.990 --> 00:07:52.670\nI've got more and more VLANs.\n\n166\n00:07:52.670 --> 00:07:57.321\nThat's either more interfaces on a router,\ntrunk ports on a firewall,\n\n167\n00:07:57.321 --> 00:07:58.933\nmore subnets to manage.\n\n168\n00:07:58.933 --> 00:08:00.950\nThings start getting more and\nmore complex.\n\n169\n00:08:00.950 --> 00:08:03.202\nAnd all I really wanted to do\nwas isolate a couple hosts.\n\n170\n00:08:03.202 --> 00:08:07.990\nThat's it, right, and I end up with\nthis network that's insanely complex.\n\n171\n00:08:07.990 --> 00:08:10.950\n>> So, after a couple of weeks of this,\nwe have a network administrator,\n\n172\n00:08:10.950 --> 00:08:11.740\nhe's on the roof.\n\n173\n00:08:11.740 --> 00:08:13.135\nWe're talking him down.\n\n174\n00:08:13.135 --> 00:08:13.850\n>> [LAUGH]\n>> Saying hey now,\n\n175\n00:08:13.850 --> 00:08:15.590\nbuddy, life's worth living.\n\n176\n00:08:15.590 --> 00:08:18.490\nI know this VLAN business you got\ngoing on is a little difficult but\n\n177\n00:08:18.490 --> 00:08:20.380\nthere is a better way right Don.\n\n178\n00:08:20.380 --> 00:08:23.990\n>> Absolutely, yeah we wanna avoid\nthis administrative burden we wanna\n\n179\n00:08:23.990 --> 00:08:26.720\ncome up with a better solution and\nCisco has already done this for us.\n\n180\n00:08:26.720 --> 00:08:28.518\nIn what is called a private VLAN.\n\n181\n00:08:28.518 --> 00:08:33.980\nA private VLAN is a magical beast\nkinda like the unicorn and a.\n\n182\n00:08:33.980 --> 00:08:36.660\nIt's a VLAN that functions\ndifferent than normal VLANs.\n\n183\n00:08:37.800 --> 00:08:43.290\nWith a private VLAN,\nyou can designate within that single VLAN,\n\n184\n00:08:43.290 --> 00:08:46.650\nwhat hosts one computer can talk to.\n\n185\n00:08:46.650 --> 00:08:49.780\nSo you can actually\nrestrict people's access\n\n186\n00:08:49.780 --> 00:08:54.770\nas if you had a bunch of independent\nVLANs but you have one VLAN.\n\n187\n00:08:54.770 --> 00:08:57.590\nSo the awesome part of that\nis you have one subnet.\n\n188\n00:08:57.590 --> 00:08:58.390\nOne network.\n\n189\n00:08:58.390 --> 00:09:02.460\nSo I don't have to create a bunch of IP\nsub nets and you really have one VLAN.\n\n190\n00:09:02.460 --> 00:09:05.390\nYou'll see when I set this\nup that you end up with 3,\n\n191\n00:09:05.390 --> 00:09:09.650\nreally a minimum of 2 but\nprobably 3, 4 10, 100 VLANs,\n\n192\n00:09:09.650 --> 00:09:15.530\nbut the way that it's applied,\nit's treated as a single VLAN.\n\n193\n00:09:15.530 --> 00:09:18.670\nAnd that makes life a lot easier on us,\nand allows us to quickly and\n\n194\n00:09:18.670 --> 00:09:20.110\neasily create that separation.\n\n195\n00:09:20.110 --> 00:09:25.080\nAll right, so if I take this diagram and\nchange it to use private VLANs,\n\n196\n00:09:25.080 --> 00:09:27.210\nwhat does that do for me?\n\n197\n00:09:27.210 --> 00:09:31.090\n>> Well,\nI could create a VLAN like VLAN 10 and\n\n198\n00:09:31.090 --> 00:09:35.290\nI could flag VLAN 10 as a private VLAN.\n\n199\n00:09:35.290 --> 00:09:37.700\nWhen I do that,\nit still functions like a normal VLAN.\n\n200\n00:09:37.700 --> 00:09:39.920\nI could assign all of\nmy ports The VLAN 10.\n\n201\n00:09:39.920 --> 00:09:41.500\n>> You've got one VLAN.\n\n202\n00:09:41.500 --> 00:09:45.070\nOne IP subnet, one network, all right?\n\n203\n00:09:45.070 --> 00:09:50.380\nBut then, the private VLAN\nallows me to assign port by port\n\n204\n00:09:50.380 --> 00:09:53.115\nan individual status, all right?\n\n205\n00:09:53.115 --> 00:09:57.625\nThe name status that we're gonna\nuse is one called isolated.\n\n206\n00:09:57.625 --> 00:10:01.845\nAnd an isolated host is\na port on the switch\n\n207\n00:10:01.845 --> 00:10:06.680\nthat is only allowed to talk to\nwhat are called promiscuous ports.\n\n208\n00:10:06.680 --> 00:10:07.720\nAll right.\n\n209\n00:10:07.720 --> 00:10:11.410\nPromiscuous ports are devices that\nyou wanna share with everybody.\n\n210\n00:10:11.410 --> 00:10:13.280\nAnd it's normally just\ngonna be your gateway.\n\n211\n00:10:13.280 --> 00:10:17.530\nSo, if you take VLAN 10 here,\nI've got this firewall plugged into it.\n\n212\n00:10:17.530 --> 00:10:19.750\nI would flag the firewall as promiscuous.\n\n213\n00:10:19.750 --> 00:10:22.640\nI want everybody in this VLAN to be able\n\n214\n00:10:22.640 --> 00:10:24.700\nto go through the firewall to\nget out to the internet, right?\n\n215\n00:10:24.700 --> 00:10:25.690\nThat's the shared connection.\n\n216\n00:10:25.690 --> 00:10:26.830\nI'm gonna put my firewall rules here.\n\n217\n00:10:26.830 --> 00:10:28.200\nI'm gonna filter that access.\n\n218\n00:10:28.200 --> 00:10:31.360\nThey all need to be able to go out that\nfirewall to get to the internet or\n\n219\n00:10:31.360 --> 00:10:34.200\nthey need the incoming traffic to\ncome in through that firewall.\n\n220\n00:10:34.200 --> 00:10:36.721\nI'm gonna flag that port as promiscuous.\n\n221\n00:10:36.721 --> 00:10:41.349\nA promiscuous port can talk to any\nother port in the private VLAN.\n\n222\n00:10:41.349 --> 00:10:45.240\nNow you don't have to\nhave a promiscuous port.\n\n223\n00:10:45.240 --> 00:10:48.610\nI might have one router that's\ndesignated for one customer,\n\n224\n00:10:48.610 --> 00:10:50.310\nand another router designated for\nanother customer.\n\n225\n00:10:50.310 --> 00:10:52.710\nSo I don't just have one\nrouter flagged as promiscuous,\n\n226\n00:10:52.710 --> 00:10:55.480\nI have multiple that are tied\nto each individual customer.\n\n227\n00:10:55.480 --> 00:10:59.060\nYou can go that route, you've got that\ncontrol only can do if you have at least\n\n228\n00:10:59.060 --> 00:11:01.460\none gateway,\nthere's this flag that's promiscuous.\n\n229\n00:11:01.460 --> 00:11:07.410\nIf you are an isolated host, you are only\nallowed to talk to a promiscuous port.\n\n230\n00:11:07.410 --> 00:11:12.130\nSo I've got one VLAN, but\nwhen I flag this web server as isolated or\n\n231\n00:11:12.130 --> 00:11:15.370\nthis web server over here, customer two,\nwhen I flag it as isolated,\n\n232\n00:11:15.370 --> 00:11:18.190\nit can only talk to the firewall,\nthey can't talk to each other.\n\n233\n00:11:18.190 --> 00:11:20.455\nAny communication that goes\nbetween each other can't happen,\n\n234\n00:11:20.455 --> 00:11:22.640\ncuz they can't even see each other.\n\n235\n00:11:22.640 --> 00:11:24.010\nIt's like they're in separate VLANs.\n\n236\n00:11:25.300 --> 00:11:27.070\nBut in reality they're in one VLAN.\n\n237\n00:11:27.070 --> 00:11:31.190\nThey've got IP addresses that\nmight be right next to each other.\n\n238\n00:11:31.190 --> 00:11:36.440\nI might have 192.168.0.5 on this guy and\nthen I might have 192.168.0.6 on this guy.\n\n239\n00:11:38.440 --> 00:11:41.860\nSame subnet,\nsame default gateway and all that.\n\n240\n00:11:41.860 --> 00:11:43.000\nBut they can't even see each other.\n\n241\n00:11:43.000 --> 00:11:45.400\nThey can't even do a art broadcast to\nsee the Mac address of the other guy.\n\n242\n00:11:45.400 --> 00:11:47.030\nThey don't see anything.\n\n243\n00:11:47.030 --> 00:11:49.740\nRight?\nThey're completely isolated so\n\n244\n00:11:49.740 --> 00:11:52.420\ngoing back to my example\nof my cable modem at home.\n\n245\n00:11:52.420 --> 00:11:53.850\nI'm on a community network.\n\n246\n00:11:53.850 --> 00:11:57.620\nThere are thousands of other\ncable subscribers within\n\n247\n00:11:57.620 --> 00:11:59.410\na couple of miles of me I'm sure.\n\n248\n00:11:59.410 --> 00:12:03.110\nAnd all of us are on the same network.\n\n249\n00:12:03.110 --> 00:12:06.740\nBut I can't see any of them,\ncuz I'm isolated.\n\n250\n00:12:06.740 --> 00:12:10.380\nI can just see the default gateway back\nat the cable headquarters, and that's it.\n\n251\n00:12:10.380 --> 00:12:11.950\nThat's the only thing\nI can communicate to.\n\n252\n00:12:11.950 --> 00:12:15.050\nIf I look at the subnet mask on\nmy network, it's pretty big.\n\n253\n00:12:15.050 --> 00:12:17.500\nRight, it's I forget\nexactly how big it is,\n\n254\n00:12:17.500 --> 00:12:19.770\nit's like eight class c's bonded together,\nor something like that.\n\n255\n00:12:19.770 --> 00:12:23.570\nAnd, so that means there's room for\na couple of thousand people out there, and\n\n256\n00:12:23.570 --> 00:12:24.770\nI don't see them at all.\n\n257\n00:12:24.770 --> 00:12:25.330\nRight?\n\n258\n00:12:25.330 --> 00:12:27.490\nIt doesn't mean those\nIPs are being wasted.\n\n259\n00:12:27.490 --> 00:12:28.110\nI'm just being blocked.\n\n260\n00:12:28.110 --> 00:12:28.990\nI can't see them.\n\n261\n00:12:28.990 --> 00:12:30.710\nAnd that's what an isolated port does.\n\n262\n00:12:30.710 --> 00:12:34.530\nSo isolated is a great thing to make it\nwhere that server can still get out to\n\n263\n00:12:34.530 --> 00:12:35.940\nthe internet, and that's it.\n\n264\n00:12:37.870 --> 00:12:40.340\nRight?\nBut, in my example I mentioned how\n\n265\n00:12:40.340 --> 00:12:43.510\nwe had a web server that needed\nto talk to a database server.\n\n266\n00:12:43.510 --> 00:12:46.280\nRight, so if I isolate them,\nthey can't talk to each other.\n\n267\n00:12:46.280 --> 00:12:49.400\nNow, the web server can't get to\nthe database server, that's a problem.\n\n268\n00:12:49.400 --> 00:12:50.110\nRight?\n\n269\n00:12:50.110 --> 00:12:53.740\nI could add a second NIC to them and\nrun a physical cable or whatever but\n\n270\n00:12:53.740 --> 00:12:56.270\nin this day and age of Virtual Machines\nyou don't wanna mess with that.\n\n271\n00:12:56.270 --> 00:12:58.648\n>> And\nyou're starting to talk about work again.\n\n272\n00:12:58.648 --> 00:12:59.156\n>> [LAUGH]\n>> Yeah.\n\n273\n00:12:59.156 --> 00:12:59.664\n>> [LAUGH]\n\n274\n00:12:59.664 --> 00:13:00.734\n>> We try to stay away from that.\n\n275\n00:13:00.734 --> 00:13:01.839\n>> That's kinda the whole point,\n\n276\n00:13:01.839 --> 00:13:02.729\nyeah.\nSo,\n\n277\n00:13:02.729 --> 00:13:05.599\ninstead there's a different type\nof flag we can put on a port,\n\n278\n00:13:05.599 --> 00:13:07.499\ncalled a community.\nAll right.\n\n279\n00:13:07.499 --> 00:13:08.869\nYou can create many,\n\n280\n00:13:08.869 --> 00:13:11.519\nmany communities.\nAnd what a community is,\n\n281\n00:13:11.519 --> 00:13:14.240\nis a collection of ports that\nare allowed to talk to each other.\n\n282\n00:13:14.240 --> 00:13:17.540\nAnd so we could take,\ngoing back to my example here.\n\n283\n00:13:17.540 --> 00:13:20.620\nWe could take WEB02 and\nthis database server and\n\n284\n00:13:20.620 --> 00:13:23.580\nwe could flag their\nports as community one.\n\n285\n00:13:23.580 --> 00:13:25.980\nCommunity 2, Community 5,\nCommunity 500, right.\n\n286\n00:13:25.980 --> 00:13:27.530\nYou just give it a community number.\n\n287\n00:13:28.730 --> 00:13:33.500\nAnd once they're in a community,\nthese two can talk to each other and\n\n288\n00:13:33.500 --> 00:13:35.240\nthey can talk to the promiscuous port.\n\n289\n00:13:35.240 --> 00:13:37.940\nSo now, the web server can\ntalk to the database server.\n\n290\n00:13:37.940 --> 00:13:39.900\nAnd the web server can still\nget out to the internet and\n\n291\n00:13:39.900 --> 00:13:41.090\nreceive those communications.\n\n292\n00:13:42.140 --> 00:13:44.990\nThat means the database server could\nreceive communications on the internet too\n\n293\n00:13:44.990 --> 00:13:48.620\nso I still need my firewall\nrules to protect it, but\n\n294\n00:13:48.620 --> 00:13:50.340\nthe isolated web server over here,\n\n295\n00:13:50.340 --> 00:13:53.180\nthe isolated web server over here, they\ncan't talk to that database server at all.\n\n296\n00:13:53.180 --> 00:13:54.910\nThey don't even see it on the network.\n\n297\n00:13:54.910 --> 00:13:56.500\nAnd you can have more than one community.\n\n298\n00:13:56.500 --> 00:14:00.230\nSo consider the example I gave\nof having customer VLANs.\n\n299\n00:14:00.230 --> 00:14:03.510\nInstead of putting each customer in their\nVLAN I might put each customer in their\n\n300\n00:14:03.510 --> 00:14:06.730\nown community so\ntheir servers can see each other.\n\n301\n00:14:06.730 --> 00:14:09.420\nBut if they have one server\nthey want to be isolated,\n\n302\n00:14:09.420 --> 00:14:11.210\nwe can just flag it as isolated.\n\n303\n00:14:11.210 --> 00:14:13.480\nSo, when we deal with a private VLAN,\n\n304\n00:14:13.480 --> 00:14:15.440\nwe create it much the same\nway as a regular VLAN.\n\n305\n00:14:15.440 --> 00:14:17.140\nYou just define it, VLAN 10, right?\n\n306\n00:14:17.140 --> 00:14:19.630\nSo, I type that in, give it a name.\n\n307\n00:14:19.630 --> 00:14:21.980\nBut once we tag that as private,\n\n308\n00:14:21.980 --> 00:14:24.670\nthat's when we enable\nthe ability to apply these tags.\n\n309\n00:14:24.670 --> 00:14:25.480\nOkay?\n\n310\n00:14:25.480 --> 00:14:28.790\nAnd these tags are actually\napplied as VLAN numbers.\n\n311\n00:14:28.790 --> 00:14:30.690\nThey're not really VLANs though.\n\n312\n00:14:30.690 --> 00:14:34.110\nSo I might have VLAN 10 as my actual VLAN.\n\n313\n00:14:34.110 --> 00:14:37.080\nAnd then I create VLAN 11.\n\n314\n00:14:37.080 --> 00:14:42.690\nAnd on VLAN 11 I say\nthat's my isolated system.\n\n315\n00:14:42.690 --> 00:14:45.650\nAnd then any port that I flag\non VLAN 11 is now isolated.\n\n316\n00:14:47.120 --> 00:14:49.920\nAnd then I might take community\none here and make that VLAN 12.\n\n317\n00:14:49.920 --> 00:14:54.810\nAnd so, anybody assigned to\nVLAN 12 is in community one.\n\n318\n00:14:54.810 --> 00:14:58.600\nAnd then I might have VLAN 13 and\nthat's community two,\n\n319\n00:14:58.600 --> 00:15:01.470\nVLAN 14 is community three, and\nso I just go through my ports and\n\n320\n00:15:01.470 --> 00:15:06.000\nI assign them to the right VLAN and\nthey're all in VLAN ten but\n\n321\n00:15:06.000 --> 00:15:10.380\nnow they're isolated or\nin a community or promiscuous right?\n\n322\n00:15:10.380 --> 00:15:13.280\nThey've got that kinda flag attached to\nthem so they know how to participate.\n\n323\n00:15:13.280 --> 00:15:13.920\nAll right.\n\n324\n00:15:13.920 --> 00:15:18.510\nSo that's where this becomes really\npowerful as that we truly have one VLAN.\n\n325\n00:15:18.510 --> 00:15:20.390\nAnd we're just giving\npeople different statuses.\n\n326\n00:15:20.390 --> 00:15:22.120\nRight?\nSo, makes life a lot easier.\n\n327\n00:15:22.120 --> 00:15:24.690\nYou have one subnet,\nand everything's done.\n\n328\n00:15:24.690 --> 00:15:25.220\n>> All right, Don.\n\n329\n00:15:25.220 --> 00:15:29.090\nNow, this all sounds great and\nwe like the idea.\n\n330\n00:15:29.090 --> 00:15:33.410\nIs implementation difficult, or\nis it pretty simple, straightforward, and\n\n331\n00:15:33.410 --> 00:15:37.960\nonce you're done is there any kinda\nafter effects that we gotta get into?\n\n332\n00:15:37.960 --> 00:15:39.130\n>> Yeah, it's not that hard but\n\n333\n00:15:39.130 --> 00:15:40.800\nthe commands are different\nthan what we're used to.\n\n334\n00:15:40.800 --> 00:15:44.320\nSo it's not just doing switch port,\naccess VLAN 11.\n\n335\n00:15:44.320 --> 00:15:49.130\nThere's a little more cuz what you have to\ndo is you have to put it in VLAN 10, and\n\n336\n00:15:49.130 --> 00:15:51.830\nthen attach it to VLAN 11,\nor VLAN 12 or whatever.\n\n337\n00:15:51.830 --> 00:15:54.015\nAnd that's something that's\ndifferent than normal.\n\n338\n00:15:54.015 --> 00:15:56.020\nSo let me show you how that works.\n\n339\n00:15:56.020 --> 00:15:57.711\nI'm gonna switch over my to routers and\n\n340\n00:15:57.711 --> 00:16:00.027\nthen we'll get a chance to\nkinda jump in and see that.\n\n341\n00:16:00.027 --> 00:16:04.740\nNow Basically what I have to do is I\nhave to start by creating the VLANs, and\n\n342\n00:16:04.740 --> 00:16:08.920\nthen once they've been created,\nI flag them as private VLANs and\n\n343\n00:16:08.920 --> 00:16:11.470\nthen we go and attach them to the ports.\n\n344\n00:16:11.470 --> 00:16:14.720\nSo, lets take a look at how that\nworks on the actual router.\n\n345\n00:16:14.720 --> 00:16:16.920\nThe whole configuration\nkind of starts out normal,\n\n346\n00:16:16.920 --> 00:16:18.740\nwe have to create some VLANS, right?\n\n347\n00:16:18.740 --> 00:16:23.309\nAnd so if I take a look at the VLANs I\nhave right now, I\"ve got VLAN1.\n\n348\n00:16:23.309 --> 00:16:26.090\nI\"ve got VLAN99,\nwhich we used in the R Span episode,\n\n349\n00:16:26.090 --> 00:16:28.090\nbut I just have VLAN one and that's it.\n\n350\n00:16:28.090 --> 00:16:30.882\nIf this is going to be my DMZ switch,\n\n351\n00:16:30.882 --> 00:16:33.890\nI just need to jump through and\ndo a few kinda configuration things.\n\n352\n00:16:33.890 --> 00:16:38.560\nNow remember, on a DMZ switch you don't\nwant these VLANs spreading to any\n\n353\n00:16:38.560 --> 00:16:42.190\nother host in your network or\nto other switches.\n\n354\n00:16:42.190 --> 00:16:42.946\nAnd if you're running VTP,\n\n355\n00:16:42.946 --> 00:16:46.905\nwhich Cisco switches do Do by default,\nwe'll start participating in it.\n\n356\n00:16:46.905 --> 00:16:49.815\nWell not every switch\nsupports private VLAN so\n\n357\n00:16:49.815 --> 00:16:52.115\nI don't want this information\nspreading out to other switches.\n\n358\n00:16:52.115 --> 00:16:55.865\nI want to control it and you really\nwant to limit it to a single switch.\n\n359\n00:16:55.865 --> 00:17:00.905\nSo the best way to do that is to move\nyourself into VTP mode transparent.\n\n360\n00:17:00.905 --> 00:17:04.385\nAnd when we do that,\n\n361\n00:17:04.385 --> 00:17:08.710\nthat'll make sure that we're\nnot participating in VTP and\n\n362\n00:17:08.710 --> 00:17:12.170\nthen any VLAN we work with is really just\nlocal here on this switch which is really\n\n363\n00:17:12.170 --> 00:17:16.690\na necessity of private VLAN cuz you can't\nspread a private VLAN across multiple\n\n364\n00:17:16.690 --> 00:17:20.765\nswitches and have it work properly\nit can't handle the tags for that.\n\n365\n00:17:20.765 --> 00:17:22.975\nSo, now that I've done that,\nI can create my VLANs and so\n\n366\n00:17:22.975 --> 00:17:26.135\nmaybe I'll start with VLAN 10 and\nI'll just call that my,\n\n367\n00:17:26.135 --> 00:17:30.685\nthere's different names, you'll see some\npeople refer to it as the common VLAN.\n\n368\n00:17:30.685 --> 00:17:32.970\nThis is the VLAN that all\nthe ports are a part of.\n\n369\n00:17:32.970 --> 00:17:36.940\nYou might call it your primary v land or\nprivate VLAN.\n\n370\n00:17:36.940 --> 00:17:38.480\nWhatever it is that you want to call it.\n\n371\n00:17:38.480 --> 00:17:41.530\nI will call mine the Primary VLAN.\n\n372\n00:17:41.530 --> 00:17:44.170\nSo that's going to be my primary.\n\n373\n00:17:44.170 --> 00:17:48.790\nAlright and then I've got to\nstart creating my other VLAN and\n\n374\n00:17:48.790 --> 00:17:51.310\nthe number that I create\nis kind of up to me.\n\n375\n00:17:51.310 --> 00:17:55.521\nRight, at a minimum you're going to\nbe flagging some hosts as isolated.\n\n376\n00:17:55.521 --> 00:17:58.550\nSo we need one VLAN to\nrepresent the isolated host.\n\n377\n00:17:58.550 --> 00:18:02.630\nSo I'm gonna create VLAN 11 and\nI'll just call it isolated.\n\n378\n00:18:03.720 --> 00:18:07.970\nSo that name doesn't mean anything to the\nsystem, so I didn't actually change it,\n\n379\n00:18:07.970 --> 00:18:11.180\nI just called it isolated so\nI could remember it cuz I I forget things.\n\n380\n00:18:11.180 --> 00:18:16.490\nSo the important part here is\nwhere we say private-VLAN and\n\n381\n00:18:16.490 --> 00:18:19.020\nthen we tell it the kind\nof private VLAN it is.\n\n382\n00:18:19.020 --> 00:18:22.179\nIn this case, it is isolated.\n\n383\n00:18:22.179 --> 00:18:24.652\nAnd if you do a question mark there,\nyou'll see the different modes.\n\n384\n00:18:24.652 --> 00:18:27.815\nSo we can do community, isolated, primary.\n\n385\n00:18:27.815 --> 00:18:30.865\nRight and the we'll see that\nassociation command the minute where we\n\n386\n00:18:30.865 --> 00:18:35.055\ntie all these things together but\nI want this one to be isolated.\n\n387\n00:18:35.055 --> 00:18:36.995\nAlright, so I created VLAN 10.\n\n388\n00:18:36.995 --> 00:18:38.115\nI just named it primary.\n\n389\n00:18:38.115 --> 00:18:39.430\nA normal VLAN.\n\n390\n00:18:39.430 --> 00:18:40.760\nThen I created VLAN11.\n\n391\n00:18:40.760 --> 00:18:43.967\nAnd I marked it as\na private VLAN isolator.\n\n392\n00:18:45.150 --> 00:18:47.470\nNow I can go on to create like VLAN12.\n\n393\n00:18:47.470 --> 00:18:52.638\nWhich maybe I'll call\nthat one community one.\n\n394\n00:18:52.638 --> 00:18:56.957\nAnd I'll set that one as\nprivate VLAN community and\n\n395\n00:18:56.957 --> 00:19:00.381\nthen I can specify that's what that is.\n\n396\n00:19:00.381 --> 00:19:04.791\nAnd I don't need to throw a number on\nthe end of it because I'm using the VLAN\n\n397\n00:19:04.791 --> 00:19:09.481\nnumber so this is VLAN12 that's where\nit so its technically community 12.\n\n398\n00:19:09.481 --> 00:19:13.370\nBut each one that we create is\ntied to their own VLAN number.\n\n399\n00:19:13.370 --> 00:19:17.805\nSo if I wanted to create another one,\nfor example if I wanna do VLAN13,\n\n400\n00:19:17.805 --> 00:19:19.636\nI can name that Community2.\n\n401\n00:19:19.636 --> 00:19:21.730\nOr you'd probably name it\nafter your customer or\n\n402\n00:19:21.730 --> 00:19:23.730\nthe service that these\nservers were running.\n\n403\n00:19:23.730 --> 00:19:26.780\nSomething where you could remember\nwhy you had that community.\n\n404\n00:19:26.780 --> 00:19:31.580\nAnd then you would flag them as\nbeing community ports, right?\n\n405\n00:19:31.580 --> 00:19:35.300\nSo, I have two different communities,\nbut one's tied to VLAN 12 and\n\n406\n00:19:35.300 --> 00:19:36.800\none's tied to VLAN 13, right?\n\n407\n00:19:38.130 --> 00:19:40.130\nSo, VLAN 11 was isolated.\n\n408\n00:19:40.130 --> 00:19:41.770\n12 is community 1.\n\n409\n00:19:41.770 --> 00:19:43.530\n13 is community 2.\n\n410\n00:19:43.530 --> 00:19:46.390\nWhat about that primary that\nI created in the beginning?\n\n411\n00:19:46.390 --> 00:19:51.060\nWell the primary VLAN, VLAN 10,\nneeds to tie all these together.\n\n412\n00:19:51.060 --> 00:19:53.994\nSo to tie them together I need\nto get back into that VLAN.\n\n413\n00:19:53.994 --> 00:19:54.960\nSo I'm going to say VLAN 10.\n\n414\n00:19:54.960 --> 00:19:57.740\nAnd this is the one that I named primary.\n\n415\n00:19:57.740 --> 00:20:01.020\nAnd then I'm just going to use that\nassociation command we saw a moment ago.\n\n416\n00:20:01.020 --> 00:20:08.010\nI'm going to say private, dash,\nVLAN association 11 through 13.\n\n417\n00:20:08.010 --> 00:20:10.640\nOr whatever numbers you used,\nyou can use commas and\n\n418\n00:20:10.640 --> 00:20:12.680\nhyphens to get all the different\nnumbers that you use.\n\n419\n00:20:12.680 --> 00:20:15.950\nIf you created ten In different\ncommunities I'd need to list all ten of\n\n420\n00:20:15.950 --> 00:20:17.700\nthose VLANs here.\n\n421\n00:20:17.700 --> 00:20:21.670\nSo what this is going to tell the system\nis that VLAN 10 is a private VLAN but\n\n422\n00:20:21.670 --> 00:20:23.200\nit's the main one.\n\n423\n00:20:23.200 --> 00:20:28.150\nAnd all these other guys are associated\nwith it providing isolated or\n\n424\n00:20:28.150 --> 00:20:29.540\ncommunity ports.\n\n425\n00:20:29.540 --> 00:20:33.270\nAlright, now notice,\nI didn't do any promiscuous ports.\n\n426\n00:20:33.270 --> 00:20:35.200\nA promiscuous port can access everything,\nso\n\n427\n00:20:35.200 --> 00:20:38.010\nwe don't actually have to\ncreate a dedicated VLAN for it.\n\n428\n00:20:38.010 --> 00:20:39.450\nIt goes into the primary.\n\n429\n00:20:39.450 --> 00:20:42.410\nAlright, and so\nthat kind of our next step here.\n\n430\n00:20:42.410 --> 00:20:44.200\nNow what I need to do,\nis I need to take my switch.\n\n431\n00:20:44.200 --> 00:20:46.310\nAnd go through and start assigning ports.\n\n432\n00:20:46.310 --> 00:20:53.220\nSo maybe for the first eight ports on my\nswitch, I want those to be just isolated.\n\n433\n00:20:53.220 --> 00:20:56.300\nSo each port is treated independently,\nright?\n\n434\n00:20:56.300 --> 00:20:58.700\nOr we'd probably set up our gateway first,\nright?\n\n435\n00:20:58.700 --> 00:21:00.100\nSo let's pretend here.\n\n436\n00:21:00.100 --> 00:21:03.440\nWe'll pretend that port one has\nmy firewall, has my gateway so\n\n437\n00:21:03.440 --> 00:21:05.410\nI want that one to be promiscuous.\n\n438\n00:21:05.410 --> 00:21:10.890\nAnd then maybe I'll do ports\ntwo through 16 as isolated.\n\n439\n00:21:10.890 --> 00:21:13.178\nAnd so these are the ones that are\ncompletely separate from each other but\n\n440\n00:21:13.178 --> 00:21:14.010\ncan see that firewall.\n\n441\n00:21:14.010 --> 00:21:17.070\nSo, I'll start with port one,\n\n442\n00:21:17.070 --> 00:21:21.180\nand I'm gonna jump in there, I'm gonna\nflag it as that promiscuous port.\n\n443\n00:21:21.180 --> 00:21:25.275\nAnd so the way we do that is kind of\ninteresting, we have to say switchport,\n\n444\n00:21:25.275 --> 00:21:31.280\nprivate-VLANMapping.\n\n445\n00:21:31.280 --> 00:21:35.880\nSo I'm mapping a VLAN to it,\nand it's gonna be VLAN 10.\n\n446\n00:21:35.880 --> 00:21:36.960\nRight?\n\n447\n00:21:36.960 --> 00:21:41.318\nNow when I say that it's letting it\nknow that, this guy's in vlan 10 but\n\n448\n00:21:41.318 --> 00:21:44.680\nit's a private-vlan.\n\n449\n00:21:44.680 --> 00:21:46.220\nAnd I need to tell it,\n\n450\n00:21:46.220 --> 00:21:50.410\nbecause this one's promiscuous,\nthat it sees the other networks also.\n\n451\n00:21:50.410 --> 00:21:51.730\nAnd so I add to this a little more.\n\n452\n00:21:51.730 --> 00:21:53.290\nThis is where it really gets weird.\n\n453\n00:21:53.290 --> 00:21:55.240\nCuz, I need to say 11 dash 13, right?\n\n454\n00:21:55.240 --> 00:21:59.430\nI want a promiscuous port to\nbe able to see all of these.\n\n455\n00:21:59.430 --> 00:22:05.780\nSo, tied it to VLAN 10 but\nI've associated it with 11 to 13, also.\n\n456\n00:22:05.780 --> 00:22:10.528\nNow, if I stop there, it's actually\na broken config and this port won't\n\n457\n00:22:10.528 --> 00:22:15.137\nwork because I've got it in isolated\nports as well as community VLANs.\n\n458\n00:22:15.137 --> 00:22:17.412\nSo, it breaks it, all right?\n\n459\n00:22:17.412 --> 00:22:20.271\nIt normally expects you to just\nprovide one VLAN here, at the end,\n\n460\n00:22:20.271 --> 00:22:22.440\nto actually tie to, I provided three.\n\n461\n00:22:22.440 --> 00:22:24.430\nSo, I need to follow it\nup with one more command.\n\n462\n00:22:24.430 --> 00:22:31.290\nWhich is switchport mode\nprivate-VLAN promiscuous.\n\n463\n00:22:31.290 --> 00:22:36.480\nAll rightt, that's what tells it it's\nokay to be in more than one VLAN.\n\n464\n00:22:36.480 --> 00:22:38.270\nAnd now, that port?\n\n465\n00:22:38.270 --> 00:22:39.630\nIt's in VLAN10.\n\n466\n00:22:39.630 --> 00:22:43.270\nIt's also in VLAN 11, 12, and 13.\n\n467\n00:22:43.270 --> 00:22:46.390\nAnd so anybody in any of those VLANs\nwill be able to see this port.\n\n468\n00:22:46.390 --> 00:22:49.910\nIf I plug my firewall into it,\nit's going to be seen right here.\n\n469\n00:22:49.910 --> 00:22:54.710\nAll right, now, my interface went down,\nand it's kinda staying down.\n\n470\n00:22:54.710 --> 00:22:55.630\nIt should come back up but\n\n471\n00:22:55.630 --> 00:22:58.590\nthere are certain configurations\nthat can kind of break this.\n\n472\n00:22:58.590 --> 00:23:03.780\nSo if I take a look at the configuration\nreal quick on port one I can see my stuff.\n\n473\n00:23:03.780 --> 00:23:06.290\nEverything else in here is pretty\nmuch the default, all right?\n\n474\n00:23:07.500 --> 00:23:10.370\nPrivate VLANs don't work on trunks.\n\n475\n00:23:10.370 --> 00:23:12.650\nThey really don't like to be trunked.\n\n476\n00:23:12.650 --> 00:23:15.090\nAnd so, we may wanna throw\na few extra commands on here,\n\n477\n00:23:15.090 --> 00:23:17.390\njust to make sure it's healthy and\nand happy.\n\n478\n00:23:17.390 --> 00:23:19.250\nIf it's trying to negotiate\ntrunking in the background,\n\n479\n00:23:19.250 --> 00:23:20.810\nit's going to break it and keep it down.\n\n480\n00:23:20.810 --> 00:23:23.410\nSo, if I issue a few extra commands here.\n\n481\n00:23:23.410 --> 00:23:26.540\nLike switchport mode access.\n\n482\n00:23:26.540 --> 00:23:30.290\nSwitchport, we can do no\nnegotiate if If we want but.\n\n483\n00:23:30.290 --> 00:23:31.990\nOh yeah, see,\nI didn't even have to right there.\n\n484\n00:23:31.990 --> 00:23:33.570\nThe port just came right up.\n\n485\n00:23:33.570 --> 00:23:38.330\nBut another one that we might want\nto throw up there is PortFast.\n\n486\n00:23:38.330 --> 00:23:41.370\nSince we're not trunking, there's no risk\nof a loop on this interface where I'm\n\n487\n00:23:41.370 --> 00:23:42.520\npulling it into a firewall.\n\n488\n00:23:42.520 --> 00:23:48.890\nSo we might wanna do spanning-tree\nportfast, if we can get it, there we go.\n\n489\n00:23:48.890 --> 00:23:51.196\nTo make sure it's healthy and\nhappy and all that, and so\n\n490\n00:23:51.196 --> 00:23:52.679\nnow it's kind of flipping that on.\n\n491\n00:23:52.679 --> 00:23:55.730\nBut that's why my port went down as it was\nnegotiating trunking in the background.\n\n492\n00:23:55.730 --> 00:23:57.533\nSo switchport mode access\ntook care of that.\n\n493\n00:23:57.533 --> 00:24:02.199\nBut if I take a look at the config now,\nAnd look at it.\n\n494\n00:24:02.199 --> 00:24:04.602\nIt's flagged as an access port, and\n\n495\n00:24:04.602 --> 00:24:09.830\nyou'll see that it has got that\nprivate-vlan mapping of 10 and 11-13.\n\n496\n00:24:09.830 --> 00:24:16.260\nAnd my promiscuous mode disappeared,\nwhy is that?\n\n497\n00:24:16.260 --> 00:24:20.750\nWell, the promiscuous mode command,\nlet me get back to it here,\n\n498\n00:24:20.750 --> 00:24:24.070\nthe reason it disappears is the default.\n\n499\n00:24:24.070 --> 00:24:26.650\nWhen I start adding ports to this vlan\n\n500\n00:24:26.650 --> 00:24:29.880\nit's defaulting promiscuous on this\nswitch, not every switch does that.\n\n501\n00:24:29.880 --> 00:24:30.700\nOn some it breaks,\n\n502\n00:24:30.700 --> 00:24:33.310\non some it works, so on this switch\napparently that is the default.\n\n503\n00:24:33.310 --> 00:24:35.730\nI can rerun the command just\nto be on the safe side,\n\n504\n00:24:35.730 --> 00:24:38.920\njust to make sure it\nactually is the default.\n\n505\n00:24:38.920 --> 00:24:42.210\nAnd, whoops, and it might be that\nthe configuration didn't stick,\n\n506\n00:24:42.210 --> 00:24:44.560\nthat happens sometimes,\nand it's always annoying.\n\n507\n00:24:44.560 --> 00:24:45.120\nOh!\n\n508\n00:24:45.120 --> 00:24:46.690\nIn this case,\nthe configuration didn't stick.\n\n509\n00:24:46.690 --> 00:24:50.080\nYeah, so when I reran it there, it came\nback again, and so now it's up, and\n\n510\n00:24:50.080 --> 00:24:55.440\nyou'll see it killed my access command,\nand so now it's kinda got it down.\n\n511\n00:24:55.440 --> 00:24:56.790\nI don't have a host plugged\nin there right now, so\n\n512\n00:24:56.790 --> 00:24:58.210\nit's not too happy about that either.\n\n513\n00:24:58.210 --> 00:25:00.530\nBut now we've got it in there,\nand we're good to go.\n\n514\n00:25:00.530 --> 00:25:03.980\n>> It's always a good safety tip to make\nsure if you don't see that in the running\n\n515\n00:25:03.980 --> 00:25:07.040\nconfig on the interface, go ahead and\nretype that in, make sure it's there.\n\n516\n00:25:07.040 --> 00:25:07.950\n>> Double check, yeah.\n\n517\n00:25:07.950 --> 00:25:09.760\nEspecially, I find when\nyou work with VLANs,\n\n518\n00:25:09.760 --> 00:25:13.260\nbecause VLAN data is stored in that\nvlan.dat file, kind of separately.\n\n519\n00:25:13.260 --> 00:25:16.040\nAnd some times the commands don't stick so\nyou have to reissue them.\n\n520\n00:25:16.040 --> 00:25:18.790\nNow I've got my promiscuous\nmode port set up.\n\n521\n00:25:18.790 --> 00:25:20.320\nI've got it up, I've got it running.\n\n522\n00:25:20.320 --> 00:25:22.610\nNow I have to configure my other ones.\n\n523\n00:25:22.610 --> 00:25:27.520\nIf I want ports 2 thru 16 to be isolated,\nwhat I could do is I can just do\n\n524\n00:25:27.520 --> 00:25:33.070\nan interface range command, and\nI can grab those ports 2 thru 16,\n\n525\n00:25:33.070 --> 00:25:37.100\nand I can just flag them all as\nisolated all kind of at once.\n\n526\n00:25:37.100 --> 00:25:43.960\nSo I can jump in, I can just say\nswitchport mode private-vlan.\n\n527\n00:25:43.960 --> 00:25:46.720\nAnd once I set that\nprivate-vlan I can say host.\n\n528\n00:25:47.780 --> 00:25:50.880\nSo, that it know that we're\ndealing with a host on here.\n\n529\n00:25:50.880 --> 00:25:53.597\nAnd, actually hang on,\nbefore I do the host,\n\n530\n00:25:53.597 --> 00:25:56.956\nI'm pretty sure I need to set\nmy association, which is.\n\n531\n00:25:56.956 --> 00:26:02.120\nOh, wait,\nI'm doing my commands out of order.\n\n532\n00:26:02.120 --> 00:26:07.970\nSo, what we need to do, if I do these\nswitch board mode private-vlan host,\n\n533\n00:26:07.970 --> 00:26:10.800\nthat's what lets it know this\nport is not promiscuous and\n\n534\n00:26:10.800 --> 00:26:12.520\nthat it's participating in a private VLAN.\n\n535\n00:26:12.520 --> 00:26:14.330\nBut if you run the command first,\nit's unhappy about it.\n\n536\n00:26:14.330 --> 00:26:15.900\nCuz we got to set the association first.\n\n537\n00:26:15.900 --> 00:26:18.530\nAnd I need to leave that\nmode keyword out there.\n\n538\n00:26:18.530 --> 00:26:19.517\nSo I need to say switchport.\n\n539\n00:26:21.012 --> 00:26:22.150\nOops, just want me to double up.\n\n540\n00:26:22.150 --> 00:26:25.551\nPrivate-vlan.\n\n541\n00:26:28.687 --> 00:26:29.279\nThere we go.\n\n542\n00:26:29.279 --> 00:26:31.485\nYeah, duplicate bands there.\n\n543\n00:26:31.485 --> 00:26:33.560\nSo it's switchport private-vlan.\n\n544\n00:26:33.560 --> 00:26:36.200\nAnd now I can come in, and\nI can tell it the association so\n\n545\n00:26:36.200 --> 00:26:37.430\nit knows what it's tied to.\n\n546\n00:26:37.430 --> 00:26:40.110\nRemember the promiscuous port,\nhow I tied it to basically everything.\n\n547\n00:26:40.110 --> 00:26:45.510\nI said we're on VLAN 10, but then I said\n11 through 13 to tie them all together.\n\n548\n00:26:46.970 --> 00:26:50.060\nOn this one,\nI don't want to tie them all together.\n\n549\n00:26:50.060 --> 00:26:52.840\nI want these ports to just be isolated.\n\n550\n00:26:52.840 --> 00:26:56.010\nAnd it was VLAN 11 that was isolated.\n\n551\n00:26:56.010 --> 00:26:58.666\nSo I'm just gonna type association 10 11.\n\n552\n00:26:58.666 --> 00:27:03.598\n10 is the primary, and\nany promiscuous ports all talk to them,\n\n553\n00:27:03.598 --> 00:27:05.790\n11 makes me isolated.\n\n554\n00:27:05.790 --> 00:27:07.770\nSo I'm kind of on two VLANs at once,\n\n555\n00:27:07.770 --> 00:27:11.077\nwhich is where this gets a little\non the weird side, right?\n\n556\n00:27:11.077 --> 00:27:13.780\nOops, I got a syntax error there.\n\n557\n00:27:13.780 --> 00:27:14.540\nWhat did I do wrong?\n\n558\n00:27:15.770 --> 00:27:18.570\nOh, I left off the host,\nor the mapping keyword.\n\n559\n00:27:18.570 --> 00:27:23.320\nSo I need to come in here and\njust tell it that I'm mapping this.\n\n560\n00:27:24.670 --> 00:27:28.010\nSo now that our primary is set up and\nwe've got our promiscuous in place,\n\n561\n00:27:28.010 --> 00:27:30.570\nwhat we need to do next is go and\nassign our other interfaces,\n\n562\n00:27:30.570 --> 00:27:34.130\nand I wanted to assign ports\n2 through 16 to be isolated.\n\n563\n00:27:34.130 --> 00:27:38.530\nRight, these are on the same VLAN,\nbut I want them each to be separate.\n\n564\n00:27:38.530 --> 00:27:41.800\nThey can see the gateway and that's it,\nthey can see the promiscuous ports.\n\n565\n00:27:41.800 --> 00:27:44.000\nSo I need to go in and configure these,\nand I can use the range command,\n\n566\n00:27:44.000 --> 00:27:46.970\nlet me show you,\nthe range command makes this really easy.\n\n567\n00:27:46.970 --> 00:27:50.290\nSo we can say interface range and\nthen we can specify the ports, and\n\n568\n00:27:50.290 --> 00:27:51.841\nI want ports two through 16.\n\n569\n00:27:51.841 --> 00:27:54.580\nSo I'll just jump into that range.\n\n570\n00:27:54.580 --> 00:27:57.150\nAnd then, the first thing I need to do\n\n571\n00:27:57.150 --> 00:28:00.750\nis I need to tell it what VLANs\nit's gonna be associated with.\n\n572\n00:28:00.750 --> 00:28:04.344\nIn my case, in the promiscuous\nport we did a few moments ago,\n\n573\n00:28:04.344 --> 00:28:09.506\nwe associated with primary VLAN 10 and\nthen 11 through 13, all the other VLANs.\n\n574\n00:28:09.506 --> 00:28:11.840\nPromiscuous is associated\nwith all of them.\n\n575\n00:28:11.840 --> 00:28:15.070\nHere I'm gonna put it\nin primary VLAN 10 and\n\n576\n00:28:15.070 --> 00:28:19.160\nthen I'm going to\nassociate it with VLAN 11.\n\n577\n00:28:19.160 --> 00:28:23.570\n10 is the primary, 11 was the one\nthat I made that was isolated.\n\n578\n00:28:23.570 --> 00:28:32.270\nSo the command for that is switchport\nprivate-vlan host-association.\n\n579\n00:28:32.270 --> 00:28:36.660\nAnd then, my head is gonna cover this up\na little bit, but host-association, and\n\n580\n00:28:36.660 --> 00:28:40.004\nthen we need to specify the primary VLAN,\nwhich for me is 10.\n\n581\n00:28:40.004 --> 00:28:42.780\nAnd the VLAN I want this host to\nbe associated with, if I say 11,\n\n582\n00:28:42.780 --> 00:28:43.800\nthis will be isolated.\n\n583\n00:28:43.800 --> 00:28:49.320\nIf I say 12, it will be in community one.\n\n584\n00:28:49.320 --> 00:28:51.090\nIf I say 13, it will be in community two.\n\n585\n00:28:51.090 --> 00:28:54.220\nThis is where we designate what\nthis port is gonna be tagged as.\n\n586\n00:28:54.220 --> 00:28:57.550\nI'm not saying 11 through 13,\ncuz this isn't gonna be promiscuous.\n\n587\n00:28:57.550 --> 00:28:59.600\nI just want it to be in 11.\n\n588\n00:28:59.600 --> 00:29:03.670\nAnd then I'm still not done,\ncuz I actually have to turn this on.\n\n589\n00:29:03.670 --> 00:29:08.980\nI need to say, switchport private-vlan.\n\n590\n00:29:08.980 --> 00:29:14.200\nAnd switchport mode, private-vlan,\nwas about to do the same command again.\n\n591\n00:29:14.200 --> 00:29:20.210\nSwitchport mode private-vlan, and\nhere's where we tell it that we're a host.\n\n592\n00:29:20.210 --> 00:29:21.030\nRemember on the other port,\n\n593\n00:29:21.030 --> 00:29:23.990\nwe said that we were promiscuous,\nhere I'm saying it's just a host.\n\n594\n00:29:23.990 --> 00:29:28.440\nThis is a regular host, and\nlook at the host-association, all right.\n\n595\n00:29:28.440 --> 00:29:30.020\nIf you don't do that,\n\n596\n00:29:30.020 --> 00:29:34.070\nit's expecting to have a full core\nassociation instead of a host association.\n\n597\n00:29:34.070 --> 00:29:35.670\nSo that's kind of my difference.\n\n598\n00:29:35.670 --> 00:29:43.306\nIf I do a show run for fa1/0/1 versus\n2 and kind of compare the two, right?\n\n599\n00:29:43.306 --> 00:29:50.400\nNotice that my VLAN mapping up\nhere was for the promiscuous port.\n\n600\n00:29:50.400 --> 00:29:53.120\nVersus my host association here and\n\n601\n00:29:53.120 --> 00:29:56.090\nthe difference is how many\nVLANs we can specify.\n\n602\n00:29:56.090 --> 00:30:00.448\nAll right, and so then we've got those\nhosts to find and they're in place,\n\n603\n00:30:00.448 --> 00:30:01.140\nall right.\n\n604\n00:30:01.140 --> 00:30:04.420\nNow that was a isolated host.\n\n605\n00:30:04.420 --> 00:30:05.600\nThe other ones were communities,\n\n606\n00:30:05.600 --> 00:30:07.950\nand to set up a community is\nthe same as this right here.\n\n607\n00:30:07.950 --> 00:30:09.970\nWe just use that different VLAN.\n\n608\n00:30:09.970 --> 00:30:14.426\nSo, if I want ports 17, 18, and\n19, to be in community one,\n\n609\n00:30:14.426 --> 00:30:19.277\nI would just get into that range of\n17 through 19, and they don't have\n\n610\n00:30:19.277 --> 00:30:24.150\nto be all in order like this, they could\nbe spread out all over the switch.\n\n611\n00:30:24.150 --> 00:30:29.026\nI could have ports 1, 11, and\n32, all in one particular VLAN.\n\n612\n00:30:29.026 --> 00:30:32.324\nSo I'll just grab 17 through 19, though.\n\n613\n00:30:32.324 --> 00:30:36.558\nAnd I'm just going to go through here and\nsay switchboard,\n\n614\n00:30:36.558 --> 00:30:41.770\nprivate-vlan, host-association,\n10 and then 12, right?\n\n615\n00:30:41.770 --> 00:30:44.240\nAnd then I'm covering it up again.\n\n616\n00:30:44.240 --> 00:30:48.027\nBut 10 and 12, so they know the primary\nVLAN is 10 and I'm picking 12, which for\n\n617\n00:30:48.027 --> 00:30:49.369\nme lines up with community 1.\n\n618\n00:30:49.369 --> 00:30:52.954\nI probably could have picked some better\nnumbers there to make it a little\n\n619\n00:30:52.954 --> 00:30:55.088\neasier to recognize, but we'll do 12.\n\n620\n00:30:55.088 --> 00:31:00.086\nI know a lot of people out there, one of\nthe things I see is if you do VLAN 10 as\n\n621\n00:31:00.086 --> 00:31:05.011\nyour primary, that they'll then\ndo VLAN 100 for isolated, 101 for\n\n622\n00:31:05.011 --> 00:31:07.770\ncommunity 1, 102 for community 2.\n\n623\n00:31:07.770 --> 00:31:10.804\nSo, it's like like ten two.\nYou know ten for the primary, two for\n\n624\n00:31:10.804 --> 00:31:12.035\nthe community.\n\n625\n00:31:12.035 --> 00:31:15.535\nSo I've seen a lot of people\nuse that numbering scheme.\n\n626\n00:31:15.535 --> 00:31:17.165\nYou can use whatever works for\nyou guys, but\n\n627\n00:31:17.165 --> 00:31:19.375\nI just picked some kind\nof random numbers here.\n\n628\n00:31:19.375 --> 00:31:22.705\nSo now that that's associated,\nwe've got that in place,\n\n629\n00:31:22.705 --> 00:31:25.280\nand it's now a part of that community.\n\n630\n00:31:25.280 --> 00:31:28.960\nSo it's nice, isolated,\nand in place, all right.\n\n631\n00:31:28.960 --> 00:31:32.010\nSo at this stage,\nanything that I plug in to port 17 to 19,\n\n632\n00:31:32.010 --> 00:31:34.970\nwill be able to see the other\npeople on 17 through 19,\n\n633\n00:31:34.970 --> 00:31:39.600\nand they'll be able to see\nthe promiscuous port and that's it.\n\n634\n00:31:39.600 --> 00:31:42.710\nThey won't be able to see any\nof the other isolated ports or\n\n635\n00:31:42.710 --> 00:31:44.330\nother communities that\nare now separated out.\n\n636\n00:31:44.330 --> 00:31:46.620\nSo, when Daniel asked,\nis this easy to set up?\n\n637\n00:31:46.620 --> 00:31:47.650\nIs it intuitive?\n\n638\n00:31:47.650 --> 00:31:49.870\nWell, it's not hard, right?\n\n639\n00:31:49.870 --> 00:31:50.677\nJust a couple of commands.\n\n640\n00:31:50.677 --> 00:31:53.751\nBut they're very different commands\nfrom what we've been using so far, and\n\n641\n00:31:53.751 --> 00:31:58.220\ntechnically you're putting ports into more\nthan one VLAN which you can't normally do.\n\n642\n00:31:58.220 --> 00:32:00.392\nSo now that we're all configured,\neverybody's set right?\n\n643\n00:32:00.392 --> 00:32:06.703\nWe've got VLAN 10 for our main VLAN,\nVLAN 11 for our promiscuous mode.\n\n644\n00:32:06.703 --> 00:32:09.320\nOh no, I'm sorry, VLAN 11 for\nour isolated mode.\n\n645\n00:32:09.320 --> 00:32:11.022\nA little difference there.\n\n646\n00:32:11.022 --> 00:32:12.066\n>> [LAUGH]\n>> VLAN 12 and\n\n647\n00:32:12.066 --> 00:32:14.256\nVLAN 13 representing 2\ndifferent communities.\n\n648\n00:32:14.256 --> 00:32:16.320\nWe probably need to\nverify our configuration.\n\n649\n00:32:16.320 --> 00:32:19.170\nAnd there's really only one command\navailable for verifying it,\n\n650\n00:32:19.170 --> 00:32:22.580\nbecause what you will gonna notice,\nwell if I do the right thing here.\n\n651\n00:32:22.580 --> 00:32:27.110\nWhat you'll notice is that the normal\nVLAN commands that we're used to\n\n652\n00:32:27.110 --> 00:32:28.250\ndon't actually work.\n\n653\n00:32:28.250 --> 00:32:33.690\nIf we do like a show VLAN,\nI'll see all those VLANs that I've got.\n\n654\n00:32:33.690 --> 00:32:36.460\nSo there's VLAN 10, 11, 12, 13,\nthere's all the VLANs that I made.\n\n655\n00:32:36.460 --> 00:32:40.230\nAnd they all show as active, but\nthere's no ports assigned to them.\n\n656\n00:32:40.230 --> 00:32:42.700\nAll right, and\nthat's because they're magical VLANs.\n\n657\n00:32:42.700 --> 00:32:44.080\nThey're not there,\nthe interfaces aren't there.\n\n658\n00:32:44.080 --> 00:32:50.190\nThe interfaces are tied to more than one\nVLAN, so they kinda act like trunks.\n\n659\n00:32:50.190 --> 00:32:52.960\nAnd trunks don't show up in here either,\nright?\n\n660\n00:32:52.960 --> 00:32:54.790\nSo that's kinda how these\nare being treated and\n\n661\n00:32:54.790 --> 00:32:57.390\nthey're being yanked out of here,\nbut they're not true trunks, right?\n\n662\n00:32:57.390 --> 00:33:02.670\nSo the command we need to remember\nis show VLAN private- VLAN.\n\n663\n00:33:02.670 --> 00:33:05.630\nAll right, I ran show VLAN a second ago.\n\n664\n00:33:05.630 --> 00:33:08.320\nNow I'm running show VLAN private-VLAN.\n\n665\n00:33:08.320 --> 00:33:11.790\nAnd that will actually display the\ninformation that we're really looking for.\n\n666\n00:33:11.790 --> 00:33:14.960\nI can see that I have\na primary VLAN of VLAN 10.\n\n667\n00:33:14.960 --> 00:33:17.940\nI've got secondary VLANs of 11,\n12, and 13.\n\n668\n00:33:17.940 --> 00:33:22.380\n11 is isolated, 12 is one community and\n13 is another community.\n\n669\n00:33:22.380 --> 00:33:24.540\nAnd I can see the port\nassignments over here.\n\n670\n00:33:24.540 --> 00:33:28.770\nNow the only port that's showing up for\nme are port one and port two, all right.\n\n671\n00:33:28.770 --> 00:33:31.390\nPort one was the one\nthat I made promiscuous.\n\n672\n00:33:31.390 --> 00:33:33.830\nAnd so see how it's in all three of them,\nright?\n\n673\n00:33:33.830 --> 00:33:37.450\nWhen I did the mapping, the association\nmapping I'm active to 11 to 13,\n\n674\n00:33:37.450 --> 00:33:39.760\nthat's what you want for\na promiscuous port.\n\n675\n00:33:39.760 --> 00:33:43.760\nFor port two through 16,\nI just made them isolated, so\n\n676\n00:33:43.760 --> 00:33:46.760\nit shows up right there, all right?\n\n677\n00:33:46.760 --> 00:33:49.900\n12 and 13 don't show those other ports\nthat I assigned though, remember I set\n\n678\n00:33:49.900 --> 00:33:55.460\nwhat was it, ports 17 through 19 into the\nsecondary VLAN 12, into that community.\n\n679\n00:33:55.460 --> 00:33:57.950\nAnd the reason they're not showing up is\nI don't have anything plugged into them,\n\n680\n00:33:57.950 --> 00:33:59.430\nthose parts are down.\n\n681\n00:33:59.430 --> 00:34:03.680\nIf I do a show IP interface brief,\noops, I'm not in config so\n\n682\n00:34:03.680 --> 00:34:05.060\nI don't need my old do command there.\n\n683\n00:34:05.060 --> 00:34:07.070\nBut if I take a look at\nmy interface status,\n\n684\n00:34:07.070 --> 00:34:09.120\nif an interface is down\nit's not gonna show up.\n\n685\n00:34:09.120 --> 00:34:11.140\nSo for me, ports 1 and 2 are up.\n\n686\n00:34:11.140 --> 00:34:13.456\nAnd so they're healthy, that's why\nthey're showing up on that list.\n\n687\n00:34:13.456 --> 00:34:17.370\nBut ports 3-16, 17-19,\nthey're all down so none of them register,\n\n688\n00:34:17.370 --> 00:34:21.440\nnone of them come up and\nthat's why I'm not seeing them there.\n\n689\n00:34:21.440 --> 00:34:23.780\nBut assuming you have hosts\nplugged into your interfaces,\n\n690\n00:34:23.780 --> 00:34:28.860\nthey will come up and you'll see them\nwhen you do a show VLAN private-VLAN.\n\n691\n00:34:28.860 --> 00:34:32.110\nAnd they'll all be right there nice and\nisolated.\n\n692\n00:34:32.110 --> 00:34:36.740\nAnd at the end of the day you have one\nIP subnet that's present in VLAN 10.\n\n693\n00:34:36.740 --> 00:34:38.860\nAnd you might have a physical firewall or\n\n694\n00:34:38.860 --> 00:34:41.350\nVLAN 10 might have a virtual interface\nthat you're using for routing too.\n\n695\n00:34:41.350 --> 00:34:45.810\nBut you have one subnet,\none gateway and off you go,\n\n696\n00:34:45.810 --> 00:34:48.300\nyou just use these secondary view\nlines to control the type of action.\n\n697\n00:34:48.300 --> 00:34:50.990\nIt's not that hard to set up,\nand once it's in place,\n\n698\n00:34:50.990 --> 00:34:52.830\nit's really valuable as far as security.\n\n699\n00:34:52.830 --> 00:34:55.670\n>> Yeah, it is very, very cool to be\nable to set these private view lines.\n\n700\n00:34:55.670 --> 00:34:58.490\nI know that this is something\nI'm probably going to want to\n\n701\n00:34:58.490 --> 00:34:59.390\ndo some practicing on them.\n\n702\n00:34:59.390 --> 00:35:01.640\nAnd make sure that I\nhave this in my tool kit,\n\n703\n00:35:01.640 --> 00:35:05.150\ncuz this is something that you probably\nwill wanna use from time to time.\n\n704\n00:35:05.150 --> 00:35:08.290\nAnd it's very, very helpful not\nto have to route through VLANs.\n\n705\n00:35:08.290 --> 00:35:09.455\nI'm all about that.\n\n706\n00:35:09.455 --> 00:35:11.180\n[LAUGH] All right Don,\n\n707\n00:35:11.180 --> 00:35:14.350\nnow this is the portion of the show\nthat I've been looking forward to.\n\n708\n00:35:14.350 --> 00:35:17.880\nBecause, I'm ready to see how,\nyou mentioned storm control,\n\n709\n00:35:17.880 --> 00:35:19.535\nI did not know you were\nthe Norse God of Thunder.\n\n710\n00:35:19.535 --> 00:35:21.620\n>> [LAUGH]\n>> And that you have the ability to wield\n\n711\n00:35:21.620 --> 00:35:24.091\nthe elements but\nmake some lightning happen, let's see it.\n\n712\n00:35:24.091 --> 00:35:26.633\n>> [LAUGH] That's right,\nI'm the only one who can lift that hammer.\n\n713\n00:35:26.633 --> 00:35:27.420\nIs that it?\n>> That's it.\n\n714\n00:35:27.420 --> 00:35:28.170\n[LAUGH]\n>> So,\n\n715\n00:35:28.170 --> 00:35:31.820\nwhat we got is a technology built into\nCisco switches called Storm Control and\n\n716\n00:35:31.820 --> 00:35:34.610\nI know I've said it's not very neat,\nit's kinda lame.\n\n717\n00:35:34.610 --> 00:35:37.710\nIt was really important back in\nthe early 90's when you still\n\n718\n00:35:37.710 --> 00:35:39.160\nhad a lot of hubs on networks.\n\n719\n00:35:39.160 --> 00:35:41.990\nAnd networks were getting a lot bigger\nthan they were designed to be back then.\n\n720\n00:35:41.990 --> 00:35:45.520\nAnd so\nwe had problems with broadcast storms, or\n\n721\n00:35:45.520 --> 00:35:48.570\neven multicast storms which\nare basically broadcast storms anyway.\n\n722\n00:35:48.570 --> 00:35:51.830\nAnd so, those types of things\nwould happen because hubs repeat\n\n723\n00:35:51.830 --> 00:35:55.310\neverything in a loop on your network and\ncould drive everything crazy.\n\n724\n00:35:55.310 --> 00:35:59.640\nIn today's modern networks, thanks to\nthings like spanning tree protocol and\n\n725\n00:35:59.640 --> 00:36:01.980\nlayer three switches and\n\n726\n00:36:01.980 --> 00:36:06.040\nVLANs we don't normally have\nbroadcast norms anymore, all right?\n\n727\n00:36:06.040 --> 00:36:08.930\nBut if you're on a network that's poorly\ndesigned, maybe one you adopted and\n\n728\n00:36:08.930 --> 00:36:12.030\nit's not your fault but\nyou've got to deal with it and support it.\n\n729\n00:36:12.030 --> 00:36:15.800\nYou can actually configure\nspecial switches to watch out for\n\n730\n00:36:15.800 --> 00:36:17.010\nexcessive broadcasts.\n\n731\n00:36:17.010 --> 00:36:20.550\nAnd if it sees excessive broadcasts\nit can trim them off and\n\n732\n00:36:20.550 --> 00:36:23.910\nstop your network from being brought\ndown when you have a broadcast storm.\n\n733\n00:36:23.910 --> 00:36:27.100\nThey just keep rattling around and around\nin your network, building and building and\n\n734\n00:36:27.100 --> 00:36:30.960\nbuilding, consuming all your\nbandwidth until your network falls.\n\n735\n00:36:30.960 --> 00:36:33.420\nHere we can stop it before\nyou get to that point.\n\n736\n00:36:33.420 --> 00:36:36.470\nYou still have a problem, its still\nsomething you need to address, but\n\n737\n00:36:36.470 --> 00:36:38.680\nthis will stop it from\ndowning your network.\n\n738\n00:36:38.680 --> 00:36:42.600\nStorm control is supported on really\nevery Cisco switch I've ever touched.\n\n739\n00:36:42.600 --> 00:36:44.880\nSo I haven't run into one\nthat didn't support it.\n\n740\n00:36:44.880 --> 00:36:48.550\nAnd you basically go into an interface,\nand you set limits.\n\n741\n00:36:48.550 --> 00:36:52.070\nAnd you can define exactly how much\ntraffic you want to allow, and\n\n742\n00:36:52.070 --> 00:36:53.430\nthere's a few different ways to do it.\n\n743\n00:36:53.430 --> 00:36:57.610\nLet me show you here on an actual switch,\ncuz it's easier to see with the commands.\n\n744\n00:36:57.610 --> 00:37:01.360\nIf I jump into a port, and\nit could be a trunk port,\n\n745\n00:37:01.360 --> 00:37:05.480\nit could be a regular port, just\nwhatever it is that you wanna work with.\n\n746\n00:37:05.480 --> 00:37:08.130\nSo I'll jump into one of\nmy random ports here.\n\n747\n00:37:08.130 --> 00:37:10.830\nAnd you run storm-control, question mark.\n\n748\n00:37:10.830 --> 00:37:15.010\nYou'll see the different types\nof storm control we can do.\n\n749\n00:37:15.010 --> 00:37:17.310\nAnd I mentioned broadcast and multicast.\n\n750\n00:37:17.310 --> 00:37:20.700\nFor the most part, those are the two\nstories we need to watch out for but\n\n751\n00:37:20.700 --> 00:37:22.760\nyou'll see Unicast is in here also.\n\n752\n00:37:22.760 --> 00:37:26.410\nNow, if you're having a Unicast storm,\nthat's almost always an attack,\n\n753\n00:37:26.410 --> 00:37:28.350\nsomebody trying to VLAN hop or whatever.\n\n754\n00:37:28.350 --> 00:37:32.620\nIt's not a good thing but\nit has that spore, you can use it.\n\n755\n00:37:32.620 --> 00:37:34.330\nI've never used that in production.\n\n756\n00:37:34.330 --> 00:37:36.810\nBut Broadcast and\nMulticast on the other hand,\n\n757\n00:37:36.810 --> 00:37:40.130\nthose they can storm in it pretty is if\nyou still have hubs or if your network,\n\n758\n00:37:40.130 --> 00:37:44.810\nhas too many hosts in a single VLAN,\nyou can end up with problems there.\n\n759\n00:37:44.810 --> 00:37:48.680\nOr if a Mac address table gets full,\nyou can start to have problems.\n\n760\n00:37:48.680 --> 00:37:52.300\nSo we can start to enforce that\nright here, you set your limits for\n\n761\n00:37:52.300 --> 00:37:55.585\nbroadcast and multicast and\nthen you set an action.\n\n762\n00:37:55.585 --> 00:37:59.535\nWith storm control you've got a few\noptions to pick from, shutdown and\n\n763\n00:37:59.535 --> 00:38:00.875\ntrap, all right.\n\n764\n00:38:00.875 --> 00:38:05.965\nShutdown says if I start to see\nexcessive broadcast or Unicast or\n\n765\n00:38:05.965 --> 00:38:10.490\nwhatever I'm gonna shut the port down, and\nthat's gonna stop your storm, isn't it?\n\n766\n00:38:10.490 --> 00:38:11.970\nSo that's one way to do it.\n\n767\n00:38:11.970 --> 00:38:15.730\nNow, if you have many switches and\nyou start shutting a port down,\n\n768\n00:38:15.730 --> 00:38:16.980\nthat's gonna segment your network.\n\n769\n00:38:16.980 --> 00:38:20.260\nSo it's not unnoticed,\npeople will see that that's happened.\n\n770\n00:38:20.260 --> 00:38:22.370\nBut at least,\nyou still have some functionality and\n\n771\n00:38:22.370 --> 00:38:24.040\nthe storm has been stopped.\n\n772\n00:38:24.040 --> 00:38:27.470\nStorm's almost always caused by\nan accidental loop in the network and\n\n773\n00:38:27.470 --> 00:38:28.820\nspanning tree should catch it.\n\n774\n00:38:28.820 --> 00:38:30.655\nBut if spanning tree doesn't\ncatch it this sure will.\n\n775\n00:38:30.655 --> 00:38:32.300\nCuz it will shut that port off and\nthat loop is gone.\n\n776\n00:38:33.910 --> 00:38:37.100\nThe other option is trap and with trap\nit just generates an SNMP trap and\n\n777\n00:38:37.100 --> 00:38:38.550\nit will send it to a monitoring server.\n\n778\n00:38:38.550 --> 00:38:41.630\nSo you might have something like\nSolar Winds Network Performance Monitor.\n\n779\n00:38:41.630 --> 00:38:43.290\nAnd it can receive that, and catch it, and\n\n780\n00:38:43.290 --> 00:38:46.660\nthen you get an alert that lets you know,\nand you can go and start to address it.\n\n781\n00:38:46.660 --> 00:38:51.010\nSo that's more of like a monitoring\ninstead of an actual rich.\n\n782\n00:38:51.010 --> 00:38:51.510\n>> Can you do both?\n\n783\n00:38:51.510 --> 00:38:53.560\n>> No, it's kind of tied to one or\nthe other.\n\n784\n00:38:53.560 --> 00:38:54.170\n>> One or the other.\n\n785\n00:38:54.170 --> 00:38:56.132\n>> Yes, it depends on how\naggressive you want to be.\n\n786\n00:38:56.132 --> 00:38:59.850\nYou sorta can do both, if you have\nsomething, like I mentioned solar wind.\n\n787\n00:38:59.850 --> 00:39:04.110\nThey have it where if it receives an SNMP\ntrap, that it can take certain actions.\n\n788\n00:39:04.110 --> 00:39:05.980\nSo you could have it turn around and\ndo a shut down.\n\n789\n00:39:05.980 --> 00:39:09.340\nBut the reason that they don't do both\nis that If you shut the port down,\n\n790\n00:39:09.340 --> 00:39:14.840\nyou might not be able to send the trap and\nso it kind of one or the other.\n\n791\n00:39:14.840 --> 00:39:18.940\nSo, I'll just set mine to trap and we'll\nput that in place, so if I do have one,\n\n792\n00:39:18.940 --> 00:39:19.480\nthat's what I\"ll do.\n\n793\n00:39:19.480 --> 00:39:23.950\nOr I could just step it over to shut\ndown and put that one in place.\n\n794\n00:39:23.950 --> 00:39:26.960\nSo, now I need to configure\nthe actual limits and\n\n795\n00:39:26.960 --> 00:39:28.530\nall three of these\nare configured the same way.\n\n796\n00:39:28.530 --> 00:39:31.970\nSo, you might do all three\nlimits on one interface.\n\n797\n00:39:31.970 --> 00:39:34.170\nOr you might wanna do just broadcast and\nmulticast, but\n\n798\n00:39:34.170 --> 00:39:36.100\nthe syntax is actually the same.\n\n799\n00:39:36.100 --> 00:39:39.750\nSo, what we do is we come in and\nwe say storm-control.\n\n800\n00:39:39.750 --> 00:39:42.940\nAnd then which of these communication\ntypes we wanna protect from,\n\n801\n00:39:42.940 --> 00:39:45.200\nnormally it's broadcast, right.\n\n802\n00:39:45.200 --> 00:39:48.040\nAnd then from there,\nyou specify the level.\n\n803\n00:39:48.040 --> 00:39:51.410\nNow the level can be one of three things.\n\n804\n00:39:51.410 --> 00:39:53.630\nIt can be a percentage of bandwidth.\n\n805\n00:39:53.630 --> 00:39:57.663\nIf I see that 30% or more of my bandwidth\nis a broadcast, that's a storm.\n\n806\n00:39:57.663 --> 00:40:00.405\nOr 80% of my bandwidth is a broadcast,\nthat's a storm.\n\n807\n00:40:00.405 --> 00:40:02.422\nSo you can do it just based\non what's called Level.\n\n808\n00:40:02.422 --> 00:40:04.380\nLevel is that percentage of bandwidth.\n\n809\n00:40:04.380 --> 00:40:08.600\nOr you can do packets per second.\n\n810\n00:40:08.600 --> 00:40:13.100\nI can say, if I'm receiving more than\n1,000 broadcast packets per second,\n\n811\n00:40:13.100 --> 00:40:15.270\nthat's a storm, right.\n\n812\n00:40:15.270 --> 00:40:19.079\nOr you can do bits per second, right,\nmeasuring the actual bandwidth.\n\n813\n00:40:19.079 --> 00:40:24.240\nIf I see more than 500 bits per second\nof broadcast, then that's a storm.\n\n814\n00:40:24.240 --> 00:40:25.140\nSo we define that.\n\n815\n00:40:25.140 --> 00:40:29.520\nBut the very first keyword we have is\nlevel, regardless of what we're doing.\n\n816\n00:40:29.520 --> 00:40:32.670\nSo even if the level is a percentage of\nbandwidth, we always start with this one.\n\n817\n00:40:32.670 --> 00:40:36.210\nBut after that,\nYou can specify the percentage right here.\n\n818\n00:40:36.210 --> 00:40:37.200\nSo, I can say 80.\n\n819\n00:40:37.200 --> 00:40:41.050\nAnd if I were to press enter right now,\nthen\n\n820\n00:40:41.050 --> 00:40:45.480\nif it sees more than 80% of my bandwidth\nas a broadcast, it's a storm, right.\n\n821\n00:40:45.480 --> 00:40:47.470\nThat's probably a little\non the high side there but\n\n822\n00:40:47.470 --> 00:40:50.270\nsome networks do have a high broadcast,\nright.\n\n823\n00:40:50.270 --> 00:40:54.320\nOr I can delete that, and if I say PPS,\n\n824\n00:40:54.320 --> 00:40:59.030\nnow it's packets per second, or\nBPS, that's bits per second, right.\n\n825\n00:40:59.030 --> 00:41:01.370\nSo, I can tell it which\none I wanna monitor.\n\n826\n00:41:01.370 --> 00:41:05.190\nWith all three you have what's\ncalled a rising threshold and\n\n827\n00:41:05.190 --> 00:41:08.520\na falling threshold, so that the first\nnumber that you specify here,\n\n828\n00:41:08.520 --> 00:41:13.380\nlike if I say 60, right, level 60,\nthat means if 60% of my bandwidth or\n\n829\n00:41:13.380 --> 00:41:16.940\nmore is a broadcast, then this is\ngonna be considered a storm, right.\n\n830\n00:41:16.940 --> 00:41:18.250\nThat's my rising threshold.\n\n831\n00:41:18.250 --> 00:41:22.650\nAs the bandwidth rises to that point,\nnow we got a storm, okay.\n\n832\n00:41:22.650 --> 00:41:27.610\nIf you just stop right there, the rising\nand falling thresholds are set the same.\n\n833\n00:41:27.610 --> 00:41:31.390\nBut I can come back and\nspecify a falling threshold also.\n\n834\n00:41:31.390 --> 00:41:36.390\nAnd if I have the interface set to shut\ndown, then it can keep kinda monitoring,\n\n835\n00:41:36.390 --> 00:41:40.230\nwell, actually if it was shut down,\nit really kinda dies, but if you do SNMP,\n\n836\n00:41:40.230 --> 00:41:45.080\nwe can keep monitoring and it can watch\nfor when it falls to a certain level.\n\n837\n00:41:45.080 --> 00:41:48.310\nAnd if it reaches a certain falling level,\nthen it can clear the error, right.\n\n838\n00:41:48.310 --> 00:41:50.160\nIt's really useful with SNMP.\n\n839\n00:41:50.160 --> 00:41:53.480\nNow we don't normally, well,\nyou can set them to be the same, but\n\n840\n00:41:53.480 --> 00:41:58.290\nif it's one of those fluctuating, and\nit goes, maybe, 58 to 62, down to 58,\n\n841\n00:41:58.290 --> 00:42:01.160\nup to 62, then you're just\ngonna get a ton of messages.\n\n842\n00:42:01.160 --> 00:42:05.910\nSo, I might wanna set a falling\nlevel that is lower than this one.\n\n843\n00:42:05.910 --> 00:42:10.030\nDon't clear the error until we're\nbelow 40% broadcast, right.\n\n844\n00:42:10.030 --> 00:42:12.760\nAnd that gives me a little buffer room\nto stop from getting excessive error\n\n845\n00:42:12.760 --> 00:42:15.800\nmessages or\nalerts on an SNMP system, right?\n\n846\n00:42:15.800 --> 00:42:18.420\nSo, the rising and falling threshold,\nthe falling is optional.\n\n847\n00:42:18.420 --> 00:42:21.370\nThe rising is the important one,\ncuz that's when the alert is thrown or\n\n848\n00:42:21.370 --> 00:42:22.770\nthe port gets shut down, right.\n\n849\n00:42:22.770 --> 00:42:26.350\nIf the port gets shut down,\nare we able to communicate over it?\n\n850\n00:42:26.350 --> 00:42:27.458\nNot really.\n\n851\n00:42:27.458 --> 00:42:31.363\nIt is error disabled, so technically, the\nswitch could look at it, but it treats it\n\n852\n00:42:31.363 --> 00:42:35.103\nas shut down, so it never really clears\nthe error, unless you have error disable\n\n853\n00:42:35.103 --> 00:42:38.571\nrecovery turned on, which we talked\nabout in one of the earlier episodes.\n\n854\n00:42:38.571 --> 00:42:41.631\nAnd then, every so often,\nit'll turn the port back on to try it and\n\n855\n00:42:41.631 --> 00:42:45.567\nsee if it meets our thresholds, and that's\nwhere the following threshold comes in,\n\n856\n00:42:45.567 --> 00:42:47.831\nif you're using the shut down command,\nright.\n\n857\n00:42:47.831 --> 00:42:49.971\nSo, that's how we define that.\n\n858\n00:42:49.971 --> 00:42:52.730\nAnd here, I would basically be saying 60%\n\n859\n00:42:52.730 --> 00:42:56.250\nof my bandwidth is where I\nwanna throw up for a broadcast.\n\n860\n00:42:56.250 --> 00:43:04.430\nI might mix and match these, and say from\nmulticast, I wanna do, packets per second.\n\n861\n00:43:04.430 --> 00:43:10.970\nAnd I'll say, if I get to 1,000 packets\nper second, that's a multicast storm.\n\n862\n00:43:10.970 --> 00:43:12.690\nOr if I set a following one,\n\n863\n00:43:12.690 --> 00:43:15.703\nright, maybe I set it to 800 packets\nper second, is my following, right.\n\n864\n00:43:15.703 --> 00:43:20.215\nOops, actually you know what, multicasting\nis one of those special ones, isn't it?\n\n865\n00:43:20.215 --> 00:43:21.285\nLet's just verify that.\n\n866\n00:43:22.365 --> 00:43:25.455\nOh, no, I just left off my level\nkeyword after I said that earlier,\n\n867\n00:43:25.455 --> 00:43:28.429\nyou gotta have that level keyword, and\nI didn't listen to my own instructions.\n\n868\n00:43:28.429 --> 00:43:29.790\n>> [CROSSTALK] [LAUGH]\n>> I know.\n\n869\n00:43:29.790 --> 00:43:33.200\nI say these things for a reason,\nbut I just don't listen.\n\n870\n00:43:33.200 --> 00:43:34.342\nThere we go.\nAll right, so\n\n871\n00:43:34.342 --> 00:43:37.606\nnow I got my multicast set, and\nthen I might do the same thing for\n\n872\n00:43:37.606 --> 00:43:40.701\nunicast, right, so can come in and\nspecify unicast also.\n\n873\n00:43:40.701 --> 00:43:44.541\nAnd on this one,\nI might do bits per second, and\n\n874\n00:43:44.541 --> 00:43:49.437\nI've got 100 megabit interface,\nand so 100 megabits\n\n875\n00:43:49.437 --> 00:43:54.339\nin bits is 100 million, so\nmaybe I say like 95 million.\n\n876\n00:43:57.019 --> 00:43:57.950\nIs that right?\n\n877\n00:43:57.950 --> 00:44:00.880\nIs that 95 mega bit?\n\n878\n00:44:00.880 --> 00:44:01.515\n>> Yeah.\n>> Is it?\n\n879\n00:44:01.515 --> 00:44:02.140\nI'm bad at math.\n\n880\n00:44:02.140 --> 00:44:02.640\n>> Yeah, right, millions.\n>> [LAUGH]\n\n881\n00:44:02.640 --> 00:44:03.140\n>> [LAUGH]\n\n882\n00:44:03.140 --> 00:44:05.268\n>> So, 95 million bits per second.\n\n883\n00:44:05.268 --> 00:44:07.293\nIf I'm seeing more than 95 megabit in\n\n884\n00:44:07.293 --> 00:44:09.305\na given second, well,\n\n885\n00:44:09.305 --> 00:44:11.825\nit may just be that I'm using my network,\nright, that's what it's all about.\n\n886\n00:44:11.825 --> 00:44:14.285\nBut I can treat that as a unicast storm.\n\n887\n00:44:14.285 --> 00:44:16.983\nLike I said, I haven't used\nthe unicast storm stuff in production.\n\n888\n00:44:16.983 --> 00:44:19.620\nI haven't really found a really\ngood use for it, but it is there.\n\n889\n00:44:19.620 --> 00:44:21.410\nYou certainly can take advantage of it.\n\n890\n00:44:21.410 --> 00:44:25.200\nAnd once it's all set,\nnow we're monitoring that interface.\n\n891\n00:44:25.200 --> 00:44:29.450\nIf I take a look at that configuration,\nI do have to remember what port that was.\n\n892\n00:44:29.450 --> 00:44:30.810\nWas that port 20?\n\n893\n00:44:30.810 --> 00:44:32.280\nThere it is.\n\n894\n00:44:32.280 --> 00:44:34.210\nAnd you'll see how all\nthree of them stayed there.\n\n895\n00:44:34.210 --> 00:44:35.370\nAnd you know what Daniel?\n\n896\n00:44:35.370 --> 00:44:37.060\nI, apparently, am a liar.\n\n897\n00:44:37.060 --> 00:44:39.510\nI said that you couldn't turn on\nshut down and trap at the same time,\n\n898\n00:44:39.510 --> 00:44:41.430\nit did save both of those commands.\n\n899\n00:44:41.430 --> 00:44:42.100\n>> It surely did.\n\n900\n00:44:42.100 --> 00:44:43.183\n>> Not entirely sure,\n\n901\n00:44:43.183 --> 00:44:46.623\nI guess if your SNMP host is\navailable on a different interface,\n\n902\n00:44:46.623 --> 00:44:50.781\nit would still be able to send it, so\n[SOUND] I learned something myself there.\n\n903\n00:44:50.781 --> 00:44:54.432\nAnd instead of typing 95 million,\nI could've just typed 95 pound, but\n\n904\n00:44:54.432 --> 00:44:58.320\nyou learn some shortcuts sometimes when\nyou look at how the switches do it.\n\n905\n00:44:58.320 --> 00:45:02.570\nI don't like to use shortcuts like this\none because not every switch does them,\n\n906\n00:45:02.570 --> 00:45:04.130\nso sometimes they work,\nsometimes they don't.\n\n907\n00:45:04.130 --> 00:45:07.110\nI just type it out, but you'll see\nit kinda translated that for me.\n\n908\n00:45:07.110 --> 00:45:08.220\nBut it's got it in there.\n\n909\n00:45:08.220 --> 00:45:09.360\nThe data's in place.\n\n910\n00:45:09.360 --> 00:45:10.940\nNow I'm running storm control.\n\n911\n00:45:10.940 --> 00:45:15.380\nAnd so, if these events happen, it'll take\nthe actions that we've specified, and\n\n912\n00:45:15.380 --> 00:45:18.100\nfor the most part, that's it, right.\n\n913\n00:45:18.100 --> 00:45:19.660\nYou've got storm-control configured.\n\n914\n00:45:19.660 --> 00:45:21.110\nIt's not very flashy.\n\n915\n00:45:21.110 --> 00:45:25.150\nMost modern networks shouldn't need this,\nbut it's there.\n\n916\n00:45:25.150 --> 00:45:26.560\nYou can turn it on, and\nif it's monitoring,\n\n917\n00:45:26.560 --> 00:45:27.570\nit's not gonna do you any harm.\n\n918\n00:45:27.570 --> 00:45:30.430\nIt does take a little bit of resource on\nyour switch, but your switch is having\n\n919\n00:45:30.430 --> 00:45:33.330\nto monitor these data rates anyway for\nthe interface statistics, so\n\n920\n00:45:33.330 --> 00:45:34.950\nit's not having to work that\nmuch harder to maintain it.\n\n921\n00:45:34.950 --> 00:45:37.670\nBut it's there, and\nit's available for you to use.\n\n922\n00:45:37.670 --> 00:45:41.160\n>> Nothing like inheriting\nthose older networks,\n\n923\n00:45:41.160 --> 00:45:43.480\nthat something like this\nmight actually come in handy.\n\n924\n00:45:43.480 --> 00:45:44.650\nIt does happen from time to time.\n\n925\n00:45:44.650 --> 00:45:45.630\nMaybe you're a consultant and\n\n926\n00:45:45.630 --> 00:45:48.410\nyou're bouncing around to all\nsorts of different networks.\n\n927\n00:45:48.410 --> 00:45:51.551\nHaving another tool in the tool\nbag never hurts anything.\n\n928\n00:45:51.551 --> 00:45:53.780\nSo Don, thank you so\nmuch for those examples.\n\n929\n00:45:53.780 --> 00:45:55.970\nThe explanations, obviously,\nare very awesome.\n\n930\n00:45:55.970 --> 00:45:58.590\nIs there anything else we need to\ngo over before we call this a day?\n\n931\n00:45:58.590 --> 00:46:02.960\nI didn't show it on the router or switch,\nbut you can run show storm dash control,\n\n932\n00:46:02.960 --> 00:46:06.260\nand it will give you a summary of all your\ninterfaces and how they're configured.\n\n933\n00:46:06.260 --> 00:46:09.225\nI usually look at the config itself to\nsee it, but show storm dash control,\n\n934\n00:46:09.225 --> 00:46:11.993\nthat'll show you too and just give\nyou a quick kinda summary on those.\n\n935\n00:46:11.993 --> 00:46:13.600\nBut, yep, that's basically it.\n\n936\n00:46:13.600 --> 00:46:16.190\nAnd Daniel, that's really it for\nour switch security features.\n\n937\n00:46:16.190 --> 00:46:19.710\nThere are a few more little advanced\nbells and whistles that are tucked away,\n\n938\n00:46:19.710 --> 00:46:22.920\nthat for those of you that go onto the\nCCIE level you'll tackle those, but for\n\n939\n00:46:22.920 --> 00:46:25.680\nCCMP, we've covered all the security\nfeatures that are available here.\n\n940\n00:46:25.680 --> 00:46:27.670\nAnd that's really about it.\n\n941\n00:46:27.670 --> 00:46:30.230\nLot of good stuff to turn\non if you know it's there.\n\n942\n00:46:30.230 --> 00:46:31.160\n>> That's right.\n\n943\n00:46:31.160 --> 00:46:32.590\nWell, hopefully you guys\nhave enjoyed this show.\n\n944\n00:46:32.590 --> 00:46:34.140\nI know I had a great time making it.\n\n945\n00:46:34.140 --> 00:46:35.855\nDon, this has been a lot of fun.\n\n946\n00:46:35.855 --> 00:46:38.850\nBut,as this show goes, though,\nI think we've come to an end, so\n\n947\n00:46:38.850 --> 00:46:40.370\nwe're gonna go ahead and close it out.\n\n948\n00:46:40.370 --> 00:46:43.311\nSigning off for ITProTV,\nI've been your host Daniel Lowery.\n\n949\n00:46:43.311 --> 00:46:43.991\n>> And I'm Don Pezet.\n\n950\n00:46:43.991 --> 00:46:45.451\n>> We'll see you next time.\n\n951\n00:46:45.451 --> 00:46:52.400\n[MUSIC]\n\n",
          "vimeoId": "145312805"
        }
      ],
      "title": "Infrastructure Security"
    },
    {
      "episodes": [
        {
          "description": "In this episode, Don and Daniel explain how you can set up your switch network to survive a failure using the Hot-Standby Redundancy Protocol (HSRP). Watch as they explain how to HRSP is designed to work by creating a network of switches that are ready at a moments notice to take over for a failed switch and then show you how to actually configure HSRP in your network.",
          "length": "2400",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-1-first-hop-redundancy--1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-1-first-hop-redundancy--1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-1-first-hop-redundancy--1-sm.jpg",
          "title": "First-Hop Redundancy",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.952 --> 00:00:12.910\nAll right.\n\n3\n00:00:12.910 --> 00:00:16.630\nGreetings everyone and welcome to\nanother great episode of ITProTV.\n\n4\n00:00:16.630 --> 00:00:17.880\nI'm your host Daniel Lowry.\n\n5\n00:00:17.880 --> 00:00:20.970\nJoining me on the show today is\na man that needs no introduction.\n\n6\n00:00:20.970 --> 00:00:22.300\nThat's right, it's Don Pezet.\n\n7\n00:00:22.300 --> 00:00:23.220\nHow's it going today, Don?\n\n8\n00:00:23.220 --> 00:00:24.050\n>> It is going great.\n\n9\n00:00:24.050 --> 00:00:25.995\nNice introduction.\n\n10\n00:00:25.995 --> 00:00:28.120\n>> [LAUGH]\n>> Glad to be back on the show and\n\n11\n00:00:28.120 --> 00:00:30.810\nback on to the CC and PC switch.\n\n12\n00:00:30.810 --> 00:00:31.780\nTechnologies and\n\n13\n00:00:31.780 --> 00:00:34.280\nwhat we're gonna be taking a look at\ntoday is a pretty neat topic, right?\n\n14\n00:00:34.280 --> 00:00:37.590\nWe're gonna talk about\nfirst hop redundancy.\n\n15\n00:00:37.590 --> 00:00:39.890\nAnd first first hop redundancy,\nlet's talk about that first part.\n\n16\n00:00:39.890 --> 00:00:41.590\nWhat the heck is first hop?\n\n17\n00:00:41.590 --> 00:00:46.620\nWell, when you are on a laptop or\na desktop or a computer of any sorts, and\n\n18\n00:00:46.620 --> 00:00:52.100\nyou go to access a network,\nif you're accessing another host.\n\n19\n00:00:52.100 --> 00:00:54.106\nPrinter or whatever that is\non the same network as you,\n\n20\n00:00:54.106 --> 00:00:56.010\nyou're just doing broadcast.\n\n21\n00:00:56.010 --> 00:00:59.390\nYou find that person and\nyou start to communicate directly to them.\n\n22\n00:00:59.390 --> 00:01:03.530\nBut if you're gonna talk to somebody on\nany other network on the entire planet, or\n\n23\n00:01:03.530 --> 00:01:04.500\neven in your building.\n\n24\n00:01:04.500 --> 00:01:07.400\nAny other network than the one\nyour directly plugged into,\n\n25\n00:01:07.400 --> 00:01:09.210\nyou have to get somebody to help you.\n\n26\n00:01:09.210 --> 00:01:12.870\nAnd the person who helps you\nis your default gateway.\n\n27\n00:01:12.870 --> 00:01:13.550\nRight?\n\n28\n00:01:13.550 --> 00:01:16.330\nDefault gateway,\ngateway of last resort, default router,\n\n29\n00:01:16.330 --> 00:01:18.940\ndifferent people use different ways,\nbut it's all the same thing.\n\n30\n00:01:18.940 --> 00:01:21.420\nIt's that first router you talk to, so\n\n31\n00:01:21.420 --> 00:01:25.500\nwhen you assign an IP address to a laptop\nor a desk top, you give it an IP address,\n\n32\n00:01:25.500 --> 00:01:28.660\nyou give it a subnet mask, and\nyou give it a default gateway.\n\n33\n00:01:28.660 --> 00:01:31.350\nIf you don't have a default gateway\nyou can't talk to any other networks,\n\n34\n00:01:31.350 --> 00:01:33.170\nif you have one that's your first hop.\n\n35\n00:01:34.530 --> 00:01:39.000\nNow If you watch the route show,\nwe talk about EIGRP and\n\n36\n00:01:39.000 --> 00:01:43.870\nOSPF and RIP and BGP and all these\ngreat dynamic routing protocols that\n\n37\n00:01:43.870 --> 00:01:47.870\nhelp us build massive,\nfull mesh networks that where.\n\n38\n00:01:47.870 --> 00:01:50.690\nIf one link goes down,\nwe just jump to another link.\n\n39\n00:01:50.690 --> 00:01:53.920\nThere's always ways to reroute\naround stuff, all right?\n\n40\n00:01:53.920 --> 00:01:58.170\nYou're first hop, that's the router\nright there on your own network.\n\n41\n00:01:58.170 --> 00:02:00.500\nThere's not a lot of paths to get there,\nright?\n\n42\n00:02:00.500 --> 00:02:03.260\nWe talked about some layer two\nredundancy early in this series.\n\n43\n00:02:03.260 --> 00:02:06.710\nWe talked about spanning tree and how\nspanning tree can have more than one path.\n\n44\n00:02:06.710 --> 00:02:08.720\nAnd it shuts one off to prevent the loop.\n\n45\n00:02:08.720 --> 00:02:11.660\nAnd then it turns it back on if\nit needs it, removes the failure.\n\n46\n00:02:11.660 --> 00:02:14.050\nWell, those technologies are great, but\n\n47\n00:02:14.050 --> 00:02:17.260\nthere's a few other things we can do\nwith the layer three side to actually\n\n48\n00:02:17.260 --> 00:02:20.690\nmake it a little more powerful and\nprotect that first hop.\n\n49\n00:02:20.690 --> 00:02:24.140\nAnd the main reason we have to do that\nis if I configure my workstation,\n\n50\n00:02:24.140 --> 00:02:25.730\nhow many default gateways\ncan I put in there?\n\n51\n00:02:26.880 --> 00:02:27.500\nOne.\n\n52\n00:02:27.500 --> 00:02:29.830\nYou can put more than one if you want but\nyou're only going to use one.\n\n53\n00:02:29.830 --> 00:02:31.300\nAnd the others kind of get ignored.\n\n54\n00:02:31.300 --> 00:02:33.660\nIn Windows, they only let you have one.\n\n55\n00:02:33.660 --> 00:02:36.580\nIn Linux, you can do more than one and\nit just ignores the others.\n\n56\n00:02:36.580 --> 00:02:39.620\nIn Mac, I think you can only do one.\n\n57\n00:02:39.620 --> 00:02:41.300\nIt's Unix under the hood, so who knows.\n\n58\n00:02:41.300 --> 00:02:44.620\nBut you normally have that limitation\non desktop machines, laptops,\n\n59\n00:02:44.620 --> 00:02:47.230\nwhere you can only set\none default gateway and\n\n60\n00:02:47.230 --> 00:02:50.500\nif that default gateway goes down\nyou're cut off from the network.\n\n61\n00:02:50.500 --> 00:02:52.740\nRight?\nNow, I'm talking about gateways.\n\n62\n00:02:52.740 --> 00:02:54.030\nI'm talking about routing.\n\n63\n00:02:54.030 --> 00:02:55.140\nThis is the switch show, right?\n\n64\n00:02:55.140 --> 00:02:56.470\nWhy am I bringing that up?\n\n65\n00:02:56.470 --> 00:02:57.860\nWell, more and\n\n66\n00:02:57.860 --> 00:03:01.240\nmore we're starting to see switches\ndisplayed as layer three switches.\n\n67\n00:03:01.240 --> 00:03:02.950\nSwitches that perform routing.\n\n68\n00:03:02.950 --> 00:03:04.480\nOkay?\nLet me show you an example here on one\n\n69\n00:03:04.480 --> 00:03:05.000\nof my switches.\n\n70\n00:03:05.000 --> 00:03:09.485\nSo I've got this core switch,\nAnd if we look at my core config,\n\n71\n00:03:09.485 --> 00:03:12.515\nlet me just make that a little bigger so\nwe can actually see what I'm doing.\n\n72\n00:03:12.515 --> 00:03:14.345\nIf we take a look at a core switch and\n\n73\n00:03:14.345 --> 00:03:18.975\nyou do a show ip route, a Cisco switch\nis not necessarily a router by default.\n\n74\n00:03:18.975 --> 00:03:21.140\nOkay?\nWell, I guess this one is.\n\n75\n00:03:21.140 --> 00:03:22.680\nThat's kinda cheating.\n\n76\n00:03:22.680 --> 00:03:26.613\nNo IP routing, that's the default mode for\na switch that is not a router.\n\n77\n00:03:26.613 --> 00:03:28.127\nSo when you run show IP route,\n\n78\n00:03:28.127 --> 00:03:30.861\nyou normally expect to see\nthat it's empty, right?\n\n79\n00:03:30.861 --> 00:03:33.983\nBut on a 2960 with a right feature set or\n\n80\n00:03:33.983 --> 00:03:38.494\nany 3560 or higher switch,\nyou can just run IP routing and\n\n81\n00:03:38.494 --> 00:03:42.602\nall of the sudden your switch\nbecomes a router, right?\n\n82\n00:03:42.602 --> 00:03:45.011\nAnd, now when you run\nthat do show ip route,\n\n83\n00:03:45.011 --> 00:03:48.920\nyou actually see a routing table and\nyou're now routing.\n\n84\n00:03:48.920 --> 00:03:50.890\nNow, why would I want to switch to route?\n\n85\n00:03:50.890 --> 00:03:52.200\nBecause of vlan's.\n\n86\n00:03:52.200 --> 00:03:54.560\nIf I start creating VLANs, right?\n\n87\n00:03:54.560 --> 00:03:58.720\nMaybe I have like vlan 2,\nwhich is gonna be marketing.\n\n88\n00:03:58.720 --> 00:04:03.940\nI might have vlan 3, which is operations.\n\n89\n00:04:03.940 --> 00:04:07.180\nAnd vlan 4, might be sales, right.\n\n90\n00:04:07.180 --> 00:04:09.830\nSo I start creating these VLANs, and\n\n91\n00:04:09.830 --> 00:04:14.720\nin each VLAN I'm going to have\na different subnet, a different network.\n\n92\n00:04:14.720 --> 00:04:23.040\nSo if I get into VLAN 2 I might\nmake that the 192.168.2 network,\n\n93\n00:04:23.040 --> 00:04:28.340\nand I might make my switch 0.1, right?\n\n94\n00:04:28.340 --> 00:04:32.610\nAnd then I go into VLAN 3 and\nI make it 192.168.3.1.\n\n95\n00:04:32.610 --> 00:04:40.200\nAnd if I go into VLAN 4,\nthis will get, but not as fast.\n\n96\n00:04:40.200 --> 00:04:42.290\nBut you guys kind of see\nwhat I'm getting at here,\n\n97\n00:04:42.290 --> 00:04:45.260\nis that basically I'm assigning\nan IP on each of these VLANS.\n\n98\n00:04:45.260 --> 00:04:51.340\nAnd by doing that, my switch will be\nable to route Between those VLANs.\n\n99\n00:04:51.340 --> 00:04:56.430\nSo if I have a host on VLAN2, and\nthey need to talk to somebody on VLAN4,\n\n100\n00:04:56.430 --> 00:04:59.860\nwell in my routing table,\nI've got all those VLANs.\n\n101\n00:04:59.860 --> 00:05:01.520\nWell I would, if they actually came up.\n\n102\n00:05:01.520 --> 00:05:04.500\nOh, I guess I need to assign some\nports to them that are up, and\n\n103\n00:05:04.500 --> 00:05:05.960\nstuff like that, right?\n\n104\n00:05:05.960 --> 00:05:09.350\nIf I had a trunk,\nall those would come up real fast.\n\n105\n00:05:09.350 --> 00:05:17.020\nSo if I do a little trunk encapsulation,\nand switchport mode trunk.\n\n106\n00:05:17.020 --> 00:05:19.250\nI don't have enough ports\nthat are actually up and\n\n107\n00:05:19.250 --> 00:05:21.040\nrunning to bring all this up individually.\n\n108\n00:05:21.040 --> 00:05:25.895\nBut as those come up, I'll start to\nsee those interfaces come up, and\n\n109\n00:05:25.895 --> 00:05:28.095\nmy routing table will actually populate.\n\n110\n00:05:28.095 --> 00:05:32.350\nSo, if I look at my routing table now,\nI'm big liar.\n\n111\n00:05:32.350 --> 00:05:35.285\n>> [LAUGH]\n>> So, let's see what happened there.\n\n112\n00:05:35.285 --> 00:05:40.335\nBut as I start to create these things,\nwe're gonna have separate networks,\n\n113\n00:05:40.335 --> 00:05:43.770\nright, so I've got these VLAN 2,\nVLAN 3, VLAN 4.\n\n114\n00:05:43.770 --> 00:05:47.800\nI've got these networks that are up and\nI now need to start routing between them.\n\n115\n00:05:47.800 --> 00:05:50.370\nAnd you know, I was just trying to bring\nthem up real quick and the reason they're\n\n116\n00:05:50.370 --> 00:05:54.180\nnot coming up is I am trunking but\nI bet the other side isn't doing.\n\n117\n00:05:54.180 --> 00:05:55.470\nOh, nope, there they went.\n\n118\n00:05:55.470 --> 00:05:56.907\nI'm just being impatient.\n\n119\n00:05:56.907 --> 00:05:58.081\nIf I'd just waited.\n\n120\n00:05:58.081 --> 00:05:59.125\n>> It takes a little Don, simmer down.\n\n121\n00:05:59.125 --> 00:06:01.970\n>> I know, I know, it's my limitation.\n\n122\n00:06:01.970 --> 00:06:02.700\nThere we go.\n\n123\n00:06:02.700 --> 00:06:04.710\nNow we're seeing all those networks.\n\n124\n00:06:04.710 --> 00:06:05.400\nAll right?\n\n125\n00:06:05.400 --> 00:06:09.310\nSo if I take my laptops and my PCs and\nthose things and I set their default\n\n126\n00:06:09.310 --> 00:06:14.320\ngateway to my switch, they'll now\nbe able to access all these VLANs.\n\n127\n00:06:14.320 --> 00:06:17.950\nAnd that's important, because on a router,\n\n128\n00:06:17.950 --> 00:06:21.290\nit's hard to find routers that have\nmore than a handful of interfaces.\n\n129\n00:06:21.290 --> 00:06:22.950\nIf I had 20 VLANs,\n\n130\n00:06:22.950 --> 00:06:26.000\nto get a router with 20 interfaces\nis going to cost me a lot of money.\n\n131\n00:06:26.000 --> 00:06:29.720\nOr I could do trunks, but\nthen I'm sharing bandwidth and\n\n132\n00:06:29.720 --> 00:06:32.150\nI might not want that for\nrouting between VLANs.\n\n133\n00:06:32.150 --> 00:06:35.480\nSo having an external router\ncan get pretty costly.\n\n134\n00:06:35.480 --> 00:06:37.880\nBut if I use the layer\nthree switch as the router,\n\n135\n00:06:37.880 --> 00:06:40.170\nit can be routing between 100 VLANs.\n\n136\n00:06:40.170 --> 00:06:42.780\nAnd they're all virtual interfaces,\nso it doesn't matter.\n\n137\n00:06:42.780 --> 00:06:46.150\nIt's all being done on the where\nyou get way better performance.\n\n138\n00:06:46.150 --> 00:06:50.520\nSo we normally use routers on the edge\nof our network, between our network and\n\n139\n00:06:50.520 --> 00:06:51.770\nthe wide area network.\n\n140\n00:06:51.770 --> 00:06:55.335\nBecause you can get routers with\nserial interfaces for T1's or\n\n141\n00:06:55.335 --> 00:06:57.630\nfiber-optic interfaces or whatever.\n\n142\n00:06:57.630 --> 00:07:02.800\nBut on the switches, you can't get\na switch with frame relay ports.\n\n143\n00:07:02.800 --> 00:07:03.420\nThey do have some.\n\n144\n00:07:03.420 --> 00:07:06.220\nThey cost hundreds of thousands of\ndollars, the really high end ISP ones.\n\n145\n00:07:06.220 --> 00:07:08.850\nBut for regular businesses, you can't\nget a switch with a frame relay port.\n\n146\n00:07:08.850 --> 00:07:10.890\nYou can't get a switch that does npls.\n\n147\n00:07:10.890 --> 00:07:14.320\nA lot of them don't do that, because\nthey're designed to be used inside of your\n\n148\n00:07:14.320 --> 00:07:16.510\nLAN, where you don't\nneed those technologies.\n\n149\n00:07:16.510 --> 00:07:19.680\nBut here we can use it as a router for\nrouting our internal network, and\n\n150\n00:07:19.680 --> 00:07:22.800\nit does a great job of it It's up,\nit's running, and\n\n151\n00:07:22.800 --> 00:07:25.360\nnow this guy becomes the heart\nof the network, right?\n\n152\n00:07:25.360 --> 00:07:29.040\nThis is the key router for\nall of my various LAN subnets.\n\n153\n00:07:29.040 --> 00:07:31.010\n>> Well, Don,\nthat sounds great in theory, right?\n\n154\n00:07:31.010 --> 00:07:34.220\nWe've got the routing happened,\ncuz we got a bunch of VLANs going on,\n\n155\n00:07:34.220 --> 00:07:37.820\nwe're not making our edge\nrouters handle this work,\n\n156\n00:07:37.820 --> 00:07:41.380\nthank you layer three switching, but\nyou say this is the gateway, right?\n\n157\n00:07:41.380 --> 00:07:44.900\nWe have a VLAN one we use the switch\nas the gateway VLAN2 and so on and\n\n158\n00:07:44.900 --> 00:07:49.700\nso forth, but I'm starting to see a\nproblem here or at least a possible issue.\n\n159\n00:07:49.700 --> 00:07:51.430\nThat was if that switch goes down right?\n\n160\n00:07:51.430 --> 00:07:53.916\nIt is the gateway, and\nnow the switch is gone.\n\n161\n00:07:53.916 --> 00:07:55.310\nNo one has Gateway.\n\n162\n00:07:55.310 --> 00:07:59.196\n>> Yeah, and when you say no one,\nif it's routing between all of your VLANs,\n\n163\n00:07:59.196 --> 00:08:02.529\nit's your whole network,\nYou might have a hundred switches but\n\n164\n00:08:02.529 --> 00:08:05.861\nif this is your distribution switch\nthat is handling the routing\n\n165\n00:08:05.861 --> 00:08:09.626\nbetween these different VLAN's,\nit's the core really at that point,\n\n166\n00:08:09.626 --> 00:08:12.863\nits the heart of your network\nif it goes down that's it right?\n\n167\n00:08:12.863 --> 00:08:16.643\nSo you might have laptops and desktops\nthat are plugged in to a switch that is\n\n168\n00:08:16.643 --> 00:08:19.463\nstill up but\nbecause they can't get to their first hop,\n\n169\n00:08:19.463 --> 00:08:22.403\nthey can't get to the IP that\nsays their default gateway,\n\n170\n00:08:22.403 --> 00:08:26.080\nthey are not going to be able to\nget out of the network all right?\n\n171\n00:08:26.080 --> 00:08:31.900\nSo, if you're implementing things like\nthis, like layer three switching here or\n\n172\n00:08:31.900 --> 00:08:34.140\neven just regular routing,\nwe have the same problem with the router.\n\n173\n00:08:34.140 --> 00:08:37.250\nIf you have one router and\nit goes down, what happens?\n\n174\n00:08:37.250 --> 00:08:38.290\nYou're out of luck.\n\n175\n00:08:38.290 --> 00:08:41.280\nSo fortunately on switches and on routers,\n\n176\n00:08:41.280 --> 00:08:43.930\nwe have the same technologies\navailable to help us with that.\n\n177\n00:08:43.930 --> 00:08:46.570\nAnd so that's what we're gonna look at\nhere in this episode are a couple of\n\n178\n00:08:46.570 --> 00:08:50.710\nthe different technologies available for\nus to help solve this problem, all right.\n\n179\n00:08:50.710 --> 00:08:55.290\nAnd one of the best technologies\nthat's out there is one called HSRP,\n\n180\n00:08:55.290 --> 00:08:58.520\nthe hot standby redundancy protocol.\n\n181\n00:08:58.520 --> 00:09:01.880\nAnd with HSRP, what it lets us do\n\n182\n00:09:01.880 --> 00:09:06.940\nis instead of having an IP address tied\nto one switch or tied to one router.\n\n183\n00:09:06.940 --> 00:09:10.880\nWe can create kind of a virtual cluster.\n\n184\n00:09:10.880 --> 00:09:12.780\nWe can have a virtual router.\n\n185\n00:09:12.780 --> 00:09:15.450\nAn IP in a MAC address is\nattached to a virtual router\n\n186\n00:09:15.450 --> 00:09:17.600\nthat can move from hardware to hardware.\n\n187\n00:09:17.600 --> 00:09:22.470\nSo I might have two switches and right\nnow the virtual router is on switch one.\n\n188\n00:09:22.470 --> 00:09:24.895\nBut if switch one fails,\nswitch two takes over and\n\n189\n00:09:24.895 --> 00:09:26.927\nthe virtual router's now on switch two.\n\n190\n00:09:26.927 --> 00:09:31.047\nSo even though switch one failed, the\nother switch is acting as that gateway and\n\n191\n00:09:31.047 --> 00:09:34.386\nmy clients are still able to\ncommunicate and function, right.\n\n192\n00:09:34.386 --> 00:09:37.987\nNow HSRP is a pretty straightforward\nthing to configure but\n\n193\n00:09:37.987 --> 00:09:42.790\na couple of little factoids we need to\nknow before we get started with it.\n\n194\n00:09:42.790 --> 00:09:45.250\nFirst off, it is Cisco proprietary.\n\n195\n00:09:45.250 --> 00:09:49.400\nHSRP is something that Cisco made\nback in the 90s at some point.\n\n196\n00:09:49.400 --> 00:09:52.310\nSo they made it a long time ago,\nand it works really well.\n\n197\n00:09:52.310 --> 00:09:56.930\nThere are alternatives out there, but HSRP\nis kind of Cisco's protocol they built up.\n\n198\n00:09:56.930 --> 00:09:59.180\nIt does work on routers and switches.\n\n199\n00:09:59.180 --> 00:10:00.350\nAnd it works on most switches.\n\n200\n00:10:00.350 --> 00:10:03.260\nIf it's a layer three switch\nthe odds are it supports HSRP,\n\n201\n00:10:03.260 --> 00:10:05.770\nI don't think I've seen one\nthat didn't support it.\n\n202\n00:10:05.770 --> 00:10:10.140\nWhen we get it configured,\nyou're creating this virtual IP.\n\n203\n00:10:10.140 --> 00:10:14.872\nSo, you might have a switch,\nlike my switch, if I look at my switch and\n\n204\n00:10:14.872 --> 00:10:17.052\nI take a look at vlan1, right.\n\n205\n00:10:17.052 --> 00:10:22.302\nSo, my vlan1 IP is 192.168.16.5.\n\n206\n00:10:22.302 --> 00:10:26.431\nIf I want to make that IP redundant, I'm\ngoing to take that IP off the interface\n\n207\n00:10:26.431 --> 00:10:28.910\nand get myself a different IP, right?\n\n208\n00:10:28.910 --> 00:10:31.030\nEach switch in the cluster\nhas to have it's own IP.\n\n209\n00:10:31.030 --> 00:10:34.670\nAnd then you have this one\nvertical IP that you share.\n\n210\n00:10:34.670 --> 00:10:36.740\nSo, usually we picked dot one for\nthe router.\n\n211\n00:10:36.740 --> 00:10:39.960\nYour router doesn't have to be dot one,\nor your gateway, it's what a lot of\n\n212\n00:10:39.960 --> 00:10:42.430\npeople pick just because it's usually\nthe first thing we've set up.\n\n213\n00:10:42.430 --> 00:10:47.250\nSo, I might have dot one as my virtual but\nthis interface here is dot five.\n\n214\n00:10:47.250 --> 00:10:47.780\nRight?\nAnd\n\n215\n00:10:47.780 --> 00:10:49.520\nthat lets me get that\nkind of put in place and\n\n216\n00:10:49.520 --> 00:10:52.540\ndot one can now bounce\nbetween my different systems.\n\n217\n00:10:52.540 --> 00:10:55.620\nIt will generate a virtual\nMAC address also.\n\n218\n00:10:55.620 --> 00:10:58.360\nAnd with HSRP, there's actually\ntwo different versions of it,\n\n219\n00:10:58.360 --> 00:10:59.740\nversion one and version two.\n\n220\n00:10:59.740 --> 00:11:03.480\nAnd the MAC address is different\ndepending on the version, all right.\n\n221\n00:11:03.480 --> 00:11:06.390\nAnd I'll highlight those when we go in and\nactually configure it.\n\n222\n00:11:06.390 --> 00:11:09.140\nThe main reason is in version one,\n\n223\n00:11:09.140 --> 00:11:13.960\nyou could only create 16 HSRP,\nwell that was a hardware limitation.\n\n224\n00:11:13.960 --> 00:11:19.280\nOn the software side there was a software\nlimitation of 255 HSRP groups.\n\n225\n00:11:19.280 --> 00:11:21.070\nI've got five vlans.\n\n226\n00:11:21.070 --> 00:11:22.800\nI could configure HSRP for\n\n227\n00:11:22.800 --> 00:11:25.780\neach vlan independently because\nthey all have a separate IP.\n\n228\n00:11:25.780 --> 00:11:26.410\nRight?\n\n229\n00:11:26.410 --> 00:11:29.110\nOr I could have one HSRP instance\nto kind of cover all of them, but\n\n230\n00:11:29.110 --> 00:11:30.160\nthat gets a little dodgy.\n\n231\n00:11:30.160 --> 00:11:33.650\nSo we normally have it one per\nvlan to get it up and configured.\n\n232\n00:11:33.650 --> 00:11:37.750\nAnd when you do that, each one's\nan instance and so the MAC address has to\n\n233\n00:11:37.750 --> 00:11:40.880\nreflect that instance number in there and\nthey limit you to 255.\n\n234\n00:11:40.880 --> 00:11:43.710\nWell, when HSRP version two was released,\n\n235\n00:11:43.710 --> 00:11:46.570\nthe big thing it did which\nadds support for more groups.\n\n236\n00:11:46.570 --> 00:11:49.810\nThey increased that number and so now we\nneed three digits to represent it instead\n\n237\n00:11:49.810 --> 00:11:51.980\nof two, so that MAC address\nchanged a little bit, right.\n\n238\n00:11:51.980 --> 00:11:54.610\nThat's the biggest difference\nbetween version one and version two,\n\n239\n00:11:54.610 --> 00:11:57.480\notherwise it's just stability and\nperformance that kind of changed.\n\n240\n00:11:57.480 --> 00:12:01.677\nBut the configuration is basically the\nsame, regardless of which version you run.\n\n241\n00:12:01.677 --> 00:12:04.718\nBut I'll point out that MAC address\nwhen we jump in and configure it,\n\n242\n00:12:04.718 --> 00:12:07.719\nbecause it's pretty easy to spot\nit's a fake address, all right?\n\n243\n00:12:07.719 --> 00:12:11.568\nNow other things to remember with HSRP,\nwhen you turn it on,\n\n244\n00:12:11.568 --> 00:12:16.636\none router will become the active and\nthe other router will become the standby.\n\n245\n00:12:16.636 --> 00:12:20.381\nAll right the active is the one\nthat's actually doing the work and\n\n246\n00:12:20.381 --> 00:12:24.602\nit has the virtual router, if the active\none goes down the standby becomes\n\n247\n00:12:24.602 --> 00:12:28.960\nthe active and it starts moving the data\nall right it takes for that virtual,\n\n248\n00:12:28.960 --> 00:12:32.262\nso we have this kind of\nalternating role between the two.\n\n249\n00:12:32.262 --> 00:12:33.511\nBut you're not limited to two.\n\n250\n00:12:33.511 --> 00:12:36.688\nI could run HSRP between four switches or\nfour routers or\n\n251\n00:12:36.688 --> 00:12:39.400\neven a mix if you wanna go really crazy.\n\n252\n00:12:39.400 --> 00:12:40.940\nYou can do that.\n\n253\n00:12:40.940 --> 00:12:45.160\nBut you'll have one active,\none stand by and\n\n254\n00:12:45.160 --> 00:12:49.080\neverybody else will be referred\nto as an other, all right.\n\n255\n00:12:49.080 --> 00:12:54.420\nAn other is a gateway that is a candidate\nto become active or standby, right?\n\n256\n00:12:54.420 --> 00:12:58.500\nBut HSRP itself really only supports\none active and one standby.\n\n257\n00:12:58.500 --> 00:12:59.840\nEverything else is kind of ignored but\n\n258\n00:12:59.840 --> 00:13:02.360\nyou'll see it in the output of\nthe commands although they are there so\n\n259\n00:13:02.360 --> 00:13:04.860\nyou can have more than two if you want,\nall right.\n\n260\n00:13:04.860 --> 00:13:07.320\nBut the active is the one\nreally doing all the work.\n\n261\n00:13:07.320 --> 00:13:11.470\nif you have four or five switches\nthat are all in one HSRP group\n\n262\n00:13:11.470 --> 00:13:13.710\nonly one switch has the vertical router.\n\n263\n00:13:13.710 --> 00:13:15.520\nOnly one switch is doing the real work.\n\n264\n00:13:15.520 --> 00:13:17.380\nAll the others are really\njust sitting there.\n\n265\n00:13:17.380 --> 00:13:18.010\nAll right?\nSo\n\n266\n00:13:18.010 --> 00:13:21.270\nthat a key thing to remember\nwith how HSRP functions.\n\n267\n00:13:21.270 --> 00:13:23.415\nNow when we get this all set up.\n\n268\n00:13:23.415 --> 00:13:26.945\nOne of our switches will become\nthe master, or the active.\n\n269\n00:13:26.945 --> 00:13:29.135\nAnd the other guys will be the standby.\n\n270\n00:13:29.135 --> 00:13:31.105\nAnd we can influence\nthat decision if we want.\n\n271\n00:13:31.105 --> 00:13:34.425\nYou can set a priority to indicate\nwho's gonna be the one that's active.\n\n272\n00:13:34.425 --> 00:13:35.555\nCuz you'll probably have a preference.\n\n273\n00:13:35.555 --> 00:13:38.925\nYou'll have, you know, one router\nthat you just prefer over the other.\n\n274\n00:13:38.925 --> 00:13:39.995\nMaybe it's better hardware.\n\n275\n00:13:39.995 --> 00:13:42.275\nMaybe it, maybe you just like it better.\n\n276\n00:13:42.275 --> 00:13:43.405\nIt's at the top of the rack.\n\n277\n00:13:43.405 --> 00:13:44.055\nOr whatever.\n\n278\n00:13:44.055 --> 00:13:45.265\nSo we can use that to influence it.\n\n279\n00:13:45.265 --> 00:13:46.755\nOtherwise, it figures it out itself.\n\n280\n00:13:46.755 --> 00:13:48.560\nIt kinda does like a little vote system.\n\n281\n00:13:48.560 --> 00:13:50.180\nAnd it really boils down\nto who comes up first.\n\n282\n00:13:50.180 --> 00:13:53.030\nI mean, whoever's up first is gonna\nbe the active and that's that.\n\n283\n00:13:53.030 --> 00:13:55.930\nBut we can kind of influence\nthat if we want, all right?\n\n284\n00:13:55.930 --> 00:13:57.640\nWell, let's take a look at\nthe configuration on this,\n\n285\n00:13:57.640 --> 00:14:01.260\nbecause it's really not a difficult\nthing to get up and going.\n\n286\n00:14:01.260 --> 00:14:05.480\nNow, we start by figuring out\nwhat we want to make redundant.\n\n287\n00:14:05.480 --> 00:14:08.530\nSo for example, for me, on vlan1.\n\n288\n00:14:08.530 --> 00:14:10.136\nIf I take a look at my vlan1 interface.\n\n289\n00:14:10.136 --> 00:14:14.178\nI am 192.168.16.5, all right?\n\n290\n00:14:14.178 --> 00:14:17.277\nAnd if I have my host using\nthat as a default gateway,\n\n291\n00:14:17.277 --> 00:14:19.469\nthey can get to all of my other vlans.\n\n292\n00:14:19.469 --> 00:14:23.290\nBut I want to make a virtual IP\nthat can bounce between systems.\n\n293\n00:14:23.290 --> 00:14:28.420\nSo I'm gonna create a virtual 192.168.16.1\nthat I can use as the default gateway and\n\n294\n00:14:28.420 --> 00:14:29.690\nit'll be virtual, all right?\n\n295\n00:14:30.950 --> 00:14:33.980\nAnd we do that by using\nthe standby commands.\n\n296\n00:14:33.980 --> 00:14:36.810\nFirst off I'm gonna get into\ninterface vlan1, right?\n\n297\n00:14:36.810 --> 00:14:39.760\nNow, on a switch, HSRP is normally\n\n298\n00:14:39.760 --> 00:14:42.650\nconfigured on our vlan interfaces\ncuz that's where routing happens.\n\n299\n00:14:42.650 --> 00:14:45.250\nOn a router, it's normally figured on\nthe physical interface cuz that's where\n\n300\n00:14:45.250 --> 00:14:46.590\nrouting happens.\n\n301\n00:14:46.590 --> 00:14:49.840\nBut, on a switch, if you go into\nan interface and say, no switchboard.\n\n302\n00:14:49.840 --> 00:14:51.900\nIt turns into a routed interface.\n\n303\n00:14:51.900 --> 00:14:54.860\nAnd you can do HSRP on\nthe interface itself, that way.\n\n304\n00:14:54.860 --> 00:14:57.440\nBut, normally, it's done it's done here on\nthe vlan cuz that's where the IP is that\n\n305\n00:14:57.440 --> 00:14:58.720\nI'm trying to make redundant.\n\n306\n00:14:58.720 --> 00:14:59.930\nAll right?\n\n307\n00:14:59.930 --> 00:15:04.590\nIf I was trying to make this IP redundant,\nI'd need to change my IP first.\n\n308\n00:15:04.590 --> 00:15:06.910\nBut since I'm picking a new\nIP to use in my virtual,\n\n309\n00:15:06.910 --> 00:15:09.680\nI can just ignore that and\nthen come in and configure it.\n\n310\n00:15:09.680 --> 00:15:13.120\nWhen you configure it,\nyou say standby, right?\n\n311\n00:15:13.120 --> 00:15:17.580\nBecause HSRP, the hot standby,\nis what we're looking to figure.\n\n312\n00:15:17.580 --> 00:15:19.844\nYou do standby and\nthen you specify a group number.\n\n313\n00:15:19.844 --> 00:15:23.636\nAnd see how my group number\nis 0 through 255, all right.\n\n314\n00:15:23.636 --> 00:15:26.969\nThat's because it's gonna\ndefault to version one.\n\n315\n00:15:26.969 --> 00:15:29.511\nVersion one has that maximum of 255.\n\n316\n00:15:29.511 --> 00:15:32.800\nIf I go version two it can go higher,\nright?\n\n317\n00:15:32.800 --> 00:15:36.400\nWell this is my very first group,\nI am just gonna call it standby one.\n\n318\n00:15:36.400 --> 00:15:40.300\nI might be configuring more\nthan one HSRP instance but\n\n319\n00:15:40.300 --> 00:15:41.180\nin this case I am just doing one.\n\n320\n00:15:41.180 --> 00:15:42.980\nSo I'll say standby one.\n\n321\n00:15:42.980 --> 00:15:47.107\nAnd then, from there, I need to tell it\nthe IP address that I'm gonna use for\n\n322\n00:15:47.107 --> 00:15:48.794\nthat virtual router, right?\n\n323\n00:15:48.794 --> 00:15:54.181\nAnd I wanna use 192.168.16.1.\n\n324\n00:15:54.181 --> 00:15:55.798\nI don't need to specify a subnet mask,\n\n325\n00:15:55.798 --> 00:15:58.297\nit's gonna use the subnet mask\nfrom the interface already,\n\n326\n00:15:58.297 --> 00:16:01.286\ncuz it's gotta be in the same network or\nthis whole thing doesn't work.\n\n327\n00:16:01.286 --> 00:16:02.099\nSo I don't need that.\n\n328\n00:16:02.099 --> 00:16:03.492\nRight.\n\n329\n00:16:03.492 --> 00:16:07.184\nIf I stop right here,\ntechnically I'm done.\n\n330\n00:16:07.184 --> 00:16:10.880\nTechnically I've just\nconfigured HSRP on this router.\n\n331\n00:16:10.880 --> 00:16:14.460\nIt's the only one so\nit'll become active but I'm configured.\n\n332\n00:16:14.460 --> 00:16:15.540\nAll right?\n\n333\n00:16:15.540 --> 00:16:20.400\nIn the background it's transitioning\nthrough one of five different HSRP states.\n\n334\n00:16:20.400 --> 00:16:24.460\nThe first state is just called initial and\nthat means that you've turned on HSRP.\n\n335\n00:16:25.810 --> 00:16:28.530\nThen it moves on to listening.\n\n336\n00:16:28.530 --> 00:16:34.390\nIt's listening to see if there's already\nan active HSRP router for group one.\n\n337\n00:16:35.390 --> 00:16:38.290\nWe don't want to mess with the active guy\nif we don't have to because it's going\n\n338\n00:16:38.290 --> 00:16:39.670\nto listen to see.\n\n339\n00:16:39.670 --> 00:16:42.150\nIt's listening and\nseeing what's going on in the network.\n\n340\n00:16:42.150 --> 00:16:46.333\nNow, if it listens and there's nobody else\nout there, then it starts speaking and\n\n341\n00:16:46.333 --> 00:16:47.830\nsays hey, I'm here.\n\n342\n00:16:47.830 --> 00:16:50.640\nI think I'm gonna become active.\n\n343\n00:16:50.640 --> 00:16:53.750\nOr, if it found some other routers, then\nit's gonna come up and say hey I'm here\n\n344\n00:16:53.750 --> 00:16:57.710\nand I think I'm gonna go ahead and\nbecome a stand by or just be an other.\n\n345\n00:16:57.710 --> 00:16:59.410\nI just want you guys to know I'm here,\nright?\n\n346\n00:16:59.410 --> 00:17:01.590\nSo it does this speaking thing.\n\n347\n00:17:01.590 --> 00:17:05.220\nAnd then once it's done speaking,\nit transitions in to one of two states.\n\n348\n00:17:05.220 --> 00:17:09.213\nIt either goes active or standby, okay?\n\n349\n00:17:09.213 --> 00:17:14.050\nIf there's already an active and\na standby, then it goes to other.\n\n350\n00:17:14.050 --> 00:17:17.160\nAnd when you're in the other state,\nyou're technically still speaking.\n\n351\n00:17:17.160 --> 00:17:18.840\nYou just kind of stay\nin that speaking state.\n\n352\n00:17:18.840 --> 00:17:22.910\nYou're letting people know that you\nexist but you're not active or standby.\n\n353\n00:17:22.910 --> 00:17:27.900\nSo, my router, my switch did that and\nit's firing up and,\n\n354\n00:17:27.900 --> 00:17:31.235\noh shoot, [LAUGH] I picked a duplicate IP,\nthat's awesome.\n\n355\n00:17:31.235 --> 00:17:32.060\n>> [LAUGH]\n>> So, .1\n\n356\n00:17:32.060 --> 00:17:35.640\nis apparently already in use on my network\nso it's getting a little upset about that.\n\n357\n00:17:35.640 --> 00:17:38.190\nBut you'll see where I\nhave that state change.\n\n358\n00:17:38.190 --> 00:17:42.470\nAnd I went from state standby to active,\nokay?\n\n359\n00:17:42.470 --> 00:17:46.870\nSo I was listening and I went into standby\nfirst, and then went to active when I\n\n360\n00:17:46.870 --> 00:17:49.840\nrealized there was no active\nperson out there for group one.\n\n361\n00:17:49.840 --> 00:17:50.880\nSo I kind of took over that role.\n\n362\n00:17:50.880 --> 00:17:53.250\nNow I picked a duplicate IP and\n\n363\n00:17:53.250 --> 00:17:57.500\nthat's not a good thing so I'm gonna\nswitch my IP, maybe I'll use like 20.\n\n364\n00:17:57.500 --> 00:17:59.410\n>> We got a great show on\nnetworking fundamentals,\n\n365\n00:17:59.410 --> 00:18:02.295\nthis afternoon Don if you\nneed to check that out.\n\n366\n00:18:02.295 --> 00:18:04.553\n[LAUGH]\n>> So I'll move IPs here, but now I'm up,\n\n367\n00:18:04.553 --> 00:18:07.950\nI'm going, I'm still the active\nI just have a different IP.\n\n368\n00:18:07.950 --> 00:18:09.910\nIt even might actually do a reset.\n\n369\n00:18:09.910 --> 00:18:14.700\nIf I want to monitor this,\nI can just run, show standby.\n\n370\n00:18:14.700 --> 00:18:17.400\nAnd if you leave it there, it will\nshow all of your standby groups, or\n\n371\n00:18:17.400 --> 00:18:22.040\nyou can throw in a number and it'll\ntell you the actual group and you know,\n\n372\n00:18:22.040 --> 00:18:24.870\non mine, I did do group one didn't I?\n\n373\n00:18:24.870 --> 00:18:26.050\nAll right, well there we go.\n\n374\n00:18:26.050 --> 00:18:29.010\nWe'll do it, just a show standby,\nand I've only got one group so\n\n375\n00:18:29.010 --> 00:18:30.810\nit's not like I'm getting\na lot of output here anyway.\n\n376\n00:18:30.810 --> 00:18:33.100\nBut I can see that my state is active.\n\n377\n00:18:33.100 --> 00:18:37.051\nI can see my virtual IP\naddress is 192.168.16.20, and\n\n378\n00:18:37.051 --> 00:18:40.215\nthat's my virtual router\nthat I've created.\n\n379\n00:18:40.215 --> 00:18:45.575\nAnd if I take my workstations and\nset their default gateway to .20 instead\n\n380\n00:18:45.575 --> 00:18:49.895\nof my own .5, this is a virtual IP that\ncan then bounce between switches, right.\n\n381\n00:18:49.895 --> 00:18:51.085\nSo there's the virtual IP.\n\n382\n00:18:51.085 --> 00:18:52.705\nAnd the MAC address.\n\n383\n00:18:52.705 --> 00:18:54.435\nLook at this MAC address.\n\n384\n00:18:54.435 --> 00:18:59.898\nIn HSRP version one,\nyour MAC address will always\n\n385\n00:18:59.898 --> 00:19:05.370\nbe 0000.0c07.ac and then two numbers.\n\n386\n00:19:05.370 --> 00:19:07.720\nAnd those two numbers are your group and\nit's written in hexadecimal.\n\n387\n00:19:07.720 --> 00:19:11.770\nSo if you're using 1 through 9,\n\n388\n00:19:11.770 --> 00:19:16.630\nit'll just be 01, it starts at zero,\nso 00 through 09.\n\n389\n00:19:16.630 --> 00:19:20.700\nBut as soon as you get to 10,\nit becomes 0a.\n\n390\n00:19:20.700 --> 00:19:23.550\nAnd then 0b and\nit goes all the way up to ff.\n\n391\n00:19:23.550 --> 00:19:24.370\nAnd ff is 255.\n\n392\n00:19:24.370 --> 00:19:30.510\nSo that's where we get that limit of 0 to\n255 for our groups in HSRP version one.\n\n393\n00:19:30.510 --> 00:19:34.790\nWell, if you're running a big 6500\nseries switch and your routing for\n\n394\n00:19:34.790 --> 00:19:39.090\ntons of customers, and you've got tons of\nvlans, you might have more than 255 VLANs.\n\n395\n00:19:39.090 --> 00:19:41.720\nYou might need more than 255 HSRP groups.\n\n396\n00:19:41.720 --> 00:19:43.370\nAnd so they expanded that out.\n\n397\n00:19:43.370 --> 00:19:46.190\nAnd with version two, that number goes up.\n\n398\n00:19:46.190 --> 00:19:49.450\nAnd they needed more than just\nthese two digits to represent it.\n\n399\n00:19:49.450 --> 00:19:53.457\nSo if I issue standby 1\n\n400\n00:19:53.457 --> 00:19:59.200\nversion 2, that's going to move me\ninto version two if this switch,\n\n401\n00:19:59.200 --> 00:20:02.769\nthis switch has to support it,\nwhat is it doing?\n\n402\n00:20:02.769 --> 00:20:05.190\n[LAUGH] I say it has to support it,\nit doesn't have to do anything.\n\n403\n00:20:05.190 --> 00:20:05.780\n>> You will do this.\n\n404\n00:20:05.780 --> 00:20:10.820\n>> [LAUGH] But it should be, standby 1,\nhow can this switch not support that?\n\n405\n00:20:10.820 --> 00:20:14.090\nWell, what you normally do is\nyou get in the interface and\n\n406\n00:20:14.090 --> 00:20:18.610\nyou say standby1 version 2 and\nthat moves you into the version 2 mode.\n\n407\n00:20:18.610 --> 00:20:23.263\nAnd now you've got more group numbers\navailable to be able to use and\n\n408\n00:20:23.263 --> 00:20:26.212\nin my case I am just\nnot seeing the ability.\n\n409\n00:20:26.212 --> 00:20:29.730\nOh you don't specify the group number\non this one that's interesting.\n\n410\n00:20:29.730 --> 00:20:32.870\nBut, all right so if I leave off the group\nnumber, and just do a standby version.\n\n411\n00:20:32.870 --> 00:20:34.650\nAnd I'll say version two.\n\n412\n00:20:34.650 --> 00:20:35.290\nThere we go.\n\n413\n00:20:35.290 --> 00:20:36.680\nAnd so that's gonna move it.\n\n414\n00:20:36.680 --> 00:20:40.020\nAnd you'll notice I just got a status\nmessage, that I went from active to init.\n\n415\n00:20:40.020 --> 00:20:42.790\nThere's that initial status\nas we're turning on HSRP.\n\n416\n00:20:42.790 --> 00:20:46.090\nIt basically had to turn off version one,\nand now turn on version two.\n\n417\n00:20:46.090 --> 00:20:49.810\nSo it's flipped my mode, and\neventually I'll go active.\n\n418\n00:20:49.810 --> 00:20:52.810\nBut if I stat to look at things like, oh.\n\n419\n00:20:52.810 --> 00:20:54.790\nI know why we have to leave\nthe group number off.\n\n420\n00:20:54.790 --> 00:20:55.680\n>> It has to be consistent.\n\n421\n00:20:55.680 --> 00:20:58.710\n>> Because we're changing the way\nthe group numbers are being handled right?\n\n422\n00:20:58.710 --> 00:21:01.750\nBecause now I could have\nsomething far greater than 255 so\n\n423\n00:21:01.750 --> 00:21:02.710\nwe've got to leave that one off.\n\n424\n00:21:02.710 --> 00:21:03.860\nThat makes sense.\n\n425\n00:21:03.860 --> 00:21:07.730\nSo if I come in here and\nI take a look at standby,\n\n426\n00:21:07.730 --> 00:21:10.780\nnotice my command is not\n0 through 255 any more.\n\n427\n00:21:10.780 --> 00:21:13.241\nNow it's 0 through 4095.\n\n428\n00:21:13.241 --> 00:21:14.000\nAll right?\n\n429\n00:21:14.000 --> 00:21:17.270\nAnd so now I can do a much higher\ngroup number and technically,\n\n430\n00:21:17.270 --> 00:21:18.430\nI'm already configured, right?\n\n431\n00:21:18.430 --> 00:21:20.790\nBecause I did the standby 1 IP and\n\n432\n00:21:20.790 --> 00:21:24.240\nI can make sure that configuration is\nstill there just in case it is gone.\n\n433\n00:21:25.390 --> 00:21:30.040\nIf we take a look at it, and I can see\nthat my standby IP is still there, right?\n\n434\n00:21:30.040 --> 00:21:32.050\nAnd if I do a show standby.\n\n435\n00:21:33.390 --> 00:21:37.580\nWoops and take a look at that, we can\nsee where I'm up, my group is active and\n\n436\n00:21:37.580 --> 00:21:39.920\nsee how my mac address is now different?\n\n437\n00:21:39.920 --> 00:21:43.750\nThe mac address is different because\nnow we're in version two and\n\n438\n00:21:43.750 --> 00:21:50.260\na version two one always starts with\n0000 0C9F F and then it stops, right?\n\n439\n00:21:50.260 --> 00:21:53.839\nAnd then the last three\nare 000 all the way\n\n440\n00:21:53.839 --> 00:21:58.500\nthrough FFF which gets you 0 through 4095,\nright?\n\n441\n00:21:58.500 --> 00:22:01.030\nSo that's kind of a change right there.\n\n442\n00:22:01.030 --> 00:22:04.420\nOtherwise, not all that much\nchange with HSRP version 2.\n\n443\n00:22:04.420 --> 00:22:06.060\nThat was the big one right there.\n\n444\n00:22:06.060 --> 00:22:08.720\nThey did kind of tweak the way\nmulticaster handled forward and\n\n445\n00:22:08.720 --> 00:22:10.770\nthey improved some performance and\nstability.\n\n446\n00:22:10.770 --> 00:22:13.130\nSo if you support version 2,\nyou might as well flip to it.\n\n447\n00:22:13.130 --> 00:22:16.620\nBut your not going to see any huge\ngains over version 1 on most systems.\n\n448\n00:22:19.410 --> 00:22:20.750\nSo, that's basically\ngetting it configured,\n\n449\n00:22:20.750 --> 00:22:21.890\ngetting it kind of put in place.\n\n450\n00:22:22.960 --> 00:22:24.620\nTechnically we're up and running, right?\n\n451\n00:22:25.910 --> 00:22:30.195\nIf I go and turn on another switch, now\nwe can actually see this cluster working,\n\n452\n00:22:30.195 --> 00:22:32.790\ncuz right now it's not\nactually working for me.\n\n453\n00:22:32.790 --> 00:22:37.409\nIf I just do a show standby, and I take\na look at it, I see my state is active.\n\n454\n00:22:37.409 --> 00:22:41.668\nI've got this virtual router of\n192.168.16.20 but if I look down here,\n\n455\n00:22:41.668 --> 00:22:43.670\nstandby router is unknown.\n\n456\n00:22:43.670 --> 00:22:47.260\nIf I fail,\nthere's nobody there to take over, right?\n\n457\n00:22:47.260 --> 00:22:49.900\nSo I really need to jump\nover to another switch.\n\n458\n00:22:49.900 --> 00:22:51.760\nSo I'll take my other core switch here.\n\n459\n00:22:51.760 --> 00:22:53.010\n>> And the whole purpose is to\n\n460\n00:22:53.010 --> 00:22:55.094\nhave the redundancy of\nthe multiple switches, right?\n\n461\n00:22:55.094 --> 00:22:57.130\n>> Yep, that is exactly right.\n\n462\n00:22:57.130 --> 00:23:00.300\nAnd I can jump over to this one and\nstart to get it configured over here.\n\n463\n00:23:00.300 --> 00:23:07.050\nSo, let me just get into my configuration\nand we will jump into interface vlan 1.\n\n464\n00:23:07.050 --> 00:23:12.720\nAnd let's see what I've got\non this interface already.\n\n465\n00:23:12.720 --> 00:23:13.780\nSo this one's .6.\n\n466\n00:23:13.780 --> 00:23:15.920\nMy other switch was .5, this one's .6.\n\n467\n00:23:15.920 --> 00:23:17.010\nSo I'll just come in here and\n\n468\n00:23:17.010 --> 00:23:20.970\nI'll say standby version 2,\nI do need to be in the same version.\n\n469\n00:23:20.970 --> 00:23:28.505\nAnd then I can say standby\n1 IP 192.168.16.20.\n\n470\n00:23:28.505 --> 00:23:31.840\nThe same IP I put in on the other side,\nbecause this is the standby.\n\n471\n00:23:31.840 --> 00:23:34.010\nThat shared virtual IP.\n\n472\n00:23:34.010 --> 00:23:37.592\nSo I'll put that in, and\nnow HSRP is gonna kick in.\n\n473\n00:23:37.592 --> 00:23:39.380\nI'm gonna start communicating\nwith that other switch.\n\n474\n00:23:39.380 --> 00:23:40.998\nI'm gonna go to the initial state.\n\n475\n00:23:40.998 --> 00:23:44.701\nI'm gonna start talking to the network,\nwell I'm gonna listen first and\n\n476\n00:23:44.701 --> 00:23:46.082\nI'll see that other side.\n\n477\n00:23:46.082 --> 00:23:50.326\nThen I'll start speaking and I'll say,\nhey I'm ready to participate,\n\n478\n00:23:50.326 --> 00:23:51.841\ndo you guys need a backup?\n\n479\n00:23:51.841 --> 00:23:54.093\nAnd then I should go\ninto the standby state.\n\n480\n00:23:54.093 --> 00:23:57.543\nOr if there's already an active and\na standby then I'll just keep speaking and\n\n481\n00:23:57.543 --> 00:23:58.598\nthat's that, right?\n\n482\n00:23:58.598 --> 00:24:02.568\nSo I can see I just went\nfrom Speak to Standby.\n\n483\n00:24:02.568 --> 00:24:08.064\nAnd if I do a show standby, I can look at\nthat and I can see that I do have a state\n\n484\n00:24:08.064 --> 00:24:13.420\nchange, my Virtual IP is 192.168.16.20,\nright there.\n\n485\n00:24:13.420 --> 00:24:17.800\nAnd if I look down here, I can see\nthe active router is 192.168.16.5,\n\n486\n00:24:17.800 --> 00:24:21.240\nthat's my other switch.\n\n487\n00:24:21.240 --> 00:24:27.741\nAnd then I'm the standby, and so it says,\nStandby router is local, I'm the standby.\n\n488\n00:24:27.741 --> 00:24:30.436\nSo I now have a true cluster.\n\n489\n00:24:30.436 --> 00:24:34.543\nIf one of the other switches, or\nif the active one were to fail,\n\n490\n00:24:34.543 --> 00:24:36.660\nI would take over, okay.\n\n491\n00:24:36.660 --> 00:24:38.810\nNow, let me show you kinda\nthat failure real quick.\n\n492\n00:24:38.810 --> 00:24:43.360\nIf I jump over to my other switch,\nwhat can cause a failure?\n\n493\n00:24:43.360 --> 00:24:45.810\nWell, it's gonna be one of two things,\nright.\n\n494\n00:24:45.810 --> 00:24:49.510\nIf the whole switch were to fail, if I\nwere to yank the power plug out of it,\n\n495\n00:24:49.510 --> 00:24:50.944\nright, that's a failure,\n\n496\n00:24:50.944 --> 00:24:54.379\nthat'll cause it to flip over, or\nif the VLAN interface goes down.\n\n497\n00:24:54.379 --> 00:24:56.140\nNow, when's your VLAN\ninterface gonna go down?\n\n498\n00:24:57.480 --> 00:25:00.898\nNever really is, right,\nif it has no ports active in that VLAN.\n\n499\n00:25:00.898 --> 00:25:04.760\nBut if you've got at least one trunk, it\nshould always be up so it's not realistic.\n\n500\n00:25:04.760 --> 00:25:07.475\nBut I'm gonna to down the VLAN\ninterface just to show you guys.\n\n501\n00:25:08.545 --> 00:25:11.775\nSo if I go into int vlan 1 and\ndo a shutdown,\n\n502\n00:25:11.775 --> 00:25:16.305\nall right, this guy can't be active\nanymore cuz it just lost its interface.\n\n503\n00:25:16.305 --> 00:25:18.645\nAnd so you'll see some status\nmessages coming up and\n\n504\n00:25:18.645 --> 00:25:22.960\nI can see my Grp 1 state\nwent from Active to Init.\n\n505\n00:25:22.960 --> 00:25:24.711\nSo I'm now down as the active.\n\n506\n00:25:24.711 --> 00:25:29.029\nAnd if I switch back over to my other\nswitch, I'm gonna switch switches,\n\n507\n00:25:29.029 --> 00:25:32.490\nyou'll see I got a status\nmessage right there.\n\n508\n00:25:32.490 --> 00:25:34.470\nGrp 1 state went from Standby to Active.\n\n509\n00:25:35.580 --> 00:25:37.796\nAnd your work stations,\nthey don't even know this happened.\n\n510\n00:25:37.796 --> 00:25:42.640\nBecause the virtual IP stays the same,\n192.168.16.20.\n\n511\n00:25:42.640 --> 00:25:46.340\nAnd the MAC address stays the same cuz\nit was a virtual MAC, it hands off.\n\n512\n00:25:46.340 --> 00:25:48.780\nAnd so they just start going\nto this new destination.\n\n513\n00:25:48.780 --> 00:25:50.470\nThey don't even realize that it happened.\n\n514\n00:25:50.470 --> 00:25:54.730\nWe now have first hop redundancy right\nhere in the event of a switch failure.\n\n515\n00:25:54.730 --> 00:25:58.640\n>> Yeah, Don, I've seen this in action and\nI think we lost maybe one ping.\n\n516\n00:25:58.640 --> 00:26:01.400\nIt was so quick, super fast,\n\n517\n00:26:01.400 --> 00:26:04.770\nno workstation knew anything about the\nfact that one switch actually went down.\n\n518\n00:26:04.770 --> 00:26:06.000\n>> Yeah, it's fast.\n\n519\n00:26:06.000 --> 00:26:09.500\nThe part that takes the longest is that\nvirtual MAC address is moving to other\n\n520\n00:26:09.500 --> 00:26:13.130\nhardware, and so the switches have\nto update their MAC address table.\n\n521\n00:26:13.130 --> 00:26:15.810\nThat's really all you're waiting for,\nand that happens pretty quick,\n\n522\n00:26:15.810 --> 00:26:17.530\nso you usually don't notice.\n\n523\n00:26:17.530 --> 00:26:21.730\nI mean, there's some software out there\nlike Lotus Domino that'll pick up on that,\n\n524\n00:26:21.730 --> 00:26:23.970\nbut most software won't\neven realize it happened.\n\n525\n00:26:23.970 --> 00:26:25.520\nIt's just a smooth transition over.\n\n526\n00:26:25.520 --> 00:26:28.890\n>> Yeah, now we have some redundancy\nif the switch fails, right?\n\n527\n00:26:28.890 --> 00:26:31.180\nIf that goes down, it's not a problem.\n\n528\n00:26:31.180 --> 00:26:34.164\nJumps over to our standby switch,\nit becomes the active switch, and\n\n529\n00:26:34.164 --> 00:26:35.249\nwe're off to the races.\n\n530\n00:26:35.249 --> 00:26:39.476\nBut Don, one of the more common problems\nthat we actually have in switches is that\n\n531\n00:26:39.476 --> 00:26:42.970\na port fails, and\nnot necessarily the switch itself.\n\n532\n00:26:42.970 --> 00:26:44.030\nWhat can we do if that happens?\n\n533\n00:26:44.030 --> 00:26:45.605\nDo we have some HSRP for that?\n\n534\n00:26:45.605 --> 00:26:46.105\n>> Yeah.\n>> [LAUGH]\n\n535\n00:26:46.105 --> 00:26:46.713\n>> Yeah so,\n\n536\n00:26:46.713 --> 00:26:50.875\nyou bring up a great point there, right?\nIf I take a look at my\n\n537\n00:26:50.875 --> 00:26:52.785\ncore switch here, right?\n\n538\n00:26:52.785 --> 00:26:55.765\nWhen I downed it, I downed Vlan1,\nand that's never gonna happen.\n\n539\n00:26:55.765 --> 00:26:58.925\nThat's not a realistic failure.\n\n540\n00:26:58.925 --> 00:27:03.275\nSo, really all HSRP is set up for\nhere is if my whole switch fails, and\n\n541\n00:27:03.275 --> 00:27:04.627\nthat's not terribly realistic either.\n\n542\n00:27:04.627 --> 00:27:08.420\nThese things'll run for seven,\nten years and never have a single failure.\n\n543\n00:27:08.420 --> 00:27:09.890\nYou're more likely to\nhave a power outage or\n\n544\n00:27:09.890 --> 00:27:13.070\nsome other kind of configuration\nissue that downs it.\n\n545\n00:27:13.070 --> 00:27:15.390\nBut an individual port failing,\nthat happens a lot.\n\n546\n00:27:15.390 --> 00:27:18.310\nWell, I'm tied to Vlan1,\nand Vlan1's not gonna fail,\n\n547\n00:27:18.310 --> 00:27:21.710\nso the port failing here isn't gonna help.\n\n548\n00:27:21.710 --> 00:27:24.540\nWhat if I wanna monitor some other port?\n\n549\n00:27:24.540 --> 00:27:26.870\nNow, if I'm the default gateway,\n\n550\n00:27:26.870 --> 00:27:32.440\nthen I'm typically going to be using some\nkind of downstream router as my gateway.\n\n551\n00:27:32.440 --> 00:27:33.874\nI'll have a gateway of last resort or\n\n552\n00:27:33.874 --> 00:27:36.910\nsome default route that I use\nto get people to the Internet.\n\n553\n00:27:36.910 --> 00:27:39.810\nI might wanna monitor the port\nthat that's attached to.\n\n554\n00:27:39.810 --> 00:27:43.190\nI don't wanna put that port in HSRP,\nbut I wanna monitor that port.\n\n555\n00:27:43.190 --> 00:27:45.258\nSo what we can do is we\ncan use track objects.\n\n556\n00:27:45.258 --> 00:27:49.012\nIf you watched the route show, I spent\nsome time on that in the IP SLA episodes.\n\n557\n00:27:49.012 --> 00:27:52.360\nBut here, on a switch,\nyou can do track objects also.\n\n558\n00:27:52.360 --> 00:27:56.485\nYou can track individual interfaces or\nyou can track routes.\n\n559\n00:27:56.485 --> 00:27:58.825\nSo if you have a default\nroute in your routing table,\n\n560\n00:27:58.825 --> 00:28:00.735\nyou can just monitor to see if\nthe default route is there.\n\n561\n00:28:00.735 --> 00:28:03.705\nAnd if the default route goes away,\nyou can take action,\n\n562\n00:28:03.705 --> 00:28:05.365\nyou can cause HSRP to failover.\n\n563\n00:28:05.365 --> 00:28:08.415\nThere's some neat ways to do this and\nI wanna show them to you.\n\n564\n00:28:08.415 --> 00:28:12.155\nSo let's just use a quick example here.\n\n565\n00:28:12.155 --> 00:28:18.677\nLet's say I've got interface fa1/0/1, and\nthere is a router on the other side of it.\n\n566\n00:28:18.677 --> 00:28:23.352\nSo if I ping to 192.168.16.,\n\n567\n00:28:23.352 --> 00:28:28.300\nwhat is that guy's IP, 22 or something.\n\n568\n00:28:28.300 --> 00:28:29.260\nWait, let me find out.\n\n569\n00:28:29.260 --> 00:28:32.190\nIf my Edge guy here, this Edge router.\n\n570\n00:28:32.190 --> 00:28:35.363\nSo if I take a look at, or no,\nit's not, it's NY WAN, here we go.\n\n571\n00:28:35.363 --> 00:28:38.240\nNY WAN, this router,\nwhich I apparently didn't power on, so\n\n572\n00:28:38.240 --> 00:28:39.885\nwe'll have to pick somebody else.\n\n573\n00:28:39.885 --> 00:28:41.740\n[LAUGH] Let's pick this guy here.\n\n574\n00:28:41.740 --> 00:28:44.330\nI have a number of different devices\nto pick from that are actually\n\n575\n00:28:44.330 --> 00:28:45.470\nalready powered on.\n\n576\n00:28:45.470 --> 00:28:49.278\nSo, if I do a show IP int br,\nI can look at this guy.\n\n577\n00:28:49.278 --> 00:28:53.000\nThis guy is 192.168.16.1, this is\nthe guy I duplicated earlier, right?\n\n578\n00:28:53.000 --> 00:28:56.460\nSo there's a nice little overlap for me.\n\n579\n00:28:56.460 --> 00:28:59.460\nAnd that's the Gi 0/0\ninterface on this one.\n\n580\n00:28:59.460 --> 00:29:04.090\nSo if I go to my core switch and I take a\nlook at how I'm connected to that, right?\n\n581\n00:29:04.090 --> 00:29:08.150\nSo if I look at my cdp nei,\noh, I'm not in config.\n\n582\n00:29:09.920 --> 00:29:11.572\nAnd I take a look at my neighbors,\n\n583\n00:29:11.572 --> 00:29:14.585\nI can see that I'm connected\nto NYEDGE1 on Fas 1/0/1.\n\n584\n00:29:14.585 --> 00:29:16.650\nGood, all right, so\nthat's the interface that I'm on.\n\n585\n00:29:16.650 --> 00:29:18.580\nI might wanna monitor that interface, or\n\n586\n00:29:18.580 --> 00:29:20.910\nI might just wanna monitor\nsome route that's tied to it.\n\n587\n00:29:20.910 --> 00:29:25.720\nSo for example, I might say ip route, and\n\n588\n00:29:25.720 --> 00:29:32.850\nhave a default route that points to\n192.168.16.1, to that guy, okay.\n\n589\n00:29:32.850 --> 00:29:37.484\nAnd that route makes it into my routing\ntable as my gateway of last resort,\n\n590\n00:29:37.484 --> 00:29:38.399\nright there.\n\n591\n00:29:38.399 --> 00:29:41.310\nAnd so I might want to monitor\nwhether that default route is there.\n\n592\n00:29:41.310 --> 00:29:44.050\nSo I can just create a track\nobject that monitors those and\n\n593\n00:29:44.050 --> 00:29:45.370\nthen reflects the status.\n\n594\n00:29:45.370 --> 00:29:46.980\nIt's pretty straight forward.\n\n595\n00:29:46.980 --> 00:29:49.015\nIf you've seen the route show,\nyou already know how to do this.\n\n596\n00:29:49.015 --> 00:29:53.338\nBut if you haven't, the commands to create\na track object, we basically say track,\n\n597\n00:29:53.338 --> 00:29:55.070\nand then you give it a number.\n\n598\n00:29:55.070 --> 00:29:58.110\nYou can create as many track objects\nas you want, well, there is a limit.\n\n599\n00:29:58.110 --> 00:30:01.720\nLet's see what mine is, 1000, but\nI'm not gonna monitor 1000 things.\n\n600\n00:30:01.720 --> 00:30:06.580\nSo I'm just gonna say track 1, and\nthen you can track all sorts of stuff.\n\n601\n00:30:06.580 --> 00:30:08.840\nYou can track jitter and delay,\n\n602\n00:30:08.840 --> 00:30:12.910\nyou can track, reachability is what\nI normally do, can I reach it?\n\n603\n00:30:12.910 --> 00:30:14.980\nYou can track all sorts of crazy stuff.\n\n604\n00:30:14.980 --> 00:30:17.545\nSo it's kinda up to you how\nyou wanna set this one up.\n\n605\n00:30:17.545 --> 00:30:21.294\nBut in my scenario, I just wanna track,\nI'll start with an interface.\n\n606\n00:30:21.294 --> 00:30:27.017\nSo I'm gonna track fa1/0/1 and\nwhat I'm looking for\n\n607\n00:30:27.017 --> 00:30:31.640\nis line-protocol, the physical port.\n\n608\n00:30:31.640 --> 00:30:35.200\nIf that physical port goes down,\nthis track object will go down.\n\n609\n00:30:36.290 --> 00:30:39.170\nSo it gives me a way to kind\nof monitor that physical port.\n\n610\n00:30:39.170 --> 00:30:42.742\nIf I'm monitoring a route,\nI could say, I'll do track 2 here.\n\n611\n00:30:42.742 --> 00:30:44.801\nI do track 2, and then I come in and\n\n612\n00:30:44.801 --> 00:30:48.000\nI specify that I'm wanting\nto monitor a route.\n\n613\n00:30:48.000 --> 00:30:50.560\nAnd if you do a question mark you'll see\nthe different things you can monitor.\n\n614\n00:30:50.560 --> 00:30:52.390\nI guess route's tucked under IP.\n\n615\n00:30:52.390 --> 00:30:57.980\nBut we can say ip route, and you can\nspecify the route you wanna monitor.\n\n616\n00:30:57.980 --> 00:31:00.630\nAnd then just add the key word,\nreachability,\n\n617\n00:31:01.650 --> 00:31:05.410\nwhich means look at my routing table and\nsee if you can find a route.\n\n618\n00:31:05.410 --> 00:31:08.050\nAnd by doing all 0s\nthat's the default route.\n\n619\n00:31:08.050 --> 00:31:12.811\nSo track object 1 is monitoring\na physical interface,\n\n620\n00:31:12.811 --> 00:31:16.165\ntrack object 2 is monitoring a route.\n\n621\n00:31:16.165 --> 00:31:19.120\nAnd the commands,\nlet me just bring those back up again.\n\n622\n00:31:20.240 --> 00:31:22.060\nThe commands are pretty simple too.\n\n623\n00:31:22.060 --> 00:31:23.570\nIf you go jump over to the route show and\n\n624\n00:31:23.570 --> 00:31:27.810\ncheck out the IP SLA episode, I show where\nyou can set up schedules and timers.\n\n625\n00:31:27.810 --> 00:31:30.670\nYou can set up all sorts of\ncrazy things here to monitor and\n\n626\n00:31:30.670 --> 00:31:32.790\ninfluence how often it pings and\nall of that.\n\n627\n00:31:32.790 --> 00:31:34.580\nThere's a lot more to them.\n\n628\n00:31:34.580 --> 00:31:38.660\nBut for this, these two commands\nright here really kinda tackle it.\n\n629\n00:31:38.660 --> 00:31:41.450\nOne monitors a physical interface,\none monitors a route.\n\n630\n00:31:41.450 --> 00:31:44.036\nIf either one goes down,\nthe track object fails.\n\n631\n00:31:44.036 --> 00:31:47.356\nAnd we can tie that track object to HSRP.\n\n632\n00:31:47.356 --> 00:31:53.208\nSo I can jump into HSRP, well here,\nlet me show you a track object fail first.\n\n633\n00:31:53.208 --> 00:31:57.341\nSo if I say Show track 1,\nit says that it's up, right?\n\n634\n00:31:57.341 --> 00:31:58.827\nThat interface is up.\n\n635\n00:31:58.827 --> 00:32:02.671\nIf I get into interface fa1/0/1,\nand I shut it down,\n\n636\n00:32:02.671 --> 00:32:07.450\nthe interface goes down,\nthe track object will go down, all right.\n\n637\n00:32:07.450 --> 00:32:11.893\nSo I get one extra line there during\na failure letting me know the track object\n\n638\n00:32:11.893 --> 00:32:16.348\nwent down, and if I do a show track 1,\nI can see that status is down, right?\n\n639\n00:32:16.348 --> 00:32:19.970\nSo another way to kind of monitor that,\nand\n\n640\n00:32:19.970 --> 00:32:24.295\nI can jump into the HSRP\nconfiguration on VLAN 1 and\n\n641\n00:32:24.295 --> 00:32:29.927\nwhat you do is you say standby 1,\nand then if you look at your help,\n\n642\n00:32:29.927 --> 00:32:34.025\nyou've got the track command right there.\n\n643\n00:32:34.025 --> 00:32:38.425\nAnd we can track, if I say track 1,\nI'm gonna track that physical interface,\n\n644\n00:32:38.425 --> 00:32:40.455\nif I say track 2,\nI'm gonna track my default route, right?\n\n645\n00:32:40.455 --> 00:32:43.557\nSo you can track kind of\nwhatever you want, right?\n\n646\n00:32:43.557 --> 00:32:47.517\nNow when we track an object,\nyou need to say what to do about it,\n\n647\n00:32:47.517 --> 00:32:49.477\nand there's two options here.\n\n648\n00:32:49.477 --> 00:32:51.487\nA lot of times you just want it shut down.\n\n649\n00:32:51.487 --> 00:32:52.717\nHey, if I can't get to that port,\n\n650\n00:32:52.717 --> 00:32:55.540\npeople don't need to come to me,\nshut this one down, right?\n\n651\n00:32:55.540 --> 00:32:58.100\nAnd I don't mean shut the router down and\nturn it off.\n\n652\n00:32:58.100 --> 00:33:00.240\nI mean shut down the HSRP group,\n\n653\n00:33:00.240 --> 00:33:03.180\nwhich is gonna cause the other\nrouter to go active, right?\n\n654\n00:33:03.180 --> 00:33:04.510\nThe problem with shutting it down,\n\n655\n00:33:04.510 --> 00:33:07.850\nthough, is it kind of has a hard\ntime coming back up, right?\n\n656\n00:33:07.850 --> 00:33:11.400\nSo another option we can do is\ncalled a decrement, all right?\n\n657\n00:33:11.400 --> 00:33:14.670\nEvery router in our HSRP\ncluster has a priority,\n\n658\n00:33:14.670 --> 00:33:18.300\nand the priority determines who's\ngoing to be the active router.\n\n659\n00:33:18.300 --> 00:33:20.480\nAnd by default they all\nhave a priority of 100.\n\n660\n00:33:20.480 --> 00:33:23.970\nYou can set it so\nthat when the track object fails,\n\n661\n00:33:23.970 --> 00:33:28.210\ninstead of shutting it down,\nit can lower the priority.\n\n662\n00:33:28.210 --> 00:33:31.630\nA higher priority number's gonna become\nactive, a lower priority number won't.\n\n663\n00:33:31.630 --> 00:33:35.990\nSo, we can say, lower my priority so\nsomebody else can become active, and\n\n664\n00:33:35.990 --> 00:33:38.550\nlet them jump in and take over, all right?\n\n665\n00:33:38.550 --> 00:33:42.880\nAnd if that happens, now we're up,\nand we're happy, and we're running.\n\n666\n00:33:42.880 --> 00:33:45.510\nBut we wanna pay attention to\nhow we do our decrements, right?\n\n667\n00:33:45.510 --> 00:33:49.360\nCuz you might be tracking more than\none object, so you might wanna have\n\n668\n00:33:49.360 --> 00:33:52.350\ntwo things fail, or three things fail\nbefore you actually fail over, and\n\n669\n00:33:52.350 --> 00:33:54.220\nyou can use decrements to figure that out.\n\n670\n00:33:54.220 --> 00:33:58.710\nSo I can say decrement ten,\nif that interface goes down,\n\n671\n00:33:58.710 --> 00:34:00.359\nI'm gonna reduce my priority by ten.\n\n672\n00:34:01.650 --> 00:34:06.370\nMy default priority is 100, that'll\ntake me down to 90, and I'm in business.\n\n673\n00:34:06.370 --> 00:34:12.000\nWell, I could also come in and\nsay, like, standby 1 priority and\n\n674\n00:34:12.000 --> 00:34:16.920\nredefine my priority to something higher,\nso maybe I am the root.\n\n675\n00:34:16.920 --> 00:34:21.210\nI want this one to be the active router,\nand so, I set my priority to 110.\n\n676\n00:34:21.210 --> 00:34:23.360\nEverybody else is 100, so\nI'll become the active, right?\n\n677\n00:34:23.360 --> 00:34:28.890\nMy priority is 110, and when I fail that\ntrack object, it's gonna decrement it\n\n678\n00:34:28.890 --> 00:34:32.190\nby 10, that'll put me to 100 just in line\nwith everybody else, I'll stay active.\n\n679\n00:34:32.190 --> 00:34:34.940\nBut, if bump that to 11,\nIt'll take me down to 99,\n\n680\n00:34:34.940 --> 00:34:37.950\nand everybody else will be better\nthan me and then they can take over.\n\n681\n00:34:37.950 --> 00:34:40.150\nSo, you gotta kinda pay\nattention to that stuff.\n\n682\n00:34:40.150 --> 00:34:41.680\nSo, by setting my priority to 110,\n\n683\n00:34:41.680 --> 00:34:46.540\nI will become active and\nthe other guys won't, they'll go standby.\n\n684\n00:34:46.540 --> 00:34:47.914\nAnd then, if a failure happens,\n\n685\n00:34:47.914 --> 00:34:50.475\nI'll drop down to 99 and\nsomebody else will become active.\n\n686\n00:34:50.475 --> 00:34:52.752\nNow, if my priority is\nhigher than everybody else,\n\n687\n00:34:52.752 --> 00:34:54.760\nI should be active right now, shouldn't I?\n\n688\n00:34:54.760 --> 00:35:00.870\nWell, by default, HSRP will not\noverride the currently active master.\n\n689\n00:35:00.870 --> 00:35:05.500\nSo if I do a show standby and I look\nat what's in there I can see where my\n\n690\n00:35:05.500 --> 00:35:11.290\npriority is 110 right there, and\nif I look at the active router, it doesn't\n\n691\n00:35:11.290 --> 00:35:13.830\nsay it here, but I didn't configure it on\nthe other router, so you know it's 100.\n\n692\n00:35:13.830 --> 00:35:15.860\nI'm not the active.\n\n693\n00:35:15.860 --> 00:35:17.390\nWhy not?\n\n694\n00:35:17.390 --> 00:35:19.440\nAnd that's because we're\nnot overriding it.\n\n695\n00:35:19.440 --> 00:35:24.064\nIf you want overrides, you need to\ntype standby and your group number,\n\n696\n00:35:24.064 --> 00:35:25.820\npreempt, all right?\n\n697\n00:35:25.820 --> 00:35:27.310\nIt's called preemption, and\n\n698\n00:35:27.310 --> 00:35:31.270\nit basically says if I've got a better\npriority, I want to be the active.\n\n699\n00:35:31.270 --> 00:35:33.720\nAnd when I turned on that preemption,\nyou'll see, there we go,\n\n700\n00:35:33.720 --> 00:35:34.890\nwe went and turned active.\n\n701\n00:35:34.890 --> 00:35:38.440\nSo if you have one router or one switch\nthat you want to be the active one and\n\n702\n00:35:38.440 --> 00:35:41.820\nyou give it a higher priority, it's a good\nidea to turn on preemption there too.\n\n703\n00:35:41.820 --> 00:35:44.670\nThat way if there's a failure,\nsomebody else can take over, but\n\n704\n00:35:44.670 --> 00:35:45.810\nwhen the failure is gone and\n\n705\n00:35:45.810 --> 00:35:50.972\nthis switch comes back to normal, it'll\ntake back over and become the primary.\n\n706\n00:35:50.972 --> 00:35:53.284\nAll right, and\nthat's what just happened for me.\n\n707\n00:35:53.284 --> 00:35:58.123\nSo I'm now active and if I get into\nfa1/0/1, and I shut that, well,\n\n708\n00:35:58.123 --> 00:36:01.479\nbefore I do it here let me\njust do a show standby, and\n\n709\n00:36:01.479 --> 00:36:05.290\nwe saw that my priority was 110, right?\n\n710\n00:36:05.290 --> 00:36:08.150\nSo right here I can see\nmy priority is 110.\n\n711\n00:36:08.150 --> 00:36:13.170\nAnd the standby router is the other switch\nand it's got a priority of 100, right?\n\n712\n00:36:13.170 --> 00:36:14.850\nI can see its priority now.\n\n713\n00:36:14.850 --> 00:36:19.590\nIf shut this interface down,\nmy track object\n\n714\n00:36:19.590 --> 00:36:23.950\nfails which is gonna\nlower my priority to 99,\n\n715\n00:36:23.950 --> 00:36:27.740\nand I should give up my role\nas the active HSRP router.\n\n716\n00:36:28.845 --> 00:36:30.260\nI should.\n\n717\n00:36:30.260 --> 00:36:32.510\nWell, I'm waiting and it's not happening.\n\n718\n00:36:32.510 --> 00:36:33.940\nSo what's going on there?\n\n719\n00:36:33.940 --> 00:36:36.120\nWell, if I look at my show standby output,\n\n720\n00:36:37.145 --> 00:36:41.285\nI can see that my track object has\ncaused me to decrement down to 99.\n\n721\n00:36:41.285 --> 00:36:42.245\nIt worked like I expected.\n\n722\n00:36:42.245 --> 00:36:44.915\nAnd the standby has a priority of 100.\n\n723\n00:36:44.915 --> 00:36:47.145\nWhy didn't the standby take over?\n\n724\n00:36:47.145 --> 00:36:50.530\nBecause it's not gonna preempt me,\nI'm the active router.\n\n725\n00:36:50.530 --> 00:36:52.980\nI need to turn on preemption on it, too.\n\n726\n00:36:52.980 --> 00:36:54.820\nAnd then it would have taken over and\nkicked in.\n\n727\n00:36:55.960 --> 00:36:58.780\nIf we had left it at\nthe default function of hey,\n\n728\n00:36:58.780 --> 00:37:00.750\ntrack this object and if the object fails,\n\n729\n00:37:00.750 --> 00:37:04.040\njust shut down, then this would have\nworked and that would have been it.\n\n730\n00:37:04.040 --> 00:37:07.270\nBut because I did a decrement, I need to\nmake sure preemption is turned on, so\n\n731\n00:37:07.270 --> 00:37:09.670\nthe other guys will kick in and\ndo their work.\n\n732\n00:37:09.670 --> 00:37:13.800\nSo, if I were to jump over\nto the other switch and\n\n733\n00:37:13.800 --> 00:37:19.355\njump back in to my configuration and\nget in to VLAN1 and\n\n734\n00:37:19.355 --> 00:37:23.980\nset its standby with preemption,\n\n735\n00:37:23.980 --> 00:37:29.090\nit's got a priority of 100, I've got a\npriority of 99 and so it should take over.\n\n736\n00:37:29.090 --> 00:37:30.260\nAnd, I see that it just did.\n\n737\n00:37:30.260 --> 00:37:34.660\nSo, it just took over,\nit's now the head honcho, it's active.\n\n738\n00:37:34.660 --> 00:37:38.530\nAnd if I go back to core one,\nand I fix my problem, right?\n\n739\n00:37:38.530 --> 00:37:44.110\nSo if I fix the issue with my system,\nI can get into that interface and fix it.\n\n740\n00:37:45.500 --> 00:37:50.630\nMy priority will go back to 110,\nI'm set to preempt, I'll become active.\n\n741\n00:37:50.630 --> 00:37:54.130\nAnd so\nit's kind of tucked away right there,\n\n742\n00:37:54.130 --> 00:37:56.050\nI just went from standby to active, right?\n\n743\n00:37:56.050 --> 00:38:01.480\nSo now I'm in business, and that's really\nall there is to it to configuring HSRP.\n\n744\n00:38:01.480 --> 00:38:07.260\nTechnically, I was done 25 minutes\nago when I issued standby one IP and\n\n745\n00:38:07.260 --> 00:38:09.380\nIP address, I was done right there.\n\n746\n00:38:09.380 --> 00:38:12.710\nBut all these other things\nare ways that we can tweak\n\n747\n00:38:12.710 --> 00:38:16.000\nthe configuration to get it to\nbehave the way that we want, right?\n\n748\n00:38:16.000 --> 00:38:18.110\nThere's a lot of stuff\nthat you can adjust, and\n\n749\n00:38:18.110 --> 00:38:21.840\neven then it really just boils down\nto a handful of commands, right?\n\n750\n00:38:21.840 --> 00:38:26.010\nSo these standby commands that,\nthese five and the track objects,\n\n751\n00:38:26.010 --> 00:38:29.580\nbetween those you get a pretty\nwell-rounded clustering solution.\n\n752\n00:38:29.580 --> 00:38:32.350\n>> Yeah, it's nice to be able\nto use that preemption to\n\n753\n00:38:32.350 --> 00:38:35.810\nenable some consistency in your network\nbecause the switch goes down, and\n\n754\n00:38:35.810 --> 00:38:37.910\nyou're not just gonna leave it down and\ngo, oh well, what are we gonna do?\n\n755\n00:38:37.910 --> 00:38:39.050\nYou're gonna get fixed,\n\n756\n00:38:39.050 --> 00:38:43.740\nyou're gonna replace it with another\nswitch, and you want that consistency.\n\n757\n00:38:43.740 --> 00:38:47.820\nI expect that to be that,\nnot the standby, right,\n\n758\n00:38:47.820 --> 00:38:50.050\nbut the active, or the active switch.\n\n759\n00:38:50.050 --> 00:38:52.280\nI want that to be there all the time.\n\n760\n00:38:52.280 --> 00:38:54.600\nAnd when this one has to take over,\nit does, that's great, but\n\n761\n00:38:54.600 --> 00:38:57.220\nwhen I get everything back to\nthe way I like it, let's use\n\n762\n00:38:57.220 --> 00:39:00.690\nthat preemption to make sure it comes back\nto the way we actually want it to work.\n\n763\n00:39:00.690 --> 00:39:02.040\n>> Yeah, absolutely.\n\n764\n00:39:02.040 --> 00:39:04.240\nNow Daniel, I only got through HSRP.\n\n765\n00:39:04.240 --> 00:39:05.560\n>> You only got there.\n\n766\n00:39:05.560 --> 00:39:09.025\n>> I had two more to talk about,\nVRRP and GLBP.\n\n767\n00:39:09.025 --> 00:39:11.171\nTheir configurations are almost identical,\nso\n\n768\n00:39:11.171 --> 00:39:14.583\nthe work that we just did right there is\nbasically the same with the other two.\n\n769\n00:39:14.583 --> 00:39:17.018\nBut there are important,\nthey do behave a little differently, so\n\n770\n00:39:17.018 --> 00:39:18.270\nI wanna talk about them.\n\n771\n00:39:18.270 --> 00:39:21.965\nBut let's do a part two so we can tackle\nthose other guys and get them knocked out.\n\n772\n00:39:21.965 --> 00:39:23.975\nThey are important,\nyou do wanna know them.\n\n773\n00:39:23.975 --> 00:39:26.775\nThere are times where the other\nprotocols are preferred, but\n\n774\n00:39:26.775 --> 00:39:30.095\nHSRP is built into darn near\nall Cisco equipment these days.\n\n775\n00:39:30.095 --> 00:39:32.575\nIt works on routers,\nit works on switches, great technology,\n\n776\n00:39:32.575 --> 00:39:37.517\nit's pretty flexible, and it's good stuff,\nunless you have third party equipment,\n\n777\n00:39:37.517 --> 00:39:38.797\nand then you're kinda out of luck.\n\n778\n00:39:38.797 --> 00:39:40.837\nSo, we'll talk about\nthat more in part two.\n\n779\n00:39:40.837 --> 00:39:42.937\n>> Hey, some of our best work\nis in part twos, right Don?\n\n780\n00:39:42.937 --> 00:39:44.607\nSo, I'm looking forward to that.\n\n781\n00:39:44.607 --> 00:39:46.857\nWe'll go ahead and thank you, Don,\nfor those great demonstrations.\n\n782\n00:39:46.857 --> 00:39:49.313\nThank you guys for watching,\nwe're gonna go ahead and call it a show.\n\n783\n00:39:49.313 --> 00:39:52.703\nSigning off for ITProTV,\nI've been your host Daniel Lowrie.\n\n784\n00:39:52.703 --> 00:39:53.439\n>> And I'm Don Pezet.\n\n785\n00:39:53.439 --> 00:39:54.979\n>> And we'll see you next time.\n\n786\n00:39:54.979 --> 00:40:00.002\n[MUSIC]\n\n",
          "vimeoId": "141782683"
        },
        {
          "description": "In this episode, Daniel and Don continue exploring redundancy protocols found on Cisco switches, this time covering the Virtual Router Redundancy Protocol or VRRP. Just like HSRP, VRRP allows you to set up standby switches to take over in the case of a failure with the main switch. Also, they go over the topic of load balancing using the Gateway Load Balancing Protocol(GLBP).",
          "length": "2658",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-1-first_hop_redundancy_pt2-100815-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-1-first_hop_redundancy_pt2-100815-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-1-first_hop_redundancy_pt2-100815-1-sm.jpg",
          "title": "First-Hop Redundancy Part 2",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.000\n[MUSIC]\n\n2\n00:00:11.641 --> 00:00:13.351\nAlright, greetings everyone.\n\n3\n00:00:13.351 --> 00:00:16.250\nWelcome to another great\nepisode of ITProTV.\n\n4\n00:00:16.250 --> 00:00:17.520\nI am your host Daniel Lowry,\n\n5\n00:00:17.520 --> 00:00:20.160\njoining me in the studio today is\nnone other than Mr. Don Pezet.\n\n6\n00:00:20.160 --> 00:00:22.080\nHow is it going today Don?\n\n7\n00:00:22.080 --> 00:00:24.110\n>> It is going great Daniel\nglad to be back on the show and\n\n8\n00:00:24.110 --> 00:00:27.630\nready to jump back into\nthe world of Cisco switching.\n\n9\n00:00:27.630 --> 00:00:31.360\nIn particular we're going to be taking\na look at first hop redundancy and\n\n10\n00:00:31.360 --> 00:00:33.680\nthis is part two to first hop redundancy.\n\n11\n00:00:33.680 --> 00:00:35.930\nSo if you haven't caught\nthe first episode check that out.\n\n12\n00:00:35.930 --> 00:00:39.050\nBecause what we've tackled there,\nwhich HSRP, right?\n\n13\n00:00:39.050 --> 00:00:43.020\nThe hot standby routing protocol,\nor redundancy protocol, and\n\n14\n00:00:43.020 --> 00:00:46.520\nit was a great chance to see how to take\na couple of Cisco switches or routers, for\n\n15\n00:00:46.520 --> 00:00:50.600\nthat matter, and effectively\ncluster them together, where one is\n\n16\n00:00:50.600 --> 00:00:54.820\nhandling the routing, and if it fails,\nanother one takes over and runs that role.\n\n17\n00:00:54.820 --> 00:00:59.740\nNow, you'll remember from an episode,\nhopefully you'll remember, That HSRP was\n\n18\n00:00:59.740 --> 00:01:06.020\nCisco proprietary, and it worked really\nwell, but it is Cisco proprietary.\n\n19\n00:01:06.020 --> 00:01:08.330\nSo that's kind of it's\nlimitation that it has.\n\n20\n00:01:08.330 --> 00:01:11.490\nThere's actually a few other limitations\nthat, if you've only worked with HSRP you\n\n21\n00:01:11.490 --> 00:01:15.620\nmight not notice, cuz HSRP does a really\ngood job of creating that redundancy.\n\n22\n00:01:15.620 --> 00:01:18.290\nIf one device fails,\nthe other takes over, it's really fast.\n\n23\n00:01:18.290 --> 00:01:20.250\nWorks great, right?\n\n24\n00:01:20.250 --> 00:01:23.240\nBut there are other options, and that's\nwhat we're gonna look at in this episode.\n\n25\n00:01:23.240 --> 00:01:27.980\nWe have two other redundancy options in\nCisco equipment that are available to us.\n\n26\n00:01:27.980 --> 00:01:33.770\nNow HSRP is supported on darn near all\nCisco equipment, routers, and switches.\n\n27\n00:01:33.770 --> 00:01:36.790\nFirewalls not so much,\nfirewalls do different stuff.\n\n28\n00:01:36.790 --> 00:01:39.330\nBut on the routing and switching\nside you have HSRP built into it,\n\n29\n00:01:39.330 --> 00:01:40.990\ninto almost all of the equipment.\n\n30\n00:01:40.990 --> 00:01:44.090\nSo you can jump in and configure it and\nget it up and going pretty easily.\n\n31\n00:01:44.090 --> 00:01:48.100\nBut if you have third party equipment,\nmaybe you've got some Cisco switches and\n\n32\n00:01:48.100 --> 00:01:52.690\nsome HP Pro curves, or you've got some\nCisco routers and some Juniper routers.\n\n33\n00:01:52.690 --> 00:01:54.800\nAnd you want to have\nredundancy between them,\n\n34\n00:01:54.800 --> 00:01:58.960\nthen it becomes a little more challenging,\nyou can't use HSRP anymore right?\n\n35\n00:01:58.960 --> 00:02:03.090\nSo instead we have VRRP right?\n\n36\n00:02:03.090 --> 00:02:07.350\nVRRP is\nthe Virtual Router Redundancy Protocol and\n\n37\n00:02:07.350 --> 00:02:12.970\nIt's an IEEE standard, it's basically\na standards alternative to HSRP.\n\n38\n00:02:12.970 --> 00:02:16.540\nAnd Cisco is involved in\nthe standardization of the VRRP.\n\n39\n00:02:16.540 --> 00:02:20.850\nSo it's not like Cisco really cares which\none you use, so it's kind of up to you,\n\n40\n00:02:20.850 --> 00:02:25.680\nand you'll see when we go and configure it\nthe VRRP and HSRP are almost identical.\n\n41\n00:02:25.680 --> 00:02:27.930\nSo in real life land.\n\n42\n00:02:27.930 --> 00:02:31.140\nIt doesn't really matter\nwhich one you use, right.\n\n43\n00:02:31.140 --> 00:02:33.820\nIt's kind of which one makes\nbest sense in your environment.\n\n44\n00:02:33.820 --> 00:02:38.170\nIf you're all Cisco, you might choose\nto go HSRP, just because you can, but\n\n45\n00:02:38.170 --> 00:02:40.290\nif you're mixing vendors or\neven if you are all Cisco,\n\n46\n00:02:40.290 --> 00:02:44.110\nyou might choose to go VRRP anyway,\njust because it is the standard.\n\n47\n00:02:44.110 --> 00:02:45.630\nAnd that's kinda how I am.\n\n48\n00:02:45.630 --> 00:02:50.130\nEven in the earlier days with trunking,\nwhere you could choose between ISL and\n\n49\n00:02:50.130 --> 00:02:51.740\n802.1q, I would always go 802.1q.\n\n50\n00:02:51.740 --> 00:02:54.790\nBecause, I knew if I had all\nCisco equipment I was fine,\n\n51\n00:02:54.790 --> 00:02:58.260\nbut if I wanted to bring third party\nstuff in later I could still use it.\n\n52\n00:02:58.260 --> 00:03:00.188\nThat's how I am with VRRP and HSRP.\n\n53\n00:03:00.188 --> 00:03:08.170\nBut, I said HSRP is supported on darn\nnear all Cisco equipment, VRRP isn't,\n\n54\n00:03:08.170 --> 00:03:11.240\nso you'll need to check your IOS to\nmake sure it's part of the feature set.\n\n55\n00:03:11.240 --> 00:03:15.270\nSome feature sets don't include VRVP,\nbut we're doing HSRP.\n\n56\n00:03:15.270 --> 00:03:17.800\nIt's getting to be a smaller and smaller\namount of devices that are like that.\n\n57\n00:03:17.800 --> 00:03:20.530\nBut be on the lookout for\nthat for your equipment.\n\n58\n00:03:20.530 --> 00:03:25.560\n>> So Don, when it comes to VRRP,\nit's basically an identical type of thing\n\n59\n00:03:25.560 --> 00:03:30.060\nas HSRP, which we love, it's a fantastic\nlittle item we have available for us.\n\n60\n00:03:30.060 --> 00:03:31.420\nBut if I'm remembering correctly,\n\n61\n00:03:31.420 --> 00:03:34.590\nI think there is some, is there\nterminology that's kind of different?\n\n62\n00:03:34.590 --> 00:03:35.490\n>> Yeah.\n>> When it comes\n\n63\n00:03:35.490 --> 00:03:36.760\nto configuring it and stuff.\n\n64\n00:03:36.760 --> 00:03:39.440\n>> They use some slightly different\nwords in the descriptions and\n\n65\n00:03:39.440 --> 00:03:41.030\nthere is some slightly different behavior.\n\n66\n00:03:41.030 --> 00:03:43.620\nSo let's touch on those\nkind of key points.\n\n67\n00:03:43.620 --> 00:03:49.370\nWith HSRP you have one active router,\none stand-by router,\n\n68\n00:03:49.370 --> 00:03:53.200\nand, everybody else is\njust called an other.\n\n69\n00:03:53.200 --> 00:03:54.420\nRight?\nThey're not active or standby,\n\n70\n00:03:54.420 --> 00:03:56.820\nthey're just kind of waiting in the folds,\nthere.\n\n71\n00:03:56.820 --> 00:04:00.190\nAnd, so, you really just have one router\nthat's up and going, one that's standby.\n\n72\n00:04:00.190 --> 00:04:01.788\nEverybody else is just kind of parked.\n\n73\n00:04:01.788 --> 00:04:03.086\nRight.\n\n74\n00:04:03.086 --> 00:04:07.770\nIn VRRP instead of the active router\nyou have what's called the master, so\n\n75\n00:04:07.770 --> 00:04:09.970\nyou have a master router, right?\n\n76\n00:04:09.970 --> 00:04:14.660\nAnd if the master router fails, then it\nflips over to what's called its backup.\n\n77\n00:04:14.660 --> 00:04:18.320\nSo instead of active and standby,\nyou have master and backup.\n\n78\n00:04:18.320 --> 00:04:20.240\nRight?\nSo that's the difference in terminology.\n\n79\n00:04:20.240 --> 00:04:22.640\nBut there's also differences in behavior.\n\n80\n00:04:22.640 --> 00:04:27.070\nSo, in HSRP, you have an active and a\nstandby, everybody else is parked, right?\n\n81\n00:04:27.070 --> 00:04:30.790\nThey're all kind of stuck in that speak\nphase, but they're not active or standby.\n\n82\n00:04:30.790 --> 00:04:35.910\nWell, in VRRP,\nall the other routers are backups.\n\n83\n00:04:35.910 --> 00:04:39.610\nYou have one master, and\neverybody else is a backup.\n\n84\n00:04:39.610 --> 00:04:43.770\nAnd any one of those backups could step up\nto become the master at a moment's notice,\n\n85\n00:04:43.770 --> 00:04:46.930\nif they have the right priority,\nif they beat the other people out, or\n\n86\n00:04:46.930 --> 00:04:48.990\nfirst come first serve,\nwhoever gets there, right?\n\n87\n00:04:48.990 --> 00:04:51.690\nThey're all eligible to become the master.\n\n88\n00:04:51.690 --> 00:04:56.170\nSo, you have one master and\nall the others are backups.\n\n89\n00:04:56.170 --> 00:04:58.630\nNow, in HSRP because you\njust had an active and\n\n90\n00:04:58.630 --> 00:05:02.530\na standby,\nwhen I ran the show standby command.\n\n91\n00:05:02.530 --> 00:05:05.970\nIf I was on the active router I saw\nthe IP address of the backup, and\n\n92\n00:05:05.970 --> 00:05:07.930\nif I was on the backup router, standby.\n\n93\n00:05:07.930 --> 00:05:12.170\nIf I was on the standby router\nI could do a show standby and\n\n94\n00:05:12.170 --> 00:05:13.240\nsee who the active router was.\n\n95\n00:05:13.240 --> 00:05:15.200\nI could see their IP.\n\n96\n00:05:15.200 --> 00:05:19.270\nIn VRRP the master actually\ndoesn't see the backups.\n\n97\n00:05:19.270 --> 00:05:20.470\nIt doesn't know they're there.\n\n98\n00:05:20.470 --> 00:05:22.470\nSo, when we go to configure this and\n\n99\n00:05:22.470 --> 00:05:26.510\nget the master set up, that switch is\ngoing to come up and be active, and\n\n100\n00:05:26.510 --> 00:05:31.670\nit'll be the one running the show and\nthen it will think it has no backups.\n\n101\n00:05:31.670 --> 00:05:35.970\nNow, you might ask yourself,\nwell wait a minute, why would I do that?\n\n102\n00:05:35.970 --> 00:05:38.420\nWhy would I want the master\nnot to know about the backups?\n\n103\n00:05:38.420 --> 00:05:40.190\nWell, think about what's\ngonna happen here.\n\n104\n00:05:40.190 --> 00:05:45.980\nThe master's doing the routing, and if the\nmaster fails, a backup needs to take over.\n\n105\n00:05:45.980 --> 00:05:50.660\nWell, if the master fails, does it matter\nif it knows there's a backup or not?\n\n106\n00:05:50.660 --> 00:05:51.230\nIt failed.\n\n107\n00:05:51.230 --> 00:05:53.150\nIt's not like it's gonna say,\noh I don't have a backup so\n\n108\n00:05:53.150 --> 00:05:55.050\nmaybe I won't fail right now.\n\n109\n00:05:55.050 --> 00:05:56.500\nI'll wait and fail later.\n\n110\n00:05:56.500 --> 00:05:57.970\n>> I was gonna fail, but\n\n111\n00:05:57.970 --> 00:06:01.100\nI've decided that's not a good\nidea at this point in time.\n\n112\n00:06:01.100 --> 00:06:02.510\n[LAUGH]\n>> So, knowing the backups there really\n\n113\n00:06:02.510 --> 00:06:04.130\ndoesn't make any difference, right?\n\n114\n00:06:04.130 --> 00:06:05.630\nSo, the master doesn't.\n\n115\n00:06:05.630 --> 00:06:07.910\nAnd that way we can have\nmore than one backup and\n\n116\n00:06:07.910 --> 00:06:09.446\nthe master doesn't have\nto keep track of it.\n\n117\n00:06:09.446 --> 00:06:13.210\nVersus the HSRP where the master\ndoes keep track of that back up.\n\n118\n00:06:13.210 --> 00:06:16.520\nNow, the back ups,\nthey are aware of the master.\n\n119\n00:06:16.520 --> 00:06:19.490\nThey know that that person is\nthere cuz they're watching and\n\n120\n00:06:19.490 --> 00:06:22.380\nkeeping an eye on it, saying I'm\ngonna wait for that guy to fail and\n\n121\n00:06:22.380 --> 00:06:23.940\nI'm gonna, I'm gonna jump in and\ntake over, right.\n\n122\n00:06:23.940 --> 00:06:26.530\nOr there's some other backups out there,\nso we're gonna get in a fight, but\n\n123\n00:06:26.530 --> 00:06:28.550\none of us is gonna win and\nthen we're gonna take that over.\n\n124\n00:06:28.550 --> 00:06:30.390\nSo that's a bit of a different behavior,\nand\n\n125\n00:06:30.390 --> 00:06:32.640\nthere's one other thing\nthat's really different.\n\n126\n00:06:32.640 --> 00:06:37.640\nRemember from the last episode when I\nconfigured HSRP, my switches, right, so\n\n127\n00:06:37.640 --> 00:06:43.130\nI had core one and core two,\nthey already had their own IPs.\n\n128\n00:06:44.600 --> 00:06:47.850\nCore one was 192.168.16.5,\nand core two 192.168.16.6.\n\n129\n00:06:47.850 --> 00:06:52.015\nWhen I created the virtual router,\nthe stand by, that virtual router for\n\n130\n00:06:52.015 --> 00:06:55.890\nHSRP, I gave it 192.168.16.20.\n\n131\n00:06:55.890 --> 00:07:01.640\nSo I created an all new IP to be the\nvirtual router that could bounce between\n\n132\n00:07:01.640 --> 00:07:05.550\nthe systems, and a virtual MAC address\nthat could balance between the systems.\n\n133\n00:07:06.850 --> 00:07:11.610\nRight?\nWith VRRP, you don't have to do that.\n\n134\n00:07:11.610 --> 00:07:13.470\nYou can use a virtual IP, if you want.\n\n135\n00:07:13.470 --> 00:07:14.730\nI normally do.\n\n136\n00:07:14.730 --> 00:07:19.950\nBut if you want, you could use the IP\naddress that's on the master, right?\n\n137\n00:07:19.950 --> 00:07:23.790\nAnd again, it goes back to,\nif the master fails.\n\n138\n00:07:23.790 --> 00:07:25.239\nWhat does it matter if it has that IP,\nright?\n\n139\n00:07:25.239 --> 00:07:27.100\n>> [LAUGH]\n>> It just failed and went offline.\n\n140\n00:07:27.100 --> 00:07:30.160\nSo it's offline,\nit doesn't need its IP anymore.\n\n141\n00:07:30.160 --> 00:07:31.250\nWe can take it.\n\n142\n00:07:31.250 --> 00:07:33.240\nIn fact, it doesn't even need\nits MAC address anymore.\n\n143\n00:07:33.240 --> 00:07:34.770\nWe can take that too.\n\n144\n00:07:34.770 --> 00:07:35.390\nRight?\n\n145\n00:07:35.390 --> 00:07:36.370\nAnd by doing that.\n\n146\n00:07:36.370 --> 00:07:39.810\n>> Just rummaging through his clothes\nas he's laying on the ground dead.\n\n147\n00:07:39.810 --> 00:07:42.525\n[LAUGH]\n>> It's like when somebody gets fired\n\n148\n00:07:42.525 --> 00:07:43.275\nat the office.\n\n149\n00:07:43.275 --> 00:07:47.455\nAnd you're, oh, that's a good stapler,\nand a tape machine.\n\n150\n00:07:47.455 --> 00:07:48.210\n>> Dibs, dibs.\n\n151\n00:07:48.210 --> 00:07:50.515\n[LAUGH]\n>> So that's exactly how VRRP is, right?\n\n152\n00:07:50.515 --> 00:07:51.580\nIt's like office space.\n\n153\n00:07:51.580 --> 00:07:54.940\nAnd so, people need to jump in and\ngrab that data.\n\n154\n00:07:54.940 --> 00:07:57.670\nBut it means your clients are still\nconnecting the same IP and\n\n155\n00:07:57.670 --> 00:07:58.810\nsame MAC address they always did.\n\n156\n00:07:58.810 --> 00:07:59.772\nRight?\nJust like with HSRP\n\n157\n00:07:59.772 --> 00:08:02.620\nwith the virtual stuff,\nbut here it's physical.\n\n158\n00:08:02.620 --> 00:08:03.952\nSo little bit different behavior now.\n\n159\n00:08:03.952 --> 00:08:05.640\nI don't normally take advantage of that.\n\n160\n00:08:05.640 --> 00:08:10.510\nI like having a virtual IP because\nit's just a little more clean for me.\n\n161\n00:08:10.510 --> 00:08:15.063\nBut you can use the physical ones,\nanother difference.\n\n162\n00:08:15.063 --> 00:08:18.590\nBut, let's just pretend for a moment that\nwe didn't know about those differences.\n\n163\n00:08:18.590 --> 00:08:23.820\nAnd I asked you to go in and configure\nVRRP on a router or on a switch, right?\n\n164\n00:08:24.940 --> 00:08:30.397\nIf you know how to configure HSRP, you\njust take every command that you used for\n\n165\n00:08:30.397 --> 00:08:34.871\nHSRP, and any time you use the word\nstandby, change it to VRRP.\n\n166\n00:08:34.871 --> 00:08:37.620\nSo, the configuration is\neffectively identical.\n\n167\n00:08:37.620 --> 00:08:40.220\nAll that stuff we saw in the last\nepisode about setting priorities,\n\n168\n00:08:40.220 --> 00:08:45.290\nabout doing track objects, all that\nfancy stuff, it's the same in VRRP.\n\n169\n00:08:45.290 --> 00:08:46.800\nSo, when you do the configuration,\n\n170\n00:08:46.800 --> 00:08:49.940\nit's really pretty straightforward\nto jump in and knock it out.\n\n171\n00:08:49.940 --> 00:08:50.870\nSo let me show you.\n\n172\n00:08:50.870 --> 00:08:53.800\nI've got my CORE1 switch fired up here.\n\n173\n00:08:53.800 --> 00:08:57.800\nAnd if I take a look at it, so\n\n174\n00:08:57.800 --> 00:09:02.963\nthis is the one that's 192.168.16, oh,\nI said .5 earlier, apparently it's .21.\n\n175\n00:09:02.963 --> 00:09:06.891\nSo it's 192.168.16.21, and\n\n176\n00:09:06.891 --> 00:09:12.893\nif I take a look at my CORE2 switch\nhere and let's see what it's got.\n\n177\n00:09:12.893 --> 00:09:16.697\nIt is 192.168.16.22.\n\n178\n00:09:16.697 --> 00:09:22.995\nSo I wanna turn on VRRP and I'm gonna\ngive it a virtual IP of, I'll do .20.\n\n179\n00:09:22.995 --> 00:09:26.150\nLet me just make sure that's not in use,\nI think I did that in the show yesterday.\n\n180\n00:09:26.150 --> 00:09:27.731\nPicked an IP that was\nalready used somewhere.\n\n181\n00:09:27.731 --> 00:09:28.650\n>> [LAUGH]\n>> All right, yeah.\n\n182\n00:09:28.650 --> 00:09:29.710\nSo, that one's not in use.\n\n183\n00:09:29.710 --> 00:09:31.760\nSo I'm gonna get VRRP up and\nrunning on these.\n\n184\n00:09:31.760 --> 00:09:36.620\nAnd I'll have it set for\n.20 as that virtual IP.\n\n185\n00:09:36.620 --> 00:09:39.850\nSo I'm gonna start over here on CORE1,\nand I'm gonna get it setup, right?\n\n186\n00:09:39.850 --> 00:09:43.020\nSo I'm gonna jump into my configuration,\nand I'm doing this for\n\n187\n00:09:43.020 --> 00:09:44.130\nthe VLAN1 interface.\n\n188\n00:09:44.130 --> 00:09:47.790\nRemember, just like HSRP, you can\nhave more than one VRRP group and so\n\n189\n00:09:47.790 --> 00:09:51.100\nyou can create redundancy across\nmultiple interfaces if you want.\n\n190\n00:09:51.100 --> 00:09:54.160\nHaving those virtual interfaces set up,\ntheir virtual IPs set up, and\n\n191\n00:09:54.160 --> 00:09:56.685\nnow have redundancy between\nall your different VLANs.\n\n192\n00:09:56.685 --> 00:09:59.445\nBut I'll just do VLAN1 for right now.\n\n193\n00:09:59.445 --> 00:10:05.185\nNow, in HSRP I would come in and\nI would say standby one ip blah blah blah.\n\n194\n00:10:05.185 --> 00:10:08.345\nSo here, I just drop the word standby and\nswap it out for VRRP.\n\n195\n00:10:08.345 --> 00:10:11.830\nI say vrrp and\nthen I specify the rest of that command.\n\n196\n00:10:11.830 --> 00:10:14.210\nNow, if you're not sure\nyour device supports VRRP,\n\n197\n00:10:14.210 --> 00:10:15.860\njust do a quick question mark.\n\n198\n00:10:15.860 --> 00:10:18.970\nCuz if you don't get a response there,\nthen you don't support VRRP, right?\n\n199\n00:10:18.970 --> 00:10:20.610\nSo, that's the easy way to tell.\n\n200\n00:10:20.610 --> 00:10:23.800\nSo, I'll just create VRRP group 1.\n\n201\n00:10:23.800 --> 00:10:29.480\nAnd then I'll just say IP 192.168.16.20,\nall right?\n\n202\n00:10:29.480 --> 00:10:33.540\nNow, if I wanted to use the master's\nIP address, if you look at this,\n\n203\n00:10:33.540 --> 00:10:36.480\nit just wants an IP address, right?\n\n204\n00:10:36.480 --> 00:10:39.700\nAnd you could actually type\nthe IP address of the master, so\n\n205\n00:10:39.700 --> 00:10:40.620\nmine is .21 and I could use that.\n\n206\n00:10:40.620 --> 00:10:42.144\nAll right?\n\n207\n00:10:42.144 --> 00:10:45.572\nBut since I'm not actually going to take\nthis device down, I will go ahead and\n\n208\n00:10:45.572 --> 00:10:47.069\nuse a different one, all right?\n\n209\n00:10:47.069 --> 00:10:51.857\nNow, with HSRP, I made the comment\nthat once I issued that first command,\n\n210\n00:10:51.857 --> 00:10:53.461\ntechnically I was done.\n\n211\n00:10:53.461 --> 00:10:55.490\nWith VRRP I am also.\n\n212\n00:10:55.490 --> 00:10:58.940\nSo with that one command I'm\nactually up and running VRRP.\n\n213\n00:10:58.940 --> 00:11:02.090\nAnd you can see that I switched\nfrom the init state to backup and\n\n214\n00:11:02.090 --> 00:11:03.420\nthen I went from backup to master.\n\n215\n00:11:03.420 --> 00:11:05.740\nSo I just became the master\nof this VRRP group.\n\n216\n00:11:05.740 --> 00:11:06.750\nAnd I'm up and running.\n\n217\n00:11:06.750 --> 00:11:09.870\nAnd it happened a lot faster than HSRP.\n\n218\n00:11:09.870 --> 00:11:13.174\nNow, you'll hear a lot of\npeople out there say, oh,\n\n219\n00:11:13.174 --> 00:11:15.603\nI always do VRRP because it's faster.\n\n220\n00:11:15.603 --> 00:11:16.650\nIt fails over faster.\n\n221\n00:11:16.650 --> 00:11:17.270\nI love VRRP.\n\n222\n00:11:18.560 --> 00:11:22.540\nWell, technically they're right,\nthat VRRP is faster.\n\n223\n00:11:22.540 --> 00:11:28.090\nBut it's because VRRP has a much\nshorter hello interval and dead timer.\n\n224\n00:11:28.090 --> 00:11:31.430\nSo that the timers on VRRP\nare just set shorter by default.\n\n225\n00:11:31.430 --> 00:11:33.800\nOn HSRP they're set a little bit longer.\n\n226\n00:11:33.800 --> 00:11:37.440\nWhat Cisco's trying to do is cover you for\n\n227\n00:11:37.440 --> 00:11:42.140\nfastest fail over without false fail\novers due to flapping networks.\n\n228\n00:11:42.140 --> 00:11:44.530\nSo that's why they have their\ntimers just the way they are.\n\n229\n00:11:44.530 --> 00:11:50.052\nAnd you can adjust the HSRP timers\nto set them the same as VRRP and\n\n230\n00:11:50.052 --> 00:11:51.730\nthen they're the same speed.\n\n231\n00:11:51.730 --> 00:11:55.720\nSo by default, yes, VRRP is faster,\nbut you can equal them out,\n\n232\n00:11:55.720 --> 00:12:00.710\nand then they run at the same speed,\nif you're concerned about that.\n\n233\n00:12:00.710 --> 00:12:03.260\n>> Is VRRP faster even\nwithout the timer stuff?\n\n234\n00:12:03.260 --> 00:12:06.650\nIt sounds there's a lot less\noverhead with VRRP than with HSRP.\n\n235\n00:12:06.650 --> 00:12:09.320\n>> You know, it sounds like there is,\nbut there really isn't.\n\n236\n00:12:09.320 --> 00:12:11.390\nSo if you were to set\nthe timers to the same,\n\n237\n00:12:11.390 --> 00:12:15.990\nlike if you were to lower HSRP's timer to\nmatch VRRP's, they'd be the same speed.\n\n238\n00:12:15.990 --> 00:12:19.180\nYeah, there's not really\nany difference there.\n\n239\n00:12:19.180 --> 00:12:21.450\nYeah, they both use multi-pass\ncommunications to talk to each other.\n\n240\n00:12:21.450 --> 00:12:24.090\nThey both protect the same way,\nthey really work the same way.\n\n241\n00:12:24.090 --> 00:12:27.160\nThere's a very little difference\nbetween them aside from terminology and\n\n242\n00:12:27.160 --> 00:12:27.880\nbasic function.\n\n243\n00:12:27.880 --> 00:12:29.050\n>> Okay.\n\n244\n00:12:29.050 --> 00:12:30.500\n>> All right, so here I am.\n\n245\n00:12:30.500 --> 00:12:33.290\nI'm master, right, very exciting.\n\n246\n00:12:33.290 --> 00:12:35.130\nI could continue on and\n\n247\n00:12:35.130 --> 00:12:39.560\nconfigure a lot of the other things\nthat we saw in our last episode, right?\n\n248\n00:12:39.560 --> 00:12:41.390\nSo I could start to set up event tracking.\n\n249\n00:12:41.390 --> 00:12:42.680\nHere's where you adjust the timers.\n\n250\n00:12:42.680 --> 00:12:43.770\nI could set my priorities.\n\n251\n00:12:43.770 --> 00:12:45.455\nTurn on preemption, right?\n\n252\n00:12:45.455 --> 00:12:48.285\nAll the same things as HSRP, and I'm not\ngonna bore you to death with those and\n\n253\n00:12:48.285 --> 00:12:49.655\nwe still have another protocol to get to.\n\n254\n00:12:49.655 --> 00:12:53.515\nSo I'll just leave it at that for\nright now, okay?\n\n255\n00:12:53.515 --> 00:13:00.572\nAnd, if I get out of config here and\ndo a show VRRP, right, show vrrp.\n\n256\n00:13:00.572 --> 00:13:03.802\nI can take a look at that status,\nand I can see I'm in Group 1.\n\n257\n00:13:03.802 --> 00:13:05.332\nMy current state is Master.\n\n258\n00:13:05.332 --> 00:13:08.542\nMy IP address,\nmy virtual IP address, is this guy.\n\n259\n00:13:08.542 --> 00:13:11.132\nAnd it did generate a virtual MAC address.\n\n260\n00:13:11.132 --> 00:13:14.272\nAnd just like HSRP,\nit's using a fake address, and\n\n261\n00:13:14.272 --> 00:13:16.522\nmy group number's right there at the end.\n\n262\n00:13:16.522 --> 00:13:21.430\nSo, again, very similar to what\nwe saw in the last episode.\n\n263\n00:13:21.430 --> 00:13:25.100\nNotice though, preemption enabled, right.\n\n264\n00:13:25.100 --> 00:13:27.040\nPreemption is turned on by default.\n\n265\n00:13:27.040 --> 00:13:28.852\nIn VRRP, it's turned off by default.\n\n266\n00:13:28.852 --> 00:13:31.870\nIn HSRP, and again,\nyou can configure one to match the other.\n\n267\n00:13:31.870 --> 00:13:33.890\nIf you want,\nyou can turn off preemption here.\n\n268\n00:13:33.890 --> 00:13:36.910\nBut otherwise, it's just on by default.\n\n269\n00:13:36.910 --> 00:13:38.200\nBut if you look at these intervals here.\n\n270\n00:13:38.200 --> 00:13:41.550\nI've got like this Master Advertisement\ninterval as one second and\n\n271\n00:13:41.550 --> 00:13:44.310\nmy Master Down interval is 3.6 seconds,\nright?\n\n272\n00:13:44.310 --> 00:13:47.070\nAnd those are lower than\nthe timers we had in HSRP,\n\n273\n00:13:47.070 --> 00:13:49.010\nwhich is partly what makes this faster.\n\n274\n00:13:50.160 --> 00:13:55.610\nAll right, so, there's another command\nthat kind of useful, show vrrp brief.\n\n275\n00:13:55.610 --> 00:13:57.170\nAnd if you run that,\nit gives you a summary.\n\n276\n00:13:57.170 --> 00:14:00.050\nNow, I've only got one\nVRRP group right now.\n\n277\n00:14:00.050 --> 00:14:04.928\nAnd so, when I jump in here and look at\nit, it's not a big deal to run show vrrp.\n\n278\n00:14:04.928 --> 00:14:08.571\nBut if you've got 50 VLANs, and\nyou're running VRRP across all 50,\n\n279\n00:14:08.571 --> 00:14:10.530\nthat output gets a little cumbersome.\n\n280\n00:14:10.530 --> 00:14:13.371\nAnd so, show vrrp brief gives\nyou a real quick summary.\n\n281\n00:14:13.371 --> 00:14:16.519\nAnd so you can look in there real quick\nand you can see the interface, VLAN1,\n\n282\n00:14:16.519 --> 00:14:19.540\nthe group number, priorities, times,\nwhether you're master or not.\n\n283\n00:14:19.540 --> 00:14:25.280\nYou can see all of that laid out right\nhere in a nice, easy-to-view format.\n\n284\n00:14:25.280 --> 00:14:28.180\nAll right, I'm gonna jump over to CORE2,\nand on CORE2,\n\n285\n00:14:28.180 --> 00:14:31.200\nI'm just gonna basically repeat\nthat same process, right?\n\n286\n00:14:31.200 --> 00:14:36.760\nSo I'll get into the vlan 1 interface,\nI'll say vrrp 1 ip and\n\n287\n00:14:36.760 --> 00:14:39.880\nI'll specify that same virtual IP,\nall right.\n\n288\n00:14:39.880 --> 00:14:42.040\nIf I was using the IP of the master,\n\n289\n00:14:42.040 --> 00:14:44.650\nI'd be putting the IP of\nthe master here instead.\n\n290\n00:14:44.650 --> 00:14:47.570\nAnd it doesn't matter that that IP's\nalready in use cuz we're not going\n\n291\n00:14:47.570 --> 00:14:48.190\nto take it over yet.\n\n292\n00:14:48.190 --> 00:14:50.770\nWe're just the backup, or we will be\njust the back up here in just a moment.\n\n293\n00:14:51.920 --> 00:14:55.230\nSo when I run that, now this switch\nis trying to become the back up and\n\n294\n00:14:55.230 --> 00:14:58.310\nyou'll see, again, it happens really fast,\nthat we transition and\n\n295\n00:14:58.310 --> 00:15:02.330\nbecome the backup, And, ooh,\nthat's a problem right there, isn't it?\n\n296\n00:15:02.330 --> 00:15:06.900\nSo, I transition to be the backup and then\nI transition to be the master, all right.\n\n297\n00:15:06.900 --> 00:15:11.360\nThat's not a good sign right there, so\nwhy did I transition to be the master?\n\n298\n00:15:11.360 --> 00:15:14.900\nWell, that means that one\nof two things is happening.\n\n299\n00:15:14.900 --> 00:15:17.890\nOne, I might not be able\nto see the other switch.\n\n300\n00:15:17.890 --> 00:15:19.810\nIf I have a network connectivity issue,\n\n301\n00:15:19.810 --> 00:15:23.470\nthen I can't see the other switch,\nI'm gonna become the master, right.\n\n302\n00:15:23.470 --> 00:15:28.060\nSo if I test that out, right, I'll test\nthat connectivity to the other guy.\n\n303\n00:15:28.060 --> 00:15:32.930\nWhich his IP was 21, and\nnope, I'm pinging across.\n\n304\n00:15:32.930 --> 00:15:37.310\nSo I do see the other guy, so that's not\nmy problem, what's the other problem?\n\n305\n00:15:37.310 --> 00:15:41.030\nThe other problem is not\nnecessarily a problem.\n\n306\n00:15:41.030 --> 00:15:45.996\nIn VRRP, I mentioned preemption\nwas turned on by default, and\n\n307\n00:15:45.996 --> 00:15:49.545\npriority is set to a default also.\n\n308\n00:15:49.545 --> 00:15:51.985\nDefault of 100, just like HSRP.\n\n309\n00:15:51.985 --> 00:16:00.182\nSo, when my switch, my CORE2 came up,\nwe had a tie on priority.\n\n310\n00:16:00.182 --> 00:16:01.732\nSo it had to go to a tie breaker.\n\n311\n00:16:01.732 --> 00:16:05.692\nAnd when it does a tie breaker it uses\nthe physical MAC address on your switch.\n\n312\n00:16:05.692 --> 00:16:08.720\nAnd the physical MAC\naddress of this switch.\n\n313\n00:16:08.720 --> 00:16:11.220\nMust be lower than the physical\nMAC address of the other switch.\n\n314\n00:16:11.220 --> 00:16:16.950\nSo in this scenario I beat it out,\nand so this guy became the master.\n\n315\n00:16:16.950 --> 00:16:18.920\nNow, do I really care?\n\n316\n00:16:18.920 --> 00:16:21.640\nI might not care which one\nof these guys is the master.\n\n317\n00:16:21.640 --> 00:16:25.890\nBut I might have that other switch,\nmaybe it's a higher end switch,\n\n318\n00:16:25.890 --> 00:16:27.100\ncuz they don't have to match.\n\n319\n00:16:27.100 --> 00:16:30.370\nMaybe it's got some better warranty\nservice on it or something, so\n\n320\n00:16:30.370 --> 00:16:31.640\nI want that one to be the master.\n\n321\n00:16:31.640 --> 00:16:33.040\nSo I can always jump and fix the priority.\n\n322\n00:16:33.040 --> 00:16:37.201\nIf I jump back to CORE1, I can see,\nI guess I could have told if they saw each\n\n323\n00:16:37.201 --> 00:16:41.299\nother just right here by looking at\nwhether it flipped this one to backup,\n\n324\n00:16:41.299 --> 00:16:42.112\nwhich it did.\n\n325\n00:16:42.112 --> 00:16:45.648\nBut I can get into vlan 1.\n\n326\n00:16:45.648 --> 00:16:49.930\nAnd I can just say vrrp 1 priority.\n\n327\n00:16:49.930 --> 00:16:54.773\n[LAUGH]\n>> [LAUGH] It's one of those funny words.\n\n328\n00:16:54.773 --> 00:16:56.595\n>> Thank you public school.\n\n329\n00:16:56.595 --> 00:17:00.005\nAll right, so priority 1's in, so\nnow I've bumped up my priority, and\n\n330\n00:17:00.005 --> 00:17:02.645\nthanks to preemption, I'm gonna take over.\n\n331\n00:17:02.645 --> 00:17:07.860\nAnd so now I'm the master again,\nCORE1 is the master for this vrrp group.\n\n332\n00:17:07.860 --> 00:17:11.270\nIf it fails,\nthe other guy will take over, right?\n\n333\n00:17:11.270 --> 00:17:17.320\nBut if I do a show vrrp and take a look at\nit here, I can see that I'm the master.\n\n334\n00:17:17.320 --> 00:17:17.970\nAnd if you look,\n\n335\n00:17:17.970 --> 00:17:21.850\nnotice how there's nothing in here that\ntells me who the backup is, right?\n\n336\n00:17:21.850 --> 00:17:25.660\nThe primary,\nthe master doesn't see the backups.\n\n337\n00:17:25.660 --> 00:17:29.280\nBut if I jump over to core two which\nis now the backup again, right?\n\n338\n00:17:29.280 --> 00:17:32.070\nSo I can I can see it\ntransition to backup.\n\n339\n00:17:32.070 --> 00:17:35.980\nIf I do a show vrp on it, I can see that\n\n340\n00:17:35.980 --> 00:17:40.880\nit is in the state of backup, and\nit is well aware of who the master is.\n\n341\n00:17:40.880 --> 00:17:41.700\nIt shows it right there.\n\n342\n00:17:41.700 --> 00:17:44.220\nAnd that the master has a priority of 110,\nall right.\n\n343\n00:17:44.220 --> 00:17:46.390\nSo it's up and running and\nthings are working fine.\n\n344\n00:17:46.390 --> 00:17:49.259\nIf I was to take CORE1 and\n\n345\n00:17:49.259 --> 00:17:55.580\nshut off its vlan 1 interface,\nright, which would take it down,\n\n346\n00:17:55.580 --> 00:17:59.050\nthen the other switch will automatically\nflip to become the master.\n\n347\n00:17:59.050 --> 00:18:01.120\nAnd so if I look over here,\nit's already done it,\n\n348\n00:18:01.120 --> 00:18:03.000\nbefore I could even switch consoles.\n\n349\n00:18:03.000 --> 00:18:07.034\nIt's now the master, and it's up and\nrunning for 192.168.16.20.\n\n350\n00:18:07.034 --> 00:18:08.460\nWe're now redundant.\n\n351\n00:18:08.460 --> 00:18:11.550\n>> Thank you VRRP,\nit's a nice thing to have,\n\n352\n00:18:11.550 --> 00:18:13.660\nespecially in those mixed environments.\n\n353\n00:18:13.660 --> 00:18:17.400\nYou got some Cisco equipment, maybe you've\ngot some HP or Dell switches as well.\n\n354\n00:18:17.400 --> 00:18:22.850\nAnd you use VRRP so, because of the whole\nproprietariness of the HSRP protocol.\n\n355\n00:18:22.850 --> 00:18:25.690\nEven though it's just as great,\napparently, it'd be nice Don,\n\n356\n00:18:25.690 --> 00:18:28.150\nif one day they just talked together and\n\n357\n00:18:28.150 --> 00:18:34.830\nworked in unison where you could have\nVRRP and HSRP doing a little tango.\n\n358\n00:18:34.830 --> 00:18:36.880\n>> Yeah, so fortunately we don't\nhave to worry about that, Daniel,\n\n359\n00:18:36.880 --> 00:18:39.460\nbecause most of our equipment\ndoes support VRRP now.\n\n360\n00:18:39.460 --> 00:18:41.440\nSo you can just run with that and\nyou're on the safe side of it.\n\n361\n00:18:41.440 --> 00:18:43.270\nAnd that is what I normally do.\n\n362\n00:18:43.270 --> 00:18:47.450\nNow, we've talked about HSRP,\nwe've talked about VRRP.\n\n363\n00:18:47.450 --> 00:18:50.370\nThere is one more that we need\nto be aware of for the exam and\n\n364\n00:18:50.370 --> 00:18:53.490\nit's the least frequently used, but\nit's probably the most powerful.\n\n365\n00:18:53.490 --> 00:18:55.370\nAnd it's called GLBP.\n\n366\n00:18:56.950 --> 00:19:01.855\nGLBP is the gateway load\nbalancing protocol.\n\n367\n00:19:01.855 --> 00:19:04.665\n>> [LAUGH]\n>> The LP gets you every time.\n\n368\n00:19:04.665 --> 00:19:06.510\n[LAUGH]\n>> I've done it right in every other one.\n\n369\n00:19:06.510 --> 00:19:10.010\nSo, the gateway load balancing protocol,\nGLBP.\n\n370\n00:19:10.010 --> 00:19:13.340\nAnd, it's a little bit different\nthan the other guys, all right?\n\n371\n00:19:13.340 --> 00:19:17.530\nFirst off, GLBP is gonna take us back\ninto the world of Cisco proprietary.\n\n372\n00:19:17.530 --> 00:19:20.000\nHSRP and GLBP are both Cisco only.\n\n373\n00:19:20.000 --> 00:19:21.470\nVRRP is the one that's a standard.\n\n374\n00:19:22.540 --> 00:19:27.690\nBut what GOBP does that's different,\nremember with HSRP and\n\n375\n00:19:27.690 --> 00:19:31.550\nVRRP you have an active or\na master, right?\n\n376\n00:19:31.550 --> 00:19:32.820\nAnd that's the gateway.\n\n377\n00:19:32.820 --> 00:19:35.600\nThat's the router that's doing the work,\nor switch that's doing the work.\n\n378\n00:19:36.880 --> 00:19:42.264\nAnd everybody else that's in that group\nis a standby or a backup, or an other.\n\n379\n00:19:42.264 --> 00:19:44.970\nSomebody who's just kind\nof sitting there waiting.\n\n380\n00:19:44.970 --> 00:19:46.740\nNot actually doing anything.\n\n381\n00:19:46.740 --> 00:19:51.187\nAnd so, the frustrating part for\na lot of CIOs that are out there is,\n\n382\n00:19:51.187 --> 00:19:55.635\nthey're talking to their network admin and\nthey're like, okay,\n\n383\n00:19:55.635 --> 00:19:59.553\nwe just bought a 6512,\nand it cost us $75,000.\n\n384\n00:19:59.553 --> 00:20:06.415\nAnd we got a second 6512 sitting right\nnext to it and it cost us $75,000.\n\n385\n00:20:06.415 --> 00:20:09.265\nAnd, you're telling me that,\n\n386\n00:20:09.265 --> 00:20:12.127\nthat second one is just sitting\nthere doing nothing all day?\n\n387\n00:20:12.127 --> 00:20:14.767\nAnd then, as the network engineer,\nyou have to look at them in the eye and\n\n388\n00:20:14.767 --> 00:20:16.422\nsay, yes.\n\n389\n00:20:16.422 --> 00:20:17.907\n>> [LAUGH]\n>> It is sitting there doing nothing\n\n390\n00:20:17.907 --> 00:20:20.187\nall day, but when we have a failure,\n\n391\n00:20:20.187 --> 00:20:23.087\nyou will appreciate that money\nsitting there doing nothing.\n\n392\n00:20:23.087 --> 00:20:25.087\nIt's a hard sell.\n\n393\n00:20:25.087 --> 00:20:28.947\nAnd there's a lot of CIOs out there\nthat don't necessarily buy into that and\n\n394\n00:20:28.947 --> 00:20:31.890\nthey say, well,\nremember that old switch we replaced,\n\n395\n00:20:31.890 --> 00:20:35.070\nwhat if we put that old switch over\nthere and use that as our redundancy?\n\n396\n00:20:35.070 --> 00:20:39.020\nI've been there, so you want to try and\navoid that if you can.\n\n397\n00:20:39.020 --> 00:20:45.500\nSo GLBP says, all right, let's just not\nhave one active, let's load balance.\n\n398\n00:20:45.500 --> 00:20:49.977\nLet's get multiple switches, or\nmultiple routers up on a gateway IP,\n\n399\n00:20:49.977 --> 00:20:54.390\non that first hop IP, and\nhave them load balance the traffic.\n\n400\n00:20:54.390 --> 00:20:57.070\nAnd that way you're actually\nusing your equipment.\n\n401\n00:20:57.070 --> 00:21:01.460\nAnd if one fails, the other one\njust takes over the whole load.\n\n402\n00:21:01.460 --> 00:21:04.900\nSo let's say you had two systems,\nyou'd split the data 50-50, right?\n\n403\n00:21:04.900 --> 00:21:08.460\nAnd if one failed, the other would\njust step up to 100%, right?\n\n404\n00:21:08.460 --> 00:21:10.810\nBut the cool thing with GLBP is\nyou can expand it even more.\n\n405\n00:21:10.810 --> 00:21:13.800\nI can have five, six,\nseven switches, seven routers.\n\n406\n00:21:13.800 --> 00:21:16.590\nAnd load balancing across all of them.\n\n407\n00:21:16.590 --> 00:21:18.780\nAnd as one failed, or\nI did maintenance on one,\n\n408\n00:21:18.780 --> 00:21:20.390\npeople would just shift\nover to the others.\n\n409\n00:21:20.390 --> 00:21:22.310\nAnd that's it, GLBP's really cool.\n\n410\n00:21:22.310 --> 00:21:25.970\nBut it takes a lot of\nprocessor power to do this,\n\n411\n00:21:25.970 --> 00:21:28.220\ncuz it's having to track\nall of these sessions.\n\n412\n00:21:28.220 --> 00:21:32.130\nAnd that doesn't happen with HSRP and\nVRRP, they create next to no load on\n\n413\n00:21:32.130 --> 00:21:34.640\nthe system because they're just\nhandling one address and MAC address.\n\n414\n00:21:34.640 --> 00:21:36.600\nThey do that all the time, right.\n\n415\n00:21:36.600 --> 00:21:40.150\nBut with GLBP they've gotta actually look\nat the data stream inside of it, and\n\n416\n00:21:40.150 --> 00:21:44.630\nas a result,\nM=most Cisco switches do not support GLBP.\n\n417\n00:21:45.690 --> 00:21:51.580\nSo for example, here in my lab,\nI've got a 3560 and two 3750s.\n\n418\n00:21:51.580 --> 00:21:55.810\nAnd on my 3750s, which are really\n\n419\n00:21:55.810 --> 00:22:00.140\nthe upper tier of switches before\nyou get to the chassis based ones.\n\n420\n00:22:00.140 --> 00:22:02.440\nThe 3750s don't support GLBP.\n\n421\n00:22:02.440 --> 00:22:07.430\nIt's kinda confusing if you get into a\ninterface and you do a GLBP question mark.\n\n422\n00:22:07.430 --> 00:22:09.920\nSee how it looks like it's\ngonna reconfigure it?\n\n423\n00:22:09.920 --> 00:22:13.155\nAnd so if I come in here and say,\n\n424\n00:22:13.155 --> 00:22:17.649\nglbp 1 IP 192.168.16.20.\n\n425\n00:22:17.649 --> 00:22:22.530\nSo if I wanna go in and fill this one in,\nGLBP is not supported by the switch stack.\n\n426\n00:22:22.530 --> 00:22:23.950\nIt tricked me.\n\n427\n00:22:23.950 --> 00:22:25.640\nIt made it look like I had that feature.\n\n428\n00:22:25.640 --> 00:22:27.240\nI was so excited and then it's not there.\n\n429\n00:22:28.530 --> 00:22:33.126\nSo if you're on a chassis based switch,\nI'm talking about 4000 series and higher,\n\n430\n00:22:33.126 --> 00:22:38.300\nand you've got a supervisor module\n\n431\n00:22:38.300 --> 00:22:42.310\nin there that is the full routing enabled\nsupervisor module, you can do GLBP.\n\n432\n00:22:42.310 --> 00:22:46.790\nAnd the reason I mention that supervisor\nmodule, the 4000 series switches,\n\n433\n00:22:46.790 --> 00:22:49.590\nyou can get the supervisor module\nin them that's just layer two, and\n\n434\n00:22:49.590 --> 00:22:52.330\nthen it doesn't do GLBP so\nyou still have to check.\n\n435\n00:22:52.330 --> 00:22:58.040\nAnd the 6500s, most of them do GLBP\nout of the box, nothing special there.\n\n436\n00:22:58.040 --> 00:23:01.650\nA lot of Cisco routers do\nsupport GLBP out of the box,\n\n437\n00:23:01.650 --> 00:23:04.290\neven some of the lower end ones,\nbecause they're already routing.\n\n438\n00:23:04.290 --> 00:23:06.100\nThey're already used to looking\nat those data streams, so\n\n439\n00:23:06.100 --> 00:23:07.710\nit's not like it needs extra hardware.\n\n440\n00:23:07.710 --> 00:23:13.070\nBut a switch needs extra hardware,\nand that's why your 2900s,\n\n441\n00:23:13.070 --> 00:23:17.090\nyour 3500s, your 3750s, those switches,\nthey just don't support GLBP.\n\n442\n00:23:18.280 --> 00:23:20.480\nSo that's why this one is the least used.\n\n443\n00:23:20.480 --> 00:23:21.970\nIt's the most powerful, but\n\n444\n00:23:21.970 --> 00:23:25.650\nit's the least used because you gotta\nhave the hardware to handle it.\n\n445\n00:23:25.650 --> 00:23:27.500\nNow, the way GLBP works,\n\n446\n00:23:27.500 --> 00:23:31.590\nthe configuration's actually\nremarkably similar to HSRP VRRP, right?\n\n447\n00:23:31.590 --> 00:23:34.160\nAll three of these configure\nbasically the same way.\n\n448\n00:23:34.160 --> 00:23:41.120\nThe difference is you do have\na master in the GLBP cluster.\n\n449\n00:23:41.120 --> 00:23:44.560\nWhat they do, they call it an AVG.\n\n450\n00:23:44.560 --> 00:23:48.760\nSo the active virtual gateway, right?\n\n451\n00:23:48.760 --> 00:23:51.540\nSo the AVG,\nthat's the person who's in charge.\n\n452\n00:23:51.540 --> 00:23:54.024\nSo the first switch you configure, or\n\n453\n00:23:54.024 --> 00:23:58.920\nwhoever you set the highest priority to,\nthey're gonna become that AVG.\n\n454\n00:23:58.920 --> 00:24:01.914\nAnd then after that, every other switch or\n\n455\n00:24:01.914 --> 00:24:05.580\nevery other router that you\njoin to this GOBP group.\n\n456\n00:24:05.580 --> 00:24:09.680\nBecomes what's called an AVF\nan active virtual forwarder.\n\n457\n00:24:09.680 --> 00:24:11.580\nNotice they're both called active.\n\n458\n00:24:11.580 --> 00:24:14.270\nActive virtual gateway,\nactive virtual forwarder.\n\n459\n00:24:14.270 --> 00:24:16.820\nEverybody is routing traffic.\n\n460\n00:24:16.820 --> 00:24:22.410\nThe only difference is the AVG is the one\nwho's determining how we load balance.\n\n461\n00:24:22.410 --> 00:24:26.100\nHow we distribute the traffic\nacross the switches.\n\n462\n00:24:26.100 --> 00:24:28.640\nBut the forwarders,\nthey're all forwarding traffic.\n\n463\n00:24:28.640 --> 00:24:30.500\nThey're all moving it along, right?\n\n464\n00:24:30.500 --> 00:24:35.810\nAnd if the AVG fails, one of the other\nAVFs just takes over, right?\n\n465\n00:24:35.810 --> 00:24:38.880\nAnd traffic continues flowing like normal,\nit's just taking over.\n\n466\n00:24:38.880 --> 00:24:42.120\nSo all right, I'll handle this,\nhere's how we're gonna load balance.\n\n467\n00:24:42.120 --> 00:24:44.610\nAnd when I say how we're gonna load\nbalance what I'm talking about is,\n\n468\n00:24:44.610 --> 00:24:47.900\nwhen you load balance\nyour traffic in GLBP.\n\n469\n00:24:47.900 --> 00:24:52.070\nYou can pick how you wanna do it, there's\na few different modes that it supports.\n\n470\n00:24:52.070 --> 00:24:55.270\nAnd the default mode is\nkind of like some of\n\n471\n00:24:55.270 --> 00:24:58.290\nthe load balancing we've seen in\nother episodes like in EtherChannel.\n\n472\n00:24:58.290 --> 00:25:01.580\nWhere it load balances based on that\nMAC address, the source MAC address,\n\n473\n00:25:01.580 --> 00:25:03.540\nthe traffic, it distributes that way.\n\n474\n00:25:03.540 --> 00:25:07.170\nBut you can switch to other modes and\nhave it work differently.\n\n475\n00:25:07.170 --> 00:25:09.170\nIt's up to you how you wanna do that.\n\n476\n00:25:09.170 --> 00:25:11.680\nA few different ways to go about that.\n\n477\n00:25:11.680 --> 00:25:14.150\nThat's why we have to have that one AVG.\n\n478\n00:25:14.150 --> 00:25:16.950\nIf it wasn't for that,\nyou really wouldn't need a master.\n\n479\n00:25:16.950 --> 00:25:18.320\nThey could all just be forwarding.\n\n480\n00:25:18.320 --> 00:25:21.360\nAnd if somebody drops, there's extra\ntraffic that doesn't have a destination.\n\n481\n00:25:21.360 --> 00:25:22.810\nAnd they grab it and they move on.\n\n482\n00:25:22.810 --> 00:25:25.200\nRight.\nSo pretty neat the way that works,\n\n483\n00:25:25.200 --> 00:25:28.370\neverybody's up and running,\nand everybody's working.\n\n484\n00:25:28.370 --> 00:25:31.870\nOkay.\nNow the way these guys work\n\n485\n00:25:31.870 --> 00:25:34.800\nis they listen for all traffic.\n\n486\n00:25:34.800 --> 00:25:40.170\nSo we have a virtual IP, and our host\nare all pointing to this virtual IP and\n\n487\n00:25:40.170 --> 00:25:42.830\nthe AVG and all the AVFs,\nthey all listen for that traffic.\n\n488\n00:25:42.830 --> 00:25:48.360\nOkay, but based on the load balancing,\nwhen a client sends out an ARP request,\n\n489\n00:25:48.360 --> 00:25:52.420\nright, so the first time my laptop goes\nto hit that IP request, all right.\n\n490\n00:25:52.420 --> 00:25:53.580\nI send out an ARP request.\n\n491\n00:25:53.580 --> 00:25:55.960\nAnd I say, all right,\nmy default gateway is 192.160.0.1.\n\n492\n00:25:55.960 --> 00:26:01.120\nCan somebody tell me what the MAC\naddress of that system is?\n\n493\n00:26:01.120 --> 00:26:05.460\nAnd the router with 192.168.0.1, here's\nthat arp request, and it replies back and\n\n494\n00:26:05.460 --> 00:26:07.610\nsays, hey, that's me,\nhere's my Mac address.\n\n495\n00:26:07.610 --> 00:26:12.130\nWell, with GLBP all the forwarders,\nthe ABG and\n\n496\n00:26:12.130 --> 00:26:16.560\nthe ABFs, they all listen and\nthey all hear that ARP request.\n\n497\n00:26:16.560 --> 00:26:21.400\nAnd then based on load balancing,\none of them responds back and says hey,\n\n498\n00:26:21.400 --> 00:26:24.340\nthat's me, here's my MAC address.\n\n499\n00:26:24.340 --> 00:26:31.000\nSo unlike HSRP and VRRP where they all\nshare a virtual MAC address, GLBP doesn't.\n\n500\n00:26:31.000 --> 00:26:37.280\nEach forwarder the ABG and the ABFs,\nthey have all have their own MAC address.\n\n501\n00:26:37.280 --> 00:26:39.960\nAnd that way the clients are using\nthat MAC address to get to\n\n502\n00:26:39.960 --> 00:26:43.380\nan individual node inside\nof the GLBP cluster.\n\n503\n00:26:43.380 --> 00:26:46.080\nSo it's a shared layer three IP.\n\n504\n00:26:47.240 --> 00:26:50.590\nAnd a unique layer two MAC.\n\n505\n00:26:50.590 --> 00:26:53.710\n>> All right Don, so\nwe've got active forwarding.\n\n506\n00:26:53.710 --> 00:26:55.630\nEverybody's forwarding,\neverybody's doing something.\n\n507\n00:26:55.630 --> 00:26:58.340\nThey're trying to load balance,\nobviously it's the whole point here.\n\n508\n00:26:58.340 --> 00:27:00.550\nBut there's only one IP address.\n\n509\n00:27:00.550 --> 00:27:04.950\nHow do the devices know which\ndevice to actually forward through?\n\n510\n00:27:04.950 --> 00:27:09.720\nYeah, great question, because with\nHSRP and VRRP, it's really simple.\n\n511\n00:27:09.720 --> 00:27:12.930\nThere's a MAC address and\nan IP address, right?\n\n512\n00:27:12.930 --> 00:27:17.330\nLayer two and layer three,\nthat actually move from router to router,\n\n513\n00:27:17.330 --> 00:27:21.075\nswitch to switch, so\nthe clients move along with it, right?\n\n514\n00:27:21.075 --> 00:27:24.635\nThey've already got it in their ARC cache\nthat says where they're gonna go, right?\n\n515\n00:27:24.635 --> 00:27:28.085\nYou know, for a laptop,\nthe first time I plug into a network and\n\n516\n00:27:28.085 --> 00:27:29.525\nI go to contact my default gateway.\n\n517\n00:27:29.525 --> 00:27:32.150\nI wanna get to the Internet or\nsome other network.\n\n518\n00:27:32.150 --> 00:27:35.410\nI know my default gateway is\nlet's say it's 192.168.0.1.\n\n519\n00:27:35.410 --> 00:27:37.200\nI know that's my default gateway.\n\n520\n00:27:38.240 --> 00:27:40.490\nI type that in, or\nI get it from a DHCP server.\n\n521\n00:27:40.490 --> 00:27:43.090\nBut the first time I talk to it,\nI have to send out an ARP broadcast.\n\n522\n00:27:43.090 --> 00:27:44.430\nAnd I send out that ARP broadcast and\n\n523\n00:27:44.430 --> 00:27:48.380\nI say, hey, what's the MAC address for\n192.168.0.1?\n\n524\n00:27:48.380 --> 00:27:50.980\nAnd that gateway receives it and\nresponds back.\n\n525\n00:27:50.980 --> 00:27:54.380\nAnd in HSRP or VRRP, it's just\nwhoever's controlling it right then.\n\n526\n00:27:54.380 --> 00:27:58.730\nThey respond back and I add their\nfake cluster IP to my ARP cache and\n\n527\n00:27:58.730 --> 00:28:00.080\nnow I can talk to the gateway.\n\n528\n00:28:00.080 --> 00:28:00.930\nRight?\n\n529\n00:28:00.930 --> 00:28:04.460\nIf a failure happens, the IP and\nthe MAC move to the other system.\n\n530\n00:28:04.460 --> 00:28:06.990\nSo my ARP cache stays current and\nI keep communicating.\n\n531\n00:28:06.990 --> 00:28:08.510\nRight?\nVery simple.\n\n532\n00:28:08.510 --> 00:28:10.520\nWith GLBP it's different.\n\n533\n00:28:10.520 --> 00:28:14.650\nWith GOBP, you have a shared IP address.\n\n534\n00:28:14.650 --> 00:28:19.580\nOne IP that's shared across\nall your AVFs and the AVG.\n\n535\n00:28:19.580 --> 00:28:22.640\nBut each one maintains\nits own MAC address.\n\n536\n00:28:22.640 --> 00:28:23.790\nThey each have a unique MAC address.\n\n537\n00:28:24.920 --> 00:28:30.090\nAnd that way when I send out my ARP\nbroadcast, everybody that the AVG and\n\n538\n00:28:30.090 --> 00:28:32.890\nall the AVF's are listening for\nthat broadcast.\n\n539\n00:28:32.890 --> 00:28:35.530\nThey hear it, right,\nthey hear that come in.\n\n540\n00:28:35.530 --> 00:28:39.270\nAnd then, based on load balancing right,\nwhatever system it is they're using for\n\n541\n00:28:39.270 --> 00:28:45.300\nload balancing, they see it come in and\none of them will answer the arp request.\n\n542\n00:28:45.300 --> 00:28:45.960\nRight.\n\n543\n00:28:45.960 --> 00:28:49.990\nNot all of them, and they're not\nanswering with a shared MAC address,\n\n544\n00:28:49.990 --> 00:28:53.350\nthey're answering with just\ntheir unique MAC address.\n\n545\n00:28:53.350 --> 00:28:56.730\nAnd they send that back to the client,\nso the client sees it and\n\n546\n00:28:56.730 --> 00:29:00.850\nthey say,\noh the gateway IP is 192.168.0.1.\n\n547\n00:29:00.850 --> 00:29:04.620\nBut I got this MAC address and I'm gonna\nstart talking to that from my gateway and\n\n548\n00:29:04.620 --> 00:29:07.890\nthat's one node in that GLBP cluster.\n\n549\n00:29:07.890 --> 00:29:12.270\nSo, it may be the AVG, it might be one\nof the AVFs, it'd be any one of them.\n\n550\n00:29:12.270 --> 00:29:15.910\nAnd if one of them fails and\nwe can't get to it.\n\n551\n00:29:15.910 --> 00:29:18.970\nWell, the ARP cache age is out,\nwe send out a new ARP request and\n\n552\n00:29:18.970 --> 00:29:22.970\nwe get another one that answers us,\nand we switch to that one, right?\n\n553\n00:29:22.970 --> 00:29:26.640\nAnd there's a little of a system\nwhere the AVG can take over to, so\n\n554\n00:29:26.640 --> 00:29:28.540\nit actually happens very, very fast.\n\n555\n00:29:28.540 --> 00:29:30.410\nAnd then you're able to communicate,\nand then you move through.\n\n556\n00:29:30.410 --> 00:29:34.640\nBut that's how you're being steered to\none particular node inside of there.\n\n557\n00:29:34.640 --> 00:29:36.660\nYou have a shared IP, and\n\n558\n00:29:36.660 --> 00:29:41.850\nthen a unique MAC address on each of\nthe forwarders that's involved in this.\n\n559\n00:29:41.850 --> 00:29:42.470\nAll right.\n\n560\n00:29:42.470 --> 00:29:46.080\nNow, that's the biggest difference\nbetween GLBP and the other protocols,\n\n561\n00:29:46.080 --> 00:29:47.420\nis that everybody's active.\n\n562\n00:29:47.420 --> 00:29:51.310\nSo, if you wanna take advantage of that\nduplicate set of hardware you got,\n\n563\n00:29:51.310 --> 00:29:52.840\nGLBP will let you do it.\n\n564\n00:29:52.840 --> 00:29:54.260\nBut it's really gotta\nbe the expensive stuff.\n\n565\n00:29:54.260 --> 00:29:56.100\nRight.\nThe cheap hardware isn't gonna do it.\n\n566\n00:29:56.100 --> 00:29:58.130\nOn routers this works really well too,\nthough.\n\n567\n00:29:58.130 --> 00:30:00.560\nIf you've got even 2900 supported,\n\n568\n00:30:00.560 --> 00:30:05.290\nyou don't even have to have like 7200's or\nthe really expensive ones.\n\n569\n00:30:05.290 --> 00:30:07.460\nThe 2900's will do.\n\n570\n00:30:07.460 --> 00:30:08.710\nThe 2800's will do it.\n\n571\n00:30:08.710 --> 00:30:11.810\nI don't think any of the 1700 or\n1800's here, I don't think they'll do it.\n\n572\n00:30:11.810 --> 00:30:15.080\nBut, but the midgrade ones and\nhigher will.\n\n573\n00:30:15.080 --> 00:30:17.970\nAnd always double check your feature\nset to make sure it's in there.\n\n574\n00:30:17.970 --> 00:30:20.030\nThe configuration's pretty\nstraightforward though.\n\n575\n00:30:20.030 --> 00:30:24.764\nThere are a few extra little commands\nI'll show you, but let's say that I wann\n\n576\n00:30:24.764 --> 00:30:28.840\ntake this guy here, NYEDGE1, all right.\n\n577\n00:30:28.840 --> 00:30:33.280\nAnd I wanna make it my gateway.\n\n578\n00:30:33.280 --> 00:30:37.950\nI wanna make it my AVG, or\nwhatever, to be running GLPP and\n\n579\n00:30:37.950 --> 00:30:40.170\nsharing that IP and giving my redundancy.\n\n580\n00:30:40.170 --> 00:30:40.940\nAll right.\n\n581\n00:30:40.940 --> 00:30:47.620\nWell, on this system, if I take\na look at one of its interfaces here,\n\n582\n00:30:47.620 --> 00:30:55.100\nI can see that it's got 192.168.16.2 and\nI've got NYEDGE2, this other guy here.\n\n583\n00:30:55.100 --> 00:31:00.450\nAnd I can do a quick\ncheck on its interface.\n\n584\n00:31:00.450 --> 00:31:02.210\nAnd it's 192.168.16.3.\n\n585\n00:31:02.210 --> 00:31:06.033\nI wanna make these guys\nshare 192.168.16.1.\n\n586\n00:31:06.033 --> 00:31:09.630\nThat's what they're gonna share and\nunlike in the last episode,\n\n587\n00:31:09.630 --> 00:31:12.930\nI'm just gonna ping that and\nmake sure it is actually available for me.\n\n588\n00:31:12.930 --> 00:31:14.260\nAnd it's good.\n\n589\n00:31:14.260 --> 00:31:16.010\nAll right.\nSo I'm going to configure GLBP, so\n\n590\n00:31:16.010 --> 00:31:17.280\none of these guys'll be an AVG,\n\n591\n00:31:17.280 --> 00:31:20.910\none of these guys'll be an AVF and\nthey'll start to share that IP.\n\n592\n00:31:20.910 --> 00:31:22.230\nAll right?\n\n593\n00:31:22.230 --> 00:31:25.290\nNow if I jump over to EDGE1,\nthis is where I'll start.\n\n594\n00:31:25.290 --> 00:31:26.590\nThis guy.\n\n595\n00:31:26.590 --> 00:31:28.200\nI'm gonna get into that interface, and\n\n596\n00:31:28.200 --> 00:31:31.131\nI'm using routed interfaces here\ninstead of a VLAN on this one.\n\n597\n00:31:31.131 --> 00:31:34.360\nThis would be the same on the router\nas it would be on the switch.\n\n598\n00:31:34.360 --> 00:31:36.110\nOn the switch it could\nbe routed interface or\n\n599\n00:31:36.110 --> 00:31:38.490\na virtual interface like VLAN 1 VLAN 2 or\nwhatever.\n\n600\n00:31:38.490 --> 00:31:40.670\nSo, here I'm doing on this one.\n\n601\n00:31:40.670 --> 00:31:45.390\nI'm just going to jump into that\ninterface and I'm going to run glbp One,\n\n602\n00:31:46.730 --> 00:31:49.160\nIP and then the IP that i want to share.\n\n603\n00:31:49.160 --> 00:31:50.930\nRight this command should look familiar.\n\n604\n00:31:50.930 --> 00:31:54.990\nWe're taking HSRP and just anywhere we\nuse the word standby swapping it out for\n\n605\n00:31:54.990 --> 00:31:59.340\nGLBP, or swap it out for VLRP,\nit's all kind of the same.\n\n606\n00:31:59.340 --> 00:32:03.900\nAnd Iw ill just punch in that IP,\nand if I stop right here, I'm done.\n\n607\n00:32:03.900 --> 00:32:05.950\nI configured GLBP, right?\n\n608\n00:32:05.950 --> 00:32:09.461\nBut, there's all the other little bells\nand whistles that we can configure, right?\n\n609\n00:32:09.461 --> 00:32:11.981\nSo if you do GLBP One and a question mark,\n\n610\n00:32:11.981 --> 00:32:16.570\nyou'll see some of the other\nthings that we can configure.\n\n611\n00:32:16.570 --> 00:32:20.880\nOne thing about GLBP, is it's not\nnecessarily the fastest in the world, but\n\n612\n00:32:20.880 --> 00:32:24.980\nagain, it's got timers that we can adjust,\nbut you typically don't want to.\n\n613\n00:32:24.980 --> 00:32:26.040\nAnd here's the thing.\n\n614\n00:32:26.040 --> 00:32:30.090\nI said earlier, you could take HSRP and\ntune it down to the same timers as VRRP,\n\n615\n00:32:30.090 --> 00:32:31.770\nand they're both the same as far as speed.\n\n616\n00:32:32.810 --> 00:32:37.370\nBut they don't have to manipulate\nARP cache like GLBP does.\n\n617\n00:32:37.370 --> 00:32:41.460\nSo, on GLBP,\nyou could lower its timers to match, but\n\n618\n00:32:41.460 --> 00:32:44.770\nbecause there's ARP caches involved\non your switches, on your routers,\n\n619\n00:32:44.770 --> 00:32:48.537\non your clients, you generally don't\nwanna mess with the timers too much.\n\n620\n00:32:48.537 --> 00:32:50.445\nRight?\nCisco's got them set pretty well to be\n\n621\n00:32:50.445 --> 00:32:53.245\nable to handle the communications\nthat we need, right?\n\n622\n00:32:53.245 --> 00:32:56.709\nSo, I won't mess with those,\nbut some of the other options\n\n623\n00:32:56.709 --> 00:33:00.770\nthat we have in here are things\nlike adjusting the load-balancing.\n\n624\n00:33:00.770 --> 00:33:02.780\nI mean, we've got the stuff\nwe expect to see, right?\n\n625\n00:33:02.780 --> 00:33:05.500\nLike priority, so we can get that set.\n\n626\n00:33:05.500 --> 00:33:08.550\nBut load balancing is\none that's kind of new.\n\n627\n00:33:08.550 --> 00:33:09.910\nRight?\nBecause we don't load balance with\n\n628\n00:33:09.910 --> 00:33:10.680\nthe other protocols.\n\n629\n00:33:10.680 --> 00:33:12.470\nOne device handles it all.\n\n630\n00:33:12.470 --> 00:33:17.380\nSo, if I were to come in here and\nsay GLBP 1 load-balancing, and\n\n631\n00:33:17.380 --> 00:33:20.565\nthen do a question mark, you'll see\nthe different modes your system supports.\n\n632\n00:33:20.565 --> 00:33:22.650\nRight?\nAnd there's three modes.\n\n633\n00:33:22.650 --> 00:33:24.105\nThe first one is host dependent.\n\n634\n00:33:24.105 --> 00:33:26.110\nRight?\nAnd it just says,\n\n635\n00:33:26.110 --> 00:33:30.905\nload balance equally stores MAC address,\ndetermines which forwarder you choose.\n\n636\n00:33:30.905 --> 00:33:32.210\nRight?\nSo, basically,\n\n637\n00:33:32.210 --> 00:33:36.409\nit's gonna take your MAC addresses,\nas people send out the ARP broadcast,\n\n638\n00:33:36.409 --> 00:33:40.610\nit's just gonna distribute that\nevenly across all of your equipment.\n\n639\n00:33:40.610 --> 00:33:43.640\nSo, if I have two 6500s,\nhalf my traffic should go to one, and\n\n640\n00:33:43.640 --> 00:33:44.990\nhalf my traffic should go to the other.\n\n641\n00:33:44.990 --> 00:33:47.030\nBut it's doing it based\non source MAC address.\n\n642\n00:33:47.030 --> 00:33:51.270\nSo, if I have two laptops connect,\none might hit the first switch,\n\n643\n00:33:51.270 --> 00:33:52.360\nthe other might hit the second switch,\n\n644\n00:33:52.360 --> 00:33:55.460\nand one laptop might talk\na lot more than the other.\n\n645\n00:33:55.460 --> 00:33:57.500\nSo, when we talk about\ndistributing it evenly,\n\n646\n00:33:57.500 --> 00:34:00.490\nwe're talking about evenly in\nterms of the number of clients.\n\n647\n00:34:00.490 --> 00:34:02.920\nNot necessarily in terms\nof true bandwidth.\n\n648\n00:34:02.920 --> 00:34:04.770\nRight?\nSo, you don't get that kind of\n\n649\n00:34:04.770 --> 00:34:06.240\ntrue level of load balancing with that.\n\n650\n00:34:07.470 --> 00:34:09.161\nYou also have round robin.\n\n651\n00:34:09.161 --> 00:34:10.820\nRound robin says,\n\n652\n00:34:10.820 --> 00:34:14.150\ndon't worry about the source MAC address,\nwe're just gonna go one at a time.\n\n653\n00:34:14.150 --> 00:34:17.910\nSo, let's say I have one AVG and\nthree AVFs.\n\n654\n00:34:17.910 --> 00:34:21.830\nThe first client that comes along,\nthe AVG will respond.\n\n655\n00:34:21.830 --> 00:34:24.360\nThe second client will\ngo to the first AVF.\n\n656\n00:34:24.360 --> 00:34:26.250\nThe third client will\ngo to the second AVF.\n\n657\n00:34:26.250 --> 00:34:27.920\nThe fourth client will\ngo to the third AVF.\n\n658\n00:34:27.920 --> 00:34:31.380\nAnd, then it starts over again with AVG,\nand it just kind of rotates through,\n\n659\n00:34:31.380 --> 00:34:34.820\none at a time, and they just take turns,\nanswering those ARP requests.\n\n660\n00:34:34.820 --> 00:34:36.930\nAnd, then people connect, and\nthey move through that system.\n\n661\n00:34:36.930 --> 00:34:39.300\nAll right so that's round robin,\n\n662\n00:34:39.300 --> 00:34:44.430\nbut you can do GLBP between\nequipment that's not identical.\n\n663\n00:34:44.430 --> 00:34:48.870\nAnd if the equipment is not identical,\nthen what you'll bump into is\n\n664\n00:34:48.870 --> 00:34:52.370\none switch might be capable of\nhanding more bandwidth than the other.\n\n665\n00:34:52.370 --> 00:34:55.826\nAnd so, you can do load\nbalancing that is weighted, and\n\n666\n00:34:55.826 --> 00:34:58.840\nyou can assign a weight to each router.\n\n667\n00:34:58.840 --> 00:35:01.620\nAnd I can say that one router\nhas a weight of 80, and\n\n668\n00:35:01.620 --> 00:35:05.560\nanother router has a weight of 20,\nand it'll load balance based on that.\n\n669\n00:35:05.560 --> 00:35:09.190\nSo, I can send 80% of the clients\nto one side, and 20% to the other.\n\n670\n00:35:09.190 --> 00:35:11.350\nSo, there's a few different\nways to manipulate it, but for\n\n671\n00:35:11.350 --> 00:35:16.090\nmost of us, the host dependent, that is\nusually the most effective way to go.\n\n672\n00:35:16.090 --> 00:35:18.420\nIt balances people out, because typically,\n\n673\n00:35:18.420 --> 00:35:20.450\nwe're going to be\nbalancing equal equipment.\n\n674\n00:35:20.450 --> 00:35:22.550\nYou buy two 6500s, and\nyou wanna balance between them.\n\n675\n00:35:22.550 --> 00:35:25.420\nAll right, so\nI'm not gonna adjust that one.\n\n676\n00:35:25.420 --> 00:35:27.054\nIt's fine that way that it is.\n\n677\n00:35:27.054 --> 00:35:31.349\nSome of the other things we can do,\nif we want to adjust that weighting,\n\n678\n00:35:31.349 --> 00:35:36.074\nwhat you do is you say GLBP 1 weighing,\nand then you can specify your weighting\n\n679\n00:35:36.074 --> 00:35:41.010\ninformation, and notice that you can\nspecify your tracking here also.\n\n680\n00:35:41.010 --> 00:35:41.860\nAll right?\n\n681\n00:35:41.860 --> 00:35:43.780\nThe weighting is kinda like your priority.\n\n682\n00:35:43.780 --> 00:35:44.700\nNow, we have priority.\n\n683\n00:35:44.700 --> 00:35:47.620\nIf I'm not using weighting,\nI can just go in and set the priority,\n\n684\n00:35:47.620 --> 00:35:50.250\nand whoever's got the highest\npriority becomes the AVG.\n\n685\n00:35:50.250 --> 00:35:51.200\nEverybody else is an AVF.\n\n686\n00:35:51.200 --> 00:35:52.900\nAll right?\n\n687\n00:35:52.900 --> 00:35:57.340\nBut remember, we manipulated\npriority to make one HSRP or one\n\n688\n00:35:57.340 --> 00:36:01.640\nVRRP gateway less desirable than the other\nand cause fail over and all that stuff?\n\n689\n00:36:01.640 --> 00:36:05.790\nWell, in GLBP, you can use priority\nto influence who's the AVG, but\n\n690\n00:36:05.790 --> 00:36:09.915\nyou can't use the priority\nto cause a fail over.\n\n691\n00:36:09.915 --> 00:36:10.930\nRght?\n\n692\n00:36:10.930 --> 00:36:14.410\nWhat you need to use is, well, I mean\nyou can if that's all you're using, but\n\n693\n00:36:14.410 --> 00:36:18.480\nif you're using weighting, priority\nisn't gonna have that effect anymore.\n\n694\n00:36:18.480 --> 00:36:19.540\nWeighting will.\n\n695\n00:36:19.540 --> 00:36:21.510\nAnd so, you've gotta come in and\nconfigure your weighting, and\n\n696\n00:36:21.510 --> 00:36:22.410\nset what that value is.\n\n697\n00:36:22.410 --> 00:36:24.480\nAnd then you can set your track here.\n\n698\n00:36:24.480 --> 00:36:28.420\nAnd you can reduce\nthe weight of that router\n\n699\n00:36:28.420 --> 00:36:30.190\nbased on whether certain\nthings have failed.\n\n700\n00:36:30.190 --> 00:36:32.640\nIf there's an interface that failed,\nor a route that's gone, or whatever,\n\n701\n00:36:32.640 --> 00:36:36.000\nI can reduce my weight and\nsend the traffic to the other systems.\n\n702\n00:36:36.000 --> 00:36:36.510\nRight?\n\n703\n00:36:36.510 --> 00:36:39.360\nWhen you define weighting,\nit starts with a maximum value, so\n\n704\n00:36:39.360 --> 00:36:41.472\nI can set my maximum at one hundred.\n\n705\n00:36:41.472 --> 00:36:42.640\nAll right?\n\n706\n00:36:42.640 --> 00:36:48.120\nAnd then, you specify a lower and an upper\nthreshold that defines when you're active,\n\n707\n00:36:48.120 --> 00:36:51.830\nand so I can say,\nif my weighting ever drops below 90,\n\n708\n00:36:51.830 --> 00:36:54.983\nI shouldn't be active anymore.\n\n709\n00:36:54.983 --> 00:36:56.750\nI should be out of the pool.\n\n710\n00:36:56.750 --> 00:36:57.590\nAll right.\n\n711\n00:36:57.590 --> 00:37:04.800\nAnd then, I can say, if my weighting ever\nhits 95, then I can come active again.\n\n712\n00:37:04.800 --> 00:37:07.090\nOr you know,\nI might even set it to the full 100, like,\n\n713\n00:37:07.090 --> 00:37:10.585\nyou gotta get back to 100\nto go fully active again.\n\n714\n00:37:10.585 --> 00:37:12.090\nRight?\nSo, we can influence that right\n\n715\n00:37:12.090 --> 00:37:15.680\nhere with the weighting, and\nthen if you couple that with a track,\n\n716\n00:37:15.680 --> 00:37:19.030\nactually it's gonna get a little upset,\nbecause I didn't put my keywords in here.\n\n717\n00:37:19.030 --> 00:37:23.815\nSo, I need to say lower 90 and\nthen upper 100.\n\n718\n00:37:23.815 --> 00:37:25.055\nThere we go.\n\n719\n00:37:25.055 --> 00:37:30.135\nAnd then, I can couple that with a track,\nand say for\n\n720\n00:37:30.135 --> 00:37:33.685\nthe track to decrement me by 10,\nor decrement me by 15,\n\n721\n00:37:33.685 --> 00:37:37.580\nand if I had a failure, it can take away\n15 from my weight and I drop down to 85.\n\n722\n00:37:37.580 --> 00:37:39.080\nAnd now, I'm out of the pool.\n\n723\n00:37:39.080 --> 00:37:41.206\nRight?\nSo, we can manipulate all that, and\n\n724\n00:37:41.206 --> 00:37:44.170\nthen it balances the traffic,\nbased on the weight also,\n\n725\n00:37:44.170 --> 00:37:46.596\nif you put yourself into\nload balancing mode.\n\n726\n00:37:46.596 --> 00:37:47.420\nAll right?\n\n727\n00:37:47.420 --> 00:37:49.310\nNow by default,\nwe're doing host dependent, and\n\n728\n00:37:49.310 --> 00:37:50.910\nthe weight doesn't really matter there.\n\n729\n00:37:50.910 --> 00:37:53.090\nThe priority does, and\nso, I can come in here and\n\n730\n00:37:53.090 --> 00:37:58.280\nsay GLBP 1 priority 110, and\nnow I've got a higher priority.\n\n731\n00:37:59.480 --> 00:38:01.080\nNow, remember preemption?\n\n732\n00:38:01.080 --> 00:38:03.820\nHow we had to turn that on for\none router to take over on the other?\n\n733\n00:38:03.820 --> 00:38:06.160\nWe don't have preemption with GLBP,\nbecause everybody is active.\n\n734\n00:38:06.160 --> 00:38:07.420\nThere's nothing to preempt.\n\n735\n00:38:07.420 --> 00:38:10.630\nThe only thing you can preempt is who\nis the AVG, and at the end of the day,\n\n736\n00:38:10.630 --> 00:38:14.060\nwe don't really care who the AVG is\ncuz they're all forwarding traffic,\n\n737\n00:38:14.060 --> 00:38:18.000\nso it doesn't necessarily matter\nto me which one is responsible for\n\n738\n00:38:18.000 --> 00:38:21.300\ncontrolling the cluster,\nbecause they're all working together.\n\n739\n00:38:21.300 --> 00:38:21.830\nRight?\nBut\n\n740\n00:38:21.830 --> 00:38:23.740\nwe can set that priority to\ninfluence who that AVG is.\n\n741\n00:38:23.740 --> 00:38:25.280\nAll right?\n\n742\n00:38:25.280 --> 00:38:27.270\nSo, this guy is up and running.\n\n743\n00:38:27.270 --> 00:38:32.700\nIf I take a look at that config,\nand just do a show GLBP,\n\n744\n00:38:32.700 --> 00:38:37.140\nyou'll see that we've got similar commands\nto the other ones, show GLBP, and\n\n745\n00:38:37.140 --> 00:38:41.200\nshow GLBP brief, and we can look at that\nconfig, and I can see that I'm up and\n\n746\n00:38:41.200 --> 00:38:42.970\ngoing, my state is active.\n\n747\n00:38:42.970 --> 00:38:45.430\nAnd as you look down the list,\nyou'll see the various things.\n\n748\n00:38:45.430 --> 00:38:49.420\nNotice that I've got that pre-emption\ndisabled, but that doesn't mean that I\n\n749\n00:38:49.420 --> 00:38:52.260\ncan't have another router come up,\nbecause they're all active.\n\n750\n00:38:52.260 --> 00:38:53.484\nIt's talking about just for the AVG.\n\n751\n00:38:53.484 --> 00:38:55.950\nRight?\nSo the rest of it all\n\n752\n00:38:55.950 --> 00:38:57.410\nhere is pretty straight forward.\n\n753\n00:38:57.410 --> 00:39:01.280\nMy standby is unknown,\nbecause there is no standby AVG.\n\n754\n00:39:01.280 --> 00:39:03.520\nWell, I haven't configured\nanybody to take over.\n\n755\n00:39:03.520 --> 00:39:06.020\nSo, these terms are really\nreferring to the AVG.\n\n756\n00:39:06.020 --> 00:39:10.372\nBut as far as forwarding, right, we're\nforwarding just like anybody else that's\n\n757\n00:39:10.372 --> 00:39:12.360\nconnected, and so when you look at this,\n\n758\n00:39:12.360 --> 00:39:16.740\nwhat we're seeing up here,\nmostly has to do with the AVG, right?\n\n759\n00:39:16.740 --> 00:39:17.850\nAnd the group.\n\n760\n00:39:17.850 --> 00:39:22.630\nAnd then right down here, there's one\nforwarder, Forwarder 1, and that's me.\n\n761\n00:39:22.630 --> 00:39:25.300\nI'm the AVG, and I'm a forwarder.\n\n762\n00:39:25.300 --> 00:39:26.840\nI can see I've got a Mac address.\n\n763\n00:39:26.840 --> 00:39:29.250\nI've got an owner ID for\n\n764\n00:39:29.250 --> 00:39:33.840\nwho's controlling that virtual Mac\naddress, and then we're up and going.\n\n765\n00:39:33.840 --> 00:39:34.380\nRight?\n\n766\n00:39:34.380 --> 00:39:40.820\nAnd if I jump over to edge two, I can take\nthis guy and repeat that same process.\n\n767\n00:39:41.990 --> 00:39:49.227\nSo, I'll just come in here and\nsay GLBP 1 and IP 192.168.16.1.\n\n768\n00:39:49.227 --> 00:39:50.410\nAll right?\n\n769\n00:39:50.410 --> 00:39:51.620\nAnd, I'll leave his priority at 100.\n\n770\n00:39:51.620 --> 00:39:54.980\nThe other guy's got a higher priority,\nso he'll stay the AVG.\n\n771\n00:39:54.980 --> 00:39:59.320\nBut this one will come up, and\nit will become an active forwarder.\n\n772\n00:39:59.320 --> 00:40:02.006\nRight?\nAn AVF, and we should see that here,\n\n773\n00:40:02.006 --> 00:40:02.700\nshortly.\n\n774\n00:40:02.700 --> 00:40:07.080\nNow, if I get impatient, and I don't see\nthe communication, again, we might have to\n\n775\n00:40:07.080 --> 00:40:10.980\nmake sure we've got connectivity between\nthe two systems, and there we go.\n\n776\n00:40:10.980 --> 00:40:13.514\nI see that I do.\nIt just kind of transitioned And\n\n777\n00:40:13.514 --> 00:40:18.990\nI can see that interface transition\nfrom state Listen to Active.\n\n778\n00:40:18.990 --> 00:40:23.850\nAnd now it's forwarding and if I do a show\nglbp, I can jump in here and look at it.\n\n779\n00:40:23.850 --> 00:40:27.190\nAnd I can see information about that avg,\nand I can see myself.\n\n780\n00:40:27.190 --> 00:40:30.560\nAnd so here's the two nodes that\nare involved in this environment.\n\n781\n00:40:30.560 --> 00:40:33.810\nAnd then down here,\nI can see the MAC address that I'm using.\n\n782\n00:40:33.810 --> 00:40:36.940\nAnd see how it says that I\nlearned that MAC address, right?\n\n783\n00:40:36.940 --> 00:40:38.300\nI learned it from the other one.\n\n784\n00:40:38.300 --> 00:40:40.870\nThis is the MAC address for the group.\n\n785\n00:40:40.870 --> 00:40:46.230\nBut I'm gonna respond to clients\nwith this address, my owner address.\n\n786\n00:40:46.230 --> 00:40:47.230\nThat's that unique address.\n\n787\n00:40:47.230 --> 00:40:49.750\nThat's why we've got two MAC\naddresses that are inside here that\n\n788\n00:40:49.750 --> 00:40:50.710\nare tied to that.\n\n789\n00:40:50.710 --> 00:40:54.520\nAnd so now, we're configured,\nwe're up, and we're in business.\n\n790\n00:40:54.520 --> 00:40:57.080\nAnd so now we're running GLBP,\nit's that easy.\n\n791\n00:40:57.080 --> 00:41:00.720\n>> It's that simple, ladies and\ngentlemen, GLBP coming to the rescue.\n\n792\n00:41:00.720 --> 00:41:05.760\nWhen we've spent multi, multi thousands\nof dollars on awesome hardware but\n\n793\n00:41:05.760 --> 00:41:06.940\nwe want to get the most of that.\n\n794\n00:41:06.940 --> 00:41:10.680\nNow you can go to your CIO or\nwhoever is coming to you going,\n\n795\n00:41:10.680 --> 00:41:14.620\nwhat is that extra switch sitting\nin there doing nothing for?\n\n796\n00:41:14.620 --> 00:41:16.400\nYou can go,\nwell it's not doing nothing anymore.\n\n797\n00:41:16.400 --> 00:41:20.270\nI made sure we're utilizing that hardware\nuntil we do have a full-on failover.\n\n798\n00:41:20.270 --> 00:41:22.907\n>> Yep,\nnow I do want to show one more thing.\n\n799\n00:41:22.907 --> 00:41:24.927\nLet me jump back over to EDGE1.\n\n800\n00:41:24.927 --> 00:41:30.266\nSo I was running the show glbp command,\nright?\n\n801\n00:41:30.266 --> 00:41:33.744\nIf you do, show glbp brief, you're\ngonna see something that's a little bit\n\n802\n00:41:33.744 --> 00:41:36.310\ndifferent than what we've seen before,\nokay?\n\n803\n00:41:36.310 --> 00:41:41.185\nWhen you look at this,\nnotice how I've got two entries for,\n\n804\n00:41:41.185 --> 00:41:45.155\nor really three entries here for my\ninterface on this router, on this switch.\n\n805\n00:41:45.155 --> 00:41:48.395\nSo when I look at this, I can see\nthat I've got group 1 configured, and\n\n806\n00:41:48.395 --> 00:41:51.220\nunder forwarding,\nI've got somebody who's not forwarding.\n\n807\n00:41:51.220 --> 00:41:54.330\nAnd then I've got two that are forwarding,\nokay.\n\n808\n00:41:54.330 --> 00:42:00.090\nWhat you're seeing here is an entry for\nthe AVG and an entry for the AVF.\n\n809\n00:42:00.090 --> 00:42:05.386\nBut the AVG shows up as a AVF also,\nso it shows up twice.\n\n810\n00:42:05.386 --> 00:42:07.630\nAnd so that's why I have\nsomething not forwarding.\n\n811\n00:42:07.630 --> 00:42:10.910\nAnd that not forwarding is 192.168.16.1,\n\n812\n00:42:10.910 --> 00:42:13.830\nthat's the IP that we\nassigned to this group.\n\n813\n00:42:15.030 --> 00:42:18.640\nAnd if I look at the address,\n\n814\n00:42:18.640 --> 00:42:22.540\nit's 192.168.0.1, but right beneath it,\nhere's those fake MAC addresses.\n\n815\n00:42:22.540 --> 00:42:26.985\nAnd notice how there's two different ones,\n\n816\n00:42:26.985 --> 00:42:29.420\n0007.b400.0101 and\nthe other one is 0102, okay?\n\n817\n00:42:30.710 --> 00:42:33.430\nSo, I've got two different MAC addresses.\n\n818\n00:42:33.430 --> 00:42:35.481\nThose are the unique MAC\naddresses that we hand out so\n\n819\n00:42:35.481 --> 00:42:37.957\nthat clients to know to connect to us,\nand so you'll see that.\n\n820\n00:42:37.957 --> 00:42:40.360\nBut don't be surprised when you have one\nentry in here that's not forwarding.\n\n821\n00:42:40.360 --> 00:42:46.470\nThat doesn't mean that you need to jump in\nand fix something, bhat's just the AVG.\n\n822\n00:42:46.470 --> 00:42:52.320\nAnd the AVG is currently local,\nthat's the active, and it has a standby.\n\n823\n00:42:52.320 --> 00:42:55.300\nBut notice how the forwarders\ndon't have a standby.\n\n824\n00:42:55.300 --> 00:42:57.170\nRight, they just have a dash over here.\n\n825\n00:42:57.170 --> 00:42:58.980\nCuz a forwarder doesn't need a standby,\nright?\n\n826\n00:42:58.980 --> 00:43:00.000\nThey're just forwarding.\n\n827\n00:43:00.000 --> 00:43:01.798\nSo it's really treated as\ntwo different entities.\n\n828\n00:43:01.798 --> 00:43:04.155\nYour AVG kinda has split personalities.\n\n829\n00:43:04.155 --> 00:43:07.634\nRight, because it's an AVG and an AVF,\neverybody else is just an AVF.\n\n830\n00:43:07.634 --> 00:43:08.737\nSo that output's a little bit weird.\n\n831\n00:43:08.737 --> 00:43:10.271\n>> Our favorite schizophrenic protocol.\n\n832\n00:43:10.271 --> 00:43:12.751\n[LAUGH]\n>> That's it, it's really powerful,\n\n833\n00:43:12.751 --> 00:43:13.910\nit's a great protocol.\n\n834\n00:43:13.910 --> 00:43:17.252\nIt's one people really wanna use,\nyou just have to have the hardware for it.\n\n835\n00:43:17.252 --> 00:43:21.440\nYou gotta pay some dough to get\nGLBP in your environment, but\n\n836\n00:43:21.440 --> 00:43:22.950\nit does a great job, it really works well.\n\n837\n00:43:22.950 --> 00:43:23.730\n>> Awesome.\nWell, Don,\n\n838\n00:43:23.730 --> 00:43:27.200\nis there anything else we need to let\nthese good people know about when it comes\n\n839\n00:43:27.200 --> 00:43:29.980\nto these redundancy and\nload balancing protocols?\n\n840\n00:43:29.980 --> 00:43:31.390\n>> That's about it.\n\n841\n00:43:31.390 --> 00:43:33.190\nJust, real high level, just for\n\n842\n00:43:33.190 --> 00:43:36.200\nyour own memory,\nthe commands are real simple, right?\n\n843\n00:43:36.200 --> 00:43:39.920\nBecause they're really pretty much the\nsame commands for all three, VRRP, HSRP,\n\n844\n00:43:39.920 --> 00:43:41.420\nand GLBP.\n\n845\n00:43:41.420 --> 00:43:45.960\nThe other thing you need to remember is\nthat HSRP and GLBP are Cisco proprietary,\n\n846\n00:43:45.960 --> 00:43:47.990\nVRRP is an open standard.\n\n847\n00:43:47.990 --> 00:43:51.780\nSo third parties can support it\njust as well as anybody else.\n\n848\n00:43:51.780 --> 00:43:55.475\nSo be aware of those differences,\nbe aware of how to configure them and\n\n849\n00:43:55.475 --> 00:43:59.590\nkinda the key differences between\neach one, and you'll do well.\n\n850\n00:43:59.590 --> 00:44:02.350\n>> All right, well Don, thank you so\nmuch for those demonstrations.\n\n851\n00:44:02.350 --> 00:44:03.410\nThank you for watching.\n\n852\n00:44:03.410 --> 00:44:05.250\nHopefully we'll see you\nnext time on ITProTV.\n\n853\n00:44:05.250 --> 00:44:07.250\nWe're gonna go ahead and sign off.\n\n854\n00:44:07.250 --> 00:44:08.820\nI've been your host, Daniel Lowrie.\n\n855\n00:44:08.820 --> 00:44:09.415\n>> And I'm Don Pezet.\n\n856\n00:44:09.415 --> 00:44:11.518\n>> And we'll see you next time.\n\n857\n00:44:11.518 --> 00:44:18.100\n[SOUND]\n\n",
          "vimeoId": "142150583"
        },
        {
          "description": "In this episode, Ronnie and Don take a look at some of the benefits and features of Layer 3 switches.  They also discuss the limitations of using Layer 3 switches.  The guys also show a basic inter-vlan configuration on a Layer 3 switch.",
          "length": "1733",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-2-layer_3_switching-101415-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-2-layer_3_switching-101415-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/cisco-ccnpswitch300115/cisco-ccnpswitch300115-3-2-layer_3_switching-101415-1-sm.jpg",
          "title": "Layer 3 Switching",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:10.261\n[MUSIC]\n\n2\n00:00:10.261 --> 00:00:12.881\nWelcome to another great\nepisode here on ITProTV.\n\n3\n00:00:12.881 --> 00:00:14.890\nI'm your host, Ronnie Wong, and\n\n4\n00:00:14.890 --> 00:00:18.720\nwe're taking away a CCMP switch today,\nand to help us out, Mr. Don Pezet.\n\n5\n00:00:18.720 --> 00:00:19.560\nHow's it going?\n\n6\n00:00:19.560 --> 00:00:21.180\n>> It is going great, Ronnie.\n\n7\n00:00:21.180 --> 00:00:24.290\nReady to jump into one of the cooler\ntopics that we get to see inside of\n\n8\n00:00:24.290 --> 00:00:25.710\nthe CCMP switch world.\n\n9\n00:00:25.710 --> 00:00:30.590\nNow, for the switch exam, we're normally\ntalking about layer two topics, right?\n\n10\n00:00:30.590 --> 00:00:32.150\nSwitches are layer two devices,\n\n11\n00:00:32.150 --> 00:00:35.160\nwe're trying to move frames\nfrom one port to another.\n\n12\n00:00:35.160 --> 00:00:38.930\nBut in this episode,\nwe're gonna look at layer three switching,\n\n13\n00:00:38.930 --> 00:00:42.350\nwhich is kind of a contradiction\nto terms there, right?\n\n14\n00:00:42.350 --> 00:00:44.610\nSwitch is layer two and\nI'm talking about layer three.\n\n15\n00:00:44.610 --> 00:00:48.010\n>> Yeah, Don, I know from the OSI model\nthat layer two, we have switches and\n\n16\n00:00:48.010 --> 00:00:49.840\nlayer three we have routers.\n\n17\n00:00:49.840 --> 00:00:52.980\nBut you're talking about a layer three\nswitch that really is a contradiction to\n\n18\n00:00:52.980 --> 00:00:54.220\nwhat we're normally seeing.\n\n19\n00:00:54.220 --> 00:00:56.900\n>> Yeah, and it's a technology\nthat's evolved quite a bit and\n\n20\n00:00:56.900 --> 00:00:58.310\nI'll tell you when I.\n\n21\n00:00:58.310 --> 00:01:01.930\nThe first layer three switch\nthat I worked on was in, oh,\n\n22\n00:01:01.930 --> 00:01:06.460\nshoot it would've been 1999 or\n2000 and back then what you did,\n\n23\n00:01:06.460 --> 00:01:10.650\nis you would get a Sysco switch\nlike those big 5500's back then.\n\n24\n00:01:10.650 --> 00:01:14.480\nAnd you would actually\nbuy a router module.\n\n25\n00:01:14.480 --> 00:01:16.050\nAnd you'd stick it into the switch,\n\n26\n00:01:16.050 --> 00:01:20.760\nyou are effectively taking a physical\nrouter and sticking it in your switch, so\n\n27\n00:01:20.760 --> 00:01:24.880\nthat the switch can do routing\nright there inside of the device.\n\n28\n00:01:24.880 --> 00:01:27.000\nIn today's world,\nyou still have that, right?\n\n29\n00:01:27.000 --> 00:01:31.400\nIf you get a 6500 series switch,\nthe really big one, you can put\n\n30\n00:01:31.400 --> 00:01:35.530\na supervisor module in there and it can\ndo the routing right there on the switch.\n\n31\n00:01:35.530 --> 00:01:39.898\nBut even the lower end\nswitches like the 3560's,\n\n32\n00:01:39.898 --> 00:01:44.550\nthe 3750's, even the 2960's\ncan do it to a limited degree.\n\n33\n00:01:44.550 --> 00:01:49.430\nThey can perform routing just right\nthere in software on the switch.\n\n34\n00:01:49.430 --> 00:01:50.400\nAnd it's pretty neat, right?\n\n35\n00:01:50.400 --> 00:01:54.390\nLet's start off with something\nthat's kindaimportant.\n\n36\n00:01:54.390 --> 00:01:56.530\nWhy would we bother doing this\nin the first place, right?\n\n37\n00:01:56.530 --> 00:01:58.320\nIf you got routers that\nare perfectly good at routing,\n\n38\n00:01:58.320 --> 00:02:02.120\nand you got switches that are perfectly\ngood at switching, why mix the two?\n\n39\n00:02:02.120 --> 00:02:03.920\nWe're not talking about chocolate and\npeanut butter here.\n\n40\n00:02:03.920 --> 00:02:05.870\nIt's not gonna be that perfect mixture.\n\n41\n00:02:05.870 --> 00:02:10.230\nSo, the main reason we do it is bandwidth,\nright?\n\n42\n00:02:10.230 --> 00:02:12.500\nWhen you go and buy a router,\n\n43\n00:02:12.500 --> 00:02:17.440\nare you gonna be able to find a router\nwith ten gigs of bandwidth on it?\n\n44\n00:02:17.440 --> 00:02:18.410\nYou can they make them.\n\n45\n00:02:18.410 --> 00:02:20.110\nThey're expensive, right?\n\n46\n00:02:20.110 --> 00:02:23.820\nMost of the routers that you buy\ntoday are only gonna be gigabit.\n\n47\n00:02:23.820 --> 00:02:24.360\nRight?\n\n48\n00:02:24.360 --> 00:02:27.700\nSo, if you have 2 gigabit\ninterfaces I could link to\n\n49\n00:02:27.700 --> 00:02:31.200\ngigabit networks that have a gigabit of\nbandwidth through them, and that's great.\n\n50\n00:02:31.200 --> 00:02:34.070\nBut if I want ten gig, now,\nI got a bit of a problem.\n\n51\n00:02:34.070 --> 00:02:35.640\nI gotta find a router that has it.\n\n52\n00:02:35.640 --> 00:02:38.130\nOr, if I need even more than ten gigs,\n\n53\n00:02:38.130 --> 00:02:40.780\nthen we really start talking\nabout getting expensive.\n\n54\n00:02:40.780 --> 00:02:44.030\nSo, there's problem number\none is bandwidth and\n\n55\n00:02:44.030 --> 00:02:45.820\nproblem number two is port density.\n\n56\n00:02:45.820 --> 00:02:48.450\nWhen you go and buy a router how\nmany interfaces does it have?\n\n57\n00:02:48.450 --> 00:02:49.600\n>> Two or three?\n\n58\n00:02:49.600 --> 00:02:51.790\nMost routers just have two or\nthree, right?\n\n59\n00:02:51.790 --> 00:02:54.760\nAnd as you start to get into the higher\nend routers, when you get to the 3900's,\n\n60\n00:02:54.760 --> 00:02:58.100\nyou can get modules and\nit's pretty easy to throw in 12,\n\n61\n00:02:58.100 --> 00:03:02.795\neven 24 ports on a 3900 if\nyou really kinda press it.\n\n62\n00:03:02.795 --> 00:03:06.995\nIf you start getting into the 7200's\nyou can get even more ports, but\n\n63\n00:03:06.995 --> 00:03:08.865\nwhat if I need 100 ports?\n\n64\n00:03:08.865 --> 00:03:11.955\nWell, now, it's pretty tough to\nfind a router that can do that,\n\n65\n00:03:11.955 --> 00:03:16.525\nit's easy to find a switch with 100 ports,\nit's harder to find a router.\n\n66\n00:03:16.525 --> 00:03:18.685\nAnd especially,\na router that has the throughput,\n\n67\n00:03:18.685 --> 00:03:22.745\nthe ability to move enough data\nthrough it to maintain high bandwidth.\n\n68\n00:03:22.745 --> 00:03:25.595\nSo, on wide area networks\nthat's not a problem right?\n\n69\n00:03:25.595 --> 00:03:30.340\nOn a WAN, when we're talking about\nT1 lines and MPLS frame relay,\n\n70\n00:03:30.340 --> 00:03:31.720\nthose types of connectivity,\n\n71\n00:03:31.720 --> 00:03:35.340\nwe're not usually talking about gigs\nof bandwidth, and it's not a big deal.\n\n72\n00:03:35.340 --> 00:03:38.520\nWe're also not usually talking\nabout hundreds of interfaces.\n\n73\n00:03:38.520 --> 00:03:41.440\nSo it's not a big deal,\nrouters can handle it just fine.\n\n74\n00:03:41.440 --> 00:03:46.390\nBut on a Local Area Network,\non a LAN, you might have many VLANs.\n\n75\n00:03:46.390 --> 00:03:50.990\nAnd you need to route between those VLANs,\nand finding a router\n\n76\n00:03:50.990 --> 00:03:55.150\nwith enough interfaces to do one\ninterface per VLAN is pretty hard to do.\n\n77\n00:03:55.150 --> 00:03:59.118\nIt gets pretty expensive and creates this\nmassive single point of failure right\n\n78\n00:03:59.118 --> 00:04:02.075\nthere on your In your network, so\nthat's a pretty big challenge there.\n\n79\n00:04:02.075 --> 00:04:03.270\nRight?\n\n80\n00:04:03.270 --> 00:04:06.370\nNow, over the years, there have been\ndifferent solutions to this, and\n\n81\n00:04:06.370 --> 00:04:07.600\none solution was router on a stick.\n\n82\n00:04:07.600 --> 00:04:09.030\n>> Ronnie,\nyou remember router on a stick, right?\n\n83\n00:04:09.030 --> 00:04:11.930\n>> Yeah, with router on a stick, what we\ndo is we, of course, connect the actual\n\n84\n00:04:11.930 --> 00:04:17.220\nlayer two switch to a layer three router\nand even between VLANs, we'd actually\n\n85\n00:04:17.220 --> 00:04:21.040\nhave to take traffic from one VLAN,\nshuffle it out to, of course, the router.\n\n86\n00:04:21.040 --> 00:04:24.970\nThe router would then route it out on\nthat same length into the separate VLAN.\n\n87\n00:04:24.970 --> 00:04:28.800\nSo, being able to do router on a stick\nwas actually a great configuration\n\n88\n00:04:28.800 --> 00:04:30.600\non a fairly small network.\n\n89\n00:04:30.600 --> 00:04:33.740\nBut then again, you're still having\nthat one gig port, normally.\n\n90\n00:04:33.740 --> 00:04:37.390\nAnd so you do have a lot of VLANs or if\nyou're actually doing something like VTP\n\n91\n00:04:37.390 --> 00:04:41.520\nbetween multiple switches, it can get\na little bit more hefty at that point.\n\n92\n00:04:41.520 --> 00:04:44.660\nSo, even though the solution is not\nthe greatest solution, if you really need\n\n93\n00:04:44.660 --> 00:04:48.740\nthat high speed traffic that we normally\ndo need between different networks.\n\n94\n00:04:48.740 --> 00:04:51.240\n>> Yeah, and if you've never done\nrouter on a stick, first off,\n\n95\n00:04:51.240 --> 00:04:54.610\nI don't blame you,\nit was a great solution.\n\n96\n00:04:54.610 --> 00:04:57.860\nIt was the only thing we had for a while,\nwhere you basically configured a trunk\n\n97\n00:04:57.860 --> 00:05:02.090\nport, right, so a VLAN trunk port\nbetween your switch and your router.\n\n98\n00:05:02.090 --> 00:05:05.010\nAnd then on your router,\nyou could create virtual sub interfaces.\n\n99\n00:05:05.010 --> 00:05:07.970\nIn fact, let me, yeah, I'll show you guys\nreal quick, just if you haven't seen it\n\n100\n00:05:07.970 --> 00:05:11.430\nbefore, so I've got this router here and\nit's a 2900 right?\n\n101\n00:05:11.430 --> 00:05:16.080\nIf I look at my version output here,\nso it's not a great router, but\n\n102\n00:05:16.080 --> 00:05:19.620\nit's good enough and it's got\na couple of gig ports on it right?\n\n103\n00:05:19.620 --> 00:05:25.470\nSo it's got three gigabit Ethernet\ninterfaces on it that I can use here and\n\n104\n00:05:25.470 --> 00:05:27.730\nthose interfaces that kind of limits us.\n\n105\n00:05:27.730 --> 00:05:30.410\nI can connect to three VLANs,\nI have three interfaces.\n\n106\n00:05:30.410 --> 00:05:32.205\nBut what if I have five or ten VLANs.\n\n107\n00:05:32.205 --> 00:05:34.510\n>> [LAUGH]\n>> I can take one of those interfaces and\n\n108\n00:05:34.510 --> 00:05:38.410\nbreak it up to have virtual\nsub-interfaces, and\n\n109\n00:05:38.410 --> 00:05:40.950\nI can use those as a trunk to my network.\n\n110\n00:05:40.950 --> 00:05:45.610\nSo, if I take a look at the configuration\nof one of those interfaces,\n\n111\n00:05:45.610 --> 00:05:46.325\nI'll take gi0/0, right?\n\n112\n00:05:46.325 --> 00:05:50.127\nSo it's 192.168.16.2 and that's it.\n\n113\n00:05:50.127 --> 00:05:51.218\nIt's up and it's running.\n\n114\n00:05:51.218 --> 00:05:56.449\nNow, it has no knowledge of VLANs because\nthis is just an access port on the switch,\n\n115\n00:05:56.449 --> 00:05:56.990\nright?\n\n116\n00:05:56.990 --> 00:05:59.180\nThe switch is putting us on VLAN one and\n\n117\n00:05:59.180 --> 00:06:04.190\nthat's what that one is, right, but\nif I had VLANs two, three, four, and five.\n\n118\n00:06:04.190 --> 00:06:08.070\nI could come in and start to add those\nin here as virtual sub-interfaces.\n\n119\n00:06:08.070 --> 00:06:12.754\nSo, in my configuration I could\njump in and I could say interface\n\n120\n00:06:12.754 --> 00:06:17.950\ngi0/0.2 like that, and\nI'm creating a sub-interface.\n\n121\n00:06:17.950 --> 00:06:21.530\nAnd when you do that, you have to tell it\nthe encapsulation that you're using and\n\n122\n00:06:21.530 --> 00:06:23.830\nI'm gonna tell it, encapsulation.1q so,\n\n123\n00:06:23.830 --> 00:06:26.460\nit knows that I'm gonna be\nbuilding an 802.1q trunk and\n\n124\n00:06:26.460 --> 00:06:30.270\nit got mad at me cuz I didn't follow\nit up with what VLAN it was gonna be.\n\n125\n00:06:30.270 --> 00:06:33.800\nYou have to tell it all right,\nthis one's gonna be on VLAN 2 and\n\n126\n00:06:33.800 --> 00:06:38.720\nthen I can give it an IP address of\nwhatever it is that I want it to have or\n\n127\n00:06:38.720 --> 00:06:40.390\nI'll just give it a fake one.\n\n128\n00:06:40.390 --> 00:06:45.020\nAnd I could continue doing that for\nas many other sub-interfaces as I needed.\n\n129\n00:06:45.020 --> 00:06:49.490\nSo, maybe I've got VLAN 3 out there,\nand so I could punch that one in.\n\n130\n00:06:49.490 --> 00:06:52.650\nAnd I just keep going,\nadding in each of my different networks.\n\n131\n00:06:52.650 --> 00:06:57.280\nNow, the cool part about this\nis that I have one interface\n\n132\n00:06:57.280 --> 00:07:01.220\nthat I've now got set up for\nthree different VLANs, right?\n\n133\n00:07:01.220 --> 00:07:06.620\nSo, if I take a look at my config for\nthat, you'll see\n\n134\n00:07:06.620 --> 00:07:13.180\nwhere I've got the 0/0 interface and then\nhere's the sub-interfaces that I made.\n\n135\n00:07:13.180 --> 00:07:16.840\nAnd I can continue adding more\nsub-interfaces as I needed them\n\n136\n00:07:16.840 --> 00:07:20.610\nto finally get to where I've\ngot all my VLANs represented.\n\n137\n00:07:20.610 --> 00:07:25.770\nAnd when I do a show IP route, they just\nshow up in here as connected routes.\n\n138\n00:07:25.770 --> 00:07:28.910\nSo, I'm connected to 192.168.16.17.18,\nall right?\n\n139\n00:07:28.910 --> 00:07:31.930\nSo, this is the old solution.\n\n140\n00:07:31.930 --> 00:07:33.450\nIf I wanted to route between these VLANs,\n\n141\n00:07:33.450 --> 00:07:36.740\nI could take one router,\nset it up as a trunk.\n\n142\n00:07:36.740 --> 00:07:39.620\nThe port that I'm plugged into on\nthe switch, I'd need to configure that as\n\n143\n00:07:39.620 --> 00:07:44.150\na trunk so that I'm carrying VLANs 2,\n3 and 4, and off we go, right?\n\n144\n00:07:44.150 --> 00:07:45.980\nWell, there's one problem.\n\n145\n00:07:45.980 --> 00:07:48.260\nRight, first of all, I mean,\nthat all works,it works great.\n\n146\n00:07:48.260 --> 00:07:50.670\nBut the problem is, it's one line.\n\n147\n00:07:50.670 --> 00:07:52.720\nAnd like Ronnie said,\nit's a gig leak, right?\n\n148\n00:07:52.720 --> 00:07:54.470\nBut it's not even just that.\n\n149\n00:07:54.470 --> 00:07:58.234\nMy traffic, if I'm routing\nsomething from VLAN 2 to VLAN 3.\n\n150\n00:07:58.234 --> 00:08:02.274\nI had to send the traffic up\nthe gig link to the router.\n\n151\n00:08:02.274 --> 00:08:04.614\nThe router moves it over the VLAN 3 and\n\n152\n00:08:04.614 --> 00:08:08.500\nthen it's gonna come down\nthe same link on the other VLAN.\n\n153\n00:08:08.500 --> 00:08:11.990\nSo I'm using send and receive bandwidth.\n\n154\n00:08:11.990 --> 00:08:14.880\nNow, gig links like this\none are full duplex.\n\n155\n00:08:14.880 --> 00:08:17.230\nSo I can send and receive at the same\ntime, that's should be okay but\n\n156\n00:08:17.230 --> 00:08:18.780\neverybody else is doing the same thing.\n\n157\n00:08:18.780 --> 00:08:22.710\nEverybody else is going up and\ndown that same line.\n\n158\n00:08:22.710 --> 00:08:26.910\nI've created a bottleneck on my network,\nand that's the bad part.\n\n159\n00:08:26.910 --> 00:08:32.700\nSo if we could take this router and\nstick it inside of the switch,\n\n160\n00:08:32.700 --> 00:08:35.510\nnow I don't have a link that I've\ngotta go up and come back down.\n\n161\n00:08:35.510 --> 00:08:40.600\nI don't have this bandwidth contention or\nwhatever, it's all inside of the switch.\n\n162\n00:08:40.600 --> 00:08:45.400\nAnd so that solves one problem and we get\nanother really cool benefit along with it.\n\n163\n00:08:45.400 --> 00:08:49.725\nThe router that's inside of the switch\ncan be directly wired in to the back\n\n164\n00:08:49.725 --> 00:08:51.510\nplane of the switch.\n\n165\n00:08:51.510 --> 00:08:56.440\nAnd that means you can\nroute packets at speeds\n\n166\n00:08:56.440 --> 00:09:01.090\nthat aren't realizable on a normal router,\non a traditional, affordable router.\n\n167\n00:09:01.090 --> 00:09:07.290\nSo for example, when I look at this router\nhere, it's a 2900 and it has gig boards.\n\n168\n00:09:07.290 --> 00:09:10.510\nSo I can't move more than a gig\nof data in any direction, right?\n\n169\n00:09:10.510 --> 00:09:14.080\nI can be sending a gig or receiving\na gig or doing both at the same time.\n\n170\n00:09:14.080 --> 00:09:17.230\nBut I can never get more than a gigabit of\nbandwidth on this because that's what I'm\n\n171\n00:09:17.230 --> 00:09:18.710\ntied to right?\n\n172\n00:09:18.710 --> 00:09:21.580\nBut on a Cisco switch,\nyou have a back plane.\n\n173\n00:09:21.580 --> 00:09:25.070\nAnd the back plane is\nusually significantly higher\n\n174\n00:09:25.070 --> 00:09:27.875\nthan whatever the speed of\nthe ports happen to be,all right.\n\n175\n00:09:27.875 --> 00:09:30.840\nBecause Cisco switches\noperate on this principle of,\n\n176\n00:09:30.840 --> 00:09:33.710\nwell they call it subscription and\nover subscription,\n\n177\n00:09:33.710 --> 00:09:38.920\nthat if I get a 48 port and\nthey're 48, one gig\n\n178\n00:09:38.920 --> 00:09:44.590\nports I could potentially be generating\n48 gigs of traffic in either direction.\n\n179\n00:09:44.590 --> 00:09:45.670\nRight?\n\n180\n00:09:45.670 --> 00:09:48.070\nBut the back plane of the switch\nis probably not 48 gigs.\n\n181\n00:09:48.070 --> 00:09:52.270\nBecause Cisco knows that not every\nport is talking to each other.\n\n182\n00:09:52.270 --> 00:09:55.970\nSo it's normally gonna be\nsomething like 16 gigs or 32 gigs.\n\n183\n00:09:55.970 --> 00:09:57.500\nAnd ports are sharing.\n\n184\n00:09:57.500 --> 00:09:58.070\nRight?\nSo\n\n185\n00:09:58.070 --> 00:10:00.600\nyou're over subscribing your back plane.\n\n186\n00:10:00.600 --> 00:10:03.940\nPotentially I could have more port traffic\nthen what's available in the back plain.\n\n187\n00:10:03.940 --> 00:10:08.405\nBut even at 32 gigs if I'm over\nsubscribed, I still have more bandwidth\n\n188\n00:10:08.405 --> 00:10:11.050\nthan this router's gonna\nhave with a single gig link.\n\n189\n00:10:11.050 --> 00:10:13.790\nSo when you buy a Cisco switch,\nif you get the cheap ones, right.\n\n190\n00:10:13.790 --> 00:10:14.750\nYou get a 2960.\n\n191\n00:10:14.750 --> 00:10:18.720\nIt's usually,\neight ports assuming it's gig,\n\n192\n00:10:18.720 --> 00:10:22.260\nit's usually eight ports sharing a one\ngig connection to the back plane.\n\n193\n00:10:22.260 --> 00:10:23.490\nSo if you look at the front of the switch,\n\n194\n00:10:23.490 --> 00:10:26.140\nyou'll actually see these little\nyellow boxes drawn around ports.\n\n195\n00:10:26.140 --> 00:10:28.630\nThat are showing you\nthe clusters that they create.\n\n196\n00:10:28.630 --> 00:10:31.102\nSo these eight ports\nshare a gig connection.\n\n197\n00:10:31.102 --> 00:10:32.182\nThese eight ports share a gig.\n\n198\n00:10:32.182 --> 00:10:33.401\nThese eight ports share a gig.\n\n199\n00:10:33.401 --> 00:10:34.850\nRight?\n\n200\n00:10:34.850 --> 00:10:37.076\nAnd on a higher end switch, like a 3750,\n\n201\n00:10:37.076 --> 00:10:39.426\nwhich is what I've been\nusing most of the show.\n\n202\n00:10:39.426 --> 00:10:42.701\nThis 3750s,\nthey don't over subscribe, and so\n\n203\n00:10:42.701 --> 00:10:47.395\nif you've got a 24 port 3750,\nit's got a 24 gig back plane.\n\n204\n00:10:47.395 --> 00:10:50.105\nUsually more because of\nthe uplink ports that are on it.\n\n205\n00:10:50.105 --> 00:10:54.375\nAnd so these switches cost more, but\nthere's a reason for that, right?\n\n206\n00:10:54.375 --> 00:10:57.875\nBecause they're able to handle all\nthe bandwidth that you shove at them.\n\n207\n00:10:57.875 --> 00:11:02.065\nNow unfortunately there's not a great\nway to see what your bandwidth is\n\n208\n00:11:02.065 --> 00:11:04.340\nright here on the switch itself.\n\n209\n00:11:04.340 --> 00:11:06.700\nYou've really gotta go to\nCisco's documentation.\n\n210\n00:11:06.700 --> 00:11:08.792\nIf you go an dig up Cisco's documentation,\n\n211\n00:11:08.792 --> 00:11:11.740\nlike here's I've the 6500s\nkinda pulled up.\n\n212\n00:11:11.740 --> 00:11:14.100\nWhen you go and\nstart reading on the switches,\n\n213\n00:11:14.100 --> 00:11:18.190\nit'll tell you about the back plane,\nright?\n\n214\n00:11:18.190 --> 00:11:19.640\nWhen you buy that switch,\n\n215\n00:11:19.640 --> 00:11:23.060\nit's comes in different models that have\ndifferent amounts of back plane bandwidth.\n\n216\n00:11:23.060 --> 00:11:28.604\nAnd so you'll see down here like if\nwe have a Cisco 6500 with the SFM2,\n\n217\n00:11:28.604 --> 00:11:33.105\nyou can get up to 256 gigabit\nof bandwidth on that switch.\n\n218\n00:11:33.105 --> 00:11:38.312\nThat might be a little bit of overkill for\nus but if I have a virtual router floating\n\n219\n00:11:38.312 --> 00:11:43.700\non the back plane, that means the router\ncan be routing 256 gigs of data at once.\n\n220\n00:11:43.700 --> 00:11:46.875\nNow it's not normally that bad because of\nthe way you have your separate control\n\n221\n00:11:46.875 --> 00:11:47.470\nplane and all that.\n\n222\n00:11:47.470 --> 00:11:52.180\nSo you're never truly routing a full 256,\nbut you could be doing that, and\n\n223\n00:11:52.180 --> 00:11:54.690\nyou'll see they have models that\ngo all the way up to 720 gigabits.\n\n224\n00:11:54.690 --> 00:11:57.610\nYou can get huge amounts of bandwidth.\n\n225\n00:11:57.610 --> 00:11:59.339\nEven on your cheaper switches.\n\n226\n00:11:59.339 --> 00:12:01.010\nI shouldn't say cheaper here.\n\n227\n00:12:01.010 --> 00:12:02.870\n>> [LAUGH]\n>> Less expensive switches,\n\n228\n00:12:02.870 --> 00:12:07.060\neven on like a 3560, The back plane\non those is still pretty significant.\n\n229\n00:12:07.060 --> 00:12:08.560\nYou can move a lot more\ndata than a router.\n\n230\n00:12:08.560 --> 00:12:09.650\nAll right?\n\n231\n00:12:09.650 --> 00:12:13.110\nSo that's the main reason why we might\nchoose to do layer three switching,\n\n232\n00:12:13.110 --> 00:12:16.440\nis we could get way better\nbandwidth out of this\n\n233\n00:12:16.440 --> 00:12:19.070\nthan we would by doing\nit on a router itself.\n\n234\n00:12:19.070 --> 00:12:19.880\nAll right?\n\n235\n00:12:19.880 --> 00:12:22.010\nBut it's not all sunshine and rainbows.\n\n236\n00:12:22.010 --> 00:12:25.040\nWhen you switch this,\nthere's certain things that you give up.\n\n237\n00:12:25.040 --> 00:12:30.080\nCertain things that you can do on\na router but you can't do on a switch.\n\n238\n00:12:30.080 --> 00:12:31.230\nAll right?\n\n239\n00:12:31.230 --> 00:12:32.890\nThe number one thing?\n\n240\n00:12:32.890 --> 00:12:34.870\nIf I take a look at my interfaces, right?\n\n241\n00:12:34.870 --> 00:12:37.420\nOr here, even in the show version,\nI can see it.\n\n242\n00:12:37.420 --> 00:12:40.010\nWhen I take a look at\nthe interfaces on my switch,\n\n243\n00:12:40.010 --> 00:12:42.270\nwhat kind of interfaces am I gonna have?\n\n244\n00:12:42.270 --> 00:12:45.810\nWell on this one,\noh shoot I moved right past it.\n\n245\n00:12:45.810 --> 00:12:49.460\nOn this one what you'll see is\nI have Ethernet interfaces.\n\n246\n00:12:49.460 --> 00:12:50.380\nRight.\n\n247\n00:12:50.380 --> 00:12:52.490\nI've got 24 fast Ethernet interfaces.\n\n248\n00:12:52.490 --> 00:12:55.030\nI've got two gigabit Ethernet interfaces.\n\n249\n00:12:55.030 --> 00:12:56.110\nHow many serial ports do I have?\n\n250\n00:12:57.670 --> 00:12:58.290\n>> None.\n>> None.\n\n251\n00:12:58.290 --> 00:12:59.720\nYou know, that's the thing.\n\n252\n00:12:59.720 --> 00:13:03.060\nOn a switch it is really switching for\nEthernet networks.\n\n253\n00:13:03.060 --> 00:13:04.940\nWhat if I need MPLS?\n\n254\n00:13:04.940 --> 00:13:06.700\nWhat if I need frame relay?\n\n255\n00:13:06.700 --> 00:13:09.430\nWhat if I have a T1 that's\ncoming in that's doing PPP?\n\n256\n00:13:11.060 --> 00:13:12.190\nSwitches don't do that.\n\n257\n00:13:12.190 --> 00:13:13.650\nSwitches are LAN devices.\n\n258\n00:13:13.650 --> 00:13:15.290\nLocal area networks not\nwide area networks.\n\n259\n00:13:15.290 --> 00:13:16.910\nThey are not going to do that, right?\n\n260\n00:13:16.910 --> 00:13:18.230\nThere are some switches that will do it.\n\n261\n00:13:18.230 --> 00:13:22.280\nWhen you start getting in to\nthe higher end, all rules go away.\n\n262\n00:13:22.280 --> 00:13:25.600\nBut on your mid-tier and low-end switches\nyou're just not gonna have that.\n\n263\n00:13:25.600 --> 00:13:28.300\nOn a router if I need a T1 interface,\nno big deal.\n\n264\n00:13:28.300 --> 00:13:31.540\nYou just buy a serial HWIC and\npop it in there and you're in business.\n\n265\n00:13:31.540 --> 00:13:34.420\nOr a module you throw in there and\nyou got it.\n\n266\n00:13:34.420 --> 00:13:35.740\nOn a switch, you don't have that.\n\n267\n00:13:35.740 --> 00:13:37.710\nThat's the first thing we give up.\n\n268\n00:13:37.710 --> 00:13:41.090\nThe other thing we give up\nare some protocols, right.\n\n269\n00:13:41.090 --> 00:13:44.140\nThere's certain protocols that\nwork just fine on a router but\n\n270\n00:13:44.140 --> 00:13:45.320\ndon't work on a switch.\n\n271\n00:13:45.320 --> 00:13:49.460\nA great example of that would be NAT,\nnetwork address translation, right.\n\n272\n00:13:49.460 --> 00:13:54.480\nIf I'm on a switch, so well,\njust kinda first rule of layer three\n\n273\n00:13:54.480 --> 00:13:57.550\nswitching is that layer three switching\nis normally turned off by default.\n\n274\n00:13:57.550 --> 00:14:00.225\nSo I'm just gonna issue an IP routing\ncommand here to make sure it's turned on,\n\n275\n00:14:00.225 --> 00:14:01.520\nright.\n\n276\n00:14:01.520 --> 00:14:06.250\nAnd if I do a show ip nat translations,\nwhich would work on any Cisco router,\n\n277\n00:14:06.250 --> 00:14:09.750\neven the cheapest one, I get nothing back.\n\n278\n00:14:09.750 --> 00:14:10.330\nRight?\n\n279\n00:14:10.330 --> 00:14:12.280\nBut, if I take a look at show ip nat and\n\n280\n00:14:12.280 --> 00:14:14.800\ndo a question mark,\nthe commands are there.\n\n281\n00:14:14.800 --> 00:14:16.314\nRight?\nThey're there, so\n\n282\n00:14:16.314 --> 00:14:18.530\nit obviously supports NAT, right?\n\n283\n00:14:18.530 --> 00:14:22.860\nWell, what you'll find is this is one\nof those, oh, if I spell it right,\n\n284\n00:14:22.860 --> 00:14:26.440\nwhere even though the commands are there,\nit doesn't actually work.\n\n285\n00:14:26.440 --> 00:14:30.600\nWe can't get in there and actually\nturn on network address translation.\n\n286\n00:14:30.600 --> 00:14:36.350\nIf I were to try to get into interface\nVLAN one, and say ip net inside.\n\n287\n00:14:37.570 --> 00:14:39.010\nIt didn't work, right.\n\n288\n00:14:39.010 --> 00:14:41.620\nSo I can't actually enable NAT.\n\n289\n00:14:41.620 --> 00:14:43.953\nSo the fact that the show commands\nare there doesn't really help me, right.\n\n290\n00:14:43.953 --> 00:14:45.056\nI'm giving that up.\n\n291\n00:14:45.056 --> 00:14:49.440\nSame thing with some routing protocols,\nyou'll find that, even if you have a layer\n\n292\n00:14:49.440 --> 00:14:53.780\nthree switch, you might have support for\na particular routing protocol, right?\n\n293\n00:14:53.780 --> 00:14:58.230\nSo I might say, router RIP,\nrouter OSPF, or whatever.\n\n294\n00:14:58.230 --> 00:15:00.510\nBut sometimes they won't be there.\n\n295\n00:15:00.510 --> 00:15:03.160\nSo notice I've got like router BGP,\nall right.\n\n296\n00:15:03.160 --> 00:15:05.780\nMost layer three switches\ndon't support BGP\n\n297\n00:15:05.780 --> 00:15:08.100\nbecause you need BGP when\nyou're routing on the Internet.\n\n298\n00:15:08.100 --> 00:15:11.150\nYou don't need BGP when you're\nrouting inside of your LAN, and so\n\n299\n00:15:11.150 --> 00:15:12.750\na lot of them won't do it, right.\n\n300\n00:15:12.750 --> 00:15:14.410\nSome of them will, some won't.\n\n301\n00:15:14.410 --> 00:15:17.360\nSome might do OSPF but not do RIP.\n\n302\n00:15:17.360 --> 00:15:20.670\nSo understand that not all your\nrouting protocols may be there.\n\n303\n00:15:20.670 --> 00:15:22.380\nEven though they show up in the commands,\n\n304\n00:15:22.380 --> 00:15:25.750\nsometimes you go to enable them and\nthey don't work.\n\n305\n00:15:25.750 --> 00:15:28.207\nWell, in this case this\none does support BGP.\n\n306\n00:15:28.207 --> 00:15:29.560\n>> [LAUGH]\n>> So this one has it,\n\n307\n00:15:29.560 --> 00:15:30.410\nnot every switch does.\n\n308\n00:15:30.410 --> 00:15:33.800\nJust be aware that you are giving up\ncertain features cuz a switch can't do it.\n\n309\n00:15:33.800 --> 00:15:36.160\nSo it's not that we don't\nneed routers anymore,\n\n310\n00:15:36.160 --> 00:15:38.780\nrouters still serve a very specific place.\n\n311\n00:15:38.780 --> 00:15:41.820\nIt's just sometimes we can use\na switch to get better performance.\n\n312\n00:15:41.820 --> 00:15:46.100\n>> Now,Don, is there any advantage,\nbecause it is actually a switch,\n\n313\n00:15:46.100 --> 00:15:49.570\nwith the way that the A6 work in\nthe switch and the layer three?\n\n314\n00:15:49.570 --> 00:15:51.070\n>> Well, it depends on the switch.\n\n315\n00:15:51.070 --> 00:15:53.818\nSo, when you have a router,\na router has hardware.\n\n316\n00:15:53.818 --> 00:15:54.987\nRonnie mentioned ASIC's, right?\n\n317\n00:15:54.987 --> 00:15:58.312\nApplication specific integrated\ncircuits It's microchips that\n\n318\n00:15:58.312 --> 00:16:02.930\nare on the motherboard of the router\nthat are specifically designed to route.\n\n319\n00:16:02.930 --> 00:16:06.070\nOn a switch we have the same thing, but\nthey're specifically designed to switch.\n\n320\n00:16:06.070 --> 00:16:08.800\nNow we're making you do something\nit's not specifically designed for.\n\n321\n00:16:08.800 --> 00:16:11.340\nWell, on a low end switch or\neven a mid tier,\n\n322\n00:16:11.340 --> 00:16:14.260\non some of the mid tiers,\nthey don't have that hardware for routing.\n\n323\n00:16:14.260 --> 00:16:16.320\nAnd so they're doing it in software,\nright?\n\n324\n00:16:16.320 --> 00:16:20.090\nSo, if you have a complex network,\nif you're doing things like route maps and\n\n325\n00:16:20.090 --> 00:16:23.800\npolicy based routing, the switches\ndon't do such a great job of that.\n\n326\n00:16:23.800 --> 00:16:25.244\nRouters do a great job of that.\n\n327\n00:16:25.244 --> 00:16:29.708\nBut when you start getting into the higher\nswitches like a 3750 like mine here or\n\n328\n00:16:29.708 --> 00:16:34.443\nif you get into a 4500 or a 6500, a lot of\ntimes you'll see they do PBR just fine.\n\n329\n00:16:34.443 --> 00:16:37.992\nThey've got the hardware for the router\ncuz your actually buying a hardware\n\n330\n00:16:37.992 --> 00:16:41.985\nsupervisor module that you pop into it,\nthat has the routing hardware on it.\n\n331\n00:16:41.985 --> 00:16:45.685\nSo there is a difference between whether\nthis is employed in hardware and\n\n332\n00:16:45.685 --> 00:16:47.415\nin software, all right?\n\n333\n00:16:47.415 --> 00:16:51.085\nAnd let's build on that hardware and\nsoftware topic, right?\n\n334\n00:16:51.085 --> 00:16:54.650\nSo, on a router,\nyou have physical interfaces that are tied\n\n335\n00:16:54.650 --> 00:16:57.010\nto each network that you're\ngonna be routing, right?\n\n336\n00:16:57.010 --> 00:16:58.440\nOn a switch you don't, right?\n\n337\n00:16:58.440 --> 00:17:00.260\nAnd let's take a look at my switch here.\n\n338\n00:17:00.260 --> 00:17:05.156\nSo, I've got this switch, and\nit's a 3750, I think 24 ports, and\n\n339\n00:17:05.156 --> 00:17:09.216\nif I take a look at the interfaces\nthat are available, right?\n\n340\n00:17:09.216 --> 00:17:14.080\nI've got FA 1/0/1, and on it goes, right?\n\n341\n00:17:14.080 --> 00:17:16.790\nBut notice how I don't have IP\naddresses on any of these, right?\n\n342\n00:17:16.790 --> 00:17:19.110\nNone of these interfaces have an IP.\n\n343\n00:17:19.110 --> 00:17:23.150\nBecause it's on a router that we\nassigned an IP address to an interface.\n\n344\n00:17:23.150 --> 00:17:26.610\nOn a switch,\nwe assigned it to a virtual interface.\n\n345\n00:17:26.610 --> 00:17:29.710\nAnd so you can see I've got\nVlan 1 right up here, right?\n\n346\n00:17:29.710 --> 00:17:33.040\nA virtual interface, you might be\nthinking, that's software isn't it?\n\n347\n00:17:33.040 --> 00:17:34.550\nTechnically, it is, yes.\n\n348\n00:17:34.550 --> 00:17:37.250\nBut it's software that the switch\nis designed to handle.\n\n349\n00:17:37.250 --> 00:17:41.630\nSo it's got this interface that has an IP,\nthat's able to route, and\n\n350\n00:17:41.630 --> 00:17:43.470\nI can add ports to it.\n\n351\n00:17:43.470 --> 00:17:46.690\nAnd now they're a part of that network and\nthey can see it, right?\n\n352\n00:17:46.690 --> 00:17:49.850\nSwitches do support doing\nphysical ports too.\n\n353\n00:17:49.850 --> 00:17:51.873\nI could assign a physical\nport to a network.\n\n354\n00:17:51.873 --> 00:17:55.606\nMaybe I wanna take,\nI'll take port number 12 over here and\n\n355\n00:17:55.606 --> 00:17:57.515\nI'll make it a physical port.\n\n356\n00:17:57.515 --> 00:18:04.088\nSo if I get into fa1/0/12,\nI can issue the no switchport command,\n\n357\n00:18:04.088 --> 00:18:08.416\nand that says this is no\nlonger a layer two port.\n\n358\n00:18:08.416 --> 00:18:10.920\nNow it's a layer three port.\n\n359\n00:18:10.920 --> 00:18:12.340\nAnd once it's a layer three port,\n\n360\n00:18:12.340 --> 00:18:15.550\nI can assign it an IP address\njust like anything else.\n\n361\n00:18:15.550 --> 00:18:21.741\nAnd so I'll give it 192.168.17.02,\nI guess.\n\n362\n00:18:21.741 --> 00:18:25.016\nAnd give it that IP.\n\n363\n00:18:25.016 --> 00:18:27.470\nAll right.\nAnd as long as it's up,\n\n364\n00:18:27.470 --> 00:18:31.840\nI now have a connection and\na network tied to this physical interface.\n\n365\n00:18:31.840 --> 00:18:35.130\nNow when you tie to a physical interface\nlike that, it's not on a VLAN.\n\n366\n00:18:35.130 --> 00:18:36.380\nIt's a physical interface.\n\n367\n00:18:36.380 --> 00:18:39.310\nSo it doesn't know if it's on VLAN 1 or\nVLAN 5, or VLAN 10,000.\n\n368\n00:18:39.310 --> 00:18:40.300\nIt doesn't know.\n\n369\n00:18:40.300 --> 00:18:42.770\nWell, you can't go to 10,000,\nI guess it wouldn't know that.\n\n370\n00:18:42.770 --> 00:18:46.860\nBut it doesn't know,\nit's just a physical, routed port.\n\n371\n00:18:46.860 --> 00:18:49.340\nNow, there's times where we\nmight want that if we're doing,\n\n372\n00:18:49.340 --> 00:18:51.330\nI think we mentioned it\nback in EtherChannel show.\n\n373\n00:18:51.330 --> 00:18:55.380\nHow I might want to bond layer three\ninterfaces to create some mega router\n\n374\n00:18:55.380 --> 00:19:00.520\nport, you could do that here, but\nnormally we're gonna tie it to a VLAN and\n\n375\n00:19:00.520 --> 00:19:03.400\nthat's because a VLAN doesn't\nhave the bandwidth boundaries.\n\n376\n00:19:03.400 --> 00:19:05.580\nThe VLAN interface is floating\non the back plane, so\n\n377\n00:19:05.580 --> 00:19:07.900\nyou've got full access to\nthe back plane's bandwidth.\n\n378\n00:19:07.900 --> 00:19:10.290\nWhen I tie it to a physical\ninterface like this,\n\n379\n00:19:10.290 --> 00:19:12.750\nI'm tied to the bandwidth\nof that interface.\n\n380\n00:19:12.750 --> 00:19:13.961\nBut it does work, right?\n\n381\n00:19:13.961 --> 00:19:18.220\nAnd if I were to try that same thing\non a different port, like port 13.\n\n382\n00:19:18.220 --> 00:19:25.836\nIf I wanted to give it an IP address,\nwell, this one is still a layer two port.\n\n383\n00:19:25.836 --> 00:19:28.621\nAnd so when I try and\nassign it a layer three address,\n\n384\n00:19:28.621 --> 00:19:30.596\nthat command is not even supported.\n\n385\n00:19:30.596 --> 00:19:35.662\nSo that breaks it, and if I do a show\nIP route, and I take a look at my\n\n386\n00:19:35.662 --> 00:19:41.285\nrouting table,\nI'll see 192.168.16 attached to VLAN 1 and\n\n387\n00:19:41.285 --> 00:19:45.544\nI see 192.168.17 attached to FA0-12.\n\n388\n00:19:45.544 --> 00:19:47.088\nRight attach that other interface.\n\n389\n00:19:47.088 --> 00:19:50.440\nSo we can kinda use it either way to\nprovide that routing environment.\n\n390\n00:19:50.440 --> 00:19:53.740\n>> So Don, if we're trying\nto actually create 10 or 15,\n\n391\n00:19:53.740 --> 00:19:57.610\n20 different VLANs I don't really need\nto configure anything else, do I?\n\n392\n00:19:57.610 --> 00:20:00.790\nSince it's just a layer three switch,\nit should work perfectly fine.\n\n393\n00:20:00.790 --> 00:20:02.030\nAnd so,\n>> Yeah.\n\n394\n00:20:02.030 --> 00:20:03.000\n>> Is that all I have to do?\n\n395\n00:20:03.000 --> 00:20:05.300\n>> Well, I mean,\nassuming that routing is turned on, and\n\n396\n00:20:05.300 --> 00:20:06.970\nyou've already created\nthe VLAN interfaces,\n\n397\n00:20:06.970 --> 00:20:09.860\nyou really just assign IP addresses to\nthem, and then you're up and going.\n\n398\n00:20:09.860 --> 00:20:12.550\nLet me show you guys kind of\na standard configuration for\n\n399\n00:20:12.550 --> 00:20:16.160\nwhat we might do with a layer three\nenvironment like this, right?\n\n400\n00:20:16.160 --> 00:20:19.860\nSo, I've got VLAN 1 already in place and\nI'm up and\n\n401\n00:20:19.860 --> 00:20:22.630\nI'm running my routing protocol and\nthings are running.\n\n402\n00:20:22.630 --> 00:20:23.230\nRight?\n\n403\n00:20:23.230 --> 00:20:26.150\nSo, I might then create other VLANs.\n\n404\n00:20:26.150 --> 00:20:28.422\nSo, I might do a vlan two and\na vlan three and\n\n405\n00:20:28.422 --> 00:20:30.833\nall these other vlan's that I make, right?\n\n406\n00:20:30.833 --> 00:20:32.390\nAnd, I don't even have to\nmake them ahead of time.\n\n407\n00:20:32.390 --> 00:20:36.104\nI can just jump into their interface and\nstart assigning IP addresses to them.\n\n408\n00:20:36.104 --> 00:20:41.796\nSo, I might have 192.168.2.1,\n\n409\n00:20:41.796 --> 00:20:46.750\nand then I'll do, maybe like VLAN 3.\n\n410\n00:20:46.750 --> 00:20:50.252\nI just go through and\nstart creating each of these interfaces.\n\n411\n00:20:50.252 --> 00:20:54.152\nAnd as I create these interfaces,\nif the VLAN doesn't exist,\n\n412\n00:20:54.152 --> 00:20:55.779\nit's now creating them.\n\n413\n00:20:55.779 --> 00:20:57.752\nDo I have any trunks?\n\n414\n00:20:57.752 --> 00:20:59.313\nLet's see if I have any\ntrunks on this thing,\n\n415\n00:20:59.313 --> 00:21:00.750\notherwise they're not gonna come up.\n\n416\n00:21:00.750 --> 00:21:06.070\nSo, let me just get a trunk fired up and\n\n417\n00:21:06.070 --> 00:21:09.570\nthat way we'll see to those.\n\n418\n00:21:09.570 --> 00:21:12.070\nRemember, in order for\na VLAN interface to come up,\n\n419\n00:21:12.070 --> 00:21:15.490\nit has to have at least one physical\ninterface that's up and tied to it.\n\n420\n00:21:15.490 --> 00:21:18.441\nIf all the physical interfaces are down,\nthe VLAN interface goes down.\n\n421\n00:21:18.441 --> 00:21:23.880\nSo if I bring up something like a trunk,\nwell that's gonna allow it to come up.\n\n422\n00:21:23.880 --> 00:21:26.550\nAnd when the trunk comes up,\nall the V line interfaces come up.\n\n423\n00:21:26.550 --> 00:21:29.590\nSo I'm just gonna whip\nthat up real quick and\n\n424\n00:21:29.590 --> 00:21:33.730\nwe should see that change here just in\na moment as soon as that negotiates out.\n\n425\n00:21:33.730 --> 00:21:37.530\nNow, when each of these come up,\nassuming routing is turned on,\n\n426\n00:21:37.530 --> 00:21:38.520\nwe should be in business.\n\n427\n00:21:38.520 --> 00:21:42.210\nAnd when I say routing is turned\non I mean that IP Routing command.\n\n428\n00:21:42.210 --> 00:21:42.750\nOkay?\n\n429\n00:21:42.750 --> 00:21:43.970\nGotta issue ip routing.\n\n430\n00:21:43.970 --> 00:21:47.790\nIf you're doing IPv6, it would be IPv6\nunicash dash routing is the command.\n\n431\n00:21:47.790 --> 00:21:51.530\nAnd then that's gonna get it enabled,\nand now we're acting as a router.\n\n432\n00:21:51.530 --> 00:21:53.190\nAnd you can verify that pretty easy.\n\n433\n00:21:53.190 --> 00:21:56.880\nIf routing is not turned on,\nwhen you run show ip route.\n\n434\n00:21:56.880 --> 00:21:59.610\nYou'll just get a simple line message\nletting you know that routing\n\n435\n00:21:59.610 --> 00:22:00.470\nis not enabled.\n\n436\n00:22:00.470 --> 00:22:04.010\nBut if routing is enabled, you'll see this\nbig table where you see your networks,\n\n437\n00:22:04.010 --> 00:22:07.080\nnetworks that you're connected to and\nthey each kinda pop up, all right.\n\n438\n00:22:07.080 --> 00:22:08.862\nSo I'm starting to see\nsome of the networks.\n\n439\n00:22:08.862 --> 00:22:10.665\nThere's a vlan 2 that kind of came up,\n\n440\n00:22:10.665 --> 00:22:13.865\nvlan 1 is up, vlan 3 is not up,\ntrunks probably.\n\n441\n00:22:13.865 --> 00:22:18.255\nOh, the other side doesn't know about\nVLAN 3 yet, so I'm not running VTP.\n\n442\n00:22:18.255 --> 00:22:20.595\nIf I were to set a VTP domain, and\n\n443\n00:22:20.595 --> 00:22:25.215\nstart to configure all that,\nthen we would start to see that happen.\n\n444\n00:22:25.215 --> 00:22:28.600\nAll right, so\nOnce those are configured I'm not routing.\n\n445\n00:22:28.600 --> 00:22:30.130\nI'm routing in between those.\n\n446\n00:22:30.130 --> 00:22:32.400\nAnd I can start to treat this as a router.\n\n447\n00:22:32.400 --> 00:22:35.640\nJust instead of physical interfaces\nI'm using the VLAN interfaces, right?\n\n448\n00:22:35.640 --> 00:22:39.970\nSo, I can do things like\nsay router ospf 1 and\n\n449\n00:22:39.970 --> 00:22:42.190\nspecify the network\nthat I wanna advertise.\n\n450\n00:22:42.190 --> 00:22:44.810\nMaybe I wanna do all of them, right?\n\n451\n00:22:44.810 --> 00:22:47.540\nAnd I'll just throw them\nall into area zero.\n\n452\n00:22:47.540 --> 00:22:49.566\nSo, now I'm running ospf, and\n\n453\n00:22:49.566 --> 00:22:53.230\nI'm advertising all my\nnetworks in the area zero.\n\n454\n00:22:53.230 --> 00:22:56.300\nAnd now I can start exchanging\nroutes with other devices.\n\n455\n00:22:56.300 --> 00:23:01.285\nDo I still have the connection with\nthat router, or did I mess it up?\n\n456\n00:23:01.285 --> 00:23:04.390\n[LAUGH] I was messing around\nwith this other router.\n\n457\n00:23:04.390 --> 00:23:05.190\nWhich one was that?\n\n458\n00:23:05.190 --> 00:23:08.420\nEdge one I don't know,\nwe can use one of these guys.\n\n459\n00:23:08.420 --> 00:23:10.700\nI've got enough letters lane around here.\n\n460\n00:23:10.700 --> 00:23:15.390\nSo, this guy has a connection to the core,\nall right.\n\n461\n00:23:15.390 --> 00:23:18.820\nAnd so,\nit's connected on that VLAN 1 network.\n\n462\n00:23:18.820 --> 00:23:22.290\nIf I were to create some other networks\non this guy and start to show him,\n\n463\n00:23:22.290 --> 00:23:25.730\nwe could start to kinda push that.\n\n464\n00:23:25.730 --> 00:23:27.690\nSo, this guy's putting in several\ndifferent networks, right?\n\n465\n00:23:27.690 --> 00:23:29.720\nOh, this is the one I was\nworking with earlier.\n\n466\n00:23:29.720 --> 00:23:32.890\n16, 17, 18, all these different\nnetworks that I'm connected to.\n\n467\n00:23:32.890 --> 00:23:34.740\nSo, this guy can start to run ospf and\n\n468\n00:23:34.740 --> 00:23:37.690\nwe should start exchanging\nroutes with the switch, right?\n\n469\n00:23:37.690 --> 00:23:41.810\nSo, if I do a router ospf 1, and I'll\njust advertise all of my networks here,\n\n470\n00:23:43.610 --> 00:23:45.922\nand throw all that into area zero.\n\n471\n00:23:45.922 --> 00:23:50.002\nAll right, so that one is gonna start\ngoing and I should be seeing the switch.\n\n472\n00:23:50.002 --> 00:23:51.910\nThe switch and I are both running ospf and\n\n473\n00:23:51.910 --> 00:23:55.338\nwe should start to build a neighbor\nrelationship assuming that I've got\n\n474\n00:23:55.338 --> 00:23:58.040\nconnectivity,which I\nshould as I start typing.\n\n475\n00:23:58.040 --> 00:24:00.110\nYou can see my adjacency just came up.\n\n476\n00:24:00.110 --> 00:24:01.927\nSo if I do a show ip ospf nei,\n\n477\n00:24:01.927 --> 00:24:07.470\nI can see that I am spotting another\nswitch that's out there, a router, right?\n\n478\n00:24:07.470 --> 00:24:08.630\nI see it as a router here.\n\n479\n00:24:08.630 --> 00:24:09.850\nI don't see it as a switch.\n\n480\n00:24:09.850 --> 00:24:12.950\nCuz it is functionally\nacting like a router.\n\n481\n00:24:12.950 --> 00:24:17.100\nAnd if I do a show ip route, let's\nsee if I've learned anything from it.\n\n482\n00:24:17.100 --> 00:24:19.047\nAnd I can see that I've learned,\n\n483\n00:24:19.047 --> 00:24:24.390\nthat 192.168.2 that I made a few moments\nago, I'm learning that via ospf.\n\n484\n00:24:24.390 --> 00:24:26.060\nNow that's here on my router.\n\n485\n00:24:26.060 --> 00:24:27.980\nThe same thing's happening\nin the opposite direction.\n\n486\n00:24:27.980 --> 00:24:29.580\nIf I jump over to the switch,\n\n487\n00:24:29.580 --> 00:24:33.330\nthe switch is now learning about\nthese other networks also.\n\n488\n00:24:33.330 --> 00:24:37.850\nAnd if I get on the right switch,\nwe should be able to see that.\n\n489\n00:24:37.850 --> 00:24:41.462\nWith little show ip ospf nei, so\nthere's the router that I'm seeing.\n\n490\n00:24:41.462 --> 00:24:45.415\nAnd if I do a show ip route,\nwe'll see if we're learning any routes and\n\n491\n00:24:45.415 --> 00:24:50.574\nI can see that I'm learning the 172.14\nnetwork, as well as the 10.16 network,\n\n492\n00:24:50.574 --> 00:24:54.393\nso I'm learning about these other\nnetworks I'm not connected to.\n\n493\n00:24:54.393 --> 00:24:57.418\nNow I can go to the clients\non each of my VLANs and\n\n494\n00:24:57.418 --> 00:25:01.990\nI can set the clients to use\nthe switch as their default gateway.\n\n495\n00:25:01.990 --> 00:25:06.450\nAnd the switch can now route them on\nthat first leg along their journey.\n\n496\n00:25:06.450 --> 00:25:08.130\nNow, remember Cisco's multi tier model,\n\n497\n00:25:08.130 --> 00:25:12.760\nwhere you've got the access layer,\nthe distribution layer and the core layer.\n\n498\n00:25:12.760 --> 00:25:16.270\nNormally the access layer of switches\nare just layer two switches, but\n\n499\n00:25:16.270 --> 00:25:20.980\nat the distribution layer,\nthat's where we either have routers, or\n\n500\n00:25:20.980 --> 00:25:22.810\nlayer three switches.\n\n501\n00:25:22.810 --> 00:25:25.880\nAnd then at the core,\nyou typically have routers, but\n\n502\n00:25:25.880 --> 00:25:29.180\nyou can have switches if they're\nsuitable for your needs.\n\n503\n00:25:29.180 --> 00:25:32.280\nIf you're just dealing with ethernet or\nwhatever, you can have them in your core.\n\n504\n00:25:32.280 --> 00:25:34.320\nSo, that's kinda how this break down.\n\n505\n00:25:34.320 --> 00:25:37.540\nThis is what I would configure on\na distribution layer switch that\n\n506\n00:25:37.540 --> 00:25:38.750\nwas sitting in the middle of the network,\n\n507\n00:25:38.750 --> 00:25:41.420\nproviding that connectivity\nbetween the different VLANs.\n\n508\n00:25:41.420 --> 00:25:44.925\n>> Now Don, there's still a little bit\nof terminology confusion that I have.\n\n509\n00:25:44.925 --> 00:25:49.960\nThe very fact is I keep\nhearing about SVIs and BVIs.\n\n510\n00:25:49.960 --> 00:25:52.050\nWhat are they and\nwhat's the difference between them?\n\n511\n00:25:52.050 --> 00:25:56.357\n>> Yeah, so in the early days of\nlayer three switching with Cisco,\n\n512\n00:25:56.357 --> 00:25:59.680\nbasically what they had was,\nif you had a 6500,\n\n513\n00:25:59.680 --> 00:26:02.760\nyou've got a higher end switch,\nright, a chassis based switch.\n\n514\n00:26:02.760 --> 00:26:05.710\nYou had SVI's,\nthe Switch Virtual Interfaces.\n\n515\n00:26:05.710 --> 00:26:08.750\n>> And these VLAN interfaces\nthat I'm making, those are SVIs.\n\n516\n00:26:08.750 --> 00:26:11.090\nThose are switch virtual interfaces.\n\n517\n00:26:11.090 --> 00:26:17.060\nBut, they had some routers that had switch\nmodules that you'd pop into them and\n\n518\n00:26:17.060 --> 00:26:19.320\nso it was like the opposite direction.\n\n519\n00:26:19.320 --> 00:26:20.800\nInstead of sticking\na router in the switch,\n\n520\n00:26:20.800 --> 00:26:22.725\nyou were sticking a switch in your router.\n\n521\n00:26:22.725 --> 00:26:26.280\nAnd so when they did that, they used\ndelineate between that by calling\n\n522\n00:26:26.280 --> 00:26:28.670\nthem BVIs, Bridge Virtual Interfaces.\n\n523\n00:26:28.670 --> 00:26:33.060\nWell, remember that a bridge and\na switch are basically the same thing.\n\n524\n00:26:33.060 --> 00:26:35.880\nIt used to be a little different,\nwhere a bridge only had two ports,\n\n525\n00:26:35.880 --> 00:26:37.890\nI'm talking about back in the 1980s.\n\n526\n00:26:37.890 --> 00:26:40.680\nNow bridges and\nswitches are effectively identical.\n\n527\n00:26:40.680 --> 00:26:44.030\nAnd so Cisco's kinda moved away\nfrom from that BVI terminology and\n\n528\n00:26:44.030 --> 00:26:45.750\nnow they're just called SVIs.\n\n529\n00:26:45.750 --> 00:26:48.850\nBut you'll still see that\nterminology every now and then.\n\n530\n00:26:48.850 --> 00:26:51.150\nI'm not sure if I actually\nsee it on this one.\n\n531\n00:26:51.150 --> 00:26:54.270\nIf I take a look at\neven like show version,\n\n532\n00:26:54.270 --> 00:26:56.320\nit's not gonna show those\nvirtual interfaces.\n\n533\n00:26:56.320 --> 00:26:57.510\nWell I guess it does.\n\n534\n00:26:57.510 --> 00:27:02.740\nThis has three virtual ethernet\ninterfaces, but it doesn't say SVI or BVI,\n\n535\n00:27:02.740 --> 00:27:06.130\nbut if you do see that terminology, you'll\nnormally see it in your debugs, right?\n\n536\n00:27:06.130 --> 00:27:09.060\nIf you're doing debug logging or whatever,\nyou might see messages about an SVI or\n\n537\n00:27:09.060 --> 00:27:11.350\nBVI coming up or going down.\n\n538\n00:27:11.350 --> 00:27:13.378\nIt's kinda like the NAT,\nwhen you turn on NAT,\n\n539\n00:27:13.378 --> 00:27:15.581\nyou get a virtual NAT\ninterface that gets created.\n\n540\n00:27:15.581 --> 00:27:20.340\nIt's the same idea, but it's just\na different terminology you might see.\n\n541\n00:27:20.340 --> 00:27:23.230\n>> All right, Don that's a lot of\ninformation right here on just layer\n\n542\n00:27:23.230 --> 00:27:24.470\nthree switching.\n\n543\n00:27:24.470 --> 00:27:27.580\nAny other things that we might\nneed to consider if we're actually\n\n544\n00:27:27.580 --> 00:27:28.360\nimplementing it?\n\n545\n00:27:28.360 --> 00:27:29.190\nYou showed us a lot,\n\n546\n00:27:29.190 --> 00:27:32.250\nbut is there any little tweaks or\nthings that we have to worry about?\n\n547\n00:27:32.250 --> 00:27:36.370\n>> The big thing to remember is, not\nevery switch supports the same features.\n\n548\n00:27:36.370 --> 00:27:38.090\nAnd it is really all over the place.\n\n549\n00:27:38.090 --> 00:27:40.740\nSo sometimes you might have\na routing protocol on one switch and\n\n550\n00:27:40.740 --> 00:27:41.980\nnot have it on another.\n\n551\n00:27:41.980 --> 00:27:44.810\nSo use the Cisco iOS feature navigator.\n\n552\n00:27:44.810 --> 00:27:47.700\nIf you've never used it, go to Cisco's\nwebsite, search for feature navigator.\n\n553\n00:27:47.700 --> 00:27:50.339\nAnd basically they have this cool\nwizard you run through where you pick\n\n554\n00:27:50.339 --> 00:27:53.569\nthe features you need, and then it'll tell\nyou if it's available on your hardware.\n\n555\n00:27:53.569 --> 00:27:55.252\nAnd if it is available of your hardware,\n\n556\n00:27:55.252 --> 00:27:58.790\nit'll tell you which version of iOS\nyou need or which license, right?\n\n557\n00:27:58.790 --> 00:28:02.208\nBecause on the 15,iOSs now, it's just\none iOS and you pay for the license for\n\n558\n00:28:02.208 --> 00:28:03.237\nthe different things.\n\n559\n00:28:03.237 --> 00:28:05.970\nSo it'll tell you what\nyou need on your device.\n\n560\n00:28:05.970 --> 00:28:10.950\nSo just be aware that it's not\nconsistent features everywhere.\n\n561\n00:28:10.950 --> 00:28:13.768\n>> What we took a look at\nin this particular episode,\n\n562\n00:28:13.768 --> 00:28:17.020\nright, was really the benefits\nof layer three switching, and\n\n563\n00:28:17.020 --> 00:28:19.660\nalso why we would actually\nwant to do it as well.\n\n564\n00:28:19.660 --> 00:28:22.040\nWe learned that even though it\nis such a great technology,\n\n565\n00:28:22.040 --> 00:28:25.560\nit really does help speed up and\ngive us more bandwidth on the back plane.\n\n566\n00:28:25.560 --> 00:28:29.280\nThe very fact is there are some\ntradeoffs that we have to be able to do.\n\n567\n00:28:29.280 --> 00:28:32.200\nWorking with layer three switching is\nprobably more common today than it ever\n\n568\n00:28:32.200 --> 00:28:35.790\nwas before, so it's a great idea to at\nleast get familiar with it if you've only\n\n569\n00:28:35.790 --> 00:28:38.120\nbeen dealing with layer\ntwo switching as well.\n\n570\n00:28:38.120 --> 00:28:41.020\nBut this is a great place for\nus to go ahead and end our episode.\n\n571\n00:28:41.020 --> 00:28:43.950\nSo signing off for\nITProTV, I'm Ronnie Wong.\n\n572\n00:28:43.950 --> 00:28:44.610\n>> And I'm Don Pezet.\n\n573\n00:28:44.610 --> 00:28:45.349\n>> And we'll see you next time.\n\n574\n00:28:45.349 --> 00:28:52.860\n[MUSIC]\n\n",
          "vimeoId": "142546757"
        }
      ],
      "title": "Infrastructure Services"
    }
  ],
  "url": "ccnp-routing-switching1",
  "vLab": false
}
