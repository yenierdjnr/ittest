{
  "description": "pfSense is a popular open source firewall solution that has many of the same features as some of the enterprise security appliances offered by many of the leading security appliance vendors.  It’s full feature set is provided free of charge.  This series was designed to introduce to our viewers the pfSense solution, demonstrate many of its features and provide some of the most essential configuration guidance to someone desiring to get pfSense working in their environment.",
  "descriptionMD": "",
  "length": "37514",
  "name": "pfSense",
  "practiceExam": false,
  "subtitle": "pfSense Build 2.2.2",
  "tagUrl": "network-admin",
  "topics": [
    {
      "episodes": [
        {
          "description": "pfSense is a popular open source firewall solution that has many of the same features as some of the enterprise security appliances offered by many of the leading security appliance vendors. It’s full feature set is provided free of charge. This series was designed to introduce to our viewers the pfSense solution, demonstrate many of its features and provide some of the most essential configuration guidance to someone desiring to get pfSense working in their environment.",
          "length": "356",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-0-0-overview-060815-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-0-0-overview-060815-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-0-0-overview-060815-1-sm.jpg",
          "title": "pfSense Overview",
          "transcript": "WEBVTT\n\n1\n00:00:00.008 --> 00:00:06.022\n[SOUND] Welcome to the ITProTV\n\n2\n00:00:06.022 --> 00:00:12.040\npfSense Text Skill series.\n\n3\n00:00:12.040 --> 00:00:16.180\nIn this series of episodes, we're gonna\nbe taking a look at the pfSense firewall.\n\n4\n00:00:16.180 --> 00:00:19.190\nAnd how we can implement that\nin our homes and businesses.\n\n5\n00:00:19.190 --> 00:00:22.780\nAnd really get a lot of great\nfunctionality out of a firewall system.\n\n6\n00:00:22.780 --> 00:00:26.810\nThat is feature by feature,\na great competitor with the big\n\n7\n00:00:26.810 --> 00:00:30.350\ncommercial vendors out there like\nCisco and Juniper and those guys.\n\n8\n00:00:30.350 --> 00:00:34.130\n>> The nice thing about the pfSense\nfirewall is really for the open-source\n\n9\n00:00:34.130 --> 00:00:37.480\ncrowd and for everybody else that's\ntrying to look for all the features.\n\n10\n00:00:37.480 --> 00:00:41.360\nBut you don't want to keep adding in and\nspending more and more money.\n\n11\n00:00:41.360 --> 00:00:43.750\nYou gonna see that pfSense\nreally is a way to go and\n\n12\n00:00:43.750 --> 00:00:45.655\nreally a nice feature set for us.\n\n13\n00:00:45.655 --> 00:00:48.690\n>> Ronnie, I know you've bumped into this,\nI bumped into it to where\n\n14\n00:00:48.690 --> 00:00:52.190\nyou go to a business and\nyou start implementing a Cisco ASA.\n\n15\n00:00:52.190 --> 00:00:55.070\nAnd then you find some feature you\nwanna use and you're like oh shoot,\n\n16\n00:00:55.070 --> 00:00:57.640\nI've gotta upgrade to the 50 user license.\n\n17\n00:00:57.640 --> 00:00:59.330\nOr the unlimited user license,\n\n18\n00:00:59.330 --> 00:01:04.250\nor the security plus license just to\nget more than two interfaces working.\n\n19\n00:01:04.250 --> 00:01:06.785\nAnd it's really frustrating and\nreally expensive.\n\n20\n00:01:06.785 --> 00:01:08.268\nPfSense on the other hand,\n\n21\n00:01:08.268 --> 00:01:12.800\nopen-source firewall part if you\ndownload it free from their website.\n\n22\n00:01:12.800 --> 00:01:15.380\nAnd all of it's functionality\nworks out of the box.\n\n23\n00:01:15.380 --> 00:01:18.570\nThat's the way they make money,\nis they make money off of support tickets.\n\n24\n00:01:18.570 --> 00:01:21.710\nIf you want commercial support\nfrom pfSense [INAUDIBLE],\n\n25\n00:01:21.710 --> 00:01:23.540\ncall them on the phone and\nthey help you out.\n\n26\n00:01:23.540 --> 00:01:24.810\nWell, you have to pay for that.\n\n27\n00:01:24.810 --> 00:01:28.016\nBut if you want community support and\nto set it up yourself,\n\n28\n00:01:28.016 --> 00:01:29.694\nthey don't charge you a dime.\n\n29\n00:01:29.694 --> 00:01:33.370\nIt doesn't matter if you have 1 user or\n10,000 users, they don't care.\n\n30\n00:01:33.370 --> 00:01:34.490\nIt will flow right through.\n\n31\n00:01:34.490 --> 00:01:36.040\nIt is a great firewall system.\n\n32\n00:01:36.040 --> 00:01:37.650\nI've used it in a number of locations.\n\n33\n00:01:37.650 --> 00:01:38.580\nRon, you use it too.\n\n34\n00:01:38.580 --> 00:01:39.320\n>> I do, yeah.\n\n35\n00:01:39.320 --> 00:01:42.248\nI've used it in a couple of\ndifferent locations that really,\n\n36\n00:01:42.248 --> 00:01:44.969\nit made more sense to go with\nthe features that we needed.\n\n37\n00:01:44.969 --> 00:01:48.520\nAnd so, I'm only willing to spend this\nmuch amount of money to be able to do so.\n\n38\n00:01:48.520 --> 00:01:52.485\nAnd I said, well you're actually taking\na look at doing a Cisco firewall.\n\n39\n00:01:52.485 --> 00:01:54.950\nAnd you're gonna have to do exactly\nwhat Don was talking about.\n\n40\n00:01:54.950 --> 00:01:56.380\nYou keep upgrading,\nall of a sudden they're like,\n\n41\n00:01:56.380 --> 00:01:58.128\nthat's a little bit out\nof our price range.\n\n42\n00:01:58.128 --> 00:01:59.320\nRecommending a pfSense and\n\n43\n00:01:59.320 --> 00:02:03.490\nsaying hey, as long as you have\na computer that can pretty much run it.\n\n44\n00:02:03.490 --> 00:02:07.120\nWe can actually go ahead and implement\nthis and have a full feature firewall set.\n\n45\n00:02:07.120 --> 00:02:10.340\n>> A couple of neat features about pfSense\nthat will make you want to choose it as\n\n46\n00:02:10.340 --> 00:02:11.410\na firewall.\n\n47\n00:02:11.410 --> 00:02:12.460\nIt is free right?\n\n48\n00:02:12.460 --> 00:02:13.310\nThat's pretty cool.\n\n49\n00:02:13.310 --> 00:02:16.740\n>> A big one\n>> It runs on top of FreeBSD, which is\n\n50\n00:02:16.740 --> 00:02:21.090\na Unix-based operating system that's\ndesigned to run on standard hardware.\n\n51\n00:02:21.090 --> 00:02:23.270\nSo if you wanna buy a firewall appliance,\n\n52\n00:02:23.270 --> 00:02:25.210\nsomething as dedicated as a firewall,\nyou can.\n\n53\n00:02:25.210 --> 00:02:27.560\nAnd you can buy them with pfSense on them.\n\n54\n00:02:27.560 --> 00:02:32.300\nOr if you want, you can just take\na regular PC, a server, a one use server.\n\n55\n00:02:32.300 --> 00:02:34.050\nOr even a desktop, you have laying around.\n\n56\n00:02:34.050 --> 00:02:35.960\nI've done it on old laptops before.\n\n57\n00:02:35.960 --> 00:02:39.430\nAnd you can throw pfSense right on there,\ncuz it supports standard hardware.\n\n58\n00:02:39.430 --> 00:02:43.140\n64-bit and 32-bit,\nyou can throw it on there.\n\n59\n00:02:43.140 --> 00:02:47.090\nIt's really pretty flexible for\nthat and that's something that's nice.\n\n60\n00:02:47.090 --> 00:02:50.930\nAnother nice feature is\nthe web-based user interface, right?\n\n61\n00:02:50.930 --> 00:02:53.732\nWe keep singling out Cisco,\nwhich I feel a little bad about it.\n\n62\n00:02:53.732 --> 00:02:55.770\n>> [LAUGH]\n>> Cuz Cisco does make great equipment.\n\n63\n00:02:55.770 --> 00:02:59.870\nBut if you wanna manage a Cisco firewall,\nyou've either got the command-line.\n\n64\n00:02:59.870 --> 00:03:04.816\nOr you've got their Java standalone\ninterface for which is really unpleasant.\n\n65\n00:03:04.816 --> 00:03:07.030\nI mean, just running Java is unpleasant.\n\n66\n00:03:07.030 --> 00:03:08.380\nWith pfSense, it's just a webpage.\n\n67\n00:03:08.380 --> 00:03:10.280\nBrowse this webpage,\nyou punch in your config.\n\n68\n00:03:10.280 --> 00:03:12.810\nYou do have the command-line also,\nif you wanna go that route.\n\n69\n00:03:12.810 --> 00:03:16.270\nIt's very flexible,\nlots of possibilities in there.\n\n70\n00:03:16.270 --> 00:03:18.100\nIt's a great solution.\n\n71\n00:03:18.100 --> 00:03:20.470\n>> Unlike [LAUGH], again picking on Cisco,\n>> [LAUGH]\n\n72\n00:03:20.470 --> 00:03:21.120\n>> A little bit, but\n\n73\n00:03:21.120 --> 00:03:24.300\nunlike setting up that\ninitial Cisco firewall,\n\n74\n00:03:24.300 --> 00:03:27.084\nbeing able to just install the pfSense.\n\n75\n00:03:27.084 --> 00:03:29.750\nAnd then at the very end once\nit's installed, it says, hey,\n\n76\n00:03:29.750 --> 00:03:31.970\nthis is how you connect and\nbegin to configure it.\n\n77\n00:03:31.970 --> 00:03:34.140\nYou can have the pfSense\nfirewall actually up and\n\n78\n00:03:34.140 --> 00:03:36.600\nrunning, probably within half an hour.\n\n79\n00:03:36.600 --> 00:03:38.310\n>> Easy.\n>> And now you're actually just\n\n80\n00:03:38.310 --> 00:03:39.710\ntweaking all your settings.\n\n81\n00:03:39.710 --> 00:03:42.780\nAnd so the ease of usage,\nthe ability for someone to say,\n\n82\n00:03:42.780 --> 00:03:44.730\nall right,\nI can feel comfortable with this.\n\n83\n00:03:44.730 --> 00:03:46.770\nIt's incredibly easy in pfSense.\n\n84\n00:03:46.770 --> 00:03:49.120\n>> All right, so\nwhat are we gonna cover in this series?\n\n85\n00:03:49.120 --> 00:03:51.120\nWell, if you stay tuned to\nwatch our pfSense series.\n\n86\n00:03:51.120 --> 00:03:55.552\nWe're gonna show how to get a copy of\npfSense, how to install it on hardware.\n\n87\n00:03:55.552 --> 00:03:57.520\nCuz there's are a couple of\ndifferent methods you can go.\n\n88\n00:03:57.520 --> 00:04:00.340\nWe'll walk through each of\nthe different ways to get it installed.\n\n89\n00:04:00.340 --> 00:04:01.420\nAnd then once it's up and running,\n\n90\n00:04:01.420 --> 00:04:04.290\nwe're gonna run through\nsome basic routing setup.\n\n91\n00:04:04.290 --> 00:04:06.340\nWe'll show how to do\nfirewall filter rules.\n\n92\n00:04:06.340 --> 00:04:09.110\nCuz it is a firewall,\nyou probably wanna do that.\n\n93\n00:04:09.110 --> 00:04:12.320\nWe'll also take a look at Network adress\ntranslation, which is pretty important,\n\n94\n00:04:12.320 --> 00:04:13.970\nas well as port forwarding.\n\n95\n00:04:13.970 --> 00:04:16.335\nAnd we're gonna take a look at VPN setups.\n\n96\n00:04:16.335 --> 00:04:19.030\nSite-to-site VPNs for connecting offices,\n\n97\n00:04:19.030 --> 00:04:23.510\nas well as just regular remote access\nVPNs to allow your traveling users.\n\n98\n00:04:23.510 --> 00:04:26.620\nYour people that are out in the field\nto be able to connect back in and\n\n99\n00:04:26.620 --> 00:04:27.930\nwork with the system.\n\n100\n00:04:27.930 --> 00:04:30.970\nIt's all functionality that's\nbaked right into pfSense.\n\n101\n00:04:32.110 --> 00:04:33.190\nTowards the end of the series,\n\n102\n00:04:33.190 --> 00:04:36.250\nwe're gonna take a look at some of\nthe packages we can install in pfSense.\n\n103\n00:04:36.250 --> 00:04:39.370\nNow this is something that sets\npfSense aside from other firewalls.\n\n104\n00:04:39.370 --> 00:04:42.130\nThe packages, it's third-party\nsoftware that we can load and\n\n105\n00:04:42.130 --> 00:04:43.870\nrun right from our firewall.\n\n106\n00:04:43.870 --> 00:04:46.760\nAnd there's a wide range of\npackages that are out there.\n\n107\n00:04:46.760 --> 00:04:51.685\nFrom advanced reporting services,\nto proxy and web filtering services.\n\n108\n00:04:51.685 --> 00:04:54.560\nThere's all sorts of\nneat little gadgets and\n\n109\n00:04:54.560 --> 00:04:58.150\nstuff that you can install there to make\nyour firewall do some really cool stuff.\n\n110\n00:04:58.150 --> 00:05:00.540\nThat you normally would have\nto have a separate device for.\n\n111\n00:05:00.540 --> 00:05:01.910\nHere we can kind of wrap it all together.\n\n112\n00:05:02.940 --> 00:05:06.230\nSo a lot of different choices,\na lot of different flexibility.\n\n113\n00:05:06.230 --> 00:05:08.107\nIt's a great system to use.\n\n114\n00:05:08.107 --> 00:05:10.786\nSo definitely something that\nyou'll wanna check out,\n\n115\n00:05:10.786 --> 00:05:12.500\nif that sounds interesting to you.\n\n116\n00:05:12.500 --> 00:05:15.670\nSounds like something you wanna learn more\nabout, then you're in the right place.\n\n117\n00:05:15.670 --> 00:05:19.160\nStay tuned cuz we've got our\npfSense series coming up.\n\n118\n00:05:19.160 --> 00:05:22.890\nIf you're a die hard Cisco fan and that's\nthe route you wanna go or Juniper or\n\n119\n00:05:22.890 --> 00:05:23.850\nthe other guys.\n\n120\n00:05:23.850 --> 00:05:27.230\nWell, the concepts that we cover\nover these next several episodes,\n\n121\n00:05:27.230 --> 00:05:28.940\nthey really apply to any firewall, right?\n\n122\n00:05:28.940 --> 00:05:31.070\nAll the firewalls basically work the same.\n\n123\n00:05:31.070 --> 00:05:32.540\nIt's just the implementation is different.\n\n124\n00:05:32.540 --> 00:05:34.290\nThe commands, the web interface.\n\n125\n00:05:34.290 --> 00:05:38.140\nBut remember at ITProTV, you have access\nto the whole library with your account.\n\n126\n00:05:38.140 --> 00:05:41.280\nSo you can jump over to the Cisco\nshows and check those out.\n\n127\n00:05:41.280 --> 00:05:43.710\nOr whatever other resource it\nis that you wanna use there.\n\n128\n00:05:43.710 --> 00:05:46.430\nBut if you wanna learn about pfSense,\nyou're in the right place.\n\n129\n00:05:46.430 --> 00:05:49.176\nStay tuned,\nwe've got pfSense episodes coming up.\n\n130\n00:05:49.176 --> 00:05:55.539\n>> [MUSIC]\n\n",
          "vimeoId": "130220843"
        },
        {
          "description": null,
          "length": "1442",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-1-obtaining_pfsense-060815-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-1-obtaining_pfsense-060815-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-1-obtaining_pfsense-060815-1-sm.jpg",
          "title": "Obtaining pfSense",
          "transcript": "WEBVTT\n\n1\n00:00:00.025 --> 00:00:07.622\n[MUSIC]\n\n2\n00:00:07.622 --> 00:00:10.820\nIn this segment, we're gonna take\na look at obtaining pfSense.\n\n3\n00:00:10.820 --> 00:00:13.320\nAnd by obtaining,\nI mean downloading it, right?\n\n4\n00:00:13.320 --> 00:00:14.570\nAnd you might ask yourself,\n\n5\n00:00:14.570 --> 00:00:16.960\ndo we really need to film a segment\non how to download software?\n\n6\n00:00:16.960 --> 00:00:20.640\nDon't you just go to the website and\nclick a button, well yes and no.\n\n7\n00:00:20.640 --> 00:00:23.900\nYes, you do go to the website and you\nclick a download link and it downloads it.\n\n8\n00:00:23.900 --> 00:00:26.050\nBut no, it's not that straight forward.\n\n9\n00:00:26.050 --> 00:00:29.890\nThere's actually several\ndifferent versions of pfSence.\n\n10\n00:00:29.890 --> 00:00:33.860\nAnd if you get the wrong one,\nit can cause some real problems.\n\n11\n00:00:33.860 --> 00:00:35.360\nIt may not install at all.\n\n12\n00:00:35.360 --> 00:00:37.210\nRight, that would be a pretty obvious one.\n\n13\n00:00:37.210 --> 00:00:39.910\nBut other times it might\nactually install for you and\n\n14\n00:00:39.910 --> 00:00:44.060\nrun just fine until later on down the road\nand you find out something's missing and\n\n15\n00:00:44.060 --> 00:00:46.810\nthere's no easy way to move\nbetween the different versions.\n\n16\n00:00:46.810 --> 00:00:49.282\nYou end up having to format your\nfirewall and start over again.\n\n17\n00:00:49.282 --> 00:00:53.807\nSo, we wanna help you avoid that mistake\nby choosing the right edition of pfSense\n\n18\n00:00:53.807 --> 00:00:55.790\nfrom the very beginning.\n\n19\n00:00:55.790 --> 00:00:58.240\n>> When you start taking a look\nat pfSense on the download,\n\n20\n00:00:58.240 --> 00:01:00.920\nyou're probably gonna say, oh,\nthis is easy, I just know exactly which\n\n21\n00:01:00.920 --> 00:01:04.870\none you wanna pick, until you see the list\nthat you have a chance to choose from.\n\n22\n00:01:06.080 --> 00:01:08.608\nWell then, at that point,\nthat's when it really becomes confusing.\n\n23\n00:01:08.608 --> 00:01:11.080\nSo I wanna make sure that you\nactually do have a sense and\n\n24\n00:01:11.080 --> 00:01:13.500\nunderstanding, some of the different\nchoices that you have, and\n\n25\n00:01:13.500 --> 00:01:15.360\nwhich one's going to be the right one for\nyou.\n\n26\n00:01:15.360 --> 00:01:18.210\n>> Yeah, now they recently updated\nthe pfSense homepage to make this\n\n27\n00:01:18.210 --> 00:01:20.120\nprocess a lot easier.\n\n28\n00:01:20.120 --> 00:01:23.810\nI've got the homepage pulled up right here\non my system, and basically when you go to\n\n29\n00:01:23.810 --> 00:01:27.090\ntheir website, you'll see a nice big red\nbutton here with the Download Now, and\n\n30\n00:01:27.090 --> 00:01:29.610\nmy head's kinda covering it,\nbut there we go.\n\n31\n00:01:29.610 --> 00:01:30.480\nDownload Now.\n\n32\n00:01:30.480 --> 00:01:35.194\nAnd you can click on that, and it takes\nyou to kind of this simpler-ish page.\n\n33\n00:01:35.194 --> 00:01:39.100\nRight, [LAUGH] where we have a few\nchoices about what we wanna pick.\n\n34\n00:01:39.100 --> 00:01:44.090\nNow my choices here all stem\nfrom what version I wanna get.\n\n35\n00:01:44.090 --> 00:01:47.630\nDo I wanna get 2.2.2 INSTALL,\nor 2.2.2 UPGRADE?\n\n36\n00:01:47.630 --> 00:01:50.060\nNow that's pretty self-explanatory.\n\n37\n00:01:50.060 --> 00:01:53.690\nIf you've already got a pfSense firewall\nup and running and you're gonna upgrade,\n\n38\n00:01:53.690 --> 00:01:55.440\nyou need the UPGRADE edition.\n\n39\n00:01:55.440 --> 00:01:59.980\nNow, I've never actually used that,\nbecause you can do an in place upgrade\n\n40\n00:01:59.980 --> 00:02:02.240\nright from the web management\nportal of the firewall.\n\n41\n00:02:02.240 --> 00:02:04.710\nAnd that's way easier than\ndoing it from right here.\n\n42\n00:02:04.710 --> 00:02:06.780\nSo, normally,\nwe don't bother with that download.\n\n43\n00:02:06.780 --> 00:02:11.820\nBut right beside it, we have the 2.2.2\ninstall, and that's what we normally want.\n\n44\n00:02:11.820 --> 00:02:13.640\nThere are other downloads available.\n\n45\n00:02:13.640 --> 00:02:16.088\nIf you scroll down,\nyou'll see DAILY SNAPSHOTS.\n\n46\n00:02:16.088 --> 00:02:21.010\nPfSense is a open source, so anybody can\nedit the source code and publish changes.\n\n47\n00:02:21.010 --> 00:02:24.340\nAnd new changes happen every single day.\n\n48\n00:02:24.340 --> 00:02:28.380\nBut, they haven't all been tested and\nvetted they're not all cleared for\n\n49\n00:02:28.380 --> 00:02:29.760\nproduction use yet.\n\n50\n00:02:29.760 --> 00:02:32.830\nSo if you want the latest and greatest\nwith all the cutting-edge changes,\n\n51\n00:02:32.830 --> 00:02:34.510\nyou can do that daily snapshot.\n\n52\n00:02:34.510 --> 00:02:38.762\nBut if you want the latest stable, the one\nthat's been tested that's safe to run,\n\n53\n00:02:38.762 --> 00:02:42.346\nit's this guy right up here and\nthe current version as of the filming in\n\n54\n00:02:42.346 --> 00:02:45.200\nthis episode is 2.2.2 by\nthe time you download it,\n\n55\n00:02:45.200 --> 00:02:48.204\nit might be 2.2.3 or\n2.3 might be out, who knows.\n\n56\n00:02:48.204 --> 00:02:48.704\nRIght, new versions come out all the time.\n\n57\n00:02:49.750 --> 00:02:52.190\n>> Now Don I'm seeing a link there for\nsource code.\n\n58\n00:02:52.190 --> 00:02:53.810\nWhen would I choose that?\n\n59\n00:02:53.810 --> 00:02:56.490\n>> Well it's open source, right?\n\n60\n00:02:56.490 --> 00:03:00.220\nIf you want to create some\nnew functionality in pfSense,\n\n61\n00:03:00.220 --> 00:03:03.490\nyou can download the source code, modify\nit and push it back up to them, right?\n\n62\n00:03:03.490 --> 00:03:06.150\nAnd become part of\nthe daily snapshot process.\n\n63\n00:03:06.150 --> 00:03:10.740\nOr, if we're deploying this\nas our security device,\n\n64\n00:03:10.740 --> 00:03:13.300\nwe don't know who wrote this software,\nwe don't know,\n\n65\n00:03:13.300 --> 00:03:16.910\nI can't name a single source that\nworks at the pfSense organization.\n\n66\n00:03:16.910 --> 00:03:18.370\nHow do we know we can trust it?\n\n67\n00:03:18.370 --> 00:03:21.060\nWe can download that source code and\nwe can review all\n\n68\n00:03:21.060 --> 00:03:24.410\nthe programming code that was written and\nmake sure there's no back door or\n\n69\n00:03:24.410 --> 00:03:27.030\nanything like that, that's put into\nthe system that we're unaware of.\n\n70\n00:03:27.030 --> 00:03:27.790\nSo it's all right there.\n\n71\n00:03:27.790 --> 00:03:28.610\nIt's available.\n\n72\n00:03:28.610 --> 00:03:30.795\nIt's all covered under\nan open source license, and\n\n73\n00:03:30.795 --> 00:03:33.645\nso that's it, it's published,\nyou get the whole thing right there.\n\n74\n00:03:35.045 --> 00:03:38.695\nAll right, well, for us, we're gonna\nbe doing the 2.2.2 stable version, so\n\n75\n00:03:38.695 --> 00:03:40.015\nI'll click on that.\n\n76\n00:03:40.015 --> 00:03:44.510\nAnd now, we get a screen that is so\nmuch more useful than the old way.\n\n77\n00:03:44.510 --> 00:03:50.190\nWhat used to happen was when you clicked\non that link you'd get basically this.\n\n78\n00:03:50.190 --> 00:03:53.690\nA big list of all of the images\nthat you could download.\n\n79\n00:03:53.690 --> 00:03:55.300\nAnd it's quite a list, right?\n\n80\n00:03:55.300 --> 00:03:57.180\nThere's quite a bit of stuff in here.\n\n81\n00:03:57.180 --> 00:03:59.810\nEach one has a little bit\ndifferent meaning to it,\n\n82\n00:03:59.810 --> 00:04:01.740\nwhich I'll talk about here in a moment.\n\n83\n00:04:01.740 --> 00:04:04.690\nBut now, back here on the pfSense page,\n\n84\n00:04:04.690 --> 00:04:08.730\nwhen you go to download It simplifies\nthat, and it allows you to answer just\n\n85\n00:04:08.730 --> 00:04:12.060\na couple of basic questions to\nget you to the right decision.\n\n86\n00:04:12.060 --> 00:04:17.211\nThe first choice we have to make is\nwhether we want to be 32-bit or 64-bit.\n\n87\n00:04:17.211 --> 00:04:17.940\nAll right.\n\n88\n00:04:17.940 --> 00:04:22.819\nThere's one more option down there if\nyou have one of the dedicated pfSense\n\n89\n00:04:22.819 --> 00:04:26.768\nappliances, you can choose that\nNetgate ADI image, but for\n\n90\n00:04:26.768 --> 00:04:32.190\nmost of us we're running on standard\nIntel hardware, you can choose the 64-bit\n\n91\n00:04:32.190 --> 00:04:36.777\nimage if you've got a 64-bit processor,\nor the 32-bit image.\n\n92\n00:04:36.777 --> 00:04:40.499\nNow we were talking a little bit about\nthis before the show because I made\n\n93\n00:04:40.499 --> 00:04:44.780\nthe comment that, if you don't have more\nthan 4-gigs of RAM, there's not a ton\n\n94\n00:04:44.780 --> 00:04:48.647\nof benefit going with 64-bit, so\nyou could really go with either one.\n\n95\n00:04:48.647 --> 00:04:49.390\nRight?\n\n96\n00:04:49.390 --> 00:04:52.940\nBut if you have more than 4-gigs of RAM,\nyou've gotta go with the 64-bit version or\n\n97\n00:04:52.940 --> 00:04:56.660\nyou're not gonna be able to take advantage\nof all that extra memory in the same way\n\n98\n00:04:56.660 --> 00:04:58.270\nthat you can with the 64-bit version.\n\n99\n00:04:58.270 --> 00:05:00.640\nSo you definitely want that one.\n\n100\n00:05:00.640 --> 00:05:04.630\nNow I said, [LAUGH] this is\nall before the show, I said.\n\n101\n00:05:04.630 --> 00:05:08.300\nWell, if you have less than 4 gigs, you\nmight as well just do the 32-bit version.\n\n102\n00:05:08.300 --> 00:05:11.710\nThat used to always be considered\nthe more stable of the two.\n\n103\n00:05:11.710 --> 00:05:14.000\nBut Ron, you pointed out that's\nnot the case anymore, right?\n\n104\n00:05:14.000 --> 00:05:17.970\n>> Right, if you actually do go to\nthe pfSense forums and you take a look,\n\n105\n00:05:17.970 --> 00:05:21.630\neven pfSense, the people that are working\nwith them, do recommend that at any time,\n\n106\n00:05:21.630 --> 00:05:27.220\nif you have that opportunity, run with the\n64-bit if your hardware will support it.\n\n107\n00:05:27.220 --> 00:05:30.680\nAs long as your CPU will support it and\nyou have the hardware that's there and\n\n108\n00:05:30.680 --> 00:05:34.820\nyou have the extra RAM, you should go\nahead and run at least the 64-bit version.\n\n109\n00:05:34.820 --> 00:05:36.930\n>> Yeah, and that's why they've\nadded this note down here that says,\n\n110\n00:05:36.930 --> 00:05:42.370\nif your system has a 64-bit capable Intel\nor AMD CPU, use the 64-bit version one.\n\n111\n00:05:42.370 --> 00:05:45.560\n>> Only use the 32-bit one if\nyou just have a 32-bit CPU.\n\n112\n00:05:45.560 --> 00:05:50.104\nWhat that means, is that means that they\nare actively developing under the 64-bit\n\n113\n00:05:50.104 --> 00:05:52.199\ncode and then cross compiling to 32.\n\n114\n00:05:52.199 --> 00:05:54.480\nThat means 64-bit is now\nthe more stable versions.\n\n115\n00:05:54.480 --> 00:05:58.546\nSo, even if you have 1 gig of ram,\nif you have a 64-bit CPU go ahead and\n\n116\n00:05:58.546 --> 00:05:59.290\ndo that one.\n\n117\n00:06:00.790 --> 00:06:01.430\nAll right.\n\n118\n00:06:01.430 --> 00:06:06.030\nSo when I choose that 64-bit, now,\nthe little menu here is gonna expand\n\n119\n00:06:06.030 --> 00:06:09.830\nout a little bit, and it's gonna give\nme an option to choose my platform.\n\n120\n00:06:09.830 --> 00:06:13.020\nNow, platform can be\na little bit confusing and\n\n121\n00:06:13.020 --> 00:06:14.790\nit's kinda shrinking my window a bit here.\n\n122\n00:06:14.790 --> 00:06:16.740\nLet me see if I can make that.\n\n123\n00:06:16.740 --> 00:06:17.560\nThere we go.\n\n124\n00:06:17.560 --> 00:06:21.080\nSo we get three choices when we go for\nchoosing a Platform.\n\n125\n00:06:21.080 --> 00:06:25.686\nLive CD with Installer, Live CD with\nInstaller on a USB Memory stick, or\n\n126\n00:06:25.686 --> 00:06:29.702\nEmbedded NanoBSD typically with CF,\nwhich is compact flash.\n\n127\n00:06:29.702 --> 00:06:30.701\nAll right.\n\n128\n00:06:30.701 --> 00:06:32.420\nNow, let's talk a little\nbit about each of these.\n\n129\n00:06:32.420 --> 00:06:33.870\nRunning a Live CD with Installer.\n\n130\n00:06:33.870 --> 00:06:34.540\nWhat's that?\n\n131\n00:06:34.540 --> 00:06:38.270\n>> When you go ahead and download from\npfSense the installer, they can go ahead\n\n132\n00:06:38.270 --> 00:06:42.380\nand download in that format that will\nallow you to run it directly in RAM.\n\n133\n00:06:42.380 --> 00:06:46.570\nNow when you do that you just boot up\nto it, and from that point you can\n\n134\n00:06:46.570 --> 00:06:50.350\nrun pfSense, you can get it installed,\nyou can actually view the configuration.\n\n135\n00:06:50.350 --> 00:06:53.340\nBut at the end of the day it's not\ngonna save it into itself, but\n\n136\n00:06:53.340 --> 00:06:56.800\nthey do give you that option that will\nsave your configs to an external drive or\n\n137\n00:06:56.800 --> 00:06:58.610\nto another drive if you choose to.\n\n138\n00:06:58.610 --> 00:07:01.980\nBut if you reboot the system you're\ngonna always have to load that backup.\n\n139\n00:07:01.980 --> 00:07:05.033\nNow the nice thing is that it actually\nsays with an installer, so there\n\n140\n00:07:05.033 --> 00:07:08.553\ncomes a point when you actually do look\nduring the install process that says hey,\n\n141\n00:07:08.553 --> 00:07:11.800\nyou have to press the letter I here if\nyou wanna start the install process.\n\n142\n00:07:11.800 --> 00:07:15.500\nIf not, it would just boot up into RAM and\nyou'll just be running pfSense.\n\n143\n00:07:15.500 --> 00:07:16.060\n>> Yeah.\n\n144\n00:07:16.060 --> 00:07:20.431\nNow, what you're downloading there is\nactually an ISO image of a CD, so you\n\n145\n00:07:20.431 --> 00:07:25.302\ndownload the ISO image, and then you burn\nit to a CD drive that's an important step.\n\n146\n00:07:25.302 --> 00:07:26.972\nAnd for lot of people,\nthat's what they want.\n\n147\n00:07:26.972 --> 00:07:29.150\nThey wanna boot from that CD drive and\ninstall it.\n\n148\n00:07:29.150 --> 00:07:32.000\nBut if you just wanna test drive pfSense,\nif you just wanna try it out,\n\n149\n00:07:32.000 --> 00:07:35.170\nyou can boot right from that CD,\ngo right into pfSense and\n\n150\n00:07:35.170 --> 00:07:37.500\ntry it out, and\nit doesn't mess with your hard drives.\n\n151\n00:07:37.500 --> 00:07:40.840\nBut if you choose the installation option\nthen it does mess with your hard drives.\n\n152\n00:07:40.840 --> 00:07:42.620\nThen it formats it and\ninstalls to the hard drive.\n\n153\n00:07:42.620 --> 00:07:45.370\nAt that point you can throw the CD away\ncuz it's gonna boot from the hard drive\n\n154\n00:07:45.370 --> 00:07:46.270\nand off you go.\n\n155\n00:07:46.270 --> 00:07:49.305\nSo, for most people that's\nthe installation mechanism you wanna use.\n\n156\n00:07:49.305 --> 00:07:55.275\nBut, more and more systems today\ndon't come with the CD drive run.\n\n157\n00:07:55.275 --> 00:07:57.080\nYour laptop doesn't, my laptop doesn't.\n\n158\n00:07:57.080 --> 00:08:00.329\nThe little one used server we use\nas a firewall here at the studio,\n\n159\n00:08:00.329 --> 00:08:02.430\nit doesn't have a CD drive.\n\n160\n00:08:02.430 --> 00:08:05.230\nSo how do you install on a system\nthat doesn't have a CD drive?\n\n161\n00:08:05.230 --> 00:08:07.930\n>> Use USB key for\nyou to be able to do that.\n\n162\n00:08:07.930 --> 00:08:12.430\nAnd so, here pfSense is giving us another\noption to be able to download that same\n\n163\n00:08:12.430 --> 00:08:17.340\nimage, but this time that formatting on\nthat image is a little bit different.\n\n164\n00:08:17.340 --> 00:08:21.790\nAnd then you can take that image and end\nup transferring it over to a USB stick.\n\n165\n00:08:21.790 --> 00:08:26.060\nThat will then boot up and give you those\nsame options installing like you're\n\n166\n00:08:26.060 --> 00:08:29.200\nactually using that Live CD will boot\nup and give you a chance to run it.\n\n167\n00:08:29.200 --> 00:08:32.750\nBut then once again, if you choose to\ninstall it, you have a chance to say, hey,\n\n168\n00:08:32.750 --> 00:08:35.295\nI wanna actually not just run this,\nbut I want to install it as well.\n\n169\n00:08:35.295 --> 00:08:38.190\n>> And\nnow our last option is the neatest one.\n\n170\n00:08:38.190 --> 00:08:43.948\nIt's Embedded NanoBSD typically with CF\nand what they're talking about there is,\n\n171\n00:08:43.948 --> 00:08:48.100\nmaybe you wanna build a firewall that\ndoesn't have a hard drive, right.\n\n172\n00:08:48.100 --> 00:08:49.320\nMore of an appliance.\n\n173\n00:08:49.320 --> 00:08:51.100\nYou want a firewall that's got CPU,\n\n174\n00:08:51.100 --> 00:08:55.850\nmemory and no hard drive,\njust flash storage, right?\n\n175\n00:08:55.850 --> 00:08:58.150\nAnd it might be a compact flash\ncard running on the motherboard.\n\n176\n00:08:58.150 --> 00:09:01.010\nIt might be flashable memory\nbuilt into the motherboard,\n\n177\n00:09:01.010 --> 00:09:03.410\nlike you see in those\ndedicated firewall appliances.\n\n178\n00:09:03.410 --> 00:09:07.210\nIt might be a USB stick stuck\nin the computer, right?\n\n179\n00:09:07.210 --> 00:09:10.040\nAnd you wanna boot off of that,\ninstead of a hard drive.\n\n180\n00:09:10.040 --> 00:09:13.780\nWell, why can't we just\nuse normal pfSense or\n\n181\n00:09:13.780 --> 00:09:16.950\nour normal installer on a USB key or\nflash memory?\n\n182\n00:09:16.950 --> 00:09:19.650\nWell, the main reason is lifetime.\n\n183\n00:09:19.650 --> 00:09:23.780\nWith flash memory,\nthe more you write to a particular sector,\n\n184\n00:09:23.780 --> 00:09:26.060\nwell, the shorter its lifetime gets.\n\n185\n00:09:26.060 --> 00:09:29.170\nYou can only read and write from\nthe same spot in flash memory so\n\n186\n00:09:29.170 --> 00:09:30.943\nmany times before it wears out.\n\n187\n00:09:30.943 --> 00:09:37.915\nSo the NanoBSD installers are tuned to\nonly write to the disk when they have to.\n\n188\n00:09:37.915 --> 00:09:40.595\nAnd that really minimizes\ntheir disk writes and\n\n189\n00:09:40.595 --> 00:09:42.725\nit prolongs the life of that media.\n\n190\n00:09:42.725 --> 00:09:45.795\nSo when you have things like logs,\nwrite access logs,\n\n191\n00:09:45.795 --> 00:09:48.520\nevery time traffic passes through\nthe firewall, it's logging that.\n\n192\n00:09:48.520 --> 00:09:52.110\nWith our normal installers,\nthose logs get written to the hardrive.\n\n193\n00:09:52.110 --> 00:09:55.210\nAnd that's good, because if\nthe firewall reboots or loses power,\n\n194\n00:09:55.210 --> 00:09:56.990\nyou keep your logs.\n\n195\n00:09:56.990 --> 00:09:59.440\nBut if we're using flash memory,\n\n196\n00:09:59.440 --> 00:10:03.570\nwriting those logs to disk,\nthat's like a constant write operation.\n\n197\n00:10:03.570 --> 00:10:06.440\nAnd it's writing and writing and\nwriting and writing and writing.\n\n198\n00:10:06.440 --> 00:10:09.330\nAnd then eventually your flash fails.\n\n199\n00:10:09.330 --> 00:10:13.620\nAnd so with this, it'll keep the logs\nin RAM and it writes them to RAM.\n\n200\n00:10:13.620 --> 00:10:16.360\nNow on a positive side,\nyour flash is gonna last a lot longer.\n\n201\n00:10:16.360 --> 00:10:19.460\nOn a negative side, if you reboot\nthe firewall or if it loses power,\n\n202\n00:10:19.460 --> 00:10:20.950\nyou lose your logs, right?\n\n203\n00:10:20.950 --> 00:10:22.990\nSo, pros and cons with that.\n\n204\n00:10:22.990 --> 00:10:24.850\nWith doing the Embedded install,\n\n205\n00:10:24.850 --> 00:10:29.520\nyou get prolonged life of your hardware\nwith no need for hard drives, right?\n\n206\n00:10:29.520 --> 00:10:31.570\nInstead you use that flash memory.\n\n207\n00:10:31.570 --> 00:10:35.600\nBut it's not so good for\nthings like extensive logging.\n\n208\n00:10:35.600 --> 00:10:38.950\nAlso you'll find that some packages\naren't supported in NanoBSD,\n\n209\n00:10:38.950 --> 00:10:40.780\nyou have to have the full\nversion to do it.\n\n210\n00:10:40.780 --> 00:10:45.320\nSo if you wanna take full advantage of\neverything that pfSense has to offer,\n\n211\n00:10:45.320 --> 00:10:47.680\nyou really need to do\nthe Live CD with Installer and\n\n212\n00:10:47.680 --> 00:10:50.110\nyou need to install to a hard drive.\n\n213\n00:10:50.110 --> 00:10:50.610\nRight?\n\n214\n00:10:50.610 --> 00:10:54.000\nOr to flash memory that they\ncan handle a longer lifetime.\n\n215\n00:10:54.000 --> 00:10:57.940\nSSD with TRIM Support, that usually\nis a little bit better of an option.\n\n216\n00:10:57.940 --> 00:11:02.770\nBut if you're just looking to\nget low energy, like a fanless\n\n217\n00:11:02.770 --> 00:11:07.110\nsystem you dont want to stick a physical\nmoving hard drive in a fanless system.\n\n218\n00:11:07.110 --> 00:11:09.653\nSo in that case,\nyou'd wanna go with Embedded.\n\n219\n00:11:09.653 --> 00:11:12.680\nSo those three choices there are gonna\ntake us to our different installers.\n\n220\n00:11:12.680 --> 00:11:16.920\nNow the installers themselves,\nare basically the same,\n\n221\n00:11:16.920 --> 00:11:20.140\nexcept the first one here is\ndesigned to be written to a CD.\n\n222\n00:11:20.140 --> 00:11:24.190\nThe other two are designed to be written\nto either flash or a memory stick.\n\n223\n00:11:24.190 --> 00:11:24.840\nAll right?\n\n224\n00:11:24.840 --> 00:11:28.330\nWhen we do this Live CD with installer on\na memory stick, we're creating a memory\n\n225\n00:11:28.330 --> 00:11:32.920\nstick that we'll boot from and\nthen it'll install to another location.\n\n226\n00:11:32.920 --> 00:11:36.090\nWhen we do Embedded,\nwe're gonna write it to memory,\n\n227\n00:11:36.090 --> 00:11:38.690\nto flash memory and\nthat's the actual install.\n\n228\n00:11:38.690 --> 00:11:39.930\nIt's ready to go from that point.\n\n229\n00:11:39.930 --> 00:11:43.370\nYou don't have to do an installer\nbeyond that, so a little bit different.\n\n230\n00:11:43.370 --> 00:11:48.040\nNow that means that on that one, it has to\nknow a little bit more about the system.\n\n231\n00:11:48.040 --> 00:11:51.040\nAnd if I expand that out,\nyou'll see it asks about the Console and\n\n232\n00:11:51.040 --> 00:11:52.790\nCompact Flash card size.\n\n233\n00:11:52.790 --> 00:11:55.620\nIf I choose Live CD with Installer,\nsee what it asks about the Console but\n\n234\n00:11:55.620 --> 00:11:56.920\nnot the size?\n\n235\n00:11:56.920 --> 00:12:00.080\nOr Live CD,\nit doesn't ask about anything, right?\n\n236\n00:12:00.080 --> 00:12:03.600\nEach one has some little caveats\nthat we might need to configure.\n\n237\n00:12:03.600 --> 00:12:04.949\nLet's talk about that Console first.\n\n238\n00:12:06.090 --> 00:12:09.160\nIf I'm installing pfSense\non an actual computer,\n\n239\n00:12:09.160 --> 00:12:12.810\njust a regular full Intel or\nwhatever system.\n\n240\n00:12:12.810 --> 00:12:15.960\nI probably have a monitor, keyboard,\nmouse attached to it, right?\n\n241\n00:12:15.960 --> 00:12:18.490\nSo I can use a VGA console.\n\n242\n00:12:18.490 --> 00:12:23.160\nI can hook a VGA monitor up to it and\nactually see the output for that firewall.\n\n243\n00:12:23.160 --> 00:12:28.769\nBut if I'm installing on an appliance,\nright, just like a little box, netgate\n\n244\n00:12:28.769 --> 00:12:34.640\nis one of the bigger vendors for that cuz\nNetgate is actually what sponsors pfSense.\n\n245\n00:12:34.640 --> 00:12:38.656\nBut if we take a look at\nsome of Netgate's firewalls,\n\n246\n00:12:38.656 --> 00:12:44.208\nthey have all sorts of really cool ones\nthat you can go in and take a look at.\n\n247\n00:12:44.208 --> 00:12:47.855\nLet's see,\nwhere are the firewalls in here?\n\n248\n00:12:47.855 --> 00:12:50.125\nThere we go, like these APU4s or whatever.\n\n249\n00:12:50.125 --> 00:12:53.165\nThese little guys are just\ndedicated firewall boxes and\n\n250\n00:12:53.165 --> 00:12:56.115\nthey run pfSense on them,\nthey're very compact.\n\n251\n00:12:56.115 --> 00:13:00.385\nThere's no VGA port on that,\nI can't hook a monitor up to that to see.\n\n252\n00:13:00.385 --> 00:13:05.270\nSo if I can't see what's going on,\nwhat do I do?\n\n253\n00:13:05.270 --> 00:13:08.910\nThe other option here is to go Serial,\nthe serial port.\n\n254\n00:13:08.910 --> 00:13:12.890\nThe Console output that command-line it\nis section be output on a serial cable.\n\n255\n00:13:12.890 --> 00:13:16.590\nYou can take a laptop,\nplug in a serial cable into it and\n\n256\n00:13:16.590 --> 00:13:18.635\nactually see the output that's\ncoming across the screen.\n\n257\n00:13:18.635 --> 00:13:19.725\nRight?\n\n258\n00:13:19.725 --> 00:13:23.325\n>> The Serial option is actually one of\nthe kinda neatest options that you have\n\n259\n00:13:23.325 --> 00:13:27.390\nespecially if you work with other\nfirewalls before, like the Cisco ASA.\n\n260\n00:13:27.390 --> 00:13:30.450\nIt seems very natural as you plug\nthat device in and it actually\n\n261\n00:13:30.450 --> 00:13:33.410\nstarts scrolling across the screen,\nyou now feel a little bit more confident.\n\n262\n00:13:33.410 --> 00:13:35.040\nGo, oh, this I can work with.\n\n263\n00:13:35.040 --> 00:13:36.970\nAnd so, if you don't have that option, so\n\n264\n00:13:36.970 --> 00:13:40.175\nif you do pull up an appliance and\nyou don't see a VGA port on it.\n\n265\n00:13:40.175 --> 00:13:43.515\nYou don't see a spot where you\ncan connect in a USB keyboard,\n\n266\n00:13:43.515 --> 00:13:45.565\nmore than likely this is the option\nthat you're gonna choose.\n\n267\n00:13:47.015 --> 00:13:50.125\n>> Now, personally on the ones that I\nbuild, if they're being built on a one use\n\n268\n00:13:50.125 --> 00:13:53.340\nserver or whatever and you have VGA,\nyou might as well choose that.\n\n269\n00:13:53.340 --> 00:13:55.770\nYou can actually set the firewall\nto output on both, if you want.\n\n270\n00:13:55.770 --> 00:13:57.780\nBut during the install,\nyou have to pick one or the other and\n\n271\n00:13:57.780 --> 00:14:00.060\nthat's the choice that it's\ngiving me here, right.\n\n272\n00:14:00.060 --> 00:14:01.670\nSo I'll choose VGA.\n\n273\n00:14:01.670 --> 00:14:04.195\nThe next thing is\nthe Compact Flash card size.\n\n274\n00:14:04.195 --> 00:14:05.879\nNow when we choose the Live CD ones,\n\n275\n00:14:05.879 --> 00:14:09.120\nthose it doesn't care what\nsize you're putting it on.\n\n276\n00:14:09.120 --> 00:14:12.720\nBut remember with this one,\nI'm not creating an installer.\n\n277\n00:14:12.720 --> 00:14:14.600\nI'm actually doing the install.\n\n278\n00:14:14.600 --> 00:14:16.740\nSo when I throw this\nonto the Compact Flash,\n\n279\n00:14:16.740 --> 00:14:19.220\nit needs to know how big that memory is.\n\n280\n00:14:19.220 --> 00:14:23.920\nAnd I can tell it if it's 1 gig or\n2 gigs or 4 gigs in size.\n\n281\n00:14:23.920 --> 00:14:26.480\nNow, what if mine is 8 gigs or 16 Gigs?\n\n282\n00:14:26.480 --> 00:14:27.970\nI don't have that choice.\n\n283\n00:14:27.970 --> 00:14:29.580\nThat doesn't mean you're out of luck.\n\n284\n00:14:29.580 --> 00:14:33.430\nAll you have to do is choose one\nthat's smaller than your size, right?\n\n285\n00:14:33.430 --> 00:14:34.360\nSmaller or equal to.\n\n286\n00:14:34.360 --> 00:14:36.520\nYou just can't choose one that's bigger.\n\n287\n00:14:36.520 --> 00:14:40.420\nIf I have a 1 gig Compact Flash card and\nI choose the 2 gig image here,\n\n288\n00:14:40.420 --> 00:14:42.260\nit's not gonna work, right?\n\n289\n00:14:42.260 --> 00:14:45.980\nBut if I have an 8 gig Compact Flash and\nI choose any of these 1,\n\n290\n00:14:45.980 --> 00:14:48.610\n2 or 4, it'll work just fine, right?\n\n291\n00:14:48.610 --> 00:14:51.770\nWhat you're actually picking here\nis the size of the partition\n\n292\n00:14:51.770 --> 00:14:54.640\nthat it's gonna create when\nit partitions out that drive.\n\n293\n00:14:54.640 --> 00:14:57.800\nAnd pfSense,\nit needs a bit of room to breath.\n\n294\n00:14:57.800 --> 00:15:00.640\nIt doesn't need 4 gigs of space, but\n\n295\n00:15:00.640 --> 00:15:05.150\nif you give it 4 gigs of space, it gives\nit extra room for logs or other data.\n\n296\n00:15:05.150 --> 00:15:09.110\nWhen you do an upgrade,\nit can store an entire separate copy\n\n297\n00:15:09.110 --> 00:15:12.530\nof the pfSense software,\nso you can role back.\n\n298\n00:15:12.530 --> 00:15:13.290\nYou can do backups,\n\n299\n00:15:13.290 --> 00:15:17.030\nthere's all sorts of cool stuff\nyou can do if you have the room.\n\n300\n00:15:17.030 --> 00:15:19.600\nBut if you're working\nwith limited components,\n\n301\n00:15:19.600 --> 00:15:22.160\nlike you would in an integrated system or\nan embedded system.\n\n302\n00:15:22.160 --> 00:15:26.160\nIf you've only got 1 gig of flash\nburned onto that motherboard.\n\n303\n00:15:26.160 --> 00:15:30.390\nWell, you choose that 1 gig model and\nthat's the one that's gonna install and\n\n304\n00:15:30.390 --> 00:15:33.520\nit's gonna have a 1 gig\npartition that's ready to go.\n\n305\n00:15:33.520 --> 00:15:38.440\nNow if you have a 16 gig stick and\nyou install the 4 gig one,\n\n306\n00:15:38.440 --> 00:15:42.300\nafter the install you can go in and\nexpand that out to expand it to 16.\n\n307\n00:15:42.300 --> 00:15:46.125\nYou can take advantage of that other\nspace, but you don't normally need to.\n\n308\n00:15:46.125 --> 00:15:47.820\nPfSense normally doesn't\nneed that much room.\n\n309\n00:15:50.060 --> 00:15:51.010\nAll right.\n\n310\n00:15:51.010 --> 00:15:55.020\nOnce you choose all of that and you get\nit kind of chosen down at the bottom,\n\n311\n00:15:55.020 --> 00:15:57.680\nyou'll start to see the mirrors\nyou can download from, so\n\n312\n00:15:57.680 --> 00:15:59.460\nyou can choose which one is nearest you.\n\n313\n00:15:59.460 --> 00:16:02.670\nWe've got New York, Louisville,\nI guess Louisville probably the closest,\n\n314\n00:16:02.670 --> 00:16:03.309\nmaybe Austin.\n\n315\n00:16:03.309 --> 00:16:04.285\nI don't know which one's closer.\n\n316\n00:16:04.285 --> 00:16:06.850\n>> [LAUGH]\n>> Definitely not London or Amsterdam.\n\n317\n00:16:06.850 --> 00:16:08.567\nThose are a little bit further away for\nus.\n\n318\n00:16:08.567 --> 00:16:11.199\nBut choose one that's near you,\ndownload it, and you'll have it.\n\n319\n00:16:11.199 --> 00:16:15.110\nThis helps to guide you to\nget the right one, all right?\n\n320\n00:16:15.110 --> 00:16:18.059\nBut, when you download it,\nthere is a file naming convention, and\n\n321\n00:16:18.059 --> 00:16:21.111\nlet's say you download all of them,\nand then you come back later on and\n\n322\n00:16:21.111 --> 00:16:23.320\nyou've kind of forgotten which is which.\n\n323\n00:16:23.320 --> 00:16:25.760\nLet's take a look at that naming\nconvention they use, all right?\n\n324\n00:16:27.690 --> 00:16:30.230\nWhen you go to download\none of these files,\n\n325\n00:16:30.230 --> 00:16:34.570\nbasically it starts with pfSense,-,\nand then the version number, right?\n\n326\n00:16:34.570 --> 00:16:35.917\nSo I see 2.2.2.\n\n327\n00:16:35.917 --> 00:16:39.940\nAnd then you can see I'm doing a release,\nnot like a daily snapshot, right?\n\n328\n00:16:39.940 --> 00:16:41.130\nThose are the ones.\n\n329\n00:16:41.130 --> 00:16:44.700\nRelease means that this\nis the stable version.\n\n330\n00:16:44.700 --> 00:16:49.630\nAnd then after that,\neverything else that follows is detailing\n\n331\n00:16:49.630 --> 00:16:52.380\nwhat image this happens to be, all right?\n\n332\n00:16:52.380 --> 00:16:53.892\nNotice this one says 1g.\n\n333\n00:16:53.892 --> 00:16:56.973\nThis is a one gig NanoBSD image.\n\n334\n00:16:56.973 --> 00:17:02.020\nAnd if I scroll down, I'll find the two\ngig, and then the four gigs, right?\n\n335\n00:17:02.020 --> 00:17:04.770\nSo those are the sizes for the flash card.\n\n336\n00:17:04.770 --> 00:17:07.870\nI see amd64, that tells me it's 64-bit.\n\n337\n00:17:07.870 --> 00:17:10.118\nOr I see I386, that tells me it's 32-bit.\n\n338\n00:17:10.118 --> 00:17:15.700\nI see NanoBSD, that's what let's me\nknow this is the embedded version.\n\n339\n00:17:15.700 --> 00:17:19.690\nAnd now I see either -vga, or nothing.\n\n340\n00:17:19.690 --> 00:17:22.475\nIf you see -vga well that,\nthat means you hook a monitor up to it,\n\n341\n00:17:22.475 --> 00:17:23.905\nyou've actually got a vga port.\n\n342\n00:17:23.905 --> 00:17:26.798\nIf you don't see anything,\nthat means it's using the serial port.\n\n343\n00:17:26.798 --> 00:17:30.317\nNotice that the serial port is the default\none, vga is the one that's different,\n\n344\n00:17:30.317 --> 00:17:31.439\nnot the other way around.\n\n345\n00:17:32.820 --> 00:17:37.160\nAnd then after that we can see it's\nan image file, .img, followed by .gz.\n\n346\n00:17:37.160 --> 00:17:40.780\nIt's been gzipped,\nthe GNU zip utility to compress it and\n\n347\n00:17:40.780 --> 00:17:42.450\nmake it a bit smaller, right?\n\n348\n00:17:42.450 --> 00:17:46.550\nThey have to do that because the 1\ngig image would be 1 gig in size.\n\n349\n00:17:46.550 --> 00:17:50.090\nThe 2 gig image would be 2 gigs, and the 4\ngig image would be 4 gigs in size, but\n\n350\n00:17:50.090 --> 00:17:51.460\nit's mostly empty.\n\n351\n00:17:51.460 --> 00:17:55.960\nSo notice when they compress that 4\ngig image that it actually shows that\n\n352\n00:17:55.960 --> 00:17:58.037\nthere's only 144M, right?\n\n353\n00:17:58.037 --> 00:18:01.828\nThe whole rest of it is empty,\nit's room for logs, backups, packages,\n\n354\n00:18:01.828 --> 00:18:06.004\nall the other things that we throw on\nthere, so that's why they compress these.\n\n355\n00:18:06.004 --> 00:18:07.129\nWhat about these other files, Ronnie?\n\n356\n00:18:07.129 --> 00:18:09.820\nThese MD5 and SHA-256s?\n\n357\n00:18:09.820 --> 00:18:12.590\n>> Yeah, when you start seeing those\nother files, a lot of times when you\n\n358\n00:18:12.590 --> 00:18:16.140\ngo ahead and download it, what if you\nthink that something is corrupted?\n\n359\n00:18:16.140 --> 00:18:19.690\nWell, they give you this chance to be\nable to do a hash value, and they also,\n\n360\n00:18:19.690 --> 00:18:21.805\nof course,\nallow you to download that file.\n\n361\n00:18:21.805 --> 00:18:24.866\nSo when you do hash that file,\nyou can verify that this\n\n362\n00:18:24.866 --> 00:18:29.311\nis the exact copy that you got from that\nserver that it was actually hosted on.\n\n363\n00:18:29.311 --> 00:18:32.504\nAnd this is something we really do\nwant to make sure that we do test,\n\n364\n00:18:32.504 --> 00:18:35.584\nespecially when we're gonna be\nputting this into production,\n\n365\n00:18:35.584 --> 00:18:38.350\nbecause we don't want a lot\nof fault starts again.\n\n366\n00:18:38.350 --> 00:18:40.190\nEvery time we think that\nsomething is actually right and\n\n367\n00:18:40.190 --> 00:18:42.630\nwe get to a point in the install and\nit's not working.\n\n368\n00:18:42.630 --> 00:18:45.930\nBy being able to download these hash files\nalong with the file itself, it gives you\n\n369\n00:18:45.930 --> 00:18:49.680\nthat chance to go ahead and verify that\neverything is good before you even start.\n\n370\n00:18:49.680 --> 00:18:51.310\n>> Checking for\ncorruption is a great point.\n\n371\n00:18:51.310 --> 00:18:55.340\nAnother thing to remember though,\nis that this is your firewall.\n\n372\n00:18:55.340 --> 00:18:57.620\nImagine if somebody put\na back door in there.\n\n373\n00:18:57.620 --> 00:18:58.650\nIt's open source.\n\n374\n00:18:58.650 --> 00:19:00.390\nI could download the source code.\n\n375\n00:19:00.390 --> 00:19:02.874\nI could put my backdoor in there and\ncompile it and\n\n376\n00:19:02.874 --> 00:19:05.964\nzip it all up just like these and\nthen put it out there and say,\n\n377\n00:19:05.964 --> 00:19:09.130\nhey this is Don's definitely\ndownload it from me.\n\n378\n00:19:09.130 --> 00:19:12.240\n>> [LAUGH]\n>> And its got my backdoor embedded in it.\n\n379\n00:19:12.240 --> 00:19:13.650\nYou don't want that.\n\n380\n00:19:13.650 --> 00:19:15.710\nSo, if we're going and\ndownloading this from a mirror,\n\n381\n00:19:15.710 --> 00:19:18.790\nhow do we know that it hasn't\nbeen tampered with, right?\n\n382\n00:19:18.790 --> 00:19:20.080\nAnd so, it's checksums that do it.\n\n383\n00:19:20.080 --> 00:19:21.170\nThe md5 and the shah-256.\n\n384\n00:19:21.170 --> 00:19:22.460\nYou just need one of them, right?\n\n385\n00:19:22.460 --> 00:19:23.297\nWhat ever one one you choose.\n\n386\n00:19:23.297 --> 00:19:26.806\nshah-256 is stronger, but\neither one will work.\n\n387\n00:19:26.806 --> 00:19:30.044\nThe trick here is, you never want to\ndownload those signatures from the same\n\n388\n00:19:30.044 --> 00:19:32.235\nsite you're downloading the image from,\nright?\n\n389\n00:19:32.235 --> 00:19:34.022\nThey'll just change the signatures, too.\n\n390\n00:19:34.022 --> 00:19:38.118\nSo, if you want to be sure that the\nfirewall software has not been modified in\n\n391\n00:19:38.118 --> 00:19:41.574\nany way, you download from one mirror,\nthe actual images, and\n\n392\n00:19:41.574 --> 00:19:45.670\nthen you download the signatures from\nanother mirror from somewhere else or\n\n393\n00:19:45.670 --> 00:19:47.670\nfrom the official pfSense webpage.\n\n394\n00:19:47.670 --> 00:19:48.800\nYou can get them from there.\n\n395\n00:19:48.800 --> 00:19:50.780\nYou can download them,\nthey're really small.\n\n396\n00:19:50.780 --> 00:19:54.620\nPull them down, compare the two and then\nmake sure that hasn't been tampered with.\n\n397\n00:19:55.780 --> 00:19:57.300\nOut of all the devices on your network,\n\n398\n00:19:57.300 --> 00:20:01.110\nyour firewall is absolutely the one\nyou don't want compromised.\n\n399\n00:20:01.110 --> 00:20:04.110\nMaybe if you have an IDS box, you probably\ndon't want that messed with either.\n\n400\n00:20:04.110 --> 00:20:06.860\nBut this is really important, so\nit's a good time to check that.\n\n401\n00:20:08.000 --> 00:20:10.510\nAll right,\nnow these are all NanoBSD up here.\n\n402\n00:20:10.510 --> 00:20:14.168\nIf I keep scrolling down I'll\nsee that NanoBSD name goes away,\n\n403\n00:20:14.168 --> 00:20:18.252\nthe sizes go away and now we end up\nwith much shorter names, all right?\n\n404\n00:20:18.252 --> 00:20:24.372\nThese are regular live CD installs, and so\nI've got pfSense LIveCD, pfSense memstick.\n\n405\n00:20:24.372 --> 00:20:25.740\nThey're actually the same.\n\n406\n00:20:25.740 --> 00:20:29.370\nOne's designed as an ISO that's\ngonna be written to a CD drive,\n\n407\n00:20:29.370 --> 00:20:33.020\nthe other's an IMG that's gonna\nbe written to a USB stick, right?\n\n408\n00:20:33.020 --> 00:20:35.500\nBut inside of them,\nthey're practically the same.\n\n409\n00:20:35.500 --> 00:20:38.450\nBoth are designed to run with\nvery little writing to disk.\n\n410\n00:20:38.450 --> 00:20:41.620\nThe ISO, in fact, is designed to not\nwrite to the disk at all because you\n\n411\n00:20:41.620 --> 00:20:43.800\ncan't write to a CD, right?\n\n412\n00:20:43.800 --> 00:20:45.830\nAnd so\nwe'll just see whether it's the LiveCD or\n\n413\n00:20:45.830 --> 00:20:48.210\nmemstick followed by\nthe version release and\n\n414\n00:20:48.210 --> 00:20:52.990\nthen whether it's 32-bit or 64-bit, and\nthose are the guys that we normally want.\n\n415\n00:20:52.990 --> 00:20:56.670\nAnd then down here we can see some of\nthe proprietary ones, the ADI ones.\n\n416\n00:20:56.670 --> 00:21:00.000\nAnd then they've got some special\nones down here at the bottom.\n\n417\n00:21:00.000 --> 00:21:03.890\nThese are more memstick ones that\nare kind of based off of that LiveCD.\n\n418\n00:21:03.890 --> 00:21:09.230\nBut this is a little bit of a blend\nbetween the NanoBSD and the full version.\n\n419\n00:21:09.230 --> 00:21:14.020\nWhere, it's the full version of pfSense\ndesigned to run on a memory stick, and\n\n420\n00:21:14.020 --> 00:21:17.310\nuse the serial port for\noutput instead of a monitor.\n\n421\n00:21:17.310 --> 00:21:20.890\nSo, if you've got a regular PC or\na one-use server, but\n\n422\n00:21:20.890 --> 00:21:25.520\nyou wanna treat it like an appliance with\nno VGA monitor, this is the one you'd use.\n\n423\n00:21:25.520 --> 00:21:28.980\nKind of a special one that's down\nthere at the bottom, all right?\n\n424\n00:21:28.980 --> 00:21:32.361\nSo, that's kind of how the naming\nconvention works for these files.\n\n425\n00:21:32.361 --> 00:21:36.662\nThey're all gzipped, and so\nif you want, you can uncompress them.\n\n426\n00:21:36.662 --> 00:21:39.750\nUsually when you write them you'll\nhave to uncompress them to write them.\n\n427\n00:21:39.750 --> 00:21:42.790\nWe're gonna do an episode on actually\ncreating that install media a little bit\n\n428\n00:21:42.790 --> 00:21:44.310\nlater, so just be aware of that.\n\n429\n00:21:44.310 --> 00:21:46.520\nWe'll kinda show that process\nof uncompressing them.\n\n430\n00:21:46.520 --> 00:21:49.807\nNow if you need a previous version\nof pfSense, they are out there.\n\n431\n00:21:49.807 --> 00:21:51.495\nNot every mirror has them.\n\n432\n00:21:51.495 --> 00:21:53.950\nSee I'm connected to cubenet right now.\n\n433\n00:21:53.950 --> 00:21:57.740\nI'm not sure if they carry the previous\nversions or not, let's go and check.\n\n434\n00:21:57.740 --> 00:22:03.900\nSo, you might not be ready for 2.2.2 yet,\nyou might still be on 2.1.5 or something.\n\n435\n00:22:03.900 --> 00:22:08.840\nAnd so your mirror might need to, yeah\nit looks like they might not have it or\n\n436\n00:22:08.840 --> 00:22:09.780\nthey might limit it.\n\n437\n00:22:09.780 --> 00:22:13.713\nBut sometimes the web access,\nthey limit you so\n\n438\n00:22:13.713 --> 00:22:19.708\nthat you can't view some of the\ndirectories that you can when you FTP in,\n\n439\n00:22:19.708 --> 00:22:24.860\nso let me connect via FTP here and\nwe'll see what we get.\n\n440\n00:22:24.860 --> 00:22:29.350\nSo we go into their pfSense folder and\n\n441\n00:22:29.350 --> 00:22:34.380\nI can see,\nnot a whole heck of a lot in here.\n\n442\n00:22:34.380 --> 00:22:36.950\nYeah, they just have the current one and\nthat's it.\n\n443\n00:22:36.950 --> 00:22:39.860\nSo, you might have to poke around a few\ndifferent mirrors to find one that still\n\n444\n00:22:39.860 --> 00:22:41.210\nhas the older versions.\n\n445\n00:22:41.210 --> 00:22:46.167\nThere are times where,\nI remember when 2.2 first came out, and\n\n446\n00:22:46.167 --> 00:22:47.857\nit had some bugs in it.\n\n447\n00:22:47.857 --> 00:22:49.675\nYou might want to stay on 2.1.5.\n\n448\n00:22:49.675 --> 00:22:52.230\nThen 2.2.1 came out and fixed those bugs.\n\n449\n00:22:52.230 --> 00:22:54.185\nNow, 2.2.2 came out.\n\n450\n00:22:54.185 --> 00:22:59.080\n2.2.2, I think it had the heart bleed\nfix and a few other, that were really\n\n451\n00:22:59.080 --> 00:23:04.310\nsecurity related fixes, not truly bugs\nwith pfSense but just as important, right?\n\n452\n00:23:04.310 --> 00:23:07.650\nRemember, when you run\nan older version of pfSense,\n\n453\n00:23:07.650 --> 00:23:10.050\nyou might be missing out on\nsome security patches and\n\n454\n00:23:10.050 --> 00:23:12.970\nyour firewall is definitely a device\nthat you want to be secure.\n\n455\n00:23:12.970 --> 00:23:16.435\nSo you typically want to run the latest\nand greatest version, if possible.\n\n456\n00:23:16.435 --> 00:23:20.635\nSo when obtaining your download ,make\nsure you're getting the newest version.\n\n457\n00:23:20.635 --> 00:23:21.811\nAnd if you're ever in doubt,\n\n458\n00:23:21.811 --> 00:23:24.210\nyou can always find it on\npfSense home page, right?\n\n459\n00:23:24.210 --> 00:23:28.420\nWhen we go to pfSense homepage you\nget the nice little overview stuff.\n\n460\n00:23:28.420 --> 00:23:30.480\nAnd when we go to Download Now,\n\n461\n00:23:30.480 --> 00:23:35.520\nthey tell you right here under the Latest\nStable Version, that 2.2.2 is the latest,\n\n462\n00:23:35.520 --> 00:23:37.360\nso really easy to check and\nsee if you've got the latest.\n\n463\n00:23:39.470 --> 00:23:42.640\nAll right, well, Ronnie, as far as\ngetting a copy of that install media,\n\n464\n00:23:42.640 --> 00:23:44.490\nI think that pretty much covers it all,\nright?\n\n465\n00:23:44.490 --> 00:23:46.920\n>> As far as getting it,\nthat's the only thing that we need.\n\n466\n00:23:46.920 --> 00:23:50.310\nNow the next thing that we have to do\nof course is begin that process of\n\n467\n00:23:50.310 --> 00:23:51.470\ntrying to install it.\n\n468\n00:23:51.470 --> 00:23:53.535\n>> All right, but that's a pretty good\nspot for us to wrap this segment up.\n\n469\n00:23:53.535 --> 00:24:00.053\nSo stay tuned,\nwe're gonna build our install media next.\n\n470\n00:24:00.053 --> 00:24:02.100\n[SOUND]\n\n",
          "vimeoId": "130220844"
        },
        {
          "description": null,
          "length": "973",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-2-buillding_install_media-060815-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-2-buillding_install_media-060815-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-2-buillding_install_media-060815-1-sm.jpg",
          "title": "Building Install Media",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:08.047\n[MUSIC]\n\n2\n00:00:08.047 --> 00:00:11.783\nIn this segment we're gonna be taking\na look at building the installation media\n\n3\n00:00:11.783 --> 00:00:13.060\nfor pfSense.\n\n4\n00:00:13.060 --> 00:00:16.380\nSo you download a pfSense, you're ready\nto get it set up on your first firewall.\n\n5\n00:00:16.380 --> 00:00:18.880\nYou got to have some kind\nof installed media first.\n\n6\n00:00:18.880 --> 00:00:24.290\nSo let's kick this off, taking a look\nat CD installation media, that used to\n\n7\n00:00:24.290 --> 00:00:29.160\nbe the most common way to install things\nwhen every computer had CD drive in them.\n\n8\n00:00:29.160 --> 00:00:32.830\nBut more and more today, we're starting\nto see computers not include a CD drive.\n\n9\n00:00:32.830 --> 00:00:36.290\nSo if you were to do some\nkind of CD install media,\n\n10\n00:00:36.290 --> 00:00:38.220\nyou have to carry something\naround like well, what I've got.\n\n11\n00:00:38.220 --> 00:00:41.490\nI've got this little USB CD drive\nattached to my computer right now,\n\n12\n00:00:41.490 --> 00:00:44.940\nand you really just don't see\nthese as much anymore, but\n\n13\n00:00:44.940 --> 00:00:47.330\nit is still something that's out there so\nI wanna cover it.\n\n14\n00:00:47.330 --> 00:00:51.460\nStep one, you download the copy\nof pfSense from pfsense.org, and\n\n15\n00:00:51.460 --> 00:00:53.642\nwe showed that in our last segment.\n\n16\n00:00:53.642 --> 00:00:54.560\nYou go to the website.\n\n17\n00:00:54.560 --> 00:00:57.520\nYou find the appropriate one and\nyou download it.\n\n18\n00:00:57.520 --> 00:01:00.080\nStep two though is one that\npeople miss a lot of times.\n\n19\n00:01:00.080 --> 00:01:04.390\nWhen you download the image from pfSense,\nit's archived, it's zipped up and\n\n20\n00:01:04.390 --> 00:01:05.180\ncompressed.\n\n21\n00:01:05.180 --> 00:01:08.990\nWe need to uncompress that file and\nthen we'll be able to go in there and\n\n22\n00:01:08.990 --> 00:01:10.420\nwrite that image.\n\n23\n00:01:10.420 --> 00:01:13.350\nSo for example,\nlet's take a look at my machine here, and\n\n24\n00:01:13.350 --> 00:01:19.100\nbefore the show I went and\ndownloaded a couple of copies of pfSense.\n\n25\n00:01:19.100 --> 00:01:23.252\nAnd if I take a look at them,\nI can see this guy right here,\n\n26\n00:01:23.252 --> 00:01:29.516\npfSense-LiveCD-2.2.2-RELEASE -i286.iso.gz.\n\n27\n00:01:29.516 --> 00:01:33.020\nThat .gz right there tells me\nit's zipped up, and if I try and\n\n28\n00:01:33.020 --> 00:01:36.200\nburn that to an ISO image right now,\nit's not gonna do me any good.\n\n29\n00:01:36.200 --> 00:01:38.550\nSo I need to unarchive that,\n\n30\n00:01:38.550 --> 00:01:43.480\nand if you're in Windows, it doesn't have\na gzip handler by default so you might\n\n31\n00:01:43.480 --> 00:01:45.856\nneed a software utility like WinZip or-\n>> 7-Zip.\n\n32\n00:01:45.856 --> 00:01:48.299\n>> 7-zip is another one,\nthat's a good one that's out there.\n\n33\n00:01:49.310 --> 00:01:51.760\nIn Mac you actually do have support for\nit.\n\n34\n00:01:51.760 --> 00:01:55.990\nYou can just double-click on it or you\nmight have third party software installed,\n\n35\n00:01:55.990 --> 00:01:58.430\nbut in a Mac if you just\ndouble-click it'll open up.\n\n36\n00:01:58.430 --> 00:02:00.610\nIf you're in a UNIX or Linux based system,\n\n37\n00:02:00.610 --> 00:02:03.260\nthen you've actually got\nthe gzip utility or gunzip.\n\n38\n00:02:03.260 --> 00:02:06.140\nThere's a few of them that\nyou can use to open that up.\n\n39\n00:02:06.140 --> 00:02:10.350\nBut once you decompress it you'll see\nit's just a regular old ISO image.\n\n40\n00:02:10.350 --> 00:02:13.290\nAnd if you wanna burn an ISO\nimage to a disk well,\n\n41\n00:02:13.290 --> 00:02:15.970\nyou can use whatever disk\nwriting software you want.\n\n42\n00:02:15.970 --> 00:02:18.428\nAgain, in Windows it's\nactually built-in software.\n\n43\n00:02:18.428 --> 00:02:20.090\nYou can right-click on the ISO and\n\n44\n00:02:20.090 --> 00:02:25.375\nchoose to put it into the burn image\nwizard, I think is what it's called.\n\n45\n00:02:25.375 --> 00:02:28.365\nIn Mac, we can use the disc\nutility to burn that and\n\n46\n00:02:28.365 --> 00:02:31.675\nit's just up to you what\nsoftware you wanna use.\n\n47\n00:02:31.675 --> 00:02:34.555\nSo I'll go into my disc utility,\nand here I can see that\n\n48\n00:02:34.555 --> 00:02:39.815\nCD DVD burner that I've got, and notice\nup here I've got this little Burn button.\n\n49\n00:02:39.815 --> 00:02:43.905\nAnd I can choose Burn, and\nit's gonna let me pick an image.\n\n50\n00:02:43.905 --> 00:02:46.790\nAnd I can browse in and find that image.\n\n51\n00:02:46.790 --> 00:02:50.390\nAnd it's this guy right here notice the\ngzup one is kind of grayed out there it\n\n52\n00:02:50.390 --> 00:02:54.150\nwon't let me choose it but I can choose\nthat ISO image and I can burn it.\n\n53\n00:02:54.150 --> 00:02:58.473\nNow that's the 386 one the 32-bit one I'm\ngonna pick that 64-bit guy right there,\n\n54\n00:02:58.473 --> 00:03:00.540\nthat'll be a little more useful.\n\n55\n00:03:00.540 --> 00:03:03.260\nSo I'll choose that one and\nI'll go ahead and hit burn and\n\n56\n00:03:03.260 --> 00:03:07.030\nit's gonna basically reach out to\nthat drive and burn it to the disk.\n\n57\n00:03:07.030 --> 00:03:11.690\nNow, once it's burned, it doesn't matter\nif I burned it from a Windows machine or\n\n58\n00:03:11.690 --> 00:03:12.567\na Mac or Linux.\n\n59\n00:03:12.567 --> 00:03:14.460\nIt doesn't matter.\n\n60\n00:03:14.460 --> 00:03:17.210\nNow, it's a BSD operating\nsystem written to that disk.\n\n61\n00:03:17.210 --> 00:03:21.030\nAnd I can take that disk and go to any\nother machine and boot off of it, and\n\n62\n00:03:21.030 --> 00:03:25.480\nit's gonna boot the free BSD operating\nsystem that pfSense runs on top of.\n\n63\n00:03:25.480 --> 00:03:28.530\nI can do my install and\neverything else that I need from there.\n\n64\n00:03:28.530 --> 00:03:31.620\nSo creating the CD install media,\nnot really a big deal.\n\n65\n00:03:31.620 --> 00:03:35.520\nI think most of you guys watching the show\nare probably already familiar with this.\n\n66\n00:03:35.520 --> 00:03:40.680\nI did use a CDR write disk.\n\n67\n00:03:40.680 --> 00:03:43.990\nNot a DVD but\nyou can do a DVD if you want.\n\n68\n00:03:43.990 --> 00:03:47.500\nIt just depends on where you're\ngonna be booting this off of.\n\n69\n00:03:47.500 --> 00:03:49.950\nIf you're booting a machine that only\nhas CD drive and not a DVD drive,\n\n70\n00:03:49.950 --> 00:03:52.385\nyou need to make sure you use CD media.\n\n71\n00:03:52.385 --> 00:03:56.095\nPfSense image is very small, so\nyou don't need a DVD to hold it,\n\n72\n00:03:56.095 --> 00:03:57.762\nit will fit just fine on a CD.\n\n73\n00:03:57.762 --> 00:03:58.678\nIt's up to you which one you wanna use.\n\n74\n00:04:00.170 --> 00:04:02.230\n>> The other way to create\nan installation media of course,\n\n75\n00:04:02.230 --> 00:04:05.960\nis using a memory stick such\nas a USB key like this.\n\n76\n00:04:05.960 --> 00:04:07.070\nWhat you wanna make sure of course,\n\n77\n00:04:07.070 --> 00:04:08.810\nis that you do have one\nthat will probably be,\n\n78\n00:04:08.810 --> 00:04:12.750\nI'm gonna say 2 gigs or most of them are\nprobably gonna be much bigger than that.\n\n79\n00:04:12.750 --> 00:04:15.990\nBut what we wanna do is we wanna actually\ndownload that different image, the one\n\n80\n00:04:15.990 --> 00:04:20.360\nthat's actually designed for the Memstick,\nand then transfer that over here too.\n\n81\n00:04:20.360 --> 00:04:23.612\nSo that's the process that I'm\nactually gonna be following right now.\n\n82\n00:04:23.612 --> 00:04:25.230\nWhat's gonna happen\nthough is on this stick,\n\n83\n00:04:25.230 --> 00:04:26.560\nit's gonna erase anything that's on it.\n\n84\n00:04:26.560 --> 00:04:29.630\nSo don't put it on something that you\nbelieve that you have sensitive documents\n\n85\n00:04:29.630 --> 00:04:32.550\non or at least transfer that over if\nyou're actually gonna be using that.\n\n86\n00:04:32.550 --> 00:04:34.820\nSo it's actually going to\ntake that a software and\n\n87\n00:04:34.820 --> 00:04:36.340\nactually be able to transfer that over.\n\n88\n00:04:36.340 --> 00:04:40.060\nThe one that pfSense recommends\nis one that we call Image Writer,\n\n89\n00:04:40.060 --> 00:04:41.700\nit is the one that pfSense recommends.\n\n90\n00:04:41.700 --> 00:04:46.130\nSo I'm simply gonna plug in my\nUSB key here on my computer, and\n\n91\n00:04:46.130 --> 00:04:47.960\nwhen we bring up the screen\nI've went ahead and\n\n92\n00:04:47.960 --> 00:04:51.290\ndownloaded the actual image soft,\nwhoops, there it is.\n\n93\n00:04:51.290 --> 00:04:54.079\nThe USB stick kind of popped up for me.\n\n94\n00:04:54.079 --> 00:04:58.311\nAnd so the one that we have is\nthe one that's zipped up and\n\n95\n00:04:58.311 --> 00:05:03.176\nit's gonna be the memstick2.2.2RELEASE,\nthe AMD64,\n\n96\n00:05:03.176 --> 00:05:05.900\nand this one's got the .img file.\n\n97\n00:05:05.900 --> 00:05:07.760\nAnd the same process here,\n\n98\n00:05:07.760 --> 00:05:11.410\nI need to unzip that one too\nbefore I burn it to that stick.\n\n99\n00:05:11.410 --> 00:05:17.300\nNow, you actually see where I have 7-Zip,\nI was gonna say WinZip, 7Zip on here.\n\n100\n00:05:17.300 --> 00:05:21.930\nGonna type up my WinZip file manager,\nand select that.\n\n101\n00:05:21.930 --> 00:05:22.627\nOh, maybe.\n\n102\n00:05:22.627 --> 00:05:26.280\n>> [LAUGH]\n>> It's like a challenge.\n\n103\n00:05:26.280 --> 00:05:30.871\nAnd so inside that file manager,\nI'm going to look for the.\n\n104\n00:05:32.286 --> 00:05:35.280\nLet me see if I can find that desktop.\n\n105\n00:05:35.280 --> 00:05:39.800\nSo I've downloaded the pfSense\nmemory stick image, and\n\n106\n00:05:39.800 --> 00:05:41.440\nI need to unzip that as well.\n\n107\n00:05:41.440 --> 00:05:46.110\nIn the background,\nI've already got my 7-Zip ready to go.\n\n108\n00:05:46.110 --> 00:05:50.090\nSo all I need to do is\nselect the memstick image.\n\n109\n00:05:50.090 --> 00:05:54.420\nAnd then from there extract it, and\nmake sure I actually have it in a place.\n\n110\n00:05:54.420 --> 00:05:55.810\nI'm gonna be able to find it,\nthat's the key.\n\n111\n00:05:57.930 --> 00:06:00.040\nAnd once it finishes extracting,\n\n112\n00:06:00.040 --> 00:06:05.410\nI should end up getting the image\nhere inside of this folder.\n\n113\n00:06:05.410 --> 00:06:09.680\nSo that's what I'm actually going\nto be burning to, that USB stick.\n\n114\n00:06:09.680 --> 00:06:12.930\nBecause pfSense does recommend\none called Image Writer, you\n\n115\n00:06:12.930 --> 00:06:17.508\ncan download that from the Internet, and\nI've got that up and running for us here.\n\n116\n00:06:17.508 --> 00:06:19.755\n>> And notice it, this is the one\nthat always tricks me up on this,\n\n117\n00:06:19.755 --> 00:06:22.425\nis on the pfSense,\nthey call it image writer.\n\n118\n00:06:22.425 --> 00:06:24.335\nMultiple places they call it image writer.\n\n119\n00:06:24.335 --> 00:06:25.629\nBut then when you look in the title bar-\n>> WIN.\n\n120\n00:06:25.629 --> 00:06:26.955\n>> Win32 Disk Imager.\n\n121\n00:06:26.955 --> 00:06:31.095\nSo the product actually has two\ndifferent names, which is confusing.\n\n122\n00:06:31.095 --> 00:06:34.566\nSo just be aware of that when\nyou go to work with this.\n\n123\n00:06:34.566 --> 00:06:38.577\n>> So from here,\nwe go back into my ITProTV folder, and\n\n124\n00:06:38.577 --> 00:06:43.040\ninto that folder that\nactually extracted it.\n\n125\n00:06:43.040 --> 00:06:44.976\nI'm gonna click open.\n\n126\n00:06:44.976 --> 00:06:48.210\n>> Yeah, and he's just choosing\nthe IMG file, that's that disk image.\n\n127\n00:06:48.210 --> 00:06:51.350\nSo he's providing the image\nfile to the Win32 Disk Imager.\n\n128\n00:06:51.350 --> 00:06:55.760\nThe only other thing it needs to know is,\ninstallation media to copy it to.\n\n129\n00:06:55.760 --> 00:06:58.577\n>> So from this point here,\nI need to select that and\n\n130\n00:06:58.577 --> 00:07:02.980\nthat's gonna copy it to the D drive,\nwhich is my USB stick over here.\n\n131\n00:07:02.980 --> 00:07:04.900\nAnd I'm going to select right.\n\n132\n00:07:04.900 --> 00:07:07.650\n>> And be careful here because all\nit gives you is a drive letter.\n\n133\n00:07:07.650 --> 00:07:11.360\nSo it says d:/,\nhe gets that little message.\n\n134\n00:07:11.360 --> 00:07:12.380\nAnd oh, there you'll actually see that.\n\n135\n00:07:12.380 --> 00:07:12.905\n>> Yep.\n\n136\n00:07:12.905 --> 00:07:13.700\n>> Warning right there.\n\n137\n00:07:13.700 --> 00:07:16.786\nIt's letting him know hey, be careful if\nyou're writing to a disk that has data\n\n138\n00:07:16.786 --> 00:07:17.445\non it-\n>> [LAUGH]\n\n139\n00:07:17.445 --> 00:07:18.660\n>> We're about to wipe it all out.\n\n140\n00:07:18.660 --> 00:07:19.960\nAnd all it gave us was a letter.\n\n141\n00:07:19.960 --> 00:07:22.966\nSo if you had a USB hard drive\nattached at the same time.\n\n142\n00:07:22.966 --> 00:07:25.430\n>> [LAUGH]\n>> You might be choosing the wrong media.\n\n143\n00:07:25.430 --> 00:07:27.040\nSo double check your drive letter.\n\n144\n00:07:27.040 --> 00:07:29.130\nTriple check your drive letter,\nso you don't pick the wrong one,\n\n145\n00:07:29.130 --> 00:07:31.000\ncuz it's gonna erase that drive and\n\n146\n00:07:31.000 --> 00:07:36.020\nthen it's gonna throw that data right on\nthere and you're gonna be in business.\n\n147\n00:07:36.020 --> 00:07:36.984\n>> Did I do that?\n\n148\n00:07:36.984 --> 00:07:39.880\n>> [LAUGH]\n>> Oh no, I know I've felt that before.\n\n149\n00:07:39.880 --> 00:07:42.220\nAnd from that point it's just\ngonna take a few seconds.\n\n150\n00:07:42.220 --> 00:07:43.970\nAnd it should write on through, and\n\n151\n00:07:43.970 --> 00:07:48.450\nnow we can use that USB stick to boot\nthat device up too and we're ready to go.\n\n152\n00:07:48.450 --> 00:07:51.720\n>> And when that's done,\nyou've got bootable USB media and\n\n153\n00:07:51.720 --> 00:07:55.380\nalmost every computer today is\ncapable of booting off of USB.\n\n154\n00:07:55.380 --> 00:07:59.190\nI say almost there are some Chromebooks\nand stuff that a lot of times won't do it.\n\n155\n00:07:59.190 --> 00:08:01.890\nBut the cool part is you\ndon't need a CD drive.\n\n156\n00:08:01.890 --> 00:08:05.630\nAlmost every computer has a USB port\non it, you plug in that USB key,\n\n157\n00:08:05.630 --> 00:08:09.270\nyou boot up your system and you choose the\nboot up on that and you'll be in business.\n\n158\n00:08:09.270 --> 00:08:12.480\nWe'd get a chance to see that when\nwe actually in installation show.\n\n159\n00:08:12.480 --> 00:08:16.490\nNow, Ronnie just did this on a Windows\nmachine and in Windows you do have to\n\n160\n00:08:16.490 --> 00:08:20.620\ndownload third party software, but\nif you're on a Linux or a Mac or\n\n161\n00:08:20.620 --> 00:08:25.010\na any DSD system,\nyou can actually use built in software.\n\n162\n00:08:25.010 --> 00:08:28.900\nIn the units world we've had software\nthis little executable command called DD,\n\n163\n00:08:28.900 --> 00:08:30.970\nit's capable of writing disc images.\n\n164\n00:08:30.970 --> 00:08:34.520\nYou can just write the disk data straight\nto a system and you're in business.\n\n165\n00:08:34.520 --> 00:08:37.770\nIt's effectively what that\nWin32 Disk Image is doing,\n\n166\n00:08:37.770 --> 00:08:39.570\njust doing it from the command line.\n\n167\n00:08:39.570 --> 00:08:42.953\nSo let me show you the same thing but\non a Mac instead.\n\n168\n00:08:42.953 --> 00:08:46.858\nSo what Ronnie just showed you was\nbasically building that USB installation\n\n169\n00:08:46.858 --> 00:08:48.390\nmedia for a Windows machine.\n\n170\n00:08:48.390 --> 00:08:50.520\nAnd in Windows you got to\nhave third party software.\n\n171\n00:08:50.520 --> 00:08:52.390\nThere's nothing built in that will do it.\n\n172\n00:08:52.390 --> 00:08:55.542\nBut if you're on a Linux or\nMac, BSD type system,\n\n173\n00:08:55.542 --> 00:09:00.196\nthey actually have software already\nbuilt into them, there's a very old\n\n174\n00:09:00.196 --> 00:09:04.572\nLinux command called DD that lets us\nwrite disk data to well to a disk.\n\n175\n00:09:04.572 --> 00:09:05.930\nThat's kind of what it does.\n\n176\n00:09:05.930 --> 00:09:08.930\nSo we can just use that built in software.\n\n177\n00:09:08.930 --> 00:09:11.540\nOn a positive side, that means we don't\nthink it would download anything.\n\n178\n00:09:11.540 --> 00:09:13.684\nOn a negative side,\nit's command line software.\n\n179\n00:09:13.684 --> 00:09:15.410\n>> [LAUGH]\n>> So just a little bit harder.\n\n180\n00:09:15.410 --> 00:09:18.020\nBut you don't do it very often,\nso it's not that big of a deal.\n\n181\n00:09:18.020 --> 00:09:19.610\nBut it's nice that we\ncan use what's built in.\n\n182\n00:09:19.610 --> 00:09:22.400\nSo I wanna show you that\nright here on my Mac.\n\n183\n00:09:22.400 --> 00:09:26.570\nI've gone ahead and downloaded\nthe pfSense memstick image right here.\n\n184\n00:09:26.570 --> 00:09:29.279\nAnd I'm actually gonna leave\nit archived for right now,\n\n185\n00:09:29.279 --> 00:09:32.451\ncause we can unarchive it at the same\ntime as we apply it to the disk.\n\n186\n00:09:32.451 --> 00:09:34.490\nJust do it all in one fell swoop.\n\n187\n00:09:34.490 --> 00:09:37.820\nIn a Mac you can double-click on it,\nit'll unarchive it.\n\n188\n00:09:37.820 --> 00:09:40.290\nYou can do that if you want but\nI'll just leave it right there.\n\n189\n00:09:41.380 --> 00:09:43.280\nThe next thing I need is a USB stick and\n\n190\n00:09:43.280 --> 00:09:47.290\nI've got my trusty dusty 16\ngig USB stick stuck in here.\n\n191\n00:09:47.290 --> 00:09:49.840\nAnd I'm gonna fire up my\ndisk utility real quick.\n\n192\n00:09:49.840 --> 00:09:51.620\nBecause I need to see the disk and\n\n193\n00:09:51.620 --> 00:09:55.120\nthere's two things that I\nneed to do to get ready here.\n\n194\n00:09:55.120 --> 00:09:58.800\nThe first thing I need to do is,\nI need to unmount the disk.\n\n195\n00:09:58.800 --> 00:10:01.770\nIn Mac OS, it unmounts the disk\nautomatically when you plug it in and\n\n196\n00:10:01.770 --> 00:10:02.810\nit locks it.\n\n197\n00:10:02.810 --> 00:10:05.865\nSo you can't erase the disk\nwhile it's mounted.\n\n198\n00:10:05.865 --> 00:10:09.410\nNow, I shouldn't be saying disk,\nI should be saying volume.\n\n199\n00:10:09.410 --> 00:10:10.720\nI need to unmount the volume.\n\n200\n00:10:10.720 --> 00:10:14.720\nI need the disk to be present because\notherwise I won't be able to write to it.\n\n201\n00:10:14.720 --> 00:10:17.400\nSo what I need to do is\nchoose the volume or\n\n202\n00:10:17.400 --> 00:10:21.578\nvolumes if there's more than one, I need\nto choose those volumes and eject them,\n\n203\n00:10:21.578 --> 00:10:24.680\ndon't use unmount, if you use unmount.\n\n204\n00:10:24.680 --> 00:10:26.310\nI'm sorry.\nI'm getting them backwards.\n\n205\n00:10:26.310 --> 00:10:27.747\nIf we need to unmount-\n>> [LAUGH]\n\n206\n00:10:27.747 --> 00:10:28.485\n>> Not eject.\n\n207\n00:10:28.485 --> 00:10:30.680\nEject actually turns the hardware off.\n\n208\n00:10:30.680 --> 00:10:31.980\nAnd then we can't access the hardware.\n\n209\n00:10:31.980 --> 00:10:32.970\nThat'd be bad.\n\n210\n00:10:32.970 --> 00:10:35.410\nUnmount just takes that volume out.\n\n211\n00:10:35.410 --> 00:10:38.230\nSo I'm going to unmount that volume and\nit turns gray.\n\n212\n00:10:38.230 --> 00:10:39.860\nBut the disk still shows up.\n\n213\n00:10:39.860 --> 00:10:41.220\nI didn't do eject.\n\n214\n00:10:41.220 --> 00:10:42.200\nThe disk is still there.\n\n215\n00:10:42.200 --> 00:10:43.446\nSo now, I'm ready.\n\n216\n00:10:43.446 --> 00:10:46.450\nNo volumes are mounted\ninside of that disk.\n\n217\n00:10:46.450 --> 00:10:50.130\nThen I'm just gonna choose that disc and\nhit the info button.\n\n218\n00:10:50.130 --> 00:10:53.610\nI need to get the disc identifier.\n\n219\n00:10:53.610 --> 00:10:55.350\nMine is called disc two.\n\n220\n00:10:55.350 --> 00:10:58.310\nOn your system it might be disc three,\ndisc four, who knows.\n\n221\n00:10:58.310 --> 00:11:01.350\nBased on how many other discs\nyou have on your system.\n\n222\n00:11:01.350 --> 00:11:04.660\nBe very careful here, just like under\nWindows with the drive letters.\n\n223\n00:11:04.660 --> 00:11:08.390\nHere, if I get the wrong disc ID,\nI'm gonna be in real trouble.\n\n224\n00:11:08.390 --> 00:11:11.441\nIf you're on a Linux system before we\nunmounted that volume we could have\n\n225\n00:11:11.441 --> 00:11:13.702\njust dropped to a terminal and\nrun the mount command.\n\n226\n00:11:13.702 --> 00:11:16.501\nAnd it would've shown you the disc\nID right there too, there there's\n\n227\n00:11:16.501 --> 00:11:19.270\na few different ways to see it, but\nright here I can see it on disc two.\n\n228\n00:11:20.440 --> 00:11:23.870\nSo my volumes are unmounted,\nmy disc is still present,\n\n229\n00:11:23.870 --> 00:11:26.750\nI know it's disc two,\nnow I'm ready to write that image.\n\n230\n00:11:26.750 --> 00:11:28.550\nSo I'm gonna fire up a terminal.\n\n231\n00:11:30.480 --> 00:11:34.590\nAnd let me just get into my\nfolder where I downloaded it.\n\n232\n00:11:35.810 --> 00:11:39.200\nAnd I'm looking for\nthis memstick image right here.\n\n233\n00:11:39.200 --> 00:11:44.973\nI got the pfSense-memstick RELEASE 222 and\nit's the 64-bit one,\n\n234\n00:11:44.973 --> 00:11:51.037\nand I left it archived cuz I'm gonna just\nknock all this out in one fell swoop.\n\n235\n00:11:51.037 --> 00:11:54.260\nSo what I\"m gonna do is I'm\ngonna run two commands at once.\n\n236\n00:11:54.260 --> 00:11:58.120\nI'm gonna run the gzip command\nto unarchive my data and\n\n237\n00:11:58.120 --> 00:12:02.730\nthen I'm gonna pipe that output into\nthe DD command to write the data.\n\n238\n00:12:02.730 --> 00:12:06.410\nSo we'll unarchive and\nwrite to the media all at the same time.\n\n239\n00:12:06.410 --> 00:12:11.490\nSo I'm gonna use gzcat,\nwhich lets us view the archive and\n\n240\n00:12:11.490 --> 00:12:13.850\nconcatenate or output its data.\n\n241\n00:12:13.850 --> 00:12:19.852\nAnd I'm gonna do that with\nmy pfSense-memstick image.\n\n242\n00:12:19.852 --> 00:12:22.300\nSo that's what I'm gonna\nbe basically opening up.\n\n243\n00:12:23.330 --> 00:12:27.980\nAnd then I'm gonna use the pipe symbol\nto send the output of that command\n\n244\n00:12:27.980 --> 00:12:28.810\ninto another command.\n\n245\n00:12:28.810 --> 00:12:30.571\nAnd I'm gonna send that into dd.\n\n246\n00:12:30.571 --> 00:12:32.527\nThat's the disk writing utility.\n\n247\n00:12:32.527 --> 00:12:35.406\nI'm gonna say, the output file or\n\n248\n00:12:35.406 --> 00:12:40.188\nwhere I'm gonna send this\nto is gonna be /dev/disk2.\n\n249\n00:12:40.188 --> 00:12:42.171\nThat's what I got to know the disk number.\n\n250\n00:12:42.171 --> 00:12:43.270\nSo this is disk two.\n\n251\n00:12:44.280 --> 00:12:47.540\nAnd then I need to specify the block size.\n\n252\n00:12:47.540 --> 00:12:50.010\nDepending on your system,\nthis can be a little different.\n\n253\n00:12:50.010 --> 00:12:53.850\nOn a Linux system, you will typically\ndo one megabyte or just 1m.\n\n254\n00:12:53.850 --> 00:12:58.130\nOn a true BSD system,\nyou'll normally do 64k.\n\n255\n00:12:58.130 --> 00:13:00.781\nOn a Mac, for\nwhatever reason we end up doing 16k.\n\n256\n00:13:00.781 --> 00:13:02.280\nThat seems to be what they like.\n\n257\n00:13:02.280 --> 00:13:07.337\nSo I'm just gonna specify\nthat right there, bs=16k.\n\n258\n00:13:07.337 --> 00:13:10.758\nSo assuming I don't have\nany typos when I run this,\n\n259\n00:13:10.758 --> 00:13:15.590\nit's gonna unarchive and\nwrite to the disk media all in one swoop.\n\n260\n00:13:15.590 --> 00:13:17.600\nAnd well, I got permission denied.\n\n261\n00:13:17.600 --> 00:13:21.710\nRemember when you're in the terminal as a\nMAC user, you're not an admin by default.\n\n262\n00:13:21.710 --> 00:13:26.890\nSo I need to do a little sudo on this\none to get the elevated privileges.\n\n263\n00:13:26.890 --> 00:13:31.110\nAnd now, I can come in and\nspecify my password, if I can remember it.\n\n264\n00:13:32.150 --> 00:13:36.570\nAnd see how I got a permission\ndenied right off the bat?\n\n265\n00:13:36.570 --> 00:13:38.640\nWhat's going on there is I'm\nrunning two different commands.\n\n266\n00:13:39.710 --> 00:13:42.740\nThe first command, that gzcat,\nthat actually ran okay.\n\n267\n00:13:42.740 --> 00:13:46.160\nIt was the second command that failed, and\nso I got a permission denied right away.\n\n268\n00:13:46.160 --> 00:13:48.454\nSo I'm just gonna have to re run it.\n\n269\n00:13:48.454 --> 00:13:52.030\nAnd we should be back in business and\nyou know what actually, I'm still getting.\n\n270\n00:13:53.070 --> 00:13:57.087\nSo we'll probably have to sudo both of\nthese individually which is always fun.\n\n271\n00:13:57.087 --> 00:13:58.060\nBut we'll go ahead and do that.\n\n272\n00:13:58.060 --> 00:13:59.220\nThere we go.\n\n273\n00:13:59.220 --> 00:14:01.410\nSo now,\nI'm sudoing both of them individually.\n\n274\n00:14:01.410 --> 00:14:04.000\nSo we're gonna do the gzcat,\nthat's gonna unarchive it.\n\n275\n00:14:04.000 --> 00:14:07.130\nThe output then gets fed into the next\ncommand, where it's writing it.\n\n276\n00:14:07.130 --> 00:14:09.670\nAnd see how it looks like it's\nkind of stalled, it hasn't.\n\n277\n00:14:09.670 --> 00:14:10.594\nI'm looking down at my USB key and\n\n278\n00:14:10.594 --> 00:14:11.438\nI see the red light-\n>> [LAUGH]\n\n279\n00:14:11.438 --> 00:14:13.060\n>> Flashing away.\n\n280\n00:14:13.060 --> 00:14:15.860\nIt's writing that data to the USB key and\nwhen it's done,\n\n281\n00:14:15.860 --> 00:14:18.900\nI'll now have a bootable USB key.\n\n282\n00:14:18.900 --> 00:14:21.867\nNow Ronnie, you had a nice sort of\nblue bar that went across the screen,\n\n283\n00:14:21.867 --> 00:14:22.913\nprogress tracking GUI.\n\n284\n00:14:22.913 --> 00:14:24.860\n>> [LAUGH]\n>> All that good stuff.\n\n285\n00:14:24.860 --> 00:14:28.011\nI don't, so there are advantages\nto having that Web UI.\n\n286\n00:14:28.011 --> 00:14:31.603\nBut at the same time, I've got my\nsoftware right here on my system.\n\n287\n00:14:31.603 --> 00:14:34.445\nI didn't have to download anything.\n\n288\n00:14:34.445 --> 00:14:38.020\nBut once that's done, I'll have a USB\ninstalled media just like Ronnie did.\n\n289\n00:14:38.020 --> 00:14:40.730\nYou stick it in a computer and\nboot off it, and you're in business.\n\n290\n00:14:40.730 --> 00:14:43.122\nIn fact Ronnie and I,\nwe use the same image.\n\n291\n00:14:43.122 --> 00:14:44.160\n>> We do.\n\n292\n00:14:44.160 --> 00:14:47.110\n>> So the USB keys that we\ncreated should be identical.\n\n293\n00:14:47.110 --> 00:14:50.470\nThere should be no difference between\nhis that he made on Windows and\n\n294\n00:14:50.470 --> 00:14:53.050\nmine made on Mac cuz it was\nall from the same image.\n\n295\n00:14:55.840 --> 00:14:59.300\nSo those are pretty much yeah, and\nas far as making the install media,\n\n296\n00:14:59.300 --> 00:15:02.300\nthe only one we didn't show\nwas the compact flash.\n\n297\n00:15:02.300 --> 00:15:04.010\nIf you're doing the NanoBSD one.\n\n298\n00:15:04.010 --> 00:15:07.100\nIt's actually done the same way as\nthis LiveCD one that I did right here.\n\n299\n00:15:07.100 --> 00:15:08.070\nThe memstick one.\n\n300\n00:15:08.070 --> 00:15:12.528\nThe only difference is what you're writing\nto that flash is not an installer.\n\n301\n00:15:12.528 --> 00:15:16.670\nIt's actually pfSense\nalready ready to rock, but\n\n302\n00:15:16.670 --> 00:15:17.830\nthe installation method is the same.\n\n303\n00:15:17.830 --> 00:15:21.500\nYou can use Win 32 Disk Imager or\nyou can use DD like I did.\n\n304\n00:15:21.500 --> 00:15:22.547\nEither way, it creates a same one.\n\n305\n00:15:22.547 --> 00:15:25.100\nSo it's kind of duplicate.\n\n306\n00:15:25.100 --> 00:15:28.880\n>> Yeah, the advantage of using\nthe USB is speed more than anything\n\n307\n00:15:28.880 --> 00:15:32.810\nelse even compared to the regular\nCD that you would get.\n\n308\n00:15:32.810 --> 00:15:38.220\nHaving USB and it's fairly easy to just\nmove it from one device to another.\n\n309\n00:15:38.220 --> 00:15:39.890\nBut speed is pretty much the key.\n\n310\n00:15:39.890 --> 00:15:41.610\n>> Yeah, absolutely.\n\n311\n00:15:41.610 --> 00:15:44.270\nWell, once that's done you're ready\nto rock, you got your install media.\n\n312\n00:15:44.270 --> 00:15:46.650\nSo that's pretty much it for this episode.\n\n313\n00:15:46.650 --> 00:15:51.090\nWe got a chance to see building a CD and\nwe also saw using Windows and\n\n314\n00:15:51.090 --> 00:15:53.170\nusing a Mac to build the disk images.\n\n315\n00:15:53.170 --> 00:15:55.170\nNow, we've got pfSense and\nwe're ready to install.\n\n316\n00:15:55.170 --> 00:15:57.254\nSo that logically is gonna be-\n>> [LAUGH]\n\n317\n00:15:57.254 --> 00:15:58.400\n>> Our next episode.\n\n318\n00:15:58.400 --> 00:16:00.606\nSo if you wanna see the actual\ninstallation happen,\n\n319\n00:16:00.606 --> 00:16:01.670\nstay tuned for that one.\n\n320\n00:16:01.670 --> 00:16:04.317\nBut for this episode,\nI think that's a wrap, right Ronnie?\n\n321\n00:16:04.317 --> 00:16:05.144\n>> It is.\n\n322\n00:16:05.144 --> 00:16:07.466\n>> Stay tuned, and\nwe'll see you in the next episode.\n\n323\n00:16:07.466 --> 00:16:13.259\n[MUSIC]\n\n",
          "vimeoId": "130220852"
        },
        {
          "description": null,
          "length": "1080",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-3-installing_pfsense-060815-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-3-installing_pfsense-060815-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-3-installing_pfsense-060815-1-sm.jpg",
          "title": "Installing pfSense",
          "transcript": "WEBVTT\n\n1\n00:00:00.820 --> 00:00:07.627\n[MUSIC]\n\n2\n00:00:07.627 --> 00:00:11.280\nIn this segment we're gonna take a look at\ngetting pfSense installed onto our actual\n\n3\n00:00:11.280 --> 00:00:12.180\nhardware.\n\n4\n00:00:12.180 --> 00:00:14.717\nIn a previous episode, we showed how\nto make the actual installation media.\n\n5\n00:00:14.717 --> 00:00:16.435\nNow, we're gonna use it.\n\n6\n00:00:16.435 --> 00:00:18.540\nSo this is where the real action starts,\nright?\n\n7\n00:00:18.540 --> 00:00:22.983\nSo, if we want to install pfSense on our\nsystem, it's as simple as inserting the CD\n\n8\n00:00:22.983 --> 00:00:26.473\nor inserting the USB key that we\nset up as our installation media,\n\n9\n00:00:26.473 --> 00:00:27.693\nand booting off of it.\n\n10\n00:00:27.693 --> 00:00:30.119\nNow, if you're installing from a CD,\n\n11\n00:00:30.119 --> 00:00:33.950\nyour computer will probably\nboot from the CD automatically.\n\n12\n00:00:33.950 --> 00:00:35.660\nMost computers do that.\n\n13\n00:00:35.660 --> 00:00:38.950\nIf you're booting from a USB key,\nthough, it's not always a given.\n\n14\n00:00:38.950 --> 00:00:40.890\nNot every computer defaults\nto booting from USB.\n\n15\n00:00:40.890 --> 00:00:43.500\nIn fact, most of them don't for\nsecurity purposes.\n\n16\n00:00:43.500 --> 00:00:47.380\nSo you'll probably need to find some way\nto bring up a boot menu on your system.\n\n17\n00:00:47.380 --> 00:00:51.800\nIf you have a Dell, it's normally\npressing, what is it, F11 when you boot?\n\n18\n00:00:51.800 --> 00:00:56.230\nDifferent hardware vendors have\ndifferent shortcut keys for that.\n\n19\n00:00:56.230 --> 00:00:58.370\nBut you'll need a network menu or\n\n20\n00:00:58.370 --> 00:01:02.010\njust a boot menu to say I\nwanna boot off the USB key.\n\n21\n00:01:02.010 --> 00:01:05.220\nIf your system doesn't have a boot menu,\nyou can just go into BIOS and\n\n22\n00:01:05.220 --> 00:01:07.030\nyou can change the boot order.\n\n23\n00:01:07.030 --> 00:01:12.790\nDo be aware that if you have\na EFI BIOS that if you have secure\n\n24\n00:01:12.790 --> 00:01:17.666\nboot turned on that might be a problem\nbecause the USB installation image for\n\n25\n00:01:17.666 --> 00:01:19.269\npfSense is not an EFI image, so\n\n26\n00:01:19.269 --> 00:01:22.480\nyou'll need to turn on legacy boot\noptions to be able to boot that.\n\n27\n00:01:22.480 --> 00:01:24.910\nThose are all things that kinda\ninterfere with the boot process.\n\n28\n00:01:25.990 --> 00:01:29.995\nBut once you're past that, you boot the\nsystem, you tell it to boot from USB or\n\n29\n00:01:29.995 --> 00:01:32.410\nCD, and then you start the installer.\n\n30\n00:01:32.410 --> 00:01:33.515\nSo let's walk through that process,\n\n31\n00:01:33.515 --> 00:01:35.990\nI've got a system right\nhere that is ready to go.\n\n32\n00:01:35.990 --> 00:01:39.430\nAnd what we're gonna see is\nas it boots up, here it goes,\n\n33\n00:01:39.430 --> 00:01:41.390\nlaunching the pfSense boot installer.\n\n34\n00:01:41.390 --> 00:01:44.390\nNow, on our first screen you're\ngonna see some simple menu options,\n\n35\n00:01:44.390 --> 00:01:47.610\nand there was a timer at the bottom\nthat I just cleared out.\n\n36\n00:01:47.610 --> 00:01:49.850\nIt gives you about ten seconds to pick,\nand\n\n37\n00:01:49.850 --> 00:01:54.760\nif you don't pick it's just gonna go\nwith option number 1, Boot Multi User.\n\n38\n00:01:54.760 --> 00:01:57.970\nThe other options are really designed for\nrecovery stuff.\n\n39\n00:01:57.970 --> 00:01:59.650\nWe've got Boot [S]ingle User.\n\n40\n00:01:59.650 --> 00:02:01.790\nWell, that's if you're\ntrying to recover a system.\n\n41\n00:02:01.790 --> 00:02:03.810\nYou need to get in there, and\njust be able to access it.\n\n42\n00:02:03.810 --> 00:02:06.240\nYou don't want full services running.\n\n43\n00:02:06.240 --> 00:02:08.250\nYou've got [Esc]ape to the loader prompt.\n\n44\n00:02:08.250 --> 00:02:10.050\nIf you need to provide boot options,\n\n45\n00:02:10.050 --> 00:02:12.190\nmaybe certain hardware is\nnot detecting properly.\n\n46\n00:02:12.190 --> 00:02:16.210\nYou see that with RAID controllers and\nsome other hardware that can be a problem,\n\n47\n00:02:16.210 --> 00:02:18.880\nwhich really in a pfSense\nfirewall is not truly necessary.\n\n48\n00:02:18.880 --> 00:02:21.130\nAnd then you got reboot,\nthat's a good one.\n\n49\n00:02:21.130 --> 00:02:22.907\nIt kinda just undoes the whole boot thing.\n\n50\n00:02:22.907 --> 00:02:25.605\n[LAUGH] Then you got a few\nother options at the bottom.\n\n51\n00:02:25.605 --> 00:02:27.440\nKernel options and boot options.\n\n52\n00:02:27.440 --> 00:02:30.120\nAgain, for customizing the way\nthat our hardware is detected.\n\n53\n00:02:31.370 --> 00:02:34.700\nIn my case though, I'm ready to boot and\ngo, most people would be.\n\n54\n00:02:34.700 --> 00:02:39.535\nAnd so number 1 is the default and it\nwould've gone to that had I left it alone.\n\n55\n00:02:39.535 --> 00:02:42.580\nNow a lot of stuff is gonna\nscroll across the screen.\n\n56\n00:02:42.580 --> 00:02:46.370\nAnd what's happening is we're\nbooting up into FreeBSD.\n\n57\n00:02:46.370 --> 00:02:48.980\nAnd FreeBSD has to detect\nall of our hardware.\n\n58\n00:02:48.980 --> 00:02:51.390\nSo you'll see my VGA\ncard was just detected,\n\n59\n00:02:51.390 --> 00:02:54.400\nUSB, CD rights,\npicking up all of the hardware.\n\n60\n00:02:54.400 --> 00:02:59.080\nIt's not actually in pfSense yet\nuntil you see that pfSense logo pass by.\n\n61\n00:02:59.080 --> 00:03:01.520\nNow, I'm in pfSense.\n\n62\n00:03:01.520 --> 00:03:05.070\nWell, technically I'm in the installer,\nwell I'm screwing up the installer.\n\n63\n00:03:05.070 --> 00:03:07.720\nWell, shoot, now I'm just gonna make\nit do all sorts of crazy things.\n\n64\n00:03:07.720 --> 00:03:10.900\nBasically, it goes into the installer and\nit gives us a few options.\n\n65\n00:03:10.900 --> 00:03:13.920\nAnd the options that kinda passed\nby the screen on me there.\n\n66\n00:03:13.920 --> 00:03:16.590\nWe're covering things,\nactually let's do this Jason.\n\n67\n00:03:16.590 --> 00:03:17.540\nLet's see if we can't get back.\n\n68\n00:03:17.540 --> 00:03:19.012\nI wanna show those options.\n\n69\n00:03:19.012 --> 00:03:23.340\nAll right, so I've got this machine\nfiring up, it's booting off a CD or\n\n70\n00:03:23.340 --> 00:03:26.190\nUSB key, whatever installation\nmedia it is that you chose.\n\n71\n00:03:26.190 --> 00:03:28.850\nAnd you'll see you get a little\nmenu with a few options in it.\n\n72\n00:03:28.850 --> 00:03:31.780\nBoot multi user is the default,\nthat's what we normally want.\n\n73\n00:03:31.780 --> 00:03:35.330\nThe other options are if we need\nto change some our boot options.\n\n74\n00:03:35.330 --> 00:03:38.790\nYou might have a RAID controller or some\nother kind of specialized hardware that's\n\n75\n00:03:38.790 --> 00:03:41.980\ncausing a problem at boot time, and\nyou need to provide boot options.\n\n76\n00:03:41.980 --> 00:03:43.260\nAnd that's what most of\nthese center around.\n\n77\n00:03:43.260 --> 00:03:45.770\nYou'll see kernel choices, boot options.\n\n78\n00:03:45.770 --> 00:03:48.360\nThose are all just kinda\nembedded in there to choose that.\n\n79\n00:03:48.360 --> 00:03:52.000\nBut I'm gonna go with the standard\nMulti User, and that's gonna boot up.\n\n80\n00:03:52.000 --> 00:03:55.740\nAt this point, it's booting FreeBSD and\nit's detecting all of my hardware.\n\n81\n00:03:55.740 --> 00:03:57.680\nWe're not actually in pfSense yet.\n\n82\n00:03:57.680 --> 00:03:59.240\nWhen the text turns to gray,\n\n83\n00:03:59.240 --> 00:04:02.470\nwe'll be in pfSense, and\nwe'll get another couple of choices.\n\n84\n00:04:02.470 --> 00:04:06.210\nNow the choices are gonna go by kinda\nfast, we don't have a long timer here.\n\n85\n00:04:06.210 --> 00:04:08.400\nAnd you'll see, right here,\nit's kind of coming across.\n\n86\n00:04:08.400 --> 00:04:09.730\nI'm gonna pause this.\n\n87\n00:04:09.730 --> 00:04:11.730\nIt's a virtual machine, so I can pause it.\n\n88\n00:04:11.730 --> 00:04:13.940\nBut you'll see some of the little\nmenu options that I've got.\n\n89\n00:04:13.940 --> 00:04:15.450\nThere's really just three of them.\n\n90\n00:04:15.450 --> 00:04:19.600\n(R)ecovery mode, (I)nstaller,\nor (C)ontinue with the LiveCD.\n\n91\n00:04:19.600 --> 00:04:22.990\nThe reason the timer is so short on this,\nis that if you're booting up your system,\n\n92\n00:04:22.990 --> 00:04:25.270\nyou want your firewall\noperational as fast as possible.\n\n93\n00:04:25.270 --> 00:04:30.170\nSo the timer doesn't hang around very\nlong and there's no good way to pause it.\n\n94\n00:04:30.170 --> 00:04:31.764\nIf we choose (R)ecovery mode,\n\n95\n00:04:31.764 --> 00:04:34.660\nthat's what I would choose if\nmy firewall was messed up.\n\n96\n00:04:34.660 --> 00:04:37.410\nIf my firewall's messed up, the easiest\nthing to do is just format it and\n\n97\n00:04:37.410 --> 00:04:40.670\nput pfSense back on it, but\nyou lose all your configuration.\n\n98\n00:04:40.670 --> 00:04:45.220\nSo we can go into (R)ecovery mode,\nand we can back up the configuration,\n\n99\n00:04:45.220 --> 00:04:49.510\nerase the firewall, redeploy pfSense\non it, and put the config back again.\n\n100\n00:04:49.510 --> 00:04:52.520\nAnd we're right back to running\nan operational in short order.\n\n101\n00:04:52.520 --> 00:04:53.675\nSo that what (R)ecovery mode is for.\n\n102\n00:04:53.675 --> 00:04:59.050\n(I)nstaller is if I want to\ninstall pfSense on my hardware.\n\n103\n00:04:59.050 --> 00:05:01.670\nI don't wannna run the LiveCD,\nI don't wanna just run it from CD,\n\n104\n00:05:01.670 --> 00:05:05.500\nI wanna actually install to the machine,\nI would hit I.\n\n105\n00:05:05.500 --> 00:05:09.260\nAnd then C is (C)ontinue to the LiveCD,\nso I can hit that and\n\n106\n00:05:09.260 --> 00:05:12.930\nstart to move that process to\njust run from the CD itself.\n\n107\n00:05:12.930 --> 00:05:16.600\nIf I don't press anything,\nit is gonna run from the LiveCD.\n\n108\n00:05:16.600 --> 00:05:21.120\nSo if I resume this machine and\nI don't press anything,\n\n109\n00:05:21.120 --> 00:05:23.750\nwell it's gonna continue, and\nthe timer's ticking away.\n\n110\n00:05:23.750 --> 00:05:26.260\nIt's got a little stray characters\nthere from me doing stuff, but\n\n111\n00:05:26.260 --> 00:05:28.080\nI'll just hit C to continue.\n\n112\n00:05:28.080 --> 00:05:32.100\nNow it's actually going to run the pfSense\nfirewall entirely from the CD.\n\n113\n00:05:32.100 --> 00:05:34.730\nOn a positive side,\nI get a firewall very fast.\n\n114\n00:05:34.730 --> 00:05:35.980\nOn a negative side, if I reboot,\n\n115\n00:05:35.980 --> 00:05:38.800\nI lose everything that I did\nbecause it's just writing to RAM.\n\n116\n00:05:40.150 --> 00:05:44.380\nBut you'll see right here in the menu\noptions, I've got option 99,\n\n117\n00:05:44.380 --> 00:05:46.670\nInstall pfSense to a hard drive.\n\n118\n00:05:46.670 --> 00:05:51.830\nThat's the same as if I had chosen\nI back on the earlier menu screen.\n\n119\n00:05:51.830 --> 00:05:54.650\nSo if I had just hit an I, it would\nhave basically skipped all this and\n\n120\n00:05:54.650 --> 00:05:56.910\ngone right to 99 to install.\n\n121\n00:05:56.910 --> 00:05:59.890\nWell, most of the time we're going to\nwant to install to a hard drive and\n\n122\n00:05:59.890 --> 00:06:01.720\nnot do a CD boot like this.\n\n123\n00:06:01.720 --> 00:06:04.780\nSo I'm gonna go in and\nwe'll just restart and\n\n124\n00:06:04.780 --> 00:06:07.320\nrun through this process again just\na little more quickly this time.\n\n125\n00:06:07.320 --> 00:06:11.560\nAnd as we move through,\nwe'll just boot into multi user,\n\n126\n00:06:11.560 --> 00:06:15.470\nand then when it gets to the menu options,\nwe'll choose I to install.\n\n127\n00:06:15.470 --> 00:06:18.400\nI'm not interested in doing a LiveCD,\nI wanns get this installed.\n\n128\n00:06:19.880 --> 00:06:22.390\nNow you might actually see some\nerrors pop up through here if your\n\n129\n00:06:22.390 --> 00:06:24.000\nhardware isn't detected properly.\n\n130\n00:06:24.000 --> 00:06:27.220\nSo keep an eye out for that, but\nPSD's actually got really good hardware\n\n131\n00:06:27.220 --> 00:06:29.720\ncompatibility these days, so\nit's not normally an issue.\n\n132\n00:06:29.720 --> 00:06:32.970\nAll right,\nI'm choosing I to do my installation,\n\n133\n00:06:32.970 --> 00:06:35.632\nand it's doing some additional\nhardware detection.\n\n134\n00:06:35.632 --> 00:06:38.630\nYou might've noticed there,\nit picked up that I'm running VMware.\n\n135\n00:06:38.630 --> 00:06:39.799\nSo the installer is aware of this.\n\n136\n00:06:39.799 --> 00:06:43.582\nYou don't have to install on physical\nhardware, you can install on XenServer,\n\n137\n00:06:43.582 --> 00:06:44.600\nHyper-V, VMware.\n\n138\n00:06:44.600 --> 00:06:49.240\nYou can install it in Amazon EC2,\nyou can install it all sorts of places and\n\n139\n00:06:49.240 --> 00:06:50.050\nit's really pretty powerful.\n\n140\n00:06:51.780 --> 00:06:54.770\nAll right, next, it's just gonna\nask some basic compatibility\n\n141\n00:06:54.770 --> 00:06:58.120\nquestions about my screen,\nmy keyboard, and so on.\n\n142\n00:06:58.120 --> 00:07:01.560\nThe defaults are all set up for\nthe United States.\n\n143\n00:07:01.560 --> 00:07:05.170\nIf you're not using a U.S. keyboard, or if\nyou're not using a U.S. alphabet, you can\n\n144\n00:07:05.170 --> 00:07:08.990\ngo through here and choose those options,\nand update that to reflect your locale.\n\n145\n00:07:08.990 --> 00:07:09.740\nYou may need to do that.\n\n146\n00:07:10.770 --> 00:07:13.590\nFor me though, I can go ahead and\naccept it, and\n\n147\n00:07:13.590 --> 00:07:16.040\nnow it's asking what type\nof install I want to do.\n\n148\n00:07:16.040 --> 00:07:18.090\nQuick, Custom, or Rescue.\n\n149\n00:07:19.470 --> 00:07:23.910\nRescue, that's where I've already got\na firewall and it's just not booting.\n\n150\n00:07:23.910 --> 00:07:25.250\nIt's got some problem.\n\n151\n00:07:25.250 --> 00:07:26.480\nRescue config.xml.\n\n152\n00:07:26.480 --> 00:07:29.690\nThat means it's gonna try and\nget the configuration file and\n\n153\n00:07:29.690 --> 00:07:33.710\nthen rebuild the firewall using that file,\nif it can.\n\n154\n00:07:33.710 --> 00:07:35.820\nIt may be the damage is too great,\nit can't get at that, but\n\n155\n00:07:35.820 --> 00:07:36.800\nthis is one way to try.\n\n156\n00:07:38.490 --> 00:07:41.230\nCustom Install is if I wanna\nmodify the installation options,\n\n157\n00:07:41.230 --> 00:07:45.200\nthe size of the partitions, what files\nare being written, things of that nature.\n\n158\n00:07:45.200 --> 00:07:47.700\nYou can modify all that during\nthe install if you want.\n\n159\n00:07:47.700 --> 00:07:49.650\nBut most of us want that Quick and Easy.\n\n160\n00:07:51.690 --> 00:07:53.680\nNow we run through the Quick and\nEasy, it's just gonna warn us, hey,\n\n161\n00:07:53.680 --> 00:07:55.670\nwe're gonna format your hard drive.\n\n162\n00:07:55.670 --> 00:07:56.950\nThat's what it's gonna do,\n\n163\n00:07:56.950 --> 00:08:00.340\nit's gonna assume this drive is\ndedicated for pfSense and wipe it out.\n\n164\n00:08:00.340 --> 00:08:03.431\nSo it's gonna say it will\ninstall automatically.\n\n165\n00:08:03.431 --> 00:08:06.390\nIt won't ask me any questions,\nit's just gonna do it.\n\n166\n00:08:06.390 --> 00:08:09.420\nIt's gonna format the first\nhard drive it finds.\n\n167\n00:08:09.420 --> 00:08:11.520\nIf I want to customize that,\npick different drives or\n\n168\n00:08:11.520 --> 00:08:15.320\ndifferent partitions, I need to go\nback out and do the custom install.\n\n169\n00:08:15.320 --> 00:08:18.230\nNow it does say,\nit's not gonna ask any questions.\n\n170\n00:08:18.230 --> 00:08:21.210\nBut that doesn't mean I'm locked\ninto one method of install.\n\n171\n00:08:21.210 --> 00:08:24.550\nOnce the install is done, we can go\nback in and change whatever we want.\n\n172\n00:08:24.550 --> 00:08:28.030\nWe have a lot of flexibility\nonce the system is up.\n\n173\n00:08:28.030 --> 00:08:30.846\nI'll just choose OK and\nthere it goes, it's wiped the disk,\n\n174\n00:08:30.846 --> 00:08:34.747\nit's building the different mount points\nwhere it's gonna put the operating system\n\n175\n00:08:34.747 --> 00:08:36.390\nin place, and the other software.\n\n176\n00:08:36.390 --> 00:08:39.840\nAnd once it's done,\nit's gonna ask some questions.\n\n177\n00:08:39.840 --> 00:08:40.590\n>> [LAUGH]\n>> So much for\n\n178\n00:08:40.590 --> 00:08:42.530\nproceeding with no questions, right?\n\n179\n00:08:42.530 --> 00:08:44.620\nWhat I really meant was that it was\ngoing to proceed with the hard drive\n\n180\n00:08:44.620 --> 00:08:46.300\nformat without any questions.\n\n181\n00:08:46.300 --> 00:08:47.880\nNow we get real questions.\n\n182\n00:08:47.880 --> 00:08:50.978\n>> Now on this particular question, notice\nit's asking us how we want to actually\n\n183\n00:08:50.978 --> 00:08:54.740\ninstall this, whether we're gonna use that\nstandard kernel or the embedded kernel.\n\n184\n00:08:54.740 --> 00:08:57.320\nMost of us, if we're actually using\nan older machine, or a laptop,\n\n185\n00:08:57.320 --> 00:08:58.680\nit's gonna be the standard kernel.\n\n186\n00:08:58.680 --> 00:09:01.630\nIf you did buy an appliance for it, in\nother words, one that doesn't have a hard\n\n187\n00:09:01.630 --> 00:09:05.440\ndrive and you're gonna install it, you\nmight choose that embedded kernel instead.\n\n188\n00:09:05.440 --> 00:09:07.960\n>> And what this really boils down\nto is where the screen output goes.\n\n189\n00:09:07.960 --> 00:09:11.320\nDoes the screen output\ngo to a VGA monitor or\n\n190\n00:09:11.320 --> 00:09:14.390\na monitor in general,\nlike you'd have on a laptop or a PC?\n\n191\n00:09:14.390 --> 00:09:16.990\nOr does the screen output\ngo to a serial port?\n\n192\n00:09:16.990 --> 00:09:20.120\nAnd that's why it's saying that,\nno VGA console or keyboard.\n\n193\n00:09:20.120 --> 00:09:23.460\nYou're just outputting to\na serial port and using that.\n\n194\n00:09:23.460 --> 00:09:28.170\nIf you choose serial, you need to have\na serial cable to be able to connect and\n\n195\n00:09:28.170 --> 00:09:29.800\na serial port on the system.\n\n196\n00:09:29.800 --> 00:09:33.030\nIf you choose this for a system that\ndoesn't have a serial port, you've got\n\n197\n00:09:33.030 --> 00:09:35.920\nno way to get screen output anymore, and\nyou can lock yourself out of the system.\n\n198\n00:09:36.970 --> 00:09:40.200\nWell, for mine, it's a virtual machine so\nI actually do have a screen on it,\n\n199\n00:09:40.200 --> 00:09:42.600\nso I'll choose the standard kernel.\n\n200\n00:09:42.600 --> 00:09:45.280\nAll right, now it's gonna go and\nfinish that install.\n\n201\n00:09:45.280 --> 00:09:49.160\nWhen it's done,\neverything we need is on the hard drive.\n\n202\n00:09:49.160 --> 00:09:52.550\nI don't need my USB key or\nmy CD drive anymore.\n\n203\n00:09:52.550 --> 00:09:54.880\nSo you can take those out,\nyou're done with those.\n\n204\n00:09:54.880 --> 00:09:59.090\nAnd when you reboot, it's gonna\nboot from the hard drive itself.\n\n205\n00:09:59.090 --> 00:10:03.075\nAnd notice on this screen, it tells me the\ndefault IP address, the default username,\n\n206\n00:10:03.075 --> 00:10:04.338\nand the default password.\n\n207\n00:10:04.338 --> 00:10:07.536\nThe default IP is 192.168.1.1,\n\n208\n00:10:07.536 --> 00:10:11.750\nDefault username is admin,\ndefault password is pfsense.\n\n209\n00:10:12.920 --> 00:10:15.920\nSo once it reboots,\nit'll be up and running.\n\n210\n00:10:15.920 --> 00:10:17.538\nHere it goes booting.\n\n211\n00:10:17.538 --> 00:10:20.390\nAnd it's gonna boot from the hard\ndrive instead of the CD drive.\n\n212\n00:10:20.390 --> 00:10:24.490\nIt's giving me a moment here where I can\npress F1 to get to boot options if I want.\n\n213\n00:10:24.490 --> 00:10:26.230\nBut if I just ignore that and\nwait a moment,\n\n214\n00:10:26.230 --> 00:10:29.240\nit's gonna actually boot off\nthe hard drive, here it goes.\n\n215\n00:10:29.240 --> 00:10:32.680\nAnd we'll see menus that are very\nsimilar to the USB or CD.\n\n216\n00:10:33.770 --> 00:10:35.670\nBut it's gonna move through\nthose a little more quickly.\n\n217\n00:10:35.670 --> 00:10:40.211\nAnd here in just a moment, I'm not\ngonna see the install or LiveCD menu,\n\n218\n00:10:40.211 --> 00:10:44.841\nit's just gonna pass right by that,\nand go into the main pfSense screen.\n\n219\n00:10:44.841 --> 00:10:46.551\nThere we go.\nThat was where we would've seen the menu\n\n220\n00:10:46.551 --> 00:10:47.665\njust a moment ago.\n\n221\n00:10:47.665 --> 00:10:50.160\nPassed right by that, and\nthen we'll get our main screen.\n\n222\n00:10:51.300 --> 00:10:56.700\nNow on our main screen, you can actually\ndo some very basic configuration changes.\n\n223\n00:10:56.700 --> 00:10:59.590\nTypically, there's not\nmuch we wanna change here.\n\n224\n00:10:59.590 --> 00:11:03.100\nWe wanna make sure that we have an IP\naddress assigned to the system so\n\n225\n00:11:03.100 --> 00:11:05.100\nthat we can remotely manage it and\nconnect to it.\n\n226\n00:11:06.170 --> 00:11:09.350\nAnd that's pretty much all we need.\n\n227\n00:11:09.350 --> 00:11:11.880\nAnd the default install\nwill typically do that.\n\n228\n00:11:11.880 --> 00:11:15.211\nIf I look up here, I can see where\nit's saying Welcome to pfSense, so\n\n229\n00:11:15.211 --> 00:11:15.963\nI know I'm up.\n\n230\n00:11:15.963 --> 00:11:19.420\nAnd then it detected two network\ninterfaces, em0 and em1.\n\n231\n00:11:19.420 --> 00:11:22.200\nThose are the two network\ncards it detected.\n\n232\n00:11:22.200 --> 00:11:26.810\nOn one of them it got a DHCP address,\nso it assumed that was the Internet.\n\n233\n00:11:26.810 --> 00:11:30.840\nAnd on the other it didn't get a DHCP\naddress, so it assumes that's the inside.\n\n234\n00:11:30.840 --> 00:11:32.720\nWell, you know what\nhappens when you assume.\n\n235\n00:11:32.720 --> 00:11:36.230\nIt could be wrong, so\nwe might have to adjust that, and\n\n236\n00:11:36.230 --> 00:11:37.770\nyou'll see the options in here.\n\n237\n00:11:37.770 --> 00:11:41.519\nIf you look at Set interface(s)\nIP address or Assign an IP or\n\n238\n00:11:41.519 --> 00:11:44.394\nInterfaces, we can start\nto customize that.\n\n239\n00:11:44.394 --> 00:11:48.235\nSo if I need to do that if,\nit doesn't detect rightly,\n\n240\n00:11:48.235 --> 00:11:52.502\nwe can say Assign Interfaces,\nI'll take option number 1.\n\n241\n00:11:52.502 --> 00:11:53.545\nAnd it's gonna say,\ndo I want to set up VLANs?\n\n242\n00:11:53.545 --> 00:11:56.218\nWell we're gonna talk about\nVLANs in another episode, so\n\n243\n00:11:56.218 --> 00:11:59.140\nI'll leave those off for now, I'll say no.\n\n244\n00:11:59.140 --> 00:12:02.440\nAnd now it's gonna ask me to pick\nwhich one is the WAN interface.\n\n245\n00:12:03.730 --> 00:12:07.730\nI can type the name if I know based\non the MAC address up here which one\n\n246\n00:12:07.730 --> 00:12:09.650\nis the WAN interface, I can pick.\n\n247\n00:12:09.650 --> 00:12:13.330\nIf I don't know,\nthe way it auto detects is by using DHCP.\n\n248\n00:12:13.330 --> 00:12:16.910\nIf it gets a DHCP address,\nit assumes that's the WAN one.\n\n249\n00:12:16.910 --> 00:12:19.010\nThat may not be happening\nautomatically on my network, though,\n\n250\n00:12:19.010 --> 00:12:23.460\nI might need to tell it, hey,\nthat one's the Internet, em0.\n\n251\n00:12:23.460 --> 00:12:25.685\nAnd then for the LAN,\nI can leave that to auto also,\n\n252\n00:12:25.685 --> 00:12:28.940\nit'll just pick whatever other one I have,\nor I can type in and I'll do em1.\n\n253\n00:12:30.730 --> 00:12:34.562\nIf you have more interfaces, if you're\nsetting up a DMZ you could specify their\n\n254\n00:12:34.562 --> 00:12:38.410\nnames here, but honestly I usually do\nthis in the web interface after the fact.\n\n255\n00:12:38.410 --> 00:12:39.764\nSo even if I have more interfaces,\n\n256\n00:12:39.764 --> 00:12:41.670\nI normally just hit Enter\nto say that I'm done.\n\n257\n00:12:41.670 --> 00:12:45.190\nAll right, so\nnow it is just mapping WAN and LAN.\n\n258\n00:12:46.790 --> 00:12:50.262\nAnd then next,\nwe can assign IP addresses if necessary.\n\n259\n00:12:50.262 --> 00:12:53.920\nIt assigned 192.168.1.1 as my internal IP.\n\n260\n00:12:53.920 --> 00:12:55.229\nMaybe I don't like that.\n\n261\n00:12:55.229 --> 00:12:59.420\nMaybe I want 192.168.0.1\non my internal network.\n\n262\n00:12:59.420 --> 00:13:02.660\nWell, we can change that too,\nas soon as it gets me back to my menu.\n\n263\n00:13:02.660 --> 00:13:06.050\nAnd then we'll be able to modify that\nIP to whatever range it is we want.\n\n264\n00:13:06.050 --> 00:13:07.190\nThere we go.\n\n265\n00:13:07.190 --> 00:13:12.170\nSo I'm gonna do option number 2,\nwhich is Set interface(s) IP address.\n\n266\n00:13:12.170 --> 00:13:15.360\nNow I can set my WAN one, but\nI'm gonna leave that at DHCP,\n\n267\n00:13:15.360 --> 00:13:18.290\nthat's how a lot of us have our\nInternet connections anyway.\n\n268\n00:13:18.290 --> 00:13:22.340\nAnd then, for the inside,\nI'll choose that one, interface 2.\n\n269\n00:13:22.340 --> 00:13:23.228\nAnd, I'll give it its IP address.\n\n270\n00:13:23.228 --> 00:13:27.290\nI want it to be 192.168.0.1.\n\n271\n00:13:27.290 --> 00:13:31.260\nNow, when I provide the IP, if I just\nput the IP address in and press Enter,\n\n272\n00:13:31.260 --> 00:13:33.910\nit's gonna have to ask me\nwhat Subnet mask I'm using.\n\n273\n00:13:33.910 --> 00:13:39.090\nAnd we'll use a standard class C,\nwhich is a 24-bit Subnet mask.\n\n274\n00:13:39.090 --> 00:13:40.970\nAfter that, we're done, I can press Enter.\n\n275\n00:13:42.140 --> 00:13:45.740\nAnd Enter again, so\nit's gonna use DHCP for that one.\n\n276\n00:13:45.740 --> 00:13:50.580\nAnd now it's asking if I want to use\na DHCP server on my local area network.\n\n277\n00:13:50.580 --> 00:13:51.320\nAnd we normally do.\n\n278\n00:13:51.320 --> 00:13:54.120\nYou might already have a DHCP server,\nso you'd say no, but\n\n279\n00:13:54.120 --> 00:13:56.840\nin my case I don't, so I'll say yes.\n\n280\n00:13:56.840 --> 00:13:58.780\nAnd it's gonna ask me for my ranges.\n\n281\n00:13:58.780 --> 00:14:02.690\nSo I might want to start\nmy range at 192.168.100.\n\n282\n00:14:02.690 --> 00:14:05.070\nAnd I guess my head's kind\nof on top of that, but\n\n283\n00:14:05.070 --> 00:14:07.010\nyou guys will see it in just a second.\n\n284\n00:14:07.010 --> 00:14:11.069\nAnd I'll run that all the way through,\n192.168.0.150.\n\n285\n00:14:11.069 --> 00:14:18.490\nAnd the last question it asks is whether\nI wanna use HTTP or HTTPS for the system.\n\n286\n00:14:18.490 --> 00:14:23.810\nIt defaults to HTTPS, and it's asking\nhere if I wanna revert it to HTTP.\n\n287\n00:14:23.810 --> 00:14:28.450\nIn the past, you'd never want to do this,\nbut on some of the newer browsers like\n\n288\n00:14:28.450 --> 00:14:32.960\nGoogle Chrome, they're getting really\nstrict about having trusted certificates.\n\n289\n00:14:32.960 --> 00:14:36.690\nSo you might need to say yes\nto revert this to HTTP, and\n\n290\n00:14:36.690 --> 00:14:40.160\nthen the first time you get into\nthe panel create a new certificate so\n\n291\n00:14:40.160 --> 00:14:41.920\nthat it'll work in your system.\n\n292\n00:14:41.920 --> 00:14:44.900\nOtherwise, you might lock yourself\nout because of a certificate check.\n\n293\n00:14:44.900 --> 00:14:46.750\nI'm actually gonna go ahead and\nsay yes to revert that.\n\n294\n00:14:47.860 --> 00:14:51.520\nThat's the last choice it made, and now my\nhead is off the top of those IP addresses.\n\n295\n00:14:51.520 --> 00:14:54.501\nSo, you can see where I\ntyped in .100 though .150.\n\n296\n00:14:54.501 --> 00:14:58.593\nI picked 50 IPs just\nbecause I felt like it.\n\n297\n00:14:58.593 --> 00:15:01.985\nAll right, we got a question in the\nchatroom about those network interfaces\n\n298\n00:15:01.985 --> 00:15:04.060\nabout why they're called em0 versus eth0.\n\n299\n00:15:04.060 --> 00:15:07.230\nIf I were running this on actual hardware,\n\n300\n00:15:07.230 --> 00:15:10.580\nthey would show up as eth0,\neth1, and so on.\n\n301\n00:15:10.580 --> 00:15:14.090\nI'm running this inside of VMWare, and\nin VMWare it makes them show up as em0.\n\n302\n00:15:15.100 --> 00:15:17.630\nKnow that on different hardware, they can\nshow up with different names, though.\n\n303\n00:15:17.630 --> 00:15:18.270\nIt is possible.\n\n304\n00:15:21.122 --> 00:15:22.780\nAll right, once that's done,\nit just gives me my IP.\n\n305\n00:15:22.780 --> 00:15:28.010\nIt says, hey, I should be able to get to\nthis firewall at 192.168.0.1, and log in.\n\n306\n00:15:28.010 --> 00:15:31.390\nUsername admin, password pfsense,\nand get to work.\n\n307\n00:15:32.990 --> 00:15:35.598\nMy basic install should be done,\nlet's go see what happens.\n\n308\n00:15:35.598 --> 00:15:38.460\nI'm gonna flip over to a little\nWindows 8 machine that I've got\n\n309\n00:15:38.460 --> 00:15:42.550\nsetting on that same network,\nand it's picked up a new network.\n\n310\n00:15:42.550 --> 00:15:43.840\nWe'll have to see if it's the right one.\n\n311\n00:15:43.840 --> 00:15:46.040\nThat's always a part of the challenge,\nright?\n\n312\n00:15:46.040 --> 00:15:48.510\nSo let me, I'm just gonna fire\nup a command prompt here and\n\n313\n00:15:48.510 --> 00:15:51.560\nsee what network I actually ended up on.\n\n314\n00:15:51.560 --> 00:15:55.977\nIf I look at my IP, I got 192.168.1.100.\n\n315\n00:15:55.977 --> 00:15:59.360\nI'm in that pool that we created.\n\n316\n00:15:59.360 --> 00:16:02.524\nAnd notice my default gateway is wrong,\nwe'll have to sort that out.\n\n317\n00:16:02.524 --> 00:16:04.018\nI still have 1.1, oh actually.\n\n318\n00:16:04.018 --> 00:16:04.640\nYou know what?\n\n319\n00:16:04.640 --> 00:16:05.760\nI'm-\n>> Not on the right network.\n\n320\n00:16:05.760 --> 00:16:07.390\n>> Not on the right network at all.\n\n321\n00:16:07.390 --> 00:16:10.824\nAll right,\nI'm gonna do an ipconfig/release,\n\n322\n00:16:10.824 --> 00:16:13.370\nwhich it seems to be thinking about.\n\n323\n00:16:13.370 --> 00:16:14.090\nThere we go.\n\n324\n00:16:14.090 --> 00:16:16.076\nAnd I'll do an ipconfig/renew.\n\n325\n00:16:16.076 --> 00:16:20.280\nI'll make sure that I get a new IP address\nthat hopefully is in the right range.\n\n326\n00:16:20.280 --> 00:16:22.560\nAnd assuming that I am, there we go.\n\n327\n00:16:22.560 --> 00:16:24.190\nNow those are right.\n\n328\n00:16:24.190 --> 00:16:26.100\nI should be able to get to that firewall.\n\n329\n00:16:26.100 --> 00:16:28.149\nI will cringe as I fire\nup Internet Explorer.\n\n330\n00:16:28.149 --> 00:16:30.766\n>> [LAUGH]\n>> [LAUGH] And\n\n331\n00:16:30.766 --> 00:16:33.919\nI'm gonna browse to 192.168.0.1.\n\n332\n00:16:33.919 --> 00:16:40.120\nHad I left HTTPS on,\nI would type https://whatever.\n\n333\n00:16:40.120 --> 00:16:42.380\nBut, I chose to revert it,\nand remember why I did that.\n\n334\n00:16:42.380 --> 00:16:45.810\nNot because I don't care about SSL, but\nbecause on some newer browsers, they're\n\n335\n00:16:45.810 --> 00:16:49.530\ngetting really strict, so I'll probably\nwanna go in and create my own certificate.\n\n336\n00:16:49.530 --> 00:16:50.565\nSo, that's why I did that.\n\n337\n00:16:50.565 --> 00:16:57.360\nAnd I'm just gonna log in with\nusername admin, password pfsense,\n\n338\n00:16:57.360 --> 00:17:01.430\nand once I log in, it takes me to\nthe initial configuration wizard.\n\n339\n00:17:02.980 --> 00:17:06.970\nWhat we just did was installing\npfSense onto this hardware, and\n\n340\n00:17:06.970 --> 00:17:09.250\nnow we're ready to do our\ninitial configuration.\n\n341\n00:17:09.250 --> 00:17:09.806\nAll right,\n\n342\n00:17:09.806 --> 00:17:14.060\nnow the configuration that I put on there\nalready is actually somewhat functional.\n\n343\n00:17:14.060 --> 00:17:16.840\nMachines inside of the network should\nbe able to get out to the Internet,\n\n344\n00:17:16.840 --> 00:17:19.720\nshould be able to browse through,\nbut obviously there's a lot more.\n\n345\n00:17:19.720 --> 00:17:21.210\nWe need to change that default password,\n\n346\n00:17:21.210 --> 00:17:24.960\nwe need to configure our certificate, we\nneed to configure all those other things.\n\n347\n00:17:24.960 --> 00:17:28.880\nBut that's all great stuff for\nour next episode.\n\n348\n00:17:28.880 --> 00:17:32.380\nAs far the basic install of\npfSense though, that's it, right?\n\n349\n00:17:32.380 --> 00:17:35.600\nSimple wizard, you might need\nto reassign some interfaces,\n\n350\n00:17:35.600 --> 00:17:38.112\nyou might need to assign some IPs,\nbut for the most part, that's it.\n\n351\n00:17:38.112 --> 00:17:42.250\nAll right, well ladies and gentleman, this\nis a good spot for us to wrap this one.\n\n352\n00:17:42.250 --> 00:17:45.684\nWe'll pause here, and stayed tuned,\nwe're gonna have our next episode of doing\n\n353\n00:17:45.684 --> 00:17:49.017\nthe initial configs, as we go through and\nstart to tweak all the little things we\n\n354\n00:17:49.017 --> 00:17:51.036\nneed to do before we move\nthis into production.\n\n355\n00:17:51.036 --> 00:17:53.689\nSo stay tuned for that, and\nwe'll see you next time.\n\n356\n00:17:53.689 --> 00:17:59.639\n[MUSIC]\n\n",
          "vimeoId": "130220847"
        },
        {
          "description": null,
          "length": "1267",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-4-initial_configuration-060815-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-4-initial_configuration-060815-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-4-initial_configuration-060815-1-sm.jpg",
          "title": "Initial Configuration",
          "transcript": "WEBVTT\n\n1\n00:00:00.243 --> 00:00:07.649\n[MUSIC]\n\n2\n00:00:07.649 --> 00:00:08.455\nIn this segment,\n\n3\n00:00:08.455 --> 00:00:12.450\nwe're gonna take a look at the Initial\nConfiguration of a pfSence firewall.\n\n4\n00:00:12.450 --> 00:00:15.564\nSo, at this point,\nyou've installed pfSense on the hardware,\n\n5\n00:00:15.564 --> 00:00:19.484\nyou've booted it up, you finished its\nquick little mini installer that it does.\n\n6\n00:00:19.484 --> 00:00:21.526\nAnd the firewall's just\nsitting there humming along,\n\n7\n00:00:21.526 --> 00:00:23.187\nit's time to get some work done,\nall right?\n\n8\n00:00:23.187 --> 00:00:26.461\nThis would be where you start if\nyou're buying an appliance, right?\n\n9\n00:00:26.461 --> 00:00:29.999\nOne that has pfSense pre-installed,\nbut if you're installing it yourself,\n\n10\n00:00:29.999 --> 00:00:33.483\ndefinitely double back to our episodes\nwhere we show you how to install pfSense\n\n11\n00:00:33.483 --> 00:00:34.770\non your hardware.\n\n12\n00:00:34.770 --> 00:00:37.028\nBut once it's there, you fire it up and\n\n13\n00:00:37.028 --> 00:00:40.460\nthe console really just gives\nyou some basic information.\n\n14\n00:00:40.460 --> 00:00:44.530\nSo for example here, let me show\nyou the console of my firewall.\n\n15\n00:00:44.530 --> 00:00:45.860\nSo when you boot it up,\nit just comes up and\n\n16\n00:00:45.860 --> 00:00:50.150\nit shows you, right here,\nwhat the IP address of your firewall is.\n\n17\n00:00:50.150 --> 00:00:53.160\nAnd if you haven't configured it before,\nthe user name is admin,\n\n18\n00:00:53.160 --> 00:00:55.330\nand the password is pfSense.\n\n19\n00:00:55.330 --> 00:00:59.030\nSo you take a computer on your local\nnetwork and you browse for that IP.\n\n20\n00:00:59.030 --> 00:01:02.970\nAnd when you browse to it,\nyou'll see this webpage right here.\n\n21\n00:01:02.970 --> 00:01:06.270\nAnd you just login with that\ndefault user name and password.\n\n22\n00:01:06.270 --> 00:01:09.600\nAdmin and pfSense for the password.\n\n23\n00:01:09.600 --> 00:01:12.640\nNow, obviously it's a bad idea to\nstick with default usernames and\n\n24\n00:01:12.640 --> 00:01:15.770\ndefault passwords, so\nwe need to get things set up.\n\n25\n00:01:15.770 --> 00:01:19.950\nThe first time you log in, it's gonna\ntake you to the initial setup wizard.\n\n26\n00:01:19.950 --> 00:01:23.010\nNow, mine skipped the initial\nsetup wizard because\n\n27\n00:01:23.010 --> 00:01:24.560\nI'd already logged into it once, right?\n\n28\n00:01:24.560 --> 00:01:26.410\nSo once you've logged into it,\nit does that.\n\n29\n00:01:26.410 --> 00:01:30.230\nIf you're like me, you can always\njust go to System > Setup Wizard, and\n\n30\n00:01:30.230 --> 00:01:32.130\nthat'll repeat the process, all right?\n\n31\n00:01:32.130 --> 00:01:35.380\nThe first time you log in,\npunch in username and password, and\n\n32\n00:01:35.380 --> 00:01:36.960\nyou'll get this screen.\n\n33\n00:01:36.960 --> 00:01:40.850\nIt's a simple wizard that walks us\nthrough the basic steps that we need\n\n34\n00:01:40.850 --> 00:01:42.938\nto get things configured and\nafter that, it goes away.\n\n35\n00:01:42.938 --> 00:01:44.680\nAnd you won't get bugged by\nthis wizard again unless you\n\n36\n00:01:44.680 --> 00:01:45.730\nchoose to run it, like I just did.\n\n37\n00:01:47.560 --> 00:01:51.810\nAll right, well, on our first screen,\nit's really just kind of not asking us to\n\n38\n00:01:51.810 --> 00:01:55.630\nconfigure or anything, but making us\naware of how pfSense makes their money.\n\n39\n00:01:55.630 --> 00:01:59.130\nThey just gave you the software for free\nand you might be installing it on hardware\n\n40\n00:01:59.130 --> 00:02:02.130\nyou had laying around and so\nyou didn't pay them for that either.\n\n41\n00:02:02.130 --> 00:02:02.862\nThey didn't get any money.\n\n42\n00:02:02.862 --> 00:02:04.570\n>> [LAUGH]\n>> You might have also noticed that when\n\n43\n00:02:04.570 --> 00:02:08.000\nyou go to the pfSense website,\nthere's not a bunch of advertisements.\n\n44\n00:02:08.000 --> 00:02:09.210\nHow do they make their money?\n\n45\n00:02:09.210 --> 00:02:10.370\nThrough support.\n\n46\n00:02:10.370 --> 00:02:12.470\nIf you get a gold\nsubscription with pfSense,\n\n47\n00:02:12.470 --> 00:02:15.510\nthey'll help you with phone\nticket calls and so on.\n\n48\n00:02:15.510 --> 00:02:16.380\nThat's how they make their money.\n\n49\n00:02:16.380 --> 00:02:18.120\nThat's how we support them, right?\n\n50\n00:02:18.120 --> 00:02:19.790\nIt's a good idea to do that.\n\n51\n00:02:19.790 --> 00:02:24.170\nBut in the meantime, we'll hit Next, and\nnow we get to the actual configuration.\n\n52\n00:02:24.170 --> 00:02:27.020\nIt's gonna ask for\na host name for the system.\n\n53\n00:02:27.020 --> 00:02:30.060\nNow, nobody's gonna see the host\nname except for administrators.\n\n54\n00:02:30.060 --> 00:02:33.390\nIf you only have one pfSense firewall,\nyou might leave it as pfSense.\n\n55\n00:02:33.390 --> 00:02:36.210\nBut if I have a bunch of them,\nI might want to name them.\n\n56\n00:02:36.210 --> 00:02:38.240\nSo for example, I'm in Gainesville, right?\n\n57\n00:02:38.240 --> 00:02:42.680\nSo we might call this the gnv-fw,\ngnv firewall, or something.\n\n58\n00:02:42.680 --> 00:02:46.380\nYou can call it whatever you want,\nyou can punch in that name.\n\n59\n00:02:46.380 --> 00:02:50.850\nIt does need to obey the basic DNS rules,\nno spaces or\n\n60\n00:02:50.850 --> 00:02:52.430\nexclamation points, things like that.\n\n61\n00:02:52.430 --> 00:02:55.870\nBut you just punch in a name and a domain.\n\n62\n00:02:55.870 --> 00:02:59.880\nSo maybe I'll say this one is\nlab.itpro.tv for my domain.\n\n63\n00:02:59.880 --> 00:03:02.980\n>> Now, Don, I think you make a very\nimportant emphasis here that we\n\n64\n00:03:02.980 --> 00:03:05.170\nreally need to point out, which is,\n\n65\n00:03:05.170 --> 00:03:09.780\nunder that hostname,\nis to make sure we follow that DNS name.\n\n66\n00:03:09.780 --> 00:03:13.700\nCuz if you don't and later on when you go\nto configure something, you might find out\n\n67\n00:03:13.700 --> 00:03:17.490\nit says, hey, I don't know what you're\ntalking about, and this is very important.\n\n68\n00:03:17.490 --> 00:03:19.950\n>> Yeah,\nit definitely can cause some problems.\n\n69\n00:03:19.950 --> 00:03:22.236\nThe other thing we can\nconfigure here are DNS servers.\n\n70\n00:03:22.236 --> 00:03:23.287\nNow, by default,\n\n71\n00:03:23.287 --> 00:03:27.251\nthe firewall is gonna use whatever\nDNS servers it learns through DHCP.\n\n72\n00:03:27.251 --> 00:03:30.170\nAnd that might be fine with us,\nleave this blank.\n\n73\n00:03:30.170 --> 00:03:33.110\nBut if you want to override it,\nnow is the time to do it.\n\n74\n00:03:33.110 --> 00:03:34.910\nAnd so I wanna override mine.\n\n75\n00:03:34.910 --> 00:03:40.395\nI know my ISP is giving me certain DNS\nservers but maybe I wanna use OpenDNS or\n\n76\n00:03:40.395 --> 00:03:44.130\nDynDNS or somebody like that,\nI'll use Google, right?\n\n77\n00:03:44.130 --> 00:03:46.920\nSo I don't care what DNS\nservers my ISP gives me,\n\n78\n00:03:46.920 --> 00:03:47.937\nthese are the ones that I wanna use.\n\n79\n00:03:49.580 --> 00:03:53.340\nBut it also has the option to allow those\nto be overridden, so if I learn different\n\n80\n00:03:53.340 --> 00:03:56.840\nDNS servers from DHCP, I'll use\nthose regardless of what I put here.\n\n81\n00:03:56.840 --> 00:04:02.160\nI don't want that, so\nI'll turn that optional, all right?\n\n82\n00:04:02.160 --> 00:04:05.120\nOn my next screen,\nit's gonna ask about a time server.\n\n83\n00:04:05.120 --> 00:04:08.430\nSynchronizing times across all\nof your network hardware is\n\n84\n00:04:08.430 --> 00:04:11.930\nreally instrumental if you're gonna do\nany kind of security tracking, right?\n\n85\n00:04:11.930 --> 00:04:14.830\nIf one server gets compromised and you're\ntrying to figure out what was going on in\n\n86\n00:04:14.830 --> 00:04:18.030\nyour other servers at the same time,\nthey need to have the same clock.\n\n87\n00:04:18.030 --> 00:04:21.170\nOtherwise it's hard to figure out\nwhat happened at the same time.\n\n88\n00:04:21.170 --> 00:04:22.860\nSo we support a time server.\n\n89\n00:04:22.860 --> 00:04:24.830\nBy default, it uses a public one.\n\n90\n00:04:24.830 --> 00:04:26.290\nYou may or may not want that.\n\n91\n00:04:26.290 --> 00:04:30.060\nYou might have an internal time server\nyou wanna use, and you can specify that.\n\n92\n00:04:30.060 --> 00:04:32.650\nWe can also set what we\nwant our time zone to be.\n\n93\n00:04:32.650 --> 00:04:38.300\nYou'll see I'm in ETC/UTC,\nwhich is not really good enough for me.\n\n94\n00:04:38.300 --> 00:04:40.020\nI'm gonna choose EST.\n\n95\n00:04:40.020 --> 00:04:44.010\nWe're in the Eastern time zone here in\nthe United States, and EST 5 EDT, for\n\n96\n00:04:44.010 --> 00:04:47.860\ndaylight too,\nI'm just going to go with Eastern.\n\n97\n00:04:47.860 --> 00:04:48.600\n>> And there's a lot more\n\n98\n00:04:48.600 --> 00:04:50.410\noptions than what we're seeing\nright here in that little menu.\n\n99\n00:04:50.410 --> 00:04:54.050\nBelieve it or not, if you scroll all the\nway up, you'll get to the continents is\n\n100\n00:04:54.050 --> 00:04:56.550\nwhat you'll also get to and\nsome different locations.\n\n101\n00:04:56.550 --> 00:04:59.927\nSo there's actually one for Americas and\nthen I think you'll see New York,\n\n102\n00:04:59.927 --> 00:05:03.485\nsitting right there as well,\ndepending on the specificity that we need.\n\n103\n00:05:03.485 --> 00:05:05.650\n>> Yep, whichever one is the easiest for\nyou to find.\n\n104\n00:05:05.650 --> 00:05:07.400\nI always hated that country one.\n\n105\n00:05:07.400 --> 00:05:09.220\n>> Yeah.\n>> Gotta figure out what city.\n\n106\n00:05:09.220 --> 00:05:12.470\nNew York, which is only what,\nlike 1,200 miles from here, so\n\n107\n00:05:12.470 --> 00:05:15.360\nwe gotta pick some city that's not,\nwhatever.\n\n108\n00:05:15.360 --> 00:05:18.270\nSo we pick our time, and\nthen we move forward.\n\n109\n00:05:18.270 --> 00:05:21.690\nNow, it's asking me about my WAN\ninterface, the Internet interface.\n\n110\n00:05:21.690 --> 00:05:26.060\nNow, the odds are, you already configured\nthis when you did the install,\n\n111\n00:05:26.060 --> 00:05:30.050\nright, but if you bought an appliance\nthat came pre-installed with pfSense,\n\n112\n00:05:30.050 --> 00:05:30.940\nthen you haven't.\n\n113\n00:05:30.940 --> 00:05:32.440\nHere's your chance to do it.\n\n114\n00:05:32.440 --> 00:05:37.800\nSo, it may be prepopulated with data that\nyou already put in from doing the install\n\n115\n00:05:37.800 --> 00:05:40.000\nbut if it's an appliance,\nyou'll need to pick.\n\n116\n00:05:40.000 --> 00:05:44.160\nIs your wide area network interface,\nis it DHCP or is it static?\n\n117\n00:05:44.160 --> 00:05:46.780\nMaybe you have a static\nIP from your provider.\n\n118\n00:05:46.780 --> 00:05:50.920\nMaybe you're using point-to-point\nprotocol over ethernet, PPPoE.\n\n119\n00:05:50.920 --> 00:05:53.760\nSo you'd need to specify\nthat in the credentials or\n\n120\n00:05:53.760 --> 00:05:57.380\nPPTP if you've got some kind of\npoint-to-point tunneling going on.\n\n121\n00:05:57.380 --> 00:05:59.280\nSo you'd specify the protocol right here.\n\n122\n00:05:59.280 --> 00:06:00.950\nIn my case, I'm gonna stick with DHCP.\n\n123\n00:06:02.570 --> 00:06:04.890\nYou can also override the MAC address.\n\n124\n00:06:04.890 --> 00:06:06.790\nNow, why would we do that?\n\n125\n00:06:06.790 --> 00:06:09.620\nWell, some cable providers,\nwhen you get cable modems or\n\n126\n00:06:09.620 --> 00:06:12.660\nDSL, hard code your\nservice to a MAC address.\n\n127\n00:06:12.660 --> 00:06:13.680\nAnd so, here,\n\n128\n00:06:13.680 --> 00:06:17.670\nwe can clone the MAC address of one of\nour PCs onto the firewall, if we want.\n\n129\n00:06:17.670 --> 00:06:19.100\nIt's the public interface, anyway,\n\n130\n00:06:19.100 --> 00:06:22.850\nso it's not like it'll cause a conflict\non your LAN and that's one way to do it.\n\n131\n00:06:24.330 --> 00:06:26.090\nYou'll see your maximum transmission unit,\n\n132\n00:06:26.090 --> 00:06:28.650\nhow large frames are allowed\nto be on your network.\n\n133\n00:06:28.650 --> 00:06:32.230\nThe default is 1500 for most systems,\nbut you'll see you can manipulate it.\n\n134\n00:06:32.230 --> 00:06:36.640\nIt says here if we leave a blank 1492,\nis gonna be,\n\n135\n00:06:36.640 --> 00:06:40.910\nit's default for PPPoE and\n1500 for everything else.\n\n136\n00:06:40.910 --> 00:06:43.990\nNow, why is PPPOE a little smaller?\n\n137\n00:06:43.990 --> 00:06:45.490\nBecause it needs a little more room for\n\n138\n00:06:45.490 --> 00:06:49.240\nthe authentication and PPPoE header, it's\ngot to have that little block on there so\n\n139\n00:06:49.240 --> 00:06:52.120\nit takes some room there, so that's\nwhy it makes it a little bit smaller.\n\n140\n00:06:53.330 --> 00:06:56.260\nAll right, some of the other things we\nmight need to manipulate here if we chose\n\n141\n00:06:56.260 --> 00:07:01.010\nstatic IP, we can put that static IP\naddress right here and who our gateway is.\n\n142\n00:07:01.010 --> 00:07:03.530\nI went with DHCP so\nI don't have to fill these out, in fact,\n\n143\n00:07:03.530 --> 00:07:05.600\nI don't think it'll even\nlet me fill those out.\n\n144\n00:07:05.600 --> 00:07:07.050\nYeah, I can't type in there.\n\n145\n00:07:07.050 --> 00:07:10.765\nSo if I had set static,\nI'd be able to provide those.\n\n146\n00:07:10.765 --> 00:07:13.562\nWith DHCP, I'll normally get\nassigned a host name, but\n\n147\n00:07:13.562 --> 00:07:15.640\nI can specify a host name if I want.\n\n148\n00:07:15.640 --> 00:07:19.936\nIf I don't, it's gonna try and\nuse the one that we specified earlier,\n\n149\n00:07:19.936 --> 00:07:22.592\nwhich mine was pfSense.lab.itpro.tv.\n\n150\n00:07:22.592 --> 00:07:25.147\nIf we chose PPPoE,\nwe provide our credentials here.\n\n151\n00:07:25.147 --> 00:07:28.830\nUsername, password, and\nanything else that our ISP provides us.\n\n152\n00:07:28.830 --> 00:07:32.033\nThis is information you get from your ISP.\n\n153\n00:07:32.033 --> 00:07:33.798\nAnd same thing with PPTP.\n\n154\n00:07:33.798 --> 00:07:36.920\nIf we're doing tunneling,\nwe'd specify our username, password.\n\n155\n00:07:36.920 --> 00:07:38.674\nAnd the other information\nwe got from our ISP.\n\n156\n00:07:40.996 --> 00:07:45.640\nAfter that,\nare two security related entries.\n\n157\n00:07:45.640 --> 00:07:48.050\nThey're turned on by default\nthat most people want that, but\n\n158\n00:07:48.050 --> 00:07:49.590\nthere are times where you might not.\n\n159\n00:07:49.590 --> 00:07:51.957\nMine is a great example, all right?\n\n160\n00:07:51.957 --> 00:07:56.243\nThe first one says,\nshould we block RFC1918 Networks?\n\n161\n00:07:56.243 --> 00:07:58.099\nNow, Ronnie, what are RFC1918 Networks?\n\n162\n00:07:58.099 --> 00:08:02.497\n>> The RFC1918 Networks are the private\nIP addresses that are not routable on\n\n163\n00:08:02.497 --> 00:08:03.370\nthe Internet.\n\n164\n00:08:03.370 --> 00:08:07.570\nAnd so, when you do see those, normally\nit's probably because you are actually\n\n165\n00:08:07.570 --> 00:08:11.093\nworking within your own networks and\nyou're trying not to actually\n\n166\n00:08:11.093 --> 00:08:15.510\nuse public addresses, even on\nthe outside interfaces of your firewall.\n\n167\n00:08:15.510 --> 00:08:17.126\n>> I know in the past,\nwe wanted to block these.\n\n168\n00:08:17.126 --> 00:08:22.474\nI didn't want traffic coming from\nthe Internet that was 192.168.0 or\n\n169\n00:08:22.474 --> 00:08:25.845\n172.16 dot whatever or 10 dot whatever.\n\n170\n00:08:25.845 --> 00:08:27.507\nThose are all private addresses.\n\n171\n00:08:27.507 --> 00:08:29.908\nWe shouldn't get traffic\nfrom the Internet like that.\n\n172\n00:08:29.908 --> 00:08:35.442\nBut more and more ISPs these days are\nstarting to do commercial-grade NAT where\n\n173\n00:08:35.442 --> 00:08:40.903\nthey give you a internal IP on your Wan\ninterface and that can wreak some havoc.\n\n174\n00:08:40.903 --> 00:08:42.860\nAnd so you might need to turn that off.\n\n175\n00:08:42.860 --> 00:08:44.310\nThis is the chance to do it.\n\n176\n00:08:44.310 --> 00:08:46.540\nWe can always do it later, too.\n\n177\n00:08:46.540 --> 00:08:48.680\nThen block Bogon networks.\n\n178\n00:08:48.680 --> 00:08:52.601\nWell, a lot of us think of RFC 1918\naddress as the only ones that should be\n\n179\n00:08:52.601 --> 00:08:54.195\ncoming from the Internet, but\n\n180\n00:08:54.195 --> 00:08:58.148\nthere's actually a number of other\nranges that shouldn't come in either.\n\n181\n00:08:58.148 --> 00:09:01.385\nThese are blocks of IPs that are used for\nother purposes,\n\n182\n00:09:01.385 --> 00:09:04.907\nlike the 127.0.0.0 class A,\nis used for loopback.\n\n183\n00:09:04.907 --> 00:09:05.900\nYou shouldn't get any traffic on that.\n\n184\n00:09:06.910 --> 00:09:12.370\nAnd like the 225 or 224 and higher for\nmulti-cast or the class Es, right?\n\n185\n00:09:12.370 --> 00:09:14.040\nThe ones all the way\ndown there at the end.\n\n186\n00:09:14.040 --> 00:09:16.563\nThat traffic shouldn't come\nfrom the Internet either, and\n\n187\n00:09:16.563 --> 00:09:17.705\nso that gets blocked also.\n\n188\n00:09:17.705 --> 00:09:21.805\nSee these are addresses that are reserved,\nbut not RFC 1918.\n\n189\n00:09:21.805 --> 00:09:22.720\nThey're kind of outside of it.\n\n190\n00:09:22.720 --> 00:09:25.563\nSo, you pretty much always\nwant that turned on.\n\n191\n00:09:28.388 --> 00:09:31.250\nAll right, on our next screen it\nasks us about our LAN address.\n\n192\n00:09:31.250 --> 00:09:33.960\nNow, we probably don't\nwant to change this,\n\n193\n00:09:33.960 --> 00:09:38.360\nbut if your appliance came set for one IP,\nyou can choose to swap it to another one.\n\n194\n00:09:38.360 --> 00:09:41.010\nBe aware, you'll get disconnected, right?\n\n195\n00:09:41.010 --> 00:09:42.550\nYou're connected to\nthe web interface here,\n\n196\n00:09:42.550 --> 00:09:43.830\nit'll disconnect you\nwhile it changes the IP,\n\n197\n00:09:43.830 --> 00:09:47.530\nand then you'll need to\nreconnect on the new IP address.\n\n198\n00:09:47.530 --> 00:09:51.497\nMine's at 192.680.1,\nI'm happy with that, so I'll leave it be\n\n199\n00:09:54.109 --> 00:09:57.050\nNow, the most important\nscreen of this process.\n\n200\n00:09:57.050 --> 00:09:59.310\nYou do need to change your password.\n\n201\n00:09:59.310 --> 00:10:02.370\nDon't leave it at the default\npassword because, well,\n\n202\n00:10:02.370 --> 00:10:03.500\npeople know what it is, right?\n\n203\n00:10:03.500 --> 00:10:04.150\nJust pfSense.\n\n204\n00:10:04.150 --> 00:10:06.320\nSo we definitely wanna\nchange that to something.\n\n205\n00:10:06.320 --> 00:10:06.950\nWhoops.\n\n206\n00:10:06.950 --> 00:10:08.850\nDefinitely change it to\nsomething different.\n\n207\n00:10:08.850 --> 00:10:10.692\nI'll specify a new password here.\n\n208\n00:10:10.692 --> 00:10:15.730\nSuper secret, I don't wanna tell anybody,\nand there we go, all right?\n\n209\n00:10:15.730 --> 00:10:16.880\nOnce that's done,\n\n210\n00:10:16.880 --> 00:10:21.330\nit's gonna reboot the firewall to make\nthose changes take effect, right?\n\n211\n00:10:21.330 --> 00:10:24.630\nSo like if you change the IP,\nthat's gonna take effect.\n\n212\n00:10:24.630 --> 00:10:29.610\nOnce it reboots, we'll need to go in and\nreconnect on the new IP, right?\n\n213\n00:10:29.610 --> 00:10:32.600\nSo it's just letting me know the wizard\nis completed, and I need to wait.\n\n214\n00:10:32.600 --> 00:10:35.710\nAnd if I go look at my firewall,\nit should be rebooting or\n\n215\n00:10:35.710 --> 00:10:38.260\nactually mine may have already\nrebooted at this point.\n\n216\n00:10:38.260 --> 00:10:40.360\nIt boots pretty fast.\n\n217\n00:10:40.360 --> 00:10:42.156\nIf you have the physical\nhardware next to you,\n\n218\n00:10:42.156 --> 00:10:44.885\nit actually plays a little music on\nthe PC speaker, and it goes [SOUND].\n\n219\n00:10:44.885 --> 00:10:48.170\nIt kind of lets you know\nthat it finished rebooting.\n\n220\n00:10:48.170 --> 00:10:56.090\nBut, one way to find out is do an all new\ntab, and let's see if I can get to that.\n\n221\n00:10:56.090 --> 00:10:58.170\nAnd sure enough, I'm able to get to it.\n\n222\n00:10:58.170 --> 00:11:02.230\nThe firewall is up and running and\nlooks like we're in business.\n\n223\n00:11:03.570 --> 00:11:09.060\nNow, that's the initial setup wizard and\ntechnically, we're now a firewall.\n\n224\n00:11:09.060 --> 00:11:09.700\nWe're up and running.\n\n225\n00:11:09.700 --> 00:11:10.880\nWe're routing traffic.\n\n226\n00:11:10.880 --> 00:11:12.870\nClients could plugin\nto the inside network,\n\n227\n00:11:12.870 --> 00:11:15.720\nget an DHCP address,\nbrowse out to the Internet and go.\n\n228\n00:11:15.720 --> 00:11:18.648\nI should be able to get\nout to the Internet.\n\n229\n00:11:18.648 --> 00:11:21.948\nBut, there might be a few other things\nthat we need to knock out as part of\n\n230\n00:11:21.948 --> 00:11:25.705\nthe initial configuration before we call\nthis one a day and walk off, all right?\n\n231\n00:11:25.705 --> 00:11:28.853\nOne of the main things is,\nduring my set up,\n\n232\n00:11:28.853 --> 00:11:32.700\nI chose not to enable HTTPS for\nthis admin interface.\n\n233\n00:11:32.700 --> 00:11:35.840\nNotice I'm not on a secure page here,\nall right?.\n\n234\n00:11:35.840 --> 00:11:39.400\nAnd I did that because I might have\nspecial needs in my browser where I need\n\n235\n00:11:39.400 --> 00:11:40.880\nto adjust that certificate.\n\n236\n00:11:40.880 --> 00:11:45.420\nSo, we need to know how to turn that\non and off and kind of change that.\n\n237\n00:11:45.420 --> 00:11:49.510\nSo, if you've got special certificate\nneeds, like I have in my instance,\n\n238\n00:11:49.510 --> 00:11:50.190\nyou need to know how to\ncreate a new certificate, and\n\n239\n00:11:50.190 --> 00:11:55.550\nyou need to know how to\nenable that on the system.\n\n240\n00:11:55.550 --> 00:11:59.260\nSo I wanna show you that here as part of\nthe initial configuration, all right?\n\n241\n00:11:59.260 --> 00:12:02.780\nThe other thing is, I'm logged in\nwith this generic admin account.\n\n242\n00:12:02.780 --> 00:12:06.120\nWe'll probably want to create\nan account just for ourselves so\n\n243\n00:12:06.120 --> 00:12:08.920\nthat we're not always logging in\nwith this generic admin account.\n\n244\n00:12:08.920 --> 00:12:10.900\nSo I'll show you how to kinda\nwalk through that process, too.\n\n245\n00:12:12.280 --> 00:12:14.260\nAll right,\nlet's start with the certificate.\n\n246\n00:12:14.260 --> 00:12:19.100\nIf we go up here to System,\nyou've got Certificate Manager right here.\n\n247\n00:12:19.100 --> 00:12:22.110\nIf you need some kind of special\ncertificate, a certificate with different\n\n248\n00:12:22.110 --> 00:12:25.290\nsecurity settings, you can come in here\nand create a certificate, all right?\n\n249\n00:12:26.320 --> 00:12:30.430\nIf you go under the Certificate tab,\nyou'll see the certificates you've got.\n\n250\n00:12:30.430 --> 00:12:32.000\nAnd I've got the Web Configurator one.\n\n251\n00:12:32.000 --> 00:12:33.670\nThat's the one that was\ncreated by default,\n\n252\n00:12:33.670 --> 00:12:36.120\nthat maybe I don't like that, all right?\n\n253\n00:12:36.120 --> 00:12:38.750\nSo I can come in and\nadd a new certificate.\n\n254\n00:12:38.750 --> 00:12:43.340\nAnd when I do that, here it's giving\nme the chance to import a certificate.\n\n255\n00:12:43.340 --> 00:12:46.600\nI can go to my CA and\ngenerate my certificate, and\n\n256\n00:12:46.600 --> 00:12:50.580\nI can import it right in here, right,\nif I've already got a cert for that.\n\n257\n00:12:50.580 --> 00:12:54.580\nIf I don't have a cert,\nwell I'll need to generate a request.\n\n258\n00:12:54.580 --> 00:12:57.900\nYou'll see where I can create\na certificate signing request, and\n\n259\n00:12:57.900 --> 00:13:02.690\nI can create my request form, send that\nout to a provider like Digisearch,\n\n260\n00:13:02.690 --> 00:13:04.000\nor somebody like that.\n\n261\n00:13:04.000 --> 00:13:08.820\nThey can issue the cert, and then I\ncome back here and I go to import, and\n\n262\n00:13:08.820 --> 00:13:12.460\nI import that certificate into my system,\nright?\n\n263\n00:13:12.460 --> 00:13:16.370\nOr we could create an internal\ncertificate, one assigned by the firewall,\n\n264\n00:13:16.370 --> 00:13:20.610\nbut most of your browsers are not\ngonna trust that, all right?\n\n265\n00:13:20.610 --> 00:13:23.820\nOnce you've done that,\nonce you've got that certificate in place,\n\n266\n00:13:23.820 --> 00:13:27.480\nit'll show up here under our certificates,\nin this list.\n\n267\n00:13:27.480 --> 00:13:29.980\nAnd now we just need to tell\nour firewall to use it.\n\n268\n00:13:29.980 --> 00:13:33.895\nThe admin interface, we can adjust that\nif we go up to System and Advanced.\n\n269\n00:13:35.330 --> 00:13:37.770\nAnd under Advanced,\nyou'll see Admin Access.\n\n270\n00:13:37.770 --> 00:13:41.320\nAnd here's where determine\nwhether it's HTTP or HTTPS.\n\n271\n00:13:41.320 --> 00:13:45.581\nAnd if choose that HTTPS, we'll see this\nmagic drop down box appear where we can\n\n272\n00:13:45.581 --> 00:13:48.517\npick which certificate we're gonna use,\nall right?\n\n273\n00:13:48.517 --> 00:13:50.180\nI'll pick that web configurated one.\n\n274\n00:13:50.180 --> 00:13:54.762\nOnce you've got that one chosen,\nscroll all the way down and hit Save, and\n\n275\n00:13:54.762 --> 00:13:57.396\nnow it's going to turn that one on, okay?\n\n276\n00:13:57.396 --> 00:14:01.116\nNow, once that's done, it's telling\nme that changes have been applied\n\n277\n00:14:01.116 --> 00:14:05.436\nsuccessfully, and it's gonna redirect me,\nit needs to flip me over to the secure one\n\n278\n00:14:05.436 --> 00:14:08.081\nand it is gonna do that it\nsays in about 20 seconds.\n\n279\n00:14:08.081 --> 00:14:10.920\nIf we're patient, we can wait,\nand that'll happen.\n\n280\n00:14:10.920 --> 00:14:14.320\nOtherwise we can just open another tab and\nbrowse to it ourselves.\n\n281\n00:14:16.280 --> 00:14:19.760\nNow, it's a self-signed certificate,\nso here I get a warning, right?\n\n282\n00:14:19.760 --> 00:14:22.025\nIf I'd put my own cert in there,\nthen it would be good and\n\n283\n00:14:22.025 --> 00:14:23.289\nI wouldn't get this warning.\n\n284\n00:14:23.289 --> 00:14:26.266\nBut I can continue to the website anyway,\nand I am secure, but\n\n285\n00:14:26.266 --> 00:14:29.826\nI'm throwing a certificate error\nbecause it was self-signed, right?\n\n286\n00:14:29.826 --> 00:14:32.600\nThat's why we'd probably want\nto generate that ourselves.\n\n287\n00:14:32.600 --> 00:14:34.960\nAnd I'm getting that certificate error on\nthis one too, which was that redirect.\n\n288\n00:14:36.700 --> 00:14:38.260\nBut at least now when I log in,\n\n289\n00:14:39.360 --> 00:14:42.620\nat least I'm logged in using\nsome kind of encryption, right?\n\n290\n00:14:42.620 --> 00:14:43.980\nAnd securing my data on that.\n\n291\n00:14:46.690 --> 00:14:49.570\nAll right, so that's one of the things\nwe definitely want to get configured.\n\n292\n00:14:49.570 --> 00:14:52.580\nWhen we initially set this up, we wanna\nmake sure we've got that certificate in\n\n293\n00:14:52.580 --> 00:14:54.690\nplace and that we're protected there.\n\n294\n00:14:54.690 --> 00:14:57.310\n>> Now Don, you had also talked\nabout actually changing or\n\n295\n00:14:57.310 --> 00:14:59.090\nusing a different user account.\n\n296\n00:14:59.090 --> 00:15:01.050\nAnd so that's what we'll need to do next.\n\n297\n00:15:01.050 --> 00:15:02.810\n>> Yeah and the user account's\nactually that same menu.\n\n298\n00:15:02.810 --> 00:15:06.280\nIf we go back under System, you'll see\nyou've got all of these different options\n\n299\n00:15:06.280 --> 00:15:08.650\nand at the very bottom\nyou've got User Manager.\n\n300\n00:15:08.650 --> 00:15:11.750\nAnd under User Manager,\nyou've got one user by default, Admin.\n\n301\n00:15:11.750 --> 00:15:14.660\nit's a default account that\nthe pfSense guys create for us.\n\n302\n00:15:14.660 --> 00:15:18.730\nIt's there, you can certainly use it, but\nif you've got multiple network admins\n\n303\n00:15:18.730 --> 00:15:20.800\nyou probably want each person\nto have their own account.\n\n304\n00:15:20.800 --> 00:15:24.820\nNow, we're gonna see in the VPN episodes\nhow to link this to something like\n\n305\n00:15:24.820 --> 00:15:29.640\nan Open Directory or Microsoft's\nActive Directory, something like that.\n\n306\n00:15:29.640 --> 00:15:31.690\nSo you might have accounts\nalready created in those systems,\n\n307\n00:15:31.690 --> 00:15:33.100\nyou can certainly use those.\n\n308\n00:15:33.100 --> 00:15:36.130\nBut you can also create\nuser accounts right here.\n\n309\n00:15:36.130 --> 00:15:39.100\nAll we do is hit the little plus sign\nover here and you can pick a user.\n\n310\n00:15:39.100 --> 00:15:41.122\nSo I'm gonna create a user called D Pezet.\n\n311\n00:15:41.122 --> 00:15:41.700\nIt's for me.\n\n312\n00:15:42.700 --> 00:15:44.100\nI'll put in a password,\n\n313\n00:15:44.100 --> 00:15:46.730\nwhich if I type right will work\na little bit better for me.\n\n314\n00:15:46.730 --> 00:15:50.675\nYou can put in your full name and\nother information.\n\n315\n00:15:50.675 --> 00:15:53.150\nIf it's a temporary account,\nyou can set when it's going to expire.\n\n316\n00:15:53.150 --> 00:15:55.990\nThat's useful for like VPN users.\n\n317\n00:15:55.990 --> 00:15:57.190\nAnd then you can specify the groups.\n\n318\n00:15:57.190 --> 00:16:00.830\nAnd see how it's gonna say,\nthat there's one group, Admins.\n\n319\n00:16:00.830 --> 00:16:02.534\nSo I can make myself an admin, or\n\n320\n00:16:02.534 --> 00:16:05.890\nI can create other groups later\non that have different access.\n\n321\n00:16:05.890 --> 00:16:07.940\nWell we'll see that in another episode.\n\n322\n00:16:07.940 --> 00:16:10.419\nBut for right now,\nI'm gonna make myself an administrator.\n\n323\n00:16:10.419 --> 00:16:12.271\nAll right.\nYou can also do things like add in\n\n324\n00:16:12.271 --> 00:16:14.835\npre-shared keys,\nwe can attach certificates to users,\n\n325\n00:16:14.835 --> 00:16:17.369\nthere's all sorts of crazy\nthings that we can do in here.\n\n326\n00:16:17.369 --> 00:16:20.502\nBut for right now I'm just gonna\ncreate this account for myself.\n\n327\n00:16:20.502 --> 00:16:23.990\nAnd now there's that dpezet\naccount right there.\n\n328\n00:16:23.990 --> 00:16:26.890\nNow, when we make changes in pfSense,\nsometimes\n\n329\n00:16:26.890 --> 00:16:30.380\nthe changes are saved automatically,\nsometimes we have to hit a save button.\n\n330\n00:16:30.380 --> 00:16:32.130\nIn this case,\nthe changes are saved automatically.\n\n331\n00:16:32.130 --> 00:16:35.660\nIf they weren't, I'd see a big\nsave button appear right here\n\n332\n00:16:35.660 --> 00:16:38.960\nto confirm the changes and\nsave it, or apply the changes.\n\n333\n00:16:38.960 --> 00:16:40.730\nIn this case, it's already done for me.\n\n334\n00:16:40.730 --> 00:16:45.100\nIf I take a look at that admin account,\nI can edit that one.\n\n335\n00:16:45.100 --> 00:16:48.080\nAnd notice that I can\ndisable the admin account.\n\n336\n00:16:48.080 --> 00:16:50.600\nSo, if I want to stop that\none from being available,\n\n337\n00:16:50.600 --> 00:16:54.760\nbecause attackers might try that,\nto brute-force the password to get in.\n\n338\n00:16:54.760 --> 00:16:55.780\nWe can come in and disable it.\n\n339\n00:16:55.780 --> 00:16:59.780\nBut I need to test my user account\nfirst before I do something like that.\n\n340\n00:16:59.780 --> 00:17:06.570\nSo I'm going to log out of this system and\nthen log back in as my new user account.\n\n341\n00:17:06.570 --> 00:17:08.219\nSo I'm going to go here to System and\nLog Out.\n\n342\n00:17:09.500 --> 00:17:11.550\nAnd then I'm gonna log in\nas my new dpezet account.\n\n343\n00:17:13.290 --> 00:17:18.220\nAnd once I log in as me, there we go,\nI can see that I am able to log in.\n\n344\n00:17:18.220 --> 00:17:19.875\nDefinitely important to test that.\n\n345\n00:17:19.875 --> 00:17:23.447\nAnd we can go to system,\nuser managers, and we can go ahead and\n\n346\n00:17:23.447 --> 00:17:25.180\ndisable that admin account.\n\n347\n00:17:26.560 --> 00:17:28.270\nNotice, you can't delete\nthe admin account.\n\n348\n00:17:28.270 --> 00:17:29.750\nThat option is gone.\n\n349\n00:17:29.750 --> 00:17:30.410\nYou can rename it.\n\n350\n00:17:30.410 --> 00:17:31.600\nI could have just renamed this dpezet,\nI guess,\n\n351\n00:17:31.600 --> 00:17:33.690\nbecause I might want to go that route.\n\n352\n00:17:33.690 --> 00:17:34.660\nBut I'm just going to disable it.\n\n353\n00:17:34.660 --> 00:17:38.020\nIt will still be there,\nit just won't be allowed to log in.\n\n354\n00:17:38.020 --> 00:17:40.582\nAnd we'll save that, and\nnow that account is disabled,\n\n355\n00:17:40.582 --> 00:17:43.690\nI don't have to worry about people\nbrute-forcing the admin account.\n\n356\n00:17:43.690 --> 00:17:46.520\nAnd I also don't have to worry about\nsomebody else creating an account called\n\n357\n00:17:46.520 --> 00:17:50.300\nadmin, because this one still exists and\nwon't allow a duplicate, and\n\n358\n00:17:50.300 --> 00:17:51.130\nthis one's disabled.\n\n359\n00:17:52.660 --> 00:17:56.310\nAnd I can just repeat this process for\nhowever many other network admins I had.\n\n360\n00:17:56.310 --> 00:17:58.450\nObviously, using a directory\nservice is gonna be better for\n\n361\n00:17:58.450 --> 00:18:00.990\nthat, but\nhere I can do it with individual users.\n\n362\n00:18:02.890 --> 00:18:06.720\nOnce that's done, we're pretty much done.\n\n363\n00:18:06.720 --> 00:18:10.220\nOne other thing that's a good idea to do\non a new firewall before you throw it in\n\n364\n00:18:10.220 --> 00:18:12.540\nproduction, is to back\nup the configuration.\n\n365\n00:18:12.540 --> 00:18:13.920\nBecause if something goes wrong,\n\n366\n00:18:13.920 --> 00:18:16.670\nI don't wanna have to go through\nall this config stuff over again.\n\n367\n00:18:16.670 --> 00:18:18.700\nSo we probably wanna set up\nsome kind of a backup for\n\n368\n00:18:18.700 --> 00:18:22.290\nour system, just to make sure\nthat we're on the up and up.\n\n369\n00:18:22.290 --> 00:18:24.630\nSo, you can do that pretty easily.\n\n370\n00:18:24.630 --> 00:18:26.270\n>> Go to diagnostics.\n\n371\n00:18:26.270 --> 00:18:28.100\n>> All right,\nwe jump over here to the diagnostics menu.\n\n372\n00:18:28.100 --> 00:18:31.040\nYou'll see that backup and\nrestore option right there.\n\n373\n00:18:31.040 --> 00:18:34.340\nWe can choose that, and you'll see\nwhat you're gonna be backing up, and\n\n374\n00:18:34.340 --> 00:18:36.140\nyou've got all sorts of\ndifferent options here.\n\n375\n00:18:36.140 --> 00:18:39.630\nDo I wanna back up the whole firewall or\njust certain pieces?\n\n376\n00:18:39.630 --> 00:18:40.230\nI'll do the whole thing.\n\n377\n00:18:41.510 --> 00:18:43.330\nAnd then, we can choose to encrypt it.\n\n378\n00:18:43.330 --> 00:18:46.250\nProbably a good idea, because if\nsomebody gets a hold of this file,\n\n379\n00:18:46.250 --> 00:18:47.220\nwhat do they have?\n\n380\n00:18:47.220 --> 00:18:49.440\nThe full config of your firewall.\n\n381\n00:18:49.440 --> 00:18:53.570\nSo, we can choose to encrypt that and\nit'll ask us to set a password on it.\n\n382\n00:18:53.570 --> 00:18:56.560\nSomebody will have to have this\npassword in order to open up\n\n383\n00:18:56.560 --> 00:18:58.060\nthe configuration file.\n\n384\n00:18:58.060 --> 00:19:00.750\nI'm actually not gonna encrypt\nmine cuz I wanna show you guys\n\n385\n00:19:00.750 --> 00:19:01.910\nthe file that it makes.\n\n386\n00:19:01.910 --> 00:19:03.650\nAnd I'll hit download configuration.\n\n387\n00:19:04.660 --> 00:19:05.700\nAnd it's just gonna download.\n\n388\n00:19:05.700 --> 00:19:07.100\nThat'll save that to my hard drive.\n\n389\n00:19:07.100 --> 00:19:12.157\nAnd when it saves it, it's just saving\nit right here as a little XML file,\n\n390\n00:19:12.157 --> 00:19:13.799\nand we can open that up.\n\n391\n00:19:13.799 --> 00:19:15.755\nLet me open that in WordPad.\n\n392\n00:19:18.200 --> 00:19:19.445\nThere we go.\n\n393\n00:19:19.445 --> 00:19:21.139\nAnd here you can kinda\nsee what it looks like.\n\n394\n00:19:22.420 --> 00:19:23.540\nAnd it's not too amazing, right?\n\n395\n00:19:23.540 --> 00:19:24.860\nIt's really just an XML file.\n\n396\n00:19:24.860 --> 00:19:26.940\nIt's pretty plain, easy to read.\n\n397\n00:19:26.940 --> 00:19:29.510\nYou'll see there are hash\npasswords in here though.\n\n398\n00:19:29.510 --> 00:19:31.250\nThat's stuff we have to be careful with.\n\n399\n00:19:31.250 --> 00:19:33.250\nEspecially since these are MD5 hashes.\n\n400\n00:19:33.250 --> 00:19:36.230\nThere's some known attacks\nthat can work against those.\n\n401\n00:19:36.230 --> 00:19:38.420\nAnd, as you look,\nyou'll see the rest of the information.\n\n402\n00:19:38.420 --> 00:19:41.930\nNow, we haven't configured a lot of this\nstuff yet, so these are all defaults.\n\n403\n00:19:41.930 --> 00:19:46.450\nBut, the more and more configuration you\ndo, The more you have to recreate if you\n\n404\n00:19:46.450 --> 00:19:49.240\never have a firewall failure, so\nyou definitely want to back this file up.\n\n405\n00:19:49.240 --> 00:19:53.950\nAnd it is not very big, right,\nit is thirteen K in size for this one.\n\n406\n00:19:53.950 --> 00:19:57.680\nIt will grow as you add more certificates\nand things, the file gets bigger, but\n\n407\n00:19:57.680 --> 00:19:59.230\nit never gets gigantic.\n\n408\n00:19:59.230 --> 00:20:00.110\nIt's always pretty small.\n\n409\n00:20:01.670 --> 00:20:05.470\nAll right, well, Ronnie, I think that\npretty much wraps up our initial config.\n\n410\n00:20:05.470 --> 00:20:07.610\nYou thinking of anything else\nyou might wanna throw in?\n\n411\n00:20:07.610 --> 00:20:08.190\n>> Not initially.\n\n412\n00:20:08.190 --> 00:20:11.760\nOnce we get everything up and running, and\nthat we can verify that we're secure and\n\n413\n00:20:11.760 --> 00:20:15.850\nthat we can get access in,\nnow comes the rest of the different\n\n414\n00:20:15.850 --> 00:20:18.440\nfun stuff that we'll be getting into for\nthe rest of the series.\n\n415\n00:20:18.440 --> 00:20:19.190\n>> Yeah, absolutely.\n\n416\n00:20:19.190 --> 00:20:20.430\nSo, stay tuned.\n\n417\n00:20:20.430 --> 00:20:23.140\nWe've got more episodes coming up,\nand more importantly,\n\n418\n00:20:23.140 --> 00:20:25.870\nwe've only configured two\ninterfaces here WAN and LAN.\n\n419\n00:20:25.870 --> 00:20:29.240\nWe probably want to set up DMZs or\nVLANs right?\n\n420\n00:20:29.240 --> 00:20:31.030\nThose are other things that\nwe need to get configured.\n\n421\n00:20:31.030 --> 00:20:34.540\nWe'll get chance to see those in an\nupcoming segment, as well as other things,\n\n422\n00:20:34.540 --> 00:20:36.650\nlike our firewall rules, VPN and so on,\n\n423\n00:20:36.650 --> 00:20:40.870\nthere's a whole ton of additional things,\nbut this firewall is up and running.\n\n424\n00:20:40.870 --> 00:20:43.650\nAny client that's behind this will be\nable to browse through it to get to\n\n425\n00:20:43.650 --> 00:20:46.590\nthe internet, and\nany traffic from the internet coming back\n\n426\n00:20:46.590 --> 00:20:49.670\nis gonna be blocked by default\nunless we requested it.\n\n427\n00:20:49.670 --> 00:20:53.370\nSo we have a fully functional\nfirewall in just a few mouse clicks.\n\n428\n00:20:54.850 --> 00:20:56.086\nAll right,\nwell I hope you guys enjoyed the segment.\n\n429\n00:20:56.086 --> 00:21:01.221\nStay tuned,\nwe've got more pfSense content coming up.\n\n430\n00:21:01.221 --> 00:21:07.410\n[MUSIC]\n\n",
          "vimeoId": "130220890"
        },
        {
          "description": null,
          "length": "1644",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-5-interfaces_and_vlans-061015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-5-interfaces_and_vlans-061015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-1-5-interfaces_and_vlans-061015-1-sm.jpg",
          "title": "Interfaces and VLANs",
          "transcript": "WEBVTT\n\n1\n00:00:00.322 --> 00:00:07.728\n[MUSIC]\n\n2\n00:00:07.728 --> 00:00:11.449\nIn this segment we're going to take\na look at configuring interfaces and\n\n3\n00:00:11.449 --> 00:00:13.715\nVLANs inside of pfSense.\n\n4\n00:00:13.715 --> 00:00:17.491\nNow for a lot of us, when we set up\npfSense, if it's for like a home network,\n\n5\n00:00:17.491 --> 00:00:21.680\nthen you're probably just gonna have two\ninterfaces, an inside and an outside, or\n\n6\n00:00:21.680 --> 00:00:22.675\na LAN and a WAN.\n\n7\n00:00:22.675 --> 00:00:24.325\nIt depends on how you wanna label it.\n\n8\n00:00:24.325 --> 00:00:26.387\nYou can call them whatever you want.\n\n9\n00:00:26.387 --> 00:00:29.840\nIn a two interface model,\nyou've got a protected network and\n\n10\n00:00:29.840 --> 00:00:31.947\nyou've got a public network.\n\n11\n00:00:31.947 --> 00:00:35.327\nAnd then you're filtering everything in\nbetween, and it's pretty cut and dried.\n\n12\n00:00:35.327 --> 00:00:38.900\nBut there's many scenarios where\nwe might actually need to bring in\n\n13\n00:00:38.900 --> 00:00:41.150\nmore than just two networks.\n\n14\n00:00:41.150 --> 00:00:43.100\nAnd that's when we have to get\ninto to start configuring our\n\n15\n00:00:43.100 --> 00:00:47.170\nadditional interfaces and\nto configure virtual local area networks,\n\n16\n00:00:47.170 --> 00:00:49.440\nor VLANs, inside of pfSense.\n\n17\n00:00:49.440 --> 00:00:52.664\n>> When you start taking a look at\nthe different interfaces that you have\n\n18\n00:00:52.664 --> 00:00:55.945\navailable, it may be because you\nare actually hosting, let's say,\n\n19\n00:00:55.945 --> 00:00:57.940\nseveral different departments.\n\n20\n00:00:57.940 --> 00:00:59.750\nBut each one's actually\non their own switch, and\n\n21\n00:00:59.750 --> 00:01:03.960\nyou still still need them to\ndo the same Firewall itself.\n\n22\n00:01:03.960 --> 00:01:07.670\nIf you have the physical ports on\nyour pfSense box, you, of course,\n\n23\n00:01:07.670 --> 00:01:09.900\ncan configure VLANs that way as well.\n\n24\n00:01:09.900 --> 00:01:12.300\nOr it may be that you choose\nto run something like a DMZ,\n\n25\n00:01:12.300 --> 00:01:16.020\nto be able to provide services not only\non the inside of your network but also on\n\n26\n00:01:16.020 --> 00:01:19.440\nthe outside without exposing everything\non the inside of your network as well.\n\n27\n00:01:19.440 --> 00:01:22.070\n>> Yeah, and\nthat concept of a DMZ is very common.\n\n28\n00:01:22.070 --> 00:01:26.020\nYou will see any business that hosts their\nown servers will typically have a DMZ.\n\n29\n00:01:26.020 --> 00:01:28.890\nYou don't have to have a DMZ,\nbut it's a good idea.\n\n30\n00:01:28.890 --> 00:01:30.440\nLet me show you what I mean.\n\n31\n00:01:30.440 --> 00:01:32.350\nSo I've got a little topology\nhere that I drew up, and\n\n32\n00:01:32.350 --> 00:01:35.420\nthis is just a very kind\nof standard example.\n\n33\n00:01:35.420 --> 00:01:39.470\nSo we might have a firewall, and on\nthe inside of our firewall we might have\n\n34\n00:01:39.470 --> 00:01:42.570\nour LAN, our local area network\nthat's a protected network, and\n\n35\n00:01:42.570 --> 00:01:46.260\nthen we have the Internet,\nthis public network out here.\n\n36\n00:01:46.260 --> 00:01:50.360\nWell, when somebody comes from the\noutside, if they need to access a server\n\n37\n00:01:50.360 --> 00:01:53.290\nor resources inside of your network,\nwhat can you do?\n\n38\n00:01:53.290 --> 00:01:57.550\nWell, you could do a port forwarding or\na NAT mapping.\n\n39\n00:01:57.550 --> 00:02:00.950\nSome kind of translation that allows\nsomebody outside to pass through your\n\n40\n00:02:00.950 --> 00:02:03.190\nfirewall to access the internal host.\n\n41\n00:02:03.190 --> 00:02:06.410\nBut what happens if that\nhost gets compromised?\n\n42\n00:02:06.410 --> 00:02:10.090\nIf somebody hacks into that system,\nthey're now on your private network.\n\n43\n00:02:10.090 --> 00:02:13.220\nThey're on your local network and\nyour systems are exposed.\n\n44\n00:02:13.220 --> 00:02:16.310\nSo the better thing to do is anytime\nwe have servers that we need to\n\n45\n00:02:16.310 --> 00:02:20.390\nexpose to the outside world,\nwe put them off into a partition.\n\n46\n00:02:20.390 --> 00:02:24.400\nAnd that partition is called a DMZ,\nit stands for Demilitarized Zone.\n\n47\n00:02:24.400 --> 00:02:25.550\nWe don't necessarily care about that.\n\n48\n00:02:25.550 --> 00:02:30.970\nBut it's a DMZ, and if you put your\nservers here, somebody from the outside\n\n49\n00:02:30.970 --> 00:02:35.880\nworld is able to pass through the firewall\nto access the server down here.\n\n50\n00:02:35.880 --> 00:02:38.646\nIf they compromise that server,\nif they break into it, well,\n\n51\n00:02:38.646 --> 00:02:40.849\nthese servers are not\nallowed to talk to your LAN.\n\n52\n00:02:40.849 --> 00:02:43.610\nThey're not allowed to\nmake that next jump over.\n\n53\n00:02:43.610 --> 00:02:47.480\nAnd so you've created these divisions or\npartitions in your system and\n\n54\n00:02:47.480 --> 00:02:52.460\nthat's really important if you want to\nhave a nice stable network that's up and\n\n55\n00:02:52.460 --> 00:02:54.460\nfunctional at all times.\n\n56\n00:02:54.460 --> 00:02:56.160\nYou've gotta have these\npartitions in place, and\n\n57\n00:02:56.160 --> 00:02:59.310\nwith pfSense it's really easy to do that.\n\n58\n00:02:59.310 --> 00:03:03.820\nAll we have to do is configure\nmore than one interface.\n\n59\n00:03:03.820 --> 00:03:06.720\nWell, if you have just one interface,\n\n60\n00:03:06.720 --> 00:03:09.020\nyou're not having a really\neffective firewall anyway, right?\n\n61\n00:03:09.020 --> 00:03:10.760\nTraffic's gotta come in and go out.\n\n62\n00:03:10.760 --> 00:03:14.940\nIf you have two interfaces you\nhave that basic functionality.\n\n63\n00:03:14.940 --> 00:03:19.770\nBut if you have three or more interfaces,\nnow you can start to create these\n\n64\n00:03:19.770 --> 00:03:22.140\nseparate networks like this and\nit's not so much of a challenge.\n\n65\n00:03:23.410 --> 00:03:25.580\nEven if you've only got\ntwo interfaces though,\n\n66\n00:03:25.580 --> 00:03:29.090\nyou can still achieve this\nthrough the use of VLANs.\n\n67\n00:03:29.090 --> 00:03:31.499\nVLANs are virtual local area networks, and\n\n68\n00:03:31.499 --> 00:03:35.980\nthey're where we divide up one physical\nnetwork into multiple virtual networks.\n\n69\n00:03:35.980 --> 00:03:39.250\nYou can create like fake interfaces\nto separate these out and\n\n70\n00:03:39.250 --> 00:03:41.175\ncreate segments in your system.\n\n71\n00:03:41.175 --> 00:03:43.200\nLet's hold off on that for\na little later in this show.\n\n72\n00:03:43.200 --> 00:03:46.500\nFor right now let's just take\na look at physical interfaces.\n\n73\n00:03:46.500 --> 00:03:50.380\nIf I have a firewall and\nit has more than two physical interfaces,\n\n74\n00:03:50.380 --> 00:03:51.850\nI can create additional networks.\n\n75\n00:03:51.850 --> 00:03:52.830\nAs many as I get, right?\n\n76\n00:03:52.830 --> 00:03:54.710\nAnd when you build a pfSense firewall,\n\n77\n00:03:54.710 --> 00:03:56.660\nthe amount of interfaces you\nhave is entirely up to you.\n\n78\n00:03:57.880 --> 00:04:00.660\nYou can buy systems that\nhave eight NICs in them.\n\n79\n00:04:00.660 --> 00:04:04.340\nYou can buy systems that have three,\nor you can add them as you need them.\n\n80\n00:04:04.340 --> 00:04:06.180\npfSense will recognize that.\n\n81\n00:04:06.180 --> 00:04:07.590\nIt's not immediately obvious though.\n\n82\n00:04:07.590 --> 00:04:11.950\nWhen you log into the pfSense management\nportal, you see that status screen?\n\n83\n00:04:11.950 --> 00:04:14.050\nAnd see how I've got a WAN and\na LAN interface?\n\n84\n00:04:14.050 --> 00:04:17.120\nThose were set up when I\ninitially set up this firewall.\n\n85\n00:04:17.120 --> 00:04:20.100\nIt doesn't show the fact that I\nactually have a third interface too.\n\n86\n00:04:20.100 --> 00:04:22.090\nIt's not here because it's not configured.\n\n87\n00:04:23.190 --> 00:04:26.500\nBut if we want to set that up,\nwe just go up here to interfaces and\n\n88\n00:04:26.500 --> 00:04:28.450\nwe'll see our two\ninterfaces that we've got.\n\n89\n00:04:28.450 --> 00:04:30.550\nI can assign other ones.\n\n90\n00:04:30.550 --> 00:04:32.550\nAnd it's when you go\nto that Assign screen,\n\n91\n00:04:32.550 --> 00:04:36.830\nthat's where you're gonna see any other\navailable network ports that you have.\n\n92\n00:04:36.830 --> 00:04:40.750\nI only have one more, but you might\nhave three or four or ten or a 100.\n\n93\n00:04:40.750 --> 00:04:43.210\nDepends on how crazy you went when\nyou specced out your firewall.\n\n94\n00:04:43.210 --> 00:04:46.280\nYou'll see that list right here\nin the drop down box, and you can\n\n95\n00:04:46.280 --> 00:04:51.150\npick the interface you want to configure,\nand you can add that into your system.\n\n96\n00:04:51.150 --> 00:04:52.690\nNow pfSense will start to use it.\n\n97\n00:04:52.690 --> 00:04:55.960\nSo it knows the interface is there,\nit's just not using it by default.\n\n98\n00:04:57.460 --> 00:05:02.520\nSo if I hit that little plus sign, it's\ngonna add it in, and now I've got WAN,\n\n99\n00:05:02.520 --> 00:05:06.390\nLAN and OPT1, that's optional 1.\n\n100\n00:05:06.390 --> 00:05:08.600\nSo I've got this optional interface.\n\n101\n00:05:08.600 --> 00:05:11.300\npfSense, they don't know what I'm going\nto use it for, so they just call it OPT1.\n\n102\n00:05:11.300 --> 00:05:14.010\nIf I added three more,\nthey'd be OPT2, OPT3, OPT4, and\n\n103\n00:05:14.010 --> 00:05:16.240\nit just kind of keeps going up from there.\n\n104\n00:05:16.240 --> 00:05:19.020\nBut we can always change that name,\nthat's no big deal.\n\n105\n00:05:19.020 --> 00:05:23.260\nIf you click on the interface, you'll see\nwhere we can just enable it or disable it,\n\n106\n00:05:23.260 --> 00:05:24.170\nand that's it.\n\n107\n00:05:24.170 --> 00:05:25.899\nBut we'll be able to change\nthat name here in a moment.\n\n108\n00:05:27.090 --> 00:05:28.930\nI'm gonna go ahead and\nenable the interface and\n\n109\n00:05:28.930 --> 00:05:30.950\nwhen we enable it,\nthere's that description.\n\n110\n00:05:30.950 --> 00:05:32.420\nAnd I'm gonna call mine DMZ.\n\n111\n00:05:33.950 --> 00:05:34.890\nCall it whatever you want.\n\n112\n00:05:34.890 --> 00:05:38.190\nDMZ is how I'll remember that this\nis where my servers are going to be.\n\n113\n00:05:38.190 --> 00:05:40.250\nRonnie gave an example of departments.\n\n114\n00:05:40.250 --> 00:05:44.420\nI might have a sales department and a\nresearch and development team department.\n\n115\n00:05:44.420 --> 00:05:47.530\nAnd I want the R&D department\nto be kind of secured and\n\n116\n00:05:47.530 --> 00:05:50.230\nseparate so\nthat the sales people can't get into R&D.\n\n117\n00:05:50.230 --> 00:05:51.810\nSo I might have different interfaces for\nthem.\n\n118\n00:05:51.810 --> 00:05:54.240\nAnd I would just name them appropriately\nso I could remember which was which.\n\n119\n00:05:56.590 --> 00:05:59.560\nThen we can specify if it's\ngonna have an IPv4 address.\n\n120\n00:05:59.560 --> 00:06:02.540\nYou probably want that so\nyou can route traffic through it.\n\n121\n00:06:02.540 --> 00:06:05.750\nI can come in here and\nsay that this is gonna be static, and\n\n122\n00:06:05.750 --> 00:06:08.140\nI'm not gonna do IPv6 on this one.\n\n123\n00:06:08.140 --> 00:06:10.270\nAnd I can specify a MAC address if I want,\n\n124\n00:06:10.270 --> 00:06:14.090\notherwise it's just gonna use whatever MAC\naddress is on the interface by default.\n\n125\n00:06:14.090 --> 00:06:18.330\nIf you're doing MAC address cloning,\nyou'd put in that other address here.\n\n126\n00:06:18.330 --> 00:06:20.179\nThe MTU will default to 1500 bytes.\n\n127\n00:06:20.179 --> 00:06:21.172\nThat's what we normally want.\n\n128\n00:06:21.172 --> 00:06:23.950\nYou can manipulate that if you need to.\n\n129\n00:06:23.950 --> 00:06:27.630\nAnd then down here we can\nconfigure the IPv4 address.\n\n130\n00:06:27.630 --> 00:06:30.781\nAnd I'm gonna make this one 192.168.1.1,\n\n131\n00:06:30.781 --> 00:06:33.400\nkind of like we saw on my diagram here,\nright?\n\n132\n00:06:33.400 --> 00:06:37.990\nI've got 192.168.0.1 on my LAN,\nI'll do 1.1 here in my DMZ.\n\n133\n00:06:40.200 --> 00:06:42.150\nAnd I'll do that as a 24 bit subnet mask.\n\n134\n00:06:42.150 --> 00:06:45.010\nNow you can do public networks or\nprivate networks.\n\n135\n00:06:45.010 --> 00:06:48.470\nIf you do private networks you'll\nhave to set up some additional NAT\n\n136\n00:06:48.470 --> 00:06:50.640\nrules to translate to public IPs.\n\n137\n00:06:50.640 --> 00:06:52.130\nIf you're doing public ones,\nthen it just works.\n\n138\n00:06:54.150 --> 00:06:58.390\nAll right, we also have that ability to\nblock private networks and bogon networks.\n\n139\n00:06:58.390 --> 00:07:02.140\nI don't want to do that cuz I'm using some\nof those private and whatever networks, so\n\n140\n00:07:02.140 --> 00:07:04.970\nI don't want to block those out, so\nI'm going to leave those turned off.\n\n141\n00:07:06.890 --> 00:07:10.890\nWhen I save that,\nnow I'm going to apply my changes.\n\n142\n00:07:10.890 --> 00:07:13.700\nAnd I'll see I've got three\ninterfaces configured, and\n\n143\n00:07:13.700 --> 00:07:15.630\nthey're three separate networks, right?\n\n144\n00:07:15.630 --> 00:07:17.810\nWAN, LAN and now DMZ.\n\n145\n00:07:19.380 --> 00:07:23.770\nIf I go back to my main status screen, I\nsee all three of them right there, LAN and\n\n146\n00:07:23.770 --> 00:07:25.150\nDMZ are up.\n\n147\n00:07:25.150 --> 00:07:29.800\nNow I called it a DMZ interface, right?\n\n148\n00:07:29.800 --> 00:07:32.551\nBut does the firewall\nknow that it's a DMZ?\n\n149\n00:07:32.551 --> 00:07:35.780\nNo, it just sees it as another network.\n\n150\n00:07:35.780 --> 00:07:39.280\nAnd so the default rules that it creates,\nthe firewall rules, the NAT rules,\n\n151\n00:07:39.280 --> 00:07:42.910\nare probably gonna need to be manipulated\nto get this to work the way that I want.\n\n152\n00:07:42.910 --> 00:07:47.810\nIdeally, I might want the Internet\nto be able to get to my LAN.\n\n153\n00:07:47.810 --> 00:07:49.360\nOr wait-\n>> To get to the DMZ.\n\n154\n00:07:49.360 --> 00:07:50.910\n>> Yeah, that's probably bad.\n\n155\n00:07:50.910 --> 00:07:53.874\n[LAUGH] I want the Internet\nto be able to get to my DMZ.\n\n156\n00:07:53.874 --> 00:07:56.920\nI don't want the Internet to\nbe able to get to my LAN.\n\n157\n00:07:56.920 --> 00:08:01.023\nAnd so I need to create rules there, but\nI want my LAN to be able to get to both,\n\n158\n00:08:01.023 --> 00:08:02.448\nthe Internet and the DMZ.\n\n159\n00:08:02.448 --> 00:08:07.420\nSo, I need to go and start specifying the\nfirewall rules to properly set this up.\n\n160\n00:08:07.420 --> 00:08:09.600\nAnd when we go to our firewall rules,\n\n161\n00:08:11.040 --> 00:08:13.790\nyou'll notice your new interface\nshows up as a tab right there.\n\n162\n00:08:13.790 --> 00:08:15.130\nSo there's that DMZ interface.\n\n163\n00:08:15.130 --> 00:08:17.230\nI can start to specify what I want.\n\n164\n00:08:17.230 --> 00:08:21.120\nSo for example,\non my DMZ I might create a rule here.\n\n165\n00:08:21.120 --> 00:08:23.140\nAnd notice how it's empty?\n\n166\n00:08:23.140 --> 00:08:25.580\npfSense doesn't know what you want\nto do with this network so it says,\n\n167\n00:08:25.580 --> 00:08:27.320\nyou know what,\nwe're just gonna block everything.\n\n168\n00:08:27.320 --> 00:08:29.620\nAnd that's what it's doing is\nblocking everything by default.\n\n169\n00:08:29.620 --> 00:08:31.730\nWe need to tell it what we want it to do.\n\n170\n00:08:31.730 --> 00:08:34.173\nSo I'm gonna add a rule here, and\n\n171\n00:08:34.173 --> 00:08:38.814\nmy rule is gonna say that the DMZ\nis not allowed to access my LAN.\n\n172\n00:08:38.814 --> 00:08:40.470\nI'm just gonna block that outright.\n\n173\n00:08:40.470 --> 00:08:46.080\nSo I'm gonna do a reject and\nit's on the DMZ interface,\n\n174\n00:08:46.080 --> 00:08:49.880\nand I'm gonna say, IPv4,\nIPv6, I don't care.\n\n175\n00:08:49.880 --> 00:08:52.720\nProtocol, I'm gonna set it to any,\nI don't care.\n\n176\n00:08:52.720 --> 00:08:58.206\nAny traffic from my DMZ,\noriginating from the DMZ,\n\n177\n00:08:58.206 --> 00:09:05.447\nwith a destination of my LAN network,\nI'm gonna be rejecting that.\n\n178\n00:09:07.176 --> 00:09:11.580\nSo now the DMZ is gonna be blocked for all\nof that traffic going to the LAN network.\n\n179\n00:09:11.580 --> 00:09:14.795\nAnd then I'm gonna add\none more rule after that.\n\n180\n00:09:14.795 --> 00:09:16.210\nActually I'll just clone this rule.\n\n181\n00:09:17.380 --> 00:09:21.680\nAnd on this one I'm going to\npass traffic from the DMZ,\n\n182\n00:09:21.680 --> 00:09:26.366\nany protocol, and\nI'm going to set it to any destination.\n\n183\n00:09:26.366 --> 00:09:28.620\nI'm gonna set it to any, like that.\n\n184\n00:09:28.620 --> 00:09:32.200\nAll right, so the way these rules will\nwork is that if somebody in the DMZ\n\n185\n00:09:32.200 --> 00:09:35.250\ntries to access my LAN,\nit's gonna get blocked.\n\n186\n00:09:35.250 --> 00:09:37.110\nBut then if they try and\naccess anything else,\n\n187\n00:09:37.110 --> 00:09:39.010\nlike the whole Internet,\nit's gonna be allowed.\n\n188\n00:09:39.010 --> 00:09:42.150\nMy DMZ system's to be allowed\nto pass out to the Internet.\n\n189\n00:09:42.150 --> 00:09:45.540\nNow the DMZ is gonna be\na functional network.\n\n190\n00:09:45.540 --> 00:09:46.210\nI'll go and apply that.\n\n191\n00:09:48.090 --> 00:09:50.280\nThat was part of my equation.\n\n192\n00:09:50.280 --> 00:09:52.770\nI need to think about the other\ndirections of traffic.\n\n193\n00:09:52.770 --> 00:09:55.800\nMy LAN needs to be able to get to the DMZ.\n\n194\n00:09:55.800 --> 00:09:57.350\nWell, it probably already can.\n\n195\n00:09:57.350 --> 00:09:58.650\nLet's look at how my rules are written.\n\n196\n00:09:59.730 --> 00:10:05.566\nIf I jump over to my LAN tab,\nI'll see that my LAN network is allowed,\n\n197\n00:10:05.566 --> 00:10:09.260\nwe've got some DNS rules\nI wrote in another show.\n\n198\n00:10:09.260 --> 00:10:11.030\nI'll just pull that out of there.\n\n199\n00:10:11.030 --> 00:10:15.750\nSo if we look at what I've got here, the\ndefault rules for the LAN state that IPv4,\n\n200\n00:10:15.750 --> 00:10:19.060\nIPv6, it can go wherever it wants.\n\n201\n00:10:19.060 --> 00:10:23.960\nIt can go wherever it wants,\nwhich includes the DMZ as well as the WAN,\n\n202\n00:10:23.960 --> 00:10:25.870\nso my LAN can already get there.\n\n203\n00:10:25.870 --> 00:10:27.160\nI don't have to change these rules at all.\n\n204\n00:10:29.900 --> 00:10:33.500\nAnd then on the WAN side, the WAN side\nis where it gets a little trickier.\n\n205\n00:10:33.500 --> 00:10:36.120\nOn the WAN side here,\nwe normally block everything.\n\n206\n00:10:36.120 --> 00:10:39.750\nWe don't want people on the Internet being\nable to come into our local area network,\n\n207\n00:10:39.750 --> 00:10:40.483\nso it's like this.\n\n208\n00:10:40.483 --> 00:10:43.130\nWe allow replies and that's it.\n\n209\n00:10:43.130 --> 00:10:45.540\nBut now I would need to go through and\n\n210\n00:10:45.540 --> 00:10:48.270\nenter in all the various\nservers that I had.\n\n211\n00:10:48.270 --> 00:10:51.060\nIf I have servers in my DMZ,\nI need to approve them,\n\n212\n00:10:51.060 --> 00:10:53.610\nI could put just a blanket\nrule in here that said\n\n213\n00:10:53.610 --> 00:10:56.630\nall Internet traffic is allowed\nto go to everything on the DMZ.\n\n214\n00:10:56.630 --> 00:10:58.580\nBut we don't normally\nwant to go that open.\n\n215\n00:10:58.580 --> 00:11:00.560\nWe want to restrict down to\nour individual protocols.\n\n216\n00:11:02.340 --> 00:11:04.170\nSo I'm just gonna go and\nadd in some new rules here.\n\n217\n00:11:05.210 --> 00:11:07.350\nAnd we'll just like play pretend here.\n\n218\n00:11:07.350 --> 00:11:09.940\nSo I'm going to pretend that I\nhave a web server in my DMZ.\n\n219\n00:11:09.940 --> 00:11:13.860\nSo I'm going to allow traffic\nwith a destination of.\n\n220\n00:11:13.860 --> 00:11:16.760\nAnd here I would specify\nthat particular host.\n\n221\n00:11:16.760 --> 00:11:21.070\nAnd that host might be 192.168.1.100 or\n\n222\n00:11:21.070 --> 00:11:23.017\nwhatever that server\nhappens to be sitting at.\n\n223\n00:11:23.017 --> 00:11:26.920\nAnd we'd probably wanna use aliases here\njust to make that a little easier on us,\n\n224\n00:11:26.920 --> 00:11:28.500\nbut I'll just specify one.\n\n225\n00:11:28.500 --> 00:11:34.450\nAnd for the destination port I might\njust do HTTP because it is a web server.\n\n226\n00:11:34.450 --> 00:11:36.140\nI will go ahead and save that and\n\n227\n00:11:36.140 --> 00:11:40.275\nnow you'll see I am blocking fake\nnetworks from coming from the Internet.\n\n228\n00:11:40.275 --> 00:11:46.160\nI'm allowing that HTTP traffic to make\nit to the server that's in the DMZ.\n\n229\n00:11:46.160 --> 00:11:48.940\nAnd then there's an implicit\ndenial at the end of this,\n\n230\n00:11:48.940 --> 00:11:50.950\neverything else is getting denied.\n\n231\n00:11:50.950 --> 00:11:55.410\nNotice that in this rule, I never\nmention that the server's in the DMZ.\n\n232\n00:11:55.410 --> 00:11:58.500\nThe only way it knows the server's\nin the DMZ is based on the IP\n\n233\n00:11:58.500 --> 00:11:59.760\naddress, and that's it.\n\n234\n00:11:59.760 --> 00:12:02.050\nSo you don't actually pick\na destination interface,\n\n235\n00:12:02.050 --> 00:12:04.450\nyou're picking destination IPs or\nnetworks.\n\n236\n00:12:04.450 --> 00:12:07.628\nThat's not necessarily the most\nintuitive a thing for some people, but\n\n237\n00:12:07.628 --> 00:12:10.401\nthis is the way it works and\nit is a lot easier having it this way.\n\n238\n00:12:12.351 --> 00:12:13.594\nOn Cisco routers, and\n\n239\n00:12:13.594 --> 00:12:18.440\neven Juniper, they do acknowledge that\ndestination zone that you're going to.\n\n240\n00:12:18.440 --> 00:12:20.570\nAnd it makes these rule\nlists a lot more complex,\n\n241\n00:12:20.570 --> 00:12:22.310\ncuz you have to have the from and the to.\n\n242\n00:12:22.310 --> 00:12:24.980\nHere it's just tied to IP, so\nit ends up being much easier to read,\n\n243\n00:12:24.980 --> 00:12:26.327\nI kinda prefer the pfSense way.\n\n244\n00:12:28.300 --> 00:12:31.900\nBut once that's in business,\nI now have a functioning DMZ, I have, if I\n\n245\n00:12:31.900 --> 00:12:35.540\nput a web server in my DMZ we'll be able\nto get to that, and it was no big deal.\n\n246\n00:12:35.540 --> 00:12:39.210\nI could continue to add more\ninterfaces as I needed them.\n\n247\n00:12:39.210 --> 00:12:43.380\nA three interface firewall is pretty\ncommon, but in an enterprise you might\n\n248\n00:12:43.380 --> 00:12:49.150\nhave 4, 8, 16 ports as you divide up all\nyour departments or separations inside.\n\n249\n00:12:49.150 --> 00:12:50.370\nThere's all sorts of\nstuff you can do there.\n\n250\n00:12:51.500 --> 00:12:55.200\nThe challenge we run into there,\nthough, are the physical interfaces.\n\n251\n00:12:55.200 --> 00:12:58.310\nRonnie, if I came to you and I said,\nI need a firewall that has 16 interfaces,\n\n252\n00:12:58.310 --> 00:13:00.030\ndo you have a recommendation for me?\n\n253\n00:13:00.030 --> 00:13:03.590\n>> I do not have any recommendation\nof any one device, except for\n\n254\n00:13:03.590 --> 00:13:07.280\na switch that would even have more\nthan four or five interfaces.\n\n255\n00:13:07.280 --> 00:13:09.910\n>> Yeah, there's a couple of\nfirewalls out there that you can buy.\n\n256\n00:13:09.910 --> 00:13:12.110\nCisco makes some really high-end ones,\n\n257\n00:13:12.110 --> 00:13:17.170\nand they're 30 or $40,000, they are not\ncheap devices, so they are out there.\n\n258\n00:13:17.170 --> 00:13:21.130\nBut with pfSense, we're just using\nnormal computer hardware typically.\n\n259\n00:13:21.130 --> 00:13:24.730\nAnd there's only so many network\ncards you can jam into a server.\n\n260\n00:13:24.730 --> 00:13:28.090\nYou can get those four port Intel NICs and\nthrow a couple of those in there.\n\n261\n00:13:28.090 --> 00:13:30.836\nMaybe if you need eight or whatever,\nthat's not such a big deal.\n\n262\n00:13:30.836 --> 00:13:35.360\nBut when you need 16 or 24 ports,\nthings really start to get out of hand.\n\n263\n00:13:36.440 --> 00:13:41.840\nSo instead of using physical interfaces,\nwe could use virtual interfaces.\n\n264\n00:13:41.840 --> 00:13:43.810\nYou can do virtual local area networks,\n\n265\n00:13:43.810 --> 00:13:48.620\nor VLANs, to divide up what we're\ngoing to be using on an interface.\n\n266\n00:13:48.620 --> 00:13:53.000\nAnd with VLANs, if you're not familiar\nwith it, most switches these days,\n\n267\n00:13:53.000 --> 00:13:57.780\nmost Layer 2 and Layer 3 switches\nsupport what's called VLAN tagging.\n\n268\n00:13:57.780 --> 00:13:58.800\nAnd with VLAN tagging,\n\n269\n00:13:58.800 --> 00:14:03.730\nwhen your traffic enters a port, it adds a\nlittle note on that traffic, a little tag.\n\n270\n00:14:03.730 --> 00:14:07.930\nIt sticks it in the Layer 2 header\nthat says this traffic is on VLAN, and\n\n271\n00:14:07.930 --> 00:14:08.760\nthen it'll be a number.\n\n272\n00:14:08.760 --> 00:14:13.860\nA number between 1 and 4,094,\nso it says this is on VLAN 5.\n\n273\n00:14:14.900 --> 00:14:17.560\nAnd that traffic is only able to access\n\n274\n00:14:17.560 --> 00:14:20.730\nother systems that\nare also tagged as VLAN 5.\n\n275\n00:14:20.730 --> 00:14:22.390\nIt partitions the network.\n\n276\n00:14:22.390 --> 00:14:26.510\nSo putting this little note in the frame\nas it passes across the network is what\n\n277\n00:14:26.510 --> 00:14:28.040\nkind of differentiates that.\n\n278\n00:14:28.040 --> 00:14:30.380\nIt's incredibly useful, and\n\n279\n00:14:30.380 --> 00:14:35.080\nif you've got HP Procurve switches,\nCisco Catalyst switches,\n\n280\n00:14:35.080 --> 00:14:40.340\nif you've got Junipers or whatever,\nalmost all of them support VLAN tagging.\n\n281\n00:14:40.340 --> 00:14:43.690\nIt's 802.1Q,\nit's a standard system that's out there.\n\n282\n00:14:43.690 --> 00:14:46.350\nAnd pfSense supports it also.\n\n283\n00:14:46.350 --> 00:14:50.720\nNow one word of caution,\nnot every network adapter supports it.\n\n284\n00:14:50.720 --> 00:14:54.760\nSo when you build your pfSense firewall,\nif you're building it with the cheapest\n\n285\n00:14:54.760 --> 00:14:58.030\nnetwork adapters you can find,\nthey might not support VLAN tagging.\n\n286\n00:14:58.030 --> 00:15:01.050\nBut if you're using Intel NICs,\nor Broadcom, or\n\n287\n00:15:01.050 --> 00:15:05.610\nwhatever, those guys almost\nalways support the VLAN tagging.\n\n288\n00:15:05.610 --> 00:15:11.400\nSo we can start to set up additional\ninterfaces in our system using VLANs.\n\n289\n00:15:11.400 --> 00:15:15.960\nAnd when we go to our interfaces menu\nup here, we're seeing our physical\n\n290\n00:15:15.960 --> 00:15:21.100\ninterfaces, And when we go to assign\nwe're seeing our interfaces here.\n\n291\n00:15:21.100 --> 00:15:25.953\nAnd these are all physical,\nreal interfaces that I've got.\n\n292\n00:15:25.953 --> 00:15:29.740\nBut you've got a tab up here for\nVLANs, and\n\n293\n00:15:29.740 --> 00:15:35.170\nwhen you go to VLANs here's where you\ncan start to create virtual interfaces.\n\n294\n00:15:35.170 --> 00:15:37.140\nSo let's do an example here.\n\n295\n00:15:37.140 --> 00:15:39.960\nI said that we were going to\ncreate a DMZ and we did, right.\n\n296\n00:15:39.960 --> 00:15:42.630\nSo under our interface assignments,\nI've got that DMZ interface.\n\n297\n00:15:44.170 --> 00:15:47.099\nInside of my DMZ I've got servers\nexposed to the Internet, and\n\n298\n00:15:47.099 --> 00:15:49.807\nI know that if somebody\ncompromises one of those servers,\n\n299\n00:15:49.807 --> 00:15:53.200\nthey could then leapfrog and start\nhitting the other servers in the DMZ.\n\n300\n00:15:53.200 --> 00:15:56.180\nSo maybe I decide I want to\npartition out those servers.\n\n301\n00:15:56.180 --> 00:16:00.500\nI want to have my database servers\nthat are in the DMZ in one network.\n\n302\n00:16:00.500 --> 00:16:03.700\nAnd my web server's in\nthe DMZ in another network.\n\n303\n00:16:03.700 --> 00:16:06.585\nAnd the web servers are allowed\nto access the database servers,\n\n304\n00:16:06.585 --> 00:16:09.950\nbut the Internet is not allowed\nto access the database servers.\n\n305\n00:16:09.950 --> 00:16:13.350\nWell that's really hard\nto do when we're kind of\n\n306\n00:16:13.350 --> 00:16:16.300\nputting them all in one big network.\n\n307\n00:16:16.300 --> 00:16:19.740\nSo if I wanna divide that\nup I can use VLANs instead.\n\n308\n00:16:20.760 --> 00:16:26.140\nSo I can go to my VLAN side here, and I'm\ngonna add in a virtual local area network,\n\n309\n00:16:26.140 --> 00:16:29.130\nand it's gonna ask who\nthe parent's interface is.\n\n310\n00:16:29.130 --> 00:16:34.475\nWhatever interface you choose needs to be\nplugged into a switch that supports VLAN\n\n311\n00:16:34.475 --> 00:16:39.455\ntagging and the port that it's plugged\ninto needs to be configured for 802.1Q\n\n312\n00:16:39.455 --> 00:16:43.215\nVLAN tagging, so that's why I've gotta\npick which interface this is tied to.\n\n313\n00:16:43.215 --> 00:16:48.635\nNow my DMZ is em2, so I'm gonna say\nthat that cable that's plugged in em2\n\n314\n00:16:48.635 --> 00:16:53.465\nis plugged into a switch and that switch\nis configured to recognize VLANs, so\n\n315\n00:16:53.465 --> 00:16:56.285\nthere is some switch-side\nstuff we've got to do.\n\n316\n00:16:56.285 --> 00:16:59.980\nBut after that, I just do my tags and\nmy descriptions.\n\n317\n00:16:59.980 --> 00:17:03.613\nSo I might create VLAN 100, and\n\n318\n00:17:03.613 --> 00:17:08.011\nI'll give it a description of DMZ-Web.\n\n319\n00:17:08.011 --> 00:17:12.190\nSo these are my web servers,\nor I might say, well, DMZ-Web.\n\n320\n00:17:12.190 --> 00:17:13.490\nAll right.\n\n321\n00:17:13.490 --> 00:17:17.828\nAnd then I can create another one,\nand I'll pick that same interface.\n\n322\n00:17:17.828 --> 00:17:21.840\nI'm gonna pick em2, and\nthis one'll be VLAN 200.\n\n323\n00:17:21.840 --> 00:17:26.537\nAnd this one'll be DMZ-Database.\n\n324\n00:17:26.537 --> 00:17:30.774\nAnd then I could continue to add even\nmore, if I had other systems, I kind of\n\n325\n00:17:30.774 --> 00:17:34.300\nrun out of examples, I guess, but maybe-\n>> File server or something.\n\n326\n00:17:34.300 --> 00:17:35.610\n>> Yeah, file servers, there we go.\n\n327\n00:17:35.610 --> 00:17:39.640\nSo if I do VLAN 300 I'll do DMZ-File.\n\n328\n00:17:39.640 --> 00:17:41.845\nNow, notice I picked 100, 200, 300.\n\n329\n00:17:41.845 --> 00:17:43.380\nWhere did I get those numbers?\n\n330\n00:17:43.380 --> 00:17:46.110\nI just made them up,\njust pulled them out of a hat.\n\n331\n00:17:46.110 --> 00:17:49.329\nSo you can pick whatever you want,\nit's one through 4,094.\n\n332\n00:17:49.329 --> 00:17:50.800\nThose are your numbers that you pick.\n\n333\n00:17:50.800 --> 00:17:55.403\nIt's got to be able to\nstore this in 16 bits.\n\n334\n00:17:55.403 --> 00:17:55.903\nThat's why we ended up with that number.\n\n335\n00:17:58.300 --> 00:18:00.640\nAll right, so we'll go ahead and\nsave that, and\n\n336\n00:18:00.640 --> 00:18:03.810\nnow when I look at it I've got\nthese three virtual interfaces.\n\n337\n00:18:03.810 --> 00:18:05.410\nThese aren't real interfaces.\n\n338\n00:18:05.410 --> 00:18:10.080\nIf I send traffic out the DMZ-Web\ninterface It's gonna go out em2,\n\n339\n00:18:10.080 --> 00:18:15.550\nit's gonna go out my DMZ interface, but\nit's gonna be tagged as VLAN 100 and\n\n340\n00:18:15.550 --> 00:18:19.260\non the switch this traffic\nwill only be able to reach\n\n341\n00:18:19.260 --> 00:18:23.530\nother people that are also tagged VLAN\n100 so I've created a partition now.\n\n342\n00:18:23.530 --> 00:18:27.960\nI've separated that traffic and\nservers that are in DMZ-Database\n\n343\n00:18:27.960 --> 00:18:31.675\nwill not be able to access DMZ-Web,\nunless I clear that.\n\n344\n00:18:31.675 --> 00:18:33.205\nAnd same thing with the reverse,\n\n345\n00:18:33.205 --> 00:18:36.220\nDMZ-Web won't be able to access\nDMZ-Database unless I clear it.\n\n346\n00:18:36.220 --> 00:18:40.910\nWe now have control, but I didn't have to\nbuy 16 physical interfaces for my server.\n\n347\n00:18:40.910 --> 00:18:43.180\nI'm just subdividing one interface.\n\n348\n00:18:43.180 --> 00:18:46.239\nThat's what VLANs are all about,\ndividing the hardware that you have.\n\n349\n00:18:47.300 --> 00:18:51.990\nAnd now that I've got that in place, if I\ngo up here to my interfaces menu, well,\n\n350\n00:18:51.990 --> 00:18:54.350\nI'm still just seeing my\nphysical interfaces, but\n\n351\n00:18:54.350 --> 00:18:56.500\nI know that I've got these VLANS.\n\n352\n00:18:56.500 --> 00:18:59.260\nIf I go over here to my\ninterface assignments,\n\n353\n00:18:59.260 --> 00:19:02.310\nnotice how I've got new stuff\ndown here in my drop-down box.\n\n354\n00:19:02.310 --> 00:19:04.540\nThere's those VLANS that we created.\n\n355\n00:19:04.540 --> 00:19:08.160\nAnd I can start to create\ninterfaces that are tied to that.\n\n356\n00:19:08.160 --> 00:19:12.011\nI'll choose VLAN 100, and I'll hit add,\n\n357\n00:19:12.011 --> 00:19:16.962\nand then VLAN 200, and add,\nand VLAN 300, and add.\n\n358\n00:19:16.962 --> 00:19:19.773\nI'm adding those to my list, and\nthen I'm gonna edit each one,\n\n359\n00:19:19.773 --> 00:19:23.487\nbecause see how it called them OPT2,\nOPT3, OPT4, those are pretty lame names.\n\n360\n00:19:23.487 --> 00:19:24.906\n>> [LAUGH]\n>> So I'm going to go in and\n\n361\n00:19:24.906 --> 00:19:26.210\nconfigure those.\n\n362\n00:19:26.210 --> 00:19:31.390\nSo this one was DMZ-Web.\n\n363\n00:19:31.390 --> 00:19:33.870\nAnd I really need to assign IP\naddresses and stuff, but for\n\n364\n00:19:33.870 --> 00:19:36.120\nthe sake of time I'll leave that out.\n\n365\n00:19:36.120 --> 00:19:37.310\nWe only want the show to be so long.\n\n366\n00:19:39.390 --> 00:19:40.300\nAnd now I can just go through and\n\n367\n00:19:40.300 --> 00:19:43.250\nstart configuring each one of\nthese to get it put in place.\n\n368\n00:19:43.250 --> 00:19:45.030\nAnd oh,\nit won't let me have a hyphen in the name.\n\n369\n00:19:45.030 --> 00:19:48.420\nWell, I can cope with that I guess.\n\n370\n00:19:48.420 --> 00:19:50.270\nAnd then we add DMZDatabase.\n\n371\n00:19:50.270 --> 00:19:51.228\nWe'll enable that one.\n\n372\n00:19:53.867 --> 00:19:58.417\nAnd just make these so we can kind\nof remember what the heck they are.\n\n373\n00:19:59.965 --> 00:20:02.010\nAnd then we'll have these new\ninterfaces ready to work with.\n\n374\n00:20:02.010 --> 00:20:07.530\nAnd once they're created they're really\nno different than any other interface.\n\n375\n00:20:07.530 --> 00:20:09.616\nOnce they're created you\ntreat them the same.\n\n376\n00:20:09.616 --> 00:20:11.667\nThere's DMZFile.\n\n377\n00:20:11.667 --> 00:20:14.010\nSave that.\n\n378\n00:20:14.010 --> 00:20:15.510\nAnd we'll apply all those changes.\n\n379\n00:20:15.510 --> 00:20:18.990\nOnce that's done, I just treat\nthem like any other interface.\n\n380\n00:20:18.990 --> 00:20:21.790\nSo as soon as this applies.\n\n381\n00:20:21.790 --> 00:20:23.700\nCreating VLANs can take it a moment.\n\n382\n00:20:23.700 --> 00:20:25.460\nA quick word of caution there.\n\n383\n00:20:25.460 --> 00:20:29.729\nIf you're configuring VLANs on the same\ninterface that you're connected to it on,\n\n384\n00:20:29.729 --> 00:20:31.664\nright, your management interface?\n\n385\n00:20:31.664 --> 00:20:32.732\nYou could potentially, well,\n\n386\n00:20:32.732 --> 00:20:35.700\nyou will get disconnected while it applies\nit because it resets the interface.\n\n387\n00:20:35.700 --> 00:20:37.630\nBut you could potentially\nlock yourself out too.\n\n388\n00:20:37.630 --> 00:20:39.880\nSo you've got to be careful\nthere when you configure it.\n\n389\n00:20:39.880 --> 00:20:41.520\nMake sure you've got physical\naccess to the system.\n\n390\n00:20:42.940 --> 00:20:46.770\nBut now when I go to my interface menu,\nsee how I got all these interfaces.\n\n391\n00:20:46.770 --> 00:20:50.730\nAnd it doesn't differentiate between\nwhether they're physical or virtual.\n\n392\n00:20:50.730 --> 00:20:52.830\nThey just show up right there,\nand that's it.\n\n393\n00:20:53.970 --> 00:20:56.160\nYou know,\nI use them just like anything else.\n\n394\n00:20:56.160 --> 00:20:59.560\nWhen I go to my firewall rules,\nI've now got tabs.\n\n395\n00:20:59.560 --> 00:21:05.480\nI can configure that DMZWeb is\nallowed to access the Internet and\n\n396\n00:21:05.480 --> 00:21:08.310\nmy database servers,\nbut not anything else.\n\n397\n00:21:08.310 --> 00:21:11.250\nAnd I can configure the database\nservers so that they're allowed to\n\n398\n00:21:11.250 --> 00:21:15.690\naccess the Internet, but not the internal\nnetwork, or my file servers.\n\n399\n00:21:15.690 --> 00:21:19.250\nWe can start to configure all those\nindividually managing those settings,\n\n400\n00:21:19.250 --> 00:21:23.295\nand as the traffic passes out these\nvirtual interfaces, it gets tagged.\n\n401\n00:21:23.295 --> 00:21:25.628\nOn the switch, it knows where\nto send it based on the tag and\n\n402\n00:21:25.628 --> 00:21:28.310\nits like we've got separate\nphysical interfaces.\n\n403\n00:21:28.310 --> 00:21:29.140\nIt's really awesome stuff.\n\n404\n00:21:30.340 --> 00:21:34.770\nSo, I know we had one of the gentlemen\nin our chat room mention how\n\n405\n00:21:34.770 --> 00:21:39.290\nhe created a VLAN he used for\nadmin traffic, right?\n\n406\n00:21:39.290 --> 00:21:44.320\nBy default,\nwhen you create these networks you\n\n407\n00:21:44.320 --> 00:21:50.510\nassign an IP address to them, and the\nfirewall will respond on those addresses.\n\n408\n00:21:50.510 --> 00:21:57.600\nSo if I take my interface that I made for\nthe DMZ I gave that one 192.168.1.1.\n\n409\n00:21:57.600 --> 00:22:00.380\nIf I stick a server in that network and\n\n410\n00:22:00.380 --> 00:22:04.420\nI browse to 192.168.1.1, I will get the\nweb management portal for the firewall.\n\n411\n00:22:06.010 --> 00:22:07.310\nWe might not want that.\n\n412\n00:22:07.310 --> 00:22:09.975\nWe might want to restrict that\naccess to the firewall itself.\n\n413\n00:22:09.975 --> 00:22:13.059\nSo on each of these VLANs or\nphysical networks,\n\n414\n00:22:13.059 --> 00:22:17.930\nI can put a rule in there that blocked\nall traffic going directly to this IP.\n\n415\n00:22:17.930 --> 00:22:20.353\nAnd then people wouldn't be able to\nget to the management pane anymore.\n\n416\n00:22:20.353 --> 00:22:24.875\nAnd we can create one VLAN, or\na physical interface if we wanted.\n\n417\n00:22:24.875 --> 00:22:28.710\nAnd that one could have access to\nthe management portal of the firewall.\n\n418\n00:22:28.710 --> 00:22:31.520\nAnd that way, now you've got just\none network with that access.\n\n419\n00:22:31.520 --> 00:22:34.780\nThe other networks can't\naccess the firewall at all.\n\n420\n00:22:34.780 --> 00:22:37.630\nIt completely prevents somebody\nfrom hacking into the firewall and\n\n421\n00:22:37.630 --> 00:22:38.650\nbypassing your rules.\n\n422\n00:22:38.650 --> 00:22:39.670\nIt's a great solution.\n\n423\n00:22:39.670 --> 00:22:43.247\nThere's all sorts of different ways\nthat you can use these technologies and\n\n424\n00:22:43.247 --> 00:22:45.935\nit gives you some flexibility that\nyou wouldn't have if it were just\n\n425\n00:22:45.935 --> 00:22:47.115\na hardware based firewall.\n\n426\n00:22:48.645 --> 00:22:52.355\nSo that's a pretty good overview there of,\nRonnie,\n\n427\n00:22:52.355 --> 00:22:53.625\ncan you think of anything I've left out?\n\n428\n00:22:53.625 --> 00:22:55.875\n>> Oh, just a couple of questions Don,\nsince you've said.\n\n429\n00:22:55.875 --> 00:22:58.712\nAnd I have only done the two\ninterface firewalls before.\n\n430\n00:22:58.712 --> 00:23:02.145\nIf you're setting up this thing\nlike the DMZ with the VLANs and\n\n431\n00:23:02.145 --> 00:23:08.300\nyou don't set that IP address on that,\nlike you were just showing, traditionally\n\n432\n00:23:08.300 --> 00:23:11.470\nwhen I do it on a physical interface like\nLAN, that becomes my default gateway.\n\n433\n00:23:11.470 --> 00:23:12.890\nWhat do I do then?\n\n434\n00:23:12.890 --> 00:23:18.370\n>> Yeah, so, normally, if you set up an\ninterface like this, and you give it an IP\n\n435\n00:23:18.370 --> 00:23:22.480\naddress, for that network, the firewall's\ngonna be its default gateway, right?\n\n436\n00:23:22.480 --> 00:23:24.940\nAnd you can configure DHCP for\neach one of these.\n\n437\n00:23:24.940 --> 00:23:27.990\nIf I go up here to services,\nlet me pull up my screen again.\n\n438\n00:23:27.990 --> 00:23:29.440\nIf we go up here to services and\n\n439\n00:23:29.440 --> 00:23:35.190\nDHCP server, notice how we've\ngot DHCP server for LAN and DMZ.\n\n440\n00:23:35.190 --> 00:23:40.930\nWe can configure the DHCP to be able\nto pass for all the other interfaces.\n\n441\n00:23:40.930 --> 00:23:44.040\nThere is a little quirk with DHCP where it\nwon't pick up the other interfaces until\n\n442\n00:23:44.040 --> 00:23:45.030\nit restarts.\n\n443\n00:23:45.030 --> 00:23:47.580\nSo I'll have to restart the firewall for\nthose to show up.\n\n444\n00:23:47.580 --> 00:23:50.370\nBut you can set those up and it'll hand\nit out and be that default gateway.\n\n445\n00:23:50.370 --> 00:23:53.480\nFor the interfaces that I didn't\nconfigure an IP on, right?\n\n446\n00:23:53.480 --> 00:23:54.977\nSo like DMZFile.\n\n447\n00:23:54.977 --> 00:23:57.687\nThis interface,\nI didn't configure an IP on it, and\n\n448\n00:23:57.687 --> 00:24:00.920\nbasically this interface is not\ngonna be functional, right?\n\n449\n00:24:00.920 --> 00:24:03.360\nPeople don't have a way\nto route traffic to it.\n\n450\n00:24:03.360 --> 00:24:07.310\nThe only time you'd do this without an IP,\nwould be if you're in transparent mode.\n\n451\n00:24:07.310 --> 00:24:10.390\nAnd you don't normally have more two\nnetworks when you're in transparent mode,\n\n452\n00:24:10.390 --> 00:24:12.070\nbecause you've got no real\ngood way to route stuff.\n\n453\n00:24:12.070 --> 00:24:14.230\nIt just goes in one interface,\nand out another.\n\n454\n00:24:14.230 --> 00:24:19.069\nSo typically, that is an important step,\ngoing in and assigning that IP.\n\n455\n00:24:19.069 --> 00:24:22.255\n>> Now Don, in our chat room,\nPaul actually asked a very good question,\n\n456\n00:24:22.255 --> 00:24:25.873\ncuz he may not understand that the rules\non whether you're actually doing it for\n\n457\n00:24:25.873 --> 00:24:29.761\nthe virtual interface that you created on\nthe physical interface, did they interact\n\n458\n00:24:29.761 --> 00:24:33.265\nany differently, or did they just\ntreat them like regular interfaces?\n\n459\n00:24:33.265 --> 00:24:35.725\n>> Yeah, they treat them\nlike regular interfaces, so\n\n460\n00:24:35.725 --> 00:24:38.715\nthere's no crazy interactions there beyond\nwhat you'd have with normal interfaces.\n\n461\n00:24:38.715 --> 00:24:40.845\nNow, there is one thing I should\nhave mentioned, and I didn't.\n\n462\n00:24:40.845 --> 00:24:45.495\nI set up em2, right, my interface em2.\n\n463\n00:24:46.495 --> 00:24:51.166\nThat's the one that I set up as\na DMZ originally, right, and\n\n464\n00:24:51.166 --> 00:24:56.308\nthen I went and created all of\nthese VLANs on em2 also, all right?\n\n465\n00:24:56.308 --> 00:24:59.825\nSo what happens there,\nbetween the virtual traffic, and\n\n466\n00:24:59.825 --> 00:25:03.430\nthe physical traffic that's going out em2?\n\n467\n00:25:03.430 --> 00:25:05.160\nWell, they're still treated separately.\n\n468\n00:25:05.160 --> 00:25:09.230\nThe difference here, is traffic\nsent out this DMZ interface that's\n\n469\n00:25:09.230 --> 00:25:13.900\nactually tied to em2,\nthat's what's called untagged traffic.\n\n470\n00:25:13.900 --> 00:25:17.870\nSo that traffic won't have a VLAN tag\non it, and when the switch gets it,\n\n471\n00:25:17.870 --> 00:25:22.500\nthat traffic will only be able to see\nother systems that are also untagged.\n\n472\n00:25:22.500 --> 00:25:25.730\nSo, by not being tagged,\nin a way, it kind of is tagged.\n\n473\n00:25:25.730 --> 00:25:29.740\nIt's on its own separate VLAN,\nit just happens to be the physical one.\n\n474\n00:25:29.740 --> 00:25:31.632\nThe other guys are the ones that\nare getting partitioned off.\n\n475\n00:25:31.632 --> 00:25:37.015\nNow, there's various schools of thought on\nhow you should pick which one is native.\n\n476\n00:25:37.015 --> 00:25:37.970\n>> [LAUGH]\n>> I usually don't\n\n477\n00:25:37.970 --> 00:25:39.760\nlike to use a native one at all.\n\n478\n00:25:39.760 --> 00:25:43.080\nSo what I might do, is take this DMZ and\njust get rid of it, and say,\n\n479\n00:25:43.080 --> 00:25:45.350\nI don't need that physical one.\n\n480\n00:25:45.350 --> 00:25:48.000\nI want all traffic to be tagged.\n\n481\n00:25:48.000 --> 00:25:51.780\n>> And when I do that, see how I got\nrid of em0, but I still have my VLANs?\n\n482\n00:25:51.780 --> 00:25:54.621\nYou don't have to have\nthat parent interface.\n\n483\n00:25:54.621 --> 00:25:58.076\nNow, all of my traffic coming out\nof that is going to be tagged, and\n\n484\n00:25:58.076 --> 00:26:00.014\nit all be partitioned based on that.\n\n485\n00:26:00.014 --> 00:26:03.272\nSo I could always create another one\nlike a DMZ generic or something,\n\n486\n00:26:03.272 --> 00:26:07.390\nthat I put other servers in, but now I'm\nnot kinda tied to that physical one.\n\n487\n00:26:07.390 --> 00:26:08.870\nBut as far as the rules,\n\n488\n00:26:08.870 --> 00:26:11.740\nonce you get to that point,\nthere is literally no difference.\n\n489\n00:26:11.740 --> 00:26:14.990\nWhen you go into the rules, there's\nno difference between a physical and\n\n490\n00:26:14.990 --> 00:26:15.670\na virtual interface.\n\n491\n00:26:15.670 --> 00:26:16.530\nThey're configured the same.\n\n492\n00:26:17.970 --> 00:26:19.811\n>> Sounds good.\n>> Yeah, so.\n\n493\n00:26:19.811 --> 00:26:21.142\nAll right, well ladies and gentlemen,\n\n494\n00:26:21.142 --> 00:26:22.996\nthat's a pretty good overview\nof interfaces in VLANs.\n\n495\n00:26:22.996 --> 00:26:25.115\nObviously, there's a ton of\ndifferent ways you can use this.\n\n496\n00:26:25.115 --> 00:26:26.555\nIt's a great technology.\n\n497\n00:26:26.555 --> 00:26:29.625\nDo be aware that there's some\nswitch side set up, right?\n\n498\n00:26:29.625 --> 00:26:30.145\nOn your switch,\n\n499\n00:26:30.145 --> 00:26:33.265\nyou've gotta configure the cable you're\nplugging in, to be a trunk port.\n\n500\n00:26:33.265 --> 00:26:37.497\nIt's gotta support 802.1,\n802.1Q VLAN tagging.\n\n501\n00:26:37.497 --> 00:26:39.939\n>> [LAUGH]\n>> It's how we remember these things.\n\n502\n00:26:39.939 --> 00:26:42.305\n[LAUGH] So, you do need to configure that.\n\n503\n00:26:42.305 --> 00:26:46.950\nIf you wanna see an example from the Cisco\nside, jump over to our CCENT show,\n\n504\n00:26:46.950 --> 00:26:49.910\nour Cisco Entry Network Technician show.\n\n505\n00:26:49.910 --> 00:26:52.358\nWe show how to configure\nit on the CISCO side there.\n\n506\n00:26:52.358 --> 00:26:54.170\nIf you're using HP ProCurve, or\n\n507\n00:26:54.170 --> 00:26:57.530\n3Com, or somebody like that, well you\ncan find it in the vendor documentation.\n\n508\n00:26:57.530 --> 00:27:00.460\nIt is very, very commonly supported.\n\n509\n00:27:00.460 --> 00:27:03.500\nI'm surprised when I encounter a switch\nthat doesn't support VLANs these days.\n\n510\n00:27:03.500 --> 00:27:06.300\nIf you get a cheap one that you bought at\nBest Buy, it probably won't support it,\n\n511\n00:27:06.300 --> 00:27:10.280\nbut if you've got a 24 port switch,\nthe odds are it supports VLAN.\n\n512\n00:27:10.280 --> 00:27:12.410\nSo just take in the documentation and\nsee what you've got.\n\n513\n00:27:13.512 --> 00:27:14.995\nAll right,\nwell I hope you guys enjoyed the segment.\n\n514\n00:27:14.995 --> 00:27:17.694\nStay tuned,\nwe've got more pfSense content, coming up.\n\n515\n00:27:17.694 --> 00:27:22.290\n[MUSIC]\n\n",
          "vimeoId": "130429591"
        }
      ],
      "title": "Installing pfSense"
    },
    {
      "episodes": [
        {
          "description": null,
          "length": "1800",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-1-filtering_wan_traffic_060915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-1-filtering_wan_traffic_060915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-1-filtering_wan_traffic_060915-1-sm.jpg",
          "title": "Filtering WAN Traffic",
          "transcript": "WEBVTT\n\n1\n00:00:00.185 --> 00:00:08.393\n[MUSIC]\n\n2\n00:00:08.393 --> 00:00:13.055\nIn this segment, we're gonna take a look\nat filtering internet traffic coming in to\n\n3\n00:00:13.055 --> 00:00:14.390\nour pfSense firewall.\n\n4\n00:00:14.390 --> 00:00:16.140\nAnd honestly,\nif you're deploying a firewall,\n\n5\n00:00:16.140 --> 00:00:18.750\nthis is probably the single\nmost important feature for you.\n\n6\n00:00:18.750 --> 00:00:20.228\nIt's why we normally put it in place.\n\n7\n00:00:20.228 --> 00:00:23.050\nWe say,\nI've got a network I want to protect and\n\n8\n00:00:23.050 --> 00:00:26.310\nI don't want the bad guys getting in\nunless I specifically allow them.\n\n9\n00:00:26.310 --> 00:00:28.750\nSo that's basic WAN filtering.\n\n10\n00:00:28.750 --> 00:00:31.390\nNow I say WAN, Wide Area Network, right?\n\n11\n00:00:31.390 --> 00:00:34.250\nTypically for us the WAN is the internet,\nbut it doesn't have to be.\n\n12\n00:00:34.250 --> 00:00:36.660\nIt could be some private\nnetwork that you've got,\n\n13\n00:00:36.660 --> 00:00:41.130\nit doesn't have to be necessarily\nthe whole Internet that's out there.\n\n14\n00:00:41.130 --> 00:00:43.160\nMaybe you've divided your own network up.\n\n15\n00:00:43.160 --> 00:00:45.030\nI know a lot of people do this\nwith their wireless networks now,\n\n16\n00:00:45.030 --> 00:00:48.740\nwhere they have a private wireless\nnetwork just for you, and\n\n17\n00:00:48.740 --> 00:00:52.880\na public wireless network that's available\nfor other people inside of your company.\n\n18\n00:00:52.880 --> 00:00:54.510\nSo we might be filtering\ntraffic like that,\n\n19\n00:00:54.510 --> 00:00:58.420\nbut the firewall rules themselves,\nthey all pretty much work the same.\n\n20\n00:00:59.470 --> 00:01:02.150\nSo when we set up a pfSense firewall,\n\n21\n00:01:02.150 --> 00:01:05.999\nthere's actually some default firewall\nrules created just, well, by default.\n\n22\n00:01:05.999 --> 00:01:07.720\n>> [LAUGH]\n>> To be super redundant here.\n\n23\n00:01:07.720 --> 00:01:10.460\nSo let's take a look at some of the\ndefault stuff to kind of get an idea of\n\n24\n00:01:10.460 --> 00:01:12.530\nwhat's in place already.\n\n25\n00:01:12.530 --> 00:01:16.960\nSo I've got my firewall here that I've got\nreally just a base install of pfSense.\n\n26\n00:01:16.960 --> 00:01:19.920\nThe only thing I've done is assign\nIP addresses and a password to it.\n\n27\n00:01:19.920 --> 00:01:23.230\nSo everything else is pretty\nmuch stock on this one.\n\n28\n00:01:23.230 --> 00:01:25.090\nYou'll see I've got two interfaces here.\n\n29\n00:01:25.090 --> 00:01:26.170\nA Wide Area Network,\n\n30\n00:01:26.170 --> 00:01:29.520\nthat's my Internet interface,\nwhere I'm getting a DHCP address.\n\n31\n00:01:29.520 --> 00:01:33.080\nI've got a public IP there\n209.251.159.184, that's my public IP,\n\n32\n00:01:33.080 --> 00:01:39.400\nit's unique to this machine, no one else\non the planet is using this IP right now.\n\n33\n00:01:39.400 --> 00:01:41.110\nWell, I'm kind of faking that IP,\n\n34\n00:01:41.110 --> 00:01:43.993\nI think that is actually used by something\nelse in our building, but who cares?\n\n35\n00:01:43.993 --> 00:01:48.860\n[LAUGH] So, somebody else in our building\nright now is like, why isn't this working?\n\n36\n00:01:48.860 --> 00:01:50.400\nAnd it's my fault.\n\n37\n00:01:50.400 --> 00:01:52.470\nBut I've also got my LAN interface.\n\n38\n00:01:52.470 --> 00:01:56.270\nAnd my LAN interface,\nI've got this 192.168.0.1.\n\n39\n00:01:56.270 --> 00:01:57.730\nThat's a private network.\n\n40\n00:01:57.730 --> 00:01:59.600\nIt's my internal machine's.\n\n41\n00:01:59.600 --> 00:02:02.390\nI don't want anybody in the outside\nworld being able to get to that,\n\n42\n00:02:02.390 --> 00:02:04.010\nI want it to be safe.\n\n43\n00:02:04.010 --> 00:02:08.060\nWell, that's the default configuration\nthat pfSense puts in place.\n\n44\n00:02:08.060 --> 00:02:10.470\nIf I go up to the firewall menu and\n\n45\n00:02:10.470 --> 00:02:14.810\nI go down to Rules, I'll get a chance\nto see the rules that are in place.\n\n46\n00:02:14.810 --> 00:02:18.420\nAnd there's really only\ntwo rules that are there,\n\n47\n00:02:18.420 --> 00:02:21.910\ntwo rules that were put in by\nthe initial configuration wizard.\n\n48\n00:02:21.910 --> 00:02:24.710\nIf you watched our episode on\ndoing the initial configuration,\n\n49\n00:02:24.710 --> 00:02:30.120\nyou'll remember there were two rules that\nwere created to block RFC1918 networks and\n\n50\n00:02:30.120 --> 00:02:32.070\nto block the Bogon networks.\n\n51\n00:02:32.070 --> 00:02:35.610\nThese are our IP addresses that\nare not in use on the Internet,\n\n52\n00:02:35.610 --> 00:02:38.210\nthat you really shouldn't\nbe receiving traffic on.\n\n53\n00:02:38.210 --> 00:02:41.010\nSo, it's created these two rules and\n\n54\n00:02:41.010 --> 00:02:43.400\nthat's it, it's blocking everything,\nright Ronnie?\n\n55\n00:02:43.400 --> 00:02:45.180\n>> Yeah.\nWhen you start taking a look at the WAN\n\n56\n00:02:45.180 --> 00:02:47.950\ninterface, you'll actually see that\neven though it says two rules,\n\n57\n00:02:47.950 --> 00:02:50.290\nthere's actually three that are there.\n\n58\n00:02:50.290 --> 00:02:53.230\nAnd that third one's actually listed\nin that grayed out portion that says,\n\n59\n00:02:53.230 --> 00:02:55.250\nlook, I'm not only blocking these two, but\n\n60\n00:02:55.250 --> 00:02:59.930\nby default we're blocking\neverything else from coming in.\n\n61\n00:02:59.930 --> 00:03:03.270\nSo this is really the default safety\nthat we have on most firewalls,\n\n62\n00:03:03.270 --> 00:03:04.790\nwhether it's pfSense or anything else.\n\n63\n00:03:04.790 --> 00:03:08.300\nAnd we're saying we don't want traffic\noriginating from the outside network,\n\n64\n00:03:08.300 --> 00:03:11.430\nregardless of where it is,\nthat it's gonna be allowed inside.\n\n65\n00:03:11.430 --> 00:03:15.090\nSo right at the beginning we\nclosed off every single port\n\n66\n00:03:15.090 --> 00:03:16.780\nthat's actually available out there.\n\n67\n00:03:16.780 --> 00:03:20.930\nAnd that is the safest rules that we can\nhave, but it may not be very useful.\n\n68\n00:03:20.930 --> 00:03:22.609\n>> Yeah, so as this is written,\n\n69\n00:03:22.609 --> 00:03:27.430\n100% of traffic from the outside\nworld coming in is gonna be blocked.\n\n70\n00:03:27.430 --> 00:03:30.060\nNow that's actually not entirely true.\n\n71\n00:03:30.060 --> 00:03:34.360\nWe have to remember that pfSense is\nwhat's called a stateful firewall.\n\n72\n00:03:34.360 --> 00:03:38.330\nIt's monitoring not just IP addresses,\nbut actually communications or\n\n73\n00:03:38.330 --> 00:03:39.980\nconversations, right?\n\n74\n00:03:39.980 --> 00:03:45.280\nSo, if somebody on my inside network\nreaches out to a website like CNN,\n\n75\n00:03:45.280 --> 00:03:49.270\nthey go to www.CNN.com and\nthey say,give me a copy of your homepage.\n\n76\n00:03:49.270 --> 00:03:53.980\nIf I look at my LAN rules,\non the LAN side we allow that.\n\n77\n00:03:53.980 --> 00:03:54.798\nLook at these rules here,\n\n78\n00:03:54.798 --> 00:03:58.560\nit's allowing everything,\neverything is allowed out by default.\n\n79\n00:03:58.560 --> 00:04:03.500\nSo I can get to CNN, but\nthen CNN has to reply back to me.\n\n80\n00:04:04.520 --> 00:04:08.550\nHow does it know to do that, how does it\nknow to let that traffic come back in?\n\n81\n00:04:08.550 --> 00:04:11.315\nAnd it does it by monitoring state.\n\n82\n00:04:11.315 --> 00:04:14.795\nThat state, that stateful connection\nthat happens says all right,\n\n83\n00:04:14.795 --> 00:04:16.115\nif somebody requests it,\n\n84\n00:04:16.115 --> 00:04:20.264\nwe'll create a temporary firewall rule\nthat allows that traffic to come back in.\n\n85\n00:04:20.264 --> 00:04:23.305\nNow we don't see that,\nthat's all in the background.\n\n86\n00:04:23.305 --> 00:04:28.235\nIf I fire up a web browser and\nI go to CNN.com,\n\n87\n00:04:28.235 --> 00:04:31.945\nit's gonna load the images for the page,\nit's gonna load a million advertisements,\n\n88\n00:04:31.945 --> 00:04:35.880\nit's gonna load all this different\nstuff right here on the page.\n\n89\n00:04:35.880 --> 00:04:38.810\nAnd if I go back to my\npfSense firewall and\n\n90\n00:04:38.810 --> 00:04:45.170\nI jump over to my WAN rules, I'm not gonna\nsee any new rules that appear there.\n\n91\n00:04:45.170 --> 00:04:47.120\nThat's all in the background, and\n\n92\n00:04:47.120 --> 00:04:51.480\nyou can sort of see it if you go\nto your diagnostics, and pfTop.\n\n93\n00:04:51.480 --> 00:04:54.590\nOr I've actually got that pulled\nup on the firewall right now.\n\n94\n00:04:54.590 --> 00:04:58.504\nI can start to see these states where\nyou've got IP addresses over here on\n\n95\n00:04:58.504 --> 00:05:03.402\nthe left, and I can see this one,\n192.1680.100, that's my workstation.\n\n96\n00:05:03.402 --> 00:05:08.116\nAnd it's going out to a public IP,\nthe IP here is 207.46.15.251.\n\n97\n00:05:08.116 --> 00:05:10.357\nI assume that's CNN, I don't know.\n\n98\n00:05:10.357 --> 00:05:14.416\nWhat, that's SSL, so probably not but\neither way, these are the sessions,\n\n99\n00:05:14.416 --> 00:05:18.169\nthese are the states that are being\ncreated between that workstation and\n\n100\n00:05:18.169 --> 00:05:22.130\nthe outside world and the firewall allows\nthat return track to come back in.\n\n101\n00:05:22.130 --> 00:05:25.180\nWhen we look at our firewall\nrules there's actually\n\n102\n00:05:25.180 --> 00:05:27.590\ntwo hidden rules that we don't see.\n\n103\n00:05:27.590 --> 00:05:30.130\nOne that's the block anything\nnot listed above, and\n\n104\n00:05:30.130 --> 00:05:35.190\nanother one that says allow replies to\nconversations that we requested, right?\n\n105\n00:05:35.190 --> 00:05:37.490\nAnd those are both important\nto our default functionality.\n\n106\n00:05:38.510 --> 00:05:42.890\nNow, the default rules as\nthey're written may be perfect,\n\n107\n00:05:42.890 --> 00:05:44.610\nthat may be exactly what we want.\n\n108\n00:05:44.610 --> 00:05:46.880\nI want my intro network to be safe.\n\n109\n00:05:46.880 --> 00:05:50.220\nIf I send a request out,\nI wanna get replies back, but that's it.\n\n110\n00:05:50.220 --> 00:05:51.920\nI don't want any other traffic to come in.\n\n111\n00:05:51.920 --> 00:05:55.700\nI might be done,\nfirewall configured, and walk away.\n\n112\n00:05:55.700 --> 00:05:58.630\nAnd you can, that's one of the things they\ntried to do with pfSense was to make it\n\n113\n00:05:58.630 --> 00:06:02.560\nwhere you could deploy it in its default\nconfig and it works, and it's done.\n\n114\n00:06:02.560 --> 00:06:03.580\nAll right.\n\n115\n00:06:03.580 --> 00:06:06.500\nBut likely, we wanna go ahead and\nconfigure some other things.\n\n116\n00:06:06.500 --> 00:06:08.340\nFor example,\nyou might have a server on your network.\n\n117\n00:06:08.340 --> 00:06:12.160\nMaybe you have a web server in your\nnetwork, or you have a desktop that you\n\n118\n00:06:12.160 --> 00:06:16.270\nwanna be able to remote into, do a little\nRDP to connect to it, all right.\n\n119\n00:06:16.270 --> 00:06:19.380\nWell, if you wanna do those things,\n\n120\n00:06:19.380 --> 00:06:23.280\nyou've got to you're gonna open\nup a hole in the firewall.\n\n121\n00:06:23.280 --> 00:06:25.970\nYou gotta allow that traffic\nto pass through, and\n\n122\n00:06:25.970 --> 00:06:27.120\nby default that's not happening.\n\n123\n00:06:27.120 --> 00:06:30.040\nSo I need to come in and\nadd a few extra entries.\n\n124\n00:06:31.390 --> 00:06:34.970\nSo let's take a look at how\nthese firewall rules are built.\n\n125\n00:06:34.970 --> 00:06:37.710\nThe first thing we need to think\nabout is the direction of traffic.\n\n126\n00:06:37.710 --> 00:06:39.820\nWhen you're creating a firewall rule,\n\n127\n00:06:39.820 --> 00:06:43.560\npfSense filters traffic when\nit comes into the firewall.\n\n128\n00:06:43.560 --> 00:06:46.450\nIt doesn't filter traffic on the way out.\n\n129\n00:06:46.450 --> 00:06:48.520\nSo if I were to look at, let me see,\n\n130\n00:06:48.520 --> 00:06:50.850\nI think we've got a topology\naround here somewhere.\n\n131\n00:06:50.850 --> 00:06:52.269\nHere we go.\n\n132\n00:06:52.269 --> 00:06:57.594\nIf we take a look at a topology like this\none, here's the 192.168.0.0 network.\n\n133\n00:06:57.594 --> 00:06:59.996\nHere's that 209.251 public network.\n\n134\n00:06:59.996 --> 00:07:02.090\nI've got these two different\nnetworks in place.\n\n135\n00:07:02.090 --> 00:07:04.080\nThis one over here on\nthe left is the internet.\n\n136\n00:07:04.080 --> 00:07:06.083\nThe one on the right is\nthe private network.\n\n137\n00:07:06.083 --> 00:07:11.618\nWell, if somebody's out here on\nthe internet and they're trying to access\n\n138\n00:07:11.618 --> 00:07:17.425\nan internal host, so like this server is\ntrying to access my internal network.\n\n139\n00:07:17.425 --> 00:07:20.125\nLet's make this where you can actually\nsee my line that I'm drawing,\n\n140\n00:07:20.125 --> 00:07:21.360\nmy horrible line.\n\n141\n00:07:21.360 --> 00:07:26.790\nSo, if they're trying to access that type\nof network, where's that traffic going?\n\n142\n00:07:26.790 --> 00:07:31.010\nWell, it starts here at this server,\ngoes across the internet,\n\n143\n00:07:31.010 --> 00:07:37.920\nit goes in my WAN interface, it then\ngoes out my LAN interface into the LAN.\n\n144\n00:07:37.920 --> 00:07:40.490\nSo, if I'm gonna filter that traffic,\n\n145\n00:07:40.490 --> 00:07:44.860\nI've got to filter it when it\ngoes in that WAN interface.\n\n146\n00:07:44.860 --> 00:07:48.080\nAnd that's the way this user interface\nis presented to us here in the firewall\n\n147\n00:07:48.080 --> 00:07:50.110\nrules, you've got your WAN and your LAN.\n\n148\n00:07:50.110 --> 00:07:52.000\nAnd those are just the names\nthat I gave those interfaces,\n\n149\n00:07:52.000 --> 00:07:53.670\nI could have called them\nwhatever I wanted, right?\n\n150\n00:07:53.670 --> 00:07:56.710\nThis could be the the red network and\nthe blue network, or whatever.\n\n151\n00:07:56.710 --> 00:07:59.792\nAnd then we would basically see\nthose connection points and\n\n152\n00:07:59.792 --> 00:08:01.340\nbe able to put those rules in.\n\n153\n00:08:03.570 --> 00:08:05.174\nSo let's pretend for a moment.\n\n154\n00:08:05.174 --> 00:08:10.920\nLet's say that I have a web\nserver that is at 192.168.0.100.\n\n155\n00:08:10.920 --> 00:08:12.060\nOr you know actually, I do have a desktop.\n\n156\n00:08:12.060 --> 00:08:18.180\nI've got a desktop in there that is\nrunning Remote Desktop Protocol.\n\n157\n00:08:18.180 --> 00:08:21.700\nI wanna create a firewall rule to allow\nthat traffic to be able to come in so\n\n158\n00:08:21.700 --> 00:08:23.690\nthat external people can connect to it.\n\n159\n00:08:23.690 --> 00:08:27.140\nWell, adding the rules is\nactually a pretty easy process.\n\n160\n00:08:27.140 --> 00:08:29.620\nYou'll see on the right side that\nthere's a series of buttons, and\n\n161\n00:08:29.620 --> 00:08:30.510\nsome of them are grayed out.\n\n162\n00:08:30.510 --> 00:08:33.050\nMost of these are grayed out\ncuz these are default rules and\n\n163\n00:08:33.050 --> 00:08:34.100\nI can't edit them, right?\n\n164\n00:08:34.100 --> 00:08:39.010\nIt won't let you edit these default\nrules beyond certain little limitations.\n\n165\n00:08:39.010 --> 00:08:43.510\nBut the plus sign is telling\nme that I can add a new rule.\n\n166\n00:08:43.510 --> 00:08:46.360\nAnd when you add a new rule, you just\nhit that plus, and they take you to\n\n167\n00:08:46.360 --> 00:08:49.450\na new screen where you get to provide\nall the information for that rule.\n\n168\n00:08:49.450 --> 00:08:53.150\nLet's run through these settings, because\nsome of them you will never use, but\n\n169\n00:08:53.150 --> 00:08:55.210\na lot of them are really important.\n\n170\n00:08:55.210 --> 00:08:56.990\nThe first one is probably\nthe most important.\n\n171\n00:08:58.740 --> 00:09:01.920\nWhen traffic comes through,\nthere's three actions we can take,\n\n172\n00:09:01.920 --> 00:09:05.090\nblock, pass, and reject.\n\n173\n00:09:05.090 --> 00:09:05.770\nAll right.\n\n174\n00:09:05.770 --> 00:09:07.432\nWell pass, that one makes sense.\n\n175\n00:09:07.432 --> 00:09:08.471\n>> Let them go through.\n\n176\n00:09:08.471 --> 00:09:10.170\n>> We want to allow it.\n\n177\n00:09:10.170 --> 00:09:13.480\nBut block and reject,\nthose sound the same don't they?\n\n178\n00:09:13.480 --> 00:09:15.630\nThey sound like they're\ndoing the same thing.\n\n179\n00:09:15.630 --> 00:09:17.830\nWell, it's just really\na different behavior.\n\n180\n00:09:17.830 --> 00:09:19.590\nBoth of them do stop the traffic.\n\n181\n00:09:19.590 --> 00:09:22.900\nBlock and reject are gonna stop\ntraffic from coming through.\n\n182\n00:09:22.900 --> 00:09:26.460\nIf you choose block and\nbad traffic comes along,\n\n183\n00:09:26.460 --> 00:09:29.675\ntraffic that you're blocking,\nyour firewall just throws it away.\n\n184\n00:09:29.675 --> 00:09:32.175\nIt doesn't tell the person on the other\nend, it just throws it away and\n\n185\n00:09:32.175 --> 00:09:33.035\nthat's the end of it.\n\n186\n00:09:33.035 --> 00:09:33.635\nAll right?\n\n187\n00:09:33.635 --> 00:09:35.875\nThe other end has to wait for\ntheir connection to time out, and\n\n188\n00:09:35.875 --> 00:09:38.715\nthen eventually they realize\nthey didn't get through.\n\n189\n00:09:38.715 --> 00:09:42.305\nIf you choose Reject though,\nnot only do you stop it,\n\n190\n00:09:42.305 --> 00:09:45.235\nbut you tell the other side,\nyou say hey, I'm blocking you.\n\n191\n00:09:45.235 --> 00:09:47.160\nYou're not allowed to do this.\n\n192\n00:09:47.160 --> 00:09:50.620\nAnd it tells them, it gives them\nthat moment of rejection, right.\n\n193\n00:09:50.620 --> 00:09:54.100\nYou've got to have that emotional\nturmoil when we filter on a firewall.\n\n194\n00:09:54.100 --> 00:09:56.040\nSo that's what Reject does.\n\n195\n00:09:56.040 --> 00:10:00.075\nAnd if you've got a really busy firewall,\nyou probably don't want to waste resources\n\n196\n00:10:00.075 --> 00:10:03.495\nreaching out and telling bad people\nthat they weren't allowed to get in.\n\n197\n00:10:03.495 --> 00:10:06.585\nSo usually we just use Pass and Block.\n\n198\n00:10:06.585 --> 00:10:09.315\nBut if it's an internal firewall you\nmight wanna use Reject cause it'll\n\n199\n00:10:09.315 --> 00:10:12.195\ncause machines to fail faster and\nthen move onto another one, or\n\n200\n00:10:12.195 --> 00:10:14.260\nget their error message faster,\nit's a little more friendly.\n\n201\n00:10:15.830 --> 00:10:17.440\nIn my case, I wanna pass some traffic.\n\n202\n00:10:17.440 --> 00:10:22.580\nI want to allow someone in the outside\nworld to come in on port 80 for\n\n203\n00:10:22.580 --> 00:10:23.390\nweb traffic.\n\n204\n00:10:23.390 --> 00:10:25.760\nI wanna allow that traffic\nto come into my system.\n\n205\n00:10:27.110 --> 00:10:31.517\nWell, the very next option is Disabled.\n\n206\n00:10:31.517 --> 00:10:34.510\nNow, why would I want to disable\nthe rule if I'm creating it?\n\n207\n00:10:34.510 --> 00:10:35.970\nRonnie, can you think of any reasons?\n\n208\n00:10:35.970 --> 00:10:39.800\n>> A lot of times you just want to test it\nout to verify that when you actually do\n\n209\n00:10:39.800 --> 00:10:43.705\nset the rule in place, that it is\nworking the way you expect it to, and\n\n210\n00:10:43.705 --> 00:10:46.285\nit's not just there, sitting there,\nand you think that it's working.\n\n211\n00:10:46.285 --> 00:10:48.495\nDisabling the rule actually\nallows you to verify whether or\n\n212\n00:10:48.495 --> 00:10:52.105\nnot it's actually working, especially on\na pass, on this side of the firewall.\n\n213\n00:10:52.105 --> 00:10:55.215\n>> Yeah, and it might also be just\na rule you need for a little while.\n\n214\n00:10:55.215 --> 00:10:58.835\nMaybe I need the rule for today,\nbut I don't need it tomorrow.\n\n215\n00:10:58.835 --> 00:11:01.710\nAnd so when I'm done,\nI could delete the rule.\n\n216\n00:11:01.710 --> 00:11:04.970\nBut if I know I might need it again in the\nfuture, I might choose to just disable it.\n\n217\n00:11:04.970 --> 00:11:06.120\nRight?\nDisable the rule.\n\n218\n00:11:06.120 --> 00:11:09.430\nThen you can always come back and\nenable it again if we want.\n\n219\n00:11:09.430 --> 00:11:10.300\nNext, the interface.\n\n220\n00:11:10.300 --> 00:11:12.620\nNow the interface is already\ngonna be chosen for us.\n\n221\n00:11:12.620 --> 00:11:15.480\nI was on the WAN tab when\nI created this rule and so\n\n222\n00:11:15.480 --> 00:11:17.480\nit's creating a WAN interface rule.\n\n223\n00:11:17.480 --> 00:11:19.430\nBut if I was just on the wrong tab,\nI could come in and\n\n224\n00:11:19.430 --> 00:11:21.540\nchange that and pick a different one.\n\n225\n00:11:21.540 --> 00:11:23.120\nBut, in my case, I'm where I need to be.\n\n226\n00:11:24.540 --> 00:11:26.950\nNext, our protocol version.\n\n227\n00:11:26.950 --> 00:11:31.910\nIs this going to be an IPv4 rule,\nan IPv6 rule, or both,\n\n228\n00:11:31.910 --> 00:11:35.568\nan IPv4 rule and\nan IPv6 rule combined into one?\n\n229\n00:11:35.568 --> 00:11:38.350\nYou'll find there's several spots\nthrough this wizard where we can\n\n230\n00:11:38.350 --> 00:11:39.630\ncombine protocols.\n\n231\n00:11:39.630 --> 00:11:41.100\nI'll tell you guys it's\nusually a bad idea.\n\n232\n00:11:41.100 --> 00:11:44.020\nIt doesn't normally work out\nthe way you think it will.\n\n233\n00:11:44.020 --> 00:11:46.020\nSo you normally do want\nto keep them separate.\n\n234\n00:11:46.020 --> 00:11:47.920\nBut we've got that choice right here.\n\n235\n00:11:47.920 --> 00:11:52.340\nNow, Ronnie, I'm not moving any\nIPv6 traffic on this network, so\n\n236\n00:11:52.340 --> 00:11:55.620\nI'm not gonna bother with that, I'm just\ngoing to deal with IPv4 traffic right now.\n\n237\n00:11:58.080 --> 00:12:00.050\nNow comes the hard part.\n\n238\n00:12:00.050 --> 00:12:03.230\nNow we need to think about the source and\nthe destination.\n\n239\n00:12:04.280 --> 00:12:08.640\nWhere's the traffic coming from and\nwhere's the traffic going to?\n\n240\n00:12:08.640 --> 00:12:12.620\nIf I'm trying to allow this\nserver out on the Internet\n\n241\n00:12:12.620 --> 00:12:16.280\nto be able to get to this work station\nthat's running some web server or\n\n242\n00:12:16.280 --> 00:12:19.930\nremote desktop or whatever,\nmy destination is easy.\n\n243\n00:12:19.930 --> 00:12:20.740\nI know my destination.\n\n244\n00:12:20.740 --> 00:12:21.920\nIt's this laptop.\n\n245\n00:12:21.920 --> 00:12:22.820\nRight?\n\n246\n00:12:22.820 --> 00:12:25.440\nBut my source is a lot harder.\n\n247\n00:12:25.440 --> 00:12:28.100\nIf the source is somebody on\na laptop that's out a hotel, or\n\n248\n00:12:28.100 --> 00:12:28.930\nout at a conference, or\n\n249\n00:12:28.930 --> 00:12:32.950\nsomewhere like that, I don't necessarily\nknow what their IP address is going to be.\n\n250\n00:12:32.950 --> 00:12:35.560\nSo, when we go to choose a source,\n\n251\n00:12:35.560 --> 00:12:39.390\nwe may know specifically who we\nwant to allow in, or we may not.\n\n252\n00:12:39.390 --> 00:12:41.590\nAnd pfSense gives us that flexibility.\n\n253\n00:12:41.590 --> 00:12:46.260\nYou can come in and\nyou can say that their source is any,\n\n254\n00:12:46.260 --> 00:12:48.800\nany IP address in the world.\n\n255\n00:12:48.800 --> 00:12:51.800\nIf I have a website, and I want\nthe whole world to be able to get to it,\n\n256\n00:12:51.800 --> 00:12:53.710\nI would choose Any.\n\n257\n00:12:53.710 --> 00:12:56.900\nYeah, you want anybody to\nbe able to get to that.\n\n258\n00:12:56.900 --> 00:13:01.560\nBut if I've got a computer that's\nrunning Remote Desktop Protocol, and\n\n259\n00:13:01.560 --> 00:13:05.040\nI just want me to get to it, I might\nwant to be a lot more specific here,\n\n260\n00:13:05.040 --> 00:13:06.820\nbut If I don't know where I'm going to be.\n\n261\n00:13:06.820 --> 00:13:08.560\nMaybe I'm at a hotel,\nmaybe I'm at a conference.\n\n262\n00:13:08.560 --> 00:13:12.130\nI can't get to it,\nI would need to choose that Any, right.\n\n263\n00:13:12.130 --> 00:13:14.110\nSo, other options we have?\n\n264\n00:13:14.110 --> 00:13:14.930\nSingle hosts.\n\n265\n00:13:14.930 --> 00:13:18.960\nYou could put in a single IP address, this\none IP is allowed to get to this host.\n\n266\n00:13:18.960 --> 00:13:21.480\nYou could do networks,\nentire ranges, if you wanted.\n\n267\n00:13:21.480 --> 00:13:23.460\nWe usually use those internally.\n\n268\n00:13:23.460 --> 00:13:26.330\nYou'll see other things\nlike letting PPTP or\n\n269\n00:13:26.330 --> 00:13:30.710\nL2TP clients come in, right,\nallowing just your WAN network or\n\n270\n00:13:30.710 --> 00:13:35.350\nWAN address, right, so your public IPs,\nor your LAN network or LAN address.\n\n271\n00:13:35.350 --> 00:13:38.860\nSo you've got a few little aliases\nhere that we can kinda pick from and\n\n272\n00:13:38.860 --> 00:13:41.900\nI'll talk a little bit more\nabout aliases later on.\n\n273\n00:13:41.900 --> 00:13:44.090\nBut, I'll stick with Any for\nthis one cuz it's gonna be a web server.\n\n274\n00:13:45.740 --> 00:13:47.520\nNext, the destination.\n\n275\n00:13:47.520 --> 00:13:49.510\nWhere's the traffic going to?\n\n276\n00:13:49.510 --> 00:13:52.450\nAnd in my case, I'm going to say the\ndestination is going to a single host or\n\n277\n00:13:52.450 --> 00:13:55.570\nalias, and it's going to that\nmachine on the inside of my network.\n\n278\n00:13:55.570 --> 00:13:58.700\nIt was 192.168.0.100.\n\n279\n00:13:58.700 --> 00:13:59.360\nAll right.\n\n280\n00:13:59.360 --> 00:14:01.680\nNow I'm just typing the IP in there.\n\n281\n00:14:01.680 --> 00:14:03.470\nWhen I create the rule,\nit's gonna show up as the IP.\n\n282\n00:14:03.470 --> 00:14:07.520\nI have to remember what\nthat IP address is.\n\n283\n00:14:07.520 --> 00:14:10.900\nAnd this is where aliases come, aliases,\nthey're pretty handy right, Ronnie?\n\n284\n00:14:10.900 --> 00:14:11.500\n>> They are.\n\n285\n00:14:11.500 --> 00:14:15.290\nWhen you start taking a look at an alias,\nit really is taking that IP address and\n\n286\n00:14:15.290 --> 00:14:16.650\nthen we are assigning a name to it.\n\n287\n00:14:16.650 --> 00:14:19.240\nBut we're gonna see that there\nare other advantages to aliases such as\n\n288\n00:14:19.240 --> 00:14:22.000\ngrouping addresses together as well.\n\n289\n00:14:22.000 --> 00:14:22.560\n>> Yeah.\n\n290\n00:14:22.560 --> 00:14:25.710\nFor me, the biggest advantage of\nan alias is putting a name to an IP so\n\n291\n00:14:25.710 --> 00:14:26.507\nyou just remember the name.\n\n292\n00:14:26.507 --> 00:14:28.350\n>> [LAUGH]\n>> That's a lot easier, right.\n\n293\n00:14:28.350 --> 00:14:29.730\nSo I'm gonna do an IP right now.\n\n294\n00:14:29.730 --> 00:14:31.720\nWe'll come back and\nchange that to an alias here in a moment.\n\n295\n00:14:32.950 --> 00:14:35.630\nNext, the destination port range.\n\n296\n00:14:35.630 --> 00:14:40.190\nWhen somebody's accessing our system,\nwhat are they using to access it?\n\n297\n00:14:40.190 --> 00:14:45.270\nAre they accessing a particular protocol\nor is it any, we do have that any option.\n\n298\n00:14:45.270 --> 00:14:48.540\nIf I want to allow any traffic\nto get to this destination.\n\n299\n00:14:48.540 --> 00:14:52.710\nBut in my case, I'm talking about remote\ndesktop or a web server or whatever, so\n\n300\n00:14:52.710 --> 00:14:53.680\nI can come through and pick.\n\n301\n00:14:53.680 --> 00:14:59.520\nNow you can only pick one port or\na range of ports, but that's it.\n\n302\n00:14:59.520 --> 00:15:06.190\nSo if I want to do a web server and RDP\nI'm gonna have to do two rules, all right.\n\n303\n00:15:06.190 --> 00:15:07.870\nSo let's start with the web server first.\n\n304\n00:15:07.870 --> 00:15:10.290\nI'm gonna come in here and\npick HTTP Port 80.\n\n305\n00:15:10.290 --> 00:15:13.090\nAnd notice how I've got a From and\na To field.\n\n306\n00:15:13.090 --> 00:15:15.760\nIf I'm doing a range of ports,\nI can put the low end and\n\n307\n00:15:15.760 --> 00:15:18.723\nthe high end in those two fields and\nit'll do everything in between.\n\n308\n00:15:18.723 --> 00:15:22.370\nBut if I just put a single one in,\nsee how I've got both of them at HTTP 80,\n\n309\n00:15:22.370 --> 00:15:25.010\nwell, that's just gonna get 80 and\nthat's it.\n\n310\n00:15:26.940 --> 00:15:28.770\nLastly, I've got an option to set logging.\n\n311\n00:15:28.770 --> 00:15:31.150\nDo I want to record when\npeople access this?\n\n312\n00:15:31.150 --> 00:15:31.720\nMaybe you do,\n\n313\n00:15:31.720 --> 00:15:34.750\ndepends on the level of security you want,\nI'm not gonna bother here.\n\n314\n00:15:34.750 --> 00:15:35.690\nAnd then a description.\n\n315\n00:15:35.690 --> 00:15:39.640\nSo I'm gonna say this is Web\nserver access for DPLAPTOP.\n\n316\n00:15:40.800 --> 00:15:42.980\nI'm just giving it a description so\nI can remember why I created this rule.\n\n317\n00:15:44.350 --> 00:15:49.090\nNow, when I save that, I'll see my rule\nhere, it's not actually in effect yet,\n\n318\n00:15:49.090 --> 00:15:51.100\nsee how it's got the big Apply\nchanges button up there?\n\n319\n00:15:51.100 --> 00:15:53.990\nSo it hasn't truly taken effect,\nand that's good.\n\n320\n00:15:53.990 --> 00:15:57.557\nCuz potentially you could lock yourself\nout of the firewall as you work with these\n\n321\n00:15:57.557 --> 00:16:00.649\nrules, so it gives you a chance to get\nit set all the way that you want And\n\n322\n00:16:00.649 --> 00:16:01.662\nthen you can apply it.\n\n323\n00:16:01.662 --> 00:16:04.515\nNow notice on this rule, it's a little\ndifferent than the ones above it.\n\n324\n00:16:04.515 --> 00:16:07.930\nThe IPv4 protocol and TCP are set.\n\n325\n00:16:07.930 --> 00:16:09.990\nThere's an any source set.\n\n326\n00:16:09.990 --> 00:16:15.930\nThere's a, whoops, as I go and edit my\nrule, there's a specific destination set.\n\n327\n00:16:15.930 --> 00:16:18.520\nThere's my description and\nwe've got the little green arrow here,\n\n328\n00:16:18.520 --> 00:16:20.270\nletting me know this is a pass rule.\n\n329\n00:16:20.270 --> 00:16:22.002\nIt's allowing traffic through.\n\n330\n00:16:23.737 --> 00:16:27.715\nNow if I want to allow traffic for\nHTTPS also, right?\n\n331\n00:16:27.715 --> 00:16:30.405\nWell, I couldn't do that here at the same\ntime, because the ports aren't in a row.\n\n332\n00:16:30.405 --> 00:16:33.565\nIt's not like 80 and 81,\nI have to do 80 and 443.\n\n333\n00:16:33.565 --> 00:16:38.685\nI can clone this rule really quick,\nand then just change that protocol.\n\n334\n00:16:38.685 --> 00:16:41.865\nWhen I hit the plus up here,\nthat creates an all-new rule.\n\n335\n00:16:41.865 --> 00:16:45.105\nBut when I hit the plus beside a rule,\n\n336\n00:16:45.105 --> 00:16:48.555\nit's gonna create a new\nrule based on this one.\n\n337\n00:16:48.555 --> 00:16:50.060\nSo when I hit that plus,\n\n338\n00:16:50.060 --> 00:16:54.670\nit's gonna automatically fill everything\nin just like it was on the other rule, and\n\n339\n00:16:54.670 --> 00:16:56.880\nall I have to do is come through and\nchange what I wanna change.\n\n340\n00:16:56.880 --> 00:17:01.050\nI'm gonna switch this to HTTPS,\nand then I'll save it.\n\n341\n00:17:01.050 --> 00:17:01.670\nRight.\n\n342\n00:17:01.670 --> 00:17:06.010\nIt's the same rule otherwise, just\nthose two little values change, right.\n\n343\n00:17:06.010 --> 00:17:08.660\nSo quick and easy way to clone it, and I\ncan even do that for a remote desktop if I\n\n344\n00:17:08.660 --> 00:17:12.200\nwanted to add that one in to it, add\nanother rule, basically mirroring the ones\n\n345\n00:17:12.200 --> 00:17:15.420\nfrom before, and I don't know if\nthey have RDP as a preset or not.\n\n346\n00:17:15.420 --> 00:17:16.031\nLet's see.\n\n347\n00:17:16.031 --> 00:17:18.048\nSo 33-89.\n\n348\n00:17:18.048 --> 00:17:19.067\nI don't see it.\n\n349\n00:17:19.067 --> 00:17:20.570\nNo, there it is.\n\n350\n00:17:20.570 --> 00:17:22.020\nMSRDP.\n\n351\n00:17:22.020 --> 00:17:23.240\nSo, all right, we can find a.\n\n352\n00:17:23.240 --> 00:17:26.020\nIf it's not in the list you can just\nchoose other, and type in the port number\n\n353\n00:17:26.020 --> 00:17:28.660\nright there, it doesn't actually matter\nwhether it knows the name or not.\n\n354\n00:17:29.820 --> 00:17:30.480\nAnd we'll save that.\n\n355\n00:17:30.480 --> 00:17:34.120\nSo now I've got these three\nrules right in place, all right?\n\n356\n00:17:34.120 --> 00:17:38.650\nNow, the first two rules are blocking\nthose fake networks from the Internet.\n\n357\n00:17:38.650 --> 00:17:43.400\nThen I've got three more rules allowing\nthe traffic that I specifically chose, and\n\n358\n00:17:43.400 --> 00:17:46.920\nthen there's that implicit deny\nrule that's after this blocking\n\n359\n00:17:46.920 --> 00:17:48.720\neverything else, all right?\n\n360\n00:17:48.720 --> 00:17:51.420\nNow we might wanna manually\ncreate a rule that says,\n\n361\n00:17:51.420 --> 00:17:54.340\nlet's block everything else if we\nwanna turn on logging for that.\n\n362\n00:17:54.340 --> 00:17:57.280\nI'll tell you, it's usually a bad idea cuz\nyour logs will fill up really fast but\n\n363\n00:17:57.280 --> 00:17:58.190\nyou can do that if you want.\n\n364\n00:17:58.190 --> 00:17:59.570\nYou can stick one on the end.\n\n365\n00:17:59.570 --> 00:18:00.990\nSome people like to put\none on the end just so\n\n366\n00:18:00.990 --> 00:18:03.740\nthey can remember it's there,\nright, so they don't forget.\n\n367\n00:18:03.740 --> 00:18:04.960\nBut it is kinda pointless, right?\n\n368\n00:18:04.960 --> 00:18:06.420\nIt is automatically gonna block that.\n\n369\n00:18:07.460 --> 00:18:09.830\nBut just for completeness,\nI'll go ahead and add one.\n\n370\n00:18:09.830 --> 00:18:10.610\nDown here at the bottom.\n\n371\n00:18:10.610 --> 00:18:13.870\nAnd we'll just stick a rule in here,\nthat's gonna do a block.\n\n372\n00:18:13.870 --> 00:18:18.050\nAnd I'm gonna set this one for\nIPv4, and IPv6,\n\n373\n00:18:18.050 --> 00:18:24.940\nwe'll set it to any protocol suite,\nany source, any destination.\n\n374\n00:18:24.940 --> 00:18:26.450\nWe won't bother logging.\n\n375\n00:18:26.450 --> 00:18:30.280\nAnd I'll just call this\nmy Catchall Deny Rule.\n\n376\n00:18:31.760 --> 00:18:32.510\nAll right.\n\n377\n00:18:32.510 --> 00:18:36.020\nAnd so, now I'm basically creating\na visual representation of what's\n\n378\n00:18:36.020 --> 00:18:36.790\nalready there, right.\n\n379\n00:18:36.790 --> 00:18:39.270\nThat rule is already there,\nI don't have to create it.\n\n380\n00:18:39.270 --> 00:18:44.480\nBut now I can visually remember it,\nsome people find that's useful.\n\n381\n00:18:44.480 --> 00:18:46.470\nAll right.\nNone of this actually takes effect until I\n\n382\n00:18:46.470 --> 00:18:48.440\napply the change, so I'll apply it.\n\n383\n00:18:48.440 --> 00:18:50.680\nAnd now it's in place.\n\n384\n00:18:50.680 --> 00:18:55.450\nAnd the firewall table reloads, and\nnow these new rules are in place.\n\n385\n00:18:55.450 --> 00:18:58.890\nSomeone on the internet could pass\nthrough my firewall and these ports,\n\n386\n00:18:58.890 --> 00:19:01.080\nthey'd be able to get\ninto my internal hosts.\n\n387\n00:19:01.080 --> 00:19:01.820\nAll right?\n\n388\n00:19:01.820 --> 00:19:03.720\nWell, there's some routing\nstuff that comes into play.\n\n389\n00:19:03.720 --> 00:19:06.140\nWe'll talk more about\nthat in the NAT episode.\n\n390\n00:19:06.140 --> 00:19:10.062\nBut for right now as far as the rules\nare concerned, those are basically it.\n\n391\n00:19:10.062 --> 00:19:14.628\nNow, Ronnie, I mentioned aliases so\nI wanna show everybody that real quick.\n\n392\n00:19:14.628 --> 00:19:19.020\nYou said, it's a great way to\nassign a name to an IP, or\n\n393\n00:19:19.020 --> 00:19:22.515\nto have one rule apply to more\nthan one protocol, right?\n\n394\n00:19:22.515 --> 00:19:26.180\n>> It's a little bit more efficient as\nwell, so the two rules that Don just\n\n395\n00:19:26.180 --> 00:19:30.810\ncreated, believe it or not by using\naliases, we can just about combine those.\n\n396\n00:19:30.810 --> 00:19:32.620\nThe only reason why Don\nhas two separate rules,\n\n397\n00:19:32.620 --> 00:19:35.260\nis because those port numbers\nare not directly adjacent or\n\n398\n00:19:35.260 --> 00:19:38.540\nthey're not actually able to be\ncombined when you do it separately, but\n\n399\n00:19:38.540 --> 00:19:42.110\nyou can see that we can create aliases not\nonly for things like IP addresses, but\n\n400\n00:19:42.110 --> 00:19:44.800\nwe can also do it for\nthings like port numbers as well.\n\n401\n00:19:44.800 --> 00:19:46.930\n>> Yeah, so\nif I go up here to my firewall menu,\n\n402\n00:19:46.930 --> 00:19:49.700\nyou've got aliases right there at the top.\n\n403\n00:19:49.700 --> 00:19:51.690\nAnd there's all sorts of\ndifferent aliases you can create.\n\n404\n00:19:51.690 --> 00:19:54.900\nAliases for IP addresses,\nfor ports, for URL's right.\n\n405\n00:19:54.900 --> 00:19:56.270\nAll sorts of different ones.\n\n406\n00:19:56.270 --> 00:19:57.610\nLet's take IP's.\n\n407\n00:19:57.610 --> 00:20:00.020\nMy workstation,\nI'm treating it as a web server.\n\n408\n00:20:00.020 --> 00:20:03.722\nRight?\nSo maybe I create an alias called,\n\n409\n00:20:03.722 --> 00:20:07.620\nwe'll call it Internal Web Servers.\n\n410\n00:20:07.620 --> 00:20:10.060\nNotice the character\nlimitations over here.\n\n411\n00:20:10.060 --> 00:20:12.147\nLetter, numbers, and\nunderscores, and that's it, so\n\n412\n00:20:12.147 --> 00:20:14.160\nthat's why I'm using\nunderscores instead of spaces.\n\n413\n00:20:14.160 --> 00:20:17.310\nBut I'm gonna call these\ninternal web servers, and\n\n414\n00:20:17.310 --> 00:20:21.380\nwe can just give it a description of,\nwell, internal web servers.\n\n415\n00:20:21.380 --> 00:20:23.470\nYeah, it's pretty inscriptive already.\n\n416\n00:20:23.470 --> 00:20:25.200\nAnd I'll say,\nwhat I'm putting in here, a host.\n\n417\n00:20:25.200 --> 00:20:27.260\nYou could do networks, right.\n\n418\n00:20:27.260 --> 00:20:30.690\nThere's ports and URLs also, but\nI'm going to be doing hosts, right.\n\n419\n00:20:30.690 --> 00:20:33.030\nAny time I have a web server\non my network, I'll come and\n\n420\n00:20:33.030 --> 00:20:34.480\nI'll add it to this alias.\n\n421\n00:20:34.480 --> 00:20:36.830\nAnd so I can come in and\nI can start to add those.\n\n422\n00:20:36.830 --> 00:20:40.450\nBut maybe I want an alias just for\nthat individual IP address, right.\n\n423\n00:20:40.450 --> 00:20:45.950\nMaybe I want DPLAPTOP, and\nI'll just say that this is Don's laptop.\n\n424\n00:20:45.950 --> 00:20:48.618\nAnd it's gonna be a host,\nand that one's going to be,\n\n425\n00:20:48.618 --> 00:20:52.171\nI'll just hit the plus sign,\nand it's 192.168.0.100.\n\n426\n00:20:52.171 --> 00:20:54.288\nThat's my laptop, all right.\n\n427\n00:20:54.288 --> 00:20:57.897\nSo I'll go ahead and punch that in and\nsave it, and now I've got an alias for\n\n428\n00:20:57.897 --> 00:21:01.130\nmy laptop, and\nI can refer to my laptop by name.\n\n429\n00:21:01.130 --> 00:21:06.357\nAnd I might create another alias, and\nthis one will be my Internal_Web_Servers,\n\n430\n00:21:08.725 --> 00:21:10.750\nAnd so we'll populate that.\n\n431\n00:21:12.480 --> 00:21:15.700\nAnd then I'll stick with hosts on this\none, but now when I go to add host,\n\n432\n00:21:15.700 --> 00:21:20.760\nI can add in any other devices\neither by IP or even by name.\n\n433\n00:21:20.760 --> 00:21:24.550\nSee as I started to type DP,\nit's got DPLAPTOP right there.\n\n434\n00:21:24.550 --> 00:21:28.610\nAnd now my laptop is its\nown individual entity, and\n\n435\n00:21:28.610 --> 00:21:30.560\nI've been added to internal web servers.\n\n436\n00:21:30.560 --> 00:21:32.460\nI might have another alias.\n\n437\n00:21:32.460 --> 00:21:35.800\nLet's say,\nI've got like a WEBSERVE01, right.\n\n438\n00:21:35.800 --> 00:21:36.690\nSo WEBSERVE01.\n\n439\n00:21:36.690 --> 00:21:40.070\nI might say that this\nis a Apache web server.\n\n440\n00:21:41.770 --> 00:21:47.356\nAnd I'll add it.\nMaybe it's 192.168.0.101.\n\n441\n00:21:47.356 --> 00:21:48.012\nAll right.\n\n442\n00:21:48.012 --> 00:21:52.010\nSo now I got DP laptop and\nwebservo one here on my list.\n\n443\n00:21:52.010 --> 00:21:56.715\nI can go edit this internal web servers,\nand I can take that one,\n\n444\n00:21:56.715 --> 00:21:59.950\nand I can add WEBSERV01 to it, all right.\n\n445\n00:22:01.150 --> 00:22:03.850\n>> Now Don, this is a great screen for\nus to take a look at for a moment.\n\n446\n00:22:03.850 --> 00:22:05.840\nThat was my fault too.\n\n447\n00:22:05.840 --> 00:22:06.530\n>> There we go.\n\n448\n00:22:06.530 --> 00:22:09.730\n>> When you're actually wondering\nwhen can I actually use alias.\n\n449\n00:22:09.730 --> 00:22:11.320\nInside of pfSense.\n\n450\n00:22:11.320 --> 00:22:15.840\nA lot of times the easiest way to tell is\nthat when you click on one of those boxes,\n\n451\n00:22:15.840 --> 00:22:20.080\nif the background turns red, it is prime\nand ready for you to use an alias.\n\n452\n00:22:20.080 --> 00:22:23.390\nAnd so once you actually get those setup,\nwhether you're actually in a firewall rule\n\n453\n00:22:23.390 --> 00:22:26.840\nor any other place, when you see that red\nbackground, it's probably gonna look for\n\n454\n00:22:26.840 --> 00:22:28.280\nan alias, and you can actually type it in.\n\n455\n00:22:28.280 --> 00:22:29.250\nShould be ready to go.\n\n456\n00:22:29.250 --> 00:22:30.780\n>> You know Ronnie?\n\n457\n00:22:30.780 --> 00:22:32.140\nI never knew that until now.\n\n458\n00:22:32.140 --> 00:22:33.900\n>> It's true!\n>> [LAUGH] I always just start typing and\n\n459\n00:22:33.900 --> 00:22:34.570\nsee if it pops up.\n\n460\n00:22:34.570 --> 00:22:35.370\nI had no idea.\n\n461\n00:22:35.370 --> 00:22:37.454\nBut you're exactly right, it is red.\n\n462\n00:22:37.454 --> 00:22:38.890\n>> [LAUGH] Well, thank you.\n\n463\n00:22:38.890 --> 00:22:40.480\n>> Learn something new every day, right?\n\n464\n00:22:40.480 --> 00:22:41.720\nSo, here we go.\n\n465\n00:22:41.720 --> 00:22:43.960\nSo I've got it set where I've got\nthese multiple hosts in there.\n\n466\n00:22:43.960 --> 00:22:48.710\nNow the cool part is, I can go and,\nwhen I create a rule, for the destination,\n\n467\n00:22:48.710 --> 00:22:52.810\ninstead of putting one particular machine,\nI can point to one of these servers, or\n\n468\n00:22:52.810 --> 00:22:56.650\none of these aliases, and it'll get\nmore than one machine at the same time.\n\n469\n00:22:56.650 --> 00:22:57.440\nThat's a lot of power.\n\n470\n00:22:57.440 --> 00:23:00.460\nI'm gonna go ahead and hit apply\nchanges here so that takes effect.\n\n471\n00:23:00.460 --> 00:23:03.410\nIt doesn't change much,\njust saves the aliases.\n\n472\n00:23:03.410 --> 00:23:05.540\nBut I'm also gonna go under my ports.\n\n473\n00:23:06.540 --> 00:23:11.240\nAnd let's say for my web servers,\nI know I wanna allow 80 and 443.\n\n474\n00:23:11.240 --> 00:23:13.761\nAnd maybe there's some\nother ports I wanna add for\n\n475\n00:23:13.761 --> 00:23:16.000\nother things that I use on my system.\n\n476\n00:23:16.000 --> 00:23:18.700\nSo I can come in and\nI can create an alias.\n\n477\n00:23:18.700 --> 00:23:24.920\nAnd I'm gonna call this\nalias maybe Web_Services.\n\n478\n00:23:24.920 --> 00:23:30.990\nSo I'll put HTTP and related service\nprotocols as my description.\n\n479\n00:23:30.990 --> 00:23:36.090\nAnd down here for my ports, I'm gonna\nstart adding these in, I'm gonna add in 80\n\n480\n00:23:36.090 --> 00:23:42.690\nand 443, and maybe I've got\nsome proprietary web app and\n\n481\n00:23:42.690 --> 00:23:47.680\nit uses ADHD or whatever, and so I'll\ngive these names so I can remember them.\n\n482\n00:23:47.680 --> 00:23:49.660\nSo I might have HTTP,\n\n483\n00:23:49.660 --> 00:23:54.490\nHTTPS, you might wanna stick SSL\nin there so you can remember it.\n\n484\n00:23:54.490 --> 00:23:58.970\nIn this one, I might call it\nmy Proprietary Web App, right?\n\n485\n00:23:58.970 --> 00:24:00.853\nSo we start populating\nall this information.\n\n486\n00:24:00.853 --> 00:24:04.853\nThese ports are not in order,\nthey're not in a row, they're just.\n\n487\n00:24:04.853 --> 00:24:07.573\nWhen I'm going in there,\nand when I save that,\n\n488\n00:24:07.573 --> 00:24:11.330\nI've now got this one alias that\nencompasses all of those ports.\n\n489\n00:24:12.690 --> 00:24:17.600\nSo when I go back to my firewall rules,\nand I go to my rules screen,\n\n490\n00:24:18.690 --> 00:24:23.520\nand my WAN interface, instead of creating\nthree rules or two rules or however many,\n\n491\n00:24:23.520 --> 00:24:28.060\nI could create a new rule that\njust used those aliases instead.\n\n492\n00:24:28.060 --> 00:24:33.260\nNow before I showed you guys how you could\nuse this plus sign to add a cloned rule,\n\n493\n00:24:33.260 --> 00:24:35.350\nbut notice there's a little\narrow symbol also.\n\n494\n00:24:35.350 --> 00:24:39.100\nAnd see how it says move\nselected rules before this rule?\n\n495\n00:24:39.100 --> 00:24:40.800\nWell, I want to create a new rule and\n\n496\n00:24:40.800 --> 00:24:45.500\nI want it to go right here, and there's\nnot really a way for me to add one in.\n\n497\n00:24:45.500 --> 00:24:47.770\nSo when I create my new rule\nit's gonna go to the bottom and\n\n498\n00:24:47.770 --> 00:24:50.530\nthen I'll need to move\nit up into position.\n\n499\n00:24:50.530 --> 00:24:52.220\nSo I am gonna come over here and\ncreate a new rule.\n\n500\n00:24:53.310 --> 00:24:59.382\nAnd this is gonna pass traffic on the WAN,\nits IPV4 traffic, its TCP traffic,\n\n501\n00:24:59.382 --> 00:25:05.726\nthe source is any, but my destination, my\ndestination is going to be single host or\n\n502\n00:25:05.726 --> 00:25:10.690\nalias, and for the alias I am\ngonna type in, what did I call it?\n\n503\n00:25:10.690 --> 00:25:12.630\n>> Web server?\n\n504\n00:25:12.630 --> 00:25:17.250\n>> This is the hard part,\nis remembering what you called the alias.\n\n505\n00:25:17.250 --> 00:25:20.440\nDid I call it public or internal?\n\n506\n00:25:20.440 --> 00:25:22.930\nThere it is, internal web servers,\nthat's what I called it.\n\n507\n00:25:22.930 --> 00:25:26.510\nYou gotta remember your alias,\nthat's the hard part I guess.\n\n508\n00:25:26.510 --> 00:25:27.110\nAll right.\n\n509\n00:25:27.110 --> 00:25:31.860\nSo this rule is gonna apply to traffic\ndestined for my internal web servers.\n\n510\n00:25:31.860 --> 00:25:35.660\nAnd for my port range, I'm not gonna\nbother with this drop-down box over here.\n\n511\n00:25:35.660 --> 00:25:39.735\nI'm just gonna type, and\nI'm gonna pick my web services.\n\n512\n00:25:39.735 --> 00:25:40.475\nPort range.\n\n513\n00:25:40.475 --> 00:25:42.775\nNow, I'm just gonna leave\nthis other field blank.\n\n514\n00:25:42.775 --> 00:25:44.215\nIt'll clone it for me later on.\n\n515\n00:25:44.215 --> 00:25:47.215\nYou can type it in if you want, but\nI'm gonna leave that blank for right now.\n\n516\n00:25:47.215 --> 00:25:53.135\nAnd I'll just call this my Public Web\nServers, and we'll save that rule.\n\n517\n00:25:53.135 --> 00:25:57.925\nNow, when it creates it, I've got that\nnew rule, and see how it went ahead and\n\n518\n00:25:57.925 --> 00:25:58.975\nstuck it at the top for me?\n\n519\n00:25:58.975 --> 00:26:02.605\nAnd that's because I used the plus sign\nup here at the top versus the plus sign\n\n520\n00:26:02.605 --> 00:26:03.480\nat the bottom.\n\n521\n00:26:03.480 --> 00:26:06.820\nBut even if it was in the wrong spot,\nI could always check the rule, and\n\n522\n00:26:06.820 --> 00:26:12.120\nthen hit an arrow anywhere in here,\nand move it to where we want it to be,\n\n523\n00:26:12.120 --> 00:26:14.720\nright, so it's really easy to move\nthese rules around on the screen.\n\n524\n00:26:14.720 --> 00:26:18.640\nIt's not drag and drop, but it's easy\nenough to kind of move that one around and\n\n525\n00:26:18.640 --> 00:26:21.380\nget it into place and\nI can see that rule right here.\n\n526\n00:26:21.380 --> 00:26:24.740\nThat it's allowing access from anybody\n\n527\n00:26:24.740 --> 00:26:27.340\nto my internal web servers\non these web services ports.\n\n528\n00:26:27.340 --> 00:26:29.950\nNow, here's my absolute favorite feature.\n\n529\n00:26:29.950 --> 00:26:32.735\nI can't remember what ports are in\nthere or what IPs are in there.\n\n530\n00:26:32.735 --> 00:26:36.505\nIf you float your mouse over it,\na little box appears and it tells you.\n\n531\n00:26:36.505 --> 00:26:37.905\nHere's the ports that I'm allowing it.\n\n532\n00:26:37.905 --> 00:26:41.305\nIt even gives my little descriptions, and\nhere's the servers that are a part of it.\n\n533\n00:26:41.305 --> 00:26:43.789\nYou don't get your descriptions there,\nit's kind of lame, but\n\n534\n00:26:43.789 --> 00:26:45.215\nyou do see that information.\n\n535\n00:26:45.215 --> 00:26:47.615\nSo it's got the information\nright there where you need it.\n\n536\n00:26:47.615 --> 00:26:52.485\nYou can find out what that rule does,\nand you've even got a quick edit box.\n\n537\n00:26:52.485 --> 00:26:53.885\nIf I wanna edit that alias,\n\n538\n00:26:53.885 --> 00:26:56.960\nI got a new web server,\nI don't have to edit my firewall rule.\n\n539\n00:26:56.960 --> 00:26:58.200\nI can float over this.\n\n540\n00:26:58.200 --> 00:26:59.310\nI've got my internal web servers.\n\n541\n00:26:59.310 --> 00:27:00.120\nI can hit edit.\n\n542\n00:27:00.120 --> 00:27:04.730\nIt'll take me right to that alias, and now\nI can start to add more rules in there.\n\n543\n00:27:04.730 --> 00:27:07.390\nAnd when I'm done, I'm in business, right.\n\n544\n00:27:07.390 --> 00:27:08.369\nEverything is in place.\n\n545\n00:27:08.369 --> 00:27:10.710\nNow I do need to remember\nto hit Apply Changes.\n\n546\n00:27:10.710 --> 00:27:13.440\nBut technically I can go in and\ndelete these other rules.\n\n547\n00:27:13.440 --> 00:27:15.110\nI don't need these guys anymore.\n\n548\n00:27:15.110 --> 00:27:18.580\nAnd I can use the little x\nsymbol to delete those, and\n\n549\n00:27:18.580 --> 00:27:20.070\nthat's gonna delete them out.\n\n550\n00:27:20.070 --> 00:27:22.410\nAnd, oh shoot, I only deleted one.\n\n551\n00:27:22.410 --> 00:27:25.140\nIf you've got more than one rule selected,\nyou should use the x up at the top\n\n552\n00:27:25.140 --> 00:27:26.950\nto delete each of the ones\nthat were selected.\n\n553\n00:27:26.950 --> 00:27:31.400\nI used the wrong x, but I'll just\nknock this other one out individually.\n\n554\n00:27:31.400 --> 00:27:32.610\nGet rid of that one.\n\n555\n00:27:32.610 --> 00:27:35.180\nAnd now I've got a much smaller\n\n556\n00:27:35.180 --> 00:27:37.680\nfirewall rule table that's\na little more human readable.\n\n557\n00:27:37.680 --> 00:27:39.610\nSo those aliases really do come in handy.\n\n558\n00:27:41.400 --> 00:27:44.140\nAll right, so\nonce you've got that in place,\n\n559\n00:27:44.140 --> 00:27:47.790\nnow you got a lean mean filtering machine,\nwe do have a slight problem.\n\n560\n00:27:47.790 --> 00:27:51.030\nMy slight problem is, anybody out\nthere on the Internet is trying to\n\n561\n00:27:51.030 --> 00:27:55.050\naccess my internal web servers, and the\ninternal web servers have internal IPs.\n\n562\n00:27:55.050 --> 00:27:58.310\nSo by itself this actually\nisn't going to work.\n\n563\n00:27:58.310 --> 00:28:01.493\nWe need to combine this with our network\naddress translation rules to be able to\n\n564\n00:28:01.493 --> 00:28:03.350\nallow that traffic to come through.\n\n565\n00:28:03.350 --> 00:28:06.710\nIf I had a DMZ and\nthese servers had public IPs\n\n566\n00:28:06.710 --> 00:28:09.650\nthen yeah the public systems would\nbe able to come in and access these.\n\n567\n00:28:09.650 --> 00:28:12.690\nBut if they got private IPs like I've got,\nthat traffic is not gonna flow.\n\n568\n00:28:12.690 --> 00:28:14.350\nSo stay tuned for our NAT episodes.\n\n569\n00:28:14.350 --> 00:28:17.600\nWe'll take a look at that and\nget a chance to see that in action.\n\n570\n00:28:17.600 --> 00:28:21.310\nBut as far as creating WAN filtering\nrules, I guess pretty much the basics.\n\n571\n00:28:21.310 --> 00:28:22.698\nRonnie, can you think of\nanything else to throw in?\n\n572\n00:28:22.698 --> 00:28:25.360\n>> Nope, just kinda remember\nthat using those aliases,\n\n573\n00:28:25.360 --> 00:28:28.630\nas hard as it seems at the beginning,\ntrying to type in all that stuff,\n\n574\n00:28:28.630 --> 00:28:31.160\nit really is gonna help as\nthose rules become more and\n\n575\n00:28:31.160 --> 00:28:34.670\nmore, that way you don't have to\nremember all the IP addresses and\n\n576\n00:28:34.670 --> 00:28:37.860\nthat is the way that pfSense would\nlove for you to actually work.\n\n577\n00:28:37.860 --> 00:28:40.450\nSometimes you'll also see, and\nwe've experienced this before too, Don,\n\n578\n00:28:40.450 --> 00:28:43.910\nthat sometimes the aliases don't work\nexactly the way that you want them to, so\n\n579\n00:28:43.910 --> 00:28:47.760\nyou may have to play around with them,\njust a little bit to get used to them.\n\n580\n00:28:47.760 --> 00:28:50.550\n>> Another little caveat to throw\nin is every rule has that option at\n\n581\n00:28:50.550 --> 00:28:52.630\nthe bottom to turn on logging.\n\n582\n00:28:52.630 --> 00:28:56.530\nBe careful with the logging because it can\nfill up your logs if you log too much.\n\n583\n00:28:56.530 --> 00:29:01.390\nI will tell you that most people's\ninstinct is to log your block rules,\n\n584\n00:29:01.390 --> 00:29:04.790\nand that's pretty much a waste of time.\n\n585\n00:29:04.790 --> 00:29:06.130\nWhen you log a block rule,\n\n586\n00:29:06.130 --> 00:29:08.630\nthat means that somebody tried to get in,\nand they got blocked.\n\n587\n00:29:08.630 --> 00:29:10.520\nThat means your firewall did\nwhat it was supposed to,\n\n588\n00:29:10.520 --> 00:29:12.640\nthe person didn't get in your network.\n\n589\n00:29:12.640 --> 00:29:14.450\nWe don't really care about that, right?\n\n590\n00:29:14.450 --> 00:29:17.340\nSo logging a block rule is\nreally kind of pointless.\n\n591\n00:29:17.340 --> 00:29:21.700\nLogging a pass rule, on the other hand,\nis a lot more useful.\n\n592\n00:29:21.700 --> 00:29:27.830\nIf I've got SSH enabled on a router, and\nsomebody SSHes into it, I wanna know that.\n\n593\n00:29:27.830 --> 00:29:28.400\nThey got there.\n\n594\n00:29:28.400 --> 00:29:29.960\nThey actually accessed that router.\n\n595\n00:29:29.960 --> 00:29:32.630\nMaybe they didn't have a username and\npassword or they didn't have the right\n\n596\n00:29:32.630 --> 00:29:36.810\ncertificate, but they physically got,\nor virtually got, to that router.\n\n597\n00:29:36.810 --> 00:29:38.860\nThat's information we wanna know.\n\n598\n00:29:38.860 --> 00:29:42.640\nLogging rules for pass rules is usually\na lot more important than logging for\n\n599\n00:29:42.640 --> 00:29:43.500\nblock or reject.\n\n600\n00:29:43.500 --> 00:29:47.462\nJust a little word of\nadvice to throw out there.\n\n601\n00:29:47.462 --> 00:29:48.950\nAll right.\nWell, Ronnie I think this is a pretty good\n\n602\n00:29:48.950 --> 00:29:50.270\nspot for us to wrap this one up.\n\n603\n00:29:50.270 --> 00:29:52.090\nI hope you guys enjoyed it.\n\n604\n00:29:52.090 --> 00:29:54.882\nStay tuned,\nwe've got more pfSense content coming up.\n\n605\n00:29:54.882 --> 00:30:00.240\n[MUSIC]\n\n",
          "vimeoId": "130429593"
        },
        {
          "description": null,
          "length": "1473",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-2-filtering_lan_traffic_060915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-2-filtering_lan_traffic_060915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-2-filtering_lan_traffic_060915-1-sm.jpg",
          "title": "Filtering LAN Traffic",
          "transcript": "WEBVTT\n\n1\n00:00:00.230 --> 00:00:06.170\n[SOUND] In this segment\nwe're gonna take a look\n\n2\n00:00:06.170 --> 00:00:11.807\nat filtering LAN traffic on our firewall.\n\n3\n00:00:11.807 --> 00:00:13.740\nNow that's LAN as in Local Area Network,\n\n4\n00:00:13.740 --> 00:00:17.790\nand this is something that's a little bit\ndifferent than our normal methods, right.\n\n5\n00:00:17.790 --> 00:00:21.640\nNormally we're concerned about keeping\nthe bad guys out of our network.\n\n6\n00:00:21.640 --> 00:00:25.150\nBut sometimes, you wanna keep your\nown people inside your network, and\n\n7\n00:00:25.150 --> 00:00:27.770\nbe a little more restrictive of what\ntraffic's allowed to pass in and\n\n8\n00:00:27.770 --> 00:00:28.860\nout of your company.\n\n9\n00:00:28.860 --> 00:00:30.450\nSo this is an important topic.\n\n10\n00:00:30.450 --> 00:00:31.780\nIt's one that people overlook, but\n\n11\n00:00:31.780 --> 00:00:33.960\ndefinitely something\nthat we need to touch on.\n\n12\n00:00:33.960 --> 00:00:36.130\n>> A lot of times,\nwhat ends up happening for most companies,\n\n13\n00:00:36.130 --> 00:00:39.770\nis that productivity gets lost very\neasily on the computer network,\n\n14\n00:00:39.770 --> 00:00:41.870\nthat's also connected to the Internet.\n\n15\n00:00:41.870 --> 00:00:45.760\nBecause things start popping up and\ngetting, and people get distracted.\n\n16\n00:00:45.760 --> 00:00:48.190\nSo one of the things you can do\nwith your firewall, of course,\n\n17\n00:00:48.190 --> 00:00:49.650\nthen is actually go ahead and do that.\n\n18\n00:00:49.650 --> 00:00:54.700\nYou can set rules in place that will allow\nyou to block access to certain sites and\n\n19\n00:00:54.700 --> 00:00:58.080\ntraffic, or\ncertain places that you want, of course,\n\n20\n00:00:58.080 --> 00:01:00.340\nanybody in your network\nto be able to go to.\n\n21\n00:01:00.340 --> 00:01:02.450\nAnd that way it doesn't\nmatter what they try to do,\n\n22\n00:01:02.450 --> 00:01:04.530\nyou've got it controlled centrally.\n\n23\n00:01:04.530 --> 00:01:07.060\nAnd that way you can actually go ahead and\nimplement the rules like that.\n\n24\n00:01:07.060 --> 00:01:08.739\nAnd that's what we wanna\ntake a look at today.\n\n25\n00:01:08.739 --> 00:01:13.684\n>> Yeah, and now we do need to be careful\nthat, trying to block people's access\n\n26\n00:01:13.684 --> 00:01:15.891\nto individual sites can be a-\n>> Challenge.\n\n27\n00:01:15.891 --> 00:01:17.306\n[LAUGH]\n>> It can be a puric victory,\n\n28\n00:01:17.306 --> 00:01:19.550\na short term victory, if anything.\n\n29\n00:01:19.550 --> 00:01:21.550\nBecause people find ways\nto get around things.\n\n30\n00:01:21.550 --> 00:01:22.080\nThey do VPNs.\n\n31\n00:01:22.080 --> 00:01:26.790\nThey do SSH tunnels, all sorts of\nstuff to bypass firewall filter rules.\n\n32\n00:01:26.790 --> 00:01:28.870\nSo you don't wanna rely\non this specifically, and\n\n33\n00:01:28.870 --> 00:01:32.460\nthere's plenty of other services out there\nyou can use to do URL filtering and all.\n\n34\n00:01:32.460 --> 00:01:36.480\nBut, when this is really handy is\nyou might have something like a test\n\n35\n00:01:36.480 --> 00:01:39.110\nin research and development network.\n\n36\n00:01:39.110 --> 00:01:42.070\nWhere you've got people deploying\nmachines that don't have the normal\n\n37\n00:01:42.070 --> 00:01:44.020\nsecurity policy applied to them.\n\n38\n00:01:44.020 --> 00:01:47.300\nAnd as a result, you might want to create\nfirewall rules that say you know what,\n\n39\n00:01:47.300 --> 00:01:51.520\nthat subnet is not allowed to get to\nthe internet, and he's block it out right.\n\n40\n00:01:51.520 --> 00:01:53.750\nOkay, now that is a very effective rule,\nright?\n\n41\n00:01:53.750 --> 00:01:57.270\nVery hard to get around that you just\nstop all of their access to the internet.\n\n42\n00:01:57.270 --> 00:01:59.510\nBut if you try to block access\nto individual resources,\n\n43\n00:01:59.510 --> 00:02:02.050\nwell we're going to show how to do it,\nit can get really challenging.\n\n44\n00:02:02.050 --> 00:02:05.310\nAnd you know James in the chat\nroom just had a great suggestion.\n\n45\n00:02:05.310 --> 00:02:08.890\nAnother option is instead of trying to\nblock access to individual resources,\n\n46\n00:02:08.890 --> 00:02:12.450\nyou can go the other direction and\nblock everything, and\n\n47\n00:02:12.450 --> 00:02:16.560\ndo a whitelist where you approve\naccess to just certain resources.\n\n48\n00:02:16.560 --> 00:02:17.820\nSo, you know what?\n\n49\n00:02:17.820 --> 00:02:21.420\nYou can only go to the web for\nPOP3 and IMAP, for\n\n50\n00:02:21.420 --> 00:02:24.580\nchecking your email, but\nnot port 25 for SMTP.\n\n51\n00:02:24.580 --> 00:02:27.190\nWe don't want you relaying\nemail out of our organization.\n\n52\n00:02:27.190 --> 00:02:30.890\nYou could go through and specify what's\nallowed and block everything else.\n\n53\n00:02:30.890 --> 00:02:34.030\nSo your approach is really up to you,\nwhich one works best.\n\n54\n00:02:34.030 --> 00:02:37.400\nBut PF Sense has\nthe capabilities built in,\n\n55\n00:02:37.400 --> 00:02:39.330\nwe just need to jump in and configure it.\n\n56\n00:02:39.330 --> 00:02:41.530\n>> So let's go ahead and\ntake a look at how we configure that.\n\n57\n00:02:41.530 --> 00:02:44.740\nAnd so we're gonna take a look at\nour pfSense firewall to do that.\n\n58\n00:02:44.740 --> 00:02:49.380\nSo on my machine I went ahead and\nwent to the tab for Firewall.\n\n59\n00:02:49.380 --> 00:02:51.470\nAnd then selected Rules and\nthat brought me out,\n\n60\n00:02:51.470 --> 00:02:53.520\nof course, to the rules tab and page.\n\n61\n00:02:53.520 --> 00:02:57.890\nWe have the three tabs above here,\nFloating and WAN and then LAN,\n\n62\n00:02:57.890 --> 00:03:00.770\nand we're actually gonna\ntake a look at LAN.\n\n63\n00:03:00.770 --> 00:03:03.230\nBy default once you actually install\n\n64\n00:03:03.230 --> 00:03:06.660\npfSense onto the box that you're\nactually gonna install it onto.\n\n65\n00:03:06.660 --> 00:03:09.720\nYou'll see that it does\ncreate a default role to make\n\n66\n00:03:09.720 --> 00:03:12.610\nsure that you don't get locked\nout of pfSense right away.\n\n67\n00:03:12.610 --> 00:03:15.360\nBut then it also adds in\nthese two other roles.\n\n68\n00:03:15.360 --> 00:03:17.100\nThese are not roles that I created, but\n\n69\n00:03:17.100 --> 00:03:19.010\nit actually gives us these\ntwo other roles here.\n\n70\n00:03:19.010 --> 00:03:22.620\nDefault to allow LAN to any,\nin other words trying to say look,\n\n71\n00:03:22.620 --> 00:03:25.370\nwe're not blocking traffic going outbound.\n\n72\n00:03:25.370 --> 00:03:29.160\nSo if I'm inside of my LAN network,\nI can get access to anywhere.\n\n73\n00:03:29.160 --> 00:03:32.748\nAnd the nice thing is since PF Sense is\nthat stateful firewall, it'll also allow\n\n74\n00:03:32.748 --> 00:03:35.876\nthe returning traffic from those\nplaces that we're coming from too.\n\n75\n00:03:35.876 --> 00:03:38.372\nAnd then it also does it for IPv6.\n\n76\n00:03:38.372 --> 00:03:41.217\nNow if I don't want those rules there,\nI can simply,\n\n77\n00:03:41.217 --> 00:03:42.998\nover here on the right hand side.\n\n78\n00:03:42.998 --> 00:03:46.740\nSelect the X over here and\ndelete those two rules out.\n\n79\n00:03:46.740 --> 00:03:49.150\nI'm just gonna leave them up there for\nright now.\n\n80\n00:03:49.150 --> 00:03:52.260\nCuz they're there, they're not really\nhurting anything at this point.\n\n81\n00:03:52.260 --> 00:03:55.500\nBut if I wanted to be more restrictive\nabout everything I could simply delete\n\n82\n00:03:55.500 --> 00:03:56.805\nthose those two rules out.\n\n83\n00:03:56.805 --> 00:04:03.605\nThat would turn it almost identical to\nthe way that the default WAN rules are.\n\n84\n00:04:03.605 --> 00:04:07.135\nMy Ws and my Rs are going to\nactually kind of betray me today,\n\n85\n00:04:07.135 --> 00:04:08.640\nI can feel that coming on.\n\n86\n00:04:08.640 --> 00:04:09.730\nSo here it is.\n\n87\n00:04:09.730 --> 00:04:11.990\nSo here are the basic land rules.\n\n88\n00:04:11.990 --> 00:04:16.980\nNow, what if I realized for my network,\nthere is a very popular website,\n\n89\n00:04:16.980 --> 00:04:21.250\nso we're just talking about blocking\naccess to a simple website here.\n\n90\n00:04:21.250 --> 00:04:23.490\nWe wanna go ahead and\ndo something like that.\n\n91\n00:04:23.490 --> 00:04:26.420\nWell, I can create a rule\nthat will help me to do that.\n\n92\n00:04:26.420 --> 00:04:31.030\nSo what I'm gonna do is to simply find\nout the IP address of that website.\n\n93\n00:04:31.030 --> 00:04:33.760\nAnd add that into part of this rule.\n\n94\n00:04:33.760 --> 00:04:36.950\nSo we're gonna use slash\ndot as an example.\n\n95\n00:04:36.950 --> 00:04:40.740\nIt's a nice place that you can go and\nread plenty of tech articles, and\n\n96\n00:04:40.740 --> 00:04:43.970\nthey kind of combine them all together,\njust like a news reader does.\n\n97\n00:04:43.970 --> 00:04:46.500\nAnd so\nlet's say that that's now become an issue,\n\n98\n00:04:46.500 --> 00:04:49.940\nand what we wanna do is\neliminate access to that.\n\n99\n00:04:49.940 --> 00:04:56.327\nNow currently if I take a look at where\nI can go to, unless they're the sites,\n\n100\n00:04:56.327 --> 00:05:01.170\nif I can spell it, slashdot.com,\nand it looks like there it is.\n\n101\n00:05:01.170 --> 00:05:03.140\nI'm starting to get access into it, and\n\n102\n00:05:03.140 --> 00:05:06.800\nso there is the website Don has just\nsaid we need to block access to that.\n\n103\n00:05:06.800 --> 00:05:09.840\nIt's just way too, you know,\ntoo many people are getting on there.\n\n104\n00:05:09.840 --> 00:05:12.490\nWe need to just go in and\neliminate that access right now, and\n\n105\n00:05:12.490 --> 00:05:15.360\nwe want to do that by\nusing a firewall rule.\n\n106\n00:05:15.360 --> 00:05:18.130\nSo, remember that the approach\nto firewall rules is,\n\n107\n00:05:18.130 --> 00:05:21.070\nit only works as it's\ncoming into that interface.\n\n108\n00:05:21.070 --> 00:05:22.690\nSo in the WAN interface.\n\n109\n00:05:22.690 --> 00:05:27.440\nSo I'm gonna make sure that I'm actually\ngonna do it on the LAN interface tab.\n\n110\n00:05:27.440 --> 00:05:30.390\nAnd from there I'm gonna\nadd in a new rule.\n\n111\n00:05:30.390 --> 00:05:33.540\nDown here at the bottom where I don't have\nany rules, over here on the right-hand\n\n112\n00:05:33.540 --> 00:05:38.770\nside, I'm going to select the plus symbol,\nand that will bring me up to that site or\n\n113\n00:05:38.770 --> 00:05:42.990\nthat page that gives me that\nability to add that rule in.\n\n114\n00:05:42.990 --> 00:05:45.310\nSo remember we're going to\ntake a look at the action, and\n\n115\n00:05:45.310 --> 00:05:49.090\nwe're not actually allowing it to come\nthrough, but we have the block and\n\n116\n00:05:49.090 --> 00:05:51.650\nwe have the reject at this point.\n\n117\n00:05:51.650 --> 00:05:54.460\nSo when we take a look at\nboth of those options.\n\n118\n00:05:54.460 --> 00:05:58.250\nRemember, block's actually going to\nblock everything and not notify us.\n\n119\n00:05:58.250 --> 00:06:02.320\nIn other words, it's gonna do it pretty\nmuch anonymously without any notification\n\n120\n00:06:02.320 --> 00:06:06.940\nat all, and then reject will give us\na chance to actually be notified.\n\n121\n00:06:06.940 --> 00:06:09.760\nAnd yes, you will see that down\nhere under the description where it\n\n122\n00:06:09.760 --> 00:06:12.660\ntells you that reject says it's,\nthe packet is gonna be returned and\n\n123\n00:06:12.660 --> 00:06:15.100\ntell you that something is\nactually going on here.\n\n124\n00:06:15.100 --> 00:06:18.370\nSo at this point, just because this is a\nsimple rule and I'm doing it for testing,\n\n125\n00:06:18.370 --> 00:06:20.830\nI'm gonna select Reject right now.\n\n126\n00:06:20.830 --> 00:06:24.710\nYou may just choose to block it\noutright and not be notified at all.\n\n127\n00:06:24.710 --> 00:06:29.090\nRemember that this can cause a little\nbit more of a performance issue, or\n\n128\n00:06:29.090 --> 00:06:31.690\nsize issue on the logs a little bit.\n\n129\n00:06:31.690 --> 00:06:34.730\nSo we're actually gonna select\nreject just because this.\n\n130\n00:06:34.730 --> 00:06:37.860\nI have this chance to be\nable to disable this rule.\n\n131\n00:06:37.860 --> 00:06:41.300\nI may want to apply it right now,\nand then later on go,\n\n132\n00:06:41.300 --> 00:06:44.830\nokay we're only gonna need to apply\nit let's say when it really gets bad.\n\n133\n00:06:44.830 --> 00:06:48.220\nI may turn it off after awhile,\nand then I can disable it, and\n\n134\n00:06:48.220 --> 00:06:50.630\nthen if it gets bad again\nI can turn it back on.\n\n135\n00:06:50.630 --> 00:06:51.720\nOr if you're just doing it for\n\n136\n00:06:51.720 --> 00:06:55.960\ntesting is another reason that you may\nchoose to disable this rule as well.\n\n137\n00:06:55.960 --> 00:06:59.230\nAnd then I want to verify that I am\nactually doing this on the correct\n\n138\n00:06:59.230 --> 00:07:00.440\ninterface.\n\n139\n00:07:00.440 --> 00:07:03.670\nSo I've gone ahead and selected the WAN\ninterface and that's what I want.\n\n140\n00:07:03.670 --> 00:07:07.070\nAnd I need to scroll down a little bit,\nand\n\n141\n00:07:07.070 --> 00:07:09.790\nof course then I have to choose whether or\n\n142\n00:07:09.790 --> 00:07:13.630\nnot or what particular protocol version\nthat I'm actually going to do this for.\n\n143\n00:07:13.630 --> 00:07:17.340\nWell I'm not really running\nanything IPv6 on my network, so\n\n144\n00:07:17.340 --> 00:07:19.150\nwe're gonna leave it at IPv4.\n\n145\n00:07:19.150 --> 00:07:23.950\nBut if I was running IPv6 only, I would,\nof course, need to select IPv6.\n\n146\n00:07:23.950 --> 00:07:27.470\nI'm running a combination of those,\nI may choose, of course then,\n\n147\n00:07:27.470 --> 00:07:29.520\nto select both of them as an option.\n\n148\n00:07:29.520 --> 00:07:32.910\nBut for right now I'm just\ngonna leave it here at IPv4.\n\n149\n00:07:34.250 --> 00:07:37.160\nBecause I also know that\nthere's a protocol, and there's\n\n150\n00:07:37.160 --> 00:07:40.480\nplenty of protocols for us to choose\nfrom in the list that they show you.\n\n151\n00:07:40.480 --> 00:07:43.400\nAll the way down to any,\nwhich is every protocol known.\n\n152\n00:07:43.400 --> 00:07:45.850\nBut for us it's just the web page, and\n\n153\n00:07:45.850 --> 00:07:47.680\nusually the default here\nis what they recommend.\n\n154\n00:07:47.680 --> 00:07:50.190\nAnd you'll see that right here\nwith the nice description.\n\n155\n00:07:50.190 --> 00:07:52.940\nThat's one thing I really appreciate\nabout working with PF sets/\n\n156\n00:07:52.940 --> 00:07:54.700\nis that instead of me having to look for\na page.\n\n157\n00:07:54.700 --> 00:07:56.900\nLike oh, which one should I choose?\n\n158\n00:07:56.900 --> 00:08:00.537\nIt just tells me, in most cases you\nshould probably just specify TCP, here.\n\n159\n00:08:00.537 --> 00:08:05.264\nAnd for a web page, that's perfectly\nfine for what we want to be able to do.\n\n160\n00:08:05.264 --> 00:08:09.353\nNow, of course, once we continue\nto move down through this list,\n\n161\n00:08:09.353 --> 00:08:13.224\nwe can actually now choose the source and\nthe destination, and\n\n162\n00:08:13.224 --> 00:08:18.040\nthese are gonna be the addresses\nthat we're actually going to block.\n\n163\n00:08:18.040 --> 00:08:21.020\nAnd of course, then,\nwe're also going to allow.\n\n164\n00:08:21.020 --> 00:08:23.630\nNow, the source right\nnow is specified as any.\n\n165\n00:08:23.630 --> 00:08:27.962\nSo that means any of the addresses\nbehind this LAN interface are,\n\n166\n00:08:27.962 --> 00:08:30.890\nat this point, gonna be blocked outright.\n\n167\n00:08:30.890 --> 00:08:34.490\nAnd that's perfectly fine,\nif that's what I want to do.\n\n168\n00:08:34.490 --> 00:08:36.990\nBut Don mentioned something\na little bit earlier.\n\n169\n00:08:36.990 --> 00:08:39.356\nHe said, what if you actually\ndo have different departments?\n\n170\n00:08:39.356 --> 00:08:43.090\nAnd one department, you really don't care\nabout blocking, they can get access to it,\n\n171\n00:08:43.090 --> 00:08:45.058\nit's just that one\ndepartment that you have,\n\n172\n00:08:45.058 --> 00:08:47.520\nthat one subnet that you\nwant to be able to block.\n\n173\n00:08:47.520 --> 00:08:50.498\nBut remember,\nyou can actually change that right here,\n\n174\n00:08:50.498 --> 00:08:54.777\nand then choose either that single post,\nor you can go to network, and of course,\n\n175\n00:08:54.777 --> 00:08:59.018\nyou can also have some of these others,\nthat you also see down here at the bottom.\n\n176\n00:08:59.018 --> 00:09:01.838\nAnd you'll see even a single\naddress inside of your LAN,\n\n177\n00:09:01.838 --> 00:09:05.030\nor even the entire LAN network,\nthat you're also doing, too.\n\n178\n00:09:05.030 --> 00:09:07.027\nSo it just depends on\nwhat you really need.\n\n179\n00:09:07.027 --> 00:09:09.910\nWe're just gonna set it at NE for\nright now.\n\n180\n00:09:09.910 --> 00:09:12.550\nNow, if I go ahead and do this,\nand I forget the rest of it,\n\n181\n00:09:12.550 --> 00:09:17.170\nsometimes it's very easy to think, you can\ndo this without actually slowing down and\n\n182\n00:09:17.170 --> 00:09:18.600\ntaking with it what you're doing.\n\n183\n00:09:18.600 --> 00:09:22.030\nBut it's the destination here\nthat we want to take a look at.\n\n184\n00:09:22.030 --> 00:09:26.290\nSo, under the destination,\nI can apply for a single host.\n\n185\n00:09:26.290 --> 00:09:30.949\nNow, if I know the host address,\nin other words, the IP address itself.\n\n186\n00:09:30.949 --> 00:09:32.390\nI can go ahead and type it in.\n\n187\n00:09:32.390 --> 00:09:35.260\nThe good thing is,\nI've already found out the IP address, and\n\n188\n00:09:35.260 --> 00:09:38.150\nI copied it over here\nonto just a text editor.\n\n189\n00:09:39.230 --> 00:09:40.280\nLet me see.\n\n190\n00:09:40.280 --> 00:09:43.880\nAnd that way I don't have to actually\nremember what the IP address is.\n\n191\n00:09:43.880 --> 00:09:47.170\nBut that actually reminds me of something,\nthat we'll actually go take care of that\n\n192\n00:09:47.170 --> 00:09:50.450\na little bit later, which of\ncourse is to create an alias port.\n\n193\n00:09:50.450 --> 00:09:54.690\nAssigning a name to the IP address is\ngonna be a lot easier for me to remember.\n\n194\n00:09:54.690 --> 00:09:58.116\nBut for right now, let's just go ahead and\nI'm gonna right-click and\n\n195\n00:09:58.116 --> 00:10:00.100\npaste that IP address in there.\n\n196\n00:10:00.100 --> 00:10:02.880\nSo here's the IP address to Slashdot.\n\n197\n00:10:02.880 --> 00:10:07.550\nSo I'm pretty much saying,\nany network inside of my interface,\n\n198\n00:10:07.550 --> 00:10:12.050\ngoing to this destination, my D's\napparently are gonna be a problem too,\n\n199\n00:10:13.160 --> 00:10:18.020\nand then, I need to scroll down and\nlook for a port AD.\n\n200\n00:10:18.020 --> 00:10:22.930\nSo I'm gonna leave that here for\nthe web address, and\n\n201\n00:10:22.930 --> 00:10:26.480\nscroll down, and\nif I choose to log it, I can, and\n\n202\n00:10:26.480 --> 00:10:31.654\nthen I'm going to enter in a description,\nwhich is to block access to\n\n203\n00:10:31.654 --> 00:10:37.190\nSlashdot.com, and click on save.\n\n204\n00:10:39.260 --> 00:10:43.110\nNow, once this is actually saved,\nnotice it's not applied yet.\n\n205\n00:10:43.110 --> 00:10:44.670\nI've saved the rule, but\n\n206\n00:10:44.670 --> 00:10:47.960\nI still have to apply these changes\nbefore it actually takes place.\n\n207\n00:10:47.960 --> 00:10:52.550\nThe big red bar, of course, tells me that,\nhey, don't think that you're done yet.\n\n208\n00:10:52.550 --> 00:10:55.890\nIf you really want it to apply,\nthis is what we want to be able to do.\n\n209\n00:10:55.890 --> 00:10:57.170\nI'm gonna click Apply.\n\n210\n00:10:58.860 --> 00:11:03.282\nAnd so, now, if I go ahead and run this,\nyou might think, all right, that's cool,\n\n211\n00:11:03.282 --> 00:11:06.180\nI'll run it right now, and\nit should apply right away.\n\n212\n00:11:06.180 --> 00:11:08.720\nSo, we're not gonna do that.\n\n213\n00:11:08.720 --> 00:11:10.280\nLet's just say that\nthis is what I believe,\n\n214\n00:11:10.280 --> 00:11:12.890\nfirst time I've actually put\none of these rules here.\n\n215\n00:11:12.890 --> 00:11:15.820\nAnd I go, all right, cool,\nI've got it, I can test it out.\n\n216\n00:11:15.820 --> 00:11:22.380\nSlashdot.com, and Don,\nit looks like it connected in.\n\n217\n00:11:22.380 --> 00:11:27.080\nLooks like I have a problem with\nmy rules here, on my firewall.\n\n218\n00:11:27.080 --> 00:11:28.880\nI applied it, everything looks good.\n\n219\n00:11:28.880 --> 00:11:30.320\nThe rule looks good.\n\n220\n00:11:30.320 --> 00:11:32.340\nDon, what in the world is going on here?\n\n221\n00:11:32.340 --> 00:11:34.620\n>> It's a blessing and a curse, right.\n\n222\n00:11:34.620 --> 00:11:36.540\nOn a negative side,\nyou put the rule in and\n\n223\n00:11:36.540 --> 00:11:39.270\nit doesn't actually take effect\nright away until you apply.\n\n224\n00:11:39.270 --> 00:11:43.320\nOn a positive side, that means if you\nneed to put in a multi-part rule, maybe,\n\n225\n00:11:43.320 --> 00:11:46.090\nit takes four or\nfive rules to write exactly what you want.\n\n226\n00:11:46.090 --> 00:11:48.400\nYou have that chance to write\nall four of five rules,\n\n227\n00:11:48.400 --> 00:11:52.200\nget it exactly the way you want, and then\nhit Apply, and it all applies at once.\n\n228\n00:11:52.200 --> 00:11:55.654\nThat's really useful, cuz if you're\ndoing things like a whitelist, and you\n\n229\n00:11:55.654 --> 00:11:59.420\nput a rule in that blocks everything, you\nmight lock yourself out from the firewall,\n\n230\n00:11:59.420 --> 00:12:02.062\ncuz you haven't had a chance to\nput in the permit rules yet.\n\n231\n00:12:02.062 --> 00:12:04.280\nOr if you get them in the wrong order,\nyou can lock yourself out.\n\n232\n00:12:04.280 --> 00:12:06.650\nThese are all kind of problems that you\ncan bump into, that's why you have, like,\n\n233\n00:12:06.650 --> 00:12:09.810\nthat anti-lockout rule that's\nup there at the top, and things.\n\n234\n00:12:09.810 --> 00:12:11.355\nThose are there to protect you, right?\n\n235\n00:12:11.355 --> 00:12:14.750\nAnd having to apply the rules,\nthat's there to protect you, too.\n\n236\n00:12:14.750 --> 00:12:18.300\nYou get all the rules put in the way\nyou want, then you apply them at once.\n\n237\n00:12:18.300 --> 00:12:21.120\n>> So, with this rule not applied yet,\nthat's pretty good.\n\n238\n00:12:21.120 --> 00:12:24.180\nBut the problem that I'm having\nhere is now that I look over it,\n\n239\n00:12:24.180 --> 00:12:26.910\nI start to remember something\nabout learning about these rules.\n\n240\n00:12:26.910 --> 00:12:29.360\nThey do apply from the top down.\n\n241\n00:12:29.360 --> 00:12:32.700\nIf I take a look at the list right now,\nwhat I'm seeing is,\n\n242\n00:12:32.700 --> 00:12:34.720\nwell its going to hit\nthis first rule here.\n\n243\n00:12:34.720 --> 00:12:40.039\nWhere it says the LAN net going to any\ndestination, any port, any gateway,\n\n244\n00:12:40.039 --> 00:12:45.045\nwhatever it is, it says, the default\nrule is to allow going any place.\n\n245\n00:12:45.045 --> 00:12:48.680\nThat problem is actually the order,\nso what I want to do is,\n\n246\n00:12:48.680 --> 00:12:51.110\nI want to rearrange these rules.\n\n247\n00:12:51.110 --> 00:12:54.530\nSo I need for this rule that I've\njust appended to the bottom,\n\n248\n00:12:54.530 --> 00:12:58.030\nto really be moved up\nabove this rule here.\n\n249\n00:12:58.030 --> 00:13:01.963\nSo the easiest way to do that is\nI'm gonna select that last rule.\n\n250\n00:13:01.963 --> 00:13:04.514\nAnd over on the right hand side\non these buttons over here,\n\n251\n00:13:04.514 --> 00:13:07.100\nyou actually see tha's there's\na left pointing arrow.\n\n252\n00:13:07.100 --> 00:13:10.050\nAnd if I hover over those two,\nnext to those rules,\n\n253\n00:13:10.050 --> 00:13:12.830\nyou'll see a little red line\nkind of appear above it.\n\n254\n00:13:12.830 --> 00:13:13.990\nAnd then if I hover a little bit more,\n\n255\n00:13:13.990 --> 00:13:16.050\nyou'll actually see that there's\na little screen tip that says,\n\n256\n00:13:16.050 --> 00:13:18.970\nto move the selected\nrule to this location.\n\n257\n00:13:18.970 --> 00:13:20.710\nSo I'm going to click right there.\n\n258\n00:13:22.660 --> 00:13:27.410\nAnd when I do that, I still need to\napply the changes, if I'm gonna do this.\n\n259\n00:13:30.550 --> 00:13:34.970\nAnd from here, you can see where it's now\nmoved that rule above the default rules,\n\n260\n00:13:34.970 --> 00:13:38.170\nwhich is what we really hoped,\nthat everything is now working.\n\n261\n00:13:38.170 --> 00:13:42.705\nSo, if I've done this correctly.\n\n262\n00:13:42.705 --> 00:13:43.205\n>> [CROSSTALK]\n>> Moment of truth, right.\n\n263\n00:13:43.205 --> 00:13:44.250\n>> I know, moment of truth.\n\n264\n00:13:44.250 --> 00:13:45.754\nAnd there it is,\n\n265\n00:13:45.754 --> 00:13:50.458\nit says it's unable to connect.\nIf your computer or network is\n\n266\n00:13:50.458 --> 00:13:54.950\nprotected by a firewall proxy, make sure\nit's actually permitted the web access.\n\n267\n00:13:54.950 --> 00:13:57.500\nSo I am actually now getting\na message saying, hey,\n\n268\n00:13:57.500 --> 00:13:59.730\nthis may have actually been\nblocked by my firewall.\n\n269\n00:13:59.730 --> 00:14:01.780\n>> And notice how fast that failed, too.\n\n270\n00:14:01.780 --> 00:14:04.300\nHe almost immediately got\nthat unable to connect, and\n\n271\n00:14:04.300 --> 00:14:07.580\nthat's because when he set up\na firewall rule, he chose reject.\n\n272\n00:14:07.580 --> 00:14:11.450\nThe firewall actively told him,\nyou are being blocked.\n\n273\n00:14:11.450 --> 00:14:15.360\nIf he had chosen block instead,\nthe firewall just throws away the traffic,\n\n274\n00:14:15.360 --> 00:14:17.658\nso what does your web browser do?\n\n275\n00:14:17.658 --> 00:14:21.480\nWell in Ronnie's case Firefox, Firefox\nwould've said well maybe my request didn't\n\n276\n00:14:21.480 --> 00:14:23.370\nmake it to the server,\nlet me send it again.\n\n277\n00:14:23.370 --> 00:14:24.000\nAnd let me say that again.\n\n278\n00:14:24.000 --> 00:14:25.210\nIt'll send it three times.\n\n279\n00:14:25.210 --> 00:14:26.560\nAnd it pauses between each.\n\n280\n00:14:26.560 --> 00:14:31.213\nIt could sit there for 10, 15 seconds\nbefore you finally get a message saying,\n\n281\n00:14:31.213 --> 00:14:33.219\nunable to contact server, right?\n\n282\n00:14:33.219 --> 00:14:36.440\nSo, by choosing reject we get\nthat more rapid message back.\n\n283\n00:14:36.440 --> 00:14:39.220\nNow Ronnie mentioned I can create\na little bit of resource utilization on\n\n284\n00:14:39.220 --> 00:14:41.190\nthe firewall, and he's absolutely right.\n\n285\n00:14:41.190 --> 00:14:42.980\nYour firewalls have to respond to this.\n\n286\n00:14:42.980 --> 00:14:46.830\nSo, we don't normally use that\nreject option with WAN filtering,\n\n287\n00:14:46.830 --> 00:14:47.995\nwith internet filtering.\n\n288\n00:14:47.995 --> 00:14:50.490\nCuz we don't want to communicate out to\nall these hackers that are out there.\n\n289\n00:14:50.490 --> 00:14:52.010\nYeah, you're being blocked.\n\n290\n00:14:52.010 --> 00:14:56.100\nBut for internal stuff, like what Ronnie's\ndoing, that reject option is really handy.\n\n291\n00:14:56.100 --> 00:14:58.723\nAnd you can always spot\nwhether it's reject or block,\n\n292\n00:14:58.723 --> 00:15:00.730\nright there on the firewall rule screen.\n\n293\n00:15:00.730 --> 00:15:02.490\nSo if we go back to Ronnie's list,\n\n294\n00:15:02.490 --> 00:15:05.410\nyou'll notice that normally when you\ndo a block rule, on the left side,\n\n295\n00:15:05.410 --> 00:15:10.340\nyou have a red square with the little\nx in it, but his is yellow.\n\n296\n00:15:10.340 --> 00:15:13.026\nAnd that's that note letting you know that\nyou're actually doing a reject on it.\n\n297\n00:15:13.026 --> 00:15:16.142\nIt is blocking the traffic, but\nit's sending that rejection notice back,\n\n298\n00:15:16.142 --> 00:15:17.320\nreally handy thing to have.\n\n299\n00:15:17.320 --> 00:15:19.455\n>> And if you're ever confused\nabout the coloring scheme,\n\n300\n00:15:19.455 --> 00:15:22.134\nnotice that there's a legend down\nhere underneath all of those rules.\n\n301\n00:15:22.134 --> 00:15:25.348\nThat will help you out if you're wondering\nwhy that turned, instead of turned red,\n\n302\n00:15:25.348 --> 00:15:27.940\nturned yellow, it tells you it's\nbecause it was that reject rule.\n\n303\n00:15:27.940 --> 00:15:29.632\nThat really does help you out.\n\n304\n00:15:29.632 --> 00:15:33.180\nSo, really, very user friendly\n\n305\n00:15:33.180 --> 00:15:37.200\nto help you identify what has\nactually gone on here on this rule.\n\n306\n00:15:37.200 --> 00:15:40.580\nNow, a lot of times though,\nyou may now actually start going,\n\n307\n00:15:40.580 --> 00:15:42.770\nturning in your mind,\ncuz this is what happens to me.\n\n308\n00:15:42.770 --> 00:15:45.580\nWell, if I can block things like Slashdot,\n\n309\n00:15:45.580 --> 00:15:48.060\nI might also be able to block\nbigger things that are out there,\n\n310\n00:15:48.060 --> 00:15:52.480\nin other words, sites that actually\nhave more than one IP address.\n\n311\n00:15:52.480 --> 00:15:53.810\nThat can be a little bit more challenging,\n\n312\n00:15:53.810 --> 00:15:56.600\nbecause that means that something like,\nfor example, like Facebook,\n\n313\n00:15:56.600 --> 00:16:01.530\nif you're trying to do that,\nthey may have thousands of IP addresses.\n\n314\n00:16:01.530 --> 00:16:05.581\nAnd if were trying to do that, Don,\nif I were to do it rule-by-rule,\n\n315\n00:16:05.581 --> 00:16:09.173\nI'd have to do every individual subnet and\n> Every address?\n\n316\n00:16:09.173 --> 00:16:12.618\n>> Yeah and you know you take a network\nlike Facebook where they've got hundreds\n\n317\n00:16:12.618 --> 00:16:16.770\nmaybe thousands of IPs that are available,\nthey definitely have multiple subnets.\n\n318\n00:16:16.770 --> 00:16:20.130\nAnd so if you're trying to allow access or\nblock access or something like that,\n\n319\n00:16:20.130 --> 00:16:23.240\nfirst off you gotta go to that vendor and\nyou got to get their list of ip's.\n\n320\n00:16:23.240 --> 00:16:26.590\nMost of them do publish it, it's a,\nI haven't looked up Facebook's but\n\n321\n00:16:26.590 --> 00:16:28.770\nthey usually do publish\nwhat their IP ranges are.\n\n322\n00:16:28.770 --> 00:16:30.520\nBecause they wanna make\nit your company decision.\n\n323\n00:16:30.520 --> 00:16:32.860\nYou can decide whether you\nwanna allow that access or not.\n\n324\n00:16:32.860 --> 00:16:35.920\nAnd then all you have to do is go and\ncreate the rules to deal with that.\n\n325\n00:16:35.920 --> 00:16:39.570\nBut if they've got multiple ranges,\nyou don't wanna create multiple rules.\n\n326\n00:16:39.570 --> 00:16:41.600\nInstead, we wanna create an alias.\n\n327\n00:16:41.600 --> 00:16:44.460\nSo you can create an alias\ncalled Facebook servers, and\n\n328\n00:16:44.460 --> 00:16:47.350\nin there you can put all\nthe individual IPs and subnets.\n\n329\n00:16:47.350 --> 00:16:48.260\nYou can list them all out.\n\n330\n00:16:48.260 --> 00:16:50.040\nAnd Ronnie,\ndo you have an example of that?\n\n331\n00:16:50.040 --> 00:16:50.920\n>> I do.\nAnd so\n\n332\n00:16:50.920 --> 00:16:53.570\nthis is something I wanted\nto show you a little bit of.\n\n333\n00:16:53.570 --> 00:16:55.020\nBecause just what I said,\n\n334\n00:16:55.020 --> 00:16:59.680\nthere is a command that you can run,\nwhich is a whois command here.\n\n335\n00:16:59.680 --> 00:17:00.810\nAnd you can run that and\n\n336\n00:17:00.810 --> 00:17:05.100\nit will end up returning to you\nall of the Facebook subnets.\n\n337\n00:17:05.100 --> 00:17:07.160\nAnd, I mean, there are a lot, Don.\n\n338\n00:17:07.160 --> 00:17:12.890\nThere are so many that's out there,\nit is amazing for us to actually\n\n339\n00:17:12.890 --> 00:17:16.840\nbe able to go through and see all of these\ndifferent things that are out there.\n\n340\n00:17:16.840 --> 00:17:18.470\nSo I went in and copied that, so\n\n341\n00:17:18.470 --> 00:17:20.590\nI just opened up my terminal and\nI ran that command.\n\n342\n00:17:20.590 --> 00:17:23.190\nIf you're wondering like,\nwhere do you get that command?\n\n343\n00:17:23.190 --> 00:17:26.040\nI simply found it on pfSense itself.\n\n344\n00:17:26.040 --> 00:17:28.090\nI said, hey, I wanna block Facebook.\n\n345\n00:17:28.090 --> 00:17:29.400\nAnd so I ran that command and\n\n346\n00:17:29.400 --> 00:17:32.830\nI was able to get the latest\nservers that they had out there.\n\n347\n00:17:32.830 --> 00:17:34.970\nAnd so from here, if I wanted to try and\n\n348\n00:17:34.970 --> 00:17:39.480\ndo that, we're just gonna show you\nthe creation of the alias of these things.\n\n349\n00:17:39.480 --> 00:17:46.770\nIf I go to firewall and\naliases from here, under the firewall,\n\n350\n00:17:46.770 --> 00:17:49.910\nnotice I have all of these different\noptions for creating aliases.\n\n351\n00:17:49.910 --> 00:17:53.870\nIP addresses, ports, URLs, you name it.\n\n352\n00:17:53.870 --> 00:17:56.580\nI'm gonna click on this plus\nsign to add a new rule.\n\n353\n00:17:58.440 --> 00:18:00.860\nAnd from here I can go ahead and do that.\n\n354\n00:18:00.860 --> 00:18:06.550\nI'm gonna call that one let's\nsay Facebook subnets and\n\n355\n00:18:06.550 --> 00:18:09.038\nthen the descriptions\nare of course all Facebook.\n\n356\n00:18:09.038 --> 00:18:15.420\n[LAUGH] Subnets.\n\n357\n00:18:15.420 --> 00:18:19.140\nNow, this is something that I know\nfrom personal experience that\n\n358\n00:18:19.140 --> 00:18:21.210\nyou've gotta be careful here.\n\n359\n00:18:21.210 --> 00:18:24.000\nNotice the type, it says Host.\n\n360\n00:18:24.000 --> 00:18:27.070\nIt's expecting an individual IP address.\n\n361\n00:18:27.070 --> 00:18:29.750\nWell if you're like me the first\ntime you did this and you entered in\n\n362\n00:18:29.750 --> 00:18:33.530\nsubnets in its place, all of a sudden\nit gave you a nice warning that said,\n\n363\n00:18:33.530 --> 00:18:38.180\nyou know you entered 5,000 IP\naddresses and I was kind of shocked.\n\n364\n00:18:38.180 --> 00:18:42.050\nSo you want to be careful especially\nif you're given a list of subnets.\n\n365\n00:18:42.050 --> 00:18:44.940\nSo at that point I want to\ngo down to networks and\n\n366\n00:18:44.940 --> 00:18:48.740\nthen I can start\nindividually applying these.\n\n367\n00:18:48.740 --> 00:18:50.700\nGoing back and copying and pasting them.\n\n368\n00:18:50.700 --> 00:18:53.860\nBut Don, that is incredibly inefficient.\n\n369\n00:18:53.860 --> 00:18:56.610\nIt really is bad if I needed to do that.\n\n370\n00:18:56.610 --> 00:19:00.490\nBut the nice thing is pfsense has\nactually thought about this as well.\n\n371\n00:19:00.490 --> 00:19:05.290\nSo if you've gone ahead and copied that,\nI'm going to go ahead and cancel this out.\n\n372\n00:19:05.290 --> 00:19:10.140\nAnd over here on the righthand side you\nactually see these three buttons here.\n\n373\n00:19:10.140 --> 00:19:13.130\nNotice that there's one button\nthat actually has a little\n\n374\n00:19:13.130 --> 00:19:18.640\ntiny up arrow that says bulk\nimport aliases from a list.\n\n375\n00:19:18.640 --> 00:19:20.020\nDon, this is the way to go.\n\n376\n00:19:20.020 --> 00:19:24.820\nSo if I go ahead and select that, right\nthen, then I can try the same thing again.\n\n377\n00:19:24.820 --> 00:19:27.520\nI'll call it Facebook Subnets.\n\n378\n00:19:29.100 --> 00:19:30.830\nAnd, well, Facebook Subnets.\n\n379\n00:19:35.330 --> 00:19:37.380\nAnd then I'm going to go to\nthe list that I copied in.\n\n380\n00:19:38.670 --> 00:19:45.022\nAnd select that list of IP addresses.\n\n381\n00:19:50.049 --> 00:19:51.197\nAnd from there, now,\n\n382\n00:19:51.197 --> 00:19:54.884\nthe only thing that you have to worry\nabout here is that you do have to enter\n\n383\n00:19:54.884 --> 00:19:59.010\nwhat they call a carriage return in\nbetween each of those IP addresses.\n\n384\n00:19:59.010 --> 00:20:03.590\nBut once you do that I can then go\nahead and paste it in here, and now,\n\n385\n00:20:03.590 --> 00:20:06.630\nby just having Facebook\nsubnets here I may.\n\n386\n00:20:06.630 --> 00:20:09.300\nLet me do something here\njust in case I did it wrong.\n\n387\n00:20:09.300 --> 00:20:09.998\nI forgot.\n\n388\n00:20:09.998 --> 00:20:12.180\n[LAUGH]\n>> No spaces.\n\n389\n00:20:12.180 --> 00:20:13.460\n>> Yeah, no spaces.\n\n390\n00:20:13.460 --> 00:20:16.610\n>> And, actually Ronnie I'm not even sure,\nwill that one allow an underscore?\n\n391\n00:20:16.610 --> 00:20:18.420\n>> Oh,\nthat one may not allow an underscore.\n\n392\n00:20:18.420 --> 00:20:18.920\n>> PFSense.\n\n393\n00:20:18.920 --> 00:20:19.965\n>> You are correct.\n\n394\n00:20:19.965 --> 00:20:23.255\nIs a little inconsistent sometimes about\nwhen they'll allow an underscore and\n\n395\n00:20:23.255 --> 00:20:24.165\nwhen they won't.\n\n396\n00:20:24.165 --> 00:20:27.845\nIn a normal alias name you can, but\non this inport form it actually won't\n\n397\n00:20:27.845 --> 00:20:30.935\nallow it, so\njust a little one to keep an eye out for.\n\n398\n00:20:30.935 --> 00:20:35.037\n>> Always look at these instructions, cuz\nI've been burned by that more than once,\n\n399\n00:20:35.037 --> 00:20:38.077\nI know just from experience.\n\n400\n00:20:38.077 --> 00:20:41.627\nSo then you can also of course\ntake a little bit of time.\n\n401\n00:20:41.627 --> 00:20:42.227\nI'm not going to.\n\n402\n00:20:42.227 --> 00:20:44.857\nYou can take a little bit of time to\nactually add a description on the end of\n\n403\n00:20:44.857 --> 00:20:46.077\neach of these.\n\n404\n00:20:46.077 --> 00:20:47.031\nI can click Save.\n\n405\n00:20:49.215 --> 00:20:52.317\nAnd now I'm gonna apply those changes,\nand there it is.\n\n406\n00:20:52.317 --> 00:20:54.880\nThere are the subnets that we've created.\n\n407\n00:20:54.880 --> 00:20:59.480\nAnd then if we now go back and create\na rule, any place that we actually go back\n\n408\n00:20:59.480 --> 00:21:04.550\ninto to create a rule,\nwe can go ahead and take a look at that.\n\n409\n00:21:05.710 --> 00:21:09.860\nAnd you'll see that those places that show\nup with a red background means that those,\n\n410\n00:21:09.860 --> 00:21:13.340\noh, excuse me,\napparently I didn't click on that.\n\n411\n00:21:13.340 --> 00:21:14.840\nJust right-clicked on it.\n\n412\n00:21:14.840 --> 00:21:16.262\nOnce you actually get that rule and\n\n413\n00:21:16.262 --> 00:21:19.190\nyou actually start seeing those\nrules inside of your LAN.\n\n414\n00:21:19.190 --> 00:21:22.060\nAny place that shows up with a red\nbackground means that an alias is\n\n415\n00:21:22.060 --> 00:21:23.150\nready to go in there.\n\n416\n00:21:23.150 --> 00:21:25.850\nAnd, it should work exactly like\nthe way that Slashdot actually\n\n417\n00:21:25.850 --> 00:21:27.670\nended up working too.\n\n418\n00:21:27.670 --> 00:21:29.820\n>> Yeah.\nThat's a great way to get in there and\n\n419\n00:21:29.820 --> 00:21:30.380\ntackle that.\n\n420\n00:21:30.380 --> 00:21:32.820\nI know, in the other direction,\nwe can use that for\n\n421\n00:21:32.820 --> 00:21:36.420\nfiltering things like access to tor\nexit nodes and other kind of things.\n\n422\n00:21:36.420 --> 00:21:39.580\nIt is nice to be able to grab those bulk\nIP's, but they do have to be maintained.\n\n423\n00:21:39.580 --> 00:21:40.080\nRight?\n\n424\n00:21:40.080 --> 00:21:42.550\nServices like Facebook are adding\nnew servers all the time, and\n\n425\n00:21:42.550 --> 00:21:44.190\nyou might have to add or remove those.\n\n426\n00:21:44.190 --> 00:21:47.830\nBut when you're whitelisting access to\nsystems, there's typically more than one\n\n427\n00:21:47.830 --> 00:21:50.760\nIP address involved in those systems and\nyou'll have to punch those in.\n\n428\n00:21:50.760 --> 00:21:52.270\nNow Ronnie's doing them here,\n\n429\n00:21:52.270 --> 00:21:54.840\nlike his example with Slashdot\nwas specifically web traffic,\n\n430\n00:21:54.840 --> 00:21:58.930\nand the challenge there is that people\ncan find other ways to get around that.\n\n431\n00:21:58.930 --> 00:22:02.180\nTraffic like SSL traffic is\nnotoriously difficult to filter.\n\n432\n00:22:02.180 --> 00:22:06.110\nSo you might want to filter just\nany protocol going to those IPs.\n\n433\n00:22:06.110 --> 00:22:09.310\nBut in this day and age with shared\nIPs new v hosts and all that it is\n\n434\n00:22:09.310 --> 00:22:12.240\na pretty challenging thing, but we wanted\nto demonstrate to you guys that it is\n\n435\n00:22:12.240 --> 00:22:16.910\npossible, you can use PFSense to filter\nthe traffic on an outgoing basis.\n\n436\n00:22:16.910 --> 00:22:20.100\nRight, our traffic is leaving the land,\ngoing out to the internet.\n\n437\n00:22:20.100 --> 00:22:22.000\nAnd we have control.\n\n438\n00:22:22.000 --> 00:22:24.820\nThe only other thing worth\nmentioning is when we do testing for\n\n439\n00:22:24.820 --> 00:22:28.140\nthis stuff, Ronnie showed that we can\nenable and disable a rule to test it out,\n\n440\n00:22:28.140 --> 00:22:31.426\nand you can also turn on logging, which\nis kind of a useful thing you might've\n\n441\n00:22:31.426 --> 00:22:33.370\nnoticed that option was at\nthe very end of the rules.\n\n442\n00:22:33.370 --> 00:22:35.550\nThat's one that you can turn\non just where you're testing,\n\n443\n00:22:35.550 --> 00:22:36.990\nsee if you're actually hitting it.\n\n444\n00:22:36.990 --> 00:22:38.700\nIf somebody's still getting to.\n\n445\n00:22:38.700 --> 00:22:42.990\nSay you're trying to block Facebook and\npeople are still able to get to it,\n\n446\n00:22:42.990 --> 00:22:46.130\nyou can turn on logging for\na permit rule at the very end, and\n\n447\n00:22:46.130 --> 00:22:49.120\ncapture that to see exactly\nwhat their traffic looks like.\n\n448\n00:22:49.120 --> 00:22:50.980\nAnd you might find that they're\naccessing a different IP,\n\n449\n00:22:50.980 --> 00:22:53.400\nor they're using a different port number,\n\n450\n00:22:53.400 --> 00:22:57.920\nor something like that that's making\nyour block rules not work, or not match.\n\n451\n00:22:57.920 --> 00:23:01.310\nSo it's a good way to kind of check that\nout and figure out what people are doing.\n\n452\n00:23:01.310 --> 00:23:01.990\nSo.\n\n453\n00:23:01.990 --> 00:23:05.120\nYou know, it's all right there,\nit's pretty straightforward.\n\n454\n00:23:05.120 --> 00:23:07.400\nRonnie, can you think of\nanything else to throw in?\n\n455\n00:23:07.400 --> 00:23:09.960\n>> Not really,\nthat logging is really important, and\n\n456\n00:23:09.960 --> 00:23:13.180\nit was a part that I really did\nforget right at the beginning.\n\n457\n00:23:13.180 --> 00:23:16.920\nBut you do have the ability to go in\nthere and see that there is one place and\n\n458\n00:23:16.920 --> 00:23:17.840\nlocation.\n\n459\n00:23:17.840 --> 00:23:21.660\nSo we go back to my computer just for\na moment, let me show you that.\n\n460\n00:23:21.660 --> 00:23:26.150\nIt's under status and\nthen down here under system logs.\n\n461\n00:23:26.150 --> 00:23:29.710\nAnd when we take a look, especially\nwhen we implement the firewall rules.\n\n462\n00:23:29.710 --> 00:23:32.210\nThis is where I get a little bit\nconfused cuz I look at this like,\n\n463\n00:23:32.210 --> 00:23:34.390\nthat has nothing to do\nwith firewall rules.\n\n464\n00:23:34.390 --> 00:23:38.000\nBut you have to find that particular tab,\nand it's right here.\n\n465\n00:23:38.000 --> 00:23:42.680\nThat you can go in and actually see what's\nbeen blocked and what hasn't been blocked.\n\n466\n00:23:42.680 --> 00:23:44.740\nSo it gives you a nice little location for\n\n467\n00:23:44.740 --> 00:23:47.510\nyou to also be able to\nspot the traffic here too.\n\n468\n00:23:47.510 --> 00:23:51.140\nSo always be able to know whether or\nnot those rules are taking effect.\n\n469\n00:23:51.140 --> 00:23:52.200\n>> Yeah, absolutely.\n\n470\n00:23:52.200 --> 00:23:54.938\nAnd that's one thing, that you might\nwant to turn the logging on and\n\n471\n00:23:54.938 --> 00:23:57.245\nthen when you're done testing\nyou turn the logging off so\n\n472\n00:23:57.245 --> 00:24:00.510\nthat you don't fill up those logs,\nthat's something that I like to do.\n\n473\n00:24:00.510 --> 00:24:01.200\nJust be aware of that,\n\n474\n00:24:01.200 --> 00:24:02.770\nit's another troubleshooting\ntool that's enabled for you.\n\n475\n00:24:03.790 --> 00:24:06.850\nAll right, well, in this segment we got\na chance to see filtering traffic as it\n\n476\n00:24:06.850 --> 00:24:07.680\nexits our network.\n\n477\n00:24:07.680 --> 00:24:09.470\nYou know, LAN traffic going out.\n\n478\n00:24:09.470 --> 00:24:12.110\nAnd In an earlier segment\nwe covered WAN traffic.\n\n479\n00:24:12.110 --> 00:24:15.200\nThis is a pretty good overview of\nthe firewall rules and how they function.\n\n480\n00:24:15.200 --> 00:24:18.300\nWe do still have some more firewall\nrule topics that are coming up, and\n\n481\n00:24:18.300 --> 00:24:21.550\nwe got a ton more pfSense\ntopics coming down the line.\n\n482\n00:24:21.550 --> 00:24:24.980\nSo stay tuned for that, but\nas far as this one's going, we're done.\n\n483\n00:24:24.980 --> 00:24:28.635\nSo stay tuned, we'll be back with more.\n\n484\n00:24:28.635 --> 00:24:32.930\n[SOUND]\n\n",
          "vimeoId": "130429594"
        },
        {
          "description": null,
          "length": "540",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-3-scheduling_filter_rules-060915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-3-scheduling_filter_rules-060915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-2-3-scheduling_filter_rules-060915-1-sm.jpg",
          "title": "Scheduling Filter Rules",
          "transcript": "WEBVTT\n\n1\n00:00:00.173 --> 00:00:07.727\n[MUSIC]\n\n2\n00:00:07.727 --> 00:00:12.280\nIn this segment, we're gonna take a look\nat scheduling our firewall filter rules.\n\n3\n00:00:12.280 --> 00:00:15.700\nNow, by default, when you write\na firewall filter rule inside of pfsense,\n\n4\n00:00:15.700 --> 00:00:19.440\nit applies as soon as you hit that\napply button, and it's permanent.\n\n5\n00:00:19.440 --> 00:00:23.780\nSo in a previous segment, Ronnie chose\nto block access to the Slashdot website.\n\n6\n00:00:23.780 --> 00:00:27.545\nAnd when he did that, that rule's in\nthere, and it's blocking it 24/7,\n\n7\n00:00:27.545 --> 00:00:30.297\nall day long, people are not\nable to get to that website.\n\n8\n00:00:30.297 --> 00:00:32.430\nAnd honestly,\nthat's what we normally want, right?\n\n9\n00:00:32.430 --> 00:00:34.960\nWe normally want a rule\nto always take effect.\n\n10\n00:00:34.960 --> 00:00:38.600\nBut sometimes, it'd be nice if\nwe could create exceptions.\n\n11\n00:00:38.600 --> 00:00:40.130\nUsing the website as an example,\n\n12\n00:00:40.130 --> 00:00:43.446\nmaybe we want our employees to be able to\nget to the website, on their lunch break.\n\n13\n00:00:43.446 --> 00:00:45.880\nWe don't want them doing\nit during work hours, but\n\n14\n00:00:45.880 --> 00:00:48.650\njust during their lunch break,\nwe want them to be able to get there.\n\n15\n00:00:48.650 --> 00:00:53.036\nOr, maybe I want users to be able to VPN\ninto my network from 8- 5 during business\n\n16\n00:00:53.036 --> 00:00:57.635\nhours, but outside of business hours, I\ndon't want people VPNing into my network.\n\n17\n00:00:57.635 --> 00:01:02.817\nYou can create schedules in pfSense, and\nattach the schedules to those rules,\n\n18\n00:01:02.817 --> 00:01:07.861\nthe filter rules, and now they'll apply\nwithin the times that you specify.\n\n19\n00:01:07.861 --> 00:01:09.778\nSo really neat way to\nkind of change that and\n\n20\n00:01:09.778 --> 00:01:13.025\nhave it be automatic where you're not\nhaving to worry about it each day,\n\n21\n00:01:13.025 --> 00:01:15.920\nenabling and disabling these\nrules during a certain time slot.\n\n22\n00:01:15.920 --> 00:01:18.040\nSo Ronnie, why don't we walk\nthem through how we do that?\n\n23\n00:01:18.040 --> 00:01:20.370\n>> Let's go ahead and\ntake a look at what we need to do.\n\n24\n00:01:20.370 --> 00:01:22.340\nAnd it can be a little\nbit confusing logic,\n\n25\n00:01:22.340 --> 00:01:24.980\nso let's see if we can\nfollow it step by step.\n\n26\n00:01:24.980 --> 00:01:27.640\nWe're at currently on my\nfirewall rule right now.\n\n27\n00:01:27.640 --> 00:01:31.180\nI'm blocking access to\nSlashdot 24 hours a day.\n\n28\n00:01:31.180 --> 00:01:34.180\nI need to create an exception which\nis gonna be using the schedule.\n\n29\n00:01:34.180 --> 00:01:38.090\nAnd what that's gonna do, is it's gonna\nallow me to define my lunch time, and\n\n30\n00:01:38.090 --> 00:01:40.540\nthen I need to actually\nattach it to a permit rule.\n\n31\n00:01:40.540 --> 00:01:42.210\nIf I attach it to a block rule,\n\n32\n00:01:42.210 --> 00:01:45.280\nit's only gonna block it during\nthat period of time instead.\n\n33\n00:01:45.280 --> 00:01:47.000\nSo, let's go ahead and do that.\n\n34\n00:01:47.000 --> 00:01:50.140\nInside of the pfSense\nfirewall web configurator,\n\n35\n00:01:50.140 --> 00:01:54.350\nI'm going to go up to Firewall on\nthe top bar, and select Schedule.\n\n36\n00:01:56.330 --> 00:01:59.963\nAnd inside of schedule,\nI do not have any rules currently created.\n\n37\n00:01:59.963 --> 00:02:03.444\nSo, over the right hand side,\nI'm gonna add a new rule, and\n\n38\n00:02:03.444 --> 00:02:05.710\nfrom here, we'll call it LunchTime.\n\n39\n00:02:07.670 --> 00:02:13.498\nIs what we'll call it, and then we'll say,\nLunchTime access to Slashdot.\n\n40\n00:02:16.215 --> 00:02:21.450\nNow, I have an option about when this\nis actually gonna be scheduled here.\n\n41\n00:02:21.450 --> 00:02:24.640\nNotice I can pick an individual\nday if I wanted to.\n\n42\n00:02:24.640 --> 00:02:28.759\nBut if I want to do it every single day\nof the week instead for the work days,\n\n43\n00:02:28.759 --> 00:02:32.014\nI can just click on the links\nabove where it says, Monday,\n\n44\n00:02:32.014 --> 00:02:36.223\nTuesday, Wednesday, Thursday and\nFriday, and we can go month by month.\n\n45\n00:02:36.223 --> 00:02:38.572\nBut we'll actually just use this\nas a demonstration, notice,\n\n46\n00:02:38.572 --> 00:02:40.105\nyou actually do have the ability, oops.\n\n47\n00:02:40.105 --> 00:02:40.999\nI keep right clicking.\n\n48\n00:02:40.999 --> 00:02:42.320\n>> [LAUGH]\n>> No matter what.\n\n49\n00:02:42.320 --> 00:02:45.450\nNow, you have the ability to go on and\nchoose every month that you want to, but\n\n50\n00:02:45.450 --> 00:02:48.335\nthis will actually do it for\nall of my work days here.\n\n51\n00:02:48.335 --> 00:02:51.610\nI'm actually just defining what\nthat lunch period is going to be,\n\n52\n00:02:51.610 --> 00:02:56.390\nMonday through Friday, and from this\npoint, it does work on a 24 hour clock, so\n\n53\n00:02:56.390 --> 00:02:57.940\nyou do have to remember that.\n\n54\n00:02:57.940 --> 00:03:01.767\nAnd for us, our lunch time,\nlet's say it's going to be,\n\n55\n00:03:01.767 --> 00:03:05.766\n12 o'clock in the afternoon there,\nright at lunchtime.\n\n56\n00:03:05.766 --> 00:03:09.881\nAnd then, we're gonna actually go\nahead and stop this at, let's say,\n\n57\n00:03:09.881 --> 00:03:13.800\n1 PM, which for us is going to be 13:00,\nright on the dot here.\n\n58\n00:03:13.800 --> 00:03:15.510\nSo we have a one hour lunch time.\n\n59\n00:03:15.510 --> 00:03:18.820\nWherein we're not really doing anything\nunblocking or permitting right now.\n\n60\n00:03:18.820 --> 00:03:21.220\nWe're just trying to define\nthis period in our schedule.\n\n61\n00:03:22.900 --> 00:03:28.329\nSo once we have that, and\nthe time range, again lunch time,\n\n62\n00:03:28.329 --> 00:03:35.157\nand I'm gonna add that time, and\nthen underneath, I should see a summary.\n\n63\n00:03:35.157 --> 00:03:40.089\nAnd there is that schedule, and\nit is now repeated Monday through Friday,\n\n64\n00:03:40.089 --> 00:03:42.057\n12 PM to 1 PM, lunch time.\n\n65\n00:03:42.057 --> 00:03:43.800\nAnd that's perfectly fine.\n\n66\n00:03:43.800 --> 00:03:45.686\nThat is what I want to do.\n\n67\n00:03:45.686 --> 00:03:48.240\nNow I need to go back into\nmy LAN firewall rules.\n\n68\n00:03:48.240 --> 00:03:51.020\nSo if I go back to Firewall, and Rules,\n\n69\n00:03:52.800 --> 00:03:56.760\nI select the proper interface tab,\nwhich is going to be my LAN tab here.\n\n70\n00:03:58.330 --> 00:04:02.975\nNow, I'm not gonna modify the original\nrule, but I'm now gonna create\n\n71\n00:04:02.975 --> 00:04:08.094\na permit rule, that pretty much says\neverything that this one says right here.\n\n72\n00:04:08.094 --> 00:04:12.748\nExcept it's actually gonna have a permit\nat the front instead, or a pass, and\n\n73\n00:04:12.748 --> 00:04:15.299\nthen I'm gonna add that schedule into it.\n\n74\n00:04:15.299 --> 00:04:17.259\nSo, I can do this in a couple of ways.\n\n75\n00:04:17.259 --> 00:04:20.944\nI can go and add in a new rule at the\nbottom and actually type everything in,\n\n76\n00:04:20.944 --> 00:04:25.226\nbut, the only thing I'm really changing to\nthis rule, is really changing the option\n\n77\n00:04:25.226 --> 00:04:29.650\nof whether or not I'm passing or rejecting\nor blocking, and that's all I'm gonna do.\n\n78\n00:04:29.650 --> 00:04:34.590\nSo I'm simply gonna clone this rule,\nhere, by clicking on\n\n79\n00:04:34.590 --> 00:04:39.090\nthe plus sign on the right hand side,\nand changing this option to pass.\n\n80\n00:04:41.070 --> 00:04:45.990\nOnce I change that option to pass, all of\nthe other things that I'm actually set\n\n81\n00:04:45.990 --> 00:04:48.640\non here should be the same,\nwhich is perfectly fine.\n\n82\n00:04:48.640 --> 00:04:50.980\nSo we didn't change anything\nthat we have in there.\n\n83\n00:04:50.980 --> 00:04:52.080\nWe're still using port ad.\n\n84\n00:04:52.080 --> 00:04:55.720\nIt's still the same destination address.\n\n85\n00:04:55.720 --> 00:04:58.640\nAnd then,\nwe're gonna scroll down to the bottom.\n\n86\n00:04:58.640 --> 00:05:01.920\nAnd we are now looking for\nthe schedule option.\n\n87\n00:05:01.920 --> 00:05:06.830\nI click on Advanced, and then I click\non the drop down under Schedule.\n\n88\n00:05:06.830 --> 00:05:08.122\nOh, did I not save that?\n\n89\n00:05:08.122 --> 00:05:11.270\nAll right,\nas we scroll down on the screen,\n\n90\n00:05:11.270 --> 00:05:15.070\nwe should see where it says Schedule,\nand I clicked on the advanced button.\n\n91\n00:05:16.220 --> 00:05:20.247\nAnd then I'm gonna click on the drop-down,\nand I should see where it says Lunchtime,\n\n92\n00:05:20.247 --> 00:05:23.908\nand if now select Lunchtime, I wanna\nverify that it's actually there [LAUGH].\n\n93\n00:05:23.908 --> 00:05:27.178\n[LAUGH] I'm gonna scroll\ndown to the bottom, and\n\n94\n00:05:27.178 --> 00:05:29.560\nmake sure I click the Save button.\n\n95\n00:05:31.710 --> 00:05:33.850\n>> Now, at this point,\nthat attaches the schedule to the rule,\n\n96\n00:05:33.850 --> 00:05:37.660\nand we're actually gonna see our user\ninterface change just a little bit.\n\n97\n00:05:37.660 --> 00:05:40.610\nNotice how Ronnie's got\nthat rule that's listed.\n\n98\n00:05:40.610 --> 00:05:43.180\nWe can kind of look at his entries there,\nand\n\n99\n00:05:43.180 --> 00:05:47.910\nhow you can see the Lunchtime rule\nis attached and how its got that red\n\n100\n00:05:47.910 --> 00:05:51.760\nbox with an x on it letting us know\nthat that schedule is applying.\n\n101\n00:05:51.760 --> 00:05:55.836\nThat we are currently in Monday\nthrough Friday between noon and\n\n102\n00:05:55.836 --> 00:05:58.860\n1PM, or that we're not, within that time.\n\n103\n00:05:58.860 --> 00:06:01.720\nIt gives us an idea whether or\nnot that rule is enabled.\n\n104\n00:06:03.190 --> 00:06:06.626\n>> Now the only other option that I\nhave to ask you to remember, right.\n\n105\n00:06:06.626 --> 00:06:10.040\nIf everybody actually goes this,\nregardless of whether it's lunch time,\n\n106\n00:06:10.040 --> 00:06:12.960\nbecause of the way that the rules\napply from the top to the bottom,\n\n107\n00:06:12.960 --> 00:06:15.070\nit's gonna hit this rule first.\n\n108\n00:06:15.070 --> 00:06:17.560\nAnd that's gonna block it anyway.\n\n109\n00:06:17.560 --> 00:06:21.390\nSo instead what I need to do,\nis I need to take this rule, and\n\n110\n00:06:21.390 --> 00:06:24.070\nmove it above the previous rule.\n\n111\n00:06:24.070 --> 00:06:29.670\nSo I'm gonna put a mark here, and\n\n112\n00:06:29.670 --> 00:06:34.600\nthen, need to find the arrow, that will\nactually move that selected rule above.\n\n113\n00:06:37.540 --> 00:06:42.991\nSo now what should end up happening after\nI hit apply, is that during those hours,\n\n114\n00:06:42.991 --> 00:06:47.817\nit's actually permitted as long as\nit's during that lunch time break.\n\n115\n00:06:47.817 --> 00:06:50.361\nAny other time of day,\nit should actually not apply.\n\n116\n00:06:50.361 --> 00:06:55.312\n>> Yeah, if it's in between noon and one,\nthat rule applies, and it'll be permitted.\n\n117\n00:06:55.312 --> 00:06:57.881\nIf it's not in between noon and\none, that rule doesn't apply and\n\n118\n00:06:57.881 --> 00:06:59.060\nthey just move down the list.\n\n119\n00:06:59.060 --> 00:07:01.470\nThey hit that next rule, which is a block.\n\n120\n00:07:01.470 --> 00:07:04.450\nAnd that's going to block that access,\nand now they can't get in.\n\n121\n00:07:04.450 --> 00:07:08.059\nIf you need to do like segmented\nschedules, a few hours in the morning,\n\n122\n00:07:08.059 --> 00:07:09.576\na few hours in the afternoon.\n\n123\n00:07:09.576 --> 00:07:12.289\nUnfortunately, there's not a great way\nto break up a schedule like that, so\n\n124\n00:07:12.289 --> 00:07:13.765\nyou end up having to\ndo more than one rule.\n\n125\n00:07:13.765 --> 00:07:15.865\nOne for each segment of that schedule, and\n\n126\n00:07:15.865 --> 00:07:18.595\nyou'll have to do more than one calendar,\nI mean schedule.\n\n127\n00:07:18.595 --> 00:07:21.945\nOne for each of those segments, so,\nit does get a little more complex, but\n\n128\n00:07:21.945 --> 00:07:24.395\nthis is a neat way to\ncreate rules like this.\n\n129\n00:07:24.395 --> 00:07:27.365\nIt's good for parents who want\nto limit Internet access for\n\n130\n00:07:27.365 --> 00:07:29.430\nmachines for kids during certain times.\n\n131\n00:07:29.430 --> 00:07:32.060\nOr, for\nbusinesses that just want to control that,\n\n132\n00:07:32.060 --> 00:07:35.320\nor open up access to systems\nduring certain times,\n\n133\n00:07:35.320 --> 00:07:39.180\nwhen it's helping with employee\nproductivity, or whatever the reason is.\n\n134\n00:07:39.180 --> 00:07:42.720\nThere's a number of different reasons\nwhy we might use schedules, right?\n\n135\n00:07:42.720 --> 00:07:46.560\nControlling when people can VPN in,\nall sorts of things of that nature, and\n\n136\n00:07:46.560 --> 00:07:48.040\nit's pretty useful stuff.\n\n137\n00:07:48.040 --> 00:07:50.285\nAnd it's not terribly hard to create,\nand put in place.\n\n138\n00:07:50.285 --> 00:07:53.530\nRemember, step one,\nwe create the schedule, then, step two,\n\n139\n00:07:53.530 --> 00:07:54.830\nwe attach it to the rules.\n\n140\n00:07:54.830 --> 00:07:59.475\nNow, we didn't attach it to that\nblock rule, and the reason is,\n\n141\n00:07:59.475 --> 00:08:04.216\nthe schedule itself determines\nwhether the rule is active or not.\n\n142\n00:08:04.216 --> 00:08:06.993\nAnd we wanted to block\nfrom midnight to noon, and\n\n143\n00:08:06.993 --> 00:08:09.314\nwe wanted to block from one to midnight.\n\n144\n00:08:09.314 --> 00:08:12.370\nWell, we could've done two schedules,\nright?\n\n145\n00:08:12.370 --> 00:08:15.470\nFor the two segments,\nit had two block rules, and then,\n\n146\n00:08:15.470 --> 00:08:18.168\nwhen they weren't in schedule, neither\nwould apply and the pass would happen.\n\n147\n00:08:18.168 --> 00:08:20.870\nMaybe, we could've done it that way,\nbut this way was a little more simple.\n\n148\n00:08:20.870 --> 00:08:23.050\nIt cut us down with the amount\nof rules that we had to put in.\n\n149\n00:08:23.050 --> 00:08:26.940\nSo, you may find that you have to\ncreate schedules for when you block.\n\n150\n00:08:26.940 --> 00:08:29.790\nOr you might find you have to\ncreate schedules for when you pass.\n\n151\n00:08:29.790 --> 00:08:33.972\nRemember the block or pass, that's\ndetermined by the rule, not the schedule.\n\n152\n00:08:33.972 --> 00:08:37.610\nThe schedule determines when\nthe rule actually applies.\n\n153\n00:08:37.610 --> 00:08:41.958\nSo, schedules can block or\nallow, they can do either one.\n\n154\n00:08:41.958 --> 00:08:44.210\nAll right, well,\nI think that's about it for schedules.\n\n155\n00:08:44.210 --> 00:08:48.012\nWe could run through countless examples,\nbut I think you guys get the idea here.\n\n156\n00:08:48.012 --> 00:08:48.970\nPretty useful stuff.\n\n157\n00:08:48.970 --> 00:08:51.850\nDefinitely something to take advantage of,\nhope you guys enjoyed it.\n\n158\n00:08:51.850 --> 00:08:55.315\nStay tuned,\nwe've got more pfSense content coming up.\n\n159\n00:08:55.315 --> 00:09:00.979\n[MUSIC]\n\n",
          "vimeoId": "130429596"
        }
      ],
      "title": "Firewall Rules"
    },
    {
      "episodes": [
        {
          "description": null,
          "length": "1326",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-1-dynamic-nat-061015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-1-dynamic-nat-061015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-1-dynamic-nat-061015-1-sm.jpg",
          "title": "Dynamic NAT",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:05.128\n[MUSIC]\n\n2\n00:00:07.923 --> 00:00:08.779\nIn this segment,\n\n3\n00:00:08.779 --> 00:00:12.543\nwe're going to take a look at network\naddress translation inside of pfSense.\n\n4\n00:00:12.543 --> 00:00:17.406\nNow, for most of us when we set up\na network, be it our home, or our office,\n\n5\n00:00:17.406 --> 00:00:21.036\nor wherever,\nwe typically connect to a cable modem, or\n\n6\n00:00:21.036 --> 00:00:23.894\nDSL, or some kind of Internet service, and\n\n7\n00:00:23.894 --> 00:00:28.644\nthat Internet service provider probably\nonly gives you one IP address.\n\n8\n00:00:28.644 --> 00:00:32.240\nAnd as a result, you've gotta get all the\ncomputers in your internal network to be\n\n9\n00:00:32.240 --> 00:00:35.072\nable to share that single address\nas they go out to the Internet.\n\n10\n00:00:35.072 --> 00:00:37.307\nNow, that one address that they give you,\nit's special.\n\n11\n00:00:37.307 --> 00:00:43.036\nIt's a unique IP address across the entire\nplanet, or at least that's the idea.\n\n12\n00:00:43.036 --> 00:00:46.271\nOn your internal network,\nyou've got more than one computer, though.\n\n13\n00:00:46.271 --> 00:00:48.007\nThere's not enough.\n\n14\n00:00:48.007 --> 00:00:49.516\nSo, you've gotta have\nsome way to share it and\n\n15\n00:00:49.516 --> 00:00:51.312\nthat's where network address\ntranslation comes in.\n\n16\n00:00:51.312 --> 00:00:55.595\nWe can use private or\nfake IP's on our internal network, and\n\n17\n00:00:55.595 --> 00:01:00.895\nwhen we go to the outside world, we can\njust hide behind that one public IP.\n\n18\n00:01:00.895 --> 00:01:04.471\nAlmost every router that's out there,\nor every firewall that's out there,\n\n19\n00:01:04.471 --> 00:01:07.143\nperforms NAT functions because\nit really is so critical.\n\n20\n00:01:07.143 --> 00:01:10.215\nJust normal operations on the Internet.\n\n21\n00:01:10.215 --> 00:01:13.429\nNow, the process itself\nis actually a little bit,\n\n22\n00:01:13.429 --> 00:01:16.418\nI don't want to call it mysterious or\ncomplex or\n\n23\n00:01:16.418 --> 00:01:20.255\nanything like that, but\nit is definitely a little bit to it.\n\n24\n00:01:20.255 --> 00:01:21.668\nAnd let me show you what I mean.\n\n25\n00:01:21.668 --> 00:01:27.978\nLet's say for example that I had a network\nwith a really basic topology like this.\n\n26\n00:01:27.978 --> 00:01:31.887\nOn my internal network,\nI've got 192.168.00.\n\n27\n00:01:31.887 --> 00:01:34.990\nAnd that's,\nthey call them a RFC 1918 address.\n\n28\n00:01:34.990 --> 00:01:39.786\nIt's a reserved IP range that's not\nallowed to be routed on the Internet.\n\n29\n00:01:39.786 --> 00:01:44.110\nAnd then, my firewall gets\na public IP in a certain range.\n\n30\n00:01:44.110 --> 00:01:49.297\nSo, maybe my service provider\ngives me .185 or something.\n\n31\n00:01:49.297 --> 00:01:51.199\nHere, I'll just use my actual firewall.\n\n32\n00:01:51.199 --> 00:01:52.386\nI got 184.\n\n33\n00:01:52.386 --> 00:01:54.782\nSo, it gave me 184.\n\n34\n00:01:54.782 --> 00:01:58.323\nWell, I've got this one IP\naddress attached to my firewall.\n\n35\n00:01:58.323 --> 00:02:01.608\nAnd all of my clients need to\nbe able to hide behind it.\n\n36\n00:02:01.608 --> 00:02:06.550\nSo, when they generate traffic, when they\nstart to communicate, traffic coming\n\n37\n00:02:06.550 --> 00:02:10.521\nfrom the inside of my network,\ngoing to the outside of my network.\n\n38\n00:02:10.521 --> 00:02:13.337\nWell, if I go out to a web\nserver on the Internet, and\n\n39\n00:02:13.337 --> 00:02:18.345\nmy source address shows as 192.168.0 or\nwhatever, they're gonna throw it away.\n\n40\n00:02:18.345 --> 00:02:20.377\nIt's non-routable on the Internet.\n\n41\n00:02:20.377 --> 00:02:25.296\nSo, I've gotta have some way to trick them\ninto thinking I came from my public IP.\n\n42\n00:02:25.296 --> 00:02:27.266\nAnd that's exactly what\nyour firewall can do.\n\n43\n00:02:27.266 --> 00:02:30.678\nIt's as a packet passes\nthrough the firewall,\n\n44\n00:02:30.678 --> 00:02:35.452\nit can open up the packet,\ntake the source address, and erase it,\n\n45\n00:02:35.452 --> 00:02:38.881\nand change the source\naddress to its public IP.\n\n46\n00:02:38.881 --> 00:02:40.607\nAnd then,\nit can send it out to the Internet.\n\n47\n00:02:40.607 --> 00:02:44.796\nAnd somebody on the Internet sees that\ntraffic, sees it from a public IP, and\n\n48\n00:02:44.796 --> 00:02:46.544\nsays great, and replies back.\n\n49\n00:02:46.544 --> 00:02:48.534\nAnd when they reply back,\nit comes through the firewall.\n\n50\n00:02:48.534 --> 00:02:53.052\nThe firewall opens up the packet, erases\nwhat's now the destination address, and\n\n51\n00:02:53.052 --> 00:02:56.754\nchanges it to the private address\non your network and sends it along.\n\n52\n00:02:56.754 --> 00:02:57.900\nThat whole process.\n\n53\n00:02:57.900 --> 00:03:01.885\nYour firewall is doing that for every\nsingle packet that passes through it,\n\n54\n00:03:01.885 --> 00:03:04.763\nif you have got the default\nconfiguration of pfSense.\n\n55\n00:03:04.763 --> 00:03:05.418\nIt's a lot of work.\n\n56\n00:03:05.418 --> 00:03:09.399\nIt's actually one of the more burdensome\nthings that your pfSense firewall does.\n\n57\n00:03:09.399 --> 00:03:13.772\nThat's why your firewall has a limited\namount of sessions that it can support at\n\n58\n00:03:13.772 --> 00:03:17.491\nany one time, because every time\nit modifies that packet, it has to\n\n59\n00:03:17.491 --> 00:03:22.476\nrecalculate a layer or two frame, or check\nsome, and that's a mathematical operation.\n\n60\n00:03:22.476 --> 00:03:24.717\nIt consumes CPU cycles, so\n\n61\n00:03:24.717 --> 00:03:30.086\nthis is one of the heavier lifting\ntasks that a firewall has to do.\n\n62\n00:03:30.086 --> 00:03:30.692\nAll right.\n\n63\n00:03:30.692 --> 00:03:32.407\nWell, I mentioned it's\nconfigured by default.\n\n64\n00:03:32.407 --> 00:03:33.576\nIt really is.\n\n65\n00:03:33.576 --> 00:03:39.519\nIf you take a firewall like mine, where\nI've got an internal IP of 192.168.0.1,\n\n66\n00:03:39.519 --> 00:03:42.618\nand a public IP, that 209.251, right?\n\n67\n00:03:42.618 --> 00:03:44.883\nThere's those addresses.\n\n68\n00:03:44.883 --> 00:03:49.696\nIt's gonna know that it needs to translate\nthose fake addresses to a public.\n\n69\n00:03:49.696 --> 00:03:55.326\nAnd that's all configured up\nhere under firewall and NAT.\n\n70\n00:03:55.326 --> 00:03:59.159\nAnd inside of NAT, you'll see\na couple of different tabs in here.\n\n71\n00:03:59.159 --> 00:04:02.467\nThe outbound NAT is what's\nconfigured by default.\n\n72\n00:04:02.467 --> 00:04:06.650\nIn other words, traffic coming from your\ninternal network going out is going to get\n\n73\n00:04:06.650 --> 00:04:10.797\ntranslated, and I can see it's added\nthe rules automatically for me right here.\n\n74\n00:04:10.797 --> 00:04:15.426\nTraffic coming from 192.168.0.0/24,\ngoing out, so\n\n75\n00:04:15.426 --> 00:04:21.002\nI've got a destination of star, will get\ntranslated to whatever my WAN address is.\n\n76\n00:04:21.002 --> 00:04:24.995\nWhatever wide area network address I\ngot from my ISP, that's what it's gonna\n\n77\n00:04:24.995 --> 00:04:28.883\nbe translated as, and this is\nan auto-created rule, I didn't make this.\n\n78\n00:04:28.883 --> 00:04:31.725\nThe system made it for\nme, and there it is.\n\n79\n00:04:31.725 --> 00:04:32.361\nAll right.\n\n80\n00:04:32.361 --> 00:04:35.533\nNow, how do I know it's actually working?\n\n81\n00:04:35.533 --> 00:04:37.823\nThere's a few ways you\ncan tell it's working.\n\n82\n00:04:37.823 --> 00:04:41.806\nOne way is if you go up here to,\nlet's see,\n\n83\n00:04:41.806 --> 00:04:45.477\nit's under Diagnostics, and pfTop.\n\n84\n00:04:45.477 --> 00:04:49.441\npfTop will show you the top communications\nthat are going on in your system right\n\n85\n00:04:49.441 --> 00:04:53.405\nnow, and so I can start to see some of\nthese communications that are happening,\n\n86\n00:04:53.405 --> 00:04:55.795\nor you can bring this up\non the firewall itself.\n\n87\n00:04:55.795 --> 00:04:57.489\nI've got it pulled up right\nhere on the firewall.\n\n88\n00:04:57.489 --> 00:04:59.841\nThese are communications that\nare happening right now.\n\n89\n00:04:59.841 --> 00:05:03.093\nIf I fire up a tab in my web browser and\n\n90\n00:05:03.093 --> 00:05:07.773\nI go somewhere like,\nwe'll go to slashdot.org.\n\n91\n00:05:07.773 --> 00:05:09.516\nSo, I'm gonna go to this website.\n\n92\n00:05:09.516 --> 00:05:12.972\nAnd when I browse the website,\nI'm going out with my fake IP,\n\n93\n00:05:12.972 --> 00:05:14.842\nI should be getting translated.\n\n94\n00:05:14.842 --> 00:05:16.905\nAnd when I look, the firewall blew up.\n\n95\n00:05:16.905 --> 00:05:18.548\nThere's just a ton of traffic here.\n\n96\n00:05:18.548 --> 00:05:25.352\nAnd if I look at the traffic,\nsee how it's 209.251.159.184\n\n97\n00:05:25.352 --> 00:05:29.550\ncoming from 208.67.220.220?\n\n98\n00:05:29.550 --> 00:05:31.314\nThat, actually that's a DNS lookup.\n\n99\n00:05:31.314 --> 00:05:32.507\nThat's OpenDNS.\n\n100\n00:05:32.507 --> 00:05:33.394\nWe configured that in another show.\n\n101\n00:05:33.394 --> 00:05:34.447\nI forgot about that.\n\n102\n00:05:34.447 --> 00:05:36.830\nSo, somewhere in here,\nI'll find that slashdot traffic.\n\n103\n00:05:36.830 --> 00:05:40.327\nBut you guys can see where these\nlook-ups are coming back, and\n\n104\n00:05:40.327 --> 00:05:44.884\nthey're not pointing to 192.168.0.100,\nthey're pointing to,\n\n105\n00:05:44.884 --> 00:05:49.324\nwhich is my work station,\nthey're pointing to 209.251 dot whatever.\n\n106\n00:05:49.324 --> 00:05:51.626\nThey're going to my firewall.\n\n107\n00:05:51.626 --> 00:05:54.285\nMy firewall is having to\ntranslate that back and\n\n108\n00:05:54.285 --> 00:05:56.354\nsend it over to the internal system.\n\n109\n00:05:56.354 --> 00:05:59.082\nAnd, it's all happening here in\nthe background without me having\n\n110\n00:05:59.082 --> 00:05:59.871\nto worry about it.\n\n111\n00:05:59.871 --> 00:06:05.507\nAnd, I would've seen that here in the web\nbased top also, there, it updates.\n\n112\n00:06:05.507 --> 00:06:08.721\nAnd, I can search for whatever\nslashdots IP was and find it in there.\n\n113\n00:06:08.721 --> 00:06:12.141\nAnd, we should see it responding\nback to that public IP, all right.\n\n114\n00:06:12.141 --> 00:06:17.442\nSo, in theory, this could be the shortest\nsegment ever in ITProTV history because,\n\n115\n00:06:17.442 --> 00:06:20.178\nwhat does it take to\nconfigure dynamic NAT?\n\n116\n00:06:20.178 --> 00:06:22.033\nNothing.\nIt's done.\n\n117\n00:06:22.033 --> 00:06:25.790\nBut there are a few little extra things\nthat we need to know about it that\n\n118\n00:06:25.790 --> 00:06:26.691\nare important.\n\n119\n00:06:26.691 --> 00:06:29.601\nFor example,\nwhen you do the pfSense install,\n\n120\n00:06:29.601 --> 00:06:34.051\nit configures NAT automatically for\nyou for your LAN going out, right?\n\n121\n00:06:34.051 --> 00:06:36.002\nWhat if you have more than two interfaces?\n\n122\n00:06:36.002 --> 00:06:39.979\nIf you've got a DMZ for example,\nit does not configure NAT for that.\n\n123\n00:06:39.979 --> 00:06:42.826\nIf you're using public IP's in your DMZ,\nyou don't care, but\n\n124\n00:06:42.826 --> 00:06:45.464\nif it's a private network\nthat's in that DMZ, or whatever\n\n125\n00:06:45.464 --> 00:06:49.289\nthat other network is that you've created,\nyou need to come in and create NAT rules.\n\n126\n00:06:49.289 --> 00:06:52.037\nSo, you'll need to know how to\nbe able to set this up yourself.\n\n127\n00:06:52.037 --> 00:06:54.740\nThe other thing is you might\nwant to override its behavior.\n\n128\n00:06:54.740 --> 00:06:57.164\nRight now, what it's translating me,\n\n129\n00:06:57.164 --> 00:07:00.455\nit's translating me to the IP\naddress of my firewall.\n\n130\n00:07:00.455 --> 00:07:03.799\nWhat if I actually have more than one IP\naddress from my Internet service provider?\n\n131\n00:07:03.799 --> 00:07:06.422\nThey do that, right,\nthey can give you more than one address.\n\n132\n00:07:06.422 --> 00:07:11.402\nI might want to translate all of my\ninternal hosts to a different address,\n\n133\n00:07:11.402 --> 00:07:11.974\nright?\n\n134\n00:07:11.974 --> 00:07:15.056\nAnd for that I'm gonna have to go in and\nconfigure this myself.\n\n135\n00:07:15.056 --> 00:07:16.479\nFortunately, it's not very hard.\n\n136\n00:07:16.479 --> 00:07:22.184\nIf we go up here to firewall and NAT, and\nwe go to that outbound NAT, right in here,\n\n137\n00:07:22.184 --> 00:07:27.184\nwe can see that we've got the automatic\noutbound NAT rule generation.\n\n138\n00:07:27.184 --> 00:07:29.020\nSo, that's in there for me.\n\n139\n00:07:29.020 --> 00:07:32.259\nWe can change it to manual, and\nnow we can create our own rules and\n\n140\n00:07:32.259 --> 00:07:34.794\ndefine things however we want them to be,\nright?\n\n141\n00:07:34.794 --> 00:07:37.195\nSo, now,\nit's kind of up to us to specify it.\n\n142\n00:07:37.195 --> 00:07:38.824\nSo, we can come in and we can put that.\n\n143\n00:07:38.824 --> 00:07:41.437\nYou'll also see where you\ncan do a hybrid outbound.\n\n144\n00:07:41.437 --> 00:07:44.733\nWhere you get the automatic, and\nthen you can add your own rules to it.\n\n145\n00:07:44.733 --> 00:07:47.431\nBut if I wanna override\nthose automatic ones,\n\n146\n00:07:47.431 --> 00:07:49.861\nthen I just wanna go straight out manual.\n\n147\n00:07:49.861 --> 00:07:53.001\nWhen I choose manual, it's gonna wipe out\nall these rules, and I can create my own.\n\n148\n00:07:53.001 --> 00:07:56.632\nNotice there's two rules down there, and\nI really didn't mention this one above it.\n\n149\n00:07:56.632 --> 00:08:01.636\nThere's a special rule that's put\nin specifically for IPsec VPN's.\n\n150\n00:08:01.636 --> 00:08:04.957\n>> IPsec sends encrypted\ntraffic on port 500 and\n\n151\n00:08:04.957 --> 00:08:09.950\nit's really important that you\ndon't mess with that port number.\n\n152\n00:08:09.950 --> 00:08:13.072\nIf you change the port number on\nthe traffic when it moves through,\n\n153\n00:08:13.072 --> 00:08:14.485\nit breaks the IPsec session.\n\n154\n00:08:14.485 --> 00:08:16.060\nSo they put a rule in there for that.\n\n155\n00:08:16.060 --> 00:08:18.246\nIf you're not using IPsec,\nthen you don't care about that rule.\n\n156\n00:08:18.246 --> 00:08:20.160\nYou can delete it, you don't need it.\n\n157\n00:08:20.160 --> 00:08:22.490\nBut that's why it's there is\nto preserve that traffic and\n\n158\n00:08:22.490 --> 00:08:24.020\nmake sure it doesn't get translated.\n\n159\n00:08:24.020 --> 00:08:28.270\nSo if we're gonna go manual, we might\nneed to add that rule back in ourselves.\n\n160\n00:08:29.720 --> 00:08:32.240\nIn my case, I'm not using IPsec,\nso I'm not worried about it.\n\n161\n00:08:32.240 --> 00:08:35.660\nI'm gonna switch over to Manual and\nI'll save that.\n\n162\n00:08:35.660 --> 00:08:41.480\nAnd once it saves and applies,\nmy NAT is now under my control.\n\n163\n00:08:41.480 --> 00:08:44.333\nAnd notice that it tried to\nguess the rules that I needed.\n\n164\n00:08:44.333 --> 00:08:47.120\nIt basically put those\nauto rules in here for me.\n\n165\n00:08:47.120 --> 00:08:50.760\nI've got the 127 network,\nwhich is the loopback and\n\n166\n00:08:50.760 --> 00:08:54.970\nI've got my 192.168 network right here\nbeing translated into a WAN address.\n\n167\n00:08:54.970 --> 00:08:59.350\nWell, I actually don't want to\ntranslate any loopback traffic.\n\n168\n00:08:59.350 --> 00:09:01.980\nI shouldn't have any traffic\noriginating from that.\n\n169\n00:09:01.980 --> 00:09:04.352\nIf I do, that's a problem in and\nof itself.\n\n170\n00:09:04.352 --> 00:09:07.395\nSo, I'm just going to take those rules and\nwe'll get rid of them.\n\n171\n00:09:08.825 --> 00:09:12.867\nSo we'll delete those out and\nI'm not using IPsec on this network, so\n\n172\n00:09:12.867 --> 00:09:15.070\nI'm going to get rid of that rule too.\n\n173\n00:09:15.070 --> 00:09:18.795\nNow even if you're not using IPsec, it\ndoesn't hurt to leave the rule in there.\n\n174\n00:09:18.795 --> 00:09:20.028\nIf I want it, I can leave it be.\n\n175\n00:09:20.028 --> 00:09:23.338\nBut in my case, just for simplicity,\nI'm gonna go head and knock that one out.\n\n176\n00:09:23.338 --> 00:09:26.502\nSo, I don't have to worry about it.\n\n177\n00:09:26.502 --> 00:09:29.108\nNow, I'm down to just one rule.\n\n178\n00:09:29.108 --> 00:09:34.228\nOne rule that says,\nif you're on the 192.168.0 and you're\n\n179\n00:09:34.228 --> 00:09:39.970\ngoing really anywhere I want to translate\nthat to whatever the WAN address is.\n\n180\n00:09:39.970 --> 00:09:44.388\nWell, if I have a separate IP address,\nI want these hosts to go out under,\n\n181\n00:09:44.388 --> 00:09:45.329\nI can specify.\n\n182\n00:09:45.329 --> 00:09:49.153\nI can edit this rule or\nI can create a new rule and put that in.\n\n183\n00:09:49.153 --> 00:09:51.797\nSo I'm gonna do that,\nI'm gonna edit this rule.\n\n184\n00:09:51.797 --> 00:09:56.477\nAnd instead of going out of my WAN\naddress, which we have got right here,\n\n185\n00:09:56.477 --> 00:09:57.732\nsee translation.\n\n186\n00:09:57.732 --> 00:09:59.697\nWe're gonna translate to an address.\n\n187\n00:09:59.697 --> 00:10:02.130\nActually, let's kind of walk through\nall the different settings here.\n\n188\n00:10:02.130 --> 00:10:03.780\nMost of these are really straightforward.\n\n189\n00:10:03.780 --> 00:10:07.000\nWe can disable the rule,\nif we need to temporarily turn it off.\n\n190\n00:10:07.000 --> 00:10:08.673\nWe can say, do not NAT.\n\n191\n00:10:08.673 --> 00:10:11.300\nThat's called a NAT exclusion rule.\n\n192\n00:10:11.300 --> 00:10:14.640\nWhen would you want to not NAT something?\n\n193\n00:10:14.640 --> 00:10:15.660\nWell, let's add a DMZ.\n\n194\n00:10:16.690 --> 00:10:19.540\nIf I wanted my LAN\ntraffic to go to the DMZ,\n\n195\n00:10:19.540 --> 00:10:22.020\nI probably don't need to translate that.\n\n196\n00:10:22.020 --> 00:10:24.970\nThe DMZ, I've got routes to be able\nto get to the private network, so\n\n197\n00:10:24.970 --> 00:10:26.930\nI can handle that without translating.\n\n198\n00:10:26.930 --> 00:10:30.602\nSo I can disable translation and\nthat saves CPU cycles,\n\n199\n00:10:30.602 --> 00:10:33.191\nit reduces the workload of the router.\n\n200\n00:10:33.191 --> 00:10:36.946\nOr if I have a VPN in place,\nI don't need to translate between me and\n\n201\n00:10:36.946 --> 00:10:41.200\nthe VPN clients and so I might have\nNAT exclusion rules for those too.\n\n202\n00:10:41.200 --> 00:10:44.553\nThat's why you got this do\nnot NAT option in a NAT rule.\n\n203\n00:10:44.553 --> 00:10:47.838\nI know it seems counterintuitive,\nbut it is actually pretty useful,\n\n204\n00:10:47.838 --> 00:10:49.220\nthen the interface.\n\n205\n00:10:49.220 --> 00:10:53.403\nNow the interface is saying,\nwhat interface we're going out of?\n\n206\n00:10:53.403 --> 00:10:55.826\nMy traffic is going out of\nthat WAN interface and so\n\n207\n00:10:55.826 --> 00:11:00.120\nthat's where I'm gonna be translating\nthis, then we can specify our Protocol.\n\n208\n00:11:00.120 --> 00:11:02.513\nWe typically want any on that one.\n\n209\n00:11:02.513 --> 00:11:05.573\nThe source,\nwe're just setting that LAN network and\n\n210\n00:11:05.573 --> 00:11:09.826\nthey've actually got it\nhard-coded here as 192.168.0.0.\n\n211\n00:11:09.826 --> 00:11:13.786\nNotice that I don't have the little\noption to choose LAN net like normal.\n\n212\n00:11:13.786 --> 00:11:18.188\nAnd it's not a problem so much as just\nthe way that pfSense is developed,\n\n213\n00:11:18.188 --> 00:11:23.225\nit's an open source product,\ndifferent people develop different things.\n\n214\n00:11:23.225 --> 00:11:27.073\nAnd so some screens are not consistent,\nthey don't pull data from the same places.\n\n215\n00:11:27.073 --> 00:11:28.197\nSo we do have to type that network in.\n\n216\n00:11:29.567 --> 00:11:33.179\nOn the nice side, you could specify\na smaller network than what you normally\n\n217\n00:11:33.179 --> 00:11:34.487\nhave assigned to your LAN.\n\n218\n00:11:34.487 --> 00:11:39.363\nYou've got that flexibility,\nthen we got the destination.\n\n219\n00:11:39.363 --> 00:11:42.054\nNow normally when we're talking about NAT,\nwe're using it,\n\n220\n00:11:42.054 --> 00:11:43.696\ncuz we're going out to the internet.\n\n221\n00:11:43.696 --> 00:11:47.503\nAnd so you don't have a particular\ndestination, this might be giant.\n\n222\n00:11:47.503 --> 00:11:51.973\nBut if we're doing a NAT exclusion rule\nup here, I might say do not NAT and\n\n223\n00:11:51.973 --> 00:11:55.370\nthen in the destination,\nI put the subnet for my VPN clients.\n\n224\n00:11:55.370 --> 00:11:57.639\nThat way, I'm not getting translated\nwhen I go to those VPN clients.\n\n225\n00:11:57.639 --> 00:12:00.550\nSo that's what you'd use this for.\n\n226\n00:12:00.550 --> 00:12:02.610\nAnd then lastly,\nwe've got the translation itself.\n\n227\n00:12:02.610 --> 00:12:07.266\nThe default is to translate to\nwhatever the interface address is that\n\n228\n00:12:07.266 --> 00:12:10.881\nwe're going out, but\nyou can choose other subnet and\n\n229\n00:12:10.881 --> 00:12:14.190\nyou can put either a single IP or\na range of IP's.\n\n230\n00:12:14.190 --> 00:12:17.880\nIf you put a range of IP's,\nyou're creating a pool of IP's.\n\n231\n00:12:17.880 --> 00:12:21.415\nAnd this hosts go out, they'll just\ngrab the first one, that's available and\n\n232\n00:12:21.415 --> 00:12:22.013\nout they go.\n\n233\n00:12:22.013 --> 00:12:25.338\nBut if you just put a single IP,\nyou're doing what's called NAT overload.\n\n234\n00:12:25.338 --> 00:12:27.804\nAnd everybody's gonna use that\nsame IP on the way out and\n\n235\n00:12:27.804 --> 00:12:31.270\nthey'll have to do what's called port\naddress translation or PAT to make sure\n\n236\n00:12:31.270 --> 00:12:34.649\nthat you don't get conflicts, like two\npeople using the same port number.\n\n237\n00:12:35.740 --> 00:12:37.694\nSo for me,\nI'm gonna put a single IP in here.\n\n238\n00:12:37.694 --> 00:12:42.808\nI'm gonna do 209.251.159.180.\n\n239\n00:12:42.808 --> 00:12:45.253\nRight now when I go out,\nI'm going out as 184,\n\n240\n00:12:45.253 --> 00:12:47.533\ncuz that's what's assigned to my firewall.\n\n241\n00:12:47.533 --> 00:12:50.697\nMaybe the ISP says, well,\nin addition to 184,\n\n242\n00:12:50.697 --> 00:12:55.629\nwe're also going to assign you 180 or\nsome other completely unrelated IP and\n\n243\n00:12:55.629 --> 00:12:58.660\nwe'll punch that in and\nthe bits in that subnet.\n\n244\n00:12:58.660 --> 00:13:01.173\nNow because it's one IP,\nI'm gonna put, whoops.\n\n245\n00:13:01.173 --> 00:13:02.990\n[LAUGH] That's not what I wanted.\n\n246\n00:13:02.990 --> 00:13:09.913\nI'm gonna put /32, so\nit's just that single IP and there we go.\n\n247\n00:13:09.913 --> 00:13:13.503\nSo, /32 and the pull options.\n\n248\n00:13:13.503 --> 00:13:17.380\nIf I did a pool,\nif I did more than one IP here.\n\n249\n00:13:17.380 --> 00:13:19.464\nThere's a few neat little options in here.\n\n250\n00:13:19.464 --> 00:13:21.270\nYou've got Round Robin.\n\n251\n00:13:21.270 --> 00:13:24.601\nRound Robin means this is gonna be doled\nout on a first come, first serve basis.\n\n252\n00:13:24.601 --> 00:13:28.125\nIf there's five IPs, the first five\ncomputers that come through are each gonna\n\n253\n00:13:28.125 --> 00:13:30.190\nget one of those IPs and\nthey're gonna go out.\n\n254\n00:13:31.210 --> 00:13:33.635\nWhat happens to the sixth person?\n\n255\n00:13:33.635 --> 00:13:34.523\n>> They don't get anywhere.\n\n256\n00:13:34.523 --> 00:13:36.061\n>> They don't get an address.\n\n257\n00:13:36.061 --> 00:13:37.833\nThey lucked out.\n\n258\n00:13:37.833 --> 00:13:41.390\nSo I've got another option that says,\nRound Robin with a sticky address.\n\n259\n00:13:41.390 --> 00:13:45.600\nAnd if I do five addresses,\nthe first four get their own IP.\n\n260\n00:13:45.600 --> 00:13:49.210\nBut the fifth one and everyone that\nfollows will all share that last IP,\n\n261\n00:13:49.210 --> 00:13:51.640\nthat becomes a sticky address.\n\n262\n00:13:51.640 --> 00:13:55.160\nNow Round Robin goes in order,\nyou can do the same thing randomly.\n\n263\n00:13:55.160 --> 00:13:57.975\nSo when you grab an IP,\nit's a random IP pulled out of the pool.\n\n264\n00:13:57.975 --> 00:14:01.400\nInstead of one after the other in\nsequence, you've got that option.\n\n265\n00:14:01.400 --> 00:14:05.857\nYou've got a few other things like doing\nsource and Bitmask hashing, which lets you\n\n266\n00:14:05.857 --> 00:14:10.028\ndetermine when somebody goes out,\nwhich of the IPs they're gonna grab from.\n\n267\n00:14:10.028 --> 00:14:13.655\nSo you could start to kind of\nbalance people across the IPs.\n\n268\n00:14:13.655 --> 00:14:17.274\nIf I've got five IPs,\nfour people get a dedicated IP and\n\n269\n00:14:17.274 --> 00:14:19.745\nthen everyone else is sharing one IP.\n\n270\n00:14:19.745 --> 00:14:23.025\nBut if I do source hashing,\nI can divide it up evenly.\n\n271\n00:14:23.025 --> 00:14:27.717\nWhere if I have five IPs, 20% of my people\ngo to one IP, 20% go to the next IP,\n\n272\n00:14:27.717 --> 00:14:28.886\n20 go to the next.\n\n273\n00:14:28.886 --> 00:14:34.900\nSo, it's a little bit more\neven than Round Robining is.\n\n274\n00:14:34.900 --> 00:14:38.592\nI can specify a port, but typically you're\nnot gonna modify your ports on this one,\n\n275\n00:14:38.592 --> 00:14:40.152\nyou're gonna let it do it for you and\n\n276\n00:14:40.152 --> 00:14:42.143\nyou've got whether you\ncan do static ports.\n\n277\n00:14:42.143 --> 00:14:44.811\nWe're gonna talk about static\nmappings in another episode where we\n\n278\n00:14:44.811 --> 00:14:45.943\ndo one-to-one mappings.\n\n279\n00:14:45.943 --> 00:14:48.130\nThis one is what's called dynamic.\n\n280\n00:14:48.130 --> 00:14:51.371\nYou don't necessarily know what IP\nyou're gonna get when you pass through\n\n281\n00:14:51.371 --> 00:14:53.387\nthe firewall, it's whatever is available.\n\n282\n00:14:53.387 --> 00:14:55.481\nAfter that, I can go ahead and save it.\n\n283\n00:14:55.481 --> 00:15:00.796\nAnd now my rule is basically functioning\nthe same way as the default rule,\n\n284\n00:15:00.796 --> 00:15:05.871\nexcept I've given it a specific IP\nto use when we translate and go out.\n\n285\n00:15:05.871 --> 00:15:08.244\nSo now when my client\nbrowses out to the Internet,\n\n286\n00:15:08.244 --> 00:15:10.970\nthey're not gonna browse out\nwith what they had before.\n\n287\n00:15:10.970 --> 00:15:11.953\nNow they're gonna browse\nout with this other one.\n\n288\n00:15:11.953 --> 00:15:15.163\nAnd actually, I should have shown that.\n\n289\n00:15:15.163 --> 00:15:16.608\nLet me do this real quick.\n\n290\n00:15:16.608 --> 00:15:19.447\nI'm gonna add another rule and\n\n291\n00:15:19.447 --> 00:15:25.060\nI'm gonna put this one back to\nusing the interface address.\n\n292\n00:15:25.060 --> 00:15:27.157\nSo we'll go ahead and create that one and\n\n293\n00:15:27.157 --> 00:15:30.190\nI'm gonna disable this rule\nthat I just made a second ago.\n\n294\n00:15:30.190 --> 00:15:31.840\nSo I'm gonna go in here and\ndisable that rule.\n\n295\n00:15:32.900 --> 00:15:37.503\nSo now what I've got is one rule that's\nbasically saying, when I go out,\n\n296\n00:15:37.503 --> 00:15:40.337\nI'm gonna go out through\nthe WAN IP address.\n\n297\n00:15:40.337 --> 00:15:45.066\nI threw a web server out in my little\ninternet zone and on that web server, I\n\n298\n00:15:45.066 --> 00:15:51.230\nmade a quick web page that I can browse to\nthat'll show me my IP and the server's IP.\n\n299\n00:15:51.230 --> 00:15:53.130\nSo if I browse out to that system.\n\n300\n00:15:53.130 --> 00:15:55.600\nOh, I might not have\ngiven it time to update.\n\n301\n00:15:57.470 --> 00:15:58.544\nOh, I didn't apply my changes.\n\n302\n00:15:58.544 --> 00:15:59.416\nLet me apply that real quick.\n\n303\n00:15:59.416 --> 00:16:03.686\nSo when I've got that in place, so now\nI've got that rule there, it's set to NAT,\n\n304\n00:16:03.686 --> 00:16:05.519\nit's set to go on that WAN address.\n\n305\n00:16:05.519 --> 00:16:06.402\nThat's all in place.\n\n306\n00:16:06.402 --> 00:16:08.063\nWe should be good to go.\n\n307\n00:16:08.063 --> 00:16:09.025\nThere we go.\n\n308\n00:16:09.025 --> 00:16:11.042\nAll right.\nWhen I browse that web server,\n\n309\n00:16:11.042 --> 00:16:12.907\nI just put a quick HTML file in there,\n\n310\n00:16:12.907 --> 00:16:15.448\nthat would use session\nvariables to show me my IP.\n\n311\n00:16:15.448 --> 00:16:20.860\nSo I can see that my IP\naddress is 209.251.159.184.\n\n312\n00:16:20.860 --> 00:16:24.890\nThat's my IP address, and\nthe server I went to is 185.\n\n313\n00:16:24.890 --> 00:16:27.900\nWell, 184,\nthat's the IP address on the firewall.\n\n314\n00:16:27.900 --> 00:16:30.911\nI got translated to the firewall's IP,\nall right?\n\n315\n00:16:30.911 --> 00:16:35.310\nIf I go and change my rules around,\noops, if I can remember what tab I'm on.\n\n316\n00:16:35.310 --> 00:16:39.795\nIf I change my rules around,\nI'm gonna disable this rule that's tied to\n\n317\n00:16:39.795 --> 00:16:47.830\nthe interface, and I'm gonna flip over to\nmy new rule, And we'll enable that one.\n\n318\n00:16:49.750 --> 00:16:53.780\nNow, instead of being translated to the\ninterface IP, I'll be translated to this\n\n319\n00:16:53.780 --> 00:16:57.985\nother IP, this 180, which I'm\npretty sure is in the same network.\n\n320\n00:16:57.985 --> 00:17:00.780\n[LAUGH] So there we go.\n\n321\n00:17:00.780 --> 00:17:02.310\nSo we've got that one set, so\n\n322\n00:17:02.310 --> 00:17:04.600\nnow that one's gonna translate over,\nand be in place.\n\n323\n00:17:04.600 --> 00:17:09.200\nSo if I jump over here and\nbrowse to this server again,\n\n324\n00:17:09.200 --> 00:17:12.566\nnow when I browse to it,\nit's gonna reach out and.\n\n325\n00:17:12.566 --> 00:17:16.600\nI might have to wait a second, it's got\nto flush the translation tables, and\n\n326\n00:17:16.600 --> 00:17:18.190\nthe translations can stay around for\na little while.\n\n327\n00:17:18.190 --> 00:17:22.124\nSo we gotta wait just a second, but\nwhat I should see is that it comes up, and\n\n328\n00:17:22.124 --> 00:17:23.516\nI'm under the 180 IP.\n\n329\n00:17:23.516 --> 00:17:26.760\nI'm not getting to the IP, or\nI'm not getting to the web server, and so\n\n330\n00:17:26.760 --> 00:17:28.080\nI've obviously caused a problem, and\n\n331\n00:17:28.080 --> 00:17:31.315\nI think I know what I did here, is\nthere's one extra step that I didn't do.\n\n332\n00:17:31.315 --> 00:17:37.230\nWhen I natted, I'm natting to an IP that's\nnot actually local to this firewall.\n\n333\n00:17:37.230 --> 00:17:39.350\nSo by default, your firewall is\ngonna ignore that IP, right?\n\n334\n00:17:39.350 --> 00:17:43.770\nIf I go back to my rule, and\nI look at the rules that I've made,\n\n335\n00:17:43.770 --> 00:17:49.975\nI'm natting my 192.168.0.0\nto this 209.251.159.180.\n\n336\n00:17:49.975 --> 00:17:54.754\nBut my firewall is actually dot 184, it's\nnot dot 180, so what's your firewall gonna\n\n337\n00:17:54.754 --> 00:17:59.040\ndo with traffic that it receives for\nan IP that isn't on the firewall?\n\n338\n00:17:59.040 --> 00:18:00.540\nIt's gonna throw it away, right, and\n\n339\n00:18:00.540 --> 00:18:03.140\nthat's most likely what's happening to me\nhere, is my traffic's getting thrown away.\n\n340\n00:18:03.140 --> 00:18:06.510\nSo I need to tell the firewall hey,\nyou've got this extra IP.\n\n341\n00:18:06.510 --> 00:18:08.940\nYou don't know about it yet, but\nI'm gonna tell you, all right?\n\n342\n00:18:08.940 --> 00:18:12.040\nAnd if I had gone a little\nslower when I edited this rule,\n\n343\n00:18:12.040 --> 00:18:13.960\nit actually gives us a warning about that.\n\n344\n00:18:13.960 --> 00:18:14.540\nRight here,\n\n345\n00:18:14.540 --> 00:18:18.860\nwhen it's giving you the information about\ndefining the IP, it says right here,\n\n346\n00:18:18.860 --> 00:18:22.020\nif you're gonna sign an IP address\nother than the one on the interface,\n\n347\n00:18:22.020 --> 00:18:27.140\nyou'll need to define a virtual IP address\nfirst, and that's what I didn't do.\n\n348\n00:18:27.140 --> 00:18:31.240\nA virtual IP is one that is not\nnecessarily assigned to an interface\n\n349\n00:18:31.240 --> 00:18:34.210\ndirectly, but\none that you're using on the firewall.\n\n350\n00:18:34.210 --> 00:18:38.570\nAnd so right here, I pull up my virtual\nIP list, and I don't have any, so\n\n351\n00:18:38.570 --> 00:18:39.740\nI need to add one.\n\n352\n00:18:39.740 --> 00:18:43.295\nSo I'm gonna add in one, and\nI'm gonna add in an IP alias.\n\n353\n00:18:43.295 --> 00:18:45.130\nYou got a few choices up here.\n\n354\n00:18:45.130 --> 00:18:47.280\nCARP, is for router redundancy.\n\n355\n00:18:47.280 --> 00:18:50.110\nSo if you've got like a shared IP\nbetween more than one firewall,\n\n356\n00:18:50.110 --> 00:18:51.880\nthat's how you can get redundancy.\n\n357\n00:18:51.880 --> 00:18:55.110\nProxy ARP,\nmeans if somebody does an ARP request for\n\n358\n00:18:55.110 --> 00:18:58.060\nthis IP, we'll actually respond with\nthe MAC address of our firewall, so\n\n359\n00:18:58.060 --> 00:19:00.250\nthe traffic knows to come to us.\n\n360\n00:19:00.250 --> 00:19:04.890\nIP alias just says there's another IP\naddress tied to our same MAC address,\n\n361\n00:19:04.890 --> 00:19:06.440\nour normal system.\n\n362\n00:19:06.440 --> 00:19:10.010\nSo, usually you wanna go with IP alias,\nbut if you have a problem with\n\n363\n00:19:10.010 --> 00:19:12.400\nconnectivity, you might need to\nswitch it over to Proxy ARP.\n\n364\n00:19:12.400 --> 00:19:13.852\nThere's different scenarios\nwhere that happens.\n\n365\n00:19:13.852 --> 00:19:16.564\nOn a WAN link,\nARP's not normally a concern, and so\n\n366\n00:19:16.564 --> 00:19:19.102\nthat's why we don't\nnormally choose that one.\n\n367\n00:19:19.102 --> 00:19:23.160\nOn a internal network like mine is,\nI might actually have to flip that on.\n\n368\n00:19:23.160 --> 00:19:24.300\nWe'll see.\n\n369\n00:19:24.300 --> 00:19:26.490\nAnd then we can say what\ninterface it's tied to.\n\n370\n00:19:26.490 --> 00:19:28.968\nThis is a public IP, so\nI'm tying it to my WAN interface.\n\n371\n00:19:28.968 --> 00:19:31.568\nAnd then I just need to tell it the IP.\n\n372\n00:19:31.568 --> 00:19:36.885\nSo the one I'm working with,\nis 209.251.159.180,\n\n373\n00:19:36.885 --> 00:19:41.040\nand it's a slash 32, so I'll provide that.\n\n374\n00:19:41.040 --> 00:19:44.175\nIf you want to configure advanced things,\nlike virtual IP passwords,\n\n375\n00:19:44.175 --> 00:19:46.653\nit supports that and stuff, but\nI'm not really worried about any of that.\n\n376\n00:19:46.653 --> 00:19:53.180\nI'm just creating a NAT Pool IP,\nand so I'll punch that in.\n\n377\n00:19:53.180 --> 00:19:57.300\nAnd now the firewall knows, hey,\nwhile this IP isn't actually\n\n378\n00:19:57.300 --> 00:20:00.570\nassigned to our interface, it's one that\nwe're using in some of our services, so\n\n379\n00:20:00.570 --> 00:20:02.600\nit's okay to reply to this traffic.\n\n380\n00:20:02.600 --> 00:20:07.300\nSo now that that's defined, I've got that\nvirtual IP, and we should be in business.\n\n381\n00:20:07.300 --> 00:20:10.500\nNow, on a WAN link,\nwe definitely would be in business.\n\n382\n00:20:10.500 --> 00:20:12.920\nOn a LAN one like mine,\nI might have to turn on Proxy ARP, so\n\n383\n00:20:12.920 --> 00:20:16.230\nlet's go see what happens when I try and\nbrowse to this server now.\n\n384\n00:20:16.230 --> 00:20:18.238\nOh, works and\nI didn't have to turn on Proxy ARP.\n\n385\n00:20:18.238 --> 00:20:20.542\n>> [LAUGH]\n>> Now when I browse to my server,\n\n386\n00:20:20.542 --> 00:20:26.394\ninstead of showing 209.251.159.184,\nthe firewall's IP, I now show 180.\n\n387\n00:20:26.394 --> 00:20:30.283\nWhen my client goes out, I'm being\ntranslated to that other address, and\n\n388\n00:20:30.283 --> 00:20:33.205\nthe firewall still maintains\nits 184 as separate.\n\n389\n00:20:33.205 --> 00:20:35.816\nIt's kind of its own one,\nand off we go, right?\n\n390\n00:20:35.816 --> 00:20:40.658\nSo, these are the little things that we\nmight need to do to adjust the dynamic NAT\n\n391\n00:20:40.658 --> 00:20:42.116\non a pfSense firewall.\n\n392\n00:20:42.116 --> 00:20:45.324\nNow I know what some of you guys\nare thinking is, that's all well and\n\n393\n00:20:45.324 --> 00:20:47.787\ngood Don, but\nhow do I do port forwarding, right?\n\n394\n00:20:47.787 --> 00:20:51.922\nWell, there are other types of NAT that\nare available that each have their\n\n395\n00:20:51.922 --> 00:20:53.262\ndifferent purposes, and\n\n396\n00:20:53.262 --> 00:20:56.582\nwe're gonna cover those in additional\nsegments that are actually coming up.\n\n397\n00:20:56.582 --> 00:20:57.442\nSo if you're watching live,\n\n398\n00:20:57.442 --> 00:21:00.710\nyou'll see that in just a few moments,\nbut if you're watching this recorded,\n\n399\n00:21:00.710 --> 00:21:02.970\nyou can jump right ahead and\ncatch those port forwarding ones.\n\n400\n00:21:02.970 --> 00:21:04.860\nI know for home users, you use that a lot.\n\n401\n00:21:04.860 --> 00:21:07.540\nIn businesses,\nyou typically don't use port forwarding.\n\n402\n00:21:07.540 --> 00:21:10.450\nYou typically use one-to-one\nstatic NAT maps, so\n\n403\n00:21:10.450 --> 00:21:12.690\nwe'll get a chance to see\nthose in another segment too.\n\n404\n00:21:12.690 --> 00:21:14.910\nBut as far as our dynamic pools,\n\n405\n00:21:14.910 --> 00:21:19.730\nin really large networks,\na single IP is not typically enough.\n\n406\n00:21:19.730 --> 00:21:23.980\nAnd so we're gonna need to modify our\ndynamic net, create a larger pool, and\n\n407\n00:21:23.980 --> 00:21:26.060\nuse that for\nour host to be able to support it.\n\n408\n00:21:26.060 --> 00:21:29.820\nSo if you've got thousands and thousands\nof computers, that's the situation you're\n\n409\n00:21:29.820 --> 00:21:32.940\nin, and that's where modifying these\ndynamic NAT rules really comes in handy.\n\n410\n00:21:34.900 --> 00:21:35.771\nAll right, well Ronnie,\n\n411\n00:21:35.771 --> 00:21:38.130\ncan you think of anything else we\nshould throw in on dynamic NATs?\n\n412\n00:21:38.130 --> 00:21:41.550\n>> Yeah, on dynamic NAT,\nthe nice thing is, by default,\n\n413\n00:21:41.550 --> 00:21:44.215\nit should work just perfectly fine when\nyou're setting up a simple network.\n\n414\n00:21:44.215 --> 00:21:47.700\nBut remember, once you get into\nthat larger enterprise, or\n\n415\n00:21:47.700 --> 00:21:51.690\nthat larger corporation, learning at least\nthe basics here on that are really gonna\n\n416\n00:21:51.690 --> 00:21:54.780\nhelp us out, so\nit's a great demo that we had.\n\n417\n00:21:54.780 --> 00:21:56.136\n>> All right, well ladies and gentlemen,\nI hope you guys enjoyed the segment.\n\n418\n00:21:56.136 --> 00:21:58.992\nStay tuned,\nwe've got more pfSense.net coming up.\n\n419\n00:21:58.992 --> 00:22:05.600\n[MUSIC]\n\n",
          "vimeoId": "130429597"
        },
        {
          "description": null,
          "length": "820",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-2-11_nat_mapping-061015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-2-11_nat_mapping-061015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-2-11_nat_mapping-061015-1-sm.jpg",
          "title": "1:1 NAT Mapping",
          "transcript": "WEBVTT\n\n1\n00:00:00.025 --> 00:00:07.265\n[MUSIC]\n\n2\n00:00:07.265 --> 00:00:10.561\nIn this segment, we're gonna take\na look at 1:1 static NAT Mapping.\n\n3\n00:00:10.561 --> 00:00:11.930\nNow, static NAT Mapping.\n\n4\n00:00:13.720 --> 00:00:18.800\nThat's where we have, typically, a public\nIP address that we want to directly map\n\n5\n00:00:18.800 --> 00:00:23.290\nto one single host inside of our network\nthat's not shared with anybody else.\n\n6\n00:00:23.290 --> 00:00:27.600\nThat one host always has that one\npublic IP that's tied to them, and\n\n7\n00:00:27.600 --> 00:00:29.310\nthey don't share it with anybody.\n\n8\n00:00:29.310 --> 00:00:31.652\nNow, why would we want to do that?\n\n9\n00:00:31.652 --> 00:00:34.300\nCan you think of why we would\nwant something like that?\n\n10\n00:00:34.300 --> 00:00:37.780\n>> Maybe you have an internal server\nthat you wanna be available just out to\n\n11\n00:00:37.780 --> 00:00:40.738\nthe public, and you only had\nyour private IP addresses, but\n\n12\n00:00:40.738 --> 00:00:43.630\nyou need to tie it directly\nto that public IP address.\n\n13\n00:00:43.630 --> 00:00:44.453\n>> That's one of the best uses.\n\n14\n00:00:44.453 --> 00:00:47.029\nAnd we know we can do things\nlike port forwarding, but\n\n15\n00:00:47.029 --> 00:00:51.100\nthere's problems with port forwarding,\nwhat if I have two web servers?\n\n16\n00:00:51.100 --> 00:00:54.010\nI can't forward port 80 to\ntwo different servers, right?\n\n17\n00:00:54.010 --> 00:00:55.110\nThat doesn't work.\n\n18\n00:00:55.110 --> 00:00:59.247\nBut if I have more than one public IP,\nI can map those to more than one server on\n\n19\n00:00:59.247 --> 00:01:03.129\nmy network, and have my servers with\nprivate internal addresses, but\n\n20\n00:01:03.129 --> 00:01:05.604\nthen they function as if\nthey had a public IP.\n\n21\n00:01:05.604 --> 00:01:09.020\nAnd the other thing is\nbecause one to one mappings,\n\n22\n00:01:09.020 --> 00:01:12.770\nthe translation is what's called true NAT.\n\n23\n00:01:12.770 --> 00:01:17.240\nMost people, what they think of as NAT is\nactually PAT, Port Address Translation.\n\n24\n00:01:17.240 --> 00:01:22.620\nIf you're sharing an IP with somebody else\nand you both go to use the same port,\n\n25\n00:01:22.620 --> 00:01:25.700\nPAT, or Port Address Translation,\nwill actually change your port number.\n\n26\n00:01:25.700 --> 00:01:26.850\nWell, if you're running a server,\n\n27\n00:01:26.850 --> 00:01:28.590\nespecially a server that\ndoes any kind of encryption,\n\n28\n00:01:28.590 --> 00:01:30.930\nyou do not wanna change\nthose port numbers.\n\n29\n00:01:30.930 --> 00:01:33.350\nWith static NAT,\nyou don't change port numbers.\n\n30\n00:01:33.350 --> 00:01:36.340\nYou're the only one using it, so\nthere are no duplicate ports.\n\n31\n00:01:36.340 --> 00:01:42.050\nAnd so, you get the advantage of having\ndedicated port numbers and a dedicated IP.\n\n32\n00:01:42.050 --> 00:01:45.290\nNow, this is not necessarily\na substitute for having a DMZ.\n\n33\n00:01:45.290 --> 00:01:47.140\nIf you have a DMZ, and\nyou move your server there,\n\n34\n00:01:47.140 --> 00:01:49.750\nyou can give your server that\npublic IP and off it went.\n\n35\n00:01:49.750 --> 00:01:51.770\nBut if you want your servers\nto have private IPs,\n\n36\n00:01:51.770 --> 00:01:57.680\nusually for routing purposes, then static,\none-to-one net mappings are the way to go.\n\n37\n00:01:57.680 --> 00:01:59.020\nLet me show you an example.\n\n38\n00:01:59.020 --> 00:02:02.480\nSo I've got a pfSense firewall\nset up here, and in pfSense,\n\n39\n00:02:02.480 --> 00:02:06.830\nwhen you do a default install,\nit's gonna set up dynamic NAT.\n\n40\n00:02:06.830 --> 00:02:12.090\nSo if I go up here to Firewall and NAT,\nand I look at the rules that are created,\n\n41\n00:02:12.090 --> 00:02:15.190\nIf I go to outbound,\nthere's just one generic rule.\n\n42\n00:02:15.190 --> 00:02:18.100\nWell, there's really two for\nIPsec, but one rule that counts,\n\n43\n00:02:18.100 --> 00:02:22.000\nthat says anybody on the inside network,\nif they go out to the Internet,\n\n44\n00:02:22.000 --> 00:02:26.260\nthey're gonna get translated into\nwhatever IP address the firewall has.\n\n45\n00:02:26.260 --> 00:02:28.192\nThey're gonna share that one IP.\n\n46\n00:02:28.192 --> 00:02:31.250\nAnd that's not great for a server.\n\n47\n00:02:31.250 --> 00:02:35.710\nSo if I want a server to have\na dedicated public IP, I can do that.\n\n48\n00:02:35.710 --> 00:02:38.510\nI can come in here and\nI can go one-to-one map.\n\n49\n00:02:38.510 --> 00:02:41.190\nStep one, I need to go and get that IP.\n\n50\n00:02:41.190 --> 00:02:43.070\nSo I need to go to my\nInternet Service Provider or\n\n51\n00:02:43.070 --> 00:02:46.890\nwhoever and purchase the IP or\nlease it or whatever it is.\n\n52\n00:02:46.890 --> 00:02:48.920\nMaybe I've already got it,\nmaybe I've got a pool of 30 IP's,\n\n53\n00:02:48.920 --> 00:02:52.100\nand I just want to assign one to a server.\n\n54\n00:02:52.100 --> 00:02:53.930\nSo I need to get that IP.\n\n55\n00:02:53.930 --> 00:02:59.420\nStep two, we need to tell\nthe firewall that it has that IP.\n\n56\n00:02:59.420 --> 00:03:00.280\nOn your firewall,\n\n57\n00:03:00.280 --> 00:03:03.420\nthey only IP's that it knows about\nis the ones it has interfaces on.\n\n58\n00:03:03.420 --> 00:03:06.000\nIf I'm getting a new IP for\na pool like this, for\n\n59\n00:03:06.000 --> 00:03:08.600\na one-to-one mapping,\nthe firewall doesn't know about it yet.\n\n60\n00:03:08.600 --> 00:03:09.137\nSo I need to tell it.\n\n61\n00:03:09.137 --> 00:03:13.450\nAnd the way we tell it is\nby defining a virtual IP.\n\n62\n00:03:13.450 --> 00:03:15.070\nIf you go to your Firewall menu up top,\n\n63\n00:03:15.070 --> 00:03:17.960\nyou'll see Virtual IPs\nright there at the bottom.\n\n64\n00:03:17.960 --> 00:03:20.250\nAnd we can define that virtual IP.\n\n65\n00:03:20.250 --> 00:03:23.840\nSo I go to my ISP and I say hey,\nI need a static IP for this server, and\n\n66\n00:03:23.840 --> 00:03:25.280\nthey give me the IP.\n\n67\n00:03:25.280 --> 00:03:27.800\nSo I'm gonna come in here and\nI'm gonna fill it out.\n\n68\n00:03:27.800 --> 00:03:29.820\nWe're gonna tell it that it's an IP alias.\n\n69\n00:03:29.820 --> 00:03:32.380\nIn other words, it's not an actual IP\naddress for the firewall, it's just\n\n70\n00:03:32.380 --> 00:03:35.410\nan alias that's gonna sit around, and\nwe'll assign it to somebody else.\n\n71\n00:03:36.650 --> 00:03:42.885\nThen we'll tell it the IP, and\nlet's say mine is 209.251.159.181.\n\n72\n00:03:42.885 --> 00:03:46.340\nSo that's the IP that I've been assigned.\n\n73\n00:03:46.340 --> 00:03:49.260\nAnd I'm just gonna do a /32,\nit's a single IP.\n\n74\n00:03:49.260 --> 00:03:52.330\nSo /32 ties us to that.\n\n75\n00:03:52.330 --> 00:03:54.497\nAnd I don't really have to\nset much else in here, but\n\n76\n00:03:54.497 --> 00:03:57.081\nI might give it a description,\nso I can remember what this is.\n\n77\n00:03:57.081 --> 00:04:03.200\nThis might be my external DP laptop.\n\n78\n00:04:03.200 --> 00:04:07.380\nSo I'm gonna map an IP to my laptop,\nso my laptop always get the same IP.\n\n79\n00:04:07.380 --> 00:04:11.950\nI'm calling it EXT_DPLAPTOP, so\nI can remember this is the external IP.\n\n80\n00:04:11.950 --> 00:04:15.540\nMy laptop's got an internal IP\nalso that I want to remember.\n\n81\n00:04:15.540 --> 00:04:18.760\nAnd this is a place where\naliases really do come in handy.\n\n82\n00:04:18.760 --> 00:04:23.110\nI'm gonna save that, and\nwe'll apply that change.\n\n83\n00:04:23.110 --> 00:04:25.790\nNow, my firewall knows that\nIP address exists, and\n\n84\n00:04:25.790 --> 00:04:28.170\nthat the firewall might be\nreceiving traffic for it.\n\n85\n00:04:28.170 --> 00:04:32.480\nI'm gonna go up to firewall and\naliases, and then aliases,\n\n86\n00:04:32.480 --> 00:04:36.580\nnotice that there's no alias created,\nwe told it that it was a virtual IP, and\n\n87\n00:04:36.580 --> 00:04:41.510\nthat it was IP alias, that's not the same\nthing, as a name alias, like we see here.\n\n88\n00:04:41.510 --> 00:04:44.320\nSo I'm gonna come back in,\nand just add these in.\n\n89\n00:04:44.320 --> 00:04:50.037\nFor the IP, I want one called\nEXT_DPLAPTOP, and it's gonna be a host,\n\n90\n00:04:50.037 --> 00:04:54.749\nand you'll see you can do host,\nnetworks, URLs and so on.\n\n91\n00:04:54.749 --> 00:04:57.020\nI'm just doing a host.\n\n92\n00:04:57.020 --> 00:05:00.554\nAnd I'm gonna add in that IP that\nI just punched in a second ago.\n\n93\n00:05:02.791 --> 00:05:05.798\nAnd what did I, I picked 181.\n\n94\n00:05:05.798 --> 00:05:07.240\nSo there we go.\n\n95\n00:05:07.240 --> 00:05:10.090\nSo we're gonna add that one in, so\nI've got an alias for my external IP, and\n\n96\n00:05:10.090 --> 00:05:13.230\nthen I'm gonna add another alias for\nmy internal IP.\n\n97\n00:05:13.230 --> 00:05:20.150\nSo whatever IP address that laptop had, so\nI'll call this INT for internal, DPLAPTOP.\n\n98\n00:05:20.150 --> 00:05:22.341\nIt'll be a host, and\nI'll need to punch in my IP.\n\n99\n00:05:22.341 --> 00:05:25.777\nNow, I don't remember my IP, so\nwe'll go and find that out real quick.\n\n100\n00:05:25.777 --> 00:05:31.560\nAnd my IP is, survey says, .100.\n\n101\n00:05:31.560 --> 00:05:34.230\nNow, I'm using DHCP, and\nthat's not a great idea.\n\n102\n00:05:34.230 --> 00:05:36.980\nIf I'm doing a static NAT Mapping and\nmy IP changes,\n\n103\n00:05:36.980 --> 00:05:38.810\nwhat's gonna happen to the mapping?\n\n104\n00:05:39.820 --> 00:05:40.720\nNot gonna work.\n\n105\n00:05:40.720 --> 00:05:43.500\nSo we probably want to do\na DHCP reservation, so\n\n106\n00:05:43.500 --> 00:05:46.780\nI've always got this IP, or\nchange my system over to a static IP.\n\n107\n00:05:46.780 --> 00:05:48.850\nThat's kind of a cautionary tale there.\n\n108\n00:05:48.850 --> 00:05:50.232\nBut, I'll punch this one in right now.\n\n109\n00:05:50.232 --> 00:05:53.410\nThat's 192.162.100.\n\n110\n00:05:53.410 --> 00:05:55.010\nThat's my host.\n\n111\n00:05:55.010 --> 00:05:57.600\nAnd now I've got some nice little\nnamed aliases that I can use for\n\n112\n00:05:57.600 --> 00:05:58.540\nthis mapping that I'm gonna do.\n\n113\n00:05:59.780 --> 00:06:02.290\nI've got an internal and an external\nIP that's gonna be for my laptop.\n\n114\n00:06:02.290 --> 00:06:05.260\nNow, the aliases themselves\ndon't actually do anything.\n\n115\n00:06:05.260 --> 00:06:07.190\nThey just sit there and look pretty.\n\n116\n00:06:07.190 --> 00:06:08.800\nI need to put the NAT mapping in.\n\n117\n00:06:09.930 --> 00:06:14.220\nIf I go up to the firewall and NAT,\nyou'll see that we've got several tabs.\n\n118\n00:06:14.220 --> 00:06:17.560\nThe one I showed you where the default\nrule was, that was under outbound.\n\n119\n00:06:17.560 --> 00:06:19.900\nThat's just outbound NAT,\nthat's dynamic NAT.\n\n120\n00:06:19.900 --> 00:06:22.850\nPeople grab whatever IP is\navailable to them as they move out.\n\n121\n00:06:22.850 --> 00:06:25.590\nBut I wanna do one-to-one mapping.\n\n122\n00:06:25.590 --> 00:06:30.060\nI want to tie an IP to an internal host,\nso\n\n123\n00:06:30.060 --> 00:06:33.560\nthat they are just connected,\nand that's that.\n\n124\n00:06:33.560 --> 00:06:36.420\nSo when I come in here and\nlook at it, I don't have any default.\n\n125\n00:06:36.420 --> 00:06:38.230\nThere are no default mappings here.\n\n126\n00:06:38.230 --> 00:06:40.660\nSo I'm gonna create my rule here,\nI'm just gonna hit my plus sign there, and\n\n127\n00:06:40.660 --> 00:06:41.870\nwe'll create it.\n\n128\n00:06:41.870 --> 00:06:44.970\nWe've got our standard options, kind of\nwhat we'd see with the firewall rule where\n\n129\n00:06:44.970 --> 00:06:48.200\nyou've got disable this rule,\nif we want to temporarily turn it off.\n\n130\n00:06:48.200 --> 00:06:49.614\nWe've got the interface\nthis is gonna operate on.\n\n131\n00:06:49.614 --> 00:06:53.207\nIt's normally gonna be the LAN interface,\nwe got internet traffic coming in,\n\n132\n00:06:53.207 --> 00:06:56.730\nwe're mapping that to somebody\non the inside network.\n\n133\n00:06:56.730 --> 00:06:59.780\nNext, it's asking for the IP address\nthat we're gonna be mapping.\n\n134\n00:06:59.780 --> 00:07:03.410\nThis is a one-to-one mapping,\nso it needs a single IP.\n\n135\n00:07:03.410 --> 00:07:09.857\nSo I'll punch that in, and\nI'm gonna be mapping to 209.251.159.181.\n\n136\n00:07:09.857 --> 00:07:13.735\nNow, a common mistake that I make\nis to put the subnet mask in here.\n\n137\n00:07:13.735 --> 00:07:15.789\nEither a /32 or /28.\n\n138\n00:07:15.789 --> 00:07:19.632\nOr whatever it is that you're using,\nbut it's got this little note here,\n\n139\n00:07:19.632 --> 00:07:20.670\nsomewhere in here,\n\n140\n00:07:20.670 --> 00:07:25.115\nthe subnet mask from the internal address\nbelow will be applied to this address.\n\n141\n00:07:25.115 --> 00:07:27.645\nSo if you punch in the subnet mak there,\nyou'll get an error and\n\n142\n00:07:27.645 --> 00:07:28.695\nwont be happy about that.\n\n143\n00:07:29.790 --> 00:07:31.250\nThen it's asking for the internal IP.\n\n144\n00:07:31.250 --> 00:07:36.018\nWell, the internal IP of\nmy laptop is 192.168.0.100.\n\n145\n00:07:36.018 --> 00:07:41.630\nNow, in both of those fields,\nI wasn't able to use the alias.\n\n146\n00:07:41.630 --> 00:07:44.437\nRonnie showed us in an earlier\nsegment how if these fields were red,\n\n147\n00:07:44.437 --> 00:07:45.976\nthey'd be ripe for taking an alias.\n\n148\n00:07:45.976 --> 00:07:48.770\nThese aren't red, so\nI've got to type them in.\n\n149\n00:07:48.770 --> 00:07:51.052\nBut those aliases I created earlier,\nare not going to waste.\n\n150\n00:07:51.052 --> 00:07:53.210\nWe're gonna use those with\nour firewall rules later.\n\n151\n00:07:53.210 --> 00:07:55.430\nBut for right now,\nI've got that punched in, so\n\n152\n00:07:55.430 --> 00:07:58.650\nit knows the external and internal IPs.\n\n153\n00:07:58.650 --> 00:08:00.960\nNow, this last field right\nhere is the destination.\n\n154\n00:08:00.960 --> 00:08:04.282\nAnd the destination is for\nour internal host going back out,\n\n155\n00:08:04.282 --> 00:08:07.030\nit would basically be like\nthe source of traffic.\n\n156\n00:08:07.030 --> 00:08:10.900\nIf we have to look at this both ways,\nbecause NAT is bi-directional.\n\n157\n00:08:10.900 --> 00:08:14.550\nSo if we need to NAT that destination,\nwe can provide that here.\n\n158\n00:08:14.550 --> 00:08:15.930\nThat's really, really rare.\n\n159\n00:08:15.930 --> 00:08:17.480\nWe don't normally need to do that.\n\n160\n00:08:17.480 --> 00:08:18.188\nSo I'm gonna leave that set to any.\n\n161\n00:08:18.188 --> 00:08:22.670\nWhatever they come in as is what we'll\ngo back out as for the destination.\n\n162\n00:08:22.670 --> 00:08:25.300\nWe assume the other person\nis on a public IP already.\n\n163\n00:08:25.300 --> 00:08:26.920\nWe're not gonna NAT for them.\n\n164\n00:08:26.920 --> 00:08:28.990\nIf we turn this on,\nwe'd be doing what's called reverse NAT,\n\n165\n00:08:28.990 --> 00:08:31.820\nwhere we NAT somebody\ncoming into our network.\n\n166\n00:08:31.820 --> 00:08:35.590\nAnd the only real scenario I can think of\nfor doing that is, maybe you're doing work\n\n167\n00:08:35.590 --> 00:08:38.470\nwith a partner, and you're creating\na connection to their network.\n\n168\n00:08:38.470 --> 00:08:41.710\nAnd they're overlapping some\nof the IP ranges that you use.\n\n169\n00:08:41.710 --> 00:08:44.576\nSo you might want to NAT them coming into\nyour network to avoid an IP conflict.\n\n170\n00:08:44.576 --> 00:08:47.723\nIt's really not something ideal or common.\n\n171\n00:08:47.723 --> 00:08:50.970\nAnd then, I can give it a description.\n\n172\n00:08:50.970 --> 00:08:56.020\nI'll just call this one\nmy DPLAPTOP Static NAT.\n\n173\n00:08:56.020 --> 00:08:59.060\nNAT reflection is set to\nuse the system default,\n\n174\n00:08:59.060 --> 00:09:01.560\nthat means that it's gonna\ndefault to bi-directional.\n\n175\n00:09:01.560 --> 00:09:05.010\nSo if somebody from the outside\ntries to get to the public IP,\n\n176\n00:09:05.010 --> 00:09:07.480\nit'll map them to my internal IP.\n\n177\n00:09:07.480 --> 00:09:10.600\nAnd if my client from the inside\ntries to go out to the Internet,\n\n178\n00:09:10.600 --> 00:09:13.610\nIt'll map me from my private\nIP to the public IP.\n\n179\n00:09:13.610 --> 00:09:15.200\nI want it to be both directions.\n\n180\n00:09:15.200 --> 00:09:17.060\nBut you can manipulate that if you want.\n\n181\n00:09:17.060 --> 00:09:20.573\nWe can disable that reflection, and\nnow it's only gonna be one way, but\n\n182\n00:09:20.573 --> 00:09:22.077\nnormally we don't want that.\n\n183\n00:09:22.077 --> 00:09:26.150\nWe'll go ahead and save that, and\nnow I've got that rule in place.\n\n184\n00:09:26.150 --> 00:09:32.190\nI can see that on the WAN interface, this\nexternal IP is tied to this internal IP.\n\n185\n00:09:32.190 --> 00:09:35.520\nAnd I'll apply that, and\nnow I've got my mapping.\n\n186\n00:09:35.520 --> 00:09:39.280\nNow, the mapping takes effect right away.\n\n187\n00:09:39.280 --> 00:09:41.170\nIf my client starts going\nout to the internet,\n\n188\n00:09:41.170 --> 00:09:43.490\nthey should be going out on that IP.\n\n189\n00:09:44.660 --> 00:09:50.460\nIf I try and go from somebody on the\noutside in it's probably not gonna work.\n\n190\n00:09:50.460 --> 00:09:52.010\nNow, why isn't it gonna work?\n\n191\n00:09:52.010 --> 00:09:53.750\nWe need firewall rules.\n\n192\n00:09:53.750 --> 00:09:56.470\nYou still have your firewall\nrules that come into play.\n\n193\n00:09:56.470 --> 00:09:58.370\nIf I go into my Rules, and\n\n194\n00:09:58.370 --> 00:10:02.340\nI got to my WAN interface,\noutside traffic is not allowed in.\n\n195\n00:10:02.340 --> 00:10:06.670\nSo be aware when you do static NAT mapping\nlike this, you've gotta come back and\n\n196\n00:10:06.670 --> 00:10:07.870\ndo your firewall rules also.\n\n197\n00:10:07.870 --> 00:10:11.410\nYou'd need to add a rule saying,\nI'm gonna allow this network\n\n198\n00:10:11.410 --> 00:10:16.690\nto be able to access this IP, which then\nis getting translated on the inside.\n\n199\n00:10:16.690 --> 00:10:21.180\nNow, the firewall rules are actually\napplied after NAT applies, so when you\n\n200\n00:10:21.180 --> 00:10:25.430\ncreate these rules, you gotta point them\nto the internal IP, not the external IP.\n\n201\n00:10:25.430 --> 00:10:29.278\nThat's a little confusing, but you'll get\nthat put in place to allow that traffic.\n\n202\n00:10:29.278 --> 00:10:32.820\nBut our NAT rule's actually\nworking right now from the inside.\n\n203\n00:10:32.820 --> 00:10:36.850\nIf I fire up a web browser and\nbrowse to a server that's hosting\n\n204\n00:10:36.850 --> 00:10:39.830\nwith a web page formula will tell\nme what IP I'm coming from, and\n\n205\n00:10:39.830 --> 00:10:44.725\nsee how it says I'm coming\nfrom 209.251.159.181,\n\n206\n00:10:44.725 --> 00:10:49.710\nmy work station is now\nstatically mapped to 181, and\n\n207\n00:10:49.710 --> 00:10:52.750\nI'm not sharing that with anybody else,\nit's a one-to-one mapping,\n\n208\n00:10:52.750 --> 00:10:57.250\nmy work station has that IP, I don't have\nto do any port translation or whatever.\n\n209\n00:10:57.250 --> 00:11:02.940\nAny traffic that comes to the firewall,\ndestined for port 181, it gets translated.\n\n210\n00:11:02.940 --> 00:11:05.760\nNow, it's destined for\n192 out 168 to zero 100.\n\n211\n00:11:05.760 --> 00:11:08.535\nAs long as there's\na firewall rule allowing it,\n\n212\n00:11:08.535 --> 00:11:11.770\nit will allow it to flow through,\nand hit my client.\n\n213\n00:11:11.770 --> 00:11:16.000\nIt's really a great way to\nhandle servers with private IPs.\n\n214\n00:11:16.000 --> 00:11:21.120\nOr if you want to have a work station with\ncrazy access to the internet be careful\n\n215\n00:11:21.120 --> 00:11:27.445\nto secure things, but we want to make\nsure that we've got that protected.\n\n216\n00:11:27.445 --> 00:11:29.830\nOne-to-one mappings, really not that hard.\n\n217\n00:11:29.830 --> 00:11:31.500\nThe two steps we gotta remember.\n\n218\n00:11:31.500 --> 00:11:32.451\nOne, we gotta create a virtual IP.\n\n219\n00:11:32.451 --> 00:11:39.560\nAnd then two, we've got to go and\ncreate the actual NAT one-to-one mapping.\n\n220\n00:11:39.560 --> 00:11:41.860\nSo we went in here and we created that.\n\n221\n00:11:41.860 --> 00:11:44.710\nNumber three, if we wanna add a third set,\nwould be those firewall rules.\n\n222\n00:11:44.710 --> 00:11:48.510\nAnd that's where I would jump out to\nmy firewall, and on my WAN interface,\n\n223\n00:11:48.510 --> 00:11:51.270\nI would add the access that\nI want people to have.\n\n224\n00:11:51.270 --> 00:11:54.060\nSo here's where I can really start to\ntake advantage of those aliases, so\n\n225\n00:11:54.060 --> 00:11:55.320\nI can pass traffic.\n\n226\n00:11:55.320 --> 00:11:58.710\nMaybe I want to allow remote desktops,\nso people can remote in to the server,\n\n227\n00:11:58.710 --> 00:12:00.800\nin to my, well, work station I guess.\n\n228\n00:12:00.800 --> 00:12:05.880\nSo I can do TCP, we'll do any source,\nand for the destination\n\n229\n00:12:05.880 --> 00:12:11.520\nhere's where I'm gonna say, the\ndestination is that internal DP laptop.\n\n230\n00:12:11.520 --> 00:12:13.090\nThat's where people are going.\n\n231\n00:12:13.090 --> 00:12:18.940\nAnd the protocol for me is gonna be the\nMicrosoft remote desktop, there we go, and\n\n232\n00:12:18.940 --> 00:12:24.300\nI'll save that rule in place, and we'll\napply it, and now, I've got that access.\n\n233\n00:12:24.300 --> 00:12:28.730\nSomebody on the outside trying to\naccess my laptop on the internal IP,\n\n234\n00:12:28.730 --> 00:12:31.840\nbecause NAT has already happened\nby the time this rule applies,\n\n235\n00:12:31.840 --> 00:12:34.430\nthen it'll send them along,\nand let them remote in.\n\n236\n00:12:34.430 --> 00:12:36.561\nThat's that next step that\nreally makes that useful.\n\n237\n00:12:36.561 --> 00:12:42.540\n[BLANK AUDIO] But, in a nutshell,\nthat's basically one-to-one net mappings.\n\n238\n00:12:42.540 --> 00:12:43.416\nRonnie, can you think\nof anything I left out?\n\n239\n00:12:43.416 --> 00:12:45.550\n>> Not on one-to-one net mappings.\n\n240\n00:12:45.550 --> 00:12:49.739\nThese are very useful, especially remember\nwhen you do have internal hosts that you\n\n241\n00:12:49.739 --> 00:12:53.338\nreally don't have a DMZ for to be able\nto provide that public IP address,\n\n242\n00:12:53.338 --> 00:12:55.587\nthat's probably the way we're gonna do it.\n\n243\n00:12:55.587 --> 00:12:59.188\n>> Now, one thing to remember is\nthat with one-to-one NAT mappings,\n\n244\n00:12:59.188 --> 00:13:03.060\nyou are expected to be bonding one\nIP to one host, it's not shared.\n\n245\n00:13:03.060 --> 00:13:05.890\nSo what if you only have one IP.\n\n246\n00:13:05.890 --> 00:13:10.390\nYour ISP gives you one single IP\naddress on your cable modem or DSL.\n\n247\n00:13:10.390 --> 00:13:12.790\nWell, you're not gonna be able\nto do one-to-one NAT mapping.\n\n248\n00:13:12.790 --> 00:13:16.970\nInstead, you're left with something\nelse like port forwarding.\n\n249\n00:13:16.970 --> 00:13:20.310\nTo be able to have one IP that then points\nat different resources to hosts that\n\n250\n00:13:20.310 --> 00:13:21.250\nare internal.\n\n251\n00:13:21.250 --> 00:13:24.000\nSo we're gonna take a look\nat that in our next segment.\n\n252\n00:13:24.000 --> 00:13:25.160\nStay tuned for that one.\n\n253\n00:13:25.160 --> 00:13:27.940\nBut as far as one-to-one static\nmappings go, we've seen it,\n\n254\n00:13:27.940 --> 00:13:29.440\nwe've done it, it's time to move on.\n\n255\n00:13:29.440 --> 00:13:31.020\nSo I hope you guys enjoyed that.\n\n256\n00:13:31.020 --> 00:13:33.319\nStay tuned,\nwe've got more pfSense content coming up.\n\n257\n00:13:33.319 --> 00:13:40.059\n[MUSIC]\n\n",
          "vimeoId": "130429948"
        },
        {
          "description": null,
          "length": "933",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-3-port_forwarding-061015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-3-port_forwarding-061015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-3-3-port_forwarding-061015-1-sm.jpg",
          "title": "Port Forwarding",
          "transcript": "WEBVTT\n\n1\n00:00:00.594 --> 00:00:07.675\n[MUSIC]\n\n2\n00:00:07.675 --> 00:00:12.160\nIn this segment, we're gonna take a look\nat port forwarding inside of pfSense.\n\n3\n00:00:12.160 --> 00:00:15.880\nNow, for home users and small businesses,\nthis is probably the most\n\n4\n00:00:15.880 --> 00:00:19.770\ncommon instance of needing to go in and\nmodify NAT inside of pfSense.\n\n5\n00:00:19.770 --> 00:00:22.940\nWe've all ready recorded segments\ncovering things like dynamic NAT,\n\n6\n00:00:22.940 --> 00:00:24.840\nwhich is used in large organizations.\n\n7\n00:00:24.840 --> 00:00:27.600\nWe covered one to one static NAT mappings,\nwhich are used for\n\n8\n00:00:27.600 --> 00:00:30.590\nservers typically in medium and\nlarge businesses.\n\n9\n00:00:30.590 --> 00:00:35.250\nBut, for small businesses we\ntypically only have one IP address.\n\n10\n00:00:35.250 --> 00:00:38.400\nYour Internet service provider gives\nyou a single IP and that's it.\n\n11\n00:00:38.400 --> 00:00:42.040\nSo, these technologies that use pools or\ndedicated IP's.\n\n12\n00:00:42.040 --> 00:00:44.400\nThose aren't really\navailable to most of us.\n\n13\n00:00:44.400 --> 00:00:48.490\nSo, if you're just trying to make some\ninternal resource on your network\n\n14\n00:00:48.490 --> 00:00:51.470\navailable to the Internet, port forwarding\nis typically the way to do that.\n\n15\n00:00:51.470 --> 00:00:54.060\nNow, if you're not familiar\nwith port forwarding,\n\n16\n00:00:54.060 --> 00:00:57.580\nlet me kinda give you an example\nof what I mean, all right?\n\n17\n00:00:57.580 --> 00:01:00.192\nHere I've got just a real\nbasic network topology.\n\n18\n00:01:00.192 --> 00:01:03.814\nAnd let's say on my internal network,\nI've got a laptop.\n\n19\n00:01:03.814 --> 00:01:05.440\nActually here, let's look at it this way.\n\n20\n00:01:05.440 --> 00:01:06.014\nHere we go.\n\n21\n00:01:06.014 --> 00:01:09.833\nI've got a firewall and\non my internal network, I have my laptop.\n\n22\n00:01:09.833 --> 00:01:13.351\nAnd my laptop is 192.168.0.100.\n\n23\n00:01:13.351 --> 00:01:19.590\nAnd I want to allow people outside to be\nable to remote desktop into my laptop.\n\n24\n00:01:19.590 --> 00:01:23.135\nSo if I'm out at a hotel or conference or\nwhatever, I'd probably have\n\n25\n00:01:23.135 --> 00:01:26.979\nmy laptop with me, but if I forgot it,\nI want to be able to remote desktop into\n\n26\n00:01:26.979 --> 00:01:30.494\nmy computer at home and access it and\nwork on that system, all right?\n\n27\n00:01:30.494 --> 00:01:33.757\nWell, my firewall has a public IP and\n\n28\n00:01:33.757 --> 00:01:38.612\nthat public IP is 209.251.159.184.\n\n29\n00:01:38.612 --> 00:01:42.290\nAnd people on the Internet\ncan get to that 184 address.\n\n30\n00:01:42.290 --> 00:01:45.430\nBut then the firewall chooses what to\nlet in and what not to, and by default,\n\n31\n00:01:45.430 --> 00:01:46.980\nit doesn't let anything in, right?\n\n32\n00:01:46.980 --> 00:01:50.210\nUnless it's a reply to\nsomething we asked for.\n\n33\n00:01:50.210 --> 00:01:54.820\nWell, what I'm wanting, is I wanna allow\ntraffic from the outside to come in,\n\n34\n00:01:54.820 --> 00:01:56.490\neven if we didn't ask for it.\n\n35\n00:01:56.490 --> 00:02:00.040\nI want somebody on the outside to be\nable to fire up a remote desktop, and\n\n36\n00:02:00.040 --> 00:02:02.790\npass through my firewall to access\nthat host even though the host didn't\n\n37\n00:02:02.790 --> 00:02:04.250\ninitiate the connection.\n\n38\n00:02:04.250 --> 00:02:07.310\nThat's not something\nthe firewall normally does.\n\n39\n00:02:07.310 --> 00:02:09.864\nBut, with port forwarding,\nwe can tell it to do that.\n\n40\n00:02:09.864 --> 00:02:12.801\nMicrosoft's remote desktop\nruns on port 3389.\n\n41\n00:02:12.801 --> 00:02:17.605\nI can tell the firewall,\nany time it receives traffic on port 3389,\n\n42\n00:02:17.605 --> 00:02:22.750\ngo ahead and do a NAT translation,\nand send that to my laptop, right?\n\n43\n00:02:22.750 --> 00:02:25.970\nEffectively exposing my laptop to\nthe Internet for that one port.\n\n44\n00:02:25.970 --> 00:02:29.600\nThe other cool part is I can grab other\nports and point them different places.\n\n45\n00:02:29.600 --> 00:02:34.220\nMaybe I have a Plex server or\na web server, a FTP server,\n\n46\n00:02:34.220 --> 00:02:36.680\nwhatever, and\nthey're different machines on my network,\n\n47\n00:02:36.680 --> 00:02:39.590\nI can send those ports to\nthe different servers.\n\n48\n00:02:39.590 --> 00:02:41.580\nThe only thing you can't\ndo is share one port.\n\n49\n00:02:41.580 --> 00:02:45.240\nIf I have two web servers, I can't\nsend port 80 to two different places.\n\n50\n00:02:45.240 --> 00:02:47.710\nI have to send port 80 to one or\nthe other.\n\n51\n00:02:47.710 --> 00:02:51.000\nSo we define that right here\nwhere we want those ports to be.\n\n52\n00:02:51.000 --> 00:02:52.850\nSo that's what we're goinna\nlook at in this episode,\n\n53\n00:02:52.850 --> 00:02:55.130\nport forwarding with pfSense.\n\n54\n00:02:55.130 --> 00:02:57.720\nNow, Ronnie,\nI know you work with Cisco ASA's a lot,\n\n55\n00:02:57.720 --> 00:02:59.730\nhave you ever configured\nport forwarding on an ASA?\n\n56\n00:02:59.730 --> 00:03:02.480\n>> I have never configured\nport forwarding on an ASA.\n\n57\n00:03:02.480 --> 00:03:05.970\n>> On most commercial firewalls,\nthey don't support it.\n\n58\n00:03:05.970 --> 00:03:08.870\nCisco ASAs don't have\na port forward option.\n\n59\n00:03:08.870 --> 00:03:10.110\nThere's ways to make it work.\n\n60\n00:03:10.110 --> 00:03:11.100\nI've done it.\n\n61\n00:03:11.100 --> 00:03:13.140\nIt's kind of a kludge, it's not very easy.\n\n62\n00:03:13.140 --> 00:03:15.360\nOn pfSense,\nthey actually make it pretty easy.\n\n63\n00:03:15.360 --> 00:03:18.750\nThey say look, we know this isn't great\nfor medium and large businesses, but\n\n64\n00:03:18.750 --> 00:03:21.390\nwe know a lot of different\npeople use pfSense, so\n\n65\n00:03:21.390 --> 00:03:23.710\nthey've taken the time to make it easy for\nus, all right?\n\n66\n00:03:23.710 --> 00:03:25.510\nLet me show you what I'm talking about.\n\n67\n00:03:25.510 --> 00:03:28.906\nWhen we wanna configure port forwarding,\n\n68\n00:03:28.906 --> 00:03:34.296\nbasically what we need to do is just\ncome up here to Firewall and NAT.\n\n69\n00:03:34.296 --> 00:03:38.143\nAnd in our NAT rules, you'll actually\nsee a tab labeled Port Forward, and\n\n70\n00:03:38.143 --> 00:03:41.390\nthere's no port forwarded by default,\nwe need to put them in.\n\n71\n00:03:41.390 --> 00:03:44.603\nAnd when we put them in, you just specify\nthe ports, based on the source and\n\n72\n00:03:44.603 --> 00:03:47.000\nthe destination, and\nwhere we're gonna send them to,\n\n73\n00:03:47.000 --> 00:03:49.305\nit's really pretty straightforward.\n\n74\n00:03:49.305 --> 00:03:51.745\nWith the other types of NAT we did,\nlike outbound, and\n\n75\n00:03:51.745 --> 00:03:55.810\none to one, we had to deal with things\nlike virtual IPs, here we don't.\n\n76\n00:03:55.810 --> 00:03:59.874\nBecause we're just gonna be redirecting\nthe port off of the firewall's own WAN\n\n77\n00:03:59.874 --> 00:04:00.790\ninterface port.\n\n78\n00:04:00.790 --> 00:04:02.030\nSo it already knows about the IP,\n\n79\n00:04:02.030 --> 00:04:05.940\nand this really couldn't be, well I guess\nit could be easier but it's pretty simple.\n\n80\n00:04:07.320 --> 00:04:08.550\nAll right I'm gonna add a rule in here.\n\n81\n00:04:08.550 --> 00:04:11.360\nAnd we'll see some of the same\noptions we've been seeing.\n\n82\n00:04:11.360 --> 00:04:14.560\nWe've got disable the rule,\nif we need to temporarily turn it off.\n\n83\n00:04:14.560 --> 00:04:18.890\nWe've got no RDR, and what this is\nbasically doing is putting an exclusion\n\n84\n00:04:18.890 --> 00:04:23.430\nin, saying like redirect your ports\nexcept if it's one of these, right?\n\n85\n00:04:23.430 --> 00:04:24.873\nIt's like a inverse rule,\n\n86\n00:04:24.873 --> 00:04:28.490\nif we wanna redirect everything\nexcept the certain range of ports.\n\n87\n00:04:28.490 --> 00:04:30.120\nWe don't normally need that.\n\n88\n00:04:30.120 --> 00:04:32.850\nThen we say the interface the traffic's\ngonna be passing through.\n\n89\n00:04:32.850 --> 00:04:34.210\nThis is normally gonna be your WAN or\n\n90\n00:04:34.210 --> 00:04:36.940\nyour Internet interface,\nwhatever you've called it.\n\n91\n00:04:36.940 --> 00:04:41.620\nFrom there we can start to pick our\nprotocols, now normally it's gonna be TCP.\n\n92\n00:04:41.620 --> 00:04:45.830\nThere's a lot of other protocols in here\nbut it's almost always gonna be TCP.\n\n93\n00:04:45.830 --> 00:04:46.930\nAnd why is that?\n\n94\n00:04:46.930 --> 00:04:49.733\nWell, UDP is sessionless.\n\n95\n00:04:49.733 --> 00:04:52.958\nAnd so UDP is very hard to determine\nwhether something's in a session or not,\n\n96\n00:04:52.958 --> 00:04:56.495\nand send it to the right place, and so we\ndon't normally do port forwarding on that.\n\n97\n00:04:56.495 --> 00:04:59.910\nBut you can, if you're running FTP or\nwhatever, you can do that.\n\n98\n00:04:59.910 --> 00:05:04.760\nBut a lot of protocols use randomized\nUDP ports, FTP is a great example, and\n\n99\n00:05:04.760 --> 00:05:06.620\nso it becomes very difficult to do that.\n\n100\n00:05:06.620 --> 00:05:08.390\nIf you've got an internal DNS server,\n\n101\n00:05:08.390 --> 00:05:12.500\nthough, you can do port forwarding for\nUDP53, and that'll knock that out.\n\n102\n00:05:12.500 --> 00:05:15.070\nBut normally it's gonna be TCP, all right?\n\n103\n00:05:15.070 --> 00:05:19.810\nAfter that, we see the source and\nthe destination, right?\n\n104\n00:05:19.810 --> 00:05:22.000\nNow, notice how the source doesn't\nhave something I can just type in,\n\n105\n00:05:22.000 --> 00:05:26.690\nit's got a show source address and\nport range option, and it's kinda hidden.\n\n106\n00:05:26.690 --> 00:05:30.110\nAnd that's because the source\nis almost always gonna be Any.\n\n107\n00:05:30.110 --> 00:05:32.190\nWe're saying anybody out\nthere on the Internet,\n\n108\n00:05:32.190 --> 00:05:36.240\nif they send traffic to this particular\nport, we're gonna forward it along.\n\n109\n00:05:36.240 --> 00:05:37.620\nSo they hide it under Advanced.\n\n110\n00:05:37.620 --> 00:05:41.240\nIf you hit Advanced, you'll see the source\noptions and you can specify them, but\n\n111\n00:05:41.240 --> 00:05:43.560\nit is really rare that\nyou wanna do that so\n\n112\n00:05:43.560 --> 00:05:46.600\nthat's why it's hidden\nunder Advanced by default.\n\n113\n00:05:46.600 --> 00:05:49.200\nThe destination is what we\ncare about though, right?\n\n114\n00:05:49.200 --> 00:05:52.610\nIf traffic is coming to my WAN address,\nright,\n\n115\n00:05:52.610 --> 00:05:56.930\nthe address on my public interface,\nthen I want to redirect it.\n\n116\n00:05:56.930 --> 00:05:58.968\nAnd so\nthat's what I'm specifying right here and\n\n117\n00:05:58.968 --> 00:06:01.550\nit's almost always just gonna\nbe your WAN address on this one.\n\n118\n00:06:01.550 --> 00:06:04.432\nAnd the destination port range,\nthose are the ports you want to do.\n\n119\n00:06:04.432 --> 00:06:06.872\nNow, if you want to forward\nmore than one port,\n\n120\n00:06:06.872 --> 00:06:09.932\nyou can define an alias ahead\nof time that covers the ports.\n\n121\n00:06:09.932 --> 00:06:13.453\nIn my case, I just want RDP,\nwhich is TCP 3389.\n\n122\n00:06:13.453 --> 00:06:19.347\nI can drop that down here and\nfind Microsoft RDP and specify it, right?\n\n123\n00:06:19.347 --> 00:06:21.562\nNow, another cool thing you can do is,\n\n124\n00:06:21.562 --> 00:06:24.380\nwhat if I want to run\nit on a different port?\n\n125\n00:06:24.380 --> 00:06:27.370\nIf somebody does a reconnaissance\nattack on my firewall,\n\n126\n00:06:27.370 --> 00:06:31.030\nthey'll see that 3389 is open and\nthey'll know, like oh, that's RDP.\n\n127\n00:06:31.030 --> 00:06:33.080\nLet me see if I can get into that, right?\n\n128\n00:06:33.080 --> 00:06:35.990\nSo, I might look for a different source.\n\n129\n00:06:35.990 --> 00:06:40.730\nAnd I might say, instead of picking\none of these hard-coded defaults,\n\n130\n00:06:40.730 --> 00:06:42.880\nI might choose Other.\n\n131\n00:06:42.880 --> 00:06:47.103\nAnd in the Other field,\nI pick something crazy, like 60,000, okay?\n\n132\n00:06:47.103 --> 00:06:52.147\nOr we'll pick something a little less\ncrazy, we'll go 6,000, all right?\n\n133\n00:06:52.147 --> 00:06:56.520\nNow, the destination for\nthe traffic is 6,000.\n\n134\n00:06:56.520 --> 00:07:01.190\nDown here under Redirect,\nI redirect that traffic to somewhere else.\n\n135\n00:07:01.190 --> 00:07:05.240\nI can say, redirect it to my internal\nhost to, if you have an alias.\n\n136\n00:07:05.240 --> 00:07:07.680\nLike, I've got an alias for\ninternal DP laptop.\n\n137\n00:07:07.680 --> 00:07:08.960\nOr you can type the IP.\n\n138\n00:07:08.960 --> 00:07:11.870\nMine would be 192.168.0.100.\n\n139\n00:07:11.870 --> 00:07:17.980\nAnd for the redirect port,\nI can set that to MSRDP.\n\n140\n00:07:17.980 --> 00:07:21.200\nNow, traffic comes to\nthe firewall in port 6,000 and\n\n141\n00:07:21.200 --> 00:07:24.368\nit translates it to 3,389\nbefore it hits my laptop.\n\n142\n00:07:24.368 --> 00:07:27.215\nSo my laptop just sees traffic\non 3,389 like normal, but\n\n143\n00:07:27.215 --> 00:07:30.514\nsomebody running a reconnaissance\nattack just sees port 6,000.\n\n144\n00:07:30.514 --> 00:07:34.910\nNow, that is really the definition\nof security through obscurity.\n\n145\n00:07:34.910 --> 00:07:36.760\nYou're not really getting\nany security out of there,\n\n146\n00:07:36.760 --> 00:07:40.290\nyou're just kind of making them\nhave to work a little bit harder.\n\n147\n00:07:40.290 --> 00:07:45.501\nSo I'm not gonna bother with that,\nI'll just leave it as RDP, all right?\n\n148\n00:07:45.501 --> 00:07:49.978\nSo we're gonna take traffic\nthat's coming in on 3389,\n\n149\n00:07:49.978 --> 00:07:56.146\nwe're gonna redirect it to my laptop and\nit's gonna stay on 3389 right there.\n\n150\n00:07:56.146 --> 00:08:01.324\nI can give it a description, I'll just\ncall this one RDP to Don's laptop.\n\n151\n00:08:01.324 --> 00:08:03.142\nAnd then we can specify\njust a few other things,\n\n152\n00:08:03.142 --> 00:08:04.880\nlike whether we want\nNAT reflection to work.\n\n153\n00:08:04.880 --> 00:08:06.280\nDo we want this to work both ways?\n\n154\n00:08:06.280 --> 00:08:08.380\nWe normally do and that is the default.\n\n155\n00:08:08.380 --> 00:08:11.410\nAnd whether we've got a filter\nrule associated with it.\n\n156\n00:08:11.410 --> 00:08:12.622\nThis is important.\n\n157\n00:08:12.622 --> 00:08:16.280\nIf I start redirecting 3389\nto my internal machine,\n\n158\n00:08:16.280 --> 00:08:19.947\nI need a firewall rule to\nallow traffic on port 3389.\n\n159\n00:08:19.947 --> 00:08:24.185\nI'm gonna have to create it, and\nso it offers to create it for me.\n\n160\n00:08:24.185 --> 00:08:26.795\nYou could say don't and\nwe'll add it ourselves, but\n\n161\n00:08:26.795 --> 00:08:31.070\nif we leave it here as add associated\nfilter rule, then it'll put that in.\n\n162\n00:08:31.070 --> 00:08:34.350\nIf I just want to allow the traffic and\nnot have a rule, you can actually choose\n\n163\n00:08:34.350 --> 00:08:38.740\nPass as an option and it'll pass\nthe traffic without an associated rule.\n\n164\n00:08:38.740 --> 00:08:42.530\nBut that can create confusion, because now\nyou've got traffic that's allowed through\n\n165\n00:08:42.530 --> 00:08:45.190\nyour firewall that isn't in\nthe list of the firewall rules.\n\n166\n00:08:45.190 --> 00:08:46.710\nI don't personally like that option.\n\n167\n00:08:46.710 --> 00:08:50.020\nSo, I almost always just leave\nit here as Add associated rule.\n\n168\n00:08:51.980 --> 00:08:56.020\nNow when we save that, it's gonna punch\nthat in, it's gonna create the mappings.\n\n169\n00:08:56.020 --> 00:09:00.550\nSo I've got TCP on my\nWAM interface port 3389\n\n170\n00:09:00.550 --> 00:09:04.804\nis being redirected to my\ninternal laptop on port 3389.\n\n171\n00:09:05.840 --> 00:09:06.938\nAnd I'll apply that.\n\n172\n00:09:06.938 --> 00:09:08.238\nAnd that's done.\n\n173\n00:09:08.238 --> 00:09:10.746\nAnd if I jump over to my firewall rules,\n\n174\n00:09:10.746 --> 00:09:13.560\nI should see that it\ncreated a rule here too.\n\n175\n00:09:13.560 --> 00:09:18.400\nAnd sure enough, I've got that IPv4 for\nthe internal laptop on 3389.\n\n176\n00:09:18.400 --> 00:09:23.260\nNotice how it's a mapping to\nthe internal IP and not the external.\n\n177\n00:09:23.260 --> 00:09:26.940\nThe reason it does that is\nthe order this stuff applies.\n\n178\n00:09:26.940 --> 00:09:31.088\nWhen traffic reaches the firewall,\nNAT, or network translation,\n\n179\n00:09:31.088 --> 00:09:34.530\nthat actually happens before\nthe firewall rules apply.\n\n180\n00:09:34.530 --> 00:09:39.290\nSo the traffic was destined to the public\nIP on my firewall on port 3389.\n\n181\n00:09:39.290 --> 00:09:43.583\nIt was translated to the internal\nIP of my laptop on 3389 and\n\n182\n00:09:43.583 --> 00:09:46.760\nthen the firewall rules applied,\nall right?\n\n183\n00:09:46.760 --> 00:09:48.920\nSo that's why we have to\nmap that to the internal.\n\n184\n00:09:48.920 --> 00:09:51.560\nIt's easy to forget if you're\ncreating the rule yourself.\n\n185\n00:09:51.560 --> 00:09:55.040\nBut if you let it create the rule for you,\nthen you don't have to remember that.\n\n186\n00:09:55.040 --> 00:09:56.620\nIt does show up here like this.\n\n187\n00:09:57.660 --> 00:09:59.640\nAnd you might be asking yourself,\nwell, that's dumb.\n\n188\n00:09:59.640 --> 00:10:02.720\nWhy don't they apply the rules first so\nwe know what to throw out?\n\n189\n00:10:02.720 --> 00:10:06.200\nAnd the reason is sometimes your rules\nneed to be based on what happens after\n\n190\n00:10:06.200 --> 00:10:10.120\nthe translation and there's no good way\nto do that if you apply the rules first.\n\n191\n00:10:10.120 --> 00:10:11.810\nAnd so that's why it applies second.\n\n192\n00:10:11.810 --> 00:10:15.938\nSo there is a reason for\ndoing it in that order.\n\n193\n00:10:15.938 --> 00:10:18.838\nBut at this stage,\nif somebody's on an outside network,\n\n194\n00:10:18.838 --> 00:10:22.862\nthey should be able to remote into my\nworkstation, well assuming I turned it on,\n\n195\n00:10:22.862 --> 00:10:24.831\nI guess we should probably check that.\n\n196\n00:10:24.831 --> 00:10:28.176\nLet me check and make sure Remote\nDesktop Protocol is even turned on on my\n\n197\n00:10:28.176 --> 00:10:31.150\nworkstation, and if it is,\nI should be able to remote into it.\n\n198\n00:10:31.150 --> 00:10:37.920\nSo if I go into my remote settings here,\nI've got, RDP is turned on, good.\n\n199\n00:10:37.920 --> 00:10:42.020\nSo if I go to an external host,\nlet's jump over here to my server.\n\n200\n00:10:43.060 --> 00:10:47.330\nSo this is a server, it's an external\nhost, if I look at its IP address,\n\n201\n00:10:47.330 --> 00:10:50.740\nit's 209.251.159.185, so\nit's out there on the Internet.\n\n202\n00:10:52.700 --> 00:10:56.308\nAnd if I fire up its\nRemote Desktop Connection and\n\n203\n00:10:56.308 --> 00:11:02.296\nI point that to my firewall, so I'm gonna\npoint it at my firewall's IP address.\n\n204\n00:11:02.296 --> 00:11:06.488\nAnd if I did an alternate port number,\nI could say like :6000, right?\n\n205\n00:11:06.488 --> 00:11:08.931\nAnd then now it's gonna flip over\nto that other port number, but\n\n206\n00:11:08.931 --> 00:11:10.434\nI left mine at the default of 3389.\n\n207\n00:11:10.434 --> 00:11:13.600\nSo I'm just gonna point at the firewall,\nand I'm gonna connect.\n\n208\n00:11:13.600 --> 00:11:16.661\nThe firewall's gonna receive that, and\n\n209\n00:11:16.661 --> 00:11:21.480\nit's going to translate that to\nmy internal IP and send it along.\n\n210\n00:11:21.480 --> 00:11:28.039\nAnd, assuming I know my user account, I've\ngot to use spaces like a crazy person.\n\n211\n00:11:28.039 --> 00:11:28.782\nThat's it.\n\n212\n00:11:28.782 --> 00:11:30.656\n>> [LAUGH]\n>> I should be able to connect,\n\n213\n00:11:30.656 --> 00:11:31.380\nand there we go.\n\n214\n00:11:31.380 --> 00:11:34.860\nNow I'm remote connected into my desktop,\nor\n\n215\n00:11:34.860 --> 00:11:37.600\nI will be here in a moment when\nit finishes loading the screen.\n\n216\n00:11:37.600 --> 00:11:40.594\nSo, I'm remoted into my\nlaptop on this other network,\n\n217\n00:11:40.594 --> 00:11:42.708\nwe passed right through the firewall.\n\n218\n00:11:42.708 --> 00:11:45.626\nAnd, if I look at my top traffic here,\n\n219\n00:11:45.626 --> 00:11:49.743\nthis is the pfTop where it\nshows all the filter rules.\n\n220\n00:11:49.743 --> 00:11:51.786\nSee all this 3389 traffic?\n\n221\n00:11:51.786 --> 00:11:56.280\n209.251.159.185, that's\nmy external server,\n\n222\n00:11:56.280 --> 00:12:02.992\nis connected to 192.168.0.100 on 3389,\nso I can see that is actually happening.\n\n223\n00:12:02.992 --> 00:12:06.198\nIt's passing through on the firewall and\nthey're communicating and\n\n224\n00:12:06.198 --> 00:12:07.455\nrunning through, right?\n\n225\n00:12:07.455 --> 00:12:10.340\nSo, that's all in action.\n\n226\n00:12:10.340 --> 00:12:14.600\nAnd really not a hard thing to\nconfigure when you look at those rules.\n\n227\n00:12:14.600 --> 00:12:17.580\nMy resolutions gonna be all\nwhacked out since I'm RDP'd in.\n\n228\n00:12:17.580 --> 00:12:19.105\nLet me flip back to my regular desktop.\n\n229\n00:12:20.230 --> 00:12:21.259\nReally not hard to configure.\n\n230\n00:12:21.259 --> 00:12:23.674\nAnd if you're coming from the Cisco world,\nboy,\n\n231\n00:12:23.674 --> 00:12:26.158\nit is a world easier than\ndoing it on the Cisco side.\n\n232\n00:12:26.158 --> 00:12:31.126\nIt's just really challenging there, but\nhere, we just define the external IP,\n\n233\n00:12:31.126 --> 00:12:33.230\nthe internal, and that's that.\n\n234\n00:12:33.230 --> 00:12:36.420\nAlso notice if you watched our other NAT\nsegments, on a lot of the other ones,\n\n235\n00:12:36.420 --> 00:12:38.340\nI had to go and configure a virtual IP.\n\n236\n00:12:38.340 --> 00:12:41.379\nWe don't have to do that here because\nwe're using the IP that's actually\n\n237\n00:12:41.379 --> 00:12:43.253\nassigned to the interface and\nthe firewall.\n\n238\n00:12:43.253 --> 00:12:45.224\nThe firewall already knows about that one.\n\n239\n00:12:45.224 --> 00:12:47.350\nWe're really just telling it about ports,\nright?\n\n240\n00:12:47.350 --> 00:12:49.470\nWe're doing port forwarding.\n\n241\n00:12:49.470 --> 00:12:53.250\nNow, also be careful,\nwhen you look at your NAT configuration.\n\n242\n00:12:54.250 --> 00:12:59.590\nThere's more than one type of NAT, and you\ncan get conflicts between them, all right?\n\n243\n00:12:59.590 --> 00:13:01.840\nPort forwarding actually applies first.\n\n244\n00:13:01.840 --> 00:13:05.400\nSo port forwarding can override\nthe behavior of some of your\n\n245\n00:13:05.400 --> 00:13:07.330\nother types of NAT you\nmight have configured.\n\n246\n00:13:07.330 --> 00:13:08.970\nIf you've configured one to one or\n\n247\n00:13:08.970 --> 00:13:11.520\noutbound, the port forwarding\ncan override that.\n\n248\n00:13:11.520 --> 00:13:15.380\nBut, really, at the end of the day, if\nyou're doing one to one, you shouldn't be\n\n249\n00:13:15.380 --> 00:13:18.590\ndoing port forwarding anyway, so\nthere shouldn't be any conflicts there.\n\n250\n00:13:18.590 --> 00:13:21.353\nBut just be aware that they\ncan override each other, so\n\n251\n00:13:21.353 --> 00:13:24.493\ndefinitely double check and\ntest any translation you put in.\n\n252\n00:13:26.792 --> 00:13:29.903\nAll right, well Ronnie,\nI used the example here of RDP, but\n\n253\n00:13:29.903 --> 00:13:32.710\nwe could host our own web server,\nour own mail server.\n\n254\n00:13:32.710 --> 00:13:35.710\nYou could host, I'm trying to\nthink of stuff I do at my house.\n\n255\n00:13:35.710 --> 00:13:40.313\nI have Plex and I did a port\nredirection for BitTorrent sync.\n\n256\n00:13:40.313 --> 00:13:43.879\nIt had a port that it wanted open to\nbe able to do proper discovery, so\n\n257\n00:13:43.879 --> 00:13:47.761\nthere's any number of things that you\nmight need to do port forwarding for\n\n258\n00:13:47.761 --> 00:13:49.972\nto your systems at home or at your office.\n\n259\n00:13:49.972 --> 00:13:55.195\nAnother thing to be aware of is that some\nInternet service providers do block ports.\n\n260\n00:13:55.195 --> 00:13:58.697\nSo for example, at home,\nif I wanted to host a web server, well,\n\n261\n00:13:58.697 --> 00:14:02.011\nI use Cox Communications for\nmy cable connection at home, and\n\n262\n00:14:02.011 --> 00:14:04.135\nthey do not allow traffic on port 80.\n\n263\n00:14:04.135 --> 00:14:05.950\nYou can't host your own web server.\n\n264\n00:14:05.950 --> 00:14:09.654\nThey also don't allow traffic on port 25,\nI can't host my own SMTP or\n\n265\n00:14:09.654 --> 00:14:10.847\nmail server, right?\n\n266\n00:14:10.847 --> 00:14:14.553\nSo just because you put the port forward\nin doesn't necessarily mean your\n\n267\n00:14:14.553 --> 00:14:16.177\nISP's gonna allow it through.\n\n268\n00:14:16.177 --> 00:14:17.640\n>> Now Don, just one question.\n\n269\n00:14:17.640 --> 00:14:18.560\nIf you're at home and\n\n270\n00:14:18.560 --> 00:14:22.780\nyou have a wireless router that's\nalready doing port forwarding for you.\n\n271\n00:14:22.780 --> 00:14:26.110\nDo I need to set both of them up, or\ndo I just need to turn one of them off?\n\n272\n00:14:26.110 --> 00:14:28.210\n>> So if you've already got a router\nthat's doing the port forwarding for you,\n\n273\n00:14:28.210 --> 00:14:31.830\nand you got the firewall, before or after?\n\n274\n00:14:31.830 --> 00:14:35.580\n>> Let's say it's before, in other words\nconnected to the cable modem itself.\n\n275\n00:14:35.580 --> 00:14:38.880\n>> So if the firewall is sitting\nin between the cable modem and\n\n276\n00:14:38.880 --> 00:14:41.200\nyour router, and\nthe router's doing the port forwarding,\n\n277\n00:14:41.200 --> 00:14:43.080\nthen you do not do the port\nforwarding on the firewall also.\n\n278\n00:14:43.080 --> 00:14:43.710\n>> Sounds good.\n\n279\n00:14:43.710 --> 00:14:46.570\n>> And the firewall only knows\nabout the external IP's, and so\n\n280\n00:14:46.570 --> 00:14:48.180\nthat's what you'd be approving through it,\nso\n\n281\n00:14:48.180 --> 00:14:51.430\nit really wouldn't be aware of\nthe internal IP's at that point.\n\n282\n00:14:51.430 --> 00:14:55.964\nYou do see that from time to time when\nthese cable providers will give you\n\n283\n00:14:55.964 --> 00:15:00.952\na modem that has a router built into it,\nand then you stick your firewall behind\n\n284\n00:15:00.952 --> 00:15:04.445\nthat, so you have,\nreally two routers in the system.\n\n285\n00:15:04.445 --> 00:15:09.152\nSo you just have to think about where\nthat translation is occurring and\n\n286\n00:15:09.152 --> 00:15:11.318\nhow you do the entries for that.\n\n287\n00:15:11.318 --> 00:15:13.767\nAll right, well ladies and gentlemen,\nthat's about it for port forwarding.\n\n288\n00:15:13.767 --> 00:15:16.235\nOne of our shorter segments,\nbut it is an easy technology.\n\n289\n00:15:16.235 --> 00:15:20.572\nIt's definitely one you'll make use of\nthough, it's a good one especially for\n\n290\n00:15:20.572 --> 00:15:22.306\nhome and small business users.\n\n291\n00:15:22.306 --> 00:15:23.875\nAll right well,\nI hope you guys enjoyed that.\n\n292\n00:15:23.875 --> 00:15:26.916\nStay tuned,\nwe've got more pfSense content coming up.\n\n293\n00:15:26.916 --> 00:15:32.879\n[MUSIC]\n\n",
          "vimeoId": "130429949"
        }
      ],
      "title": "Network Address Translation (NAT)"
    },
    {
      "episodes": [
        {
          "description": null,
          "length": "1667",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-1-site_to_site_vpn-061115-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-1-site_to_site_vpn-061115-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-1-site_to_site_vpn-061115-1-sm.jpg",
          "title": "Site-to-Site VPN",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:05.671\n[MUSIC]\n\n2\n00:00:07.299 --> 00:00:11.494\nIn this segment we're gonna take a look\nat configuring site-to-site VPNs\n\n3\n00:00:11.494 --> 00:00:14.720\nusing the OpenVPN service\ninside of pfSense.\n\n4\n00:00:14.720 --> 00:00:17.260\nWe've seen in some of our previous\nsegments how pfSense is a very\n\n5\n00:00:17.260 --> 00:00:18.610\npowerful firewall.\n\n6\n00:00:18.610 --> 00:00:22.720\nIt's got a lot of functionality in there\nand most of it's really centered around\n\n7\n00:00:22.720 --> 00:00:25.280\nfiltering traffic as it\npasses across a network.\n\n8\n00:00:25.280 --> 00:00:30.208\nBut another important function of our\nfirewalls is the ability to terminate\n\n9\n00:00:30.208 --> 00:00:31.132\nVPN tunnels.\n\n10\n00:00:31.132 --> 00:00:33.200\nAnd there's really two types\nof tunnels that we deal with.\n\n11\n00:00:33.200 --> 00:00:36.360\nThere's remote access tunnels,\nwhere you've got a laptop or\n\n12\n00:00:36.360 --> 00:00:40.930\na desktop that building up its own\ndedicated VPN connection of your system,\n\n13\n00:00:40.930 --> 00:00:43.950\nor we've got site-to-site VPNs.\n\n14\n00:00:43.950 --> 00:00:46.660\nWhere it's a firewall at one building,\n\n15\n00:00:46.660 --> 00:00:49.480\nestablishing a VPN to\na firewall in another building.\n\n16\n00:00:49.480 --> 00:00:54.421\nAnd it allows all of the computers in\nthose buildings to function over one\n\n17\n00:00:54.421 --> 00:00:55.318\nVPN tunnel.\n\n18\n00:00:55.318 --> 00:00:57.230\nAnd that's an incredibly useful thing.\n\n19\n00:00:57.230 --> 00:01:00.070\nEspecially for\ncompanies that are using the internet\n\n20\n00:01:00.070 --> 00:01:03.670\nto provide connectivity between their\nbranch offices as opposed to things like\n\n21\n00:01:03.670 --> 00:01:07.850\ndedicated point to point lines which get\nexpensive really fast, right Ronnie?\n\n22\n00:01:07.850 --> 00:01:11.010\n>> When we start taking a look at\nestablishing the VPN connection,\n\n23\n00:01:11.010 --> 00:01:12.830\nthe idea behind this, of course,\n\n24\n00:01:12.830 --> 00:01:17.730\nis the cost effectiveness instead of us\nreally having to go to a privately leased\n\n25\n00:01:17.730 --> 00:01:21.920\nline to be able to actually establish that\nconnection between two different sites.\n\n26\n00:01:21.920 --> 00:01:24.671\nBut using the VPN connection,\nas long as you're paying for\n\n27\n00:01:24.671 --> 00:01:28.523\nan internet to access connection, you can\ngo ahead and create that VPN tunnel, and\n\n28\n00:01:28.523 --> 00:01:31.550\nthat'll actually allow you to have\nthat same type of privacy that\n\n29\n00:01:31.550 --> 00:01:34.080\nyou need without actually\nthe extra expense.\n\n30\n00:01:34.080 --> 00:01:36.839\nSo we're gonna take\na look at OpenVPN today.\n\n31\n00:01:36.839 --> 00:01:41.003\n>> Yeah, now OpenVPN if you're not\nfamiliar with it is like its name implies,\n\n32\n00:01:41.003 --> 00:01:44.515\nan open source set of tools that\nare available that you can use for\n\n33\n00:01:44.515 --> 00:01:46.940\ndoing virtual private networks.\n\n34\n00:01:46.940 --> 00:01:50.680\nAnd what it does is it leverages things\nlike SSL, Secure Socket Layering, and\n\n35\n00:01:50.680 --> 00:01:53.250\nreally Transport Layer Security, or TLS.\n\n36\n00:01:53.250 --> 00:01:54.840\nIt leverages those.\n\n37\n00:01:54.840 --> 00:01:58.825\nThey use the same encryption they use when\nyou browse to websites that are secure,\n\n38\n00:01:58.825 --> 00:02:00.687\nbut it uses that to build VPN tunnels.\n\n39\n00:02:00.687 --> 00:02:05.049\nAnd that means that it's a free solution\nthat's easily implemented by people like\n\n40\n00:02:05.049 --> 00:02:08.240\npfSense, and we can use that\nto secure our communications.\n\n41\n00:02:08.240 --> 00:02:12.007\nIt's really a great technology, and\nit's pretty easy to get set up, right?\n\n42\n00:02:12.007 --> 00:02:12.730\n>> It really is.\n\n43\n00:02:12.730 --> 00:02:15.860\nWhen we start to take a look at it, the\nonly thing that's a little bit different\n\n44\n00:02:15.860 --> 00:02:19.140\nabout the way that this VPN connection\nis going to work is that you're gonna\n\n45\n00:02:19.140 --> 00:02:22.080\nactually see that you can set up\nwhat we call one side of a server.\n\n46\n00:02:22.080 --> 00:02:26.330\nAnd the other side's gonna be set up as\na client when we first get started here.\n\n47\n00:02:26.330 --> 00:02:30.456\nBut they really do work just like a\nregular VPN site-to-site connection would\n\n48\n00:02:30.456 --> 00:02:31.327\nend up working.\n\n49\n00:02:31.327 --> 00:02:33.175\nWhen you're just using\ndifferent terminology, and\n\n50\n00:02:33.175 --> 00:02:34.660\nwe'll show you exactly how that's done.\n\n51\n00:02:34.660 --> 00:02:37.190\nLet's go ahead and\ntake a look at my computer just briefly.\n\n52\n00:02:37.190 --> 00:02:42.050\nAnd I've got a basic diagram of what we're\ngonna do to establish this connection.\n\n53\n00:02:42.050 --> 00:02:46.520\nSo, over on one side I have a pfSense\nbox running and on that pfSense box\n\n54\n00:02:46.520 --> 00:02:50.070\nI'm just gonna use that for site A and\nthat's gonna become my server.\n\n55\n00:02:50.070 --> 00:02:51.790\nAnd then over on the side, for site B,\n\n56\n00:02:51.790 --> 00:02:55.300\nI have another pfSense box running,\nthat's actually gonna be my client.\n\n57\n00:02:55.300 --> 00:02:57.220\nNow, I'm just logically\ndividing that up so\n\n58\n00:02:57.220 --> 00:02:59.610\nI can keep my mind\nstraight as we set it up.\n\n59\n00:02:59.610 --> 00:03:04.170\nWe're gonna set up the server side\nfirst and then the client side as well.\n\n60\n00:03:04.170 --> 00:03:08.880\nNow I've gone ahead and separated out the\ntwo public IP addresses out here too so\n\n61\n00:03:08.880 --> 00:03:13.420\nthat we can see that in action as we\ngo ahead and make this connection.\n\n62\n00:03:13.420 --> 00:03:18.214\nSo let's go ahead and jump onto\nthe actual server side pfSense spots.\n\n63\n00:03:18.214 --> 00:03:20.631\nSo I'm just going to go ahead and do that.\n\n64\n00:03:20.631 --> 00:03:24.014\nLet me minimize this get\nthat going on here, and\n\n65\n00:03:24.014 --> 00:03:26.900\nthat's gonna be my mint OS box running.\n\n66\n00:03:28.560 --> 00:03:32.610\nSo, if we were just logging in for\nthe first time into PSS.\n\n67\n00:03:32.610 --> 00:03:34.288\nWe're normally at our dashboard.\n\n68\n00:03:34.288 --> 00:03:37.780\nWhat we're gonna do instead is along\nthe menu bar up here is go up to VPN, and\n\n69\n00:03:37.780 --> 00:03:40.020\nwe're gonna select this third option.\n\n70\n00:03:40.020 --> 00:03:42.080\nYou'll notice that there are several\nother options here today,\n\n71\n00:03:42.080 --> 00:03:44.105\nwe're taking a look at OpenVPN.\n\n72\n00:03:45.390 --> 00:03:50.350\nAnd once we get access into the OpenVPN\ntab, or the menu, you'll notice that there\n\n73\n00:03:50.350 --> 00:03:54.470\nare actually three or four different\ntabs for us to be able to set this up.\n\n74\n00:03:54.470 --> 00:03:58.560\nNow, because we're doing a site-to-site\nat this point, I'm gonna go ahead and\n\n75\n00:03:58.560 --> 00:04:04.800\nactually create a brand new OpenVPN server\nside is what we're going to do here.\n\n76\n00:04:04.800 --> 00:04:06.130\n>> Now Ronnie, if I'm setting this up for\n\n77\n00:04:06.130 --> 00:04:09.030\nmy company, does it matter which end is\nthe server, and which end is the client?\n\n78\n00:04:09.030 --> 00:04:09.930\n>> Not really,\n\n79\n00:04:09.930 --> 00:04:13.440\nyou really don't need to worry about\nit as far as the functionality goes.\n\n80\n00:04:13.440 --> 00:04:17.450\nBut if you want to say look,\nI want all of those other client sites, so\n\n81\n00:04:17.450 --> 00:04:21.240\nif I have four or five different branch\noffices, and you want to be that hub and\n\n82\n00:04:21.240 --> 00:04:23.330\nspoke, that hub in the center,\n\n83\n00:04:23.330 --> 00:04:27.890\nyou're probably gonna wanna set this up as\nbeing your end as being the server side.\n\n84\n00:04:27.890 --> 00:04:30.500\nThere is one other scenario that\nwe might need to aware of, and\n\n85\n00:04:30.500 --> 00:04:31.570\nhopefully it's not common.\n\n86\n00:04:31.570 --> 00:04:33.380\nWhen we set up site-to-site VPNs,\n\n87\n00:04:33.380 --> 00:04:37.300\nideally, both ends of the VPN\nwill have static IP addresses.\n\n88\n00:04:37.300 --> 00:04:39.358\nYou really wanna have static IP addresses.\n\n89\n00:04:39.358 --> 00:04:43.552\nBut you might be in a scenario where your\nbranch officers have like consumer grade\n\n90\n00:04:43.552 --> 00:04:44.298\nDSL or cable.\n\n91\n00:04:44.298 --> 00:04:46.640\nMaybe you're trying to get somebody's\nhome connected up to your network.\n\n92\n00:04:46.640 --> 00:04:49.700\nAnd in that scenario,\nthey might have a dynamic IP address.\n\n93\n00:04:49.700 --> 00:04:52.880\nIf they have a dynamic address,\nthey can't be the server.\n\n94\n00:04:52.880 --> 00:04:56.440\nBecause if their IP changes,\nnobody knows how to get to it.\n\n95\n00:04:56.440 --> 00:05:00.280\nAnd you can try to do things like dynamic\nDNS and all, but it really wreaks havoc.\n\n96\n00:05:00.280 --> 00:05:03.070\nAt a minimum, one of your sides\nneeds to have a static IP, so\n\n97\n00:05:03.070 --> 00:05:05.450\npeople know where to connect,\nand that should be the server.\n\n98\n00:05:05.450 --> 00:05:08.020\nIf both sides have static IPs,\nit really doesn't matter.\n\n99\n00:05:08.020 --> 00:05:09.390\nEither side can be the server.\n\n100\n00:05:09.390 --> 00:05:13.110\nThey're both capable of building up the\nsession, and it's the same encryption, so\n\n101\n00:05:13.110 --> 00:05:14.610\nit really doesn't matter.\n\n102\n00:05:14.610 --> 00:05:16.540\n>> The nice thing about what\nwe're actually gonna do is,\n\n103\n00:05:16.540 --> 00:05:17.890\nwe're gonna walk through this menu system,\n\n104\n00:05:17.890 --> 00:05:21.130\nand you're gonna see there's not a lot\nof configuration we need to do here, but\n\n105\n00:05:21.130 --> 00:05:24.115\nthere a couple of extra things\nthat we need to get set up\n\n106\n00:05:24.115 --> 00:05:26.585\nworking with the NAT rules and\nthe firewall rules too.\n\n107\n00:05:26.585 --> 00:05:30.045\nSo let's go ahead and\nget started as we set up the server side.\n\n108\n00:05:30.045 --> 00:05:33.345\nSo once we have the server tab,\nwe're just gonna clear the new server and\n\n109\n00:05:33.345 --> 00:05:34.675\nover on the right hand side.\n\n110\n00:05:34.675 --> 00:05:37.755\nAdd the little button tells me\nthat I can add the server end.\n\n111\n00:05:37.755 --> 00:05:41.845\nAnd I'm simply going to go ahead and click\nthat, and you'll now notice that Don this\n\n112\n00:05:41.845 --> 00:05:45.610\npage there's a lot of stuff that looks\nlike I actually have to configure here.\n\n113\n00:05:45.610 --> 00:05:48.578\nBut there are some other things\nthat we can kind of leave out that\n\n114\n00:05:48.578 --> 00:05:52.163\nare at the default, and we do need to\nchange them later on when we can, but for\n\n115\n00:05:52.163 --> 00:05:55.773\nright now, we're just gonna set up\na very simple site-to-site VPN here.\n\n116\n00:05:55.773 --> 00:05:58.447\nAnd now that we're actually\non the OpenVPN server,\n\n117\n00:05:58.447 --> 00:06:02.240\nnow we actually have a lot different\nthings that we can choose.\n\n118\n00:06:02.240 --> 00:06:04.970\nNow, of course, when you take a look\nat each of these options here\n\n119\n00:06:04.970 --> 00:06:07.640\nthe general information if I'm\ngonna disable this server.\n\n120\n00:06:07.640 --> 00:06:11.990\nIf I don't need that VPN server to be up\nand running I can simply just disable it\n\n121\n00:06:11.990 --> 00:06:13.790\nand maybe where I implemented\nit at one point in time,\n\n122\n00:06:13.790 --> 00:06:15.620\nand then it's like I\ndon't need it anymore.\n\n123\n00:06:15.620 --> 00:06:17.610\nI might just go ahead and disable it.\n\n124\n00:06:17.610 --> 00:06:21.410\nSecondly, I need to decide what\nmode I am actually going to be in.\n\n125\n00:06:21.410 --> 00:06:23.180\nNow, there's several different modes.\n\n126\n00:06:23.180 --> 00:06:26.290\nThe ones that we're looking at, of course,\nare the two peer-to-peer modes.\n\n127\n00:06:26.290 --> 00:06:31.420\nWe have the option of a shared key and,\nof course, then using an SSL or TLS.\n\n128\n00:06:31.420 --> 00:06:34.030\nNow, a shared key means that we're\nactually gonna generate a key or\n\n129\n00:06:34.030 --> 00:06:36.840\nwe're gonna actually create\nour own key statically, and\n\n130\n00:06:36.840 --> 00:06:39.380\nthen what I'm gonna do is pass\nthat off to the client side.\n\n131\n00:06:39.380 --> 00:06:41.250\nIn other words,\nI'll have to email it or send it,\n\n132\n00:06:41.250 --> 00:06:45.460\nor do something to get that key over\nto them, it's hopefully securely.\n\n133\n00:06:45.460 --> 00:06:47.170\nOr I can actually use the SSL.\n\n134\n00:06:47.170 --> 00:06:49.761\nNow, why would I actually\nchoose one over the other?\n\n135\n00:06:49.761 --> 00:06:53.102\n>> Well, if you do SSL certificates,\nyou can set expiration dates for\n\n136\n00:06:53.102 --> 00:06:54.400\nthose certificates.\n\n137\n00:06:54.400 --> 00:06:56.770\nYou can revoke the certificate\nif something goes wrong.\n\n138\n00:06:56.770 --> 00:06:59.290\nIf you use a password,\nthere's no expiration date.\n\n139\n00:06:59.290 --> 00:07:00.750\nThere's no way to revoke a password.\n\n140\n00:07:00.750 --> 00:07:04.720\nYou would have to come in here and change\nthe router or firewall's configuration.\n\n141\n00:07:04.720 --> 00:07:07.740\nYou have to come and change that password,\nor disable that firewall rule.\n\n142\n00:07:07.740 --> 00:07:10.120\nWith a certificate,\nyou can just go and revoke it.\n\n143\n00:07:10.120 --> 00:07:12.180\nSo you have a little bit\nof protection there.\n\n144\n00:07:12.180 --> 00:07:14.410\nCertificates are generally\nthe better way to go about it, but\n\n145\n00:07:14.410 --> 00:07:17.186\nit does require you to have\na public key infrastructure,\n\n146\n00:07:17.186 --> 00:07:20.410\nright to have a certificate\nauthority to be issuing those out.\n\n147\n00:07:20.410 --> 00:07:22.440\nSo if you're just looking\nto get this up and\n\n148\n00:07:22.440 --> 00:07:26.740\nrunning between two sites you can\nchoose to do a pre shared key, a PSK.\n\n149\n00:07:26.740 --> 00:07:30.650\nAnd you can define a nice, long\nrandomized strain that's just used for\n\n150\n00:07:30.650 --> 00:07:33.740\nthis connection and put it in place and\nit's relatively safe.\n\n151\n00:07:33.740 --> 00:07:37.080\nOne of the things I usually\ndo is if I'm gonna use a PSK,\n\n152\n00:07:37.080 --> 00:07:39.590\nI'll put it in place on\nthe two firewalls and\n\n153\n00:07:39.590 --> 00:07:43.750\nthen I won't save it anywhere, and I just\nwon't remember what that password is.\n\n154\n00:07:43.750 --> 00:07:45.490\nNobody will know what that password is.\n\n155\n00:07:45.490 --> 00:07:47.423\nAnd if I ever need it again,\nwell, I just come and\n\n156\n00:07:47.423 --> 00:07:50.407\nchange the password on the two firewalls,\nand change it to something new.\n\n157\n00:07:50.407 --> 00:07:53.549\nSo you can get a decent degree of\nsecurity out of using a PSK and\n\n158\n00:07:53.549 --> 00:07:57.383\nit's a lot simpler because you don't\nrequire a certificate authority.\n\n159\n00:07:57.383 --> 00:07:58.461\nBut if you have a CA,\n\n160\n00:07:58.461 --> 00:08:02.469\nif you're able to issue your own\ncertificates you do get some advantages.\n\n161\n00:08:02.469 --> 00:08:05.388\nThe only thing that pfSense\nreally does recommend,\n\n162\n00:08:05.388 --> 00:08:07.244\nthat if you're doing like five or\n\n163\n00:08:07.244 --> 00:08:11.840\nsix different ones of these OpenVPN site\nto sites, they recommend using the SSL.\n\n164\n00:08:11.840 --> 00:08:13.740\nWe're just doing a simple two site one.\n\n165\n00:08:13.740 --> 00:08:16.450\nSo, we're going to use this\npre-shared key option instead.\n\n166\n00:08:16.450 --> 00:08:18.930\nNow, Don the protocol actually says UDP.\n\n167\n00:08:18.930 --> 00:08:24.500\nNormally, I'm expecting TCP, but UDP seems\nto be the preferred option here, right?\n\n168\n00:08:24.500 --> 00:08:27.160\n>> Yeah, you know,\nremember how a VPN works, right?\n\n169\n00:08:27.160 --> 00:08:30.310\nAnd in SSL in general, is you're taking\nyour data, and you're encrypting it, and\n\n170\n00:08:30.310 --> 00:08:31.670\nyou're sending it along.\n\n171\n00:08:31.670 --> 00:08:33.730\nThe other end,\nthe devices that are in between,\n\n172\n00:08:33.730 --> 00:08:36.060\nthey don't really know\nwhat is inside of that.\n\n173\n00:08:36.060 --> 00:08:39.670\nThey just see an encrypted\npacket by itself, right,\n\n174\n00:08:39.670 --> 00:08:44.650\nand if it's by itself, if you get\na packet and it's out of order or\n\n175\n00:08:44.650 --> 00:08:47.820\nif you're missing something, you don't\nreally know unless you've received it,\n\n176\n00:08:47.820 --> 00:08:50.300\ndecoded it and\nlooked at what's inside of it.\n\n177\n00:08:50.300 --> 00:08:53.240\nSo inside of it, we've got things\nlike a sequence number and\n\n178\n00:08:53.240 --> 00:08:56.410\nstuff so we can track whether or\nnot we're missing packets.\n\n179\n00:08:56.410 --> 00:08:59.070\nThe encrypted packet\nitself doesn't need that.\n\n180\n00:08:59.070 --> 00:09:01.692\nIt would really be double effort for\nlittle gain.\n\n181\n00:09:01.692 --> 00:09:04.590\nSo OpenVPN defaults to UDP connections,\nand\n\n182\n00:09:04.590 --> 00:09:06.690\nthat's typically what we want for\nperformance reasons.\n\n183\n00:09:06.690 --> 00:09:09.830\nYou can flip it to TCP, it does work, but\n\n184\n00:09:09.830 --> 00:09:12.930\nit's kind of just wasted\nresources on the firewall.\n\n185\n00:09:14.680 --> 00:09:16.990\n>> And we're going to leave this\ndefault as being the tunnel mode,\n\n186\n00:09:16.990 --> 00:09:21.000\nit does give you the ability to do tap, a\ntunnel is what we're normally creating, so\n\n187\n00:09:21.000 --> 00:09:22.590\nwe're gonna go ahead and leave it there.\n\n188\n00:09:22.590 --> 00:09:25.780\n>> Yeah, and the difference there,\nit's tunnel mode and transport mode, and\n\n189\n00:09:25.780 --> 00:09:30.290\nwhen you're in tunnel mode, really every\nsingle thing about the data you're sending\n\n190\n00:09:30.290 --> 00:09:35.030\nis encrypted and it's encapsulated in\nanother packet that has a source and\n\n191\n00:09:35.030 --> 00:09:37.490\ndestination header that just\npoints to the other firewall.\n\n192\n00:09:37.490 --> 00:09:39.250\nIf you choose the tap mode,\n\n193\n00:09:39.250 --> 00:09:42.630\nthe headers of the packet of the data\nyou're sending are actually not encrypted.\n\n194\n00:09:42.630 --> 00:09:44.070\nSo the source and\nthe destination are there,\n\n195\n00:09:44.070 --> 00:09:47.260\nand it's just your payload\nthat gets encrypted.\n\n196\n00:09:47.260 --> 00:09:51.540\nWell, that's still safe, right, your\npayload is protected, but somebody could\n\n197\n00:09:51.540 --> 00:09:54.880\nlook at it, and they could recognize,\nthis computer is talking to that computer.\n\n198\n00:09:54.880 --> 00:09:58.340\nI don't know what they're talking about,\nbut I know who it is that's talking.\n\n199\n00:09:58.340 --> 00:10:02.030\nIn tunnel mode, it secures even that,\nand that's generally what we want.\n\n200\n00:10:02.030 --> 00:10:05.310\nIt's a little more work for\nthe firewall but we're better off for it.\n\n201\n00:10:05.310 --> 00:10:06.280\nSo tunnel mode is the default.\n\n202\n00:10:07.520 --> 00:10:10.930\n>> And then for us to establish that site\nto site we of course are gonna connect our\n\n203\n00:10:10.930 --> 00:10:15.480\nWAN interface to hopefully the other\nside's WAN interface as well.\n\n204\n00:10:15.480 --> 00:10:16.940\nAnd then we choose a number.\n\n205\n00:10:16.940 --> 00:10:19.460\nNow the local port number\nhere is the default one for\n\n206\n00:10:19.460 --> 00:10:23.240\nOpenVPN at least in pfSense here,\nwhich is 1194.\n\n207\n00:10:23.240 --> 00:10:25.090\nYou can change that\nnumber if you choose to.\n\n208\n00:10:25.090 --> 00:10:27.960\n>> Yeah, and you got to be careful with\nthis because it's the default number for\n\n209\n00:10:27.960 --> 00:10:30.220\nOpenVPN for all of its services.\n\n210\n00:10:30.220 --> 00:10:34.080\nSo if you've already configured remote\naccess VPN, It's probably using 1194 and\n\n211\n00:10:34.080 --> 00:10:36.270\nso you need to get\nsomething different here.\n\n212\n00:10:36.270 --> 00:10:38.850\nNow pfSense will increment it,\nso it'll go to 1195, or 1196.\n\n213\n00:10:38.850 --> 00:10:43.542\nIf you're doing more than one\npoint to point link, right,\n\n214\n00:10:43.542 --> 00:10:46.330\nif Ronnie was going to connect another\nsite after this, well, the next\n\n215\n00:10:46.330 --> 00:10:49.450\none would need to be 1195 or 1196, and\nyou can pick whatever port you want,\n\n216\n00:10:49.450 --> 00:10:52.790\nit just need to match on both ends, so\nit's just something to be aware of.\n\n217\n00:10:54.230 --> 00:11:00.165\n>> And I'm just gonna enter in this\ndescription here, OpenVPN to SiteB.\n\n218\n00:11:00.165 --> 00:11:05.060\nAnd even though I don't tend to\ndo this very often, it does help,\n\n219\n00:11:05.060 --> 00:11:07.590\nespecially if you're setting it up and\nyou're just testing it out for\n\n220\n00:11:07.590 --> 00:11:10.600\nthe first time, that way you're actually\nnot gonna get too confused about\n\n221\n00:11:10.600 --> 00:11:12.740\nwhat you're actually having to go back and\nreconfigure.\n\n222\n00:11:14.140 --> 00:11:17.660\nNow as we scroll on down, this is where\nwe actually have to take a look at\n\n223\n00:11:17.660 --> 00:11:21.220\nsetting up the cryptography for\nthe connection that we're going to do.\n\n224\n00:11:21.220 --> 00:11:24.050\nNotice it gives me the ability to\nautomatically generate a shared key, and\n\n225\n00:11:24.050 --> 00:11:25.860\nthat's what I'm going to do.\n\n226\n00:11:25.860 --> 00:11:28.820\nWhen I hit Save, it's going to generate\na key and I'm going to come back and\n\n227\n00:11:28.820 --> 00:11:31.630\nI'm going to have to copy that key,\nor if I wanted to,\n\n228\n00:11:31.630 --> 00:11:34.300\nI could just type in a key on my own.\n\n229\n00:11:34.300 --> 00:11:36.900\nI'm just going to let it generate\nits own shared key at this point,\n\n230\n00:11:36.900 --> 00:11:39.160\nwhich is going to be a nice,\nbig, gigantic key.\n\n231\n00:11:39.160 --> 00:11:42.180\nAnd you'll see it once we\nactually get through here.\n\n232\n00:11:42.180 --> 00:11:45.450\nAt this point, we can also select whatever\nencryption algorithm that we need\n\n233\n00:11:45.450 --> 00:11:48.410\nto set that's going to match whatever\nthe security policies are going to be for\n\n234\n00:11:48.410 --> 00:11:49.530\nour company.\n\n235\n00:11:49.530 --> 00:11:52.680\nAnd at this point, since we're only doing\nit for a test, just verifying that we're\n\n236\n00:11:52.680 --> 00:11:56.260\nactually getting connected,\nI'm gonna leave it here at the AES-128 bit\n\n237\n00:11:56.260 --> 00:12:00.560\nis the one that I'm gonna leave it at,\nwhich is the default that we see.\n\n238\n00:12:00.560 --> 00:12:03.090\n>> Now you do have a lot of choices there,\nand\n\n239\n00:12:03.090 --> 00:12:05.360\nlet me give you just a little\nbit of guidance on this one.\n\n240\n00:12:06.590 --> 00:12:08.380\nThere's easy mistakes to be made here.\n\n241\n00:12:08.380 --> 00:12:10.209\nThe AES-128 that Ronnie chose,\n\n242\n00:12:10.209 --> 00:12:13.220\nthat's actually the one that I\nuse most of the time, right?\n\n243\n00:12:13.220 --> 00:12:15.290\nNot just for testing, but\neven in production, and\n\n244\n00:12:15.290 --> 00:12:19.610\nthat's because it's probably\nthe best balance between good,\n\n245\n00:12:19.610 --> 00:12:22.990\nstrong security, and performance, right?\n\n246\n00:12:22.990 --> 00:12:25.700\nThere's other standards you can\npick that are even stronger.\n\n247\n00:12:25.700 --> 00:12:30.380\nIf you look at that list there's several\nin there that are even stronger, so\n\n248\n00:12:30.380 --> 00:12:32.930\n192 bit ones, 256 bit, right?\n\n249\n00:12:32.930 --> 00:12:35.490\nAnd if you want really, really strong\nencryption you can do that, but\n\n250\n00:12:35.490 --> 00:12:37.790\nyou're going to take a performance hit.\n\n251\n00:12:37.790 --> 00:12:43.090\nWhen you run pfSense you likely don't\nhave a hardware encoder in it, right?\n\n252\n00:12:43.090 --> 00:12:46.540\nYou can buy these VPN accelerator boards,\nthat are PCI Express.\n\n253\n00:12:46.540 --> 00:12:49.490\nYou pop them into your firewall, and\nthey can do that in hardware, and\n\n254\n00:12:49.490 --> 00:12:52.050\nthen you can choose the really\nstrong encryption that runs great.\n\n255\n00:12:52.050 --> 00:12:55.710\nBut if you're running on a general\npurpose like an Intel CPU or AMD or\n\n256\n00:12:55.710 --> 00:12:57.560\nwhatever, you'll take a performance hit.\n\n257\n00:12:57.560 --> 00:13:00.650\nNow depending on your level of\ntraffic that might be fine.\n\n258\n00:13:00.650 --> 00:13:03.540\nI don't know if you guys have noticed but\nevery time we pull up the homepage,\n\n259\n00:13:03.540 --> 00:13:07.600\nthere's one of our firewalls,\nthe CPU is sitting at like 2% utilization.\n\n260\n00:13:07.600 --> 00:13:09.500\nSo you probably have\nthe resources to do it.\n\n261\n00:13:09.500 --> 00:13:10.990\nYou can pick something\nstronger if you want.\n\n262\n00:13:12.410 --> 00:13:17.190\nDon't be fooled into thinking that weaker\nsecurity equals better performance.\n\n263\n00:13:17.190 --> 00:13:21.090\nI know some people will choose\nTriple DES just because,\n\n264\n00:13:21.090 --> 00:13:25.030\nthey know it's an older protocol, they\nknow it's not considered secure anymore,\n\n265\n00:13:25.030 --> 00:13:27.400\nbut they'll choose Triple DES cuz\nthey want better performance.\n\n266\n00:13:27.400 --> 00:13:31.130\nAnd AES-128 actually gives\nyou better security and\n\n267\n00:13:31.130 --> 00:13:33.110\nbetter performance than Triple DES does.\n\n268\n00:13:33.110 --> 00:13:36.320\nSo just because it's an older\nstandard doesn't mean you get\n\n269\n00:13:36.320 --> 00:13:37.190\nbetter performance out of it.\n\n270\n00:13:37.190 --> 00:13:41.130\nSo I find AES-128 is a really\ngood balance for today, right?\n\n271\n00:13:41.130 --> 00:13:42.590\nSo we're in 2015 right now.\n\n272\n00:13:42.590 --> 00:13:46.520\nIf you're watching this video in 2016,\nit might not be the best balance anymore,\n\n273\n00:13:46.520 --> 00:13:48.290\nbut for today AES-128's great.\n\n274\n00:13:49.800 --> 00:13:51.970\n>> Also we want to set\nup a hashing algorithm.\n\n275\n00:13:51.970 --> 00:13:56.320\nIt says Authentication Digest Algorithm,\nand I'm gonna leave it at SHA-1.\n\n276\n00:13:56.320 --> 00:14:00.870\nBut notice once again you do have, well,\nlooks like a ton of options there Don.\n\n277\n00:14:00.870 --> 00:14:03.738\n>> Yeah and this is one where\nyou really gotta make a choice.\n\n278\n00:14:03.738 --> 00:14:04.872\nSHA-1 is great.\n\n279\n00:14:04.872 --> 00:14:10.660\nBut it's one of the algorithms that\ncame under scrutiny with the whole NSA,\n\n280\n00:14:10.660 --> 00:14:14.990\nthe American Intelligence Organization,\nthat may have potentially backdoored it,\n\n281\n00:14:14.990 --> 00:14:16.460\nweakened it on purpose.\n\n282\n00:14:16.460 --> 00:14:22.970\nSo, in security circles today, they really\nrecommend SHA-256 or something stronger.\n\n283\n00:14:22.970 --> 00:14:26.030\nSo, when you look at the list,\nyou've got SHA-256, you can pick it.\n\n284\n00:14:26.030 --> 00:14:28.230\nIt will take a little hit on performance.\n\n285\n00:14:28.230 --> 00:14:31.100\nAgain, you probably have the resources for\nit, just monitor that.\n\n286\n00:14:31.100 --> 00:14:33.730\nBut you'd need to make sure you chose\nthe same thing on the other side.\n\n287\n00:14:33.730 --> 00:14:35.730\nRight now we'll just stick with SHA1.\n\n288\n00:14:35.730 --> 00:14:38.550\n>> Now Don, it looks like I can even\nchoose no authentication if I want to.\n\n289\n00:14:38.550 --> 00:14:39.980\nIs that ever a good option?\n\n290\n00:14:39.980 --> 00:14:43.330\n>> Well, it depends on what\nyou're using your VPN tunnel for.\n\n291\n00:14:43.330 --> 00:14:46.150\nYou can actually choose to do no\nencryption on your VPN tunnel too.\n\n292\n00:14:46.150 --> 00:14:48.610\nJust because it's a VPN doesn't\nmean you have to encrypt it.\n\n293\n00:14:48.610 --> 00:14:50.565\nIf this is non-critical data,\n\n294\n00:14:50.565 --> 00:14:54.090\ni f you're just trying to mask the\ncomplexity of a network with your tunnel,\n\n295\n00:14:54.090 --> 00:14:56.870\nthen you might choose to disable\nencryption altogether, right?\n\n296\n00:14:56.870 --> 00:15:00.220\nOr, if your information is under\na Freedom of Information Act rule, or\n\n297\n00:15:00.220 --> 00:15:03.830\nsomething where it's public data anyway,\nyou don't necessarily care if people see\n\n298\n00:15:03.830 --> 00:15:06.870\nthe data, you just don't\nwant them injecting into it.\n\n299\n00:15:06.870 --> 00:15:08.620\nAnd so, that is where you sort of pick and\nchoose.\n\n300\n00:15:08.620 --> 00:15:11.620\nDo I turn off encryption,\ndo I turn off signatures?\n\n301\n00:15:11.620 --> 00:15:14.710\nYou usually want those signatures though,\nthat's kind of important, but\n\n302\n00:15:14.710 --> 00:15:16.510\nyou can disable that.\n\n303\n00:15:16.510 --> 00:15:19.200\n>> We just pretty much left it at\nthe default for right now just so\n\n304\n00:15:19.200 --> 00:15:23.550\nthat we can get this tunnel up with a bit\nof encryption and the hardware crypto is\n\n305\n00:15:23.550 --> 00:15:27.150\nthat little module that Don was talking\nabout that does have that hardware that\n\n306\n00:15:27.150 --> 00:15:30.360\nwill allow you to accelerate\nthe performance of your cryptography here.\n\n307\n00:15:30.360 --> 00:15:32.120\nWe're not actually working with one.\n\n308\n00:15:32.120 --> 00:15:33.760\nSo we're just going to go ahead and\nleave it, and\n\n309\n00:15:33.760 --> 00:15:36.220\nsay No Hardware Crypto Acceleration.\n\n310\n00:15:36.220 --> 00:15:38.770\n>> But if you drop down that box,\nyou'll see the names.\n\n311\n00:15:38.770 --> 00:15:40.430\nThere's two different ones,\nif I remember right.\n\n312\n00:15:40.430 --> 00:15:41.250\nCan you pull that down, Ronnie?\n\n313\n00:15:41.250 --> 00:15:42.540\n>> Yep, it just takes a moment.\n\n314\n00:15:42.540 --> 00:15:44.040\n>> I think there's two, there we go.\n\n315\n00:15:44.040 --> 00:15:44.750\n>> There it is.\n\n316\n00:15:44.750 --> 00:15:47.340\n>> And so there's two different vendors\nout there that make these boards.\n\n317\n00:15:47.340 --> 00:15:48.800\nAnd you can buy them.\n\n318\n00:15:48.800 --> 00:15:50.090\nBe careful if you buy one.\n\n319\n00:15:50.090 --> 00:15:53.880\nI mean, they're great, I don't mean like\noh, they're shady, be careful, that way.\n\n320\n00:15:53.880 --> 00:15:56.196\nWhat I mean is they're rated for\nbandwidth.\n\n321\n00:15:56.196 --> 00:15:59.077\nAnd so when you look at that board and\nyou go and buy it,\n\n322\n00:15:59.077 --> 00:16:02.218\nlike I know there is one in\nparticular that's maybe 70 or\n\n323\n00:16:02.218 --> 00:16:07.240\n$80 is not expensive, but it'll only\ndo up to 45 megabyte of traffic.\n\n324\n00:16:07.240 --> 00:16:11.260\nSo, if you have more than 45 megabyte of\nbandwidth turning through your system,\n\n325\n00:16:11.260 --> 00:16:13.340\nthat VPN accelerator\ncan't keep up with it.\n\n326\n00:16:13.340 --> 00:16:14.690\nSo, we've got to be careful with that,\n\n327\n00:16:14.690 --> 00:16:18.100\nand think about it as we select those\naccelerators to get the right one.\n\n328\n00:16:18.100 --> 00:16:19.430\nAnd you'd be surprised.\n\n329\n00:16:19.430 --> 00:16:22.560\nIf you've got a nice server, if you've\ngot like a 1U server built up to your\n\n330\n00:16:22.560 --> 00:16:25.370\nfirewall, and\nit's got dual Xeon's or whatever.\n\n331\n00:16:25.370 --> 00:16:26.150\nYou'll be surprised.\n\n332\n00:16:26.150 --> 00:16:29.210\nYour general purpose CPUs will probably\ntake care of your VPN tunnels just fine.\n\n333\n00:16:29.210 --> 00:16:32.170\n>> All right, so we're gonna\nmove on to the tunnel settings,\n\n334\n00:16:32.170 --> 00:16:35.920\nwhich is where we now need to go ahead and\nenter in information really about our\n\n335\n00:16:35.920 --> 00:16:39.430\nnetwork is where we're actually gonna\nstart entering in the information.\n\n336\n00:16:39.430 --> 00:16:40.900\nNow, there's always going to be,\n\n337\n00:16:40.900 --> 00:16:46.870\nat least in this menu where you're going\nto see setup for IPv4, as well as IPv6.\n\n338\n00:16:46.870 --> 00:16:49.810\nSo we're only gonna configure the IPv4,\n\n339\n00:16:49.810 --> 00:16:53.800\nwell, because I don't have IPv6 set up and\nready to go.\n\n340\n00:16:53.800 --> 00:16:56.730\nNow the first one here is\nthe one that might get us\n\n341\n00:16:56.730 --> 00:16:59.710\non the first time we actually try\nto set this up, because you and\n\n342\n00:16:59.710 --> 00:17:03.130\nI normally think about just setting\nup stuff that you and I know.\n\n343\n00:17:03.130 --> 00:17:06.790\nBut here it's really going to\ncreate a new network tunnel.\n\n344\n00:17:06.790 --> 00:17:11.960\nIn other words, we need an IP address\nrange that we're not going to be using.\n\n345\n00:17:11.960 --> 00:17:16.050\nAnd because we're also setting\nup a point to point connection,\n\n346\n00:17:16.050 --> 00:17:19.650\nwe're gonna actually use the smallest\npossible network that we can use,\n\n347\n00:17:19.650 --> 00:17:21.320\nwhich is only going to have two addresses.\n\n348\n00:17:21.320 --> 00:17:24.570\nSo, it's gonna actually\nhave a 30 bit subnet mask.\n\n349\n00:17:24.570 --> 00:17:28.320\n>> Yeah, and this network you can really\npick whatever you want because your end\n\n350\n00:17:28.320 --> 00:17:29.870\nusers are never gonna see this network.\n\n351\n00:17:29.870 --> 00:17:31.430\nYou just need to make\nsure you don't duplicate\n\n352\n00:17:31.430 --> 00:17:34.890\nit anywhere else in your environment,\nbecause you can bump into problems there.\n\n353\n00:17:34.890 --> 00:17:39.770\nBut you do need to pick an RFC 1918\naddress, cuz this isn't a public network.\n\n354\n00:17:39.770 --> 00:17:42.560\nSo just use a private one,\npick a really small number.\n\n355\n00:17:42.560 --> 00:17:44.840\n>> And if you don't pick one,\nright, if you happen to go away and\n\n356\n00:17:44.840 --> 00:17:45.440\nyou don't pick one.\n\n357\n00:17:45.440 --> 00:17:48.030\nAnd all of a sudden, you get everything\nconnected and you go, well Ronnie,\n\n358\n00:17:48.030 --> 00:17:49.980\nI didn't pick one at all and\nit still worked.\n\n359\n00:17:49.980 --> 00:17:54.580\nWell, right underneath this it\ntells you that by default it\n\n360\n00:17:54.580 --> 00:17:59.370\nuses 10.0.8.0/24 network if you do that.\n\n361\n00:17:59.370 --> 00:18:01.870\nSo sometimes you go I don't know,\nI've never set that up, well,\n\n362\n00:18:01.870 --> 00:18:04.960\nthat's what's happening if you didn't\npick one, by default, a lot of times.\n\n363\n00:18:04.960 --> 00:18:06.500\nSo we're gonna set this one up.\n\n364\n00:18:06.500 --> 00:18:10.940\nThe reason why is that, again, on my\nnetwork inside of my LAN that I'm setting\n\n365\n00:18:10.940 --> 00:18:16.710\nup here I'm using the 172.16.21\nnetwork just as an example.\n\n366\n00:18:16.710 --> 00:18:19.530\nNow in the local network that I\nwant somebody to be able to access,\n\n367\n00:18:19.530 --> 00:18:20.070\nit's down here.\n\n368\n00:18:20.070 --> 00:18:22.980\nSo I'm skipping over\nthe IPv6 Tunnel Network, and\n\n369\n00:18:22.980 --> 00:18:27.360\nthen on the local network I'm just\ngonna set up my own LAN address,\n\n370\n00:18:27.360 --> 00:18:31.280\nwhich is gonna be a /24 here,\nfor a 24 bit subnet mask.\n\n371\n00:18:31.280 --> 00:18:35.280\nAnd notice I don't have the IPv6 network.\n\n372\n00:18:35.280 --> 00:18:37.430\nSo I'm gonna scroll on down.\n\n373\n00:18:37.430 --> 00:18:40.860\nAnd then we have to provide of course\ninformation about the remote side that we\n\n374\n00:18:40.860 --> 00:18:42.450\nare connecting into.\n\n375\n00:18:42.450 --> 00:18:47.840\nSo on that remote network on the IPv4,\nit's going to be 192.168.1.,\n\n376\n00:18:47.840 --> 00:18:51.160\noops, I did 1.1 that was not gonna work.\n\n377\n00:18:51.160 --> 00:18:55.330\nIt's gonna be the 1.0 network,\nwith the /24.\n\n378\n00:18:55.330 --> 00:18:57.540\nSo we are now setting up that connection.\n\n379\n00:18:57.540 --> 00:19:02.111\nNow, on the remote side,\nI've set up my 192.168.1.0 with a /24 cuz\n\n380\n00:19:02.111 --> 00:19:07.530\nthat's the other side, that's side b, and\nI'm not gonna set up the IPv6 network.\n\n381\n00:19:07.530 --> 00:19:10.900\nNow, under Concurrent connections,\nwe can go ahead and set a max limit.\n\n382\n00:19:10.900 --> 00:19:12.820\nIt's gonna set whatever it's default is.\n\n383\n00:19:12.820 --> 00:19:15.000\nIt says you can specify the max number.\n\n384\n00:19:15.000 --> 00:19:17.250\nIf I choose to limit it I can, but\n\n385\n00:19:17.250 --> 00:19:19.920\nDon I don't think I've ever\nactually set a number here.\n\n386\n00:19:19.920 --> 00:19:21.480\nIs there a reason why I should do that?\n\n387\n00:19:21.480 --> 00:19:23.670\n>> It comes down to resource utilization,\nright?\n\n388\n00:19:23.670 --> 00:19:27.780\nIf you're handling a large number of\nbranches, and these are dynamic tunnels\n\n389\n00:19:27.780 --> 00:19:30.350\nthat come up and go down,\nthen you might want to set a limit.\n\n390\n00:19:30.350 --> 00:19:32.370\nOn a site to site we don't normally do it.\n\n391\n00:19:32.370 --> 00:19:35.860\nOn a remote access VPN we might, and so\nthat's why that functionality is there.\n\n392\n00:19:37.280 --> 00:19:41.120\n>> And then as we continue on through\nnotice that we also have the ability to\n\n393\n00:19:41.120 --> 00:19:44.350\ncompress this traffic to give us\na little bit better performance too,\n\n394\n00:19:44.350 --> 00:19:46.040\nbut you do have to be careful.\n\n395\n00:19:46.040 --> 00:19:49.470\nSometimes you may also run across another\nconnection in which on the other side.\n\n396\n00:19:49.470 --> 00:19:51.550\nIt may not actually do all\nthe ones that you want to, but\n\n397\n00:19:51.550 --> 00:19:53.010\nnotice you can actually do adaptive,\n\n398\n00:19:53.010 --> 00:19:56.840\nor disabled if you actually don't want\nto compress any of the traffic at all.\n\n399\n00:19:59.040 --> 00:20:00.890\nNow Don, there's a couple\nof other options down here,\n\n400\n00:20:00.890 --> 00:20:04.460\nthe type of service, and\nthen duplicate connections too.\n\n401\n00:20:04.460 --> 00:20:08.210\nIt says for us to set the IP header\nvalue of the tunnel packets to match\n\n402\n00:20:08.210 --> 00:20:10.010\nthe encapsulated packet value?\n\n403\n00:20:10.010 --> 00:20:12.570\n>> Yeah, and these are things that\nmost of us aren't going to need.\n\n404\n00:20:12.570 --> 00:20:15.890\nIf you're doing quality of service you've\ntypically done it before you hit your WAN\n\n405\n00:20:15.890 --> 00:20:18.100\nlink, which means before\nyou hit your firewall.\n\n406\n00:20:18.100 --> 00:20:20.110\nSo quality of service is already applied.\n\n407\n00:20:20.110 --> 00:20:20.960\nAnd we don't sweat it.\n\n408\n00:20:20.960 --> 00:20:24.630\nBut if you wanna carry your QoS data\nover from one side to another and\n\n409\n00:20:24.630 --> 00:20:28.950\nyou're doing type of service, TOS,\nthen you can have it preserve that value,\n\n410\n00:20:28.950 --> 00:20:31.030\notherwise the value actually gets erased.\n\n411\n00:20:31.030 --> 00:20:33.480\nSame thing goes for\nthings like duplicate connections.\n\n412\n00:20:33.480 --> 00:20:37.080\nIf it's a site to site tunnel,\nwe're hard coding this to an IP.\n\n413\n00:20:37.080 --> 00:20:40.160\nSo somebody would have to try and\nspoof our IP to come in on that.\n\n414\n00:20:40.160 --> 00:20:43.220\nAnd that's not something that we're\ntypically gonna have to deal with.\n\n415\n00:20:43.220 --> 00:20:45.980\nBut if this were a remote\naccess VPN we would, right,\n\n416\n00:20:45.980 --> 00:20:49.070\npotentially if you have more than one\nperson trying to come in as a masquerade,\n\n417\n00:20:49.070 --> 00:20:51.610\nso you might have to put some\nlimitations in for that.\n\n418\n00:20:51.610 --> 00:20:53.420\nBut these settings, the type of service,\n\n419\n00:20:53.420 --> 00:20:55.600\nthat would really be\nclient remote access side.\n\n420\n00:20:55.600 --> 00:20:57.646\nThe type of service same thing.\n\n421\n00:20:57.646 --> 00:21:01.820\nDisabling IPv6 that's just if\nyou're not pushing IPv6 traffic,\n\n422\n00:21:01.820 --> 00:21:04.610\nthen why bother sending discoveries\nacross that VPN tunnel?\n\n423\n00:21:04.610 --> 00:21:06.250\nSo you can turn that off, too.\n\n424\n00:21:06.250 --> 00:21:08.990\nThese are all, you can leave it at\nthe defaults and it'll be fine, or\n\n425\n00:21:08.990 --> 00:21:10.220\nyou can adjust them if you have a need to.\n\n426\n00:21:10.220 --> 00:21:13.940\n>> And there's some other advanced options\ndown here that you can manually go in and\n\n427\n00:21:13.940 --> 00:21:15.900\nconfigure if you chose to.\n\n428\n00:21:15.900 --> 00:21:20.520\nI don't know all the syntax for doing this\nso you can find some people that will help\n\n429\n00:21:20.520 --> 00:21:24.110\nyou out with the syntax when you go to\npfSense forums, but overall, though,\n\n430\n00:21:24.110 --> 00:21:26.020\nI'm just gonna leave that for right now.\n\n431\n00:21:26.020 --> 00:21:29.640\n>> Yeah, for those advanced settings,\nit's not really a pfSense thing anymore.\n\n432\n00:21:29.640 --> 00:21:30.970\nNow it's OpenVPN.\n\n433\n00:21:30.970 --> 00:21:33.700\nAnd so what they're basically giving\nyou is access to OpenVPN's raw\n\n434\n00:21:33.700 --> 00:21:34.850\nconfiguration there.\n\n435\n00:21:34.850 --> 00:21:37.810\nSo if you have specialized configuration\ndata, you can throw it in there.\n\n436\n00:21:37.810 --> 00:21:40.650\nYou won't find help for that on\npfSense's website, or at least not much.\n\n437\n00:21:40.650 --> 00:21:44.475\nYou will find it on the OpenVPN site and\nyou can put in those customizations.\n\n438\n00:21:44.475 --> 00:21:46.685\nIt's if you want to adjust\nthings like tunnel lifetimes and\n\n439\n00:21:46.685 --> 00:21:48.515\nall that,\nthe values can all be done in there.\n\n440\n00:21:49.515 --> 00:21:52.975\n>> And then lastly is just the level of\noutput that you're also gonna get back\n\n441\n00:21:52.975 --> 00:21:56.085\nonce these connections are started,\nand we're leaving it at the default,\n\n442\n00:21:56.085 --> 00:21:58.705\nwhich is the Level 3, which tells\nyou it's recommended if you want\n\n443\n00:21:58.705 --> 00:22:02.575\na good summary of what's happening without\nbeing flooded by what you'll actually get.\n\n444\n00:22:02.575 --> 00:22:04.820\nNotice that you can actually go from,\nof course,\n\n445\n00:22:04.820 --> 00:22:08.410\nthese different ranges all the way from\nnone, all the way through level 11,\n\n446\n00:22:08.410 --> 00:22:12.540\nwhich apparently goes into the debugging,\nwhich is sending everything that you can.\n\n447\n00:22:12.540 --> 00:22:13.705\n>> It goes to 11 Ronnie.\n\n448\n00:22:13.705 --> 00:22:14.915\n>> [LAUGH] It goes to eleven.\n\n449\n00:22:14.915 --> 00:22:16.680\n>> [LAUGH]\n>> Same thing on your radio dial.\n\n450\n00:22:18.090 --> 00:22:21.730\nSo I'm just gonna go ahead and\nclick save now I went in and saved that.\n\n451\n00:22:21.730 --> 00:22:24.680\nRemember that what it did now\nis actually generated that key.\n\n452\n00:22:24.680 --> 00:22:27.530\nAnd that's something\nwe're gonna need to know.\n\n453\n00:22:27.530 --> 00:22:30.800\nSo I'm gonna come back over here and\njust show you the key for right now.\n\n454\n00:22:30.800 --> 00:22:34.130\nBut it's this shared key now,\nyou can see where it actually generated\n\n455\n00:22:34.130 --> 00:22:36.450\na longer key than I could\never come up with, Don.\n\n456\n00:22:36.450 --> 00:22:41.030\nSo here it is,\nit says an OpenVPN static key version 1.\n\n457\n00:22:41.030 --> 00:22:43.080\nSo it's right here that we have this key.\n\n458\n00:22:43.080 --> 00:22:46.820\nAnd that key is actually also what's going\nto be needed over on the client side.\n\n459\n00:22:48.450 --> 00:22:50.413\n>> Yeah and as far as the client\nside configuration goes,\n\n460\n00:22:50.413 --> 00:22:51.780\nit's really pretty easy.\n\n461\n00:22:51.780 --> 00:22:54.540\nWe pretty much just do\nthe same thing we just did.\n\n462\n00:22:54.540 --> 00:22:57.800\nThe only difference is we reversed\nsome of the numbers around.\n\n463\n00:22:57.800 --> 00:22:59.830\nOur local network versus\nthe remote network.\n\n464\n00:22:59.830 --> 00:23:02.020\nIt's just gonna be the opposite\nof what we did here.\n\n465\n00:23:02.020 --> 00:23:03.550\nBut otherwise,\nthe configuration is the same.\n\n466\n00:23:05.180 --> 00:23:10.500\n>> I'm going to go ahead, I think,\nand copy this key for right now.\n\n467\n00:23:10.500 --> 00:23:16.430\nAnd then we need to go over and we need\nto configure the firewall at this point.\n\n468\n00:23:16.430 --> 00:23:18.210\nWe need to configure some NAT rules, and\n\n469\n00:23:18.210 --> 00:23:20.610\nwe need to configure some\nregular firewall rules as well.\n\n470\n00:23:22.390 --> 00:23:26.230\nSo if I go ahead and click on Firewall,\nI'm gonna go down to Rules,\n\n471\n00:23:26.230 --> 00:23:29.510\nmakes logical sense for\nme to set this up first in this way.\n\n472\n00:23:29.510 --> 00:23:31.270\nSo there's a couple of\nthings that we need.\n\n473\n00:23:31.270 --> 00:23:35.600\nOne, on the WAN side notice that there\nare no rules that are actually connected\n\n474\n00:23:35.600 --> 00:23:38.580\nright now, so in other words,\nnothing's gonna pass this.\n\n475\n00:23:38.580 --> 00:23:41.941\nSo I need to open this up to\nthat port number that I also set\n\n476\n00:23:41.941 --> 00:23:46.177\nup which is port 1195 to be able to\ngain access to my WAN interface.\n\n477\n00:23:46.177 --> 00:23:50.773\nSo inside of the WAN rule, I'm gonna\ngo ahead and click on the plus sign and\n\n478\n00:23:50.773 --> 00:23:51.971\ncreate a new rule.\n\n479\n00:23:51.971 --> 00:23:56.393\nAnd we're gonna allow this traffic\nto pass through the WAN interface.\n\n480\n00:23:56.393 --> 00:23:59.935\nAnd by default, they set this up for UDP.\n\n481\n00:23:59.935 --> 00:24:01.838\nSo I'm gonna change this to UDP.\n\n482\n00:24:01.838 --> 00:24:06.780\nAnd the Source, we're not so worried about\nit cuz it's a site-to-site connection.\n\n483\n00:24:06.780 --> 00:24:12.630\nAnd then the Destination, I need to change\nthe destination to the WAN address.\n\n484\n00:24:12.630 --> 00:24:13.780\nSo we can access it here.\n\n485\n00:24:15.110 --> 00:24:18.810\nAnd then on the Destination port range,\nthat's gonna be the same one.\n\n486\n00:24:18.810 --> 00:24:21.550\nNow this is where I've\ngotten in trouble before,\n\n487\n00:24:21.550 --> 00:24:23.710\nbecause I just didn't remember\nwhat the port number was.\n\n488\n00:24:23.710 --> 00:24:26.170\nAnd I just went ahead and\nclicked on through.\n\n489\n00:24:26.170 --> 00:24:28.380\nBut that's the only thing\nthat I'm opening up for.\n\n490\n00:24:28.380 --> 00:24:30.324\nIs just port 1195 here.\n\n491\n00:24:30.324 --> 00:24:31.286\n>> I thought it was 1194.\n\n492\n00:24:31.286 --> 00:24:32.120\nDo we change the port numbers?\n\n493\n00:24:32.120 --> 00:24:34.205\n>> I did.\nI changed the port number to 1195.\n\n494\n00:24:34.205 --> 00:24:36.015\n>> Shows how much attention I pay [LAUGH].\n\n495\n00:24:37.730 --> 00:24:38.950\n>> And I'm gonna go ahead and click Save.\n\n496\n00:24:40.320 --> 00:24:45.560\nSo that should actually allow the traffic\nto come through on the WAN port.\n\n497\n00:24:45.560 --> 00:24:47.416\nThat's actually going to\nbe going to open VPN.\n\n498\n00:24:47.416 --> 00:24:50.997\nAnd notice on the Firewall Rules,\nnow I also have the open VPN.\n\n499\n00:24:50.997 --> 00:24:55.186\nSo this is now actually going to say hey,\nhere I need to go ahead and create some\n\n500\n00:24:55.186 --> 00:24:59.264\nrules and apparently I went ahead and\ndid that already, it did that for me.\n\n501\n00:24:59.264 --> 00:25:00.115\n>> It does that automatically.\n\n502\n00:25:00.115 --> 00:25:01.140\n>> Okay, it does it automatically.\n\n503\n00:25:01.140 --> 00:25:01.742\nI was gonna say,\n\n504\n00:25:01.742 --> 00:25:03.342\nI don't remember creating those,\n>> [LAUGH]\n\n505\n00:25:03.342 --> 00:25:04.330\n>> But there it is.\n\n506\n00:25:04.330 --> 00:25:05.710\nSo it actually allows me to go ahead and\n\n507\n00:25:05.710 --> 00:25:09.930\ndo ping to be able to get\nthrough to my own LAN network.\n\n508\n00:25:09.930 --> 00:25:11.210\nAnd so it does that.\n\n509\n00:25:11.210 --> 00:25:13.480\nAnd then of course,\nthe actual traffic too.\n\n510\n00:25:13.480 --> 00:25:15.745\n>> And the default is that it's wide open.\n\n511\n00:25:15.745 --> 00:25:17.660\n>> [LAUGH]\n>> Anybody at another site can get to\n\n512\n00:25:17.660 --> 00:25:20.590\nanything on your local site,\nthat's the default rule.\n\n513\n00:25:20.590 --> 00:25:22.990\nYou might need to come back and\nrestrict that a little bit.\n\n514\n00:25:22.990 --> 00:25:25.550\n>> Now, even though you think you're done,\nyou still have to go in and\n\n515\n00:25:25.550 --> 00:25:27.270\nset up some NAT rules as well.\n\n516\n00:25:27.270 --> 00:25:31.650\nNow the good thing is they've generated\nit for you, but it doesn't show up and so\n\n517\n00:25:31.650 --> 00:25:33.650\nsometimes you have to\ngo to Firewall > NAT.\n\n518\n00:25:35.190 --> 00:25:39.180\nAnd then Outbound for the return stuff.\n\n519\n00:25:39.180 --> 00:25:40.680\nAnd so even though the automatic,\n\n520\n00:25:40.680 --> 00:25:44.730\nyou actually start seeing,\nis added in the tunnel already.\n\n521\n00:25:44.730 --> 00:25:48.010\nSometimes when it's not actually\nexpanded out, it doesn't seem to work.\n\n522\n00:25:48.010 --> 00:25:49.550\nAnd I've had that happen, so\n\n523\n00:25:49.550 --> 00:25:54.760\nwhat I normally do is I go to Manual and\nthen I click Save.\n\n524\n00:25:54.760 --> 00:25:58.250\nAnd then I just verify that\nthose rules actually did appear.\n\n525\n00:25:58.250 --> 00:26:00.781\nAnd what we're looking for\nare the Auto created rules for\n\n526\n00:26:00.781 --> 00:26:04.320\nOpenVPN down here, on that port 500,\nas well as all the other ports.\n\n527\n00:26:06.170 --> 00:26:06.780\nOkay?\n\n528\n00:26:06.780 --> 00:26:10.130\nSo there is actually creating for\nthat tunnel network and you see that.\n\n529\n00:26:10.130 --> 00:26:16.250\nSo we are actually now ready to then,\nsay apply the changes.\n\n530\n00:26:16.250 --> 00:26:20.510\nAnd from this point on the server side,\nI think everything is actually configured.\n\n531\n00:26:20.510 --> 00:26:22.990\nUnless I've just forgot\nto configure something.\n\n532\n00:26:22.990 --> 00:26:25.240\nSo we should be ready on the server side.\n\n533\n00:26:25.240 --> 00:26:26.650\nWe still have the client side to go.\n\n534\n00:26:26.650 --> 00:26:27.250\n>> Yeah.\n\n535\n00:26:27.250 --> 00:26:29.940\nNow the only other thing to be\naware of on Ronnie's rules,\n\n536\n00:26:29.940 --> 00:26:31.990\nIf you go back to your Firewall Rules.\n\n537\n00:26:31.990 --> 00:26:36.790\nWhen he set up the rule,\nhe set the Source as anything and\n\n538\n00:26:36.790 --> 00:26:40.040\nthe Destination is the WAN interface\nof this firewall, all right?\n\n539\n00:26:40.040 --> 00:26:44.390\nIf the other site has a dynamic IP,\nthat's exactly what you need, right?\n\n540\n00:26:44.390 --> 00:26:46.150\nIf you don't know what their\nIP address is gonna be,\n\n541\n00:26:46.150 --> 00:26:49.560\nif it's DHCP from an internet service\nprovider, that's what you need.\n\n542\n00:26:49.560 --> 00:26:50.900\nBut if the other side has a static IP,\n\n543\n00:26:50.900 --> 00:26:53.660\nyou can actually improve\nyour security a little more.\n\n544\n00:26:53.660 --> 00:26:56.350\nBy putting a source IP address\nof that remote office.\n\n545\n00:26:56.350 --> 00:27:00.800\nAnd that way, only that remote office can\nbuild a VPN tunnel up on that port 1195\n\n546\n00:27:00.800 --> 00:27:05.820\nand that stop people from other IPs,\neven being able to see that port.\n\n547\n00:27:05.820 --> 00:27:08.360\nSo it just tightens security\na little bit more on that.\n\n548\n00:27:08.360 --> 00:27:10.780\nEven if somebody tried to connect though,\nthey'd still have to authenticate.\n\n549\n00:27:10.780 --> 00:27:12.550\nThey don't have the keys to your safe, but\n\n550\n00:27:12.550 --> 00:27:14.020\nit's just one extra\nlevel that we can go on.\n\n551\n00:27:15.360 --> 00:27:16.340\nAll right.\nWell, at\n\n552\n00:27:16.340 --> 00:27:18.780\nthis point we've seen the server set up.\n\n553\n00:27:18.780 --> 00:27:22.330\nWe need to see the client set up and\nthen the other final piece of it.\n\n554\n00:27:22.330 --> 00:27:24.970\nBut we kind of chatted a little\ntoo long in this one, so\n\n555\n00:27:24.970 --> 00:27:26.470\nI think we've reached\nthe end of this segment.\n\n556\n00:27:26.470 --> 00:27:30.700\nSo why don't we stop here and\nwe'll just call this our server set up.\n\n557\n00:27:30.700 --> 00:27:32.830\nAnd then stay tuned cuz we've got\nanother episode coming up and\n\n558\n00:27:32.830 --> 00:27:34.140\nwe'll do the client side.\n\n559\n00:27:34.140 --> 00:27:37.790\nAnd get that connected and actually verify\nthe tunnel is up and flowing traffic.\n\n560\n00:27:37.790 --> 00:27:44.632\nSo stay tuned for that,\nwe'll be back in a bit.\n\n561\n00:27:44.632 --> 00:27:47.360\n>> [SOUND]\n\n",
          "vimeoId": "130538616"
        },
        {
          "description": null,
          "length": "1432",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-2-site_to_site_openvpn-061215-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-2-site_to_site_openvpn-061215-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-2-site_to_site_openvpn-061215-1-sm.jpg",
          "title": "Site-to-Site OpenVPN Client",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:07.517\n[MUSIC]\n\n2\n00:00:07.517 --> 00:00:12.243\nIn this segment we're going to take a look\nat configuring an OpenVPN site-to-site\n\n3\n00:00:12.243 --> 00:00:13.650\nconnection.\n\n4\n00:00:13.650 --> 00:00:16.940\nIn our previous episode we filmed\nconfiguring the server side.\n\n5\n00:00:16.940 --> 00:00:19.540\nThis is now our part two we're going\nto take a look at the client side,\n\n6\n00:00:19.540 --> 00:00:21.790\nthe remote side of that VPN connection.\n\n7\n00:00:21.790 --> 00:00:24.290\nIf you haven't watched the first episode\nyou definitely want to jump over and\n\n8\n00:00:24.290 --> 00:00:27.358\ncheck that one out because really all\nthe hard work is done on the server.\n\n9\n00:00:27.358 --> 00:00:29.590\nOn the client side we're really\njust kind of cloning that and\n\n10\n00:00:29.590 --> 00:00:31.900\nthen bringing up the tunnel and\nmaking sure that it works.\n\n11\n00:00:31.900 --> 00:00:34.420\nBut it is important because if\nanything goes wrong here is where our\n\n12\n00:00:34.420 --> 00:00:36.200\ntroubleshooting is going to happen.\n\n13\n00:00:36.200 --> 00:00:39.450\nSo again if you haven't seen that first\nepisode definitely check it out but\n\n14\n00:00:39.450 --> 00:00:42.000\nif you're here for the second one\nlet's go ahead and get started.\n\n15\n00:00:42.000 --> 00:00:46.100\nSo Ronnie give me a little recap cuz I,\nyou know it's a new day,\n\n16\n00:00:46.100 --> 00:00:47.210\nI kinda forget where we've been.\n\n17\n00:00:47.210 --> 00:00:48.560\nWhere did we leave off?\n\n18\n00:00:48.560 --> 00:00:50.990\n>> Let's go ahead and\ntake a look at my computer.\n\n19\n00:00:50.990 --> 00:00:53.960\nI've got a diagram for\nthe very simple network that I've set up\n\n20\n00:00:53.960 --> 00:00:57.275\nto be able to create this\nOpenVPN site-to-site connection.\n\n21\n00:00:57.275 --> 00:01:02.385\nIn our previous episode, we went ahead and\nconfigured the server side of things so\n\n22\n00:01:02.385 --> 00:01:04.485\nthat the OpenVPN is now ready to go.\n\n23\n00:01:04.485 --> 00:01:07.945\nWe had to actually put in\nthe basic configuration for\n\n24\n00:01:07.945 --> 00:01:10.705\nthe OpenVPN server, we had to go in and\n\n25\n00:01:10.705 --> 00:01:14.595\nchange a couple of firewall rules and\nalso of course, NAT rules.\n\n26\n00:01:14.595 --> 00:01:20.650\nNow in that OpenVPN server side,\nit also generated for us a shared key,\n\n27\n00:01:20.650 --> 00:01:23.940\nand I went in and copied that shared\nkey because that is about the piece of\n\n28\n00:01:23.940 --> 00:01:28.330\ninformation that I need to also make sure\nthat it gets over here on this side too.\n\n29\n00:01:28.330 --> 00:01:29.380\nWhich is over on the client side.\n\n30\n00:01:29.380 --> 00:01:31.240\nAnd that's what we're\ngoing to be configuring,\n\n31\n00:01:31.240 --> 00:01:34.420\nis the right-hand side of this diagram,\nor our client so\n\n32\n00:01:34.420 --> 00:01:37.730\nthat we can actually establish this\ntunnel connection all the way through.\n\n33\n00:01:37.730 --> 00:01:40.380\nSo I'm gonna switch on over\nto that machine that's gonna\n\n34\n00:01:40.380 --> 00:01:45.220\nallow me to get access to the pfSense box.\n\n35\n00:01:45.220 --> 00:01:48.900\nAnd so here on my dashboard this is\ngonna be my firewall for site b.\n\n36\n00:01:48.900 --> 00:01:51.890\nEverything's actually up and\nworking in the way that I need to be.\n\n37\n00:01:51.890 --> 00:01:57.810\nI went ahead and I copied that shared\nkey into just a text file that\n\n38\n00:01:57.810 --> 00:02:02.930\nI've actually put here on my desktop, and\nwe'll be using that in a moment as well.\n\n39\n00:02:02.930 --> 00:02:06.050\nSo then we're gonna go ahead and\nbegin our configuration.\n\n40\n00:02:06.050 --> 00:02:09.920\nSo once we're actually on our pfSense box,\nI'm gonna go ahead and click on VPN.\n\n41\n00:02:09.920 --> 00:02:12.070\nAnd because the other side is the OpenVPN,\n\n42\n00:02:12.070 --> 00:02:15.960\nI'm gonna select OpenVPN\non this side as well.\n\n43\n00:02:15.960 --> 00:02:18.810\nAnd then, instead of actually creating\nanother server, even though it's\n\n44\n00:02:18.810 --> 00:02:23.590\na site-to-site, OpenVPN actually works\nas a client and the server side.\n\n45\n00:02:23.590 --> 00:02:26.680\nWe're gonna actually\nselect client this time.\n\n46\n00:02:26.680 --> 00:02:28.440\nAnd once we go ahead and click on client,\n\n47\n00:02:28.440 --> 00:02:30.750\nI'm gonna click on\nthe plus sign right here,\n\n48\n00:02:30.750 --> 00:02:36.070\nand that will give me the opportunity to\nbegin the configuration that I need to.\n\n49\n00:02:36.070 --> 00:02:40.170\nSo in the general information, the nice\nthing is the majority of it is the same as\n\n50\n00:02:40.170 --> 00:02:45.080\nthe other side, so I'm gonna change\nthe server mode to peer to peer.\n\n51\n00:02:45.080 --> 00:02:48.770\nNow, that's gonna actually allow me\nto get that shared key that I need.\n\n52\n00:02:48.770 --> 00:02:52.340\nSo I need to go ahead and\ncopy that and get it ready to go.\n\n53\n00:02:52.340 --> 00:02:53.130\nSo let me do that.\n\n54\n00:02:53.130 --> 00:02:55.190\nLet me minimize this for a moment and\n\n55\n00:02:55.190 --> 00:02:59.420\ntake a look at the multiple copies of the\nshared key that I've got opened up here.\n\n56\n00:02:59.420 --> 00:03:01.290\n>> I like how you pretend like\nyou don't have this memorized.\n\n57\n00:03:01.290 --> 00:03:04.520\n>> I know, yeah, it's amazing that\nI don't have it memorized at all.\n\n58\n00:03:06.000 --> 00:03:10.336\nThat key is actually going to become very\nimportant in just little bit lower down\n\n59\n00:03:10.336 --> 00:03:11.810\nhere on my screen.\n\n60\n00:03:11.810 --> 00:03:14.810\nLeave it at the default up here,\nthe UDP, and\n\n61\n00:03:14.810 --> 00:03:18.342\nverify that this is actually going to be\non my WAN link, which is what I need.\n\n62\n00:03:18.342 --> 00:03:20.540\n>> And remember, if you change\nthese settings on the server,\n\n63\n00:03:20.540 --> 00:03:21.480\nyou have to change them here too.\n\n64\n00:03:21.480 --> 00:03:25.410\nIf the server is set for UDP or TCP,\nthen this site needs to be set for TCP.\n\n65\n00:03:25.410 --> 00:03:28.980\nIf the server is in TAP mode, and not TOMA\nmode, we need this one to be in TAP mode,\n\n66\n00:03:28.980 --> 00:03:32.560\nso you gotta make sure that\nthose systems are consistent.\n\n67\n00:03:32.560 --> 00:03:36.620\n>> Yes, if not you will run into\nissues such as it not working.\n\n68\n00:03:36.620 --> 00:03:38.300\nSo the server and the host address,\n\n69\n00:03:38.300 --> 00:03:41.640\nthis is gonna be the WAN\naddress of the other side.\n\n70\n00:03:41.640 --> 00:03:49.216\nSo that should be 209, whoops if I can\nactually type in there, 209.251.159.\n\n71\n00:03:49.216 --> 00:03:51.164\nAnd .178.\n\n72\n00:03:51.164 --> 00:03:55.180\nAnd this is also the other\nimportant piece of information too.\n\n73\n00:03:55.180 --> 00:03:57.320\nIf I set it up on a different port,\n\n74\n00:03:57.320 --> 00:04:00.310\nI need to make sure that I change\nthis port to match the other side.\n\n75\n00:04:00.310 --> 00:04:00.950\nAnd I did.\n\n76\n00:04:00.950 --> 00:04:03.690\nI changed it to Port 1195.\n\n77\n00:04:03.690 --> 00:04:06.850\nAnd from there I'm just\nkind of scrolling down.\n\n78\n00:04:06.850 --> 00:04:10.090\nAnd this is where I need that\nkey that I just copied in as in\n\n79\n00:04:10.090 --> 00:04:11.790\nthe cryptographic settings.\n\n80\n00:04:11.790 --> 00:04:13.640\nNow I could automatically\ngenerate a shared key, but\n\n81\n00:04:13.640 --> 00:04:15.360\nthat's not gonna help me right now.\n\n82\n00:04:15.360 --> 00:04:17.730\nSince this is the client,\nI'm going to uncheck that, and\n\n83\n00:04:17.730 --> 00:04:19.730\nyou actually have this nice box.\n\n84\n00:04:19.730 --> 00:04:22.720\nAnd since I already copied\nit into my clipboard,\n\n85\n00:04:22.720 --> 00:04:26.590\nI can then just click into it and\njust paste it in there.\n\n86\n00:04:26.590 --> 00:04:29.480\nHopefully I don't do anything else\nthat'll actually add any other issues or\n\n87\n00:04:29.480 --> 00:04:30.280\nproblems to that.\n\n88\n00:04:31.440 --> 00:04:34.250\n>> The reason it offers the auto-generated\nkey is that you might be\n\n89\n00:04:34.250 --> 00:04:37.550\nsetting up the clients first and\nthen setting up the server afterwards.\n\n90\n00:04:37.550 --> 00:04:39.840\nSo, you generate the key here and\ncopy it to the server.\n\n91\n00:04:39.840 --> 00:04:43.830\nWe generated it on the server first, so\nthere's no need to autogenerate it here.\n\n92\n00:04:43.830 --> 00:04:46.950\n>> So I'm just going to leave\nthe default encryption standards here,\n\n93\n00:04:46.950 --> 00:04:49.960\nso I don't actually do anything\nelse that I'd need to.\n\n94\n00:04:49.960 --> 00:04:51.500\nAnd so\nyou'll actually see where it says hey,\n\n95\n00:04:51.500 --> 00:04:54.170\nset this to SHA1 unless\nthe server is set to match.\n\n96\n00:04:54.170 --> 00:04:55.390\nSHA1 is the default.\n\n97\n00:04:55.390 --> 00:04:58.290\nWhy not leave the default and\nwe'll be fine and ready to go.\n\n98\n00:04:58.290 --> 00:05:00.890\n>> Yeah, and these options right here,\nthey do have to match.\n\n99\n00:05:00.890 --> 00:05:04.020\nIf any one of these don't match,\nyour tunnel is not going to come up.\n\n100\n00:05:04.020 --> 00:05:07.520\nThe only one that can be different\nis the hardware acceleration one.\n\n101\n00:05:07.520 --> 00:05:10.940\nI might have a hardware accelerator\nat my headquarters, but\n\n102\n00:05:10.940 --> 00:05:13.380\nI might not have a hardware\naccelerator at my branch office.\n\n103\n00:05:13.380 --> 00:05:15.760\nYou know at a branch office, they're just\ngonna have one tunnel that builds up.\n\n104\n00:05:15.760 --> 00:05:16.850\nThey're the client.\n\n105\n00:05:16.850 --> 00:05:20.530\nBut at headquarters, I might have 100\ndifferent branches connecting to it and so\n\n106\n00:05:20.530 --> 00:05:23.000\nI might really benefit from\na hardware accelerator there.\n\n107\n00:05:23.000 --> 00:05:27.060\nSo that one can be different, but\nthe other ones, the hashing algorithm,\n\n108\n00:05:27.060 --> 00:05:27.930\nthe encryption algorithm,\n\n109\n00:05:27.930 --> 00:05:30.560\nthe key, those have to be identical\nbetween the client and the server.\n\n110\n00:05:31.670 --> 00:05:34.780\n>> And then we have to set up\nof course the tunnel settings.\n\n111\n00:05:34.780 --> 00:05:39.570\nNow on the other side we created another\ntunnel connection, we did a just a regular\n\n112\n00:05:39.570 --> 00:05:43.150\n30 bit subnet mask in other words\nallowing only two IP addresses so\n\n113\n00:05:43.150 --> 00:05:45.460\nthat we can have that point\nto point encryption or\n\n114\n00:05:45.460 --> 00:05:48.400\nconnection between our server and\nour client.\n\n115\n00:05:48.400 --> 00:05:49.410\nSo I'm gonna match that.\n\n116\n00:05:49.410 --> 00:05:53.880\nWhich this is gonna\n\n117\n00:05:53.880 --> 00:05:58.940\nbe 22 0 with a /30 that should give\nme one and two as my tunnel network.\n\n118\n00:05:58.940 --> 00:06:02.780\nI don't have any IP version 6 stuff set\nup so I'm not gonna worry about that one.\n\n119\n00:06:02.780 --> 00:06:05.580\nAnd then of course the network\nthat I want to try and access.\n\n120\n00:06:05.580 --> 00:06:06.804\nAnd that's gonna be the remote network.\n\n121\n00:06:06.804 --> 00:06:12.537\nWhich is going to be 1721621.0\nwith a /24 and once again,\n\n122\n00:06:12.537 --> 00:06:18.650\nwithout IP version 6,\nI'm not going to worry about that either.\n\n123\n00:06:18.650 --> 00:06:21.400\nAnd the rest of these options I'm\njust going to leave the default\n\n124\n00:06:21.400 --> 00:06:24.700\nbecause we're just trying to get\nthe tunnel up and going at this point.\n\n125\n00:06:24.700 --> 00:06:27.820\nAnd also these advanced options\nI'm gonna leave at the default.\n\n126\n00:06:27.820 --> 00:06:29.560\nAnd that verbosity level\nshould produce for\n\n127\n00:06:29.560 --> 00:06:32.830\nme some log output that can help\nme to do some troubleshooting.\n\n128\n00:06:32.830 --> 00:06:34.720\nBut in fact if we need to\na little bit later on,\n\n129\n00:06:34.720 --> 00:06:37.670\nin other words I don't get this\nsetup correctly and I need to\n\n130\n00:06:37.670 --> 00:06:41.240\nget more information, I might have to\nturn this level up when I come back in.\n\n131\n00:06:41.240 --> 00:06:43.900\nSo I'm just gonna leave it at\nthe default for right now.\n\n132\n00:06:43.900 --> 00:06:44.880\nAnd click save.\n\n133\n00:06:46.080 --> 00:06:50.540\nAnd once that's saved I can see that the\nclient is actually set up at this point,\n\n134\n00:06:50.540 --> 00:06:53.720\nbut I still need to verify on the firewall\n\n135\n00:06:53.720 --> 00:06:56.840\nrules that we can actually get the\nconnection that we need to, to get going.\n\n136\n00:06:56.840 --> 00:06:59.010\nSo I need to also add in\nsome firewall rules and\n\n137\n00:06:59.010 --> 00:07:01.290\nalso change some NAT rules as well.\n\n138\n00:07:01.290 --> 00:07:04.610\nSo if I go to firewall,\nI can go down to rules.\n\n139\n00:07:06.430 --> 00:07:08.560\nAnd notice right now on the WAN interface.\n\n140\n00:07:08.560 --> 00:07:10.790\nThere's no connections\nactually allowed on this side.\n\n141\n00:07:10.790 --> 00:07:14.810\nIt was just a kind of\nstandard default install.\n\n142\n00:07:14.810 --> 00:07:17.590\nI just changed a couple of\nIP addresses and the name.\n\n143\n00:07:17.590 --> 00:07:20.720\nBut now, without anything actually\nallowed to go through it doesn't\n\n144\n00:07:20.720 --> 00:07:22.340\nmatter if the other side's set up.\n\n145\n00:07:22.340 --> 00:07:25.280\nAnd now my client set up is not\ngoing to be able to get through.\n\n146\n00:07:25.280 --> 00:07:27.050\nSo, I need to open up the port to that,\n\n147\n00:07:27.050 --> 00:07:31.970\nI need to open a connection to that\nport 1195, is what I need to do here.\n\n148\n00:07:31.970 --> 00:07:34.490\nSo, I'm going to go ahead and\nclick on this plus sign to add a new rule.\n\n149\n00:07:35.940 --> 00:07:39.110\nVerify that I'm allowing\nthe traffic to pass.\n\n150\n00:07:39.110 --> 00:07:41.280\nAnd that's coming in on the WAN interface.\n\n151\n00:07:42.460 --> 00:07:45.420\nAnd because we're actually\nusing UDP on the inside,\n\n152\n00:07:45.420 --> 00:07:47.980\nI'm going to select UDP here\non the protocol version.\n\n153\n00:07:49.530 --> 00:07:52.058\nAnd we can go in and limit this\na little bit more if we wanted to,\n\n154\n00:07:52.058 --> 00:07:54.016\nto actually say what\nnetworks we won't allow.\n\n155\n00:07:54.016 --> 00:07:56.420\nI'm just going to leave it at any for\nthis point.\n\n156\n00:07:56.420 --> 00:08:00.310\nBut I am gonna tell it that I\nwant it only to my WAN address.\n\n157\n00:08:00.310 --> 00:08:04.640\nAnd then under the destination port range,\nonly for that 1195.\n\n158\n00:08:04.640 --> 00:08:08.643\n>> And if you're headquarters, the server\nhas a static IP which is usually will,\n\n159\n00:08:08.643 --> 00:08:10.630\nyou can put that as the source.\n\n160\n00:08:10.630 --> 00:08:13.310\nAnd now,\nyou're saying only headquarters can\n\n161\n00:08:13.310 --> 00:08:17.130\nconnect on 1195 versus just anybody\nout there could try and connect.\n\n162\n00:08:17.130 --> 00:08:19.230\nAnd try and\nbuild up that open VPN connection.\n\n163\n00:08:19.230 --> 00:08:20.770\nThey'd still have to have your key.\n\n164\n00:08:20.770 --> 00:08:25.070\nSo it's not that big of a risk but\nif you limit it to IP also,\n\n165\n00:08:25.070 --> 00:08:26.510\nit's an extra layer of security.\n\n166\n00:08:26.510 --> 00:08:30.660\nSo we will normally do that unless\nyou're dealing with the dynamic IP.\n\n167\n00:08:30.660 --> 00:08:35.080\nOpenVPN will let you have\na target that is a DNS host name\n\n168\n00:08:35.080 --> 00:08:37.900\nwhich is nice if you're gonna\nuse dynamic DNS or whatever.\n\n169\n00:08:37.900 --> 00:08:40.080\nBut if you're doing something like that,\n\n170\n00:08:40.080 --> 00:08:42.220\nyou can't make a firewall rule\naround it cuz that name changes.\n\n171\n00:08:42.220 --> 00:08:44.819\nSo that's a challenge\nthat we've got there.\n\n172\n00:08:44.819 --> 00:08:46.754\n>> So my WAN rule is actually here,\n\n173\n00:08:46.754 --> 00:08:50.410\nso that will allow that connection\nto come in which is fine.\n\n174\n00:08:50.410 --> 00:08:51.970\nThat's what we need.\n\n175\n00:08:51.970 --> 00:08:52.990\nThe other thing of course,\n\n176\n00:08:52.990 --> 00:08:56.800\nis actually gonna be what do I actually\nwant to go through that connection.\n\n177\n00:08:56.800 --> 00:09:00.170\nSo there on the OpenVPN,\nnow we have an interface.\n\n178\n00:09:00.170 --> 00:09:03.270\nI need to actually say hey, what type\nof traffic am I going to allow through?\n\n179\n00:09:03.270 --> 00:09:05.810\nWell, because I'm doing\njust a site to site,\n\n180\n00:09:05.810 --> 00:09:08.130\nI really want all\nthe traffic to come through.\n\n181\n00:09:08.130 --> 00:09:10.810\nBut I'm gonna separate it out\ninto two separate rules here, so\n\n182\n00:09:10.810 --> 00:09:13.410\nthat I can kind of be a little\nbit more granular about it.\n\n183\n00:09:13.410 --> 00:09:15.630\nI wanna allow PNGs to come through first.\n\n184\n00:09:15.630 --> 00:09:17.210\nSo you don't have to do that but\n\n185\n00:09:17.210 --> 00:09:20.860\nI like to do it cuz that gives me\na nice little test that I can do.\n\n186\n00:09:22.020 --> 00:09:23.260\nSo I'm gonna change that to ICP.\n\n187\n00:09:25.760 --> 00:09:34.133\nAnd then I want to actually allow it\nto come through to the LAN network.\n\n188\n00:09:34.133 --> 00:09:34.860\nAnd I'll save that.\n\n189\n00:09:36.050 --> 00:09:39.280\nVerify that that's actually good and\nthen I wanna allow all the other traffic.\n\n190\n00:09:39.280 --> 00:09:42.430\nI'm just gonna clone this rule.\n\n191\n00:09:42.430 --> 00:09:48.330\nI click on that plus sign, and then I'm\ngonna change the protocol to the TCP/UDP,\n\n192\n00:09:48.330 --> 00:09:51.070\nthat's really all that I need here.\n\n193\n00:09:51.070 --> 00:09:55.420\nSo this actually going to allow the ping\ntraffic as well as all the other\n\n194\n00:09:55.420 --> 00:09:57.690\nconnections to go through,\nif it's destined for\n\n195\n00:09:57.690 --> 00:10:00.740\nthe LAN on the OpenVPN interface.\n\n196\n00:10:01.830 --> 00:10:05.010\nSo that should be good for\nthose rules there.\n\n197\n00:10:05.010 --> 00:10:07.700\nAnd now,\nI just need to go up to the NAT rules.\n\n198\n00:10:07.700 --> 00:10:13.540\nSo if I go to Firewall and\nselect NAT and the Outbound.\n\n199\n00:10:13.540 --> 00:10:16.980\nAnd I can tell right now,\nif I look at the automatic rules.\n\n200\n00:10:16.980 --> 00:10:20.520\nIt looks like it's generated\neverything that I need to.\n\n201\n00:10:20.520 --> 00:10:23.320\nAnd you might actually go ahead and\ntry it and it might work, but\n\n202\n00:10:23.320 --> 00:10:25.380\nI've never had good luck with doing that.\n\n203\n00:10:25.380 --> 00:10:31.259\nI've always selected the manual and\nthen click Save and expanded it out here.\n\n204\n00:10:31.259 --> 00:10:33.430\nAnd that way, it actually lists it.\n\n205\n00:10:33.430 --> 00:10:35.760\nAnd now, you can actually\nsee the rules that applied.\n\n206\n00:10:35.760 --> 00:10:37.240\nYou can see that I didn't\nhave to generate these,\n\n207\n00:10:37.240 --> 00:10:41.380\nthis sys open VPN,\nit's auto created open VPN, auto created.\n\n208\n00:10:42.710 --> 00:10:46.840\nAnd then I'm going to apply\nthose changes and click close.\n\n209\n00:10:46.840 --> 00:10:49.050\nSo once we're done there,\n\n210\n00:10:49.050 --> 00:10:53.870\ngiven just a little bit of time\nthe connection should be done, Don.\n\n211\n00:10:53.870 --> 00:10:57.430\n>> Yeah, now the VPN tunnel a lot\nof times will come up on its own,\n\n212\n00:10:57.430 --> 00:11:00.710\nbut it's all based on what's\ncalled interesting traffic.\n\n213\n00:11:00.710 --> 00:11:03.420\nThe tunnel doesn't really\ncome up until you have\n\n214\n00:11:03.420 --> 00:11:06.370\ntraffic passing through your firewall\nthat's destined to use your tunnel.\n\n215\n00:11:06.370 --> 00:11:09.790\nRonnie set the remote network\nto what was it 172.16.?\n\n216\n00:11:09.790 --> 00:11:11.160\n>> 21.\n>> 21.\n\n217\n00:11:11.160 --> 00:11:14.930\nSo unless we have some traffic\nthat's headed with that destination,\n\n218\n00:11:14.930 --> 00:11:16.520\nthe firewall might not\nbring the tunnel up.\n\n219\n00:11:16.520 --> 00:11:19.130\nSo I really wouldn't be surprised\nif we went to check the status and\n\n220\n00:11:19.130 --> 00:11:20.490\nthe tunnel was down.\n\n221\n00:11:20.490 --> 00:11:23.890\nIf the tunnel was down, we'd just need to\ngenerate some traffic to bring it up but\n\n222\n00:11:23.890 --> 00:11:26.400\nwe can find out under the status screen.\n\n223\n00:11:26.400 --> 00:11:28.420\nAnd so right here we can look and.\n\n224\n00:11:28.420 --> 00:11:28.960\n>> Oh, no.\n\n225\n00:11:28.960 --> 00:11:30.081\n>> We're not showing this down-\n>> [LAUGH]\n\n226\n00:11:30.081 --> 00:11:30.770\n>> On this one, so\n\n227\n00:11:30.770 --> 00:11:34.162\nif you show down that just means\nthe firewall hasn't brought the tunnel up,\n\n228\n00:11:34.162 --> 00:11:35.350\nit's not a big deal.\n\n229\n00:11:35.350 --> 00:11:36.540\nYou can generate some traffic,\n\n230\n00:11:36.540 --> 00:11:40.010\nthere's a built in PNG generator under\nthe diagnostic tools you can use\n\n231\n00:11:40.010 --> 00:11:43.840\nto generate a PNG across the tunnel\nthen it should bring the tunnel up.\n\n232\n00:11:43.840 --> 00:11:45.676\nBut Ronnie's doesn't stay down.\n\n233\n00:11:45.676 --> 00:11:47.390\nOh, you're doing the PNG right now.\n\n234\n00:11:47.390 --> 00:11:51.790\nSo with Ronnie's, his is showing\nthat it's in a PNG reconnect.\n\n235\n00:11:52.790 --> 00:11:54.235\nAnd that's not so good, right?\n\n236\n00:11:54.235 --> 00:11:54.793\n>> Right.\n>> So this\n\n237\n00:11:54.793 --> 00:11:56.960\nmeans we've got some kind\nof problem with the tunnel.\n\n238\n00:11:56.960 --> 00:11:59.340\nAnd so we've gotta switch\ninto troubleshooting mode and\n\n239\n00:11:59.340 --> 00:12:01.685\nwhile I'd like to say this is uncommon,\nunfortunately it isn't.\n\n240\n00:12:01.685 --> 00:12:02.400\n>> [LAUGH]\n>> There's so\n\n241\n00:12:02.400 --> 00:12:05.460\nmany different pieces that\nwe could have left out.\n\n242\n00:12:05.460 --> 00:12:07.400\nThink of all the stuff\nthat Ronnie had to do.\n\n243\n00:12:07.400 --> 00:12:08.760\nWe had to configure the client VPN,\n\n244\n00:12:08.760 --> 00:12:11.530\nwhich had a lot of settings\nthat had to match the server.\n\n245\n00:12:11.530 --> 00:12:13.470\nAnd if any of those were different,\nit's gonna break.\n\n246\n00:12:13.470 --> 00:12:16.558\nHe had to configure the firewall\nrule to allow the traffic in.\n\n247\n00:12:16.558 --> 00:12:19.290\nHe had to configure the NAT rule to\nmake sure that we were NATting probably.\n\n248\n00:12:19.290 --> 00:12:22.690\nWell that's probably not what\nthis problem is, but it could be.\n\n249\n00:12:22.690 --> 00:12:27.008\nThese are all different areas where if\nyou missed a setting the tunnel doesn't\n\n250\n00:12:27.008 --> 00:12:27.540\ncome up.\n\n251\n00:12:27.540 --> 00:12:31.420\nAnd so now, we've gotta go back and double\ncheck and find out where that problem is.\n\n252\n00:12:31.420 --> 00:12:34.950\nAnd you'll find that while\nlogging was enabled by default,\n\n253\n00:12:34.950 --> 00:12:38.630\nthe default level of logging doesn't\ngive us a ton of information.\n\n254\n00:12:38.630 --> 00:12:42.900\nSo we may even need to go and bump up that\nverbosity level to something higher so\n\n255\n00:12:42.900 --> 00:12:45.485\nwe can get some more detailed information.\n\n256\n00:12:45.485 --> 00:12:48.980\nRonnie let's take a look of\nthe logs of what we've got here and\n\n257\n00:12:48.980 --> 00:12:51.330\njust kind of see what's in there.\n\n258\n00:12:51.330 --> 00:12:54.490\n>> Over here on the upper right hand\ncorner we have the set of buttons as\n\n259\n00:12:54.490 --> 00:12:55.490\nyou can see.\n\n260\n00:12:55.490 --> 00:12:57.670\nAnd one of them which\nis this one right here,\n\n261\n00:12:57.670 --> 00:12:59.680\nwhich looks like a little piece of paper.\n\n262\n00:12:59.680 --> 00:13:01.270\nI know its a little bit\nmore difficult to see.\n\n263\n00:13:01.270 --> 00:13:03.210\nIf I select that.\n\n264\n00:13:03.210 --> 00:13:07.620\nI can then scroll in and\nunder the open VPN tab,\n\n265\n00:13:07.620 --> 00:13:10.610\nI can see it's generating\na lot of information.\n\n266\n00:13:11.840 --> 00:13:16.335\nThat's actually just showing up,\nI'm seeing an inactivity timeout.\n\n267\n00:13:16.335 --> 00:13:17.570\n>> Yeah.\n\n268\n00:13:17.570 --> 00:13:18.380\n>> Is what I'm seeing.\n\n269\n00:13:18.380 --> 00:13:20.010\n>> And that's that PNG restart.\n\n270\n00:13:20.010 --> 00:13:21.440\nAnd notice it says PNG.\n\n271\n00:13:21.440 --> 00:13:25.540\nIt's not saying like open VPN or\nSSL, it's just straight to PNG.\n\n272\n00:13:25.540 --> 00:13:29.770\nWhat's happening is that's\nan indicator that our firewall\n\n273\n00:13:29.770 --> 00:13:32.905\nis reaching out to the other firewall and\ntrying to start talking.\n\n274\n00:13:32.905 --> 00:13:34.340\nAnd the other side's-\n>> [LAUGH]\n\n275\n00:13:34.340 --> 00:13:35.490\n>> Just not even responding.\n\n276\n00:13:35.490 --> 00:13:39.310\nIt's not even communicating back\none single, I wouldn't be surprised\n\n277\n00:13:39.310 --> 00:13:42.830\nif we weren't getting even a single\npacket back from that other firewall.\n\n278\n00:13:42.830 --> 00:13:46.740\nSo we could have a few different\nissues that could lead to this.\n\n279\n00:13:46.740 --> 00:13:50.580\nOne of the most common ones that\nI see is simply connectivity.\n\n280\n00:13:50.580 --> 00:13:52.070\nBefore we apply encryption,\n\n281\n00:13:52.070 --> 00:13:54.630\ncan our firewall get to the other\nfirewall in the first place?\n\n282\n00:13:54.630 --> 00:13:58.770\nYou might have some kind of really simple\nlayer one problem, unplugged cable or\n\n283\n00:13:58.770 --> 00:14:02.500\nwhatever, that's making it where our\nfirewall can't get to the other system.\n\n284\n00:14:02.500 --> 00:14:05.030\nSo connectivity is definitely one thing.\n\n285\n00:14:05.030 --> 00:14:08.260\nThe other thing though is\nthe VPN tunnel settings itself.\n\n286\n00:14:08.260 --> 00:14:11.180\nIf any of the VPN tunnel settings were\ndifferent, the tunnel won't come up and\n\n287\n00:14:11.180 --> 00:14:14.150\nthe other side won't talk to us\nbecause our settings don't match.\n\n288\n00:14:14.150 --> 00:14:16.230\nLike if the keys don't\nmatch it won't talk to us.\n\n289\n00:14:16.230 --> 00:14:19.624\nWe send them our key or\nour hash integrated on that key, and\n\n290\n00:14:19.624 --> 00:14:21.093\nthey just throw it away.\n\n291\n00:14:21.093 --> 00:14:22.050\nLike oops doesn't match.\n\n292\n00:14:22.050 --> 00:14:23.200\nToss it.\n\n293\n00:14:23.200 --> 00:14:25.950\nSo that could be what's going on here.\n\n294\n00:14:25.950 --> 00:14:28.760\nIt could be that the firewalls\nare blocking the traffic.\n\n295\n00:14:28.760 --> 00:14:31.510\nAnd if it's blocking it and\nnot doing a reject but doing a block,\n\n296\n00:14:31.510 --> 00:14:34.890\nthat means they don't reply and\nwe get time outs just like this.\n\n297\n00:14:34.890 --> 00:14:39.010\nSo it could be any number of things\ncausing this communication not to work.\n\n298\n00:14:39.010 --> 00:14:39.854\nThere is one more I wanna throw in.\n\n299\n00:14:39.854 --> 00:14:41.800\n>> [LAUGH]\n>> I've seen this before,\n\n300\n00:14:41.800 --> 00:14:43.640\nwhere it's actually not connectivity.\n\n301\n00:14:43.640 --> 00:14:45.470\nIt's actually not your configuration.\n\n302\n00:14:45.470 --> 00:14:49.210\nIt's the open VPN service that\ndoesn't necessarily get updated.\n\n303\n00:14:49.210 --> 00:14:52.970\nSo one of the things that I like to do\nis to restart the open VPN service.\n\n304\n00:14:52.970 --> 00:14:55.130\nNow, you can restart the whole firewall,\n\n305\n00:14:55.130 --> 00:14:59.040\nbut it's usually a little easier if\nwe just restart the open VPN service.\n\n306\n00:14:59.040 --> 00:15:02.315\nSo Ronnie, let's give that one a kick\nin the seat of the pants there.\n\n307\n00:15:02.315 --> 00:15:05.255\n>> Now, there's a reminder that Don\nalways tells me too that I have\n\n308\n00:15:05.255 --> 00:15:06.375\nto actually consider.\n\n309\n00:15:06.375 --> 00:15:08.105\nIf I'm setting up this as a client and\n\n310\n00:15:08.105 --> 00:15:13.075\na server type of connection, I've got to\nremember that on the server end side.\n\n311\n00:15:13.075 --> 00:15:18.175\nOn that end, there may be more than\none open VPN connection happening.\n\n312\n00:15:18.175 --> 00:15:22.800\nAnd so if I go over to that side,\nI'm just gonna restart the open VPN.\n\n313\n00:15:22.800 --> 00:15:27.020\nI may actually cause more issues than I\nrealize so starting it from the client\n\n314\n00:15:27.020 --> 00:15:31.450\nside is probably a better thing cuz that\nwill only effect my traffic instead.\n\n315\n00:15:31.450 --> 00:15:34.200\nSo the way that we restart that\nis we go back in the status and\n\n316\n00:15:34.200 --> 00:15:37.990\nunder the open VPN,\nover here under Service on this column.\n\n317\n00:15:37.990 --> 00:15:42.585\nYou actually will see\na Restart OpenVPN Service.\n\n318\n00:15:42.585 --> 00:15:44.312\nAnd hopefully, I clicked on there.\n\n319\n00:15:44.312 --> 00:15:44.812\nYep.\n>> Yeah.\n\n320\n00:15:44.812 --> 00:15:46.495\n>> I'm seeing the little spinning Cheerio.\n\n321\n00:15:46.495 --> 00:15:47.488\n>> And just like Ronnie said,\n\n322\n00:15:47.488 --> 00:15:49.559\nif you're at your home office and\nyou have 20 tunnels,\n\n323\n00:15:49.559 --> 00:15:50.826\nthat restarts the whole service-\n>> [LAUGH]\n\n324\n00:15:50.826 --> 00:15:51.946\n>> All 20 tunnels.\n\n325\n00:15:51.946 --> 00:15:53.610\nSo doing it on the client side like this\n\n326\n00:15:53.610 --> 00:15:57.112\nis a lot less painful.\nSo it's gonna restart that and we may find\n\n327\n00:15:57.112 --> 00:16:00.552\nthat that fixes our issue right there.\nThe tunnels come up and\n\n328\n00:16:00.552 --> 00:16:03.450\nwe're back in business.\nBut if it is a configuration issue,\n\n329\n00:16:03.450 --> 00:16:05.770\nthe issue is still there and\nthe tunnel's not gonna come up.\n\n330\n00:16:05.770 --> 00:16:08.100\nSo notice how his tunnel\nshows it's down now.\n\n331\n00:16:08.100 --> 00:16:09.440\nThat's what I was talking about earlier.\n\n332\n00:16:09.440 --> 00:16:11.080\nThat's not necessarily a bad thing.\n\n333\n00:16:11.080 --> 00:16:13.840\nIt just hasn't had a reason to come yet,\nright?\n\n334\n00:16:13.840 --> 00:16:15.050\nSo we can generate some traffic.\n\n335\n00:16:15.050 --> 00:16:17.775\nWe can use the Ping Generator, so\nthat'll throw a little traffic out there.\n\n336\n00:16:17.775 --> 00:16:19.934\n>> And go up to Diagnostics and\nthen select Ping.\n\n337\n00:16:19.934 --> 00:16:22.742\nAnd what we're gonna do\nis we're gonna try and\n\n338\n00:16:22.742 --> 00:16:26.060\nping the internal network\non the other side.\n\n339\n00:16:26.060 --> 00:16:27.700\n>> So I'm gonna do 172.-\n>> And\n\n340\n00:16:27.700 --> 00:16:30.870\nyou can pick any IP on the other side,\nit doesn't even have to be active, right?\n\n341\n00:16:30.870 --> 00:16:33.190\nWe don't care if we can even\nreach the host on the other side.\n\n342\n00:16:33.190 --> 00:16:36.110\nWe just need to generate some traffic that\nfits that pattern, that would match what\n\n343\n00:16:36.110 --> 00:16:38.480\nthe tunnel would need, and\nthat's gonna bring the tunnel up.\n\n344\n00:16:38.480 --> 00:16:42.120\nNow, even on a healthy tunnel,\nexpect the first ping to fail.\n\n345\n00:16:42.120 --> 00:16:43.740\nCuz the tunnel's building up, right?\n\n346\n00:16:43.740 --> 00:16:46.400\nAnd the timeout interval and\nthe ping is not very long.\n\n347\n00:16:46.400 --> 00:16:48.855\nUsually the tunnel takes longer to\ncome up, so it'll probably fail.\n\n348\n00:16:48.855 --> 00:16:50.480\nIt'll do three pings though,\n\n349\n00:16:50.480 --> 00:16:54.370\nand if they all fail, well you get\n100% packet loss there Ronnie.\n\n350\n00:16:54.370 --> 00:16:58.050\nThat's a great indicator\nthat we still have an issue.\n\n351\n00:16:58.050 --> 00:16:59.860\n>> Usually the great indicator here,\nat least for me,\n\n352\n00:16:59.860 --> 00:17:02.960\nis I have somewhere along\nthe line missed something.\n\n353\n00:17:02.960 --> 00:17:07.070\nI typed something or I did not pay\nattention to a setting that I need to.\n\n354\n00:17:07.070 --> 00:17:09.490\nAnd so, at this point,\nit is manual inspection,\n\n355\n00:17:09.490 --> 00:17:13.900\nverifying that my settings\nare actually correct on both sides.\n\n356\n00:17:13.900 --> 00:17:14.874\nAnd more than likely,\n\n357\n00:17:14.874 --> 00:17:18.071\nI think what I'm gonna end up seeing\nis I probably just misset something.\n\n358\n00:17:18.071 --> 00:17:22.077\nSo when I take a look at all the things\nthat I probably forgot, it's gonna be in\n\n359\n00:17:22.077 --> 00:17:26.037\nthose cryptographic settings,\nis normally what I'm gonna actually see.\n\n360\n00:17:26.037 --> 00:17:28.629\n>> Yeah, the key is the easiest\nplace to make a mistake, but\n\n361\n00:17:28.629 --> 00:17:30.155\nRonnie cut and paste it, right?\n\n362\n00:17:30.155 --> 00:17:33.050\nNow, I've had it happened during the show,\n\n363\n00:17:33.050 --> 00:17:35.040\nsome of you guys might have seen\nit before, when you cut and\n\n364\n00:17:35.040 --> 00:17:37.770\npaste, sometimes you carry some\nstraight characters along with it.\n\n365\n00:17:37.770 --> 00:17:41.690\nIf you're on a Mac, pasting onto a PC,\nthings can go weird there.\n\n366\n00:17:41.690 --> 00:17:44.930\nSo, your key might be damaged, you might\nhave picked different cryptographic\n\n367\n00:17:44.930 --> 00:17:48.770\nsettings, you might have different\nport numbers assigned on both sides.\n\n368\n00:17:48.770 --> 00:17:49.976\nSo the best thing is,\n\n369\n00:17:49.976 --> 00:17:54.240\nif you control both firewalls just\nbring up their configs side by side.\n\n370\n00:17:54.240 --> 00:17:57.230\nScroll through them both and\nlook for the differences.\n\n371\n00:17:57.230 --> 00:18:00.810\nIf you only control one end though, the\nbest thing to do is get on the phone with\n\n372\n00:18:00.810 --> 00:18:02.760\na person on the other side and say,\nall right let's walk through this.\n\n373\n00:18:02.760 --> 00:18:05.100\nSo I'm set for TCP, what are you set for?\n\n374\n00:18:05.100 --> 00:18:06.930\nOh you're UDP, all right,\nwell let's fix that, right?\n\n375\n00:18:06.930 --> 00:18:09.720\nAnd you kind of run through it and\nlook for those differences.\n\n376\n00:18:09.720 --> 00:18:13.375\nNow, Ronnie configured all this stuff and\nmost of it was the same.\n\n377\n00:18:13.375 --> 00:18:14.716\n>> Yeah.\n>> We've got your key,\n\n378\n00:18:14.716 --> 00:18:15.734\nwhich you cut and paste.\n\n379\n00:18:15.734 --> 00:18:17.174\nWe'll assume for now that's good.\n\n380\n00:18:17.174 --> 00:18:19.345\nYou've got AES-128 for your encryption.\n\n381\n00:18:19.345 --> 00:18:23.710\nYou've got SHA 160-bit for\nyour hashing algorithm.\n\n382\n00:18:23.710 --> 00:18:24.570\nThose all look pretty good.\n\n383\n00:18:24.570 --> 00:18:26.410\nLet's take a look at the other side.\n\n384\n00:18:26.410 --> 00:18:27.620\n>> Sounds good.\n\n385\n00:18:27.620 --> 00:18:29.790\nSo I'm just gonna switch on\nover to the other machine,\n\n386\n00:18:29.790 --> 00:18:31.720\nwhich is connected to the other side here.\n\n387\n00:18:31.720 --> 00:18:33.860\nLet me get the right one.\n\n388\n00:18:33.860 --> 00:18:37.510\nAnd I went ahead and\nhad this up from when I configured side A,\n\n389\n00:18:37.510 --> 00:18:41.020\nor the server side earlier, so\neverything looks good here.\n\n390\n00:18:41.020 --> 00:18:43.820\n>> UDP, tunnel, 1195,\nright, that all looks good.\n\n391\n00:18:44.980 --> 00:18:46.321\nWell we'll assume the key is good, still.\n\n392\n00:18:46.321 --> 00:18:47.307\n>> Yeah, we'll assume the key is good.\n\n393\n00:18:47.307 --> 00:18:48.422\n>> You know what happens when you assume.\n\n394\n00:18:48.422 --> 00:18:48.922\n>> I know.\n\n395\n00:18:48.922 --> 00:18:51.995\n[LAUGH]\n>> We got AES-128, we got SHA 160-bit, so\n\n396\n00:18:51.995 --> 00:18:53.113\nthat all looks good.\n\n397\n00:18:53.113 --> 00:18:56.305\n>> Yeah, that all looks good,\na little bit confusing.\n\n398\n00:18:56.305 --> 00:19:00.550\n>> So, actually,\nthis is a neat mistake to make right here.\n\n399\n00:19:00.550 --> 00:19:06.660\nIt looks good, and this is something that\nis easy to glance over like I just did,\n\n400\n00:19:06.660 --> 00:19:11.200\nif we look at that SHA 160-bit, the other\nside was SHA 160-bit also, right?\n\n401\n00:19:11.200 --> 00:19:11.810\n>> Right.\n\n402\n00:19:11.810 --> 00:19:12.860\n>> Actually, it wasn't.\n\n403\n00:19:12.860 --> 00:19:15.858\n>> Oh.\n>> The other side was SHA-1 160 bit.\n\n404\n00:19:15.858 --> 00:19:19.566\nThis one is just SHA 160-bit,\nsuper easy to make that mistake.\n\n405\n00:19:19.566 --> 00:19:20.120\n>> Right.\n\n406\n00:19:20.120 --> 00:19:22.220\n>> Right, I mean,\nthey almost look the same.\n\n407\n00:19:22.220 --> 00:19:25.379\nAnd that's because SHA,\nthat's the original version.\n\n408\n00:19:25.379 --> 00:19:28.096\nAnd it's been updated\na number of times since then.\n\n409\n00:19:28.096 --> 00:19:32.391\nSo you got SHA-1, SHA-2,\nI think there's SHA-5, SHA-256, 512.\n\n410\n00:19:32.391 --> 00:19:32.914\n>> Oh yeah.\n\n411\n00:19:32.914 --> 00:19:34.190\n>> Right, there's a bunch of them.\n\n412\n00:19:34.190 --> 00:19:35.740\nOh yeah,\nthere's your whole list right there.\n\n413\n00:19:35.740 --> 00:19:38.282\nSo, in this case,\nsuper easy to glance across,\n\n414\n00:19:38.282 --> 00:19:42.881\nbecause they're both 160-bit, they're\nboth SHA, one has a 1 in there, right?\n\n415\n00:19:42.881 --> 00:19:47.070\nBut if those don't match,\none side's not gonna talk to the others.\n\n416\n00:19:47.070 --> 00:19:49.360\nWe've got to fix that before they'll talk.\n\n417\n00:19:49.360 --> 00:19:50.810\nSo we need to chose a standard.\n\n418\n00:19:50.810 --> 00:19:54.300\nNow, in real Iife land, I'll tell\nyou that SHA-1 is not safe anymore.\n\n419\n00:19:54.300 --> 00:19:57.977\nSo we're normally gonna go with SHA-256 or\nwhatever, but for the sake of our example,\n\n420\n00:19:57.977 --> 00:19:59.186\nlet's just make them match.\n\n421\n00:19:59.186 --> 00:20:01.960\nAnd then we'll change this end to SHA-1.\n\n422\n00:20:01.960 --> 00:20:03.541\n>> All right.\n>> And when that happens,\n\n423\n00:20:03.541 --> 00:20:06.290\nmaybe that fixes our problem,\nmaybe it doesn't.\n\n424\n00:20:06.290 --> 00:20:10.860\nI encourage you guys to only make\none change at a time, all right?\n\n425\n00:20:10.860 --> 00:20:14.300\nThat way you know exactly what change\nit was that fixed the problem.\n\n426\n00:20:14.300 --> 00:20:17.970\nYou don't want to make five changes,\nand not realize which one fixed it,\n\n427\n00:20:17.970 --> 00:20:21.350\nbecause you might have weakened security\nthrough one of those other changes.\n\n428\n00:20:21.350 --> 00:20:23.420\nSo you make one change, test and verify.\n\n429\n00:20:23.420 --> 00:20:26.430\nIf it didn't fix it,\nyou might need to undo that change,\n\n430\n00:20:26.430 --> 00:20:28.720\nif you weren't certain\nof the actual solution.\n\n431\n00:20:28.720 --> 00:20:31.810\nIn our case, well,\nthe best way to tell is to fix it, and\n\n432\n00:20:31.810 --> 00:20:33.930\nthen go see what happens with the tunnel.\n\n433\n00:20:33.930 --> 00:20:35.130\n>> Tunnel is up.\n\n434\n00:20:35.130 --> 00:20:36.135\n>> Tunnel is indeed up.\n\n435\n00:20:36.135 --> 00:20:40.970\nSo yep, when we look now we can see it's\nup, shows open VPN on port 1195 using UDP.\n\n436\n00:20:40.970 --> 00:20:46.010\nTunnel's up and happy, so\nwe just had a simple misconfiguration.\n\n437\n00:20:46.010 --> 00:20:47.880\nAnd you guys see how easy that was to do,\nright?\n\n438\n00:20:47.880 --> 00:20:51.160\nIn that list, you got a whole bunch of\noptions and some of them look the same, so\n\n439\n00:20:51.160 --> 00:20:52.879\nwe've gotta do verification, right?\n\n440\n00:20:52.879 --> 00:20:58.241\n>> If everything is working correctly, I\nshould now from my site A to site B here,\n\n441\n00:20:58.241 --> 00:21:03.198\nbe able to, now let's see if I can\nactually get access to that firewall,\n\n442\n00:21:03.198 --> 00:21:04.930\nand look at that.\n\n443\n00:21:04.930 --> 00:21:09.155\nDon, I can actually get access to site B's\nfirewall right here, and let's verify.\n\n444\n00:21:11.711 --> 00:21:15.136\nAnd there it is,\nnotice I am on site B's firewall.\n\n445\n00:21:15.136 --> 00:21:19.393\nAnd so from, well, now the server side or\nfrom my headquarters side,\n\n446\n00:21:19.393 --> 00:21:22.013\nI can now manage that\nfirewall if I need to.\n\n447\n00:21:22.013 --> 00:21:24.010\n>> And once that's done,\nnow it's up and healthy.\n\n448\n00:21:24.010 --> 00:21:27.280\nYou've got your your open VPN status\nscreen where you can see the tunnels\n\n449\n00:21:27.280 --> 00:21:28.190\nthat are up.\n\n450\n00:21:28.190 --> 00:21:31.200\nYou can go into your diagnostic logging\nand you'll see that the tunnel's up and\n\n451\n00:21:31.200 --> 00:21:33.750\nhealthy and\ntraffic's starting to flow across it.\n\n452\n00:21:33.750 --> 00:21:34.950\nNow we're in good shape, right?\n\n453\n00:21:34.950 --> 00:21:38.330\nSo pretty much it comes down to\njust matching those settings and\n\n454\n00:21:38.330 --> 00:21:38.880\nyou're in business.\n\n455\n00:21:38.880 --> 00:21:40.140\nConfiguring open VPN for\n\n456\n00:21:40.140 --> 00:21:43.260\nsite to site connectivity like\nthis is not really a big deal.\n\n457\n00:21:43.260 --> 00:21:46.010\nSo that is one of the big\nadvantages it has over IPsec.\n\n458\n00:21:46.010 --> 00:21:50.520\nIPsec can be, really, there's just a lot\nof room for error inside of IPsec.\n\n459\n00:21:50.520 --> 00:21:54.380\nAnd you've got Phase 1 and\nPhase 2 negotiations that have to happen.\n\n460\n00:21:54.380 --> 00:21:58.330\nHere, it's basically SSL, so\nas long as your settings are accurate,\n\n461\n00:21:58.330 --> 00:22:00.760\nthen it's gonna connect right up and\nyou're gonna be in business.\n\n462\n00:22:00.760 --> 00:22:02.469\nAnd it's definitely\na neat technology to use.\n\n463\n00:22:02.469 --> 00:22:04.663\nI know we use the heck out of it,\nright Ronnie?\n\n464\n00:22:04.663 --> 00:22:05.173\n>> We do.\n\n465\n00:22:05.173 --> 00:22:06.530\n>> I think your home is\nlinked here to the studio.\n\n466\n00:22:06.530 --> 00:22:09.060\n>> We are.\n>> My home is linked to the studio so that\n\n467\n00:22:09.060 --> 00:22:12.260\nyou can just quickly gain access, and that\nis something that's pretty handy to have.\n\n468\n00:22:14.053 --> 00:22:16.795\nAll right, well Ronnie, can you think of\nanything else we need to throw in on open\n\n469\n00:22:16.795 --> 00:22:18.535\nVPN site to site connectivity?\n\n470\n00:22:18.535 --> 00:22:21.671\n>> No, just remember that the way that\nthis works is not everything's gonna be\n\n471\n00:22:21.671 --> 00:22:22.215\nidentical.\n\n472\n00:22:22.215 --> 00:22:25.955\nRemember that client side, or\nthat client adverse to the server tab.\n\n473\n00:22:25.955 --> 00:22:28.755\nI know that I've done that\nmore than a couple of times\n\n474\n00:22:28.755 --> 00:22:31.041\nin just setting up the server, and\ngoing to the other machine and go, okay,\n\n475\n00:22:31.041 --> 00:22:34.500\nI've set up the server again, why isn't\nit working the way that I need it to?\n\n476\n00:22:34.500 --> 00:22:37.810\nIt's because of that nature and\nthe way that the open VPN works.\n\n477\n00:22:37.810 --> 00:22:40.130\nThere's always a client,\nthere's always that server.\n\n478\n00:22:40.130 --> 00:22:42.150\nAnd so,\nonce you get that straight in your mind,\n\n479\n00:22:42.150 --> 00:22:44.630\nall the other settings\nare fairly easy to maintain.\n\n480\n00:22:45.930 --> 00:22:48.630\n>> I will mention one last\nthing just to keep in mind,\n\n481\n00:22:48.630 --> 00:22:53.550\nis that open VPN is built on top of\nusing TLS, Transport Layer Security.\n\n482\n00:22:53.550 --> 00:22:57.840\nTLS was built on top of SSL, which was\nthe original web encryption protocol for\n\n483\n00:22:57.840 --> 00:22:59.130\nbalancing the web.\n\n484\n00:22:59.130 --> 00:23:02.870\nAnd so when you're browsing\nthe internet on your security sites,\n\n485\n00:23:02.870 --> 00:23:06.514\nwatching the news and they say there's a\nnew SSL vulnerability out there, and a new\n\n486\n00:23:06.514 --> 00:23:11.290\nTLS vulnerability out there, remember that\nmost likely that applies to OpenVPN also.\n\n487\n00:23:11.290 --> 00:23:14.665\nAnd so if you're using OpenVPN site\nto site connections like these and\n\n488\n00:23:14.665 --> 00:23:18.870\nthere's a SSL vulnerability out there or\na TLS vulnerability, you probably need to\n\n489\n00:23:18.870 --> 00:23:22.680\nupdate your pfSense firewall, right,\nto make sure that stays secure and safe.\n\n490\n00:23:22.680 --> 00:23:25.210\nYou don't want your VPN\ntunnels to get compromised,\n\n491\n00:23:25.210 --> 00:23:28.010\nit's still a challenge to do it,\nbut it is possible.\n\n492\n00:23:28.010 --> 00:23:31.897\nSo make sure you keep your system up to\ndate to keep your VPN tunnels healthy,\n\n493\n00:23:31.897 --> 00:23:33.293\nhappy, and wise, right,\n\n494\n00:23:33.293 --> 00:23:34.790\nI think that was The-\n>> [LAUGH]\n\n495\n00:23:34.790 --> 00:23:36.010\n>> Little Rascals.\n\n496\n00:23:36.010 --> 00:23:38.450\nAll right, well ladies and\ngentlemen that pretty much wraps it up for\n\n497\n00:23:38.450 --> 00:23:39.840\nOpenVPN for us.\n\n498\n00:23:39.840 --> 00:23:43.110\nThe end of our two part series on\nOpenVPN and site to site setup.\n\n499\n00:23:43.110 --> 00:23:44.341\nHope you guys enjoyed it.\nStay tuned,\n\n500\n00:23:44.341 --> 00:23:46.406\nwe've got more pfSense coming up.\n\n501\n00:23:46.406 --> 00:23:52.040\n[MUSIC]\n\n",
          "vimeoId": "130769499"
        },
        {
          "description": null,
          "length": "1900",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-3-remote_access_openvpn-061115-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-3-remote_access_openvpn-061115-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-3-remote_access_openvpn-061115-1-sm.jpg",
          "title": "Remote Access OpenVPN",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:07.613\n[MUSIC]\n\n2\n00:00:07.613 --> 00:00:12.407\nIn this segment we're gonna take a look at\nconfiguring the Remote Access Service for\n\n3\n00:00:12.407 --> 00:00:13.636\nOpenVPN on pfSense.\n\n4\n00:00:13.636 --> 00:00:17.583\nOne of the neat things about pfSense is\nthat if you're using it as a firewall at\n\n5\n00:00:17.583 --> 00:00:21.348\nhome or at work, and you're ever out\ntraveling, you're out at a hotel,\n\n6\n00:00:21.348 --> 00:00:25.174\nat a restaurant, and you're on some\npublic wireless network, you can use\n\n7\n00:00:25.174 --> 00:00:29.126\nthe Remote Access VPN service from\nOpenVPN to connect back to your firewall,\n\n8\n00:00:29.126 --> 00:00:31.570\nand work on your home or office network.\n\n9\n00:00:31.570 --> 00:00:34.540\nAnd it's all very, very simple to use,\nit's all built on top of\n\n10\n00:00:34.540 --> 00:00:37.470\nthe OpenVPN protocol,\nwhich is an open source solution.\n\n11\n00:00:37.470 --> 00:00:42.480\nIt's integrated into pfSense, all we have\nto do is turn it on and get it set up.\n\n12\n00:00:42.480 --> 00:00:43.422\nAnd let me tell you,\n\n13\n00:00:43.422 --> 00:00:47.139\nit can be a daunting task if you're trying\nto build your own OpenVPN server, but\n\n14\n00:00:47.139 --> 00:00:50.373\nthe way it's implemented in pfSense,\nit's actually really easy.\n\n15\n00:00:50.373 --> 00:00:54.185\nSo we want walk you through an example\nthat will give you a chance to see\n\n16\n00:00:54.185 --> 00:00:57.553\nsomething that is definitely\ngonna use in real-life land.\n\n17\n00:00:57.553 --> 00:01:01.380\nAll right, so where I'm gonna start\nis just with my network topology.\n\n18\n00:01:01.380 --> 00:01:08.084\nI've got an office network setup right\nhere, and it's my 192.168.0.0/24 network.\n\n19\n00:01:08.084 --> 00:01:12.150\nStandard kind of class C that you'd see\nin a home or small office environment.\n\n20\n00:01:12.150 --> 00:01:13.520\nAnd I've got a server on it.\n\n21\n00:01:13.520 --> 00:01:17.940\nNow my server, it's a Web server and\nmaybe I've got an intranet site setup or\n\n22\n00:01:17.940 --> 00:01:19.070\nsomething like that.\n\n23\n00:01:19.070 --> 00:01:20.310\nAnd this server is put up.\n\n24\n00:01:20.310 --> 00:01:21.980\nIt's on my private network.\n\n25\n00:01:21.980 --> 00:01:25.510\nAnd unless you're in my private network,\nyou can't get to this server.\n\n26\n00:01:25.510 --> 00:01:29.230\nBut then, I've got my laptop, and maybe\nmy laptop, I'm out at Starbuck's, and\n\n27\n00:01:29.230 --> 00:01:31.990\nI'm on their wireless, and I want to\nbe able to connect back to this server.\n\n28\n00:01:31.990 --> 00:01:35.096\nWell, I can use OpenVPN to do that.\n\n29\n00:01:35.096 --> 00:01:36.930\nLet's take a look at my server.\n\n30\n00:01:36.930 --> 00:01:40.610\nSo here's the server that I was talking\nabout, if I just bring up my command\n\n31\n00:01:40.610 --> 00:01:46.280\nprompt and take a look at it's address,\nit's 192.168.0.200.\n\n32\n00:01:46.280 --> 00:01:47.940\nThat's a private address.\n\n33\n00:01:47.940 --> 00:01:50.820\nNobody's gonna be able to get to that from\nthe internet unless I do network address\n\n34\n00:01:50.820 --> 00:01:52.610\ntranslation or something.\n\n35\n00:01:52.610 --> 00:01:54.680\nBut I don't want people to\nget to it from the internet.\n\n36\n00:01:54.680 --> 00:01:56.380\nI wanna keep it private and secure.\n\n37\n00:01:57.380 --> 00:02:02.395\nSo what I can do is I can take my\nfirewall, which I've got right here.\n\n38\n00:02:02.395 --> 00:02:06.005\nAnd it's on the 1921680 network,\nso it's connected to that network.\n\n39\n00:02:06.005 --> 00:02:09.268\nAnd it's got a public IP\nout there on the Internet.\n\n40\n00:02:09.268 --> 00:02:12.329\n209.251.159.184.\n\n41\n00:02:12.329 --> 00:02:17.060\nIf somebody could build a VPN tunnel up\nto the firewall, they can then leapfrog\n\n42\n00:02:17.060 --> 00:02:19.910\nthrough the firewall, get to that web\nserver internally, and it would be\n\n43\n00:02:19.910 --> 00:02:23.740\nsecure and protected, and that is what we\nare doing with access VPNs are all about.\n\n44\n00:02:23.740 --> 00:02:26.140\nSo I am gonna leverage\nopen VPN to do that.\n\n45\n00:02:26.140 --> 00:02:31.000\nIf I go up here to VPN, and open VPN,\nhere is where I can go in and\n\n46\n00:02:31.000 --> 00:02:32.760\nstart to setup my system.\n\n47\n00:02:32.760 --> 00:02:35.720\nNow, what I want to do is I\nwant to set up the server.\n\n48\n00:02:35.720 --> 00:02:38.950\nAnd you can do it manually right here\nthrough the server setup if you want, or\n\n49\n00:02:38.950 --> 00:02:40.800\nwe can jump right over here to wizards.\n\n50\n00:02:40.800 --> 00:02:42.990\nAnd the wizards actually\na little bit easier to use,\n\n51\n00:02:42.990 --> 00:02:46.820\nbecause we're gonna have to create\nuser accounts for our users.\n\n52\n00:02:46.820 --> 00:02:50.130\nAnd when the users authenticate we have to\npick different authentication mechanisms\n\n53\n00:02:50.130 --> 00:02:50.650\nand stuff.\n\n54\n00:02:50.650 --> 00:02:53.300\nAnd then the wizard makes this\na little bit easier for us.\n\n55\n00:02:53.300 --> 00:02:56.800\nSo when I go in here to\nthe OpenVPN Remote Access Server Wizard.\n\n56\n00:02:56.800 --> 00:02:59.638\nI can pick how I want to\nauthenticate my users.\n\n57\n00:02:59.638 --> 00:03:01.670\nThis is the first I have to make.\n\n58\n00:03:01.670 --> 00:03:03.410\nWhere do the user accounts reside?\n\n59\n00:03:03.410 --> 00:03:06.100\nWell, the default is they reside\nright here on the firewall.\n\n60\n00:03:06.100 --> 00:03:08.796\nI can use the firewall user\nmanager to create accounts for\n\n61\n00:03:08.796 --> 00:03:10.323\neverybody who wants to come in.\n\n62\n00:03:10.323 --> 00:03:13.150\nOr I could use LDAP or Radius.\n\n63\n00:03:13.150 --> 00:03:15.080\nNow Ronnie,\nwhy would I want to use one of those?\n\n64\n00:03:15.080 --> 00:03:17.830\n>> Well, if you already have a network\ninfrastructure set up where you're doing\n\n65\n00:03:17.830 --> 00:03:20.480\nsomething like Active Directory,\nit's actually better then,\n\n66\n00:03:20.480 --> 00:03:24.440\nthat you don't have to store any of those\nuser accounts on that firewall itself.\n\n67\n00:03:24.440 --> 00:03:27.545\nIt can go and then authenticate against\nthe directory you already created.\n\n68\n00:03:27.545 --> 00:03:31.151\nAnd so, using either Radius or using LDAP,\nit's probably the best situation,\n\n69\n00:03:31.151 --> 00:03:33.447\nespecially if you are in\na corporate environment.\n\n70\n00:03:33.447 --> 00:03:36.600\n>> Yeah, the other nice thing is, let's\nsay you have a Microsoft Active Directory.\n\n71\n00:03:36.600 --> 00:03:38.240\nYou can authenticate against that.\n\n72\n00:03:38.240 --> 00:03:42.410\nSo now, users have one user account and\none password and Active Directory.\n\n73\n00:03:42.410 --> 00:03:44.680\nAnd they can use that for VPN access also.\n\n74\n00:03:44.680 --> 00:03:47.370\nVersus if I go with the local user access,\nnow,\n\n75\n00:03:47.370 --> 00:03:50.490\nthey've got their Active Directory\naccount and they've got a VPN account.\n\n76\n00:03:50.490 --> 00:03:53.010\nIf they change their password for\none, it doesn't change the other.\n\n77\n00:03:53.010 --> 00:03:56.580\nSo it's nice to integrate into\none of those directory services.\n\n78\n00:03:56.580 --> 00:03:58.830\nIn my case,\nI'm gonna run with local user access.\n\n79\n00:03:58.830 --> 00:04:03.730\nBut if we choose LDAP, we'll have to\nsetup that access, that connection to\n\n80\n00:04:03.730 --> 00:04:06.590\na directory server, and we'll have\nto provide credentials for that.\n\n81\n00:04:06.590 --> 00:04:09.022\nIt's pretty straight forward\ngetting that part setup.\n\n82\n00:04:09.022 --> 00:04:11.270\nBut I'll stick with local users for\nright now.\n\n83\n00:04:11.270 --> 00:04:12.690\nWe can always change it later if we want.\n\n84\n00:04:14.170 --> 00:04:17.490\nOn the next screen it is gonna\nask about a certificate to use.\n\n85\n00:04:17.490 --> 00:04:22.870\nNow, this is not any old certificate,\nthis is a certificate authority.\n\n86\n00:04:22.870 --> 00:04:25.860\nWe're gonna become a route CA.\n\n87\n00:04:25.860 --> 00:04:28.905\nOur firewall needs to be able\nto issue certificates to use for\n\n88\n00:04:28.905 --> 00:04:30.644\nthese VPN connections coming in.\n\n89\n00:04:30.644 --> 00:04:32.920\nIt's actually gonna\ngenerate two certificates.\n\n90\n00:04:32.920 --> 00:04:39.040\nOne as the root CA, and then one as\nsigned certificate for open VPN.\n\n91\n00:04:39.040 --> 00:04:41.910\nSo we've got to provide it\nthe information to be able to do that.\n\n92\n00:04:41.910 --> 00:04:46.429\nSo I need to give it a name, and\nI'll just call this my pfSenseCA,\n\n93\n00:04:46.429 --> 00:04:50.552\nI can pick a key link,\n2048 bit is strong enough for me.\n\n94\n00:04:50.552 --> 00:04:52.053\nWe'll set a lifetime of ten years.\n\n95\n00:04:52.053 --> 00:04:54.230\nMostly going with the defaults on this.\n\n96\n00:04:54.230 --> 00:05:00.050\nI'll populate my country information,\nso we are in Gainesville, Florida.\n\n97\n00:05:00.050 --> 00:05:05.430\nOur organization is ITProTV,\nand put in an email.\n\n98\n00:05:05.430 --> 00:05:07.168\nI'll stick in my email there.\n\n99\n00:05:07.168 --> 00:05:08.520\nAnd we'll add that new CA.\n\n100\n00:05:08.520 --> 00:05:10.840\nNow, normally you'd put\nlike an admin address.\n\n101\n00:05:10.840 --> 00:05:13.680\nSo if somebody sees the certificate and\nthey have a question about it,\n\n102\n00:05:13.680 --> 00:05:15.240\nthey could email this person.\n\n103\n00:05:15.240 --> 00:05:17.800\nAdmin or info or somebody like that.\n\n104\n00:05:17.800 --> 00:05:18.730\nWe'll go ahead and add that CA in.\n\n105\n00:05:20.410 --> 00:05:23.850\nNow, after that, it's gonna ask\nme about a certificate again.\n\n106\n00:05:23.850 --> 00:05:25.750\nAnd you're like, wait a minute,\nI just made a one.\n\n107\n00:05:25.750 --> 00:05:28.440\nWell, the first one was for\nthat root CA that it's gonna setup.\n\n108\n00:05:28.440 --> 00:05:32.066\nThe second one is the actual certificate\nthat's gonna be issued by that CA to\n\n109\n00:05:32.066 --> 00:05:32.924\nuse for open VPN.\n\n110\n00:05:32.924 --> 00:05:35.570\nSo this is the one that\nwe're truly going to use.\n\n111\n00:05:35.570 --> 00:05:37.290\nSo I'm gonna call this one pfSense.\n\n112\n00:05:38.320 --> 00:05:42.409\nOpenVPN, I'll go with 2048 bits.\n\n113\n00:05:42.409 --> 00:05:43.127\nWe'll do a ten-year.\n\n114\n00:05:43.127 --> 00:05:45.658\nNow, you might just want to do\nsomething shorter on this one, but\n\n115\n00:05:45.658 --> 00:05:48.710\nyou'll just have to remember to come and\nupdate that from time to time.\n\n116\n00:05:48.710 --> 00:05:51.448\nI typically do one year, but\nI'll leave this one at ten for now.\n\n117\n00:05:51.448 --> 00:05:53.420\nAnd it's auto-populated the rest,\n\n118\n00:05:53.420 --> 00:05:55.240\ncuz it knows most people\nare gonna put the same thing in.\n\n119\n00:05:57.940 --> 00:05:59.290\nNow, it's got enough information for\n\n120\n00:05:59.290 --> 00:06:04.030\nthe issuing certificates, I need to\nconfigure the Remote Access Server itself.\n\n121\n00:06:04.030 --> 00:06:06.710\nIt's gonna listen to my WAN interface,\nand that's typically what we want,\n\n122\n00:06:06.710 --> 00:06:08.755\nconnections coming from the Internet.\n\n123\n00:06:08.755 --> 00:06:10.505\nYou might be securing\ninternal connections.\n\n124\n00:06:10.505 --> 00:06:12.321\nNot many people do that, but you might.\n\n125\n00:06:12.321 --> 00:06:15.535\nThen you need to change this, but most\npeople, it is gonna be the WAN interface.\n\n126\n00:06:16.585 --> 00:06:20.725\nOpen VPN uses UDP by default, and\nthat's because UDP works great for\n\n127\n00:06:20.725 --> 00:06:24.270\nencrypted communications, and\nwe let retransmission happen and\n\n128\n00:06:24.270 --> 00:06:26.450\nstuff like that will happen\nafter it's been decrypted.\n\n129\n00:06:26.450 --> 00:06:30.450\nYou can use TCP, it can be a little\nhelpful sometimes getting through proxies,\n\n130\n00:06:30.450 --> 00:06:33.630\nor whatever, but you do take a bit\nof a performance hit with that.\n\n131\n00:06:33.630 --> 00:06:34.990\nYou'd rather use UDP.\n\n132\n00:06:34.990 --> 00:06:36.249\nIf at all possible.\n\n133\n00:06:36.249 --> 00:06:37.810\nAnd then the port number.\n\n134\n00:06:37.810 --> 00:06:40.050\nNow, be aware that the port number for\n\n135\n00:06:40.050 --> 00:06:45.150\nthe Remote Access VPN can conflict with\nsite-to-site VPNs if you've built them up.\n\n136\n00:06:45.150 --> 00:06:47.480\nSo we might need to pick\na unique port number here.\n\n137\n00:06:47.480 --> 00:06:48.919\nThe default is 1194.\n\n138\n00:06:48.919 --> 00:06:51.170\nIf that's already in use you\ncan pick a different number.\n\n139\n00:06:51.170 --> 00:06:53.307\nYou can pick really just\nabout whatever you want.\n\n140\n00:06:53.307 --> 00:06:55.970\nYou just need to make sure that your\nclients know what to connect to.\n\n141\n00:06:57.160 --> 00:06:58.360\nAnd then we'll give that a description.\n\n142\n00:06:58.360 --> 00:07:03.060\nI'm just gonna call this my\nOpenVPN Remote Access Server.\n\n143\n00:07:05.010 --> 00:07:07.820\nThen, I can pick how my\ncryptography is gonna happen.\n\n144\n00:07:07.820 --> 00:07:10.130\nWe've got enable\nauthentication of TLS Packets.\n\n145\n00:07:10.130 --> 00:07:12.282\nWe generally want to authenticate people.\n\n146\n00:07:12.282 --> 00:07:15.830\nYou might want to create a zero\nauthentication Remote Access VPN.\n\n147\n00:07:15.830 --> 00:07:19.830\nIf your network is secured other ways,\nthen you don't care,\n\n148\n00:07:19.830 --> 00:07:21.840\nanybody can build a VPN too, who cares?\n\n149\n00:07:21.840 --> 00:07:24.450\nBecause once they're connected,\nthen they still have to go and\n\n150\n00:07:24.450 --> 00:07:26.740\nauthenticate to get access to resources.\n\n151\n00:07:26.740 --> 00:07:30.060\nMost people don't want that, though, most\npeople want it all to be authenticated,\n\n152\n00:07:30.060 --> 00:07:31.830\nand we have to specify a key for that.\n\n153\n00:07:31.830 --> 00:07:35.360\nNow, it's gonna automatically generate\none for me, I'm fine with that.\n\n154\n00:07:35.360 --> 00:07:40.210\nBut if you're rebuilding a firewall that\nalready existed, you might wanna paste in\n\n155\n00:07:40.210 --> 00:07:43.730\nan existing key to make sure the key\nstays the same between the systems.\n\n156\n00:07:43.730 --> 00:07:44.870\nNormally we just let it generate one.\n\n157\n00:07:47.020 --> 00:07:50.144\nThen, for the Diffie–Hellman key exchange,\nhow many bits we wanna use?\n\n158\n00:07:50.144 --> 00:07:51.913\nIt defaults to 2048.\n\n159\n00:07:51.913 --> 00:07:54.741\nYou can change that to something\nstronger or weaker if you want, but\n\n160\n00:07:54.741 --> 00:07:56.950\n2048 is pretty standard.\n\n161\n00:07:56.950 --> 00:07:58.360\nAnd now our encryption.\n\n162\n00:07:58.360 --> 00:08:01.013\nYou need to choose what level of\nencryption you want to use for\n\n163\n00:08:01.013 --> 00:08:03.420\nthese clients, and\nwhat level of digital signature.\n\n164\n00:08:03.420 --> 00:08:07.853\nNow, be aware, that on your client side,\nthey're just encrypting their own data.\n\n165\n00:08:07.853 --> 00:08:12.755\nIt's not a lot, so you could pick even\nthe strongest level, like 80s 256,\n\n166\n00:08:12.755 --> 00:08:14.425\nand it's gonna run great.\n\n167\n00:08:14.425 --> 00:08:16.894\nBut on your firewall side,\non the server side,\n\n168\n00:08:16.894 --> 00:08:20.140\nthis is where all\nthe connections are terminating.\n\n169\n00:08:20.140 --> 00:08:23.557\nAnd if you got 50 users that\nare all doing AES-256 and\n\n170\n00:08:23.557 --> 00:08:28.245\nyour server just has a general purpose\nCPU, it might not be able to handle that.\n\n171\n00:08:28.245 --> 00:08:30.009\nYou get a lot of CPU load.\n\n172\n00:08:30.009 --> 00:08:33.255\nYour CPU is what's gonna determine how\nmany simultaneous VPN connections you can\n\n173\n00:08:33.255 --> 00:08:36.590\nhave, because it's having to do\nthe encryption and decryption.\n\n174\n00:08:36.590 --> 00:08:39.972\nThey do sell hardware accelerator boards,\nand you'll see that option down here.\n\n175\n00:08:39.972 --> 00:08:41.070\nIf I've got one,\n\n176\n00:08:41.070 --> 00:08:46.120\nI can choose one to make sure I get that\noptimization to improve performance.\n\n177\n00:08:46.120 --> 00:08:48.660\nAnd then,\nyou get a lot more possible connections.\n\n178\n00:08:48.660 --> 00:08:51.267\nBut you'll also find that your general\npurpose CPUs are pretty strong.\n\n179\n00:08:51.267 --> 00:08:53.502\nSo if you leave these options or\nyou bump them up,\n\n180\n00:08:53.502 --> 00:08:56.728\nyou'll probably find where you can\nget a good amount of connections.\n\n181\n00:08:56.728 --> 00:09:01.438\nBut just be aware, be sensitive, to the\nfact that that is gonna make a difference.\n\n182\n00:09:01.438 --> 00:09:02.041\nAll right.\n\n183\n00:09:02.041 --> 00:09:03.074\nWe pick our encryption.\n\n184\n00:09:03.074 --> 00:09:05.953\nThere are a lot of standards here to\npick from, tons of different ones.\n\n185\n00:09:05.953 --> 00:09:11.395\nWe've also got our digital signature or\nhashing algorithm that you can pick from.\n\n186\n00:09:11.395 --> 00:09:14.425\nSHA1 is the default which is\nconsidered weak these days, so\n\n187\n00:09:14.425 --> 00:09:17.615\nI might wanna move up to\nsomething stronger like SHA256.\n\n188\n00:09:17.615 --> 00:09:20.265\nBut you can pick those options\naccording to your need.\n\n189\n00:09:22.035 --> 00:09:24.180\nThen, my tunnel network.\n\n190\n00:09:24.180 --> 00:09:25.570\nNow, this one's tough.\n\n191\n00:09:25.570 --> 00:09:26.883\nIf you do a site to site VPN,\n\n192\n00:09:26.883 --> 00:09:30.212\nyou want to pick like a really small\nnetwork with only a couple of IPs.\n\n193\n00:09:30.212 --> 00:09:34.213\nBut here, I'm creating a network\nthat all of my remote access vpn\n\n194\n00:09:34.213 --> 00:09:35.829\nclients are going to use.\n\n195\n00:09:35.829 --> 00:09:38.186\nSo, I need to think about how\nmany clients I'm going to have.\n\n196\n00:09:38.186 --> 00:09:39.950\nAm I just going to have 50 clients?\n\n197\n00:09:39.950 --> 00:09:43.456\nI can pick a nice, small network here\nthat provided at least 50 IPs, right?\n\n198\n00:09:43.456 --> 00:09:47.930\nOr, really, 51 IPs, because we need at\nleast one ip for the firewall itself.\n\n199\n00:09:49.130 --> 00:09:53.428\nYou do not want to overlap a network\nthat's already in use on your network.\n\n200\n00:09:53.428 --> 00:09:54.916\nIt'll actually let you do it.\n\n201\n00:09:54.916 --> 00:09:59.390\nSo I've got 192.168.0\nas my internal network.\n\n202\n00:09:59.390 --> 00:10:04.090\nI could use 192.168.0 here but\nit's not a good idea.\n\n203\n00:10:04.090 --> 00:10:07.770\nThe main reason, it's not a good idea,\nhere is now every broadcast\n\n204\n00:10:07.770 --> 00:10:10.620\nthat's sent In the internal network is\ngoing to be forwarded across the VPN and\n\n205\n00:10:10.620 --> 00:10:12.430\nthat's a mess, right?\n\n206\n00:10:12.430 --> 00:10:15.337\nSo we always want to pick a separate\nnetwork, and they even warn us about that,\n\n207\n00:10:15.337 --> 00:10:17.245\ntelling us you need to\nchoose one that is separate.\n\n208\n00:10:17.245 --> 00:10:20.891\nI'm using 192.168.0 on\nmy internal network.\n\n209\n00:10:20.891 --> 00:10:26.613\nI'm gonna use 192.168.1\non this VPN network.\n\n210\n00:10:26.613 --> 00:10:29.366\nThat's gonna give me 254 usable IPs.\n\n211\n00:10:29.366 --> 00:10:31.908\nThe firewall will take one leaving 253.\n\n212\n00:10:31.908 --> 00:10:33.770\nI can now support 253 clients.\n\n213\n00:10:34.860 --> 00:10:37.736\nIf anybody else connects, there's no IPs,\nthey won't able to function, right.\n\n214\n00:10:37.736 --> 00:10:40.960\nSo this does kind of limit\nthe amount of connections we get.\n\n215\n00:10:42.560 --> 00:10:44.475\nNow, this next option is probably\none of the most important.\n\n216\n00:10:44.475 --> 00:10:48.620\nForce all client-generated\ntraffic through the tunnel.\n\n217\n00:10:48.620 --> 00:10:49.200\nNotice how it's off?\n\n218\n00:10:50.400 --> 00:10:53.700\nBy default with remote\naccess VPNs in pfSense,\n\n219\n00:10:53.700 --> 00:10:55.650\nit does what's called split tunneling.\n\n220\n00:10:55.650 --> 00:10:58.470\nThe client,\nif they have traffic destined for\n\n221\n00:10:58.470 --> 00:11:01.470\nyour protected network,\nwe'll send it over the VPN tunnel.\n\n222\n00:11:01.470 --> 00:11:02.690\nIf it's traffic destined for\n\n223\n00:11:02.690 --> 00:11:07.460\nany other network, it'll send it straight\nout to that network and bypass the VPN.\n\n224\n00:11:07.460 --> 00:11:12.050\nNow that's good because it reduces\nbandwidth on the VPN tunnel,\n\n225\n00:11:12.050 --> 00:11:14.700\nyou're not sending wasteful\ntraffic over the VPN.\n\n226\n00:11:14.700 --> 00:11:19.215\nIt's bad And that you now have a client\nthat simultaneously connected to\n\n227\n00:11:19.215 --> 00:11:20.851\nthe internet and the VPN.\n\n228\n00:11:20.851 --> 00:11:22.673\nAnd if a hacker compromises the machine,\n\n229\n00:11:22.673 --> 00:11:25.961\nthey can leapfrog through that machine\nto get in to your internal network.\n\n230\n00:11:25.961 --> 00:11:28.740\nThat is not so good, right?\n\n231\n00:11:28.740 --> 00:11:32.428\nSo generally, we want to turn this\non to say, if a client connects,\n\n232\n00:11:32.428 --> 00:11:35.621\nwe want 100% of their traffic\nto come through the VPN.\n\n233\n00:11:35.621 --> 00:11:39.361\nNow, if an attacker is attached to\ntheir machine via the internet,\n\n234\n00:11:39.361 --> 00:11:42.587\nthey get disconnected the moment\nthe VPM tunnel comes up.\n\n235\n00:11:42.587 --> 00:11:44.328\nIf they try and get in through the VPM,\n\n236\n00:11:44.328 --> 00:11:47.649\nthey're coming through our corporate\nnetwork and we have our filters,\n\n237\n00:11:47.649 --> 00:11:51.140\nour intrusion detection and\nall the protections that are in place.\n\n238\n00:11:51.140 --> 00:11:53.112\nSo it's kind of an extra\nprotection mechanism there.\n\n239\n00:11:53.112 --> 00:11:56.711\nIt does mean some wasteful traffic\nwill come over the VPN tunnel.\n\n240\n00:11:56.711 --> 00:12:01.210\nIf they're browsing eBay, or a news site,\nor whatever, it's gonna go through your\n\n241\n00:12:01.210 --> 00:12:05.399\ncorporate network, but we generally\nwant that to protect the machine, then,\n\n242\n00:12:05.399 --> 00:12:07.037\nwe specify our local network.\n\n243\n00:12:07.037 --> 00:12:09.997\nHow does the client know\nwhat traffic to send here?\n\n244\n00:12:09.997 --> 00:12:11.064\nWe just need to specify it.\n\n245\n00:12:11.064 --> 00:12:14.500\nIt needs to encompass all of\nthe networks you are using.\n\n246\n00:12:14.500 --> 00:12:18.125\nYou might have more than one network so\nyou will kind of have to specify that.\n\n247\n00:12:18.125 --> 00:12:19.480\nIn my case, I have just got the one.\n\n248\n00:12:19.480 --> 00:12:22.305\nSo, I will punch it right in here,\nthat is my local network.\n\n249\n00:12:24.165 --> 00:12:25.674\nThen I can limit my\nconcurrent connections.\n\n250\n00:12:25.674 --> 00:12:27.973\nNow we ignored this field in\nthe site to site episodes.\n\n251\n00:12:27.973 --> 00:12:33.750\nBut here, we need to think about how many\nclients we can actually support, right?\n\n252\n00:12:33.750 --> 00:12:36.103\nIf I have these VPN connections coming in,\nmy server,\n\n253\n00:12:36.103 --> 00:12:38.212\nmy firewall might only be\nable to handle so many.\n\n254\n00:12:38.212 --> 00:12:41.700\nI might want to cap this\nat 20 connections, right?\n\n255\n00:12:41.700 --> 00:12:43.830\nIf a 21st person tries to connect,\nthey gotta wait.\n\n256\n00:12:44.980 --> 00:12:48.200\nOr if I leave it empty It'll just\nconnect as many as it can until\n\n257\n00:12:48.200 --> 00:12:49.970\nthe CPU gets bogged down and\nit can't handle any more.\n\n258\n00:12:52.690 --> 00:12:54.420\nIf we wanna compress traffic,\nwe can do that.\n\n259\n00:12:54.420 --> 00:12:56.315\nThat used to be a big deal\nunder dial-up connections,\n\n260\n00:12:56.315 --> 00:12:57.806\nwhere you didn't have a lot of bandwidth.\n\n261\n00:12:57.806 --> 00:13:00.987\nUnder WAN connections these days, or\nbroadband, really, you just got tons of\n\n262\n00:13:00.987 --> 00:13:03.851\nbandwidth, so we don't worry about\ncompression as much as we used to.\n\n263\n00:13:03.851 --> 00:13:07.779\nIt does create a CPU load,\ncuz you're having to compress and\n\n264\n00:13:07.779 --> 00:13:11.950\ndecompress data But\nit's not something we really use anymore.\n\n265\n00:13:13.420 --> 00:13:14.482\nAfter that, we have a few other options.\n\n266\n00:13:14.482 --> 00:13:16.179\nIf we wanna do Type-of-Service, TOS,\n\n267\n00:13:16.179 --> 00:13:19.377\nif you're handling things like quality\nof service, you can enable that, and\n\n268\n00:13:19.377 --> 00:13:22.420\nthe clients will pass that\ninformation across the VPN tunnel.\n\n269\n00:13:22.420 --> 00:13:25.775\nBut default, they get stripped off,\nso we can choose to preserve that,\n\n270\n00:13:25.775 --> 00:13:28.148\nwhether you want\ninter-client communications.\n\n271\n00:13:28.148 --> 00:13:31.126\nWell, let's say Ronnie VPNs\nin on his laptop, and\n\n272\n00:13:31.126 --> 00:13:36.180\nI VPN in on my laptop, we can both see\nthe servers, but can we see each other?\n\n273\n00:13:36.180 --> 00:13:36.849\nWe may or may not want that.\n\n274\n00:13:36.849 --> 00:13:40.147\nUsually you don't want that, and\nyou'll notice that it is off by default.\n\n275\n00:13:40.147 --> 00:13:43.070\nWe can turn that on, though, if we want\nthe clients to be able to see each other.\n\n276\n00:13:44.370 --> 00:13:46.670\nAnd then lastly, duplicate connections.\n\n277\n00:13:46.670 --> 00:13:49.623\nDo I want users to be able\nto connect more than once?\n\n278\n00:13:49.623 --> 00:13:50.921\nRonnie, you have two laptops.\n\n279\n00:13:50.921 --> 00:13:51.658\n>> Right.\n>> So,\n\n280\n00:13:51.658 --> 00:13:55.125\nwhat if he wants to VPN from both\nof his laptops at the same time?\n\n281\n00:13:55.125 --> 00:13:56.297\nDo I want to allow that?\n\n282\n00:13:56.297 --> 00:13:57.527\nMaybe.\n\n283\n00:13:57.527 --> 00:13:58.790\nNormally, we don't.\n\n284\n00:13:58.790 --> 00:14:00.376\nNormally, it means that they've\nbeen compromised, right?\n\n285\n00:14:00.376 --> 00:14:02.755\nThat somebody else is\ntrying to VPN in as them.\n\n286\n00:14:02.755 --> 00:14:03.788\nSo, we don't want it.\n\n287\n00:14:03.788 --> 00:14:05.498\nBut there are times where\nwe might want that.\n\n288\n00:14:05.498 --> 00:14:07.786\nLike, if somebody has\na wireless cellular card,\n\n289\n00:14:07.786 --> 00:14:11.652\nand they've got their regular network\nconnection, and they're flipping from one\n\n290\n00:14:11.652 --> 00:14:14.610\nto the other, their old connection\nmight still show as active.\n\n291\n00:14:14.610 --> 00:14:15.538\nWe don't wanna block them out.\n\n292\n00:14:15.538 --> 00:14:18.209\nBut normally, we don't want people\nto do simultaneous connection.\n\n293\n00:14:18.209 --> 00:14:20.010\nSo, that is off by default.\n\n294\n00:14:21.860 --> 00:14:23.500\nAfter that, the rest of these,\n\n295\n00:14:23.500 --> 00:14:26.150\nI think we could literally leave\nthe rest of these at the default.\n\n296\n00:14:26.150 --> 00:14:29.883\nBasically, it's saying that when a client\nconnects, what IP address do they get,\n\n297\n00:14:29.883 --> 00:14:32.312\nwhat DNS servers do they get and\nall that information.\n\n298\n00:14:32.312 --> 00:14:34.094\nWell, it's all blank by default, and\n\n299\n00:14:34.094 --> 00:14:37.236\nthat means that our firewall's\ngonna automatically assign these.\n\n300\n00:14:37.236 --> 00:14:40.579\nIt'll give them an IP from\nthat network that we defined.\n\n301\n00:14:40.579 --> 00:14:44.874\nIt will give them a DNS server and\na gateway of our firewall.\n\n302\n00:14:44.874 --> 00:14:47.219\nIt's all gonna come here through\nthe firewall, and that's what we want.\n\n303\n00:14:47.219 --> 00:14:49.670\nSo, these are really overrides.\n\n304\n00:14:49.670 --> 00:14:51.945\nDo I want to override these settings?\n\n305\n00:14:51.945 --> 00:14:55.977\nDo I want to provide a different default\ndomain name, a different DNS server,\n\n306\n00:14:55.977 --> 00:14:57.350\ndifferent NTP?\n\n307\n00:14:57.350 --> 00:14:58.001\nAnd you can provide those.\n\n308\n00:14:58.001 --> 00:15:01.673\nBut they'll default to the firewall,\nand that is typically what we want.\n\n309\n00:15:01.673 --> 00:15:04.110\nSo, I'm not gonna do\nany overrides on these.\n\n310\n00:15:04.110 --> 00:15:04.850\nAnd I'll go ahead and hit Next.\n\n311\n00:15:06.782 --> 00:15:08.927\nAll right, in order for the VPN to work,\n\n312\n00:15:08.927 --> 00:15:12.718\nwe've gotta have some firewall rules\nto allow the connections in, and\n\n313\n00:15:12.718 --> 00:15:15.831\nwe've got to have some NAT\nrules to allow connections in.\n\n314\n00:15:15.831 --> 00:15:18.780\nAnd so it's going to offer\nto create those for me.\n\n315\n00:15:18.780 --> 00:15:20.482\nI'm gonna go ahead a check those but\n\n316\n00:15:20.482 --> 00:15:24.170\nif I want to restrict it somehow I\ncould go in a provide those manually.\n\n317\n00:15:24.170 --> 00:15:26.730\nI usually go ahead and check this to let\nit create it and then I go ahead and\n\n318\n00:15:26.730 --> 00:15:27.853\nmodify the rules that it made.\n\n319\n00:15:27.853 --> 00:15:28.619\nThat's easy enough.\n\n320\n00:15:30.719 --> 00:15:32.380\nWe'll go ahead and finish that up.\n\n321\n00:15:32.380 --> 00:15:35.750\nAnd now, we've got a remote access\nserver up and running, right?\n\n322\n00:15:35.750 --> 00:15:39.709\nWe are a server ready to\nreceive client connections.\n\n323\n00:15:39.709 --> 00:15:44.085\nIf I go to my firewall rules,\nI'll see that it created rules for\n\n324\n00:15:44.085 --> 00:15:47.895\nthat right here,\nallowing open VPN connectivity in.\n\n325\n00:15:47.895 --> 00:15:48.737\nSo, it's right there.\n\n326\n00:15:48.737 --> 00:15:49.950\nPeople will be able to connect.\n\n327\n00:15:49.950 --> 00:15:53.439\nAnd access my system.\n\n328\n00:15:53.439 --> 00:15:56.340\nAt this point,\nI'm technically done with the server.\n\n329\n00:15:56.340 --> 00:15:58.650\nI need to go and get my client connected.\n\n330\n00:15:58.650 --> 00:16:01.561\nWell, on my client,\nI can fire up an OpenVPN client,\n\n331\n00:16:01.561 --> 00:16:03.328\nI can provide all the settings.\n\n332\n00:16:03.328 --> 00:16:04.546\nBut I guess, some little problems.\n\n333\n00:16:04.546 --> 00:16:07.746\n>> [LAUGH]\n>> Little problems are things like,\n\n334\n00:16:07.746 --> 00:16:10.785\nhow do I give all this configuration\ninformation to an end user?\n\n335\n00:16:10.785 --> 00:16:13.800\n>> [LAUGH]\n>> End users don't understand this data.\n\n336\n00:16:13.800 --> 00:16:18.001\nAnd if I go back to my VPN and\nI pull up its settings,\n\n337\n00:16:18.001 --> 00:16:20.713\nwe've got things like the key.\n\n338\n00:16:20.713 --> 00:16:22.780\nThis TLS key that'd we have to give.\n\n339\n00:16:22.780 --> 00:16:25.231\nThese are things that you don't typically\ndon't wanna give to an end user,\n\n340\n00:16:25.231 --> 00:16:26.970\ncuz they're not gonna be\nable to handle it properly.\n\n341\n00:16:26.970 --> 00:16:30.259\nSo the better way to do this is\nto create a client package and\n\n342\n00:16:30.259 --> 00:16:32.690\nthere's a few ways to go about doing that.\n\n343\n00:16:32.690 --> 00:16:33.670\nBut the easiest way,\n\n344\n00:16:33.670 --> 00:16:36.896\nit's just a really neat packaging\nutility that's a part of pfSense.\n\n345\n00:16:36.896 --> 00:16:40.310\nIt's not installed by default,\nso I'm gonna add it real quick.\n\n346\n00:16:40.310 --> 00:16:45.723\nIf you go up to System and Packages and\nwe go under Available Packages,\n\n347\n00:16:45.723 --> 00:16:49.233\nthere's an OpenVPN Client Export Utility.\n\n348\n00:16:49.233 --> 00:16:51.534\nLet me see if I can find it in here.\n\n349\n00:16:51.534 --> 00:16:57.110\nI think it's under OpenVPN,\nit's in here somewhere.\n\n350\n00:16:57.110 --> 00:16:58.120\nThere it is.\n\n351\n00:16:58.120 --> 00:17:00.270\nOpenVPN Client Export Utility.\n\n352\n00:17:00.270 --> 00:17:04.664\nThis guy will let you build these really\neasy to use client packages that we can\n\n353\n00:17:04.664 --> 00:17:06.976\nadd in and get people set up really fast.\n\n354\n00:17:06.976 --> 00:17:09.900\nSo, I'm gonna hit the plus\nsign to add this package.\n\n355\n00:17:09.900 --> 00:17:11.180\nWe'll confirm that.\n\n356\n00:17:11.180 --> 00:17:13.493\nIt installs pretty quick,\nit's not terribly large.\n\n357\n00:17:13.493 --> 00:17:17.817\nAnd as soon as its done, we'll have a new\ntab on our VPN configuration screen where\n\n358\n00:17:17.817 --> 00:17:19.520\nwe can export these utilities.\n\n359\n00:17:21.143 --> 00:17:26.230\nSo there we go, that just finished and\nnow we're in business.\n\n360\n00:17:26.230 --> 00:17:32.340\nSo if I go back up here to my VPN,\nI've got a new tab for\n\n361\n00:17:32.340 --> 00:17:36.250\nClient Export and you can come in and\npick your VPN and\n\n362\n00:17:36.250 --> 00:17:40.130\nit can build a number of different\npackages to be available for\n\n363\n00:17:40.130 --> 00:17:42.000\nyou to be able to download and\nsend over to a client.\n\n364\n00:17:43.610 --> 00:17:47.233\nBut there's still a little more work I\nneed to do before I export that client,\n\n365\n00:17:47.233 --> 00:17:49.657\nsome things that I might\nneed to tweak a little bit.\n\n366\n00:17:49.657 --> 00:17:52.610\nWhen we ran through the wizard,\nit setup the server.\n\n367\n00:17:52.610 --> 00:17:57.110\nAnd when it setup the server,\nit set it up for\n\n368\n00:17:57.110 --> 00:18:00.770\nSSL/TLS + User Authentication.\n\n369\n00:18:00.770 --> 00:18:03.297\nThe idea here is that it's\nsomething the user has and\n\n370\n00:18:03.297 --> 00:18:05.430\nit's something the user knows.\n\n371\n00:18:05.430 --> 00:18:09.480\nSomething they have is that certificate.\n\n372\n00:18:09.480 --> 00:18:10.437\nAnd that certificate,\nthat was just that key that it\n\n373\n00:18:10.437 --> 00:18:11.080\nautomatically generated for me.\n\n374\n00:18:11.080 --> 00:18:12.857\nThat was the certificate\nthat it was using.\n\n375\n00:18:12.857 --> 00:18:16.290\nSomething they know,\nthat's their username and password.\n\n376\n00:18:16.290 --> 00:18:18.023\nThose are the two forms of authentication.\n\n377\n00:18:18.023 --> 00:18:19.669\nSo, I've got to give\nthem a certificate and\n\n378\n00:18:19.669 --> 00:18:21.860\nthey've got to have a valid user account.\n\n379\n00:18:21.860 --> 00:18:25.164\nI haven't made any user accounts yet,\nso I probably need to do that.\n\n380\n00:18:25.164 --> 00:18:27.020\nOr I could say, you know what?\n\n381\n00:18:27.020 --> 00:18:27.637\nForget it.\n\n382\n00:18:27.637 --> 00:18:32.550\nI'm just gonna do Remote Access (SSL/TLS).\n\n383\n00:18:32.550 --> 00:18:34.530\nYou just have to have the certificate, but\n\n384\n00:18:34.530 --> 00:18:36.785\nwhat if somebody gets\na hold of the certificate?\n\n385\n00:18:36.785 --> 00:18:38.290\nNow they can connect to the net work.\n\n386\n00:18:38.290 --> 00:18:40.795\nThey might not have access to\nmy net work resources, but\n\n387\n00:18:40.795 --> 00:18:42.408\nthey can start doing exploration.\n\n388\n00:18:42.408 --> 00:18:43.590\nOr I could say, you know what?\n\n389\n00:18:43.590 --> 00:18:45.627\nForget it.\nI'm just gonna do user authentication,\n\n390\n00:18:45.627 --> 00:18:47.450\nI don't care about the certificate.\n\n391\n00:18:47.450 --> 00:18:48.415\nJust give a username and a password.\n\n392\n00:18:48.415 --> 00:18:51.010\nGet that, get that connected and\nyou're in business.\n\n393\n00:18:51.010 --> 00:18:52.050\nThat can work out pretty well,\n\n394\n00:18:52.050 --> 00:18:54.211\nif you're authenticating against\nlike the Active Directory,\n\n395\n00:18:54.211 --> 00:18:55.582\nthey just need a username and password.\n\n396\n00:18:55.582 --> 00:18:58.970\nBut if somebody knows that password,\nnow you've got a compromise.\n\n397\n00:18:58.970 --> 00:19:03.319\nSo the best solution is when you use both,\nSSL and user authentication.\n\n398\n00:19:03.319 --> 00:19:04.879\nNow, they've got to have\nthe certificate and\n\n399\n00:19:04.879 --> 00:19:06.520\nthey've got to know the username and\npassword.\n\n400\n00:19:07.750 --> 00:19:10.856\nSo this part down here,\nwhere we do TLS Authentication.\n\n401\n00:19:10.856 --> 00:19:12.960\nThat's a part of it.\n\n402\n00:19:12.960 --> 00:19:16.440\nAnd you'll see down here,\nthe Server Certificate that it's using and\n\n403\n00:19:16.440 --> 00:19:17.660\nthe other information.\n\n404\n00:19:17.660 --> 00:19:21.030\nBut the next step is to\ncreate that user account.\n\n405\n00:19:21.030 --> 00:19:25.134\nSo, I'm gonna go up here to System and\nUser Manager and\n\n406\n00:19:25.134 --> 00:19:27.730\nhere's where we add in our users.\n\n407\n00:19:27.730 --> 00:19:29.183\nI'm gonna add in a new user and\n\n408\n00:19:29.183 --> 00:19:32.106\nthis is where you'd punch in\nwhat that user was going to be.\n\n409\n00:19:32.106 --> 00:19:35.028\nSo I'm just gonna give this one\na generic name, I'll call it VPN User.\n\n410\n00:19:35.028 --> 00:19:40.910\nBut this might be like Bob Smith in\naccounting, so it's B Smith or whatever.\n\n411\n00:19:40.910 --> 00:19:45.010\nSo I'll give that a password and\nthis'll be my VPN User.\n\n412\n00:19:46.490 --> 00:19:49.430\nYou can set an expiration date,\nif you want the user to be temporary and\n\n413\n00:19:49.430 --> 00:19:50.570\nthen you can set their groups.\n\n414\n00:19:51.570 --> 00:19:55.033\nNow for my Group Memberships, I can\nsee I've got like admin and that's it.\n\n415\n00:19:55.033 --> 00:19:59.424\nThey don't have to be a member of a\nparticular account, they just have to have\n\n416\n00:19:59.424 --> 00:20:04.105\na valid account to access the system and\nthen we do need a client user certificate.\n\n417\n00:20:04.105 --> 00:20:07.306\nSo, I'm gonna check that off\nto generate a certificate and\n\n418\n00:20:07.306 --> 00:20:11.531\nI'll just call this myvpnuserCert and\nit's gonna generate it from this CA and\n\n419\n00:20:11.531 --> 00:20:14.120\nmake it a good for\na certain period of time.\n\n420\n00:20:14.120 --> 00:20:16.800\nSo, I'm just gonna specify that and\nwe'll go ahead and save it.\n\n421\n00:20:18.070 --> 00:20:20.950\nSo now, I've got this VPN User in place.\n\n422\n00:20:20.950 --> 00:20:23.892\nIf we were authenticating\nagainst the Active Directory,\n\n423\n00:20:23.892 --> 00:20:25.400\nwe would create a group here.\n\n424\n00:20:25.400 --> 00:20:28.683\nAnd then in the Active Directory, we would\ncreate a group with the same name and\n\n425\n00:20:28.683 --> 00:20:31.220\nthen anybody we put in that group\nwould be able to access in.\n\n426\n00:20:31.220 --> 00:20:32.560\nSo you do group-based stuff.\n\n427\n00:20:32.560 --> 00:20:35.180\nBut here for this regular user,\nthat's what I've got.\n\n428\n00:20:35.180 --> 00:20:38.583\nIf I look under my groups you'll\nsee I've just got that admin group.\n\n429\n00:20:38.583 --> 00:20:43.060\nI might wanna create a new\ngroup here called VPN Users and\n\n430\n00:20:43.060 --> 00:20:46.690\nyou can specify who is\ngonna be in that group.\n\n431\n00:20:47.780 --> 00:20:50.797\nSo I can put my VPN users in\nthere in the individual people.\n\n432\n00:20:50.797 --> 00:20:55.097\nAnd doing this like creating a group like\nthis is nice, because you can come in and\n\n433\n00:20:55.097 --> 00:20:58.400\nyou can specify Settings and\nServers that are allowed to use.\n\n434\n00:20:58.400 --> 00:21:01.368\nHere is where you specified the Active\nDirectory and other information.\n\n435\n00:21:01.368 --> 00:21:05.165\nSo you can kind of manipulate, however,\nthis is that you want it to be.\n\n436\n00:21:05.165 --> 00:21:07.346\nBut just having that user\naccount as the main part, so\n\n437\n00:21:07.346 --> 00:21:10.020\nI've got that user account created and\nI should be ready to rock.\n\n438\n00:21:11.740 --> 00:21:16.205\nSo now when I go up to VPN and OpenVPN,\n\n439\n00:21:16.205 --> 00:21:20.040\nI can come into my settings and\nI can go to my client export.\n\n440\n00:21:20.040 --> 00:21:23.336\nAnd when I go to Export,\nI can pick what it is I'm exporting.\n\n441\n00:21:23.336 --> 00:21:26.018\nSo here's my Remote Access VPN.\n\n442\n00:21:26.018 --> 00:21:30.603\nFor the host name, I want them to connect\nto the IP address of my WAN interface and\n\n443\n00:21:30.603 --> 00:21:32.183\nthat's the default here.\n\n444\n00:21:32.183 --> 00:21:36.780\nBut you might have things like a host name\nthat you want to switch to or dynamic DNS.\n\n445\n00:21:36.780 --> 00:21:38.485\nIn my case, we'll just use the IP address.\n\n446\n00:21:38.485 --> 00:21:40.690\nI've got a static IP, that's what I\nwant people to want to connect to.\n\n447\n00:21:41.760 --> 00:21:44.640\nFor verifying the server certificate,\nwe can leave that at a default,\n\n448\n00:21:44.640 --> 00:21:46.917\nwhich is to go ahead and\nverify the X.509 certificate.\n\n449\n00:21:48.510 --> 00:21:50.929\nUse a random local port,\nwe normally want that.\n\n450\n00:21:50.929 --> 00:21:53.408\nThe clients generate\ntheir own random port.\n\n451\n00:21:53.408 --> 00:21:56.700\nIf you wanna lock it down on the firewall\nto only certain source ports,\n\n452\n00:21:56.700 --> 00:21:58.220\nyou need to turn this off, so\n\n453\n00:21:58.220 --> 00:22:01.210\nthat you could then define what\nthat source port was going to be.\n\n454\n00:22:02.910 --> 00:22:06.505\nHow we're gonna export the certificate\nif we need to export a cert,\n\n455\n00:22:06.505 --> 00:22:09.847\nit can do the Microsoft style or\njust a password protected one,\n\n456\n00:22:09.847 --> 00:22:12.133\nif you're doing like a viscosity bundle.\n\n457\n00:22:12.133 --> 00:22:14.955\nI'm gonna leave those empty, it's just\ngonna put the cert right in there and\n\n458\n00:22:14.955 --> 00:22:17.260\nnot do any special protections on it.\n\n459\n00:22:17.260 --> 00:22:19.930\nWe're not using a proxy,\nso we don't need that.\n\n460\n00:22:19.930 --> 00:22:23.248\nAnd then whether or not we want\nthe clients to be able to access\n\n461\n00:22:23.248 --> 00:22:26.177\nthe management interface of OpenVPN and\nthe server,\n\n462\n00:22:26.177 --> 00:22:29.057\nwe don't normally want that,\nit is off by default.\n\n463\n00:22:29.057 --> 00:22:32.089\nAfter that, now I see my users and\n\n464\n00:22:32.089 --> 00:22:38.070\nI can export the package based on\nwhat that user is gonna be using.\n\n465\n00:22:38.070 --> 00:22:41.247\nSo, is my user going to be using Windows?\n\n466\n00:22:41.247 --> 00:22:44.916\nIf so, it's got packages for\nWindows XP and Windows 6,\n\n467\n00:22:44.916 --> 00:22:48.980\nwhich is Windows Vista and\nhigher and its actual executables.\n\n468\n00:22:48.980 --> 00:22:53.190\nIt'll install the OpenVPN client with\nall the settings in one fell swoop.\n\n469\n00:22:53.190 --> 00:22:58.000\nIf you're using Mac, there's a VPN client\ncalled Viscosity, I use that myself.\n\n470\n00:22:58.000 --> 00:23:01.849\nIf we go to my real desktop, you'll see\nthat's my Viscosity menu up top where\n\n471\n00:23:01.849 --> 00:23:04.648\nI can VPN into all my various\nplaces that I've VPN into.\n\n472\n00:23:04.648 --> 00:23:09.790\nSo you can quickly export the Viscosity\nbundle to import into that client.\n\n473\n00:23:09.790 --> 00:23:12.600\nNow the end user,\nall they need to know is their password.\n\n474\n00:23:12.600 --> 00:23:15.340\nThey don't need to know all the settings,\nit's all right here.\n\n475\n00:23:15.340 --> 00:23:17.076\nIf you're exporting to a mobile device,\n\n476\n00:23:17.076 --> 00:23:20.012\nyou can do these archives in your\nmobile OpenVPN client can import it.\n\n477\n00:23:20.012 --> 00:23:21.830\nSo really easy stuff to do there.\n\n478\n00:23:23.790 --> 00:23:25.609\nSo we had that question in the chat room.\n\n479\n00:23:25.609 --> 00:23:28.200\nWhen you export this,\ndoes it include the client utility?\n\n480\n00:23:28.200 --> 00:23:29.493\nIt does for Windows.\n\n481\n00:23:29.493 --> 00:23:30.690\nIt doesn't for the other guys.\n\n482\n00:23:30.690 --> 00:23:32.812\nThe other guys are just a config file and\n\n483\n00:23:32.812 --> 00:23:37.196\nso you need to get the software installed\nfirst and then import that config file.\n\n484\n00:23:37.196 --> 00:23:41.216\nI'm gonna export to a Windows machine,\nit's running Windows 8 and it's 64-bit.\n\n485\n00:23:41.216 --> 00:23:44.487\nSo, I'm gonna choose this x64-win6 one.\n\n486\n00:23:44.487 --> 00:23:47.999\nI'll select that and\nI'm gonna download it.\n\n487\n00:23:47.999 --> 00:23:51.905\nNow normally, what you would do is\nsave this to like a USB key and\n\n488\n00:23:51.905 --> 00:23:55.620\nthen once you had it saved You\ncould copy it over somewhere.\n\n489\n00:23:55.620 --> 00:23:59.090\nOh, it's warning me that\nthis could harm my computer.\n\n490\n00:23:59.090 --> 00:24:01.910\nBut I'm going to, well,\nI don't wanna run it.\n\n491\n00:24:01.910 --> 00:24:02.610\nI just wanna download it.\n\n492\n00:24:02.610 --> 00:24:04.150\nLet's see if it actually downloaded.\n\n493\n00:24:04.150 --> 00:24:05.650\nWindows is protecting me from myself.\n\n494\n00:24:05.650 --> 00:24:06.840\nI did download it, good.\n\n495\n00:24:06.840 --> 00:24:09.950\nAll right, so here it is, downloaded.\n\n496\n00:24:09.950 --> 00:24:11.890\nNow, I have to be careful\nwith this a little bit.\n\n497\n00:24:11.890 --> 00:24:15.620\nIf I'm doing certificate based\nauthentication, this installer is really.\n\n498\n00:24:15.620 --> 00:24:17.480\nKind of tied to the user that use.\n\n499\n00:24:17.480 --> 00:24:21.980\nBut if I'm doing certificate and user\nname, and password, the certificates kind\n\n500\n00:24:21.980 --> 00:24:25.170\nof generic and the user name and\npassword are what differentiate.\n\n501\n00:24:25.170 --> 00:24:27.940\nSo I just need to give\nthis over to my user.\n\n502\n00:24:27.940 --> 00:24:32.620\nNormally I'd put it on a USB key and take\nit over, or burn it to a CD, or whatever.\n\n503\n00:24:32.620 --> 00:24:35.488\nBut in my case,\nI'm gonna send it over my network.\n\n504\n00:24:35.488 --> 00:24:38.850\nI've got a shared folder here,\nI can use for that.\n\n505\n00:24:38.850 --> 00:24:42.020\nAnd I'll just paste that in.\n\n506\n00:24:42.020 --> 00:24:43.560\nThere we go.\n\n507\n00:24:43.560 --> 00:24:47.480\nNow, all I have to do is jump over\nto my client and get that installed.\n\n508\n00:24:47.480 --> 00:24:51.070\nNow my client's out there\nin the real world, right?\n\n509\n00:24:51.070 --> 00:24:55.730\nOut of some public network, and if I\nlook at my IP I'll see that I've got a.\n\n510\n00:24:55.730 --> 00:24:57.330\nA public IP on this machine,\n\n511\n00:24:57.330 --> 00:25:02.144\nand if I try and ping 192.168.0.200\nI can't ping that server.\n\n512\n00:25:02.144 --> 00:25:04.580\nRight, it's a private IP,\nI'm not gonna get routed there anyway.\n\n513\n00:25:06.930 --> 00:25:12.060\nSo I need to install that client, so I'm\ngonna come in here and get that installed.\n\n514\n00:25:13.810 --> 00:25:17.180\nAnd the nice thing about this is it's\nbringing along the configuration for it so\n\n515\n00:25:17.180 --> 00:25:19.740\nI don't have to be some kind\nof wizard to get this set up.\n\n516\n00:25:19.740 --> 00:25:22.280\nYour average end user, as long as they\nhave permission to install software,\n\n517\n00:25:22.280 --> 00:25:23.420\ncan install this.\n\n518\n00:25:23.420 --> 00:25:25.550\nEven if they really know the way to do it,\n\n519\n00:25:25.550 --> 00:25:27.820\nit's kind of nice just to\nhave it the automatic anyway.\n\n520\n00:25:27.820 --> 00:25:29.220\nI'm going to let that install.\n\n521\n00:25:29.220 --> 00:25:31.290\nI'm actually not going to\nchange anything on this,\n\n522\n00:25:31.290 --> 00:25:33.070\njust let it install with the defaults.\n\n523\n00:25:34.740 --> 00:25:38.390\nNow, once it's installed, I'll have the\nVPN, the open VPN client installed, and\n\n524\n00:25:38.390 --> 00:25:43.110\nI can launch it's GUI, and\nhave it build up a VPN connection, right?\n\n525\n00:25:43.110 --> 00:25:44.420\nIt'll ask me for my password.\n\n526\n00:25:44.420 --> 00:25:46.970\nI'll have to put that in, but\notherwise, it should just connect.\n\n527\n00:25:48.050 --> 00:25:48.860\nI said should.\n\n528\n00:25:48.860 --> 00:25:52.640\n[LAUGH] You've got to use\nyour IT safety word there.\n\n529\n00:25:52.640 --> 00:25:55.480\nI'm going to go ahead and start that GUI.\n\n530\n00:25:55.480 --> 00:25:58.440\nSo that'll finish, and\ndown here in my system tray you can\n\n531\n00:25:58.440 --> 00:26:03.480\nsee that little computer with a lock\nappeared, that's the VPN GUI.\n\n532\n00:26:03.480 --> 00:26:07.890\nAnd if I click on it, it's trying to\nconnect and asking for my username and\n\n533\n00:26:07.890 --> 00:26:09.570\nmy password which hopefully I remember.\n\n534\n00:26:11.170 --> 00:26:15.020\nSo I'll just punch that in and\nit's gonna reach out and connect,\n\n535\n00:26:15.020 --> 00:26:18.380\nit's trying to contact the server,\nit's exchanging certificates right?\n\n536\n00:26:18.380 --> 00:26:21.670\nThe certificate was built into it and\nit's giving it my user name and\n\n537\n00:26:21.670 --> 00:26:24.420\nmy password and then I'm connected.\n\n538\n00:26:24.420 --> 00:26:27.040\nI'm connected I've got my little\ngreen light up here right there, so\n\n539\n00:26:27.040 --> 00:26:30.380\nI know that I'm connected and\nif I drop to my command prompt,\n\n540\n00:26:31.570 --> 00:26:34.500\nearlier when I did an IP config\nI saw that I had a public IP.\n\n541\n00:26:34.500 --> 00:26:41.490\nIf I do an IP config now,\nI've still got that public IP.\n\n542\n00:26:41.490 --> 00:26:46.650\nBut now I've got a virtual network\nadapter on the 192.168.1 network.\n\n543\n00:26:47.670 --> 00:26:51.500\nThat second network that we created for\nthe VPN service.\n\n544\n00:26:51.500 --> 00:26:58.230\nAnd if I try and ping 192.168.0.200,\nthat's that server on the back end.\n\n545\n00:26:58.230 --> 00:27:01.450\nAnd assuming I'm not blocking\npings on this firewall,\n\n546\n00:27:01.450 --> 00:27:02.890\nI should be able to get to it.\n\n547\n00:27:02.890 --> 00:27:05.480\nNow, I might actually not have access.\n\n548\n00:27:05.480 --> 00:27:09.380\nSo I'm not getting to that server.\n\n549\n00:27:09.380 --> 00:27:10.770\nWhat's my problem here?\n\n550\n00:27:10.770 --> 00:27:14.540\nWell your open VPN does have firewall\nrules just like anything else.\n\n551\n00:27:14.540 --> 00:27:18.410\nAnd I don't recall adjusting them\nin my case, so I'll bet I didn't.\n\n552\n00:27:18.410 --> 00:27:26.530\nIf we go back here to our server and\nwe go up here to our firewall and rules.\n\n553\n00:27:26.530 --> 00:27:29.520\nYou'll see I've got an open VPN tab.\n\n554\n00:27:29.520 --> 00:27:34.680\nAnd right now it says, I'm allowing\nIPB 4 traffic to pretty much anywhere.\n\n555\n00:27:34.680 --> 00:27:38.940\nSo I don't have any limitations\nthere which should be good to go.\n\n556\n00:27:38.940 --> 00:27:40.630\nLet me just double check my routing.\n\n557\n00:27:41.740 --> 00:27:46.740\nAnd notice in my routing here I've\ngot my routes are pretty much empty,\n\n558\n00:27:46.740 --> 00:27:48.560\nwhich it should be\ndynamically generating these.\n\n559\n00:27:48.560 --> 00:27:51.050\nYou know, you've got your dynamic\nentries for your default gateway.\n\n560\n00:27:51.050 --> 00:27:51.880\nSo we should be good there.\n\n561\n00:27:51.880 --> 00:27:54.680\nAnd yeah,\nwe should actually have connectivity.\n\n562\n00:27:54.680 --> 00:27:58.378\nLet me just double check on my server\nwhat default gateway I'm using.\n\n563\n00:27:58.378 --> 00:28:00.140\nIf my default gateway is not the firewall,\n\n564\n00:28:00.140 --> 00:28:02.830\nthen I don't know how to get back to\n192.168.1, and that might be the case.\n\n565\n00:28:04.020 --> 00:28:05.720\nBut, in this case, I'm getting there.\n\n566\n00:28:05.720 --> 00:28:08.110\nCould just be a case of\nthe server blocking pings.\n\n567\n00:28:08.110 --> 00:28:09.760\nLet's see if I can get to that website.\n\n568\n00:28:09.760 --> 00:28:12.960\nThat server is running a web server,\nso we'll see if I can browse to that.\n\n569\n00:28:16.300 --> 00:28:17.770\nI'll punch in and\nsure enough I'm getting to it.\n\n570\n00:28:17.770 --> 00:28:20.210\nSo the server itself is blocking pings.\n\n571\n00:28:20.210 --> 00:28:23.840\nThat's why I couldn't ping it, but\nI can get to that web server website and\n\n572\n00:28:23.840 --> 00:28:28.780\nI can see right here the server\nI browse to is 1921680200 and\n\n573\n00:28:28.780 --> 00:28:33.260\nmy IP was 192.168.1.6.\n\n574\n00:28:33.260 --> 00:28:38.440\nWhen I browse to that IP or to the private\nnetwork I am going across my VPN tunnel.\n\n575\n00:28:38.440 --> 00:28:43.030\nI have a secure connection and it is going\nto stay secure until I close the VPN.\n\n576\n00:28:43.030 --> 00:28:45.240\nIf I close my VPN connection,\n\n577\n00:28:45.240 --> 00:28:50.310\nif I just go down here and\nwe will disconnect that all right.\n\n578\n00:28:50.310 --> 00:28:55.930\nNow I'm going to disconnect,\nI'll see my internal IP disappear.\n\n579\n00:28:55.930 --> 00:28:58.870\nYep, no internal IP any more,\njust that public IP, and\n\n580\n00:28:58.870 --> 00:29:04.660\nif I fire up my web browser and\ntry to get to 192.168.0.200\n\n581\n00:29:05.830 --> 00:29:09.240\nIt's not gonna get there cuz I don't have\nthat secure tunnel in place anymore.\n\n582\n00:29:09.240 --> 00:29:09.850\nAlright.\n\n583\n00:29:09.850 --> 00:29:11.630\nNow, was that hard to set up?\n\n584\n00:29:11.630 --> 00:29:13.320\nIt really wasn't.\n\n585\n00:29:13.320 --> 00:29:15.300\nRight?\nEven if I wanted to go that extra mile and\n\n586\n00:29:15.300 --> 00:29:17.910\nset up directory authentication,\nit's really not even that hard.\n\n587\n00:29:17.910 --> 00:29:19.210\nLet me just show that real quick here.\n\n588\n00:29:19.210 --> 00:29:20.820\nWe're almost out of time.\n\n589\n00:29:20.820 --> 00:29:22.170\nBut if I go back to my.\n\n590\n00:29:22.170 --> 00:29:27.450\nMy firewall configuration and\nI go back into System and User Manager.\n\n591\n00:29:28.530 --> 00:29:31.550\nIn the User Manager you\ncan go to servers and\n\n592\n00:29:31.550 --> 00:29:34.990\nhere's where you can add in that radius or\nLDAP.\n\n593\n00:29:34.990 --> 00:29:37.220\nAnd if it's active directory\nyou would choose LDAP, so\n\n594\n00:29:37.220 --> 00:29:42.130\nI might call this my MS\nyou know active directory.\n\n595\n00:29:42.130 --> 00:29:45.520\nAnd you'd punch in the host name of\na server that was running that AD.\n\n596\n00:29:45.520 --> 00:29:53.190\nAnd then you'd specify down here what\nOU contained your user accounts.\n\n597\n00:29:53.190 --> 00:29:56.460\nAnd it includes subtrees so you might\njust put the parent of your domain.\n\n598\n00:29:56.460 --> 00:29:59.900\nAnd then down here you'd specify\nthe credentials you used for connecting.\n\n599\n00:29:59.900 --> 00:30:02.640\nIt defaults to anonymous, and\nthat doesn't really work.\n\n600\n00:30:02.640 --> 00:30:04.620\nSo you'd need to specify a user and\npassword for\n\n601\n00:30:04.620 --> 00:30:08.410\nthe firewall to connect to determine\nwhether user accounts were valid.\n\n602\n00:30:08.410 --> 00:30:12.090\nBut once you have that in place,\nyou just create a group\n\n603\n00:30:12.090 --> 00:30:16.530\nin the firewall with the same name\nas a group in active directory.\n\n604\n00:30:16.530 --> 00:30:18.740\nCase has to be the same too,\ncapital and lowercase letters,\n\n605\n00:30:18.740 --> 00:30:21.470\ngotta be identical you just\nput users in that group, and\n\n606\n00:30:21.470 --> 00:30:23.260\nthose are users who will\nhave permission to log in.\n\n607\n00:30:23.260 --> 00:30:25.120\nIt's really that easy.\n\n608\n00:30:25.120 --> 00:30:26.950\nYou don't have to generate\ncertificates for those users.\n\n609\n00:30:26.950 --> 00:30:29.870\nThey'll use the OpenVPN cert,\nand you'll be in business.\n\n610\n00:30:29.870 --> 00:30:32.460\nSo, pretty easy to get this going.\n\n611\n00:30:32.460 --> 00:30:33.460\nEven for a home user.\n\n612\n00:30:33.460 --> 00:30:36.540\nIf you just want to be able to VPN into\nyour own home when you're out on the road\n\n613\n00:30:36.540 --> 00:30:37.190\nIt's a great thing to use.\n\n614\n00:30:39.240 --> 00:30:42.240\nAll right, well I think that about\nwraps it up for good old open VPN.\n\n615\n00:30:42.240 --> 00:30:44.250\nRonnie, can you think of\nanything else to throw in?\n\n616\n00:30:44.250 --> 00:30:45.000\n>> Not really.\n\n617\n00:30:45.000 --> 00:30:48.420\nThis is just a great technology that you\nare probably going to see used in just\n\n618\n00:30:48.420 --> 00:30:50.120\nabout every businesses out there.\n\n619\n00:30:50.120 --> 00:30:53.500\nIf they have any laptops or any devices\nthat they are actually allowing users\n\n620\n00:30:53.500 --> 00:30:54.290\nto take off of their network.\n\n621\n00:30:54.290 --> 00:30:56.460\nYou'll probably see some type\nof connection like this.\n\n622\n00:30:56.460 --> 00:30:58.170\nSetting it up with open VPN.\n\n623\n00:30:58.170 --> 00:31:00.870\nActually seems incredibly straight forward\n\n624\n00:31:00.870 --> 00:31:04.790\ncompared to other ways that we've\nhad to try and set up remote access.\n\n625\n00:31:04.790 --> 00:31:05.490\n>> Yeah, absolutely.\n\n626\n00:31:05.490 --> 00:31:08.810\nAnd the fact that it's all just baked\nright into PF sense makes it great.\n\n627\n00:31:08.810 --> 00:31:11.510\nJust be aware, keep an eye on your CPU.\n\n628\n00:31:11.510 --> 00:31:13.550\nI'd keep an eye on\nthe memory of your firewall.\n\n629\n00:31:13.550 --> 00:31:16.340\nThat those are things that can get hit\nas you get more and more tunnels of,\n\n630\n00:31:16.340 --> 00:31:18.490\nthat CPU utilization starts to go up.\n\n631\n00:31:18.490 --> 00:31:19.510\nJust keep an eye on it.\n\n632\n00:31:19.510 --> 00:31:22.020\nYou might find that you have to bump\nup your hardware requirements or\n\n633\n00:31:22.020 --> 00:31:23.840\nbuy one of those VPN accelerator boards.\n\n634\n00:31:25.700 --> 00:31:29.360\nAll right, well, that pretty much wraps\nit up for Remote Access with OpenVPN.\n\n635\n00:31:29.360 --> 00:31:32.094\nHope you guys enjoyed the segment,\nstay tuned,\n\n636\n00:31:32.094 --> 00:31:34.567\nwe've got more PF sense content coming up.\n\n637\n00:31:34.567 --> 00:31:39.930\n[MUSIC].\n\n",
          "vimeoId": "130538614"
        },
        {
          "description": null,
          "length": "1658",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-4-site_to_site_ipsec-061215-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-4-site_to_site_ipsec-061215-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-4-4-site_to_site_ipsec-061215-1-sm.jpg",
          "title": "Site-to-Site IPsec",
          "transcript": "WEBVTT\n\n1\n00:00:00.470 --> 00:00:07.669\n[SOUND].\n\n2\n00:00:07.669 --> 00:00:08.622\nIn this segment,\n\n3\n00:00:08.622 --> 00:00:13.080\nwe're gonna take a look at configuring\nSite-to-Site IPsec tunnels in pfSense.\n\n4\n00:00:13.080 --> 00:00:14.786\nNow if you work with pfSense,\n\n5\n00:00:14.786 --> 00:00:19.170\nyou know that the project as a whole\nreally focuses on OpenVPN, right?\n\n6\n00:00:19.170 --> 00:00:22.830\nUsing OpenVPN for Site-to-Site connections\nand OpenVPN for remote access, and\n\n7\n00:00:22.830 --> 00:00:26.160\nthat's great until you get that\ncall from somebody and they say,\n\n8\n00:00:26.160 --> 00:00:30.570\nhey, we need to connect up to this branch\noffice and they've got a Sysco ASA,\n\n9\n00:00:30.570 --> 00:00:33.970\nor they've got a Juniper SSG,\nneither of which support Open VPN.\n\n10\n00:00:33.970 --> 00:00:37.030\nAnd you're like, well, great,\nhow am I gonna be able to VPN this\n\n11\n00:00:37.030 --> 00:00:41.990\nother vendor to Sysco or Juniper whoever,\nif they don't support Open VPN, and\n\n12\n00:00:41.990 --> 00:00:45.250\nthe solution is to use something\nthat's a little more standard.\n\n13\n00:00:45.250 --> 00:00:46.350\nIPsec, right.\n\n14\n00:00:46.350 --> 00:00:49.470\nAnd Ronnie,\npfSense has IPsec support baked in, right?\n\n15\n00:00:49.470 --> 00:00:50.180\n>> It really does.\n\n16\n00:00:50.180 --> 00:00:53.690\nIt has IPsec ready to go so\nthat you can connect to those\n\n17\n00:00:53.690 --> 00:00:56.800\nother products that are out there\nthat won't support OpenVPN.\n\n18\n00:00:56.800 --> 00:01:00.510\nSo it makes a very nice solution, even if\nyou're actually in the midst of changing\n\n19\n00:01:00.510 --> 00:01:02.840\nover and you're not exactly\nsure what's going on yet.\n\n20\n00:01:02.840 --> 00:01:06.370\nAnd you wanna switch everything over to\npfSense at this point you can set up one,\n\n21\n00:01:06.370 --> 00:01:09.410\nget IPsec running and\nthen change over to your other ones and\n\n22\n00:01:09.410 --> 00:01:13.630\nget all the way over to pfSense on\neverything, I was trying to say.\n\n23\n00:01:13.630 --> 00:01:16.279\nAnd then switch on over to OpenVPN.\n\n24\n00:01:16.279 --> 00:01:19.733\nSo what we want to do, is we wanna take\na look at actually establishing that IPsec\n\n25\n00:01:19.733 --> 00:01:22.030\nconnection between two different sites.\n\n26\n00:01:22.030 --> 00:01:26.320\nAnd the nice thing is the configuration\nis not really super difficult but\n\n27\n00:01:26.320 --> 00:01:29.270\nyou do need to make some choices, and\nthose choices are gonna be based off of\n\n28\n00:01:29.270 --> 00:01:33.630\nyour security policy, and of course what\nyou already have functioning and going.\n\n29\n00:01:33.630 --> 00:01:35.750\nSo that's what we wanna\nactually take a look at now.\n\n30\n00:01:35.750 --> 00:01:38.600\nSo let's go ahead and take a look\nat pfSense and get this set up.\n\n31\n00:01:38.600 --> 00:01:40.590\nSo I've got two machines set up,\n\n32\n00:01:40.590 --> 00:01:44.540\nthat is actually going to be connecting\nit from one site to another one.\n\n33\n00:01:44.540 --> 00:01:46.200\nSo, I've got Site A and Site B, and\n\n34\n00:01:46.200 --> 00:01:49.250\nthey're actually going to be\non a public internet network.\n\n35\n00:01:49.250 --> 00:01:52.930\nThe 209.251.159 network is what those\ntwo machines are gonna be on, and\n\n36\n00:01:52.930 --> 00:01:56.620\nwe're just gonna create\na tunnel in between them.\n\n37\n00:01:56.620 --> 00:01:58.930\nSo, we're gonna user IPsec to do so.\n\n38\n00:01:58.930 --> 00:02:02.820\nSo on this particular install,\neverything is ready to go.\n\n39\n00:02:02.820 --> 00:02:06.120\nThere's no special configurations on here.\n\n40\n00:02:06.120 --> 00:02:11.840\nAnd if I wanted to set up IPsec,\nI would go to VPN, and then select IPsec.\n\n41\n00:02:11.840 --> 00:02:14.110\nNow, this doesn't look very\nintimidating right now,\n\n42\n00:02:14.110 --> 00:02:16.020\nit looks like something that I can do.\n\n43\n00:02:16.020 --> 00:02:18.530\nSo it's very easy to actually set up.\n\n44\n00:02:18.530 --> 00:02:20.881\nAt this point,\nit looks like just a simple check box.\n\n45\n00:02:20.881 --> 00:02:22.700\nAll I have to do is enable it, and Don,\n\n46\n00:02:22.700 --> 00:02:24.710\nI think I'm done,\nonce I actually just enabled it.\n\n47\n00:02:24.710 --> 00:02:26.800\n>> Well, that was easy,\nRonnie, shorter show.\n\n48\n00:02:26.800 --> 00:02:29.880\n>> I wish that it was just that easy.\n\n49\n00:02:29.880 --> 00:02:32.710\nSometimes you actually have\nto make a lot of choices, and\n\n50\n00:02:32.710 --> 00:02:36.910\nthat's the real downfall, if you're not\nfamiliar with working with VPNs and\n\n51\n00:02:36.910 --> 00:02:41.210\nIPsec, is that there's a lot of choices\nthat you have to actually make.\n\n52\n00:02:41.210 --> 00:02:44.370\nAnd then the nice thing is, once you make\nthose choices, it's really an identical\n\n53\n00:02:44.370 --> 00:02:47.580\nconfiguration on the other side, or a\nmirrored configuration on the other side.\n\n54\n00:02:47.580 --> 00:02:49.050\nAnd you're just about ready to go.\n\n55\n00:02:49.050 --> 00:02:52.970\n>> Yeah, the thing to remember about IPsec\nis that it is not a protocol by itself.\n\n56\n00:02:52.970 --> 00:02:56.910\nIt's a framework that allows you to\npick and choose other protocols, and\n\n57\n00:02:56.910 --> 00:03:00.530\nput them together to create a secure\nconnection, and so in IPsec,\n\n58\n00:03:00.530 --> 00:03:03.390\nyou have to choose your encryption\nalgorithm, your hashing algorithm.\n\n59\n00:03:03.390 --> 00:03:05.550\nYou have to choose how you're\ngonna do your handshake.\n\n60\n00:03:05.550 --> 00:03:06.320\nAnd you have to do that for\n\n61\n00:03:06.320 --> 00:03:10.530\na phase one negotiation,\nwhere you just initialize the.\n\n62\n00:03:10.530 --> 00:03:11.100\n>> Tunnel connection.\n\n63\n00:03:11.100 --> 00:03:14.860\n>> The connection between the two systems,\nand then your phase two connection where\n\n64\n00:03:14.860 --> 00:03:18.210\nyou actually start to make it where\nyou can flow data across that tunnel.\n\n65\n00:03:18.210 --> 00:03:21.370\nSo it's really twice as many\nsettings as any of the other VPN\n\n66\n00:03:21.370 --> 00:03:22.820\ntechnologies that are out there.\n\n67\n00:03:22.820 --> 00:03:25.520\nBut it also means you get total control.\n\n68\n00:03:25.520 --> 00:03:29.730\nYou can choose exactly what you want,\nso you get a lot of power, but\n\n69\n00:03:29.730 --> 00:03:30.840\na lot of room for error.\n\n70\n00:03:30.840 --> 00:03:33.500\n>> Right, so here on this setting,\nI went ahead and\n\n71\n00:03:33.500 --> 00:03:37.020\njust put a mark here in the enable IPsec,\nI'm gonna click save.\n\n72\n00:03:37.020 --> 00:03:41.120\nNow that doesn't really do\nmuch besides turn on IPsec.\n\n73\n00:03:41.120 --> 00:03:42.710\nAnd you'll notice a little\nbit of difference up\n\n74\n00:03:42.710 --> 00:03:43.740\nhere in the upper right-hand corner.\n\n75\n00:03:43.740 --> 00:03:47.280\nAnd you'll see right now that the IPsec\nservice is stopped, and that's fine.\n\n76\n00:03:47.280 --> 00:03:49.850\nI just pretty much told it\nthat I'm about to enable it.\n\n77\n00:03:49.850 --> 00:03:53.620\nAnd now I need to go ahead and\ncreate that first connection.\n\n78\n00:03:53.620 --> 00:03:56.850\nSo what we're seeing right here is just\nkind of a heading for what we're going to\n\n79\n00:03:56.850 --> 00:04:02.280\ntake a look at as being that First tunnel\nlayer, is what we're gonna create here.\n\n80\n00:04:02.280 --> 00:04:05.410\nSo I'm gonna click on this plus sign and\nadd phase one.\n\n81\n00:04:05.410 --> 00:04:08.530\nThat's what they call that initial\nconnection between those machines,\n\n82\n00:04:08.530 --> 00:04:10.230\nit's going to be called phase one.\n\n83\n00:04:10.230 --> 00:04:11.610\nSo we're gonna establish IPsec.\n\n84\n00:04:11.610 --> 00:04:14.190\nWe need to establish an encrypted\nconnection from well\n\n85\n00:04:14.190 --> 00:04:15.470\none side to the other.\n\n86\n00:04:15.470 --> 00:04:18.530\nAnd this is where we are going\nto begin to do this.\n\n87\n00:04:18.530 --> 00:04:22.140\nAnd when we take a look at all of the\ndifferent pieces here, we do need to be\n\n88\n00:04:22.140 --> 00:04:25.220\ncareful as we come down through here\nbecause remember that these have to match.\n\n89\n00:04:25.220 --> 00:04:28.690\nWe of course have the option\nto disable this if we need to.\n\n90\n00:04:28.690 --> 00:04:32.120\nAgain, for testing at some point\nin time if you need to, or\n\n91\n00:04:32.120 --> 00:04:34.790\nif you don't need that tunnel any longer\nbut you don't want to tear it down just in\n\n92\n00:04:34.790 --> 00:04:37.470\ncase you need it a little bit later,\nit gives you that option.\n\n93\n00:04:37.470 --> 00:04:38.910\nNow, the first one here, Don,\n\n94\n00:04:38.910 --> 00:04:42.640\nis really the one that I might get\nconfused on if I hadn't done this before.\n\n95\n00:04:42.640 --> 00:04:45.030\nThere's a Version 1 and a Version 2.\n\n96\n00:04:45.030 --> 00:04:48.140\nI know that right now people just\nkind of default to Version 2.\n\n97\n00:04:48.140 --> 00:04:50.100\nI think it's just because\nthe number's bigger.\n\n98\n00:04:50.100 --> 00:04:51.975\nIs there a reason to choose number 1?\n\n99\n00:04:51.975 --> 00:04:55.970\n>> Yeah, there are some firewalls out\nthere that only support Version 1.\n\n100\n00:04:55.970 --> 00:04:58.010\nYou might have an older ASA for example.\n\n101\n00:04:58.010 --> 00:05:04.610\nCISCO ASAs, I think it was 8.4 is where\nthey introduced the Ike version 2.\n\n102\n00:05:04.610 --> 00:05:07.970\nSo if you have 8.3 and earlier,\nyou might only have IKE version 1, and so\n\n103\n00:05:07.970 --> 00:05:09.200\nyou'll need to choose that.\n\n104\n00:05:09.200 --> 00:05:10.960\nNewer ones give you a little\nmore flexibility, and\n\n105\n00:05:10.960 --> 00:05:12.000\nthey give you a little more power,\n\n106\n00:05:12.000 --> 00:05:14.010\nlike newer encryption\nalgorithms you can select from.\n\n107\n00:05:14.010 --> 00:05:17.036\nSo if you can do IKE version 2,\nyou should.\n\n108\n00:05:17.036 --> 00:05:18.310\nIKE version 1 is not bad, though,\n\n109\n00:05:18.310 --> 00:05:22.810\nthere's still plenty of secure protocols\nbut it really comes down to compatibility.\n\n110\n00:05:22.810 --> 00:05:26.710\nIf you're using IPsec, you're probably\nnot connecting pfSense to pfSense.\n\n111\n00:05:26.710 --> 00:05:29.130\nYou're probably connecting\npfSense to another vendor.\n\n112\n00:05:29.130 --> 00:05:32.960\nSo you've just gotta pick the strongest\none that both of them support.\n\n113\n00:05:34.400 --> 00:05:36.800\n>> So, right now,\nI'm just gonna go ahead and\n\n114\n00:05:36.800 --> 00:05:40.930\npick, let's just pick version 2 right\nthere that way we'll have it set.\n\n115\n00:05:40.930 --> 00:05:43.890\nAnd then if you are also\ngoing to be supporting\n\n116\n00:05:43.890 --> 00:05:47.220\nIP version six notice you actually\nhave to choose one or the other.\n\n117\n00:05:47.220 --> 00:05:50.840\nSo this doesn't allow you to do what we\nsaw on combinations a little bit earlier,\n\n118\n00:05:50.840 --> 00:05:54.160\nwhere we saw some of the firewall rules\nthat would actually do IP version 4 and\n\n119\n00:05:54.160 --> 00:05:55.490\nIP version 6.\n\n120\n00:05:55.490 --> 00:05:59.370\nYou're either going to set up a tunnel for\nversion 4 or version 6.\n\n121\n00:05:59.370 --> 00:06:03.770\nSince we're actually doing IP version 4\nright now, we're going to select that one.\n\n122\n00:06:03.770 --> 00:06:08.030\nAnd then the interface is, of course,\nthe connection that we have,\n\n123\n00:06:08.030 --> 00:06:09.923\nin other words our face.\n\n124\n00:06:09.923 --> 00:06:13.100\nThat's where this tunnel is\ngoing to be connected from.\n\n125\n00:06:13.100 --> 00:06:15.740\nSo I'm just setting it up for\nthe outside interface.\n\n126\n00:06:15.740 --> 00:06:18.690\nAnd now, here's the first\npiece of real knowledge and\n\n127\n00:06:18.690 --> 00:06:22.050\ninformation that I need to know if\nI'm gonna set this up correctly.\n\n128\n00:06:22.050 --> 00:06:25.310\nAnd I can't tell you how many times\nI've actually just kind of thought,\n\n129\n00:06:25.310 --> 00:06:27.850\nI'll remember that, and\ngotten it off by one number.\n\n130\n00:06:27.850 --> 00:06:31.060\nSo if you do know it,\nI always recommend that you write it down,\n\n131\n00:06:31.060 --> 00:06:34.380\nmake sure you know what you are connecting\nto, that way you can verify it.\n\n132\n00:06:34.380 --> 00:06:37.500\nIf not, you can make a connection\nsomewhere, but it's never gonna\n\n133\n00:06:37.500 --> 00:06:41.110\nask you to connect because you're not\nhitting the right remote gateway here.\n\n134\n00:06:41.110 --> 00:06:44.564\nSo, this can be 209.251.\n\n135\n00:06:44.564 --> 00:06:49.340\nMy typing may actually actually be\nanother ability for me to do this, and\n\n136\n00:06:49.340 --> 00:06:54.920\nthis is gonna be 186 which is going to be\nthe site, the public IP interface there.\n\n137\n00:06:56.820 --> 00:06:59.030\n>> And one thing you'll notice\nas Ronnie's filling this out,\n\n138\n00:06:59.030 --> 00:07:03.520\nwhen we did the open VPN shows we had the\noption to use a host name instead of IP's,\n\n139\n00:07:03.520 --> 00:07:05.290\nIPsec really does not like that.\n\n140\n00:07:05.290 --> 00:07:10.700\nWith IPsec, we fully expect to have\nstatic IP's on both sides of this tunnel.\n\n141\n00:07:10.700 --> 00:07:13.440\nNow, you can actually get away with\nhaving dynamic on one end, but\n\n142\n00:07:13.440 --> 00:07:15.660\nat least one end's gotta have a static IP.\n\n143\n00:07:15.660 --> 00:07:18.670\nBut really, the way it's designed\nis that static IPs on both ends.\n\n144\n00:07:20.220 --> 00:07:24.730\n>> So, this is where we begin to\nactually take a look at the proposal.\n\n145\n00:07:24.730 --> 00:07:26.310\nAnd notice they actually\nhave it nice here,\n\n146\n00:07:26.310 --> 00:07:29.410\nwhere they say, we'll you're gonna\nauthenticate to the other side.\n\n147\n00:07:29.410 --> 00:07:32.550\nSo they're asking what method\nof authentication we're going to\n\n148\n00:07:32.550 --> 00:07:33.710\nend up using.\n\n149\n00:07:33.710 --> 00:07:35.930\nSo, on my side,\nhow am I going authenticate?\n\n150\n00:07:35.930 --> 00:07:38.140\nOr, how I'm gonna want them\nto authenticate to me.\n\n151\n00:07:39.260 --> 00:07:41.410\nNotice I have two different options here.\n\n152\n00:07:41.410 --> 00:07:45.680\nI can do the RSA, I can do the PSK,\nwhich is the pre-shared key.\n\n153\n00:07:45.680 --> 00:07:47.590\nSince I don't have anything\nfrom the RSA right now,\n\n154\n00:07:47.590 --> 00:07:49.570\nI'm gonna select that pre-shared key.\n\n155\n00:07:49.570 --> 00:07:51.010\nDon, why would I choose the other one?\n\n156\n00:07:51.010 --> 00:07:52.580\n>> The RSA side, that's a certificate.\n\n157\n00:07:52.580 --> 00:07:54.813\nSo if you wanna do\na certificate-based authentication,\n\n158\n00:07:54.813 --> 00:07:57.784\nif you have a certification authority,\nand you've issued a cert out to use.\n\n159\n00:07:57.784 --> 00:08:01.384\nYou can do that and it's much harder for\nsomebody to figure out somebody's\n\n160\n00:08:01.384 --> 00:08:05.760\ncertificate, right, to get their private\nkey than it is to figure out a password.\n\n161\n00:08:05.760 --> 00:08:09.000\nIf we type in a PSK, like Ronnie's about\nto do, well, I'll see him type it.\n\n162\n00:08:09.000 --> 00:08:10.350\nI might know what it is, right.\n\n163\n00:08:10.350 --> 00:08:11.590\nIt becomes very obvious.\n\n164\n00:08:11.590 --> 00:08:14.930\nIf it's a certificate, it's a private\nkey that I actually have to obtain, and\n\n165\n00:08:14.930 --> 00:08:16.150\nthat's a lot more challenging.\n\n166\n00:08:16.150 --> 00:08:18.130\nSo you have a bit better security.\n\n167\n00:08:18.130 --> 00:08:21.910\nBut if you don't have a certificate\nauthority, PSKs are a lot faster.\n\n168\n00:08:21.910 --> 00:08:24.000\nSo if you want to just get\nthat implemented quickly and\n\n169\n00:08:24.000 --> 00:08:26.940\nnot deal with a bunch of infrastructure,\nyou can do PSKs.\n\n170\n00:08:26.940 --> 00:08:30.390\n>> Now Don, we've talked about\nthis before just together.\n\n171\n00:08:30.390 --> 00:08:33.880\nAnd when we talked about creating\na pre-shared key like this,\n\n172\n00:08:33.880 --> 00:08:36.090\nyou probably wouldn't recommend\nanything like what I'm typing here,\n\n173\n00:08:36.090 --> 00:08:38.010\nwhich is just, this is my secret key.\n\n174\n00:08:38.010 --> 00:08:41.800\nYou normally recommend that we actually\ncreate maybe a randomized password,\n\n175\n00:08:41.800 --> 00:08:43.160\nabout 20 characters or longer?\n\n176\n00:08:43.160 --> 00:08:46.060\n>> Yeah, I usually go to this website\nsecure password generator and\n\n177\n00:08:46.060 --> 00:08:46.920\nlet them generate it, or\n\n178\n00:08:46.920 --> 00:08:50.640\nyou can use other software, but\nyou want to have a nice random string.\n\n179\n00:08:50.640 --> 00:08:52.900\nKnow that you're only gonna\nhave to enter this in once.\n\n180\n00:08:52.900 --> 00:08:54.830\nYou copy this value here and\nyou paste it on the other side, and\n\n181\n00:08:54.830 --> 00:08:56.380\nyou'll never use it again, right?\n\n182\n00:08:56.380 --> 00:09:00.780\nSo pick something nice, strong,\na good long key is nice.\n\n183\n00:09:00.780 --> 00:09:04.810\n>> We're just gonna use my\nsuper secret key here instead.\n\n184\n00:09:04.810 --> 00:09:09.420\nAnd then we are now going to say, hey, how\nis this connection going to be encrypted?\n\n185\n00:09:09.420 --> 00:09:12.950\nNotice, we have our encryption algorithm,\nwe have the hashing algorithm, and\n\n186\n00:09:12.950 --> 00:09:14.620\nalso the Diffie-Hellman key groups.\n\n187\n00:09:14.620 --> 00:09:18.830\nSo these were some of\nthe elements of the IPsec that\n\n188\n00:09:18.830 --> 00:09:20.510\nDon was talking about in the framework.\n\n189\n00:09:20.510 --> 00:09:21.650\nSome of the elements that we have\n\n190\n00:09:21.650 --> 00:09:24.620\nto choose here to make sure that\neverything is connected here.\n\n191\n00:09:24.620 --> 00:09:26.450\nSo we choose our proper\nencryption algorithm.\n\n192\n00:09:26.450 --> 00:09:28.520\nI'm gonna leave at the default for\nright now.\n\n193\n00:09:28.520 --> 00:09:30.940\nI notice something,\nat least right now that if I don't,\n\n194\n00:09:30.940 --> 00:09:34.150\nI'm gonna change something and I'm not\ngoing to remember on the other side, but\n\n195\n00:09:34.150 --> 00:09:37.410\nif you're doing this for a company, Don,\nthis is where it's important that they\n\n196\n00:09:37.410 --> 00:09:39.800\nfollow whatever the security policy is,\nright?\n\n197\n00:09:39.800 --> 00:09:42.640\n>> Yeah, and often times it's a matter\nof picking the strongest one that both\n\n198\n00:09:42.640 --> 00:09:43.500\nsides support.\n\n199\n00:09:43.500 --> 00:09:45.870\nNow remember that on pfSense,\nall this encryption and\n\n200\n00:09:45.870 --> 00:09:50.210\ndecryption is happening in your general\npurpose CPU, and so the stronger\n\n201\n00:09:50.210 --> 00:09:53.280\nthe encryption algorithm you pick,\nthe more work you're placing on that CPU.\n\n202\n00:09:53.280 --> 00:09:56.160\nSo this will affect the amount\nof throughput that you get.\n\n203\n00:09:56.160 --> 00:09:59.180\nIf you're just dealing with basic traffic\nand it's no big deal, you might choose\n\n204\n00:09:59.180 --> 00:10:03.440\na weaker algorithm because of that,\nAES-256, that's pretty strong these days,\n\n205\n00:10:03.440 --> 00:10:06.310\nthat's one that I'd feel fine\nwith using in production.\n\n206\n00:10:06.310 --> 00:10:09.210\nYou could drop down to triple DES,\nwhich I wouldn't feel fine using in\n\n207\n00:10:09.210 --> 00:10:11.620\nproduction anymore,\nbecause it is one of the weaker ones.\n\n208\n00:10:11.620 --> 00:10:14.980\nSo find something that works out best for\nthe hardware that you have.\n\n209\n00:10:14.980 --> 00:10:17.980\nWe actually learned in another one of our\nsegments that a lot of Intel CPUs these\n\n210\n00:10:17.980 --> 00:10:22.360\ndays have AES accelerators built in to\nthem, so it's a great protocol to use.\n\n211\n00:10:22.360 --> 00:10:26.110\nOn the hashing algorithm SHA-1 is the\ndefault, that's considered weak today, but\n\n212\n00:10:26.110 --> 00:10:29.170\nyou can pick SHA-256,\nwhich is considered strong.\n\n213\n00:10:29.170 --> 00:10:32.150\nSo you can use that one, or\nyou can pick and choose.\n\n214\n00:10:32.150 --> 00:10:34.310\nThe trick here is to make sure\nit's identical on both sides.\n\n215\n00:10:35.940 --> 00:10:38.350\n>> What about this\nDiffie-Hellman key exchange?\n\n216\n00:10:38.350 --> 00:10:41.190\nNotice that we actually do have\nthe different links of the bits that\n\n217\n00:10:41.190 --> 00:10:44.800\nwe can use, and then there's even\nsome other fancy numbers up here.\n\n218\n00:10:44.800 --> 00:10:46.950\nAnd, I've never really\neven gone into these, Don.\n\n219\n00:10:46.950 --> 00:10:48.928\n>> Yeah.\nWhen you build up one of these sessions,\n\n220\n00:10:48.928 --> 00:10:51.230\nRonnie put in a pre-shared key, right.\n\n221\n00:10:51.230 --> 00:10:53.870\nThat key is only used right\nat the very beginning.\n\n222\n00:10:53.870 --> 00:10:57.760\nAnd as the two systems start to connect,\nthey generate a new key to use for\n\n223\n00:10:57.760 --> 00:10:58.840\nthat session.\n\n224\n00:10:58.840 --> 00:11:01.530\nSo, every session,\ntechnically has a different key.\n\n225\n00:11:01.530 --> 00:11:03.710\nAnd that key rotates out over time.\n\n226\n00:11:03.710 --> 00:11:07.150\nAnd the key that gets generated,\nis a symmetric key.\n\n227\n00:11:07.150 --> 00:11:08.840\nThe key is the same on both ends.\n\n228\n00:11:08.840 --> 00:11:11.320\nIt needs to be securely\nhanded off to the other side.\n\n229\n00:11:11.320 --> 00:11:15.620\nTo do that, Diffie-Hellman is a algorithm\nand handshake methodology for\n\n230\n00:11:15.620 --> 00:11:18.750\ndoing that, for securely sending\nthat key to the other side.\n\n231\n00:11:18.750 --> 00:11:22.780\nThe weaker the Diffie-Hellman group,\nthe more possible it is for\n\n232\n00:11:22.780 --> 00:11:27.410\nan attacker to guess what that next\niteration of that key is gonna be.\n\n233\n00:11:27.410 --> 00:11:30.460\nThe stronger the Diffie-Hellman\ngroup the less likely it's gonna be\n\n234\n00:11:30.460 --> 00:11:31.460\nan attacker can guess it.\n\n235\n00:11:31.460 --> 00:11:35.870\nNow even on the weakest setting it's still\nreally, really, really difficult for\n\n236\n00:11:35.870 --> 00:11:37.310\nsomebody to anticipate this so\n\n237\n00:11:37.310 --> 00:11:40.650\neven Diffie-Hellman group one\nis still considered secure.\n\n238\n00:11:40.650 --> 00:11:43.090\nBut two or higher is kind of preferred.\n\n239\n00:11:43.090 --> 00:11:44.230\nTwo is the default.\n\n240\n00:11:44.230 --> 00:11:46.770\nYou know,\nI've seen systems do five and seven.\n\n241\n00:11:46.770 --> 00:11:47.810\nThis one goes all the way.\n\n242\n00:11:47.810 --> 00:11:48.382\nWhat was the highest one there, Ronnie?\n\n243\n00:11:48.382 --> 00:11:50.062\nIt was like 24 or something?\n\n244\n00:11:50.062 --> 00:11:54.475\n>> 24, with 2,048 bit and subbed 256.\n\n245\n00:11:54.475 --> 00:11:55.035\n>> Yeah.\n\n246\n00:11:55.035 --> 00:11:56.745\nSo it gets pretty strong.\n\n247\n00:11:56.745 --> 00:11:58.685\nYou just have to make sure\nboth sides support it.\n\n248\n00:11:58.685 --> 00:12:00.005\nI would just stick with DH2 on this one.\n\n249\n00:12:01.195 --> 00:12:05.785\n>> And then the lifetime is telling us how\nlong that this algorithm is going to be\n\n250\n00:12:05.785 --> 00:12:06.960\nin use here.\n\n251\n00:12:06.960 --> 00:12:08.415\nI think this is a day.\n\n252\n00:12:08.415 --> 00:12:11.740\n28,800 seconds, I think,\nis a 24 hour day for\n\n253\n00:12:11.740 --> 00:12:15.570\nthat initial proposal to be given here.\n\n254\n00:12:15.570 --> 00:12:18.495\n>> So if an attacker tries to break in and\nget our key,\n\n255\n00:12:18.495 --> 00:12:21.040\nthey've really got 24 hours to figure\nthat key out before the key changes.\n\n256\n00:12:21.040 --> 00:12:25.290\n>> And then there are some\nother advanced options down\n\n257\n00:12:25.290 --> 00:12:30.670\nhere about disable re-keying or\neven re-authentication, if we need to.\n\n258\n00:12:30.670 --> 00:12:33.620\nMost of these options are ones that we're\njust going to use the default, right?\n\n259\n00:12:33.620 --> 00:12:36.530\nYou can change the behavior of the tunnel.\n\n260\n00:12:36.530 --> 00:12:38.420\nMost of these result in\nweakening the tunnel.\n\n261\n00:12:38.420 --> 00:12:41.500\nIf you look at some of these\noptions here like, respond or only.\n\n262\n00:12:41.500 --> 00:12:43.950\nThat means somebody would have\nto build a connection to me,\n\n263\n00:12:43.950 --> 00:12:46.070\nI would never build a connection to them.\n\n264\n00:12:46.070 --> 00:12:48.110\nOr disable, reauthor, rekey.\n\n265\n00:12:48.110 --> 00:12:51.650\nThat means we're gonna use the same\nkey over the lifetime of that session,\n\n266\n00:12:51.650 --> 00:12:53.140\nwhich might be very very long.\n\n267\n00:12:53.140 --> 00:12:54.970\nThese are things that weaken security.\n\n268\n00:12:54.970 --> 00:12:57.600\nThey usually lead to things like\nimproved performance, though, so\n\n269\n00:12:57.600 --> 00:12:59.020\nthat's why you might choose them.\n\n270\n00:12:59.020 --> 00:13:02.660\nBut in today's hardware,\nwe're not normally gonna mess with that.\n\n271\n00:13:02.660 --> 00:13:04.060\nDead peer detection.\n\n272\n00:13:04.060 --> 00:13:05.790\nHow do we know if\nthe other tunnel is down?\n\n273\n00:13:05.790 --> 00:13:08.630\nAnd the default is, it's sending out\na little message every ten seconds, and\n\n274\n00:13:08.630 --> 00:13:11.720\nif five of them fail,\nthen we know the tunnel is down.\n\n275\n00:13:11.720 --> 00:13:14.150\nI don't normally worry about these too\nmuch, because if the tunnel is down,\n\n276\n00:13:14.150 --> 00:13:15.200\nguess what happens.\n\n277\n00:13:15.200 --> 00:13:16.410\nTraffic doesn't go over it.\n\n278\n00:13:16.410 --> 00:13:18.920\nSo, I don't care if I know about that or\nnot.\n\n279\n00:13:18.920 --> 00:13:22.310\nIt doesn't matter to me when that\nterminates cuz traffic is not flowing.\n\n280\n00:13:22.310 --> 00:13:25.930\nSo it's not like there's some magic it\ncan do once it detects the peer is dead.\n\n281\n00:13:25.930 --> 00:13:28.630\nIt just takes it down and\ntries to rebuild the tunnel.\n\n282\n00:13:28.630 --> 00:13:32.320\nThere is one scenario where one side\nmight think the tunnel is down and\n\n283\n00:13:32.320 --> 00:13:33.920\nthe other thinks its up.\n\n284\n00:13:33.920 --> 00:13:36.630\nAnd that starts to cause problems\nwith dead peer detection,\n\n285\n00:13:36.630 --> 00:13:38.130\nit'll figure that out.\n\n286\n00:13:38.130 --> 00:13:40.690\nSo that's kind of how that works out.\n\n287\n00:13:40.690 --> 00:13:43.030\nBut once that's in place, we just save it.\n\n288\n00:13:43.030 --> 00:13:45.770\nAnd our phase one is done.\n\n289\n00:13:45.770 --> 00:13:48.810\n>> And just when you go, all right,\nthat sounds good, we are ready to go,\n\n290\n00:13:48.810 --> 00:13:52.320\nI go ahead and click save,\nand apply the settings, and\n\n291\n00:13:52.320 --> 00:13:56.450\nnow you think you're ready to go, but\nthe problem is now we've got this tunnel.\n\n292\n00:13:56.450 --> 00:14:00.940\nNotice that there says\na Show 0 Phase 2 entry.\n\n293\n00:14:00.940 --> 00:14:03.650\nAnd when you click on that plus sign,\nthere's nothing here.\n\n294\n00:14:03.650 --> 00:14:06.010\nIn IPsec,\nthere's two parts to this, right?\n\n295\n00:14:06.010 --> 00:14:09.830\nWe need to get that encrypted tunnel up,\nand now what we're doing is we're now\n\n296\n00:14:09.830 --> 00:14:13.150\nsetting it up for the data or\nthe traffic to flow through it, too,\n\n297\n00:14:13.150 --> 00:14:16.770\nand so we also need to set this side up,\nas well.\n\n298\n00:14:16.770 --> 00:14:19.802\nSo I'm going to click on that plus sign,\nwhich expanded this out, and\n\n299\n00:14:19.802 --> 00:14:23.900\nthen click on the other plus sign here,\nand now we actually have a whole new set\n\n300\n00:14:23.900 --> 00:14:27.570\nof entries that we need to pay attention\nto as we continue to move forward.\n\n301\n00:14:27.570 --> 00:14:30.430\nAnd there's a lot of different\nentries in here as well.\n\n302\n00:14:30.430 --> 00:14:33.260\nSo now that we've got that up,\nwe now actually start taking a look.\n\n303\n00:14:33.260 --> 00:14:35.900\nAgain, we can just disable\nthis one if we need to.\n\n304\n00:14:35.900 --> 00:14:38.720\nAnd then we continue to move\nthrough some of the options.\n\n305\n00:14:38.720 --> 00:14:42.730\nThis is now going to say, encrypting\nthe traffic from the local subnet.\n\n306\n00:14:42.730 --> 00:14:44.520\nWhere do I want it to go?\n\n307\n00:14:44.520 --> 00:14:51.180\nAnd it is here that I'm gonna type\nin the remote side network address.\n\n308\n00:14:51.180 --> 00:14:53.390\nWhich is gonna be for the other end.\n\n309\n00:14:53.390 --> 00:14:57.670\nSo I know that that's the traffic that\nI want to actually go into that tunnel.\n\n310\n00:14:57.670 --> 00:15:02.230\nAnd then we begin with\nthe Phase 2 proposal,\n\n311\n00:15:02.230 --> 00:15:06.140\nwhich you actually see is now the SA or\nthat security association, and\n\n312\n00:15:06.140 --> 00:15:08.710\nthe key exchange, and there's a lot\nof different options here, Don.\n\n313\n00:15:08.710 --> 00:15:12.400\n>> Yeah, and you might actually go like,\nwhy am I having to do this a second time?\n\n314\n00:15:12.400 --> 00:15:15.870\nWell, Phase 1, that's the firewalls\ntalking to each other,\n\n315\n00:15:15.870 --> 00:15:17.880\ndoing their initial key exchanges.\n\n316\n00:15:17.880 --> 00:15:18.740\nNow phase two.\n\n317\n00:15:18.740 --> 00:15:21.020\nThis is how we're actually\nhandling our client data.\n\n318\n00:15:21.020 --> 00:15:23.670\nOur payload is being\ncarried across that line.\n\n319\n00:15:23.670 --> 00:15:26.960\nAnd we can pick the same\nexact options as we did for\n\n320\n00:15:26.960 --> 00:15:31.870\nphase one, or we can pick stronger or\nweaker options depending on our need.\n\n321\n00:15:31.870 --> 00:15:36.740\nIn fact, if we're comfortable with our\nphase one settings, then on phase two,\n\n322\n00:15:36.740 --> 00:15:39.970\nwe might choose things,\nlike not even doing encryption.\n\n323\n00:15:39.970 --> 00:15:42.550\nAnd just doing digital\nsigning of our pay load.\n\n324\n00:15:42.550 --> 00:15:45.040\nSo, like that drop down box it says ESP,\nright?\n\n325\n00:15:45.040 --> 00:15:47.010\nWe're going to encapsulated\nsecurity payload.\n\n326\n00:15:47.010 --> 00:15:49.591\nWe're going to encrypt our data,\nbut you can choose to do\n\n327\n00:15:49.591 --> 00:15:52.534\nWhich is Authentication Header,\nwe're just gonna digitally sign.\n\n328\n00:15:52.534 --> 00:15:54.322\nSo we'll know if somebody tampers with it,\nbut\n\n329\n00:15:54.322 --> 00:15:56.795\nwe're not gonna hide the data from\nthe people that are out there.\n\n330\n00:15:56.795 --> 00:16:00.340\nPeople could actually get in there and\nread our data as a transistor network.\n\n331\n00:16:00.340 --> 00:16:02.570\nYou would do that for\nperformance reasons, right?\n\n332\n00:16:02.570 --> 00:16:04.340\nBut normally we want full ESP.\n\n333\n00:16:04.340 --> 00:16:05.700\nThat's what we'll choose.\n\n334\n00:16:05.700 --> 00:16:07.850\nAnd you can go through and pick each one.\n\n335\n00:16:07.850 --> 00:16:10.470\nNow phase two is a lot\ndifferent than phase one.\n\n336\n00:16:10.470 --> 00:16:14.760\nOn phase one, we picked hard set\nprotocols, but in phase two.\n\n337\n00:16:14.760 --> 00:16:16.630\nSee how Ronny can pick\nmore than one protocol?\n\n338\n00:16:16.630 --> 00:16:18.530\nSee how he can check off more than one?\n\n339\n00:16:18.530 --> 00:16:20.800\nWith phase two,\nthe two systems will negotiate,\n\n340\n00:16:20.800 --> 00:16:24.890\nand they'll pick the strongest one\nout of a list of supported protocols.\n\n341\n00:16:24.890 --> 00:16:27.280\nSo in this scenario we\nmight have more than one.\n\n342\n00:16:27.280 --> 00:16:31.080\nSo you'll highlight everything that's\nthe minimum strength that you'll allow,\n\n343\n00:16:31.080 --> 00:16:33.080\nup and above right.\n\n344\n00:16:33.080 --> 00:16:37.730\nSo I might now want triple das or das but\nI might want everything that's stronger.\n\n345\n00:16:37.730 --> 00:16:39.990\nAnd so you go through and\ncheck those and it'll negotiate it.\n\n346\n00:16:39.990 --> 00:16:42.740\nNow, that being said, I never do that.\n\n347\n00:16:42.740 --> 00:16:46.400\nI always pick the one standard I want\nbecause I always want to know what's being\n\n348\n00:16:46.400 --> 00:16:47.400\nused on my network.\n\n349\n00:16:47.400 --> 00:16:49.190\nSo I pick it, and I say you know what?\n\n350\n00:16:49.190 --> 00:16:52.890\nI'm only gonna support AES-256,\nand so we go in and hard set that.\n\n351\n00:16:52.890 --> 00:16:56.090\nIf you do AES It's auto, well,\nwho knows what the other side will pick.\n\n352\n00:16:56.090 --> 00:16:58.960\nIt could be any number of things,\nso I wanna force that.\n\n353\n00:16:58.960 --> 00:17:00.430\nIt's up to you how you\nwanna implement that.\n\n354\n00:17:01.730 --> 00:17:03.490\n>> And\nthen we also have the hash algorithm, and\n\n355\n00:17:03.490 --> 00:17:07.200\nif I remember correctly, I left it at\ndefault so I wouldn't forget that.\n\n356\n00:17:07.200 --> 00:17:09.370\nAnd this is where we get to\nanother option here which is\n\n357\n00:17:10.750 --> 00:17:13.780\nthe PFS key group which stands for\nPerfect Forward Secrecy.\n\n358\n00:17:13.780 --> 00:17:15.730\n>> That's right, Perfect Forward Secrecy.\n\n359\n00:17:15.730 --> 00:17:17.080\nWhen we get to phase two.\n\n360\n00:17:17.080 --> 00:17:20.220\nPhase one is asymmetric authentication.\n\n361\n00:17:20.220 --> 00:17:23.460\nWe have public keys and private keys that\nare going into that authentication, and\n\n362\n00:17:23.460 --> 00:17:25.430\nonly the public keys\nare crossing the networks.\n\n363\n00:17:25.430 --> 00:17:30.710\nIt's pretty safe, but in phase two, well,\nthat's when we switch to a symmetric key.\n\n364\n00:17:30.710 --> 00:17:33.680\nWe have one key that encrypts and\ndecrypts data.\n\n365\n00:17:33.680 --> 00:17:35.090\nAnd it does that for speed.\n\n366\n00:17:35.090 --> 00:17:38.770\nThat means that symmetric key has to\ncross the network and that means.\n\n367\n00:17:38.770 --> 00:17:40.950\nAn attacker could potentially\nget ahold of that key.\n\n368\n00:17:40.950 --> 00:17:43.500\nThey'd have to break through\na lot of other stuff first but\n\n369\n00:17:43.500 --> 00:17:44.980\nthey could potentially get to that.\n\n370\n00:17:44.980 --> 00:17:49.700\nSo perfect forward secrecy adds an extra\nlevel of a Diffie-Hellman exchange\n\n371\n00:17:49.700 --> 00:17:53.640\nto make sure that that key is secured\nwhen it transits across that tunnel.\n\n372\n00:17:53.640 --> 00:17:57.230\nThe tunnel's already encrypted, but\nwe're gonna encrypt it a second time.\n\n373\n00:17:57.230 --> 00:17:59.580\nA lot of people look at PFS\nas wasted effort, right?\n\n374\n00:17:59.580 --> 00:18:02.090\nYou already encrypted once,\nwhy encrypt the second time?\n\n375\n00:18:02.090 --> 00:18:04.970\nBut if you're being forced\nto use a weaker protocol,\n\n376\n00:18:04.970 --> 00:18:07.740\nyou can stack PFS on top of it\nin order to help improve that.\n\n377\n00:18:07.740 --> 00:18:09.350\nThat's what Ronnie's picking right there,\n\n378\n00:18:09.350 --> 00:18:12.530\nis if we're going to do PFS,\nwhat level of key group do we use?\n\n379\n00:18:12.530 --> 00:18:15.650\nWhat strength of key do we want\nto use to help secure that?\n\n380\n00:18:15.650 --> 00:18:17.940\nAnd you'll see you can go pretty strong,\nright?\n\n381\n00:18:17.940 --> 00:18:19.830\nBut for our example,\nwhy don't we just leave PSF off.\n\n382\n00:18:19.830 --> 00:18:22.640\nCuz it's one more thing that\ncan add to the complexity\n\n383\n00:18:22.640 --> 00:18:24.290\nin a virtual environment like this.\n\n384\n00:18:24.290 --> 00:18:26.770\nBut in production,\nit's a pretty good idea to use that.\n\n385\n00:18:26.770 --> 00:18:29.700\n>> Now, Don, it actually also has\nthis final option here which says,\n\n386\n00:18:29.700 --> 00:18:31.140\nautomatically ping the host.\n\n387\n00:18:31.140 --> 00:18:34.150\nAnd this is to just help\nkeep the connection up.\n\n388\n00:18:34.150 --> 00:18:37.420\n>> The tunnel by default,\nwill go down if it sits idle.\n\n389\n00:18:37.420 --> 00:18:39.580\nIf it's idle for long enough,\nthe tunnel will turn off.\n\n390\n00:18:39.580 --> 00:18:41.820\nAnd it does that for performance reasons.\n\n391\n00:18:41.820 --> 00:18:44.502\nIf you don't care about that lifetime.\n\n392\n00:18:44.502 --> 00:18:45.770\nIf you don't need that\ntunnel to always be up,\n\n393\n00:18:45.770 --> 00:18:47.440\nyou can leave this blank and that's fine.\n\n394\n00:18:47.440 --> 00:18:51.220\nBut if you want the tunnel to always\nbe up even if it's not being used,\n\n395\n00:18:51.220 --> 00:18:54.120\nyou can specify an IP\naddress on the remote side.\n\n396\n00:18:54.120 --> 00:18:57.950\nAnd this needs to be a protected IP,\nnot a public IP.\n\n397\n00:18:57.950 --> 00:19:00.940\nSo, you'd put in one of those internal\nIP addresses here to ping and\n\n398\n00:19:00.940 --> 00:19:02.590\nthat'll keep the tunnel alive.\n\n399\n00:19:02.590 --> 00:19:06.280\nIt literally is just a ping that runs and\noff it goes.\n\n400\n00:19:06.280 --> 00:19:09.030\nI don't normally do this cuz I\ndon't normally care if the tunnel.\n\n401\n00:19:09.030 --> 00:19:11.210\nI want the tunnel to be up when I need it.\n\n402\n00:19:11.210 --> 00:19:14.380\nAnd on a busy network it'll\npretty much always be up anyway.\n\n403\n00:19:14.380 --> 00:19:16.530\nBut if your network is going down and\n\n404\n00:19:16.530 --> 00:19:19.980\npeople are getting some sluggish\nconnections cuz the tunnel's building up,\n\n405\n00:19:19.980 --> 00:19:21.540\nyou'd put a private IP here and\nit would connect.\n\n406\n00:19:23.030 --> 00:19:25.260\n>> So we're just gonna leave that off and\nclick save.\n\n407\n00:19:25.260 --> 00:19:25.960\n>> Yup.\n\n408\n00:19:25.960 --> 00:19:27.630\n>> And then we'll apply those changes.\n\n409\n00:19:28.970 --> 00:19:32.770\nAnd so now we actually have at least\none side of this IPsec tunnel up.\n\n410\n00:19:32.770 --> 00:19:36.020\nWe just need to go and configure a few\nfirewall rules and net rules and\n\n411\n00:19:36.020 --> 00:19:39.270\nwe'll be ready to continue\non to the other side.\n\n412\n00:19:39.270 --> 00:19:44.540\nSo if I go up to firewall and then the\nrules we also have to be able to allow for\n\n413\n00:19:44.540 --> 00:19:49.110\na connection into the WAN interface\n\n414\n00:19:49.110 --> 00:19:53.580\non port 500 which supports that ICA camp I\nthink is what they traditionally call it.\n\n415\n00:19:53.580 --> 00:19:55.870\nThe tunnel connection\nactually has to happen.\n\n416\n00:19:55.870 --> 00:19:58.750\nSo, what we're actually saying is\nwe're allowing this to begin that\n\n417\n00:19:58.750 --> 00:19:59.880\nnegotiation process.\n\n418\n00:19:59.880 --> 00:20:01.680\nSo I'm going to go ahead and\nclick on that plus button.\n\n419\n00:20:03.480 --> 00:20:09.170\nThen from here it's going to be a pass on\nthe WAN interface which is what we want.\n\n420\n00:20:09.170 --> 00:20:14.160\nAnd on port 500 this is a UDP connection,\nif I remember correctly.\n\n421\n00:20:15.980 --> 00:20:20.090\nAnd I'm gonna allow that to\ngo to the WAN address here.\n\n422\n00:20:21.990 --> 00:20:27.710\nAnd so on the firewall,\nI'm going to also add in port 500.\n\n423\n00:20:27.710 --> 00:20:29.119\nHere, too.\n\n424\n00:20:31.301 --> 00:20:32.320\nAnd click Save.\n\n425\n00:20:34.900 --> 00:20:40.850\nSo that will allow the actual connection\nto begin the process there on the Ike.\n\n426\n00:20:40.850 --> 00:20:46.170\nSo now I've got the rule created for\nthe ISAKMP tunnel to come up.\n\n427\n00:20:46.170 --> 00:20:50.020\nI also wanna go ahead add in one for\nESP here too.\n\n428\n00:20:50.020 --> 00:20:54.300\nSo I'm just gonna clone this rule, and\n\n429\n00:20:54.300 --> 00:20:57.800\nthen what we're gonna do is\nchange the protocol here.\n\n430\n00:20:57.800 --> 00:21:01.780\nTo ESP to allow for\nthat connection to come through.\n\n431\n00:21:01.780 --> 00:21:05.710\nGonna see if I can scroll down.\n\n432\n00:21:06.970 --> 00:21:10.270\nMy track pad making it challenging it for\nme.\n\n433\n00:21:11.510 --> 00:21:14.870\nSo I want to make sure I have the WAN\naddress, and I'm going to click save here.\n\n434\n00:21:16.480 --> 00:21:17.702\nApply the changes.\n\n435\n00:21:17.702 --> 00:21:20.198\n>> Yeah and that's a different kind of\nrule than a lot of us are used to right.\n\n436\n00:21:20.198 --> 00:21:24.598\nBecause we're used to saying TCP\nthis port or UDP that port, but\n\n437\n00:21:24.598 --> 00:21:26.630\nthis is all encrypted.\n\n438\n00:21:26.630 --> 00:21:30.230\nSo we don't know if it's TCP traffic,\nUDP, we can't see inside of it.\n\n439\n00:21:30.230 --> 00:21:32.200\nAnd that's why we have to\npick the protocol suite, and\n\n440\n00:21:32.200 --> 00:21:33.210\nin this case that's ESP.\n\n441\n00:21:35.870 --> 00:21:39.320\nSo, let me close that, and\nonce we have that ready to go,\n\n442\n00:21:39.320 --> 00:21:41.540\nwe need to go into ip sec.\n\n443\n00:21:41.540 --> 00:21:44.880\nRight here, they went ahead\nan generated the two rules for\n\n444\n00:21:44.880 --> 00:21:48.060\nme, allowing the pings to come through and\nof course,\n\n445\n00:21:48.060 --> 00:21:51.840\nthe rest of the traffic to come through\nthat ip set tunnel that we need.\n\n446\n00:21:51.840 --> 00:21:53.810\nThe only other thing I need to do,\nI think,\n\n447\n00:21:53.810 --> 00:21:57.960\nis to verify that the NAT auto rules\nwere generated, and they normally are.\n\n448\n00:21:57.960 --> 00:22:00.360\nBut I always like to expand them\nout if I haven't done that before.\n\n449\n00:22:01.510 --> 00:22:07.170\nSelect outbound and you'll actually\nsee that they are created there,\n\n450\n00:22:07.170 --> 00:22:12.000\nbut every once in a while, I've had issues\nwhen it's not actually been expanded out.\n\n451\n00:22:12.000 --> 00:22:14.920\nSo, I can click save, and that just\ngives us the ability to edit them, but\n\n452\n00:22:14.920 --> 00:22:17.850\nI also can verify that\nthey have been created.\n\n453\n00:22:17.850 --> 00:22:19.110\nThat's really what I need to do.\n\n454\n00:22:21.270 --> 00:22:24.450\nSo, once that's connected, I just need\nto go over to the client side, or\n\n455\n00:22:24.450 --> 00:22:29.110\nto the other side, the other Site B, and\nestablish kinda the same connections here.\n\n456\n00:22:31.250 --> 00:22:32.480\n>> All right.\nSo what we're gonna do is,\n\n457\n00:22:32.480 --> 00:22:34.740\nwe don't wanna bore you to death\nas you configure the other side.\n\n458\n00:22:34.740 --> 00:22:36.490\nBut we're gonna take that second firewall.\n\n459\n00:22:36.490 --> 00:22:38.690\nWe're gonna throw that exact\nconfiguration in there.\n\n460\n00:22:38.690 --> 00:22:41.710\nThe only thing we change is the IP\nis going to point in the other\n\n461\n00:22:41.710 --> 00:22:42.860\ndirection, right?\n\n462\n00:22:42.860 --> 00:22:44.330\nAnd once that's in place,\n\n463\n00:22:44.330 --> 00:22:47.330\nwe should be able to bring\nthe tunnel up and we'll be healthy.\n\n464\n00:22:47.330 --> 00:22:50.210\nAll right, so through the magic\nof television we have instantly\n\n465\n00:22:50.210 --> 00:22:51.650\nconfigured our remote side.\n\n466\n00:22:51.650 --> 00:22:53.750\nSo Ronnie,\nwhy don't you show us where you're at?\n\n467\n00:22:53.750 --> 00:22:54.610\n>> Sure.\nI went ahead and\n\n468\n00:22:54.610 --> 00:22:58.520\nconfigured the other side pretty\nmuch identically in the IPsec,\n\n469\n00:22:58.520 --> 00:23:01.520\nso going up to VPN and IPsec.\n\n470\n00:23:01.520 --> 00:23:03.830\nExpanded out these options, filled in,\n\n471\n00:23:03.830 --> 00:23:07.620\nmade sure they were identical\nto the other side, just about.\n\n472\n00:23:07.620 --> 00:23:11.940\nThe only other configuration would, of\ncourse, be the different remote subnets.\n\n473\n00:23:11.940 --> 00:23:14.090\nChanged the firewall rules, and\n\n474\n00:23:14.090 --> 00:23:18.350\nadded in the rules that we needed to,\njust like we did on the other side.\n\n475\n00:23:18.350 --> 00:23:21.560\nSo there's those two rules\nthat we have available to us.\n\n476\n00:23:21.560 --> 00:23:25.640\nAnd then, of course, the IPsec tunnel and\nthe NAT rules are the same.\n\n477\n00:23:25.640 --> 00:23:28.070\nSo if everything is actually up and\nworking.\n\n478\n00:23:28.070 --> 00:23:31.960\nSo once that is done, I should be\nable to go to status and IPsec.\n\n479\n00:23:31.960 --> 00:23:36.180\nAnd even though it's showing disconnected\nright now, I can go ahead and\n\n480\n00:23:36.180 --> 00:23:38.310\nstart this service here.\n\n481\n00:23:38.310 --> 00:23:40.155\nSee if it actually does start.\n\n482\n00:23:40.155 --> 00:23:42.060\n[LAUGH]\n>> Moment of truth.\n\n483\n00:23:42.060 --> 00:23:43.130\n>> Moment of truth.\n\n484\n00:23:43.130 --> 00:23:45.920\nAnd seeing disconnected like that,\nthat's not anything to worry about.\n\n485\n00:23:45.920 --> 00:23:48.220\nThe tunnel stays down if\nthere's no interesting traffic.\n\n486\n00:23:48.220 --> 00:23:50.000\nTraffic to make that tunnel come up.\n\n487\n00:23:50.000 --> 00:23:53.190\nSo we have to generate some traffic,\nor do what Ronnie's doing.\n\n488\n00:23:53.190 --> 00:23:55.274\nYou can force the tunnel to come up.\n\n489\n00:23:55.274 --> 00:23:57.026\nAnd he's just thinking about it now,\n\n490\n00:23:57.026 --> 00:23:59.818\nI've seen this on mine with\nthe first time you configure it,\n\n491\n00:23:59.818 --> 00:24:03.300\nit doesn't necessarily come up and\nyou might have to restart the service.\n\n492\n00:24:03.300 --> 00:24:06.190\nSo I know, Ron, you hit the little Start\nbutton, but sometimes you have to hit\n\n493\n00:24:06.190 --> 00:24:09.650\nthe Restart button that's up there above,\nand it restarts it now.\n\n494\n00:24:09.650 --> 00:24:14.930\nIPsec is actually powered by a service\non pfSense, it's called Raccoon.\n\n495\n00:24:14.930 --> 00:24:17.600\nI know that doesn't\nsound like IPsec at all.\n\n496\n00:24:17.600 --> 00:24:20.960\nSo you might have to go and restart that\nRaccoon service before the tunnel actually\n\n497\n00:24:20.960 --> 00:24:23.000\ngets recognized and becomes healthy.\n\n498\n00:24:23.000 --> 00:24:26.435\nSo when we look at the list here though,\noh actually it's just showing straight up\n\n499\n00:24:26.435 --> 00:24:30.570\nIPsec, and it says it's running so\nlet's go check out that tunnel.\n\n500\n00:24:30.570 --> 00:24:32.430\nSee what magic has happened for us.\n\n501\n00:24:32.430 --> 00:24:35.030\n>> And it is still disconnected here.\n\n502\n00:24:35.030 --> 00:24:36.750\nLet's see if we can connect.\n\n503\n00:24:36.750 --> 00:24:38.670\n>> Oh now this could\nalso be another problem.\n\n504\n00:24:38.670 --> 00:24:41.640\nRemember IPsec is a two way agreement.\n\n505\n00:24:41.640 --> 00:24:46.600\nAnd so you can have a situation where\none side thinks the tunnel is down and\n\n506\n00:24:46.600 --> 00:24:48.630\nthe other side thinks the tunnel is up.\n\n507\n00:24:48.630 --> 00:24:52.200\nAnd what happens is the side that's\ndown tries to build a new connection.\n\n508\n00:24:52.200 --> 00:24:55.450\nAnd the other side says,\nwait a minute, this is already up.\n\n509\n00:24:55.450 --> 00:24:58.920\nYou must be an attacker trying to come\nin and create a second tunnel and\n\n510\n00:24:58.920 --> 00:25:00.080\nit blocks it.\n\n511\n00:25:00.080 --> 00:25:04.410\nAnd that happens, it really happens if\nyou change configurations on one side and\n\n512\n00:25:04.410 --> 00:25:06.250\nit can lead to this type of environment.\n\n513\n00:25:06.250 --> 00:25:08.200\nSo that may be what's happening here, too.\n\n514\n00:25:08.200 --> 00:25:09.680\nRonnie, you just restarted.\n\n515\n00:25:09.680 --> 00:25:10.370\n>> Oh, and it came up.\n\n516\n00:25:10.370 --> 00:25:11.800\n>> Apparently being patient\nsolved this problem.\n\n517\n00:25:11.800 --> 00:25:12.370\n>> Yes.\n\n518\n00:25:12.370 --> 00:25:14.920\n>> If that didn't solve the problem\nthough, the solution would really be to\n\n519\n00:25:14.920 --> 00:25:17.660\njump to the other side and\nrestart the tunnel there too.\n\n520\n00:25:17.660 --> 00:25:21.060\nThat makes sure they both know the tunnel\nis down, and they do their handshake and\n\n521\n00:25:21.060 --> 00:25:21.662\nthey come up.\n\n522\n00:25:21.662 --> 00:25:22.870\nYep, so Ronnie, he's up.\n\n523\n00:25:22.870 --> 00:25:25.650\nEstablished zero seconds ago, right?\n\n524\n00:25:25.650 --> 00:25:28.230\n>> And then you can also see if\neverything's actually working\n\n525\n00:25:28.230 --> 00:25:29.200\nright here at the SAD.\n\n526\n00:25:29.200 --> 00:25:30.950\nIt doesn't actually stand for\nsad, does it?\n\n527\n00:25:30.950 --> 00:25:32.210\n>> It's security associations.\n\n528\n00:25:32.210 --> 00:25:36.000\n>> Security associations, and once\nthose security associations are up and\n\n529\n00:25:36.000 --> 00:25:39.450\nrunning, we should be\nconnected on both sides now.\n\n530\n00:25:39.450 --> 00:25:40.580\n>> Yep, so now we're up.\n\n531\n00:25:40.580 --> 00:25:43.460\nAnother thing we can flow traffic and\nwe're using IPsec.\n\n532\n00:25:43.460 --> 00:25:48.110\nNow, if it were up to me, if I was going\nsite to site between pfSense boxes.\n\n533\n00:25:48.110 --> 00:25:49.320\nI'd use OpenVPN, right?\n\n534\n00:25:49.320 --> 00:25:50.780\nIt's a lot easier to deal with.\n\n535\n00:25:50.780 --> 00:25:52.810\nYou get it put in place and off you go.\n\n536\n00:25:52.810 --> 00:25:57.060\nBut if you need to go pfSense\nto a third party firewall like\n\n537\n00:25:57.060 --> 00:26:01.950\na Cisco ASA, Juniper SSG,\nsomething like that, WatchGuard.\n\n538\n00:26:01.950 --> 00:26:05.250\nThose guys all support IPsec and so\nwe can use IPsec to connect up to them.\n\n539\n00:26:05.250 --> 00:26:08.680\nThis is a great way to get\nmulti-vendor support on your firewall.\n\n540\n00:26:08.680 --> 00:26:12.050\nIPsec can be a little bit quirky, but\nboy does it give you a lot of power.\n\n541\n00:26:12.050 --> 00:26:15.170\nYou have a ton of control over\nwhat encryption you're using,\n\n542\n00:26:15.170 --> 00:26:16.870\nsignatures you're using and all that.\n\n543\n00:26:16.870 --> 00:26:20.250\nAnd that's attractive,\nespecially in high security environments.\n\n544\n00:26:20.250 --> 00:26:22.010\nThe setup, not terribly challenging.\n\n545\n00:26:22.010 --> 00:26:22.960\nWell, a little bit, right?\n\n546\n00:26:22.960 --> 00:26:24.380\n>> Yeah.\nJust a little bit challenging.\n\n547\n00:26:24.380 --> 00:26:27.170\nAnd just getting all those\nlittle pieces set up correctly.\n\n548\n00:26:27.170 --> 00:26:29.540\nBecause it can be a little bit\nchallenging remembering everything.\n\n549\n00:26:29.540 --> 00:26:31.530\nAnd Don, there is only one\nother thing I did remember.\n\n550\n00:26:31.530 --> 00:26:32.440\nYou mentioned Raccoon.\n\n551\n00:26:32.440 --> 00:26:36.370\nThat was true in that 2.1.5, or\nat least all of the way up through there.\n\n552\n00:26:36.370 --> 00:26:38.370\nBeginning with 2.2 or so.\n\n553\n00:26:38.370 --> 00:26:39.710\n>> Now it is just called IPSec?\n\n554\n00:26:39.710 --> 00:26:40.850\n>> It's actually different.\n\n555\n00:26:40.850 --> 00:26:43.959\nThey actually use something called\nStrong Swan or something else.\n\n556\n00:26:43.959 --> 00:26:45.020\n>> Oh.\nI do remember reading about that.\n\n557\n00:26:45.020 --> 00:26:46.670\n>> And they changed it.\n\n558\n00:26:46.670 --> 00:26:47.710\nPeople change things.\n\n559\n00:26:47.710 --> 00:26:49.230\n>> I know.\n>> Good thing to know though.\n\n560\n00:26:49.230 --> 00:26:52.260\nIf you're running 2.1 or earlier it\nwill be called the Raccoon service.\n\n561\n00:26:52.260 --> 00:26:54.360\nIn 2.2 apparently now,\nit's just called IPsec.\n\n562\n00:26:54.360 --> 00:26:55.890\nIt's that Strong Swan suite.\n\n563\n00:26:55.890 --> 00:26:57.612\nBut they work the same, right?\n\n564\n00:26:57.612 --> 00:26:59.200\n>> They do.\n>> It's IPsec under the hood.\n\n565\n00:26:59.200 --> 00:27:02.710\nYou can build a version one and version\ntwo IP connections and it works great.\n\n566\n00:27:02.710 --> 00:27:04.190\nI know we use it in production.\n\n567\n00:27:04.190 --> 00:27:06.930\nWe have one connection to another\nstudio that is doing that.\n\n568\n00:27:07.960 --> 00:27:09.780\nIt really does work well.\n\n569\n00:27:09.780 --> 00:27:12.010\nFunctionality, like everything else,\nis built into pfSense.\n\n570\n00:27:12.010 --> 00:27:14.260\nWe don't have to pay a license for\nit, it's free.\n\n571\n00:27:14.260 --> 00:27:16.390\nJust be aware to watch your utilization.\n\n572\n00:27:16.390 --> 00:27:20.363\nWatch your CPU utilization cause IPsec\ncan do some pretty heavy encryption.\n\n573\n00:27:20.363 --> 00:27:23.018\nAnd your system might not be\nable to keep up with that,\n\n574\n00:27:23.018 --> 00:27:25.618\nso always keep an eye on\nyour resource utilization.\n\n575\n00:27:25.618 --> 00:27:27.894\nAll right well ladies and\ngentlemen that wraps up IPsec.\n\n576\n00:27:27.894 --> 00:27:31.568\nStay tuned,\nwe've got more pfSense content coming up.\n\n577\n00:27:31.568 --> 00:27:37.280\n[MUSIC]\n\n",
          "vimeoId": "130769504"
        }
      ],
      "title": "Virtual Private Networks (VPN)"
    },
    {
      "episodes": [
        {
          "description": null,
          "length": "1672",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-1-dhcp-062915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-1-dhcp-062915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-1-dhcp-062915-1-sm.jpg",
          "title": "DHCP",
          "transcript": "WEBVTT\n\n1\n00:00:00.195 --> 00:00:07.583\n[MUSIC]\n\n2\n00:00:07.583 --> 00:00:10.596\nWelcome, in this segment,\nwe'll be taking a look at DHCP,\n\n3\n00:00:10.596 --> 00:00:12.900\nspecifically in its use in pfSense.\n\n4\n00:00:12.900 --> 00:00:13.830\nSo as we begin,\n\n5\n00:00:13.830 --> 00:00:20.210\nwe wanna actually understand that pfSense\ncan give you the ability to use DHCP.\n\n6\n00:00:20.210 --> 00:00:24.750\nBut if I already have a DHCP server\nset up and I'm already using it,\n\n7\n00:00:24.750 --> 00:00:28.430\nDon is there a reason why I\nshould actually be doing that?\n\n8\n00:00:28.430 --> 00:00:30.030\n>> Well you certainly don't have to.\n\n9\n00:00:30.030 --> 00:00:34.200\nSo many people already have a router\nin place or a server that's doing their\n\n10\n00:00:34.200 --> 00:00:38.460\ndynamic host configuration protocol setup\nand that's fine you can stick with that.\n\n11\n00:00:38.460 --> 00:00:41.070\nBut if you use the pfSense setup,\nthere's actually some\n\n12\n00:00:41.070 --> 00:00:43.330\nfeatures that are found in there\nthat are kinda nice to have.\n\n13\n00:00:43.330 --> 00:00:46.730\nAnd they're not, they're non-essential,\nthey're not required, pfSense is not some\n\n14\n00:00:46.730 --> 00:00:50.350\nmagical DHCP server that does\ncrazy things other systems don't.\n\n15\n00:00:50.350 --> 00:00:52.970\nBut it's just kinda nice to\nhave some basic functionality.\n\n16\n00:00:52.970 --> 00:00:55.460\nSo, let's take a look at\nDHCP configuration and\n\n17\n00:00:55.460 --> 00:00:57.800\nkinda see where it can take us.\n\n18\n00:00:57.800 --> 00:01:00.980\nNow, first off,\nif you did a basic pfSense install,\n\n19\n00:01:00.980 --> 00:01:02.970\nyou probably walked\nthrough the the wizard and\n\n20\n00:01:02.970 --> 00:01:06.720\none of the options there was to\nenable DHCP for your LAN interface.\n\n21\n00:01:06.720 --> 00:01:10.590\nIt's on by default, so\nyou're probably already a DHCP server.\n\n22\n00:01:10.590 --> 00:01:13.840\nYou might not have wanted that,\nyou might want that turned off, right?\n\n23\n00:01:13.840 --> 00:01:15.350\nSo let's take a look at my firewall and\n\n24\n00:01:15.350 --> 00:01:17.840\nwe'll see how mine is set up and\nwe'll kinda go from there.\n\n25\n00:01:17.840 --> 00:01:19.470\nSo here I've got a firewall set up.\n\n26\n00:01:19.470 --> 00:01:25.100\nIt's at 192.168.0.1,\npretty standard LAN IP type configuration.\n\n27\n00:01:25.100 --> 00:01:30.577\nAnd up top if we go to Services\nyou'll find DHCP Server right there.\n\n28\n00:01:30.577 --> 00:01:33.967\nNow notice there's actually\nfour entries for DHCP.\n\n29\n00:01:33.967 --> 00:01:35.110\nWhat's that all about?\n\n30\n00:01:35.110 --> 00:01:37.820\nWell there's two of them\nthat are important.\n\n31\n00:01:37.820 --> 00:01:42.650\nThere's DHCP server which means\nyou're an IPv4 DHCP server.\n\n32\n00:01:42.650 --> 00:01:49.221\nYou'll hand out IP addresses for IPv4 and\nthen there's DHCPv6 server, right?\n\n33\n00:01:49.221 --> 00:01:53.373\nSo you'll hand out configuration\noptions for DHCPv6.\n\n34\n00:01:53.373 --> 00:01:56.640\nThe other two are relays.\n\n35\n00:01:56.640 --> 00:01:59.500\nWith a relay, you're not a DHCP server.\n\n36\n00:01:59.500 --> 00:02:04.040\nInstead, you listen for\nDHCP requests, you capture them, and\n\n37\n00:02:04.040 --> 00:02:06.790\nyou forward them to a DHCP\nserver somewhere else.\n\n38\n00:02:06.790 --> 00:02:08.530\nThat's really useful in branch offices.\n\n39\n00:02:08.530 --> 00:02:12.170\nYou might have a branch office, but\nthe DHCP server's at headquarters.\n\n40\n00:02:12.170 --> 00:02:16.490\nWell DHCP requests are broadcasts and\nbroadcasts won't pass through a firewall\n\n41\n00:02:16.490 --> 00:02:20.280\nor a router so here we capture them, turn\nthem into unicasts and sent them along.\n\n42\n00:02:20.280 --> 00:02:21.955\nThat is what all these\ndifferent menu options are.\n\n43\n00:02:21.955 --> 00:02:25.370\nDHCP server though, that is the one\nthat we generally care about\n\n44\n00:02:25.370 --> 00:02:27.140\nbecause IPv4 is what\nwe're normally handling.\n\n45\n00:02:28.510 --> 00:02:33.330\nNow, when you get there, you're gonna see\na tab for each interface on your firewall.\n\n46\n00:02:33.330 --> 00:02:35.550\nIf you have five interfaces,\nyou'll see five tabs.\n\n47\n00:02:35.550 --> 00:02:37.980\nIf you have one interface like I do,\nyou'll see one tab.\n\n48\n00:02:37.980 --> 00:02:42.120\nAnd when you look at it, it's telling\nyou whether DHCP is turned on.\n\n49\n00:02:42.120 --> 00:02:43.330\nIn my case, it is turned on.\n\n50\n00:02:43.330 --> 00:02:46.540\nIf it were off,\nlet me just turn that off real quick.\n\n51\n00:02:46.540 --> 00:02:50.170\nIf it's off, then the screen\ndoesn't look much different, right?\n\n52\n00:02:50.170 --> 00:02:51.560\nWe still see all the various options.\n\n53\n00:02:51.560 --> 00:02:54.550\nIt's just this first check\nmark Enable DHCP server\n\n54\n00:02:54.550 --> 00:02:56.260\non LAN interface would be off, right?\n\n55\n00:02:56.260 --> 00:02:58.750\nSo turning it on and off, very easy to do.\n\n56\n00:02:58.750 --> 00:02:59.940\nAnd when you turn it off,\n\n57\n00:02:59.940 --> 00:03:04.370\nif you've already customized a hundred\ndifferent options, they all stay.\n\n58\n00:03:04.370 --> 00:03:07.197\nWhen you disable DHCP,\nit doesn't delete its settings,\n\n59\n00:03:07.197 --> 00:03:10.138\nso you can temporarily turn it\noff while you test something or\n\n60\n00:03:10.138 --> 00:03:12.340\ntroubleshoot and\nthen turn it back on again.\n\n61\n00:03:12.340 --> 00:03:15.545\nNow, I've got LAN and DMZ.\n\n62\n00:03:15.545 --> 00:03:19.470\nI also have a WAN interface that's\nnot showing up here, all right?\n\n63\n00:03:19.470 --> 00:03:20.440\nWhy isn't that showing up?\n\n64\n00:03:20.440 --> 00:03:25.910\nWell, it doesn't make any sense to\nissue IP addresses to the internet.\n\n65\n00:03:25.910 --> 00:03:29.080\nSo the WAN interface is the one\ninterface that won't show up here, but\n\n66\n00:03:29.080 --> 00:03:32.295\nif you've got LAN, DMZ,\nother networks that you've created,\n\n67\n00:03:32.295 --> 00:03:36.640\nthey'll each show up and you can enable\nthe HTP to hand our their configurations.\n\n68\n00:03:36.640 --> 00:03:39.180\nAnd the configuration could be\nvery different for each network.\n\n69\n00:03:40.290 --> 00:03:43.710\nWell, it's gotta be different because you\nmight have a different default gateway.\n\n70\n00:03:43.710 --> 00:03:46.210\nYou might have different DNS servers,\nthings like that, so\n\n71\n00:03:46.210 --> 00:03:48.170\nthat's why you have separate tabs for\neach one.\n\n72\n00:03:49.230 --> 00:03:49.980\nWell normally,\n\n73\n00:03:49.980 --> 00:03:53.400\nwith the DHCP server we've got a couple of\nbasic options that we want to hand down.\n\n74\n00:03:54.490 --> 00:03:56.990\nYou want to hand out an IP address,\nthat's kinda the whole point.\n\n75\n00:03:56.990 --> 00:03:58.600\nYou got computers that need an IP address.\n\n76\n00:03:58.600 --> 00:04:00.000\nWe're gonna give it to them.\n\n77\n00:04:00.000 --> 00:04:01.820\nSo you have to define a range of IPs.\n\n78\n00:04:02.820 --> 00:04:05.260\nYou'll need to assign\na subnet mask to use, so\n\n79\n00:04:05.260 --> 00:04:07.850\npeople know what the limits\nof their networks are.\n\n80\n00:04:07.850 --> 00:04:11.250\nYou'll typically want\nto hand out a gateway.\n\n81\n00:04:11.250 --> 00:04:12.050\nNow, you don't have to.\n\n82\n00:04:12.050 --> 00:04:15.769\nReally at a minimum, if you want to set\nup a DHCP server, the bare minimum,\n\n83\n00:04:15.769 --> 00:04:17.570\nIP address and subnet.\n\n84\n00:04:17.570 --> 00:04:21.490\nThat'll give you local communications,\nbut if you want to communicate to other\n\n85\n00:04:21.490 --> 00:04:24.400\nnetworks, you'll have to hand\nout a gateway server also.\n\n86\n00:04:24.400 --> 00:04:28.670\nSo those three things will\ngive us routed communications.\n\n87\n00:04:28.670 --> 00:04:31.320\nBut you'll probably want\nto tack on DNS servers too.\n\n88\n00:04:31.320 --> 00:04:33.944\nSo you can do name lookups and\nbrowse by name.\n\n89\n00:04:33.944 --> 00:04:38.688\nSo when I set up a DHCP server,\nthe four minimum things I look for,\n\n90\n00:04:38.688 --> 00:04:42.397\nthe IP address pool,\nthe pool of IPs I can hand out,\n\n91\n00:04:42.397 --> 00:04:47.120\nthe subnet mask, the default gateway and\nthe DNS servers.\n\n92\n00:04:47.120 --> 00:04:49.430\nAnd we'll find all those\noptions right here, but\n\n93\n00:04:49.430 --> 00:04:52.860\nthere's a lot more really cool\nstuff that pfSense can do.\n\n94\n00:04:52.860 --> 00:04:56.710\nLike this one right here,\nDeny unknown clients.\n\n95\n00:04:56.710 --> 00:04:58.020\nWhat's that all about?\n\n96\n00:04:58.020 --> 00:05:02.820\nWell, when we set up DHCP you\ncreate a pool of addresses.\n\n97\n00:05:02.820 --> 00:05:05.920\nAnd the pool is given out on a first\ncome first serve basis, right?\n\n98\n00:05:05.920 --> 00:05:08.020\nThe first computer that comes along\ngets an address from the pool.\n\n99\n00:05:08.020 --> 00:05:09.410\nThe second person gets\nanother one from the pool.\n\n100\n00:05:09.410 --> 00:05:11.440\nAnd it's just kind of randomly assigned.\n\n101\n00:05:11.440 --> 00:05:16.866\nWell, we can create a reservation\nwhere every machine gets a certain IP,\n\n102\n00:05:16.866 --> 00:05:19.590\na specific IP reserved just for them.\n\n103\n00:05:19.590 --> 00:05:22.330\nIf we say Deny unknown clients,\n\n104\n00:05:22.330 --> 00:05:25.430\nonly people with reservations\nwill be allowed to connect.\n\n105\n00:05:25.430 --> 00:05:28.720\nIf anybody else comes up and\nrequests an address, they won't get it.\n\n106\n00:05:28.720 --> 00:05:30.760\nIt's kind of an interesting\nway to control traffic.\n\n107\n00:05:30.760 --> 00:05:33.180\nNow, some people view this as security.\n\n108\n00:05:33.180 --> 00:05:37.330\nIt really isn't, because all somebody\nhas to do is run a sniffer, and\n\n109\n00:05:37.330 --> 00:05:39.260\nfind some MAC addresses that\nare already on the network.\n\n110\n00:05:39.260 --> 00:05:42.380\nThe can spoof the MAC address and\nthen they can get a DHCP address,\n\n111\n00:05:42.380 --> 00:05:44.370\nit's that simple really.\n\n112\n00:05:44.370 --> 00:05:45.770\nIt's not a true level of security.\n\n113\n00:05:45.770 --> 00:05:49.406\nIt'll stop a low-grade hacker, but\nit won't stop anybody with I don't know,\n\n114\n00:05:49.406 --> 00:05:51.758\n15 minutes of google time\nunder their belt to go and\n\n115\n00:05:51.758 --> 00:05:53.483\nfigure out how to spoof a MAC address.\n\n116\n00:05:53.483 --> 00:05:56.944\nBut you can do that,\nI'm gonna turn that off for now.\n\n117\n00:05:56.944 --> 00:06:04.020\nThen, I'm seeing the subnet mask and\nthe subnet for the interface, for LAN.\n\n118\n00:06:04.020 --> 00:06:07.450\nAnd so that's letting me know it's going\nto pick this subnet mask to use and\n\n119\n00:06:07.450 --> 00:06:10.360\nwhat range of IPs do I want to give out?\n\n120\n00:06:10.360 --> 00:06:13.700\nNow I can pick a range that’s\nvery small or very big.\n\n121\n00:06:13.700 --> 00:06:17.720\nI need to think about how many computers\nare on my network and set that many IPs.\n\n122\n00:06:17.720 --> 00:06:19.580\nNow, it used to be easy, right Ronnie,\n\n123\n00:06:19.580 --> 00:06:21.999\nwe used just count the amount of\ncomputers but it’s not so easy anymore.\n\n124\n00:06:23.000 --> 00:06:25.870\nNow there's so many different\ndifferent devices out there.\n\n125\n00:06:25.870 --> 00:06:29.730\nThere's tablets and cellphones, printers.\n\n126\n00:06:29.730 --> 00:06:31.980\nI mean what else can come up?\n\n127\n00:06:31.980 --> 00:06:32.980\n>> I can't even think of so\n\n128\n00:06:32.980 --> 00:06:35.390\nmany other devices other than\nnetbooks that might be out there.\n\n129\n00:06:35.390 --> 00:06:39.070\nYou name it, everybody's bringing what\nwe call today of course that BYOD,\n\n130\n00:06:39.070 --> 00:06:40.600\nthe bring your own device.\n\n131\n00:06:40.600 --> 00:06:42.410\nAnd they're all gonna\nwork off of wireless,\n\n132\n00:06:42.410 --> 00:06:46.560\nwhich now means that if you actually did\nsay, I'm only gonna need 50 IP addresses,\n\n133\n00:06:46.560 --> 00:06:50.210\nyou amazingly find that that one\nindividual might have 10% of those.\n\n134\n00:06:50.210 --> 00:06:54.060\nThey might have five devices that they've\nbrought with them, and that can limit you.\n\n135\n00:06:54.060 --> 00:06:56.610\nAnd all of a sudden, you're gonna\nstart running out of IP addresses.\n\n136\n00:06:56.610 --> 00:06:58.440\n>> Yep, so you gotta plan for\n\n137\n00:06:58.440 --> 00:07:00.680\nall of the devices you have to\nmake sure you have enough IPs.\n\n138\n00:07:00.680 --> 00:07:03.640\nWhat happens if we run out of IPs?\n\n139\n00:07:03.640 --> 00:07:05.190\nYou get people to boot up and\nthey don't get an address.\n\n140\n00:07:05.190 --> 00:07:07.680\nSo a lot of them will do that APIPA stuff,\nright?\n\n141\n00:07:07.680 --> 00:07:09.726\nThe Automatic Private IP Addressing.\n\n142\n00:07:09.726 --> 00:07:11.212\nThere we go, thank you, Ronnie.\n\n143\n00:07:11.212 --> 00:07:14.613\nWhere they pick\na 169.254.something.something address, and\n\n144\n00:07:14.613 --> 00:07:16.488\nthat's not terribly effective for us.\n\n145\n00:07:16.488 --> 00:07:19.214\nSo I'm gonna make sure to pick\na range that's nice and big.\n\n146\n00:07:19.214 --> 00:07:23.116\nI'm gonna do 192.168.0.50.\n\n147\n00:07:23.116 --> 00:07:26.831\nThey're 192.168.0.100.\n\n148\n00:07:26.831 --> 00:07:29.638\nNow, you could put your\nwhole range in there.\n\n149\n00:07:29.638 --> 00:07:33.680\nI could do .1 all the way through .254,\nbut my firewall is .1.\n\n150\n00:07:33.680 --> 00:07:36.440\nYou've probably have some\nother hosts on your network,\n\n151\n00:07:36.440 --> 00:07:40.490\nthings like servers or\nprinters that you want to have static IPs.\n\n152\n00:07:40.490 --> 00:07:43.200\nAnd so you might not want that\nrange to span the whole thing.\n\n153\n00:07:43.200 --> 00:07:47.000\nOr maybe you do, and you wanna do\nreservations for those, right.\n\n154\n00:07:47.000 --> 00:07:51.250\nI might have printer that I know I always\nwant that printer to have the same IP so\n\n155\n00:07:51.250 --> 00:07:52.680\nI can print to it.\n\n156\n00:07:52.680 --> 00:07:55.348\nBut I don't wanna statically assign\nthe IP, I wanna do it through DHCP.\n\n157\n00:07:55.348 --> 00:07:57.671\nNow why would I wanna do that?\n\n158\n00:07:57.671 --> 00:08:01.815\nWhy would I want to do a DHCP reservation,\nversus a static assignment?\n\n159\n00:08:01.815 --> 00:08:04.567\nWell, with a static assignment it's great.\n\n160\n00:08:04.567 --> 00:08:08.464\nYou set the IP and it's going to work\nregardless of whether the firewall's up or\n\n161\n00:08:08.464 --> 00:08:11.340\nnot, regardless of whether\nthe DHCP server's running.\n\n162\n00:08:11.340 --> 00:08:12.960\nBut if you want to make a change,\n\n163\n00:08:12.960 --> 00:08:15.402\nmaybe one day I decide I'm going to use\nsome new DNS servers on the network,\n\n164\n00:08:15.402 --> 00:08:21.210\nI've gotta go to every machine where I did\na static IP and update those DNS servers.\n\n165\n00:08:21.210 --> 00:08:24.970\nIf I did a reservation,\nI just update it on the DHCP server.\n\n166\n00:08:24.970 --> 00:08:29.460\nAnd now those other machines,\nthat are always getting the same IP,\n\n167\n00:08:29.460 --> 00:08:31.760\nthey'll update their DNS and\nwe'll get those new values.\n\n168\n00:08:31.760 --> 00:08:33.450\nSo it makes for simpler administration.\n\n169\n00:08:33.450 --> 00:08:35.150\nYou have to make that choice, right?\n\n170\n00:08:35.150 --> 00:08:39.780\nWould you rather want the rock hard\nreliability of doing a static IP\n\n171\n00:08:39.780 --> 00:08:43.900\non your individual machines and\ntrade ease of administration, or\n\n172\n00:08:43.900 --> 00:08:47.130\nwould you prefer ease of\nadministration in exchange for\n\n173\n00:08:47.130 --> 00:08:50.500\na little bit of unreliability in\nthe event that your DHCP server fails?.\n\n174\n00:08:50.500 --> 00:08:52.420\nSo that's kind of the choice you make.\n\n175\n00:08:52.420 --> 00:08:56.890\nI'll pick just a medium sized pool here,\nnow you can do additional pools.\n\n176\n00:08:56.890 --> 00:09:00.780\nNow why would we want\nto do additional pools?\n\n177\n00:09:00.780 --> 00:09:04.180\nMaybe there's some IPs that are in use and\nI wanna skip around them.\n\n178\n00:09:05.180 --> 00:09:07.190\nSo I might want to have a pool\nthat's kinda broken up.\n\n179\n00:09:07.190 --> 00:09:08.740\nI did 50 through 100.\n\n180\n00:09:08.740 --> 00:09:14.790\nI might want to add in another pool and\npunch in a range that's within that.\n\n181\n00:09:14.790 --> 00:09:18.090\nSo I could come in and I could say,\noh you know what, shoot, I never saved my\n\n182\n00:09:18.090 --> 00:09:21.510\nchanges on that last screen, so\nit's gonna get upset with me, but [COUGH].\n\n183\n00:09:21.510 --> 00:09:24.900\nSo we could come through and\nsay 50 through 100 for our first pool.\n\n184\n00:09:24.900 --> 00:09:27.280\nAnd then I might do 150 to 200.\n\n185\n00:09:27.280 --> 00:09:29.872\nAnd so I'm skipping 100 through 150.\n\n186\n00:09:29.872 --> 00:09:30.990\nYou might wanna do that.\n\n187\n00:09:30.990 --> 00:09:32.750\nAnd you can set more pools to handle that.\n\n188\n00:09:34.100 --> 00:09:39.370\nThe other thing is you might be the target\nof a DHCP relay agent from somewhere else.\n\n189\n00:09:39.370 --> 00:09:42.270\nSomebody else is relaying\nDHCP requests to you.\n\n190\n00:09:42.270 --> 00:09:44.690\nSo you might want to create\npools in those other networks so\n\n191\n00:09:44.690 --> 00:09:46.380\nthat you can issue out addresses there.\n\n192\n00:09:46.380 --> 00:09:48.260\nIt's less common, but\nit is another configuration.\n\n193\n00:09:50.710 --> 00:09:53.393\nSo let me get back here and reset this,\nsince I didn't save my changes,\n\n194\n00:09:53.393 --> 00:09:55.520\nI just lost them, so\nlet me just put those right back in.\n\n195\n00:09:55.520 --> 00:09:58.814\nAll right, then,\nif you've got WINS servers, now, Ronnie,\n\n196\n00:09:58.814 --> 00:10:01.379\nwhen's the last time you\nhad to use a WINS server?\n\n197\n00:10:01.379 --> 00:10:05.103\n>> I think 2004 is the last time\nI remember using a WINS server.\n\n198\n00:10:05.103 --> 00:10:07.055\nWhen we talk about using WINS server,\n\n199\n00:10:07.055 --> 00:10:10.110\nthis is using the old net BIOS\nway of doing name resolution.\n\n200\n00:10:10.110 --> 00:10:14.063\nAnd a lot of us haven't needed to set\nup WINS because DNS has really subsumed\n\n201\n00:10:14.063 --> 00:10:17.210\neverything that the WINS\nsever would end up doing.\n\n202\n00:10:17.210 --> 00:10:19.900\nSo if your still running a WINS server\nits probably because you have some\n\n203\n00:10:19.900 --> 00:10:21.850\napplication that might still use it.\n\n204\n00:10:21.850 --> 00:10:24.456\nBut not many of us are actually using\nany application that's doing that.\n\n205\n00:10:24.456 --> 00:10:26.418\n>> I find a lot of places\nthat still run WINS servers,\n\n206\n00:10:26.418 --> 00:10:28.120\njust run them because they're used to it.\n\n207\n00:10:28.120 --> 00:10:29.680\n>> [LAUGH]\n>> And they don't actually realize\n\n208\n00:10:29.680 --> 00:10:32.398\nthe devices aren't using it anymore\ncuz ever since Windows 2000,\n\n209\n00:10:32.398 --> 00:10:34.560\nMicrosoft's has been\nmoving away from that.\n\n210\n00:10:34.560 --> 00:10:38.527\nIf you're running Windows 7, Windows 8,\nyou're not using that WINS server and\n\n211\n00:10:38.527 --> 00:10:40.350\nyou probably don't need it anymore.\n\n212\n00:10:40.350 --> 00:10:43.170\nDNS, on the other hand,\nthat one is one that we use.\n\n213\n00:10:43.170 --> 00:10:46.600\nNow the DHCP server in pfSense\nis kind of interesting.\n\n214\n00:10:46.600 --> 00:10:52.950\nIf I leave this empty, then it'll use\nwhatever DNS servers my firewall is using.\n\n215\n00:10:52.950 --> 00:10:54.940\nIf you go up here to System and\n\n216\n00:10:54.940 --> 00:10:58.010\nGeneral Setup,\nlet me open this in another tab here.\n\n217\n00:10:58.010 --> 00:10:58.830\nIf you go to System and\n\n218\n00:10:58.830 --> 00:11:03.630\nGeneral Setup, in the General Setup you\ndefine the DNS servers for your firewall.\n\n219\n00:11:03.630 --> 00:11:06.300\nIf you do not define them\nhere in your DHCP pool,\n\n220\n00:11:06.300 --> 00:11:08.720\nthen you're just gonna hand\nout those general ones.\n\n221\n00:11:08.720 --> 00:11:11.090\nBut you might choose to put them in here,\nanyway, just to have them.\n\n222\n00:11:11.090 --> 00:11:13.450\nOr maybe you want to give\nout different ones, right?\n\n223\n00:11:13.450 --> 00:11:18.921\nSo you can come in and put in other DNS\nservers to hand out to your clients.\n\n224\n00:11:20.480 --> 00:11:22.670\nYour gateway, by default,\n\n225\n00:11:22.670 --> 00:11:26.370\nif you leave this blank, the firewall's\ngoing to hand itself out as the gateway.\n\n226\n00:11:26.370 --> 00:11:28.590\nI'm your gateway, come through me.\n\n227\n00:11:28.590 --> 00:11:31.500\nBut if your firewall here\nis the DHCP server and\n\n228\n00:11:31.500 --> 00:11:35.150\nsomebody else is the gateway,\nyou could specify that other IP.\n\n229\n00:11:35.150 --> 00:11:38.710\nYou could tell it somebody else to use.\n\n230\n00:11:38.710 --> 00:11:41.400\nI'm gonna hand out\n192.168.0.2 as my gateway.\n\n231\n00:11:41.400 --> 00:11:47.130\nThere is no .2 so I'm kind of\npicking a non-valid address there.\n\n232\n00:11:47.130 --> 00:11:50.200\nBut all right, a domain name.\n\n233\n00:11:50.200 --> 00:11:53.630\nNow domain name is optional If\nsomebody does something like\n\n234\n00:11:53.630 --> 00:11:58.210\nping www.google.com it's gonna work and\nlook that up.\n\n235\n00:11:58.210 --> 00:11:59.710\nThat's no big deal.\n\n236\n00:11:59.710 --> 00:12:03.110\nBut if they do a ping to server one and\nthat's it.\n\n237\n00:12:03.110 --> 00:12:05.180\nServer one with no domain name.\n\n238\n00:12:05.180 --> 00:12:08.540\nWell, who is server one, and\nhow do I look that up in DNS?\n\n239\n00:12:08.540 --> 00:12:09.530\nI can't.\n\n240\n00:12:09.530 --> 00:12:13.070\nAnd so here's where we're specifying what\ntheir default domain name is going to be.\n\n241\n00:12:13.070 --> 00:12:16.270\nSo, I might do something\nlike lab.itpro.tv.\n\n242\n00:12:16.270 --> 00:12:19.925\nSo now, somebody does a ping to\nserver one they'll actually look up\n\n243\n00:12:19.925 --> 00:12:23.970\nserver1.lab.itpro.tv.\n\n244\n00:12:23.970 --> 00:12:26.948\nIf there's other domains that I\nwanna add to that search list,\n\n245\n00:12:26.948 --> 00:12:28.023\nI can do it here right.\n\n246\n00:12:28.023 --> 00:12:30.999\nSo maybe I got the actual itpro.tv or\n\n247\n00:12:30.999 --> 00:12:34.936\nI might have you know\nlike staging.itpro.tv or\n\n248\n00:12:34.936 --> 00:12:41.690\nother domains edutainmentlive.com it\ncould be a completely different one.\n\n249\n00:12:41.690 --> 00:12:46.250\nAnd what you'll see is I'm separating\neach of those with semi-colons.\n\n250\n00:12:46.250 --> 00:12:50.350\nYou can put as many domains as you want,\njust put semicolons in between them and\n\n251\n00:12:50.350 --> 00:12:53.535\nnow our clients will use those\ndomains when they do a lookup.\n\n252\n00:12:53.535 --> 00:12:55.790\nAll right, next is the lease time.\n\n253\n00:12:55.790 --> 00:12:58.900\nHere's how long somebody will be\nallowed to have an address for.\n\n254\n00:12:58.900 --> 00:13:00.100\nAnd it's done in seconds.\n\n255\n00:13:00.100 --> 00:13:03.260\nSo when they get a lease,\nhow long do we let them have the address?\n\n256\n00:13:03.260 --> 00:13:08.650\nNow on DHCP servers of yore the default\nwas usually seven or eight days.\n\n257\n00:13:08.650 --> 00:13:10.870\nSo you'd have an address an entire week.\n\n258\n00:13:10.870 --> 00:13:14.332\nThe reason they picked such a big time was\nif you had 1,000 machines that were out\n\n259\n00:13:14.332 --> 00:13:16.925\nthere or\n10,000 machine that were out there.\n\n260\n00:13:16.925 --> 00:13:19.855\nYou didn't want them constantly renewing\ntheir addresses because it created\n\n261\n00:13:19.855 --> 00:13:21.655\na burden on the system.\n\n262\n00:13:21.655 --> 00:13:25.965\nBut in today's world, modern processors\nand disk access the way it is, it's so\n\n263\n00:13:25.965 --> 00:13:29.442\nmuch faster that we can do really\nshort times if If we want.\n\n264\n00:13:29.442 --> 00:13:33.443\nIf you'll notice, the default\nsetting here is 7,200 seconds, and\n\n265\n00:13:33.443 --> 00:13:36.034\nI don't know what that\nactually is in minutes.\n\n266\n00:13:36.034 --> 00:13:37.582\n>> Two hours.\n>> That's two hours?\n\n267\n00:13:37.582 --> 00:13:38.602\n>> Yeah, 120 minutes.\n\n268\n00:13:38.602 --> 00:13:39.497\n>> You are fast at math today.\n\n269\n00:13:39.497 --> 00:13:43.532\nSo two hours,\nnow you might say to yourself, two hours?\n\n270\n00:13:43.532 --> 00:13:45.022\nThat's pretty fast, isn't it?\n\n271\n00:13:45.022 --> 00:13:46.252\nWell it's even faster than that, right?\n\n272\n00:13:46.252 --> 00:13:50.390\nRemember that most clients don't wait for\ntheir lease to expire to renew.\n\n273\n00:13:50.390 --> 00:13:52.050\nMost clients will renew at 50%.\n\n274\n00:13:52.050 --> 00:13:57.010\nSo when I say two hours here, really at\none hour clients are gonna start renewing.\n\n275\n00:13:57.010 --> 00:14:00.010\nWell if you are Starbucks, or\n\n276\n00:14:00.010 --> 00:14:03.350\nyou have like a public wireless network\nwhere people come and go, right?\n\n277\n00:14:03.350 --> 00:14:06.740\nThey come in, they drink some coffee and\nuse your network and then they leave.\n\n278\n00:14:06.740 --> 00:14:08.900\nWell, you don't want them\nholding in an address for\n\n279\n00:14:08.900 --> 00:14:11.140\nan entire week when they\nwere only there for an hour.\n\n280\n00:14:11.140 --> 00:14:13.520\nSo you want a nice, short time like that.\n\n281\n00:14:13.520 --> 00:14:17.095\nBut if you're in a corporate network where\nyou've got the same machines connecting\n\n282\n00:14:17.095 --> 00:14:19.321\nday after day after day,\nyou can pick a longer time.\n\n283\n00:14:19.321 --> 00:14:22.394\nYou might pick one that's 24 hours.\n\n284\n00:14:22.394 --> 00:14:23.331\nWhat is 24 hours?\n\n285\n00:14:23.331 --> 00:14:25.380\nIs that 14,400, or is that 28?\n\n286\n00:14:25.380 --> 00:14:28.761\n>> It's actually,\nin seconds it's 86,400 seconds.\n\n287\n00:14:28.761 --> 00:14:31.297\n>> Oh, 86,400 seconds, I'm completely off.\n\n288\n00:14:31.297 --> 00:14:33.620\n>> [LAUGH]\n>> All right, so I'm gonna go for\n\n289\n00:14:33.620 --> 00:14:34.310\n24 hours here.\n\n290\n00:14:34.310 --> 00:14:37.040\nSo we'll set that hole in there.\n\n291\n00:14:37.040 --> 00:14:39.730\nThe maximum lease time.\n\n292\n00:14:39.730 --> 00:14:42.860\nNow, the maximum lease\ntime says if somebody\n\n293\n00:14:42.860 --> 00:14:45.560\nhasn't renewed by the time they hit\nthis point, when do I cut them off?.\n\n294\n00:14:45.560 --> 00:14:47.890\nYou can actually force them\nto renew earlier if you want.\n\n295\n00:14:47.890 --> 00:14:49.490\nYou can kind of manipulate that.\n\n296\n00:14:49.490 --> 00:14:53.650\nBut, then, clients can also ask for\na specific time.\n\n297\n00:14:53.650 --> 00:14:58.230\nNow, I've never seen anybody use this\nfeature, but just because you have\n\n298\n00:14:58.230 --> 00:15:01.760\na default lease time doesn't mean a client\ncouldn't ask for more if they wanted it.\n\n299\n00:15:01.760 --> 00:15:04.640\nI'm going to set it to just be the same\nwhich just happens to be the default\n\n300\n00:15:04.640 --> 00:15:05.775\nhere so I don't have to worry about that.\n\n301\n00:15:05.775 --> 00:15:06.930\nAnd we'll leave that be.\n\n302\n00:15:08.560 --> 00:15:10.900\nThen a fail-over peer IP.\n\n303\n00:15:12.010 --> 00:15:15.120\nNow what happens if my\nDHCP server goes offline?\n\n304\n00:15:16.150 --> 00:15:20.530\nPeople can't get addresses, and if I have\na 24-hour lease time, within 24 hours,\n\n305\n00:15:20.530 --> 00:15:22.820\npeople are gonna lose their IPs and\nmy network breaks.\n\n306\n00:15:22.820 --> 00:15:24.070\nWell, it's already broken, right?\n\n307\n00:15:24.070 --> 00:15:26.420\nBut now my end users feel it.\n\n308\n00:15:26.420 --> 00:15:29.220\nSo a way that we can prevent\nthat is to set up fail-over.\n\n309\n00:15:29.220 --> 00:15:32.900\nHave a second firewall so\nthat if one fails, the other takes over.\n\n310\n00:15:32.900 --> 00:15:36.060\nIf you haven't seen it,\nwe filmed an episode on high availability.\n\n311\n00:15:36.060 --> 00:15:39.000\nAnd I showed how to set up\ntwo pfSense firewalls where\n\n312\n00:15:39.000 --> 00:15:40.850\nthey replicate state between each other.\n\n313\n00:15:40.850 --> 00:15:43.740\nThey can replicate their\nDHCP database also, so\n\n314\n00:15:43.740 --> 00:15:45.931\nthat one can take over for the other.\n\n315\n00:15:45.931 --> 00:15:51.929\nIf you're doing that, you would just put\nthe IP address of the peer right here.\n\n316\n00:15:51.929 --> 00:15:54.753\nAll right, next is static ARP.\n\n317\n00:15:54.753 --> 00:16:00.232\nNow static ARP is I know it's kind of\nviewed by a lot of people as voodoo magic.\n\n318\n00:16:00.232 --> 00:16:03.756\n>> [LAUGH]\n>> Static ARP Is something that we use in\n\n319\n00:16:03.756 --> 00:16:06.690\na couple different scenarios.\n\n320\n00:16:06.690 --> 00:16:12.292\nWhen you lease an IP, right,\nyour MAC address is being tied to that IP.\n\n321\n00:16:12.292 --> 00:16:14.858\nAnd if you're active when\nsomebody does an ARP broadcast,\n\n322\n00:16:14.858 --> 00:16:17.400\nthey find your MAC\naddress tied to that IP.\n\n323\n00:16:17.400 --> 00:16:19.330\nBut what happens when you're offline?\n\n324\n00:16:19.330 --> 00:16:22.060\nIf you're offline and\nsomebody goes looking for\n\n325\n00:16:22.060 --> 00:16:25.720\nyour IP, they're not gonna find your\nMAC address cuz you're not online.\n\n326\n00:16:25.720 --> 00:16:27.960\nIf we turn on static ARP entries,\n\n327\n00:16:27.960 --> 00:16:32.390\nthe firewall is gonna\nremember your MAC address and\n\n328\n00:16:32.390 --> 00:16:36.500\nbe tied to that IP even if you aren't\nonline, even if your lease is not active.\n\n329\n00:16:37.520 --> 00:16:39.900\nNow that's really only useful for\nreservations, and\n\n330\n00:16:39.900 --> 00:16:41.270\nyou'll see the little note here.\n\n331\n00:16:41.270 --> 00:16:44.250\nThis option persists,\neven if DHCP is disabled.\n\n332\n00:16:44.250 --> 00:16:47.460\nOnly the machines listed below will be\nallowed to communicate with the firewall\n\n333\n00:16:47.460 --> 00:16:48.350\non this NIC.\n\n334\n00:16:48.350 --> 00:16:49.332\nIn other words,\n\n335\n00:16:49.332 --> 00:16:53.556\nif we turn this on, only people with\nreservations will be able to talk.\n\n336\n00:16:53.556 --> 00:16:55.230\nThe people without reservations,\n\n337\n00:16:55.230 --> 00:16:57.973\nwe don't their MAC address\nuntil they get a reservation.\n\n338\n00:16:57.973 --> 00:17:00.437\nAnd since we're getting\nstatic ARP entries,\n\n339\n00:17:00.437 --> 00:17:02.341\nthey can't add it to our ARP table.\n\n340\n00:17:02.341 --> 00:17:04.130\nWe won't be able to talk to them.\n\n341\n00:17:04.130 --> 00:17:05.920\nSo you have to be careful with this one.\n\n342\n00:17:05.920 --> 00:17:09.290\nThis would be kind of another level of\nrestricting who's allowed to connect.\n\n343\n00:17:10.780 --> 00:17:15.030\nTime format change, by default DHCP\nis gonna hand out things in UTC, but\n\n344\n00:17:15.030 --> 00:17:18.949\nyou can tell it on our screens to\ndisplay it in local time if we want.\n\n345\n00:17:18.949 --> 00:17:20.384\nAnd that's kind of a nice option,\n\n346\n00:17:20.384 --> 00:17:23.220\nhelps you to kind of better realize\nwhen these leases are gonna end.\n\n347\n00:17:25.000 --> 00:17:26.930\nAll right,\nafter that we get to the advanced options.\n\n348\n00:17:26.930 --> 00:17:28.730\nAnd let's just run\nthrough these real quick.\n\n349\n00:17:28.730 --> 00:17:30.570\nThe first one is Dynamic DNS.\n\n350\n00:17:30.570 --> 00:17:33.740\nAll right, if you've got a DNS server\nthat supports updating the records when\n\n351\n00:17:33.740 --> 00:17:36.650\nsomebody's address changes,\nwe can configure PF Sense to do that.\n\n352\n00:17:36.650 --> 00:17:39.650\nWhen it issues a new address to somebody,\nit can update your DNS Server.\n\n353\n00:17:39.650 --> 00:17:42.310\nIt's useful with like\nMicrosoft Active Directory.\n\n354\n00:17:42.310 --> 00:17:44.629\nMAC Address Control,\nwe can do a MAC filter and\n\n355\n00:17:44.629 --> 00:17:47.795\nlist exactly what MAC addresses\nare allowed to get an address.\n\n356\n00:17:47.795 --> 00:17:51.786\nThis is not a reservation,\njust basically restricting who has access.\n\n357\n00:17:51.786 --> 00:17:54.697\nNTP servers, we wanna hand out\na time server to our clients so\n\n358\n00:17:54.697 --> 00:17:56.194\nthey know who to sync against.\n\n359\n00:17:56.194 --> 00:17:59.800\nTFTP configuration,\nthis is useful for VOIP phones.\n\n360\n00:17:59.800 --> 00:18:03.100\nIf a voice over IP phone gets\na DHCP address, it's looking for\n\n361\n00:18:03.100 --> 00:18:06.170\nat TFTP option to say,\nwhere do I get my config?\n\n362\n00:18:06.170 --> 00:18:07.520\nWhere do I get my firmware?\n\n363\n00:18:07.520 --> 00:18:09.140\nSo it can update itself and configure.\n\n364\n00:18:10.160 --> 00:18:15.050\nLDAP URI, if you're using a lightweight\ndirectory access protocol database,\n\n365\n00:18:15.050 --> 00:18:16.400\nusually for authentication,\n\n366\n00:18:16.400 --> 00:18:20.510\nwe can have a DHCP option that\npoints you to the LDAP server.\n\n367\n00:18:20.510 --> 00:18:23.870\nEnable network booting, right,\nor BOOTP, the boot protocol.\n\n368\n00:18:23.870 --> 00:18:26.610\nIf you've got thin clients\nthat boot up and look for\n\n369\n00:18:26.610 --> 00:18:31.710\ntheir operating system on the network,\nthey look for this DHCP option right here.\n\n370\n00:18:31.710 --> 00:18:35.500\nThese are all well-known DHCP\noptions that you might use.\n\n371\n00:18:35.500 --> 00:18:39.940\nBut you might have custom ones also,\nones that just you need to deal with.\n\n372\n00:18:39.940 --> 00:18:43.880\nAnd so you've got additional BOOTP and\nDHCP options right here.\n\n373\n00:18:43.880 --> 00:18:45.280\nYou can define those.\n\n374\n00:18:45.280 --> 00:18:46.350\nI'm gonna save my settings and\n\n375\n00:18:46.350 --> 00:18:49.510\nthen go into that screen cuz\nI'll lose my changes if I don't.\n\n376\n00:18:49.510 --> 00:18:51.000\nSo let me save that.\n\n377\n00:18:51.000 --> 00:18:53.770\nAnd once it's saved, I'll go into that\nAdvanced screen down there, right here.\n\n378\n00:18:55.000 --> 00:18:58.760\nAnd here,\nwe can add whatever DHCP options we want.\n\n379\n00:18:58.760 --> 00:19:03.440\nSo for example, like that TFTP option up\nthere, it's actually option number 66, and\n\n380\n00:19:03.440 --> 00:19:04.630\nyou can tell it what it is.\n\n381\n00:19:04.630 --> 00:19:06.350\nIt's usually an IP address.\n\n382\n00:19:06.350 --> 00:19:10.201\nAnd so I could say hey, when you boot up\non my network, look for a TFTP server at\n\n383\n00:19:10.201 --> 00:19:14.617\n10.1.10.4, and you'll find your\nfirmware and config files there, right.\n\n384\n00:19:14.617 --> 00:19:15.977\nBut, you can define any other option.\n\n385\n00:19:15.977 --> 00:19:21.790\nThere are literally hundreds of options\nthat are available in standard DHCP.\n\n386\n00:19:21.790 --> 00:19:24.740\nAnd there's even more that\nare out there as far as just\n\n387\n00:19:24.740 --> 00:19:27.080\ncustom ones that you use for\nvarious things.\n\n388\n00:19:27.080 --> 00:19:30.543\nSo I know Wyse thin clients have three or\nfour custom options they use.\n\n389\n00:19:30.543 --> 00:19:34.170\nDifferent vendors use different things,\nbut you can define whatever you want.\n\n390\n00:19:34.170 --> 00:19:37.410\nSet them up in here, and that'll now\nbe handed out with your DHCP server.\n\n391\n00:19:39.230 --> 00:19:43.140\nWhen all that's done,\nyou're now a functioning DHCP server.\n\n392\n00:19:43.140 --> 00:19:46.490\nThe only thing I didn't show\nwere reservations, right?\n\n393\n00:19:46.490 --> 00:19:49.550\nAnd I'll show you how to set up\na reservation here in just a moment.\n\n394\n00:19:49.550 --> 00:19:52.670\nBut what I'm gonna do first is I'm\ngonna take my client here, and\n\n395\n00:19:52.670 --> 00:19:55.477\nI've got a static IP address\nright now on my work station.\n\n396\n00:19:55.477 --> 00:19:57.457\nBut I'm gonna switch over to DHCP.\n\n397\n00:19:57.457 --> 00:20:02.190\nSo let me get into my network\nsettings here for my laptop.\n\n398\n00:20:02.190 --> 00:20:09.230\nI'm going to switch over to DHCP, and\nwe'll see what I get from my DHCP server.\n\n399\n00:20:11.630 --> 00:20:12.187\nThere we go.\n\n400\n00:20:12.187 --> 00:20:15.380\nSo Windows is identifying,\nthat means it's getting its address.\n\n401\n00:20:15.380 --> 00:20:16.330\nI'm not going to wait for that.\n\n402\n00:20:16.330 --> 00:20:20.540\nLet me go to a command prompt instead, and\nwe'll be able to see this a little faster.\n\n403\n00:20:22.990 --> 00:20:28.470\nAll right, and I should have an address\nin the 192.168.0.100 through 150 range.\n\n404\n00:20:28.470 --> 00:20:30.020\nI can see that I do.\n\n405\n00:20:30.020 --> 00:20:34.188\nI got 192.168.0.2 as my default gateway,\nthat's what I wanted.\n\n406\n00:20:34.188 --> 00:20:36.290\nLet's look at a few other things.\n\n407\n00:20:36.290 --> 00:20:37.910\nLet me extend my output here.\n\n408\n00:20:38.920 --> 00:20:41.461\nFor my domain name, I got lab.itpro.tv.\n\n409\n00:20:41.461 --> 00:20:43.300\nRight, we handed that out.\n\n410\n00:20:43.300 --> 00:20:44.370\nLet's see, what else did we get?\n\n411\n00:20:44.370 --> 00:20:46.858\nMy DHCP server is 192.168.0.1.\n\n412\n00:20:46.858 --> 00:20:49.450\nRight, I got all the settings\nfrom the DHCP server.\n\n413\n00:20:49.450 --> 00:20:50.850\n>> And your 24 hour lease.\n\n414\n00:20:50.850 --> 00:20:52.525\n>> Oh, and a 24 hour lease.\n\n415\n00:20:52.525 --> 00:20:54.638\nI think I set some other things,\nbut we won't see them in here.\n\n416\n00:20:54.638 --> 00:20:59.117\nSo, we're working on getting\na DHCP address, all right.\n\n417\n00:20:59.117 --> 00:21:02.642\nNow my machine got .100 today,\nbut if I leave and\n\n418\n00:21:02.642 --> 00:21:05.780\nI come back two days later,\nmy lease expired.\n\n419\n00:21:05.780 --> 00:21:09.630\nSomebody else might have gotten 100,\nand so I might get a different address.\n\n420\n00:21:09.630 --> 00:21:14.130\nSo if I wanna make sure that I get that\nsame address again, well, I need go and\n\n421\n00:21:14.130 --> 00:21:15.970\nconfigure a reservation.\n\n422\n00:21:15.970 --> 00:21:18.460\nSo let me jump back\nover to my web browser.\n\n423\n00:21:20.110 --> 00:21:23.850\nAnd I'm gonna go back up here\nto Services > DHCP server.\n\n424\n00:21:25.180 --> 00:21:26.960\nAnd as you scroll down on this screen,\n\n425\n00:21:26.960 --> 00:21:30.890\nway down on the bottom you'll\nsee DHCP Static Mappings.\n\n426\n00:21:30.890 --> 00:21:35.100\nAnd you can hit the plus sign here,\nand you can add in the MAC address of\n\n427\n00:21:35.100 --> 00:21:40.140\na client, followed by the IP\naddress you want them to have.\n\n428\n00:21:40.140 --> 00:21:42.400\nEverything else on this screen\nis completely optional, but\n\n429\n00:21:42.400 --> 00:21:45.530\nat a minimum MAC address and\nthe IP you want them to have.\n\n430\n00:21:45.530 --> 00:21:46.722\nThe other things you can do?\n\n431\n00:21:46.722 --> 00:21:48.430\nA client identifier.\n\n432\n00:21:48.430 --> 00:21:51.950\nSome DHCP clients will provide\nan identifier when they connect.\n\n433\n00:21:51.950 --> 00:21:53.900\nAnd that's useful if they have\nmore than one network card.\n\n434\n00:21:53.900 --> 00:21:57.690\nYou'll always know it's them, even though\nthey might have more than one MAC address.\n\n435\n00:21:57.690 --> 00:21:58.993\nYou can do a hostname.\n\n436\n00:21:58.993 --> 00:22:01.870\nIf you're doing dynamic DNS,\nthis is what will get registered.\n\n437\n00:22:01.870 --> 00:22:04.970\nIf you don't specify this value, the host\nwill provide it for you, or the client,\n\n438\n00:22:04.970 --> 00:22:06.230\nthe person that's connecting.\n\n439\n00:22:07.820 --> 00:22:10.470\nEverything else, these are all overrides.\n\n440\n00:22:10.470 --> 00:22:14.610\nI can say for this one client, I want\nto override the WINS server or DNS or\n\n441\n00:22:14.610 --> 00:22:15.510\nGateway.\n\n442\n00:22:15.510 --> 00:22:18.740\nYou can override all those\nvalues from what was set\n\n443\n00:22:18.740 --> 00:22:20.340\non the DHCP server as a whole.\n\n444\n00:22:20.340 --> 00:22:22.230\nSo, you've got that kind of flexibility.\n\n445\n00:22:22.230 --> 00:22:26.285\nNow, my problem here is, I don't know my\nMAC address, and I don't want to go and\n\n446\n00:22:26.285 --> 00:22:27.609\ncopy it down or whatever.\n\n447\n00:22:27.609 --> 00:22:32.980\nSo an easier way to do this is\nto go into our Status screen.\n\n448\n00:22:32.980 --> 00:22:38.780\nAnd under Status > DHCP Leases, and you'll\nsee all the active leases on your system.\n\n449\n00:22:38.780 --> 00:22:41.210\nAnd so I can see DPLAPTOP-WIN right there.\n\n450\n00:22:41.210 --> 00:22:42.840\nThat's my Windows machine,\nand I'm connected.\n\n451\n00:22:42.840 --> 00:22:44.110\nI got this MAC address.\n\n452\n00:22:44.110 --> 00:22:46.200\nAnd I can just hit the plus\nsign beside it, and\n\n453\n00:22:46.200 --> 00:22:48.792\nthat'll let me create\na reservation right from there.\n\n454\n00:22:48.792 --> 00:22:50.840\nAnd I didn't have to\ntype the MAC address in.\n\n455\n00:22:50.840 --> 00:22:52.727\nThat's really handy to do.\n\n456\n00:22:52.727 --> 00:22:55.145\nYou've got this Copy my MAC address link,\nbut\n\n457\n00:22:55.145 --> 00:22:57.998\nthat's gonna copy the MAC\nof the computer you're on.\n\n458\n00:22:57.998 --> 00:23:00.959\nYou might be trying to create a lease for\na printer, and so\n\n459\n00:23:00.959 --> 00:23:06.000\nit's easier to go to that Status screen >\nDHCP Leases, and pull it right from there.\n\n460\n00:23:06.000 --> 00:23:08.670\nAnd once it's in there, you can populate\nany of these other values with what you\n\n461\n00:23:08.670 --> 00:23:11.010\nwant, and you can punch in an address.\n\n462\n00:23:11.010 --> 00:23:14.430\nBut be aware of this note right here.\n\n463\n00:23:14.430 --> 00:23:20.650\nIf an IPv4 address is entered, the address\nmust be outside of the pool, all right.\n\n464\n00:23:20.650 --> 00:23:24.030\nSo I can't pick an IP that's in the pool,\nit's gotta be outside of the pool.\n\n465\n00:23:24.030 --> 00:23:26.140\nI'm really extending my pool here.\n\n466\n00:23:26.140 --> 00:23:29.182\nSo if mine went from 100 to 150,\n\n467\n00:23:29.182 --> 00:23:34.617\nI'm gonna give this machine 192.168.0.99,\nright.\n\n468\n00:23:34.617 --> 00:23:37.700\nSo just right before the pool,\nI'll give it this address.\n\n469\n00:23:37.700 --> 00:23:40.640\nI can give you it description and\nany overrides that I wanted.\n\n470\n00:23:40.640 --> 00:23:44.457\nRemember the gateway that I'm\nhanding out is 192.168.0.2.\n\n471\n00:23:44.457 --> 00:23:48.499\nI'm gonna override that to 192.168.0.1.\n\n472\n00:23:48.499 --> 00:23:53.364\nAnd the DNS servers I'm handing\nout were 4.2.2.1 and 4.2.2.2,\n\n473\n00:23:53.364 --> 00:23:56.497\nwhich I saw right here,\nI was getting on my client.\n\n474\n00:23:56.497 --> 00:23:58.879\nSo I'm going to override those.\n\n475\n00:23:58.879 --> 00:24:04.701\nAnd i'll put those in as Googles.\n\n476\n00:24:04.701 --> 00:24:08.347\nSo I'm going to hand those out instead.\n\n477\n00:24:08.347 --> 00:24:10.138\nI'll go ahead and save that.\n\n478\n00:24:10.138 --> 00:24:16.535\nAt this point I've created a lease for\nthe client, a reservation for the client.\n\n479\n00:24:16.535 --> 00:24:23.676\nBut if I take a look at my client,\nI still have 192.168.0.100.\n\n480\n00:24:23.676 --> 00:24:25.357\nIt doesn't update automatically.\n\n481\n00:24:25.357 --> 00:24:26.334\nSo you got two choices.\n\n482\n00:24:26.334 --> 00:24:28.517\nChoice number one, wait for\nthe lease to expire.\n\n483\n00:24:28.517 --> 00:24:32.948\nWithin 24 hours, my client will\nflip over to the new settings, or\n\n484\n00:24:32.948 --> 00:24:35.377\ngo to the client and make it refresh.\n\n485\n00:24:35.377 --> 00:24:37.716\nSo I could do an ipconfig /renew, and\n\n486\n00:24:37.716 --> 00:24:40.859\nthat's gonna make it check\nin with the server, and\n\n487\n00:24:40.859 --> 00:24:44.967\nlet's see I got an error on my\nbluetooth which I think I can ignore.\n\n488\n00:24:44.967 --> 00:24:46.836\nLet's see how the rest of it went.\n\n489\n00:24:46.836 --> 00:24:47.973\nThere we go.\n\n490\n00:24:47.973 --> 00:24:51.793\nAnd sure enough we got 192.168.0.99.\n\n491\n00:24:51.793 --> 00:24:53.988\nMy gateway is back to .1.\n\n492\n00:24:53.988 --> 00:25:01.835\nAnd if we do a /all I am using\nGoogle's DNS severs now.\n\n493\n00:25:01.835 --> 00:25:04.528\nSo setting up a DHC server, really easy.\n\n494\n00:25:04.528 --> 00:25:06.631\nSetting up options,\nnot a big deal there either.\n\n495\n00:25:06.631 --> 00:25:09.127\nSetting up reservations,\nreally pretty easy.\n\n496\n00:25:09.127 --> 00:25:13.252\nDACP in general on the pfSense firewall\nPretty stable, pretty easy to do, and\n\n497\n00:25:13.252 --> 00:25:16.938\nit's a great alternative if you\ndon't have an existing DACP server,\n\n498\n00:25:16.938 --> 00:25:19.520\nyou can leverage pfSense and\nit does a great job.\n\n499\n00:25:19.520 --> 00:25:22.855\n>> Don, in our chatroom there was\na question a little bit earlier\n\n500\n00:25:22.855 --> 00:25:25.111\nthat asked about any security concerns.\n\n501\n00:25:25.111 --> 00:25:27.765\nSo somebody mentioned that there's\na possible denial of service on\n\n502\n00:25:27.765 --> 00:25:28.422\nDHCP normally.\n\n503\n00:25:28.422 --> 00:25:30.001\nDo you have to worry about\nthings like that here?\n\n504\n00:25:30.001 --> 00:25:30.885\n>> Absolutely.\n\n505\n00:25:30.885 --> 00:25:35.395\nIt is a DHCP server, so\na denial of service attack on a DHCP is\n\n506\n00:25:35.395 --> 00:25:40.360\nactually pretty easy for\nany DHCP server, not just pfSense, but\n\n507\n00:25:40.360 --> 00:25:44.621\nMicrosoft or a Linux DHCP server,\nor any of those guys.\n\n508\n00:25:44.621 --> 00:25:49.519\nThe most common attack is what's called a\nDHCP starvation attack, where you can take\n\n509\n00:25:49.519 --> 00:25:53.807\na client and send spoofed DHCP requests\nfrom different Mac addresses, and\n\n510\n00:25:53.807 --> 00:25:56.410\nbasically withdraw the whole pool, right.\n\n511\n00:25:56.410 --> 00:25:59.230\nSo you can take the entire\npool out of a DHCP server.\n\n512\n00:25:59.230 --> 00:26:04.400\nSo my pool here is only 50 addresses,\nso I could fire up a client, send\n\n513\n00:26:04.400 --> 00:26:08.800\nout 50 spoofed requests with 50 different\nMac addresses, and now the pool's empty.\n\n514\n00:26:08.800 --> 00:26:12.390\nRight, so that's the most common\nattack against the DHCP server,\n\n515\n00:26:12.390 --> 00:26:15.830\nand pfSense doesn't have\na great way to prevent that.\n\n516\n00:26:15.830 --> 00:26:18.790\nNeither do any of the other\nones out there, right?\n\n517\n00:26:18.790 --> 00:26:22.300\nThe way to prevent it typically\nis done on your switches.\n\n518\n00:26:22.300 --> 00:26:26.770\nA lot of switches like Cisco switches have\na technology called DHCP snooping, and\n\n519\n00:26:26.770 --> 00:26:31.260\nyou can limit the amount of DHCP requests\nallowed from a single interface, and\n\n520\n00:26:31.260 --> 00:26:33.890\nthat's a really effective way\nof stopping Stopping that.\n\n521\n00:26:33.890 --> 00:26:36.780\nThe reason we don't have a great way\nto protect from it here on the firewall\n\n522\n00:26:36.780 --> 00:26:39.810\nitself is that DHCP is\na broadcast technology.\n\n523\n00:26:39.810 --> 00:26:41.750\nThese are broadcasts coming in.\n\n524\n00:26:41.750 --> 00:26:47.070\nThe firewall has no way of knowing that 50\nrequests just came in from one interface,\n\n525\n00:26:47.070 --> 00:26:49.180\nbecause the interfaces\nare invisible to it.\n\n526\n00:26:49.180 --> 00:26:51.100\nIt just sees these broadcasts come in.\n\n527\n00:26:51.100 --> 00:26:54.491\nThe switch is really the only place\nwhere we can tell all that traffic\n\n528\n00:26:54.491 --> 00:26:55.810\ncame from one interface.\n\n529\n00:26:55.810 --> 00:26:58.803\nSo, if you're worried about\nthose types of attacks,\n\n530\n00:26:58.803 --> 00:27:00.957\nyou'll have to do it from your switch.\n\n531\n00:27:00.957 --> 00:27:05.386\nAs far as attacks form the Internet,\nwell GACP, is a broadcast technology.\n\n532\n00:27:05.386 --> 00:27:08.864\nYour firewall's automatically blocking\nbroadcast from the internet so\n\n533\n00:27:08.864 --> 00:27:11.030\nyou're protected there.\n\n534\n00:27:11.030 --> 00:27:13.990\nBut internal attacks\nare a very real threat and\n\n535\n00:27:13.990 --> 00:27:16.070\nit's just like any other DACP server.\n\n536\n00:27:17.530 --> 00:27:20.390\n>> Alright Don, I think that that's\na lot of material that we covered today.\n\n537\n00:27:20.390 --> 00:27:23.250\nRemember that DHCP is one of the most\nuseful tools that you'll have to be\n\n538\n00:27:23.250 --> 00:27:27.710\nable to manage your network and it can be\nset up on the pfSense firewall for us.\n\n539\n00:27:27.710 --> 00:27:31.930\nSo if you don't have a regular DHCP\nserver already set up, think about and\n\n540\n00:27:31.930 --> 00:27:35.210\nconsider using this as\npart of that technology.\n\n541\n00:27:35.210 --> 00:27:37.451\nBut if there's not anything\nelse that we can add, Don.\n\n542\n00:27:37.451 --> 00:27:38.877\n>> Yeah,\nit's a good place to wrap this one up.\n\n543\n00:27:38.877 --> 00:27:40.898\n>> It's a great place for\nus to wrap this up.\n\n544\n00:27:40.898 --> 00:27:42.697\nSo what we're going to do is wrap it up.\n\n545\n00:27:42.697 --> 00:27:45.379\nAnd stay tuned for more PSN's Firewall.\n\n546\n00:27:45.379 --> 00:27:51.650\n[MUSIC]\n\n",
          "vimeoId": "132253666"
        },
        {
          "description": null,
          "length": "1306",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-2-dns_resolver-060915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-2-dns_resolver-060915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-2-dns_resolver-060915-1-sm.jpg",
          "title": "DNS Resolver",
          "transcript": "WEBVTT\n\n1\n00:00:00.025 --> 00:00:08.210\n[MUSIC]\n\n2\n00:00:08.210 --> 00:00:12.690\nIn this segment, we're gonna take a look\nat the DNS resolver inside of pfSense.\n\n3\n00:00:12.690 --> 00:00:17.640\nThe DNS resolver, kinda hard to say, is a\npretty cool service because what it allows\n\n4\n00:00:17.640 --> 00:00:21.850\nus to do is to use our\nfirewall as a DNS server.\n\n5\n00:00:21.850 --> 00:00:25.180\nNow, you might ask yourself why would I\nwanna use the firewall as a DNS server?\n\n6\n00:00:25.180 --> 00:00:28.870\nIn a normal network,\nwe hand out DNS addresses to our clients.\n\n7\n00:00:28.870 --> 00:00:32.150\nAnd when our clients, a work station,\nlaptop, whatever, when it needs to look up\n\n8\n00:00:32.150 --> 00:00:35.720\na host name it'll go all the way out\nto the internet, and look up that host.\n\n9\n00:00:35.720 --> 00:00:40.060\nSo I wanna go to www.google.com,\nit goes out and it gets that address.\n\n10\n00:00:40.060 --> 00:00:42.337\nWell, it maintains it in its own cache.\n\n11\n00:00:42.337 --> 00:00:45.083\nAnd if it does the lookup for that same\naddress here in a few moments, well,\n\n12\n00:00:45.083 --> 00:00:47.810\nit's already got it in the cache,\nit gets a fast lookup.\n\n13\n00:00:47.810 --> 00:00:51.360\nBut if you have 100 computers,\nthat's 100 separate caches, right?\n\n14\n00:00:51.360 --> 00:00:53.360\nThey're not sharing a cache.\n\n15\n00:00:53.360 --> 00:00:55.920\nBut if we used our\nfirewall as a DNS server,\n\n16\n00:00:55.920 --> 00:00:59.990\nit becomes like a shared communal\ncache amongst all of our systems.\n\n17\n00:00:59.990 --> 00:01:02.310\nSo it gives us a little bit\nof a performance improvement.\n\n18\n00:01:02.310 --> 00:01:05.180\nPeople do a DNS lookup,\nthey throw it against the firewall and\n\n19\n00:01:05.180 --> 00:01:07.520\nthe firewall responds with an answer\nfrom the cache if its got one.\n\n20\n00:01:07.520 --> 00:01:09.580\nOr it goes out to\nthe internet on our behalf.\n\n21\n00:01:09.580 --> 00:01:14.210\nSo it's kind of like a DNS proxy in a way\nsitting in between us and the internet.\n\n22\n00:01:14.210 --> 00:01:16.640\nPfSense actually enables this by default.\n\n23\n00:01:16.640 --> 00:01:20.620\nWhen you install pfSense, it enables\na service called the DNS resolver, and\n\n24\n00:01:20.620 --> 00:01:22.990\nthe firewall is ready to be that entity.\n\n25\n00:01:22.990 --> 00:01:26.770\nTo be that person who answers the DNS\nquestions for our clients on the network.\n\n26\n00:01:26.770 --> 00:01:27.390\nAll right?\n\n27\n00:01:27.390 --> 00:01:29.800\nAnd if you're using DHCP it's\nalready handing that out.\n\n28\n00:01:29.800 --> 00:01:32.980\nIf you're using static IPs, though,\nyou might not have set that, right?\n\n29\n00:01:32.980 --> 00:01:35.670\nSo you might still have other\nDNS servers that are out there.\n\n30\n00:01:35.670 --> 00:01:38.709\nBut we want to show you an example of\nhow to get the DNS resolver setup and\n\n31\n00:01:38.709 --> 00:01:42.540\nI wanna give you kind of a real-world\nexample how we might use this, too.\n\n32\n00:01:42.540 --> 00:01:44.490\nThe caching, that's one benefit, right?\n\n33\n00:01:44.490 --> 00:01:48.432\nBut most of you know, DNS lookups, it's\nnot like they're really substantial, just\n\n34\n00:01:48.432 --> 00:01:52.000\na couple of kilobytes in communication,\nyou know, nothing too crazy there.\n\n35\n00:01:52.000 --> 00:01:55.935\nBut what we might wanna do is we\nmight wanna use a special DNS server,\n\n36\n00:01:55.935 --> 00:02:00.562\nsomething like OpenDNS, where they have\nfiltering to block ads and spyware and\n\n37\n00:02:00.562 --> 00:02:03.440\nviruses and\nall that stuff based on DNS lookups.\n\n38\n00:02:03.440 --> 00:02:07.318\nWell If we set that up on our clients,\nthey can use it and traffic gets blocked.\n\n39\n00:02:07.318 --> 00:02:09.881\nBut a lot kids are smart enough to know or\njust anybody,\n\n40\n00:02:09.881 --> 00:02:13.460\nthat if you want to get around that,\nyou just change your DNS servers.\n\n41\n00:02:13.460 --> 00:02:16.060\nI want to point to different DNS servers,\nnow I can get out to the internet.\n\n42\n00:02:16.060 --> 00:02:17.060\nNo big deal.\n\n43\n00:02:17.060 --> 00:02:19.960\nWell, we can actually lock it down so\n\n44\n00:02:19.960 --> 00:02:22.820\nthat people can only get\nto the firewall for DNS.\n\n45\n00:02:22.820 --> 00:02:27.560\nIt kind of forces them to use OpenDNS or\nDynDNS Guide or\n\n46\n00:02:27.560 --> 00:02:30.020\nwhoever it is that you wanna use for\nfiltering that traffic.\n\n47\n00:02:30.020 --> 00:02:31.470\nIt's a neat way to go about it and ensure,\n\n48\n00:02:31.470 --> 00:02:33.420\nyour systems stay at\nleast moderately safe.\n\n49\n00:02:34.480 --> 00:02:38.018\nAll right, so, I wanna walk you through\nan example of how we get that setup,\n\n50\n00:02:38.018 --> 00:02:40.885\nhow we use it and what kind of,\nyou can expect to go with this.\n\n51\n00:02:40.885 --> 00:02:41.860\nRight?\n\n52\n00:02:41.860 --> 00:02:46.053\nOne caveat I wanna mention before we\nstart, is that in pfSense version 2.2,\n\n53\n00:02:46.053 --> 00:02:48.344\nthere's now two different DNS services.\n\n54\n00:02:48.344 --> 00:02:49.340\nAll right?\n\n55\n00:02:49.340 --> 00:02:51.710\nThere's the DNS Forwarder and\nthe DNS Resolver,\n\n56\n00:02:51.710 --> 00:02:53.340\nlet me show you here on my firewall.\n\n57\n00:02:53.340 --> 00:02:57.020\nIf you're running 2.1.5 or\nearlier, there's only one.\n\n58\n00:02:57.020 --> 00:03:03.146\nIf you go to services, there we go,\nyou'll have a DNS Forwarder and that's it.\n\n59\n00:03:03.146 --> 00:03:06.220\nBut in 2.2 you'll have a DNS Forwarder and\na DNS Resolver, and\n\n60\n00:03:06.220 --> 00:03:09.590\nif you look at their settings,\nby and large, they're identical.\n\n61\n00:03:09.590 --> 00:03:11.660\nThey have the same functionality.\n\n62\n00:03:11.660 --> 00:03:16.710\nWhat's happening is in 2.1.5 and\nearlier we used a service called DNS Mask.\n\n63\n00:03:16.710 --> 00:03:18.240\nDNS Mask has been around a long time.\n\n64\n00:03:18.240 --> 00:03:19.950\nIt's very stable, works great, but\n\n65\n00:03:19.950 --> 00:03:25.195\nin 2.2 and higher they're moving to\na new DNS service called Unbound.\n\n66\n00:03:25.195 --> 00:03:26.565\nAnd so DNS Forwarder.\n\n67\n00:03:26.565 --> 00:03:27.965\nThat's DNS Mask.\n\n68\n00:03:27.965 --> 00:03:29.445\nDNS Resolver.\n\n69\n00:03:29.445 --> 00:03:31.405\nThat is unbound.\n\n70\n00:03:31.405 --> 00:03:33.205\nSo, you can pick which one you wanna use.\n\n71\n00:03:33.205 --> 00:03:34.945\nIf you wanna use\nthe DNS Forwarder you can.\n\n72\n00:03:34.945 --> 00:03:37.770\nIf I jump over to that one,\nI'll see my settings.\n\n73\n00:03:37.770 --> 00:03:38.852\nAnd notice how it's not enabled.\n\n74\n00:03:38.852 --> 00:03:39.830\nAll right.\n\n75\n00:03:39.830 --> 00:03:43.950\nAnd that's because if I jump over\nto DNS Resolver that one is.\n\n76\n00:03:43.950 --> 00:03:45.180\nThey're both running on port 53,\n\n77\n00:03:45.180 --> 00:03:47.950\nso you can't have them both\nrunning at the same time.\n\n78\n00:03:47.950 --> 00:03:50.490\nYou gotta pick one versus the other.\n\n79\n00:03:50.490 --> 00:03:52.670\nWell for this example we use\nthe DNS Resolver, it's the new one.\n\n80\n00:03:52.670 --> 00:03:55.990\nIf you're implementing a new firewall this\nis the one that you're supposed to use.\n\n81\n00:03:55.990 --> 00:03:57.640\nEventually DNS Mask will go away.\n\n82\n00:03:59.150 --> 00:04:00.224\nNow it's on by default.\n\n83\n00:04:00.224 --> 00:04:02.561\nAnd what that means is that\na client can go ahead and\n\n84\n00:04:02.561 --> 00:04:05.410\ndo a lookup against our firewall and\nthey'll get an answer.\n\n85\n00:04:05.410 --> 00:04:07.140\nLet me show you what I mean.\n\n86\n00:04:07.140 --> 00:04:10.929\nIf I drop to a command prompt here and\nI do an nslookup for\n\n87\n00:04:10.929 --> 00:04:14.550\ngoogle.com I can send that\nout to a public DNS server.\n\n88\n00:04:14.550 --> 00:04:17.040\nRight?\nLike this is GTE or\n\n89\n00:04:17.040 --> 00:04:19.670\nLevel 3 or whoever's,\nand I get a response.\n\n90\n00:04:19.670 --> 00:04:23.440\nOr I can do the lookup against Google's\nDNS servers, and I get a response, right?\n\n91\n00:04:23.440 --> 00:04:25.490\nI'm going out to the internet,\nand getting that answer.\n\n92\n00:04:26.570 --> 00:04:27.710\nOr, I can point it to the firewall.\n\n93\n00:04:29.120 --> 00:04:32.670\nAnd when I point it to the firewall,\nI'm gonna ask the firewall, and\n\n94\n00:04:32.670 --> 00:04:33.800\nit gives me an answer.\n\n95\n00:04:33.800 --> 00:04:34.680\nSee the server?\n\n96\n00:04:34.680 --> 00:04:37.080\nThat server right there,\nit is that firewall.\n\n97\n00:04:37.080 --> 00:04:38.440\nThat's who responded.\n\n98\n00:04:38.440 --> 00:04:40.570\nAnd now I get out, all right?\n\n99\n00:04:40.570 --> 00:04:42.020\nHow did it get the answer?\n\n100\n00:04:42.020 --> 00:04:45.490\nWell, when you ran the initial setup for\nthe firewall, you picked DNS server.\n\n101\n00:04:45.490 --> 00:04:47.470\nYou really might have left it blank,\nright?\n\n102\n00:04:47.470 --> 00:04:49.680\nLet me show you.\nIf I go back here in my firewall, and\n\n103\n00:04:49.680 --> 00:04:54.680\nI go to system and general,\nwe'll see right here the DNS Servers.\n\n104\n00:04:54.680 --> 00:04:57.560\nNow, when I set my firewall up\nit asked for DNS servers and\n\n105\n00:04:57.560 --> 00:05:01.930\nmaybe you put in Google's DNS servers,\nmaybe you put in something else.\n\n106\n00:05:01.930 --> 00:05:04.510\nBut, whatever it is you\nwanted you put there.\n\n107\n00:05:04.510 --> 00:05:06.180\nOr, maybe you left it blank.\n\n108\n00:05:06.180 --> 00:05:09.970\nThe other place that we can get DNS\nsettings from, is from our interface.\n\n109\n00:05:09.970 --> 00:05:14.002\nIf your interface, like if I go to\nmy WAN interface, if it's set for\n\n110\n00:05:14.002 --> 00:05:17.190\nDHCP, then you get DNS\nservers from that provider,\n\n111\n00:05:17.190 --> 00:05:19.490\nand then that's what you're\nusing to do your lookups.\n\n112\n00:05:19.490 --> 00:05:21.960\nSo that's what your firewall's using\nby default is one of those two things.\n\n113\n00:05:23.040 --> 00:05:25.980\nWell, if I wanna force\neverybody to use OpenDNS,\n\n114\n00:05:25.980 --> 00:05:30.810\nthen I want them to go through my firewall\nand those are the ones that I wanna use.\n\n115\n00:05:30.810 --> 00:05:34.760\nSo if I go back to system and\ngeneral, right in here,\n\n116\n00:05:34.760 --> 00:05:36.580\nI can hard code my DNS servers.\n\n117\n00:05:36.580 --> 00:05:39.670\nSo that's what I've put, these are the two\nfilter servers that OpenDNS uses.\n\n118\n00:05:39.670 --> 00:05:42.560\nSo I put those in, and\nthen right down here,\n\n119\n00:05:42.560 --> 00:05:46.310\nyou've got this, Allow DNS Server List\nto be overridden by DHCP.\n\n120\n00:05:46.310 --> 00:05:49.210\nWe need to make sure that's not checked.\n\n121\n00:05:49.210 --> 00:05:51.710\nWe don't want our DHCP settings\noverriding what we've got here.\n\n122\n00:05:51.710 --> 00:05:55.570\nSo now, this is who my firewall\nis going to do a lookup against.\n\n123\n00:05:55.570 --> 00:06:01.190\nWhen I do a lookup against my public\nservers I'll get one set of responses.\n\n124\n00:06:01.190 --> 00:06:04.050\nWhen I do a lookup against this firewall,\nit'll turn around and\n\n125\n00:06:04.050 --> 00:06:05.460\nreach out to these guys and\ngive me another set.\n\n126\n00:06:06.810 --> 00:06:08.740\nWell, there is one more little\nsetting that we have to do.\n\n127\n00:06:09.900 --> 00:06:15.500\nIf I go back up into my services and\nDNS resolver.\n\n128\n00:06:16.830 --> 00:06:19.900\nRight in here,\nyou'll see the resolver is turned on, but\n\n129\n00:06:19.900 --> 00:06:24.240\nthen there's this enable forwarding mode,\nand that's not turned on.\n\n130\n00:06:24.240 --> 00:06:28.190\nWhat that means is that if my server\ndoesn't know the answer, it's not going to\n\n131\n00:06:28.190 --> 00:06:30.660\nforward to somebody else, it's going\nto go out to the root hint servers.\n\n132\n00:06:30.660 --> 00:06:33.100\nIt's going to go out there and look for\nthat result there, and try and\n\n133\n00:06:33.100 --> 00:06:34.630\nfind it itself.\n\n134\n00:06:34.630 --> 00:06:35.230\nBut I don't want that.\n\n135\n00:06:35.230 --> 00:06:37.400\nI want it to forward to OpenDNS.\n\n136\n00:06:37.400 --> 00:06:39.580\nThat way they can filter and all that.\n\n137\n00:06:39.580 --> 00:06:41.480\nSo I need to turn on forwarding mode.\n\n138\n00:06:41.480 --> 00:06:45.940\nBut I've gotta be careful here because not\nevery forwarding server supports DNS Sec.\n\n139\n00:06:45.940 --> 00:06:48.920\nAnd I've got that turned on, so that's\ngonna cause me some little problems and\n\n140\n00:06:48.920 --> 00:06:50.130\nbreak things.\n\n141\n00:06:50.130 --> 00:06:51.828\nSo I'm gonna turn that option off.\n\n142\n00:06:51.828 --> 00:06:55.870\nI don't necessarily need that for DNS Sec\nanyway, because I'm not pushing changes.\n\n143\n00:06:55.870 --> 00:06:57.820\nSo I'll go ahead and have that set.\n\n144\n00:06:57.820 --> 00:07:02.620\nNow, anybody who doesn't look up against\nmy firewall, I'll then turn around and\n\n145\n00:07:02.620 --> 00:07:04.860\nforward that out to OpenDNS.\n\n146\n00:07:04.860 --> 00:07:09.620\nI'm going to come down here and\nsave that, and we'll have it in place.\n\n147\n00:07:09.620 --> 00:07:12.380\nAnd now,\nthose lookups will pass right through.\n\n148\n00:07:12.380 --> 00:07:16.510\nNow, if I jump over to, well I'll\nuse my client here as an example.\n\n149\n00:07:16.510 --> 00:07:21.310\nSo, on my client, I'm just going to\nopen up my network settings here.\n\n150\n00:07:22.370 --> 00:07:24.950\nAnd this is something that a lot\nof end-users could do if they had\n\n151\n00:07:24.950 --> 00:07:25.750\nadministrative access.\n\n152\n00:07:25.750 --> 00:07:28.040\nThis is come in and\nchange their DNS servers.\n\n153\n00:07:28.040 --> 00:07:30.930\nI'm going to come in and\nhard-set my DNS servers to,\n\n154\n00:07:30.930 --> 00:07:33.100\nI'll just use one of Google's, all right?\n\n155\n00:07:33.100 --> 00:07:33.960\nSo I'm going to provide Google's.\n\n156\n00:07:35.190 --> 00:07:38.340\nAnd when I go and\nstart browsing out to the internet.\n\n157\n00:07:39.860 --> 00:07:41.200\nWatch what happens.\n\n158\n00:07:41.200 --> 00:07:43.140\nSo, if I take this and I browse to.\n\n159\n00:07:43.140 --> 00:07:47.750\nWe'll go to the OpenDNS setup guide.\n\n160\n00:07:47.750 --> 00:07:50.160\nNotice how it says, I'm not using OpenDNS.\n\n161\n00:07:50.160 --> 00:07:51.695\nIt's cuz I did look up against Google.\n\n162\n00:07:51.695 --> 00:07:57.058\nOr, if I browse to their welcome page,\nit's gonna tell me I'm not using OpenDNS.\n\n163\n00:07:57.058 --> 00:07:59.472\nOr, if I browse to a bad page.\n\n164\n00:07:59.472 --> 00:08:00.413\ninternetbadguys.com.\n\n165\n00:08:00.413 --> 00:08:02.433\n[LAUGH] I get to the site.\n\n166\n00:08:02.433 --> 00:08:05.715\nThis should have been blocked, all right,\nso I know I'm not using OpenDNS.\n\n167\n00:08:07.480 --> 00:08:12.850\nBut if I change my DNS settings and\nI put them to use the firewall.\n\n168\n00:08:14.060 --> 00:08:16.770\nAnd I'm handing this out with DHCP's so\nI could just go back to that, but\n\n169\n00:08:16.770 --> 00:08:19.090\nI'll manually type it in just\nto make sure that we know for\n\n170\n00:08:19.090 --> 00:08:20.970\na fact we are going to the firewall.\n\n171\n00:08:20.970 --> 00:08:22.840\nI'm gonna change that to\nthe IP address on my firewall.\n\n172\n00:08:24.080 --> 00:08:28.750\nNow, my lookups are gonna go to\nthe firewall, the firewall's gonna forward\n\n173\n00:08:28.750 --> 00:08:36.130\nthem up to OpenDNS, and OpenDNS will\nrespond back with my filtered replies.\n\n174\n00:08:36.130 --> 00:08:39.210\nSo if I repeat some of this, and\nI'm gonna close Internet Explorer.\n\n175\n00:08:39.210 --> 00:08:42.320\nInternet Explorer can be a little bit\nflaky sometimes about caching things.\n\n176\n00:08:42.320 --> 00:08:48.980\nSo, I'm gonna just do a quick\nipconfig /flushdns, there we go.\n\n177\n00:08:48.980 --> 00:08:52.130\nAnd now we'll try this test again.\n\n178\n00:08:52.130 --> 00:08:55.780\nSo this time I'm gonna browse\nto my OpenDNS setup guide, and\n\n179\n00:08:55.780 --> 00:08:58.420\nwhat I should see, there, success.\n\n180\n00:08:58.420 --> 00:08:59.070\nI'm being filtered.\n\n181\n00:08:59.070 --> 00:09:01.890\nNow, I'm not set to use OpenDNS,\nI'm set to use my firewall.\n\n182\n00:09:02.950 --> 00:09:05.720\nBut my firewall is set to use OpenDNS.\n\n183\n00:09:05.720 --> 00:09:09.140\nAnd then I could go and choose some\nof these other test sites here, and\n\n184\n00:09:09.140 --> 00:09:11.540\nwe should see, yep, we are using OpenDNS.\n\n185\n00:09:11.540 --> 00:09:13.430\nAnd if I go to internetbadguys.com,\n\n186\n00:09:13.430 --> 00:09:17.880\nI get that it's been blocked due\nto a phishing threat, right.\n\n187\n00:09:17.880 --> 00:09:20.170\nSo I can see that that's now working.\n\n188\n00:09:20.170 --> 00:09:23.070\nBut out in TV land you guys are probably\nthinking this right now, you're like,\n\n189\n00:09:23.070 --> 00:09:26.320\nwell, can't they just change their DNS\nto something else and they'll get out?\n\n190\n00:09:26.320 --> 00:09:27.960\nYes they can, absolutely.\n\n191\n00:09:27.960 --> 00:09:31.780\nIf I drop to a command prompt,\nI can still do nslookups,\n\n192\n00:09:31.780 --> 00:09:33.430\nI can do them through my server.\n\n193\n00:09:33.430 --> 00:09:39.540\nSo if I do, welcome.opendns.com.\n\n194\n00:09:39.540 --> 00:09:40.090\nRight?\n\n195\n00:09:40.090 --> 00:09:44.450\nIf I just do that look up,\nthat's looking up through the firewall.\n\n196\n00:09:44.450 --> 00:09:46.370\nSee how I got that same response?\n\n197\n00:09:46.370 --> 00:09:49.330\nBut, if I punch that and go to Google.\n\n198\n00:09:49.330 --> 00:09:53.000\nSee how I got a different IP address?\n\n199\n00:09:53.000 --> 00:09:54.680\nGoing through Google I got one IP address,\n\n200\n00:09:54.680 --> 00:09:56.440\ngoing through OpenDNS I\ngot a different one.\n\n201\n00:09:56.440 --> 00:09:58.890\nI'm still able to go around it,\nI can bypass that filter.\n\n202\n00:10:00.110 --> 00:10:04.340\nSo, the next step is to go in and say, I'm\ngonna prohibit people from going out and\n\n203\n00:10:04.340 --> 00:10:06.760\ndoing DNS lookups against other servers.\n\n204\n00:10:06.760 --> 00:10:10.450\nSo, we can throw in a couple of quick\nfirewall rules to knock that out, and\n\n205\n00:10:10.450 --> 00:10:13.610\nnow we ensure that people in our network\nare going through safe DNS lookups.\n\n206\n00:10:13.610 --> 00:10:17.280\nSo let's take a look at those rules.\n\n207\n00:10:17.280 --> 00:10:18.940\nI'm gonna log back into my firewall.\n\n208\n00:10:20.690 --> 00:10:21.670\nAnd we'll get that set.\n\n209\n00:10:24.080 --> 00:10:27.110\n>> Now, Don, are we gonna end up\nhaving to do this on the LAN tab or\n\n210\n00:10:27.110 --> 00:10:28.910\non the WAN tab as we set this up?\n\n211\n00:10:28.910 --> 00:10:30.320\n>> Yeah,\nthis is gonna be a LAN one, right,\n\n212\n00:10:30.320 --> 00:10:33.510\nwhere we're filtering our own clients,\nour clients as they go out.\n\n213\n00:10:33.510 --> 00:10:36.400\nBasically what I want to do is I want\nto allow our own clients to get to\n\n214\n00:10:36.400 --> 00:10:41.090\nthe firewall for DNS lookups, I don't want\nthem to go anywhere else for DNS lookups.\n\n215\n00:10:41.090 --> 00:10:42.740\nSo I'm gonna add two rules.\n\n216\n00:10:42.740 --> 00:10:44.530\nI'm gonna jump over to this LAN tab, and\n\n217\n00:10:44.530 --> 00:10:47.320\non the LAN side,\nby default we allow everything, right?\n\n218\n00:10:47.320 --> 00:10:50.050\nThat's the default rules, IPv4,\n\n219\n00:10:50.050 --> 00:10:55.120\nIPv6, from our LAN network to anywhere\nelse, is allowed, that one's fired up.\n\n220\n00:10:55.120 --> 00:10:56.952\n>> And that one's gonna be there.\n\n221\n00:10:56.952 --> 00:11:00.720\nSo then what I can do,\nis I can insert a new rule.\n\n222\n00:11:02.360 --> 00:11:06.010\nAnd on this rule,\nwhat I'm going to do is a pass rule.\n\n223\n00:11:06.010 --> 00:11:10.230\nI'm going to allow DS\nlookups against my firewall.\n\n224\n00:11:10.230 --> 00:11:13.010\nSo, down here on the interface,\nit's the LAN.\n\n225\n00:11:13.010 --> 00:11:18.370\nThe TCP/IP version is IPv4,\nthe protocol is UDP, right.\n\n226\n00:11:18.370 --> 00:11:19.900\nDNS uses UDP 53.\n\n227\n00:11:19.900 --> 00:11:24.710\nThe source I don't truly care about\nsince it's on the LAN interface, but\n\n228\n00:11:24.710 --> 00:11:28.420\nI could hard set that as LAN net\nif I wanted to, or whatever.\n\n229\n00:11:28.420 --> 00:11:31.030\nI'll leave it at any though,\ncuz it's on my interface anyway.\n\n230\n00:11:31.030 --> 00:11:33.630\nThat's the only traffic that's\ngonna come in on that interface.\n\n231\n00:11:33.630 --> 00:11:38.470\nFor the destination, though, I'm gonna\nset this to LAN address that means,\n\n232\n00:11:38.470 --> 00:11:42.600\nwhatever IP address is assigned to\nthe LAN interface of this firewall.\n\n233\n00:11:43.660 --> 00:11:46.310\nAnd then for\nthe port range I'm going to choose DNS.\n\n234\n00:11:47.380 --> 00:11:51.590\nI'm allowing DNS lookups against\nthe IP address of this firewall.\n\n235\n00:11:51.590 --> 00:11:52.600\nAnd I'll go ahead and save that.\n\n236\n00:11:54.480 --> 00:11:56.440\nAnd so now I've got that rule right here.\n\n237\n00:11:56.440 --> 00:11:58.290\nNow, it's not where I\nwant it to be in my list.\n\n238\n00:11:58.290 --> 00:12:00.320\nI need to move it up and\nyou'll see here why in a minute.\n\n239\n00:12:00.320 --> 00:12:03.070\nBut for right now I'm gonna just\nuse my little arrows and move that.\n\n240\n00:12:03.070 --> 00:12:04.500\nSo it's above my permit rules.\n\n241\n00:12:05.960 --> 00:12:10.870\nThe reason I wanted to move it up is I\nneed a deny rule immediately after this.\n\n242\n00:12:10.870 --> 00:12:14.020\nSo I'm gonna take that\nrule that I just made, and\n\n243\n00:12:14.020 --> 00:12:18.940\nI'll use the clone rule button, and\nI'm gonna change this clone a little bit.\n\n244\n00:12:18.940 --> 00:12:22.600\nI'm gonna do a reject, instead of a pass.\n\n245\n00:12:22.600 --> 00:12:23.980\nI'm blocking traffic this time.\n\n246\n00:12:25.090 --> 00:12:28.800\nAnd then down here,\nI'm gonna say UDP port 53,\n\n247\n00:12:28.800 --> 00:12:33.020\nbut for that destination address,\ninstead of LAN, I'm gonna choose Any.\n\n248\n00:12:33.020 --> 00:12:38.490\nI'm denying DNS lookups against anybody\nelse other than this firewall, right.\n\n249\n00:12:38.490 --> 00:12:41.750\nThat's the only one that we\nallowed a moment ago, all right.\n\n250\n00:12:41.750 --> 00:12:42.810\nSo, I'll go ahead and save that.\n\n251\n00:12:43.940 --> 00:12:46.800\nAnd now, when I look at my rules,\nif I read them in order.\n\n252\n00:12:46.800 --> 00:12:51.730\nYou see clients are allowed to do UDP53\nagainst the LAN address of the firewall\n\n253\n00:12:51.730 --> 00:12:56.170\nand then they're rejected\nUDP53 against anybody else.\n\n254\n00:12:56.170 --> 00:12:58.140\nThat's gonna lock them into only\nbeing able to use the firewall.\n\n255\n00:12:59.350 --> 00:13:02.310\nAnd then the firewall set\nup as a DHCP server so\n\n256\n00:13:02.310 --> 00:13:05.650\nit's handing out IPs on my network,\nand when it does that,\n\n257\n00:13:05.650 --> 00:13:10.470\nit's handing out itself as the DNS server,\nso people are automatically configuring.\n\n258\n00:13:10.470 --> 00:13:13.190\nBut if they try and override it,\nit's not gonna work.\n\n259\n00:13:13.190 --> 00:13:13.830\nAll right?\n\n260\n00:13:13.830 --> 00:13:15.360\nAnd we can test that out real quick too.\n\n261\n00:13:15.360 --> 00:13:19.000\nIf I take my command prompt, I can\nuse those same tests I've been doing.\n\n262\n00:13:19.000 --> 00:13:26.280\nIf I do an nslookup for\ngoogle.com against my firewall, right?\n\n263\n00:13:26.280 --> 00:13:29.060\nI'm allowing that, the lookup happens.\n\n264\n00:13:29.060 --> 00:13:34.390\nBut if I try and send it to somebody else,\nlike we'll do GTE.\n\n265\n00:13:34.390 --> 00:13:37.780\nWe'll throw it out there and it times out.\n\n266\n00:13:37.780 --> 00:13:39.420\nIt can't get to that server, right.\n\n267\n00:13:39.420 --> 00:13:41.590\nI can't bypass the firewall anymore.\n\n268\n00:13:41.590 --> 00:13:44.140\nThe only DNS server I'm\nallowed to communicate with\n\n269\n00:13:44.140 --> 00:13:46.190\nis the one right here on my network.\n\n270\n00:13:46.190 --> 00:13:51.120\nSo great way to kind of lock that in and\nwe could try other ones too and\n\n271\n00:13:51.120 --> 00:13:53.270\nget that in place and\nyou'll see it's locked out.\n\n272\n00:13:53.270 --> 00:13:55.230\nSo easy way to go in here and\n\n273\n00:13:55.230 --> 00:13:59.370\nsay let's use the firewall, let's do the\nfiltering, and now people get protected.\n\n274\n00:14:01.160 --> 00:14:04.440\nNow you might be thinking\nin the background, gee Don,\n\n275\n00:14:04.440 --> 00:14:06.745\nthat's all well and good, right.\n\n276\n00:14:06.745 --> 00:14:09.720\nIt'd be nice to use the firewall as\nthe DNS server for this kind of stuff.\n\n277\n00:14:09.720 --> 00:14:15.910\nBut, in my company I've got a LDAP\nDirectory or a Microsoft Active Directory.\n\n278\n00:14:15.910 --> 00:14:18.990\nAnd I need DNS lookups to go\nagainst that server first and\n\n279\n00:14:18.990 --> 00:14:21.930\nfind information about my directory, or\notherwise people won't be able to log in.\n\n280\n00:14:22.980 --> 00:14:26.510\nWell there's a cool feature\ninside of the DNS resolver.\n\n281\n00:14:26.510 --> 00:14:31.460\nIf I go up here to my\nServices > DNS resolver,\n\n282\n00:14:31.460 --> 00:14:34.720\nwe can scroll down and\nyou know you see all these basic\n\n283\n00:14:34.720 --> 00:14:37.900\noptions in here most of which we\ndon't need to mess with too much.\n\n284\n00:14:37.900 --> 00:14:42.840\nBut as you keep going down you'll see\npost overrides and domain overrides.\n\n285\n00:14:42.840 --> 00:14:46.090\nThis is where I can override\nall sorts of stuff.\n\n286\n00:14:46.090 --> 00:14:47.740\nI can create custom hosts entries,\n\n287\n00:14:47.740 --> 00:14:51.500\nlike maybe I have a web server that's\nout there at a particular entry.\n\n288\n00:14:51.500 --> 00:14:59.022\nSo I could add an entry here, and I could\nadd a host for www.amazon.com right?\n\n289\n00:14:59.022 --> 00:15:02.820\nAnd you know normally if I were to go\nto amazon.com what am I gonna get?\n\n290\n00:15:02.820 --> 00:15:06.630\nI'm gonna get their home page,\nI'm gonna see their shopping stuff or\n\n291\n00:15:06.630 --> 00:15:10.840\nwhatever, but I can override\nthat on an individual basis.\n\n292\n00:15:10.840 --> 00:15:15.470\nI can just say, amazon.com is gonna be,\nwell, sorry, I need to enter it in\n\n293\n00:15:15.470 --> 00:15:20.230\nas www there, and amazon.com here, kind of\nbreak it up between the host and domain.\n\n294\n00:15:20.230 --> 00:15:23.050\nAnd then I can put in an IP address.\n\n295\n00:15:23.050 --> 00:15:26.410\nAnd I've got a server floating\naround here, let's use this server.\n\n296\n00:15:26.410 --> 00:15:30.070\nI'm gonna redirect that over to\nthis server, because why not.\n\n297\n00:15:30.070 --> 00:15:35.331\nSo, this is 209.251.159.185.185 so\n\n298\n00:15:35.331 --> 00:15:38.707\n209.251.159.185.\n\n299\n00:15:38.707 --> 00:15:43.440\nSo, I'm gonna redirect that and\nhave it go to my server instead.\n\n300\n00:15:43.440 --> 00:15:48.070\nI'm overriding whatever DNS lookup\nwould've normally happened for Amazon.\n\n301\n00:15:48.070 --> 00:15:49.780\nAnd if I had aliases I\ncould stick them in there,\n\n302\n00:15:49.780 --> 00:15:53.130\nbut here it's just gonna be that\nIP address, so I'll save that.\n\n303\n00:15:53.130 --> 00:15:57.370\nAll right, so now I've got one host\nover it, I could start to add more.\n\n304\n00:15:57.370 --> 00:15:58.975\nOr if I had an Active Directory,\n\n305\n00:15:58.975 --> 00:16:01.537\nI probably wanna redirect\nthat entire directory.\n\n306\n00:16:01.537 --> 00:16:04.498\nSo maybe I've got an Active Directory for\nlab.itpro.tv.\n\n307\n00:16:04.498 --> 00:16:06.553\nI can come here and I can add that.\n\n308\n00:16:06.553 --> 00:16:10.825\nAnd I can say any time I get a lookup for\na lab.itpro.tv,\n\n309\n00:16:10.825 --> 00:16:16.432\nthat whole domain, anything under it,\nright, dc1.lab.itpro.tv or\n\n310\n00:16:16.432 --> 00:16:21.680\nwhatever, anything I get,\nsend that to a different server.\n\n311\n00:16:21.680 --> 00:16:24.740\nSend that to this other server and\nlet that one do the resolve.\n\n312\n00:16:24.740 --> 00:16:28.190\nDon't forward it along to OpenDNS\nbecause this is internal anyway.\n\n313\n00:16:28.190 --> 00:16:31.100\nSo we can point it right over here and\nhave that in place,\n\n314\n00:16:31.100 --> 00:16:33.670\nand now, when those DNS lookups come,\n\n315\n00:16:33.670 --> 00:16:37.340\nin the one that was a host override,\nwe'll just resolve that right here.\n\n316\n00:16:37.340 --> 00:16:38.430\nI've got the name and IP.\n\n317\n00:16:38.430 --> 00:16:40.430\nIt will knock it out.\n\n318\n00:16:40.430 --> 00:16:45.260\nBut then for the one that was a domain\noverride we'll forward that entire domain.\n\n319\n00:16:45.260 --> 00:16:48.800\nWell, I guess I've got some screen\nartifacting going on there.\n\n320\n00:16:48.800 --> 00:16:50.520\nLet me reload this page.\n\n321\n00:16:50.520 --> 00:16:52.410\nThere we go.\n\n322\n00:16:52.410 --> 00:16:55.250\nSo that's gonna come up and\nthere's my overrides right there.\n\n323\n00:16:55.250 --> 00:17:00.160\nSo now we've got that basic functionality\nto redirect these to where we want to go.\n\n324\n00:17:00.160 --> 00:17:05.083\nAnd if I open up a tab,\nif I go to amazon.com, right, well,\n\n325\n00:17:05.083 --> 00:17:09.810\nit gets overridden and\nit's being sent to my server.\n\n326\n00:17:09.810 --> 00:17:11.890\nAnd my server is saying hey,\nI'm amazon.com,\n\n327\n00:17:11.890 --> 00:17:15.510\ncuz that's how I have my server set up,\nbut that's not the actual Amazon homepage.\n\n328\n00:17:15.510 --> 00:17:17.200\nI'm overriding that lookup.\n\n329\n00:17:17.200 --> 00:17:21.430\nThat's part of the power that we get,\nwhen we use that firewall, we use the DNS\n\n330\n00:17:21.430 --> 00:17:25.342\nunbound service to be able to do this\nstuff, so it's pretty, pretty neat stuff.\n\n331\n00:17:25.342 --> 00:17:28.990\n>> Now Don, when we set up the firewall\nrules to help us to limit ourselves\n\n332\n00:17:28.990 --> 00:17:33.010\nto DNS, in our chatroom we had\na question about can we simplify that\n\n333\n00:17:33.010 --> 00:17:36.996\nrule a little bit better instead by\nmarking that box that says not, and\n\n334\n00:17:36.996 --> 00:17:41.968\nso essentially saying let's block\neverything that's not our own DNS server?\n\n335\n00:17:41.968 --> 00:17:43.910\nWould that be another option?\n\n336\n00:17:43.910 --> 00:17:44.460\n>> We could.\n\n337\n00:17:44.460 --> 00:17:45.920\nI haven't done it that way.\n\n338\n00:17:45.920 --> 00:17:48.190\nI don't see any reason why we couldn't,\nthough.\n\n339\n00:17:48.190 --> 00:17:52.600\nBasically, you'd be saying that it\nwas not the LAN interface here,\n\n340\n00:17:52.600 --> 00:17:54.495\nlet's take this rule and\nwe'll give it shot.\n\n341\n00:17:54.495 --> 00:17:56.320\nEasy way to find out, right?\n\n342\n00:17:56.320 --> 00:18:00.850\nSo, right now what we're doing is we're\npassing traffic for this one network.\n\n343\n00:18:00.850 --> 00:18:02.890\nActually, let's do the deny rule, right?\n\n344\n00:18:02.890 --> 00:18:05.170\nSo let's go back out to that other rule.\n\n345\n00:18:05.170 --> 00:18:09.030\nI guess I could change that one, but\nwhatever, we'll just do this the hard way.\n\n346\n00:18:09.030 --> 00:18:12.330\nSo I'm gonna go edit this one that's\ndenying that 53 traffic everywhere.\n\n347\n00:18:12.330 --> 00:18:17.030\nAnd if we take this one so\nit's rejecting traffic, and under\n\n348\n00:18:17.030 --> 00:18:22.040\nthe destination where I left it at any,\nwhat, was it David that was suggesting it?\n\n349\n00:18:22.040 --> 00:18:26.370\nWe could come in here, and we could say,\nwe're not gonna block traffic.\n\n350\n00:18:26.370 --> 00:18:29.290\nSo traffic,\nwhen the destination is not, and\n\n351\n00:18:29.290 --> 00:18:33.050\nthen I'll set that to the LAN address,\nright?\n\n352\n00:18:33.050 --> 00:18:35.910\nSo if it's destined for\nthat one, we'll block it, or\n\n353\n00:18:35.910 --> 00:18:39.000\nif it's not destined for\nthat one, we'll block it.\n\n354\n00:18:39.000 --> 00:18:41.940\nAnd then if that's the case, we should\nbe able to get rid of this other rule,\n\n355\n00:18:41.940 --> 00:18:44.790\nwhich I'll just disable or\ndelete it outright.\n\n356\n00:18:44.790 --> 00:18:47.940\nI'll delete it outright, that we don't\nhave to worry about it floating around.\n\n357\n00:18:47.940 --> 00:18:50.610\nSo now we've just got that one rule,\nif it's not destined for\n\n358\n00:18:50.610 --> 00:18:53.100\nthis guy then we're gonna block it.\n\n359\n00:18:53.100 --> 00:18:54.260\nAnd we'll apply that and let's see.\n\n360\n00:18:54.260 --> 00:18:56.340\nMaybe we'll get this all done in one rule.\n\n361\n00:18:56.340 --> 00:18:59.390\nHey, a smaller filtering table is\na more efficient filtering table, so\n\n362\n00:18:59.390 --> 00:19:01.480\nany time you can save a line you should.\n\n363\n00:19:01.480 --> 00:19:08.980\nAll right so if I do a look up for, let's\npick another site, we'll do slashdot.org.\n\n364\n00:19:08.980 --> 00:19:11.770\nAnd we'll look that up\nagainst the firewall, right?\n\n365\n00:19:11.770 --> 00:19:12.550\nThat should be allowed.\n\n366\n00:19:14.220 --> 00:19:15.060\nAnd, you know, I stuck a www.\n\n367\n00:19:15.060 --> 00:19:18.860\nI don't think it likes that,\nso let's get rid of\n\n368\n00:19:20.520 --> 00:19:24.710\nthat and no, it's not taking that.\n\n369\n00:19:24.710 --> 00:19:26.310\nSo let me double-check the rules here.\n\n370\n00:19:26.310 --> 00:19:31.620\nSo, we've got if it's UDP 53 not\ndestined for the LAN address,\n\n371\n00:19:31.620 --> 00:19:35.770\nthen it should be rejected, and\nthese catch-alls should get it.\n\n372\n00:19:35.770 --> 00:19:38.660\nThat should capture it.\n\n373\n00:19:38.660 --> 00:19:43.470\n>> I think we did get a result at the end\nthere, I believe, if you check the end?\n\n374\n00:19:43.470 --> 00:19:44.680\n>> Oh, we did!\n\n375\n00:19:44.680 --> 00:19:46.910\n>> It just took a while,\nbut it did happen.\n\n376\n00:19:46.910 --> 00:19:48.084\n>> I wonder.\n>> [LAUGH]\n\n377\n00:19:48.084 --> 00:19:49.730\n>> I wonder what happened there.\n\n378\n00:19:49.730 --> 00:19:52.580\nYeah.\nIt certainly seemed.\n\n379\n00:19:52.580 --> 00:19:57.490\nOh, it went faster that time, so\nlet's try and bypass it now, and\n\n380\n00:19:57.490 --> 00:20:01.590\nif we bypass that one, that should\ntimeout, that should just fail.\n\n381\n00:20:01.590 --> 00:20:06.160\nSo yep,\nnow we're getting timeouts on it and well,\n\n382\n00:20:06.160 --> 00:20:08.090\nhopefully it will really\ntimeout this time.\n\n383\n00:20:08.090 --> 00:20:11.550\nMaybe it just is taking a little while for\nthat table to update.\n\n384\n00:20:11.550 --> 00:20:15.105\nIn the background there is a service,\nlike if we go and\n\n385\n00:20:15.105 --> 00:20:20.482\ntake a look at like our diagnostics and\nDNS, well, that's the DNS lookup test.\n\n386\n00:20:20.482 --> 00:20:21.886\nWhere's the services list?\n\n387\n00:20:21.886 --> 00:20:22.899\nIt's here, under status.\n\n388\n00:20:22.899 --> 00:20:24.212\nUnder status and services,\n\n389\n00:20:24.212 --> 00:20:27.120\nyou'll see a list of the different\nservices you're running.\n\n390\n00:20:27.120 --> 00:20:28.909\nThere's that unbound service, and\n\n391\n00:20:28.909 --> 00:20:32.190\nwhen you make changes to that\nit kinda restarts that service.\n\n392\n00:20:32.190 --> 00:20:36.570\nThe same thing happens with the firewall\nrules, except you don't see that listed.\n\n393\n00:20:36.570 --> 00:20:40.750\nAnd you do have an option in here\nsomewhere where you can reload that\n\n394\n00:20:40.750 --> 00:20:41.500\nfirewall filter.\n\n395\n00:20:41.500 --> 00:20:42.040\n>> Filter rules.\n\n396\n00:20:42.040 --> 00:20:43.360\n>> There, filter reload.\n\n397\n00:20:43.360 --> 00:20:45.270\nAnd so you can kind of force\nit to reload and update.\n\n398\n00:20:45.270 --> 00:20:47.550\nSo it may not have taken\neffect at first glance.\n\n399\n00:20:47.550 --> 00:20:51.450\nBut now that's in place it looks like we\nhave achieved that as one simple nice,\n\n400\n00:20:51.450 --> 00:20:55.740\nlike a single not line,\nwhich does make it more efficient.\n\n401\n00:20:55.740 --> 00:20:57.480\nBut either way,\nwe end up in an environment where,\n\n402\n00:20:57.480 --> 00:21:00.710\nnow, we're forcing our people\nto use our safe lookups.\n\n403\n00:21:00.710 --> 00:21:02.500\nWe're redirecting for\nour open directory or\n\n404\n00:21:02.500 --> 00:21:03.980\nactive directory,\nwhatever else it is we have.\n\n405\n00:21:03.980 --> 00:21:07.680\nAnd we got a pretty robust DNS solution\nright here, inside of pfSense.\n\n406\n00:21:08.740 --> 00:21:09.660\n>> I like it.\n\n407\n00:21:09.660 --> 00:21:12.210\n>> All right, well, hopefully you\nguys learned something today,\n\n408\n00:21:12.210 --> 00:21:13.280\nthat's what we always shoot for.\n\n409\n00:21:13.280 --> 00:21:15.790\nAnd this DNS resolver is a neat function.\n\n410\n00:21:15.790 --> 00:21:19.540\nBe aware that the DNS forwarder,\nthe older DNS mask, it's still there.\n\n411\n00:21:19.540 --> 00:21:22.150\nStill works great, you can use it.\n\n412\n00:21:22.150 --> 00:21:24.290\nEventually the pfSense\nguys will phase that out,\n\n413\n00:21:24.290 --> 00:21:26.340\nbut for right now it is still there.\n\n414\n00:21:26.340 --> 00:21:29.680\nIf you're configuring a new firewall,\nmake sure you use the resolver, right.\n\n415\n00:21:29.680 --> 00:21:31.450\nThat is the newer one,\nthat's the one you wanna work with.\n\n416\n00:21:32.630 --> 00:21:34.230\nAll right, well,\nthat's about all we got for this one.\n\n417\n00:21:34.230 --> 00:21:35.510\nSo, we'll go ahead and wrap it up here.\n\n418\n00:21:35.510 --> 00:21:36.400\nStayed tuned though.\n\n419\n00:21:36.400 --> 00:21:41.527\nWe've got more pfSense\ncontent coming down the road.\n\n420\n00:21:41.527 --> 00:21:46.100\n[SOUND]\n\n",
          "vimeoId": "130429950"
        },
        {
          "description": null,
          "length": "1291",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-3-captive_portal-061215-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-3-captive_portal-061215-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-3-captive_portal-061215-1-sm.jpg",
          "title": "Captive Portal",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:08.838\n[SOUND]\nIn this segment,\n\n2\n00:00:08.838 --> 00:00:12.590\nwe're gonna take a look at the captive\nportal functionality inside of pfSense.\n\n3\n00:00:12.590 --> 00:00:15.200\nNow, if you've never heard of it, captive\n\n4\n00:00:15.200 --> 00:00:17.980\nportal is one of those technologies\nthat just sounds super awesome, right?\n\n5\n00:00:17.980 --> 00:00:19.392\nIt's a captive portal, that's cool!\n\n6\n00:00:19.392 --> 00:00:21.504\n>> [LAUGH]\n>> But it's actually one of the things\n\n7\n00:00:21.504 --> 00:00:25.106\nthat's probably annoyed the hell out\nof you at some point or another.\n\n8\n00:00:25.106 --> 00:00:27.004\n>> Yes.\n>> If you've ever been to a hotel,\n\n9\n00:00:27.004 --> 00:00:30.197\nor Starbucks, or a conference center,\nor a trade show, and\n\n10\n00:00:30.197 --> 00:00:34.461\nthey tell you free wireless available,\nand you jump on that wireless network and\n\n11\n00:00:34.461 --> 00:00:38.621\nthe first website you go to, you type\nin www.google.com and what do you get?\n\n12\n00:00:38.621 --> 00:00:39.708\nWelcome.\n>> A [CROSSTALK] web page.\n\n13\n00:00:39.708 --> 00:00:42.195\n>> Yeah, welcome to our wireless network.\n\n14\n00:00:42.195 --> 00:00:45.750\nAnd sign off on our end users\nlicense agreement or pay $25 for\n\n15\n00:00:45.750 --> 00:00:48.242\naccess through the wireless network today.\n\n16\n00:00:48.242 --> 00:00:48.990\n>> [LAUGH]\n>> Right?\n\n17\n00:00:48.990 --> 00:00:51.610\nThat's called a captive portal.\n\n18\n00:00:51.610 --> 00:00:56.320\nWhen you join that wireless network,\nyou are trapped behind that portal,\n\n19\n00:00:56.320 --> 00:00:59.540\nuntil you perform some sequence of events.\n\n20\n00:00:59.540 --> 00:01:00.040\nRight?\n\n21\n00:01:00.040 --> 00:01:03.850\nSome required steps before\nthey allow you to get out.\n\n22\n00:01:03.850 --> 00:01:08.520\nNow, at a minimum this is used generally\nto enforce things like acceptable use\n\n23\n00:01:08.520 --> 00:01:09.500\npolicies.\n\n24\n00:01:09.500 --> 00:01:11.465\nHey, our wireless is free,\nor our network is free,\n\n25\n00:01:11.465 --> 00:01:14.445\nyou're welcome to use it,\nbut here's the rules, right?\n\n26\n00:01:14.445 --> 00:01:16.665\nAnd we're gonna do our due diligence\nto provide you those rules.\n\n27\n00:01:16.665 --> 00:01:19.815\nYou just have to accept them, and\nyou can get on the wireless, all right.\n\n28\n00:01:19.815 --> 00:01:22.045\nAt a maximum,\nit can be used to charge people money.\n\n29\n00:01:22.045 --> 00:01:24.667\nYou can say, if you want access\nto this wireless network,\n\n30\n00:01:24.667 --> 00:01:27.677\nlike Gogo Inflight Internet access.\n\n31\n00:01:27.677 --> 00:01:29.107\nYou gotta pay $25 for\n\n32\n00:01:29.107 --> 00:01:32.287\nthat duration of that flight to be\nable to get on the Internet and\n\n33\n00:01:32.287 --> 00:01:35.562\nbrowse to your heart's content, and\nenjoy the slowness of inflight Internet.\n\n34\n00:01:35.562 --> 00:01:36.737\n>> [LAUGH]\n>> So\n\n35\n00:01:36.737 --> 00:01:41.297\nthat is the functionality of captive\nportal and pfSense has it built-in.\n\n36\n00:01:41.297 --> 00:01:44.327\nNow I'll tell you guys,\nI've used captive portal solutions before.\n\n37\n00:01:44.327 --> 00:01:48.150\nI've used dedicated ones that cost\ntens of thousands of dollars.\n\n38\n00:01:48.150 --> 00:01:50.320\nThe one that's built into\npfSense works really well and\n\n39\n00:01:50.320 --> 00:01:51.680\ndoes everything those other guy's do,\n\n40\n00:01:51.680 --> 00:01:55.590\nso it's a great solution even if you're\nnot using it as your true firewall.\n\n41\n00:01:55.590 --> 00:01:58.700\nIf you're just using it for captive portal\nfunctionality pfSense does a good job,\n\n42\n00:01:58.700 --> 00:02:00.220\nall right.\n\n43\n00:02:00.220 --> 00:02:03.515\nOne challenge you'll bump into\nis that the documentation for\n\n44\n00:02:03.515 --> 00:02:07.390\ncaptive portal is not all that great, so\nwe're gonna run through some of it and\n\n45\n00:02:07.390 --> 00:02:09.150\nkind of give you guys two examples.\n\n46\n00:02:09.150 --> 00:02:12.610\nThere's actually three different ways that\nwe can deploy captive portal, all right?\n\n47\n00:02:12.610 --> 00:02:13.980\nI've described two of them.\n\n48\n00:02:13.980 --> 00:02:19.400\nOne way is where w e basically\nhave a screen that people see and\n\n49\n00:02:19.400 --> 00:02:23.360\nthey just click okay to get in or\nthey accept a policy or whatever.\n\n50\n00:02:23.360 --> 00:02:26.660\nAnother way is where they\nhave to provide a token code.\n\n51\n00:02:26.660 --> 00:02:29.520\nAnd the token code,\nthey buy that with a credit card or\n\n52\n00:02:29.520 --> 00:02:31.780\nthey get it from the bellhop or whatever.\n\n53\n00:02:31.780 --> 00:02:34.300\nThey get this code to give them access for\na limited period of time.\n\n54\n00:02:34.300 --> 00:02:37.900\nBut then there is a third way,\nwhich is just basic authentication.\n\n55\n00:02:37.900 --> 00:02:41.060\nYou've got to have a valid username and\npassword to use this network and\n\n56\n00:02:41.060 --> 00:02:44.280\nif you don't we're not going to allow\nyou to get out to the internet, right?\n\n57\n00:02:44.280 --> 00:02:48.000\nSo those are three different methods that\nwe can leverage captive portal for us.\n\n58\n00:02:48.000 --> 00:02:49.560\nAnd I'm going to show us two ways.\n\n59\n00:02:49.560 --> 00:02:53.020\nI'm going to show us the acceptable\nuse policy type way and\n\n60\n00:02:53.020 --> 00:02:55.280\nI'm going to show us\nthe password authentication way.\n\n61\n00:02:55.280 --> 00:02:57.480\nI'm not going to show the token way.\n\n62\n00:02:57.480 --> 00:03:02.155\nAnd the reason I'm not is it requires\na lot more outside of pfSense.\n\n63\n00:03:02.155 --> 00:03:04.380\nWith pfSense it's really\njust a couple check marks,\n\n64\n00:03:04.380 --> 00:03:05.810\nthat say yeah we're gonna do tokens.\n\n65\n00:03:05.810 --> 00:03:09.800\nBut you have to have a software developer\nthat's gonna create an application that\n\n66\n00:03:09.800 --> 00:03:13.152\nhandles the payment processing,\nthat generates the token code and\n\n67\n00:03:13.152 --> 00:03:15.080\ngives it to the user, and\nthat's all outside of pfSense,\n\n68\n00:03:15.080 --> 00:03:18.880\nand that's part of why the documentation\non it is not so great.\n\n69\n00:03:18.880 --> 00:03:21.710\nBut if you're just looking for\nusername and password authentication, or\n\n70\n00:03:21.710 --> 00:03:24.790\nif you're just looking for\nacceptable use, it's super easy.\n\n71\n00:03:24.790 --> 00:03:26.550\nSo, we're gonna show you guys\nhow to get that setup and\n\n72\n00:03:26.550 --> 00:03:29.080\nkind of the process that it goes through.\n\n73\n00:03:29.080 --> 00:03:29.890\nAll right.\n\n74\n00:03:29.890 --> 00:03:32.410\nWell, step one,\nI just want to verify that my workstation\n\n75\n00:03:32.410 --> 00:03:33.980\ncan get out to the internet right now.\n\n76\n00:03:33.980 --> 00:03:36.230\nSo, I've got a Windows 8 machine here.\n\n77\n00:03:36.230 --> 00:03:40.240\nAnd if I fire up Internet Explorer, and\nI wanna go to a website like cnn.com.\n\n78\n00:03:40.240 --> 00:03:42.260\nI'll fire it up.\n\n79\n00:03:42.260 --> 00:03:47.040\nAnd, albeit slowly, I am getting out\nto the Internet, and there we go.\n\n80\n00:03:47.040 --> 00:03:49.580\nSo some lady did something and\nshe's in the news.\n\n81\n00:03:49.580 --> 00:03:52.375\nAnd if I have clogged pipes,\nthis ad tells me they can help me.\n\n82\n00:03:52.375 --> 00:03:53.460\n>> [LAUGH]\n>> So I get all\n\n83\n00:03:53.460 --> 00:03:55.060\nthe information I need\nabout clogged pipes.\n\n84\n00:03:55.060 --> 00:03:55.935\n>> And toilets.\n\n85\n00:03:55.935 --> 00:03:56.520\n>> So [LAUGH] all right.\n\n86\n00:03:56.520 --> 00:03:58.640\nSo, I've got that.\n\n87\n00:03:58.640 --> 00:04:02.980\nBut I didn't have to sign an acceptable\nuse or anything like that.\n\n88\n00:04:02.980 --> 00:04:04.550\nI want a captive portal.\n\n89\n00:04:04.550 --> 00:04:05.120\nRight?\n\n90\n00:04:05.120 --> 00:04:07.910\nSo to get that set up, what we do\nis we jump back to our firewall.\n\n91\n00:04:08.960 --> 00:04:12.230\nAnd we go to Services, and Captive Portal.\n\n92\n00:04:12.230 --> 00:04:16.010\nNow, the captive portal functionality\nin earlier versions of pfSense was\n\n93\n00:04:16.010 --> 00:04:17.140\nreally basic.\n\n94\n00:04:17.140 --> 00:04:20.570\nBut in the 2.2 releases,\nit made it really awesome.\n\n95\n00:04:20.570 --> 00:04:23.620\nThey introduced something called a zone.\n\n96\n00:04:23.620 --> 00:04:28.440\nA zone is where we can define one or\nmore interfaces that we want to protect.\n\n97\n00:04:28.440 --> 00:04:33.435\nAnd those interfaces might be wired,\nor wireless, it can be either one.\n\n98\n00:04:33.435 --> 00:04:35.875\nAnd we can group the interfaces\ntogether if we want.\n\n99\n00:04:35.875 --> 00:04:39.025\nSo if I have four\ninterfaces on my firewall,\n\n100\n00:04:39.025 --> 00:04:42.825\nI might want two of them to have captive\nportal and two of them not, right?\n\n101\n00:04:42.825 --> 00:04:44.715\nMaybe one interface runs\nto my server data center.\n\n102\n00:04:44.715 --> 00:04:46.455\nI don't wanna do captive portal there.\n\n103\n00:04:47.678 --> 00:04:49.680\nBut another one runs to my\npublic wireless network,\n\n104\n00:04:49.680 --> 00:04:51.730\nI absolutely wanna do\ncaptive portal there.\n\n105\n00:04:51.730 --> 00:04:53.830\nSo zones are what lets me provide that.\n\n106\n00:04:53.830 --> 00:04:58.110\nSo when you go to Services, and\nCaptive Portal, you see the Zones screen.\n\n107\n00:04:58.110 --> 00:05:02.440\nNow a zone can be mapped to just a single\ninterface, that's how I normally do it, or\n\n108\n00:05:02.440 --> 00:05:05.760\nyou can map a zone to more than one\ninterface if they've got common elements.\n\n109\n00:05:05.760 --> 00:05:08.420\nSo I'm gonna go in here and\nadd in a new zone.\n\n110\n00:05:08.420 --> 00:05:13.132\nAnd we give it a name, right, so\nI might call this my Public WiFi,\n\n111\n00:05:13.132 --> 00:05:15.780\nright, or\nwhatever it is that I want this one to be.\n\n112\n00:05:15.780 --> 00:05:17.860\nI'm just going to do my LAN\nnetwork here for the example,\n\n113\n00:05:17.860 --> 00:05:19.910\nbut this might be your public WiFi.\n\n114\n00:05:19.910 --> 00:05:21.050\nAnd you give it a description.\n\n115\n00:05:21.050 --> 00:05:24.550\nThis is my Public Wireless Network.\n\n116\n00:05:25.560 --> 00:05:27.170\nAnd we'll continue and\nnow we've got a zone.\n\n117\n00:05:28.540 --> 00:05:34.310\nOnce you've got a zone, that opens you up\nfor all sorts of additional configuration\n\n118\n00:05:34.310 --> 00:05:38.270\noptions, and you'll see there's quite\na bit in here that we can set up, and\n\n119\n00:05:38.270 --> 00:05:40.750\nthis is all part of getting\ncaptive portal running.\n\n120\n00:05:40.750 --> 00:05:41.920\nNow it looks a little intimidating,\n\n121\n00:05:41.920 --> 00:05:45.840\nbut you'll find a lot of\nthe options are optional.\n\n122\n00:05:45.840 --> 00:05:48.280\nIt's kind of redundant,\nisn't it, optional options?\n\n123\n00:05:48.280 --> 00:05:50.830\nBut some of them are mandatory,\nmost of them are optional.\n\n124\n00:05:50.830 --> 00:05:52.740\nYou can go through and\ntweak what you want.\n\n125\n00:05:52.740 --> 00:05:55.410\nThe first thing I need to do is pick\nthe interface I'm gonna protect.\n\n126\n00:05:55.410 --> 00:05:59.100\nI'm gonna Enable captive portal, and\nI'm gonna protect my LAN interface.\n\n127\n00:05:59.100 --> 00:06:00.680\nNow, I'm doing public Wi-Fi, so\n\n128\n00:06:00.680 --> 00:06:04.090\nnormally I'd have an interface on my\npublic Wi-Fi and that's what I'd pick.\n\n129\n00:06:04.090 --> 00:06:08.040\nAnd you can Ctrl+click to choose more\nthan one interface if you wanna do that.\n\n130\n00:06:08.040 --> 00:06:09.130\nBut I'm just gonna protect my LAN.\n\n131\n00:06:09.130 --> 00:06:10.990\nAll right.\n\n132\n00:06:10.990 --> 00:06:14.370\nThen you can set the maximum\nconcurrent connections per client.\n\n133\n00:06:15.410 --> 00:06:17.880\nIf you've ever been to Starbucks or\na hotel, you'll\n\n134\n00:06:17.880 --> 00:06:20.860\nnotice that sometimes the network is fast,\nand sometimes the network is slow.\n\n135\n00:06:20.860 --> 00:06:23.840\nAnd what's happening is usually\nsomebody's running BitTorrent or\n\n136\n00:06:23.840 --> 00:06:26.080\ndoing a lot of traffic on that network.\n\n137\n00:06:26.080 --> 00:06:28.910\nWe can throttle the amount of\nconnections that each individual IP\n\n138\n00:06:28.910 --> 00:06:30.300\nis allowed to have.\n\n139\n00:06:30.300 --> 00:06:32.020\nThis is useful for two things.\n\n140\n00:06:32.020 --> 00:06:33.640\nOne, stopping network hogs.\n\n141\n00:06:33.640 --> 00:06:38.000\nAnd two, stopping people that have brought\nin like those little wi-fi direct boxes,\n\n142\n00:06:38.000 --> 00:06:42.730\nthe MyFi access points, or the miniature\nwireless routers, where they're sharing\n\n143\n00:06:42.730 --> 00:06:45.460\ntheir connection with other people,\nso they buy once and then share it.\n\n144\n00:06:45.460 --> 00:06:47.220\nWe can throttle the connections.\n\n145\n00:06:47.220 --> 00:06:49.780\nDefault is 0, that's probably\nwhat we want in most cases.\n\n146\n00:06:51.330 --> 00:06:54.210\nThen you can set Idle and Hard timeouts.\n\n147\n00:06:54.210 --> 00:06:56.770\nIf somebody passes through my portal and\n\n148\n00:06:56.770 --> 00:07:00.310\nthey meet whatever requirements I have,\nand then they idle for\n\n149\n00:07:00.310 --> 00:07:04.310\na certain period of time, I can make them\nhave to reaccept the agreement, all right?\n\n150\n00:07:04.310 --> 00:07:05.840\nSo I can put that in here.\n\n151\n00:07:05.840 --> 00:07:10.580\nIf I wanted it to be hard, after a certain\nperiod of time, you have to redo, right?\n\n152\n00:07:10.580 --> 00:07:13.140\nI can define that too,\nwhether you're idle or not.\n\n153\n00:07:13.140 --> 00:07:15.750\nSo maybe I wanna set it to like 24 hours.\n\n154\n00:07:15.750 --> 00:07:18.330\n24 hours is what, 2880 minutes, 2,880?\n\n155\n00:07:18.330 --> 00:07:19.141\nOr is it [CROSSTALK]?\n\n156\n00:07:19.141 --> 00:07:24.636\n>> 28,880 seconds, yes.\n\n157\n00:07:24.636 --> 00:07:28.370\n>> All right, so we'll put\nthe minutes in there, 2,880 minutes.\n\n158\n00:07:28.370 --> 00:07:32.830\nSo now, after 24 hours, they'll have to\ndo my acceptable use policy again, or\n\n159\n00:07:32.830 --> 00:07:34.460\nthey'll have to pay again.\n\n160\n00:07:34.460 --> 00:07:36.110\nThey get it for 24 hours.\n\n161\n00:07:36.110 --> 00:07:38.120\nIt's up to me to define what\nI want that interval to be,\n\n162\n00:07:38.120 --> 00:07:40.620\nif I even want to have an interval.\n\n163\n00:07:40.620 --> 00:07:43.680\nMaybe in my company,\nwe just have a policy that says,\n\n164\n00:07:43.680 --> 00:07:46.970\nlook everybody has to sign\nthe acceptable use policy.\n\n165\n00:07:46.970 --> 00:07:50.410\nAnd so, we just set this with no time\nout and now they just accept it once and\n\n166\n00:07:50.410 --> 00:07:52.220\nthey never see it again, right?\n\n167\n00:07:52.220 --> 00:07:52.720\nWe can do that.\n\n168\n00:07:54.480 --> 00:07:59.168\nThen we've got what are called, pass\nthrough credits allowed per MAC address.\n\n169\n00:07:59.168 --> 00:08:02.534\nA pass-through credit is\nsomething that allows somebody to\n\n170\n00:08:02.534 --> 00:08:05.030\npass-through the portal.\n\n171\n00:08:05.030 --> 00:08:08.914\nWhen you pass that portal, when you\nput in your user name and password or\n\n172\n00:08:08.914 --> 00:08:11.583\nyou click I agree or\nwhatever, you get a credit.\n\n173\n00:08:11.583 --> 00:08:12.817\nAnd that credit lets you through for\n\n174\n00:08:12.817 --> 00:08:15.060\nwhatever time we've kind\nof defined up here.\n\n175\n00:08:15.060 --> 00:08:17.170\nUntil we kick you out or whatever.\n\n176\n00:08:17.170 --> 00:08:21.430\nWell, you can specify how many\ncredits a single MAC address can get.\n\n177\n00:08:21.430 --> 00:08:25.320\nIf somebody put one of those routers\nin and it got multiple hosts behind it,\n\n178\n00:08:25.320 --> 00:08:27.530\nthat one MAC address is\ngetting more than one credit.\n\n179\n00:08:27.530 --> 00:08:29.150\nWe might not want that.\n\n180\n00:08:29.150 --> 00:08:30.797\nAnd so we could limit it so\n\n181\n00:08:30.797 --> 00:08:35.510\nthat each MAC address is only capable\nto get one per client MAC address.\n\n182\n00:08:35.510 --> 00:08:39.179\nOr we might leave it at zero or blank\nwhich is basically none that means that\n\n183\n00:08:39.179 --> 00:08:42.611\nevery time a new connection comes in\nit's got to do that agreement and\n\n184\n00:08:42.611 --> 00:08:45.059\nthat's what ties us to\nthese timeouts up above.\n\n185\n00:08:45.059 --> 00:08:45.929\nSo I'm gonna leave it at that one.\n\n186\n00:08:47.100 --> 00:08:49.728\nWe've got a waiting period\nto restore past due credits.\n\n187\n00:08:49.728 --> 00:08:53.071\nMaybe somebody get's a credit and\nit's only good for three hours.\n\n188\n00:08:53.071 --> 00:08:55.380\nAnd they get three hours everyday.\n\n189\n00:08:55.380 --> 00:08:57.470\nSo I want that credit to come\nback to them the next day,\n\n190\n00:08:57.470 --> 00:08:59.620\nnow they get three more hours, and\nthen the next day three hours,\n\n191\n00:08:59.620 --> 00:09:02.120\nand I can specify how long before\nthey get that credit back again.\n\n192\n00:09:03.470 --> 00:09:06.370\nAnd we can reset that waiting\nperiod on attempted access\n\n193\n00:09:06.370 --> 00:09:09.050\nwhen somebody attempts to\naccess we can define and delay.\n\n194\n00:09:09.050 --> 00:09:12.060\nOr you can even do like manual\napproval if you wanna get that way.\n\n195\n00:09:12.060 --> 00:09:13.230\nAnd you can put it in.\n\n196\n00:09:13.230 --> 00:09:15.900\nAnd we can specify that\nwe wanna reset that and\n\n197\n00:09:15.900 --> 00:09:17.220\nget people reconnected right away.\n\n198\n00:09:18.510 --> 00:09:22.200\nThe next option,\nthis log out pop-up window.\n\n199\n00:09:22.200 --> 00:09:24.450\nWhen you connect to the captive portal and\nyou use your username and\n\n200\n00:09:24.450 --> 00:09:28.350\npassword, you're now authenticated and\nyou stay connected until the hard timeout.\n\n201\n00:09:28.350 --> 00:09:31.130\nIf there's no hard timeout,\nyou stay authenticated forever.\n\n202\n00:09:31.130 --> 00:09:34.500\nIf you want the logout functionality, you\ncan turn it on, but I'll tell you guys.\n\n203\n00:09:34.500 --> 00:09:36.140\nIt's even a node in here somewhere.\n\n204\n00:09:36.140 --> 00:09:36.770\nIt's not here, but\n\n205\n00:09:36.770 --> 00:09:40.610\nsomewhere they have it where pop-up\nwindows rarely work these days.\n\n206\n00:09:40.610 --> 00:09:43.660\nAlmost everybody blocks pop-up\nwindows on their web browser and\n\n207\n00:09:43.660 --> 00:09:45.450\nthis is a JavaScript pop-up window.\n\n208\n00:09:45.450 --> 00:09:47.650\nSo you can turn that on, but\nit usually doesn't work.\n\n209\n00:09:47.650 --> 00:09:50.910\nSo most of the time users don't have\na good way to log out of the portal.\n\n210\n00:09:52.910 --> 00:09:56.110\nIf you don't want your firewall to host\nthe login page, like if you've got\n\n211\n00:09:56.110 --> 00:09:59.930\na shopping cart where they need to go to,\nto actually buy the product, you can\n\n212\n00:09:59.930 --> 00:10:06.810\nspecify a pre-authentication redirect URL,\nand a post authentication redirect URL.\n\n213\n00:10:06.810 --> 00:10:08.640\nSo, when they go to authenticate,\n\n214\n00:10:08.640 --> 00:10:11.190\ninstead of doing it here we\nsend them to our shopping cart.\n\n215\n00:10:11.190 --> 00:10:12.930\nAnd they buy their token code and\nthey get it and\n\n216\n00:10:12.930 --> 00:10:15.520\nthen they'll return back here where\nthey punch in their token code.\n\n217\n00:10:15.520 --> 00:10:19.420\nAnd then from there they get\nthis post authentication URL.\n\n218\n00:10:19.420 --> 00:10:23.065\nIn other words, once you pay,\ndon't just send them out to Google or\n\n219\n00:10:23.065 --> 00:10:25.980\nwhether you're trying to go,\nsend them to our hotel homepage or\n\n220\n00:10:25.980 --> 00:10:27.940\nsomething else to annoy\nthe hell out of them.\n\n221\n00:10:27.940 --> 00:10:29.200\nThat's kind of what they do.\n\n222\n00:10:29.200 --> 00:10:30.070\nSo we can specify those.\n\n223\n00:10:31.160 --> 00:10:34.780\nYou can also do block MAC\naddress redirect URL.\n\n224\n00:10:34.780 --> 00:10:35.430\nBy default,\n\n225\n00:10:35.430 --> 00:10:39.390\nif somebody's blocked, it just sends\nthem to the authentication page again.\n\n226\n00:10:39.390 --> 00:10:41.090\nBut, we might want to send\nthem to a different page,\n\n227\n00:10:41.090 --> 00:10:45.480\nlike the shopping cart, to say, you just\ngot blocked, and you need to go back and\n\n228\n00:10:45.480 --> 00:10:47.900\nbuy another 24 hours or whatever.\n\n229\n00:10:50.465 --> 00:10:54.790\nBy default, a user account is allowed\nto log in as many times as they want.\n\n230\n00:10:54.790 --> 00:10:56.090\nSo if I have a username and password,\n\n231\n00:10:56.090 --> 00:10:58.240\nI can go to five different machines and\nlog in.\n\n232\n00:10:58.240 --> 00:11:00.360\nWe can limit that to single login, so\n\n233\n00:11:00.360 --> 00:11:02.110\nI can only be logged in\non one machine at a time.\n\n234\n00:11:02.110 --> 00:11:05.590\nIf you do that, you gotta really\nsolve that logout problem, so\n\n235\n00:11:05.590 --> 00:11:07.680\nthat people are able to log out and\nlog in on another machine.\n\n236\n00:11:09.200 --> 00:11:13.460\nMAC filtering is what happens by default,\nIs using your MAC address to track\n\n237\n00:11:13.460 --> 00:11:16.330\nmachines to determine if they\nshould be able to come through, so\n\n238\n00:11:16.330 --> 00:11:20.290\nif that's not enabled then you kind\nof make it where people can bypass.\n\n239\n00:11:20.290 --> 00:11:21.680\nSo we don't normally want to disable that.\n\n240\n00:11:22.880 --> 00:11:25.800\nYou've also got this\npass-through MAC auto entry.\n\n241\n00:11:25.800 --> 00:11:29.470\nWhen somebody authenticates,\nthey get pass-through ability.\n\n242\n00:11:30.690 --> 00:11:33.690\nAnd if their session times out and\nthey leave,\n\n243\n00:11:33.690 --> 00:11:36.190\nthen they've got to re-authenticate\nthe next time they connect.\n\n244\n00:11:36.190 --> 00:11:40.569\nBut if I enable pass-through MAC auto\nentry, the first time they authenticate,\n\n245\n00:11:40.569 --> 00:11:42.853\ntheir MAC address gets\nadded to the list and\n\n246\n00:11:42.853 --> 00:11:47.188\nnow they're allowed to pass-through\nforever without authenticating again.\n\n247\n00:11:47.188 --> 00:11:48.853\nThat's good if you have\ndedicated computers,\n\n248\n00:11:48.853 --> 00:11:50.510\npeople don't get bothered with it.\n\n249\n00:11:50.510 --> 00:11:53.610\nBut if people shared computers that\nmight not be what you want, so\n\n250\n00:11:53.610 --> 00:11:56.760\nyou may need to turn this on or\noff based on your own needs.\n\n251\n00:11:56.760 --> 00:11:59.070\nAnd they've even got it where you\ncan tie it to the user name and\n\n252\n00:11:59.070 --> 00:12:00.320\nthat's better with shared machines.\n\n253\n00:12:02.065 --> 00:12:04.145\nWe can limit bandwidth per user.\n\n254\n00:12:04.145 --> 00:12:07.455\nIf this is a shared network I don't want\none user hogging it for everybody so\n\n255\n00:12:07.455 --> 00:12:08.855\nI can apply a default download and\n\n256\n00:12:08.855 --> 00:12:11.315\nupload the limit and\nthat will stop those bandwidth hogs.\n\n257\n00:12:13.145 --> 00:12:14.410\nAnd then authentication.\n\n258\n00:12:14.410 --> 00:12:16.630\nNotice the default is no authentication.\n\n259\n00:12:16.630 --> 00:12:18.000\nRight now when somebody logs in,\n\n260\n00:12:18.000 --> 00:12:21.740\nthey're just gonna see a webpage\nthat's gonna give them a do you agree?\n\n261\n00:12:21.740 --> 00:12:24.010\nAnd that's how I'm gonna\nset mine up by default.\n\n262\n00:12:24.010 --> 00:12:29.360\nBut I could also choose to do the local\nuser database, or a radius server.\n\n263\n00:12:29.360 --> 00:12:32.080\nAnd that radius server might be something\nlike Microsoft Active Directory, and\n\n264\n00:12:32.080 --> 00:12:33.870\nnow people can log in with\ntheir Windows account, so\n\n265\n00:12:33.870 --> 00:12:35.600\nyou've got a lot of options there.\n\n266\n00:12:35.600 --> 00:12:36.770\nWe'll start with no authentication.\n\n267\n00:12:36.770 --> 00:12:38.119\nI'll turn on authentication afterwards.\n\n268\n00:12:40.150 --> 00:12:42.870\nThe rest of these settings here all apply\nto connecting to that authentication\n\n269\n00:12:42.870 --> 00:12:44.560\nserver, which I'm not\ngonna use right here.\n\n270\n00:12:45.930 --> 00:12:48.090\nYou can choose whether\nyou wanna use HTTPS,\n\n271\n00:12:48.090 --> 00:12:49.820\nif you wanna secure that connection.\n\n272\n00:12:49.820 --> 00:12:50.910\nI'm not gonna do that.\n\n273\n00:12:50.910 --> 00:12:54.620\nIf you do choose to use HTTPS,\nyou do have to provide a certificate.\n\n274\n00:12:54.620 --> 00:12:56.770\nIt's gonna use that web\nconfigurator one by default, but\n\n275\n00:12:56.770 --> 00:12:58.370\nyou normally need to load one up yourself.\n\n276\n00:12:59.960 --> 00:13:02.070\nAnd then after that is the important part.\n\n277\n00:13:02.070 --> 00:13:03.640\nHere's our portal webpage.\n\n278\n00:13:03.640 --> 00:13:06.400\nSo what webpage are people gonna\nsee when they hit the portal?\n\n279\n00:13:06.400 --> 00:13:10.150\nThere is actually no default webpage,\nso you've gotta create one.\n\n280\n00:13:10.150 --> 00:13:15.070\nYour company crafts a webpage and\nassociated image files, and\n\n281\n00:13:15.070 --> 00:13:16.440\nso on, and you upload it.\n\n282\n00:13:16.440 --> 00:13:19.690\nNow, when you upload those image files, be\ncareful because it will take those files\n\n283\n00:13:19.690 --> 00:13:22.230\nand it'll stick the word\ncaptive before them.\n\n284\n00:13:22.230 --> 00:13:25.260\nSo captive-whatever,\nthat's what it adds in.\n\n285\n00:13:25.260 --> 00:13:28.450\nSo, if you've got associated images,\nyou've got to deal with that.\n\n286\n00:13:28.450 --> 00:13:30.970\nI've got a simple portal\nfile here on my desktop.\n\n287\n00:13:30.970 --> 00:13:32.820\nNot on my desktop, somewhere.\n\n288\n00:13:32.820 --> 00:13:33.900\nI guess in my document.\n\n289\n00:13:33.900 --> 00:13:34.800\nThere it is.\n\n290\n00:13:34.800 --> 00:13:37.510\nI've got a portal with no\nauthentication webfile,\n\n291\n00:13:37.510 --> 00:13:41.010\nlet me just open that with WordPad,\nso you guys can see what I've got.\n\n292\n00:13:41.010 --> 00:13:45.120\nThis is just a welcome to our portal,\nand it's got a button on it, and\n\n293\n00:13:45.120 --> 00:13:48.800\nthat button is just a submit button,\nand that's it.\n\n294\n00:13:48.800 --> 00:13:50.520\nI could stick a message\nin here if I wanted,\n\n295\n00:13:50.520 --> 00:13:55.290\nlike an acceptable use policy, clicking\nsubmit means you agree to my policy.\n\n296\n00:13:55.290 --> 00:13:57.190\nYou can define whatever you want there and\n\n297\n00:13:57.190 --> 00:13:59.910\npeople have to submit\nthat to get connected up.\n\n298\n00:13:59.910 --> 00:14:01.980\nSo just a real simple page\nto be able to do that.\n\n299\n00:14:01.980 --> 00:14:03.590\nYou can obviously make one much fancier.\n\n300\n00:14:05.070 --> 00:14:08.350\nI just need to upload that to my server so\nI'm gonna hit browse and\n\n301\n00:14:08.350 --> 00:14:10.420\nI'll go pick that portal\nwith no authentication.\n\n302\n00:14:11.660 --> 00:14:14.810\nAnd that's what it's gonna load\nup to the system so I'll have it.\n\n303\n00:14:14.810 --> 00:14:17.310\nIf we have an authentication error,\nwe can specify an error page.\n\n304\n00:14:17.310 --> 00:14:20.200\nThe default is to just go\nback to the log in page.\n\n305\n00:14:20.200 --> 00:14:23.960\nLog out page, again, default for that\nis just to go back to the log in page.\n\n306\n00:14:23.960 --> 00:14:26.570\nAnd then we can save it.\n\n307\n00:14:26.570 --> 00:14:29.931\nOnce that's saved,\nI now have captive portal enabled.\n\n308\n00:14:29.931 --> 00:14:33.450\nI'm protecting my LAN interface and\nnobody's logged in right now.\n\n309\n00:14:33.450 --> 00:14:35.464\nNobody, including me.\n\n310\n00:14:35.464 --> 00:14:40.671\nIf I were to open up a command prompt and\ntry and do a ping.\n\n311\n00:14:40.671 --> 00:14:43.877\nI'm gonna ping out to the internet.\n\n312\n00:14:43.877 --> 00:14:45.137\nI can't get to the internet.\n\n313\n00:14:45.137 --> 00:14:46.625\nI can't ping.\n\n314\n00:14:46.625 --> 00:14:48.805\nAnd the reason is I haven't\ncleared the captive portal yet,\n\n315\n00:14:48.805 --> 00:14:50.525\nI'm locked away behind the captive portal.\n\n316\n00:14:51.605 --> 00:14:56.325\nBut if I fire up my web browser and\nI go to any webpage, if I got to cnn.com,\n\n317\n00:14:56.325 --> 00:15:01.235\nwhere I went just a few moments ago,\nnow, oh shoot I cached it.\n\n318\n00:15:01.235 --> 00:15:02.555\nInternet Explorer is evil.\n\n319\n00:15:02.555 --> 00:15:07.400\nLet me open up another page here,\nand I'll go to Google.\n\n320\n00:15:07.400 --> 00:15:08.640\nThere we go.\n\n321\n00:15:08.640 --> 00:15:10.430\nI get Welcome to our portal.\n\n322\n00:15:10.430 --> 00:15:12.640\nClick Continue to access the Internet.\n\n323\n00:15:12.640 --> 00:15:15.220\nHere, I get maybe like\nan acceptable use policy or\n\n324\n00:15:15.220 --> 00:15:19.260\nan end user license agreement,\na picture of the hotel, whatever.\n\n325\n00:15:19.260 --> 00:15:22.120\nAnd I hit Continue to say, gee,\nthank you for the free Internet.\n\n326\n00:15:22.120 --> 00:15:25.720\nAnd now, I'm out and\nwhen I did that, look at my pings.\n\n327\n00:15:26.750 --> 00:15:28.500\nIt cleared my MAC address.\n\n328\n00:15:28.500 --> 00:15:30.680\nI'm now allowed to go out\nthrough the firewall.\n\n329\n00:15:30.680 --> 00:15:31.730\nAnd get that internet access.\n\n330\n00:15:32.780 --> 00:15:37.410\nAnd on the firewall,\nif I go up here to status and\n\n331\n00:15:37.410 --> 00:15:40.280\ncaptive portal, I can see who's logged in.\n\n332\n00:15:40.280 --> 00:15:42.080\nThere's my workstation right there.\n\n333\n00:15:42.080 --> 00:15:43.270\nI'm unauthenticated.\n\n334\n00:15:43.270 --> 00:15:44.340\nIt's just, you know?\n\n335\n00:15:44.340 --> 00:15:45.580\nI click OK.\n\n336\n00:15:45.580 --> 00:15:46.700\nAnd I'm out, and there's my session.\n\n337\n00:15:47.820 --> 00:15:48.440\nSo I'm there.\n\n338\n00:15:48.440 --> 00:15:52.571\nI can hit this Show last activity, and\nit's gonna update to kinda reflect that,\n\n339\n00:15:52.571 --> 00:15:56.479\nso I can see when's the last time this\nperson was actually using the system.\n\n340\n00:15:56.479 --> 00:15:58.179\nSo if they've idled out or not But\n\n341\n00:15:58.179 --> 00:16:01.173\notherwise it's just showing\nwhen that session started.\n\n342\n00:16:01.173 --> 00:16:03.922\nAnd if I wanna kick them out,\nI can kick them out.\n\n343\n00:16:03.922 --> 00:16:07.730\nI'm gonna kick that client out and\nnow, that session's gone.\n\n344\n00:16:07.730 --> 00:16:10.610\nAnd what I'll see is it'll take\njust a second but there it goes.\n\n345\n00:16:10.610 --> 00:16:12.114\nNow, my PNGs are dead.\n\n346\n00:16:12.114 --> 00:16:16.320\nAnd if I try and browse out to the\nInternet, I'm gonna get that portal again.\n\n347\n00:16:16.320 --> 00:16:19.900\nSo that captive portal,\nit's basically firewalling me off\n\n348\n00:16:19.900 --> 00:16:23.270\nuntil I leap through a couple\nof hoops to get things done.\n\n349\n00:16:23.270 --> 00:16:24.510\n>> Very nice.\n\n350\n00:16:24.510 --> 00:16:25.820\n>> Now,\nI did it here with no authentication.\n\n351\n00:16:25.820 --> 00:16:28.150\nThis is just me clicking okay.\n\n352\n00:16:28.150 --> 00:16:30.470\nWe'll say we want to add\nauthentication to it.\n\n353\n00:16:30.470 --> 00:16:35.890\nI've got a different web form, this guy\nright here, which is basically the same.\n\n354\n00:16:35.890 --> 00:16:37.873\nExcept it's asking to enter\nin a username and a password.\n\n355\n00:16:37.873 --> 00:16:41.430\nAnd you'll see that I'm passing\nthose as variables into the system.\n\n356\n00:16:41.430 --> 00:16:44.720\nSo we've got off user and off pass.\n\n357\n00:16:44.720 --> 00:16:46.000\nPassword and username.\n\n358\n00:16:46.000 --> 00:16:48.210\nI've gotta collect those two\nto send to the firewall and\n\n359\n00:16:48.210 --> 00:16:50.080\nthe firewall will authenticate me.\n\n360\n00:16:50.080 --> 00:16:55.090\nNow, I'm set to use my local database for\nauthentication or I will be able at least.\n\n361\n00:16:55.090 --> 00:16:58.940\nSo if I jump here I need to\ncreate a user account for myself.\n\n362\n00:16:58.940 --> 00:17:02.980\nSo I'm gonna go to User Manager and\noh I forgot, I've already got a user name.\n\n363\n00:17:02.980 --> 00:17:05.110\nWell, I've got a user account but\nit actually won't work.\n\n364\n00:17:05.110 --> 00:17:06.300\nEven though I'm an admin,\n\n365\n00:17:06.300 --> 00:17:09.980\nit won't work cuz I've gotta have\npermission to clear the Captive Portal.\n\n366\n00:17:09.980 --> 00:17:12.230\nSo I'm gonna edit my user account, and\n\n367\n00:17:12.230 --> 00:17:14.480\nas I scroll down here's\nmy Effective Privileges.\n\n368\n00:17:14.480 --> 00:17:19.340\nAnd see how I've got Admin, Allow access\nto all pages of the webConfigurator.\n\n369\n00:17:19.340 --> 00:17:21.370\nBut I need to be able to clear the portal.\n\n370\n00:17:21.370 --> 00:17:23.027\nSo I'm a hit the little plus sign.\n\n371\n00:17:23.027 --> 00:17:26.181\nAnd there's a privilege in here but\nI have to find it.\n\n372\n00:17:26.181 --> 00:17:28.120\n[LAUGH] It's kinda hard to find.\n\n373\n00:17:28.120 --> 00:17:29.670\nAnd it's.\n\n374\n00:17:29.670 --> 00:17:30.605\n>> A little bit down there it is.\n\n375\n00:17:30.605 --> 00:17:31.490\n>> There we go.\n\n376\n00:17:31.490 --> 00:17:35.530\nUser-services-captive portal login.\n\n377\n00:17:35.530 --> 00:17:36.730\nI need to add that privilege.\n\n378\n00:17:38.400 --> 00:17:42.990\nSo now, I can see I'm an admin and\nI'm allowed to clear the captive portal.\n\n379\n00:17:42.990 --> 00:17:46.582\nIf you're doing this again it's\nlike an LDAP directory or RADIUS.\n\n380\n00:17:46.582 --> 00:17:49.280\nYou'll wanna use a group\ninstead of user accounts.\n\n381\n00:17:49.280 --> 00:17:51.780\nAnd that way any user in that\ngroup will get that access,\n\n382\n00:17:51.780 --> 00:17:52.940\nyou can specify it that way.\n\n383\n00:17:52.940 --> 00:17:55.880\nBut here I'm doing it\nright on my user account.\n\n384\n00:17:55.880 --> 00:17:56.680\nLet me save that user.\n\n385\n00:17:58.040 --> 00:18:01.448\nNow, I need to go update my portal, so it\nknows to ask for a username and password.\n\n386\n00:18:01.448 --> 00:18:05.906\nSo I'm gonna go to Captive Portal and\nI'm gonna edit that zone.\n\n387\n00:18:05.906 --> 00:18:07.239\nAnd I'm gonna go down and\n\n388\n00:18:07.239 --> 00:18:10.871\nI'm gonna find that section where\nit asked about authentication.\n\n389\n00:18:10.871 --> 00:18:14.051\nAnd I'm gonna tell it to\nuse my local user database.\n\n390\n00:18:14.051 --> 00:18:16.424\nI'm not gonna do other ones,\nI'm just gonna use the local database.\n\n391\n00:18:16.424 --> 00:18:18.692\nAnd see how it says right here,\nallow only users or\n\n392\n00:18:18.692 --> 00:18:21.310\ngroups with captive portal\nlogin privilege set.\n\n393\n00:18:21.310 --> 00:18:23.860\nIf I turned that off,\nanybody with a user account would work.\n\n394\n00:18:23.860 --> 00:18:27.340\nBut it's on by default.\n\n395\n00:18:27.340 --> 00:18:31.980\nAs I scroll down, the other thing I\nneed to change is I need to change my\n\n396\n00:18:31.980 --> 00:18:37.600\nportal page content to a page that will\nask for that username and password.\n\n397\n00:18:37.600 --> 00:18:41.700\nSo I can view my current page or whatever\nbut I'm gonna upload a new one, and\n\n398\n00:18:41.700 --> 00:18:43.180\nit'll just replace the old one.\n\n399\n00:18:43.180 --> 00:18:46.940\nSo I'm gonna upload this portal-auth\nfile here that does the authentication.\n\n400\n00:18:48.100 --> 00:18:50.645\nAnd I'll go ahead and Save.\n\n401\n00:18:50.645 --> 00:18:53.720\nNow, the portal requires a username and\na password.\n\n402\n00:18:53.720 --> 00:18:59.630\nSo if I fire up a web browser and my PNGs\nshould still be failing, and they are.\n\n403\n00:18:59.630 --> 00:19:04.506\nAnd if I try and go to another website,\nlet's try and go to slash.org.\n\n404\n00:19:04.506 --> 00:19:05.733\nI get my portal log in.\n\n405\n00:19:05.733 --> 00:19:10.100\nAnd now, I've got to clear that\nportal before I can get beyond.\n\n406\n00:19:10.100 --> 00:19:13.573\nSo I'll log in, and my user name and\npassword should work,\n\n407\n00:19:13.573 --> 00:19:16.355\nlet's cross our fingers and\nhope for a second.\n\n408\n00:19:16.355 --> 00:19:18.560\n[LAUGH] That's kinda taking its-\n>> [LAUGH]\n\n409\n00:19:18.560 --> 00:19:19.471\n>> Time there, isn't it?\n\n410\n00:19:19.471 --> 00:19:23.388\nSo it should clear this and\nthen it'll let me get out.\n\n411\n00:19:23.388 --> 00:19:26.541\nAnd I'll know I'm authenticated\nif my PNGs start working and oh,\n\n412\n00:19:26.541 --> 00:19:28.129\nmaybe slash dot's the problem.\n\n413\n00:19:28.129 --> 00:19:29.915\n>> [LAUGH]\n>> I can see my PNGs are working but\n\n414\n00:19:29.915 --> 00:19:32.100\nthis authentication is still\njust kinda sitting here.\n\n415\n00:19:36.050 --> 00:19:37.040\nLet's try somebody else,\n\n416\n00:19:37.040 --> 00:19:42.180\nwe'll try how about digg see if we can\nget to good old digg with the Internet.\n\n417\n00:19:42.180 --> 00:19:44.470\nSo yeah, so\nmaybe slash dot's my problem today.\n\n418\n00:19:44.470 --> 00:19:47.690\nSo I can get out to digg now and\nI'm on the Internet, that's great.\n\n419\n00:19:47.690 --> 00:19:50.518\nThey're reporting on a future according\nto anime which I can already tell\n\n420\n00:19:50.518 --> 00:19:52.401\nwill be a completely\nworthless article to read.\n\n421\n00:19:52.401 --> 00:19:53.980\n>> [LAUGH]\n>> So\n\n422\n00:19:53.980 --> 00:19:56.590\nhere we go we're getting out,\nmy PNGs are getting out.\n\n423\n00:19:56.590 --> 00:20:02.120\nEven better, if I go to Status > Captive\nPortal, I can see that it's deep as that.\n\n424\n00:20:02.120 --> 00:20:04.150\nI know that I'm connected\nto the network and\n\n425\n00:20:04.150 --> 00:20:06.400\nI'm going out into my\nsession started this time.\n\n426\n00:20:06.400 --> 00:20:08.355\nAnd I can see that I kicked\nthat person out if I want to.\n\n427\n00:20:10.125 --> 00:20:12.855\nSo getting a Captive Portal\nset up is really not hard.\n\n428\n00:20:12.855 --> 00:20:15.275\nIf we want the token stuff yeah,\nthat's a challenge.\n\n429\n00:20:15.275 --> 00:20:16.365\nThat's where you need a developer.\n\n430\n00:20:16.365 --> 00:20:19.988\nYou need somebody to come help write the\nhooks to tap into the firewall to generate\n\n431\n00:20:19.988 --> 00:20:21.650\nthose tokens and assign them users.\n\n432\n00:20:21.650 --> 00:20:25.347\nBut if you're just trying to do a username\nand password requirement on your\n\n433\n00:20:25.347 --> 00:20:29.176\nprivate network or an acceptable use\npolicy for your employees or whatever.\n\n434\n00:20:29.176 --> 00:20:30.192\nThat's easy.\n\n435\n00:20:30.192 --> 00:20:32.904\nAnd you can add more than one zone for\nyour different interfaces now,\n\n436\n00:20:32.904 --> 00:20:34.702\ndifferent interfaces for different zones.\n\n437\n00:20:34.702 --> 00:20:38.151\nYour public Wi-Fi might\nrequire a token you pay for.\n\n438\n00:20:38.151 --> 00:20:41.631\nYour private Wi-Fi might just\nrequire a username and password.\n\n439\n00:20:41.631 --> 00:20:44.687\nYour LAN might just require\nan acceptable use policy.\n\n440\n00:20:44.687 --> 00:20:47.925\nSo you could have three different zones,\neach with different settings.\n\n441\n00:20:47.925 --> 00:20:49.195\nReally powerful stuff.\n\n442\n00:20:49.195 --> 00:20:50.205\nAnd let me tell you,\n\n443\n00:20:50.205 --> 00:20:55.215\nthere is equipment that's out there that\ncost 50, $60,000 that does the same thing.\n\n444\n00:20:55.215 --> 00:20:56.750\nPfSense does it for free.\n\n445\n00:20:56.750 --> 00:21:00.010\nIt's right there, it's easy.\n\n446\n00:21:00.010 --> 00:21:01.359\nWell Ronnie, I think it's all I've got.\n\n447\n00:21:01.359 --> 00:21:03.610\nI can't reportedly think of\nanything else to throw in.\n\n448\n00:21:03.610 --> 00:21:05.350\n>> No, it seems like a useful tool.\n\n449\n00:21:05.350 --> 00:21:08.760\nIf you really do need it, especially with\nthings like Wi-Fi on most small companies\n\n450\n00:21:08.760 --> 00:21:10.900\nthat don't to just say yeah,\nlet's just jump on.\n\n451\n00:21:10.900 --> 00:21:14.150\nJust tell them if you can connect and\nyour password works, be great but\n\n452\n00:21:14.150 --> 00:21:15.540\nif you can't, you can't.\n\n453\n00:21:15.540 --> 00:21:16.060\nSo I like it.\n\n454\n00:21:18.020 --> 00:21:20.250\n>> Well ladies and gentlemen that\nis it for Captive Portal then.\n\n455\n00:21:20.250 --> 00:21:21.420\nI hope you guys enjoyed it.\n\n456\n00:21:21.420 --> 00:21:21.980\nStay tuned.\n\n457\n00:21:21.980 --> 00:21:27.129\nWe've got more pfSense content coming up.\n\n458\n00:21:27.129 --> 00:21:30.680\n[SOUND]\n\n",
          "vimeoId": "130769503"
        },
        {
          "description": null,
          "length": "1675",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-4-high_availability-061215-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-4-high_availability-061215-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-4-high_availability-061215-1-sm.jpg",
          "title": "High Availability",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:07.682\n[MUSIC]\n\n2\n00:00:07.682 --> 00:00:12.270\nIn this segment we're gonna take a look\nat High Availability with pfSense.\n\n3\n00:00:12.270 --> 00:00:16.848\nNow, in a normal environment, I mean\nin like a home, or a small office, or\n\n4\n00:00:16.848 --> 00:00:19.905\nanything too crazy we\ntypically have one router or\n\n5\n00:00:19.905 --> 00:00:22.737\none firewall to provide\nus internet access.\n\n6\n00:00:22.737 --> 00:00:26.020\nWAN topology there's something like\nwhat I've got pulled up on my computer.\n\n7\n00:00:26.020 --> 00:00:31.000\nI've got a little diagram that just kinda\nshows how we have a small like 192.168.0\n\n8\n00:00:31.000 --> 00:00:35.790\nnetwork for our internal, a firewall, and\nthen we're in the outside world, okay.\n\n9\n00:00:35.790 --> 00:00:38.820\nAnd this network works great for\na lot of people.\n\n10\n00:00:38.820 --> 00:00:42.305\nBut if you're a medium or a large\norganization, if you've got hundreds of\n\n11\n00:00:42.305 --> 00:00:46.031\nthousands of employees that are here,\nwhat happens when that firewall fails?\n\n12\n00:00:46.031 --> 00:00:46.575\nRight?\n\n13\n00:00:46.575 --> 00:00:48.410\nMaybe the software locks up.\n\n14\n00:00:48.410 --> 00:00:49.350\nMaybe it needs to reboot.\n\n15\n00:00:49.350 --> 00:00:51.480\nMaybe you just need to do\nan upgrade on the software and\n\n16\n00:00:51.480 --> 00:00:53.970\nyou've gotta take the firewall\noffline to do it.\n\n17\n00:00:53.970 --> 00:00:57.222\nWhat happens to everybody\nwhen that occurs?\n\n18\n00:00:57.222 --> 00:00:59.459\n>> Yeah, once you actually start\ntaking a look at something like that,\n\n19\n00:00:59.459 --> 00:01:00.880\nwe have a single point of failure.\n\n20\n00:01:00.880 --> 00:01:03.880\nAnd that means that if all of my employees\nreally do need to get connected out\n\n21\n00:01:03.880 --> 00:01:09.170\nthrough VPNs, or through anything else as\nfar as resources outside of that firewall,\n\n22\n00:01:09.170 --> 00:01:11.700\nI am done if I have\na single point of failure.\n\n23\n00:01:11.700 --> 00:01:16.090\nThe nice thing is, the way that pfSense\nalso works Is it gives us a way to be able\n\n24\n00:01:16.090 --> 00:01:19.760\nto overcome that by implementing\nwhat we call high availability.\n\n25\n00:01:19.760 --> 00:01:20.816\n>> And you might think to yourself,\n\n26\n00:01:20.816 --> 00:01:22.950\nwell the solution here is just\nto add a second firewall and\n\n27\n00:01:22.950 --> 00:01:24.840\nyou'd be right to an extent.\n\n28\n00:01:24.840 --> 00:01:27.070\nBut if you throw a second\nfirewall in there and\n\n29\n00:01:27.070 --> 00:01:33.300\ngive it different IP addresses we have one\nbig problem, and that is on our clients.\n\n30\n00:01:33.300 --> 00:01:38.157\nWhether you're on a Unix or a Linux box,\na Mac or a Windows machine,\n\n31\n00:01:38.157 --> 00:01:41.664\nall of them just let you\nset one default gateway.\n\n32\n00:01:41.664 --> 00:01:45.241\nSo when I have a workstation\nthat's out there on a network,\n\n33\n00:01:45.241 --> 00:01:51.486\nif I'm on 192.168.0 network here, I give\nit a default gateway of 192.168.0.1.\n\n34\n00:01:51.486 --> 00:01:52.916\nIf that firewall fails and\n\n35\n00:01:52.916 --> 00:01:58.680\nI've got another firewall at 192.168.0.2\nI'm gonna go change my default gateway.\n\n36\n00:01:58.680 --> 00:02:02.610\nThat means either manually changing it on\nthe computers, or changing it in DHCP and\n\n37\n00:02:02.610 --> 00:02:08.660\ntelling everybody to reboot or refresh\ntheir DNS, DHCP don't know how to do that.\n\n38\n00:02:08.660 --> 00:02:10.420\nSo that's not terribly effective.\n\n39\n00:02:10.420 --> 00:02:16.090\nSo what I really need to do is I need\nto get two firewalls in place but\n\n40\n00:02:16.090 --> 00:02:18.790\nI need it to be invisible to my end users.\n\n41\n00:02:18.790 --> 00:02:21.930\nI need my end users to\njust see one firewall and\n\n42\n00:02:21.930 --> 00:02:23.640\nnot necessarily know that there's two.\n\n43\n00:02:23.640 --> 00:02:28.304\nAnd if one fails have the other take\nover what the first one was doing.\n\n44\n00:02:28.304 --> 00:02:30.123\nRight?\nAnd have it be seamless and\n\n45\n00:02:30.123 --> 00:02:32.488\ntransparent to the end users.\n\n46\n00:02:32.488 --> 00:02:38.550\nWell in pfSense, we can leverage an open\nsource technology out there called CARP.\n\n47\n00:02:38.550 --> 00:02:42.720\nAnd CARP is\nthe Common Address Redundancy Protocol.\n\n48\n00:02:42.720 --> 00:02:45.510\nIt's an open standard for\nhaving network devices\n\n49\n00:02:45.510 --> 00:02:50.930\nlike pfSense appear as one even\nthough there might be more than one.\n\n50\n00:02:50.930 --> 00:02:54.270\nAnd that way you can have a device\nfail over and another one kicks in.\n\n51\n00:02:54.270 --> 00:02:58.217\nAnd it kind of at first glance looks\na little intimidating to get it setup, but\n\n52\n00:02:58.217 --> 00:03:00.465\nwe'll show you right here in this episode,\n\n53\n00:03:00.465 --> 00:03:02.792\nit's really not that\nhard to get it in place.\n\n54\n00:03:02.792 --> 00:03:06.357\nWe just have a couple of requirements that\nwe got to deal with and as long as we get\n\n55\n00:03:06.357 --> 00:03:09.931\nthat information together before we\nget started it's actually pretty easy.\n\n56\n00:03:09.931 --> 00:03:10.477\nAll right.\n\n57\n00:03:10.477 --> 00:03:13.766\nSo instead of diving right into\nthe config like I normally do,\n\n58\n00:03:13.766 --> 00:03:16.561\nI wanna start right here\nwith this network diagram.\n\n59\n00:03:16.561 --> 00:03:20.878\nSo, what information do we need\nbefore we make this redundant?\n\n60\n00:03:20.878 --> 00:03:25.666\nWell, first off, I need a common\nIP address on the back end here.\n\n61\n00:03:25.666 --> 00:03:28.100\nOn my local area network for\nmy machines to share.\n\n62\n00:03:28.100 --> 00:03:31.698\nIn my first example I\nshow that as 192.168.0.1.\n\n63\n00:03:31.698 --> 00:03:32.473\nI'll stick with that.\n\n64\n00:03:32.473 --> 00:03:34.147\nRight, so I'm gonna use that 0.1,\n\n65\n00:03:34.147 --> 00:03:38.240\nthat's gonna be my common address that's\nshared between these two systems.\n\n66\n00:03:38.240 --> 00:03:42.700\nBut the two systems will each need\ntheir own individual address also.\n\n67\n00:03:42.700 --> 00:03:44.238\nNow, why do I need that?\n\n68\n00:03:44.238 --> 00:03:45.958\nBecause I still need to\nmanage these devices.\n\n69\n00:03:45.958 --> 00:03:48.200\nIf I wanna log into the web\nportal of one firewall or\n\n70\n00:03:48.200 --> 00:03:50.110\nanother they need to\nhave an individual IP.\n\n71\n00:03:50.110 --> 00:03:55.210\nSo I'm gonna have to have an IP here,\nan IP here and a shared IP.\n\n72\n00:03:55.210 --> 00:03:57.510\nSo three IP addresses on the inside.\n\n73\n00:03:59.140 --> 00:04:02.820\nI'm also going to need to do that for\nthe outside.\n\n74\n00:04:02.820 --> 00:04:05.280\nNow, you might ask yourself,\nwhy on the outside?\n\n75\n00:04:05.280 --> 00:04:08.050\nI don't care about the internet,\npeople getting back to me.\n\n76\n00:04:08.050 --> 00:04:10.280\nWell, we need those replies.\n\n77\n00:04:10.280 --> 00:04:15.170\nIf I send traffic out and it passes\nthrough this top firewall on the way out,\n\n78\n00:04:15.170 --> 00:04:20.600\nthat firewall creates a temporary rule,\nthat allows the reply to come back in.\n\n79\n00:04:20.600 --> 00:04:24.050\nThat rule is not present\non the other firewall.\n\n80\n00:04:24.050 --> 00:04:26.250\nSo if the reply comes back\nto the other firewall,\n\n81\n00:04:26.250 --> 00:04:28.762\nthe other firewall doesn't necessarily\nknow about the other state, it blocks it,\n\n82\n00:04:28.762 --> 00:04:30.740\nthe traffic doesn't come back in, right?\n\n83\n00:04:30.740 --> 00:04:35.130\nI need the traffic to come back to\nthe same firewall that it left through.\n\n84\n00:04:35.130 --> 00:04:38.990\nAnd so,\nwe need to create a unified IP out here\n\n85\n00:04:38.990 --> 00:04:42.070\nthat can move between\nthe two firewalls as needed.\n\n86\n00:04:42.070 --> 00:04:47.110\nAnd you end up with one firewall that's\nactive, and the other that's a backup.\n\n87\n00:04:47.110 --> 00:04:48.250\nThe other one it's a standby.\n\n88\n00:04:48.250 --> 00:04:49.800\nIt's sitting there waiting.\n\n89\n00:04:49.800 --> 00:04:53.280\nAnd if the first firewall fails,\nthe second firewall takes over\n\n90\n00:04:53.280 --> 00:04:57.020\nall the responsibilities, and\nthat shared IP jumps over.\n\n91\n00:04:57.020 --> 00:04:58.940\nAnd now we're back in business,\nwe're up and\n\n92\n00:04:58.940 --> 00:05:01.930\nrunning and\nend users really don't even notice, right?\n\n93\n00:05:01.930 --> 00:05:03.520\nSo pretty seamless operation.\n\n94\n00:05:03.520 --> 00:05:06.490\n>> Now Don I do have a question at\nthis point actually said that about\n\n95\n00:05:06.490 --> 00:05:07.150\nthe outside,\n\n96\n00:05:07.150 --> 00:05:10.680\ndoes that mean I will need to get three\npublic IP addresses if I am doing that?\n\n97\n00:05:10.680 --> 00:05:13.370\n>> You got a choice Ronnie, ideally yes.\n\n98\n00:05:13.370 --> 00:05:15.660\nYeah, you get three public IPs\nto assign to those routers.\n\n99\n00:05:15.660 --> 00:05:18.720\nTwo are dedicated and one is shared.\n\n100\n00:05:18.720 --> 00:05:23.250\nOr you could put another device here,\nlike your cable modem or whatever, and\n\n101\n00:05:23.250 --> 00:05:27.618\nlet it get the public IP and then set up\na private network here on the inside.\n\n102\n00:05:27.618 --> 00:05:30.680\nBut what did you did just do,\ncreate another single point of failure.\n\n103\n00:05:30.680 --> 00:05:31.346\nSo if you're gonna have that,\n\n104\n00:05:31.346 --> 00:05:33.320\n[LAUGH] you might as well just abandon\nall these in the first place and\n\n105\n00:05:33.320 --> 00:05:34.075\ngo back to WAN firewall.\n\n106\n00:05:34.075 --> 00:05:34.800\nRight?\n\n107\n00:05:34.800 --> 00:05:35.750\nSo it's really a choice.\n\n108\n00:05:35.750 --> 00:05:37.770\nIf you want true high availability, yeah,\n\n109\n00:05:37.770 --> 00:05:39.940\nyou're gonna be in three public IPs for\nthis one.\n\n110\n00:05:39.940 --> 00:05:42.494\nYeah.\nAnd if you've got hundreds of thousands of\n\n111\n00:05:42.494 --> 00:05:46.200\nemployees, those IPs are gonna\ncost you about $5 a month.\n\n112\n00:05:46.200 --> 00:05:49.210\nIt's not much, so\nit's worth it to do that, yeah.\n\n113\n00:05:49.210 --> 00:05:50.600\nGo ahead and get it.\n\n114\n00:05:50.600 --> 00:05:54.320\nAll right, now that doesn't\nmean I need multiple LAN links.\n\n115\n00:05:54.320 --> 00:05:57.390\nAlthough you can, it's not ideal.\n\n116\n00:05:57.390 --> 00:06:02.390\nSo I don't need a T1 here and\na T1 here, I can still have one T1.\n\n117\n00:06:02.390 --> 00:06:05.950\nAnd have it run into a switch that\nthen feeds these two firewalls,\n\n118\n00:06:05.950 --> 00:06:09.460\nor that we split some way to\nrun to these two devices.\n\n119\n00:06:09.460 --> 00:06:13.000\nIf I do that,\nit's still one link out to the ISP.\n\n120\n00:06:13.000 --> 00:06:15.705\nI haven't paid double bandwidth,\nbut I have more than one IP on it.\n\n121\n00:06:15.705 --> 00:06:16.950\nThey give you an IP block for that.\n\n122\n00:06:18.430 --> 00:06:22.921\nIf I want true super redundancy, I would\nactually have another ISP with two more\n\n123\n00:06:22.921 --> 00:06:26.338\nlinks running to it so\nI'd be doing HA on one link to one ISP and\n\n124\n00:06:26.338 --> 00:06:30.112\nHA on the other link to the other\nISP if we wanted to really go crazy.\n\n125\n00:06:30.112 --> 00:06:33.374\nBut just to make our firewalls\nredundant is really not that bad.\n\n126\n00:06:33.374 --> 00:06:37.286\nNow the other thing is, one of these\nfirewalls is gonna be active, and\n\n127\n00:06:37.286 --> 00:06:41.730\nthe other one is gonna be passive,\nit's gonna be in backup mode.\n\n128\n00:06:41.730 --> 00:06:44.790\nAnd if the active one fails,\nthe backup one kicks in.\n\n129\n00:06:44.790 --> 00:06:48.470\nWell, one of the problems we have is that\nstate that I mentioned a moment ago.\n\n130\n00:06:48.470 --> 00:06:52.670\nAs people are passing out of this firewall\nup here, traffic is coming back and\n\n131\n00:06:52.670 --> 00:06:55.835\nthe firewall knows to allow it\nbecause it's maintaining its state.\n\n132\n00:06:55.835 --> 00:07:00.565\nSo we need a way to synchronize that\nstate between these two firewalls so\n\n133\n00:07:00.565 --> 00:07:01.775\nthey have the same information.\n\n134\n00:07:01.775 --> 00:07:04.145\nSo when a failover occurs,\npeople's state is preserved.\n\n135\n00:07:04.145 --> 00:07:08.035\nSame thing with the configuration,\nif I add a firewall rule here,\n\n136\n00:07:08.035 --> 00:07:11.030\nI need that same firewall rule\nto be available down here.\n\n137\n00:07:11.030 --> 00:07:15.190\nSo if I wanna set up high availability,\nI need to have a third interface.\n\n138\n00:07:15.190 --> 00:07:19.501\nA dedicated interface running between\nthese two firewalls that's used\n\n139\n00:07:19.501 --> 00:07:21.913\nspecifically for synchronizing data.\n\n140\n00:07:21.913 --> 00:07:22.492\nAll right.\n\n141\n00:07:22.492 --> 00:07:24.869\nNow you can use a VLAN interface for\nit, but\n\n142\n00:07:24.869 --> 00:07:28.340\nideally you wanna have\nphysical interfaces dedicated.\n\n143\n00:07:28.340 --> 00:07:31.860\nIt can just be a crossover cable between\nthe two, you don't need switches or\n\n144\n00:07:31.860 --> 00:07:34.380\nanything like that in the mix,\nalthough you can.\n\n145\n00:07:34.380 --> 00:07:39.220\nThe idea is you wanna have a non-blocking\ninterface where you're not competing for\n\n146\n00:07:39.220 --> 00:07:41.890\ntraffic against other\nhosts that are out there.\n\n147\n00:07:41.890 --> 00:07:45.100\nSo to get this set up,\nI need some information.\n\n148\n00:07:45.100 --> 00:07:50.414\nAnd here's where I kinda outline that,\nis that on each interface, I have an IP.\n\n149\n00:07:50.414 --> 00:07:53.745\nSo I'm gonna assign\n192.168.0.2 to this firewall.\n\n150\n00:07:53.745 --> 00:07:55.240\nAnd .3 to this firewall.\n\n151\n00:07:55.240 --> 00:07:58.922\nAnd they've got 209.251.159.185 here.\n\n152\n00:07:58.922 --> 00:08:00.582\nAnd 186 here.\n\n153\n00:08:00.582 --> 00:08:04.637\nAnd I'm gonna take These IPs\nthat were my gateway and\n\n154\n00:08:04.637 --> 00:08:07.224\nmy public IP and my old firewall.\n\n155\n00:08:07.224 --> 00:08:10.719\nAnd I'm gonna use those as what\nare called my virtual IPs, my VIPs.\n\n156\n00:08:10.719 --> 00:08:14.510\nAnd those VIPs, they're gonna\nbe shared between those devices.\n\n157\n00:08:14.510 --> 00:08:16.640\nThey can bounce back and\nforth depending on who's the master.\n\n158\n00:08:18.010 --> 00:08:20.440\nThen we need to add a link\nbetween the two servers, so\n\n159\n00:08:20.440 --> 00:08:21.999\nthis would be like an em2 for me.\n\n160\n00:08:21.999 --> 00:08:26.624\nOr on yours, it might eth2 or whatever\nit is that your interface type is, and\n\n161\n00:08:26.624 --> 00:08:31.264\nfrom there we go in and we assign IP\naddresses, so they can talk to each other.\n\n162\n00:08:31.264 --> 00:08:34.920\nThat's all information I need\nto have before I get started.\n\n163\n00:08:34.920 --> 00:08:37.231\nAnd assuming I've got that information,\nthe rest of it,\n\n164\n00:08:37.231 --> 00:08:38.655\nit's just kinda plugging in data.\n\n165\n00:08:38.655 --> 00:08:39.405\nIt's really not that bad.\n\n166\n00:08:40.715 --> 00:08:42.555\nSo, let's see this in action.\n\n167\n00:08:42.555 --> 00:08:46.235\nHere's my workstation and\nI am logged into my two firewalls.\n\n168\n00:08:46.235 --> 00:08:49.625\nSo, I've got pfsense-node1 and\npfsense-node2.\n\n169\n00:08:49.625 --> 00:08:51.830\nThese guys have a default install.\n\n170\n00:08:51.830 --> 00:08:55.005\nAll I've done is give them a host name and\nassigned IP addresses, so\n\n171\n00:08:55.005 --> 00:08:56.913\nI've got the IP addresses right there.\n\n172\n00:08:56.913 --> 00:09:01.114\nIt is important that you give the two\nof them different host names.\n\n173\n00:09:01.114 --> 00:09:04.415\nAnd the reason is there's a little bit\nof name look up stuff that happens in\n\n174\n00:09:04.415 --> 00:09:06.811\nthe background, and\nif they have the same host name,\n\n175\n00:09:06.811 --> 00:09:10.010\nit can't tell the firewalls apart and\nit causes some sync problems.\n\n176\n00:09:10.010 --> 00:09:14.609\nSo, make sure they have different names,\nI just called mine pfsense-node1 and\n\n177\n00:09:14.609 --> 00:09:17.820\npfsense-node2, just so\nI can remember which was which.\n\n178\n00:09:18.970 --> 00:09:20.320\nAnd I assigned those IPs,\n\n179\n00:09:20.320 --> 00:09:24.640\nthese are the dedicated IPs,\nthats what I assigned to those interfaces.\n\n180\n00:09:24.640 --> 00:09:26.960\nAnd that's really it,\nthat's all that I've done.\n\n181\n00:09:28.680 --> 00:09:33.030\nNow, to get setup before I can\neven start getting CARP in place,\n\n182\n00:09:33.030 --> 00:09:35.540\nthere's a few little\nthings that I need to do.\n\n183\n00:09:35.540 --> 00:09:38.340\nFirst off,\nI have to have a common username and\n\n184\n00:09:38.340 --> 00:09:40.530\npassword between the two systems.\n\n185\n00:09:40.530 --> 00:09:45.580\nSo, if I have an Admin account and\nmy password is password123 on node1,\n\n186\n00:09:45.580 --> 00:09:49.280\nI need an Admin account with\na password of password123 on node2.\n\n187\n00:09:49.280 --> 00:09:51.510\nThe name and password has to\nmatch between the two units.\n\n188\n00:09:52.540 --> 00:09:54.710\nAnd that's part of how\nthe config sync works.\n\n189\n00:09:54.710 --> 00:09:57.770\nWhen you make a configuration\nchange on node1, it effectively\n\n190\n00:09:57.770 --> 00:10:00.498\nlogs in to the other router, and\nmakes the same change on the other one.\n\n191\n00:10:00.498 --> 00:10:04.250\nSo, you've gotta make sure that you've\ngot that common username and password.\n\n192\n00:10:04.250 --> 00:10:06.880\nI already have that, I'm just using\nthe default Admin account, and\n\n193\n00:10:06.880 --> 00:10:07.710\nI've got a common password.\n\n194\n00:10:09.400 --> 00:10:12.558\nThe other thing is I need that\nSYNC interface to be set up.\n\n195\n00:10:12.558 --> 00:10:16.520\nSo, I'm gonna go up here to my Interfaces,\nand see how I've just got LAN and WAN?\n\n196\n00:10:16.520 --> 00:10:20.635\nSo, I'm gonna go to Assign,\nand I'm gonna configure em2,\n\n197\n00:10:20.635 --> 00:10:26.193\njust my next available interface, and\nI'm not gonna leave it called OPT1,\n\n198\n00:10:26.193 --> 00:10:30.000\nthough, I'm gonna call it SYNC so\nI can remember what it does.\n\n199\n00:10:30.000 --> 00:10:33.658\nThat's gonna be my SYNC Interface,\nI'm gonna give it a static IP.\n\n200\n00:10:33.658 --> 00:10:37.605\nAnd for its IP address,\nI'm gonna make it, and\n\n201\n00:10:37.605 --> 00:10:41.155\nyou can really just pick whatever network\nyou want, if you've only got two nodes,\n\n202\n00:10:41.155 --> 00:10:43.485\nyou can put a really\nsmall subnet if you want.\n\n203\n00:10:43.485 --> 00:10:46.875\nYou can have a CARP pool with\nlike multiple routers though, so\n\n204\n00:10:46.875 --> 00:10:48.425\nyou might specify a bigger network.\n\n205\n00:10:48.425 --> 00:10:50.210\nI'll just use the 192.168.1 network, and\n\n206\n00:10:50.210 --> 00:10:56.330\nwe'll set it to /24,\nI want it nice and big on this one.\n\n207\n00:10:56.330 --> 00:10:59.429\nSo, I'm just assigning an IP address,\nthere's no gateway or anything, I'm not\n\n208\n00:10:59.429 --> 00:11:02.463\nworried about blocking private networks\ncuz this is just gonna be used for SYNC.\n\n209\n00:11:02.463 --> 00:11:06.365\nSo, I'm just gonna set\nthat as 192.168.1.2.\n\n210\n00:11:06.365 --> 00:11:10.299\nOn the other firewall, I'm gonna go and\ndo the same thing, and just give it\n\n211\n00:11:10.299 --> 00:11:14.189\na different IP, so on the other firewall,\nI'll go to it's Interfaces.\n\n212\n00:11:14.189 --> 00:11:16.313\nI'm gonna configure its em2.\n\n213\n00:11:16.313 --> 00:11:20.248\nI'm gonna call that interface SYNC,\njust for my own benefit,\n\n214\n00:11:20.248 --> 00:11:25.386\nit actually doesn't care what the name is,\nbut for my benefit I'll call it that.\n\n215\n00:11:25.386 --> 00:11:28.394\nAnd then, I'll tell it that\nit has a Static IPv4 address.\n\n216\n00:11:28.394 --> 00:11:34.756\nAnd that address is 192.168.1.3 for\nthis guy.\n\n217\n00:11:34.756 --> 00:11:37.920\nAnd you can pick whatever IPs you want.\n\n218\n00:11:37.920 --> 00:11:39.620\nWe just need these two nodes\nto talk to each other, so\n\n219\n00:11:39.620 --> 00:11:41.514\nwhatever IPs you pick need\nto be in the same subnet.\n\n220\n00:11:43.985 --> 00:11:44.695\nSo, now we've got that.\n\n221\n00:11:45.765 --> 00:11:46.745\nNow, in order for\n\n222\n00:11:46.745 --> 00:11:50.885\nthose SYNC Interfaces to work,\nI do need to add a little firewall rule.\n\n223\n00:11:50.885 --> 00:11:54.865\nBecause what does pfSense do with new\ninterfaces that we add by default?\n\n224\n00:11:54.865 --> 00:11:58.693\nIt kind of blocks everything,\nwhich is not terribly convenient.\n\n225\n00:11:58.693 --> 00:12:02.360\nSo, [LAUGH] I'm gonna go up\nhere to Firewall and Rules, and\n\n226\n00:12:02.360 --> 00:12:05.820\nI'll go under my SYNC tab,\nand see how there's no rules?\n\n227\n00:12:05.820 --> 00:12:06.750\nI just need to allow something.\n\n228\n00:12:06.750 --> 00:12:11.830\nNow, if you're doing a crossover cable\nright between your two firewalls, you\n\n229\n00:12:11.830 --> 00:12:17.470\ncan just put in one rule that allows all\nTCP/IP version 4 traffic, and that's easy.\n\n230\n00:12:17.470 --> 00:12:18.610\nBut if it's running to a switch, and\n\n231\n00:12:18.610 --> 00:12:21.790\nthere's other stuff on the network,\nthat's not really recommended.\n\n232\n00:12:21.790 --> 00:12:25.710\nSo, you might wanna do a stricter rule\nhere that just allows traffic from that\n\n233\n00:12:25.710 --> 00:12:26.800\nother host.\n\n234\n00:12:26.800 --> 00:12:30.060\nBut in my case, I do have a crossover\ncable, so I'm just gonna come in here and\n\n235\n00:12:30.060 --> 00:12:32.090\nsay I wanna pass traffic.\n\n236\n00:12:32.090 --> 00:12:37.000\nI'm gonna pass IPv4 traffic,\nand I'll pass any protocol.\n\n237\n00:12:37.000 --> 00:12:39.190\nSo, I'm just basically\ngonna open this one wide.\n\n238\n00:12:40.540 --> 00:12:43.470\nAnd I'll do the same thing on the other\nside cuz I need those SYNC cables to\n\n239\n00:12:43.470 --> 00:12:44.470\nbe able to talk.\n\n240\n00:12:44.470 --> 00:12:47.732\nI can't synchronize configuration\nuntil they're able to talk, so\n\n241\n00:12:47.732 --> 00:12:51.513\nthis is really one of the last things that\nI have to configure on both firewalls.\n\n242\n00:12:51.513 --> 00:12:55.978\nSo, I'll go here to Firewall and Rules,\n\n243\n00:12:55.978 --> 00:13:00.698\ngo to my SYNC Interface and\nI'll add a rule,\n\n244\n00:13:00.698 --> 00:13:04.411\nallowing all that traffic again.\n\n245\n00:13:04.411 --> 00:13:08.064\nAll right, once that's done, the two\nfirewalls can now talk to each other using\n\n246\n00:13:08.064 --> 00:13:11.195\nthat SYNC Interface and that's\nexactly what I needed to be in place.\n\n247\n00:13:11.195 --> 00:13:16.123\nEverything else I do, I'll just configure\non node1 or whichever one I want\n\n248\n00:13:16.123 --> 00:13:20.516\nto be the master, and then it'll\npush the changes to the other one.\n\n249\n00:13:20.516 --> 00:13:23.454\nSo, I'm gonna jump back over to node1.\n\n250\n00:13:23.454 --> 00:13:24.279\nHere's where I'm gonna\ndo the rest of my work.\n\n251\n00:13:24.279 --> 00:13:28.730\nAnd now, we're set up to start\ndoing our configuration.\n\n252\n00:13:30.410 --> 00:13:35.000\nStep one, I need to configure\nmy Virtual IPs, my VIP's.\n\n253\n00:13:35.000 --> 00:13:37.940\nSo I'm gonna go up here to\nFirewall > Virtual IP's,\n\n254\n00:13:37.940 --> 00:13:42.930\nand I'm gonna create two VIP's.\n\n255\n00:13:42.930 --> 00:13:46.980\nOne for my LAN and one for my WAN, so\nI'll go and hit my little plus sign here.\n\n256\n00:13:46.980 --> 00:13:49.230\nAnd I'll start with the LAN one.\n\n257\n00:13:49.230 --> 00:13:51.200\nWe've created VIP's in other shows.\n\n258\n00:13:51.200 --> 00:13:53.070\nWe always did IP Aliases, but this one,\n\n259\n00:13:53.070 --> 00:13:57.400\nI'm gonna choose CARP specifically for\nredundancy.\n\n260\n00:13:57.400 --> 00:14:00.230\nAnd this one's gonna be\non my LAN Interface.\n\n261\n00:14:00.230 --> 00:14:05.860\nAnd it's gonna be 192.168.0.1, that's\nthe IP I wanna share between my systems.\n\n262\n00:14:08.160 --> 00:14:09.790\nWe do need to set a password.\n\n263\n00:14:09.790 --> 00:14:12.370\nYou don't want just somebody coming\nalong and plugging in a router,\n\n264\n00:14:12.370 --> 00:14:16.280\nand joining into your CARP pool cuz\nthey could start redirecting traffic.\n\n265\n00:14:16.280 --> 00:14:19.180\nSo, we need to make sure that we\nhave some kind of password assigned\n\n266\n00:14:19.180 --> 00:14:20.420\nto stop people from joining it.\n\n267\n00:14:21.430 --> 00:14:23.370\nYou can give it a VHID Group.\n\n268\n00:14:23.370 --> 00:14:25.983\nThe VHID Group kind of\ndetermines how failover works.\n\n269\n00:14:25.983 --> 00:14:29.968\nYou can put all of your\nVIP's in one VHID Group, and\n\n270\n00:14:29.968 --> 00:14:34.150\nif one system fails,\nthey'll all failover at once.\n\n271\n00:14:34.150 --> 00:14:38.677\nAll your different interfaces, or you can\nput each interface in its own VHID Group,\n\n272\n00:14:38.677 --> 00:14:41.637\nand that way,\none interface at a time could failover.\n\n273\n00:14:41.637 --> 00:14:44.120\nIt depends on what you're planning for.\n\n274\n00:14:44.120 --> 00:14:46.740\nIf you're planning for\nthe entire firewall failing,\n\n275\n00:14:46.740 --> 00:14:49.660\nit doesn't really matter whether you\nuse one or multiple VHID Groups.\n\n276\n00:14:49.660 --> 00:14:51.680\nIt actually defaults to multiple,\nI'll leave it that way.\n\n277\n00:14:53.110 --> 00:14:55.260\nNext, our Advertising Frequency.\n\n278\n00:14:55.260 --> 00:14:59.076\nNow, the Advertising Frequency is how we\ndetermine who is gonna be the primary,\n\n279\n00:14:59.076 --> 00:15:02.100\nwho's gonna take over in the first place.\n\n280\n00:15:02.100 --> 00:15:05.537\nThe lower the Skew number,\nthe more likely you are to become master.\n\n281\n00:15:05.537 --> 00:15:10.336\nIf you have a Skew number of 0, you will\nbe the master, and so that's my default.\n\n282\n00:15:10.336 --> 00:15:14.537\nIt's set to 0, and that's it,\nthis firewall will become the master.\n\n283\n00:15:14.537 --> 00:15:17.518\nThen, it's gonna configure\nthe secondary for me, and\n\n284\n00:15:17.518 --> 00:15:20.819\nwhen it does that, it just takes this and\nadds 100 to it, so\n\n285\n00:15:20.819 --> 00:15:24.697\nthe other one will be 100 for\nits Skew, and it'll become the backup.\n\n286\n00:15:24.697 --> 00:15:27.761\nAnd if I add a third one,\nit'll become 200, and then 300 and\n\n287\n00:15:27.761 --> 00:15:29.256\nkinda keeps going up like that.\n\n288\n00:15:29.256 --> 00:15:33.109\nIf I pick a 5 here,\nthen my backup will get a 105, by default,\n\n289\n00:15:33.109 --> 00:15:37.070\nunless I go and manually and\noverride it, which you can do.\n\n290\n00:15:37.070 --> 00:15:38.790\nBut this is just how we\nset that preference.\n\n291\n00:15:38.790 --> 00:15:40.660\nI want this one to be the master,\nso I'll leave it at 0.\n\n292\n00:15:40.660 --> 00:15:44.555\nAnd then we can give it a description,\n\n293\n00:15:44.555 --> 00:15:50.297\nI'll call this one my LAN CARP IP,\nand I'll save that.\n\n294\n00:15:50.297 --> 00:15:52.933\nAnd let's just save the password, great.\n\n295\n00:15:52.933 --> 00:15:56.694\nAnd then I'm gonna add another IP,\nand this will be another CARP one but\n\n296\n00:15:56.694 --> 00:15:58.332\nthis one is gonna be for my WAN.\n\n297\n00:15:58.332 --> 00:16:04.473\nAnd on my WAN,\nI'm gonna use 209.251.159.184.\n\n298\n00:16:04.473 --> 00:16:07.643\nThat is a /28 network for me.\n\n299\n00:16:07.643 --> 00:16:09.260\nThere we go.\n\n300\n00:16:09.260 --> 00:16:11.730\nI'll set a password on that one also.\n\n301\n00:16:11.730 --> 00:16:13.989\nNotice the VHID group is changed to 2.\n\n302\n00:16:13.989 --> 00:16:16.760\nI'll leave it that way cuz I'm\nplanning for whole firewall failure.\n\n303\n00:16:18.600 --> 00:16:20.600\nAnd then my advertising frequency.\n\n304\n00:16:20.600 --> 00:16:24.878\nLet leave that skew at 0, let this be the\nmaster and I'll call this my WAN CARP IP,\n\n305\n00:16:24.878 --> 00:16:28.680\nsee how many acronyms I can\nuse in my description there.\n\n306\n00:16:28.680 --> 00:16:29.887\nThere we go.\n\n307\n00:16:29.887 --> 00:16:32.570\nSo now, I've got those IPs\nthat I'm gonna apply it.\n\n308\n00:16:32.570 --> 00:16:34.960\nI'm not setting this up on node 2, cuz I'm\n\n309\n00:16:34.960 --> 00:16:39.000\ngoing to sync the configurations here in\na minute and that will knock that out.\n\n310\n00:16:39.000 --> 00:16:43.260\nSo once that's done,\nnow I have my virtual IPs in place.\n\n311\n00:16:43.260 --> 00:16:44.680\nAnd I'm ready to start using them.\n\n312\n00:16:44.680 --> 00:16:45.980\nSo I've got that in place.\n\n313\n00:16:45.980 --> 00:16:47.780\nThat should be all we need.\n\n314\n00:16:47.780 --> 00:16:50.200\nNext, we need to go ahead and\nget the sync set up.\n\n315\n00:16:50.200 --> 00:16:53.470\nNow, there's two parts to\nthe sync that are gonna happen.\n\n316\n00:16:53.470 --> 00:16:56.486\nThere's the state sync for\nthe communication state and\n\n317\n00:16:56.486 --> 00:16:58.678\nthen there's the configuration sync.\n\n318\n00:16:58.678 --> 00:17:01.040\nAnd they're both configured\nin the same place.\n\n319\n00:17:01.040 --> 00:17:04.960\nIf you're on the virtual IP screen,\nyou can go right to CARP Settings, and\n\n320\n00:17:04.960 --> 00:17:06.260\nthat's where it is.\n\n321\n00:17:06.260 --> 00:17:09.440\nIf you're not on the virtual IP screen,\n\n322\n00:17:09.440 --> 00:17:12.730\nunder your system menu you\nhave high availability sync.\n\n323\n00:17:12.730 --> 00:17:14.549\nAnd it takes you to the same place.\n\n324\n00:17:14.549 --> 00:17:16.740\nAnd it's the same place either way you go.\n\n325\n00:17:16.740 --> 00:17:18.660\nSo both ways work.\n\n326\n00:17:18.660 --> 00:17:22.980\nAnd right here's where we can define\nour state sync as well as our\n\n327\n00:17:22.980 --> 00:17:24.505\nconfiguration sync.\n\n328\n00:17:24.505 --> 00:17:25.480\nAnd they're not hard.\n\n329\n00:17:25.480 --> 00:17:28.190\nOn the state, we just say that\nwe want to synchronize state.\n\n330\n00:17:28.190 --> 00:17:29.800\nYes, I wanna do that.\n\n331\n00:17:29.800 --> 00:17:33.110\nWe tell it what interface we're\ngonna use for synching and\n\n332\n00:17:33.110 --> 00:17:36.300\nyou need to pick that dedicated\ninterface that you made earlier.\n\n333\n00:17:37.340 --> 00:17:41.478\nAnd then the IP address of the peer,\nthe person on the other side.\n\n334\n00:17:41.478 --> 00:17:45.271\nSo the person on the other\nside from me is 192.168.1.3,\n\n335\n00:17:45.271 --> 00:17:48.009\nthat's why I had to assign\nthat IP ahead of time.\n\n336\n00:17:48.009 --> 00:17:50.160\nSo I'd be able to provide it right here.\n\n337\n00:17:50.160 --> 00:17:53.705\nNow, it's smart enough that when it\nreaches over to that other side it will\n\n338\n00:17:53.705 --> 00:17:56.479\nconfigure this and\nit will set it to look back here at .2.\n\n339\n00:17:56.479 --> 00:17:57.710\nIt will reverse it for us.\n\n340\n00:17:59.230 --> 00:18:04.570\nSame thing down here for configuring\nour or syncing our configuration.\n\n341\n00:18:04.570 --> 00:18:06.570\nI'll put the IP that I'm syncing to.\n\n342\n00:18:08.280 --> 00:18:11.670\nSo 193.168.1.3 that's another firewall.\n\n343\n00:18:11.670 --> 00:18:14.430\nI can give the remote system username.\n\n344\n00:18:14.430 --> 00:18:17.417\nAnd remember this user has to\nbe present on both systems.\n\n345\n00:18:17.417 --> 00:18:21.150\nAuto filled something there, let me\njust type it to make sure it's right.\n\n346\n00:18:21.150 --> 00:18:24.280\nSo it does have to be the same on both\nsystems, whatever that account is.\n\n347\n00:18:24.280 --> 00:18:25.130\nI'll just punch that in there.\n\n348\n00:18:26.220 --> 00:18:28.585\nAnd then what we wanna synchronize.\n\n349\n00:18:28.585 --> 00:18:31.545\nYou can pick and choose, you don't have to\nsynchronize the whole configuration if you\n\n350\n00:18:31.545 --> 00:18:33.305\ndon't want to but normally we do.\n\n351\n00:18:33.305 --> 00:18:36.455\nSo we can go in here and start to check\nall of this stuff off that we wanna\n\n352\n00:18:36.455 --> 00:18:39.925\nsynchronize, our rules,\nour aliases, our NAT,\n\n353\n00:18:39.925 --> 00:18:43.485\nanything you leave off could potentially\nbe different between the systems.\n\n354\n00:18:43.485 --> 00:18:47.240\nNow, notice I'm checking\nthings like IPsec and OpenVPN.\n\n355\n00:18:47.240 --> 00:18:48.240\nWhat if I'm not using those?\n\n356\n00:18:48.240 --> 00:18:52.420\nIf I'm not using them, there's not\na whole lot of reason to sync them so\n\n357\n00:18:52.420 --> 00:18:54.430\nyou might be able to save\na little performance, but\n\n358\n00:18:54.430 --> 00:18:59.810\nwe're really talking about config files\nthat are 60k, 80k not a big deal.\n\n359\n00:18:59.810 --> 00:19:01.967\nSo I usually just check everything.\n\n360\n00:19:01.967 --> 00:19:05.249\nThat's what I'm gonna do is run down\nthe line, check off all this good stuff,\n\n361\n00:19:05.249 --> 00:19:06.990\neven the stuff I'm not using.\n\n362\n00:19:06.990 --> 00:19:08.880\nJust in case I turn it on later,\n\n363\n00:19:08.880 --> 00:19:11.360\nI don't have to remember like\nwhy's node 2 not working for this?\n\n364\n00:19:11.360 --> 00:19:12.420\nWell, I check it all.\n\n365\n00:19:14.390 --> 00:19:15.690\nSo we'll save that in place.\n\n366\n00:19:15.690 --> 00:19:16.920\nThere we go.\n\n367\n00:19:16.920 --> 00:19:19.450\nAnd now synch is in place.\n\n368\n00:19:19.450 --> 00:19:22.070\nNow, how do I know synch is working?\n\n369\n00:19:22.070 --> 00:19:22.990\nWell, it's easy.\n\n370\n00:19:22.990 --> 00:19:24.810\nI can just go look at the other node.\n\n371\n00:19:24.810 --> 00:19:29.210\nI configured the VIPs on node1,\nI didn't configure those on node2.\n\n372\n00:19:29.210 --> 00:19:32.200\nI configured sync on node1,\nI didn't configure those on node2.\n\n373\n00:19:32.200 --> 00:19:35.098\nSo if I go look at node2,\nit should have these settings.\n\n374\n00:19:35.098 --> 00:19:37.785\nAnd if you haven't noticed, I'm kinda\nstalling here to make sure it has time.\n\n375\n00:19:37.785 --> 00:19:40.575\nI'm gonna jump over to node2,\nand let's find out.\n\n376\n00:19:40.575 --> 00:19:44.725\nI'm gonna go to firewall and VIPs and\nsure enough, there they are.\n\n377\n00:19:44.725 --> 00:19:46.345\nNode2 has it.\n\n378\n00:19:46.345 --> 00:19:49.585\nAnd if I go to System >\nHigh Availability Sync,\n\n379\n00:19:49.585 --> 00:19:54.270\nit's populated and oh,\nactually it hasn't populated this one yet.\n\n380\n00:19:54.270 --> 00:19:57.072\nThis takes a little bit longer to be\nable to pull the configuration back from\n\n381\n00:19:57.072 --> 00:19:59.130\nthe other side, but it will get set.\n\n382\n00:19:59.130 --> 00:20:01.430\nBut I do see the VIPs, so\nI do know it's synching.\n\n383\n00:20:01.430 --> 00:20:06.442\nThe data's coming over and\nwe are almost ready to rock.\n\n384\n00:20:06.442 --> 00:20:10.885\nI say almost because we\nhaven't actually configured\n\n385\n00:20:10.885 --> 00:20:14.610\nour true full redundancy at this point.\n\n386\n00:20:14.610 --> 00:20:16.010\nWell it technically we have.\n\n387\n00:20:16.010 --> 00:20:19.950\nUsually what we've done right\nhere is enough to get us by, and\n\n388\n00:20:19.950 --> 00:20:22.920\nCARP should kick in on it's own but\nI have seen where it hasn't.\n\n389\n00:20:22.920 --> 00:20:24.490\nSo let's double check that and\n\n390\n00:20:24.490 --> 00:20:27.859\nmake sure oh, there is one other\nthing that I gotta do I forgot about.\n\n391\n00:20:29.290 --> 00:20:30.990\nThe default NAT rules.\n\n392\n00:20:30.990 --> 00:20:33.210\nThe default NAT rules that\nare created in the router.\n\n393\n00:20:33.210 --> 00:20:38.630\nin the firewall, say any inside traffic\ngoing out gets NAT to our WAN IP.\n\n394\n00:20:38.630 --> 00:20:40.020\nWell, I don't want that to happen.\n\n395\n00:20:40.020 --> 00:20:45.190\nI want it to get NAT to our WAN VIP, the\nVirtual IP not the one on my interface.\n\n396\n00:20:45.190 --> 00:20:46.750\nSo I need to edit my NAT rules.\n\n397\n00:20:46.750 --> 00:20:48.550\nSo let's jump in and do that real quick.\n\n398\n00:20:48.550 --> 00:20:49.810\nI'll go to Firewall.\n\n399\n00:20:49.810 --> 00:20:51.838\nAnd next,\nactually let me just hit Save here and\n\n400\n00:20:51.838 --> 00:20:53.774\nmake sure that I saved\nall that after I did it.\n\n401\n00:20:53.774 --> 00:20:55.274\nI'm pretty sure I did.\n\n402\n00:20:55.274 --> 00:20:57.710\nAnd then I'll go up\nhere to Firewall > NAT.\n\n403\n00:20:59.340 --> 00:21:04.560\nAnd if I go to outbound, that default\noutbound rule is naving to my WAN address.\n\n404\n00:21:04.560 --> 00:21:06.640\nI need that to NAT to my VIP.\n\n405\n00:21:06.640 --> 00:21:08.270\nUnfortunately you can't\nedit these default rules,\n\n406\n00:21:08.270 --> 00:21:09.790\nyou have to switch to manual to do it.\n\n407\n00:21:09.790 --> 00:21:13.180\nSo I'll do that I'm gonna\nflip over to manual.\n\n408\n00:21:13.180 --> 00:21:15.610\nAnd now, I see them individually and\nI can edit them.\n\n409\n00:21:15.610 --> 00:21:17.230\nNow, I don't really care about NAT for\n\n410\n00:21:17.230 --> 00:21:20.040\nmy synced network, the synced network\nis never going out to the Internet.\n\n411\n00:21:20.040 --> 00:21:23.070\nI don't care about NAT for\nmy 127 network, cuz that's a loop back.\n\n412\n00:21:23.070 --> 00:21:25.600\nSo I really just care about these here for\nthe LAN.\n\n413\n00:21:25.600 --> 00:21:27.190\nAnd so I'm gonna edit these rules.\n\n414\n00:21:28.330 --> 00:21:31.480\nAnd I'm gonna change them so\nthat when they go out,\n\n415\n00:21:31.480 --> 00:21:36.510\ninstead of NATting to the interface,\nI'll choose my WAN CARP IP.\n\n416\n00:21:36.510 --> 00:21:42.470\nI want them to NAT to that,\nnot to where it was defaulting to.\n\n417\n00:21:42.470 --> 00:21:46.060\nAnd then I'll edit the other\nrule to do the same thing, so\n\n418\n00:21:46.060 --> 00:21:47.260\nit will NAT out to that CARP IP.\n\n419\n00:21:50.060 --> 00:21:54.560\nOnce that's done, now when my inside\npeople go out to the Internet,\n\n420\n00:21:54.560 --> 00:21:56.770\nthey'll get NATted to the CARP IP.\n\n421\n00:21:57.790 --> 00:22:02.294\nAnd that will make sure it pushes them\nout and we should see everybody happy.\n\n422\n00:22:02.294 --> 00:22:05.565\nSo we apply that change,\njust verify it's there.\n\n423\n00:22:05.565 --> 00:22:08.735\nAnd it is, so\nwe should be good on that one.\n\n424\n00:22:08.735 --> 00:22:11.825\nAnother thing that I may or may not\nhave to do, if you're using DHCP on\n\n425\n00:22:11.825 --> 00:22:15.837\nyour firewall, you're handing out\nDHCP addresses to your clients and\n\n426\n00:22:15.837 --> 00:22:18.957\nthe default gateway by\ndefault is your firewall.\n\n427\n00:22:18.957 --> 00:22:22.217\nWell we should change that\nto be the LAN carp IP.\n\n428\n00:22:22.217 --> 00:22:24.958\nI can't remember if I'm running DHCP or\nnot so let's go find out.\n\n429\n00:22:24.958 --> 00:22:30.097\nSo I'm gonna go to my DHCP server and LAN\nand I'm not, I'm not actually running it.\n\n430\n00:22:30.097 --> 00:22:32.827\nBut let's say I turn it on here,\nI'll turn it on what the heck,\n\n431\n00:22:32.827 --> 00:22:33.967\nwe'll go crazy with it.\n\n432\n00:22:33.967 --> 00:22:37.100\nSo I'm gonna turn on my DHCP server.\n\n433\n00:22:37.100 --> 00:22:40.986\nAnd by default it's gonna\nhand out itself as DNS.\n\n434\n00:22:40.986 --> 00:22:43.690\nAnd it's gonna hand out itself as gateway.\n\n435\n00:22:43.690 --> 00:22:45.920\nBut I don't want that because\nthis firewall might fail.\n\n436\n00:22:45.920 --> 00:22:48.697\nI wanna hand out my VIPs instead.\n\n437\n00:22:48.697 --> 00:22:53.010\nSo I am gonna hand out 192.168.01 as DNS,\nand\n\n438\n00:22:53.010 --> 00:22:57.090\n192.168.01 as my default gateway.\n\n439\n00:22:57.090 --> 00:22:58.440\nThat way, it's not tied to node1.\n\n440\n00:22:58.440 --> 00:23:00.070\nIt's not tied to node2.\n\n441\n00:23:00.070 --> 00:23:03.273\nIt's tied to that virtual IP.\n\n442\n00:23:03.273 --> 00:23:06.870\nI'll go ahead and save that and\nnow I've got DHCP in business.\n\n443\n00:23:08.460 --> 00:23:10.390\nAt this point, we should be good.\n\n444\n00:23:10.390 --> 00:23:13.490\nCARP is likely automatically turned on.\n\n445\n00:23:13.490 --> 00:23:14.800\nLet's find out.\n\n446\n00:23:14.800 --> 00:23:17.393\nIf we go up here to status,\nyou've got CARP failover.\n\n447\n00:23:17.393 --> 00:23:18.990\nIt's the very first one.\n\n448\n00:23:18.990 --> 00:23:20.610\nAnd it should've turned on.\n\n449\n00:23:20.610 --> 00:23:24.590\nAnd when you go in here what you should\nsee is that your status is MASTER.\n\n450\n00:23:25.770 --> 00:23:29.950\nIf it didn't turn on you'll actually see a\nbutton here that will say Enable CARP and\n\n451\n00:23:29.950 --> 00:23:31.150\nyou can click it and that'll turn it on.\n\n452\n00:23:31.150 --> 00:23:33.670\nBut normally it turns itself on\nbecause of the sync stuff and\n\n453\n00:23:33.670 --> 00:23:35.170\nother traffic that's going on.\n\n454\n00:23:35.170 --> 00:23:37.560\nBut I can see that my\nvirtual IPs are active.\n\n455\n00:23:37.560 --> 00:23:42.900\nI'm the Master, so node1 is up and\nrunning and handling these.\n\n456\n00:23:42.900 --> 00:23:44.450\nLet's check out node2.\n\n457\n00:23:44.450 --> 00:23:50.040\nIf I jump over to node2 and\ngo to Status > CARP, there it is.\n\n458\n00:23:50.040 --> 00:23:53.025\nIt's got the VIPs and\nits status is BACKUP.\n\n459\n00:23:53.025 --> 00:23:57.149\nIt's now the backup firewall for\nmy system.\n\n460\n00:23:57.149 --> 00:24:01.559\nI'm gonna take my work station, and\nI'm going to flip over to DHCP Since we\n\n461\n00:24:01.559 --> 00:24:05.410\nenabled DHCP on the network now,\nI think I had a static IP before.\n\n462\n00:24:05.410 --> 00:24:09.850\nBut we can go DHCP style or\nI could actually stay with static too.\n\n463\n00:24:09.850 --> 00:24:13.643\nIf I just want to change my default\ngateway or whatever to that VIP,\n\n464\n00:24:13.643 --> 00:24:16.559\nI'm gonna change that 192.168.0.1,\n\n465\n00:24:16.559 --> 00:24:20.600\nthat's what I'm gonna use now\nas my default gateway, my DNS.\n\n466\n00:24:20.600 --> 00:24:22.045\nSo I'm gonna go ahead and get that set.\n\n467\n00:24:24.646 --> 00:24:29.020\nAnd if I,\njust want to verify communication's here.\n\n468\n00:24:29.020 --> 00:24:31.657\nI'm gonna fire up a command prompt.\n\n469\n00:24:31.657 --> 00:24:37.192\nDo an ipconfig action, and I can see\nthat my default gateway is 192.186.0.1.\n\n470\n00:24:37.192 --> 00:24:40.560\nNotice how I have two default gateways for\nIPv6.\n\n471\n00:24:40.560 --> 00:24:44.480\nI'm detecting both firewalls with IPv6 so\nit knows they're both out there, but\n\n472\n00:24:44.480 --> 00:24:45.630\nI'm only seeing that one VIP.\n\n473\n00:24:46.710 --> 00:24:51.170\nAnd if I try and ping out to the internet,\nright, I'm going out and\n\n474\n00:24:51.170 --> 00:24:53.320\nable to get to the internet.\n\n475\n00:24:53.320 --> 00:24:57.610\nAnd if I do an arp -a I've\ngot 192.168.0.1, .2, .3,\n\n476\n00:24:57.610 --> 00:25:00.460\ncuz I've got the web pages pooled up.\n\n477\n00:25:00.460 --> 00:25:03.170\nBut this is a virtual\nMAC address right here.\n\n478\n00:25:03.170 --> 00:25:06.500\nIt's a fake MAC address that's\nbeen assigned to that VIP.\n\n479\n00:25:06.500 --> 00:25:09.910\nAnd when I go out to the internet,\nthat's who I'm passing through.\n\n480\n00:25:09.910 --> 00:25:13.610\nSo when I go out to 4.2.2.1, right?\n\n481\n00:25:13.610 --> 00:25:18.450\nI'm going to 192.168.0.1, which can be\nhosted on either of those firewalls.\n\n482\n00:25:18.450 --> 00:25:21.810\nAnd see how via the MAC address\nthat identified that I went to .2,\n\n483\n00:25:21.810 --> 00:25:25.380\nthat's node one,\nthat's my nest there, alright?\n\n484\n00:25:25.380 --> 00:25:26.960\nHere's the fun part.\n\n485\n00:25:26.960 --> 00:25:30.020\nI'm gonna do a constant ping.\n\n486\n00:25:30.020 --> 00:25:32.850\nSo now I'm pinging out to this host.\n\n487\n00:25:32.850 --> 00:25:33.962\nLet's say one of my firewalls fails.\n\n488\n00:25:33.962 --> 00:25:38.890\nI'm gonna take node one, so this guy right\nhere, wait, this is pfsense node two.\n\n489\n00:25:38.890 --> 00:25:42.520\nLet me go to pfsense node one and\nit's a virtual machine.\n\n490\n00:25:42.520 --> 00:25:44.070\nI'm gonna pause it.\n\n491\n00:25:44.070 --> 00:25:47.510\nNow when you pause it that\nmachine stops responding.\n\n492\n00:25:47.510 --> 00:25:50.070\nNode two is still working.\n\n493\n00:25:50.070 --> 00:25:54.460\nNode two will sense that node\none is down and it'll take over.\n\n494\n00:25:54.460 --> 00:25:55.300\nAnd look right there.\n\n495\n00:25:55.300 --> 00:25:58.040\nI lost one ping and node two took over.\n\n496\n00:25:58.040 --> 00:25:59.345\nI'm getting back out\nto the internet again.\n\n497\n00:25:59.345 --> 00:26:07.370\nAnd I can verify that if I go to my\nbrowser and go over to node two.\n\n498\n00:26:07.370 --> 00:26:12.020\nOn my status screen, if I refresh this\nscreen, node two is now the master.\n\n499\n00:26:12.020 --> 00:26:13.590\nIt's up, it's running.\n\n500\n00:26:13.590 --> 00:26:15.120\nNode one is completely failed.\n\n501\n00:26:15.120 --> 00:26:17.950\nMaybe I took it offline to do some\nupgrades, or some maintenance, or\n\n502\n00:26:17.950 --> 00:26:20.510\nwhatever node two is up and\nrunning and it's happy.\n\n503\n00:26:20.510 --> 00:26:21.920\nAnd when I fix node one and\n\n504\n00:26:21.920 --> 00:26:26.820\nI get it all happy again I can power it\nback on and watch how fast this happens.\n\n505\n00:26:26.820 --> 00:26:31.290\nOn node one I'm gonna power it up, it's\ngonna synchronize state with the other\n\n506\n00:26:31.290 --> 00:26:38.290\nnode and as soon as it's done,\nnode two will become the backup again.\n\n507\n00:26:38.290 --> 00:26:41.800\nNode one will become the master,\nI should have to log in.\n\n508\n00:26:42.840 --> 00:26:45.140\nOh, I paused it, so it remembers my state.\n\n509\n00:26:45.140 --> 00:26:48.370\nBut if I look at my command prompt, I\ndidn't even lose a single ping that time.\n\n510\n00:26:48.370 --> 00:26:49.100\n>> Very nice.\n\n511\n00:26:49.100 --> 00:26:52.260\n>> There were a couple of\nother larger delays there,\n\n512\n00:26:52.260 --> 00:26:55.170\nbut it was that fast coming back online.\n\n513\n00:26:55.170 --> 00:26:58.380\nThis works really well and\nit's not very hard to do, right?\n\n514\n00:26:58.380 --> 00:27:01.576\nWe just set it up in this episode,\nwhich would have been, what,\n\n515\n00:27:01.576 --> 00:27:03.070\nless than like 30 minutes.\n\n516\n00:27:03.070 --> 00:27:03.633\nIt's not a hard thing to put in place.\n\n517\n00:27:03.633 --> 00:27:04.169\n>> It's awesome.\n\n518\n00:27:05.370 --> 00:27:06.910\nYeah, so if you've got that firewall.\n\n519\n00:27:06.910 --> 00:27:08.610\nIf it's a critical piece\nof your infrastructure and\n\n520\n00:27:08.610 --> 00:27:12.240\nyou definitely don't want it to go down,\nyou can whip up something like this.\n\n521\n00:27:12.240 --> 00:27:13.980\nIt works great, you can put it in place.\n\n522\n00:27:13.980 --> 00:27:16.280\nAnd now you've got that\nlevel redundancy and\n\n523\n00:27:16.280 --> 00:27:19.530\nyou don't have a single point of\nfailure on your firewall anymore.\n\n524\n00:27:19.530 --> 00:27:22.870\nSo, Common Address Redundancy Protocol,\nCARP\n\n525\n00:27:22.870 --> 00:27:26.570\nit's a great solution built into pfSense,\ndefinitely something to make use of.\n\n526\n00:27:26.570 --> 00:27:27.940\n>> Very nice.\n\n527\n00:27:27.940 --> 00:27:30.920\n>> All right, well ladies and gentlemen,\nI think that about wraps it up for High\n\n528\n00:27:30.920 --> 00:27:35.290\navailability and CARP Do remember there's\nother things to plan for with availability\n\n529\n00:27:35.290 --> 00:27:39.500\nlike your switches, your WAN links,\nyour connections to the ISPs, that stuff.\n\n530\n00:27:39.500 --> 00:27:42.060\nBut on the firewall side,\nthat's our solution.\n\n531\n00:27:42.060 --> 00:27:44.660\nIt works great,\ndefinitely take advantage of that.\n\n532\n00:27:44.660 --> 00:27:46.130\nWell I hope you guys enjoyed the show.\n\n533\n00:27:46.130 --> 00:27:49.055\nStay tuned we got more\npfSense content coming up.\n\n534\n00:27:49.055 --> 00:27:54.900\n[MUSIC]\n\n",
          "vimeoId": "130769501"
        },
        {
          "description": null,
          "length": "1839",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-5-routing_protocols-062915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-5-routing_protocols-062915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-5-5-routing_protocols-062915-1-sm.jpg",
          "title": "Routing Protocols",
          "transcript": "WEBVTT\n\n1\n00:00:00.310 --> 00:00:07.507\n[MUSIC]\n\n2\n00:00:07.507 --> 00:00:08.414\nIn this segment,\n\n3\n00:00:08.414 --> 00:00:12.435\nwe're going to take a look at using\nrouting protocols with PF Sense Firewall.\n\n4\n00:00:12.435 --> 00:00:17.460\nWith Pfsense firewall, we can configure\nstatic routing, as well as dynamic routing\n\n5\n00:00:17.460 --> 00:00:21.910\nprotocols to work and do all the things\nthat our traditional routers would do.\n\n6\n00:00:21.910 --> 00:00:25.090\nDon, if I end up having\na router that can actually do\n\n7\n00:00:25.090 --> 00:00:28.360\nall of these different things and\na firewall that can do it,\n\n8\n00:00:28.360 --> 00:00:31.920\nwhy would I choose to ever run\nrouting protocols on my firewall?\n\n9\n00:00:31.920 --> 00:00:35.030\n>> For the longest time,\nwe always maintained separate devices.\n\n10\n00:00:35.030 --> 00:00:36.930\nYou had the router which\nconnected you to the Internet, and\n\n11\n00:00:36.930 --> 00:00:40.350\nthen you had the firewall that protected\nyou from the Internet and the router.\n\n12\n00:00:40.350 --> 00:00:43.270\nBut that's really not necessary anymore.\n\n13\n00:00:43.270 --> 00:00:46.430\nEvery firewall that's out there\nis capable of being a router.\n\n14\n00:00:46.430 --> 00:00:50.550\nAnd so you can actually eliminate the\nrouter and consolidate down to one device.\n\n15\n00:00:50.550 --> 00:00:53.570\nYou eliminate a point of failure\non your network if you want.\n\n16\n00:00:53.570 --> 00:00:56.720\nThe only time you really need a dedicated\nrouter anymore is when you're connecting\n\n17\n00:00:56.720 --> 00:00:59.420\nsome kind of specialized WAN interface,\nright?\n\n18\n00:00:59.420 --> 00:01:03.580\nYou can go out and you can buy routers\nthat have Serial T1 cards in them,\n\n19\n00:01:03.580 --> 00:01:09.000\nthat have optical fiber connections for\nOC 12s, or things like that, an ISDN.\n\n20\n00:01:09.000 --> 00:01:11.090\nYou can buy that in a router.\n\n21\n00:01:11.090 --> 00:01:13.750\nYou can't buy firewalls that\nhave those custom interfaces.\n\n22\n00:01:14.810 --> 00:01:17.150\nReally, that's the only time\nyou need a router anymore.\n\n23\n00:01:17.150 --> 00:01:20.060\nNow you just have a firewall\nthat performs that function, and\n\n24\n00:01:20.060 --> 00:01:22.930\nPF sense does a really good job at it.\n\n25\n00:01:22.930 --> 00:01:24.180\nThere are some advanced things.\n\n26\n00:01:24.180 --> 00:01:26.722\nIf you work for\nan internet service provider or\n\n27\n00:01:26.722 --> 00:01:31.218\nif you're handling b g p tables, you don't\nwant to mess with pf sense as a router,\n\n28\n00:01:31.218 --> 00:01:33.272\nit's not going to work well for you.\n\n29\n00:01:33.272 --> 00:01:38.040\nBut for a home user, a branch office,\neven a corporate like an enterprise data\n\n30\n00:01:38.040 --> 00:01:41.190\ncenter, you can us p f sense as\na router and it does a pretty good job.\n\n31\n00:01:42.350 --> 00:01:46.440\nDedicated routers will have hardware that\nassists moving their packets faster and\n\n32\n00:01:46.440 --> 00:01:49.120\ndoing like packet inspection,\nthings of those natures.\n\n33\n00:01:49.120 --> 00:01:51.940\nPFSense on the other hand is doing\nthis in general purpose CPUs, so you\n\n34\n00:01:51.940 --> 00:01:55.080\ncan see some different load performance\nout of it, you have to monitor that.\n\n35\n00:01:55.080 --> 00:01:58.840\nBut otherwise, as far as basic routing\nis concerned, it's a great alternative.\n\n36\n00:01:58.840 --> 00:02:00.880\nFor home offices, and branch offices,\n\n37\n00:02:00.880 --> 00:02:03.620\nthere is really no need to\nmaintain two devices anymore.\n\n38\n00:02:03.620 --> 00:02:07.250\nConsolidate it down and\nhave your firewall be your router.\n\n39\n00:02:07.250 --> 00:02:10.070\n>> Alright, so when we start taking a look\nat some of the different ways that we\n\n40\n00:02:10.070 --> 00:02:14.420\ncan go ahead and use routing and PSN's\nfirewall, one of the easiest ways and\n\n41\n00:02:14.420 --> 00:02:17.890\none of the most direct ways that you and\nI will actually use it is by creating what\n\n42\n00:02:17.890 --> 00:02:22.260\nwe call status routes, and we've talked\nabout the idea of creating static routes.\n\n43\n00:02:22.260 --> 00:02:25.110\nWell, this is when we\nadministratively configure it.\n\n44\n00:02:25.110 --> 00:02:29.280\nIn other words, we say here's what we want\nthat router to do, so we want to make sure\n\n45\n00:02:29.280 --> 00:02:34.350\nthat we actually do that, and we set it in\nthere, and nothing ever changes with that.\n\n46\n00:02:34.350 --> 00:02:36.310\nSo, it doesn't matter if\nthe rest of network changes,\n\n47\n00:02:36.310 --> 00:02:39.140\nmy routes will always be the same.\n\n48\n00:02:39.140 --> 00:02:42.310\nThe advantage of it though is that\nit actually is something that,\n\n49\n00:02:42.310 --> 00:02:46.000\nit's exactly what I want, but\nit also keeps the routing table nice and\n\n50\n00:02:46.000 --> 00:02:48.430\nsmall, nothing's ever\ngoing to get in there.\n\n51\n00:02:48.430 --> 00:02:50.490\nThen there's some disadvantages too.\n\n52\n00:02:50.490 --> 00:02:55.990\nThe big disadvantage is it's, for at least\nour sake's here, if the network does\n\n53\n00:02:55.990 --> 00:02:59.010\nchange and now we actually have a network\nout there that doesn't change, well,\n\n54\n00:02:59.010 --> 00:03:02.060\nthat means we have to go in and actually\nadministratively change it as well.\n\n55\n00:03:02.060 --> 00:03:04.070\nAnd there may be other\ndisadvantages out there, too.\n\n56\n00:03:04.070 --> 00:03:08.210\nIt could be a little bit slower to try and\nget everything back up and running, but\n\n57\n00:03:08.210 --> 00:03:12.510\noverall, though, it is something you\ncan take advantage of in PFSense.\n\n58\n00:03:12.510 --> 00:03:15.570\n>> And it is pretty easy to set up,\nlet me show you here on my firewall.\n\n59\n00:03:15.570 --> 00:03:19.390\nSo, you actually already\nset up at least one static\n\n60\n00:03:19.390 --> 00:03:21.610\nroute on your firewall when\nyou did the initial setup.\n\n61\n00:03:21.610 --> 00:03:25.290\nOn the initial it asked who your default\ngateway was, if your router wants to get\n\n62\n00:03:25.290 --> 00:03:28.300\nout to the internet, who does it reach\nout to, and maybe you didn't set that.\n\n63\n00:03:28.300 --> 00:03:31.060\nMaybe you said my WAN interface\nis going to use DHCP to get\n\n64\n00:03:31.060 --> 00:03:32.850\nan address from your service provider.\n\n65\n00:03:32.850 --> 00:03:36.520\nSo, if you did that,\nthen you got a gateway from them and\n\n66\n00:03:36.520 --> 00:03:39.120\nthat is kind of your first static route.\n\n67\n00:03:39.120 --> 00:03:41.690\nIf you go up to your system menu,\nyou'll see routing.\n\n68\n00:03:42.690 --> 00:03:46.360\nAnd inside of routing,\nhere's where we can define gateways.\n\n69\n00:03:46.360 --> 00:03:48.090\nGateways are default routes, and\n\n70\n00:03:48.090 --> 00:03:51.370\nthese are really the first kind of\nstatic route that most people work with.\n\n71\n00:03:51.370 --> 00:03:55.060\nIt's normally just the IP address of\nyour internet service provider, right?\n\n72\n00:03:55.060 --> 00:03:57.210\nWho do you go to to get\nout to the Internet?\n\n73\n00:03:57.210 --> 00:03:58.370\nSo, you'll have a gateway.\n\n74\n00:03:58.370 --> 00:04:02.970\nIf you're using DHCP it will show\nup just like this: wan dhcp.\n\n75\n00:04:02.970 --> 00:04:06.270\nI'm getting a dynamic address from\nmy Internet service provider and\n\n76\n00:04:06.270 --> 00:04:08.190\nthis is the gateway they've given me.\n\n77\n00:04:08.190 --> 00:04:11.984\nSo, I've put a static route in, I've said\nI've done it, the router has done it for\n\n78\n00:04:11.984 --> 00:04:13.450\nme, the firewall.\n\n79\n00:04:13.450 --> 00:04:14.970\nIt said, alright 0.0.0.0,\n\n80\n00:04:14.970 --> 00:04:19.830\nwhich is a wildcard network,\na network that encompasses everything,\n\n81\n00:04:19.830 --> 00:04:22.880\nis available through this\nInternet service provider, right?\n\n82\n00:04:22.880 --> 00:04:25.850\nAnd you can add in more\ngateways if you want.\n\n83\n00:04:25.850 --> 00:04:28.440\nNow, we don't normally have\nto if we're using DHCP.\n\n84\n00:04:28.440 --> 00:04:31.920\nIf we're doing static, we might want\nto manually put some in there and\n\n85\n00:04:31.920 --> 00:04:33.560\nyou can define a priority, right?\n\n86\n00:04:33.560 --> 00:04:36.950\nYou can give them a metric and\nsay I prefer this route over that route,\n\n87\n00:04:36.950 --> 00:04:40.540\nif you have more than one\nISP you can do that, right?\n\n88\n00:04:40.540 --> 00:04:43.750\nBut, we typically just\nhave one default gateway,\n\n89\n00:04:43.750 --> 00:04:45.580\nwhoever it is that gets\nus out to the Internet.\n\n90\n00:04:46.580 --> 00:04:49.940\nAnd after that,\nwe can go to the routes tab, and\n\n91\n00:04:49.940 --> 00:04:54.910\nright here is where we can configure\nmanual routes for individual networks.\n\n92\n00:04:54.910 --> 00:04:58.800\nFor example, maybe I'm starting to\ndo work with another company, right?\n\n93\n00:04:58.800 --> 00:05:01.200\nSo we've got a second company\nthat we're partnering with.\n\n94\n00:05:01.200 --> 00:05:02.040\nAnd we have so\n\n95\n00:05:02.040 --> 00:05:05.080\nmuch data moving back and forth that\nwe decide to build a VPN tunnel.\n\n96\n00:05:05.080 --> 00:05:07.840\nBut not here through\nthis pfSense firewall.\n\n97\n00:05:07.840 --> 00:05:11.000\nInstead, we have a dedicated firewall\nsomewhere else on our network.\n\n98\n00:05:11.000 --> 00:05:14.690\nAnd we build the VPN tunnel from\nthat firewall to the third party.\n\n99\n00:05:15.870 --> 00:05:20.390\nAnd if their network is\nlike a private address,\n\n100\n00:05:20.390 --> 00:05:25.386\nmaybe they're using 172.16.0.0,\nthat RFC 1918 private address range,\n\n101\n00:05:25.386 --> 00:05:29.750\nI might want to direct that network\nover to the other firewall.\n\n102\n00:05:29.750 --> 00:05:32.030\nSo, I can just come in here and\nI can hit add.\n\n103\n00:05:32.030 --> 00:05:35.580\nAnd I can say, yeah, if I'm trying to get\nto that partner network, 172.16.0.0/16,\n\n104\n00:05:35.580 --> 00:05:42.290\nif I'm trying to get to that,\n\n105\n00:05:42.290 --> 00:05:45.100\ndon't go through my gateway like normal,\nright?\n\n106\n00:05:45.100 --> 00:05:49.490\nInstead, I want to send you\nthrough this other host.\n\n107\n00:05:49.490 --> 00:05:53.310\nNow when I look here,\nI hit the drop down box and\n\n108\n00:05:53.310 --> 00:05:54.510\nI just see the ones that I’ve learned.\n\n109\n00:05:54.510 --> 00:05:56.380\nI don’t see the option\nto type anything in.\n\n110\n00:05:56.380 --> 00:06:00.050\nBut you’ll see I’ve got this\nred link to add a new gateway.\n\n111\n00:06:00.050 --> 00:06:02.080\nAnd so I’m going to add a new gateway in.\n\n112\n00:06:02.080 --> 00:06:03.875\nIt’s not going to be a default.\n\n113\n00:06:03.875 --> 00:06:06.383\nThat’s going to make this a little\ndifferent from what we’ve seen\n\n114\n00:06:06.383 --> 00:06:07.068\nin other routes.\n\n115\n00:06:07.068 --> 00:06:12.037\nAnd so I'm going to call this,\nmaybe this is Firewall-2.\n\n116\n00:06:12.037 --> 00:06:16.750\nAnd I'll punch in its IP address, and\nI can give it a description or whatever.\n\n117\n00:06:16.750 --> 00:06:18.210\nI'll call this my Partner VPN.\n\n118\n00:06:18.210 --> 00:06:20.680\nAnd it's kind of small.\n\n119\n00:06:20.680 --> 00:06:23.020\nLet me zoom that in a little bit.\n\n120\n00:06:23.020 --> 00:06:25.070\nSo now, what I'm doing is\nI'm basically just saying,\n\n121\n00:06:25.070 --> 00:06:28.580\nhey, when you want to get\nto the 172.16 network,\n\n122\n00:06:28.580 --> 00:06:32.560\nInstead of going out my default gateway,\ngo to this gateway instead.\n\n123\n00:06:32.560 --> 00:06:36.926\nGo to 192.168.0.2,\nI'm going to save that gateway, and\n\n124\n00:06:36.926 --> 00:06:39.890\nit's gonna tell me it\ncan't save it this time.\n\n125\n00:06:39.890 --> 00:06:40.920\nThat's convenient.\n\n126\n00:06:40.920 --> 00:06:44.160\nSo let's try that again,\nwhat is going on there?\n\n127\n00:06:44.160 --> 00:06:46.300\nAll right,\nwell let me add it the manual way.\n\n128\n00:06:46.300 --> 00:06:47.900\nSo if I go back out to routing.\n\n129\n00:06:48.920 --> 00:06:51.120\nAlright, and I can go right\nhere on my gateway screen and\n\n130\n00:06:51.120 --> 00:06:53.100\nI can add the new gateway here.\n\n131\n00:06:53.100 --> 00:06:55.050\nAnd so I'm going to come in,\nand I'm going to punch it in.\n\n132\n00:06:55.050 --> 00:06:58.070\nThis one's actually going to be on my\nLAN interface, not on my WAN, and oh,\n\n133\n00:06:58.070 --> 00:07:00.740\nyou know, I didn't change that\ndrop-down box on the other one, so\n\n134\n00:07:00.740 --> 00:07:03.030\nthat's probably why it was\nerroring out on that one.\n\n135\n00:07:03.030 --> 00:07:06.790\nSo, I'll just put it back in here,\nso that was my mistake.\n\n136\n00:07:06.790 --> 00:07:13.170\nSo I'm going to punch in who that gateway\nis and it's not a default gateway.\n\n137\n00:07:13.170 --> 00:07:16.080\nYou'll see I actually have a few\nadditional options in here like\n\n138\n00:07:16.080 --> 00:07:17.790\nDisable Gateway Monitoring.\n\n139\n00:07:17.790 --> 00:07:20.660\nBy default, you can monitor an IP\n\n140\n00:07:20.660 --> 00:07:23.840\naddress on the other side to make sure\nyou can actually get to this host.\n\n141\n00:07:23.840 --> 00:07:26.630\nNo sense routing traffic to it\nif it's not actually working.\n\n142\n00:07:26.630 --> 00:07:31.870\nSo for example, if this one is powering\na VPN tunnel, I might want to put in an IP\n\n143\n00:07:31.870 --> 00:07:36.930\non that other network and say try and ping\nthis other IP, and if you can't ping it\n\n144\n00:07:36.930 --> 00:07:39.540\nthen there's something wrong with\nVPN tunnel no sense routing traffic.\n\n145\n00:07:39.540 --> 00:07:40.960\nTake this one out of the routing tables.\n\n146\n00:07:40.960 --> 00:07:42.100\nYou can set that up.\n\n147\n00:07:42.100 --> 00:07:42.840\nI'll define it, but\n\n148\n00:07:42.840 --> 00:07:44.940\nI'm going to disable that because\nthis network doesn't actually exist.\n\n149\n00:07:46.300 --> 00:07:49.479\nThen you can say, mark the gateway as\ndown if you want to temporarily take it\n\n150\n00:07:49.479 --> 00:07:51.608\noffline, this basically\ndisables the gateway.\n\n151\n00:07:51.608 --> 00:07:53.190\nAnd then you can give it a description.\n\n152\n00:07:53.190 --> 00:07:54.290\nThis was my partner.\n\n153\n00:07:54.290 --> 00:07:56.210\nVPN.\n\n154\n00:07:56.210 --> 00:08:01.441\nSo I'll punch that in and oh, gateway\nname must not contain invalid characters.\n\n155\n00:08:01.441 --> 00:08:03.960\nSo let me just take that dash out.\n\n156\n00:08:03.960 --> 00:08:07.187\nIt wasn't happy about my dash.\n\n157\n00:08:07.187 --> 00:08:08.515\nThere we go.\n\n158\n00:08:08.515 --> 00:08:12.424\nSo now, I've got a nice new gateway\ndefined right there on my LAN interface.\n\n159\n00:08:12.424 --> 00:08:15.530\nThat is why I errored out earlier,\nso I've got that assigned properly.\n\n160\n00:08:15.530 --> 00:08:22.727\nAnd now, when I go to Routes, I can add in\nmy new route for the 172.16.0.0 network.\n\n161\n00:08:22.727 --> 00:08:25.467\nAnd that is a 16 bit subnet.\n\n162\n00:08:25.467 --> 00:08:28.624\nAnd now,\nI can pick that Firewall 02 right there.\n\n163\n00:08:28.624 --> 00:08:31.820\nI can disable it,\nif I wanna take it offline temporarily.\n\n164\n00:08:31.820 --> 00:08:32.910\nI don't.\n\n165\n00:08:32.910 --> 00:08:34.485\nAnd I'll just say that's my partner VPN.\n\n166\n00:08:34.485 --> 00:08:38.949\nSo now, anytime my firewall receives\ntraffic destined for 172.16.0.0,\n\n167\n00:08:38.949 --> 00:08:43.227\ninstead of going up the default gateway,\nit'll just redirect it and send it right\n\n168\n00:08:43.227 --> 00:08:47.629\nover here to 192.168.0.2 where\nhopefully there's another firewall or\n\n169\n00:08:47.629 --> 00:08:50.853\nrouter standing by that does know\nhow to get to that network and\n\n170\n00:08:50.853 --> 00:08:53.160\nwill send it along appropriately.\n\n171\n00:08:53.160 --> 00:08:55.150\nSo that's a Static Route.\n\n172\n00:08:55.150 --> 00:08:56.560\nThey're not hard to configure.\n\n173\n00:08:56.560 --> 00:08:58.850\nOnce they're in place they're rock solid.\n\n174\n00:08:58.850 --> 00:09:02.800\nBut I disabled monitoring,\nso regardless of whether or\n\n175\n00:09:02.800 --> 00:09:05.470\nnot this other host is up, this route's\ngonna stay on my routing table and\n\n176\n00:09:05.470 --> 00:09:07.418\nI'm always gonna try and\nsend traffic out of it.\n\n177\n00:09:07.418 --> 00:09:10.130\nSo like Ronnie said,\nif something changes I have to come in and\n\n178\n00:09:10.130 --> 00:09:13.480\nmanually change it and that's\nthe biggest negative of a Static Route.\n\n179\n00:09:13.480 --> 00:09:14.660\nIs just the support of it.\n\n180\n00:09:14.660 --> 00:09:18.208\nI'm gonna have to go in and\nmanual update this.\n\n181\n00:09:18.208 --> 00:09:21.458\n>> Now, the other thing we also have to\nconsider with a Static Route usually is\n\n182\n00:09:21.458 --> 00:09:24.809\nthat on the other side we gotta make sure\nthat there's also a route coming back\n\n183\n00:09:24.809 --> 00:09:25.860\nour way too.\n\n184\n00:09:25.860 --> 00:09:29.500\nSo just remember that if you're setting\nthem both up on PSN's firewalls.\n\n185\n00:09:29.500 --> 00:09:33.090\nBut usually though once we actually\nget Static Routes in hand and\n\n186\n00:09:33.090 --> 00:09:34.420\nwe don't really need them.\n\n187\n00:09:34.420 --> 00:09:38.350\nWhat we probably need is something like\na dynamic routing protocol instead.\n\n188\n00:09:38.350 --> 00:09:39.780\nIn dynamic routing protocols,\n\n189\n00:09:39.780 --> 00:09:43.030\nremember what that means is that they're\ngonna learn the routes from other\n\n190\n00:09:43.030 --> 00:09:47.330\nrouters or other devices that are actually\nsending out or advertising those routes.\n\n191\n00:09:47.330 --> 00:09:53.006\nSo in pfSense firewall we have the ability\nto actually run either RIP or also OSPF.\n\n192\n00:09:53.006 --> 00:09:54.700\nNow, we're gonna talk about RIP first.\n\n193\n00:09:54.700 --> 00:09:57.570\nRIP stands for\nrouting information protocol.\n\n194\n00:09:57.570 --> 00:10:01.070\nAnd there's actually two versions of RIP,\nand one of the earlier versions,\n\n195\n00:10:01.070 --> 00:10:04.250\nversion 1, only supports the class for\nrouting so\n\n196\n00:10:04.250 --> 00:10:07.270\nyou don't tend to actually have\na lot of that going on anymore.\n\n197\n00:10:07.270 --> 00:10:10.016\nBut for us, we're gonna actually\ntake a look at RIP version 2.\n\n198\n00:10:10.016 --> 00:10:15.010\nRIP version 2 does support the ability to\ndo the variable length subnet masking.\n\n199\n00:10:15.010 --> 00:10:19.480\nAnd it's actually incredibly easy\nto set up and that's what we like.\n\n200\n00:10:19.480 --> 00:10:23.240\nBut there's also some\nunusual things about it too.\n\n201\n00:10:23.240 --> 00:10:24.550\nOne, it's slow.\n\n202\n00:10:24.550 --> 00:10:27.610\nIt doesn't do a triggered update,\nit does periodic updates.\n\n203\n00:10:27.610 --> 00:10:30.560\nSo you may have to wait for\nall those routes to come in and\n\n204\n00:10:30.560 --> 00:10:32.490\neven then it can actually\ntake a long time.\n\n205\n00:10:32.490 --> 00:10:33.610\nUsually up to five minutes or\n\n206\n00:10:33.610 --> 00:10:37.040\nlonger before all the routes actually\ncome in when you need them to.\n\n207\n00:10:37.040 --> 00:10:40.840\nSo even though it's a way that we can do\nit, we don't see it very often useless you\n\n208\n00:10:40.840 --> 00:10:43.910\nactually know that there's not gonna be\nthat many routes in your routing table.\n\n209\n00:10:43.910 --> 00:10:46.790\nSo Don, what is it about RIP\nthat we need to understand here?\n\n210\n00:10:46.790 --> 00:10:49.650\n>> So getting RIP set up is really easy,\nthere's just two parts of it.\n\n211\n00:10:49.650 --> 00:10:53.240\nA dynamic routing protocol, the power of\nit is that instead of you having to tell\n\n212\n00:10:53.240 --> 00:10:57.580\nyour router or firewall about the routes,\nit can just learn them from the network.\n\n213\n00:10:57.580 --> 00:11:00.726\nSo when you configure\na dynamic routing protocol,\n\n214\n00:11:00.726 --> 00:11:04.173\none part of it is telling\nthe router how to learn routes.\n\n215\n00:11:04.173 --> 00:11:07.220\nAnd we're gonna tell ours to listen for\nRIP routes on the network.\n\n216\n00:11:07.220 --> 00:11:09.921\nThe other part is telling\nit to advertise routes,\n\n217\n00:11:09.921 --> 00:11:13.214\nto tell everybody else about\nthe routes that you know about.\n\n218\n00:11:13.214 --> 00:11:15.950\nAnd that's where you get the two way\ncommunications between all your routers.\n\n219\n00:11:15.950 --> 00:11:19.350\nThey exchange information and\nyour network converges.\n\n220\n00:11:19.350 --> 00:11:22.540\nWell we set it all up at\nthe same time here on pfSense.\n\n221\n00:11:22.540 --> 00:11:24.605\nFirst off, the base install for\n\n222\n00:11:24.605 --> 00:11:28.365\npfSense does not include any\ndynamic routing protocols.\n\n223\n00:11:28.365 --> 00:11:30.880\nSo I actually have no dynamic\nrouting out of the box.\n\n224\n00:11:30.880 --> 00:11:34.160\nI need to install a package\nto add that support.\n\n225\n00:11:34.160 --> 00:11:37.780\nSo I'm gonna go up here\nto System > Packages and\n\n226\n00:11:37.780 --> 00:11:40.120\nI'm gonna find the routed package.\n\n227\n00:11:40.120 --> 00:11:44.522\nSo if I go under Available Packages,\nthere's a package in here called routed.\n\n228\n00:11:44.522 --> 00:11:47.432\nIt's you know way down in the r's.\n\n229\n00:11:47.432 --> 00:11:51.980\nAnd routed is the route demon,\nand it supports RIP.\n\n230\n00:11:51.980 --> 00:11:53.495\nSo it's buried away right here.\n\n231\n00:11:53.495 --> 00:11:55.430\nRouted, Network Management.\n\n232\n00:11:55.430 --> 00:11:58.390\nNow, notice it says that\nit's stable 1.1 designed for\n\n233\n00:11:58.390 --> 00:12:01.562\nplatform 2.2 always keep an eye out for\nthat.\n\n234\n00:12:01.562 --> 00:12:04.945\nThere's a lot of packages that are out\nthere that haven't been updated for\n\n235\n00:12:04.945 --> 00:12:08.480\n2.2 yet,\nI'm running pfSense 2.2.3 right now, but\n\n236\n00:12:08.480 --> 00:12:12.780\nyou'll see other ones in here that are\nstill like platform one point whatever so\n\n237\n00:12:12.780 --> 00:12:16.510\nyou gotta watch out for that but\nrouted has been updated.\n\n238\n00:12:16.510 --> 00:12:20.330\nSo that's what I want, and\nI'm gonna come in here and install routed.\n\n239\n00:12:20.330 --> 00:12:24.902\nSo I'm just gonna hit the plus sign\nover here, and we're gonna install it.\n\n240\n00:12:24.902 --> 00:12:29.240\nNow routed, the route demon, it doesn't\nhave a whole heck of a lot of options.\n\n241\n00:12:29.240 --> 00:12:32.890\nIt's gonna install, there we go it\ninstalls very fast, very small and\n\n242\n00:12:32.890 --> 00:12:36.820\nwhen it's done, I just need to do\nsome basic configuration of it.\n\n243\n00:12:36.820 --> 00:12:40.780\nNow, routed is actually\nburied under Services.\n\n244\n00:12:40.780 --> 00:12:43.830\nAnd then it's not called routed,\nhere it's called RIP.\n\n245\n00:12:43.830 --> 00:12:45.230\nA little confusing.\n\n246\n00:12:45.230 --> 00:12:48.050\nRouted does just provide RIP version 1 and\nRIP version 2.\n\n247\n00:12:48.050 --> 00:12:49.620\nIt doesn't provide any\nother touring protocols.\n\n248\n00:12:51.180 --> 00:12:52.670\nAs far as my configuration options.\n\n249\n00:12:52.670 --> 00:12:57.130\nNumber one, I need to turn on RIP so\nI'll just enable that.\n\n250\n00:12:57.130 --> 00:13:00.770\nThen at that point I'm going to\nstart listening for RIP routes,\n\n251\n00:13:00.770 --> 00:13:02.430\nif somebody can teach me RIP route.\n\n252\n00:13:02.430 --> 00:13:05.868\nBut I need to tell it what\ninterfaces it will connect to.\n\n253\n00:13:05.868 --> 00:13:10.175\nNow, with routed when you do this\nyou're configuring your listener and\n\n254\n00:13:10.175 --> 00:13:12.021\nyour speaker at the same time.\n\n255\n00:13:12.021 --> 00:13:15.648\nYou're saying I'm gonna listen on\nthese interfaces to learn routes and\n\n256\n00:13:15.648 --> 00:13:20.070\nI'm gonna advertise on these interfaces\nto tell other people about my routes.\n\n257\n00:13:20.070 --> 00:13:24.754\nSo you'll wanna choose typically\nyour internal networks.\n\n258\n00:13:24.754 --> 00:13:28.458\nSo for me I've got a LAN and a DMZ,\nI'm gonna choose both of those.\n\n259\n00:13:28.458 --> 00:13:30.250\nI'm not gonna choose my WAN.\n\n260\n00:13:30.250 --> 00:13:33.650\nThere's really not any need to advertise\nyour routes out to the Internet,\n\n261\n00:13:33.650 --> 00:13:36.200\nbecause most of your routes are gonna\nbe for private networks anyway.\n\n262\n00:13:36.200 --> 00:13:38.740\nSo I'm gonna choose LAN and DMZ.\n\n263\n00:13:38.740 --> 00:13:40.670\nI can choose between Version 1 and\nVersion 2.\n\n264\n00:13:40.670 --> 00:13:43.005\nYou almost always want version 2.\n\n265\n00:13:43.005 --> 00:13:45.410\nVersion 1 is classical like Ronnie said.\n\n266\n00:13:45.410 --> 00:13:47.300\nYou can set a RIP password.\n\n267\n00:13:47.300 --> 00:13:50.620\nYou don't want somebody bringing up\ntheir own RIP router, and starting to\n\n268\n00:13:50.620 --> 00:13:53.950\npush fake routes in your network or\ncapturing your traffic, that would be bad.\n\n269\n00:13:53.950 --> 00:13:55.610\nSo you can put in a password.\n\n270\n00:13:55.610 --> 00:13:58.810\nI'm gonna leave mine blank for\nright now, just cuz mines in a lab.\n\n271\n00:14:00.030 --> 00:14:03.280\nThen you can turn off\naggregation of subnets.\n\n272\n00:14:03.280 --> 00:14:06.310\nIn the Cisco world this is\ncalled auto summerization.\n\n273\n00:14:06.310 --> 00:14:11.800\nRIP version 2 is classless, but it still\nsort of behaves in a classfull manner.\n\n274\n00:14:11.800 --> 00:14:14.600\nIt'll take routes and\nsummarize them to make them smaller.\n\n275\n00:14:14.600 --> 00:14:17.170\nYou might not want that, and\nso you can turn that off.\n\n276\n00:14:17.170 --> 00:14:22.710\nAnd then they've got super netting also,\nwhere it can make networks bigger too.\n\n277\n00:14:22.710 --> 00:14:23.880\nYou can turn that off too, and\n\n278\n00:14:23.880 --> 00:14:27.010\nthen it's gonna advertise just\nthe actual routes that are attached.\n\n279\n00:14:27.010 --> 00:14:29.040\nIt's up to you whether you\nwant those to be on or off.\n\n280\n00:14:30.440 --> 00:14:34.600\nI'll go ahead and save that option and\nnow, it's not terribly dramatic but\n\n281\n00:14:34.600 --> 00:14:35.135\nthat's it.\n\n282\n00:14:35.135 --> 00:14:37.120\n>> [LAUGH]\n>> I'm up and I'm running RIP.\n\n283\n00:14:37.120 --> 00:14:40.912\nNow, routed doesn't give me any way\nto verify this is actually working.\n\n284\n00:14:40.912 --> 00:14:42.630\nSo how do I know that it's working?\n\n285\n00:14:42.630 --> 00:14:44.710\nWell, there's a few different\nways to go about it,\n\n286\n00:14:44.710 --> 00:14:49.650\nbut the best way is if\nwe go up to Diagnostics,\n\n287\n00:14:49.650 --> 00:14:53.570\nunder Diagnostics you've got Routes and\nyou can see your routing table.\n\n288\n00:14:53.570 --> 00:14:56.790\nNow, on a normal firewall's routing table,\n\n289\n00:14:56.790 --> 00:15:01.510\nif you go to your Interfaces,\nwell on your Interfaces screen, any\n\n290\n00:15:01.510 --> 00:15:04.960\nnetwork that's attached to these are what\nyou're gonna see in your routing table.\n\n291\n00:15:04.960 --> 00:15:07.970\nSo you should see a default gateway route,\nand\n\n292\n00:15:07.970 --> 00:15:12.070\nthen you should see locally connected ones\nfor each of your networks that you have.\n\n293\n00:15:12.070 --> 00:15:15.680\nIf I'm learning routes, I should see\nroutes that I don't have an interface on.\n\n294\n00:15:15.680 --> 00:15:20.965\nSo if I go to Status > Interfaces,\nhere I can see I'm connected\n\n295\n00:15:20.965 --> 00:15:25.576\nto the 127 network, the 209.251 network.\n\n296\n00:15:25.576 --> 00:15:28.650\nWell, those are my DNS servers, but\nI am connected to those networks.\n\n297\n00:15:28.650 --> 00:15:33.275\nYou'll see I'm connected to the 192.168.0\nnetwork, the 192.168.1 network, right?\n\n298\n00:15:33.275 --> 00:15:35.870\nThose are ones I'm directly connected to.\n\n299\n00:15:35.870 --> 00:15:38.180\nBut if I go to Diagnostics > Routes,\n\n300\n00:15:38.180 --> 00:15:41.910\nI should start to see routes that\nI'm not directly connected to.\n\n301\n00:15:41.910 --> 00:15:43.070\nSo it's gathering that data.\n\n302\n00:15:43.070 --> 00:15:44.500\nI'm gonna give it just a minute.\n\n303\n00:15:44.500 --> 00:15:45.710\nThere we go.\n\n304\n00:15:45.710 --> 00:15:50.712\nAnd now, I'm starting to see all\nthese other networks, 192.168.10,\n\n305\n00:15:50.712 --> 00:15:54.652\n.20, .30, .40, .50,\nwhere did those come from?\n\n306\n00:15:54.652 --> 00:15:57.200\nThose came from another\nrouter on my network.\n\n307\n00:15:57.200 --> 00:16:00.608\nThey taught me those routes, I learned\nthose routes from the other router.\n\n308\n00:16:00.608 --> 00:16:02.288\nI didn't have to manually put them in.\n\n309\n00:16:02.288 --> 00:16:04.898\nAnd it's dynamic,\nas that other router powers off,\n\n310\n00:16:04.898 --> 00:16:07.220\nthese routes will come\nout of my routing table.\n\n311\n00:16:07.220 --> 00:16:08.230\nSo it's adding and\n\n312\n00:16:08.230 --> 00:16:11.330\nremoving them dynamically without\nme having to get involved.\n\n313\n00:16:11.330 --> 00:16:13.690\nNow it doesn't tell me\nwhere the routes came from.\n\n314\n00:16:13.690 --> 00:16:15.193\nThat's kind of the hard part,\n\n315\n00:16:15.193 --> 00:16:18.770\nis looking at this I don't necessarily\nknow that it came from route D.\n\n316\n00:16:18.770 --> 00:16:21.410\nAnd the people that wrote\nthat route D package,\n\n317\n00:16:21.410 --> 00:16:24.020\nthey didn't integrate any\nreal logging with it.\n\n318\n00:16:24.020 --> 00:16:29.900\nSo when you come in here we don't have\na RIP log that we can pull up or anything.\n\n319\n00:16:29.900 --> 00:16:32.672\nSo it is kind of difficult\nto verify it beyond that but\n\n320\n00:16:32.672 --> 00:16:36.245\nI am learning the routes so\nI am now functioning in red.\n\n321\n00:16:36.245 --> 00:16:40.545\nAll right, a RIP is slow and\nit's not really scalable very large.\n\n322\n00:16:40.545 --> 00:16:43.095\nIf your network has more\nthen 15 hops RIP dies out.\n\n323\n00:16:43.095 --> 00:16:46.335\nSo it's not really suitable for\nlarge environments, right Ronnie?\n\n324\n00:16:46.335 --> 00:16:51.070\n>> Yeah, the larger your environment goes\nthe more your going to leave RIP and\n\n325\n00:16:51.070 --> 00:16:52.590\ninstead, you're probably going to look for\n\n326\n00:16:52.590 --> 00:16:55.530\na routing protocol that's designed for\nbigger networks.\n\n327\n00:16:55.530 --> 00:16:57.760\nAnd when that comes down to routing,\n\n328\n00:16:57.760 --> 00:16:59.570\nusually there's two big\nones that are out there.\n\n329\n00:16:59.570 --> 00:17:02.600\nThere's EIGRP,\nthe problem with EIGRP is simple,\n\n330\n00:17:02.600 --> 00:17:06.325\nit's Cisco proprietary\nthat is also changing too.\n\n331\n00:17:06.325 --> 00:17:10.515\nBut then there is OSPF,\nopen shortest path first, and\n\n332\n00:17:10.515 --> 00:17:13.515\nthis the one that you probably\nare gonna end up running.\n\n333\n00:17:13.515 --> 00:17:17.585\nIt is open source, so in other words you\ncan run it on anything that you choose to.\n\n334\n00:17:17.585 --> 00:17:21.675\nThe other advantage of it is that\nonce it actually gets set up,\n\n335\n00:17:21.675 --> 00:17:23.555\nit's a little bit router\nintensive at the beginning,\n\n336\n00:17:23.555 --> 00:17:27.240\nbut once it gets set up it doesn't really\nneed to learn a lot from that point.\n\n337\n00:17:27.240 --> 00:17:30.810\nAnd then usually it's because\neverybody else is actually using it.\n\n338\n00:17:30.810 --> 00:17:35.380\nIt is very compatible with\na lot of different routers too.\n\n339\n00:17:35.380 --> 00:17:38.900\nNow the disadvantage though,\nis it is resource intensive.\n\n340\n00:17:38.900 --> 00:17:43.530\nIt does hold a big gigantic routing\ntable and it does abate somewhat, but\n\n341\n00:17:43.530 --> 00:17:45.660\nit's not as often as what RIP does.\n\n342\n00:17:45.660 --> 00:17:48.300\nIt actually is probably the routing\nprotocol you're more likely to see in\n\n343\n00:17:48.300 --> 00:17:49.470\nthe production network.\n\n344\n00:17:49.470 --> 00:17:51.530\n>> Yeah, and that big giant routing table.\n\n345\n00:17:51.530 --> 00:17:53.670\nYou don't necessarily have\na big giant routing table.\n\n346\n00:17:53.670 --> 00:17:56.860\nIf your network is big then yeah,\nOSPF has a big table.\n\n347\n00:17:56.860 --> 00:17:57.830\nBut if your network is small,\n\n348\n00:17:57.830 --> 00:18:00.650\nit really doesn't consume\nthat much as far as memory.\n\n349\n00:18:00.650 --> 00:18:02.370\nCPU's what we really worry about.\n\n350\n00:18:02.370 --> 00:18:05.906\nIf your network is not stable, if you\nhave constant change in your network,\n\n351\n00:18:05.906 --> 00:18:09.075\nOSPF can consume a a bit of CPU\nbecause it's having to recalculate.\n\n352\n00:18:09.075 --> 00:18:11.930\nBut if your network is stable and\nyour routing table is small,\n\n353\n00:18:11.930 --> 00:18:13.490\nOSPF is really not that bad.\n\n354\n00:18:13.490 --> 00:18:15.820\nBut it does consume more\nresources than RIP.\n\n355\n00:18:15.820 --> 00:18:19.640\nIt does do a little bit of mathematics and\nso on.\n\n356\n00:18:19.640 --> 00:18:23.010\nAll right, well, I just disabled\nRIP in the background of my router.\n\n357\n00:18:23.010 --> 00:18:23.805\nSo I've turned it off.\n\n358\n00:18:23.805 --> 00:18:27.560\nAnd if I go to Diagnostics and\nRoutes, I'm gonna, well.\n\n359\n00:18:27.560 --> 00:18:29.910\nI had to reboot my router so\nlet me get logged back into it.\n\n360\n00:18:29.910 --> 00:18:33.080\nAnd I'm gonna go into Diagnostics and\nRoutes.\n\n361\n00:18:33.080 --> 00:18:37.900\nAnd what I want to do is I want to show\nyou guys those 192.160.10, 20, 30 40,\n\n362\n00:18:37.900 --> 00:18:39.616\n50 routes that those are gone.\n\n363\n00:18:39.616 --> 00:18:41.830\nSo those aren't in my\nrouting table anymore.\n\n364\n00:18:41.830 --> 00:18:44.710\nI'm not running RIP, so\nI'm not learning those routes.\n\n365\n00:18:44.710 --> 00:18:47.430\nInstead I'm gonna turn on OSPF.\n\n366\n00:18:47.430 --> 00:18:49.880\nWell, this is another one where\nI've got to add a package.\n\n367\n00:18:49.880 --> 00:18:52.380\nSo I'm going to go up to system and\npackages.\n\n368\n00:18:52.380 --> 00:18:54.950\nAnd I'm going to go into\navailable packages.\n\n369\n00:18:54.950 --> 00:18:59.110\nAnd the OSPF package was made by\nan organization called Quagga,\n\n370\n00:18:59.110 --> 00:19:00.920\nwhich is kind of an odd name.\n\n371\n00:19:00.920 --> 00:19:03.240\nBut, so I'm just going to do\na quick search for Quagga.\n\n372\n00:19:03.240 --> 00:19:06.260\nNow there's another package\nout there called Open BGP for\n\n373\n00:19:06.260 --> 00:19:09.180\nthe border gateway protocol,\nthe two conflict.\n\n374\n00:19:09.180 --> 00:19:13.170\nYou can't run Open BGP and\nOSPF at the same time.\n\n375\n00:19:13.170 --> 00:19:14.880\nYou got to pick one or the other.\n\n376\n00:19:14.880 --> 00:19:16.410\nWe're not going to get into BGP today.\n\n377\n00:19:16.410 --> 00:19:18.110\nMost people don't have a need for it.\n\n378\n00:19:18.110 --> 00:19:21.605\nIf you do have a need for it, running it\non your firewall is not a great idea.\n\n379\n00:19:21.605 --> 00:19:23.490\nSo I don't recommend that.\n\n380\n00:19:23.490 --> 00:19:26.100\nBut Quagga OSPF is right here.\n\n381\n00:19:26.100 --> 00:19:27.280\nThat one, it is a good idea.\n\n382\n00:19:27.280 --> 00:19:28.790\nThis one will work just fine.\n\n383\n00:19:28.790 --> 00:19:30.880\nSo I'm gonna come in and\nadd that package in.\n\n384\n00:19:30.880 --> 00:19:32.850\nSo I'll just hit that little\nplus sign over beside it.\n\n385\n00:19:32.850 --> 00:19:35.820\nAnd we're gonna get that one installed.\n\n386\n00:19:35.820 --> 00:19:39.240\nNow one of the things Ronnie mentioned\nearlier is that OSPF is a little more\n\n387\n00:19:39.240 --> 00:19:40.690\ncomplex to set up.\n\n388\n00:19:40.690 --> 00:19:43.340\nSo one of the first things you'll\nnotice is when we go to configure\n\n389\n00:19:43.340 --> 00:19:47.950\nQuagga OSPF is that it's got\na lot more options, okay.\n\n390\n00:19:47.950 --> 00:19:49.900\nSo they're it just finished installing.\n\n391\n00:19:49.900 --> 00:19:54.570\nAnd when it's done, if I go under\nservices I've got Quagga OSPF,\n\n392\n00:19:54.570 --> 00:19:59.260\nand in here I've got my Global Settings,\nmy Interface Settings,\n\n393\n00:19:59.260 --> 00:20:01.290\nmy Raw Config, and my Status.\n\n394\n00:20:01.290 --> 00:20:03.240\nThey've actually done a much\nbetter job on this one.\n\n395\n00:20:03.240 --> 00:20:06.400\nIt's much more robust than\nthe RIP offering, all right?\n\n396\n00:20:06.400 --> 00:20:09.370\nTo get it set up we need to\nstart on the interface settings.\n\n397\n00:20:09.370 --> 00:20:12.450\nI know it's tempting to start right here\non Global, but it actually doesn't work.\n\n398\n00:20:12.450 --> 00:20:16.450\nYou have to go to Interface first and\nadd at least one interface.\n\n399\n00:20:16.450 --> 00:20:20.350\nJust like with RIP, you add the interfaces\nthat you want to listen on and\n\n400\n00:20:20.350 --> 00:20:22.100\nthat you want to advertise on.\n\n401\n00:20:22.100 --> 00:20:24.750\nSo I'm gonna hit the plus sign\nover here to add an Interface.\n\n402\n00:20:24.750 --> 00:20:28.050\nSo I'm gonna add my LAN interface.\n\n403\n00:20:28.050 --> 00:20:31.790\nAnd then you'll see I've got a lot more\noptions than just choosing the interface.\n\n404\n00:20:31.790 --> 00:20:34.000\nI can set a metric.\n\n405\n00:20:34.000 --> 00:20:37.940\nIf I learn a route on an interface I can\nuse metrics to influence whether I choose\n\n406\n00:20:37.940 --> 00:20:39.930\nthis route over another one.\n\n407\n00:20:39.930 --> 00:20:43.980\nIn OSPF the lower the number\nthe more preferred the route is.\n\n408\n00:20:43.980 --> 00:20:47.570\nThe metric in OSPF is called cost and\nso a lower number is better,\n\n409\n00:20:47.570 --> 00:20:49.620\na higher number is worse.\n\n410\n00:20:49.620 --> 00:20:51.930\nYou can define the area.\n\n411\n00:20:51.930 --> 00:20:56.660\nNow, if you're doing OSPF in a single\narea, then you can leave this blank and\n\n412\n00:20:56.660 --> 00:20:57.900\njust define it on the global page.\n\n413\n00:20:57.900 --> 00:21:01.160\nBut you might have one\ninterface in one area,\n\n414\n00:21:01.160 --> 00:21:04.180\nanother interface in another area,\nand you put the area number here.\n\n415\n00:21:04.180 --> 00:21:05.740\nNow if you're coming from the Cisco world,\n\n416\n00:21:05.740 --> 00:21:09.370\nyou're used to saying things\nlike area zero or area one.\n\n417\n00:21:09.370 --> 00:21:13.590\nBut the OSPF implementation in\npfSense follows the standard.\n\n418\n00:21:13.590 --> 00:21:17.992\nAnd in the official OSPF standard your\narea number has to be in the format of\n\n419\n00:21:17.992 --> 00:21:19.130\nan IPv4 address.\n\n420\n00:21:19.130 --> 00:21:23.728\nSo if you want area zero it\nwould need to be 0.0.0.0.\n\n421\n00:21:23.728 --> 00:21:27.810\nAnd if was area one you'd need 0.0.0.1.\n\n422\n00:21:27.810 --> 00:21:30.090\nSo a little bit different than the way\nyou might be used to writing it.\n\n423\n00:21:30.090 --> 00:21:32.270\nBut you'd need to punch that in there.\n\n424\n00:21:32.270 --> 00:21:36.520\nYou can give it a description and you can\nflag the interface as passive if you want.\n\n425\n00:21:36.520 --> 00:21:41.030\nPassive means you will not learn\nOSPF routes on this interface.\n\n426\n00:21:41.030 --> 00:21:44.760\nBut you will advertise to say,\nI've got this network.\n\n427\n00:21:44.760 --> 00:21:45.970\nYou'd typically turn this on for\n\n428\n00:21:45.970 --> 00:21:49.830\nyour DMZ or any network where\nthere weren't other routers on it.\n\n429\n00:21:49.830 --> 00:21:52.030\nNo sense learning routes if\nthere's no router out there,\n\n430\n00:21:52.030 --> 00:21:53.190\nthat's just opening you up to attack.\n\n431\n00:21:55.420 --> 00:21:59.420\nWe can also do a filter, to specify\nexactly who we allow routes to come in\n\n432\n00:21:59.420 --> 00:22:01.410\nfrom, again, another security mechanism.\n\n433\n00:22:01.410 --> 00:22:03.440\nYou can turn on MD5 password.\n\n434\n00:22:03.440 --> 00:22:07.550\nA nice secure hash password to\nensure people can't connect\n\n435\n00:22:07.550 --> 00:22:08.380\nunless you want them to.\n\n436\n00:22:09.900 --> 00:22:12.010\nThen you can define your router priority.\n\n437\n00:22:12.010 --> 00:22:14.430\nIf you have two routers\nadvertising the same route,\n\n438\n00:22:14.430 --> 00:22:16.202\nhow do they pick which one wins out?\n\n439\n00:22:16.202 --> 00:22:19.320\nWell there's some things\ncalled a designated router or\n\n440\n00:22:19.320 --> 00:22:24.140\nbackup designated router, these DRs or\nBDRs, and when the election happens\n\n441\n00:22:24.140 --> 00:22:27.550\nit actually uses their IP addresses\nto determine who's the winner.\n\n442\n00:22:27.550 --> 00:22:30.670\nHere we can influence that to pick who\nis the winner, and then when there is\n\n443\n00:22:30.670 --> 00:22:34.260\na conflict of routes, it's this DR\nthat's gonna make that decision.\n\n444\n00:22:34.260 --> 00:22:35.540\nSo we can influence it.\n\n445\n00:22:35.540 --> 00:22:37.920\nIf you leave it blank,\nit does an automatic election,\n\n446\n00:22:37.920 --> 00:22:39.160\nit figures it out on its own.\n\n447\n00:22:40.580 --> 00:22:42.950\nThe next three values you\nreally shouldn't change.\n\n448\n00:22:42.950 --> 00:22:45.710\nIf you change these values you need to\nchange them everywhere on your network.\n\n449\n00:22:45.710 --> 00:22:48.800\nThe Hello, Retransmit and Dead Timer.\n\n450\n00:22:48.800 --> 00:22:52.490\nYour firewall is gonna be sending\nout OSPF messages every ten seconds.\n\n451\n00:22:52.490 --> 00:22:55.850\nIt expects everybody else to send\nthem every ten seconds also.\n\n452\n00:22:55.850 --> 00:22:58.540\nIf they don't, it drops the connection.\n\n453\n00:22:58.540 --> 00:23:02.020\nSo these numbers have to match across\nall of your firewalls and routers.\n\n454\n00:23:03.040 --> 00:23:07.820\nThe retransmit is set to five,\nif somebody doesn't respond back that they\n\n455\n00:23:07.820 --> 00:23:10.750\nacknowledge the reception,\nwe retransmit within five seconds.\n\n456\n00:23:10.750 --> 00:23:12.430\nAnd then a dead timer of 40.\n\n457\n00:23:12.430 --> 00:23:16.990\nIf we don't hear a response to our hellos\n\n458\n00:23:16.990 --> 00:23:21.340\nfour times in a row, right, 40 seconds\nif we're doing hellos every ten seconds.\n\n459\n00:23:21.340 --> 00:23:22.490\nThen we'll determine they're dead, and\n\n460\n00:23:22.490 --> 00:23:24.010\nwe'll take their routes\nout of the routing table.\n\n461\n00:23:25.300 --> 00:23:29.088\nAll right, on Cisco routers, the defaults\nare actually like 10, 5, and 30.\n\n462\n00:23:29.088 --> 00:23:31.618\nSo if you're going to be\ncommunicating with Cisco,\n\n463\n00:23:31.618 --> 00:23:35.011\nyou'll either need to change your\npfSense boxes to 10, 5, 30 or\n\n464\n00:23:35.011 --> 00:23:39.339\nchange your Cisco routers to 10, 5, 40 to\nmake them match but they do have to match.\n\n465\n00:23:39.339 --> 00:23:41.436\nI'll leave mine at the defaults.\n\n466\n00:23:41.436 --> 00:23:43.490\nNow I've got one interface.\n\n467\n00:23:43.490 --> 00:23:46.650\nI can continue to add other\ninterfaces that were on my network.\n\n468\n00:23:46.650 --> 00:23:50.195\nI might want to add like my DMZ,\nand I can come through and\n\n469\n00:23:50.195 --> 00:23:52.092\nspecify their information.\n\n470\n00:23:52.092 --> 00:23:54.884\nDid I do area zero or\narea one on that other one?\n\n471\n00:23:54.884 --> 00:23:56.445\nNow I don't remember, shoot.\n\n472\n00:23:56.445 --> 00:23:57.474\nBut you can punch those in.\n\n473\n00:23:57.474 --> 00:24:01.550\nReally the only thing that you truly\nhave to do is pick the interface name.\n\n474\n00:24:01.550 --> 00:24:04.810\nYou don't even have to specify the area,\ncuz that can always come from the global.\n\n475\n00:24:04.810 --> 00:24:07.390\nSo really, just picking that interface and\nhitting save is the bare minimum.\n\n476\n00:24:08.440 --> 00:24:10.150\nOnce those are done,\nyou can go to the global setting and\n\n477\n00:24:10.150 --> 00:24:12.650\nyou can actually turn the protocol on.\n\n478\n00:24:12.650 --> 00:24:16.220\nWe have to set a master password for\nconnecting to the demon.\n\n479\n00:24:16.220 --> 00:24:18.260\nThere's no way around that,\nyou've got to set one.\n\n480\n00:24:18.260 --> 00:24:20.017\nI'll just set mine to the word password.\n\n481\n00:24:20.017 --> 00:24:21.360\nI suggest you don't do that.\n\n482\n00:24:21.360 --> 00:24:22.000\n>> [LAUGH]\n>> You\n\n483\n00:24:22.000 --> 00:24:24.730\ncan turn on logging if you want it and\nlog adjacencies.\n\n484\n00:24:24.730 --> 00:24:27.610\nAdjacencies are where you build\na connection to another OSPF router.\n\n485\n00:24:28.830 --> 00:24:30.730\nThen we can set our router ID.\n\n486\n00:24:30.730 --> 00:24:33.490\nNow, the router ID is picked\nfrom one of your IP addresses.\n\n487\n00:24:33.490 --> 00:24:34.640\nWhen your router boots up and\n\n488\n00:24:34.640 --> 00:24:39.145\nOSPF starts, it just looks at the highest\nIP address you have, and it uses that.\n\n489\n00:24:39.145 --> 00:24:41.120\nAnd you might wanna override that.\n\n490\n00:24:41.120 --> 00:24:42.800\nAnd that's exactly what I'm gonna do.\n\n491\n00:24:42.800 --> 00:24:44.050\nI like to use my internal IP.\n\n492\n00:24:44.050 --> 00:24:47.320\nMy highest IP address is my\npublic IP right now, 209.\n\n493\n00:24:47.320 --> 00:24:50.970\nWhich I'm not running OSPF on, so\nactually it would default to this one.\n\n494\n00:24:50.970 --> 00:24:51.910\nBut, either way.\n\n495\n00:24:51.910 --> 00:24:53.680\nYou know, we'll stick with this.\n\n496\n00:24:53.680 --> 00:24:55.290\nWe can specify the area for\n\n497\n00:24:55.290 --> 00:24:58.010\nany interface that doesn't have\nan area statically assigned.\n\n498\n00:24:58.010 --> 00:24:59.410\nI'm just gonna put myself in area zero.\n\n499\n00:24:59.410 --> 00:25:03.120\nAnd then we can define other things,\n\n500\n00:25:03.120 --> 00:25:07.460\nwhether we wanna disable fib updates,\nredistribute connected sub-nets.\n\n501\n00:25:07.460 --> 00:25:10.810\nThere's a lot of other advanced options\nthat kind of go beyond the scope of this.\n\n502\n00:25:10.810 --> 00:25:13.683\n>> If you wanna learn about\nadvanced OSPF configuration,\n\n503\n00:25:13.683 --> 00:25:16.930\nI encourage you to jump over to\nthe CCNA or the CCNP route shows.\n\n504\n00:25:16.930 --> 00:25:18.550\nWe go really in depth on those.\n\n505\n00:25:18.550 --> 00:25:21.590\nBut some of these that are kind\nof handy are those redistributes.\n\n506\n00:25:21.590 --> 00:25:26.283\nIf we're learning static routes, or\ndefault routes or directly connected\n\n507\n00:25:26.283 --> 00:25:30.630\nroutes, we can redistributed those\ninto OSPF to advertise them out.\n\n508\n00:25:30.630 --> 00:25:32.170\nIt's a way to get routes\ninto the routing table.\n\n509\n00:25:32.170 --> 00:25:33.840\nI'm not gonna do that.\n\n510\n00:25:35.420 --> 00:25:38.775\nAll right, we can set hold times and\ndelays so that when we learn a new route,\n\n511\n00:25:38.775 --> 00:25:41.347\nwe don't just immediately\nthrow it in the routing table,\n\n512\n00:25:41.347 --> 00:25:43.300\nwe wait to see if it's stable.\n\n513\n00:25:43.300 --> 00:25:46.990\nYou can make it RFC 1583 compatible,\nwhich is for\n\n514\n00:25:46.990 --> 00:25:50.920\nhandling how we determine autonomous\nsystems, if they're external or internal.\n\n515\n00:25:50.920 --> 00:25:53.190\nI'm not gonna worry about that.\n\n516\n00:25:53.190 --> 00:25:55.490\nAnd then you can define rules.\n\n517\n00:25:55.490 --> 00:26:00.290\nThese rules are where we kind of override\nthe behavior for certain routes.\n\n518\n00:26:00.290 --> 00:26:03.370\nYou can define certain subnets\nbeing tied to certain areas.\n\n519\n00:26:03.370 --> 00:26:05.770\nIt's very uncommon that you\nneed to manipulate that.\n\n520\n00:26:06.890 --> 00:26:09.010\nAnd then lastly,\nif you're doing high availability,\n\n521\n00:26:09.010 --> 00:26:11.450\nyou would need to put\nyour CARP address here.\n\n522\n00:26:11.450 --> 00:26:14.250\nAnd your OSPF states can\nexchange between the routers so\n\n523\n00:26:14.250 --> 00:26:17.330\nthat your firewalls will still appear\nat one firewall on the network.\n\n524\n00:26:17.330 --> 00:26:20.270\nInstead of looking like two firewalls,\nwhich can wreak havoc with OSPF.\n\n525\n00:26:22.060 --> 00:26:24.230\nWhen all that's done, we can save it.\n\n526\n00:26:24.230 --> 00:26:27.490\nAnd really, at the end of the day,\nsetting the Master Password and\n\n527\n00:26:27.490 --> 00:26:29.510\nsetting the Area was all I had to do here.\n\n528\n00:26:29.510 --> 00:26:31.300\nAll the other stuff is optional.\n\n529\n00:26:31.300 --> 00:26:34.540\nSo add an interface and just hit Save.\n\n530\n00:26:34.540 --> 00:26:36.920\nAdd a master password,\nadd an area number and hit Save.\n\n531\n00:26:36.920 --> 00:26:39.910\nThose three things,\nthat's enough to get OSPF up and running.\n\n532\n00:26:39.910 --> 00:26:42.010\nAll the other stuff are really\njust options for us.\n\n533\n00:26:43.350 --> 00:26:48.260\nOnce that's done, I can come in and\nI can take a look at my status tab.\n\n534\n00:26:48.260 --> 00:26:51.550\nAnd assuming it's actually started,\nmy service might not be started.\n\n535\n00:26:51.550 --> 00:26:54.580\nIf the service is started, you'll actually\nsee the status message where it'll show\n\n536\n00:26:54.580 --> 00:26:56.850\nthe routing table and\nthe other information that's on there.\n\n537\n00:26:56.850 --> 00:26:58.810\nSo, looks like mine is not started.\n\n538\n00:26:58.810 --> 00:27:00.640\nSo I'm gonna go and start that service.\n\n539\n00:27:00.640 --> 00:27:06.710\nSo if we go under our Diagnostics and,\nmaybe not Diagnostics.\n\n540\n00:27:06.710 --> 00:27:07.460\nHow about Status?\n\n541\n00:27:07.460 --> 00:27:10.060\nThere we go.\nStatus and Services.\n\n542\n00:27:10.060 --> 00:27:11.910\nWe can jump in here and find Quagga OSPF.\n\n543\n00:27:11.910 --> 00:27:14.750\nAnd actually it does show\nthat it is up and running.\n\n544\n00:27:14.750 --> 00:27:15.900\nLet me try and access that again.\n\n545\n00:27:15.900 --> 00:27:20.896\nIf I go back to Services and Quagga OSPF,\nand go to my Status tab, sure enough,\n\n546\n00:27:20.896 --> 00:27:23.040\nit is just not wanting to come up.\n\n547\n00:27:23.040 --> 00:27:24.710\n>> I think you're Find,\nyou're using the Find.\n\n548\n00:27:26.970 --> 00:27:28.590\n>> Oh, well that's not gonna\neffect it while it's loading it.\n\n549\n00:27:28.590 --> 00:27:29.420\n>> I wasn't sure.\n\n550\n00:27:29.420 --> 00:27:31.660\n>> Alright, well something is\nwrong with my status screen.\n\n551\n00:27:31.660 --> 00:27:35.140\nLet me turn on logging, it might just be\nmad that I haven't turned on logging but\n\n552\n00:27:35.140 --> 00:27:36.790\nI'm pretty sure that's not required.\n\n553\n00:27:37.860 --> 00:27:40.860\nIf something like this happens,\nit's possible that I had an improper\n\n554\n00:27:40.860 --> 00:27:44.320\npackage installation, so I might need to\nuninstall and reinstall the package, or\n\n555\n00:27:44.320 --> 00:27:47.750\nI might need to reboot the firewall\nwhich you do hate to do, but\n\n556\n00:27:47.750 --> 00:27:50.730\nyeah it's not coming up, but\nwe'll see if it's actually working.\n\n557\n00:27:50.730 --> 00:27:55.610\nIf I go to diagnostics and routes, when I\ncome in here, we can see if I'm actually\n\n558\n00:27:55.610 --> 00:27:59.520\nlearning OSPF routes, and that'll\ntell us whether it's running or not.\n\n559\n00:27:59.520 --> 00:28:01.230\n>> Sure.\n>> And sure enough I am running it.\n\n560\n00:28:01.230 --> 00:28:03.080\nSo it is running just fine.\n\n561\n00:28:03.080 --> 00:28:08.500\nFor some reason I'm just not able to\nget to that Quagga OSPF status page.\n\n562\n00:28:08.500 --> 00:28:10.270\nWell, you know,\nlet's just double check and\n\n563\n00:28:10.270 --> 00:28:13.430\nmake sure I didn't miss\nanything too obvious.\n\n564\n00:28:13.430 --> 00:28:16.749\nSo I'm just gonna jump back\nunder Quagga OSPF here and\n\n565\n00:28:16.749 --> 00:28:21.050\nI'll check to make sure that I've\ngot nothing disabling that page.\n\n566\n00:28:21.050 --> 00:28:23.990\nI don't have any crazy rules to find so\nwe should be fine there.\n\n567\n00:28:23.990 --> 00:28:29.470\nAnd if I go to my interface settings,\nI've got my LAN interface to find.\n\n568\n00:28:31.190 --> 00:28:33.720\nAnd, yeah, you know, the status pages and\nstuff are just not loading.\n\n569\n00:28:33.720 --> 00:28:36.400\nI must have an improper\npackage installation.\n\n570\n00:28:36.400 --> 00:28:39.170\nYou can remove the package and\nthen add it again.\n\n571\n00:28:39.170 --> 00:28:41.960\nIt will actually retain it's settings and\ntry and repair that.\n\n572\n00:28:41.960 --> 00:28:43.450\nBut normal,\nyou'd click on your status page.\n\n573\n00:28:43.450 --> 00:28:44.910\nYou can actual see the routes.\n\n574\n00:28:44.910 --> 00:28:46.440\nLet me bring up a different\nrouter real quick.\n\n575\n00:28:47.780 --> 00:28:50.941\nOne where this should work just fine,\nI'll flip over to another one just so\n\n576\n00:28:50.941 --> 00:28:51.550\nwe can see it.\n\n577\n00:28:54.300 --> 00:28:58.550\nThere we go, and\nI'll just jump into its services and OSPF.\n\n578\n00:28:58.550 --> 00:29:02.610\nThis is the other router that I've been\ntalking to in the show, and there we go.\n\n579\n00:29:02.610 --> 00:29:04.330\nSo if I take a look at its status screen,\n\n580\n00:29:04.330 --> 00:29:06.300\nyou can see all of this\ndifferent information.\n\n581\n00:29:06.300 --> 00:29:10.420\nLike the general OSPF configuration,\nwhich I can see here.\n\n582\n00:29:10.420 --> 00:29:13.660\nYou can see any neighbors\nthat you're peered to, right?\n\n583\n00:29:13.660 --> 00:29:18.500\nAnd who is the designated router or\nbackup designated router or whatever.\n\n584\n00:29:18.500 --> 00:29:21.820\nYou can see your OSPF database,\nthe links that you've learned about.\n\n585\n00:29:21.820 --> 00:29:23.280\nAnd your router database,\n\n586\n00:29:23.280 --> 00:29:26.130\nall the routers that you're talking to and\ntheir information.\n\n587\n00:29:26.130 --> 00:29:27.870\nBut more importantly is\nthis guy right here.\n\n588\n00:29:27.870 --> 00:29:31.610\nThis is where you can see all of your\nroutes and their associated metrics.\n\n589\n00:29:31.610 --> 00:29:33.940\nThat's what I wanted to show\nyou guys on the other firewall.\n\n590\n00:29:33.940 --> 00:29:38.395\nSo this is showing up here and\nso you get your routing table.\n\n591\n00:29:38.395 --> 00:29:41.175\nLaid out nice and\nclean in a format that makes sense.\n\n592\n00:29:41.175 --> 00:29:43.135\nSo really useful information.\n\n593\n00:29:43.135 --> 00:29:46.065\nA lot more powerful that that\nRIP package that we saw.\n\n594\n00:29:46.065 --> 00:29:50.085\n>> So with the PSS firewall, we have the\nability to not have to use the router if\n\n595\n00:29:50.085 --> 00:29:54.355\nwe don't need to, but we will see\nthat you can setup the static routes.\n\n596\n00:29:54.355 --> 00:29:57.095\nYou can use RIP, and you can use OSPF, so\n\n597\n00:29:57.095 --> 00:30:00.730\nthere's a lot of configuration that you\ncan do with routing just on the firewall.\n\n598\n00:30:00.730 --> 00:30:02.830\nDon is there anything else that\nwe actually need to cover?\n\n599\n00:30:02.830 --> 00:30:03.520\n>> I think that's about it.\n\n600\n00:30:03.520 --> 00:30:04.680\nI mean Ronnie you know as well as I do,\n\n601\n00:30:04.680 --> 00:30:08.200\nwe can spend a ton more time talking about\nhow the routing protocols themselves work\n\n602\n00:30:08.200 --> 00:30:11.850\nbut as far as the PF sense\nconfiguration that's basically it.\n\n603\n00:30:11.850 --> 00:30:14.570\nIf you want to learn more about\nthe protocols definitely jump over like\n\n604\n00:30:14.570 --> 00:30:18.390\nthe CCNA show does a great job of laying\nout those protocols and how they work, and\n\n605\n00:30:18.390 --> 00:30:20.830\nthe CCNP route goes into even more depth,\nso those are out there.\n\n606\n00:30:20.830 --> 00:30:24.389\nThey're a little CISCO centric, but\nyou saw the configuration side here,\n\n607\n00:30:24.389 --> 00:30:27.292\nthe concepts are the same between\nthe two different vendors.\n\n608\n00:30:27.292 --> 00:30:28.352\nAll right, well that's all we've got.\n\n609\n00:30:28.352 --> 00:30:29.302\nI hope you guys enjoyed it.\n\n610\n00:30:29.302 --> 00:30:32.062\nStay tuned,\nwe've got more pfSense content coming up.\n\n611\n00:30:32.062 --> 00:30:38.740\n[MUSIC]\n\n",
          "vimeoId": "132253660"
        }
      ],
      "title": "Services"
    },
    {
      "episodes": [
        {
          "description": null,
          "length": "1153",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-1-home_screen_widgets-062915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-1-home_screen_widgets-062915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-1-home_screen_widgets-062915-1-sm.jpg",
          "title": "Home Screen Widgets",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:05.313\n[SOUND] In this segment we're gonna take\n\n2\n00:00:05.313 --> 00:00:12.077\na look at the home screen\non the pfSense firewall.\n\n3\n00:00:12.077 --> 00:00:15.695\nBy default when you go ahead and install\nthe pfSense firewall, when you bring up\n\n4\n00:00:15.695 --> 00:00:19.330\nthe web page, it's going to bring\nyou to what is called the dashboard.\n\n5\n00:00:19.330 --> 00:00:22.440\nThat dashboard is gonna have\na little bit of information on it.\n\n6\n00:00:22.440 --> 00:00:24.380\nThe information can tell\nyou about the health and\n\n7\n00:00:24.380 --> 00:00:26.680\nthe status of the firewall itself.\n\n8\n00:00:26.680 --> 00:00:30.110\nBut there's a lot more behind\nthe pfSense firewall and\n\n9\n00:00:30.110 --> 00:00:33.390\nwe can actually customize it and\nwe can actually add a lot of different\n\n10\n00:00:33.390 --> 00:00:36.850\nelements into it that will make it more\nusable to what we actually need to do.\n\n11\n00:00:36.850 --> 00:00:40.520\nSo Don, what else do we actually need\nto know about the dashboard here?\n\n12\n00:00:40.520 --> 00:00:43.120\n>> Well, first thing we need\nto know is it is customizable,\n\n13\n00:00:43.120 --> 00:00:45.330\nyou'd be surprised how many\npeople don't realize that,\n\n14\n00:00:45.330 --> 00:00:47.960\nthat you can change what's\ndisplayed on that home screen.\n\n15\n00:00:47.960 --> 00:00:49.240\nBut before we start customizing,\n\n16\n00:00:49.240 --> 00:00:52.720\nlet's take a look at the information it\ndoes give us, because it's pretty handy.\n\n17\n00:00:52.720 --> 00:00:56.060\nWhen you first log into pfSense, you'll\nsee a screen that looks like mine and\n\n18\n00:00:56.060 --> 00:00:58.950\nit's got two little panes of information.\n\n19\n00:00:58.950 --> 00:01:02.900\nThose panes are our widgets, and the\nwidgets give you data about the system.\n\n20\n00:01:02.900 --> 00:01:05.790\nThe widget on the left is giving\nme general system information\n\n21\n00:01:05.790 --> 00:01:07.750\nabout my firewall in the install.\n\n22\n00:01:07.750 --> 00:01:10.940\nAnd the widget on the right is general\ninformation about my interfaces.\n\n23\n00:01:10.940 --> 00:01:13.470\nNow, that's pretty handy\ninformation to have.\n\n24\n00:01:13.470 --> 00:01:15.300\nWhat interfaces I've got?\n\n25\n00:01:15.300 --> 00:01:17.880\nWhat their speed and duplex is set to?\n\n26\n00:01:17.880 --> 00:01:20.550\nWhat their IP address is if they have one?\n\n27\n00:01:20.550 --> 00:01:23.050\nAnd their status as far as being up or\ndown.\n\n28\n00:01:23.050 --> 00:01:26.690\nNow be aware, you'll only see\nconfigured interfaces here.\n\n29\n00:01:26.690 --> 00:01:29.510\nYou might have ten interfaces, and\nyou just haven't configured the other ones\n\n30\n00:01:29.510 --> 00:01:31.490\nyet, but they're not gonna\nshow up here in the list.\n\n31\n00:01:31.490 --> 00:01:34.230\nBut you can see I've got three interfaces,\nI've configured them, and so\n\n32\n00:01:34.230 --> 00:01:36.650\nthey all show up right here in the widget.\n\n33\n00:01:36.650 --> 00:01:39.040\nOn the left side we see\nthings like our host name,\n\n34\n00:01:39.040 --> 00:01:40.970\nwhich is not generally important.\n\n35\n00:01:40.970 --> 00:01:43.710\nBut if you're trying to manage\nten different firewalls,\n\n36\n00:01:43.710 --> 00:01:46.170\nit's nice to know which\none you're logged into.\n\n37\n00:01:46.170 --> 00:01:47.927\nThen we can see our version information.\n\n38\n00:01:47.927 --> 00:01:49.755\nRight?\nWell what version of pfSense am I running?\n\n39\n00:01:49.755 --> 00:01:51.770\nI'm running 2.2.3.\n\n40\n00:01:51.770 --> 00:01:54.490\nAnd beneath it,\nit has a little dynamic check.\n\n41\n00:01:54.490 --> 00:01:57.260\nYou might not realize this but\nwhen you log into this homepage.\n\n42\n00:01:57.260 --> 00:02:01.210\nIt actually reaches out to\npfSense.org servers and\n\n43\n00:02:01.210 --> 00:02:02.530\nchecks to see if we have\nthe latest version.\n\n44\n00:02:02.530 --> 00:02:05.160\nLet me just refresh this screen and\nyou'll see it happen.\n\n45\n00:02:05.160 --> 00:02:07.290\nRight there, obtaining update status.\n\n46\n00:02:07.290 --> 00:02:10.030\nIt's reaching out to their servers and\nthen, it's gonna respond back.\n\n47\n00:02:10.030 --> 00:02:11.750\nNow, what if you don't want that?\n\n48\n00:02:11.750 --> 00:02:14.640\nI don't want it reaching out to\npfSense every time I go to homepage.\n\n49\n00:02:14.640 --> 00:02:16.000\nI can check on my own.\n\n50\n00:02:16.000 --> 00:02:17.690\nWell, you can disable that functionality.\n\n51\n00:02:17.690 --> 00:02:19.570\nYou don't have to have it do that check.\n\n52\n00:02:19.570 --> 00:02:24.570\nYou can go up to System > Firmware and\nunder the Firmware screen,\n\n53\n00:02:24.570 --> 00:02:26.690\nyou can go to Updater Settings.\n\n54\n00:02:26.690 --> 00:02:30.690\nAnd right in here you'll see,\nunder updates, the dashboard check.\n\n55\n00:02:30.690 --> 00:02:34.060\nAnd you can disable that dashboard check,\nI'll just save that.\n\n56\n00:02:34.060 --> 00:02:37.800\nAnd now that it's disabled, when I go back\nto the home screen, I still see my version\n\n57\n00:02:37.800 --> 00:02:41.205\ninformation, but it no longer checks\nto see if I have the latest version.\n\n58\n00:02:41.205 --> 00:02:41.910\nRight?\n\n59\n00:02:41.910 --> 00:02:44.290\nIt is a handy thing though, because\nif you're not at the latest version,\n\n60\n00:02:44.290 --> 00:02:46.580\nit gives you a link to go\nright to the updater page.\n\n61\n00:02:46.580 --> 00:02:50.060\nAnd, if you haven't watched already,\nwe did an episode on updating pfSense,\n\n62\n00:02:50.060 --> 00:02:53.290\ncheck that out and we actually go through\nthat process of doing the upgrade.\n\n63\n00:02:53.290 --> 00:02:55.150\nIt's nice to be able to know\nthat right from the dash.\n\n64\n00:02:56.750 --> 00:02:59.950\nAfter that we see things like our\nplatform, my platform is pfSense,\n\n65\n00:02:59.950 --> 00:03:04.220\nyou would pretty much expect to see that,\nand then information about your CPU.\n\n66\n00:03:04.220 --> 00:03:07.570\nNow pfSense can run on a number\nof different hardware types.\n\n67\n00:03:07.570 --> 00:03:10.940\nSo this is where you expect to see if\nyou're running an Intel processor or\n\n68\n00:03:10.940 --> 00:03:14.780\nAMD or some other processor variant,\nyou'll see that information in here.\n\n69\n00:03:14.780 --> 00:03:16.770\nHow many cores you have.\n\n70\n00:03:16.770 --> 00:03:19.930\nWhat the minimum and\nmaximum utilization is.\n\n71\n00:03:19.930 --> 00:03:23.469\nYou see I've got like a max of\na 2.8 gigahertz processor core.\n\n72\n00:03:23.469 --> 00:03:28.786\nI can run at 2.8 gigahertz of speed, but\nthat currently I'm only running at 350.\n\n73\n00:03:28.786 --> 00:03:29.800\nWell, why is that?\n\n74\n00:03:29.800 --> 00:03:31.820\nMy firewall is idling right now.\n\n75\n00:03:31.820 --> 00:03:33.700\nIt's a good way to see\nthe process utilization and\n\n76\n00:03:33.700 --> 00:03:36.300\nwe'll see another way here in a moment.\n\n77\n00:03:36.300 --> 00:03:36.880\nAfter that I can see my Uptime.\n\n78\n00:03:36.880 --> 00:03:39.187\nMy firewall has been up for\na blazing 17 minutes.\n\n79\n00:03:39.187 --> 00:03:39.745\nRight?\n\n80\n00:03:39.745 --> 00:03:42.440\n>> [LAUGH]\n>> So you might see 219 days on here.\n\n81\n00:03:42.440 --> 00:03:45.803\nHowever long it is that your\nsystem has been online for.\n\n82\n00:03:45.803 --> 00:03:49.310\nThe current date and\ntime as your firewall thinks it is,\n\n83\n00:03:49.310 --> 00:03:52.160\nnow you might ask yourself why\ndo we bother putting that there.\n\n84\n00:03:52.160 --> 00:03:53.850\nIt's really handy because\nif you're going and\n\n85\n00:03:53.850 --> 00:03:58.310\nlooking at your logs and the system\nlogs the times just aren't matching up,\n\n86\n00:03:58.310 --> 00:04:00.090\nyou might find that the clock\nis wrong on your firewall.\n\n87\n00:04:00.090 --> 00:04:02.450\nSo, you can look right here to see\nwhat time your firewall thinks it is.\n\n88\n00:04:03.600 --> 00:04:05.710\nThen the DNS servers that we're using.\n\n89\n00:04:05.710 --> 00:04:08.000\nAnd these are the DNS servers that\nthe firewall itself is using.\n\n90\n00:04:08.000 --> 00:04:11.050\nNot necessarily what it's handing\nout via DHCP or whatever but\n\n91\n00:04:11.050 --> 00:04:12.690\nwhat the firewall is using to do lookups.\n\n92\n00:04:13.690 --> 00:04:15.830\nWe can see when the last\nconfig change happened.\n\n93\n00:04:15.830 --> 00:04:17.910\nSo if something went wrong on\nthe firewall and I'm like man,\n\n94\n00:04:17.910 --> 00:04:19.590\ndid anybody change something?\n\n95\n00:04:19.590 --> 00:04:23.560\nI can look at this and I can say well,\nall right so I've got changes dated today.\n\n96\n00:04:23.560 --> 00:04:24.930\nSo, there's a problem here.\n\n97\n00:04:24.930 --> 00:04:25.760\nRight?\nOr you can look, and\n\n98\n00:04:25.760 --> 00:04:27.073\nthere's been no change in two months.\n\n99\n00:04:27.073 --> 00:04:31.669\nI just had this with a firewall last week\nwhere it had 219 day uptime I mentioned,\n\n100\n00:04:31.669 --> 00:04:34.362\nthat was this firewall I\nlooked at on Thursday and\n\n101\n00:04:34.362 --> 00:04:38.121\nit had a long uptime and there hadn't\nbeen a change in three months.\n\n102\n00:04:38.121 --> 00:04:41.197\nAnd something was going wrong and\nI thought man, if somebody changed\n\n103\n00:04:41.197 --> 00:04:45.015\nsomething, well, I knew they hadn't,\nbecause no change was registered here, and\n\n104\n00:04:45.015 --> 00:04:47.580\nthey had an uptime that was really,\nreally long.\n\n105\n00:04:47.580 --> 00:04:49.650\nSo I knew that whatever the problem was,\n\n106\n00:04:49.650 --> 00:04:52.410\nit probably wasn't stemming from\na configuration issue on the firewall.\n\n107\n00:04:54.150 --> 00:04:58.070\nAfter that, we start to see utilization,\nand this is really important.\n\n108\n00:04:58.070 --> 00:05:01.350\nA lot of people that deploy\npfSense build their own firewall.\n\n109\n00:05:01.350 --> 00:05:02.910\nThey either do a virtual machine, or\n\n110\n00:05:02.910 --> 00:05:06.660\nthey buy like a one-use server, they\ndo things like I'm doing here with ATOM\n\n111\n00:05:06.660 --> 00:05:10.325\nprocessors instead of like full Intels or\nwait, no, I'm on an i7.\n\n112\n00:05:10.325 --> 00:05:12.540\n>> [LAUGH]\n>> I have another firewall.\n\n113\n00:05:12.540 --> 00:05:13.130\nWhere was that thing?\n\n114\n00:05:13.130 --> 00:05:14.020\nHere, this guy.\n\n115\n00:05:14.020 --> 00:05:16.383\nThis firewall,\nwhich is on an ATOM processor.\n\n116\n00:05:16.383 --> 00:05:19.959\nRight?\nThat's not a full like Intel GPU or CPU,\n\n117\n00:05:19.959 --> 00:05:24.750\nit's more of like a mobile or\nlow-energy processor.\n\n118\n00:05:24.750 --> 00:05:27.710\nAnd so when you start building\nstuff on custom hardware,\n\n119\n00:05:27.710 --> 00:05:31.030\nhow do you know whether your\nhardware can handle the load?\n\n120\n00:05:31.030 --> 00:05:35.050\nAnd you can look at these little\ngraphs to find that information out.\n\n121\n00:05:35.050 --> 00:05:39.789\nIt's all laid out right here in\na state table, MBUF and insulin.\n\n122\n00:05:39.789 --> 00:05:40.540\nRight?\n\n123\n00:05:40.540 --> 00:05:41.660\nSo what are each of these?\n\n124\n00:05:41.660 --> 00:05:46.560\nWell, the state table, whenever somebody\nbuilds a connection through your firewall,\n\n125\n00:05:46.560 --> 00:05:48.520\nthere's rules that apply\nto their connection and\n\n126\n00:05:48.520 --> 00:05:50.800\nthere's probably network translation too.\n\n127\n00:05:50.800 --> 00:05:53.350\nSo each of them has to be\ntracked by the fire wall.\n\n128\n00:05:53.350 --> 00:05:54.539\nAnd that's called State.\n\n129\n00:05:54.539 --> 00:05:59.208\nNow, one client might generate\nhundreds of state connections.\n\n130\n00:05:59.208 --> 00:06:03.478\nIf you guys watched the episode,\nI don't remember if we did it here, but\n\n131\n00:06:03.478 --> 00:06:07.888\nlet me just show you an example of like\nhere, if I open up a command prompt and\n\n132\n00:06:07.888 --> 00:06:10.340\ndo a netstat here on my client.\n\n133\n00:06:10.340 --> 00:06:13.110\nWell let me do netstat -n to\nmake that go a little faster.\n\n134\n00:06:13.110 --> 00:06:16.800\nAll right, so here's sessions\nthat I've got open on my system.\n\n135\n00:06:16.800 --> 00:06:19.960\nI've only got two,\nthere's nothing spectacular going on here.\n\n136\n00:06:19.960 --> 00:06:23.559\nBut if I do something like I fire up\na web browser and I go to CNN.com.\n\n137\n00:06:23.559 --> 00:06:24.200\nRight?\n\n138\n00:06:24.200 --> 00:06:26.540\nI'm just browsing the one web page.\n\n139\n00:06:26.540 --> 00:06:28.900\nSo now I've browsed through this web page,\nand\n\n140\n00:06:28.900 --> 00:06:33.592\nwhen I go back into a net-n look at all\nthe connections that I just opened up.\n\n141\n00:06:33.592 --> 00:06:34.600\nAll right?\n\n142\n00:06:34.600 --> 00:06:37.185\nThere's a state for each one of those.\n\n143\n00:06:37.185 --> 00:06:42.070\nWell, that's a good 100-150 It's really\na testament to how many advertisements\n\n144\n00:06:42.070 --> 00:06:43.290\nI'm seeing on this web page.\n\n145\n00:06:43.290 --> 00:06:46.610\nThere's easily 150\nconnections right there.\n\n146\n00:06:46.610 --> 00:06:48.760\nYour firewall has to track all of those.\n\n147\n00:06:48.760 --> 00:06:53.560\nAnd so in your dashboard, it's showing\nyou how many states it can handle and\n\n148\n00:06:53.560 --> 00:06:57.590\nyou'll see that my firewall can\nactually handle 201,000 states and\n\n149\n00:06:57.590 --> 00:06:59.900\nthat right now it's tracking 895.\n\n150\n00:06:59.900 --> 00:07:01.820\nWhich doesn't even register\nas a single percent.\n\n151\n00:07:01.820 --> 00:07:05.260\nOop, it just jumped up because of my\nlittle web browser, so now I'm at 1%.\n\n152\n00:07:05.260 --> 00:07:06.560\nAll right?\n\n153\n00:07:06.560 --> 00:07:09.100\nSo, if I'm gonna add 50 more clients,\n\n154\n00:07:09.100 --> 00:07:11.820\nam I gonna have a state table\nthat's big enough to handle that?\n\n155\n00:07:11.820 --> 00:07:14.160\nIf it isn't, I need to add more memory.\n\n156\n00:07:14.160 --> 00:07:15.750\nRight?\nMemory, your RAM, and\n\n157\n00:07:15.750 --> 00:07:19.450\nyour firewall is gonna equate to how\nmuch of a state table you can have.\n\n158\n00:07:19.450 --> 00:07:21.325\nAnd that's what you're seeing\nnext is the memory buffer.\n\n159\n00:07:21.325 --> 00:07:22.120\nRight?\n\n160\n00:07:22.120 --> 00:07:25.223\nHow am I using my memory and you'll\nsee that I've allocated this system.\n\n161\n00:07:25.223 --> 00:07:26.523\nNot a ton of memory.\n\n162\n00:07:26.523 --> 00:07:31.440\nIt's 26.5 Megs, is what it's\nlisting there for that buffer and\n\n163\n00:07:31.440 --> 00:07:35.840\nit's currently using one and\na half Megs of it.\n\n164\n00:07:35.840 --> 00:07:37.530\nThen you can see your CPU load.\n\n165\n00:07:37.530 --> 00:07:39.650\nRight?\nYou get your CPU load average and\n\n166\n00:07:39.650 --> 00:07:41.350\nI can see mine is pretty low.\n\n167\n00:07:41.350 --> 00:07:43.920\nAnd you've got the last one minute,\nthe last five minutes, and\n\n168\n00:07:43.920 --> 00:07:44.878\nthe last 15 minutes.\n\n169\n00:07:44.878 --> 00:07:48.850\nSo over the last 15 minutes I've\nbeen averaging .08 CPU, or 0%.\n\n170\n00:07:48.850 --> 00:07:52.600\nI've got plenty of CPU\npower on this thing.\n\n171\n00:07:52.600 --> 00:07:53.710\nRight?\n\n172\n00:07:53.710 --> 00:07:56.720\nI'll run out of memory before\nI run out of CPU power.\n\n173\n00:07:56.720 --> 00:08:00.910\nThen down here in my memory I've actually\ngot two gigs of total RAM in the system\n\n174\n00:08:00.910 --> 00:08:03.130\nand I'm using 8% of that.\n\n175\n00:08:03.130 --> 00:08:05.280\nMy swap file, if I run out of RAM,\n\n176\n00:08:05.280 --> 00:08:09.420\nI'll start to use the swap file that\nhasn't happened so my swap file is empty.\n\n177\n00:08:09.420 --> 00:08:13.550\nAnd then disk, you may or may not have\nstorage available for your firewall\n\n178\n00:08:13.550 --> 00:08:18.140\nyou might be running just off a flash\nmemory or integrated into a motherboard.\n\n179\n00:08:18.140 --> 00:08:21.470\nAnd so you may just have your slash or\nyour root system and that's it.\n\n180\n00:08:21.470 --> 00:08:24.600\nBut on mine, you can see I've got\nabout 15 gigs of memory available or\n\n181\n00:08:24.600 --> 00:08:25.950\nstorage available.\n\n182\n00:08:25.950 --> 00:08:27.560\nAnd I'm using just 2% of it.\n\n183\n00:08:28.590 --> 00:08:33.520\nSo that's all information we can\nget right here from the home screen\n\n184\n00:08:33.520 --> 00:08:37.720\nin it's default config, but\nboy we can have a lot of fun with this.\n\n185\n00:08:37.720 --> 00:08:41.190\nWe can add a lot more information in here\nthat's pretty powerful, and you probably\n\n186\n00:08:41.190 --> 00:08:45.182\nnotice that this other firewall that I\npulled up, I got all sorts of stuff on it.\n\n187\n00:08:45.182 --> 00:08:50.310\nGot bandwidth graphs, we've got service\nstatuses, we've got tunnel information.\n\n188\n00:08:50.310 --> 00:08:52.646\nRight?\nI mean just all sorts of information in\n\n189\n00:08:52.646 --> 00:08:53.229\nhere.\n\n190\n00:08:53.229 --> 00:08:54.395\nAll right?\n\n191\n00:08:54.395 --> 00:08:58.670\nWell that's how we can customize this\ndashboard to make it where at a glance we\n\n192\n00:08:58.670 --> 00:09:01.900\ncan look at our firewall and\nsee the health and status of it.\n\n193\n00:09:01.900 --> 00:09:04.010\nAnd we do that through the use of widgets.\n\n194\n00:09:05.520 --> 00:09:08.490\nNow when I move my mouse cursor to the top\nof any of these widgets it changes to that\n\n195\n00:09:08.490 --> 00:09:11.710\nfour way arrow thing, and\nthat just means that I can drag this and\n\n196\n00:09:11.710 --> 00:09:14.300\nmove it around and\nkinda change how things are laid out.\n\n197\n00:09:14.300 --> 00:09:16.020\nRight?\nThat's fun and exciting.\n\n198\n00:09:16.020 --> 00:09:19.730\nBut, what's really fun and exciting,\nis the little plus sign up here.\n\n199\n00:09:19.730 --> 00:09:24.640\nWhen we can add a number of other widgets\nto customize what we want to see.\n\n200\n00:09:24.640 --> 00:09:29.340\nSo for example if I'm running Carp, and\nI want to see is this guy the master or\n\n201\n00:09:29.340 --> 00:09:32.640\nis it in standby and\nthe other router's the master.\n\n202\n00:09:32.640 --> 00:09:34.620\nI can add in that Carp status.\n\n203\n00:09:34.620 --> 00:09:36.364\nAnd then we would see\na little block in here,\n\n204\n00:09:36.364 --> 00:09:38.170\nwhich is probably going to the bottom.\n\n205\n00:09:38.170 --> 00:09:39.220\nThere it is.\n\n206\n00:09:39.220 --> 00:09:42.840\nI'm gonna move that over here,\nI'm gonna try and move that over here.\n\n207\n00:09:42.840 --> 00:09:45.710\nIf I can configure Carp on this\nsystem then it would show up here and\n\n208\n00:09:45.710 --> 00:09:50.040\nI would be able to see that configuration\nand it's associated information.\n\n209\n00:09:50.040 --> 00:09:52.500\nI'm not running Carp so\nit really doesn't help me.\n\n210\n00:09:52.500 --> 00:09:56.170\nBut if I go over here and add, I can\nadd in other things, like my gateways.\n\n211\n00:09:57.230 --> 00:09:58.180\nI can add in.\n\n212\n00:09:58.180 --> 00:10:00.400\nHere, let's just add a couple of\nthese in that are pretty common.\n\n213\n00:10:01.760 --> 00:10:03.450\nLet's see, we could do.\n\n214\n00:10:03.450 --> 00:10:08.510\nWe've had interfaces, IP sec is a great\none for monitoring your IP set tunnels.\n\n215\n00:10:08.510 --> 00:10:10.100\nLet's just run down\nthe list of what these are.\n\n216\n00:10:10.100 --> 00:10:11.750\nRight?\nSo, a captive portal.\n\n217\n00:10:11.750 --> 00:10:14.320\nIf we've enabled captive portal,\nthis is gonna show us.\n\n218\n00:10:14.320 --> 00:10:16.920\nWho's authenticated against\nour captive portal.\n\n219\n00:10:16.920 --> 00:10:19.340\nHow many clients are passing through it,\nand who are they, so\n\n220\n00:10:19.340 --> 00:10:21.020\na quick kind of status on that.\n\n221\n00:10:21.020 --> 00:10:25.500\nCarp status, if we're the active router or\nif we're the standby for Carp.\n\n222\n00:10:25.500 --> 00:10:28.530\nDin DNS,\nif we're doing dynamic DNS updates,\n\n223\n00:10:28.530 --> 00:10:32.340\nthis will show the last time we updated,\nand whether we were successful.\n\n224\n00:10:33.350 --> 00:10:34.450\nOur gateways.\n\n225\n00:10:34.450 --> 00:10:37.270\nThis will show each of\nthe default gateways and\n\n226\n00:10:37.270 --> 00:10:39.190\nthe regular gateways that we put in.\n\n227\n00:10:39.190 --> 00:10:40.790\nAnd if we turned on monitoring,\n\n228\n00:10:40.790 --> 00:10:42.690\nthen it's gonna show whether\nthose gateways are healthy.\n\n229\n00:10:42.690 --> 00:10:46.580\nCan we actually talk to them and\nmove data through them?\n\n230\n00:10:46.580 --> 00:10:51.510\nGeomirrors status, that's for the geo ip\ndatabase, there's several different types\n\n231\n00:10:51.510 --> 00:10:55.550\nof reports we'll see in other episodes\nwhere you can geolocate people's IPs and\n\n232\n00:10:55.550 --> 00:10:59.350\nhere it's just showing the mirror status,\nhave we updated recently.\n\n233\n00:10:59.350 --> 00:11:03.310\nInstalled Packages, just a list of the\npackages you have installed on pfSense.\n\n234\n00:11:03.310 --> 00:11:05.000\nYour interface statistics.\n\n235\n00:11:05.000 --> 00:11:09.470\nSo, each of your interfaces and, how much\nis, I like that one, I'll add that one in.\n\n236\n00:11:09.470 --> 00:11:12.560\nAnd how much traffic they've moved and\nwhether they've had interface errors,\n\n237\n00:11:12.560 --> 00:11:13.780\nthings of that nature.\n\n238\n00:11:13.780 --> 00:11:16.170\nThe interfaces themselves,\nthat's this window over here,\n\n239\n00:11:16.170 --> 00:11:17.050\nwe've already got that one.\n\n240\n00:11:18.320 --> 00:11:19.680\nThen we've got IPsec.\n\n241\n00:11:19.680 --> 00:11:22.030\nIf you have any IPsec VPN tunnels set up,\n\n242\n00:11:22.030 --> 00:11:24.120\nit'll show you if they're up or\nif they're down.\n\n243\n00:11:24.120 --> 00:11:26.180\nIf they're up it'll show you\nhow long they were up for\n\n244\n00:11:26.180 --> 00:11:27.350\nand how much traffic they'd moved.\n\n245\n00:11:28.530 --> 00:11:30.270\nThe loadbalancer status.\n\n246\n00:11:30.270 --> 00:11:34.090\nIf we've got loadbalancing configured,\nwe can see information about it.\n\n247\n00:11:34.090 --> 00:11:35.560\nOur firewall logs.\n\n248\n00:11:35.560 --> 00:11:38.370\nThis'll show the most recent\nSyslog entries that have occurred\n\n249\n00:11:38.370 --> 00:11:38.900\non the firewall.\n\n250\n00:11:38.900 --> 00:11:41.580\nIf you've ever used a Cisco ASA,\nthis is very similar to them.\n\n251\n00:11:41.580 --> 00:11:44.390\nWhen you access their home page,\nthey've got the log windows at the bottom.\n\n252\n00:11:44.390 --> 00:11:46.440\nWe can add that same functionality here.\n\n253\n00:11:46.440 --> 00:11:49.020\nI'll go ahead and add that one.\n\n254\n00:11:49.020 --> 00:11:52.930\nThen we can do NTP status if we're set for\nusing a time server then we can see\n\n255\n00:11:52.930 --> 00:11:56.340\nthe last time we checked with it and\nwhat our time is set to.\n\n256\n00:11:56.340 --> 00:12:00.710\nOpen VPN, these might be site to site or\nremote access tunnels.\n\n257\n00:12:00.710 --> 00:12:03.970\nI can see their health and status,\nwho is connected via remote access or\n\n258\n00:12:03.970 --> 00:12:05.260\nwhat site to site connections are up.\n\n259\n00:12:06.380 --> 00:12:07.930\nPicture, this one's kind of silly.\n\n260\n00:12:07.930 --> 00:12:10.020\nIf you choose picture,\nyou can add a picture to your home page,\n\n261\n00:12:10.020 --> 00:12:11.986\nmaybe you want to add a company logo or\nwhatever.\n\n262\n00:12:11.986 --> 00:12:16.890\nRSS, you can add in RSS feed so if you've\ngot some security blog you follow or\n\n263\n00:12:16.890 --> 00:12:18.320\nwhatever, you can throw it in there.\n\n264\n00:12:18.320 --> 00:12:20.400\nAgain, another kind of silly one.\n\n265\n00:12:20.400 --> 00:12:21.480\nService status.\n\n266\n00:12:21.480 --> 00:12:22.660\nI do like this one.\n\n267\n00:12:22.660 --> 00:12:23.760\nWith service status,\n\n268\n00:12:23.760 --> 00:12:26.220\nyou can show all the services of your\nsystem when they're healthy or not.\n\n269\n00:12:26.220 --> 00:12:29.150\nIf a service has crashed, you can see\nthat, or if you want to restart it,\n\n270\n00:12:29.150 --> 00:12:30.660\nyou can do it all right\nfrom the dashboard.\n\n271\n00:12:31.860 --> 00:12:33.370\nSmart status.\n\n272\n00:12:33.370 --> 00:12:36.610\nIf you have a hard drive\ninside of your firewall,\n\n273\n00:12:36.610 --> 00:12:37.990\nhard drives had this smart detection.\n\n274\n00:12:37.990 --> 00:12:39.930\nRonnie do you remember\nwhat smart stands for?\n\n275\n00:12:39.930 --> 00:12:40.600\n>> I do not right now.\n\n276\n00:12:40.600 --> 00:12:44.720\n>> It's some kind of self maintenance and\nsomething something technology.\n\n277\n00:12:44.720 --> 00:12:47.200\nIt's where a hard drive can\ndetect its own failures.\n\n278\n00:12:47.200 --> 00:12:50.900\nSo if the hard drive is healthy,\nthe smart status passes and its great.\n\n279\n00:12:50.900 --> 00:12:54.720\nIf smart fails then that means there is an\nimpending hard drive failure coming down\n\n280\n00:12:54.720 --> 00:12:56.640\nthe road,\nyou need to change out that hard drive.\n\n281\n00:12:56.640 --> 00:12:59.055\nSo we can actually see that\nsmart status right here.\n\n282\n00:12:59.055 --> 00:13:01.340\nThat's really important because\na lot of our firewalls are headless,\n\n283\n00:13:01.340 --> 00:13:02.780\nyou don't have a monitor on them.\n\n284\n00:13:02.780 --> 00:13:05.730\nAnd that's where you'd normally see your\nsmart status when you boot a system up.\n\n285\n00:13:05.730 --> 00:13:07.440\nYou see it before\nthe operating system boots.\n\n286\n00:13:08.930 --> 00:13:10.250\nWe can do system information.\n\n287\n00:13:10.250 --> 00:13:12.620\nWell that's this main panel\nhere we've already got.\n\n288\n00:13:13.810 --> 00:13:16.480\nWe can do Thermal Sensors.\n\n289\n00:13:16.480 --> 00:13:19.100\nMost motherboards these days\nare equipped with thermal sensors so\n\n290\n00:13:19.100 --> 00:13:20.980\nwe can see the temperature\ninside of our firewall.\n\n291\n00:13:21.990 --> 00:13:26.270\nTraffic Graphs, we can see how much\ntraffic is moving across our firewall, and\n\n292\n00:13:26.270 --> 00:13:29.020\nyou can see incoming and\noutgoing bandwidth.\n\n293\n00:13:29.020 --> 00:13:32.500\nAnd then wake on LAN, this is whether\nwe're enabled for Wake on LAN and\n\n294\n00:13:32.500 --> 00:13:35.040\nthen, whether we've got clients setup for\nWake on LAN, too.\n\n295\n00:13:35.040 --> 00:13:37.710\nAnd, we can trigger that\nright from a widget.\n\n296\n00:13:37.710 --> 00:13:40.520\nNow, each time I clicked on one these,\nit added it to the homepage.\n\n297\n00:13:40.520 --> 00:13:42.920\nI just kind of threw them\non there in a random order.\n\n298\n00:13:42.920 --> 00:13:48.047\nAnd I can drag these around to\ncreate the layout that I want.\n\n299\n00:13:48.047 --> 00:13:52.318\nSo maybe I want my interface\nlist right at the top,\n\n300\n00:13:52.318 --> 00:13:56.193\nI want my traffic graphs\nright beneath that.\n\n301\n00:13:56.193 --> 00:13:57.042\nAll right?\n\n302\n00:13:57.042 --> 00:14:00.780\nI want my logs to be way\ndown here at the bottom.\n\n303\n00:14:00.780 --> 00:14:04.060\nI might wanna move my\ngateways over somewhere else,\n\n304\n00:14:04.060 --> 00:14:05.390\nor my interface statistics.\n\n305\n00:14:05.390 --> 00:14:07.930\nRight?\nSo, we can really start to customize this\n\n306\n00:14:07.930 --> 00:14:11.990\nto build the layout that is\norganized the way that we want.\n\n307\n00:14:11.990 --> 00:14:18.080\nNow, be aware that all of this stuff is\nkind of just being changed right now and\n\n308\n00:14:18.080 --> 00:14:20.810\nI've gotta save this if I want it to stay.\n\n309\n00:14:20.810 --> 00:14:24.890\nOtherwise it's gonna all\ndisappear when I log out, which is\n\n310\n00:14:24.890 --> 00:14:28.590\nkinda depressing if we spent a bunch\nof time to do this and you lose it all.\n\n311\n00:14:28.590 --> 00:14:29.472\nThat's no fun at all.\n\n312\n00:14:29.472 --> 00:14:32.680\nAll right, so we can get in here and\nkinda settle this up.\n\n313\n00:14:32.680 --> 00:14:34.450\nWhy is it not letting me\nput the logs over here?\n\n314\n00:14:34.450 --> 00:14:37.190\nIt's decided that the logs\nare not gonna go there.\n\n315\n00:14:37.190 --> 00:14:38.580\nThere we go.\nAll right.\n\n316\n00:14:38.580 --> 00:14:40.510\nSo now I've built this layout\nkinda the way that I want it, but\n\n317\n00:14:40.510 --> 00:14:41.920\nwe can go even further.\n\n318\n00:14:41.920 --> 00:14:44.020\nSome of these layouts like traffic graphs.\n\n319\n00:14:44.020 --> 00:14:47.070\nSee how it's defaulting just\nshowing my wan traffic?\n\n320\n00:14:47.070 --> 00:14:51.260\nIf I expand out current traffic I\ncan see my current LAN traffic.\n\n321\n00:14:51.260 --> 00:14:52.560\nRight?\nAnd even DMZ.\n\n322\n00:14:52.560 --> 00:14:54.690\nAnd maybe I want those\nexpanded by default.\n\n323\n00:14:54.690 --> 00:14:59.340\nWell you can expand them here and\nwhen I save it will save them as expanded.\n\n324\n00:14:59.340 --> 00:15:00.990\nSame thing goes for\nsome of the other entries here.\n\n325\n00:15:00.990 --> 00:15:02.530\nBut I can see my interface statistics.\n\n326\n00:15:02.530 --> 00:15:06.870\nPackets In, Packets Out, Errors In and\nOut, all good things to know.\n\n327\n00:15:06.870 --> 00:15:09.490\nMy service status is right\nthere like I explained.\n\n328\n00:15:09.490 --> 00:15:13.190\nHere's my most recent firewall logs for\ntraffic that was blocked or allowed.\n\n329\n00:15:14.190 --> 00:15:16.280\nAnd then, down here, I've got my gateways.\n\n330\n00:15:16.280 --> 00:15:18.100\nAnd, you'll see two of\nmy gateways are online.\n\n331\n00:15:18.100 --> 00:15:19.880\nOne of my gateways is unknown.\n\n332\n00:15:19.880 --> 00:15:21.890\nI can see that health and\nstatus right there.\n\n333\n00:15:21.890 --> 00:15:24.920\n>> Now Don, I also noticed that on that\nred bar where it says firewall logs,\n\n334\n00:15:24.920 --> 00:15:27.990\nyou have a little wrench that you can\neven customize within that little\n\n335\n00:15:27.990 --> 00:15:28.930\nwindow as well.\n\n336\n00:15:28.930 --> 00:15:31.160\n>> Sure.\nYeah, some of them have that, all do here.\n\n337\n00:15:31.160 --> 00:15:33.550\nHere we can change how\nmany lines that we see.\n\n338\n00:15:33.550 --> 00:15:34.910\nSo I'm just seeing five.\n\n339\n00:15:34.910 --> 00:15:37.480\nWe can bump that up to show\nmore if we want, up to 20.\n\n340\n00:15:37.480 --> 00:15:42.820\nWe can tell it to show passes or blocks or\nrejects or just one or the other.\n\n341\n00:15:42.820 --> 00:15:45.040\nSo maybe you don't want to see passes.\n\n342\n00:15:45.040 --> 00:15:45.840\nI'm gonna turn it all on.\n\n343\n00:15:47.020 --> 00:15:51.080\nAnd maybe I just wanna see if my LAN\ntraffic, so you can update that and\n\n344\n00:15:51.080 --> 00:15:52.070\nnow that behavior is gonna change.\n\n345\n00:15:52.070 --> 00:15:53.135\nYou see what just happened?\n\n346\n00:15:53.135 --> 00:15:55.670\n>> [LAUGH]\n>> See how I lost everything?\n\n347\n00:15:55.670 --> 00:15:58.610\nWell what happens is when you\nstart adding widgets it's\n\n348\n00:15:58.610 --> 00:16:02.960\nreally important that when you do that\nyou hit this big save settings button.\n\n349\n00:16:02.960 --> 00:16:07.902\nAnd then once it saves the overall layout,\nthen you can edit the individual widgets.\n\n350\n00:16:07.902 --> 00:16:08.510\nAll right?\n\n351\n00:16:08.510 --> 00:16:11.510\nSo just bear in mind that it does\nkinda track that separately.\n\n352\n00:16:11.510 --> 00:16:13.298\nIt is important to monitor that.\n\n353\n00:16:13.298 --> 00:16:16.180\nBut I wanna show you this on a different\nfirewall, this guy right here,\n\n354\n00:16:16.180 --> 00:16:19.240\nwhere we have customized that with\nthe information that I wanted.\n\n355\n00:16:19.240 --> 00:16:20.526\nI can see my current LAN traffic.\n\n356\n00:16:20.526 --> 00:16:21.570\nRight?\n\n357\n00:16:21.570 --> 00:16:25.530\nI can see [COUGH] that this one\nhas four megs of incoming traffic.\n\n358\n00:16:25.530 --> 00:16:27.180\nAnd 143 megs of outgoing traffic.\n\n359\n00:16:27.180 --> 00:16:31.220\nRight there's a good idea of how much\ntraffic I'm moving on that system.\n\n360\n00:16:31.220 --> 00:16:33.280\nAnd then I can see the interfaces and\ntheir status.\n\n361\n00:16:33.280 --> 00:16:35.870\nI can see my services and\nthat their healthy.\n\n362\n00:16:35.870 --> 00:16:36.610\nRight?\nThis one's running\n\n363\n00:16:36.610 --> 00:16:37.590\nseveral different things.\n\n364\n00:16:38.760 --> 00:16:41.490\nI can see the smart status with\nthis hard drive and its passed.\n\n365\n00:16:41.490 --> 00:16:43.570\nI know that hard drive\nis healthy right now.\n\n366\n00:16:43.570 --> 00:16:46.670\nUnder open VPN I can see peer\nto peer server instances,\n\n367\n00:16:46.670 --> 00:16:50.182\nthese would be site to site, but\nI can also see remote access.\n\n368\n00:16:50.182 --> 00:16:51.440\nNobody is remoted in right now,\n\n369\n00:16:51.440 --> 00:16:53.830\notherwise I would see it right there and\nI would know it.\n\n370\n00:16:53.830 --> 00:16:57.740\nSo these are great ways to be able\nto get information about your system\n\n371\n00:16:57.740 --> 00:17:02.120\nall just at a glance, you quickly examine\nit, look at it, and determine whether or\n\n372\n00:17:02.120 --> 00:17:03.690\nnot your system is healthy.\n\n373\n00:17:03.690 --> 00:17:04.240\nRight?\n\n374\n00:17:04.240 --> 00:17:05.370\nSo customize that.\n\n375\n00:17:05.370 --> 00:17:06.520\nRight?\nPlay around with it.\n\n376\n00:17:06.520 --> 00:17:07.930\nThe widgets are pretty neat.\n\n377\n00:17:07.930 --> 00:17:10.880\nThey're only loaded when you're on\nthe homepage, so it doesn't increase\n\n378\n00:17:10.880 --> 00:17:14.080\nthe burden on the firewall,\nbecause normally nobody's on the homepage.\n\n379\n00:17:14.080 --> 00:17:14.650\nRight?\n\n380\n00:17:14.650 --> 00:17:17.080\nSo you customize it,\nyou get it set up the way you want, and\n\n381\n00:17:17.080 --> 00:17:19.390\nnow you get that at a glance monitoring,\nwhich is pretty nice.\n\n382\n00:17:21.000 --> 00:17:25.550\n>> Now Don, this is actually a great view\nfor us to have because it actually allows\n\n383\n00:17:25.550 --> 00:17:29.950\nus, when we first log in, to just not\nhave to go to every single little tab,\n\n384\n00:17:29.950 --> 00:17:32.400\nto be able to have a nice\nquick glance in the summary,\n\n385\n00:17:32.400 --> 00:17:35.160\nof the way that the performance\nof our firewall is going.\n\n386\n00:17:35.160 --> 00:17:37.840\nIs there anything else that we\nshould be doing to this thing\n\n387\n00:17:37.840 --> 00:17:38.990\nto kinda help improve us?\n\n388\n00:17:38.990 --> 00:17:42.600\nBut you just showed us,\nreally the ones that you would add in.\n\n389\n00:17:43.790 --> 00:17:46.509\nAll the rest of this stuff like\nthe pictures you don't really care about.\n\n390\n00:17:46.509 --> 00:17:47.430\n[LAUGH]\n>> I don't care about it, but\n\n391\n00:17:47.430 --> 00:17:49.770\nyou guys out there in TV land you might.\n\n392\n00:17:49.770 --> 00:17:52.460\nAnd hey, I'm not running Carp here so\nI don't the Carp widget but\n\n393\n00:17:52.460 --> 00:17:54.460\nmaybe you are,\nyou'll want that Carp widget.\n\n394\n00:17:54.460 --> 00:17:56.850\nSo It really is kinda\ncustomized to your environment.\n\n395\n00:17:56.850 --> 00:17:59.230\nAnd remember,\nyou don't have to do this stuff.\n\n396\n00:17:59.230 --> 00:17:59.767\nRight?\nEvery bit\n\n397\n00:17:59.767 --> 00:18:02.221\nof information on this dashboard\nis accessible somewhere else.\n\n398\n00:18:02.221 --> 00:18:02.800\nRight?\n\n399\n00:18:02.800 --> 00:18:05.990\nWe can go under our Status\n> CARP failover and\n\n400\n00:18:05.990 --> 00:18:08.170\nI can find out everything I\nneed about CARP right there.\n\n401\n00:18:08.170 --> 00:18:10.970\nI can go under Status and\nI can pull up my Interface statuses.\n\n402\n00:18:10.970 --> 00:18:12.930\nAnd here I can see the same information.\n\n403\n00:18:12.930 --> 00:18:15.321\nHere's my in/out packets, my errors.\n\n404\n00:18:15.321 --> 00:18:15.920\nRight?\n\n405\n00:18:15.920 --> 00:18:18.450\nSo, none of the data on\nthe dashboard is secret.\n\n406\n00:18:18.450 --> 00:18:22.030\nIt's just making it human readable,\nputting it all in one place, and\n\n407\n00:18:22.030 --> 00:18:23.180\nmaking it convenient.\n\n408\n00:18:23.180 --> 00:18:25.980\nBecause otherwise, you're like me, and\nyou're like, well, is that under Status or\n\n409\n00:18:25.980 --> 00:18:28.370\nis that under Diagnostics,\nbecause I can never remember.\n\n410\n00:18:28.370 --> 00:18:31.080\nAnd then you've got to go through and\ntry and find the stuff, and it's just so\n\n411\n00:18:31.080 --> 00:18:32.740\nmuch easier to be in one place.\n\n412\n00:18:32.740 --> 00:18:34.630\nIt's all just about convenience.\n\n413\n00:18:34.630 --> 00:18:35.450\n>> It really is.\n\n414\n00:18:35.450 --> 00:18:38.220\nThe main one that I use as far as\nwhen somebody calls me and says,\n\n415\n00:18:38.220 --> 00:18:41.010\nhey, my VPN connection is not up.\n\n416\n00:18:41.010 --> 00:18:41.840\nI just launch in.\n\n417\n00:18:41.840 --> 00:18:45.150\nI go directly to the page and I can see\nthat little window there and I can go,\n\n418\n00:18:45.150 --> 00:18:48.520\noh yeah it's not up, or no it looks like\nit is up, there may be other issues.\n\n419\n00:18:48.520 --> 00:18:52.880\nSo it's a great little convenience\nsummary location for us to have.\n\n420\n00:18:52.880 --> 00:18:55.920\nThis utility for\nus in the pfSense firewall.\n\n421\n00:18:55.920 --> 00:18:56.640\n>> All right, everybody.\n\n422\n00:18:56.640 --> 00:18:57.760\nI hope you guys enjoyed the show.\n\n423\n00:18:57.760 --> 00:19:01.160\nA lot of neat stuff in Widgets,\nso definitely have fun with that.\n\n424\n00:19:01.160 --> 00:19:03.070\nI hope you guys enjoyed it as\nmuch as we did filming it.\n\n425\n00:19:03.070 --> 00:19:03.613\nStay tuned.\n\n426\n00:19:03.613 --> 00:19:06.401\nWe've got more pfSense content coming up.\n\n427\n00:19:06.401 --> 00:19:07.760\n[SOUND]\n\n",
          "vimeoId": "132253662"
        },
        {
          "description": null,
          "length": "2074",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/teckskills-pfsense-6-2-diagnostic_tools-063015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/teckskills-pfsense-6-2-diagnostic_tools-063015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/teckskills-pfsense-6-2-diagnostic_tools-063015-1-sm.jpg",
          "title": "Diagnostic Tools",
          "transcript": "WEBVTT\n\n1\n00:00:00.263 --> 00:00:08.064\n[MUSIC]\n\n2\n00:00:08.064 --> 00:00:09.110\nIn this segment,\n\n3\n00:00:09.110 --> 00:00:14.020\nwe're gonna be taking a look at\npfSense firewalls diagnostic tools.\n\n4\n00:00:14.020 --> 00:00:18.100\nIn pfSense, there's so many different\ntools that are actually right there, so\n\n5\n00:00:18.100 --> 00:00:22.330\nthat you can take a look at all\nthe different things that may go wrong,\n\n6\n00:00:22.330 --> 00:00:24.400\nthat may actually be\nfunctioning correctly.\n\n7\n00:00:24.400 --> 00:00:27.960\nIt is amazing that they went ahead and\nbuilt all these tools in there, because it\n\n8\n00:00:27.960 --> 00:00:32.470\nmakes it a nice contained tool in itself,\nas far as the firewall, and we don't have\n\n9\n00:00:32.470 --> 00:00:36.940\nto go outside of it too often to actually\nsee what's happening on the firewall.\n\n10\n00:00:36.940 --> 00:00:39.200\nAnd today,\nwe're taking a look at with Don.\n\n11\n00:00:39.200 --> 00:00:41.638\nDon, this is an amazing set of tools,\nisn't it?\n\n12\n00:00:41.638 --> 00:00:43.790\n>> It really is, and\nit's incredibly useful.\n\n13\n00:00:43.790 --> 00:00:47.429\nAnd one of the big things for me is,\nif you're having network problems,\n\n14\n00:00:47.429 --> 00:00:51.545\nyou can troubleshoot from a PC or Mac,\nyou know, a laptop, desktop, whatever,\n\n15\n00:00:51.545 --> 00:00:52.934\nif you have access to that.\n\n16\n00:00:52.934 --> 00:00:56.552\nBut if you're a remote user, you might\nnot have access to a machine that's in\n\n17\n00:00:56.552 --> 00:01:00.393\na branch office or wherever, so it's nice\nto be able to connect to the firewall and\n\n18\n00:01:00.393 --> 00:01:03.092\nrun diagnostics and\ntest the network from the firewall.\n\n19\n00:01:03.092 --> 00:01:06.880\nAlso, you might just want to eliminate\nthe PC as the possible cause, right?\n\n20\n00:01:06.880 --> 00:01:09.660\nSo you've got somebody who says their\ndesktop, Hey, I can't get to the internet.\n\n21\n00:01:09.660 --> 00:01:11.550\nAll right, well,\nlet me connect to the firewall and\n\n22\n00:01:11.550 --> 00:01:13.510\nsee if the firewall can\nget to the internet.\n\n23\n00:01:13.510 --> 00:01:15.176\nIf the firewall can get to the internet,\n\n24\n00:01:15.176 --> 00:01:17.734\nthen I must some kind of issue\nbetween the PC and the firewall.\n\n25\n00:01:17.734 --> 00:01:20.977\nBut if the firewall can't get to the\ninternet, then it's not the PC's problem,\n\n26\n00:01:20.977 --> 00:01:24.032\nit's something in between the firewall and\nthe internet, and I need to go and\n\n27\n00:01:24.032 --> 00:01:25.175\nfind out what that issue is.\n\n28\n00:01:25.175 --> 00:01:29.904\nSo It's a great place to jump in, run\nsome tests, see how things are going, and\n\n29\n00:01:29.904 --> 00:01:31.397\nthere's a lot in there.\n\n30\n00:01:31.397 --> 00:01:33.257\nLet's take a look at the diagnostics menu.\n\n31\n00:01:33.257 --> 00:01:38.038\nSo I've got my pfSense firewall pulled\nup here and across the top we've got all\n\n32\n00:01:38.038 --> 00:01:42.790\nour menus, and there's this\nDiagnostics menu, and it is massive.\n\n33\n00:01:42.790 --> 00:01:46.500\nNow you've probably noticed, if you've\nbeen watching all of our segments,\n\n34\n00:01:46.500 --> 00:01:49.730\nthere are many times where I go\nto find something in the menu and\n\n35\n00:01:49.730 --> 00:01:51.170\nI go to the wrong place.\n\n36\n00:01:51.170 --> 00:01:55.980\nThe Status menu right next to it\nis also a great place to go for\n\n37\n00:01:55.980 --> 00:01:57.550\ntroubleshooting and diagnostics.\n\n38\n00:01:57.550 --> 00:01:59.764\nThese two are really very similar and so\n\n39\n00:01:59.764 --> 00:02:02.390\nit makes it easy to confuse\nwhich menu to go to.\n\n40\n00:02:02.390 --> 00:02:06.465\nThe primary difference, and\nit doesn’t always work this way, but\n\n41\n00:02:06.465 --> 00:02:11.680\nthe idea is that status, that’s reflecting\nthe status of the firewall itself.\n\n42\n00:02:11.680 --> 00:02:14.660\nSo if I’m trying to\ntroubleshoot the firewall,\n\n43\n00:02:14.660 --> 00:02:17.432\nlike I have a VPN tone\nthat’s not staying up.\n\n44\n00:02:17.432 --> 00:02:21.240\nWell for that, I'm gonna come to status,\nand there's where I've got open VPN.\n\n45\n00:02:21.240 --> 00:02:25.320\nThis is where I'm gonna come to find that\ninformation about the firewall itself.\n\n46\n00:02:25.320 --> 00:02:28.850\nBut if I'm troubleshooting the network,\nnot just the firewall, but\n\n47\n00:02:28.850 --> 00:02:31.400\nthe connectivity through it, the\nconnectivity out through the Internet and\n\n48\n00:02:31.400 --> 00:02:33.590\nso on, that's where diagnostics comes in.\n\n49\n00:02:33.590 --> 00:02:38.130\nNow that's not 100% true,\nthere's things like the ARP table here,\n\n50\n00:02:38.130 --> 00:02:42.350\nthat's the firewall's ARP table,\nnot some PC on your networks ARP table,\n\n51\n00:02:42.350 --> 00:02:43.800\nthis is the firewall's ARP table.\n\n52\n00:02:43.800 --> 00:02:47.848\nSo it blends the two and it is easy\nto confuse which one to go through.\n\n53\n00:02:47.848 --> 00:02:51.508\nNow we've used the status menu in a number\nof episodes, but in this one we wanna\n\n54\n00:02:51.508 --> 00:02:54.890\nfocus on that diagnostic menu\nin some of the common tools.\n\n55\n00:02:54.890 --> 00:02:58.080\nLet's just start right there\nat the top with the ARP table.\n\n56\n00:02:58.080 --> 00:03:00.790\nARP, that's the address\nresolution protocol.\n\n57\n00:03:00.790 --> 00:03:05.371\nAnd when you come into the ARP table\nyou'll see a list of the IP to\n\n58\n00:03:05.371 --> 00:03:09.190\nMac address mappings that\nyour system has learned.\n\n59\n00:03:09.190 --> 00:03:13.543\nSo my firewall is connected\nto the 192.168.0 network,\n\n60\n00:03:13.543 --> 00:03:18.779\nthe 192.168.1 network and\nthe 209.251.159 networks.\n\n61\n00:03:18.779 --> 00:03:21.613\nI'll see the various\nhosts that it's learned.\n\n62\n00:03:21.613 --> 00:03:23.330\nNow it knows itself.\n\n63\n00:03:23.330 --> 00:03:27.420\nThese two right here, that's the firewall\nitself, and this last one here,\n\n64\n00:03:27.420 --> 00:03:28.860\nthat's the firewall itself.\n\n65\n00:03:28.860 --> 00:03:32.664\nBut these other IPs,\nthis ones my laptop right here, and then\n\n66\n00:03:32.664 --> 00:03:37.138\nthis one is the gateway to the firewalls\nusing to get out to the internet.\n\n67\n00:03:37.138 --> 00:03:39.950\nAnd you'll see the Mac\naddresses associated with each.\n\n68\n00:03:39.950 --> 00:03:42.995\nNow, how can we use Use this for\ntrouble shooting.\n\n69\n00:03:42.995 --> 00:03:47.775\nLet's say I go to ping a desktop, and\nI know that desktop is sitting out there,\n\n70\n00:03:47.775 --> 00:03:49.405\nand I go to ping it, and\nI don't get any response.\n\n71\n00:03:49.405 --> 00:03:51.229\nAnd so\nI say well that desktop must be off.\n\n72\n00:03:51.229 --> 00:03:54.100\nSo I call that person and say,\nhey can you turn that desktop on?\n\n73\n00:03:54.100 --> 00:03:57.460\nAnd they say well it is on,\nit's up and running.\n\n74\n00:03:57.460 --> 00:04:03.270\nWell it's not uncommon for\nsoftware firewalls to block pings, right?\n\n75\n00:04:03.270 --> 00:04:05.490\nI think Windows blocks\npings now by default.\n\n76\n00:04:05.490 --> 00:04:06.356\n>> It you have it, the server does.\n\n77\n00:04:06.356 --> 00:04:07.273\n>> Oh it does, good.\n\n78\n00:04:07.273 --> 00:04:11.900\nSo if you have a Windows server or Windows\n8 and you fire it up, it blocks pings.\n\n79\n00:04:11.900 --> 00:04:12.910\nSo how do you know that machine's on?\n\n80\n00:04:13.940 --> 00:04:16.410\nWell, you don't necessarily\nknow with ping.\n\n81\n00:04:16.410 --> 00:04:20.811\nBut the cool part is, whenever you reach\nout to a system, with ping or any TCP or\n\n82\n00:04:20.811 --> 00:04:24.412\nUDP protocol, the first thing you\ndo is an ARP broadcast to say,\n\n83\n00:04:24.412 --> 00:04:25.968\nwhat's your MAC address?\n\n84\n00:04:25.968 --> 00:04:28.802\nAnd regardless of whether\nthey have a firewall or not,\n\n85\n00:04:28.802 --> 00:04:31.030\na machine has to reply\nto an ARP broadcast.\n\n86\n00:04:31.030 --> 00:04:33.590\nIf it doesn't,\nyou can't connect to it at all.\n\n87\n00:04:33.590 --> 00:04:36.602\nSo even with a firewall,\nyou still respond to ARP broadcast.\n\n88\n00:04:36.602 --> 00:04:40.708\nAnd if I see that mapping in here that\nlet's me know that machine is on, but\n\n89\n00:04:40.708 --> 00:04:43.567\nmaybe its firewall is\nblocking the connectivity.\n\n90\n00:04:43.567 --> 00:04:47.360\nSo, neat way to be able to see\nthat information right there.\n\n91\n00:04:47.360 --> 00:04:50.210\nIf the IP is not even\nshowing up in the ARP table,\n\n92\n00:04:50.210 --> 00:04:52.290\nthen that tells you that\nmachine might be turned off,\n\n93\n00:04:52.290 --> 00:04:56.100\nmight be unplugged from the network, or\nmight be plugged into a different physical\n\n94\n00:04:56.100 --> 00:04:59.540\nnetwork that our broadcasts aren't\nable to hit, that's always possible.\n\n95\n00:04:59.540 --> 00:05:01.570\nSo, it's nice to be able to see\nthat information right there.\n\n96\n00:05:04.580 --> 00:05:08.106\nSome of the other things we can test,\nwe've got authentication.\n\n97\n00:05:08.106 --> 00:05:12.037\nIf you set up authentication on\na radius server or an LDAP server,\n\n98\n00:05:12.037 --> 00:05:13.899\nhow do you know it's working?\n\n99\n00:05:13.899 --> 00:05:16.279\nWell, you can try to login,\nbut you might get an error.\n\n100\n00:05:16.279 --> 00:05:20.400\nFrom here it's nice because you can\nspecify who it is that you wanna test\n\n101\n00:05:20.400 --> 00:05:21.026\nagainst.\n\n102\n00:05:21.026 --> 00:05:22.947\nDo I want to test against\nthe local database or\n\n103\n00:05:22.947 --> 00:05:24.626\ndo I wanna test against radius or LDAP?\n\n104\n00:05:24.626 --> 00:05:29.495\nNow I don't have anything in my drop down\nbecause I haven't configured any other\n\n105\n00:05:29.495 --> 00:05:33.503\nservers, but if I were to go up here\nto like, let's go to system and\n\n106\n00:05:33.503 --> 00:05:36.430\nuser manager and jump over to servers.\n\n107\n00:05:36.430 --> 00:05:39.118\nIf I were to add in some servers,\nright, so\n\n108\n00:05:39.118 --> 00:05:44.274\nmaybe I add in some kind of radius server\nor something, I could punch that in here,\n\n109\n00:05:44.274 --> 00:05:49.701\ndefine the settings, I'll just put in some\nfake data here, just to have something.\n\n110\n00:05:49.701 --> 00:05:51.300\nSo I'll punch that in.\n\n111\n00:05:51.300 --> 00:05:53.850\nSo now I've defined a radius\nserver that's available for\n\n112\n00:05:53.850 --> 00:05:56.720\nme to authenticate against and\nwhen I set up open VPN or\n\n113\n00:05:56.720 --> 00:05:59.550\nwhatever I can tell it, hey you need\nto authenticate against radius.\n\n114\n00:05:59.550 --> 00:06:03.930\nWell, I can test that under\ndiagnostics and authentication.\n\n115\n00:06:03.930 --> 00:06:07.340\nNow I can pick radius from my dropdown\nbox and I can provide a user name and\n\n116\n00:06:07.340 --> 00:06:10.250\na password, and I could have it test.\n\n117\n00:06:10.250 --> 00:06:13.780\nNow, I put in a fake radius, so it's\nnot gonna be able to connect to it, but\n\n118\n00:06:13.780 --> 00:06:16.920\nhere I'll get a little bit of information\nthat tells me what the problem is, and\n\n119\n00:06:16.920 --> 00:06:19.420\nthat can help me to troubleshoot and\nsort that out.\n\n120\n00:06:19.420 --> 00:06:23.350\nReally useful when you're connecting\nto something like a Microsoft Active\n\n121\n00:06:23.350 --> 00:06:26.750\nDirectory, like we're doing LDAP, you\ncan get some good information that way.\n\n122\n00:06:28.820 --> 00:06:31.515\nAll right, some of the other things\nthat we've got, command prompt.\n\n123\n00:06:33.400 --> 00:06:37.412\nIt's not often, but there are times when\nyou just wish you could run a command\n\n124\n00:06:37.412 --> 00:06:40.632\nagainst the underlying operating\nsystem inside of pfSense.\n\n125\n00:06:40.632 --> 00:06:43.312\nFor example,\nI might wanna know my disk utilization.\n\n126\n00:06:43.312 --> 00:06:44.550\nWell, you can find that.\n\n127\n00:06:44.550 --> 00:06:46.920\nIt's buried away in the status somewhere.\n\n128\n00:06:46.920 --> 00:06:48.260\nI can never really remember where, but\n\n129\n00:06:48.260 --> 00:06:51.080\nsomewhere under status you can go in and\nwe can find\n\n130\n00:06:51.080 --> 00:06:53.890\nwhat the hard drive utilization\nis like inside of our firewall.\n\n131\n00:06:53.890 --> 00:06:56.225\nBut if you can't remember\nwhere the menu item is,\n\n132\n00:06:56.225 --> 00:06:58.781\nyou might be thinking well I\nknow I can just run DF-H and\n\n133\n00:06:58.781 --> 00:07:02.528\nit will tell me exactly what I want, if I\nonly had access to that command prompt.\n\n134\n00:07:02.528 --> 00:07:07.671\nWell you can go to diagnostics and command\nprompt and right here you can Upload and\n\n135\n00:07:07.671 --> 00:07:12.220\ndownload files, you can run inline PHP,\nor you can just run commands.\n\n136\n00:07:12.220 --> 00:07:15.370\nMaybe I wanna run DF-H,\nshow me that hard drive utilization.\n\n137\n00:07:15.370 --> 00:07:17.316\nI wanna execute it, there it is.\n\n138\n00:07:17.316 --> 00:07:21.170\nIt runs the command in the background,\nand then then it shows me the output.\n\n139\n00:07:21.170 --> 00:07:26.027\nAnd I can see it, I am cruising along at\nsix percent utilization on my route and\n\n140\n00:07:26.027 --> 00:07:29.413\nsome of my other directories\nare a little bit higher.\n\n141\n00:07:29.413 --> 00:07:33.576\nSome of these we don't actually\nwrite to like FFS, but\n\n142\n00:07:33.576 --> 00:07:35.937\nthis MD0 is at three percent.\n\n143\n00:07:35.937 --> 00:07:39.182\nI have plenty of room on this system so\nno big deal there.\n\n144\n00:07:39.182 --> 00:07:40.614\nWe can run lots of stuff,\n\n145\n00:07:40.614 --> 00:07:44.858\nwe could run uname -a to find out which\nversion of FreeBSD we are running.\n\n146\n00:07:44.858 --> 00:07:48.982\nAnd so I can see I'm running\nFreeBSD 10.1-RELEASE-p13.\n\n147\n00:07:48.982 --> 00:07:53.395\nSo anything we wanna issue against the\nunderlying operating system right here.\n\n148\n00:07:53.395 --> 00:07:58.109\nAll right, another really useful one for\ntroubleshooting, oftentimes when people\n\n149\n00:07:58.109 --> 00:08:01.919\ncan't get to a website, we go and\nwe use something like ping to test.\n\n150\n00:08:01.919 --> 00:08:04.743\nRight here, we'll jump ahead, and\nunder Diagnostics, we've got Ping.\n\n151\n00:08:04.743 --> 00:08:08.217\nAnd we can do a test to ping a host,\nright?\n\n152\n00:08:08.217 --> 00:08:13.550\nSo when we ping, we might ping by a name,\nor an IP, right?\n\n153\n00:08:13.550 --> 00:08:17.948\nWhen we ping by name,\nlike if I ping www.google.com, right?\n\n154\n00:08:17.948 --> 00:08:20.685\nIt's going to do a DNS\nlook up in the background,\n\n155\n00:08:20.685 --> 00:08:24.565\nresolve that to an IP and ping that host.\n\n156\n00:08:24.565 --> 00:08:25.845\nRight?\nSo I'm going to run this and\n\n157\n00:08:25.845 --> 00:08:29.895\nthere we go, it pinged, and I can see\nwhere it resolved it to an IP right there.\n\n158\n00:08:30.915 --> 00:08:33.170\nWell what if DNS isn't working?\n\n159\n00:08:33.170 --> 00:08:35.460\nWell you could always say, all right,\nI'm not able to get to Google.\n\n160\n00:08:35.460 --> 00:08:37.270\nMaybe the problem is DNS.\n\n161\n00:08:37.270 --> 00:08:43.620\nI can just try and ping an IP, and ping\nthat, now I take DNS out of the picture.\n\n162\n00:08:43.620 --> 00:08:44.180\nAll right.\n\n163\n00:08:44.180 --> 00:08:47.020\nSo there we go, it goes and\nit does the ping and I get out.\n\n164\n00:08:47.020 --> 00:08:48.960\nNow I know I've got a DNS problem.\n\n165\n00:08:48.960 --> 00:08:54.610\nWell to troubleshoot DNS, we can go under\ndiagnostics, and you can do DNS lookup.\n\n166\n00:08:54.610 --> 00:08:57.160\nThe DNS lookup screen,\nit actually works both ways.\n\n167\n00:08:57.160 --> 00:09:00.370\nYou can do forward and\nreverse DNS lookups.\n\n168\n00:09:00.370 --> 00:09:05.350\nSo, if I put in www.google.com,\nit's going to do a forward lookup, and\n\n169\n00:09:05.350 --> 00:09:06.960\ntry and resolve that to IP.\n\n170\n00:09:06.960 --> 00:09:09.870\nAnd here I get all the IPs\nthat were tied to it.\n\n171\n00:09:09.870 --> 00:09:12.180\nI get information about\nthe query that was responded.\n\n172\n00:09:12.180 --> 00:09:16.360\nI even get the ability to do pings and\ntrace routes right here from the output,\n\n173\n00:09:16.360 --> 00:09:18.170\nwhich is really nice.\n\n174\n00:09:18.170 --> 00:09:20.350\nAnd you can create aliases.\n\n175\n00:09:20.350 --> 00:09:22.380\nSo if I want to create a firewall rule,\n\n176\n00:09:22.380 --> 00:09:26.210\nmaybe I'm really strict about\nwhat websites people can get to.\n\n177\n00:09:26.210 --> 00:09:29.530\nAnd I want to do a manual firewall rule to\nimprove things, I might come in here and\n\n178\n00:09:29.530 --> 00:09:35.620\nsay all right, I want to let people\nget to slashdot.org or cnn.com, right.\n\n179\n00:09:35.620 --> 00:09:40.440\nAnd so we can come in and we can do that\nlookup, and then it'll get all the IPs,\n\n180\n00:09:40.440 --> 00:09:45.850\nand we can create an alias from it, and\nnow we've created this alias, cnn_com, and\n\n181\n00:09:45.850 --> 00:09:51.590\nI can use that in my firewall rules and so\non, to approve that access to get through.\n\n182\n00:09:51.590 --> 00:09:54.290\nReally convenient to be able\nto do these things dynamically\n\n183\n00:09:54.290 --> 00:09:56.110\nright here from the system.\n\n184\n00:09:56.110 --> 00:09:59.000\n>> Now, Don,\nI noticed in the diagnostic list there,\n\n185\n00:09:59.000 --> 00:10:00.740\nthe next one is the one that kills me.\n\n186\n00:10:00.740 --> 00:10:02.805\nIt actually just says edit file.\n\n187\n00:10:02.805 --> 00:10:06.750\n>> [LAUGH]\n>> What file do I have to edit on pfSense?\n\n188\n00:10:06.750 --> 00:10:08.080\nThat to me just doesn't make sense.\n\n189\n00:10:08.080 --> 00:10:10.230\nI don't think I'd ever use it.\n\n190\n00:10:10.230 --> 00:10:13.160\n>> Yeah, this is another one of those\nwhere hopefully you never need to use it.\n\n191\n00:10:13.160 --> 00:10:14.910\n>> [LAUGH]\n>> But there may be times, right?\n\n192\n00:10:14.910 --> 00:10:17.810\nMaybe you've used some kind of\nhardware that pfSense isn't\n\n193\n00:10:17.810 --> 00:10:19.500\nrecognizing specifically.\n\n194\n00:10:19.500 --> 00:10:23.170\nAnd so, you need to tell BSD under\nthe hood to load a certain module for\n\n195\n00:10:23.170 --> 00:10:24.790\nthat hardware.\n\n196\n00:10:24.790 --> 00:10:25.750\nTo do that,\n\n197\n00:10:25.750 --> 00:10:31.490\nyou'll need to edit configuration\nfiles inside of BSD under the hood.\n\n198\n00:10:31.490 --> 00:10:33.600\nYou can SSH into the box and\ndo it that way, or\n\n199\n00:10:33.600 --> 00:10:35.520\nyou can access the console of the box.\n\n200\n00:10:35.520 --> 00:10:40.090\nIf I go here, to the console of my\nfirewall, you've got number eight\n\n201\n00:10:40.090 --> 00:10:44.060\nright there is shell, so\nyou can drop to a shell, and there I am.\n\n202\n00:10:44.060 --> 00:10:49.610\nAnd I could, you know, navigate around,\nfind my configuration files, right?\n\n203\n00:10:49.610 --> 00:10:52.050\nAnd, I could jump in here and\nstart to modify things, right?\n\n204\n00:10:52.050 --> 00:10:55.900\nSo, it's all, you know,\na unix-like operating system, and\n\n205\n00:10:55.900 --> 00:10:58.060\nit's all ready to do work with.\n\n206\n00:10:58.060 --> 00:11:02.220\nBut, if you don't have shell access, or\nyou just don't want to mess with this,\n\n207\n00:11:02.220 --> 00:11:06.560\nyou can do it from the GUI by\nusing diagnostics and edit file.\n\n208\n00:11:06.560 --> 00:11:11.500\nAnd when you go to edit that file,\nyou can browse to pick a file to load, and\n\n209\n00:11:11.500 --> 00:11:15.530\nhere's the file system, and\nI'm browsing into the file system, so\n\n210\n00:11:15.530 --> 00:11:21.270\nI can jump in here, and /cf/conf,\nthat's where pfSense actually\n\n211\n00:11:21.270 --> 00:11:25.550\nstores its own configuration, so\nthat's the raw configuration file for\n\n212\n00:11:25.550 --> 00:11:28.910\npfSense that we can modify if we\nwere looking for something specific.\n\n213\n00:11:28.910 --> 00:11:33.570\nThere are a small amount of options that\nare available directly in the config file,\n\n214\n00:11:33.570 --> 00:11:35.140\nbut not in the GUI.\n\n215\n00:11:35.140 --> 00:11:37.510\nIt's really,\nreally rare that you have to do that.\n\n216\n00:11:37.510 --> 00:11:41.020\nMore commonly,\nit's messing with the BSD, right?\n\n217\n00:11:41.020 --> 00:11:45.560\nSo jumping into like /etc and\ncoming in here and modifying something.\n\n218\n00:11:45.560 --> 00:11:49.510\nYou know maybe something to do with\nthe network adapter configuration or\n\n219\n00:11:49.510 --> 00:11:50.890\nsomething of that nature.\n\n220\n00:11:50.890 --> 00:11:55.410\nTo get a system configured to\nwork the way that we want it to.\n\n221\n00:11:55.410 --> 00:11:57.940\nYeah, definitely not a common one for\nus to mess with.\n\n222\n00:11:57.940 --> 00:11:59.890\nBecause the GUI is\nreally pretty inclusive.\n\n223\n00:11:59.890 --> 00:12:03.050\nIt's got the majority of what we want.\n\n224\n00:12:03.050 --> 00:12:03.730\nAll right.\n\n225\n00:12:03.730 --> 00:12:04.530\nFactory defaults.\n\n226\n00:12:05.700 --> 00:12:07.470\nIf you've messed something\nup on the firewall,\n\n227\n00:12:07.470 --> 00:12:09.330\nif you've done some\nconfiguration changes and\n\n228\n00:12:09.330 --> 00:12:12.590\nthings are just not working right,\nyou can choose this option, and\n\n229\n00:12:12.590 --> 00:12:17.850\nwhat it does is that slash cf, that config\nfile that I showed you just a moment ago,\n\n230\n00:12:17.850 --> 00:12:20.960\nif we choose factory defaults,\nit just wipes that file out.\n\n231\n00:12:20.960 --> 00:12:22.520\nYour operating system stays the same.\n\n232\n00:12:22.520 --> 00:12:26.168\nThe pf sense install stays the same,\nbut all the configuration goes away and\n\n233\n00:12:26.168 --> 00:12:27.995\nit puts you back to factory defaults.\n\n234\n00:12:27.995 --> 00:12:29.326\nNow be careful with this one,\n\n235\n00:12:29.326 --> 00:12:32.161\nbecause if you have packages\ninstalled they all get disabled.\n\n236\n00:12:32.161 --> 00:12:38.300\nYour IP gets reset to 192.168.1.1 so\nyou'll probably disconnect yourself.\n\n237\n00:12:38.300 --> 00:12:42.790\nYour username and password gets reset\nto admin and pfsense for the password.\n\n238\n00:12:42.790 --> 00:12:44.510\nRight.\nAll of that get's reset\n\n239\n00:12:44.510 --> 00:12:46.160\nback to the factory default.\n\n240\n00:12:46.160 --> 00:12:50.010\nSo if your doing remotely, your going\nto kick yourself out of the machine and\n\n241\n00:12:50.010 --> 00:12:51.410\nyou won't be able to get back into right.\n\n242\n00:12:51.410 --> 00:12:54.489\nSo be careful with that but\nyou can quickly reset the system.\n\n243\n00:12:56.170 --> 00:12:57.860\nWe've got a halt system.\n\n244\n00:12:57.860 --> 00:13:00.470\nHalt in the Unix world is is\nthe same thing as shut down.\n\n245\n00:13:00.470 --> 00:13:04.360\nSo, if we want to shut this machine down,\nwe can use halt and that will turn it off.\n\n246\n00:13:04.360 --> 00:13:06.770\nAgain, if you don't have\nphysical access to the firewall,\n\n247\n00:13:06.770 --> 00:13:09.210\nit would be a little difficult\nto turn it back on remotely.\n\n248\n00:13:09.210 --> 00:13:11.960\nMaybe you've got wake on land set\nup to be able to fire that on, but\n\n249\n00:13:11.960 --> 00:13:14.540\notherwise, it's going to power off and\nthat's the end of it.\n\n250\n00:13:14.540 --> 00:13:16.480\nIt does do a graceful shutdown.\n\n251\n00:13:16.480 --> 00:13:19.410\nMore often than not we're going\nto go down here to reboot.\n\n252\n00:13:19.410 --> 00:13:21.210\nI want to reboot for\nsome change to take effect.\n\n253\n00:13:21.210 --> 00:13:23.030\nAnd that'll take it down and\nbring it back up.\n\n254\n00:13:23.030 --> 00:13:26.520\nAll right, what else do we have in here?\n\n255\n00:13:26.520 --> 00:13:28.400\n>> That NDP table.\n\n256\n00:13:28.400 --> 00:13:28.980\n>> NDP table,\n\n257\n00:13:28.980 --> 00:13:33.920\nthis is one that's not all that commonly\nused, because it's tied to IPv6.\n\n258\n00:13:33.920 --> 00:13:36.780\nIn IPv6, we don't have an ARP\ntable like you see up here.\n\n259\n00:13:36.780 --> 00:13:39.520\nInstead you use the network\ndiscovery protocol.\n\n260\n00:13:39.520 --> 00:13:43.920\nAnd so when you go to the NDP table that's\nexactly what you're going to see are IPv6\n\n261\n00:13:43.920 --> 00:13:49.100\naddresses mapped to MAC addresses, instead\nof IPv4 addresses mapped to MAC addresses.\n\n262\n00:13:50.390 --> 00:13:52.360\nSo in IPv4 you have an ARP table.\n\n263\n00:13:52.360 --> 00:13:55.690\nIn IPv6 you have NDP,\nNetwork Discovery Protocol.\n\n264\n00:13:55.690 --> 00:13:58.580\nAnd there you can see each\nof the MACs that I know.\n\n265\n00:13:58.580 --> 00:14:02.220\nAnd the IPv6 addressed,\nnotice how they're written.\n\n266\n00:14:02.220 --> 00:14:04.810\nYou actually have the address\nfollowed by a zone.\n\n267\n00:14:04.810 --> 00:14:10.650\nAnd there's some operating systems out\nthere like [COUGH] Windows, where the zone\n\n268\n00:14:10.650 --> 00:14:14.530\nis this annoying index number and you\ndon't know what interface it's tied to.\n\n269\n00:14:14.530 --> 00:14:18.480\nBut in pfSense, they use a zone\nthat is named after the interface.\n\n270\n00:14:18.480 --> 00:14:22.180\nSo I have three interfaces, EM0, EM1, EM2.\n\n271\n00:14:22.180 --> 00:14:23.290\nAnd that's what I'm seeing right here,\n\n272\n00:14:23.290 --> 00:14:25.820\nit's letting me know which\nnetwork adapter they're tied to.\n\n273\n00:14:25.820 --> 00:14:29.760\nBut even if I didn't know that,\nway over here I got DMZ, LAN, LAN.\n\n274\n00:14:29.760 --> 00:14:31.830\nYeah in Windows you'll see percent ten.\n\n275\n00:14:31.830 --> 00:14:33.160\n>> Yeah.\n>> It's well great.\n\n276\n00:14:33.160 --> 00:14:34.390\n>> Some random assigned number.\n\n277\n00:14:34.390 --> 00:14:36.020\n>> What did I click on here?\n\n278\n00:14:36.020 --> 00:14:37.940\nYeah what is interface 10?\n\n279\n00:14:37.940 --> 00:14:38.680\nThat's great.\n\n280\n00:14:38.680 --> 00:14:42.910\nSo not terribly helpful.\n\n281\n00:14:42.910 --> 00:14:43.850\nAlright.\nLet's see what's next.\n\n282\n00:14:43.850 --> 00:14:44.830\n>> Packet capture.\n\n283\n00:14:44.830 --> 00:14:45.910\n>> Oh, packet capture.\n\n284\n00:14:45.910 --> 00:14:48.966\nNow packet capture's a fun one.\n\n285\n00:14:48.966 --> 00:14:51.680\nThere are times, [LAUGH] I think it's fun,\n\n286\n00:14:51.680 --> 00:14:55.290\nI like it more so, there's times when\nyou're troubleshooting your network.\n\n287\n00:14:55.290 --> 00:14:57.950\nSomethings going on and\nyou just can't see it.\n\n288\n00:14:57.950 --> 00:15:01.710\nMaybe some traffic is getting blocked\non the network or whatever, and\n\n289\n00:15:01.710 --> 00:15:04.420\nyou want to see the actual traffic.\n\n290\n00:15:04.420 --> 00:15:05.600\nA great example.\n\n291\n00:15:05.600 --> 00:15:10.020\nMaybe you installed N top NG, and\nyour monitoring network utilization.\n\n292\n00:15:10.020 --> 00:15:13.810\nYou see this one work station that is\njust flooding traffic out your firewall.\n\n293\n00:15:13.810 --> 00:15:16.280\nIt's occupying 50% of your bandwidth.\n\n294\n00:15:16.280 --> 00:15:19.480\nAnd you're like man, I see who they\nare and I see who they're talking to, but\n\n295\n00:15:19.480 --> 00:15:20.550\nwhat are they doing?\n\n296\n00:15:20.550 --> 00:15:22.970\nWhat exactly,\nwhat kind of payload are they carrying?\n\n297\n00:15:22.970 --> 00:15:24.660\nI wish I could see those packets.\n\n298\n00:15:24.660 --> 00:15:26.560\nWell packet capture lets you do that.\n\n299\n00:15:26.560 --> 00:15:29.740\nYou can come in here into\nthe packet capture screen and\n\n300\n00:15:29.740 --> 00:15:31.700\nyou can tell it to record traffic.\n\n301\n00:15:31.700 --> 00:15:33.260\nNow be careful with this.\n\n302\n00:15:33.260 --> 00:15:35.910\nBecause it's recording it to the firewall.\n\n303\n00:15:35.910 --> 00:15:38.540\nAnd the more traffic you record,\n\n304\n00:15:38.540 --> 00:15:41.500\nthe more likely you are to fill up\nthe hard drive on the firewall.\n\n305\n00:15:41.500 --> 00:15:44.520\nNow, it won't let it get to that point,\nit'll stop the capture, but\n\n306\n00:15:44.520 --> 00:15:45.770\nyou can run out of space.\n\n307\n00:15:45.770 --> 00:15:47.956\nYou've got to be careful with that,\nall right?\n\n308\n00:15:47.956 --> 00:15:50.670\nNow, it's going to record it\nto a file on the firewall.\n\n309\n00:15:50.670 --> 00:15:53.642\nAnd if I do another packet capture later,\nit will delete that file and\n\n310\n00:15:53.642 --> 00:15:57.138\nrewrite a new one, so it only stores one\npacket capture on the firewall at a time.\n\n311\n00:15:57.138 --> 00:16:00.165\nSo when you're done you\nneed to download it.\n\n312\n00:16:00.165 --> 00:16:02.806\nNow it will actually give us\nthe option to view it here in the page.\n\n313\n00:16:02.806 --> 00:16:05.163\nBut the view only shows\nsome basic information.\n\n314\n00:16:05.163 --> 00:16:08.038\nIf you want to see the real\ndata you download it and\n\n315\n00:16:08.038 --> 00:16:11.350\nopen it in packet capture software,\nall right.\n\n316\n00:16:11.350 --> 00:16:12.980\nLet me show you an example.\n\n317\n00:16:12.980 --> 00:16:17.047\nMaybe I've got a user that's\ngonna be doing some FTP right,\n\n318\n00:16:17.047 --> 00:16:19.215\ndoing file transfer protocol.\n\n319\n00:16:19.215 --> 00:16:21.015\nAnd I want to see what they're doing.\n\n320\n00:16:21.015 --> 00:16:24.010\nI know they're moving a lot of files,\nI want to see what's going on.\n\n321\n00:16:24.010 --> 00:16:26.120\nI know that FTP does\nstuff in plain text so\n\n322\n00:16:26.120 --> 00:16:28.490\nI can interpret it if\nI can see the traffic.\n\n323\n00:16:28.490 --> 00:16:31.330\nSo what we can do is we can\ncome in here and we can say,\n\n324\n00:16:31.330 --> 00:16:36.190\nI'm going to monitor on my LAN interface,\nand then we can specify other things.\n\n325\n00:16:36.190 --> 00:16:38.230\nLike do I want to be in promiscuous mode.\n\n326\n00:16:38.230 --> 00:16:42.290\nNow, the nature of this traffic is that\nit's passing through the firewall.\n\n327\n00:16:42.290 --> 00:16:45.520\nSo I don't need to be in\npromiscuous mode to record it.\n\n328\n00:16:45.520 --> 00:16:47.570\nUnless I'm in a transparent firewall.\n\n329\n00:16:47.570 --> 00:16:50.520\nThen I need to do that because the traffic\nis not actually destined for me.\n\n330\n00:16:50.520 --> 00:16:53.830\nIn my case, my firewall is acting like\na router so I don't need promiscuous mode.\n\n331\n00:16:55.120 --> 00:16:57.750\nEverything else I could leave empty and\njust hit Save.\n\n332\n00:16:57.750 --> 00:17:00.400\nI'll start recording on\nthe lane interface right now.\n\n333\n00:17:00.400 --> 00:17:03.950\nBut you don't want to record\nanymore than you have to.\n\n334\n00:17:03.950 --> 00:17:06.980\nSo the best thing to do is\nlimit this traffic right?\n\n335\n00:17:06.980 --> 00:17:09.160\nFilter it down as much as you can.\n\n336\n00:17:09.160 --> 00:17:12.050\nSo for my address family,\nI'm gonna limit that to IPv4.\n\n337\n00:17:12.050 --> 00:17:16.010\nNo sense recording to IPv6 because\nI'm trying to find some IPv4 traffic.\n\n338\n00:17:16.010 --> 00:17:19.780\nFor the protocol,\nI can filter this down to TCP or\n\n339\n00:17:19.780 --> 00:17:23.905\nUDP, but I've picked FTP,\nis what I wanna watch.\n\n340\n00:17:23.905 --> 00:17:27.220\nAnd FTP uses both TCP and UDP, so\nI can't really filter that one,\n\n341\n00:17:27.220 --> 00:17:30.510\nI'll just leave that one at any,\nthe host address.\n\n342\n00:17:30.510 --> 00:17:33.570\nIf I'm watching a particular host,\nI can just record it.\n\n343\n00:17:33.570 --> 00:17:35.180\nHere, I'm gonna record my laptop.\n\n344\n00:17:36.890 --> 00:17:38.190\nSo, let me figure out what my IP is.\n\n345\n00:17:38.190 --> 00:17:40.920\nI think I'm 99, and I am.\n\n346\n00:17:40.920 --> 00:17:41.920\nI'm 99.\n\n347\n00:17:41.920 --> 00:17:44.795\nSo, let me get back here.\n\n348\n00:17:44.795 --> 00:17:47.292\nWhy do I keep coming back\nto Microsoft Translator?\n\n349\n00:17:47.292 --> 00:17:48.034\nAnd, there you go.\n\n350\n00:17:48.034 --> 00:17:51.230\nI'm gonna punch in 10.1.230.99.\n\n351\n00:17:51.230 --> 00:17:53.240\nI just wanna record\ntraffic from my laptop.\n\n352\n00:17:53.240 --> 00:17:57.080\nSo that's going to immediately shrink\ndown the size of this capture file,\n\n353\n00:17:57.080 --> 00:18:00.450\ncuz now I'm just getting the host\nthat I'm really looking out for.\n\n354\n00:18:00.450 --> 00:18:02.292\n>> Is that the right IP address?\n\n355\n00:18:02.292 --> 00:18:03.850\n10.1.230?\n\n356\n00:18:03.850 --> 00:18:04.593\n>> Oh I don't know, is it?\n\n357\n00:18:04.593 --> 00:18:05.730\nNo.\n>> I was gonna say.\n\n358\n00:18:05.730 --> 00:18:07.370\n>> That's my other IP.\n\n359\n00:18:08.900 --> 00:18:10.320\nThere we go.\n\n360\n00:18:10.320 --> 00:18:11.913\nThat's my alias, also known as.\n\n361\n00:18:11.913 --> 00:18:14.090\n192.168.0.99 there we go there's my IP.\n\n362\n00:18:14.090 --> 00:18:15.000\nThank you Ronnie.\n\n363\n00:18:16.450 --> 00:18:19.220\nI can specify a port if I'm trying\nto watch a particular port,\n\n364\n00:18:19.220 --> 00:18:23.260\nbut FTP bounces between 20 and 21,\nso that doesn't work out so well.\n\n365\n00:18:23.260 --> 00:18:24.880\nI'll leave that blank.\n\n366\n00:18:24.880 --> 00:18:28.930\nPacket lengths, I can specify the length\nof the packets that I want to capture.\n\n367\n00:18:28.930 --> 00:18:32.050\nI'll leave mine at zero which\nwill capture the entire frame.\n\n368\n00:18:32.050 --> 00:18:34.790\nRight?\nI don't want to mess with that count.\n\n369\n00:18:34.790 --> 00:18:36.850\nHow many packets do I want to capture?\n\n370\n00:18:36.850 --> 00:18:39.990\nNow you can put as many\nas you want in here.\n\n371\n00:18:39.990 --> 00:18:42.410\nThe default is to only\ncapture a hundred packets.\n\n372\n00:18:42.410 --> 00:18:45.270\nWell a hundred packets is\nreally not all that much, so\n\n373\n00:18:45.270 --> 00:18:47.250\nyou might want to put\na bigger number in there.\n\n374\n00:18:47.250 --> 00:18:52.570\nIf you put zero,\nit will capture forever until you stop it.\n\n375\n00:18:52.570 --> 00:18:54.510\nSo you have to tell it when\nto stop the capture and\n\n376\n00:18:54.510 --> 00:18:55.750\nthat's what I'm gonna do right now.\n\n377\n00:18:55.750 --> 00:18:56.640\nI'll tell it when to stop.\n\n378\n00:18:56.640 --> 00:19:00.380\nBut in real life land, you'd probably set\nit to something like 1,000, let it run,\n\n379\n00:19:00.380 --> 00:19:02.224\nand then it'll stop automatically\nwhen it hits 1,000.\n\n380\n00:19:04.160 --> 00:19:07.240\nNow this next one, level of detail,\nthis one is a little bit confusing.\n\n381\n00:19:07.240 --> 00:19:11.030\nMedium, high, full, this is the amount of\ninformation that's it's gonna display for\n\n382\n00:19:11.030 --> 00:19:12.580\nus in the web browser.\n\n383\n00:19:12.580 --> 00:19:16.560\nWhen you download the capture file,\nit's got all the data in there,\n\n384\n00:19:16.560 --> 00:19:18.380\nregardless what you\npick here in this menu.\n\n385\n00:19:18.380 --> 00:19:22.320\nSo this is really just saying,\nwhat do I want to see in the web browser.\n\n386\n00:19:22.320 --> 00:19:25.190\nI'm not gonna read this in the web browser\nanyway, so I don't really care, so\n\n387\n00:19:25.190 --> 00:19:27.280\nI'll stick with normal on this,\nI'm gonna download it.\n\n388\n00:19:27.280 --> 00:19:28.220\nAnd edit it somewhere else.\n\n389\n00:19:29.290 --> 00:19:31.760\nAnd then there's gonna be\nIP addresses in use, and\n\n390\n00:19:31.760 --> 00:19:34.640\nit offers to do reverse DNS lookups.\n\n391\n00:19:34.640 --> 00:19:36.080\nI'm gonna leave that off.\n\n392\n00:19:36.080 --> 00:19:38.240\nIf I was gonna view this\nin the web browser,\n\n393\n00:19:38.240 --> 00:19:40.980\nI'd probably want that on to help\nme figure out who the hosts were.\n\n394\n00:19:40.980 --> 00:19:45.130\nBut if I'm gonna be editing\nthis in other software, right?\n\n395\n00:19:45.130 --> 00:19:47.850\nThat other software is going to\ndo reverse lookups for me and\n\n396\n00:19:47.850 --> 00:19:49.540\nso I'm not going to bother with it here.\n\n397\n00:19:49.540 --> 00:19:51.250\nI'll just save that little\nburden on the firewall.\n\n398\n00:19:51.250 --> 00:19:55.230\nAll right, I'm going to go ahead and\nhit Start and\n\n399\n00:19:55.230 --> 00:19:56.690\nnow it's going to start capturing.\n\n400\n00:19:56.690 --> 00:19:57.310\nOkay.\n\n401\n00:19:57.310 --> 00:19:59.730\nSo it's running and\nI've got a Stop button.\n\n402\n00:19:59.730 --> 00:20:04.560\nAnd so now I can come in here and I can\nconnect to some host that's out there.\n\n403\n00:20:04.560 --> 00:20:08.660\nAnd I'm going to login and, oh you know,\n\n404\n00:20:08.660 --> 00:20:13.580\nprovide a fake password,\nwhich I just typed wrong, but whatever.\n\n405\n00:20:13.580 --> 00:20:16.350\nSo I can jump in here and\nI can start to work, and\n\n406\n00:20:16.350 --> 00:20:19.580\nsee here's FTP jumping port numbers on me.\n\n407\n00:20:20.770 --> 00:20:23.300\nSo that directory command's\nprobably going to fail.\n\n408\n00:20:23.300 --> 00:20:26.610\nAnd so we can start to browse and\nthe whole time,\n\n409\n00:20:26.610 --> 00:20:30.025\nthe firewall's recording this traffic,\nright, it's recording what I'm doing.\n\n410\n00:20:30.025 --> 00:20:34.430\n[LAUGH] Is my passive\ntransfer not working?\n\n411\n00:20:35.500 --> 00:20:36.260\nI guess not.\nWell anyhow,\n\n412\n00:20:36.260 --> 00:20:38.300\nwe get some FTP traffic here\nthat I'll be able to see.\n\n413\n00:20:38.300 --> 00:20:41.410\nI'm not going to fuss with\nwhy that thing's not working.\n\n414\n00:20:41.410 --> 00:20:45.520\nBut anyhow, so we can record this traffic.\n\n415\n00:20:45.520 --> 00:20:48.100\nWe start to see the information\nmoving forward.\n\n416\n00:20:48.100 --> 00:20:49.350\nYeah that's just whatever.\n\n417\n00:20:49.350 --> 00:20:51.940\nAll right, and we can come in here and\nwe can stop it.\n\n418\n00:20:51.940 --> 00:20:55.650\nNow when we stop it down here\nI can see that packet count.\n\n419\n00:20:55.650 --> 00:20:59.894\nHere it's showing all the traffic\ninvolving 192.168.0.99.\n\n420\n00:20:59.894 --> 00:21:02.130\nNot just FTP but other things too.\n\n421\n00:21:02.130 --> 00:21:05.130\nSo I kind of see the traffic\nthat it recorded.\n\n422\n00:21:05.130 --> 00:21:11.560\nMore importantly, I can download the\ncapture and I can save that to my system.\n\n423\n00:21:11.560 --> 00:21:14.700\nOnce it's saved,\nI can open it in software like Wire Shark.\n\n424\n00:21:14.700 --> 00:21:16.930\nI've got Wire Shark\ninstalled on this machine.\n\n425\n00:21:16.930 --> 00:21:20.200\nWhen I open it in Wire Shark, it's going\nto do a much better job of showing\n\n426\n00:21:20.200 --> 00:21:23.230\nme the data than what I would\nhave had via the webpage.\n\n427\n00:21:23.230 --> 00:21:24.500\nSo, now I can get that breakdown.\n\n428\n00:21:24.500 --> 00:21:26.630\nI can find that FTP session.\n\n429\n00:21:26.630 --> 00:21:29.630\nAnd I can tell it to\nfollow that TCP stream and\n\n430\n00:21:29.630 --> 00:21:32.330\nnow I can see the information\nthat was provided.\n\n431\n00:21:32.330 --> 00:21:35.250\nI can see what that user was doing, okay?\n\n432\n00:21:35.250 --> 00:21:37.990\nAs they connected,\nas they started to work, and so on, right?\n\n433\n00:21:37.990 --> 00:21:41.325\nWe can really really get an idea of\nwhat that traffic was on the system.\n\n434\n00:21:41.325 --> 00:21:44.365\nSo it's a packet capturer that\nruns right from the firewall.\n\n435\n00:21:44.365 --> 00:21:47.635\nAnd that's pretty awesome because\nif you've got a VPN tunnel,\n\n436\n00:21:47.635 --> 00:21:49.085\nit's gonna capture the traffic.\n\n437\n00:21:49.085 --> 00:21:51.455\nOr assuming you choose\nthe right interface,\n\n438\n00:21:51.455 --> 00:21:55.355\nit'll capture it before the data is\nencrypted, versus if you try and\n\n439\n00:21:55.355 --> 00:21:58.145\ncapture it on the the WAN interface\nwhere the data's already encrypted.\n\n440\n00:21:58.145 --> 00:21:58.805\nYou can't see it.\n\n441\n00:21:58.805 --> 00:22:02.795\nSo it's a great place to troubleshoot\nfrom and look at that network traffic.\n\n442\n00:22:02.795 --> 00:22:06.250\n>> Now Don, You've got this Wire Shark.\n\n443\n00:22:06.250 --> 00:22:09.820\nWhy not run Wire Shark and\ncapture it anyways?\n\n444\n00:22:09.820 --> 00:22:12.050\n>> Wire Shark assumes you have\nphysical access to that network,\n\n445\n00:22:12.050 --> 00:22:14.220\nthat you can physically\nplug your machine in.\n\n446\n00:22:14.220 --> 00:22:16.633\nIf you are remote,\nthe firewall is already there.\n\n447\n00:22:16.633 --> 00:22:17.815\nHave it capture for you.\n\n448\n00:22:17.815 --> 00:22:22.125\nAnd then you can copy this cap file up\nto your system wherever you are and\n\n449\n00:22:22.125 --> 00:22:23.035\nopen it and review it.\n\n450\n00:22:23.035 --> 00:22:25.340\nSo it really is a pretty\nuseful thing to have.\n\n451\n00:22:25.340 --> 00:22:27.295\n>> Cool.\n>> All right,\n\n452\n00:22:27.295 --> 00:22:29.155\nlet's see, what else do we have?\n\n453\n00:22:29.155 --> 00:22:32.345\nSome of these, we've already\ntalked about in other episodes.\n\n454\n00:22:32.345 --> 00:22:37.355\nPfInfo, pfTop, those are great for\nseeing information on the system.\n\n455\n00:22:37.355 --> 00:22:41.180\nLike pfTop, that's the one that gives\nyou your top network connections.\n\n456\n00:22:41.180 --> 00:22:42.580\nWho is consuming the most bandwidth?\n\n457\n00:22:42.580 --> 00:22:47.090\nWe saw BandwidthD and ntopng that\ngive us more information than that.\n\n458\n00:22:47.090 --> 00:22:51.110\nPfInfo is getting information\nabout the firewall itself, and so\n\n459\n00:22:51.110 --> 00:22:54.460\nthis is good for if you're working\nwith tech support or whatever.\n\n460\n00:22:54.460 --> 00:22:55.930\nYou can get a ton of information.\n\n461\n00:22:55.930 --> 00:22:59.020\nI think that disk utilization\nis actually in here.\n\n462\n00:22:59.020 --> 00:23:00.740\nRemember how I said it was\nburied in here somewhere?\n\n463\n00:23:00.740 --> 00:23:02.530\nI think it's in pfInfo.\n\n464\n00:23:02.530 --> 00:23:06.040\nAlthough I don't see it, but yeah, it is\nsummarizing for me all my packet data,\n\n465\n00:23:06.040 --> 00:23:08.380\nmy incoming, my outgoing,\nmy connections and their delay.\n\n466\n00:23:08.380 --> 00:23:11.700\nJust good information about the firewall.\n\n467\n00:23:11.700 --> 00:23:14.270\nPing, we already talked about,\nreboot we already talked about.\n\n468\n00:23:14.270 --> 00:23:17.550\nRoutes we saw on the routing episode,\nthat's how we view our routing table.\n\n469\n00:23:17.550 --> 00:23:19.500\nTo see what routes our\nfirewall knows about.\n\n470\n00:23:19.500 --> 00:23:22.150\nAt a minimum you should have a default\nroute to be able to get out to\n\n471\n00:23:22.150 --> 00:23:26.580\nthe internet as well as routes for\neach of your locally connected network.\n\n472\n00:23:26.580 --> 00:23:28.330\nSMART status is a fun one.\n\n473\n00:23:28.330 --> 00:23:32.410\nIf you have a hard drive inside\nof your PF Sense firewall,\n\n474\n00:23:32.410 --> 00:23:34.940\nit can do smart error detection, right?\n\n475\n00:23:34.940 --> 00:23:37.380\nAnd Ronnie,\ndo you remember what SMART stands for?\n\n476\n00:23:37.380 --> 00:23:43.758\n>> It stands for System No, it's\nself-monitoring, analysis, reporting tool.\n\n477\n00:23:43.758 --> 00:23:45.200\n[LAUGH]\n>> There we go.\n\n478\n00:23:45.200 --> 00:23:46.440\n>> [LAUGH] I didn't know that.\n\n479\n00:23:46.440 --> 00:23:47.946\n>> It's a hard drive technology.\n\n480\n00:23:47.946 --> 00:23:48.712\n[CROSSTALK] I didn't know it.\n\n481\n00:23:48.712 --> 00:23:50.341\n>> [LAUGH]\n>> It's a hard drive technology that's\n\n482\n00:23:50.341 --> 00:23:53.307\nbuilt into your disk to help them predict\nwhen a failure is about to occur and\n\n483\n00:23:53.307 --> 00:23:54.216\nPFSense can see that.\n\n484\n00:23:54.216 --> 00:23:58.766\n>> And so if I go under My Diagnostics and\nI go into SMART, you can actually pull up\n\n485\n00:23:58.766 --> 00:24:02.485\nthe SMART health information for\nyour hard drive, or drives.\n\n486\n00:24:02.485 --> 00:24:04.151\nIf you have more than one\nyou can pick right there.\n\n487\n00:24:04.151 --> 00:24:07.454\nYou can actually have it rerun\nthe smart test cuz otherwise it\n\n488\n00:24:07.454 --> 00:24:10.040\nonly runs it when the system boots up.\n\n489\n00:24:10.040 --> 00:24:14.030\nAnd you can view logs to see if there\nhad been any failures in the past.\n\n490\n00:24:14.030 --> 00:24:18.380\nSo a great way to get in there and\nkind of anticipate whether a failure for\n\n491\n00:24:18.380 --> 00:24:21.250\nyour hard drive is coming in your future,\ncuz that's always a good time.\n\n492\n00:24:22.918 --> 00:24:25.990\nAll right, let's see, we're getting\ndown to the last couple of ones here.\n\n493\n00:24:25.990 --> 00:24:27.510\n>> Sockets and states.\n\n494\n00:24:27.510 --> 00:24:29.480\n>> Yep.\nSockets, states, and state summary.\n\n495\n00:24:29.480 --> 00:24:30.670\nThese are all related.\n\n496\n00:24:30.670 --> 00:24:33.800\nThis is all telling us about the traffic\npassing through our firewall.\n\n497\n00:24:33.800 --> 00:24:38.150\nWhen somebody connects to an external\nhost, they create a state, and the state\n\n498\n00:24:38.150 --> 00:24:42.520\ncontains who they are, who they're\nconnected to, what protocol they're using.\n\n499\n00:24:42.520 --> 00:24:43.900\nTheir Socket,\n\n500\n00:24:43.900 --> 00:24:47.680\nthat's the port that they're using as they\nreach out to connect to that other host.\n\n501\n00:24:47.680 --> 00:24:51.079\nAnd the State Summary, well,\nyour state table can be pretty big, and so\n\n502\n00:24:51.079 --> 00:24:53.820\na summary of it kinda\nconsolidates that down.\n\n503\n00:24:53.820 --> 00:24:56.880\nWhat happens is when you have\nsomebody browse out to a single host,\n\n504\n00:24:56.880 --> 00:24:57.860\nlet me show you for example.\n\n505\n00:24:57.860 --> 00:25:02.000\nIf I go here to Sockets, here I see some\nof the different sockets on the firewall\n\n506\n00:25:02.000 --> 00:25:05.950\nI'm listening on, and whether they're\nlistening or actually active.\n\n507\n00:25:05.950 --> 00:25:09.380\nI'm running a lot of different stuff\non this firewall like Squid and stuff.\n\n508\n00:25:09.380 --> 00:25:13.340\nSo they're all kinda just sitting\nhere waiting and not doing much.\n\n509\n00:25:13.340 --> 00:25:17.700\nAnd if I go under Diagnostics > State,\nI'll see the states on my firewall.\n\n510\n00:25:17.700 --> 00:25:21.637\nAnd I got a couple of connections in here\nwhich are related to my machine reaching\n\n511\n00:25:21.637 --> 00:25:22.830\nout to external hosts.\n\n512\n00:25:22.830 --> 00:25:26.620\nSo I see that 192.168.0.99,\nbut there's not a ton.\n\n513\n00:25:26.620 --> 00:25:29.460\nSee my current total\nstate count is only 27.\n\n514\n00:25:29.460 --> 00:25:33.980\nWell, if I open up something like CNN, and\n\n515\n00:25:33.980 --> 00:25:37.760\ntheir crazy web page starts loading\nits thousand connections that it does,\n\n516\n00:25:38.840 --> 00:25:42.310\nwhen I go back here if I\nrefresh my state table.\n\n517\n00:25:44.105 --> 00:25:51.245\nSo if I just go back to Diagnostics >\nStates, I just jumped from 27 to 1,350.\n\n518\n00:25:51.245 --> 00:25:57.025\nI created over 1,300 states just to\nview the CNN page, and that's one host.\n\n519\n00:25:57.025 --> 00:25:58.775\nImagine if you had 1,000\nhosts behind this firewall.\n\n520\n00:25:58.775 --> 00:25:59.985\nIt gets overwhelming.\n\n521\n00:25:59.985 --> 00:26:04.800\nSo you can go to Diagnostics > State\nSummary, and now it's gonna consolidate\n\n522\n00:26:04.800 --> 00:26:09.100\nthat down and say, all right, while I\nmight have five different connections to\n\n523\n00:26:09.100 --> 00:26:12.470\none web server to download ads,\nlet's consolidate that into one entry.\n\n524\n00:26:12.470 --> 00:26:15.304\nYes, I'm using HTTP to download\nads from this one server.\n\n525\n00:26:15.304 --> 00:26:17.296\nAnd so\nit starts to really break that down.\n\n526\n00:26:17.296 --> 00:26:23.170\nSo here's my machine, 192.168.0.99\nI currently have 518 states open,\n\n527\n00:26:23.170 --> 00:26:26.740\nand here's some basic\nsummary information about it.\n\n528\n00:26:26.740 --> 00:26:29.310\nAnd then they break it down\nby destination IP too.\n\n529\n00:26:29.310 --> 00:26:31.290\nSo just a nice little summary of that.\n\n530\n00:26:31.290 --> 00:26:34.970\nIt's still a good chunk of data, but it's\na little bit more manageable this way.\n\n531\n00:26:37.211 --> 00:26:38.425\nAll right, whoops.\n\n532\n00:26:38.425 --> 00:26:41.480\nI'm just jumping all over the place today.\n\n533\n00:26:41.480 --> 00:26:42.220\nAll right, so let's see.\n\n534\n00:26:42.220 --> 00:26:43.982\nThat was states, so\nwe're almost done here.\n\n535\n00:26:43.982 --> 00:26:45.520\nWe got System Activity.\n\n536\n00:26:45.520 --> 00:26:48.780\nSystem Activity's another way to\nget general health of our system.\n\n537\n00:26:48.780 --> 00:26:51.070\nHere I can see the processes\nthat are running and\n\n538\n00:26:51.070 --> 00:26:52.660\nwho’s consuming the bulk of it.\n\n539\n00:26:52.660 --> 00:26:57.490\nHopefully you see exactly what I’m seeing\nhere, that Idle is occupying most of it.\n\n540\n00:26:57.490 --> 00:27:02.620\nThat’s what we want, is our kernel and CPU\nto basically be just sitting there idle.\n\n541\n00:27:02.620 --> 00:27:06.680\nBut our other processes do have to do\nwork, so you expect to see those increase.\n\n542\n00:27:06.680 --> 00:27:09.540\nAnd this screen automatically\nupdates just every two or\n\n543\n00:27:09.540 --> 00:27:13.140\nthree seconds that it updates\nto show what's the most recent.\n\n544\n00:27:13.140 --> 00:27:15.190\nSo that's just kind of\nrunning right there.\n\n545\n00:27:15.190 --> 00:27:19.680\nThis would be the equivalent in a Unix\nshell of running the top command.\n\n546\n00:27:19.680 --> 00:27:21.440\nNot ntop, which is network stuff.\n\n547\n00:27:21.440 --> 00:27:24.047\nHere it's just regular old top, CPU stuff.\n\n548\n00:27:26.194 --> 00:27:29.710\nAll right, the last couple of commands,\nlet's see, that was System Activity.\n\n549\n00:27:29.710 --> 00:27:31.140\nWe've got Tables.\n\n550\n00:27:31.140 --> 00:27:35.140\nTables we don't normally have to go to but\nyour system is maintaining several\n\n551\n00:27:35.140 --> 00:27:38.707\ndifferent tables for different\npurposes and when you jump in here and\n\n552\n00:27:38.707 --> 00:27:42.360\ntake a look at it it's things like,\nwhat IP has been locked out of SSH?\n\n553\n00:27:42.360 --> 00:27:45.410\nWhat IPs have been locked\nout of the web configurator?\n\n554\n00:27:45.410 --> 00:27:48.290\nWhat networks are considered\nbogon networks?\n\n555\n00:27:48.290 --> 00:27:51.740\nI know we mentioned that the default\nfirewall rules blocked bogon networks.\n\n556\n00:27:51.740 --> 00:27:54.850\nThese are networks that shouldn't\nreally be assigned to anybody.\n\n557\n00:27:54.850 --> 00:27:57.670\nWell, you might not know this, but\nthose networks change every week.\n\n558\n00:27:57.670 --> 00:28:01.210\nThe IANA publishes updated lists of what's\nconsidered a bogon network that you\n\n559\n00:28:01.210 --> 00:28:02.360\nshouldn't see.\n\n560\n00:28:02.360 --> 00:28:06.740\nSo if we ever want to see that list,\nwe can come in here and here's the list.\n\n561\n00:28:06.740 --> 00:28:07.871\nAnd you'll notice, I mean,\n\n562\n00:28:07.871 --> 00:28:10.188\nsome of these are what we would\nconsider public IPs, right?\n\n563\n00:28:10.188 --> 00:28:13.700\n31.132.32.0/19.\n\n564\n00:28:13.700 --> 00:28:18.323\nThat's in a class A, it's publicly\nroutable, it's not an RFC 1918 address.\n\n565\n00:28:18.323 --> 00:28:20.260\nBut I shouldn't be getting traffic on it.\n\n566\n00:28:20.260 --> 00:28:22.280\nAnd so\nwe can see that laid out right here.\n\n567\n00:28:22.280 --> 00:28:25.890\nThese are bogon networks and\nthere's a lot of them.\n\n568\n00:28:25.890 --> 00:28:29.040\nAnd that list does get updated,\nso Tables will let us see that.\n\n569\n00:28:31.730 --> 00:28:33.060\nThen we've got Test Port.\n\n570\n00:28:33.060 --> 00:28:35.330\nNow Test Port, I use this one a lot.\n\n571\n00:28:35.330 --> 00:28:38.640\nSomebody calls me and says hey,\nI can't connect to this mail server.\n\n572\n00:28:38.640 --> 00:28:40.760\nI can't connect to this FTP server.\n\n573\n00:28:40.760 --> 00:28:42.750\nAnd so I said, all right, well, let me\njust go ahead and check from the firewall.\n\n574\n00:28:42.750 --> 00:28:44.270\nCan the firewall do it?\n\n575\n00:28:44.270 --> 00:28:48.230\nAnd you can specify, I'll do that same\nFTP server I connected to a moment ago.\n\n576\n00:28:48.230 --> 00:28:49.686\nYou can come in and you can specify it.\n\n577\n00:28:49.686 --> 00:28:52.680\nYou can specify a port number,\nspecify a source port.\n\n578\n00:28:52.680 --> 00:28:56.105\nAnd I know it says that it\nshould typically be left blank.\n\n579\n00:28:56.105 --> 00:28:58.220\nI've never gotten this to\nwork by leaving it blank.\n\n580\n00:28:58.220 --> 00:29:01.600\nSo for the source port you really\nneed to pick a random port.\n\n581\n00:29:01.600 --> 00:29:05.255\nUsually in between 49000 and\n60000 is a good place to pick.\n\n582\n00:29:05.255 --> 00:29:08.425\nI'll pick 49000.\n\n583\n00:29:08.425 --> 00:29:10.455\nAnd then,\nwhether we want to show the text.\n\n584\n00:29:10.455 --> 00:29:12.857\nIf we don't show the text it's just going\nto tell us whether we're connected or not.\n\n585\n00:29:12.857 --> 00:29:14.475\nIt'll say yeah, I connected, great.\n\n586\n00:29:14.475 --> 00:29:15.405\nWhich is pretty fast.\n\n587\n00:29:15.405 --> 00:29:16.575\nI'll show you that first.\n\n588\n00:29:16.575 --> 00:29:19.485\nBut it doesn't give you information\nabout what it connected to.\n\n589\n00:29:19.485 --> 00:29:22.300\nFor the source address,\nthis one's kind of important.\n\n590\n00:29:22.300 --> 00:29:26.221\nIf you choose the WAN interface, you're\ngonna reach out with your public IP.\n\n591\n00:29:26.221 --> 00:29:29.213\nIf you choose the LAN interface,\nit's gonna use your private IP,\n\n592\n00:29:29.213 --> 00:29:33.560\nwhich will get NATted, so this is a good\nway to test network address translation.\n\n593\n00:29:33.560 --> 00:29:36.160\nSo I'm gonna pick my LAN interface for\nthat.\n\n594\n00:29:36.160 --> 00:29:38.530\nAnd then what protocol\nthat you're gonna use.\n\n595\n00:29:38.530 --> 00:29:42.610\nNow because I'm not showing remote text,\nit's gonna reach out and\n\n596\n00:29:42.610 --> 00:29:44.350\njust tell me if it can\nconnect on that port.\n\n597\n00:29:44.350 --> 00:29:45.270\nIt'll do it very fast.\n\n598\n00:29:46.780 --> 00:29:50.847\nBut if I tell it to show remote text, what\nit's gonna do is it's gonna connect and\n\n599\n00:29:50.847 --> 00:29:52.960\nit's gonna wait ten seconds.\n\n600\n00:29:52.960 --> 00:29:58.560\nAnd then it's going to show me any text\nthat came up in those ten seconds.\n\n601\n00:29:58.560 --> 00:30:01.280\nIf I give that a moment here, it's\ngonna run, it's gonna wait ten seconds.\n\n602\n00:30:01.280 --> 00:30:02.540\nThere we go.\n\n603\n00:30:02.540 --> 00:30:05.720\nAnd I can see it actually\nconnected to an FTP server.\n\n604\n00:30:05.720 --> 00:30:07.230\nThere's the information about it.\n\n605\n00:30:07.230 --> 00:30:09.254\nIt's a great way for\ntesting email servers.\n\n606\n00:30:09.254 --> 00:30:11.880\nSomebody says, man,\nmy email is not getting through.\n\n607\n00:30:11.880 --> 00:30:15.730\nThen you might say,\nwell can we even connect to that server?\n\n608\n00:30:15.730 --> 00:30:19.440\nSo I might go up here to\nDiagnostics > DNS Lookup.\n\n609\n00:30:19.440 --> 00:30:21.970\nAnd I might do a DNS Lookup for\nwhoever it is that I'm sending to.\n\n610\n00:30:21.970 --> 00:30:24.000\nMaybe I'm sending an email to Google.\n\n611\n00:30:24.000 --> 00:30:28.840\nSo I do a lookup for google.com,\nand I can see their information.\n\n612\n00:30:28.840 --> 00:30:32.350\nOh, they don't show me the mx records\nhere when you do this lookup.\n\n613\n00:30:32.350 --> 00:30:35.480\nBut if I want their mx records,\nI can go and get their mx records.\n\n614\n00:30:35.480 --> 00:30:38.910\nSo let me just do that right here.\n\n615\n00:30:38.910 --> 00:30:43.730\nSo I'll do an nslookup, set type=mx.\n\n616\n00:30:43.730 --> 00:30:45.400\nAnd I'll do google.com.\n\n617\n00:30:45.400 --> 00:30:48.416\nThere we go, and so here's their\nmail servers that are out there, and\n\n618\n00:30:48.416 --> 00:30:49.860\nI'll just pick any one of these.\n\n619\n00:30:49.860 --> 00:30:50.620\nI'll take this one.\n\n620\n00:30:53.190 --> 00:30:56.150\nAnd if I'm going to be sending them email,\nwell,\n\n621\n00:30:56.150 --> 00:30:59.650\nI can go down here to\nDiagnostics > Test Port.\n\n622\n00:30:59.650 --> 00:31:02.782\nI can put in the host,\nwhich is gonna be Google's mail server.\n\n623\n00:31:02.782 --> 00:31:06.962\nFor the port I'll put in 25 and\nI'll just do 49000 for mine.\n\n624\n00:31:06.962 --> 00:31:11.809\nI'll say show me the remote text and here\nit's not gonna matter if I do WAN or LAN,\n\n625\n00:31:11.809 --> 00:31:15.260\nI just wanna see if I\ncan get to their server.\n\n626\n00:31:15.260 --> 00:31:17.397\nAnd then what protocol I want to use.\n\n627\n00:31:17.397 --> 00:31:21.100\nAnd so I'm going to reach out to\ntheir server, and can I connect?\n\n628\n00:31:21.100 --> 00:31:23.860\nMaybe there's a firewall in between me and\nthem blocking it.\n\n629\n00:31:23.860 --> 00:31:24.840\nMaybe I connect to them and\n\n630\n00:31:24.840 --> 00:31:27.540\nit gives me an error message\nsaying I need to authenticate.\n\n631\n00:31:27.540 --> 00:31:30.230\nI'll at least be able to see\nthat information and find out.\n\n632\n00:31:30.230 --> 00:31:33.340\nIn this case, I can see yes,\nI can connect to them, and\n\n633\n00:31:33.340 --> 00:31:35.270\nI'm getting a response back\nfrom their SMTP server.\n\n634\n00:31:35.270 --> 00:31:37.780\nSo, just a great way to troubleshoot\nnetwork connectivity like that.\n\n635\n00:31:39.540 --> 00:31:40.686\nAnd that leads us to our\n[CROSSTALK] last one.\n\n636\n00:31:40.686 --> 00:31:41.810\n>> Traceroute.\n\n637\n00:31:41.810 --> 00:31:45.710\n>> Yeah, which is incredibly useful,\nthat's this Traceroute command.\n\n638\n00:31:47.240 --> 00:31:51.540\nSo with traceroute, I can get a chance\nto see all the hosts in between me and\n\n639\n00:31:51.540 --> 00:31:54.670\nmy destination, which is great for\nidentifying where there's problems.\n\n640\n00:31:54.670 --> 00:31:58.400\nSo if I'm trying to get to a website,\nI'll do slashdot.org.\n\n641\n00:31:58.400 --> 00:32:00.920\nIf I want to get to that site I\ncan tell it I want to do an IPv4,\n\n642\n00:32:00.920 --> 00:32:03.030\nkind of traceroute.\n\n643\n00:32:03.030 --> 00:32:07.050\nI can tell it for the source address\nI want to use my LAN or WAN or\n\n644\n00:32:07.050 --> 00:32:09.310\nwhatever interface it is\nthat I want to test from.\n\n645\n00:32:09.310 --> 00:32:11.395\nI'll just choose my WAN interface here.\n\n646\n00:32:11.395 --> 00:32:15.115\nAnd I can do a reverse address\nlookup if I want to see the name of\n\n647\n00:32:15.115 --> 00:32:17.985\neach router that I pass\nthrough on the way there.\n\n648\n00:32:17.985 --> 00:32:20.935\nWhen I run the traceroute,\nit's gonna map that out and\n\n649\n00:32:20.935 --> 00:32:24.762\nshow all the routers that I pass\nthrough on my way to a destination.\n\n650\n00:32:24.762 --> 00:32:29.492\nSo if I can't get to Google's mx server,\nmaybe the problem isn't at Google.\n\n651\n00:32:29.492 --> 00:32:33.492\nMaybe the problem is with an ISP\nin between me and Google, and\n\n652\n00:32:33.492 --> 00:32:37.182\nwith traceroute we can find\nout where that problem is.\n\n653\n00:32:37.182 --> 00:32:42.232\nNow you may bump into a situation where\nsome of your hops get blocked, and when\n\n654\n00:32:42.232 --> 00:32:46.810\nthat happens instead of seeing a name like\nthis you'll just see three asterisks, ***.\n\n655\n00:32:46.810 --> 00:32:48.200\nThat's letting you know\nthat it got blocked.\n\n656\n00:32:49.240 --> 00:32:51.350\nBut then it may continue on after that.\n\n657\n00:32:51.350 --> 00:32:55.553\nThe reason is traceroute actually has its\nown protocol, the traceroute protocol,\n\n658\n00:32:55.553 --> 00:32:57.980\nand not every firewall allows it.\n\n659\n00:32:57.980 --> 00:33:01.881\nSo in PF Sense, it's actually got this\nreally neat option here, Use ICMP.\n\n660\n00:33:01.881 --> 00:33:04.527\nAnd what you can do is you\ncan tell it to do that, and\n\n661\n00:33:04.527 --> 00:33:06.691\nit won't use the traceroute protocol.\n\n662\n00:33:06.691 --> 00:33:08.671\nInstead it'll use ping.\n\n663\n00:33:08.671 --> 00:33:11.030\nIt'll use ICMP echo request for\neach hop and\n\n664\n00:33:11.030 --> 00:33:14.026\nit'll say, I'm just gonna\nsend out an echo request and\n\n665\n00:33:14.026 --> 00:33:18.210\nget a reply back using that because\na lot of firewalls do allow that.\n\n666\n00:33:18.210 --> 00:33:20.788\nAnd when you choose that, if it wasn't\ngetting blocked you'll actually\n\n667\n00:33:20.788 --> 00:33:22.046\nget the same output you did before.\n\n668\n00:33:22.046 --> 00:33:23.786\nIt's not really any different, but\n\n669\n00:33:23.786 --> 00:33:26.620\nit is using a different\nprotocol to achieve its goals.\n\n670\n00:33:26.620 --> 00:33:30.490\nSo great way to see that pathway to\nfigure out what's in between you and\n\n671\n00:33:30.490 --> 00:33:33.770\nthat destination and\nkind of troubleshoot your network.\n\n672\n00:33:35.110 --> 00:33:38.680\nAll right, well, that's pretty good\nrundown of all the diagnostic tools and\n\n673\n00:33:38.680 --> 00:33:40.440\nkind of scenarios where we use them.\n\n674\n00:33:40.440 --> 00:33:43.210\nHopefully you guys get an idea\nthere of the power of that.\n\n675\n00:33:43.210 --> 00:33:46.790\nThe nice part, again, is that we can\ntroubleshoot right from the firewall.\n\n676\n00:33:46.790 --> 00:33:50.960\nSo this firewall might be at a branch\noffice in a completely different country,\n\n677\n00:33:50.960 --> 00:33:52.660\nbut I can connect into the firewall and\n\n678\n00:33:52.660 --> 00:33:55.500\nstart to run all of these tests\nas if I was sitting right there.\n\n679\n00:33:55.500 --> 00:33:57.780\nAnd that's really, really valuable,\nreally useful thing to do.\n\n680\n00:33:59.200 --> 00:34:02.390\n>> So when we take a look at\nthe PF Sense firewall, don't\n\n681\n00:34:02.390 --> 00:34:06.280\nget rid of it as a diagnostic tool, don't\njust think about its basic functionality.\n\n682\n00:34:06.280 --> 00:34:09.430\nRealize that there are so many diagnostic\ntools that are built right in there,\n\n683\n00:34:09.430 --> 00:34:12.700\nand it's worth you taking\ntime to explore it.\n\n684\n00:34:12.700 --> 00:34:16.800\nIt's worth you actually taking a look\nat it and get used to using it as well.\n\n685\n00:34:16.800 --> 00:34:19.720\nRight from the firewall being able to\nactually diagnose all the different things\n\n686\n00:34:19.720 --> 00:34:22.210\nthat we saw, is an incredible use and\n\n687\n00:34:22.210 --> 00:34:24.920\nan incredible tool that you can\nhave just on your entire network.\n\n688\n00:34:24.920 --> 00:34:26.540\nHope you guys enjoyed this segment.\n\n689\n00:34:26.540 --> 00:34:28.222\nStay tuned for more PF Sense.\n\n690\n00:34:28.222 --> 00:34:34.190\n[SOUND]\n\n",
          "vimeoId": "132319755"
        },
        {
          "description": null,
          "length": "1580",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-3-bandwidthg_ntopng-062915-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-3-bandwidthg_ntopng-062915-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-3-bandwidthg_ntopng-062915-1-sm.jpg",
          "title": "BandwidthD / ntopgn",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:05.304\n[MUSIC]\n\n2\n00:00:07.675 --> 00:00:10.888\nIn this segment we're gonna take a look\nat some of the monitoring tools that\n\n3\n00:00:10.888 --> 00:00:13.180\nare available inside of pfSense itself.\n\n4\n00:00:13.180 --> 00:00:16.860\nSo that we can actually go ahead and be\nable to find out not only what the system\n\n5\n00:00:16.860 --> 00:00:20.820\nis actually doing in performance,\nbut as well as the network.\n\n6\n00:00:20.820 --> 00:00:23.408\nAnd we take a look at those,\nthere's two common packages.\n\n7\n00:00:23.408 --> 00:00:28.390\nOne's called BandwidthD and the other one,\nyou're gonna have to help me, NTOPNG,\n\n8\n00:00:28.390 --> 00:00:29.262\nthat's the one-\n>> That's right.\n\n9\n00:00:29.262 --> 00:00:30.430\n>> That I can't remember.\n\n10\n00:00:30.430 --> 00:00:32.150\nSo a little bit tongue twister for me.\n\n11\n00:00:32.150 --> 00:00:34.950\nBut those are really the two basic\nmonitoring tools that really help us\n\n12\n00:00:34.950 --> 00:00:36.810\ndealing with performance.\n\n13\n00:00:36.810 --> 00:00:38.490\n>> Let's start with BandwidthD.\n\n14\n00:00:38.490 --> 00:00:40.470\nIt just means the Bandwidth demon, and\n\n15\n00:00:40.470 --> 00:00:43.450\nit's a service that can run in\nthe background on top of pfSense.\n\n16\n00:00:43.450 --> 00:00:47.785\nAnd what it does, is it provides a really\nlight weight way to measure traffic and\n\n17\n00:00:47.785 --> 00:00:50.130\nbandwidth consumption on your firewall.\n\n18\n00:00:50.130 --> 00:00:52.750\nLet me show you a common\nproblem that we have.\n\n19\n00:00:52.750 --> 00:00:56.690\nSo here on my firewall, I've got a little\ntraffic graph thrown right here on my\n\n20\n00:00:56.690 --> 00:00:59.010\nhome screen so\nI can just see how traffic I'm pushing.\n\n21\n00:00:59.010 --> 00:00:59.950\nAnd if you look at it,\n\n22\n00:00:59.950 --> 00:01:03.910\nI've got this huge spike right here\nwhere I spiked almost to 60 megabits.\n\n23\n00:01:03.910 --> 00:01:06.280\nAnd then it dropped back down and\nnow, I'm kind of flat lining.\n\n24\n00:01:06.280 --> 00:01:10.440\nSo at this point in time,\nsomebody was moving it about we'll say,\n\n25\n00:01:10.440 --> 00:01:12.565\n55 megabits of traffic.\n\n26\n00:01:12.565 --> 00:01:13.315\nWho was it?\n\n27\n00:01:13.315 --> 00:01:14.495\nWho did that?\nWho was consuming my\n\n28\n00:01:14.495 --> 00:01:15.975\nbandwidth during that time?\n\n29\n00:01:15.975 --> 00:01:16.995\nI have no idea.\n\n30\n00:01:16.995 --> 00:01:18.213\nI know that it happened.\n\n31\n00:01:18.213 --> 00:01:20.735\nThe firewall let's me know\nthat it happened, but\n\n32\n00:01:20.735 --> 00:01:22.885\nit doesn't let me know who did it.\n\n33\n00:01:22.885 --> 00:01:24.925\nAnd that's what BandwidthD helps with.\n\n34\n00:01:24.925 --> 00:01:28.955\nBandwidthD can run in the background and\nit can interpret this information and\n\n35\n00:01:28.955 --> 00:01:33.140\nlog it to a little database to say,\nhere's the person that used that traffic.\n\n36\n00:01:33.140 --> 00:01:36.510\nAnd here's the conversation, here's who\nthe source was and the destination.\n\n37\n00:01:36.510 --> 00:01:40.700\nAnd it gives you a better idea of what was\nconsuming the traffic on your network.\n\n38\n00:01:40.700 --> 00:01:44.740\nThis is really handy if you have something\nlike a metered bandwidth connection.\n\n39\n00:01:44.740 --> 00:01:45.940\nI know I had that.\n\n40\n00:01:45.940 --> 00:01:48.280\nI got an email from my\ncable company saying,\n\n41\n00:01:48.280 --> 00:01:50.090\nI went over my bandwidth utilization for\na month.\n\n42\n00:01:50.090 --> 00:01:51.446\n>> [LAUGH]\n>> I was like, what are you talking about?\n\n43\n00:01:51.446 --> 00:01:52.564\n>> [LAUGH]\n>> So\n\n44\n00:01:52.564 --> 00:01:57.640\nI turned on BandwidthD on my firewall at\nhome, and I recorded traffic for a month.\n\n45\n00:01:57.640 --> 00:01:59.596\nAnd then when I violated my limit again.\n\n46\n00:01:59.596 --> 00:02:01.880\n>> [LAUGH]\n>> I was like let me pull up the log and\n\n47\n00:02:01.880 --> 00:02:02.750\nfigure out who I was.\n\n48\n00:02:02.750 --> 00:02:06.090\nAnd it was kind of interesting because it\nturned out to be a little Roku box in my\n\n49\n00:02:06.090 --> 00:02:09.860\nhouse that I had a picture\nscreen saver on it.\n\n50\n00:02:09.860 --> 00:02:11.440\nSo when it would go on to a screen saver,\n\n51\n00:02:11.440 --> 00:02:14.750\nit would throw these pictures right\nout of my Google Picasa account.\n\n52\n00:02:14.750 --> 00:02:18.230\nWell, it didn't cash the photos so\nit was downloading photos\n\n53\n00:02:18.230 --> 00:02:22.260\nconstantly as it ran and\nit was running me out of my bandwidth cap.\n\n54\n00:02:22.260 --> 00:02:25.220\nI was able to find that\nthanks to BandwidthD.\n\n55\n00:02:25.220 --> 00:02:27.730\nNow, it is very light weight,\nthere's not a lot of options with it.\n\n56\n00:02:27.730 --> 00:02:29.620\nLet me show you how we install it.\n\n57\n00:02:29.620 --> 00:02:31.700\nFirst off it's a package that\nwe got to get installed.\n\n58\n00:02:31.700 --> 00:02:35.480\nSo I'm gonna go up here\nto System > Packages.\n\n59\n00:02:35.480 --> 00:02:39.432\nAnd then I'll go to Available Packages,\nand I'm going to find Bandwidth D.\n\n60\n00:02:39.432 --> 00:02:43.150\nNow, BandwidthD hasn't\nseen a ton of updates, but\n\n61\n00:02:43.150 --> 00:02:45.760\nthey're actually doing a pretty\ngood job about getting it current.\n\n62\n00:02:45.760 --> 00:02:49.737\nAnd see how it's got platform 2.2 2.2.999.\n\n63\n00:02:49.737 --> 00:02:54.966\nWell this one, it really jumped from\nplatform 1.2.3, right up to this.\n\n64\n00:02:54.966 --> 00:02:59.130\nSo it kind of missed a few updates\nfrom the earlier pfSense 2.0 days.\n\n65\n00:02:59.130 --> 00:03:01.840\nBut it has been updated now,\nso it's pretty safe to run.\n\n66\n00:03:01.840 --> 00:03:03.035\nSo we've got bandwidthd.\n\n67\n00:03:03.035 --> 00:03:06.308\nWe can just hit our little plus\nsign to get that installed and\n\n68\n00:03:06.308 --> 00:03:10.780\nwe'll confirm that and once it's\ninstalled, it's pretty much ready to rock.\n\n69\n00:03:10.780 --> 00:03:14.000\nBandwidthd is not a difficult thing\nto get installed or up and running or\n\n70\n00:03:14.000 --> 00:03:15.200\nanything like that.\n\n71\n00:03:15.200 --> 00:03:16.990\nOnce it's in there.\n\n72\n00:03:16.990 --> 00:03:18.220\nSo I'm just gonna let it finish.\n\n73\n00:03:18.220 --> 00:03:19.890\nThere we go, it completed.\n\n74\n00:03:19.890 --> 00:03:22.560\nWe just need to double\ncheck its configuration.\n\n75\n00:03:22.560 --> 00:03:23.820\nAnd if you go up here to Services,\n\n76\n00:03:23.820 --> 00:03:26.140\nyou'll see BandwidthD added\nright under your service menu.\n\n77\n00:03:26.140 --> 00:03:29.380\nAnd when we go in here we'll\nsee our configuration.\n\n78\n00:03:29.380 --> 00:03:32.070\nNow, it looks like there's\na lot of options in here, but\n\n79\n00:03:32.070 --> 00:03:33.440\nthere's really not all that much.\n\n80\n00:03:33.440 --> 00:03:35.530\nLet's kind of walk through\nthe different options.\n\n81\n00:03:35.530 --> 00:03:37.068\nFirst off, you can turn it on.\n\n82\n00:03:37.068 --> 00:03:40.129\nIf you went through the trouble of\ninstalling it you probably do want\n\n83\n00:03:40.129 --> 00:03:41.590\nto turn it on, so I'll do that.\n\n84\n00:03:41.590 --> 00:03:43.990\nThen the interface that it will bind to.\n\n85\n00:03:43.990 --> 00:03:47.230\nNow, that doesn't mean\nthe interface it's monitoring.\n\n86\n00:03:47.230 --> 00:03:50.560\nIt means it's the interface that we're\nallowed to access the admin interface.\n\n87\n00:03:50.560 --> 00:03:54.850\nBandwithd actually gonna create\na separate web server in the background.\n\n88\n00:03:54.850 --> 00:03:57.120\nAnd this is the interface\nit's gonna answer on.\n\n89\n00:03:57.120 --> 00:03:59.790\nSo we typically want our LAN interface.\n\n90\n00:03:59.790 --> 00:04:02.938\nClients on the LAN will be able\nto get to the BandwidthD page.\n\n91\n00:04:02.938 --> 00:04:03.850\nAnd that's exactly what I want.\n\n92\n00:04:04.880 --> 00:04:09.560\nYou can then specify other networks\nyou want to allow to have access.\n\n93\n00:04:09.560 --> 00:04:12.300\nSo for example my firewall,\nthe LAN side is 192.168.0.0/24, but\n\n94\n00:04:12.300 --> 00:04:18.110\nI might have other networks\nthat I wanna authorize.\n\n95\n00:04:18.110 --> 00:04:19.970\nSo I can just do a semicolon and\n\n96\n00:04:19.970 --> 00:04:25.180\npunch in other networks in here too,\nand now they'll be allowed to connect.\n\n97\n00:04:25.180 --> 00:04:29.630\nSo each of the networks that you want to\nbe able to connect to the end of this.\n\n98\n00:04:29.630 --> 00:04:34.300\nYou've got how often it grabs data\nBandwidthD is collecting data about your\n\n99\n00:04:34.300 --> 00:04:38.620\ntraffic if you are constantly collecting\ndata it creates a performance hit.\n\n100\n00:04:38.620 --> 00:04:43.520\nSo to minimize that hit, it grabs on\nintervals instead of constantly grabbing.\n\n101\n00:04:43.520 --> 00:04:47.765\nAnd you'll see the default is zero which\nmean it actually is gonna constantly grab,\n\n102\n00:04:47.765 --> 00:04:51.180\nit's gonna grab a bunch of information\nI might wanna spread that out.\n\n103\n00:04:51.180 --> 00:04:53.960\nAnd here it's just saying that each\ninterval that I specify is actually\n\n104\n00:04:53.960 --> 00:04:55.500\n200 seconds.\n\n105\n00:04:55.500 --> 00:04:58.844\nSo if I do an interval\nof one then it's only\n\n106\n00:04:58.844 --> 00:05:03.539\ngoing to grab settings every 3 minutes and\n20 seconds.\n\n107\n00:05:03.539 --> 00:05:05.380\nThat may or may not be what we want.\n\n108\n00:05:05.380 --> 00:05:06.610\nYou kind of put in your values there.\n\n109\n00:05:06.610 --> 00:05:07.420\nI'm gonna leave mine empty.\n\n110\n00:05:08.480 --> 00:05:10.319\nThen our graph cutoff.\n\n111\n00:05:10.319 --> 00:05:13.520\nThe graph cutoff,\nthat's when it's building these graphs.\n\n112\n00:05:13.520 --> 00:05:16.080\nThe data, if it gets too\nlarge when do we cut it off?\n\n113\n00:05:16.080 --> 00:05:20.464\nAnd the default here is to set it to 1024\nkilobytes, in other words 1 megabyte,\n\n114\n00:05:20.464 --> 00:05:23.390\nwhich is actually quite a bit\nof chart data right there.\n\n115\n00:05:23.390 --> 00:05:24.360\nThat's usually more than enough.\n\n116\n00:05:25.890 --> 00:05:28.970\nAnother option is whether or\nnot we wanna operate in promiscuous mode.\n\n117\n00:05:28.970 --> 00:05:29.760\nBy default,\n\n118\n00:05:29.760 --> 00:05:33.660\nthe firewall is only gonna report on\ntraffic that passed through the firewall.\n\n119\n00:05:33.660 --> 00:05:36.920\nIf you turn on promiscuous mode, it'll\ntrack traffic that didn't pass through\n\n120\n00:05:36.920 --> 00:05:39.990\nthe firewall that it just was\nable to see on the interface.\n\n121\n00:05:39.990 --> 00:05:43.750\nNow there's rarely any point in doing\nthat, but you can turn that option on and\n\n122\n00:05:43.750 --> 00:05:45.140\nthen it'll track that too.\n\n123\n00:05:45.140 --> 00:05:47.210\nJust be aware it's not terribly effective.\n\n124\n00:05:49.200 --> 00:05:51.435\nThe next two options are really important.\n\n125\n00:05:51.435 --> 00:05:54.300\nBandwidthD is creating\nall these logs in RAM.\n\n126\n00:05:55.360 --> 00:05:59.180\nWhat happens if your firewall reboots or\nyou lose power?\n\n127\n00:05:59.180 --> 00:06:03.070\nWell the logs go away and BandwidthD\nstarts with a new empty setting.\n\n128\n00:06:03.070 --> 00:06:05.770\nSo if you'd been trying to track\na months worth of traffic and\n\n129\n00:06:05.770 --> 00:06:09.159\non day 28 the firewall reboots,\nyou just lost 28 days of logs.\n\n130\n00:06:10.220 --> 00:06:14.700\nSo you can tell it to log\nthe data to a log file.\n\n131\n00:06:14.700 --> 00:06:16.630\nAnd then you can tell it when it reboots,\n\n132\n00:06:16.630 --> 00:06:20.080\nread those logs back into memory and\nnow they'll be available.\n\n133\n00:06:21.810 --> 00:06:23.360\nOne word of caution here.\n\n134\n00:06:23.360 --> 00:06:28.870\nIf you're running on a Nano install\nlike you've installed to a USB key or to\n\n135\n00:06:28.870 --> 00:06:33.110\nsome kind of flash memory, you generally\ndon't wanna log to your flash memory.\n\n136\n00:06:33.110 --> 00:06:36.960\nBecause those are a lot of writes that\nare happening to the flash memory and\n\n137\n00:06:36.960 --> 00:06:38.280\nthat shortens the lifespan.\n\n138\n00:06:38.280 --> 00:06:41.820\nNow, the last couple of years,\nthat was definitely a big deal.\n\n139\n00:06:41.820 --> 00:06:44.770\nIn recent years,\nflash memory's come a long way.\n\n140\n00:06:44.770 --> 00:06:47.300\nAnd it's normally okay to go ahead and\ndo it.\n\n141\n00:06:47.300 --> 00:06:50.110\nInstead of being able to get eight years\nout of that flash memory you might only\n\n142\n00:06:50.110 --> 00:06:51.890\nget four years out of that flash memory.\n\n143\n00:06:51.890 --> 00:06:53.960\nWell, you probably won't run\nthat firewall for four years,\n\n144\n00:06:53.960 --> 00:06:55.320\nyou'll probably swap it out before then.\n\n145\n00:06:55.320 --> 00:06:56.970\nSo it's not really a big deal.\n\n146\n00:06:56.970 --> 00:06:59.730\nSo just be aware of that if\nyou're doing a Nano install,\n\n147\n00:06:59.730 --> 00:07:03.759\nyou can have some logging issues or\nlifetime issues with your memory.\n\n148\n00:07:05.780 --> 00:07:08.810\nIf you're running a Nano install and\nyou really wanna log this data,\n\n149\n00:07:08.810 --> 00:07:11.870\nyou can actually choose to\nlog to a post or SQL server.\n\n150\n00:07:11.870 --> 00:07:16.570\nYou can set up a database on your network\nnot on pfSense itself, somewhere else and\n\n151\n00:07:16.570 --> 00:07:17.340\nyou can log it in.\n\n152\n00:07:17.340 --> 00:07:19.990\nAnd if you do that,\nyou provide the database host, name,\n\n153\n00:07:19.990 --> 00:07:21.760\nusername, and other information.\n\n154\n00:07:22.830 --> 00:07:23.790\nSo you can provide that, and\n\n155\n00:07:23.790 --> 00:07:26.090\nthat can kind of solves the problem\nof writing logs locally.\n\n156\n00:07:27.520 --> 00:07:30.630\nYou can define filters, if there's\ntraffic that you want to leave out.\n\n157\n00:07:30.630 --> 00:07:34.920\nIt uses libpcap, so you can go and pull up\nthe documentation for the libpcap project\n\n158\n00:07:34.920 --> 00:07:38.640\nand write a filter to define, this is\nthe only type of traffic I wanna monitor.\n\n159\n00:07:38.640 --> 00:07:40.350\nThat will help reduce\nthe size of your logs also.\n\n160\n00:07:42.110 --> 00:07:43.610\nIt's got the option to draw graphs.\n\n161\n00:07:43.610 --> 00:07:46.090\nWe normally want that if it\nmakes things look pretty.\n\n162\n00:07:46.090 --> 00:07:49.210\nYou can just have it give you tables\nthough instead of graphs if you turn that\n\n163\n00:07:49.210 --> 00:07:49.790\noption off.\n\n164\n00:07:51.250 --> 00:07:52.550\nHere's the refresh interval.\n\n165\n00:07:52.550 --> 00:07:55.790\nWhen we're viewing the BandwidthD page,\nhow often does it refresh automatically?\n\n166\n00:07:55.790 --> 00:07:58.050\nYou can always refresh manually\nwhenever you want, but\n\n167\n00:07:58.050 --> 00:07:59.250\nyou can set that interval right here.\n\n168\n00:08:00.680 --> 00:08:03.753\nAnd then it's just giving us\nthe basic graph and log information.\n\n169\n00:08:03.753 --> 00:08:07.092\nSo it's telling us how often it's\ngonna create those log files and\n\n170\n00:08:07.092 --> 00:08:08.954\nhow much data it's going to retain.\n\n171\n00:08:08.954 --> 00:08:13.620\nNow when we save that,\nbandwidth d is now active and running.\n\n172\n00:08:13.620 --> 00:08:16.700\nRemember I said it's spinning up\na web server in the background.\n\n173\n00:08:16.700 --> 00:08:19.980\nIt gives me this access bandwidth d link\nand if you look at the URL at the bottom\n\n174\n00:08:19.980 --> 00:08:25.330\nof my screen there, it's actually going\nto my firewalls IP slash bandwidth d.\n\n175\n00:08:25.330 --> 00:08:27.950\nThat's the separate website\nthat it builds, and\n\n176\n00:08:27.950 --> 00:08:31.110\nwhen you go there you'll\nsee this page right here.\n\n177\n00:08:31.110 --> 00:08:33.960\nNow, if you're like me,\nyou just turned on bandwidth d,\n\n178\n00:08:33.960 --> 00:08:37.630\nit doesn't have any information to show us\nand so we come in here it's kinda empty.\n\n179\n00:08:37.630 --> 00:08:40.630\nYou can expect that, probably for\nthe first solid day, right?\n\n180\n00:08:40.630 --> 00:08:43.630\nSo I'd have to really run this route\n24 hours before I got any kind of\n\n181\n00:08:43.630 --> 00:08:45.460\ntruly useful information and\n\n182\n00:08:45.460 --> 00:08:48.730\nthe longer it's been running,\nthe more data you'll see, all right?\n\n183\n00:08:48.730 --> 00:08:50.530\nLet me show you on a production firewall.\n\n184\n00:08:50.530 --> 00:08:53.230\nThis is the firewall that our video\nstream is going through right now, so\n\n185\n00:08:53.230 --> 00:08:57.040\nif you're watching this live,\nwe're passing through this firewall, and\n\n186\n00:08:57.040 --> 00:09:01.740\nI'm just gonna go up to Services, and\nBandwidthD, and I'll access that page.\n\n187\n00:09:01.740 --> 00:09:06.690\nAnd here see how I got the Top\n20 IPs by Traffic- Daily.\n\n188\n00:09:06.690 --> 00:09:11.530\nAnd I can see the list sorted\nby who is the consumer, right?\n\n189\n00:09:11.530 --> 00:09:12.280\nHere's the 10.1.230.5,\n\n190\n00:09:12.280 --> 00:09:15.630\nthat's a host on our internal network\nthat's moving a certain amount of traffic.\n\n191\n00:09:15.630 --> 00:09:19.700\nAnd it starts to lay this stuff out for\nme, and then it breaks it down by subnets,\n\n192\n00:09:19.700 --> 00:09:22.070\nand we can kind of see that being metered.\n\n193\n00:09:22.070 --> 00:09:25.244\nAnd these charts, if I had been running\nit for a month, or for days, or weeks, or\n\n194\n00:09:25.244 --> 00:09:27.730\nwhatever, we'd have it kind\nof stretched out more.\n\n195\n00:09:27.730 --> 00:09:31.150\nBut you start to get an idea of\nwho is consuming that traffic.\n\n196\n00:09:31.150 --> 00:09:33.456\nAnd you can break it down different ways.\n\n197\n00:09:33.456 --> 00:09:35.130\nThe Top 20 is what it's showing right now,\n\n198\n00:09:35.130 --> 00:09:37.900\ni could say let me just\nsee this one network.\n\n199\n00:09:37.900 --> 00:09:41.420\nAnd now it starts to break it down more.\n\n200\n00:09:41.420 --> 00:09:44.030\nSo, 10.1.230.5, that host,\nhas moved 59.8 gigs of data.\n\n201\n00:09:44.030 --> 00:09:45.080\nSeems like a lot.\n\n202\n00:09:45.080 --> 00:09:50.570\nWell, that's probably our video switch\nover here that's pushing the live stream.\n\n203\n00:09:50.570 --> 00:09:52.080\nAlthough it could be\nsomebody's workstation.\n\n204\n00:09:52.080 --> 00:09:54.780\nI have to look up,\nI don't remember offhand who .5 is.\n\n205\n00:09:54.780 --> 00:09:56.650\nOh, actually .5 is our video encoder.\n\n206\n00:09:56.650 --> 00:09:58.835\nYeah, that's the one that\nuploads videos for the site.\n\n207\n00:09:58.835 --> 00:09:59.734\n[CROSSTALK] Yeah.\n\n208\n00:09:59.734 --> 00:10:00.250\n>> [LAUGH]\n>> But\n\n209\n00:10:00.250 --> 00:10:04.340\nsome of these other ones we can look up\nwhat they were and try and find and out.\n\n210\n00:10:04.340 --> 00:10:09.300\nI know this one was my laptop right here,\nso I pushed 1.9 gigs of data on my system.\n\n211\n00:10:09.300 --> 00:10:12.350\nAnd you can kind of break down\nhow much they're communicating.\n\n212\n00:10:12.350 --> 00:10:16.770\nSo this is a great way to identify\nwho's moving the most traffic, right?\n\n213\n00:10:16.770 --> 00:10:19.710\nAnd if I click on it, I can see kind\nof a breakdown of that traffic.\n\n214\n00:10:19.710 --> 00:10:23.140\nSo, you can see like for mine,\nmost of it was HTTP, although I've got\n\n215\n00:10:23.140 --> 00:10:26.845\na little bit of TCP traffic off to the\nside that was apparently unidentifiable.\n\n216\n00:10:26.845 --> 00:10:30.360\n[LAUGH] I don't know what\nI'm doing to generate that.\n\n217\n00:10:30.360 --> 00:10:33.260\nBut, you can see really interesting\ninformation in here as you break\n\n218\n00:10:33.260 --> 00:10:34.340\nthis stuff down.\n\n219\n00:10:34.340 --> 00:10:36.520\nAnd kind of what is,\nthis is probably our streaming server, so\n\n220\n00:10:36.520 --> 00:10:40.730\nwe would have started recording in\nthe morning and it's still running to now.\n\n221\n00:10:40.730 --> 00:10:43.070\nBut it's cool.\nYou get some great information here.\n\n222\n00:10:43.070 --> 00:10:46.410\nIt's not incredibly detailed though,\nright?\n\n223\n00:10:46.410 --> 00:10:49.130\nLike I can't see who these\npeople are talking to.\n\n224\n00:10:49.130 --> 00:10:50.540\nBandwidthD doesn't record that.\n\n225\n00:10:50.540 --> 00:10:52.520\nIt's really just focused on bandwidth.\n\n226\n00:10:52.520 --> 00:10:53.610\nThat's the name.\n\n227\n00:10:53.610 --> 00:10:55.530\nSo BandwidthD is lightweight.\n\n228\n00:10:55.530 --> 00:11:00.440\nIt's simple, but the information it gives\nyou is lightweight and simple also.\n\n229\n00:11:00.440 --> 00:11:02.720\nSo it's not terribly detailed.\n\n230\n00:11:02.720 --> 00:11:04.750\nIf we want something terribly detailed,\n\n231\n00:11:04.750 --> 00:11:10.530\nwe need to move to our next\noption which is ntopng.\n\n232\n00:11:10.530 --> 00:11:11.060\nAll right.\n\n233\n00:11:11.060 --> 00:11:13.410\nNtop right ntop, the network top.\n\n234\n00:11:13.410 --> 00:11:16.390\nThat's an old Unix and\nLinux command that shows you who the top\n\n235\n00:11:16.390 --> 00:11:18.540\nconsumers of network\nbandwidth are in your system.\n\n236\n00:11:18.540 --> 00:11:19.480\nNtop.\n\n237\n00:11:19.480 --> 00:11:22.960\nNtopng is just the next generation,\nright, it's like Star Trek.\n\n238\n00:11:22.960 --> 00:11:27.680\nSo this is new and exciting and\nit does some really cool stuff.\n\n239\n00:11:27.680 --> 00:11:32.250\nWell, ntop is not installed by default,\nit's another package that we need to add.\n\n240\n00:11:32.250 --> 00:11:35.070\nIf you're running a nano install,\nI'm sorry but\n\n241\n00:11:35.070 --> 00:11:36.760\nntopng will not run on top of a nano.\n\n242\n00:11:36.760 --> 00:11:39.680\nYou actually have to have\nthe full version of pfSense.\n\n243\n00:11:39.680 --> 00:11:41.440\nSo if you go to your homepage.\n\n244\n00:11:41.440 --> 00:11:44.230\nAnd you're look in here for\nthis 2.2.3 release AMD 64.\n\n245\n00:11:44.230 --> 00:11:46.740\nIf your's says nanobsd in here,\n\n246\n00:11:46.740 --> 00:11:50.890\nthen you're not gonna be able to run ntop,\nall right?\n\n247\n00:11:50.890 --> 00:11:54.200\nSo that's kind of a limitation,\nor ntopng, right?\n\n248\n00:11:54.200 --> 00:11:55.970\nEvery pfSense firewall runs ntop.\n\n249\n00:11:55.970 --> 00:11:59.100\nIf you go to Status, or\nDiagnostics, there we go.\n\n250\n00:11:59.100 --> 00:12:02.050\nIf you go to Diagnostics and\nyou find pfTop.\n\n251\n00:12:02.050 --> 00:12:03.580\nAll right?\n\n252\n00:12:03.580 --> 00:12:07.250\nThat's their equivalent of just the basic\nnTop that you'd find in the Unix system,\n\n253\n00:12:07.250 --> 00:12:10.580\nand so it lays it out, and\nhere's your top communicators.\n\n254\n00:12:10.580 --> 00:12:12.830\nAll right?\nJust a simple chart that you can see,\n\n255\n00:12:12.830 --> 00:12:14.900\nand it doesn't necessarily\ngo back very far.\n\n256\n00:12:14.900 --> 00:12:19.110\nSo it's not a replacement for Bandwidth D,\nand yet, it's not very customizable, so\n\n257\n00:12:19.110 --> 00:12:22.010\nit's not a replacement for\nntopng either, it's kind of in between.\n\n258\n00:12:23.260 --> 00:12:25.740\nSo I need to install ntopng.\n\n259\n00:12:25.740 --> 00:12:29.770\nI'm gonna go up here to System and\nPackages, and\n\n260\n00:12:29.770 --> 00:12:34.438\nI'll go to available packages, and\nI'm going to hunt down the ntopng,\n\n261\n00:12:34.438 --> 00:12:38.460\nthere it is.\n\n262\n00:12:38.460 --> 00:12:39.870\nAlright, and I'm going to go ahead and\nadd this one in.\n\n263\n00:12:39.870 --> 00:12:42.580\nNow notice that it does have\na status of alpha, right,\n\n264\n00:12:42.580 --> 00:12:47.090\nthey're still in development, testing,\nand all that, so just be aware of that.\n\n265\n00:12:47.090 --> 00:12:48.280\nBut I'm going to go ahead and install it.\n\n266\n00:12:48.280 --> 00:12:53.220\nIt's going to install,\nwhich is exciting, and there it goes.\n\n267\n00:12:53.220 --> 00:12:55.290\nNow ntopng is a lot more heavyweight.\n\n268\n00:12:55.290 --> 00:12:56.500\nThan Bandwidth D.\n\n269\n00:12:56.500 --> 00:12:58.870\nSo, you can notice already\nthe installer is taking longer.\n\n270\n00:12:58.870 --> 00:13:00.388\nAnd that's because it's reaching out,\n\n271\n00:13:00.388 --> 00:13:02.655\ndownloading the package,\nthe package is large.\n\n272\n00:13:02.655 --> 00:13:06.955\nNtopng does create a CPU and\nmemory burden on your firewall.\n\n273\n00:13:06.955 --> 00:13:08.740\nNow, it creates a burden.\n\n274\n00:13:08.740 --> 00:13:10.440\nI don't mean it's like,\noverwhelming your firewall,\n\n275\n00:13:10.440 --> 00:13:12.680\nbut you need to pay attention to it.\n\n276\n00:13:12.680 --> 00:13:15.220\nIt will reduce the amount of\noverall available memory and\n\n277\n00:13:15.220 --> 00:13:17.160\nCPU available to the rest\nof your firewall.\n\n278\n00:13:17.160 --> 00:13:18.740\nIf you've got the hardware for\nit, it's no big deal.\n\n279\n00:13:18.740 --> 00:13:20.820\nYou run it.\nYou get a wealth of information out of it.\n\n280\n00:13:20.820 --> 00:13:23.590\nBut monitor your utilization.\n\n281\n00:13:23.590 --> 00:13:26.180\nLook at what your utilization is\nlike before you install it and\n\n282\n00:13:26.180 --> 00:13:27.450\nlook at it afterwards and\n\n283\n00:13:27.450 --> 00:13:31.030\njust make sure that you're not placing\ntoo much of a burden on your firewall.\n\n284\n00:13:32.450 --> 00:13:34.530\nAll right.\nThis thing's finishing its install here.\n\n285\n00:13:34.530 --> 00:13:36.320\nIt's setting up a separate web server.\n\n286\n00:13:36.320 --> 00:13:40.100\nIt's setting up a custom PHP install here,\ngetting itself set up, and\n\n287\n00:13:40.100 --> 00:13:43.750\nas soon as it's done,\nwe'll be able to access ntopng.\n\n288\n00:13:43.750 --> 00:13:45.280\nThere it goes.\n\n289\n00:13:45.280 --> 00:13:50.380\nNow that it's done, we can go up\nhere to services and, wait a minute.\n\n290\n00:13:50.380 --> 00:13:51.650\nThis one's not under services, is it?\n\n291\n00:13:51.650 --> 00:13:55.550\nThis one's buried under Status, shoot,\n\n292\n00:13:55.550 --> 00:13:57.018\neverything gets moved around\nin these different places.\n\n293\n00:13:57.018 --> 00:13:59.120\n>> [LAUGH]\n>> [LAUGH] I have to try and\n\n294\n00:13:59.120 --> 00:14:00.170\nfigure out where it's.\n\n295\n00:14:00.170 --> 00:14:00.940\n>> Diagnostics.\n\n296\n00:14:00.940 --> 00:14:01.810\n>> Diagnostics.\n\n297\n00:14:01.810 --> 00:14:02.980\nThere we go.\n\n298\n00:14:02.980 --> 00:14:06.730\nAnd under diagnostics I've got ntopng and\nntopng Settings.\n\n299\n00:14:06.730 --> 00:14:07.230\nAll right.\n\n300\n00:14:07.230 --> 00:14:09.800\nThat's the one that I'm looking for\nright there is the settings.\n\n301\n00:14:09.800 --> 00:14:12.320\nYou can't go into ntopng\nuntil you've set it up.\n\n302\n00:14:12.320 --> 00:14:14.050\nSo if I go into its settings.\n\n303\n00:14:14.050 --> 00:14:18.110\nWe can see a few different things\nto set like an admin password.\n\n304\n00:14:18.110 --> 00:14:22.210\nNtopNG is it's own webserver, and in\norder to get into it you have to log in.\n\n305\n00:14:22.210 --> 00:14:26.990\nIt's gonna create one user account, called\nAdmin and this is its password right here.\n\n306\n00:14:26.990 --> 00:14:28.150\nAll right?\n\n307\n00:14:28.150 --> 00:14:33.120\nOnce you're in, you can create\nmore user accounts just in ntopng.\n\n308\n00:14:33.120 --> 00:14:36.650\nRight, so somebody doesn't have to have\nfirewall admin access just to pull up\n\n309\n00:14:36.650 --> 00:14:37.640\ndiagnostics and logging.\n\n310\n00:14:37.640 --> 00:14:39.530\nIt's really useful if you want\nyour help desk to have access.\n\n311\n00:14:40.820 --> 00:14:43.500\nThen, the interfaces it's going to run on.\n\n312\n00:14:43.500 --> 00:14:45.970\nI'm just going to choose my LAN interface.\n\n313\n00:14:45.970 --> 00:14:49.500\nYou can hold control and\npick as many interfaces as you want.\n\n314\n00:14:49.500 --> 00:14:50.600\nThe DNS mode.\n\n315\n00:14:50.600 --> 00:14:54.240\nThe default is when there's IP addresses,\nit's going to try and resolve a name, so\n\n316\n00:14:54.240 --> 00:14:56.600\nwe get names instead of IPs,\nthat's kind of nice.\n\n317\n00:14:56.600 --> 00:14:58.710\nBut you can change that\nbehavior if you want.\n\n318\n00:14:59.950 --> 00:15:02.940\nIt can do geo location of IPs.\n\n319\n00:15:02.940 --> 00:15:06.590\nIt maintains a little data base for that\nand you can hit update geo IP data and\n\n320\n00:15:06.590 --> 00:15:08.750\nIt will download that latest data base for\nthat information.\n\n321\n00:15:10.390 --> 00:15:13.220\nWe can choose what's\nconsidered a local network.\n\n322\n00:15:13.220 --> 00:15:16.650\nIt's got a, you know, whether we want\nto just treat all our FC 19 networks or\n\n323\n00:15:16.650 --> 00:15:18.100\nif we want to specify particular ones.\n\n324\n00:15:19.210 --> 00:15:21.790\nYou can choose whether you're\nstoring historical data.\n\n325\n00:15:21.790 --> 00:15:25.050\nIn other words, do you log to ram,\nor log to the hard drive?\n\n326\n00:15:25.050 --> 00:15:27.610\nAnd a lot of times we want to log to\nour hard drive if we have the space.\n\n327\n00:15:28.650 --> 00:15:30.810\nThen if you want any kind of alerting.\n\n328\n00:15:30.810 --> 00:15:32.730\nI'm not going to turn on alerting,\nI'll just leave that empty,\n\n329\n00:15:32.730 --> 00:15:34.670\nand I'll go ahead and hit change.\n\n330\n00:15:34.670 --> 00:15:37.960\nNow, that's going to apply\nthe change to ntopng.\n\n331\n00:15:37.960 --> 00:15:39.670\nAnd now I'm ready to rock, right?\n\n332\n00:15:39.670 --> 00:15:41.620\nWell, as soon as it's done\napplying that change,\n\n333\n00:15:41.620 --> 00:15:44.910\nI do wanna update my Geo IP information,\nso I'm gonna do that.\n\n334\n00:15:44.910 --> 00:15:47.810\nThe reason I didn't click it there is I\ndon't wanna lose the changes I made, so\n\n335\n00:15:47.810 --> 00:15:50.505\nI need to hit Change first,\nand then update it.\n\n336\n00:15:50.505 --> 00:15:52.145\nNow it does take a moment.\n\n337\n00:15:52.145 --> 00:15:55.475\nNtopng is not necessarily the fastest\nthing in the world because it's fairly\n\n338\n00:15:55.475 --> 00:15:56.465\ncomplex.\n\n339\n00:15:56.465 --> 00:16:01.055\nThis is running right now on a quad\ncore intel I7, so it's got plenty of\n\n340\n00:16:01.055 --> 00:16:05.281\nCPU power and it still took a moment\nthere to just be Aware of that.\n\n341\n00:16:05.281 --> 00:16:10.406\nOkay, I'm gonna update my\ngeo IP data real quick.\n\n342\n00:16:10.406 --> 00:16:13.007\nIt's just reaching out to an internet site\nthat has open source geo IP information\n\n343\n00:16:13.007 --> 00:16:14.870\nand downloading that to the database.\n\n344\n00:16:14.870 --> 00:16:19.590\nAnd when that's done we will be ready\nto use this tab to access ntopng.\n\n345\n00:16:19.590 --> 00:16:23.661\nNow when we access BandwidthD it was just\na sub folder under the IP address of\n\n346\n00:16:23.661 --> 00:16:27.356\nour firewall, but ntopng is actually\nrunning on a different port.\n\n347\n00:16:27.356 --> 00:16:31.767\nYou can see at the bottom of my screen,\nit's going to go to my firewalls IP,\n\n348\n00:16:31.767 --> 00:16:32.966\ncolon, 3000.\n\n349\n00:16:32.966 --> 00:16:35.948\nSo it's on port 3000 of this firewall, and\n\n350\n00:16:35.948 --> 00:16:39.312\npeople can browse through that,\nand access ntopng.\n\n351\n00:16:39.312 --> 00:16:43.450\nAll right, when we got to access it,\nit's going to jump over to that page.\n\n352\n00:16:43.450 --> 00:16:47.470\nAnd much like BandwidthD,\nthe webpage that I'm about to see is not,\n\n353\n00:16:47.470 --> 00:16:51.000\nis apparently not gonna come up, but\nis not terribly informational, right?\n\n354\n00:16:51.000 --> 00:16:53.970\nWhen ntop first comes up it\ndoesn't have a ton of data.\n\n355\n00:16:53.970 --> 00:16:56.590\nSo I'm gonna switch this\nover to production firewall\n\n356\n00:16:56.590 --> 00:16:59.730\nwhere I can show you guys\nsome actual real data.\n\n357\n00:16:59.730 --> 00:17:04.940\nSo if I go here and\nI'll go to my ntop screen.\n\n358\n00:17:04.940 --> 00:17:07.380\nHere's the first log in screen\nthat we'd normally expect.\n\n359\n00:17:07.380 --> 00:17:10.775\nAnd you'd punch in the password\nthat you set, and you'd log in.\n\n360\n00:17:10.775 --> 00:17:13.260\nAnd this is the home screen for ntop.\n\n361\n00:17:13.260 --> 00:17:17.570\nIt starts off by showing us our top flow\ntalkers, and here's where it gets really\n\n362\n00:17:17.570 --> 00:17:22.410\ncool, because on the left side,\nI see 10.1.230.5, that same encoder box.\n\n363\n00:17:22.410 --> 00:17:24.260\nThat's my number one talker.\n\n364\n00:17:24.260 --> 00:17:27.950\nAnd then on the right side,\nI see the flows.\n\n365\n00:17:27.950 --> 00:17:30.420\nThat one talker's talking\nto four different people.\n\n366\n00:17:30.420 --> 00:17:34.630\nI can see these four different Amazon AWS\nhosts that is reaching out to and\n\n367\n00:17:34.630 --> 00:17:35.580\ntalking to them.\n\n368\n00:17:35.580 --> 00:17:38.540\nSo, and a fifth one just appeared,\nthat IP, and\n\n369\n00:17:38.540 --> 00:17:40.220\nit's gonna do a name\nlookup in the background.\n\n370\n00:17:40.220 --> 00:17:43.220\nSo there it goes, it just updated,\nthere's our video CDN, right, so\n\n371\n00:17:43.220 --> 00:17:45.450\nit's probably streaming our show.\n\n372\n00:17:45.450 --> 00:17:47.480\nSo you'll see these things pop up.\n\n373\n00:17:47.480 --> 00:17:51.620\nNow not only do I know who the top talker\nis, I know who they're talking to.\n\n374\n00:17:51.620 --> 00:17:54.750\nAnd if I keep scrolling down,\nI'll see other ones listed.\n\n375\n00:17:54.750 --> 00:17:56.410\nIf I have other people\nthat are measuring up,\n\n376\n00:17:56.410 --> 00:17:59.960\nthis guy's apparently way above everybody\nelse because nobody else is showing up.\n\n377\n00:17:59.960 --> 00:18:02.640\nNow, I'm glad I scrolled down,\nbecause see this message right here.\n\n378\n00:18:02.640 --> 00:18:05.870\nA new ntopng version,\nversion 2 is available for download.\n\n379\n00:18:05.870 --> 00:18:06.448\nPlease upgrade.\n\n380\n00:18:06.448 --> 00:18:09.170\nBe careful with that.\n\n381\n00:18:09.170 --> 00:18:14.102\nIt's talking about ntopng that you'd\nrun on a regular Linux server,\n\n382\n00:18:14.102 --> 00:18:16.560\nnot the pfSense package.\n\n383\n00:18:16.560 --> 00:18:20.770\nIf you go into the pfSense package store,\nI installed the latest version.\n\n384\n00:18:20.770 --> 00:18:23.670\nSo, there's not an update\nof the pfSense package.\n\n385\n00:18:23.670 --> 00:18:27.470\nIf you were to try to update this,\nit's not tested for pfSense yet\n\n386\n00:18:27.470 --> 00:18:28.630\nand it may break things.\n\n387\n00:18:28.630 --> 00:18:31.310\nSo, we can actually disregard\nthat upgrade notice.\n\n388\n00:18:31.310 --> 00:18:34.190\nBut I do see some other data, like right\nhere I can see my current bandwidth.\n\n389\n00:18:34.190 --> 00:18:37.530\nI'm pushing, looks like,\nbetween 8 and 42 megabits of data.\n\n390\n00:18:37.530 --> 00:18:39.000\nIt's kind of fluctuating.\n\n391\n00:18:39.000 --> 00:18:40.290\nI can see my uptime.\n\n392\n00:18:40.290 --> 00:18:42.220\nThis one's been up for 13 hours.\n\n393\n00:18:42.220 --> 00:18:48.023\nI can see I've got 371 hosts on this\nnetwork with 660-some-odd flows going on.\n\n394\n00:18:48.023 --> 00:18:50.946\nThat's a lot of traffic and\nthis is all within our studio,\n\n395\n00:18:50.946 --> 00:18:52.800\nwhich is kind of impressive.\n\n396\n00:18:52.800 --> 00:18:57.340\nBut if we go up here to Hosts,\nwe can start to see that breakdown.\n\n397\n00:18:57.340 --> 00:19:02.610\nAnd what you'll see is that ntopng treats\ninternal and external hosts the same.\n\n398\n00:19:02.610 --> 00:19:06.240\nSo here in our network in the studio\nwe have maybe 30 computers.\n\n399\n00:19:06.240 --> 00:19:08.540\nBut we're talking to people\nout there on the internet, and\n\n400\n00:19:08.540 --> 00:19:11.495\nthat's why we're over 300 for\nthe amount of hosts that it's tracking.\n\n401\n00:19:11.495 --> 00:19:15.508\nAnd you can see 10.1.230.5 is\nresponsible for 75% of our send and\n\n402\n00:19:15.508 --> 00:19:16.983\nreceive traffic right now.\n\n403\n00:19:16.983 --> 00:19:18.057\n>> Impressive.\n\n404\n00:19:18.057 --> 00:19:24.980\n>> Yeah, You got 10.1.230.90 at 8.1%,\nI actually have no idea who that is.\n\n405\n00:19:24.980 --> 00:19:28.460\nAnd then [LAUGH] we've got\n16.2% is everybody else.\n\n406\n00:19:28.460 --> 00:19:29.800\nSo if your network is running slow and\n\n407\n00:19:29.800 --> 00:19:32.730\nyou want to know who's consuming\nthe bandwidth, here's the guy, right?\n\n408\n00:19:32.730 --> 00:19:35.710\nThis one, whatever he's doing right\nnow is consuming our bandwidth.\n\n409\n00:19:37.420 --> 00:19:41.370\nAnd then if we continue to break this\ndown, you can go to applications.\n\n410\n00:19:41.370 --> 00:19:42.212\nWhat program is it?\n\n411\n00:19:42.212 --> 00:19:45.730\nWell, DropBox at 44.9%.\n\n412\n00:19:45.730 --> 00:19:48.315\nSo, that's a pretty good\nindicator that that system has\n\n413\n00:19:48.315 --> 00:19:51.010\nDropBox configured on it and\nit's syncing data up to it.\n\n414\n00:19:51.010 --> 00:19:54.822\nAnd it's consuming a ton of traffic which\nI'm kinda glad we pulled this up Ronnie\n\n415\n00:19:54.822 --> 00:19:58.312\nbecause we used drop box for a little\nwhile here for backing up our videos.\n\n416\n00:19:58.312 --> 00:20:01.084\nWe use something different now we should\nprobably disable that we can save some\n\n417\n00:20:01.084 --> 00:20:01.847\nserious bandwidth.\n\n418\n00:20:01.847 --> 00:20:02.828\n>> Yeah.\n\n419\n00:20:02.828 --> 00:20:05.280\n>> Adobe Flash at 34%.\n\n420\n00:20:05.280 --> 00:20:06.850\nWell that's our video stream, right.\n\n421\n00:20:06.850 --> 00:20:09.150\nWe stream in RTMP which\nis an Adobe protocol.\n\n422\n00:20:09.150 --> 00:20:13.920\nYou'll see Skype, sitting there at\n7.5% that's pretty impressive not sure\n\n423\n00:20:13.920 --> 00:20:15.920\nwho's using Skype here.\n\n424\n00:20:15.920 --> 00:20:21.022\nWe've got HTTP traffic, SSL and other,\na quick break down of where that is and\n\n425\n00:20:21.022 --> 00:20:24.212\nwe can use if for\ntroubleshooting information.\n\n426\n00:20:24.212 --> 00:20:27.164\nWe've got ASNs, which are hosts\nthat we're reaching out and\n\n427\n00:20:27.164 --> 00:20:28.890\ntalking to kind of laying that out.\n\n428\n00:20:28.890 --> 00:20:32.900\nAnd you'll see we've got this\nlocal/unknown accounting for\n\n429\n00:20:32.900 --> 00:20:34.420\nmost of this, so\nit's not able to identify it.\n\n430\n00:20:34.420 --> 00:20:37.060\nAnd it's really hard to see these\nguys cuz they're so small, but again,\n\n431\n00:20:37.060 --> 00:20:39.550\nidentifying the ports and\nthe host that we're talking to.\n\n432\n00:20:40.650 --> 00:20:41.440\nAnd then senders.\n\n433\n00:20:41.440 --> 00:20:45.130\nWho's sending the most data, which we\nkind of see this consistent pattern.\n\n434\n00:20:45.130 --> 00:20:48.344\nFor the inside hosts, that 10.1.230.5.\n\n435\n00:20:48.344 --> 00:20:51.630\nBut here's the outside,\nsomebody's sending in.\n\n436\n00:20:51.630 --> 00:20:53.290\nAnd so they kind of register here.\n\n437\n00:20:54.890 --> 00:20:57.330\nThe Flows screen is probably\nthe most useful, though.\n\n438\n00:20:57.330 --> 00:21:01.190\nWhen you flip over to Flows,\nhere's where you get the real breakdown.\n\n439\n00:21:01.190 --> 00:21:05.970\nI can see who's talking to who,\nwhat protocol they're using and whether\n\n440\n00:21:05.970 --> 00:21:10.600\nthey're sending more or receiving more,\nthe client and server side of things.\n\n441\n00:21:10.600 --> 00:21:12.410\nSo you really get that break down, and\n\n442\n00:21:12.410 --> 00:21:15.500\nthe total bandwidth they\npush in that communication.\n\n443\n00:21:15.500 --> 00:21:17.490\nSo when we start to break this down,\n\n444\n00:21:17.490 --> 00:21:20.276\nyou can really find a lot of\ninteresting stuff in here.\n\n445\n00:21:20.276 --> 00:21:26.030\nSo that 10.1.230.5 we see that break down\nof all that people that are talking to and\n\n446\n00:21:26.030 --> 00:21:26.740\nexactly what it is.\n\n447\n00:21:26.740 --> 00:21:29.880\nSo here's those DropBox\ncommunications that are going on and\n\n448\n00:21:29.880 --> 00:21:31.420\nyou can see the amount\nof traffic throughput.\n\n449\n00:21:31.420 --> 00:21:34.140\nWhich really at the end of the day it's\nnot that much, looks like about a gig and\n\n450\n00:21:34.140 --> 00:21:35.330\na half of data.\n\n451\n00:21:35.330 --> 00:21:40.220\nVersus this Adobe Flash connection\nwhich also is over a gig of data, but\n\n452\n00:21:40.220 --> 00:21:43.030\npushed all to a single destination.\n\n453\n00:21:43.030 --> 00:21:45.320\nThat's the kind of stuff\nwe see broken down in here.\n\n454\n00:21:45.320 --> 00:21:46.630\nAnd this is customizable.\n\n455\n00:21:46.630 --> 00:21:48.470\nYou can filter by application.\n\n456\n00:21:48.470 --> 00:21:49.910\nYou can filter by host.\n\n457\n00:21:49.910 --> 00:21:53.635\nThere's all sorts of data that you can\nchoose to turn on or off in the table.\n\n458\n00:21:53.635 --> 00:21:57.650\nntopng is very powerful as far as letting\nyou see what's going on in there.\n\n459\n00:22:00.330 --> 00:22:03.483\nOther things we can do,\nwe can pull up our interface screens and\n\n460\n00:22:03.483 --> 00:22:05.222\nwe can break down that interface.\n\n461\n00:22:05.222 --> 00:22:07.792\nSo I can see this interface\nhas been responsible for\n\n462\n00:22:07.792 --> 00:22:09.870\nmoving 82 gigs of data today.\n\n463\n00:22:09.870 --> 00:22:14.150\nThe received packets right there, dropped\npackets, so if it's getting overloaded.\n\n464\n00:22:14.150 --> 00:22:19.340\nYou can break it down by packet,\nby protocol and historical activity.\n\n465\n00:22:19.340 --> 00:22:23.190\nSo you can see what's considered\nnormal for this interface, right?\n\n466\n00:22:23.190 --> 00:22:26.560\nAnd it breaks all that down and\nyou can kinda see information over time.\n\n467\n00:22:26.560 --> 00:22:29.710\nThis is all being stored in a database, so\nit's really useful for troubleshooting at\n\n468\n00:22:29.710 --> 00:22:34.550\ndifferent times and seeing when your\npeaks and valleys are in traffic.\n\n469\n00:22:34.550 --> 00:22:35.770\nAnd you can spread this out.\n\n470\n00:22:35.770 --> 00:22:37.770\nMaybe I want to see the last six hours.\n\n471\n00:22:37.770 --> 00:22:38.870\nAnd so here's my last six hours.\n\n472\n00:22:38.870 --> 00:22:40.780\nYou can see where I turned on ntop.\n\n473\n00:22:40.780 --> 00:22:43.010\nI turned it on in the middle of the night\nwhen the traffic was doing nothing.\n\n474\n00:22:43.010 --> 00:22:46.270\nAnd then this morning, we start to see\nthat traffic start to spike, right?\n\n475\n00:22:46.270 --> 00:22:48.210\nSo this is actually,\nright here is 7:57 am,\n\n476\n00:22:48.210 --> 00:22:51.810\nwhich is about when we all\nstart showing up at the office.\n\n477\n00:22:51.810 --> 00:22:53.770\nAnd then you just start\nto seeing this spike.\n\n478\n00:22:53.770 --> 00:22:58.250\nAs we start to work and turn the shows\non and all that other stuff.\n\n479\n00:22:58.250 --> 00:23:01.580\nOur show started at 9:30 today so\nsomewhere in here,\n\n480\n00:23:01.580 --> 00:23:04.460\nwe really didn't see a whole lot\nof traffic when the show started.\n\n481\n00:23:04.460 --> 00:23:06.630\nBut yeah, so you can break all that down,\nreally handy stuff.\n\n482\n00:23:07.660 --> 00:23:10.940\nAnd then under Admin, here's where\nyou can go to Manage Users and\n\n483\n00:23:10.940 --> 00:23:12.820\nyou can add user accounts for\nother people.\n\n484\n00:23:12.820 --> 00:23:14.380\nSo if you have your help desk and\n\n485\n00:23:14.380 --> 00:23:17.370\nyou want them to be able to login to see\nthis information, you can punch it in.\n\n486\n00:23:17.370 --> 00:23:19.290\nNow they can login and get that.\n\n487\n00:23:19.290 --> 00:23:21.860\nSo, ntopng, very powerful.\n\n488\n00:23:21.860 --> 00:23:25.070\nDoes create some load though, so\ndefinitely keep an eye on that, right?\n\n489\n00:23:25.070 --> 00:23:29.700\nGo back to your firewall screen and\nwatch that processor load.\n\n490\n00:23:29.700 --> 00:23:33.970\nIf I go back to my dashboard,\nyou've got your memory buffer,\n\n491\n00:23:33.970 --> 00:23:35.850\nyour state table, and so on.\n\n492\n00:23:35.850 --> 00:23:38.690\nMake sure you're not exceeding\nany of those numbers because\n\n493\n00:23:38.690 --> 00:23:40.810\nif you are performance is\ngonna drop on my system.\n\n494\n00:23:40.810 --> 00:23:45.294\nNow I can see here my CPU utilization,\nI have to wait ten seconds, I'm at 11%.\n\n495\n00:23:46.930 --> 00:23:51.690\nWould I be at 11% if I wasn't running ntop\nand BandwidthD, and these other guys?\n\n496\n00:23:51.690 --> 00:23:53.010\nIt's hard to say.\n\n497\n00:23:53.010 --> 00:23:54.310\nWe can always remove them or\n\n498\n00:23:54.310 --> 00:23:57.580\nstop them, and\nthen see what happens from there right?\n\n499\n00:23:57.580 --> 00:24:00.110\nSo like if I got to, let's see,\n\n500\n00:24:00.110 --> 00:24:04.730\nStatus and Services, and\nwe take BandwidthD I'll just stop it.\n\n501\n00:24:06.110 --> 00:24:10.180\nAnd then after it stops,\nI'll take ntopd, and I'll stop it also.\n\n502\n00:24:10.180 --> 00:24:15.230\nSo when I stop those services, let's find\nntopng, let make sure I get the right one.\n\n503\n00:24:15.230 --> 00:24:16.765\nI don't wanna stop\nsomething truly important.\n\n504\n00:24:16.765 --> 00:24:18.390\n>> [LAUGH]\n>> So when I stop those services,\n\n505\n00:24:18.390 --> 00:24:22.070\nI can then look at the performance and\nsay, is it now different, right?\n\n506\n00:24:22.070 --> 00:24:24.390\nSo I was averaging 11% CPU a moment ago.\n\n507\n00:24:24.390 --> 00:24:27.720\nNow that I've stopped those,\nif I go back to my dashboard.\n\n508\n00:24:29.210 --> 00:24:31.695\nAnd I'll have to wait a moment for\nthis CPU to update.\n\n509\n00:24:31.695 --> 00:24:34.420\nAm I'm running a little better, right?\n\n510\n00:24:34.420 --> 00:24:38.770\nAnd if I am, now I know the impact of\nthose two were creating on this firewall\n\n511\n00:24:38.770 --> 00:24:40.520\nand so I'm gonna wait patiently.\n\n512\n00:24:40.520 --> 00:24:41.900\nThere you go, I'm at 8%.\n\n513\n00:24:41.900 --> 00:24:46.681\nSo, ntopng created a 3%\nCPU overhead on my system.\n\n514\n00:24:46.681 --> 00:24:50.550\nNow, I've obviously got the room,\nI'm only at 8% right now.\n\n515\n00:24:50.550 --> 00:24:51.740\nFine, turn it on.\n\n516\n00:24:51.740 --> 00:24:54.800\nBut just be aware that\nthere is a resource burden\n\n517\n00:24:54.800 --> 00:24:55.939\nplaced on your system when you turn it on.\n\n518\n00:24:57.390 --> 00:25:00.780\n>> Now Don, there's a lot of\nmonitoring that we just looked at here.\n\n519\n00:25:00.780 --> 00:25:03.180\nIt gives us the ability to take\na look at our firewall and\n\n520\n00:25:03.180 --> 00:25:07.030\nsee everything that's going on, not only\non it as far as traffic moving through it.\n\n521\n00:25:07.030 --> 00:25:09.570\nBut we have the ability to have\nthat little BandwidthD that gives\n\n522\n00:25:09.570 --> 00:25:11.180\na summary of information.\n\n523\n00:25:11.180 --> 00:25:14.460\nNot as detailed, but\nthen we can go the ntopng,\n\n524\n00:25:14.460 --> 00:25:18.360\nthat next generation one, and see pretty\nmuch anything that we need to see in\n\n525\n00:25:18.360 --> 00:25:22.090\nthe way that our network management and\ntraffic's going through that.\n\n526\n00:25:22.090 --> 00:25:25.630\nSo Don, I can't think of anything\nelse we need to add in there.\n\n527\n00:25:25.630 --> 00:25:28.860\n>> Yeah, I mean, there is a lot more power\nin there if you dig deep into it but for\n\n528\n00:25:28.860 --> 00:25:30.920\nbasic monitoring your\nsystem it's pretty simple.\n\n529\n00:25:30.920 --> 00:25:31.560\nYou just turn it on.\n\n530\n00:25:31.560 --> 00:25:33.490\nThose are two of the big\noptions that are out there.\n\n531\n00:25:33.490 --> 00:25:35.090\nThere are other options.\n\n532\n00:25:35.090 --> 00:25:36.996\nYou don't have to monitor\nfrom within the firewall.\n\n533\n00:25:36.996 --> 00:25:39.290\nYou can use third party software.\n\n534\n00:25:39.290 --> 00:25:42.530\nPaid software like\nSolar Winds Network Performance Monitor.\n\n535\n00:25:42.530 --> 00:25:46.440\nThere's free software like Nagios or MRTG.\n\n536\n00:25:46.440 --> 00:25:48.010\nYou can fire up Cacti.\n\n537\n00:25:48.010 --> 00:25:51.140\nThere's all sorts of different ways\nyou can monitor their, Zabbix.\n\n538\n00:25:51.140 --> 00:25:54.160\nZabbix even has packages for\nagents on pfSense.\n\n539\n00:25:54.160 --> 00:25:55.830\nThey directly support it.\n\n540\n00:25:55.830 --> 00:25:56.820\nThey're open source, so\n\n541\n00:25:56.820 --> 00:25:59.990\nthere's a lot of great ways to\nmonitor with external systems.\n\n542\n00:25:59.990 --> 00:26:03.315\nBut if you want to monitor from\nthe firewall itself, BandwidthD and\n\n543\n00:26:03.315 --> 00:26:05.010\nntopng those are kind of our go-to guys.\n\n544\n00:26:06.380 --> 00:26:10.046\n>> All right, well,\nthat's all that we have for our monitoring\n\n545\n00:26:10.046 --> 00:26:14.147\nof our pfSense firewall today Stay\ntuned for more pfSense firewall.\n\n546\n00:26:14.147 --> 00:26:19.720\n[MUSIC]\n\n",
          "vimeoId": "132253661"
        },
        {
          "description": null,
          "length": "804",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-5-updating_pfsense-061115-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-5-updating_pfsense-061115-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-6-5-updating_pfsense-061115-1-sm.jpg",
          "title": "Updating pfSense",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:06.694\n[MUSIC]\n\n2\n00:00:06.694 --> 00:00:11.082\n>> In this segment we're gonna take\na look at upgrading our pfSense firewall.\n\n3\n00:00:11.082 --> 00:00:15.164\nNow the guys over at the pfSense\norganization, they are constantly coming\n\n4\n00:00:15.164 --> 00:00:19.336\nup with new improvements, bug fixes,\nnew features, security hot fixes.\n\n5\n00:00:19.336 --> 00:00:23.633\nThey are really important for us to get in\nplace on our firewall as soon as we can.\n\n6\n00:00:23.633 --> 00:00:27.404\nNow, when you do your upgrades,\nthere are development releases and\n\n7\n00:00:27.404 --> 00:00:31.184\nnon-stable branches that really\ndon't recommend most of you run.\n\n8\n00:00:31.184 --> 00:00:32.914\nDefinitely not suitable for production.\n\n9\n00:00:32.914 --> 00:00:36.207\nBut on the production side,\nwhen updates come out of pfSense,\n\n10\n00:00:36.207 --> 00:00:39.139\nthey're typically ready to\nbe launched immediately.\n\n11\n00:00:39.139 --> 00:00:41.955\nThey're designed for\ndefinite testing, approval,\n\n12\n00:00:41.955 --> 00:00:45.009\nget it thrown out there and\nget it in place as soon as you can,\n\n13\n00:00:45.009 --> 00:00:48.522\nbecause they're typically fixing\nsome kind of security exploit.\n\n14\n00:00:48.522 --> 00:00:50.066\nYou don't want to leave\nthat laying around.\n\n15\n00:00:50.066 --> 00:00:53.190\nFortunately, they make it pretty easy for\nus.\n\n16\n00:00:53.190 --> 00:00:57.157\nPfSense is hosted on a number of different\nmirrors out there on the internet and our\n\n17\n00:00:57.157 --> 00:01:01.254\nfirewall checks in with those mirrors from\ntime to time to see if there's an update.\n\n18\n00:01:01.254 --> 00:01:04.028\nAnd it actually happens every\ntime you go to your home page.\n\n19\n00:01:04.028 --> 00:01:05.782\nLet me show you, for example,\nhere on my firewall.\n\n20\n00:01:05.782 --> 00:01:09.427\nI've got a firewall that's\nrunning 2.2 release.\n\n21\n00:01:09.427 --> 00:01:15.470\nNow it was built on Thursday,\nJanuary 22nd and that was six months ago.\n\n22\n00:01:15.470 --> 00:01:18.000\nWell, by the time this episode\nis filmed it was six months ago.\n\n23\n00:01:18.000 --> 00:01:20.261\nThat's old.\nThere have more than likely been updates\n\n24\n00:01:20.261 --> 00:01:20.940\nsince then.\n\n25\n00:01:20.940 --> 00:01:24.924\nWell, when you first come to the home\npage, you'll see a message right here.\n\n26\n00:01:24.924 --> 00:01:26.990\nObtaining update status.\n\n27\n00:01:26.990 --> 00:01:29.846\nIt's reaching out to the internet to see,\nif there's any updates.\n\n28\n00:01:29.846 --> 00:01:33.470\nAnd if there are, the message\nwill change to update available,\n\n29\n00:01:33.470 --> 00:01:35.225\nclick here to view the update.\n\n30\n00:01:35.225 --> 00:01:38.113\nThat's our visual notice\nthat there's an update and\n\n31\n00:01:38.113 --> 00:01:39.854\nwe should do it as soon as we can.\n\n32\n00:01:39.854 --> 00:01:42.674\nAnd if you click on that\nclick here to view update,\n\n33\n00:01:42.674 --> 00:01:45.420\nit'll tell you the new version number.\n\n34\n00:01:45.420 --> 00:01:50.467\nI'm running 2.2, but\nnow there's a 2.2.2 that's been updated.\n\n35\n00:01:50.467 --> 00:01:53.287\nIt's showing where it's\ngetting that update from.\n\n36\n00:01:53.287 --> 00:01:56.457\nI can see mine's getting it\nsecurely from the pfSense web page.\n\n37\n00:01:56.457 --> 00:01:58.199\nSo there's an update that's available.\n\n38\n00:01:58.199 --> 00:02:00.939\nI can reach out and get it, if I want.\n\n39\n00:02:00.939 --> 00:02:05.246\nNow before I do that, I probably\nwanna go and read the release notes.\n\n40\n00:02:05.246 --> 00:02:09.297\nAnd when you go to pfsense.org,\nright on their website, they've got\n\n41\n00:02:09.297 --> 00:02:13.969\ninformation that is available to let you\nsee what updates are out and what's new.\n\n42\n00:02:13.969 --> 00:02:18.027\nIf you go to the download link and\nyou find like an install or whatever right\n\n43\n00:02:18.027 --> 00:02:22.360\nbeneath that, they've got this for\na previous list of versions or whatever.\n\n44\n00:02:22.360 --> 00:02:24.820\nSee the release category?\n\n45\n00:02:24.820 --> 00:02:26.276\nThat's the release category of their blog.\n\n46\n00:02:26.276 --> 00:02:30.310\nAnd every time they do a release,\nthey put a blog notice up about it and\n\n47\n00:02:30.310 --> 00:02:33.243\nit tells you what's new and\nI'm running 2.2.\n\n48\n00:02:33.243 --> 00:02:38.352\nSo if I scroll down to 2.2,\nwhich is down here somewhere.\n\n49\n00:02:38.352 --> 00:02:39.129\nThere, that's what I'm running.\n\n50\n00:02:39.129 --> 00:02:43.033\nI would need to look at\nwhat changed in 2.2.1 and\n\n51\n00:02:43.033 --> 00:02:48.461\nwhat changed in 2.2.2,\ncuz I'm gonna get both of those together.\n\n52\n00:02:48.461 --> 00:02:52.063\nAnd you will see there are Security Fixes\nfor a number of exploits,\n\n53\n00:02:52.063 --> 00:02:54.323\nthere's some new features or whatever.\n\n54\n00:02:54.323 --> 00:02:58.850\nHere's just general Bug Fixes that have\nbeen put in place, and Upgrade Guidance.\n\n55\n00:02:58.850 --> 00:03:00.685\nSome warnings here.\n\n56\n00:03:00.685 --> 00:03:03.253\nBecause if you're running\na really old version of pfSense,\n\n57\n00:03:03.253 --> 00:03:05.731\nyou might not be able to upgrade\nstraight to this version.\n\n58\n00:03:05.731 --> 00:03:07.148\nThat might not be possible.\n\n59\n00:03:07.148 --> 00:03:11.332\nOr occasionally, there's updates\nyou can't do via the web UI and\n\n60\n00:03:11.332 --> 00:03:14.783\nyou actually have to go to\nthe console of the firewall.\n\n61\n00:03:14.783 --> 00:03:18.071\nOn the console menu of the firewall,\nyou'll see there's an option in here.\n\n62\n00:03:18.071 --> 00:03:19.906\nLet me see if I can spot it, right here.\n\n63\n00:03:19.906 --> 00:03:21.427\nUpgrade from console.\n\n64\n00:03:21.427 --> 00:03:24.352\nAnd if you're far enough back,\nyou might have to do that.\n\n65\n00:03:24.352 --> 00:03:27.175\nAnd that's where you provided\nthe information right here via the command\n\n66\n00:03:27.175 --> 00:03:28.870\nline and it goes and\nit applies the updates.\n\n67\n00:03:29.930 --> 00:03:32.448\nEven still if you have a really\nold version of pfSense,\n\n68\n00:03:32.448 --> 00:03:35.845\nyou might just need to backup your\nconfiguration, format the firewall,\n\n69\n00:03:35.845 --> 00:03:38.720\ninstall the new version and\nimport your configuration back.\n\n70\n00:03:38.720 --> 00:03:42.284\nIt really stinks to do that, but that\nwould really only happen if maybe you went\n\n71\n00:03:42.284 --> 00:03:45.751\nto work somewhere and they had firewalls\npeople hadn't been maintaining.\n\n72\n00:03:45.751 --> 00:03:48.785\nSo you'd really have to neglect\nyour equipment for that to occur.\n\n73\n00:03:50.145 --> 00:03:53.208\nMost of the time though,\nit's just a matter of coming in here and\n\n74\n00:03:53.208 --> 00:03:54.581\ntelling it to do the update.\n\n75\n00:03:54.581 --> 00:03:57.818\nNow, you've got your\nUpdater Settings right here.\n\n76\n00:03:57.818 --> 00:04:01.248\nIf I go to Updater Settings,\nwe can see some basic information,\n\n77\n00:04:01.248 --> 00:04:04.005\nwe can change about how the updater works.\n\n78\n00:04:04.005 --> 00:04:05.659\nSo, who do I update from?\n\n79\n00:04:05.659 --> 00:04:09.002\nAnd usually,\nwe want that to pull from pfSense.\n\n80\n00:04:09.002 --> 00:04:11.698\nBut you'll see I could actually\nswitch over to the 32-bit one,\n\n81\n00:04:11.698 --> 00:04:12.670\nif I wanted to go crazy.\n\n82\n00:04:12.670 --> 00:04:13.587\nIt's not a good idea.\n\n83\n00:04:13.587 --> 00:04:18.011\nYou'll see down here, where you can\ndo Firmware Auto Update URLs and\n\n84\n00:04:18.011 --> 00:04:20.768\nyou can specify a destination of your own.\n\n85\n00:04:20.768 --> 00:04:27.240\nMaybe you have 500 firewalls and you\nhave 20 of them that are your test bed.\n\n86\n00:04:27.240 --> 00:04:30.721\nYou can take those 20 and point them\nat a local URL or at the Internet, so\n\n87\n00:04:30.721 --> 00:04:32.163\nthey get updates right away.\n\n88\n00:04:32.163 --> 00:04:35.669\nBut then take the other 480 and\npoint them to your own server and\n\n89\n00:04:35.669 --> 00:04:39.637\nwhen you're ready for the update to\nrollout, you throw it on own server.\n\n90\n00:04:39.637 --> 00:04:43.809\nAnd now they get that update, so you can\ndo a controlled rollout of new versions.\n\n91\n00:04:45.060 --> 00:04:47.233\nYou can also choose whether you\nwanna allow unsigned images.\n\n92\n00:04:47.233 --> 00:04:50.101\nIf you're modifying the images and\ncompiling them yourselves,\n\n93\n00:04:50.101 --> 00:04:52.248\nyou probably don't wanna\ndo a signature check.\n\n94\n00:04:52.248 --> 00:04:54.411\nWell, unless you're going\nto sign them yourselves, so\n\n95\n00:04:54.411 --> 00:04:55.682\nyou can turn that off to allow it.\n\n96\n00:04:55.682 --> 00:04:59.202\nAnd then if you just hate that dashboard\ncheck bugging you about new updates,\n\n97\n00:04:59.202 --> 00:05:00.404\nyou can turn that off too.\n\n98\n00:05:00.404 --> 00:05:02.447\nSo now you don't get the message about it.\n\n99\n00:05:02.447 --> 00:05:04.944\nWe can do a Manual Update.\n\n100\n00:05:04.944 --> 00:05:08.375\nIf we go to Manual Update,\nsee how we can enable firmware upload and\n\n101\n00:05:08.375 --> 00:05:10.107\nwe can upload a particular file.\n\n102\n00:05:10.107 --> 00:05:11.129\nI'm running 2.2.\n\n103\n00:05:11.129 --> 00:05:16.040\n2.2.1 came out, but\nI missed it and now 2.2.2 is out.\n\n104\n00:05:16.040 --> 00:05:18.315\nWell, maybe I wanna go to 2.2.1.\n\n105\n00:05:18.315 --> 00:05:21.309\nThe automatic updater won't let me\ndo that it will automatically go to\n\n106\n00:05:21.309 --> 00:05:22.029\nthe newest one.\n\n107\n00:05:22.029 --> 00:05:25.570\nIf I wanna go to an older one,\nI can enable firmware upload and\n\n108\n00:05:25.570 --> 00:05:29.118\nupload the 2.2.1 file and\nthen it'll do that upgrade.\n\n109\n00:05:29.118 --> 00:05:31.491\nSo you're not forced to\ngo to the newest one,\n\n110\n00:05:31.491 --> 00:05:34.311\nit's just the automatic part\ngoes to the newest one.\n\n111\n00:05:34.311 --> 00:05:35.687\nNow if I go to Auto Update,\n\n112\n00:05:35.687 --> 00:05:39.267\nit's really tempting to just hit\nthat Invoke Auto Upgrade button.\n\n113\n00:05:39.267 --> 00:05:43.939\nI'll tell you guys most of the time these\nupgrades go pretty smooth, but I know I\n\n114\n00:05:43.939 --> 00:05:48.993\npersonally had issues with the 2.15 to\n2.2 update that was a bit of a tough one.\n\n115\n00:05:48.993 --> 00:05:52.767\nAnd so when that happens,\nboy is it nice to have a safety net.\n\n116\n00:05:52.767 --> 00:05:55.449\nAnd the best safety net you can\nhave is this guy right here.\n\n117\n00:05:55.449 --> 00:05:57.910\nPerform a full backup prior to upgrade.\n\n118\n00:05:57.910 --> 00:06:00.520\n>> [LAUGH]\n>> It'll back up your firewall.\n\n119\n00:06:00.520 --> 00:06:03.744\nAnd if you do the upgrade and\nsomething's not working right,\n\n120\n00:06:03.744 --> 00:06:05.548\nyou can go to Restore Full Backup.\n\n121\n00:06:05.548 --> 00:06:09.565\nYou'll see your backup in the list and\nyou can restore right back to it.\n\n122\n00:06:09.565 --> 00:06:13.535\nSo easy to roll it back,\nif you did the backup.\n\n123\n00:06:13.535 --> 00:06:14.728\nIf you don't do the backup,\n\n124\n00:06:14.728 --> 00:06:17.976\nif you don't check that little box to\nperform the full upgrade when you do it.\n\n125\n00:06:17.976 --> 00:06:20.274\nIt doesn't have a backup,\nyou can't rollback.\n\n126\n00:06:20.274 --> 00:06:24.080\nYou have to format the firewall\nto rollback, it's not easy.\n\n127\n00:06:24.080 --> 00:06:26.970\nSo make sure you check that off,\nit doesn't take all that much\n\n128\n00:06:26.970 --> 00:06:30.000\nstorage to back it up and\nthen we could hit Invoke Upgrade.\n\n129\n00:06:30.000 --> 00:06:32.516\nThe firewall is gonna reach\nout to the pfSense website and\n\n130\n00:06:32.516 --> 00:06:34.255\nthere it goes downloading that image.\n\n131\n00:06:34.255 --> 00:06:36.749\nAnd the images are usually\nabout 80 megs in size,\n\n132\n00:06:36.749 --> 00:06:40.007\nit doesn't take that long to pull\nit down and so it's gonna get it.\n\n133\n00:06:40.007 --> 00:06:42.886\nOnce it's in place,\nit's gonna do the upgrade.\n\n134\n00:06:42.886 --> 00:06:47.138\nIt's gonna backup my data,\ndo the upgrade, reboot the firewall and\n\n135\n00:06:47.138 --> 00:06:50.818\nI should be running 2.2.2,\nthe latest and greatest.\n\n136\n00:06:50.818 --> 00:06:52.894\nSo there it's telling me it finished and\n\n137\n00:06:52.894 --> 00:06:56.139\nnow it's upgrading the firewall\nwall reboot when it's done.\n\n138\n00:06:56.139 --> 00:07:00.017\nNow, it's just gonna sit here and\nI don't see a whole lot.\n\n139\n00:07:00.017 --> 00:07:01.956\nThere's the status bar, but\nit doesn't actually work.\n\n140\n00:07:01.956 --> 00:07:03.197\n[LAUGH]\n>> [LAUGH]\n\n141\n00:07:03.197 --> 00:07:03.981\n>> So you don't see\n\n142\n00:07:03.981 --> 00:07:05.890\na whole lot until the firewall reboots.\n\n143\n00:07:05.890 --> 00:07:09.293\nIf you're watching on the console,\nhere you can see a little bit more.\n\n144\n00:07:09.293 --> 00:07:11.417\nOn the console, I can see I got a message.\n\n145\n00:07:11.417 --> 00:07:15.040\nIt's letting me know the firm upgrade\nis in progress and here we go.\n\n146\n00:07:15.040 --> 00:07:16.444\nIt's complete rebooting in ten seconds.\n\n147\n00:07:16.444 --> 00:07:19.173\nSo on the console,\nyou do get a little bit more information.\n\n148\n00:07:19.173 --> 00:07:23.908\nBack here on my web UI, it is telling me,\nwell, the same stuff it said a moment ago,\n\n149\n00:07:23.908 --> 00:07:25.549\nit hasn't really updated.\n\n150\n00:07:25.549 --> 00:07:28.057\nSo watching on that console can\nbe a little bit more useful.\n\n151\n00:07:28.057 --> 00:07:29.682\nThere it goes, shutting down.\n\n152\n00:07:29.682 --> 00:07:33.618\nWhen it reboots, it's gonna come up and\nit should be 2.2.2.\n\n153\n00:07:33.618 --> 00:07:35.277\nNow, key takeaways here.\n\n154\n00:07:35.277 --> 00:07:37.378\n>> [LAUGH]\n>> Definitely remember to backup,\n\n155\n00:07:37.378 --> 00:07:38.459\nit didn't take very long.\n\n156\n00:07:38.459 --> 00:07:41.907\nAnd then two, remember that it\nhas to reboot for the upgrade.\n\n157\n00:07:41.907 --> 00:07:43.417\nThis is not an online upgrade.\n\n158\n00:07:43.417 --> 00:07:46.058\nSo this is probably something\nyou'll wanna do after hours,\n\n159\n00:07:46.058 --> 00:07:49.496\nnot something necessarily in the middle\nof the day like I'm doing right here.\n\n160\n00:07:49.496 --> 00:07:51.098\n>> [LAUGH]\n>> Cuz it will cause a production outage.\n\n161\n00:07:51.098 --> 00:07:55.382\nBut it's gonna reboot there and\nI can see pfSense coming up.\n\n162\n00:07:55.382 --> 00:07:57.577\nGoing through its little boot process.\n\n163\n00:07:57.577 --> 00:07:59.492\nI can't really tell what\nversion it is here.\n\n164\n00:07:59.492 --> 00:08:02.894\nIt's probably in all this mess somewhere,\nif I dug through it all.\n\n165\n00:08:02.894 --> 00:08:05.900\nBut once it's up,\nwe can see it in the web UI real quick.\n\n166\n00:08:05.900 --> 00:08:08.891\nWe'll know exactly what version we're\nrunning and that it finished it's upgrade.\n\n167\n00:08:08.891 --> 00:08:09.774\nYeah, there we go.\n\n168\n00:08:09.774 --> 00:08:12.617\n2.2.2, it went by on\nthe screen pretty fast there.\n\n169\n00:08:12.617 --> 00:08:16.109\nBut as soon as that web configurator\nis up, we'll get into it and\n\n170\n00:08:16.109 --> 00:08:18.187\nwe'll find out what we're running.\n\n171\n00:08:18.187 --> 00:08:19.591\nThere we go.\n\n172\n00:08:19.591 --> 00:08:23.295\nSo I can see it again, visually confirming\n2.2.2 right there in the console.\n\n173\n00:08:23.295 --> 00:08:27.405\nAnd back here in my web UI,\nI'll have to log in again.\n\n174\n00:08:27.405 --> 00:08:29.889\nSo we'll get back out here.\n\n175\n00:08:29.889 --> 00:08:32.321\nAnd I'm gonna log back in to my system,\n\n176\n00:08:32.321 --> 00:08:36.028\nI'll tell Microsoft to stop\ntrying to store my passwords.\n\n177\n00:08:36.028 --> 00:08:40.643\nAnd what I should see is I'm\nrunning the latest version now and\n\n178\n00:08:40.643 --> 00:08:42.340\nit even tells me that.\n\n179\n00:08:42.340 --> 00:08:45.020\nI am on the latest version,\nthere is no update available.\n\n180\n00:08:46.850 --> 00:08:49.490\nBut is everything done,\nis everything working great?\n\n181\n00:08:49.490 --> 00:08:50.870\nMaybe.\n\n182\n00:08:50.870 --> 00:08:52.569\nWe need to test.\n\n183\n00:08:52.569 --> 00:08:54.357\nSo we start to check our various systems.\n\n184\n00:08:54.357 --> 00:08:55.657\nDid all our VPN tunnels come backup?\n\n185\n00:08:55.657 --> 00:08:57.016\nCan people remote in?\n\n186\n00:08:57.016 --> 00:08:59.082\nAre my nat rules all working properly?\n\n187\n00:08:59.082 --> 00:09:01.114\nIs all this stuff still\nfunctioning properly?\n\n188\n00:09:01.114 --> 00:09:02.344\nIf they are, great.\n\n189\n00:09:02.344 --> 00:09:04.450\nI'm done and I walk away.\n\n190\n00:09:04.450 --> 00:09:09.333\nBut if something's not working right and I\nneed to get back in business as quickly as\n\n191\n00:09:09.333 --> 00:09:12.424\nI can, then I need to go back\nin to my upgrade screen.\n\n192\n00:09:12.424 --> 00:09:15.904\nAnd from the upgrade screen,\nwe can go in and\n\n193\n00:09:15.904 --> 00:09:21.751\nwe can tell it that we want to rollback\nto the update that we were on before.\n\n194\n00:09:21.751 --> 00:09:26.709\nSo if I go up here to System and\nFirmware, I get into my Firmware screen.\n\n195\n00:09:26.709 --> 00:09:28.153\nThis is where the Auto Update was, but\n\n196\n00:09:28.153 --> 00:09:31.235\nyou don't have the little shortcut link\non the home page, if you're up to date.\n\n197\n00:09:31.235 --> 00:09:33.988\nAnd then you can come here\nto Restore Full Backup and\n\n198\n00:09:33.988 --> 00:09:35.918\nthere's that backup that we made.\n\n199\n00:09:35.918 --> 00:09:39.900\nIt's a backup, I can select that and\nI can download it.\n\n200\n00:09:39.900 --> 00:09:44.588\nYou download it to your USB key and\nthen you can go to the firewall and\n\n201\n00:09:44.588 --> 00:09:48.794\non the firewall's console,\nyou can restore that backup.\n\n202\n00:09:48.794 --> 00:09:50.790\nYou can format the whole firewall.\n\n203\n00:09:50.790 --> 00:09:52.730\nThrow a different version on,\nif you wanted or\n\n204\n00:09:52.730 --> 00:09:55.285\nyou could restore right from that\nUSB key and put it in place.\n\n205\n00:09:55.285 --> 00:09:57.490\nIt's 236 megs in size.\n\n206\n00:09:57.490 --> 00:10:00.435\nThat's larger than the image download,\ncuz it's got my configs and\n\n207\n00:10:00.435 --> 00:10:03.400\nsome other settings that are on there and\nit's all be extracted too.\n\n208\n00:10:03.400 --> 00:10:06.886\nNot like the images that you download\nthat are highly compressed, but\n\n209\n00:10:06.886 --> 00:10:09.796\nthe upgrade's pretty\nstraightforward all right there.\n\n210\n00:10:09.796 --> 00:10:13.975\nIf the firewall's still functional, I\ndon't even have to copy that to a USB key.\n\n211\n00:10:13.975 --> 00:10:16.889\nI can just hit Restore and\nit's gonna do the restore in place.\n\n212\n00:10:16.889 --> 00:10:20.720\nSo if I choose the firewall,\nI'll let it restore the config too.\n\n213\n00:10:20.720 --> 00:10:23.725\nIf I've made changes since then,\nI might wanna preserve those, so\n\n214\n00:10:23.725 --> 00:10:25.264\ndon't restore the config.xml.\n\n215\n00:10:25.264 --> 00:10:28.514\nBut normally, we want that, and\nso I can choose to Restore it.\n\n216\n00:10:28.514 --> 00:10:30.813\nAnd now, it's gonna do that restore.\n\n217\n00:10:30.813 --> 00:10:32.229\nSo, it tells me it's currently restoring.\n\n218\n00:10:32.229 --> 00:10:34.732\nIf I check out the console,\nwell, eventually,\n\n219\n00:10:34.732 --> 00:10:38.102\nI'll see some little messages here and\nthen it's gonna reboot.\n\n220\n00:10:38.102 --> 00:10:43.501\nAnd when it reboots, I shall be back\nto 2.2 without the 2.2.2 update.\n\n221\n00:10:43.501 --> 00:10:45.637\nSo, it'll churn along.\n\n222\n00:10:45.637 --> 00:10:47.602\nThis process does actually\ntake a little while, so\n\n223\n00:10:47.602 --> 00:10:50.220\nI probably won't bore you guys with\nsitting here waiting for that.\n\n224\n00:10:50.220 --> 00:10:52.983\nBut it'll run through,\nit'll reboot and then it'll rollback.\n\n225\n00:10:52.983 --> 00:10:57.045\nI have had it before where\nthe update was so messed up,\n\n226\n00:10:57.045 --> 00:11:01.130\nthat I wasn't even able\nto get to the web UI.\n\n227\n00:11:01.130 --> 00:11:03.939\nAnd at that point, you really do\nhave to just format the firewall and\n\n228\n00:11:03.939 --> 00:11:05.675\nkind of start over again and that stinks.\n\n229\n00:11:05.675 --> 00:11:09.876\nBut if you backed up your config, it's so\neasy to just bring up a new firewall and\n\n230\n00:11:09.876 --> 00:11:13.532\nthrow your config right back into it\nthat it's not that big of a deal.\n\n231\n00:11:13.532 --> 00:11:18.451\nSo that's kind of a life lesson there\nis always backup your configurations on\n\n232\n00:11:18.451 --> 00:11:19.520\nyour firewall.\n\n233\n00:11:19.520 --> 00:11:23.027\nDon't count on upgrades and\nthings like that,\n\n234\n00:11:23.027 --> 00:11:28.123\nworking just perfectly and\nthat kind of stuff is not difficult to do.\n\n235\n00:11:28.123 --> 00:11:30.979\nWhen you go into your menus up here.\n\n236\n00:11:30.979 --> 00:11:33.812\nLet's see, where is the backup-\n>> Diagnostics.\n\n237\n00:11:33.812 --> 00:11:34.683\n>> Oh, thank you, Ronnie.\n\n238\n00:11:34.683 --> 00:11:37.759\n>> Backup, restore,\nthird or fourth option.\n\n239\n00:11:37.759 --> 00:11:38.305\n>> There we go.\n\n240\n00:11:38.305 --> 00:11:41.474\nSo my firewall is busy doing\nits own restore right now.\n\n241\n00:11:41.474 --> 00:11:42.069\n>> [LAUGH]\n>> So\n\n242\n00:11:42.069 --> 00:11:43.308\nI don't think it will let me click that.\n\n243\n00:11:43.308 --> 00:11:46.727\nBut if you got to Diagnostics and\nBackup and Restore, that in this screen,\n\n244\n00:11:46.727 --> 00:11:48.150\nyou can download your config.\n\n245\n00:11:48.150 --> 00:11:51.694\nAnd if you download that config and\nanything happens to the firewall,\n\n246\n00:11:51.694 --> 00:11:55.236\nyou could format it, erase it completely,\nbring up a new firewall and\n\n247\n00:11:55.236 --> 00:11:59.337\njust go down here to restore and restore\nthat config and you are back in business.\n\n248\n00:11:59.337 --> 00:12:02.268\nAll your certificates, everything is\nright back where it needs to be and\n\n249\n00:12:02.268 --> 00:12:04.154\nyou didn't have to rely\non that other backup.\n\n250\n00:12:04.154 --> 00:12:08.323\nSo if you're backing up your config,\nthen you'll be in good shape.\n\n251\n00:12:08.323 --> 00:12:11.980\nBut otherwise, that's basically it for\nupdating a firewall.\n\n252\n00:12:11.980 --> 00:12:15.901\nThis restore, it's got to extract the\nfile, move things around and reboot, so\n\n253\n00:12:15.901 --> 00:12:17.295\nit'll finish eventually.\n\n254\n00:12:17.295 --> 00:12:19.269\nOh, it's actually already finished.\n\n255\n00:12:19.269 --> 00:12:20.789\nHere we go.\n\n256\n00:12:20.789 --> 00:12:21.590\n>> Oh, yes, that's it.\n\n257\n00:12:21.590 --> 00:12:23.192\n>> So I'm running 2.2 release again.\n\n258\n00:12:23.192 --> 00:12:26.104\nIt is showing an update is available,\nso I've been rolled back and\n\n259\n00:12:26.104 --> 00:12:27.614\nI don't have the update anymore.\n\n260\n00:12:27.614 --> 00:12:30.029\nThat went faster than I thought.\n\n261\n00:12:30.029 --> 00:12:31.875\nSo well, there we go.\n\n262\n00:12:31.875 --> 00:12:33.697\nAll right, Ronnie.\n\n263\n00:12:33.697 --> 00:12:35.474\nThat's about all,\nI've got on upgrading the firewall.\n\n264\n00:12:35.474 --> 00:12:36.136\nCan you think of anything else?\n\n265\n00:12:36.136 --> 00:12:37.962\n>> The only other thing\nthat I've run into,\n\n266\n00:12:37.962 --> 00:12:40.583\nwhich is you've gotta be patient\nas you do stuff like this.\n\n267\n00:12:40.583 --> 00:12:42.915\n>> [LAUGH]\n>> If you get impatient and for\n\n268\n00:12:42.915 --> 00:12:48.310\none reason or another you decide,\nhey, I'm gonna just unplug the power.\n\n269\n00:12:48.310 --> 00:12:52.340\nPfSense is very sensitive about the idea\nof you not doing some type of graceful\n\n270\n00:12:52.340 --> 00:12:56.381\nshutdown, if you don't have it and\nit can cause things to actually be worse.\n\n271\n00:12:56.381 --> 00:12:59.783\nSo when you do stuff like this,\njust be patient and\n\n272\n00:12:59.783 --> 00:13:03.833\ngive it a little bit of time and\nmake sure you don't rush it.\n\n273\n00:13:03.833 --> 00:13:05.319\nI think is pretty much the key.\n\n274\n00:13:05.319 --> 00:13:07.838\n>> Yeah.\nI think we've learned that lesson more\n\n275\n00:13:07.838 --> 00:13:08.454\nthan once.\n\n276\n00:13:08.454 --> 00:13:09.440\n>> [LAUGH] Yes.\n\n277\n00:13:09.440 --> 00:13:10.819\n>> [LAUGH] Or\nwe haven't learned that lesson,\n\n278\n00:13:10.819 --> 00:13:12.172\nI guess will be the better\nway to put that.\n\n279\n00:13:12.172 --> 00:13:14.970\nWell, ladies and gentlemen,\nI hope you guys enjoyed that.\n\n280\n00:13:14.970 --> 00:13:17.838\nStay tuned,\nwe've got more pfSense content coming up.\n\n281\n00:13:17.838 --> 00:13:23.999\n[MUSIC]\n\n",
          "vimeoId": "130538615"
        }
      ],
      "title": "Monitoring and Maintaining"
    },
    {
      "episodes": [
        {
          "description": null,
          "length": "1794",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-7-1-popular_packages-063015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-7-1-popular_packages-063015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-7-1-popular_packages-063015-1-sm.jpg",
          "title": "Popular Packages",
          "transcript": "WEBVTT\n\n1\n00:00:00.025 --> 00:00:05.524\n[SOUND] In this segment we're gonna\n\n2\n00:00:05.524 --> 00:00:10.840\ntake a look at PF Sense packages.\n\n3\n00:00:10.840 --> 00:00:17.010\nPackages give us the ability to go ahead\nand extend the functionality of PF Sense.\n\n4\n00:00:17.010 --> 00:00:20.230\nAnd there's a ton of packages and\ntoday to help us.\n\n5\n00:00:20.230 --> 00:00:23.490\nTo try and figure out what the packages\nare, which ones we're gonna use.\n\n6\n00:00:23.490 --> 00:00:26.670\nDon, there are so many of them,\nhow do we know what to choose?\n\n7\n00:00:26.670 --> 00:00:27.500\n>> There's a lot.\n\n8\n00:00:27.500 --> 00:00:30.340\nAnd so what we wanna do here is kind\nof highlight some of the popular\n\n9\n00:00:30.340 --> 00:00:31.688\npackages that are out there.\n\n10\n00:00:31.688 --> 00:00:36.230\nNow, you guys, everybody's implementation\nof PF sense is a little bit unique.\n\n11\n00:00:36.230 --> 00:00:40.860\nEverybody's network is a lot unique, and\nso there's some packages that may be super\n\n12\n00:00:40.860 --> 00:00:43.830\nimportant to you,\nthat I don't care about in the slightest.\n\n13\n00:00:43.830 --> 00:00:46.460\nAnd vice versa there might be\npackages that are really important\n\n14\n00:00:46.460 --> 00:00:48.240\nto me that you don't care\nabout in the slightest.\n\n15\n00:00:48.240 --> 00:00:51.860\nSo it's a matter of finding\nthe ones that are really useful,\n\n16\n00:00:51.860 --> 00:00:54.330\nthe ones that really meet your need and\nachieve a goal.\n\n17\n00:00:54.330 --> 00:00:57.710\nAlso, remember, there's a lot of things\nthat we can do from the firewall, but\n\n18\n00:00:57.710 --> 00:01:00.920\njust because we can,\ndoesn't necessarily mean we should.\n\n19\n00:01:00.920 --> 00:01:05.490\nThere's plenty of things that are better\nsuited being done somewhere else.\n\n20\n00:01:05.490 --> 00:01:09.080\nLike you can set up your PF Sense\nfirewall as an FTP server and\n\n21\n00:01:09.080 --> 00:01:10.030\nturn it into file storage.\n\n22\n00:01:10.030 --> 00:01:11.400\nYou can do that.\n\n23\n00:01:11.400 --> 00:01:12.310\nIt's not really designed for\n\n24\n00:01:12.310 --> 00:01:15.870\nthat though and it'd be better off to have\na separate server being your file storer.\n\n25\n00:01:15.870 --> 00:01:16.540\nYou can do that.\n\n26\n00:01:16.540 --> 00:01:17.140\nRight?\n\n27\n00:01:17.140 --> 00:01:20.250\nSame thing with wireless access\npoint functionality and so on.\n\n28\n00:01:20.250 --> 00:01:23.860\nSo when you look at these packages,\nthey're not all a great idea.\n\n29\n00:01:23.860 --> 00:01:26.280\nBut I wanna highlight some of\nthe popular ones that are out there and\n\n30\n00:01:26.280 --> 00:01:29.830\njust show you some examples,\nkinda give you a feel for what's there.\n\n31\n00:01:29.830 --> 00:01:32.390\nNow when you log in to\nyour PF Sense Firewall,\n\n32\n00:01:32.390 --> 00:01:37.000\nyou can access the package screen,\nby going up here to System and Packages.\n\n33\n00:01:37.000 --> 00:01:37.670\nAll right.\n\n34\n00:01:37.670 --> 00:01:39.280\nAnd when you go into the package screen,\n\n35\n00:01:39.280 --> 00:01:42.880\nit defaults by showing you packages that\nyou've already installed on your firewall.\n\n36\n00:01:42.880 --> 00:01:45.260\nAnd it's probably an empty list.\n\n37\n00:01:45.260 --> 00:01:47.820\nIf this is a new install your\nlist won't really have anything.\n\n38\n00:01:47.820 --> 00:01:51.170\nAnd everything will be under\nthe available packages tab, and\n\n39\n00:01:51.170 --> 00:01:53.100\nthat's where you'll see your layout.\n\n40\n00:01:53.100 --> 00:01:55.350\nAs you install packages,\nthey come out of this list though and\n\n41\n00:01:55.350 --> 00:01:56.995\nget moved over to install.\n\n42\n00:01:56.995 --> 00:02:01.205\nSo when you look at this list, read\nthe descriptions, read what it says of\n\n43\n00:02:01.205 --> 00:02:06.365\nthe package, what it does and pay really\ngood attention to the status column.\n\n44\n00:02:06.365 --> 00:02:10.475\nA lot of these packets will\nsay things like alpha.\n\n45\n00:02:10.475 --> 00:02:13.735\nAlpha means you probably shouldn't\nbe using this in production.\n\n46\n00:02:13.735 --> 00:02:14.675\nIt's alpha status.\n\n47\n00:02:14.675 --> 00:02:17.075\nIt may have bugs in it,\nit hasn't been throughly tested.\n\n48\n00:02:17.075 --> 00:02:19.260\nIt hasn't had a security review yet.\n\n49\n00:02:19.260 --> 00:02:21.860\nNot necessarily something\nyou want in production.\n\n50\n00:02:21.860 --> 00:02:24.570\nAlso, platform is really important.\n\n51\n00:02:24.570 --> 00:02:26.972\nI'm running PF Sense 2.2.3, so\n\n52\n00:02:26.972 --> 00:02:30.760\nI really wanna find packages that are for\nplatform 2.2.\n\n53\n00:02:30.760 --> 00:02:35.380\nIf I find one that's for platform 1.2.3,\nI probably don't wanna run that,\n\n54\n00:02:35.380 --> 00:02:38.610\nright, it hasn't been updated to\nsupport the newer versions of PF Sense.\n\n55\n00:02:38.610 --> 00:02:40.970\nAnd you will find that,\nso be careful with that.\n\n56\n00:02:40.970 --> 00:02:44.380\nThere's many of these that are here in\nbeta, some of them are stable, right,\n\n57\n00:02:44.380 --> 00:02:47.250\nthe bacula client,\nthat's a back up client you can run.\n\n58\n00:02:47.250 --> 00:02:52.460\nIt's stable, you can deploy that, works\ngreat, platform 2.2, wonderful, right.\n\n59\n00:02:52.460 --> 00:02:53.980\nBut other one's, maybe not so\n\n60\n00:02:53.980 --> 00:02:57.470\nmuch, so just be careful as you\ngo through and pick those out.\n\n61\n00:02:57.470 --> 00:03:01.070\nNow I've installed a couple of\nthe packages here that are pretty popular.\n\n62\n00:03:01.070 --> 00:03:05.180\nSo let's just talk about each one of these\nand we'll kind of run through the list.\n\n63\n00:03:05.180 --> 00:03:08.920\nNow we've talked about some\npackages in other episodes.\n\n64\n00:03:08.920 --> 00:03:11.370\nSo I don't want to rehash\none's we've already done.\n\n65\n00:03:11.370 --> 00:03:14.920\nWe did an episode on Bandwidth D and\nNtop NG.\n\n66\n00:03:14.920 --> 00:03:18.250\nIf you haven't watched that episode yet,\nBandwidth D\n\n67\n00:03:18.250 --> 00:03:21.890\nis a neat package that lets you monitor\nthe bandwidth consumption on your system.\n\n68\n00:03:21.890 --> 00:03:24.310\nShows what IP addresses are in\nuse on your network and\n\n69\n00:03:24.310 --> 00:03:26.502\nhow much band width they're consuming.\n\n70\n00:03:26.502 --> 00:03:31.170\nNtop NG does the same thing,\nbut in far more detail.\n\n71\n00:03:31.170 --> 00:03:33.170\nSo it gives you some\nreally cool pie charts.\n\n72\n00:03:33.170 --> 00:03:33.960\nIt's pretty.\n\n73\n00:03:33.960 --> 00:03:36.780\nIt breaks down the flow, so\nyou see not only how much traffic that\n\n74\n00:03:36.780 --> 00:03:39.440\none flow is generating, but\nwhat protocols they use and\n\n75\n00:03:39.440 --> 00:03:42.830\nwho they were talking to, really\ndetailed information, inside of there.\n\n76\n00:03:44.210 --> 00:03:48.180\nIn our remote access VPN\nepisode our open VPN episode,\n\n77\n00:03:48.180 --> 00:03:53.240\nwe covered another utility which was\nthe Open VPN Client Export Utility.\n\n78\n00:03:53.240 --> 00:03:56.750\nThat one will export the config files\nyou'd need to use on a client to get\n\n79\n00:03:56.750 --> 00:03:58.240\nit to connect to your VPN.\n\n80\n00:03:58.240 --> 00:04:02.760\nSo those are really good packages,\nvery widely used, very popular, but\n\n81\n00:04:02.760 --> 00:04:04.300\nwe've just covered them in other episodes.\n\n82\n00:04:05.540 --> 00:04:10.322\nBut a new one that we haven't covered,\nhow about PF Blocker NG.\n\n83\n00:04:10.322 --> 00:04:14.440\nPF Blocker, it's gonna be in my installed\nlist cuz I've already installed it.\n\n84\n00:04:14.440 --> 00:04:18.470\nIn previous versions of PF Sense,\nso if you're running like 2.0 or\n\n85\n00:04:18.470 --> 00:04:20.400\nback in the 1 points, or whatever.\n\n86\n00:04:20.400 --> 00:04:24.560\nThen you'll have just PF Blocker, but\nin PF Sense 2.2 and higher you've got\n\n87\n00:04:24.560 --> 00:04:30.420\nPF Blocker NG and what it is is a really\nneat utility that helps you for\n\n88\n00:04:30.420 --> 00:04:35.260\nwriting firewall rules that block\nthings like entire countries, alright.\n\n89\n00:04:35.260 --> 00:04:39.090\nIt's very common that you might have\na server, maybe you're a company here in\n\n90\n00:04:39.090 --> 00:04:43.240\nthe United States and all of your\ncustomers are here in the United States.\n\n91\n00:04:43.240 --> 00:04:46.650\nBut you're getting attack traffic\non your website that's coming from\n\n92\n00:04:46.650 --> 00:04:49.230\nCzechoslovakia or China or Russia.\n\n93\n00:04:49.230 --> 00:04:52.240\nYou don't have any customers over there.\n\n94\n00:04:52.240 --> 00:04:54.280\nIf you don't have any\ncustomers over there,\n\n95\n00:04:54.280 --> 00:04:57.200\nwhy not just block traffic from\nthose countries altogether?\n\n96\n00:04:57.200 --> 00:04:59.450\nNow, that doesn't work so\nwell if you're like us.\n\n97\n00:04:59.450 --> 00:05:01.440\nAt ITProTV, we have customers in Russia.\n\n98\n00:05:01.440 --> 00:05:03.810\nWe have customers in China, so\nwe don't want to block them.\n\n99\n00:05:03.810 --> 00:05:07.390\nBut if you don't have customers there, you\ncan block it and that helps to secure it,\n\n100\n00:05:07.390 --> 00:05:11.310\nor you're home, you know, maybe you're at\nhome and you're in the U.S., you don't\n\n101\n00:05:11.310 --> 00:05:14.720\ncontact systems outside the U.S.,\nyou can block it, and limit it by country.\n\n102\n00:05:14.720 --> 00:05:19.023\nThe challenge there is those\naddresses change all the time, and\n\n103\n00:05:19.023 --> 00:05:22.010\nPF Blocker helps us to prevent that.\n\n104\n00:05:22.010 --> 00:05:26.370\nIf you install PF Blocker, what you'll\nget is a new installation menu up here.\n\n105\n00:05:26.370 --> 00:05:29.960\nIf we go up to firewall,\nand PF blocker NG.\n\n106\n00:05:31.220 --> 00:05:34.700\nAnd what it does, is it lets us\ncome in here and configure it so\n\n107\n00:05:34.700 --> 00:05:38.240\nthat it can reach out and\nget these updated country lists.\n\n108\n00:05:38.240 --> 00:05:41.250\nWhen you look at these tabs up here\nwe've got Africa, Asia, Europe,\n\n109\n00:05:41.250 --> 00:05:42.950\nNorth America and so on.\n\n110\n00:05:42.950 --> 00:05:44.820\nWe can enable PF blocker.\n\n111\n00:05:44.820 --> 00:05:47.090\nI'm just going to turn that on real quick.\n\n112\n00:05:47.090 --> 00:05:50.460\nWe can pick who our inbound and\noutbound interfaces are.\n\n113\n00:05:50.460 --> 00:05:53.420\nRight?\nSo my inbound interfaces, inbound firewall\n\n114\n00:05:53.420 --> 00:05:57.670\nrules will go on my WAN, and my outbound\nfirewall rules will go on my LAN.\n\n115\n00:05:57.670 --> 00:06:00.980\nSo I'm just gonna chose those and\nI'll gonna go ahead and save that.\n\n116\n00:06:02.200 --> 00:06:03.530\nThat's gonna enable PF Blocker.\n\n117\n00:06:03.530 --> 00:06:06.110\nAnd now that actually didn't\nchange anything on my firewall.\n\n118\n00:06:06.110 --> 00:06:08.100\nI just told PF Blocker what to do.\n\n119\n00:06:09.290 --> 00:06:11.740\nThen I can jump over to the update tab,\nand\n\n120\n00:06:11.740 --> 00:06:14.420\nhere's how we tell it to get\nits updated country list.\n\n121\n00:06:14.420 --> 00:06:18.580\nSo, cron status, right,\nit's running a cron job every so often.\n\n122\n00:06:18.580 --> 00:06:20.950\nHere, we can see the next\nrun will be at 11 AM,\n\n123\n00:06:20.950 --> 00:06:24.500\nwhich is in 36 minutes, it's gonna run and\nupdate all these country lists.\n\n124\n00:06:24.500 --> 00:06:28.410\nSo, it's gonna run those updates,\nwe can force it to do an update right now,\n\n125\n00:06:28.410 --> 00:06:30.400\nsince I just did the install, and\n\n126\n00:06:30.400 --> 00:06:33.810\nthat's gonna make sure I've got the latest\ncountry list, so there it goes,\n\n127\n00:06:33.810 --> 00:06:37.320\njust did an update, so\nnothing new was found, so its good to go.\n\n128\n00:06:37.320 --> 00:06:41.680\nAlright once we are done there, now we\ncan now start to work with PF Blocker.\n\n129\n00:06:41.680 --> 00:06:42.475\nSo maybe I wanna block.\n\n130\n00:06:42.475 --> 00:06:45.390\nWho do we want to single out,\nlets single out Afghanistan today,\n\n131\n00:06:45.390 --> 00:06:48.040\nbecause there is a lot of\nattacks coming from Afghanistan.\n\n132\n00:06:48.040 --> 00:06:51.597\nSo I might chose to go over here to Asia\nand pick I'm gonna pick Afghanistan and\n\n133\n00:06:51.597 --> 00:06:54.337\nAfghanistan actually has two\ndifferent country codes, so\n\n134\n00:06:54.337 --> 00:06:56.290\nI'm going to chose both of them.\n\n135\n00:06:56.290 --> 00:06:57.840\nRight.\nSo let me just go ahead and\n\n136\n00:06:57.840 --> 00:06:59.230\nchoose both of those.\n\n137\n00:06:59.230 --> 00:07:01.640\nAnd then down here we can\nsee what we're gonna do.\n\n138\n00:07:01.640 --> 00:07:04.640\nI'm gonna take these guys and\nI'm gonna deny inbound traffic.\n\n139\n00:07:04.640 --> 00:07:07.620\nI'm not gonna let inbound traffic\ncome in from Afghanistan.\n\n140\n00:07:07.620 --> 00:07:10.150\nAnd as I scroll down,\nI can choose to enable logging.\n\n141\n00:07:10.150 --> 00:07:12.470\nI can filter based on ports or\ndestination.\n\n142\n00:07:12.470 --> 00:07:14.420\nI can filter based on protocol.\n\n143\n00:07:14.420 --> 00:07:18.820\nAnd when I hit save, it's going\nto create a firewall rule for me.\n\n144\n00:07:18.820 --> 00:07:21.724\nAnd so if I go up here to firewall and\nrules,\n\n145\n00:07:21.724 --> 00:07:25.690\nI'll have a new firewall rule,\ndid I not hit save?\n\n146\n00:07:25.690 --> 00:07:28.810\nWell, it will create a new firewall\nrule here in just a minute.\n\n147\n00:07:28.810 --> 00:07:32.410\nWhere it'll actually list\nan alias that it created,\n\n148\n00:07:32.410 --> 00:07:36.720\nan alias that is mapped to Afghanistan and\nyou know,\n\n149\n00:07:36.720 --> 00:07:39.780\nlet me just make sure I set my inbound and\noutbound interfaces.\n\n150\n00:07:39.780 --> 00:07:41.310\nThere we go, so those are set.\n\n151\n00:07:42.400 --> 00:07:46.190\nThat's usually the one that I make\nmistake on, so let me go back here and\n\n152\n00:07:46.190 --> 00:07:46.750\ntry this again.\n\n153\n00:07:46.750 --> 00:07:49.160\nSo I've got Afghanistan chosen.\n\n154\n00:07:49.160 --> 00:07:52.600\nSo there we go, I've got this selected for\ndenying inbound,\n\n155\n00:07:52.600 --> 00:07:55.390\nI must have hit save because\nit remembers everything.\n\n156\n00:07:55.390 --> 00:08:01.864\nWe've got all those entries in place,\nand go ahead and save that.\n\n157\n00:08:01.864 --> 00:08:04.086\nWhat it's actually doing in\nthe background is it's saying, okay,\n\n158\n00:08:04.086 --> 00:08:06.690\nI need to create this list, and\nI need to put it in the firewall rule.\n\n159\n00:08:06.690 --> 00:08:09.640\nBut I need to update that\nanytime there's changes,\n\n160\n00:08:09.640 --> 00:08:13.580\nlike new IP ranges might get added to\nAfghanistan, so it needs to update that.\n\n161\n00:08:13.580 --> 00:08:17.295\nSo it's actually a job in the background\nthat's supplying it, and I bet if I were\n\n162\n00:08:17.295 --> 00:08:20.075\nmore of a patient man, I could wait, and\nit would take effect, but I'm not patient.\n\n163\n00:08:20.075 --> 00:08:20.935\nSo I'm gonna force it.\n\n164\n00:08:20.935 --> 00:08:24.405\nI'm gonna go to my update tab,\nand I'm gonna force an update,\n\n165\n00:08:24.405 --> 00:08:27.697\nand I'm just gonna make that turkey run.\n\n166\n00:08:27.697 --> 00:08:28.667\nAnd there we go.\n\n167\n00:08:28.667 --> 00:08:32.427\nI can see it's doing stuff, see how it's\nbuilding up this alias table and so on?\n\n168\n00:08:32.427 --> 00:08:33.757\nSo now I should be good.\n\n169\n00:08:33.757 --> 00:08:37.247\nAnd if I go up here to my firewall and\nmy rules, there we go.\n\n170\n00:08:37.247 --> 00:08:39.047\nThank goodness.\n\n171\n00:08:39.047 --> 00:08:44.437\n[LAUGH] So I can see that it's\ncreated a IPV4 and an IPV6 rule,\n\n172\n00:08:44.437 --> 00:08:49.957\nblocking all of those networks that I just\nliked, those ones that are in Afghanistan.\n\n173\n00:08:49.957 --> 00:08:52.670\nAnd that traffic is now being\nblocked on my WAN interface.\n\n174\n00:08:52.670 --> 00:08:55.720\nAnd it was being blocked anyway, because I\nhad this kind of block all rule, but now,\n\n175\n00:08:55.720 --> 00:08:56.650\nI'm being very specific.\n\n176\n00:08:56.650 --> 00:08:59.230\nI'm blocking those, and\nnot allowing them in.\n\n177\n00:08:59.230 --> 00:09:04.390\nSo, pf blocker ng, really cool because\nit lets you block, based on countries,\n\n178\n00:09:04.390 --> 00:09:07.550\nbased on other things, there's all\nkinds of neat stuff you can do.\n\n179\n00:09:07.550 --> 00:09:11.570\nWe've got top 20 spammer countries, you\ncan come in and pick to block from, and\n\n180\n00:09:11.570 --> 00:09:12.940\nreally filter that traffic.\n\n181\n00:09:12.940 --> 00:09:13.560\nSo, neat stuff there.\n\n182\n00:09:15.010 --> 00:09:15.930\nAll right.\n\n183\n00:09:15.930 --> 00:09:19.560\nAnother package that's\npretty popular is snort.\n\n184\n00:09:19.560 --> 00:09:24.990\nThe snort package, now we could do\nan entire weeks worth of shows on snort,\n\n185\n00:09:24.990 --> 00:09:28.740\nbut the snort package it's\nan intrusion detection system.\n\n186\n00:09:28.740 --> 00:09:32.600\nWhat it does is it scans your traffic\nas it passes through the network, and\n\n187\n00:09:32.600 --> 00:09:33.930\nit looks for attacks.\n\n188\n00:09:33.930 --> 00:09:36.240\nWhen there's an attack that is\npublished out on the internet,\n\n189\n00:09:36.240 --> 00:09:38.390\npeople know how that attack is exploited,\nand\n\n190\n00:09:38.390 --> 00:09:43.650\nso the Snort guys write rules to detect\nthat attack and block it from happening.\n\n191\n00:09:43.650 --> 00:09:45.690\nWell setting up a Snort server\ncan be really challenging,\n\n192\n00:09:45.690 --> 00:09:48.720\nyou see the steps here, downloading it,\nsetting up, configuring it.\n\n193\n00:09:48.720 --> 00:09:53.360\nIn pf sense it's not such a big deal,\nyou just install the snort package.\n\n194\n00:09:53.360 --> 00:09:56.270\nSo under systems and\npackages you've got a snort package.\n\n195\n00:09:56.270 --> 00:10:00.550\nYou can add that in, and\nonce it's in you can go to services and\n\n196\n00:10:00.550 --> 00:10:03.075\nSnort, and then we just customize it.\n\n197\n00:10:03.075 --> 00:10:05.055\nWe tell it what interfaces\nI wanna monitor,\n\n198\n00:10:05.055 --> 00:10:07.915\nmaybe I wanna monitor my LAN interface or\nnormally your WAN interface, right,\n\n199\n00:10:07.915 --> 00:10:11.285\nthat's where we're watching for those\nattacks, and then you can specify your\n\n200\n00:10:11.285 --> 00:10:14.855\nglobal settings, what traffic it's\nblocked, you can create exceptions,\n\n201\n00:10:14.855 --> 00:10:19.120\nwhat's allowed to pass through without\nbeing scanned, and you can define that.\n\n202\n00:10:19.120 --> 00:10:22.820\nOne quick word of caution,\nsnort uses CPU power,\n\n203\n00:10:22.820 --> 00:10:26.600\nit's got to scan every packet, so\nit creates a little bit of latency.\n\n204\n00:10:26.600 --> 00:10:28.290\nThat can be bad for voiceover IP.\n\n205\n00:10:28.290 --> 00:10:31.860\nSo make sure you add any voiceover\nIP traffic to pass lists so\n\n206\n00:10:31.860 --> 00:10:34.110\nit passes through without being scanned.\n\n207\n00:10:34.110 --> 00:10:38.180\nIt's also a good idea to add\nencrypted traffic, VPN traffic, SSL.\n\n208\n00:10:38.180 --> 00:10:40.470\nAdd those to your pass list cuz\nyou can't scan them anyway.\n\n209\n00:10:40.470 --> 00:10:41.750\nIt's encrypted, right?\n\n210\n00:10:41.750 --> 00:10:44.420\nSo you're really just wasting\ntime trying to scan those.\n\n211\n00:10:44.420 --> 00:10:45.505\nSo put.\nPut those on your list,\n\n212\n00:10:45.505 --> 00:10:47.865\nthat'll lower your resource utilization.\n\n213\n00:10:47.865 --> 00:10:50.445\nEverything else though, go ahead and\nscan, it will look for attacks, and\n\n214\n00:10:50.445 --> 00:10:51.475\nit'll block those.\n\n215\n00:10:51.475 --> 00:10:53.477\nSo really neat software,\n\n216\n00:10:53.477 --> 00:10:59.185\nsuper easy to implement here in PFSense,\nthanks to the package.\n\n217\n00:10:59.185 --> 00:11:02.905\nAll right.\nAnother neat one is called Mail Report.\n\n218\n00:11:02.905 --> 00:11:06.235\nUnder systems and packages you can find\nit, and it's just called Mail Report.\n\n219\n00:11:06.235 --> 00:11:08.980\nI've already installed it here on mine,\nit's just called Mail Report.\n\n220\n00:11:08.980 --> 00:11:13.980\nAnd what it lets you do is generate\nemail reports that get sent to you.\n\n221\n00:11:13.980 --> 00:11:17.370\nMaybe you want a weekly bandwidth report,\nor\n\n222\n00:11:17.370 --> 00:11:20.430\njust some kind of health report for\nyour firewalls.\n\n223\n00:11:20.430 --> 00:11:24.740\nYou can set it up and have it email that\ninformation to you on a regular schedule.\n\n224\n00:11:24.740 --> 00:11:28.830\nWhen mail report's installed,\nyou can go up here to services.\n\n225\n00:11:28.830 --> 00:11:33.550\nAnd, now let's see here,\nit's buried under services, and, oh wait,\n\n226\n00:11:33.550 --> 00:11:34.990\nit's not, it's under status.\n\n227\n00:11:34.990 --> 00:11:37.560\nUnder status, and\ne-mail reports, there we go.\n\n228\n00:11:37.560 --> 00:11:41.150\nThis is one problem with packages,\npackages kind of spread themselves out.\n\n229\n00:11:41.150 --> 00:11:45.670\nYou guys saw how PF blocker was\nunder firewall and PF blocker, but\n\n230\n00:11:45.670 --> 00:11:50.400\nthen, if we went under services, that was\nwhere we had some other things like snort.\n\n231\n00:11:50.400 --> 00:11:54.100\nAnd then I go under status, and\nthat's where I've got email reports.\n\n232\n00:11:54.100 --> 00:11:56.970\nAnd then the other challenge is, they\ndon't necessarily follow the same name.\n\n233\n00:11:56.970 --> 00:12:00.640\nThe package is called mail report,\nbut the menu item is email reports.\n\n234\n00:12:00.640 --> 00:12:03.290\nSo, sometimes it's a little tricky\nto find out where a package is,\n\n235\n00:12:03.290 --> 00:12:05.230\nyou may need to look at the help\ndocumentation to find that.\n\n236\n00:12:06.250 --> 00:12:10.900\nBut in email reports, here I can define\nemail reports that I want to send.\n\n237\n00:12:10.900 --> 00:12:13.020\nAnd so\nI can just hit my little plus sign, and\n\n238\n00:12:13.020 --> 00:12:17.640\nI can say that I wanna send out some\nkind of firewall health report,\n\n239\n00:12:18.850 --> 00:12:21.740\nor bandwidth report, or\nwhatever it is that I wanna do.\n\n240\n00:12:21.740 --> 00:12:23.290\nI can specify how often I want it.\n\n241\n00:12:23.290 --> 00:12:25.290\nI'm just gonna say every Sunday,\nsend me one.\n\n242\n00:12:26.290 --> 00:12:28.440\nAnd it's just creating a cron\njob in the background,\n\n243\n00:12:28.440 --> 00:12:33.000\nso these fields all correspond to cron\nvalues for when you want this to occur.\n\n244\n00:12:33.000 --> 00:12:38.490\nThen we can specify things like\ncommands we want the system to run.\n\n245\n00:12:38.490 --> 00:12:42.430\nWe can say log files that we want it\nto send, and we can even attach graphs.\n\n246\n00:12:42.430 --> 00:12:44.830\nNow I have to hit save\nbefore I can add those.\n\n247\n00:12:44.830 --> 00:12:47.450\nSo I'm going to save that and edit it,\nand then and then we'll add in.\n\n248\n00:12:47.450 --> 00:12:50.890\nSo maybe I want disk utilization, so\n\n249\n00:12:50.890 --> 00:12:56.280\nunder commands I'll put disk utilizations\nand for the command I'll run df-h.\n\n250\n00:12:56.280 --> 00:12:59.850\nSo now it's going to send me\nthe output of my df-h command,\n\n251\n00:12:59.850 --> 00:13:02.210\nwhich will show me my disk utilization.\n\n252\n00:13:02.210 --> 00:13:07.020\nOr under logs, I might want to come in and\nadd log entries in here.\n\n253\n00:13:07.020 --> 00:13:10.710\nSomething like, maybe I want to know\nwho's VPNing into my system, so\n\n254\n00:13:10.710 --> 00:13:13.170\nI can come in and\npick something like OpenVPN, right?\n\n255\n00:13:13.170 --> 00:13:16.900\nSend me my OpenVPN logs,\njust send me 1000 rows.\n\n256\n00:13:18.160 --> 00:13:21.420\nAnd you can write filters for this to\nkinda restrict which rows get returned,\n\n257\n00:13:21.420 --> 00:13:24.020\nmaybe you just want error messages or\nwhatever, you can do that.\n\n258\n00:13:25.890 --> 00:13:27.370\nAnd then I can add graphs.\n\n259\n00:13:27.370 --> 00:13:29.190\nSo I can come in here and\nI can choose add, and\n\n260\n00:13:29.190 --> 00:13:31.070\nyou can pick all sorts\nof different graphs.\n\n261\n00:13:31.070 --> 00:13:35.700\nMaybe I want my wan traffic, and\nI can specify time spans and so\n\n262\n00:13:35.700 --> 00:13:37.890\non, and\nnow that's gonna get attached, too.\n\n263\n00:13:37.890 --> 00:13:38.570\nAll right.\n\n264\n00:13:38.570 --> 00:13:43.650\nSo when I hit save, now every Sunday\nit's going to generate this email and\n\n265\n00:13:43.650 --> 00:13:47.600\nsend it to me and I'll get this\nall information on my firewall.\n\n266\n00:13:47.600 --> 00:13:49.740\nNow, don't stop there.\n\n267\n00:13:49.740 --> 00:13:53.290\nYour p f sense firewall, it's actually\nnot set to send emails by default.\n\n268\n00:13:53.290 --> 00:13:54.960\nSo we do need to configure that.\n\n269\n00:13:54.960 --> 00:14:00.320\nSo we need under system, and advanced,\nand under your advanced screen,\n\n270\n00:14:00.320 --> 00:14:04.750\nyou've got notifications, and this is\nwhere you set up how pfSense notifies you.\n\n271\n00:14:04.750 --> 00:14:07.910\nThis is here even if you don't\ninstall the Mail Reports utility.\n\n272\n00:14:07.910 --> 00:14:11.510\nAnd in here, you'll see where\nyou can set up SMTP email.\n\n273\n00:14:11.510 --> 00:14:13.890\nSo if you wanted to email,\nyou need to come in here and\n\n274\n00:14:13.890 --> 00:14:18.450\nset an email server, credentials,\nthe from address, all that other stuff,\n\n275\n00:14:18.450 --> 00:14:20.660\nso that your system would be\nallowed to send those email.\n\n276\n00:14:20.660 --> 00:14:23.740\nIf you don't configure this,\nthe mail report package is pretty useless.\n\n277\n00:14:26.660 --> 00:14:28.990\nAll right.\nAnother good package to install,\n\n278\n00:14:28.990 --> 00:14:32.770\nif you're running pfSense\non top of VMware.\n\n279\n00:14:32.770 --> 00:14:37.650\nWell, installing the VMware tools in BSD\nis unfortunately not a very easy thing.\n\n280\n00:14:37.650 --> 00:14:39.750\nFortunately we've got a pfSense package.\n\n281\n00:14:39.750 --> 00:14:42.160\nIf you go under system and packages and\n\n282\n00:14:42.160 --> 00:14:44.710\navailable packages,\nyou'll find the open VM tools.\n\n283\n00:14:44.710 --> 00:14:49.060\nLet me browse down here to my O section.\n\n284\n00:14:49.060 --> 00:14:49.690\nThere it is.\n\n285\n00:14:49.690 --> 00:14:54.860\nOpen VM tools, and\nwhat that is Is the command line\n\n286\n00:14:54.860 --> 00:14:57.870\nVMware tools for\nsupporting a virtual machine.\n\n287\n00:14:57.870 --> 00:14:59.710\nIt doesn't have any of the GUI stuff,\nright, so\n\n288\n00:14:59.710 --> 00:15:03.475\nnone of the x11 graphical\nutilities because, you know,\n\n289\n00:15:03.475 --> 00:15:06.450\nyou're firewall doesn't have a graphical\ninterface, so it doesn't need those.\n\n290\n00:15:06.450 --> 00:15:09.631\nAnd it's enough to make it where\nVMware can do a graceful shutdown, or\n\n291\n00:15:09.631 --> 00:15:13.400\nyou can do snapshots, or\nyou can do other activities like that\n\n292\n00:15:13.400 --> 00:15:16.960\nthat are important for making VMware\nrun to its fullest capabilities.\n\n293\n00:15:16.960 --> 00:15:17.970\nSo you can install that.\n\n294\n00:15:17.970 --> 00:15:21.130\nThere's really no configuration needed,\nyou just install the package, and\n\n295\n00:15:21.130 --> 00:15:23.218\nnow your system becomes VMWare aware.\n\n296\n00:15:23.218 --> 00:15:26.468\nAll right.\n\n297\n00:15:26.468 --> 00:15:30.440\nNow, probably the most popular,\nI know Ronnie, you were telling me,\n\n298\n00:15:30.440 --> 00:15:32.530\nit's the most popular package.\n\n299\n00:15:32.530 --> 00:15:34.060\n>> It is.\nIf you go ahead and\n\n300\n00:15:34.060 --> 00:15:36.550\ntake a look at pfSense on its website.\n\n301\n00:15:36.550 --> 00:15:39.130\nIt'll tell you that this package\nthat we're about to take a look at,\n\n302\n00:15:39.130 --> 00:15:44.140\nwhich is squid, is by far the most popular\npackage that is downloaded and installed.\n\n303\n00:15:44.140 --> 00:15:45.860\nYou can add up all the other packages and\n\n304\n00:15:45.860 --> 00:15:49.770\nit doesn't compare to the number of\ntimes squid is actually installed.\n\n305\n00:15:49.770 --> 00:15:51.710\n>> Now, squid what it is, is a proxy.\n\n306\n00:15:51.710 --> 00:15:53.993\nYou can set up your firewall\nto be a proxy server.\n\n307\n00:15:53.993 --> 00:15:57.699\nNow if you never used a proxy server\nI'm not surprised, they are not\n\n308\n00:15:57.699 --> 00:16:01.872\nterribly popular today but back in\nthe day When you have dial-up networks.\n\n309\n00:16:01.872 --> 00:16:05.194\nWhat a proxy server did is instead of\nallowing people to go directly out to\n\n310\n00:16:05.194 --> 00:16:09.010\nthe Internet themselves,\nthey had to pass through the proxy server.\n\n311\n00:16:09.010 --> 00:16:12.750\nAnd the main reason they did that was for\ncaching, performance improvements.\n\n312\n00:16:12.750 --> 00:16:15.860\nIf I have five computers and\nthey all go to cnn.com,\n\n313\n00:16:15.860 --> 00:16:19.400\nthey're all downloading\nthat web page five times.\n\n314\n00:16:19.400 --> 00:16:22.260\nSo technically I kinda\nwasted bandwidth there.\n\n315\n00:16:22.260 --> 00:16:24.180\nWouldn't it have been nice\nif I'd downloaded it for\n\n316\n00:16:24.180 --> 00:16:27.370\none of them and\nthen just sent copies to the other four?\n\n317\n00:16:27.370 --> 00:16:29.080\nJust download it once and share it.\n\n318\n00:16:29.080 --> 00:16:31.430\nThat's what proxies were\noriginally designed to do.\n\n319\n00:16:31.430 --> 00:16:33.450\nThey provided caching.\n\n320\n00:16:33.450 --> 00:16:37.360\nWell, as broadband came about and now we\nhave tons of bandwidth that's out there,\n\n321\n00:16:37.360 --> 00:16:39.180\npeople don't really care\nabout caching anymore so\n\n322\n00:16:39.180 --> 00:16:41.900\nthat aspect of proxies is\nnot really useful anymore.\n\n323\n00:16:41.900 --> 00:16:45.620\nIf you just install Squid by itself and\nturn it on, that's it,\n\n324\n00:16:45.620 --> 00:16:50.680\nit's on but you don't really benefit\nfrom the cache like you used to.\n\n325\n00:16:50.680 --> 00:16:55.100\nSo normally we couple Squid\nwith a content filter.\n\n326\n00:16:55.100 --> 00:16:56.930\nA popular one out there is SquidGuard, but\n\n327\n00:16:56.930 --> 00:16:59.038\neven more popular is one\ncalled Dansguardian.\n\n328\n00:16:59.038 --> 00:17:03.780\nAnd what Dansguardian does is it allows\nyou to look at not just the URLs, but\n\n329\n00:17:03.780 --> 00:17:08.630\nit allows you to look at the keywords and\nimages that are found inside of a web\n\n330\n00:17:08.630 --> 00:17:10.440\npage to determine whether\nit should be filtered.\n\n331\n00:17:10.440 --> 00:17:13.070\nSo you can filter on things like\nhate speech and pornography and\n\n332\n00:17:13.070 --> 00:17:14.400\nall sorts of stuff like that.\n\n333\n00:17:14.400 --> 00:17:19.440\nAnd that becomes really useful for schools\nand homes and families that want to\n\n334\n00:17:19.440 --> 00:17:23.210\ncontrol the type of content that\ntheir machines are exposed to.\n\n335\n00:17:23.210 --> 00:17:25.940\nSo the first part of getting that\nto work is to install Squid.\n\n336\n00:17:25.940 --> 00:17:27.120\nIt's just a normal package.\n\n337\n00:17:27.120 --> 00:17:28.490\nYou add it in.\n\n338\n00:17:28.490 --> 00:17:30.290\nSquid's actually\noperational out of the box.\n\n339\n00:17:30.290 --> 00:17:34.050\nIt's actually running once you install\nthe package, and you're in business.\n\n340\n00:17:35.180 --> 00:17:38.010\nThe other things, though,\nlike if we install Dansguardian,\n\n341\n00:17:38.010 --> 00:17:41.900\nanother package that we add on,\nit's not running out of the box and\n\n342\n00:17:41.900 --> 00:17:44.220\nwe're gonna have to tweak that and\nconfigure it a bit.\n\n343\n00:17:44.220 --> 00:17:47.740\nSo let's take a look at an example of\nkinda getting those things fired up\n\n344\n00:17:47.740 --> 00:17:49.210\nand in place.\n\n345\n00:17:49.210 --> 00:17:52.050\nFirst off, once they're installed,\nI've installed Dansguardian and Squid.\n\n346\n00:17:52.050 --> 00:17:53.970\nThose two pieces are what I'm\ngonna need to make this work.\n\n347\n00:17:54.980 --> 00:18:00.230\nWe can go under Services and Dansguardian,\nand here's where its configuration is.\n\n348\n00:18:00.230 --> 00:18:06.540\nIf we go under Services, you don't see\nSquid in that list, you see Proxy server.\n\n349\n00:18:06.540 --> 00:18:09.140\nThis is another one where the package\nname doesn't match the menu item,\n\n350\n00:18:09.140 --> 00:18:10.730\nwhich is slightly annoying.\n\n351\n00:18:10.730 --> 00:18:12.680\nBut we can go in here and\nwe can see that, and\n\n352\n00:18:12.680 --> 00:18:15.860\nyou'll see the proxy interface is\nset to my LAN interface by default.\n\n353\n00:18:15.860 --> 00:18:17.450\nUsers are allowed through.\n\n354\n00:18:17.450 --> 00:18:19.520\nI don't really have to customize Squid.\n\n355\n00:18:19.520 --> 00:18:21.000\nIt's already running.\n\n356\n00:18:21.000 --> 00:18:23.380\nBut there's two things that\nwe may want to customize.\n\n357\n00:18:23.380 --> 00:18:25.970\nOne is transparent proxy.\n\n358\n00:18:25.970 --> 00:18:28.960\nBy default,\nclient computers don't use a proxy.\n\n359\n00:18:28.960 --> 00:18:31.040\nYou have to tell them to use the proxy.\n\n360\n00:18:31.040 --> 00:18:34.060\nWell, if you choose a transparent proxy,\nthen any traffic passing\n\n361\n00:18:34.060 --> 00:18:38.180\nthrough this firewall will be proxied\nthrough it and you get that protection.\n\n362\n00:18:38.180 --> 00:18:39.780\nSo you might want to turn that on.\n\n363\n00:18:39.780 --> 00:18:41.270\nIn my case though,\nI'm gonna manually set it.\n\n364\n00:18:41.270 --> 00:18:42.600\nWe normally do policies or\n\n365\n00:18:42.600 --> 00:18:45.560\nwhatever to push out to our clients\nto make them use the proxy.\n\n366\n00:18:45.560 --> 00:18:47.540\nThe other thing you might wanna\nchange is the default port.\n\n367\n00:18:47.540 --> 00:18:49.606\nThe default port is 3128.\n\n368\n00:18:49.606 --> 00:18:53.483\nYou might wanna change that to some\nother port, but I'll leave mine at 3128.\n\n369\n00:18:53.483 --> 00:18:56.254\nAnd the reason I'm gonna leave it,\nis my client's aren't actually\n\n370\n00:18:56.254 --> 00:18:59.504\ngonna directly connect to Squid,\nthey're gonna connect to Dansguardian, and\n\n371\n00:18:59.504 --> 00:19:02.060\nthen Dansguardian will pass\nthe traffic through Squid for me.\n\n372\n00:19:02.060 --> 00:19:04.645\nSo that's why I'm not really worried\nabout those port numbers there.\n\n373\n00:19:04.645 --> 00:19:06.781\nAll right, so\nthat one's already up and running.\n\n374\n00:19:06.781 --> 00:19:11.190\nI'm gonna jump over to Dansguardian,\nand now I've gotta get it set up.\n\n375\n00:19:11.190 --> 00:19:14.360\nAnd just to kinda show you here\nI'm gonna browse to a website and\n\n376\n00:19:14.360 --> 00:19:18.270\nI know I've mentioned CNN a few times,\nso I'm gonna browse to cnn.com.\n\n377\n00:19:18.270 --> 00:19:22.870\nSo there we go we can see that\nI can get to cnn.com just fine.\n\n378\n00:19:22.870 --> 00:19:26.890\nAll right, so when I go back\nhere to my main home page, or\n\n379\n00:19:26.890 --> 00:19:30.640\nmy Dansguardian page,\nwe can see Enable Dansguardian.\n\n380\n00:19:30.640 --> 00:19:33.640\nIt's pretty obvious I'm gonna need\nthat option, so I'll check that off.\n\n381\n00:19:33.640 --> 00:19:35.320\nAnd then where we're gonna listen.\n\n382\n00:19:35.320 --> 00:19:37.230\nNow the default is\nlistening on the loopback.\n\n383\n00:19:37.230 --> 00:19:38.830\nIt's kind of listening for\nits own traffic.\n\n384\n00:19:38.830 --> 00:19:42.040\nI'm gonna change that to\nlistening on my LAN interface.\n\n385\n00:19:42.040 --> 00:19:44.851\nI wanna monitor traffic from\nmy clients coming through.\n\n386\n00:19:44.851 --> 00:19:50.260\nThe listen port defaults to 8080 and\nthat's a pretty common proxy port,\n\n387\n00:19:50.260 --> 00:19:54.200\nso I'll leave it at 8080 but I could\nspecify a different one if I wanted to.\n\n388\n00:19:54.200 --> 00:19:58.416\nThen we've got options to tweak how\nmany connections we support and so on.\n\n389\n00:19:58.416 --> 00:20:00.370\nMost of us will want to leave\nthat at the default, so\n\n390\n00:20:00.370 --> 00:20:01.600\nI'm just going to leave those be.\n\n391\n00:20:02.740 --> 00:20:05.800\nDown here, though,\nis where we get to the proxy IP.\n\n392\n00:20:05.800 --> 00:20:09.117\nNow if you look at it,\nthe default is 127.0.0.1.\n\n393\n00:20:09.117 --> 00:20:13.889\nIt's gonna proxy right here against\nthe firewall, and the proxy port is 3128.\n\n394\n00:20:13.889 --> 00:20:15.648\nIt's looking for Squid.\n\n395\n00:20:15.648 --> 00:20:17.160\nNow this loopback, though,\n\n396\n00:20:17.160 --> 00:20:20.500\nis a little bit of a problem cuz Squid is\nactually listening on my LAN interface.\n\n397\n00:20:20.500 --> 00:20:23.700\nSo I'm gonna put in my\nLAN interface IP here.\n\n398\n00:20:23.700 --> 00:20:25.241\nAnd then my port is 3128.\n\n399\n00:20:25.241 --> 00:20:27.362\nYou can type it in if you want,\nbut it is the default so\n\n400\n00:20:27.362 --> 00:20:28.677\nI don't really have to do that.\n\n401\n00:20:28.677 --> 00:20:30.872\nSo I'm gonna save that.\n\n402\n00:20:30.872 --> 00:20:34.992\nDansguardian is now turned on and\nit's set to use that proxy, so\n\n403\n00:20:34.992 --> 00:20:39.400\nit's gonna pass through Squid,\nso we've got that set.\n\n404\n00:20:39.400 --> 00:20:43.770\nNow it's enabled, but\nI've got my basic configuration.\n\n405\n00:20:43.770 --> 00:20:46.720\nAnd if you look up here across the top\nyou'll see all the different things that\n\n406\n00:20:46.720 --> 00:20:47.880\nwe can configure.\n\n407\n00:20:47.880 --> 00:20:51.010\nIf you go to blacklist,\nhere we can configure a blacklist or\n\n408\n00:20:51.010 --> 00:20:54.390\nwe can use an Internet blacklist for\nURLs to block.\n\n409\n00:20:54.390 --> 00:20:56.940\nBut the whole reason the guy,\nDan, who made Dansguardian,\n\n410\n00:20:56.940 --> 00:21:00.170\nthe whole reason he created this, he said,\nlook, blacklists aren't effective.\n\n411\n00:21:00.170 --> 00:21:02.670\nNew URLs are constantly coming out and\nthese get out of date.\n\n412\n00:21:02.670 --> 00:21:04.960\nSo there's really no\npoint in even using them.\n\n413\n00:21:04.960 --> 00:21:09.050\nInstead you want to do text-based content\nfilters that are looking for keywords and\n\n414\n00:21:09.050 --> 00:21:11.080\nstuff to block on regardless of URL.\n\n415\n00:21:11.080 --> 00:21:13.246\nBut if you have a blacklist\nyou can use it.\n\n416\n00:21:13.246 --> 00:21:15.710\nYou can punch it right in here,\npunch in the URL for it and\n\n417\n00:21:15.710 --> 00:21:17.790\nyou'll filter based on that traffic.\n\n418\n00:21:17.790 --> 00:21:20.620\nBut more commonly we're\ngoing to use these ACLs.\n\n419\n00:21:20.620 --> 00:21:24.010\nAnd under ACLs you'll see we\ncan do antivirus scanning,\n\n420\n00:21:24.010 --> 00:21:25.760\nwe can do pics detection.\n\n421\n00:21:25.760 --> 00:21:29.170\nIt can actually do crazy things\nlike looking at images to detect\n\n422\n00:21:29.170 --> 00:21:33.950\nhow much of a flesh tone is used in the\nimage to determine if it's pornography.\n\n423\n00:21:33.950 --> 00:21:35.580\nIt's pretty entertaining stuff.\n\n424\n00:21:35.580 --> 00:21:38.380\nPhrase lists,\nwhere we can look for keywords,\n\n425\n00:21:38.380 --> 00:21:40.980\nand you'll notice on each of\nthese there's one access list.\n\n426\n00:21:40.980 --> 00:21:43.290\nThe default is that list\nwill apply to everybody.\n\n427\n00:21:43.290 --> 00:21:44.850\nYou can create more than one list, and\n\n428\n00:21:44.850 --> 00:21:48.230\nhave different lists apply to\ndifferent people in your organization.\n\n429\n00:21:48.230 --> 00:21:50.390\nWe've got site lists and URL lists.\n\n430\n00:21:50.390 --> 00:21:54.040\nUnder site lists here, for example,\nI might come in and choose to block.\n\n431\n00:21:54.040 --> 00:21:56.840\nAnd you can just come in here and\nmodify this list.\n\n432\n00:21:56.840 --> 00:22:00.980\nAnd you can add in,\nlike here I'll just add cnn.com.\n\n433\n00:22:00.980 --> 00:22:02.310\nI'm gonna block it.\n\n434\n00:22:02.310 --> 00:22:04.170\nI'm also blocking badboys.com apparently.\n\n435\n00:22:04.170 --> 00:22:05.435\nI don't know what that is.\n\n436\n00:22:05.435 --> 00:22:06.960\n>> [LAUGH]\n>> Apparently that's a default.\n\n437\n00:22:06.960 --> 00:22:08.290\nSo I'll come down here and\n\n438\n00:22:08.290 --> 00:22:11.650\nyou'll see that there's exceptions\nyou can put in here and other things,\n\n439\n00:22:11.650 --> 00:22:14.950\nto configure what it is that you're going\nto be allowing your people to get to.\n\n440\n00:22:14.950 --> 00:22:17.920\nSo while a proxy,\nwe don't benefit from the cache.\n\n441\n00:22:18.980 --> 00:22:20.765\nYou still benefit from the cache,\nit's just not so\n\n442\n00:22:20.765 --> 00:22:22.562\nnoticeable anymore cuz we have so\nmuch bandwidth.\n\n443\n00:22:22.562 --> 00:22:25.767\nBut you definitely benefit from being\nable to do these content filters.\n\n444\n00:22:25.767 --> 00:22:29.986\nAnd once I've got that in place, it uses\nConJobs and things to update itself, but\n\n445\n00:22:29.986 --> 00:22:31.960\nit's usually really, really fast.\n\n446\n00:22:31.960 --> 00:22:33.070\nI'm just gonna make sure that's saved.\n\n447\n00:22:33.070 --> 00:22:36.490\nI'm gonna double-check one other\nthing here under my groups.\n\n448\n00:22:36.490 --> 00:22:39.540\nYou'll see this default filter group,\nI'm just gonna double-check and\n\n449\n00:22:39.540 --> 00:22:42.210\nmake sure that it is set to do a scan.\n\n450\n00:22:42.210 --> 00:22:42.900\nIt is, good.\n\n451\n00:22:42.900 --> 00:22:45.600\nSo that's the default,\njust to do a scan of the system.\n\n452\n00:22:45.600 --> 00:22:49.140\nIf it wasn't set for\ndefaults then it wouldn't scan the data.\n\n453\n00:22:49.140 --> 00:22:53.096\nBut at this point If I set my web\nbrowser up to use my proxy server,\n\n454\n00:22:53.096 --> 00:22:54.504\nI should get blocked.\n\n455\n00:22:54.504 --> 00:22:56.338\nI should not be able to get to CNN.\n\n456\n00:22:56.338 --> 00:22:57.383\nLet's see if it works.\n\n457\n00:22:57.383 --> 00:22:59.093\nSo I'm gonna take\nInternet Explorer here and\n\n458\n00:22:59.093 --> 00:23:00.720\nI'm gonna set it to use that proxy server.\n\n459\n00:23:02.730 --> 00:23:06.117\nAnd I'm just gonna set this port to 8080\nlike we saw in the little setup wizard.\n\n460\n00:23:07.700 --> 00:23:11.380\nAnd once that's done I'm\ngonna open up a page and\n\n461\n00:23:11.380 --> 00:23:13.700\nhope that Internet Explorer\nhasn't cached it.\n\n462\n00:23:13.700 --> 00:23:14.450\nOh, shoot, it has.\n\n463\n00:23:14.450 --> 00:23:16.370\nAll right, let's just close this and\n\n464\n00:23:16.370 --> 00:23:19.870\nwe'll open up an all-new\nInternet Explorer window.\n\n465\n00:23:19.870 --> 00:23:21.000\nBoy, how much junk am I running here?\n\n466\n00:23:22.840 --> 00:23:23.590\nAnd let's see.\n\n467\n00:23:24.620 --> 00:23:29.268\nWell, I'm getting access denied on that,\nand oh, you know what's happening here?\n\n468\n00:23:29.268 --> 00:23:34.124\nI did cnn.com by itself, not www.cnn.com.\n\n469\n00:23:34.124 --> 00:23:34.741\nBut actually,\n\n470\n00:23:34.741 --> 00:23:38.135\nyou guys probably saw right here that\nI was getting this Access Denied.\n\n471\n00:23:38.135 --> 00:23:40.600\nAnd this is coming from Squid,\nI'm being blocked.\n\n472\n00:23:40.600 --> 00:23:42.370\nSo it's actually blocking my traffic and\n\n473\n00:23:42.370 --> 00:23:44.800\nkind of filtering out my\naccess to go out there.\n\n474\n00:23:44.800 --> 00:23:48.980\nAnd that's really the whole point is that\nwe can filter based on certain things.\n\n475\n00:23:48.980 --> 00:23:52.010\nSquid by itself won't\nblock you on the way out.\n\n476\n00:23:52.010 --> 00:23:54.307\nYou can go out.\nIt's caching by default.\n\n477\n00:23:54.307 --> 00:23:57.474\nYou can turn on authentication in\nSquid and now it's going to look for\n\n478\n00:23:57.474 --> 00:24:00.749\nuser names and passwords to make sure\nthat you can get in And oh, shoot,\n\n479\n00:24:00.749 --> 00:24:03.057\nI've managed to lock myself\nout of the firewall.\n\n480\n00:24:03.057 --> 00:24:06.260\nSo [LAUGH] this is something we\nhave to be careful with, right?\n\n481\n00:24:06.260 --> 00:24:10.235\nMy proxy settings are apparently locking\nme out of my firewall, but fortunately,\n\n482\n00:24:10.235 --> 00:24:12.355\nI can just go and\nturn off the proxy setting.\n\n483\n00:24:12.355 --> 00:24:15.540\nIf this were a transparent proxy,\nI'd be in real trouble here, right?\n\n484\n00:24:15.540 --> 00:24:19.216\nBut since it's not a transparent one,\nI can just turn off the proxy, and\n\n485\n00:24:19.216 --> 00:24:20.671\nI'll be able to get back in.\n\n486\n00:24:20.671 --> 00:24:23.782\nBut the cool part here is,\nthat we can go in and filter that traffic,\n\n487\n00:24:23.782 --> 00:24:25.748\nwe can require users to\nput in a username and\n\n488\n00:24:25.748 --> 00:24:28.334\npassword just to be able to\nget into the system and so on.\n\n489\n00:24:28.334 --> 00:24:33.416\nAnd that's all kind of\nthe part of what squid and\n\n490\n00:24:33.416 --> 00:24:38.294\ncan do to kind of provide\nus that secure environment.\n\n491\n00:24:38.294 --> 00:24:40.616\nSo pretty cool stuff there.\n\n492\n00:24:40.616 --> 00:24:43.630\nAll right, I got two more I wanna\ntalk about before we wrap up.\n\n493\n00:24:43.630 --> 00:24:46.510\nThe next one is FreeRADIUS, all right?\n\n494\n00:24:46.510 --> 00:24:49.790\nWhen we set up authentication\non our pfSence firewall,\n\n495\n00:24:49.790 --> 00:24:53.310\nusually we're gonna authenticate against\nlike a Microsoft Active Directory server,\n\n496\n00:24:53.310 --> 00:24:56.560\nan LDAP server, or\na RADIUS server somewhere else.\n\n497\n00:24:56.560 --> 00:25:00.390\nBut if this is at your home, you may not\nhave a RADIUS server somewhere else, so\n\n498\n00:25:00.390 --> 00:25:03.040\nyou can set one up right\non top of pfSense.\n\n499\n00:25:03.040 --> 00:25:04.990\nAnd for doing that, we can use FreeRADIUS.\n\n500\n00:25:04.990 --> 00:25:06.225\nIt's in your packages.\n\n501\n00:25:06.225 --> 00:25:07.920\nUnder All Packages, you'll find it.\n\n502\n00:25:07.920 --> 00:25:10.400\nThere's FreeRADIUS and FreeRADIUS 2.\n\n503\n00:25:10.400 --> 00:25:13.870\nIf you're running the latest version of\npfSense, you'll only see FreeRADIUS 2.\n\n504\n00:25:13.870 --> 00:25:16.920\nAnd I've already installed it right here,\nthe FreeRADIUS package.\n\n505\n00:25:16.920 --> 00:25:20.470\nNow the package by itself,\nit's pretty simple.\n\n506\n00:25:20.470 --> 00:25:21.760\nIt's not really crazy.\n\n507\n00:25:21.760 --> 00:25:26.160\nIf we just go under Services and\nFreeRADIUS, you'll find it right there.\n\n508\n00:25:26.160 --> 00:25:28.400\nAnd we are a RADIUS server.\n\n509\n00:25:28.400 --> 00:25:30.920\nAnd so now you can come in and\nyou can add user accounts right here.\n\n510\n00:25:30.920 --> 00:25:32.840\nAnd you start to define\nthese RADIUS accounts.\n\n511\n00:25:32.840 --> 00:25:35.790\nMaybe all your family members or\nyour workplace associates,\n\n512\n00:25:35.790 --> 00:25:37.180\nyou define them right here.\n\n513\n00:25:37.180 --> 00:25:41.680\nAnd then not only can the firewall\nauthenticate against this RADIUS database,\n\n514\n00:25:41.680 --> 00:25:43.880\nbut any other appliances\nyou have in your network.\n\n515\n00:25:43.880 --> 00:25:46.950\nYou might have switches or\nwireless access points, and\n\n516\n00:25:46.950 --> 00:25:49.695\nthey can authenticate against\nthis RADIUS server too.\n\n517\n00:25:49.695 --> 00:25:52.425\nAnd even better, on the RADIUS server,\nwe can turn around and\n\n518\n00:25:52.425 --> 00:25:56.255\ndo an LDAP authentication against\nthings like an Active Directory server.\n\n519\n00:25:56.255 --> 00:26:01.005\nSo now we've got a fully featured\nRADIUS server right here on pfSense.\n\n520\n00:26:01.005 --> 00:26:02.605\nIt can be useful.\n\n521\n00:26:02.605 --> 00:26:03.275\nThe reality is,\n\n522\n00:26:03.275 --> 00:26:06.925\nI think most companies will have other\nservers that are doing this role.\n\n523\n00:26:06.925 --> 00:26:08.395\nBut, for home, if you need a quick and\n\n524\n00:26:08.395 --> 00:26:10.295\ndirty RADIUS server,\nthis is a great way to spin one up.\n\n525\n00:26:11.580 --> 00:26:12.885\nAnd then the last one.\n\n526\n00:26:12.885 --> 00:26:16.711\nIn a mission-critical environment where\nyour firewall's really important,\n\n527\n00:26:16.711 --> 00:26:19.083\nthey're gonna have it attached to a UPS,\nright?\n\n528\n00:26:19.083 --> 00:26:22.184\nAnd the number one manufacturer\nof UPS's out there is APC.\n\n529\n00:26:22.184 --> 00:26:25.865\nAnd APC, their power supplies have USB and\n\n530\n00:26:25.865 --> 00:26:30.774\nserial ports that you can\nconnect your firewall that will\n\n531\n00:26:30.774 --> 00:26:36.000\nnotify the firewall that\nwe're running on battery.\n\n532\n00:26:36.000 --> 00:26:39.860\nOr do a graceful shutdown of the firewall\nif you're about to run out of battery.\n\n533\n00:26:39.860 --> 00:26:42.470\nBut, by default,\npfSense can't see any of that.\n\n534\n00:26:42.470 --> 00:26:49.960\nSo there's a package, if I jump into my\npackages screen here, called APC UPSD.\n\n535\n00:26:49.960 --> 00:26:54.329\nSo it's the APC,\nI think it's American Power Company and\n\n536\n00:26:54.329 --> 00:26:58.086\nthen UPS,\nuninterruptible power supply demon.\n\n537\n00:26:58.086 --> 00:27:01.235\nThis is a service that runs in\nthe background that listens for\n\n538\n00:27:01.235 --> 00:27:02.480\nthose UPS calls.\n\n539\n00:27:02.480 --> 00:27:04.260\nAnd so it'll let us know if\nwe've got a problem there.\n\n540\n00:27:04.260 --> 00:27:08.820\nIf we go up here to services, you'll\nsee it right at the beginning, Apcupsd.\n\n541\n00:27:08.820 --> 00:27:12.496\nAnd right here, we can tell it,\nI want to enable it,\n\n542\n00:27:12.496 --> 00:27:15.938\nI've got a UPS connected and\nthen how I connect.\n\n543\n00:27:15.938 --> 00:27:20.676\nNow, how you connect might be a serial\nport, it might be a USB connection, and so\n\n544\n00:27:20.676 --> 00:27:24.878\nyou’ll need to specify the type of\ncable that you’re connected with.\n\n545\n00:27:24.878 --> 00:27:28.730\nAnd they’ve got all the cable part numbers\nright here that’ll let the system know how\n\n546\n00:27:28.730 --> 00:27:30.040\nit’s connected.\n\n547\n00:27:30.040 --> 00:27:31.706\nAnd then the actual\ndevice name right here.\n\n548\n00:27:31.706 --> 00:27:34.549\nAnd see how they've got /dev/tty?\n\n549\n00:27:34.549 --> 00:27:38.160\nThat'll be mapped to a serial port,\nor you'll see USB ones.\n\n550\n00:27:38.160 --> 00:27:40.340\nHere, like USB.\n\n551\n00:27:40.340 --> 00:27:42.960\nHere's network, if it's a network UPS.\n\n552\n00:27:42.960 --> 00:27:44.230\nAnd you can tell it how to watch for it.\n\n553\n00:27:44.230 --> 00:27:46.233\nAnd now when the UPS\nis running on battery,\n\n554\n00:27:46.233 --> 00:27:48.186\nthe firewall will get a message about it.\n\n555\n00:27:48.186 --> 00:27:50.397\nAnd when the UPS is\nrunning low on battery,\n\n556\n00:27:50.397 --> 00:27:52.970\nit'll gracefully shut down the firewall.\n\n557\n00:27:52.970 --> 00:27:54.710\nSo great way to be able to see that.\n\n558\n00:27:54.710 --> 00:27:57.622\nAnd get that information\nusing the APC UPS demon.\n\n559\n00:27:59.930 --> 00:28:01.360\nAll right, they give it all,\n\n560\n00:28:01.360 --> 00:28:04.640\nreally well documented right here as far\nas the syntax that you need to put in.\n\n561\n00:28:04.640 --> 00:28:07.038\nYou can put the poll time,\nkill on power fail, right,\n\n562\n00:28:07.038 --> 00:28:10.548\nit can hibernate the UPS on power fail,\nit can do all sorts of different things.\n\n563\n00:28:10.548 --> 00:28:14.160\nAnd you set it all right here,\nhow long you wait before you shut down,\n\n564\n00:28:14.160 --> 00:28:17.979\nthe other intervals and it just runs\nin the background and watch the UPS.\n\n565\n00:28:17.979 --> 00:28:20.525\nThere's a surprising amount\nof features in here.\n\n566\n00:28:20.525 --> 00:28:23.065\nAnd you can have it email you,\nwhich is always a nice thing.\n\n567\n00:28:23.065 --> 00:28:25.055\nThe firewall emails you,\nhey I'm running on battery.\n\n568\n00:28:25.055 --> 00:28:28.005\nJust want to let you know, heads up.\n\n569\n00:28:28.005 --> 00:28:29.765\nAll right, so that's a quick and\n\n570\n00:28:29.765 --> 00:28:33.565\ndirty kind of overview of some of the more\npopular packages that are out there.\n\n571\n00:28:33.565 --> 00:28:34.390\nObviously there's a lot.\n\n572\n00:28:34.390 --> 00:28:36.875\nRight, there's probably\na good 100 packages there.\n\n573\n00:28:36.875 --> 00:28:40.361\nWe covered, I don't know,\nwhat, 10, maybe 10 or 12.\n\n574\n00:28:40.361 --> 00:28:41.765\nBut they are the more popular ones,\n\n575\n00:28:41.765 --> 00:28:46.860\nthe ones that are out there, word of\ncaution, don't get into package overload.\n\n576\n00:28:46.860 --> 00:28:49.640\nAll of these packages are programs\nrunning on your firewall, and\n\n577\n00:28:49.640 --> 00:28:54.520\nyour firewall only has so much in the way\nof resources, so much memory and CPU.\n\n578\n00:28:54.520 --> 00:28:57.730\nSo the more packages you load, typically,\nthe slower your firewall gets.\n\n579\n00:28:57.730 --> 00:28:59.170\nSo just keep an eye on it.\n\n580\n00:28:59.170 --> 00:29:00.820\nIf you're running on standard PC hardware,\n\n581\n00:29:00.820 --> 00:29:02.860\nyou probably have a lot\nof extra resources.\n\n582\n00:29:02.860 --> 00:29:06.010\nBut, if you're running on\nan actual firewall appliance,\n\n583\n00:29:06.010 --> 00:29:10.440\nthey usually do the bare minimum CPU, the\nbare minimum network, that kinda stuff.\n\n584\n00:29:10.440 --> 00:29:12.980\nAnd so\nyou don't have a lot of extra resources.\n\n585\n00:29:12.980 --> 00:29:16.660\nAnother thing to remember,\nif you do a NanoBSD install,\n\n586\n00:29:16.660 --> 00:29:20.040\nlike if you do an install to Flash,\na lot of these packages aren't supported.\n\n587\n00:29:20.040 --> 00:29:21.240\nSo some of them may not show up.\n\n588\n00:29:21.240 --> 00:29:23.710\nIf you don't see a package in your list,\n\n589\n00:29:23.710 --> 00:29:28.260\nyou're probably running a NanoBSD install\ninstead of a full pfSense install.\n\n590\n00:29:29.490 --> 00:29:30.720\nSo just be aware of\nthose little variations.\n\n591\n00:29:31.970 --> 00:29:35.260\n>> So, pfSense with all of the packages\nthat we have gives us the ability to not\n\n592\n00:29:35.260 --> 00:29:38.530\nonly expand some of the capabilities\nof the pfSense firewall, but\n\n593\n00:29:38.530 --> 00:29:42.290\nalso customize it to\nexactly what you need.\n\n594\n00:29:42.290 --> 00:29:45.240\nThat's all that we have for\nour pfSense packages today.\n\n595\n00:29:45.240 --> 00:29:46.330\nGlad you joined us.\n\n596\n00:29:46.330 --> 00:29:47.529\nStay tuned for more pfSense.\n\n597\n00:29:47.529 --> 00:29:53.580\n[MUSIC]\n\n",
          "vimeoId": "132319752"
        },
        {
          "description": null,
          "length": "2015",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-7-2-selecting_hardware-063015-1.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-7-2-selecting_hardware-063015-1-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/techskills-pfsense/techskills-pfsense-7-2-selecting_hardware-063015-1-sm.jpg",
          "title": "Selecting Hardware",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:03.267\n[SOUND] In this segment,\n\n2\n00:00:03.267 --> 00:00:08.329\nwe're gonna take a look at selecting\n\n3\n00:00:08.329 --> 00:00:13.079\nhardware for a pfSense firewall.\n\n4\n00:00:13.079 --> 00:00:18.330\nNow, Don, when I take a look at that,\nI have an old machine sitting around.\n\n5\n00:00:18.330 --> 00:00:20.610\nIt's running a 386 computer.\n\n6\n00:00:20.610 --> 00:00:22.920\nIt's got a 30 gig hard drive.\n\n7\n00:00:22.920 --> 00:00:24.350\nI should be able to run it and\nthat should be fine.\n\n8\n00:00:24.350 --> 00:00:25.480\nRight?\n\n9\n00:00:25.480 --> 00:00:28.020\n>> It's one of the neat\nthings about pfSense.\n\n10\n00:00:28.020 --> 00:00:31.960\nIf you wanna Cisco viral, if you\nwant it to run Cisco's ASA software,\n\n11\n00:00:31.960 --> 00:00:33.410\nyou have to buy their hardware.\n\n12\n00:00:33.410 --> 00:00:36.770\nBut with pfSense,\nit runs on top of FreeBSD, so\n\n13\n00:00:36.770 --> 00:00:39.680\nanything BSD can run off of,\npfSense can run off of.\n\n14\n00:00:39.680 --> 00:00:41.180\nSo, a lot of people do that.\n\n15\n00:00:41.180 --> 00:00:43.090\nThey say, well I've got this\nold computer sitting around.\n\n16\n00:00:43.090 --> 00:00:45.000\nLet me turn that into a firewall.\n\n17\n00:00:45.000 --> 00:00:48.580\nWell, let me tell you guys,\nfree BSD will run on a lot of stuff.\n\n18\n00:00:48.580 --> 00:00:50.840\nIt will run on things that are ten,\n15 years old.\n\n19\n00:00:50.840 --> 00:00:52.550\nIt will run fine.\n\n20\n00:00:52.550 --> 00:00:55.250\nWell, the base operating\nsystem will run fine.\n\n21\n00:00:55.250 --> 00:00:58.120\nBut then the throughput of\nyour firewall will be garbage.\n\n22\n00:00:58.120 --> 00:01:02.870\nAnd so I hear about so\nmany people like, yeah I tried pfSense.\n\n23\n00:01:02.870 --> 00:01:05.140\nBut it was just so\nslow I couldn't keep running it.\n\n24\n00:01:05.140 --> 00:01:06.240\nAnd I said what did you deploy it on?\n\n25\n00:01:06.240 --> 00:01:10.913\nAnd they say well I had this old\nlaptop I used to use and how old?\n\n26\n00:01:10.913 --> 00:01:11.679\nWell about eight years old.\n\n27\n00:01:11.679 --> 00:01:13.633\n>> [LAUGH]\n>> What do you expect to get out of\n\n28\n00:01:13.633 --> 00:01:15.360\nthat thing it's junk hardware.\n\n29\n00:01:15.360 --> 00:01:19.560\nSo when you build up a pfSense\nfirewall you really have two choices.\n\n30\n00:01:19.560 --> 00:01:21.150\nYou can go out and\nyou can buy an appliance\n\n31\n00:01:21.150 --> 00:01:24.190\nfrom somebody's that manufactured\nsomething to be dedicated as a firewall.\n\n32\n00:01:24.190 --> 00:01:27.170\nOr you can build your own system,\nbut if you build your own system,\n\n33\n00:01:27.170 --> 00:01:29.750\nit's not just carte blanche,\nyou can't just pick anything.\n\n34\n00:01:29.750 --> 00:01:34.830\nWe need to keep in mind the performance of\npfSense when we select our hardware and\n\n35\n00:01:34.830 --> 00:01:36.480\nchoose what's appropriate for\n\n36\n00:01:36.480 --> 00:01:38.450\nthe amount of traffic that\nwe're gonna push through it.\n\n37\n00:01:38.450 --> 00:01:41.220\nYour firewall can only be as good\nas the hardware you give it.\n\n38\n00:01:41.220 --> 00:01:44.740\nSo, it's not just a free for\nall use any old hardware.\n\n39\n00:01:44.740 --> 00:01:47.320\nThere is a little bit of logic that's\ngoing into selecting that hardware.\n\n40\n00:01:47.320 --> 00:01:51.200\n>> When we talk about selecting\nthe pfSense firewall's hardware then.\n\n41\n00:01:51.200 --> 00:01:53.170\nThere is a place for guidance.\n\n42\n00:01:53.170 --> 00:01:55.390\nIn other words,\neven though you might go I know six or\n\n43\n00:01:55.390 --> 00:01:59.210\nseven old machines that'd be perfectly\nfine, you don't just wanna start that way.\n\n44\n00:01:59.210 --> 00:02:04.210\nWhat you wanna do is you wanna go to\npfSense's website at pfSense.org, and\n\n45\n00:02:04.210 --> 00:02:07.710\ntake a look at what they consider\ntheir minimum hardware requirements\n\n46\n00:02:07.710 --> 00:02:10.240\nto go ahead and begin starting that way.\n\n47\n00:02:10.240 --> 00:02:14.808\nSo I simply open up a web browser and\nI went ahead and select products and\n\n48\n00:02:14.808 --> 00:02:17.751\ncame up to pfSense hardware and\nit tells you,\n\n49\n00:02:17.751 --> 00:02:22.300\nit gives you that flexibility\nto chose the hardware you want.\n\n50\n00:02:22.300 --> 00:02:23.756\nBut then as you go down through it,\n\n51\n00:02:23.756 --> 00:02:25.980\nof course it asks you to\nlist some different things.\n\n52\n00:02:25.980 --> 00:02:29.055\nWe'll gonna come back to that in\nthe moment, but what we are looking for\n\n53\n00:02:29.055 --> 00:02:32.060\nis right here under hardware\nrequirements and guidance.\n\n54\n00:02:32.060 --> 00:02:37.450\nAnd you can see right away, that\nthe requirements really aren't that high.\n\n55\n00:02:37.450 --> 00:02:43.079\nIt actually running on machines what I\nwas actually saying which is an hardware,\n\n56\n00:02:43.079 --> 00:02:45.160\nan old, no piece, an old PC.\n\n57\n00:02:45.160 --> 00:02:46.410\nExcuse me.\n\n58\n00:02:46.410 --> 00:02:52.610\nThat was actually running like a 500\nmegahertz processor with 256 megs of RAM.\n\n59\n00:02:52.610 --> 00:02:54.880\nSo I've actually had a PC like that, and\n\n60\n00:02:54.880 --> 00:02:58.125\neven though that's the minimum\nrequirement, notice that directly\n\n61\n00:02:58.125 --> 00:03:03.290\nunderneat that, they tell you what is\ntheir recommended minimum instead.\n\n62\n00:03:03.290 --> 00:03:07.159\nThey're telling you that if you just want\nto install pfSense to get it installed and\n\n63\n00:03:07.159 --> 00:03:09.438\nrunning, you could do it\non something this old.\n\n64\n00:03:09.438 --> 00:03:13.943\nBut if you want to have any type or\nperformance at all on this machine,\n\n65\n00:03:13.943 --> 00:03:15.807\nwhat you want is right here,\n\n66\n00:03:15.807 --> 00:03:21.630\nat least as the minimum a CP running one\ngigahertz and at least a gigabyte of RAM.\n\n67\n00:03:21.630 --> 00:03:24.430\nNow when you start talking about that,\n\n68\n00:03:24.430 --> 00:03:26.990\nthere's other requirements that\nare actually going to be needed.\n\n69\n00:03:26.990 --> 00:03:31.950\nIf you can install pfSense, of course that\neither means you're gonna use a USB or\n\n70\n00:03:31.950 --> 00:03:35.960\na CD and then the minimum\nhard drive requirements too.\n\n71\n00:03:35.960 --> 00:03:38.990\nNotice that they actually do talk\nabout a gigabyte hard drive.\n\n72\n00:03:38.990 --> 00:03:41.410\nHard to find one that's\nnot going to be a gig, but\n\n73\n00:03:41.410 --> 00:03:44.700\nif you want to go to another system that's\nembedded, in other words, one without\n\n74\n00:03:44.700 --> 00:03:49.330\nmoving parts in it, it tells you you need\nat least a gigabyte of compact flash.\n\n75\n00:03:49.330 --> 00:03:51.530\nAnd if you're gonna manage\nit from the command line,\n\n76\n00:03:51.530 --> 00:03:54.640\nyou're either going to need a serial\nport for the console, some of\n\n77\n00:03:54.640 --> 00:03:58.920\nthe new ones actually require like a mini\nUSB if you have those systems installed.\n\n78\n00:03:58.920 --> 00:04:02.120\nSo that is the basic hardware\n\n79\n00:04:02.120 --> 00:04:06.640\nwhen we just look at a way of\nactually being able to be installed.\n\n80\n00:04:06.640 --> 00:04:10.140\nBut to get more functionality of course,\nit also means,\n\n81\n00:04:10.140 --> 00:04:13.265\nbecause we're actually running traffic\nthrough it, we need to go ahead and\n\n82\n00:04:13.265 --> 00:04:17.410\nalso select network adapters that\nare actually going to work and even though\n\n83\n00:04:17.410 --> 00:04:23.331\npfSense says, hey we'll support a lot of\nthem, they recommend Intel-based NIC.\n\n84\n00:04:23.331 --> 00:04:26.080\nNow Don, why Intel-based NICs?\n\n85\n00:04:26.080 --> 00:04:27.400\nWhat's going on with that?\n\n86\n00:04:27.400 --> 00:04:29.039\n>> Yeah,\nit really comes down to two things.\n\n87\n00:04:29.039 --> 00:04:31.362\nIt's performance and driver compatibility.\n\n88\n00:04:31.362 --> 00:04:32.116\nAll right?\n\n89\n00:04:32.116 --> 00:04:35.942\nWhen you deploy pfSense, everything\nyou just showed on that website,\n\n90\n00:04:35.942 --> 00:04:38.250\nit's all about minimal configurations.\n\n91\n00:04:38.250 --> 00:04:42.690\nSo if you're gonna deploy a basic firewall\nwith an inside and an outside interface,\n\n92\n00:04:42.690 --> 00:04:45.780\nand you're just doing packet filtering,\nthat configurations great.\n\n93\n00:04:45.780 --> 00:04:48.690\nBut when you start getting into\nthings that are more advanced,\n\n94\n00:04:48.690 --> 00:04:52.390\nlike you wanna run packages,\nyou wanna do VPNs,\n\n95\n00:04:52.390 --> 00:04:56.620\nyou wanna do deep packet inspection,\nthat takes extra resources.\n\n96\n00:04:56.620 --> 00:04:59.740\nWell, if you're planning on\ndeploying things like VLAN, and\n\n97\n00:04:59.740 --> 00:05:03.370\nVLAN tagging,\nnot every network adapter supports that.\n\n98\n00:05:03.370 --> 00:05:06.502\nAnd so across the board,\nif you go and look at all the pfSense\n\n99\n00:05:06.502 --> 00:05:11.094\ndocumentation they almost all say, boy we\nreally recommend Intel network adapters.\n\n100\n00:05:11.094 --> 00:05:13.376\nAnd it's not because they love Intel,\n\n101\n00:05:13.376 --> 00:05:16.763\nor they get a ton of money from Intel,\nor maybe they do, but\n\n102\n00:05:16.763 --> 00:05:21.040\nif you have an Intel NIC you know that\ncertain features are going to work.\n\n103\n00:05:21.040 --> 00:05:23.670\nYou know that VLAN Tagging\nis going to function,\n\n104\n00:05:23.670 --> 00:05:28.930\nyou know that it'll participate\nproperly in a bonded NIC environment.\n\n105\n00:05:28.930 --> 00:05:31.756\nIf you go with some cheap, off-the-shelf,\n\n106\n00:05:31.756 --> 00:05:34.400\nthird-party network adapters from\nsome company you've never heard of,\n\n107\n00:05:34.400 --> 00:05:36.570\nyou don't know if those\nadvanced functions will work.\n\n108\n00:05:36.570 --> 00:05:39.956\nYour basic connectivity will work just\nfine but the advanced stuff won't.\n\n109\n00:05:39.956 --> 00:05:44.230\nSo be careful with that especially if\nyou're doing things like buying NICs that\n\n110\n00:05:44.230 --> 00:05:48.090\nhave TCP offload engines, TOE, or\nif you've got a multi-port NIC.\n\n111\n00:05:48.090 --> 00:05:50.038\nIf you get a network adapter\nwith four ports on it.\n\n112\n00:05:50.038 --> 00:05:52.128\nRight?\nWhich is pretty common in a firewall,\n\n113\n00:05:52.128 --> 00:05:55.840\nthe Intel ones, FreeBSD has\nthe drivers for them, they work great.\n\n114\n00:05:55.840 --> 00:05:58.310\nIf you go with some of the off-brand ones,\nyou know, even,\n\n115\n00:05:58.310 --> 00:06:00.060\neven some of the bigger\nbrands like Broadcom,\n\n116\n00:06:00.060 --> 00:06:03.520\nyou're just not certain if those\nare gonna work inside a freeBSD, and\n\n117\n00:06:03.520 --> 00:06:07.110\nthus work inside a pfsense, so be aware\nof that with your hardware selection.\n\n118\n00:06:07.110 --> 00:06:09.050\n>> And, normally what the NICs\nthat we're talking about,\n\n119\n00:06:09.050 --> 00:06:12.360\nthey recommend at least\ngigabit network adapters.\n\n120\n00:06:12.360 --> 00:06:15.920\nOr higher if you can because you're gonna\nbe sending a lot of traffic through it,\n\n121\n00:06:15.920 --> 00:06:17.600\nand that's the recommendation.\n\n122\n00:06:17.600 --> 00:06:21.580\nNow the CPU also is another\nconsideration we have to think about.\n\n123\n00:06:21.580 --> 00:06:25.180\nAnd they base it off of how much\ntraffic you are going to be\n\n124\n00:06:25.180 --> 00:06:27.480\nsending through that box itself.\n\n125\n00:06:27.480 --> 00:06:30.860\nSo notice they talk about\nten to 20 megabits all up\n\n126\n00:06:30.860 --> 00:06:32.475\nto 501 megabits per second.\n\n127\n00:06:32.475 --> 00:06:37.184\nAnd so, of course, the more traffic that\nyou can send the higher end processor that\n\n128\n00:06:37.184 --> 00:06:39.011\nyou won't to actually go with.\n\n129\n00:06:39.011 --> 00:06:45.860\nAnd here, at the 501+ megabytes, multiples\ncores at greater than two gigahertz.\n\n130\n00:06:45.860 --> 00:06:49.658\nNotice you can go all the way down if\nyou're talking about ten to 20 megabits.\n\n131\n00:06:49.658 --> 00:06:52.950\nLess than four years old,\nIntel or AMD CPU,\n\n132\n00:06:52.950 --> 00:06:56.990\na clock that leads at\nleast 500 megahertz here.\n\n133\n00:06:56.990 --> 00:07:01.474\nSo the range of hardware can be very\ndifferent when you take a look at all\n\n134\n00:07:01.474 --> 00:07:03.076\nthese considerations.\n\n135\n00:07:03.076 --> 00:07:05.539\nBut as you continue to go down through it.\n\n136\n00:07:05.539 --> 00:07:07.072\nRight?\nThe more features you add in,\n\n137\n00:07:07.072 --> 00:07:10.676\nthe better your processor needs to be,\nthe more traffic you're gonna be sending\n\n138\n00:07:10.676 --> 00:07:14.227\nthrough and the more of those different\nthings like Don was talking about such as\n\n139\n00:07:14.227 --> 00:07:18.120\nVLANs and VLAN Tagging, you need those\nNICS that are going to support that.\n\n140\n00:07:18.120 --> 00:07:22.615\nBut in the end result of everything,\nit doesn't matter what\n\n141\n00:07:22.615 --> 00:07:26.560\nNICS that you pick if they don't\nshow up on this list right here.\n\n142\n00:07:26.560 --> 00:07:31.200\nThe hardware compatibility list and\nit says as pfSense is based on FreeBSD,\n\n143\n00:07:31.200 --> 00:07:35.470\nit's the same hardware\ncompatibility as FreeBSD, and so,\n\n144\n00:07:35.470 --> 00:07:40.685\nif you're not sure, if you're there going,\nI wonder if this NIC will work with it.\n\n145\n00:07:40.685 --> 00:07:45.695\nThe best place for you to go and find out,\nis gonna be on this link right here.\n\n146\n00:07:45.695 --> 00:07:47.875\nAnd if I go ahead and select that link.\n\n147\n00:07:47.875 --> 00:07:52.807\nThat will bring you to the FreeBSD's page,\nand you can see where it says FreeBSD.org\n\n148\n00:07:52.807 --> 00:07:57.534\nand this release on this hardware note for\nthe latest version, and then from there\n\n149\n00:07:57.534 --> 00:08:02.149\nyou can scroll down and you can see the\nsupported processors and system boards.\n\n150\n00:08:02.149 --> 00:08:03.112\nAnd other devices.\n\n151\n00:08:03.112 --> 00:08:06.319\nI'm just gonna scroll on down through\nthere, by selecting the link.\n\n152\n00:08:06.319 --> 00:08:08.929\nAnd so if you're looking for\nan AMD processor,\n\n153\n00:08:08.929 --> 00:08:11.353\nit tells you which ones\nare actually there.\n\n154\n00:08:11.353 --> 00:08:13.599\nThe 386 based processors, and\n\n155\n00:08:13.599 --> 00:08:17.530\nyou can continue to go on down\nthrough there and verify.\n\n156\n00:08:17.530 --> 00:08:21.023\nSo at anytime when you're looking for\nhardware, if you are going to decide to\n\n157\n00:08:21.023 --> 00:08:23.510\nbuild your own,\nhere is probably the best place to go.\n\n158\n00:08:23.510 --> 00:08:24.240\nRight, Don?\n\n159\n00:08:24.240 --> 00:08:24.880\n>> That's right.\n\n160\n00:08:24.880 --> 00:08:26.540\nAnd this is the only way to be sure.\n\n161\n00:08:26.540 --> 00:08:28.573\nYou know if you want to know\nthat hardware is gonna work,\n\n162\n00:08:28.573 --> 00:08:29.580\nit needs to be on this list.\n\n163\n00:08:29.580 --> 00:08:32.614\nNow, just because it's on the list doesn't\nmean that it's amazing and awesome, right?\n\n164\n00:08:32.614 --> 00:08:33.372\n>> [LAUGH]\n>> Look at some of\n\n165\n00:08:33.372 --> 00:08:34.950\nthose sun ultra cards that are on there.\n\n166\n00:08:34.950 --> 00:08:36.390\nThose are pretty old.\n\n167\n00:08:36.390 --> 00:08:39.205\nAnd so, there might be stuff that's\non there that is supported by bsd but\n\n168\n00:08:39.205 --> 00:08:41.300\nit's not going to give you\nthe performance you want.\n\n169\n00:08:41.300 --> 00:08:44.580\nSo, still keep that in mind, but\nthere's a lot that's in there.\n\n170\n00:08:44.580 --> 00:08:46.740\nAlso be careful with\nthe different architectures.\n\n171\n00:08:46.740 --> 00:08:47.920\nLike in the CPU list.\n\n172\n00:08:47.920 --> 00:08:50.020\nIt'll list cpus like arm's cpus.\n\n173\n00:08:50.020 --> 00:08:54.100\nWell, there might not be a PF sense\nversion that's compiled for ARM.\n\n174\n00:08:54.100 --> 00:08:57.160\nWhen you go to download PF sense,\nthat was one of the choices you have,\n\n175\n00:08:57.160 --> 00:08:58.260\nwas to pick your architecture.\n\n176\n00:08:58.260 --> 00:09:03.310\nAnd, for most of us, there's the 386\narchitecture, which is the 32 bit.\n\n177\n00:09:03.310 --> 00:09:07.370\nThere's the X8664,\nwhich is the 64 bit architecture, and\n\n178\n00:09:07.370 --> 00:09:10.080\nthen they do have some arm for\nthe nano builds and stuff,\n\n179\n00:09:10.080 --> 00:09:15.020\nso you might have a processor that VSD\nsupports in one of their ports, but\n\n180\n00:09:15.020 --> 00:09:18.500\nisn't supported inside of PF Sense,\nso be aware of that too.\n\n181\n00:09:18.500 --> 00:09:21.634\nBut, at the end of the day,\nthe free VSD compatibility list,\n\n182\n00:09:21.634 --> 00:09:24.300\nthat's the one that we really\nwant to watch out for.\n\n183\n00:09:24.300 --> 00:09:26.200\n>> So, today is really a day\nthat we're gonna shop for\n\n184\n00:09:26.200 --> 00:09:28.940\nsome different hardware is what\nwe're going to end up doing.\n\n185\n00:09:28.940 --> 00:09:31.940\nAnd the reason why is because\nall of us want, at times here,\n\n186\n00:09:31.940 --> 00:09:36.400\nto either build our own or to make that\nsystem to be what we need it to be.\n\n187\n00:09:36.400 --> 00:09:39.370\nSo when you begin, there's a lot\nof choices out there depending on\n\n188\n00:09:39.370 --> 00:09:43.170\nhow much work and\neffort you're willing to put into this.\n\n189\n00:09:43.170 --> 00:09:46.410\nDon, we can spend sometimes\nmaybe weeks going, okay,\n\n190\n00:09:46.410 --> 00:09:50.480\nthis versus this processor,\nthis NIC versus this NIC.\n\n191\n00:09:50.480 --> 00:09:52.770\nBut sometimes you need a little\nbit more help than that.\n\n192\n00:09:52.770 --> 00:09:56.200\nAnd the good thing is, on pfSense,\nthey can give us some help there too.\n\n193\n00:09:56.200 --> 00:09:59.693\n>> Yeah, so I kind of made a list of\nthe things that I always take into\n\n194\n00:09:59.693 --> 00:10:02.590\nconsideration when I\nselect a new firewall.\n\n195\n00:10:02.590 --> 00:10:07.200\nAnd the very first two things in my list\nwere compatibility and performance, right?\n\n196\n00:10:07.200 --> 00:10:07.970\nCompatibility.\n\n197\n00:10:07.970 --> 00:10:11.390\nI need this hardware to work\nreally well with pfSense.\n\n198\n00:10:11.390 --> 00:10:12.820\nI don't want it to fight drivers.\n\n199\n00:10:12.820 --> 00:10:13.664\nI don't wanna have to,\n\n200\n00:10:13.664 --> 00:10:16.280\nyou know worry about the next\nupdate breaking on my hardware.\n\n201\n00:10:16.280 --> 00:10:18.020\nI want it to be really compatible.\n\n202\n00:10:18.020 --> 00:10:20.460\nAnd I want to get the performance\nI need out of it.\n\n203\n00:10:20.460 --> 00:10:22.810\nSo those are two things\nthat I really consider.\n\n204\n00:10:22.810 --> 00:10:26.240\nAll the other things that I\nconsider are important, but\n\n205\n00:10:26.240 --> 00:10:30.900\none of the most important other\nones is commercial support.\n\n206\n00:10:30.900 --> 00:10:33.180\nIf you're deploying this in your home, and\n\n207\n00:10:33.180 --> 00:10:34.990\nyou break the firewall,\nit's just your home.\n\n208\n00:10:34.990 --> 00:10:36.150\nIt's no big deal.\n\n209\n00:10:36.150 --> 00:10:39.020\nBut if you're in your company and\nyou have thousands of employees and\n\n210\n00:10:39.020 --> 00:10:41.210\nthe firewall breaks and\nyou can't figure out why,\n\n211\n00:10:41.210 --> 00:10:44.410\nit's nice to have somebody you\ncan call to get help with.\n\n212\n00:10:44.410 --> 00:10:49.000\nAlright, well the PF sense at PFsense.org,\nyou can sign up for a gold membership.\n\n213\n00:10:49.000 --> 00:10:50.960\nYou can actually get\nsupport instance with them.\n\n214\n00:10:50.960 --> 00:10:54.650\nI think they charge like $200 an hour or\nsomething to call and get help but\n\n215\n00:10:54.650 --> 00:10:58.700\nthere's somebody you can call and\nget help with for the software.\n\n216\n00:10:58.700 --> 00:11:00.740\nBut for the hardware,\nthat's your hardware.\n\n217\n00:11:00.740 --> 00:11:03.510\nYou bought it.\nYou got to figure that out on your own.\n\n218\n00:11:03.510 --> 00:11:05.650\nSo one of the things that PF Sense does,\n\n219\n00:11:05.650 --> 00:11:09.462\nis they actually work in conjunction\nwith another company called Net Gate.\n\n220\n00:11:09.462 --> 00:11:13.090\nPF Sense is a non profit organization.\n\n221\n00:11:13.090 --> 00:11:15.200\nMost of their employees\nthough actually work for\n\n222\n00:11:15.200 --> 00:11:19.090\nNetgate who manufactures firewalls and\nthey are a for profit company.\n\n223\n00:11:19.090 --> 00:11:23.240\nAnd so if you buy Netgate hardware, and\nyou're running pfSense on it you can\n\n224\n00:11:23.240 --> 00:11:26.130\nactually get support and they'll support\nboth the software and the hardware.\n\n225\n00:11:26.130 --> 00:11:29.950\nSo we might choose to just go and\nbuy an outright appliance, so\n\n226\n00:11:29.950 --> 00:11:31.170\nthat we get the commercial support.\n\n227\n00:11:31.170 --> 00:11:33.810\nAnd Ron,\nyou've worked with these a good bit, and\n\n228\n00:11:33.810 --> 00:11:36.490\nit is nice to be able to have that person\nthere to call and get help from, right?\n\n229\n00:11:36.490 --> 00:11:37.430\n>> It really is.\n\n230\n00:11:37.430 --> 00:11:40.240\nWe purchased a pfSense appliance.\n\n231\n00:11:40.240 --> 00:11:42.580\nAnd the nice thing about it is that,\nwhen we purchased that,\n\n232\n00:11:42.580 --> 00:11:45.680\nthey went ahead and added in\nthe additional I think it's one year\n\n233\n00:11:45.680 --> 00:11:50.460\nof support that we can call them with, and\nit really is something that is a benefit,\n\n234\n00:11:50.460 --> 00:11:53.460\nespecially when you get to that point\nwhere you're stuck on something.\n\n235\n00:11:53.460 --> 00:11:56.110\nAnd they're saying they'll\nsupport the pfSense firewall, and\n\n236\n00:11:56.110 --> 00:12:00.170\nthey'll also, because they are also\nthe ones that work with the hardware,\n\n237\n00:12:00.170 --> 00:12:01.910\nthey know exactly what\nyou're talking about.\n\n238\n00:12:01.910 --> 00:12:05.450\nThey're not just guessing and\ntelling you what they're talking about.\n\n239\n00:12:05.450 --> 00:12:08.210\nSo, one of the neatest places,\nat least that I think,\n\n240\n00:12:08.210 --> 00:12:12.390\nto start when you start thinking about\nselecting hardware, is why not go directly\n\n241\n00:12:12.390 --> 00:12:17.440\nto the people that actually made\nthe PF Sense operating system itself, or\n\n242\n00:12:17.440 --> 00:12:21.450\nthe firewall itself, as well as the people\nthat are actually doing the hardware?\n\n243\n00:12:21.450 --> 00:12:26.310\nSo on PF Sense's site, they actually\ndo have a store that you can go to.\n\n244\n00:12:26.310 --> 00:12:28.190\nAnd underneath that store they'll list for\n\n245\n00:12:28.190 --> 00:12:31.740\nyou all of the different appliances\nthat they have available.\n\n246\n00:12:31.740 --> 00:12:36.390\nAnd the nice thing about it is that they\nare specific to what they believe is gonna\n\n247\n00:12:36.390 --> 00:12:39.230\nbe the most compatible types\nof hardware that you need,\n\n248\n00:12:39.230 --> 00:12:43.020\nalong with PF Sense as well as the\nperformance level that you need as well.\n\n249\n00:12:43.020 --> 00:12:46.360\nAnd so working with all of these\ndifferent ones I think the most\n\n250\n00:12:46.360 --> 00:12:49.460\npopular system that is out there for\nthem is this SG2440.\n\n251\n00:12:51.270 --> 00:12:55.360\nAnd the reason why I know that is that,\nit's actually like on back order.\n\n252\n00:12:55.360 --> 00:12:57.680\nHas been on back order\nsince I think like April.\n\n253\n00:12:57.680 --> 00:12:59.060\nAnd so, everybody and\n\n254\n00:12:59.060 --> 00:13:02.380\ntheir mother apparently wants\nthis little box right here.\n\n255\n00:13:02.380 --> 00:13:05.815\nThe one that I've worked with\nis right here on this 4860, and\n\n256\n00:13:05.815 --> 00:13:08.187\nyou can see that it\nactually gives you a nice,\n\n257\n00:13:08.187 --> 00:13:12.580\nat least a nice overall business usage,\nsmall business, and to medium business.\n\n258\n00:13:12.580 --> 00:13:14.490\nAnd that's something that,\nthat you want to consider.\n\n259\n00:13:14.490 --> 00:13:18.255\nBecause you can spend way too much\non a firewall for your business and,\n\n260\n00:13:18.255 --> 00:13:22.270\neven though it actually will provide you\nthe same support as you would a small one.\n\n261\n00:13:22.270 --> 00:13:25.250\nThe cost difference is actually\nwhat you're looking at.\n\n262\n00:13:25.250 --> 00:13:28.685\nAnd you can also see on the cpu speed,\nis where it's a little bit different.\n\n263\n00:13:28.685 --> 00:13:32.675\nAnd for us, on some of these,\nit also of course it has RAM.\n\n264\n00:13:32.675 --> 00:13:35.425\nAnd then these maximum active connections.\n\n265\n00:13:35.425 --> 00:13:38.352\nThe difference between those two levels\non the ones that I've seen right there,\n\n266\n00:13:38.352 --> 00:13:40.565\nit about doubles the actual\nmaximum number of connections.\n\n267\n00:13:40.565 --> 00:13:42.700\nSo if you need more, that's the way to go.\n\n268\n00:13:42.700 --> 00:13:45.460\n>> Yeah, and here we're talking about\nthat throughput, that performance.\n\n269\n00:13:45.460 --> 00:13:48.240\nSo, remember that when we talk about an\nactive connection, I know I've showed it\n\n270\n00:13:48.240 --> 00:13:52.670\nin another episode, I've fired up just\nthe CNN web page, and when I did that,\n\n271\n00:13:52.670 --> 00:13:57.180\nit created over 1,000 state connections\ninside of there just for me.\n\n272\n00:13:57.180 --> 00:13:59.110\nSo when you look at that 8 million,\nyou're like, 8 million?\n\n273\n00:13:59.110 --> 00:14:00.100\nThat's a ton.\n\n274\n00:14:00.100 --> 00:14:04.090\nBut one person could be consuming\na thousand of those just opening one,\n\n275\n00:14:04.090 --> 00:14:05.060\nsingle webpage.\n\n276\n00:14:05.060 --> 00:14:08.605\nSo assuming that each person\nin your network consumed\n\n277\n00:14:08.605 --> 00:14:12.625\n10,000 active connections, that 8 million\nconnections that it supports right there.\n\n278\n00:14:12.625 --> 00:14:15.485\nIf we kind of divide that out,\ndo some math, carry the one or whatever,\n\n279\n00:14:15.485 --> 00:14:17.405\nyou end up with about 80,000 employees.\n\n280\n00:14:17.405 --> 00:14:19.325\nThat's a pretty big organization, right?\n\n281\n00:14:19.325 --> 00:14:22.395\nSo, just keep that in mind when you\nlook at these to figure out how many\n\n282\n00:14:22.395 --> 00:14:24.450\nconnections you're actually gonna\nbe able to get out of that.\n\n283\n00:14:24.450 --> 00:14:27.290\nAnd you might need to step-up to\none of the higher end firewalls.\n\n284\n00:14:27.290 --> 00:14:30.233\nYou might need a firewall that's\na higher end than any of the ones they\n\n285\n00:14:30.233 --> 00:14:30.959\noffer, right?\n\n286\n00:14:30.959 --> 00:14:34.500\nWhat's the biggest, baddest one we\nhave there, Ron, is that 1U model?\n\n287\n00:14:34.500 --> 00:14:38.220\n>> It is the 1U model with 2758 here.\n\n288\n00:14:38.220 --> 00:14:40.650\nAnd when you take a look\nat that connection,\n\n289\n00:14:40.650 --> 00:14:42.885\nit's still maxed out at 8 million.\n\n290\n00:14:42.885 --> 00:14:43.678\n>> Mm-hm.\n\n291\n00:14:43.678 --> 00:14:46.160\nSo you know what it's adding\nis more network interfaces but\n\n292\n00:14:46.160 --> 00:14:47.270\nit's the same amount of connection.\n\n293\n00:14:47.270 --> 00:14:51.060\nSo if you have an even bigger network,\nyou might not have a choice but\n\n294\n00:14:51.060 --> 00:14:52.600\nto go out and build your own firewall.\n\n295\n00:14:52.600 --> 00:14:56.570\nAnd if you're gonna build your own\nfirewall, you've gotta think about,\n\n296\n00:14:56.570 --> 00:14:59.990\ndo I have enough CPU power to handle\nthe packages that I'm gonna run and\n\n297\n00:14:59.990 --> 00:15:01.730\nthe packet inspection I'm gonna do?\n\n298\n00:15:01.730 --> 00:15:04.970\nAre my network adapters high enough\nbandwidth to be able to move things\n\n299\n00:15:04.970 --> 00:15:06.970\nthrough, and other things of that nature.\n\n300\n00:15:06.970 --> 00:15:10.370\nNow, you will find some websites out there\n\n301\n00:15:10.370 --> 00:15:14.230\nthat will recommend what are called\nvpn accelerator boards alright.\n\n302\n00:15:14.230 --> 00:15:16.380\nYou can buy these little\npci express cards.\n\n303\n00:15:16.380 --> 00:15:17.210\nThat you pop it in the firewall.\n\n304\n00:15:17.210 --> 00:15:19.480\nThey're not expensive, they're like $100.\n\n305\n00:15:19.480 --> 00:15:22.360\nThat'll add in hardware,\nencryption and decryption.\n\n306\n00:15:23.390 --> 00:15:25.210\nAlright, those I used to\nrecommend all the time.\n\n307\n00:15:25.210 --> 00:15:27.360\nThey were a great addition\nto your firewall.\n\n308\n00:15:27.360 --> 00:15:30.710\nThe problem is,\nthey haven't aged very well, and\n\n309\n00:15:30.710 --> 00:15:34.740\nmost of them have a throughput\nlimit of 45 megabit.\n\n310\n00:15:34.740 --> 00:15:38.524\nSo if you go and buy one of those high\nHIFN, that was the company that made most\n\n311\n00:15:38.524 --> 00:15:41.658\nof them, they had these ones and\nthey can do up to 45 megabit,\n\n312\n00:15:41.658 --> 00:15:44.994\nand they would handle the encryption,\ndecryption and hardware.\n\n313\n00:15:44.994 --> 00:15:49.537\nIt would take all the work of the cpu\nof your firewall which is really nice,\n\n314\n00:15:49.537 --> 00:15:53.600\nif your internet connection\nwas 45 megabits or lower.\n\n315\n00:15:53.600 --> 00:15:56.019\nBut if you have an 80 bit\ninternet connection or\n\n316\n00:15:56.019 --> 00:15:57.674\na gigabit internet connection.\n\n317\n00:15:57.674 --> 00:16:00.414\nYou far exceed what those\nlittle cards can handle.\n\n318\n00:16:00.414 --> 00:16:03.377\nAnd so it doesn't make sense to\nhave that hardware accelerator.\n\n319\n00:16:03.377 --> 00:16:07.004\nInstead, general purpose\nCPUs like your Intel Xeons,\n\n320\n00:16:07.004 --> 00:16:12.248\nthey have AES accelerators in them and so\nif you set your VPN tunnels up to use AES,\n\n321\n00:16:12.248 --> 00:16:16.670\nthen, you can take advantage of\nyour general purpose CPU for that.\n\n322\n00:16:16.670 --> 00:16:20.440\nSo, specialized hardware encoder,\ndecoder, that kind of stuff,\n\n323\n00:16:20.440 --> 00:16:24.880\nisn't really required anymore, as long as\nwe select the appropriate hardware for it.\n\n324\n00:16:24.880 --> 00:16:27.653\n>> Now Don, as we go on through some, just\na little bit more of the hardware here.\n\n325\n00:16:27.653 --> 00:16:30.090\nOn the storage options that\nI have in front of me,\n\n326\n00:16:30.090 --> 00:16:33.170\nit actually gives me the difference\nbetween Flash and SSD.\n\n327\n00:16:33.170 --> 00:16:35.920\nIs there a reason why\nI should choose Flash?\n\n328\n00:16:35.920 --> 00:16:39.548\n>> Flash is a lot cheaper than\ngetting an SSD drive in there.\n\n329\n00:16:39.548 --> 00:16:41.005\nSSD is normally larger.\n\n330\n00:16:41.005 --> 00:16:44.177\nSo, if you're gonna be maintaining\na lot of logfiles, and so\n\n331\n00:16:44.177 --> 00:16:46.950\non, then having SSD is\nthe better route to go.\n\n332\n00:16:46.950 --> 00:16:50.880\nBut if you're just trying to run a quick,\nsmooth system with as little hardware in\n\n333\n00:16:50.880 --> 00:16:55.560\nit as possible, running NanoBSD, then\nthat's where the flash memory comes in.\n\n334\n00:16:55.560 --> 00:16:57.820\nSo it's up to you which\none you want to choose.\n\n335\n00:16:57.820 --> 00:16:59.290\nIt used to be a big price difference.\n\n336\n00:16:59.290 --> 00:17:01.590\nNowadays it's really not that much\nof a price difference any more,\n\n337\n00:17:01.590 --> 00:17:05.550\nand you just get a lot more\nstorage with the SSD SIDE.\n\n338\n00:17:05.550 --> 00:17:08.120\nNow with the SSD SIDE,\nyou can do a full Intel of pfSense,\n\n339\n00:17:08.120 --> 00:17:11.250\nwith the flash side you're\nlimited to doing the nano\n\n340\n00:17:11.250 --> 00:17:15.080\ninstalls otherwise the lifetime of your\nflash memory gets reduced significantly.\n\n341\n00:17:15.080 --> 00:17:16.910\nAnd that means a lot\nof packages won't run.\n\n342\n00:17:16.910 --> 00:17:19.610\nAnd you won't be able to store\nas many log files, and so on.\n\n343\n00:17:19.610 --> 00:17:23.780\nSo these are the tradeoffs that we make\nwhen we choose between the storage types.\n\n344\n00:17:23.780 --> 00:17:26.010\n>> Yeah.\nThe only other additional consideration\n\n345\n00:17:26.010 --> 00:17:28.410\nthat we're really gonna\nbe concerned about here\n\n346\n00:17:28.410 --> 00:17:33.180\nis what pfSense says is also included in,\nwhich is that hardware support.\n\n347\n00:17:33.180 --> 00:17:36.042\nAnd that's probably one of the main\nreasons why you might choose\n\n348\n00:17:36.042 --> 00:17:39.190\nthis in a production network\nrather than building your own.\n\n349\n00:17:39.190 --> 00:17:43.970\nYou build your own, you are the support\nfor it, and that means if there is\n\n350\n00:17:43.970 --> 00:17:47.470\nsomething that's not working, well,\nyou're kind of stuck right there at\n\n351\n00:17:47.470 --> 00:17:50.300\nyour own knowledge and being able\nto actually do your own research.\n\n352\n00:17:50.300 --> 00:17:52.620\nWhereas here you actually have\nthe team that went ahead and\n\n353\n00:17:52.620 --> 00:17:56.720\ndeveloped everything to be compatible\nin the way that they want it to be.\n\n354\n00:17:56.720 --> 00:17:58.920\nSo that is one option for you to do that.\n\n355\n00:17:58.920 --> 00:18:02.710\nRemember that what this also comes\nwith is pfSense is already installed.\n\n356\n00:18:02.710 --> 00:18:05.730\nUsually it's actually checked\nbefore they actually send it out.\n\n357\n00:18:05.730 --> 00:18:09.180\nSo when we got our pfSense firewall,\nthere was a big yellow sheet of paper\n\n358\n00:18:09.180 --> 00:18:12.990\nthat said checked and tested by and\nsomebody actually signed their name to it.\n\n359\n00:18:12.990 --> 00:18:16.270\nSo that way you knew that the firewall had\nbeen started up and they were able to get\n\n360\n00:18:16.270 --> 00:18:20.820\nthe webpage and they thought everything\nwas fine when they shipped it out.\n\n361\n00:18:20.820 --> 00:18:25.050\nBut you can go the other route,\nwhich is the Netgate one, too.\n\n362\n00:18:25.050 --> 00:18:27.970\nAnd so,\nNetgate is kind of the pfSense firewall,\n\n363\n00:18:27.970 --> 00:18:30.770\nbut really without\nthe operating system or,\n\n364\n00:18:30.770 --> 00:18:34.940\nI shouldn't say the operating system,\npfSense actually installed on it, too.\n\n365\n00:18:34.940 --> 00:18:41.940\nSo if you go to Netgate, store.netgate.com\nI was trying to remember which one it is,\n\n366\n00:18:41.940 --> 00:18:46.210\nand you actually see that they go ahead\nand they build up some of these systems.\n\n367\n00:18:46.210 --> 00:18:49.130\nAnd the numbering system Don\nlooks just about the same.\n\n368\n00:18:49.130 --> 00:18:55.020\nI see a 2440 like I did on the pfSense\nbox, a 4860, just like the pfSense box.\n\n369\n00:18:55.020 --> 00:18:55.810\nAnd to tell you the truth,\n\n370\n00:18:55.810 --> 00:18:58.600\nit doesn't look like that there's really\nthat much difference beside the blue and\n\n371\n00:18:58.600 --> 00:19:01.430\nthe black color paint on here.\n\n372\n00:19:01.430 --> 00:19:05.110\nAnd so, here's another system\nthat we can actually choose.\n\n373\n00:19:05.110 --> 00:19:08.510\nAnd so, here's that hardware\nside that Don was talking about.\n\n374\n00:19:08.510 --> 00:19:11.300\n>> Yeah, and like I said, it's really\nthe same employees, the same people,\n\n375\n00:19:11.300 --> 00:19:14.050\nthis is how that nonprofit\norganization is able to keep going,\n\n376\n00:19:14.050 --> 00:19:16.080\nis that most of them work for Netgate.\n\n377\n00:19:16.080 --> 00:19:20.410\nSo, if you wanna support the PFNs project,\na great way to do it is to buy firewalls\n\n378\n00:19:20.410 --> 00:19:22.480\nfrom them that's a way\nto generate revenue.\n\n379\n00:19:22.480 --> 00:19:25.540\nNow if you wanna build your own,\nthen it's time to go shopping and\n\n380\n00:19:25.540 --> 00:19:27.360\nthere's a lot of different\nhardware out there and\n\n381\n00:19:27.360 --> 00:19:30.575\nit's easy to get kind of drawn in\nby the bells and whistles, but\n\n382\n00:19:30.575 --> 00:19:34.260\nthere's things that we need to think about\nwhen we select actual hardware components.\n\n383\n00:19:34.260 --> 00:19:39.470\nTwo big important ones that a lot of\npeople don't think about are noise and\n\n384\n00:19:39.470 --> 00:19:40.420\ntemperature.\n\n385\n00:19:40.420 --> 00:19:41.210\nAll right.\n\n386\n00:19:41.210 --> 00:19:45.270\nThe firewalls that Ronnie just showed you\na minute ago, they're all fanless systems.\n\n387\n00:19:45.270 --> 00:19:46.081\nThere's no fans in them.\n\n388\n00:19:46.081 --> 00:19:46.730\nRight?\n\n389\n00:19:46.730 --> 00:19:49.240\nThey run practically silent.\n\n390\n00:19:49.240 --> 00:19:51.080\nBut when we go out and\nwe buy our own boxes,\n\n391\n00:19:51.080 --> 00:19:53.430\nthey almost always have fans in them.\n\n392\n00:19:53.430 --> 00:19:56.740\nAnd if you're buying like\na one use server chassis,\n\n393\n00:19:56.740 --> 00:19:59.212\nthey can have fans on\nthem that are very noisy.\n\n394\n00:19:59.212 --> 00:20:02.390\nOne I've used a lot are like\nthe super micro server cases,\n\n395\n00:20:02.390 --> 00:20:03.770\nwhich you can buy on Newegg.\n\n396\n00:20:03.770 --> 00:20:07.500\nRonnie, can you do just like\na Newegg search for supermicro 1U.\n\n397\n00:20:07.500 --> 00:20:08.900\nI'm sure they'll turn up.\n\n398\n00:20:08.900 --> 00:20:12.720\nSo when you find these cases, they're\ngreat for building 1U servers which can be\n\n399\n00:20:12.720 --> 00:20:15.600\nused as a PFNs firewall if you\nwant really powerful stuff.\n\n400\n00:20:15.600 --> 00:20:20.700\nBut, the fan's are so noisy,\nI wouldn't dream of using it in my house.\n\n401\n00:20:20.700 --> 00:20:21.270\nRight?\n\n402\n00:20:21.270 --> 00:20:22.700\nIn a server room, it's fine.\n\n403\n00:20:22.700 --> 00:20:24.440\nIt'll blend right in\nwith all the other fans.\n\n404\n00:20:24.440 --> 00:20:24.990\nRight?\n\n405\n00:20:24.990 --> 00:20:28.730\nBut in your home, it's so much noise you\nwon't want to keep that thing turned on.\n\n406\n00:20:28.730 --> 00:20:29.530\nYeah, like that guy right there.\n\n407\n00:20:29.530 --> 00:20:32.160\nSUPERMICRO Barebones 1U Intel Intel Atom.\n\n408\n00:20:32.160 --> 00:20:34.585\nActually, that box right\nthere you're looking at.\n\n409\n00:20:34.585 --> 00:20:35.100\n>> [LAUGH] Is the one.\n\n410\n00:20:35.100 --> 00:20:37.210\n>> That is the same box we use for\n\n411\n00:20:37.210 --> 00:20:40.580\nthe firewall right here at the IT PRO TV\nstudios are actual production firewall\n\n412\n00:20:40.580 --> 00:20:44.205\nin that box, you got\nan Intel Atom D525 processor, right?\n\n413\n00:20:44.205 --> 00:20:45.928\nWell, let's talk about why\nI picked that one, right?\n\n414\n00:20:45.928 --> 00:20:47.870\nCuz I'm the one that picked it.\n\n415\n00:20:47.870 --> 00:20:49.430\nIt does have fans which are too noisy for\n\n416\n00:20:49.430 --> 00:20:53.060\nhome use but, I was putting it in a server\nroom so I didn't care about that.\n\n417\n00:20:53.060 --> 00:20:58.180\nIt has an Intel Atom processor which\ndoesn't have a lot of muscle behind it\n\n418\n00:20:58.180 --> 00:21:01.520\nbut, we're not pushing a ton\nof traffic here, right?\n\n419\n00:21:01.520 --> 00:21:03.520\nAnd very little of it's\nactually encrypted so\n\n420\n00:21:03.520 --> 00:21:06.070\nmoving it through the firewall\ndidn't require a lot of burden.\n\n421\n00:21:06.070 --> 00:21:09.590\nThe reason I picked the Atom is they\nhave a lower power consumption and\n\n422\n00:21:09.590 --> 00:21:11.230\nthey generate less heat.\n\n423\n00:21:11.230 --> 00:21:14.220\nWe could actually run that one fanless if\nwe want like, I could pop the fans out and\n\n424\n00:21:14.220 --> 00:21:14.940\nit'll run just fine.\n\n425\n00:21:14.940 --> 00:21:16.990\nThe Atom doesn't generate a lot of heat.\n\n426\n00:21:16.990 --> 00:21:20.541\nBut if we were to start pushing tons of\ndata, like gigabits of data through there,\n\n427\n00:21:20.541 --> 00:21:22.857\nthat Atom processor wouldn't\nbe able to handle it and\n\n428\n00:21:22.857 --> 00:21:24.306\nit would need to step up, right?\n\n429\n00:21:24.306 --> 00:21:26.498\nSo pull that screen back up.\n\n430\n00:21:26.498 --> 00:21:30.656\nSo, when we take a look at some of\nthe other components of the list there,\n\n431\n00:21:30.656 --> 00:21:33.602\nit says 200 watt low\nnoise AC/DC power supply.\n\n432\n00:21:33.602 --> 00:21:35.227\nSo that's an outright lie,\nit's very noisy.\n\n433\n00:21:35.227 --> 00:21:36.124\n>> [LAUGH]\n>> [LAUGH] But\n\n434\n00:21:36.124 --> 00:21:39.152\nwhen you look at other I\nguess in their defense,\n\n435\n00:21:39.152 --> 00:21:42.575\nthe power supply might be very quiet but\nthe case fans aren't.\n\n436\n00:21:42.575 --> 00:21:47.230\nThe other cool thing that this case\nhas is what's called IPMI, right?\n\n437\n00:21:47.230 --> 00:21:49.670\nIt's got out of band management on it.\n\n438\n00:21:49.670 --> 00:21:52.430\nThe firewall can be\ncompletely turned off and\n\n439\n00:21:52.430 --> 00:21:55.840\nI can browse to a webpage to look\nat the hardware and power it on.\n\n440\n00:21:55.840 --> 00:21:59.190\nSo if I ever get logged out of\nthe firewall, well I can't,\n\n441\n00:21:59.190 --> 00:22:00.380\nI can't get locked out of the firewall.\n\n442\n00:22:00.380 --> 00:22:04.420\nI can always access the console via\nthe IPMI log in, or I can power cycle,\n\n443\n00:22:04.420 --> 00:22:09.410\nI can do firmware resets, I can completely\ninstall pfSense by mounting an ISOM\n\n444\n00:22:09.410 --> 00:22:11.650\nto it virtually via the IPMI management.\n\n445\n00:22:11.650 --> 00:22:13.480\nThat's really powerful, all right?\n\n446\n00:22:13.480 --> 00:22:16.710\nIs your old laptop you have\nlying around gonna have that?\n\n447\n00:22:16.710 --> 00:22:17.330\nNo.\nAnd\n\n448\n00:22:17.330 --> 00:22:20.180\nthat's the way people set themselves\nup for failure with pfSense,\n\n449\n00:22:20.180 --> 00:22:22.170\nis choosing inadequate hardware.\n\n450\n00:22:22.170 --> 00:22:24.510\nDedicated hardware like\nthis can be really useful.\n\n451\n00:22:24.510 --> 00:22:27.170\nAnd here you see, this one $370, right?\n\n452\n00:22:27.170 --> 00:22:29.645\nAnd it's bare bones,\nit doesn't have any memory, right?\n\n453\n00:22:29.645 --> 00:22:31.950\nSo you gotta buy some RAM, and\nit doesn't have any storage.\n\n454\n00:22:31.950 --> 00:22:34.600\nBut it's got that Atom processor in there,\nit's ready to rock and\n\n455\n00:22:34.600 --> 00:22:37.340\nthis is pretty suitable for\nsmall and medium businesses.\n\n456\n00:22:37.340 --> 00:22:40.870\nIt is, literally, the firewall if\nyou're watching this video live,\n\n457\n00:22:40.870 --> 00:22:43.370\nif you're watching it recorded then you're\nnot going through that firewall, but\n\n458\n00:22:43.370 --> 00:22:46.280\nif you're watching this live, our video\nis passing through that box right\n\n459\n00:22:46.280 --> 00:22:47.560\nthere on the way out to the internet.\n\n460\n00:22:47.560 --> 00:22:51.870\nSo, great resource,\na great piece of equipment to use.\n\n461\n00:22:51.870 --> 00:22:53.242\nSUPERMICRO isn't the only one.\n\n462\n00:22:53.242 --> 00:22:56.317\nWe actually have a second firewall\nhere for the other company that's in\n\n463\n00:22:56.317 --> 00:22:59.511\nthe building with us and they're\nusing a Dell PowerEdge server, right?\n\n464\n00:22:59.511 --> 00:23:03.950\nA Dell PowerEdge with Zeon processors in\nit so it can handle a lot more traffic.\n\n465\n00:23:03.950 --> 00:23:06.561\nThey're handling multiple VPN tunnels and\n\n466\n00:23:06.561 --> 00:23:09.940\nthey're handling a lot of\nVoice over IP traffic.\n\n467\n00:23:09.940 --> 00:23:12.850\nAnd because they're doing all that,\nthey needed more performance than we did,\n\n468\n00:23:12.850 --> 00:23:15.160\nso they got a Dell PowerEdge Server.\n\n469\n00:23:15.160 --> 00:23:17.820\nIt has,\nwhat's Dell's remote management called?\n\n470\n00:23:17.820 --> 00:23:19.450\n>> Open Manage?\n\n471\n00:23:19.450 --> 00:23:20.630\n>> Dell Open, wait.\n\n472\n00:23:20.630 --> 00:23:21.327\n>> No.\n\n473\n00:23:21.327 --> 00:23:22.227\n>> Whatever they're called it.\n\n474\n00:23:22.227 --> 00:23:22.860\n>> Yeah.\n[LAUGH].\n\n475\n00:23:22.860 --> 00:23:23.527\n>> Open directory.\n\n476\n00:23:23.527 --> 00:23:25.250\n>> Whatever Dell's management is.\n>> Yeah.\n\n477\n00:23:25.250 --> 00:23:28.419\n>> HP has the Remote Insight, right?\n\n478\n00:23:28.419 --> 00:23:31.666\nAnd your inside boards are ILO,\nthe Inside Lights Out or\n\n479\n00:23:31.666 --> 00:23:34.340\nwhatever those cards are called.\n\n480\n00:23:34.340 --> 00:23:37.110\nSo, they all have kinda remote\nmanagement capabilities built into them.\n\n481\n00:23:37.110 --> 00:23:40.220\nThey get hardware support through\nDell because they bought it,\n\n482\n00:23:40.220 --> 00:23:44.070\nthey have it under warranty with Dell, and\nthey get software support through pfSense.\n\n483\n00:23:44.070 --> 00:23:47.550\nSo, they have companies that support\nthem for that infrastructure.\n\n484\n00:23:47.550 --> 00:23:49.310\nYou can do that.\nYou can choose the appropriate hardware.\n\n485\n00:23:49.310 --> 00:23:53.500\nJust be careful, sometimes systems can\nbe noisy, sometimes they can be hot and\n\n486\n00:23:53.500 --> 00:23:55.680\nthey're gonna need fans to cool them.\n\n487\n00:23:55.680 --> 00:23:58.805\nFor my firewall at home though,\nI went a different route.\n\n488\n00:23:58.805 --> 00:24:01.604\nI got a mini ITX case, right?\n\n489\n00:24:01.604 --> 00:24:02.674\nIt's a small system.\n\n490\n00:24:02.674 --> 00:24:04.253\nI run it completely fan less.\n\n491\n00:24:04.253 --> 00:24:07.334\nI did an Atom processor again because\nI knew at home I am not going to have\n\n492\n00:24:07.334 --> 00:24:08.130\na ton of traffic.\n\n493\n00:24:08.130 --> 00:24:11.790\nMy Internet connection kind of stinks\nanyway so I can only push so much over it.\n\n494\n00:24:11.790 --> 00:24:14.570\nAnd I didn't want fans cuz\nI wanted it to run silent.\n\n495\n00:24:14.570 --> 00:24:17.927\nI put it in the top of my closet and\nI just see a blue light on it and\n\n496\n00:24:17.927 --> 00:24:19.097\nthat's it, right?\n\n497\n00:24:19.097 --> 00:24:22.557\nRonny, do you have a, you do,\nlet's take a look at that.\n\n498\n00:24:22.557 --> 00:24:26.673\n>> I do have mini-itx.com pulled up and\nthis is one of the sites that a lot of\n\n499\n00:24:26.673 --> 00:24:31.415\npeople do go to so they can build their\nown system however they choose to.\n\n500\n00:24:31.415 --> 00:24:35.860\nFairly popular to be able to do this, and\nyou can choose the individual components.\n\n501\n00:24:35.860 --> 00:24:38.760\nDon, did you actually go the route\nof picking out everything?\n\n502\n00:24:38.760 --> 00:24:42.570\nLike, the RAM, the hard drive,\nthe motherboard, the case, and everything?\n\n503\n00:24:42.570 --> 00:24:46.050\n>> I was a bit lazy, Ronnie, and\nI just bought one of their bundles.\n\n504\n00:24:46.050 --> 00:24:50.440\nI knew I wanted an Atom processor and\ncertain storage and\n\n505\n00:24:50.440 --> 00:24:53.390\nthey had these bundles where they could\nput it together and send it to you.\n\n506\n00:24:53.390 --> 00:24:54.829\nI mean, you can,\nyou can buy each of the individual pieces.\n\n507\n00:24:56.240 --> 00:24:57.920\nThe advantage of like\nthe board that I did,\n\n508\n00:24:57.920 --> 00:25:01.820\nwhich I don't think they sell any more,\nbut it had the Intel Atom processor and\n\n509\n00:25:01.820 --> 00:25:05.560\nIntel Nix on it, it had two\nnetwork interfaces on it already.\n\n510\n00:25:05.560 --> 00:25:07.781\nNow if I wanted four interfaces\nthat doesn't help me, so\n\n511\n00:25:07.781 --> 00:25:10.389\nI'm gonna have to pick a different\nboard or build your own system.\n\n512\n00:25:10.389 --> 00:25:13.245\nBut these guys kind of\nhave that all pre-built.\n\n513\n00:25:13.245 --> 00:25:14.025\nJust be careful.\n\n514\n00:25:14.025 --> 00:25:16.955\nPay attention to the power\nrequirements and so on.\n\n515\n00:25:16.955 --> 00:25:18.825\nIt's really nice to be able\nto get these inexpensive,\n\n516\n00:25:18.825 --> 00:25:21.395\nsmall systems that have the load you want.\n\n517\n00:25:21.395 --> 00:25:24.965\nThe Atom processor might not be\nthe way for you to go anymore.\n\n518\n00:25:24.965 --> 00:25:26.765\nYou might need a Bay Trail processor,\n\n519\n00:25:26.765 --> 00:25:28.785\nsomething that's got\na little more oomph to it.\n\n520\n00:25:28.785 --> 00:25:30.705\nAnd you can certainly get those.\n\n521\n00:25:30.705 --> 00:25:33.790\nJust understand that those\nhave more power requirements.\n\n522\n00:25:33.790 --> 00:25:36.500\nWhich means they generate more heat,\nwhich means they need fans.\n\n523\n00:25:36.500 --> 00:25:41.130\nAnd so if you need fans, then you can\nget quiet fans, suitable for home use.\n\n524\n00:25:41.130 --> 00:25:44.829\nBut if the fans are noisy, well that's\ngoing to be a bit of a problem.\n\n525\n00:25:44.829 --> 00:25:47.649\n>> Yeah,\nunderneath their options here on their\n\n526\n00:25:47.649 --> 00:25:52.620\nonline store they have this mini PC\nsystems and that's what I selected.\n\n527\n00:25:52.620 --> 00:25:55.900\nAnd the nice thing about this is that it's\nalready kind of preconfigured in the way\n\n528\n00:25:55.900 --> 00:25:57.030\nthat we said.\n\n529\n00:25:57.030 --> 00:25:59.710\nSo you have the case,\nyou have the board, and\n\n530\n00:25:59.710 --> 00:26:03.150\nthen you can choose the performance\noptions that you want.\n\n531\n00:26:03.150 --> 00:26:05.550\nAnd also whether you're going\nto add a drive and a RAM.\n\n532\n00:26:05.550 --> 00:26:08.050\nAnd here they're talking about Jetways.\n\n533\n00:26:08.050 --> 00:26:11.820\nLooks like the only ones that\nthey've got now, and some Via Minis.\n\n534\n00:26:11.820 --> 00:26:17.210\nIndustrial router platforms and\nZotach eco PCs as well.\n\n535\n00:26:17.210 --> 00:26:20.550\nSo, there are many options that\nyou can go through to choose that.\n\n536\n00:26:20.550 --> 00:26:22.020\nNow, if you want to go the other route.\n\n537\n00:26:22.020 --> 00:26:23.880\nNow you might think like,\nwho would ever do that?\n\n538\n00:26:23.880 --> 00:26:26.390\nWell, we actually have someone in\nthe studio that actually did that.\n\n539\n00:26:26.390 --> 00:26:28.370\nThey not only picked the card,\nthey picked everything, and\n\n540\n00:26:28.370 --> 00:26:29.440\nthey even built their own box.\n\n541\n00:26:29.440 --> 00:26:31.180\nAnd that's Nate, our producer.\n\n542\n00:26:31.180 --> 00:26:35.560\nAnd he loves his little pfSense firewall\nbox cuz he built everything from scratch.\n\n543\n00:26:35.560 --> 00:26:36.920\n>> He put neon lights in it and stuff.\n\n544\n00:26:36.920 --> 00:26:40.760\n>> Neon lights, there's a little LED on\nit, you name it, it's pretty slick system.\n\n545\n00:26:40.760 --> 00:26:42.910\n>> Yeah,\nyou can really have a lot of fun with it.\n\n546\n00:26:42.910 --> 00:26:45.660\nNow, I'm not a big fan of\nthe Jetway hardware, but\n\n547\n00:26:45.660 --> 00:26:48.680\nyou do see Jetway advertise a lot cuz they\nhave these little motherboards with four\n\n548\n00:26:48.680 --> 00:26:50.860\ninterfaces on them that's really handy.\n\n549\n00:26:50.860 --> 00:26:53.030\nI don't know, I'm not a big fan of that.\n\n550\n00:26:53.030 --> 00:26:55.010\nBut, yeah, there's plenty of\noptions that are out there.\n\n551\n00:26:55.010 --> 00:26:59.360\nCouple other things to think about\nreliability and redundancy, all right?\n\n552\n00:26:59.360 --> 00:27:02.990\nWith a lot of these firewalls they're so\ninexpensive that you can just buy two and\n\n553\n00:27:02.990 --> 00:27:03.850\nset up CARP.\n\n554\n00:27:03.850 --> 00:27:05.680\nAnd, if one fails you got\nthe other one running, right.\n\n555\n00:27:05.680 --> 00:27:06.700\nSo, you're kind of covered.\n\n556\n00:27:06.700 --> 00:27:07.970\nBut there's other systems you can buy,\n\n557\n00:27:07.970 --> 00:27:12.360\nlike that Dell PowerEdge server where\nit has two power supplies in it.\n\n558\n00:27:12.360 --> 00:27:15.090\nAnd you can do a RAID array,\ndo mirror hard drives, and so\n\n559\n00:27:15.090 --> 00:27:18.040\nyou can build redundancy\ninto the firewall itself.\n\n560\n00:27:18.040 --> 00:27:21.405\nYou gotta lot of options there, but\nthat needs to be a part of your\n\n561\n00:27:21.405 --> 00:27:23.905\nplan when you go to select hardware for\nyour deployment.\n\n562\n00:27:25.615 --> 00:27:28.055\nLet's see, what are some other\nthings we need to think about?\n\n563\n00:27:28.055 --> 00:27:29.005\nInterface count.\n\n564\n00:27:29.005 --> 00:27:31.205\nRight, interface count's a big deal.\n\n565\n00:27:31.205 --> 00:27:35.065\nTo be a decent firewall, you've got to\nhave at least one interface, right?\n\n566\n00:27:35.065 --> 00:27:38.840\nNow, you might think, what good's\na firewall if it's only got one interface?\n\n567\n00:27:38.840 --> 00:27:42.916\nBut thanks to VLANs, I could divide up\none interface and have an incoming and\n\n568\n00:27:42.916 --> 00:27:47.138\nan outgoing VLAN right, inside or outside\nVLAN and do it off of one interface.\n\n569\n00:27:47.138 --> 00:27:48.253\nNot normally a good idea, so\n\n570\n00:27:48.253 --> 00:27:51.000\nyou're normally going to need\nat least two interfaces.\n\n571\n00:27:51.000 --> 00:27:53.760\nAnd that's what stops using\nthings like the Intel NUC.\n\n572\n00:27:53.760 --> 00:27:58.820\nRight, the Intel NUC, the Intel next\nunit of computing, that's the little box\n\n573\n00:27:58.820 --> 00:28:04.290\nthey made that has an Intel i5 processor\nin it, and two or four gigs of RAM.\n\n574\n00:28:04.290 --> 00:28:06.710\nIt would make a great pfSense firewall,\n\n575\n00:28:06.710 --> 00:28:10.990\ncapable of handling tons of connections,\nbut it's only got one network interface.\n\n576\n00:28:10.990 --> 00:28:15.400\nSo if you want to use an Intel NUC, you\ngot to add like a USB network interface or\n\n577\n00:28:15.400 --> 00:28:18.970\nsomething, and\nUSB does things in software so\n\n578\n00:28:18.970 --> 00:28:21.050\nit's not gonna get\nthe performance that you want.\n\n579\n00:28:21.050 --> 00:28:23.640\nAnd that holds that back\nfrom being really useful.\n\n580\n00:28:23.640 --> 00:28:26.970\nBut there's other systems out there\nthat have two interfaces by default.\n\n581\n00:28:26.970 --> 00:28:29.280\nYou've got the new Intel NUCs there?\n\n582\n00:28:29.280 --> 00:28:29.910\n>> It is, so\n\n583\n00:28:29.910 --> 00:28:34.160\nhere you can see introducing the latest\nIntel NUCs that they have available.\n\n584\n00:28:34.160 --> 00:28:38.650\nThe fifth generation i5 processors.\n\n585\n00:28:38.650 --> 00:28:43.647\nAnd with this one, let's see,\nwhich is the best one.\n\n586\n00:28:43.647 --> 00:28:46.090\nWe'll take a look at the latest\nones that they show.\n\n587\n00:28:47.890 --> 00:28:54.530\nAnd the limitation again is the one\nNIC that we have available to us.\n\n588\n00:28:54.530 --> 00:28:57.290\nSo there are many of these types\nof systems that are out there.\n\n589\n00:28:57.290 --> 00:28:58.680\nWe can buy them pre-built.\n\n590\n00:28:58.680 --> 00:29:00.430\nYou can build them on your own.\n\n591\n00:29:00.430 --> 00:29:04.560\nThe other the site that we also have them\nif you wanted to go piece by piece you,\n\n592\n00:29:04.560 --> 00:29:05.710\nof course, could do that.\n\n593\n00:29:05.710 --> 00:29:08.160\nThere's another company out\nthere called mini ITX and\n\n594\n00:29:08.160 --> 00:29:12.000\nhere's some of what they call mini value\nsystems where they build on top of it.\n\n595\n00:29:12.000 --> 00:29:13.150\nAnd you can see how popular it is.\n\n596\n00:29:13.150 --> 00:29:16.110\nJust about everything they have\nhere is almost out of stock.\n\n597\n00:29:16.110 --> 00:29:18.480\nSo I went through page after page and\nI finally found one.\n\n598\n00:29:18.480 --> 00:29:23.130\nOh, here's the one with Bay Trail in it,\nthat is not out of stock, as well.\n\n599\n00:29:23.130 --> 00:29:25.910\n>> Yeah, and that's the one kind\nof replaced the ATOM that I used.\n\n600\n00:29:25.910 --> 00:29:31.000\n>> And you see the prices,\nthey're not that bad, but this one may\n\n601\n00:29:31.000 --> 00:29:34.710\nalso require you, of course, to actually\nadd in just a couple of other things.\n\n602\n00:29:34.710 --> 00:29:38.450\nHere it says RAM and\na hard drive to complete your system.\n\n603\n00:29:38.450 --> 00:29:40.820\nSo depending on how much RAM\nyou're willing to put into it,\n\n604\n00:29:40.820 --> 00:29:42.950\nhow big of a hard drive you're\nwilling to put into it,\n\n605\n00:29:42.950 --> 00:29:46.050\nit may add in another $100\nmaybe a little bit more.\n\n606\n00:29:46.050 --> 00:29:49.670\nBut right from there then you can take\nyour pfSense install it on there and\n\n607\n00:29:49.670 --> 00:29:50.840\nget ready to go.\n\n608\n00:29:50.840 --> 00:29:54.301\nIt really is all about making sure you\nhave enough network adapters as well.\n\n609\n00:29:54.301 --> 00:29:57.367\nAnd I like their site because it actually\ndoes show you all of the interfaces that\n\n610\n00:29:57.367 --> 00:29:58.490\nare available.\n\n611\n00:29:58.490 --> 00:30:01.530\n>> Now some of them will have a PCI card\nslot inside of them where you can add\n\n612\n00:30:01.530 --> 00:30:03.200\na full size PCI card.\n\n613\n00:30:03.200 --> 00:30:06.330\nAnd that's cool because you can go out and\nyou get like those Intel four port cards,\n\n614\n00:30:06.330 --> 00:30:07.960\nor you can get them as like server pools.\n\n615\n00:30:07.960 --> 00:30:10.340\nA lot of people sell them\non eBay from their servers.\n\n616\n00:30:10.340 --> 00:30:11.390\nIf they don't actually need them.\n\n617\n00:30:11.390 --> 00:30:15.420\nYou can add that in and get a quick four\nmore ports in there, that's pretty handy.\n\n618\n00:30:15.420 --> 00:30:19.230\nThe Jetway boards actually have those four\nports in there, but again, it's Jetway.\n\n619\n00:30:19.230 --> 00:30:22.600\nSome people like them,\nI'm just not a big fan.\n\n620\n00:30:22.600 --> 00:30:24.485\nBut, just keep that in mind.\n\n621\n00:30:24.485 --> 00:30:28.065\nYou may be tempted to say, let me slap\nsome USB network adapters on there.\n\n622\n00:30:28.065 --> 00:30:29.245\nUSB network adapters can work.\n\n623\n00:30:29.245 --> 00:30:32.605\nYou can get gig network adapters and if\nyou look, those are USB 3.0 ports on that\n\n624\n00:30:32.605 --> 00:30:36.215\nthing so you could have USB\n3.0 network adapters attached.\n\n625\n00:30:36.215 --> 00:30:40.245\nBut USB pushes all of its\nkinda calculations and\n\n626\n00:30:40.245 --> 00:30:43.520\nhardware calcs all through the CPU.\n\n627\n00:30:43.520 --> 00:30:47.490\nSo if you're doing this on an Atom\nprocessor, it's creating a CPU burden.\n\n628\n00:30:47.490 --> 00:30:49.670\nIf you have a Bay Trail\nit's a little bit better,\n\n629\n00:30:49.670 --> 00:30:51.910\nif you have an actual Intel Xeon or\nsomething, it's fine.\n\n630\n00:30:51.910 --> 00:30:54.700\nBut if you're doing a Xeon,\nyou probably have full server hardware and\n\n631\n00:30:54.700 --> 00:30:57.450\nyou an just stick the PCI\ncards in there instead of USB.\n\n632\n00:30:57.450 --> 00:31:01.880\nSo always be aware that everything has\na little bit of an impact on your system.\n\n633\n00:31:01.880 --> 00:31:05.960\nNow once we get it set up,\nit's nice that the pfSense homepage\n\n634\n00:31:05.960 --> 00:31:08.210\ntells you exactly how many\nstates you can support, and\n\n635\n00:31:08.210 --> 00:31:10.930\nhow big your memory buffer is,\nso you can kinda gage that.\n\n636\n00:31:10.930 --> 00:31:12.240\nAnd you have to keep an eye on it.\n\n637\n00:31:12.240 --> 00:31:15.110\nCuz you may find that in production\nyour utilization starts getting\n\n638\n00:31:15.110 --> 00:31:16.800\na little high and\nyou have to upgrade a bit.\n\n639\n00:31:16.800 --> 00:31:19.390\nFortunately the cost on most of this\nstuff is so low that it's not a big deal.\n\n640\n00:31:20.770 --> 00:31:24.240\n>> All right Don, is there any other\npiece of hardware advice that we need to\n\n641\n00:31:24.240 --> 00:31:26.440\nimpart onto our viewers?\n\n642\n00:31:26.440 --> 00:31:30.430\n>> We had a question in the forums whether\npfSense can run on a Raspberry Pi.\n\n643\n00:31:30.430 --> 00:31:31.760\nWhich is a good question.\n\n644\n00:31:31.760 --> 00:31:33.980\nIt can, you can actually\nthrow it on a Raspberry Pi.\n\n645\n00:31:33.980 --> 00:31:35.860\nIt's just your throughput's\ngonna be pretty poor.\n\n646\n00:31:35.860 --> 00:31:38.460\nA Raspberry Pi has only\none network adapter,\n\n647\n00:31:38.460 --> 00:31:41.280\nand, if you want a second adapter,\nyou're gonna have to do a USB one.\n\n648\n00:31:41.280 --> 00:31:44.710\nI think it's only got USB 2.0 ports, so\nthat's kind of a bit of a problem there.\n\n649\n00:31:46.420 --> 00:31:50.340\nEven aside from that the ARM\nprocessor that's on a raspberry pie.\n\n650\n00:31:50.340 --> 00:31:53.110\nIt's not the beefiest thing in the world.\n\n651\n00:31:53.110 --> 00:31:55.020\nSo if you're just doing straight\nup routing you'd probably\n\n652\n00:31:55.020 --> 00:31:55.520\nbe doing an okay job.\n\n653\n00:31:55.520 --> 00:32:00.600\nBut if you're doing packet filtering, if\nyou're doing an other kind of VPN access\n\n654\n00:32:00.600 --> 00:32:02.570\nany kind of encryption or decryption.\n\n655\n00:32:02.570 --> 00:32:04.580\nIt's really not gonna perform very well,\n\n656\n00:32:04.580 --> 00:32:08.380\nso you probably wanna stay\naway from something like that.\n\n657\n00:32:08.380 --> 00:32:12.406\nEspecially when it's not that much more\nexpensive to step up to an Atom processor\n\n658\n00:32:12.406 --> 00:32:15.380\nor a Bay Trail processor that can\ndo just a heck of a lot more.\n\n659\n00:32:15.380 --> 00:32:18.520\nSo, yeah,\nlot of options that are out there.\n\n660\n00:32:18.520 --> 00:32:22.290\nJump into the pfSense forums, you'll see\npeople where they discuss their build and\n\n661\n00:32:22.290 --> 00:32:24.300\nwhat hardware they use and so on.\n\n662\n00:32:24.300 --> 00:32:25.800\nSo, you know,\nmake sure you check that out.\n\n663\n00:32:25.800 --> 00:32:27.540\nSome good information to be found there.\n\n664\n00:32:27.540 --> 00:32:29.440\nAnd then just don't go cheap on it.\n\n665\n00:32:29.440 --> 00:32:30.540\nA lot of people do that.\n\n666\n00:32:30.540 --> 00:32:32.930\nThey go cheap on their hardware,\nand then they say,\n\n667\n00:32:32.930 --> 00:32:36.570\nI really just wasn't impressed with\npfSense, I'm going back to my ASA.\n\n668\n00:32:36.570 --> 00:32:38.010\nWell, the Cisco ASAs are great, right?\n\n669\n00:32:38.010 --> 00:32:40.140\nThey are running on hardware\nthat's specialized,\n\n670\n00:32:40.140 --> 00:32:43.110\nthat's designed exactly for\nfirewall functionality.\n\n671\n00:32:43.110 --> 00:32:45.490\nBut boy do they nickel and\ndime you on the licensing.\n\n672\n00:32:45.490 --> 00:32:47.900\nThe software cost is really\nexpensive with that.\n\n673\n00:32:47.900 --> 00:32:50.170\nWith pfSense, since you're not paying for\n\n674\n00:32:50.170 --> 00:32:52.630\nthat licence,\nput that money in the hardware.\n\n675\n00:32:52.630 --> 00:32:53.490\nBuy decent hardware and\n\n676\n00:32:53.490 --> 00:32:57.045\nyou'll get great lifetime out of it and\nit really runs well.\n\n677\n00:32:57.045 --> 00:32:59.670\n>> All right, so,\n\n678\n00:32:59.670 --> 00:33:04.740\nwhen we take a look at selecting hardware,\nremember, don't chintz out at this point.\n\n679\n00:33:04.740 --> 00:33:07.850\nMake sure you take a look at\nthe minimum hardware requirements and\n\n680\n00:33:07.850 --> 00:33:08.720\nbuild from there.\n\n681\n00:33:08.720 --> 00:33:10.450\nRemember all the features that you need.\n\n682\n00:33:10.450 --> 00:33:13.700\nMake sure you get the performance\nthat matches what you need.\n\n683\n00:33:13.700 --> 00:33:17.440\nBecause if not you're actually going to\nbe fairly disappointed with the way that\n\n684\n00:33:17.440 --> 00:33:20.579\npfSense is gonna work and\nfigure out everything that it needs to do.\n\n685\n00:33:24.700 --> 00:33:26.547\nThat wraps up our show for today.\n\n686\n00:33:26.547 --> 00:33:28.705\nStay tuned for more pfSense content.\n\n687\n00:33:28.705 --> 00:33:34.560\n[MUSIC]\n\n",
          "vimeoId": "132319753"
        }
      ],
      "title": "Packages"
    }
  ],
  "url": "pfsense",
  "vLab": false
}
