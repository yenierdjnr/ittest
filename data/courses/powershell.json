{
  "description": "The Microsoft PowerShell is a secondary command line interface found in most Microsoft operating systems. The purpose of the PowerShell is to provide a much more feature rich scripting and automation environment than was previously possible in the base command shell. This series introduces the viewer to the PowerShell and its basic functions. It then moves in to specific areas like managing DNS, DHCP and Active Directory along with their typical commands. ",
  "descriptionMD": "",
  "length": "45533",
  "name": "PowerShell",
  "practiceExam": false,
  "subtitle": "for Administrators",
  "tagUrl": "help-desk",
  "topics": [
    {
      "episodes": [
        {
          "description": "The Microsoft PowerShell is a secondary command line interface found in most Microsoft operating systems. The purpose of the PowerShell is to provide a much more feature rich scripting and automation environment than was previously possible in the base command shell. This series introduces the viewer to the PowerShell and its basic functions. It then moves in to specific areas like managing DNS, DHCP and Active Directory along with their typical commands.",
          "length": "249",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-0-0-overview-120114.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-0-0-overview-120114-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-0-0-overview-120114-sm.jpg",
          "title": "Windows PowerShell Overview",
          "transcript": "1\n00:00:00,000 --> 00:00:08,376\n[MUSIC]\n\n2\n00:00:08,376 --> 00:00:12,270\nWelcome to ITProTV's PowerShell for\nSys Admins program.\n\n3\n00:00:12,270 --> 00:00:16,130\nWhat we're doing is we're recording\na series of videos that are covering\n\n4\n00:00:16,130 --> 00:00:17,990\nhow to use the Windows PowerShell.\n\n5\n00:00:17,990 --> 00:00:21,400\nWe're seeing a bigger and bigger push\nfrom Microsoft use PowerShell for\n\n6\n00:00:21,400 --> 00:00:25,150\nall sorts of things, and the product's\nreally advanced over the years.\n\n7\n00:00:25,150 --> 00:00:27,890\nIt's wonderful for\ndoing things like automation and\n\n8\n00:00:27,890 --> 00:00:30,980\nscripting activities to occur in sequence\nthat you don't have to go through and\n\n9\n00:00:30,980 --> 00:00:33,130\ndo them over and over again yourself.\n\n10\n00:00:33,130 --> 00:00:35,440\nSometimes you have multiple servers\nthat you want to configure and\n\n11\n00:00:35,440 --> 00:00:38,010\nyou don't want to go and\ndo each one individually.\n\n12\n00:00:38,010 --> 00:00:41,770\nWe can write a PowerShell Script and\nit'll knock them all out for us in one go.\n\n13\n00:00:41,770 --> 00:00:43,340\nIt's really pretty cool.\n\n14\n00:00:43,340 --> 00:00:47,200\nBut it is a lot different than\nthe command prompt that we're used to.\n\n15\n00:00:47,200 --> 00:00:48,870\nOr maybe you're not used to\nthe command prompt at all.\n\n16\n00:00:48,870 --> 00:00:52,120\nMaybe you're an all GUI person,\nplenty of people are these days.\n\n17\n00:00:52,120 --> 00:00:53,700\nSo the Powershell can\nbe a little daunting,\n\n18\n00:00:53,700 --> 00:00:56,530\nand that's what this program aims to fix.\n\n19\n00:00:56,530 --> 00:00:59,510\nWe're gonna take a look at,\nwell, some of the basics first.\n\n20\n00:00:59,510 --> 00:01:03,300\nWe'll start out with just what the\nPowerShell is and how the interface works.\n\n21\n00:01:03,300 --> 00:01:07,300\nThe interface is pretty neat, and there's\nsome really cool tools and shortcuts that\n\n22\n00:01:07,300 --> 00:01:11,260\nwe can use just right in the basic\ninterface that can help us out a lot.\n\n23\n00:01:11,260 --> 00:01:13,580\nFrom there, we're going to start\nadvancing into other topics.\n\n24\n00:01:13,580 --> 00:01:16,530\nLet me show you the outline that\nwe've kind of worked up for this.\n\n25\n00:01:16,530 --> 00:01:20,000\nUnlike a lot of shows on ITProTV,\nthis show is not built around a particular\n\n26\n00:01:20,000 --> 00:01:22,620\ncertification, so\nwe're going freestyle here.\n\n27\n00:01:22,620 --> 00:01:25,340\nWe're basically adding whatever\nwe feel is appropriate, and\n\n28\n00:01:25,340 --> 00:01:30,440\nby we, I mean most of this is myself and\nour other host Mike Roderick.\n\n29\n00:01:30,440 --> 00:01:34,190\nWe've taken a look at the various\nPowerShell commands that we think most\n\n30\n00:01:34,190 --> 00:01:37,980\npeople need to know it to be prepared for\nthe exams and prepared for the real world.\n\n31\n00:01:37,980 --> 00:01:38,790\nSo, like I said,\n\n32\n00:01:38,790 --> 00:01:41,950\nwe're gonna start out right here with\nthe introduction to the PowerShell.\n\n33\n00:01:41,950 --> 00:01:45,480\nWe'll just go over some of those\nbasic commands, general syntax,\n\n34\n00:01:45,480 --> 00:01:47,770\nhow we can use the interface.\n\n35\n00:01:47,770 --> 00:01:50,900\nFrom there, we'll start to focus\non the more practical skills.\n\n36\n00:01:50,900 --> 00:01:53,720\nWe'll have a series of videos that\nare focusing on server management.\n\n37\n00:01:53,720 --> 00:01:56,833\nThese are generic tasks that\nare performed on every Windows server.\n\n38\n00:01:56,833 --> 00:02:00,457\nI might be adding roles,\nremoving features, managing services,\n\n39\n00:02:00,457 --> 00:02:04,660\nwhatever it is that we need to do as part\nof the day to day operations of a server.\n\n40\n00:02:04,660 --> 00:02:09,034\nThen we're gonna focus in on DNS, how to\nget DNS, domain naming system, configured\n\n41\n00:02:09,034 --> 00:02:14,020\non a server, and how to work with zones\nand other records all from the PowerShell.\n\n42\n00:02:14,020 --> 00:02:17,610\nWe'll proceed to DHCP,\ndynamic host configuration protocol, and\n\n43\n00:02:17,610 --> 00:02:19,080\nhow to manage it.\n\n44\n00:02:19,080 --> 00:02:21,150\nAnd then the big one, active directory.\n\n45\n00:02:21,150 --> 00:02:22,890\nI know it doesn't look that\nbig here in the outline, but\n\n46\n00:02:22,890 --> 00:02:24,620\nthere's actually quite a bit to it.\n\n47\n00:02:24,620 --> 00:02:27,520\nCreating the active directory,\nworking with user accounts,\n\n48\n00:02:27,520 --> 00:02:30,000\ngroups, organizational units,\ngroup policy objects,\n\n49\n00:02:30,000 --> 00:02:33,805\nall of that stuff that's buried inside\nthe active directory, you can completely\n\n50\n00:02:33,805 --> 00:02:37,785\ninterface with it via the PowerShell,\nand then we're going to tackle Hyper-V.\n\n51\n00:02:37,785 --> 00:02:40,265\nHow do you get Hyper-V installed?\n\n52\n00:02:40,265 --> 00:02:43,595\nHow to manage virtual machines,\ncreating them, starting, stopping, taking\n\n53\n00:02:43,595 --> 00:02:48,635\nsnapshots, all those other things that are\npart of the routine operation of Hyper-V.\n\n54\n00:02:48,635 --> 00:02:51,745\nNow, depending on when\nyou watch this show,\n\n55\n00:02:51,745 --> 00:02:54,740\nthere may just be these videos available.\n\n56\n00:02:54,740 --> 00:02:57,340\nBut if it's been a year or\n\n57\n00:02:57,340 --> 00:03:00,110\nhowever long, you may see that we have\nquite a bit more content than that.\n\n58\n00:03:00,110 --> 00:03:03,070\nAnd that's because this isn't based\naround an exam set of objectives.\n\n59\n00:03:03,070 --> 00:03:05,660\nWe're not waiting on Microsoft\nto tell us what to cover.\n\n60\n00:03:05,660 --> 00:03:08,090\nInstead, we're just figuring it out.\n\n61\n00:03:08,090 --> 00:03:10,460\nWhatever we feel like needs to be in\nthere we're throwing it in there.\n\n62\n00:03:10,460 --> 00:03:13,590\nAnd that means that if you have any ideas,\nif there was something you\n\n63\n00:03:13,590 --> 00:03:16,980\ndidn't see on that outline that\nyou want covered, let us know.\n\n64\n00:03:16,980 --> 00:03:18,370\nPost in the Q & A forums,\n\n65\n00:03:18,370 --> 00:03:21,510\nyou can just go right in there into the\nMicrosoft forum and post and say hey, Don,\n\n66\n00:03:21,510 --> 00:03:25,770\nI'd really like it if you did a section\non Microsoft SQL or Microsoft Exchange,\n\n67\n00:03:25,770 --> 00:03:28,500\nyou covered some of the PowerShell\nstuff that's available from those.\n\n68\n00:03:28,500 --> 00:03:31,230\nIf that's something that interests you,\ngreat, throw it on there.\n\n69\n00:03:31,230 --> 00:03:33,870\nIt's not on any of the exams\nthat our site prepares you for,\n\n70\n00:03:33,870 --> 00:03:37,610\nat least not yet, but it's something\nthat's useful to know and we'll do it,\n\n71\n00:03:37,610 --> 00:03:39,050\nwe'll film it and get thrown on there.\n\n72\n00:03:39,050 --> 00:03:43,140\nSo if it's not on the outline, just let\nus know, we'll work to get it added.\n\n73\n00:03:43,140 --> 00:03:44,333\nBut these are kind of the major ones.\n\n74\n00:03:44,333 --> 00:03:48,519\nThese are definitely ones that you need\nto know if you're getting ready for\n\n75\n00:03:48,519 --> 00:03:51,917\nthe 70-410, 70-411 and 70-412 exams.\n\n76\n00:03:51,917 --> 00:03:55,029\nAnd so we try to basically\nwrap all those together, but\n\n77\n00:03:55,029 --> 00:03:58,083\nwe're definitely willing\nto extend that as needed.\n\n78\n00:03:58,083 --> 00:04:02,034\nAll right, so that's what we're about to\njump into, and without further delay,\n\n79\n00:04:02,034 --> 00:04:03,625\nwe'll go ahead and get started.\n\n80\n00:04:03,625 --> 00:04:09,724\n[MUSIC]\n\n",
          "vimeoId": "113436931"
        },
        {
          "description": "",
          "length": "555",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-0-introduction-to-powershell-120114.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-0-introduction-to-powershell-120114-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-0-introduction-to-powershell-120114-sm.jpg",
          "title": "Introduction To Powershell",
          "transcript": "1\n00:00:00,000 --> 00:00:08,998\n[SOUND]\nIn this segment,\n\n2\n00:00:08,998 --> 00:00:12,667\nwe're just gonna take a quick moment\nto do an Introduction to PowerShell.\n\n3\n00:00:12,667 --> 00:00:15,289\nThe odds are,\nif you've come here to watch these videos,\n\n4\n00:00:15,289 --> 00:00:18,231\nyou already know what the PowerShell is,\nbut I find it's a good,\n\n5\n00:00:18,231 --> 00:00:21,734\nhealthy idea [LAUGH] to make sure we have\na basic understanding of the concept.\n\n6\n00:00:21,734 --> 00:00:24,150\nAnd so,\nthat's just what we'll tackle right here.\n\n7\n00:00:24,150 --> 00:00:27,060\nThe Windows Powershell is a new\n\n8\n00:00:27,060 --> 00:00:29,440\ncommand line interface that's\navailable for Windows.\n\n9\n00:00:29,440 --> 00:00:32,090\nNow, I say new, but\nit actually came out in 2006, and\n\n10\n00:00:32,090 --> 00:00:34,530\nso it's about eight years old now.\n\n11\n00:00:34,530 --> 00:00:38,350\nIt's pretty mature,\nit's in use by a lot of organizations.\n\n12\n00:00:38,350 --> 00:00:41,690\nBut it's new compared to\nour old command line.\n\n13\n00:00:41,690 --> 00:00:46,040\nIn Windows NT, we had just the CMD,\nthe command interpreter.\n\n14\n00:00:46,040 --> 00:00:49,000\nAnd prior to that,\nwe had the DOS command interpreter.\n\n15\n00:00:49,000 --> 00:00:53,130\nSo, it was a different environment back\nthen, a different set of commands.\n\n16\n00:00:53,130 --> 00:00:57,630\nPowerShell looks to replace those\nold command line interfaces.\n\n17\n00:00:57,630 --> 00:01:01,790\nAnd basically, upgrade them into a new\nworld where we have a lot more power, and\n\n18\n00:01:01,790 --> 00:01:02,950\nflexibility.\n\n19\n00:01:02,950 --> 00:01:06,990\nOver the years, Microsoft has seen\nthe Linux environment grow, and\n\n20\n00:01:06,990 --> 00:01:08,050\ngrow, and grow.\n\n21\n00:01:08,050 --> 00:01:10,830\nAnd one of the powerful features\nin the Linux environment,\n\n22\n00:01:10,830 --> 00:01:13,630\nis that the command line that you choose,\nthe Shell.\n\n23\n00:01:13,630 --> 00:01:17,480\nIf you choose the BASH Shell,\nor TCSH, or one of those guys,\n\n24\n00:01:17,480 --> 00:01:21,810\nyou can do darn near programming language\nright from the command prompt, and\n\n25\n00:01:21,810 --> 00:01:25,200\nthat makes it very powerful for\nscripting, and automation.\n\n26\n00:01:25,200 --> 00:01:29,030\nAnd so, Microsoft sought to\nbring feature parity there.\n\n27\n00:01:29,030 --> 00:01:31,695\nTo be able to bring that functionality\ninto the Windows environment, so\n\n28\n00:01:31,695 --> 00:01:33,057\nwe weren't relying on Linux tools.\n\n29\n00:01:33,057 --> 00:01:34,903\nAnd the PowerShell is what came of that.\n\n30\n00:01:34,903 --> 00:01:41,114\nNow, the PowerShell was released in 2006\nfor Windows XP, and Windows Server 2003.\n\n31\n00:01:41,114 --> 00:01:44,857\nAnd at the time, it was just called\nPowerShell version 1.0, and you could go,\n\n32\n00:01:44,857 --> 00:01:47,320\nand download it from Microsoft's website.\n\n33\n00:01:47,320 --> 00:01:50,020\nSo if you were running Windows XP,\nor Windows Server 2003,\n\n34\n00:01:50,020 --> 00:01:52,600\nyou didn't have the PowerShell by default.\n\n35\n00:01:52,600 --> 00:01:53,960\nYou had to go, and download it.\n\n36\n00:01:53,960 --> 00:01:57,320\nSo on those machines,\nyou still had the regular command prompt.\n\n37\n00:01:57,320 --> 00:02:01,290\nAnd from there you'd go in, and execute\nyour regular command line utilities, and\n\n38\n00:02:01,290 --> 00:02:02,670\nthat's what you had.\n\n39\n00:02:02,670 --> 00:02:05,461\nBut if you went, and\ndownloaded the PowerShell,\n\n40\n00:02:05,461 --> 00:02:08,390\nnow the PowerShell with\na new command prompt.\n\n41\n00:02:08,390 --> 00:02:09,560\nYou still had all your old commands.\n\n42\n00:02:09,560 --> 00:02:11,520\nAll your old commands still worked.\n\n43\n00:02:11,520 --> 00:02:13,271\nBut now, you have a lot of new stuff.\n\n44\n00:02:13,271 --> 00:02:16,609\nAnd because Microsoft created\nthis from the ground up,\n\n45\n00:02:16,609 --> 00:02:18,322\nthey were able to modify it.\n\n46\n00:02:18,322 --> 00:02:21,116\nHowever, they needed to\nan ideal environment, and\n\n47\n00:02:21,116 --> 00:02:24,130\nthe first thing they did\nis they brought in logic.\n\n48\n00:02:24,130 --> 00:02:26,360\nSo, we can do darn near programming.\n\n49\n00:02:26,360 --> 00:02:29,270\nYou can do what's effectively\nlike Visual Basic script almost\n\n50\n00:02:29,270 --> 00:02:32,130\nfrom the command prompt, and\nit'll execute that on the fly.\n\n51\n00:02:32,130 --> 00:02:34,990\nIt does just in time compiling,\nand it's really cool.\n\n52\n00:02:34,990 --> 00:02:39,940\nBut it also is packed-full of\njust whole new sets of commands.\n\n53\n00:02:39,940 --> 00:02:41,700\nThey're called commandlets, and\n\n54\n00:02:41,700 --> 00:02:46,580\nthose commands can do all sorts of things\nfrom creating users, to stopping services,\n\n55\n00:02:46,580 --> 00:02:49,650\nto shutting down the computer,\nquerying values.\n\n56\n00:02:49,650 --> 00:02:52,110\nYou can do a ton of stuff.\n\n57\n00:02:52,110 --> 00:02:54,800\nAnd even better, it's fully extendable.\n\n58\n00:02:54,800 --> 00:02:57,410\nOther companies can write\ntheir own commandlets.\n\n59\n00:02:57,410 --> 00:03:00,350\nThey can extend that functionality,\nand then you can import those to make\n\n60\n00:03:00,350 --> 00:03:04,070\nuse of them yourself, and\nMicrosoft extends it also.\n\n61\n00:03:04,070 --> 00:03:08,040\nIn fact, PowerShell version\n1.0 is what came out in 2006.\n\n62\n00:03:08,040 --> 00:03:11,810\nWe're now on PowerShell 4.0,\nwith 5.0 on the horizon.\n\n63\n00:03:11,810 --> 00:03:15,380\nAnd with each one,\nthey're introducing new commandlets.\n\n64\n00:03:15,380 --> 00:03:19,720\nNew commands we can use to execute,\nand perform all sorts of activities.\n\n65\n00:03:19,720 --> 00:03:22,210\nSo, let's just run down some of\nthe additions real quick, so\n\n66\n00:03:22,210 --> 00:03:24,665\nwe understand the differences\nthat are out there.\n\n67\n00:03:24,665 --> 00:03:28,125\nThe most common PowerShell that\nyou'll encounter out there,\n\n68\n00:03:28,125 --> 00:03:29,930\nis PowerShell version 2.0.\n\n69\n00:03:29,930 --> 00:03:34,005\nVersion 1.0 was the first one, and\nyou had to go, and download it to have it.\n\n70\n00:03:34,005 --> 00:03:37,375\nSo not many people did,\nunless you had a specific need for it.\n\n71\n00:03:37,375 --> 00:03:40,990\nBut PowerShell version 2.0 was\nthe first one to be included\n\n72\n00:03:40,990 --> 00:03:43,435\nwith a Microsoft operating system.\n\n73\n00:03:43,435 --> 00:03:47,123\nPowerShell version 2.0 was included\nby default in Windows 7, and\n\n74\n00:03:47,123 --> 00:03:48,990\nWindows Server 2008.\n\n75\n00:03:48,990 --> 00:03:50,850\nWhich are the most common\nMicrosoft platforms.\n\n76\n00:03:50,850 --> 00:03:52,810\nThat's why PowerShell version 2.0 is so\ncommon.\n\n77\n00:03:53,870 --> 00:03:58,270\nSo, if you're out and about, and\nyou sit down at a machine at work, and\n\n78\n00:03:58,270 --> 00:04:01,440\nyou fire up PowerShell,\nthe odds are you're firing up 2.0.\n\n79\n00:04:01,440 --> 00:04:05,721\nNow, 2.0 is very similar to 1.0,\nit just has some stability enhancements,\n\n80\n00:04:05,721 --> 00:04:07,627\na few new features people asked for.\n\n81\n00:04:07,627 --> 00:04:10,971\nIt's available for\ndownload for Windows XP, for\n\n82\n00:04:10,971 --> 00:04:14,163\nWindows Vista, for Windows Server 2003.\n\n83\n00:04:14,163 --> 00:04:17,470\nSo, if you have those older OSs you could\ngo, and download it, and have it, or\n\n84\n00:04:17,470 --> 00:04:20,890\nyou could stay on PowerShell\n1.0 if you really wanted to.\n\n85\n00:04:20,890 --> 00:04:23,280\nBut the main things that were added, well,\n\n86\n00:04:23,280 --> 00:04:26,710\nthere's one feature that was added that\nI use all the time, and that's remoting.\n\n87\n00:04:26,710 --> 00:04:29,670\nThe ability to execute PowerShell\ncommands not on the computer\n\n88\n00:04:29,670 --> 00:04:32,120\nthat you're sitting at,\nbut on a remote computer.\n\n89\n00:04:32,120 --> 00:04:34,760\nAnd that's really cool because you\nmight be on your Windows 7 laptop,\n\n90\n00:04:34,760 --> 00:04:39,090\nand you're trying to work with\na Windows Server 2012 machine.\n\n91\n00:04:39,090 --> 00:04:41,400\nAnd you wanna execute a PowerShell\ncommands on that remote machine.\n\n92\n00:04:41,400 --> 00:04:44,250\nAnd that remoting functionality\nis what gives you that ability.\n\n93\n00:04:44,250 --> 00:04:48,690\nWe've also got the PowerShell ISE, which\nis an integrated scripting environment.\n\n94\n00:04:48,690 --> 00:04:51,640\nI almost wanna call it\na graphical user interface.\n\n95\n00:04:51,640 --> 00:04:52,208\nIt really isn't thought.\n\n96\n00:04:52,208 --> 00:04:53,101\nIt's a neat utility,\n\n97\n00:04:53,101 --> 00:04:55,876\nwe'll see it in an episode that we're\ngonna film here in a little bit.\n\n98\n00:04:55,876 --> 00:05:00,746\nBut it's a intelligent graphical system\nthat you can use to type in all your\n\n99\n00:05:00,746 --> 00:05:05,153\ncommands, and it'll do syntax checking,\nand colorization, and\n\n100\n00:05:05,153 --> 00:05:09,300\nall that other stuff to help\nyou with writing good scripts.\n\n101\n00:05:09,300 --> 00:05:12,250\nSo, those were both added\nin PowerShell version 2.0,\n\n102\n00:05:12,250 --> 00:05:15,070\nand that's where it really\nstarted to see general adoption.\n\n103\n00:05:15,070 --> 00:05:18,688\nThis is where we saw people\nabandoning the old command prompt,\n\n104\n00:05:18,688 --> 00:05:23,613\nabandoning their old batch files, and CMD\nscripts, and moving over to PowerShell.\n\n105\n00:05:23,613 --> 00:05:28,025\nWell, in 2012 PowerShell 3.0 came out.\n\n106\n00:05:28,025 --> 00:05:32,320\nI don't know, if I mentioned a date\non 2.0, 2.0 that was in 2009.\n\n107\n00:05:32,320 --> 00:05:36,760\nSo three years later, in 2012 we\nhad PowerShell 3.0, it came out.\n\n108\n00:05:36,760 --> 00:05:39,820\nIt's pre-installed in Windows 8,\nand Windows Server 2012.\n\n109\n00:05:39,820 --> 00:05:43,760\nSo you kind of see, whenever a new\nversion of Windows comes out typically,\n\n110\n00:05:43,760 --> 00:05:45,538\na new version of PowerShell comes out too.\n\n111\n00:05:45,538 --> 00:05:49,500\nIt was pre-installed on Windows 8, and\nServer 2012, but it was available for\n\n112\n00:05:49,500 --> 00:05:50,670\ndownload.\n\n113\n00:05:50,670 --> 00:05:54,094\nBut this was the first time that\nMicrosoft cut off some operating systems.\n\n114\n00:05:54,094 --> 00:05:58,296\nIt's available for download for\nWindows 7, and Windows Server 2008.\n\n115\n00:05:58,296 --> 00:06:02,330\nIt's not available for\nWindows XP, or Windows Vista.\n\n116\n00:06:02,330 --> 00:06:06,680\nAnd so, on those systems, Powershell\n2.0 is the highest that you can go.\n\n117\n00:06:06,680 --> 00:06:09,380\nAnd again, that's why Powershell\n2.0 is still the most common.\n\n118\n00:06:10,420 --> 00:06:13,680\nBut it added some good stuff, one of\nmy favorite features that it added was\n\n119\n00:06:13,680 --> 00:06:16,500\nthe ability to do updates for\nthe help files.\n\n120\n00:06:16,500 --> 00:06:19,700\nSometimes the help files that come\nwith it aren't very detailed, or\n\n121\n00:06:19,700 --> 00:06:22,000\nthey change over time due to hot fixes.\n\n122\n00:06:22,000 --> 00:06:24,000\nWell, now, you can dynamically\nupdate the help files, and\n\n123\n00:06:24,000 --> 00:06:27,000\nyou can stay up to date, and\nget some really good help there.\n\n124\n00:06:27,000 --> 00:06:31,010\nThe other thing is it brought in\nsomething called Intellisense to the ISE.\n\n125\n00:06:31,010 --> 00:06:34,790\nIn the ISE, if you start to type\na command, it'll show you suggestions for\n\n126\n00:06:34,790 --> 00:06:36,940\nwhat the remainder of\nthat command could be.\n\n127\n00:06:36,940 --> 00:06:40,160\nIt's a feature that's been found\nin Visual Studio for a long time.\n\n128\n00:06:40,160 --> 00:06:44,020\nThey just brought that over\ninto PowerShell in version 3.0.\n\n129\n00:06:44,020 --> 00:06:48,848\nThe current, stable version of PowerShell\nthough, is PowerShell 4.0, and\n\n130\n00:06:48,848 --> 00:06:50,630\nit just came out in 2013.\n\n131\n00:06:50,630 --> 00:06:52,150\nSo, it's pretty new.\n\n132\n00:06:52,150 --> 00:06:56,340\nIt's pre-installed on Windows 8.1,\nand Windows Server 2012 R2.\n\n133\n00:06:56,340 --> 00:07:00,915\nIt's available for download for\nWindows 8, Windows Server 2008,\n\n134\n00:07:00,915 --> 00:07:03,654\nWindows Server 2012, and Windows 7.\n\n135\n00:07:03,654 --> 00:07:05,493\nSo, you can download it for\nthose guys, but\n\n136\n00:07:05,493 --> 00:07:07,960\nanybody prior to Windows 7 can't have it.\n\n137\n00:07:07,960 --> 00:07:11,360\nSo that is the latest, and greatest,\nand that's what I'm gonna be using for\n\n138\n00:07:11,360 --> 00:07:12,720\nall the shows that we go through.\n\n139\n00:07:12,720 --> 00:07:14,610\nWe'll be sticking with PowerShell 4.0.\n\n140\n00:07:14,610 --> 00:07:19,870\nNow, it added a few things that are not\nnecessarily noticeable to a lot of people.\n\n141\n00:07:19,870 --> 00:07:23,680\nThere's enhanced script security,\nMicrosoft wanted to ensure that\n\n142\n00:07:23,680 --> 00:07:26,870\nmalicious scripts couldn't run on\nyour system using the PowerShell.\n\n143\n00:07:26,870 --> 00:07:30,200\nSo, we'll see some changes there,\nand some enhanced debugging.\n\n144\n00:07:30,200 --> 00:07:33,381\nWhen problems happen, Powershell 4.0\ncan give you more detailed logs,\n\n145\n00:07:33,381 --> 00:07:34,529\nand information about it.\n\n146\n00:07:34,529 --> 00:07:40,016\nNow, Powershell 5.0 is on the horizon,\nMicrosoft has announced Windows 10,\n\n147\n00:07:40,016 --> 00:07:43,433\nand Windows 10 will come\nwith Powershell 5.0.\n\n148\n00:07:43,433 --> 00:07:47,850\nThere's no release date yet, although\nthey're saying it'll be in the first, or\n\n149\n00:07:47,850 --> 00:07:52,030\nsecond quarter of 2015 is kind\nof what they're looking at now.\n\n150\n00:07:52,030 --> 00:07:55,480\nAnd when it comes out,\nthere'll be new features there too.\n\n151\n00:07:55,480 --> 00:07:59,240\nThe only one I'm really aware of so far,\nis something called package control.\n\n152\n00:07:59,240 --> 00:08:02,386\nRemember, I mentioned that\nPowerShell is extendable,\n\n153\n00:08:02,386 --> 00:08:04,685\nthat we can add more functionality to it.\n\n154\n00:08:04,685 --> 00:08:08,121\nWell, it gets a little challenging when\nyou've got add ons from five different\n\n155\n00:08:08,121 --> 00:08:10,803\nvendors, and how do you know\nif there's updates, and so on.\n\n156\n00:08:10,803 --> 00:08:14,901\nWell, in Powershell 5.0,\nyou'll have what are called repositories.\n\n157\n00:08:14,901 --> 00:08:17,525\nThe PowerShell can reach out\nto these repositories, and\n\n158\n00:08:17,525 --> 00:08:19,778\nmake sure it has the latest\naddition of an add on.\n\n159\n00:08:19,778 --> 00:08:22,970\nAnd then if an update comes out,\nIt can dynamically do the update.\n\n160\n00:08:22,970 --> 00:08:24,630\nIt's a really cool feature.\n\n161\n00:08:24,630 --> 00:08:26,660\nIt's another thing found in\nLinux platforms pretty commonly.\n\n162\n00:08:26,660 --> 00:08:29,633\nMicrosoft is now integrating\nthat into their PowerShell too.\n\n163\n00:08:29,633 --> 00:08:32,370\nSo, PowerShell 5.0,\nthat's the one I'm excited about.\n\n164\n00:08:32,370 --> 00:08:34,320\nI'm looking forward to getting into that.\n\n165\n00:08:34,320 --> 00:08:38,730\nBut for now,\nPowerShell 4.0 is what's stable.\n\n166\n00:08:38,730 --> 00:08:41,480\nThat's a little bit of\nhistory about the PowerShell.\n\n167\n00:08:41,480 --> 00:08:43,170\nI talked a little bit about what it is,\n\n168\n00:08:43,170 --> 00:08:47,510\na command line interface where we can\ndo all sorts of really cool stuff.\n\n169\n00:08:47,510 --> 00:08:50,540\nAnd that's what's gonna lead into all\nthe rest of the remaining segments of\n\n170\n00:08:50,540 --> 00:08:51,146\nthis series is.\n\n171\n00:08:52,680 --> 00:08:54,160\nDon, what's the cool stuff?\n\n172\n00:08:54,160 --> 00:08:55,450\nWell, we're gonna see that.\n\n173\n00:08:55,450 --> 00:08:57,850\nWe'll get a chance to take a look at\nhow that command line interface works,\n\n174\n00:08:57,850 --> 00:09:00,860\nwe'll get a chance to see it,\nand continue to work with it.\n\n175\n00:09:00,860 --> 00:09:04,600\nBut for right now, I think that's a pretty\ngood Introduction to the PowerShell, and\n\n176\n00:09:04,600 --> 00:09:05,650\nits history.\n\n177\n00:09:05,650 --> 00:09:07,692\nAnd now, we're ready to get\nstarted with the learning.\n\n178\n00:09:07,692 --> 00:09:15,056\n[SOUND]\n\n",
          "vimeoId": "113437106"
        },
        {
          "description": "",
          "length": "1461",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-1-basic-command-syntax-120114.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-1-basic-command-syntax-120114-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-1-basic-command-syntax-120114-sm.jpg",
          "title": "Basic Command Syntax",
          "transcript": "1\n00:00:00,351 --> 00:00:08,220\n[MUSIC]\n\n2\n00:00:08,220 --> 00:00:11,501\nIn this segment we're going to take a look\nat the basic ways that we can input\n\n3\n00:00:11,501 --> 00:00:12,945\ncommands into the PowerShell.\n\n4\n00:00:12,945 --> 00:00:15,655\nYou might be thinking to yourself\ncome on Don it's a command.\n\n5\n00:00:15,655 --> 00:00:17,185\nYou just type it and press enter.\n\n6\n00:00:17,185 --> 00:00:18,255\nWhat's more to it?\n\n7\n00:00:18,255 --> 00:00:22,035\nWell there's actually probably a good\nfive or six different ways we can\n\n8\n00:00:22,035 --> 00:00:26,075\nfeed commands into the PowerShell and\nit's pretty interesting how that works.\n\n9\n00:00:26,075 --> 00:00:27,935\nSo I want to show you each of those and\n\n10\n00:00:27,935 --> 00:00:30,645\nget you kind of familiar\nwith the basic syntax.\n\n11\n00:00:30,645 --> 00:00:34,445\nFirst off, the commands that we run,\nthey're not technically commands.\n\n12\n00:00:34,445 --> 00:00:36,810\nMicrosoft calls them commandlets.\n\n13\n00:00:36,810 --> 00:00:40,868\nAnd commandlets, that's just their little\nname that says that it's really a program,\n\n14\n00:00:40,868 --> 00:00:44,500\nand that command might\ndo more than one thing.\n\n15\n00:00:44,500 --> 00:00:47,900\nIf you think about the old style command\nline, commands, you'd type something\n\n16\n00:00:47,900 --> 00:00:50,930\nlike DIR and press enter,\nwell that was the directory command.\n\n17\n00:00:50,930 --> 00:00:53,620\nIt would pull up the directory and\nwhat files were in the directory.\n\n18\n00:00:53,620 --> 00:00:55,160\nDid one thing.\n\n19\n00:00:55,160 --> 00:00:56,850\nThat's how most commands work.\n\n20\n00:00:56,850 --> 00:01:00,860\nBut commandlets might actually\ncause a chain of events to happen.\n\n21\n00:01:00,860 --> 00:01:04,190\nSo that's why Microsoft just uses\na slightly different term for it.\n\n22\n00:01:04,190 --> 00:01:07,260\nCommandlets are really easy to spot\nbecause their names are always made up of\n\n23\n00:01:07,260 --> 00:01:08,480\ntwo pieces.\n\n24\n00:01:08,480 --> 00:01:12,420\nThere's a verb and\na hyphen, followed by noun.\n\n25\n00:01:12,420 --> 00:01:18,760\nThat verb is normally something like,\nget, set, modify, remove, right?\n\n26\n00:01:18,760 --> 00:01:21,280\nIt's an action,\nit's something that you're doing.\n\n27\n00:01:21,280 --> 00:01:22,920\nAnd then there's a hyphen\nfollowed by a noun and\n\n28\n00:01:22,920 --> 00:01:25,760\nthe noun is normally what\nit is you're modifying.\n\n29\n00:01:25,760 --> 00:01:28,840\nSo, for example, let me show you what's\nprobably the most important command that\n\n30\n00:01:28,840 --> 00:01:30,840\nwe're going to learn\nin this entire series,\n\n31\n00:01:30,840 --> 00:01:35,820\nwhich is the Get-Help command, all right.\n\n32\n00:01:35,820 --> 00:01:36,630\nGet, that's the verb.\n\n33\n00:01:36,630 --> 00:01:38,170\nI'm telling it I want to get something.\n\n34\n00:01:38,170 --> 00:01:39,088\nGet it and show it to me.\n\n35\n00:01:39,088 --> 00:01:45,020\nAnd then -Help, I want to pull up\nthe help for PowerShell, all right?\n\n36\n00:01:45,020 --> 00:01:47,150\nIf you ever wanna learn\nmore about a command and\n\n37\n00:01:47,150 --> 00:01:50,130\nfind information out about it,\nGet-Help is your go to guy.\n\n38\n00:01:50,130 --> 00:01:52,440\nThis is probably\nthe command I run the most.\n\n39\n00:01:52,440 --> 00:01:56,470\nSo, Get-Help, we just type it right\ninto the PowerShell and we press enter.\n\n40\n00:01:56,470 --> 00:02:01,160\nNow, with a commandlet,\nit's designed to run in the PowerShell.\n\n41\n00:02:01,160 --> 00:02:03,110\nHow do I know if I'm in the PowerShell?\n\n42\n00:02:03,110 --> 00:02:04,630\nYou might not be, right?\n\n43\n00:02:04,630 --> 00:02:07,560\nWindows still has the original\nshell present, right?\n\n44\n00:02:07,560 --> 00:02:09,400\nSo, it's not like it went away.\n\n45\n00:02:09,400 --> 00:02:11,590\nI've got it right here and\nI can pull it up.\n\n46\n00:02:11,590 --> 00:02:14,840\nAnd we can make use of it or\nwhatever it is that we want to do.\n\n47\n00:02:14,840 --> 00:02:18,510\nLet me just kind of change this font so\nI can actually read what's on the screen.\n\n48\n00:02:18,510 --> 00:02:19,490\nThere we go.\n\n49\n00:02:19,490 --> 00:02:22,440\nSo here I am but\nthe difference is in this command prompt\n\n50\n00:02:22,440 --> 00:02:25,530\nif I do DIR all the commands\nwe're used to, they work.\n\n51\n00:02:25,530 --> 00:02:29,890\nBut if I type Get-Help I get that\nit's not a program that's recognized.\n\n52\n00:02:29,890 --> 00:02:30,970\nIt doesn't work, right?\n\n53\n00:02:30,970 --> 00:02:33,040\nSo it's not a command prompt command.\n\n54\n00:02:34,060 --> 00:02:37,930\nBut if I get back here to my PowerShell\nand I type Get-help, there it is.\n\n55\n00:02:37,930 --> 00:02:39,810\nIt just did a bunch of stuff, right?\n\n56\n00:02:39,810 --> 00:02:41,060\nIt scrolled by really fast.\n\n57\n00:02:41,060 --> 00:02:43,630\nBut that's basically it running, right?\n\n58\n00:02:43,630 --> 00:02:46,250\nThe Windows PowerShell\nhas that functionality.\n\n59\n00:02:46,250 --> 00:02:48,980\nMicrosoft wants to remind you of\nwhen you're in the PowerShell, and\n\n60\n00:02:48,980 --> 00:02:51,060\nthat's why it looks so different.\n\n61\n00:02:51,060 --> 00:02:54,730\nYou'll notice when I pulled up that\nregular command prompt it was black\n\n62\n00:02:54,730 --> 00:02:59,300\nwith gray text, and the prompt was just,\nC:\\Users\\Don Pazet, and\n\n63\n00:02:59,300 --> 00:03:04,830\nthat was it, but here in PowerShell\nit's blue with a white text,\n\n64\n00:03:04,830 --> 00:03:07,040\nand it's got PS written\nat the very beginning.\n\n65\n00:03:07,040 --> 00:03:10,970\nThat's the reminder to me saying,\noh I'm in the PowerShell.\n\n66\n00:03:10,970 --> 00:03:14,940\nNow I'm on a Windows Server 2012 machine,\nand you'll see in Windows Server 2012,\n\n67\n00:03:14,940 --> 00:03:18,380\nPowerShell is added to\nyour task bar by default.\n\n68\n00:03:18,380 --> 00:03:20,380\nSo it's right there and you can launch it.\n\n69\n00:03:20,380 --> 00:03:25,280\nIn Windows 7 and\n8 it's installed by default, but\n\n70\n00:03:25,280 --> 00:03:27,210\nit's not under your Start menu.\n\n71\n00:03:27,210 --> 00:03:29,010\nI mean, under your task bar.\n\n72\n00:03:29,010 --> 00:03:30,672\nIn Windows 7 it is under your Start menu.\n\n73\n00:03:30,672 --> 00:03:33,040\nIf you pull up your Start menu and\ngo into All Programs,\n\n74\n00:03:33,040 --> 00:03:34,730\nyou'll find it sitting right in there.\n\n75\n00:03:34,730 --> 00:03:38,755\nIn In Windows 8 you can just use the\nsearch functionality on your start screen.\n\n76\n00:03:38,755 --> 00:03:43,125\nIf you bring up your start screen you\ncan type powershell or just power and\n\n77\n00:03:43,125 --> 00:03:45,405\nit'll be one of the first\nthings that comes up.\n\n78\n00:03:45,405 --> 00:03:47,692\nSo, quick and easy to get into it.\n\n79\n00:03:47,692 --> 00:03:50,982\nAnd then you're in your PowerShell.\n\n80\n00:03:50,982 --> 00:03:54,052\nAnd once you're there, you're able to\nstart using the PowerShell commands.\n\n81\n00:03:54,052 --> 00:03:57,532\nYou can type Get-Help and\nit's going to return that information.\n\n82\n00:03:58,574 --> 00:04:02,482\nNow, PowerShell is,\nlike the name implies, pretty powerful.\n\n83\n00:04:02,482 --> 00:04:06,172\nSo, there are a ton of commands\nthat are available in there.\n\n84\n00:04:06,172 --> 00:04:11,860\nIf you ever want to see the full list,\nthere's a command that is Get-Command.\n\n85\n00:04:11,860 --> 00:04:13,820\nThis is another great one that we can run.\n\n86\n00:04:13,820 --> 00:04:17,730\nGet-Command will show us all\nthe commands that are available.\n\n87\n00:04:17,730 --> 00:04:21,510\nSo here it is, it's going through and\nlisting all the commandlets and\n\n88\n00:04:21,510 --> 00:04:22,670\nfunctions that are available.\n\n89\n00:04:22,670 --> 00:04:24,910\nAnd we'll get a chance to\nsee more of these later.\n\n90\n00:04:24,910 --> 00:04:28,310\nThere's a ton, I actually don't\nknow how many are on here.\n\n91\n00:04:28,310 --> 00:04:30,380\nYou can even extend it and add your own,\n\n92\n00:04:30,380 --> 00:04:32,780\nso who knows how many\nyour system will have.\n\n93\n00:04:32,780 --> 00:04:35,410\nBut there are well over a thousand\n\n94\n00:04:35,410 --> 00:04:38,240\ndifferent command modes that\nare available for you to be able to run.\n\n95\n00:04:38,240 --> 00:04:40,960\nEach one performing some\ndifferent functionality.\n\n96\n00:04:40,960 --> 00:04:44,080\nBut they all follow that verb,\nnoun format, right.\n\n97\n00:04:44,080 --> 00:04:48,180\nSo, I've got unlock, unprotect,\nupdate, wait, write,\n\n98\n00:04:48,180 --> 00:04:50,350\nthose are all verbs, followed by nouns.\n\n99\n00:04:50,350 --> 00:04:54,080\nProcess, job, event,\nwhat is it that I'm working with?\n\n100\n00:04:54,080 --> 00:04:55,300\nIt's a simple syntax.\n\n101\n00:04:55,300 --> 00:04:58,180\nIt's designed to be fairly plain\nenglish so that if you look at one and\n\n102\n00:04:58,180 --> 00:05:00,088\nyou see something like this, Wait-Event.\n\n103\n00:05:00,088 --> 00:05:02,410\nYou should be able to guess what that is.\n\n104\n00:05:02,410 --> 00:05:05,660\nWe're waiting for\nsome kind of event to happen, right?\n\n105\n00:05:05,660 --> 00:05:09,040\nSo I have a pretty good idea\nof what that command does.\n\n106\n00:05:09,040 --> 00:05:14,365\nBut if I want to find out more,\nI can use Get-Help to find out more.\n\n107\n00:05:14,365 --> 00:05:20,375\nGet-Help followed by the command I want\nto learn about and I'll type Wait-Event.\n\n108\n00:05:23,010 --> 00:05:25,440\nAnd now it's going to tell\nme about that command.\n\n109\n00:05:25,440 --> 00:05:28,650\nSo it's giving me a little bit information\nhere and telling me what it's doing,\n\n110\n00:05:28,650 --> 00:05:31,870\nin my case it's telling me it cannot\nfind the help file for this commandlet.\n\n111\n00:05:31,870 --> 00:05:32,900\nThat's useful.\n\n112\n00:05:32,900 --> 00:05:35,670\nIt's just giving me really generic syntax.\n\n113\n00:05:35,670 --> 00:05:37,730\nThat's not great.\n\n114\n00:05:37,730 --> 00:05:40,440\nI'll show you how to fix\nthat in another segment.\n\n115\n00:05:40,440 --> 00:05:43,730\nWhat happens is when you install\nthe PowerShell it installs help files for\n\n116\n00:05:43,730 --> 00:05:46,020\nsome very common commands, and\n\n117\n00:05:46,020 --> 00:05:49,140\nthe less common commands it doesn't\ninstall the help files for.\n\n118\n00:05:49,140 --> 00:05:51,900\nAnd so we actually have to tell it to\ngo online and get those help files.\n\n119\n00:05:51,900 --> 00:05:58,329\nLet me pick something that's a little\nmore commonly used, like Get-Childobject.\n\n120\n00:05:58,329 --> 00:06:04,390\nActually, well searching help for\nit, and not finding it.\n\n121\n00:06:04,390 --> 00:06:09,190\nHow about Childitem,\nif I can type here that'll help me out.\n\n122\n00:06:09,190 --> 00:06:11,220\nThere we go, so here's Get-Childitem, and\n\n123\n00:06:11,220 --> 00:06:13,420\nactually that one's help\nfiles not pulling up either.\n\n124\n00:06:13,420 --> 00:06:15,570\nSo yeah, we'll definitely have\nto do an update on this one.\n\n125\n00:06:15,570 --> 00:06:18,710\nBut you can use that to pull extended\ninformation about most commands and\n\n126\n00:06:18,710 --> 00:06:21,970\nyou see a description of what they are and\nhow they work.\n\n127\n00:06:21,970 --> 00:06:22,820\nWhen you're running that.\n\n128\n00:06:22,820 --> 00:06:24,295\nWhat you're actually running two things.\n\n129\n00:06:24,295 --> 00:06:28,710\nGet-Help is the commandlet\nfollowed by modifiers.\n\n130\n00:06:28,710 --> 00:06:31,490\nAnd the modifiers can\nspecify all sorts of things.\n\n131\n00:06:31,490 --> 00:06:33,312\nWhat action you want to perform.\n\n132\n00:06:33,312 --> 00:06:35,200\nWhat it is that you're\ntrying to do on the system.\n\n133\n00:06:35,200 --> 00:06:38,400\nSo I might want to do a Stop-Service.\n\n134\n00:06:38,400 --> 00:06:42,600\nSo I'm going to stop a service\nthat is running on my system and\n\n135\n00:06:42,600 --> 00:06:46,520\nthen I would follow that up with a name.\n\n136\n00:06:46,520 --> 00:06:50,390\nAnd I might say -Name dnsclient.\n\n137\n00:06:50,390 --> 00:06:50,900\nRight?\n\n138\n00:06:50,900 --> 00:06:54,120\nApparently my name is wrong though,\nit didn't seem to like that.\n\n139\n00:06:54,120 --> 00:06:56,170\nAnd so I might have my syntax wrong.\n\n140\n00:06:56,170 --> 00:06:59,970\nIt might just be Stop-Service dnsclient\nbut it is not finding that one either so\n\n141\n00:06:59,970 --> 00:07:02,280\nI might not have\nthe dnsclient enabled at all.\n\n142\n00:07:02,280 --> 00:07:06,940\nSo we run the command, and it goes and\ngives us a nice little error here.\n\n143\n00:07:06,940 --> 00:07:11,050\nThe error is kind of nice because\nit tells you where your problem is.\n\n144\n00:07:11,050 --> 00:07:12,190\nSo when I look at this here it's tell me,\n\n145\n00:07:12,190 --> 00:07:14,810\nit cannot find any service\nwith the name dnsclient.\n\n146\n00:07:14,810 --> 00:07:17,490\nSo apparently I'm using the wrong name for\nit,\n\n147\n00:07:17,490 --> 00:07:20,010\nor it just has a different\nname than what I'm used to.\n\n148\n00:07:20,010 --> 00:07:23,618\nSo we would need to go and update to\nfind out what that proper name was.\n\n149\n00:07:23,618 --> 00:07:28,100\nAnd specify that,\nI could do a Get-Service, and\n\n150\n00:07:28,100 --> 00:07:31,180\nthen that's going to run and\nshow me all the services.\n\n151\n00:07:31,180 --> 00:07:33,530\nAnd I can go and\nfind the dnsclient in there and\n\n152\n00:07:33,530 --> 00:07:37,460\nsee what it's actually called\nsince apparently I don't know.\n\n153\n00:07:37,460 --> 00:07:40,730\nAnd the dnsclient is\nactually called Dnscache.\n\n154\n00:07:41,840 --> 00:07:44,430\nSo if I use the right name this\nwill work a little better for me.\n\n155\n00:07:44,430 --> 00:07:48,140\nSo I wanna do Stop-Service dnscache.\n\n156\n00:07:50,640 --> 00:07:55,152\nNow, notice up here,\nwhen I've found it in my list, Dnscache.\n\n157\n00:07:55,152 --> 00:07:59,134\nYou see how the D is capitalized right\nthere and the rest of it is lowercase?\n\n158\n00:07:59,134 --> 00:08:00,719\nI can write it that way.\n\n159\n00:08:00,719 --> 00:08:03,420\nSo if we go back here and\nI'll just come in and\n\n160\n00:08:03,420 --> 00:08:07,216\npunch it in like that and\nit's going to reach out and stop it and\n\n161\n00:08:07,216 --> 00:08:11,020\n[LAUGH] now i've bumped into\nanother issue that I know of.\n\n162\n00:08:11,020 --> 00:08:15,160\nIn this case I didn't run the PowerShell\nas an administrator and so\n\n163\n00:08:15,160 --> 00:08:17,450\nI'm not allowed to stop the service.\n\n164\n00:08:17,450 --> 00:08:21,680\nSo here it's just saying it cannot\nopen the Dnscache in this system and\n\n165\n00:08:21,680 --> 00:08:23,920\nit's because I didn't run\nit as an administrator.\n\n166\n00:08:23,920 --> 00:08:28,330\nWhen you just click the PowerShell icon,\nyou're running it as a regular user.\n\n167\n00:08:28,330 --> 00:08:29,930\nYou have user account control or\n\n168\n00:08:29,930 --> 00:08:33,420\nUAC that's in there that's preventing\nyou from doing certain things.\n\n169\n00:08:33,420 --> 00:08:36,780\nBut if you right click on that button,\nyou'll see run as administrator.\n\n170\n00:08:36,780 --> 00:08:38,920\nAnd there we can fire\nthe command prompt up.\n\n171\n00:08:38,920 --> 00:08:42,380\nAs an administrator, and\nnow we'll be able to do more.\n\n172\n00:08:42,380 --> 00:08:45,600\nWe'll be able to say Stop-Service,\noops, if we can spell it.\n\n173\n00:08:47,240 --> 00:08:48,230\nThere we go.\n\n174\n00:08:48,230 --> 00:08:49,790\nAnd then we can specify Dnscache.\n\n175\n00:08:49,790 --> 00:08:53,090\nAnd it's gonna jump in there and stop it.\n\n176\n00:08:53,090 --> 00:08:53,640\nOkay.\n\n177\n00:08:53,640 --> 00:08:56,130\nAnd if I do Get-Service, and I go in, and\n\n178\n00:08:56,130 --> 00:09:00,930\nI find my Dnscache again,\nI'll just go find it here.\n\n179\n00:09:00,930 --> 00:09:03,810\nI can see that it is now stopped, right?\n\n180\n00:09:03,810 --> 00:09:05,900\nSo, then we can start it back up again.\n\n181\n00:09:05,900 --> 00:09:07,750\nIf Stop-Service stopped it,\n\n182\n00:09:07,750 --> 00:09:11,410\nit's pretty good guess that\nStart-Service is gonna start it again.\n\n183\n00:09:11,410 --> 00:09:14,300\nMost of your commands are gonna be\nlike that, fairly intuitive, right?\n\n184\n00:09:14,300 --> 00:09:19,640\nWe can figure out what we need to do\nFabian just asked in the chatroom there.\n\n185\n00:09:19,640 --> 00:09:22,710\nI was leading in to that point and\ngot sidetracked.\n\n186\n00:09:22,710 --> 00:09:25,000\nI mentioned how there was capitalization.\n\n187\n00:09:25,000 --> 00:09:28,530\nSee how I've got that capital D there and\nI've capitalized my words.\n\n188\n00:09:28,530 --> 00:09:29,920\nI'm just doing that\nbecause it looks nicer.\n\n189\n00:09:29,920 --> 00:09:32,900\nIt's the way they write it\nin the help files and stuff.\n\n190\n00:09:32,900 --> 00:09:36,600\nBut for the most part,\nPowerShell is not case sensitive.\n\n191\n00:09:36,600 --> 00:09:39,700\nThere are some areas where there's\nvalues that are case sensitive, but\n\n192\n00:09:39,700 --> 00:09:41,370\nit's not PowerShell's fault.\n\n193\n00:09:41,370 --> 00:09:44,750\nIt's whatever system it's\ncalling that determines that.\n\n194\n00:09:44,750 --> 00:09:47,250\nAs far as PowerShell is concerned though,\nit's not.\n\n195\n00:09:47,250 --> 00:09:52,590\nSo if I were to run Stop-Service Dnscache\nand I were to do it all lowercase.\n\n196\n00:09:52,590 --> 00:09:56,420\nSo I'll just go and change all my casing\nthere to all lowercase and run it.\n\n197\n00:09:56,420 --> 00:09:58,210\nIt runs just the same.\n\n198\n00:09:58,210 --> 00:10:03,790\nSo, as far as PowerShell is concerned,\nit's not case sensitive.\n\n199\n00:10:03,790 --> 00:10:06,660\nBut just be aware that if you put\nin add-ons, if you're managing\n\n200\n00:10:06,660 --> 00:10:11,120\nMicrosoft Exchange, or Active Directory or\nsomething, you may bump into an area where\n\n201\n00:10:11,120 --> 00:10:16,360\nthey require a value to be case sensitive,\nand that's where it gets a little flaky.\n\n202\n00:10:16,360 --> 00:10:18,030\nIt becomes inconsistent.\n\n203\n00:10:18,030 --> 00:10:21,560\nAnd for me, I kind of just make it\na habit of following the casing,\n\n204\n00:10:21,560 --> 00:10:24,580\njust to be on the safe side,\nbut probably 95% of the time,\n\n205\n00:10:24,580 --> 00:10:28,790\nyou don't have to worry about the case.\n\n206\n00:10:28,790 --> 00:10:32,910\nAll right, now, not everything in\nthe PowerShell has to be a commandlet.\n\n207\n00:10:32,910 --> 00:10:33,990\nThe commandlets are nice.\n\n208\n00:10:33,990 --> 00:10:35,000\nWe've got a ton of them, right?\n\n209\n00:10:35,000 --> 00:10:38,050\nOver a thousand of them that\nare available to do all sorts of stuff.\n\n210\n00:10:38,050 --> 00:10:40,530\nBut there's other things we can do,\ntoo, like expressions.\n\n211\n00:10:41,590 --> 00:10:45,410\nIf you ever find yourself\nwondering what one plus one is,\n\n212\n00:10:45,410 --> 00:10:46,360\nyou can type it into Power Shell.\n\n213\n00:10:46,360 --> 00:10:50,710\nIf I type 1+1 and press Enter,\nit tells me that it's 2.\n\n214\n00:10:50,710 --> 00:10:51,400\nOne plus one is two.\n\n215\n00:10:51,400 --> 00:10:53,670\nWe learned something\nnew on the show today.\n\n216\n00:10:53,670 --> 00:10:54,530\nSo, there it is.\n\n217\n00:10:54,530 --> 00:10:55,800\nSimple expression.\n\n218\n00:10:55,800 --> 00:10:58,100\nAnd you can do spaces on these.\n\n219\n00:10:58,100 --> 00:11:01,700\nSome people like to do that for\nreadability, and it'll figure it out.\n\n220\n00:11:01,700 --> 00:11:03,278\nYou can do advanced mathematics.\n\n221\n00:11:03,278 --> 00:11:07,270\n289 / 12, and it'll calculate that out.\n\n222\n00:11:07,270 --> 00:11:09,080\nYou can even do order of operations.\n\n223\n00:11:09,080 --> 00:11:13,965\nIf I do like (7 + 4) /\n\n224\n00:11:13,965 --> 00:11:18,660\n(8 * 9), right?\n\n225\n00:11:18,660 --> 00:11:21,120\nWriting that out,\nit'll work that out, too.\n\n226\n00:11:21,120 --> 00:11:23,040\nAnd you can even do units.\n\n227\n00:11:23,040 --> 00:11:25,040\nSo, for example, 1GB.\n\n228\n00:11:26,500 --> 00:11:31,490\n1GB to a lot of us,\nwe think of that as 1 million bytes.\n\n229\n00:11:31,490 --> 00:11:33,350\nBut it really isn't, is it?\n\n230\n00:11:33,350 --> 00:11:41,320\n1GB is actually 1 million, let me work\nout my numbers here and get this right.\n\n231\n00:11:41,320 --> 00:11:42,870\nIt is, oh, 1 billion.\n\n232\n00:11:42,870 --> 00:11:44,716\nShoot.\nI was off by an entire order of magnitude.\n\n233\n00:11:44,716 --> 00:11:51,893\nSo, we think of it as one billion bytes,\nbut it's actually 1,073,741,824 Bytes,\n\n234\n00:11:51,893 --> 00:11:57,510\nand that's because of the way sector\nsizes are measured on hard drives.\n\n235\n00:11:57,510 --> 00:12:02,810\nAnd so if we start feeding it values like\n1GB, it understands that to be accurate.\n\n236\n00:12:02,810 --> 00:12:10,160\nAnd if you mix things,\nif you say like 1GB + 500MB, right?\n\n237\n00:12:10,160 --> 00:12:14,030\nIt'll actually work that out and\ngive you the value corrected for\n\n238\n00:12:14,030 --> 00:12:15,068\nthe actual byte size.\n\n239\n00:12:15,068 --> 00:12:19,150\nSo really neat stuff that you can do from\nthe command prompt inside a PowerShell.\n\n240\n00:12:19,150 --> 00:12:21,650\nThis is where we're starting to\nget closer to the Linux-like\n\n241\n00:12:21,650 --> 00:12:23,790\nenvironment where you can do logic.\n\n242\n00:12:23,790 --> 00:12:26,120\nAdvanced logic right here\nfrom the command prompt.\n\n243\n00:12:26,120 --> 00:12:29,770\nThis stuff didn't work in the regular\ncommand prompt in Windows.\n\n244\n00:12:29,770 --> 00:12:30,810\nBut in the PowerShell, it does.\n\n245\n00:12:32,510 --> 00:12:33,210\nAll right.\n\n246\n00:12:33,210 --> 00:12:35,530\nSome of the other things\nthat we might see.\n\n247\n00:12:35,530 --> 00:12:39,220\nWhen we do commands,\nthings like Get-Help, or\n\n248\n00:12:39,220 --> 00:12:43,170\nthose operators that I just did or the\nexpressions that I just did right there,\n\n249\n00:12:43,170 --> 00:12:45,870\nwhen we do those,\nwe can type them in like I did here.\n\n250\n00:12:45,870 --> 00:12:49,290\nBut if you've got a series of\nten commands that you wanna run.\n\n251\n00:12:49,290 --> 00:12:53,080\nYou might not want to have\nto type in all ten of them.\n\n252\n00:12:53,080 --> 00:12:55,650\nSo you might choose to\ncreate a script file.\n\n253\n00:12:55,650 --> 00:12:59,940\nIn power shell you can create script files\nreally easy, they're just text files and\n\n254\n00:12:59,940 --> 00:13:02,560\nthe extension is .ps1.\n\n255\n00:13:02,560 --> 00:13:06,120\nAnd it was from the PowerShell 1.0\ndays but they didn't change it.\n\n256\n00:13:06,120 --> 00:13:08,770\nMicrosoft made a few mistakes with\nPowerShell 1.0 with putting the version\n\n257\n00:13:08,770 --> 00:13:10,250\nnumber in places where\nthey shouldn't have.\n\n258\n00:13:10,250 --> 00:13:11,750\nAnd so PowerShell's one of those.\n\n259\n00:13:12,780 --> 00:13:17,410\nSo we've got any file that ends\nin .ps1 is a PowerShell script.\n\n260\n00:13:17,410 --> 00:13:20,780\nAnd in a PowerShell script all you do is\nput all the commands that you want to run\n\n261\n00:13:20,780 --> 00:13:23,320\nand then you can call that script.\n\n262\n00:13:23,320 --> 00:13:28,120\nNow by default in PowerShell\n4.0 scripting is disabled.\n\n263\n00:13:28,120 --> 00:13:31,430\nIf I were to create a script right now,\nit actually won't work.\n\n264\n00:13:31,430 --> 00:13:32,780\nSo let me show you what I mean.\n\n265\n00:13:33,860 --> 00:13:36,870\nSo if I get into,\nI'll just go to my desktop here.\n\n266\n00:13:36,870 --> 00:13:42,360\nAnd I'll do notepad test.ps1, all right?\n\n267\n00:13:42,360 --> 00:13:45,868\nAnd so\nI'm going to create a file here, and\n\n268\n00:13:45,868 --> 00:13:51,700\nI'm just going to put in a Get-Help and\n1GB + 500MB, right.\n\n269\n00:13:51,700 --> 00:13:54,530\nTwo commands that we saw work\njust fine a moment ago, right, so\n\n270\n00:13:54,530 --> 00:13:57,394\nI'm just gonna put those right here\nin my script and I'll save that.\n\n271\n00:13:58,660 --> 00:14:05,052\nNow when I save it I can take a look and\n\n272\n00:14:05,052 --> 00:14:08,510\nthere's my test.ps1,\nthat's a PowerShell script.\n\n273\n00:14:08,510 --> 00:14:10,780\nWhenever you run a script in PowerShell,\n\n274\n00:14:10,780 --> 00:14:15,100\nyou have to provide the path to\nthe script in order to execute it.\n\n275\n00:14:15,100 --> 00:14:18,440\nYou can type out the full path\nif you want to get there.\n\n276\n00:14:18,440 --> 00:14:23,011\nOr you can type .\\ which means\nthe current directory that I'm in, it's\n\n277\n00:14:23,011 --> 00:14:27,965\nkind of a shortcut we can use, and that\nshortcut existed in the old DOS days too.\n\n278\n00:14:27,965 --> 00:14:31,190\nSo you might already be\nfamiliar with that one.\n\n279\n00:14:31,190 --> 00:14:35,150\nBut .\\test.ps1,\nthat's the script I'm gonna call.\n\n280\n00:14:35,150 --> 00:14:38,240\nIf I try to call it without that,\nit may or may not find it.\n\n281\n00:14:38,240 --> 00:14:42,870\nIf you don't include a path it looks for\nthe path variable and the path variable\n\n282\n00:14:42,870 --> 00:14:47,650\nusually doesn't include your desktop, it\nincludes things like C:\\windows\\system32\n\n283\n00:14:47,650 --> 00:14:51,280\nfolders like that, those are included but\nwe don't put our scripts there.\n\n284\n00:14:51,280 --> 00:14:55,070\nSo that's why it's important to put\nthat path in there And when I run it.\n\n285\n00:14:55,070 --> 00:14:58,800\nWell, I've enabled the scripting\non mine so it is going to run.\n\n286\n00:14:58,800 --> 00:15:01,110\nBut on yours, if you try and\nrun it out of the box, it won't.\n\n287\n00:15:01,110 --> 00:15:03,670\nAnd look for, we've got a segment\ncoming up here in a minute.\n\n288\n00:15:03,670 --> 00:15:06,660\nAbout what are called\nscript execution policies.\n\n289\n00:15:06,660 --> 00:15:08,480\nAnd if you find that your\nscripts aren't running,\n\n290\n00:15:08,480 --> 00:15:09,730\nI'll show you how to correct that.\n\n291\n00:15:09,730 --> 00:15:11,910\nHow you go through and\nactually enable that.\n\n292\n00:15:11,910 --> 00:15:13,230\nBut when I ran it.\n\n293\n00:15:13,230 --> 00:15:17,160\nYou'll see in here, I just ran that\ntest.ps1, and here's my help, right?\n\n294\n00:15:17,160 --> 00:15:21,720\nSo it ran Get-Help, and\nthen after that at the very end,\n\n295\n00:15:21,720 --> 00:15:27,320\nhere's the math result of, what was it?\n\n296\n00:15:27,320 --> 00:15:28,970\n1GB + 500MB, right?\n\n297\n00:15:28,970 --> 00:15:30,980\nSo it output that right there at the end.\n\n298\n00:15:30,980 --> 00:15:32,900\nScripting is super easy in PowerShell.\n\n299\n00:15:32,900 --> 00:15:35,970\nYou just write the various commands you\nwant to run in the order you want to run\n\n300\n00:15:35,970 --> 00:15:37,420\nand you call it.\n\n301\n00:15:37,420 --> 00:15:38,880\nThat's a pretty basic script.\n\n302\n00:15:38,880 --> 00:15:41,560\nWe'll see in later shows that you can\nactually get pretty advanced with this and\n\n303\n00:15:41,560 --> 00:15:42,630\nyou can put a lot of logic in there.\n\n304\n00:15:42,630 --> 00:15:44,960\nYou can say check if this file exists,\n\n305\n00:15:44,960 --> 00:15:47,460\nand if it does exist do\nthese series of actions.\n\n306\n00:15:47,460 --> 00:15:49,874\nAnd if it doesn't exist do this\nother series of actions so\n\n307\n00:15:49,874 --> 00:15:53,014\nyou can create advanced logic and\nnow your script becomes very powerful.\n\n308\n00:15:53,014 --> 00:15:57,444\nAnd you can even have where your script\ntakes inputs so you can feed values to it.\n\n309\n00:15:57,444 --> 00:16:01,382\nMaybe your script runs a series of\ncommands But you wanna be able to specify\n\n310\n00:16:01,382 --> 00:16:04,980\nwhat computer it runs on so\nyou can feed that in via script.\n\n311\n00:16:04,980 --> 00:16:08,790\nSo scripting like this is a very\ncommon way to run commands.\n\n312\n00:16:08,790 --> 00:16:10,340\nSo we've seen three\ndifferent commands before.\n\n313\n00:16:10,340 --> 00:16:15,450\nWe've seen command lets, we've seen\nexpressions, right, mathematical formulas.\n\n314\n00:16:15,450 --> 00:16:16,920\nAnd now we've seen scripts.\n\n315\n00:16:18,070 --> 00:16:19,180\nBut that's not the end of it.\n\n316\n00:16:19,180 --> 00:16:22,660\nThere's even some other ones\nthat are [LAUGH] out there.\n\n317\n00:16:22,660 --> 00:16:25,600\nOne of the other things we're gonna see\na little bit later is something called\n\n318\n00:16:25,600 --> 00:16:26,750\na function.\n\n319\n00:16:26,750 --> 00:16:28,340\nAnd an alias.\n\n320\n00:16:28,340 --> 00:16:29,890\nAnd so we've got segments on those too.\n\n321\n00:16:29,890 --> 00:16:34,130\nBut an alias is just a nickname for\nanother command.\n\n322\n00:16:34,130 --> 00:16:37,232\nAll right.\nYou'll notice I ran dir a minute ago,\n\n323\n00:16:37,232 --> 00:16:39,690\nwhich is directory, okay.\n\n324\n00:16:39,690 --> 00:16:43,460\nThat's not a verb/noun format is it?\n\n325\n00:16:43,460 --> 00:16:47,627\nDir is an old school command,\nit's an old DOS command, line command, and\n\n326\n00:16:47,627 --> 00:16:49,626\nit pulls up the directory listing.\n\n327\n00:16:49,626 --> 00:16:54,918\nWell dir, that's actually an alias for\nanother command.\n\n328\n00:16:54,918 --> 00:17:02,570\nIf I do get-alias dir, it'll show me that\nit's actually an alias for get-childitem.\n\n329\n00:17:02,570 --> 00:17:05,030\nSee there's my verb/noun format.\n\n330\n00:17:05,030 --> 00:17:10,410\nIf I do get-childitem, and run that,\nit's the same exact output.\n\n331\n00:17:10,410 --> 00:17:14,440\nSo sometimes we're not typing\na commandlet, we're typing an alias.\n\n332\n00:17:14,440 --> 00:17:17,390\nAnd we'll see how to create our own\naliases later, which can be kind of handy.\n\n333\n00:17:19,170 --> 00:17:22,130\nSometimes you'll have commands\nlike these that aren't an alias,\n\n334\n00:17:22,130 --> 00:17:24,340\nbut they are function.\n\n335\n00:17:24,340 --> 00:17:27,620\nWell functions, what they allow you\nto do is not only do a nickname for\n\n336\n00:17:27,620 --> 00:17:30,780\na command, but\nalso pass additional parameters to it.\n\n337\n00:17:30,780 --> 00:17:33,750\nSo you can have different configurations\nfor how a command runs, and\n\n338\n00:17:33,750 --> 00:17:35,020\nthat's pretty powerful stuff too.\n\n339\n00:17:35,020 --> 00:17:36,710\nI'll show some examples in another second.\n\n340\n00:17:38,000 --> 00:17:41,410\nAll right, so those are some of\nthe different ways that we can do it,\n\n341\n00:17:41,410 --> 00:17:45,430\nwe'll also see that our commands\nsometimes can be really long.\n\n342\n00:17:45,430 --> 00:17:48,650\nAnd as you're typing a command,\nthe longer the command is,\n\n343\n00:17:48,650 --> 00:17:53,970\nthe more likely that it is going\nto wrap around the screen, right.\n\n344\n00:17:53,970 --> 00:17:58,710\nSo if I'm typing some really long command,\nI'll hit the edge of the screen and\n\n345\n00:17:58,710 --> 00:18:02,420\nit'll start to wrap\naround to the next line.\n\n346\n00:18:02,420 --> 00:18:05,390\nThat can make readability\na little bit challenging.\n\n347\n00:18:05,390 --> 00:18:08,600\nWe won't see that in our early segments\nin this show, but some of the later ones\n\n348\n00:18:08,600 --> 00:18:12,270\nthat we do like in active directory,\nthe commands can get really long.\n\n349\n00:18:12,270 --> 00:18:15,090\nThe sequel ones, boy,\nthose are the really long ones.\n\n350\n00:18:15,090 --> 00:18:20,350\nSo if you ever want to manually wrap\na command around the edge of a line,\n\n351\n00:18:20,350 --> 00:18:23,730\nyou can do that by using the back tick.\n\n352\n00:18:23,730 --> 00:18:28,110\nThe back tick, it's usually on the tilt\nkey of your keyboard at the top left.\n\n353\n00:18:28,110 --> 00:18:31,000\nAnd basically it says,\nthis command isn't done yet.\n\n354\n00:18:31,000 --> 00:18:31,670\nAll right.\n\n355\n00:18:31,670 --> 00:18:37,960\nSo if I do something like set-location,\nall right.\n\n356\n00:18:37,960 --> 00:18:40,120\nThat's a way that I can\nchange what directory I'm in.\n\n357\n00:18:40,120 --> 00:18:43,180\nSo I can change like my C drive,\nall right.\n\n358\n00:18:43,180 --> 00:18:48,520\nWell I could run set-location and\nthen do a back tick like that.\n\n359\n00:18:48,520 --> 00:18:52,060\nAnd when I press Enter,\nsee what happened to my command?\n\n360\n00:18:52,060 --> 00:18:53,460\nIt didn't run it.\n\n361\n00:18:53,460 --> 00:18:55,650\nIt just moved me to the next line.\n\n362\n00:18:55,650 --> 00:19:00,410\nAnd now I can type in,\nwhere it is that I want to go to, and\n\n363\n00:19:00,410 --> 00:19:01,832\nI can start to type that in.\n\n364\n00:19:01,832 --> 00:19:04,470\nYou know I picked a bad example there\nbecause that looks it's gonna be\n\n365\n00:19:04,470 --> 00:19:05,170\na long one.\n\n366\n00:19:05,170 --> 00:19:11,450\nBut I could type in c:/Windows, and\nnow it knows, hey my command is not over.\n\n367\n00:19:11,450 --> 00:19:13,290\nI can keep doing additional lines.\n\n368\n00:19:13,290 --> 00:19:16,630\nTyping more and more and\nmore until it executes.\n\n369\n00:19:16,630 --> 00:19:18,010\nThat was just the back tick that did that,\n\n370\n00:19:18,010 --> 00:19:21,270\nthat was the one that gets\nthat in place and runs it.\n\n371\n00:19:22,370 --> 00:19:25,130\nAll right, now we're not\ngonna need that anytime soon.\n\n372\n00:19:25,130 --> 00:19:28,420\nI just wanted you to be aware that if\nyou ever see an example on the internet,\n\n373\n00:19:28,420 --> 00:19:31,480\non the internet a lot of times they'll\nformat them to fit on a web page nicely.\n\n374\n00:19:31,480 --> 00:19:33,290\nAnd they'll put those back ticks in there.\n\n375\n00:19:33,290 --> 00:19:36,140\nAnd what you can do is you can\njust delete that back tick and\n\n376\n00:19:36,140 --> 00:19:38,430\nwrite it as one command.\n\n377\n00:19:38,430 --> 00:19:42,870\nSo if I write it like this,\nit's all on one line and we move.\n\n378\n00:19:42,870 --> 00:19:43,489\nWhen you run it,\n\n379\n00:19:43,489 --> 00:19:46,293\nthat's what Windows is doing anyway,\nit's turning it into one big line.\n\n380\n00:19:46,293 --> 00:19:47,668\nAnd executing it that way.\n\n381\n00:19:49,960 --> 00:19:50,516\nAll right,\n\n382\n00:19:50,516 --> 00:19:54,570\none of the biggest challenges inside\nof the PowerShell is finding a command.\n\n383\n00:19:54,570 --> 00:19:55,860\nThere's so many of them.\n\n384\n00:19:55,860 --> 00:19:58,050\nHow do you know what\ncommands are available?\n\n385\n00:19:58,050 --> 00:20:01,110\nThat's one of the real challenges\na lot of us have to deal with.\n\n386\n00:20:01,110 --> 00:20:05,300\nUnfortunately, we can do searches\npretty easily to find those.\n\n387\n00:20:05,300 --> 00:20:08,537\nSo I showed you Get-Command earlier.\n\n388\n00:20:08,537 --> 00:20:11,050\nAnd when you run Get-Command.\n\n389\n00:20:11,050 --> 00:20:12,320\nBoy, that's a lot of stuff.\n\n390\n00:20:12,320 --> 00:20:13,880\nAll right, but if I'm looking for\n\n391\n00:20:13,880 --> 00:20:17,180\nsomething in particular,\nlike I want to work with a,\n\n392\n00:20:17,180 --> 00:20:22,430\nlet's say events right, because I've\ngot this way ads event right here.\n\n393\n00:20:22,430 --> 00:20:25,790\nSo I wanna find any action\nthat deals with events.\n\n394\n00:20:27,140 --> 00:20:35,420\nSo what I could do is I can run get\ncash command followed by *event* right.\n\n395\n00:20:36,490 --> 00:20:39,060\nWhat I'm doing is I'm saying, a wild card.\n\n396\n00:20:39,060 --> 00:20:42,710\nThe star, the asterisk there,\nthat represents any character or\n\n397\n00:20:42,710 --> 00:20:43,970\nnumber of characters.\n\n398\n00:20:43,970 --> 00:20:46,740\nSo any command that has the word event.\n\n399\n00:20:46,740 --> 00:20:48,480\nIn it somewhere, right.\n\n400\n00:20:48,480 --> 00:20:50,880\nThat's what I'm looking for, okay.\n\n401\n00:20:50,880 --> 00:20:54,230\nNow when I run that,\nI may get more than I want, right.\n\n402\n00:20:54,230 --> 00:20:56,530\nI may get some that have EventLog in them.\n\n403\n00:20:56,530 --> 00:20:57,670\nSome are just Event.\n\n404\n00:20:57,670 --> 00:21:00,630\nSo there's variations that\nare available in here.\n\n405\n00:21:00,630 --> 00:21:04,890\nMaybe I'm specifically\nconcerned about the EventLog.\n\n406\n00:21:04,890 --> 00:21:08,390\nI might wanna change this\nto change get-command.\n\n407\n00:21:08,390 --> 00:21:12,020\n*-EventLog, like that.\n\n408\n00:21:12,020 --> 00:21:15,410\nNow I'm saying, just show me\nthe commands that end with Event Log.\n\n409\n00:21:15,410 --> 00:21:19,400\nI don't know what the verb is, but\nthe noun is going to be Event Log.\n\n410\n00:21:19,400 --> 00:21:23,430\nAnd now I can see clear the Event Log,\nget the Event Log, limit it, new,\n\n411\n00:21:23,430 --> 00:21:25,230\nremove, show, write.\n\n412\n00:21:25,230 --> 00:21:27,490\nSo here's the various ones\nthat are available to me.\n\n413\n00:21:27,490 --> 00:21:29,440\nNow I start to get an idea\nof what we can do.\n\n414\n00:21:29,440 --> 00:21:33,380\nAll right, and\nthese aren't case sensitive.\n\n415\n00:21:33,380 --> 00:21:38,040\nIf I change this, see how I get the same\nresult there even with lower case, so\n\n416\n00:21:38,040 --> 00:21:39,470\nyou don't have to be precise.\n\n417\n00:21:39,470 --> 00:21:41,000\nI normally start out with\nsomething general, like,\n\n418\n00:21:41,000 --> 00:21:42,830\nhey I wanna work with user accounts.\n\n419\n00:21:42,830 --> 00:21:49,470\nSo I do get-command *user*, right, show me\neverything that has the word user in it.\n\n420\n00:21:49,470 --> 00:21:50,470\nAll right.\nSo I get this list.\n\n421\n00:21:50,470 --> 00:21:54,040\nAnd then I can start to narrow it down\na little bit based on what I wanted.\n\n422\n00:21:54,040 --> 00:21:57,100\nLike here active directory user,\nthat's what I wanted.\n\n423\n00:21:57,100 --> 00:22:03,920\nAnd so now I can say get-command *-ADUser,\nand now I'm just seeing those.\n\n424\n00:22:03,920 --> 00:22:08,650\nGet, remove, set and new, let's run\nover those four verbs right there,\n\n425\n00:22:08,650 --> 00:22:10,520\nbecause those are the four\nmost common verbs.\n\n426\n00:22:10,520 --> 00:22:13,120\nGet, that just means retrieve information.\n\n427\n00:22:13,120 --> 00:22:17,320\nYou're not actually changing anything,\nyou're just getting some information.\n\n428\n00:22:17,320 --> 00:22:20,410\nNew, that means we're creating a new user.\n\n429\n00:22:20,410 --> 00:22:22,220\nWe're adding something new to the system,\n\n430\n00:22:22,220 --> 00:22:25,000\nwe are making a change by\nintroducing something new.\n\n431\n00:22:25,000 --> 00:22:27,450\nSometimes you'll see the word add instead.\n\n432\n00:22:27,450 --> 00:22:30,199\nSo you might see new or add,\nbut new is the most common.\n\n433\n00:22:31,490 --> 00:22:32,400\nRemove.\n\n434\n00:22:32,400 --> 00:22:33,320\nLike the name implies,\n\n435\n00:22:33,320 --> 00:22:36,760\nthat's gonna get rid of it,\ndelete something out of the system.\n\n436\n00:22:36,760 --> 00:22:38,490\nAnd then set.\n\n437\n00:22:38,490 --> 00:22:41,040\nThat's the one that modifies a record.\n\n438\n00:22:41,040 --> 00:22:44,300\nWhen you say set-aduser,\nyou're setting some property,\n\n439\n00:22:44,300 --> 00:22:48,450\nyou're changing some value for\nthat user, and modifying what they do.\n\n440\n00:22:48,450 --> 00:22:50,530\nThose are the four most common verbs,\n\n441\n00:22:50,530 --> 00:22:53,850\nright there, that you'll encounter\nworking with power shell.\n\n442\n00:22:53,850 --> 00:22:57,630\nAnd so when we start to look at these\ncommands, you'll see tons of them.\n\n443\n00:22:58,740 --> 00:23:04,080\nIf I want to do like get-command and\nwe'll do new-*.\n\n444\n00:23:04,080 --> 00:23:07,080\nI want to see all the stuff\nthat I can create new ones of.\n\n445\n00:23:07,080 --> 00:23:10,680\nYou'll see there's a lot, I can create\nnew services, new Windows events.\n\n446\n00:23:10,680 --> 00:23:14,930\nI can create new objects, new PS drives,\nnow all sorts of stuff in here.\n\n447\n00:23:14,930 --> 00:23:18,080\nAD user, these are all different\nthings that we can create.\n\n448\n00:23:18,080 --> 00:23:20,650\nAnd there's even some special\nfunctions that do things,\n\n449\n00:23:20,650 --> 00:23:23,070\nlike new volumes for creating disks.\n\n450\n00:23:23,070 --> 00:23:26,340\nReally powerful stuff in here,\nif you just know to find the command.\n\n451\n00:23:27,390 --> 00:23:30,360\nNow Microsoft has great documentation\non the TechNet website.\n\n452\n00:23:30,360 --> 00:23:33,380\nYou can go there and find lists of all\nthe commands that are available there.\n\n453\n00:23:33,380 --> 00:23:35,860\nVery searchable, very easy to work with.\n\n454\n00:23:35,860 --> 00:23:38,640\nBut if you're under the gun, you're on\na computer and you don't have internet\n\n455\n00:23:38,640 --> 00:23:41,580\naccess, it's nice to know that you\ncan at least search through and\n\n456\n00:23:41,580 --> 00:23:42,430\nfind your commands here.\n\n457\n00:23:43,890 --> 00:23:46,550\nAll right, well that's a pretty\ngood spot to wrap this segment up.\n\n458\n00:23:46,550 --> 00:23:47,930\nLet's take a look at what we've covered,\nright.\n\n459\n00:23:47,930 --> 00:23:49,685\nSo we started with basic commandlets.\n\n460\n00:23:49,685 --> 00:23:53,526\nAnd how they function, we had a change to\nsee some aliases that are already built in\n\n461\n00:23:53,526 --> 00:23:55,365\nplace, alternate commands.\n\n462\n00:23:55,365 --> 00:23:57,290\nWe even got a chance to\nlook at expressions,\n\n463\n00:23:57,290 --> 00:24:00,210\nmathematical operations we can\nperform from the command prompt.\n\n464\n00:24:00,210 --> 00:24:04,270\nAnd then we just wrapped up talking about\na few other things, like using get help\n\n465\n00:24:04,270 --> 00:24:07,846\nand get command to be able to find\nthe commands that are available, and\n\n466\n00:24:07,846 --> 00:24:10,168\nlocate what it is we need\nto use in the system.\n\n467\n00:24:10,168 --> 00:24:11,760\nAll right,\nhopefully you guys enjoyed that segment.\n\n468\n00:24:11,760 --> 00:24:14,960\nStay tuned,\nwe've got more PowerShell coming up.\n\n469\n00:24:14,960 --> 00:24:21,370\n[SOUND]\n\n",
          "vimeoId": "113437108"
        },
        {
          "description": "",
          "length": "507",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-2-command-history-120114.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-2-command-history-120114-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-2-command-history-120114-sm.jpg",
          "title": "Command History",
          "transcript": "1\n00:00:00,900 --> 00:00:07,889\n[MUSIC]\n\n2\n00:00:07,889 --> 00:00:12,450\nIn this segment we're gonna take a look\nat the command history in Powershell.\n\n3\n00:00:12,450 --> 00:00:17,225\nOne of the faster ways to enter commands\nthat we used previously is to, well,\n\n4\n00:00:17,225 --> 00:00:18,625\nuse our command history.\n\n5\n00:00:18,625 --> 00:00:21,960\nPowershell is actually keeping track\nof all of the commands that you've run\n\n6\n00:00:21,960 --> 00:00:24,710\nsince you logged in and\nstarted running it.\n\n7\n00:00:24,710 --> 00:00:26,340\nActually, even prior to log in.\n\n8\n00:00:26,340 --> 00:00:28,610\nIt actually keeps them\nsession by session so\n\n9\n00:00:28,610 --> 00:00:31,490\nit can go go back to previous times\nthat you've logged into your system.\n\n10\n00:00:31,490 --> 00:00:33,580\nI guess I shouldn't say every command,\n\n11\n00:00:33,580 --> 00:00:35,490\nit's really just keeping\ntrack of the last 64.\n\n12\n00:00:35,490 --> 00:00:40,230\nSo the last 64 commands that you've typed\nare being held in Powershell's cache.\n\n13\n00:00:40,230 --> 00:00:42,750\nAnd that means you can recall\nthem whenever you want.\n\n14\n00:00:42,750 --> 00:00:44,540\nIt's kind of a neat feature to have.\n\n15\n00:00:44,540 --> 00:00:45,850\nLet's take a look at that.\n\n16\n00:00:45,850 --> 00:00:49,600\nI've got a Powershell fired up right here,\nand I've cleared my screen, so\n\n17\n00:00:49,600 --> 00:00:51,480\nthere's not really anything on it.\n\n18\n00:00:51,480 --> 00:00:55,400\nBut, I've previously used this,\nright, I used it another segment.\n\n19\n00:00:55,400 --> 00:00:59,880\nSo, if I want to view my command history,\nthere's a few ways we can do it.\n\n20\n00:00:59,880 --> 00:01:02,790\nThe easiest way to bring a command\nup that you've run previously,\n\n21\n00:01:02,790 --> 00:01:06,370\nif it was run recently, is to use your\nup and down arrows on your keyboard.\n\n22\n00:01:06,370 --> 00:01:08,450\nIf I press the up arrow on my keyboard,\nit goes up,\n\n23\n00:01:08,450 --> 00:01:10,320\nand there you can see\nwhere I cleared my screen.\n\n24\n00:01:11,352 --> 00:01:14,410\nOr where I'd use the Linux or\nUnix LS command.\n\n25\n00:01:14,410 --> 00:01:16,450\nHere's the get dash command new.\n\n26\n00:01:16,450 --> 00:01:19,830\nThese are the commands I ran\nin a previous segment, right?\n\n27\n00:01:19,830 --> 00:01:22,620\nAnd I can press my up arrow\nto go back in time and\n\n28\n00:01:22,620 --> 00:01:25,020\nI can press my down arrow\nto go forward in time.\n\n29\n00:01:25,020 --> 00:01:27,980\nI can scroll through and\nfind the command that I want.\n\n30\n00:01:27,980 --> 00:01:30,050\nAnd then I can go in and I can modify it.\n\n31\n00:01:30,050 --> 00:01:34,820\nSo instead of get-command*-aduser,\n\n32\n00:01:34,820 --> 00:01:39,650\nmaybe I want to pull up one\nthat is *-eventlog, right?\n\n33\n00:01:39,650 --> 00:01:42,290\nSo I can modify the command as\nappropriate, and there we go.\n\n34\n00:01:42,290 --> 00:01:44,580\nSo pretty easy way to pull that back up.\n\n35\n00:01:44,580 --> 00:01:45,920\nNow, if the command you're looking for\n\n36\n00:01:45,920 --> 00:01:49,620\nwas just in the last few commands,\nthat works really well.\n\n37\n00:01:49,620 --> 00:01:51,500\nBut if you ran it 20 or 30 commands ago,\n\n38\n00:01:51,500 --> 00:01:54,110\nyou don't want to have to\nscroll all the way back.\n\n39\n00:01:54,110 --> 00:01:55,810\nSo there's a few other\nways that we can do that.\n\n40\n00:01:57,050 --> 00:01:59,770\nOne way, is that we can actually\nview our whole history.\n\n41\n00:01:59,770 --> 00:02:03,220\nWe can type get-history.\n\n42\n00:02:03,220 --> 00:02:06,030\nAnd that will pull up\nthe Powershell history.\n\n43\n00:02:06,030 --> 00:02:09,030\nAnd here I can go back and\nsee the previous commands.\n\n44\n00:02:09,030 --> 00:02:13,550\nAnd so, I can see it starts up here at\none with stop-service DNS Cache, that was\n\n45\n00:02:13,550 --> 00:02:19,423\nsomething I ran back early on, and then\nall the commands that I ran after that.\n\n46\n00:02:19,423 --> 00:02:22,705\nMoving forward including changing\ndirectories, running commands,\n\n47\n00:02:22,705 --> 00:02:24,075\nthere was a bad command there.\n\n48\n00:02:24,075 --> 00:02:26,525\nIt doesn't tell you if the command\nwas successful, or not right?\n\n49\n00:02:26,525 --> 00:02:28,475\nThis was actually a bad command here.\n\n50\n00:02:28,475 --> 00:02:33,985\nBut, it's got the commands, and you could\neasy copy and paste these if you want.\n\n51\n00:02:33,985 --> 00:02:36,260\nRight, you could just highlight\nthem with your mouse.\n\n52\n00:02:36,260 --> 00:02:38,400\nAnd press enter and that copies it.\n\n53\n00:02:38,400 --> 00:02:40,770\nAnd you can right click with the mouse and\nthat paste it again.\n\n54\n00:02:40,770 --> 00:02:43,035\nSo that's one way that we\ncan quickly do things there.\n\n55\n00:02:43,035 --> 00:02:47,278\nGet-history is nice cause it just\nkeeps track of all this stuff.\n\n56\n00:02:47,278 --> 00:02:53,140\nYou get a chance to see everything you've\nrun and it's constantly being updated.\n\n57\n00:02:53,140 --> 00:02:55,380\nSo as I take a look at my history.\n\n58\n00:02:55,380 --> 00:02:58,370\nI can see my history just grew from\nthe 33 it was a minute ago to 36 now.\n\n59\n00:02:58,370 --> 00:03:00,790\nAnd there's those commands.\n\n60\n00:03:00,790 --> 00:03:02,522\nThat I just typed that made it grow.\n\n61\n00:03:02,522 --> 00:03:03,590\nAll right.\n\n62\n00:03:03,590 --> 00:03:05,690\nSo, that's one way to do it.\n\n63\n00:03:05,690 --> 00:03:09,590\nOne thing I guess I should mention\nis I'm in Windows Server 2012 and\n\n64\n00:03:09,590 --> 00:03:12,770\nthe quick edit mode is enabled by default.\n\n65\n00:03:12,770 --> 00:03:15,280\nSo when I wanted to copy\nsomething I just highlighted\n\n66\n00:03:15,280 --> 00:03:16,830\nit by using the left mouse button.\n\n67\n00:03:16,830 --> 00:03:19,720\nI just clicked and\nhighlighted and pressed enter.\n\n68\n00:03:19,720 --> 00:03:23,660\nBut if you're in Windows Server 2008 or\n2003, in one\n\n69\n00:03:23,660 --> 00:03:26,550\nof the earlier versions of Powershell,\nthat's not turned on by default.\n\n70\n00:03:26,550 --> 00:03:29,150\nSo, you might need to turn quick edit on.\n\n71\n00:03:29,150 --> 00:03:33,250\nOr, if you don't want to turn quick edit\non, you can go up here to your menu, and\n\n72\n00:03:33,250 --> 00:03:36,040\nyou can choose edit and mark, and\n\n73\n00:03:36,040 --> 00:03:37,690\nthat's what will turn on\nthe ability to highlight.\n\n74\n00:03:37,690 --> 00:03:39,020\nAnd then you can press enter.\n\n75\n00:03:39,020 --> 00:03:42,008\nSo that may be a difference that\nyou see on your own system.\n\n76\n00:03:42,008 --> 00:03:45,620\nAll right, [COUGH] so\nhere we can see the history.\n\n77\n00:03:45,620 --> 00:03:49,120\nThat's great, it's the same thing I see\nwith my up and down arrows as we go\n\n78\n00:03:49,120 --> 00:03:52,540\nthrough and start to look at the commands\nthere, so not much difference.\n\n79\n00:03:52,540 --> 00:03:53,630\nJust we get to see them all.\n\n80\n00:03:54,930 --> 00:03:55,570\nAll right.\n\n81\n00:03:55,570 --> 00:03:58,720\nAnother thing that we can do, is there's\na couple of neat little keyboard shortcuts\n\n82\n00:03:58,720 --> 00:04:00,660\nthat deal with your function keys.\n\n83\n00:04:00,660 --> 00:04:05,970\nIf you hit F7 on your keyboard, so\nthat's F as in Frank and seven, right?\n\n84\n00:04:05,970 --> 00:04:10,070\nYour function key number seven, when\nyou hit that, you get a little pop up.\n\n85\n00:04:10,070 --> 00:04:12,300\nThen the pop up will\nshow the commands too.\n\n86\n00:04:12,300 --> 00:04:14,093\nAll right.\nAnd you'll see where I can go and\n\n87\n00:04:14,093 --> 00:04:17,420\nscroll back and there's each of\nthe commands that are in my history.\n\n88\n00:04:17,420 --> 00:04:21,500\nThe nice thing here is I can go through\nand find the command I wanna run, and\n\n89\n00:04:21,500 --> 00:04:23,140\nI can press enter and it runs it.\n\n90\n00:04:23,140 --> 00:04:26,000\nSo you can just scroll through and\nfind the command you want.\n\n91\n00:04:26,000 --> 00:04:30,020\nAnother thing you'll notice is that\nmost of those commands had a number\n\n92\n00:04:30,020 --> 00:04:31,580\nattached to them, right?\n\n93\n00:04:31,580 --> 00:04:35,120\nSo when I hit F7, see how there's\nthat number beside each one.\n\n94\n00:04:35,120 --> 00:04:39,630\nOr if I do get-history, right.\n\n95\n00:04:39,630 --> 00:04:41,930\nHere we can see that number beside them.\n\n96\n00:04:41,930 --> 00:04:44,910\nIf you know the number of\nthe command that you want to run,\n\n97\n00:04:44,910 --> 00:04:50,780\nyou can just hit F9 on the keyboard,\nand you can pick the command.\n\n98\n00:04:50,780 --> 00:04:53,260\nSo if I want to run get history,\nor let's do a different one.\n\n99\n00:04:53,260 --> 00:04:55,390\nLet's do get command and\nthat log, that's command 33.\n\n100\n00:04:55,390 --> 00:04:59,890\nI can just type in 33, and,\nit picks the wrong one.\n\n101\n00:04:59,890 --> 00:05:04,010\nSo you know, my history has changed,\napparently, so let's try that again.\n\n102\n00:05:04,010 --> 00:05:06,030\nWe get history.\n\n103\n00:05:06,030 --> 00:05:12,480\nAnd I want to run, wait,\nI confused myself.\n\n104\n00:05:12,480 --> 00:05:14,770\nSo I'll do get child item, which is 36.\n\n105\n00:05:14,770 --> 00:05:22,030\nSo if I want to do 36, i just F9 and\ntype in 36, and, I typed the wrong one.\n\n106\n00:05:22,030 --> 00:05:23,650\nThat's pretty spectacular.\n\n107\n00:05:23,650 --> 00:05:28,230\nSo, the problem here is when I run get\nhistory, that's a command that I ran.\n\n108\n00:05:28,230 --> 00:05:29,310\nAnd so it's modifying the numbers.\n\n109\n00:05:29,310 --> 00:05:33,750\nSo I actually need to increase it by one\nor actually, here was can change this up.\n\n110\n00:05:33,750 --> 00:05:36,670\nI'll just use F7 so\nI'm not actually changing mine.\n\n111\n00:05:36,670 --> 00:05:37,250\nAnd I'll look here.\n\n112\n00:05:37,250 --> 00:05:39,360\nSo I haven't actually run a command yet.\n\n113\n00:05:39,360 --> 00:05:41,520\nAnd now if I want to run\nget child item is 38.\n\n114\n00:05:42,970 --> 00:05:46,383\nSo, but it's gonna make me, there we go.\n\n115\n00:05:46,383 --> 00:05:49,710\nSooner or later I will get this to run.\n\n116\n00:05:49,710 --> 00:05:50,307\nThere we go.\n\n117\n00:05:50,307 --> 00:05:51,800\nGet child item and we can run it, right.\n\n118\n00:05:52,830 --> 00:05:55,770\nThe numbers are pretty challenging\nbecause they are constantly changing, so\n\n119\n00:05:55,770 --> 00:05:59,590\nthat's kind of a rough one for\nus but it's there.\n\n120\n00:05:59,590 --> 00:06:01,920\nYou're able to see that history,\nand it's able to function.\n\n121\n00:06:01,920 --> 00:06:04,110\nThe default is 64 commands.\n\n122\n00:06:04,110 --> 00:06:07,690\nIf you want it to record more,\nwell that's something you need to modify.\n\n123\n00:06:07,690 --> 00:06:10,810\nWe'll do a segment on\ncustomizing the Powershell, but\n\n124\n00:06:10,810 --> 00:06:12,410\nI want to stick with the defaults for\nright now.\n\n125\n00:06:12,410 --> 00:06:13,350\nSo the default is 64,\n\n126\n00:06:13,350 --> 00:06:18,450\nwhen we get to the 65th one, it'll\noverwrite the oldest one, the first one.\n\n127\n00:06:18,450 --> 00:06:21,170\nThat one will go away and get replaced,\nand so that's why those numbers\n\n128\n00:06:21,170 --> 00:06:24,490\nare constantly changing as it shifts\nthrough adding these new commands.\n\n129\n00:06:25,910 --> 00:06:28,320\nAll right, so those are some of\nthe different shortcuts we've got.\n\n130\n00:06:28,320 --> 00:06:29,918\nI feel like I'm missing one.\n\n131\n00:06:29,918 --> 00:06:32,377\nOh, searching.\n\n132\n00:06:32,377 --> 00:06:35,180\nSo you might know that you've\ntyped a command before.\n\n133\n00:06:35,180 --> 00:06:37,110\nAnd you wanna pull it back up again, and\n\n134\n00:06:37,110 --> 00:06:39,690\nyou just don't wanna\ntype the whole thing in.\n\n135\n00:06:39,690 --> 00:06:43,040\nWell, what you can do is you can type\nthe first few characters, right.\n\n136\n00:06:43,040 --> 00:06:48,450\nSo I can just come in here and\nstart to type whatever that command was.\n\n137\n00:06:48,450 --> 00:06:53,100\nAnd then if you hit F8 on your keyboard,\nif I hit the F8 key.\n\n138\n00:06:53,100 --> 00:06:57,220\nIt does a search through my history and\nit looks for commands that had that.\n\n139\n00:06:57,220 --> 00:07:00,000\nNow that is not too\nterribly spectacular right?\n\n140\n00:07:00,000 --> 00:07:03,980\nWe have tab autocomplete that will run.\n\n141\n00:07:03,980 --> 00:07:08,190\nBy hitting the tab key, but it's actually\nlooking at the command that we ran.\n\n142\n00:07:08,190 --> 00:07:10,700\nSo if we look for a command that I ran.\n\n143\n00:07:10,700 --> 00:07:12,933\nThis may be longer,\nlike this guy right here, right.\n\n144\n00:07:12,933 --> 00:07:14,530\nThis is a really long one.\n\n145\n00:07:14,530 --> 00:07:20,300\nThat's where it really saves us time and\nthat one wasn't really, truly functional.\n\n146\n00:07:20,300 --> 00:07:22,020\nIf we take something\nlike stop service here.\n\n147\n00:07:22,020 --> 00:07:25,390\nThis one, where it's more\nthan just a command, right.\n\n148\n00:07:25,390 --> 00:07:28,070\nSo stop service, I typed stop.\n\n149\n00:07:28,070 --> 00:07:30,240\nI could actually probably\njust stop right there and\n\n150\n00:07:30,240 --> 00:07:34,000\nhit F8 and\nsee how it does stop.service DNS cache.\n\n151\n00:07:34,000 --> 00:07:35,600\nIt's the command that I typed.\n\n152\n00:07:35,600 --> 00:07:39,620\nSo, F7 shows you your history.\n\n153\n00:07:39,620 --> 00:07:42,680\nF8 lets you search your history and\n\n154\n00:07:42,680 --> 00:07:46,820\nF9 lets you run a command from\nyour history based on it's number.\n\n155\n00:07:46,820 --> 00:07:48,683\nSo, F7, F8, and F9.\n\n156\n00:07:48,683 --> 00:07:50,817\nSome neat little keyboard shortcuts\nthat are available there.\n\n157\n00:07:51,830 --> 00:07:54,125\nThe other thing we talked about just\nback at the beginning of the segment was\n\n158\n00:07:54,125 --> 00:07:56,720\nget-history, which I\nused several times there.\n\n159\n00:07:56,720 --> 00:08:00,320\nBetween those commands,\nthat's pretty much the command history.\n\n160\n00:08:00,320 --> 00:08:02,750\nYou'll see there's a few programming\nshortcuts that are available too.\n\n161\n00:08:02,750 --> 00:08:04,590\nWe might see those in some\nof the other segments but\n\n162\n00:08:04,590 --> 00:08:06,370\nthey are not as commonly used.\n\n163\n00:08:06,370 --> 00:08:08,120\nThings like dollar sign dollar sign and\n\n164\n00:08:08,120 --> 00:08:11,120\na few other little shortcuts there\nthat can reference previous commands.\n\n165\n00:08:11,120 --> 00:08:14,550\nBut as far as the history goes,\nthese are the primary commands right here.\n\n166\n00:08:14,550 --> 00:08:17,360\nAll right,\nwell I hope you guys enjoyed that segment.\n\n167\n00:08:17,360 --> 00:08:21,265\nStay tuned we've got more\nPowershell coming up.\n\n168\n00:08:21,265 --> 00:08:27,149\n[SOUND]\n\n",
          "vimeoId": "113437109"
        },
        {
          "description": "",
          "length": "508",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-3-aliases-120114.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-3-aliases-120114-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-3-aliases-120114-sm.jpg",
          "title": "Aliases",
          "transcript": "1\n00:00:00,226 --> 00:00:05,660\n[MUSIC]\n\n2\n00:00:07,982 --> 00:00:11,360\nIn this segment, we're going to take\na look at aliases in PowerShell.\n\n3\n00:00:11,360 --> 00:00:14,575\nNow, when Microsoft created\nthe PowerShell, it was a new command line\n\n4\n00:00:14,575 --> 00:00:17,908\ninterface and so there's a bit of\na learning curve to get used to using it.\n\n5\n00:00:17,908 --> 00:00:18,651\nYou guys know.\n\n6\n00:00:18,651 --> 00:00:20,817\nYou're watching this show for\nthat very reason.\n\n7\n00:00:20,817 --> 00:00:22,843\nBut they wanted to make\nit as easy as possible.\n\n8\n00:00:22,843 --> 00:00:26,647\nAnd so they took a lot of commands that\nwe were used to back in the regular\n\n9\n00:00:26,647 --> 00:00:29,356\ncommand prompt, be it Windows or\neven Linux, and\n\n10\n00:00:29,356 --> 00:00:32,550\nthey added them as aliases\ninside of PowerShell.\n\n11\n00:00:32,550 --> 00:00:36,120\nThere are many aliases that\nare already created for us and\n\n12\n00:00:36,120 --> 00:00:38,540\nwe probably used without even\nthinking about it, right?\n\n13\n00:00:38,540 --> 00:00:39,960\nLet's take a look at some of those and\n\n14\n00:00:39,960 --> 00:00:43,362\nthen we'll get a chance to see how to\ncreate our own aliases after that.\n\n15\n00:00:43,362 --> 00:00:46,240\nAll right, so how do I know what\naliases are already in the system?\n\n16\n00:00:46,240 --> 00:00:48,321\nWell you can run Get-Alias and\n\n17\n00:00:48,321 --> 00:00:52,330\nthat will give you a list of\nthe ones that have been created.\n\n18\n00:00:52,330 --> 00:00:55,420\nNow there's default ones that\ncome with Windows PowerShell and\n\n19\n00:00:55,420 --> 00:00:59,377\nif you've installed any add-ons they\nmight have brought their own aliases too.\n\n20\n00:00:59,377 --> 00:01:00,705\nSo you may see more than I do, or\n\n21\n00:01:00,705 --> 00:01:04,060\nyou may see less than I do based\non the add-ons that you've got.\n\n22\n00:01:04,060 --> 00:01:08,270\nBut you'll see a ton of commands in here,\nmany of which come from the Windows world,\n\n23\n00:01:08,270 --> 00:01:11,530\nsome of which come from the Linux world or\nUNIX world.\n\n24\n00:01:11,530 --> 00:01:14,530\nSo there's some commands we run\non a regular basis like dir,\n\n25\n00:01:14,530 --> 00:01:16,150\nthe old directory command.\n\n26\n00:01:16,150 --> 00:01:17,940\nThat's from the DOS days.\n\n27\n00:01:17,940 --> 00:01:22,715\nWell you can still run it, but\nit just maps to Get-ChildItem, right?\n\n28\n00:01:22,715 --> 00:01:27,416\nOr copy, the old copy command,\nwell, that goes to Copy-Item.\n\n29\n00:01:27,416 --> 00:01:32,406\nIt's pairing up a name with the verb\nnoun commandlet that we're used to in\n\n30\n00:01:32,406 --> 00:01:33,380\nPowerShell.\n\n31\n00:01:33,380 --> 00:01:33,961\nAll right.\n\n32\n00:01:33,961 --> 00:01:35,883\nSo just to make life easy.\n\n33\n00:01:35,883 --> 00:01:38,785\nThe other reason they do it is for\nbackwards compatibility.\n\n34\n00:01:38,785 --> 00:01:42,910\nYou might have batch files that have\nbeen written to run at a regular command\n\n35\n00:01:42,910 --> 00:01:43,441\nprompt.\n\n36\n00:01:43,441 --> 00:01:46,575\nAnd Microsoft wanted to make sure\nthat those batch files would run even\n\n37\n00:01:46,575 --> 00:01:47,487\nunder PowerShell.\n\n38\n00:01:47,487 --> 00:01:51,203\nBy putting these aliases in there,\nthat fixes it right?\n\n39\n00:01:51,203 --> 00:01:54,765\nBut you may encounter some aliases that\nare missing that you would expect to have,\n\n40\n00:01:54,765 --> 00:01:57,878\nand I know that there's one in particular\nthat I bump into all the time.\n\n41\n00:01:57,878 --> 00:01:59,411\nI'll show you here in a moment.\n\n42\n00:01:59,411 --> 00:02:00,960\nAnd it gets frustrating.\n\n43\n00:02:00,960 --> 00:02:05,180\nSo Microsoft makes it where you\ncan create your own aliases and\n\n44\n00:02:05,180 --> 00:02:07,220\nthat's really nice cuz you\ncan start to make up for\n\n45\n00:02:07,220 --> 00:02:09,480\nsome of these commands that\nyou don't have anymore.\n\n46\n00:02:09,480 --> 00:02:13,964\nOr you can just make things easier on\nyourself by having a proper alias in\n\n47\n00:02:13,964 --> 00:02:14,495\nplace.\n\n48\n00:02:14,495 --> 00:02:16,414\nSo we'll get a chance to\nsee that as we go through.\n\n49\n00:02:16,414 --> 00:02:19,220\nBut these are the default\nones that are in place.\n\n50\n00:02:19,220 --> 00:02:23,070\nIf you're using a command and you just\nwanna know about the alias it's doing, so\n\n51\n00:02:23,070 --> 00:02:24,670\nfor example, copy.\n\n52\n00:02:24,670 --> 00:02:26,230\nIf I use the copy command and\n\n53\n00:02:26,230 --> 00:02:30,410\nI know it's an alias,\nwhat's the actual commandlet for it?\n\n54\n00:02:30,410 --> 00:02:34,610\nYou can always run Get-Alias\nfollowed by the specific command, so\n\n55\n00:02:34,610 --> 00:02:36,750\nI'll say like Get-Alias copy.\n\n56\n00:02:36,750 --> 00:02:39,360\nAnd when I run that,\nit'll just show me that one, so\n\n57\n00:02:39,360 --> 00:02:43,260\neasy to kinda narrow it down and find\nthe alias that I wanna see, all right?\n\n58\n00:02:43,260 --> 00:02:46,925\nAnd there are aliases for\na lot of other systems, like with Linux.\n\n59\n00:02:46,925 --> 00:02:51,439\nI know Fabian in the chat room was\nmentioning it, how we have ls and pwd and\n\n60\n00:02:51,439 --> 00:02:55,070\ncommands like that,\nthat we're used to from other OSes.\n\n61\n00:02:55,070 --> 00:02:58,593\nAnd it's just designed to make it\na smaller learning curve when we move\n\n62\n00:02:58,593 --> 00:02:59,760\ninto the PowerShell.\n\n63\n00:02:59,760 --> 00:03:02,580\nAll right, now, the aliases that\nare there, those are exciting.\n\n64\n00:03:02,580 --> 00:03:05,521\nNot terribly exciting, but they're there.\n\n65\n00:03:05,521 --> 00:03:07,019\nWe might want to make our own.\n\n66\n00:03:07,019 --> 00:03:08,910\nNow why would I want to make my own?\n\n67\n00:03:08,910 --> 00:03:11,870\nWell, maybe there's some command\nnot listed here that I want.\n\n68\n00:03:11,870 --> 00:03:14,940\nThe one that I always do is edit, right?\n\n69\n00:03:14,940 --> 00:03:19,230\nWhen I got started in computers,\nI was using DOS 3.3 and the edit command,\n\n70\n00:03:19,230 --> 00:03:20,489\nit was built right in.\n\n71\n00:03:20,489 --> 00:03:26,565\nYou had this text-based light ANSI\ngraphics text editor that I used for\n\n72\n00:03:26,565 --> 00:03:29,830\nyears and years and years.\n\n73\n00:03:29,830 --> 00:03:32,080\nAnd then one day,\nMicrosoft said you know what?\n\n74\n00:03:32,080 --> 00:03:33,350\nWe're not gonna support that anymore.\n\n75\n00:03:33,350 --> 00:03:35,310\nWe're gonna get rid of edit and\nso it's gone.\n\n76\n00:03:35,310 --> 00:03:38,122\nWell, to this day,\nwhen I go to edit a file,\n\n77\n00:03:38,122 --> 00:03:41,097\nI will often type edit\nfollowed by a file name.\n\n78\n00:03:41,097 --> 00:03:46,190\nSo if I go into a directory\nlike my user account and\n\n79\n00:03:46,190 --> 00:03:52,789\nI want to edit a file here called\ntest.txt, I might type edit.\n\n80\n00:03:52,789 --> 00:03:53,930\nIt doesn't have that command.\n\n81\n00:03:53,930 --> 00:03:56,560\nEven if I went to the command\nprompt it's not there either.\n\n82\n00:03:56,560 --> 00:03:58,830\nSo I might want to create an alias for\nthat.\n\n83\n00:03:58,830 --> 00:04:00,825\nAnd aliases are really easy to create.\n\n84\n00:04:00,825 --> 00:04:05,922\nYou basically just say Set-Alias, and then\nthe word you want to use is the alias.\n\n85\n00:04:05,922 --> 00:04:07,310\nI'm gonna create one called edit.\n\n86\n00:04:08,770 --> 00:04:14,040\nNow an alias is mapping\na name to a command.\n\n87\n00:04:14,040 --> 00:04:16,910\nAnd what would normally\nfollow here is a commandlet.\n\n88\n00:04:18,110 --> 00:04:21,610\nBut there is no commandlet that\nprovides me an editor either.\n\n89\n00:04:21,610 --> 00:04:24,830\nSo the other we can do with\nan alias is point it to a binary.\n\n90\n00:04:24,830 --> 00:04:25,740\nAnd that's what I'm gonna do.\n\n91\n00:04:25,740 --> 00:04:30,149\nI'm gonna create an alias that's\ngonna tie this to Notepad.\n\n92\n00:04:30,149 --> 00:04:34,750\nSo I'm gonna go in here and\nspecify that my alias for\n\n93\n00:04:34,750 --> 00:04:40,321\nedit points to\nC:\\Windows\\System32\\notepad.exe.\n\n94\n00:04:40,321 --> 00:04:43,651\nNow when I type that old edit command\nthat I'm just used to typing,\n\n95\n00:04:43,651 --> 00:04:47,694\nit'll launch Notepad, and fire that up so\nthat I can edit that file, all right,\n\n96\n00:04:47,694 --> 00:04:49,540\npretty simple there.\n\n97\n00:04:49,540 --> 00:04:55,420\nThe way the alias works is any time\nI type the word edit, anything after\n\n98\n00:04:55,420 --> 00:05:01,568\nthe word edit will be passed as a\nparameter to this command, to notepad.exe.\n\n99\n00:05:01,568 --> 00:05:02,440\nAll right.\n\n100\n00:05:02,440 --> 00:05:07,049\nOne limitation of an alias is\nyou can't do other parameters.\n\n101\n00:05:07,049 --> 00:05:11,240\nI can't add parameters\nhere to the alias itself.\n\n102\n00:05:11,240 --> 00:05:15,130\nSo if I wanted to run notepad.exe/q or\nsomething like that, you can't do it,\n\n103\n00:05:15,130 --> 00:05:17,030\nall right?\n\n104\n00:05:17,030 --> 00:05:21,881\nFor that, we'll have to use functions and\nwe'll see that in the next segment, but\n\n105\n00:05:21,881 --> 00:05:25,276\nas far as this is concerned,\nthis is gonna work perfect for\n\n106\n00:05:25,276 --> 00:05:27,937\nme because now when I type edit, test.txt.\n\n107\n00:05:27,937 --> 00:05:33,256\nIt'll take that test.txt and\nfeed that as a parameter to notepad.exe,\n\n108\n00:05:33,256 --> 00:05:36,189\nand so when I run it, there's Notepad.\n\n109\n00:05:36,189 --> 00:05:39,430\nIt's telling me text.txt doesn't exist,\ndo I want to create a new one?\n\n110\n00:05:39,430 --> 00:05:40,560\nSure.\n\n111\n00:05:40,560 --> 00:05:45,253\nI'll say this is my file, and\nI'll go ahead and save that.\n\n112\n00:05:45,253 --> 00:05:50,319\nSo now I've got that file, and the next\ntime I do edit test.txt, there it is.\n\n113\n00:05:50,319 --> 00:05:54,595\nSo now I've got that command available and\nI'm able to use it.\n\n114\n00:05:54,595 --> 00:05:58,877\nOne little word of caution here,\nthe aliases are actually tied to your\n\n115\n00:05:58,877 --> 00:06:03,684\ncurrent session so when you close out and\ngo back in, your aliases may be gone.\n\n116\n00:06:03,684 --> 00:06:07,716\nJump ahead, we'll have a video on\nmodifying your profile in PowerShell and\n\n117\n00:06:07,716 --> 00:06:11,822\nyou can set these aliases to be recreated\nevery time you launch a PowerShell.\n\n118\n00:06:11,822 --> 00:06:13,680\nThat way they're always there for you.\n\n119\n00:06:13,680 --> 00:06:15,870\nIf it's a temporary thing,\nthen it's great.\n\n120\n00:06:15,870 --> 00:06:18,720\nIt's like this, you close out of\nPowerShell and they'll go away.\n\n121\n00:06:18,720 --> 00:06:21,784\nBut if you want it to be around long term,\nyou'll wanna go ahead and\n\n122\n00:06:21,784 --> 00:06:23,000\nadd that to your profile.\n\n123\n00:06:23,000 --> 00:06:23,824\nAll right.\n\n124\n00:06:23,824 --> 00:06:26,196\nIf we wanna get rid of an alias,\n\n125\n00:06:26,196 --> 00:06:31,760\nyou can use the Remove-Alias command,\nand I can remove edit.\n\n126\n00:06:31,760 --> 00:06:33,030\nOh shoot, sorry.\n\n127\n00:06:33,030 --> 00:06:35,180\nThis one's a little bit weird.\n\n128\n00:06:35,180 --> 00:06:37,397\nWe actually have to do Remove-Item.\n\n129\n00:06:37,397 --> 00:06:40,705\nAnd then alias:edit.\n\n130\n00:06:40,705 --> 00:06:43,070\nRemove-Item is like a generic\nremoval command and so\n\n131\n00:06:43,070 --> 00:06:46,060\nthey don't actually have a remove just for\naliases.\n\n132\n00:06:46,060 --> 00:06:48,150\nBecause they know if you close\nPowerShell they go away.\n\n133\n00:06:48,150 --> 00:06:49,880\nSo why do you need a remove?\n\n134\n00:06:49,880 --> 00:06:51,846\nSo if we want to force it we\nhave to use Remove-Item but\n\n135\n00:06:51,846 --> 00:06:53,347\nit doesn't know what kind of item it is.\n\n136\n00:06:53,347 --> 00:06:58,390\nSo we have to say alias: and the name\nof the alias and that will remove it.\n\n137\n00:06:58,390 --> 00:07:02,100\nNow depending on your system it\nmight not actually get removed.\n\n138\n00:07:02,100 --> 00:07:04,740\nThat does happen where it stays resident.\n\n139\n00:07:04,740 --> 00:07:07,210\nAnd I'll bet mine has done\nthat because I'm on a server.\n\n140\n00:07:07,210 --> 00:07:09,030\nAnd so if I run edit.\n\n141\n00:07:09,030 --> 00:07:10,620\nIt did actually remove it.\n\n142\n00:07:10,620 --> 00:07:15,280\nI have seen sometimes where the alias will\nstay even after you've done a Remove-Item\n\n143\n00:07:15,280 --> 00:07:17,650\nand that's because of the way\nthe PowerShell does the caching.\n\n144\n00:07:17,650 --> 00:07:20,890\nIn that case you can just close\nPowerShell and reopen it again and\n\n145\n00:07:20,890 --> 00:07:22,322\nthat will take care of it.\n\n146\n00:07:22,322 --> 00:07:24,590\nBut that's how we can\ncreate that alias and\n\n147\n00:07:24,590 --> 00:07:26,260\nremove it if we need it gone, right now.\n\n148\n00:07:27,810 --> 00:07:33,100\nAll right, now with our aliases they're\npretty easy, pretty simple to create.\n\n149\n00:07:33,100 --> 00:07:36,183\nRemember we did Set-Dash alias,\nfollowed by a name and\n\n150\n00:07:36,183 --> 00:07:39,835\nthen whatever command it was\nthat we wanted, all right.\n\n151\n00:07:39,835 --> 00:07:44,115\nThat command could be a commandlet or it\ncan be an actual binary, an executable, or\n\n152\n00:07:44,115 --> 00:07:45,245\neven a script for that matter.\n\n153\n00:07:45,245 --> 00:07:46,745\nYou can do an alias for\nall sorts of things.\n\n154\n00:07:48,145 --> 00:07:52,890\nIf we wanna remove it, we have to use\nRemove-Item followed by the alias: and\n\n155\n00:07:52,890 --> 00:07:54,840\nwhatever the actual alias name is,\n\n156\n00:07:54,840 --> 00:07:57,360\nso pretty straightforward\nprocess right there.\n\n157\n00:07:57,360 --> 00:07:59,220\nAnd when you create your own aliases,\n\n158\n00:07:59,220 --> 00:08:02,010\nlike if I go back here and\ncreate that alias again.\n\n159\n00:08:02,010 --> 00:08:05,430\nWhen you run Get-Alias, you'll see\nit in there, it'll be in the list.\n\n160\n00:08:05,430 --> 00:08:09,130\nYou know, these are just alphabetized,\nso I can just go in, find my alias and\n\n161\n00:08:09,130 --> 00:08:10,630\nit will be listed right there.\n\n162\n00:08:11,780 --> 00:08:14,730\nSo that's a basic overview of aliases.\n\n163\n00:08:14,730 --> 00:08:17,580\nFor a more powerful option,\ntake a look at functions.\n\n164\n00:08:17,580 --> 00:08:20,293\nAnd that's what we're going to be covering\nin the next segment, so stay tuned.\n\n165\n00:08:20,293 --> 00:08:22,313\nThere is more PowerShell after this.\n\n166\n00:08:22,313 --> 00:08:27,653\n[MUSIC]\n\n",
          "vimeoId": "113437110"
        },
        {
          "description": "",
          "length": "486",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-4-functions-120114.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-4-functions-120114-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-4-functions-120114-sm.jpg",
          "title": "Function",
          "transcript": "1\n00:00:00,000 --> 00:00:08,208\n[MUSIC]\n\n2\n00:00:08,208 --> 00:00:12,450\nIn this segment, we're gonna take a look\nat functions in Windows PowerShell.\n\n3\n00:00:12,450 --> 00:00:14,686\nIf you watched our segment on aliases,\n\n4\n00:00:14,686 --> 00:00:18,625\nwe covered how to create a name that\nrepresented some other command.\n\n5\n00:00:18,625 --> 00:00:23,205\nAnd I mentioned in there that one of\nthe limitations of an alias is that you\n\n6\n00:00:23,205 --> 00:00:27,875\ncan't preload as part of the alias\ncommand line modifiers for a command.\n\n7\n00:00:27,875 --> 00:00:29,330\nLet me show you what I mean.\n\n8\n00:00:29,330 --> 00:00:32,130\nThe alias that I created in\nthat shell was the edit alias.\n\n9\n00:00:32,130 --> 00:00:36,560\nI tied the name edit to notepad.exe.\n\n10\n00:00:36,560 --> 00:00:42,030\nWell, what if I wanted to have an alias\nthat automatically edited a specific\n\n11\n00:00:42,030 --> 00:00:43,280\nfile, all right?\n\n12\n00:00:43,280 --> 00:00:47,750\nA great example, and this is one that I\nuse myself, is the hosts file in Windows.\n\n13\n00:00:47,750 --> 00:00:52,160\nThe host file is what overrides our DNS\nlookups so you can map IPs to names, and\n\n14\n00:00:52,160 --> 00:00:54,500\nI find I end up editing\nthat more than I should.\n\n15\n00:00:54,500 --> 00:00:57,890\nBut if I wanted to create a single command\nthat I could run that would allow me\n\n16\n00:00:57,890 --> 00:00:59,330\nto edit the host file,\n\n17\n00:00:59,330 --> 00:01:04,440\nwell I would need to be passing\nthe file name along with notepad.exe.\n\n18\n00:01:04,440 --> 00:01:07,390\nAll right so\nI'd need to change the way this works.\n\n19\n00:01:07,390 --> 00:01:11,494\nWhen we did the alias\nit was set-alias edit.\n\n20\n00:01:11,494 --> 00:01:15,270\nAnd then I specified\nthe path to notepad right.\n\n21\n00:01:15,270 --> 00:01:21,090\nSo this is the command that I\nran there to create the alias.\n\n22\n00:01:21,090 --> 00:01:23,790\nJust mapping the name to a command.\n\n23\n00:01:23,790 --> 00:01:29,260\nAnd when I use that alias, you would type\nedit, and then whatever you wanted, right.\n\n24\n00:01:29,260 --> 00:01:31,940\nYou might have modifiers.\n\n25\n00:01:31,940 --> 00:01:34,850\nYou might have a filename, whatever it is.\n\n26\n00:01:36,050 --> 00:01:37,880\nYou punch in that information.\n\n27\n00:01:37,880 --> 00:01:41,605\nAnything you type after edit\nwill get passed to Notepad so\n\n28\n00:01:41,605 --> 00:01:46,690\nthis would actually run as Notepad\n/q /a hosts.txt, all right.\n\n29\n00:01:46,690 --> 00:01:49,680\nBut what if I wanted to\nautomatically have this stuff in it?\n\n30\n00:01:50,720 --> 00:01:52,570\nWell, it won't let you do that.\n\n31\n00:01:52,570 --> 00:01:57,280\nSo if I do, like,\nset-alias edit-hosts, right.\n\n32\n00:01:57,280 --> 00:02:01,375\nI wanna create an alias called edit-hosts,\nthat'll edit that host file, all right.\n\n33\n00:02:01,375 --> 00:02:06,042\nAnd I try and map that to C:\\windows.\n\n34\n00:02:06,042 --> 00:02:08,834\nWhoops, if I type it\nright it'll work better.\n\n35\n00:02:08,834 --> 00:02:10,792\n[LAUGH] It is not my day for typing.\n\n36\n00:02:10,792 --> 00:02:15,232\nSystem32\\notepad.exe and\n\n37\n00:02:15,232 --> 00:02:20,167\nthen the file that I wanted to edit.\n\n38\n00:02:20,167 --> 00:02:25,166\nWhich this one is buried away in here so\nit is right there.\n\n39\n00:02:25,166 --> 00:02:29,820\nOkay, so\nI'm mapping the name edit-hosts, and\n\n40\n00:02:29,820 --> 00:02:34,930\nI'm trying to map it to this program,\nwith this command line modifier,\n\n41\n00:02:34,930 --> 00:02:38,440\nafter it telling it which file\nI want to edit, all right.\n\n42\n00:02:38,440 --> 00:02:40,240\nWell, aliases don't like that.\n\n43\n00:02:40,240 --> 00:02:43,490\nWhen I run that it's gonna get upset,\nokay.\n\n44\n00:02:43,490 --> 00:02:47,320\nAnd it's not just the space that\ncauses the problem, if I go in and\n\n45\n00:02:47,320 --> 00:02:49,130\nput quotes around it to\ntake care of the space,\n\n46\n00:02:49,130 --> 00:02:52,420\nit's not gonna be too much\nhappier in that scenario either.\n\n47\n00:02:53,800 --> 00:02:57,780\nIt ran, and\nif I do a get-alias and I go and\n\n48\n00:02:57,780 --> 00:03:03,320\nfind that edit-hosts,\nlook at what my alias is.\n\n49\n00:03:03,320 --> 00:03:04,740\nIt's nothing, all right.\n\n50\n00:03:04,740 --> 00:03:07,960\nIt didn't give me an error, but\nit didn't work either, right.\n\n51\n00:03:07,960 --> 00:03:10,910\nSo that's not gonna help me very much.\n\n52\n00:03:10,910 --> 00:03:13,440\nSo, if I wanna do an advanced alias,\n\n53\n00:03:13,440 --> 00:03:17,380\nsomething that does more than just\nprovides a command to map to.\n\n54\n00:03:17,380 --> 00:03:19,070\nWe need to use a function.\n\n55\n00:03:19,070 --> 00:03:23,570\nFunctions allow you to attach all\nsorts of stuff to a name, and\n\n56\n00:03:23,570 --> 00:03:26,420\nthe function really becomes\nits own unique command.\n\n57\n00:03:26,420 --> 00:03:27,930\nIt's very cool stuff.\n\n58\n00:03:27,930 --> 00:03:29,790\nSo that's what I'm gonna do.\n\n59\n00:03:29,790 --> 00:03:32,470\nI just need to get rid of\nthat one that we just made.\n\n60\n00:03:32,470 --> 00:03:34,130\nWe'll remove that.\n\n61\n00:03:34,130 --> 00:03:37,050\nIn fact, there's already a lot\nof functions that are present\n\n62\n00:03:37,050 --> 00:03:38,430\ninside of the system.\n\n63\n00:03:38,430 --> 00:03:42,960\nWhen you do get-command, and you pull\nup that list of all the commands in\n\n64\n00:03:42,960 --> 00:03:48,440\nPowershell, notice how I just had a bunch\nof screens go by that were functions,\n\n65\n00:03:48,440 --> 00:03:49,700\nand now I've got a bunch\nthat are commandlets.\n\n66\n00:03:49,700 --> 00:03:53,140\nSo here I'm looking at the commandlets and\nif I scroll back up,\n\n67\n00:03:53,140 --> 00:03:57,800\nthere's a lot of commands up here that\naren't commandlets at all, here but\n\n68\n00:03:57,800 --> 00:03:59,010\nthey're functions, all right.\n\n69\n00:03:59,010 --> 00:04:00,930\nSo what is a function?\n\n70\n00:04:00,930 --> 00:04:03,980\nWell it's something that\ndoes more than one thing.\n\n71\n00:04:03,980 --> 00:04:06,230\nAnd that's what I wanna do,\nI wanna run Notepad.\n\n72\n00:04:06,230 --> 00:04:08,870\nBut I don't just wanna run it by itself,\nI wanna pass some values to it,\n\n73\n00:04:08,870 --> 00:04:10,160\nsome other things.\n\n74\n00:04:10,160 --> 00:04:11,630\nI might have conditions.\n\n75\n00:04:11,630 --> 00:04:15,920\nWhen you run this command, check and\nsee if I have a network connection.\n\n76\n00:04:15,920 --> 00:04:16,910\nAnd if I do, do this.\n\n77\n00:04:16,910 --> 00:04:20,400\nIf I don't have a network connection,\nthen do this other thing.\n\n78\n00:04:20,400 --> 00:04:21,940\nYou can't do that with an alias.\n\n79\n00:04:21,940 --> 00:04:23,260\nBut you can with a function.\n\n80\n00:04:23,260 --> 00:04:25,430\nThey're very, very powerful, all right.\n\n81\n00:04:25,430 --> 00:04:28,000\nLet me show you the basic way for\ncreating a function.\n\n82\n00:04:29,090 --> 00:04:30,550\nWe start with just the function command.\n\n83\n00:04:30,550 --> 00:04:33,470\nI know that's a little bit\nweird because in PowerShell\n\n84\n00:04:33,470 --> 00:04:37,330\nmost things are the verb noun format,\nbut this one we just say function.\n\n85\n00:04:37,330 --> 00:04:40,140\nThat lets it know that we're\nabout to create a function.\n\n86\n00:04:40,140 --> 00:04:43,310\nAnd then we can say the name\nwe want the function to have.\n\n87\n00:04:43,310 --> 00:04:47,300\nAnd I'm gonna call mine edit-hosts,\nall right.\n\n88\n00:04:47,300 --> 00:04:53,120\nThen you do the curly bracket, and then\nyou can put whatever you want in there.\n\n89\n00:04:53,120 --> 00:04:57,720\nYou can put one command, a series of\ncommands, you can put all sorts of logic,\n\n90\n00:04:57,720 --> 00:05:00,600\nyou can do a ton of stuff\ninside of a function.\n\n91\n00:05:00,600 --> 00:05:01,670\nWell mine's fairly simple.\n\n92\n00:05:01,670 --> 00:05:03,090\nI don't need a ton of logic.\n\n93\n00:05:03,090 --> 00:05:07,690\nI just want it to run Notepad,\nand edit my file.\n\n94\n00:05:07,690 --> 00:05:11,560\nNow, I could type out the full command,\nbut I'm actually gonna recycle my alias.\n\n95\n00:05:11,560 --> 00:05:13,720\nRemember that alias I made was edit.\n\n96\n00:05:13,720 --> 00:05:15,320\nSo I can actually reuse that.\n\n97\n00:05:15,320 --> 00:05:18,014\nHere I'm gonna say edit\n\n98\n00:05:18,014 --> 00:05:25,292\nC:\\Windows\\System32\\Drivers\\Etc\\Hosts,\nright.\n\n99\n00:05:25,292 --> 00:05:28,510\nOh my head is on top of that,\nlet me scroll up a bit.\n\n100\n00:05:28,510 --> 00:05:29,208\nThere we go.\n\n101\n00:05:29,208 --> 00:05:32,610\nSo you can see the file that I'm editing,\nand I'll just go with curly bracket.\n\n102\n00:05:32,610 --> 00:05:40,310\nSo I could have, right here, I could have\ntyped C:\\Windows\\System32\\Notepad.exe.\n\n103\n00:05:40,310 --> 00:05:41,750\nBut since I already had an alias for\n\n104\n00:05:41,750 --> 00:05:45,070\nit I'm just gonna reuse that alias right\nhere, save me a little bit of typing.\n\n105\n00:05:45,070 --> 00:05:49,508\nAnd then I'm passing to that\nalias this modifier, all right.\n\n106\n00:05:49,508 --> 00:05:52,318\nNow edit-hosts is a lot more powerful.\n\n107\n00:05:52,318 --> 00:05:57,370\nSo alias Is just a name to a command,\nand that's it.\n\n108\n00:05:57,370 --> 00:06:02,371\nA function though, is a name to a series\nof events of limitless power, right.\n\n109\n00:06:02,371 --> 00:06:04,720\nThat's a cool way to look at it.\n\n110\n00:06:04,720 --> 00:06:07,390\nYou can do all sorts of\ncrazy stuff in a function.\n\n111\n00:06:07,390 --> 00:06:08,940\nAnd when I run that, it's gonna log it, so\n\n112\n00:06:08,940 --> 00:06:11,710\nnow I've got this function\ncreated called edit-hosts.\n\n113\n00:06:11,710 --> 00:06:16,350\nAnd when I run it, I can be anywhere on\nmy computer, any prompt that I'm at and\n\n114\n00:06:16,350 --> 00:06:18,230\nI can just type edit hosts, and\n\n115\n00:06:18,230 --> 00:06:22,360\nwhen I run that, it fires up Notepad,\nand here I am in the Windows host file.\n\n116\n00:06:22,360 --> 00:06:25,580\nAnd I can come in and I can start to\nadd entries that I need to modify.\n\n117\n00:06:25,580 --> 00:06:28,532\nNow I need to make sure that I ran\nmy prompt as an administrator,\n\n118\n00:06:28,532 --> 00:06:30,333\notherwise I won't be able to save it.\n\n119\n00:06:30,333 --> 00:06:35,639\nBut I can come in here and say like,\nmy local machine has itprotv.net,\n\n120\n00:06:35,639 --> 00:06:41,667\nwww, that's one of our test domains that\nwe use, so I might throw that in there.\n\n121\n00:06:41,667 --> 00:06:45,231\nAnd now whenever I try and\ngo to www.itprotv.net,\n\n122\n00:06:45,231 --> 00:06:47,500\nit will just go to my own machine.\n\n123\n00:06:47,500 --> 00:06:48,480\nI close that out.\n\n124\n00:06:50,000 --> 00:06:53,930\nAnd we can always pull that right back up.\n\n125\n00:06:53,930 --> 00:06:54,890\nAnd there it is.\n\n126\n00:06:54,890 --> 00:06:56,210\nMy values are saved, right.\n\n127\n00:06:56,210 --> 00:06:59,310\nNice little shortcut that we've made,\nvery easy to do.\n\n128\n00:06:59,310 --> 00:07:04,120\nBecause it's a function, what I could have\ndone is put that edit-host in there, and\n\n129\n00:07:04,120 --> 00:07:07,262\nthen right after it,\nexecuted another command,\n\n130\n00:07:07,262 --> 00:07:11,570\nlike: ipconfig/flushdns,\nand flush my DNS cache.\n\n131\n00:07:11,570 --> 00:07:14,270\nYou don't have to do that cuz\na host file would override it, but\n\n132\n00:07:14,270 --> 00:07:17,030\nthat's the idea that we can\nhave a series of events.\n\n133\n00:07:17,030 --> 00:07:18,360\nYou can even call a script.\n\n134\n00:07:18,360 --> 00:07:21,000\nThere's all sorts of neat stuff\nthat you can do in a function.\n\n135\n00:07:21,000 --> 00:07:24,290\nBasically these curly brackets say,\nall right sky's the limit.\n\n136\n00:07:24,290 --> 00:07:26,780\nWhatever you can think of to\nput in here is gonna run, and\n\n137\n00:07:26,780 --> 00:07:29,170\njust close the curly\nbrackets when your done.\n\n138\n00:07:29,170 --> 00:07:31,170\nNow you've got the function in place,\nall right.\n\n139\n00:07:31,170 --> 00:07:35,150\nSo very powerful it's like\nan advanced version of a alias,\n\n140\n00:07:35,150 --> 00:07:39,130\nthere we go a little brain freeze there.\n\n141\n00:07:39,130 --> 00:07:40,650\nSo, pretty neat stuff.\n\n142\n00:07:40,650 --> 00:07:43,190\nDefinitely something to take advantage of.\n\n143\n00:07:43,190 --> 00:07:45,480\nOtherwise as far as functions\nare concerned that's basically it.\n\n144\n00:07:45,480 --> 00:07:48,380\nI don't wanna go into\nthe programming side.\n\n145\n00:07:48,380 --> 00:07:51,469\nBut all the other things we learned in the\nother segments can go between those curly\n\n146\n00:07:51,469 --> 00:07:53,590\nbrackets, so you can really\nfit a lot of stuff in there.\n\n147\n00:07:54,630 --> 00:07:56,300\nAll right,\nwell I hope you guys enjoyed that segment.\n\n148\n00:07:56,300 --> 00:08:00,000\nStayed tuned, we've got more\nPowerShell coming up after this.\n\n149\n00:08:00,000 --> 00:08:04,700\n[MUSIC]\n\n",
          "vimeoId": "113437112"
        },
        {
          "description": "",
          "length": "609",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-5-executing-binaries-120114.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-5-executing-binaries-120114-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-5-executing-binaries-120114-sm.jpg",
          "title": "Executing Binaries",
          "transcript": "1\n00:00:00,025 --> 00:00:06,379\n[SOUND] In this segment,\nwe're gonna take a look at\n\n2\n00:00:06,379 --> 00:00:11,991\nexecuting binaries inside of PowerShell.\n\n3\n00:00:11,991 --> 00:00:16,310\nNow I know what you're thinking,\nDon this is the dumbest segment ever.\n\n4\n00:00:16,310 --> 00:00:18,570\nto execute a binary,\nyou just type his name and press enter.\n\n5\n00:00:18,570 --> 00:00:20,130\nWhat's so crazy about that?\n\n6\n00:00:20,130 --> 00:00:21,780\nWell, for the most part you're right.\n\n7\n00:00:21,780 --> 00:00:22,670\nYou're exactly right.\n\n8\n00:00:22,670 --> 00:00:25,110\nYou type a name and press enter and\nthat's how it works.\n\n9\n00:00:25,110 --> 00:00:27,090\nBut there's a few exceptions to that,\n\n10\n00:00:27,090 --> 00:00:30,700\ntimes where we might have problems\nwith executing a binary, and\n\n11\n00:00:30,700 --> 00:00:33,260\nI just want to highlight some of those so\nthat you guys are aware of them.\n\n12\n00:00:33,260 --> 00:00:33,850\nAll right?\n\n13\n00:00:33,850 --> 00:00:36,410\nFirst off let's start\nwith that simple example.\n\n14\n00:00:36,410 --> 00:00:38,230\nWhen it comes to executing a binary,\n\n15\n00:00:38,230 --> 00:00:41,870\nif you know the name of it you\njust run it, right, so Notepad.\n\n16\n00:00:41,870 --> 00:00:44,560\nWell, notepad is notepad.exe.\n\n17\n00:00:44,560 --> 00:00:49,506\nAnd I could type in\nthe full path if I wanted.\n\n18\n00:00:49,506 --> 00:00:52,470\nSo C:\\\\Windows\\System32\\notepad.exe.\n\n19\n00:00:52,470 --> 00:00:53,381\nThat works.\n\n20\n00:00:53,381 --> 00:00:54,530\nThat works.\n\n21\n00:00:54,530 --> 00:00:56,980\nOr if it's in the path, right?\n\n22\n00:00:56,980 --> 00:00:58,710\nYou have this path variable.\n\n23\n00:00:58,710 --> 00:01:01,990\nIf you type in $path,\nyou'll see what it is.\n\n24\n00:01:01,990 --> 00:01:05,430\nAnd mine is not showing up,\nthat's awesome.\n\n25\n00:01:05,430 --> 00:01:09,000\nSo [LAUGH] I guess I could\ndo write console but\n\n26\n00:01:09,000 --> 00:01:14,110\nwe can pull it up in our\nsystem configuration also.\n\n27\n00:01:14,110 --> 00:01:17,120\nWhoops not that one.\n\n28\n00:01:17,120 --> 00:01:20,120\nHere let's pull it up this way.\n\n29\n00:01:20,120 --> 00:01:22,210\nWe can take a look at our path.\n\n30\n00:01:22,210 --> 00:01:27,340\nAnd the path is what your system is\nsearching for whenever it runs programs\n\n31\n00:01:27,340 --> 00:01:32,440\nyou have these environment variables, and\none of them is your path right here, and\n\n32\n00:01:32,440 --> 00:01:35,190\nit's basically just a giant\nlist of directories.\n\n33\n00:01:35,190 --> 00:01:38,770\nAnd this will be kind of hard to see,\nso let me pull this back up.\n\n34\n00:01:38,770 --> 00:01:39,560\nHere we go.\n\n35\n00:01:39,560 --> 00:01:42,830\nSo it's this giant list of directories\nthat shows all the different\n\n36\n00:01:42,830 --> 00:01:44,680\nplaces it'll look for a program.\n\n37\n00:01:44,680 --> 00:01:51,550\nAnd so you'll see mine has System Roots,\nSystem/32, so all these different folders.\n\n38\n00:01:51,550 --> 00:01:54,070\nAnd your programs may or\nmay not be in that folder.\n\n39\n00:01:54,070 --> 00:01:56,160\nIf they are, great,\nthey'll run without a path.\n\n40\n00:01:56,160 --> 00:01:59,400\nOtherwise, you'll need to specify a path.\n\n41\n00:01:59,400 --> 00:02:04,185\nSo I can run it with a path, or I can\nrun it without a path like notepad.exe.\n\n42\n00:02:04,185 --> 00:02:09,305\nBecause it's an executable I can\nleave off the extension if I want.\n\n43\n00:02:09,305 --> 00:02:11,835\nI don't have to put .exe or .com.\n\n44\n00:02:11,835 --> 00:02:15,445\nI don't have to put .bat or\n.cmd if I'm running those.\n\n45\n00:02:15,445 --> 00:02:18,290\nSo you can leave little\npieces off if you want.\n\n46\n00:02:18,290 --> 00:02:20,280\nRunning a binary is pretty simple.\n\n47\n00:02:20,280 --> 00:02:24,580\nWhen it gets tricky is when we\ninvolve special characters.\n\n48\n00:02:24,580 --> 00:02:26,470\nWhat do I mean by a special character?\n\n49\n00:02:26,470 --> 00:02:27,730\nWell things like a space.\n\n50\n00:02:27,730 --> 00:02:32,320\nSomething as simple as a space can cause\na real problem with running a program.\n\n51\n00:02:32,320 --> 00:02:35,070\nIf the program is in the path, you can run\njust the program name and you're done.\n\n52\n00:02:35,070 --> 00:02:38,180\nBut if there's a space\nin the program name,\n\n53\n00:02:38,180 --> 00:02:40,570\nyou've gotta make sure\nthe PowerShell understands that.\n\n54\n00:02:40,570 --> 00:02:42,200\nAnd if there's a space in the path,\n\n55\n00:02:42,200 --> 00:02:44,650\nif you're having to provide a path,\nit has to understand that to.\n\n56\n00:02:45,830 --> 00:02:47,580\nSo we gotta be ready to handle that.\n\n57\n00:02:47,580 --> 00:02:49,445\nIf I run something like iexplore.\n\n58\n00:02:50,640 --> 00:02:54,940\nThat is the Internet explorer,\nor is it iexplorer.\n\n59\n00:02:54,940 --> 00:02:56,380\nOh, shoot.\n\n60\n00:02:56,380 --> 00:02:58,580\nOh well, it's probably not in the path.\n\n61\n00:02:58,580 --> 00:03:00,499\nSo, if I try and run something like that.\n\n62\n00:03:01,580 --> 00:03:03,200\nLet's go through and\nsee if we can't find this guy.\n\n63\n00:03:03,200 --> 00:03:05,220\nI'm going to use my tab auto-complete.\n\n64\n00:03:05,220 --> 00:03:07,800\nActually you can see it right there\nwhat tab auto-complete has done.\n\n65\n00:03:07,800 --> 00:03:10,050\nWhen I started to type that path,\n\n66\n00:03:10,050 --> 00:03:16,330\nI typed in C:\\pro and\nI hit Tab to do auto-complete for me.\n\n67\n00:03:16,330 --> 00:03:17,570\nAnd notice what it did.\n\n68\n00:03:17,570 --> 00:03:20,370\nIt didn't just put quotes around it.\n\n69\n00:03:20,370 --> 00:03:22,960\nI mean it did, it put quotes around it so\nI know that there's a space.\n\n70\n00:03:22,960 --> 00:03:26,390\nBut it stuck this\nampersand at the beginning.\n\n71\n00:03:26,390 --> 00:03:27,710\nWhat's that all about?\n\n72\n00:03:27,710 --> 00:03:30,740\nWell, the ampersand is what\nlets PowerShell know, hey,\n\n73\n00:03:30,740 --> 00:03:31,820\nwe're about to run a program.\n\n74\n00:03:31,820 --> 00:03:34,290\nAnd there's some spaces in the name.\n\n75\n00:03:34,290 --> 00:03:36,470\nThat's the warning that we get,\n\n76\n00:03:36,470 --> 00:03:39,320\nthat we give PowerShell to\nlet it know that's happening.\n\n77\n00:03:39,320 --> 00:03:41,910\nThat's the little quirk,\nthat's the thing we need to remember.\n\n78\n00:03:41,910 --> 00:03:45,850\nIf you're executing a binary with spaces\nin the file name or in the path, you've\n\n79\n00:03:45,850 --> 00:03:49,300\ngot to do an ampersand at the beginning\nand then quotes around the command.\n\n80\n00:03:49,300 --> 00:03:52,210\nThey can be single quotes like it did,\nor they can be double quotes,\n\n81\n00:03:52,210 --> 00:03:56,820\nit doesn't matter, and we can continue\nto use tab auto complete to find\n\n82\n00:03:56,820 --> 00:04:01,840\nwhat it is we're looking for, and\nI'm looking for Internet Explorer.\n\n83\n00:04:01,840 --> 00:04:03,390\nHere, let me shorten that up a little bit.\n\n84\n00:04:03,390 --> 00:04:05,440\nI know it starts with IE something or\nanother.\n\n85\n00:04:07,250 --> 00:04:09,270\nI'll just keep hitting tab.\n\n86\n00:04:09,270 --> 00:04:10,620\nThere we go, all right.\n\n87\n00:04:10,620 --> 00:04:12,520\nSo here,\nI don't have a space in the file name.\n\n88\n00:04:12,520 --> 00:04:14,760\nIt's just IExplorer.exe.\n\n89\n00:04:14,760 --> 00:04:16,410\nBut, there are spaces in the rest.\n\n90\n00:04:16,410 --> 00:04:18,250\nSo, we put apostrophes or\n\n91\n00:04:18,250 --> 00:04:22,170\nquotes around it and an ampersand at\nthe beginning to let it be aware.\n\n92\n00:04:22,170 --> 00:04:26,180\nAnd when we run that,\nthere it goes it ran Internet Explorer.\n\n93\n00:04:26,180 --> 00:04:26,860\nRight.\n\n94\n00:04:26,860 --> 00:04:32,200\nIf you run it without the ampersand,\nsometimes it'll understand,\n\n95\n00:04:32,200 --> 00:04:33,800\na lot of times it doesn't.\n\n96\n00:04:33,800 --> 00:04:37,550\nAnd you run that and it ends up just\nechoing the output that you provided.\n\n97\n00:04:37,550 --> 00:04:39,800\nSo here it is, echoing the output.\n\n98\n00:04:39,800 --> 00:04:40,870\nThat's it right?\n\n99\n00:04:40,870 --> 00:04:42,480\nDidn't actually run the program.\n\n100\n00:04:42,480 --> 00:04:43,880\nThe ampersand is really important.\n\n101\n00:04:45,340 --> 00:04:48,290\nThere is another scenario\nyou can bump into also.\n\n102\n00:04:48,290 --> 00:04:52,370\nSometimes it's not so\nmuch about a space in a file name,\n\n103\n00:04:52,370 --> 00:04:56,070\nas it is special characters in\nthe command that you're running.\n\n104\n00:04:56,070 --> 00:05:03,305\nSo, for example, if I have Had a file,\nlet's say C:\\test.txt all right.\n\n105\n00:05:03,305 --> 00:05:09,945\nSo I'm gonna say this is a test,\nwhoops, that's not what I wanted.\n\n106\n00:05:09,945 --> 00:05:11,975\nI just want to save and get out.\n\n107\n00:05:11,975 --> 00:05:16,245\nAlright, so I've got a file now,\nthat is test.txt.\n\n108\n00:05:16,245 --> 00:05:21,070\nThere it is, and I might want\nto modify the file permissions.\n\n109\n00:05:21,070 --> 00:05:23,900\nWell I know the GY I can go pull\nup the properties of the file, but\n\n110\n00:05:23,900 --> 00:05:28,030\nI can modify file permissions right from\nthe command line using the icacls or\n\n111\n00:05:28,030 --> 00:05:32,620\nI C A C L S command line\nutility to change those.\n\n112\n00:05:32,620 --> 00:05:36,400\nWell, one of the problems\nwith the icacls command line\n\n113\n00:05:36,400 --> 00:05:38,170\nis it uses a lot of special characters.\n\n114\n00:05:38,170 --> 00:05:41,100\nIt uses parenthesis,\nthat's the main one that causes problems.\n\n115\n00:05:41,100 --> 00:05:46,190\nAnd PowerShell can choke on those\nparentheses, it'll interpret them wrong.\n\n116\n00:05:46,190 --> 00:05:48,840\nAnd so it's another area\nwhere we have to be careful\n\n117\n00:05:48,840 --> 00:05:50,820\nabout what we're providing it, all right?\n\n118\n00:05:50,820 --> 00:05:55,615\nSo for example, if I wanted to run icacls\n\n119\n00:05:55,615 --> 00:06:03,120\nC:\\test.txt, and\ngonna give myself full control, right?\n\n120\n00:06:03,120 --> 00:06:05,960\nSo I need to specify who I am.\n\n121\n00:06:05,960 --> 00:06:06,470\nAll right.\n\n122\n00:06:08,940 --> 00:06:12,270\nAnd I'm gonna give myself,\nwell you know what?\n\n123\n00:06:12,270 --> 00:06:16,450\nI'm gonna set some inheritance I guess.\n\n124\n00:06:16,450 --> 00:06:18,370\nAnd then I need to modify that.\n\n125\n00:06:18,370 --> 00:06:23,610\nI want my component inheritance and\nobject, or it's container and object.\n\n126\n00:06:23,610 --> 00:06:27,510\nI really just need object cuz it's not\na folder, but I'll set those and F.\n\n127\n00:06:27,510 --> 00:06:29,890\nI'm going to give myself full control.\n\n128\n00:06:29,890 --> 00:06:33,860\nSo, I'm going to give myself\nfull control of that file, but\n\n129\n00:06:33,860 --> 00:06:38,590\nI've got quote marks inside of my commend,\nI've got a colon inside of my command,\n\n130\n00:06:38,590 --> 00:06:41,430\nand I've got some parentheses\ninside of my command, and\n\n131\n00:06:41,430 --> 00:06:44,250\nall of those can cause\nproblems with PowerShell.\n\n132\n00:06:45,980 --> 00:06:48,570\nIf I run that, it may work,\nit may not, but\n\n133\n00:06:48,570 --> 00:06:52,960\nnotice what it says here\nThe term CI is not recognized.\n\n134\n00:06:52,960 --> 00:06:57,050\nIt was actually happy all the way along,\nuntil it got to here.\n\n135\n00:06:57,050 --> 00:06:59,010\nThe colon kinda threw it.\n\n136\n00:06:59,010 --> 00:07:02,110\nAnd then the CI,\nit tried to run that as a command.\n\n137\n00:07:02,110 --> 00:07:04,030\nAnd that didn't work, and it broke.\n\n138\n00:07:04,030 --> 00:07:06,720\nRight?\nIt wasn't able to execute my command.\n\n139\n00:07:06,720 --> 00:07:10,310\nAnd in the syntax highlighting down here,\nit shows my command.\n\n140\n00:07:10,310 --> 00:07:13,920\nAnd notice right here these\nlittle squigglies The tilds.\n\n141\n00:07:13,920 --> 00:07:16,160\nThat's it telling me where\nthe command broke down.\n\n142\n00:07:16,160 --> 00:07:19,490\nSo it broke down here because\nof special characters.\n\n143\n00:07:19,490 --> 00:07:22,401\nNow if I want to try to get around\nthat there's a neat little shortcut\n\n144\n00:07:22,401 --> 00:07:23,670\nyou can use.\n\n145\n00:07:23,670 --> 00:07:28,480\nThere's a value we can stick in here\nthat tells PowerShell hey the name of\n\n146\n00:07:28,480 --> 00:07:33,800\nthe program is over, the rest of this\nstuff is for that program, not for you.\n\n147\n00:07:33,800 --> 00:07:38,640\nWe can tell PowerShell to stop\ninterpreting the rest of the line.\n\n148\n00:07:38,640 --> 00:07:41,860\nIt'll just take the rest of the line and\nfeed it to the program we're calling.\n\n149\n00:07:41,860 --> 00:07:48,126\nSo when I called icacls right here all\nthis other stuff C:/test.text/grant,\n\n150\n00:07:48,126 --> 00:07:52,580\nall this other stuff,\nicacls cares about that.\n\n151\n00:07:52,580 --> 00:07:53,660\nNot PowerShell.\n\n152\n00:07:54,670 --> 00:07:57,560\nSo I can come in here and\nI can add a little bit more to it.\n\n153\n00:07:57,560 --> 00:07:59,900\nAnd you can kind of pick\nwhere you want it to be.\n\n154\n00:07:59,900 --> 00:08:02,220\nI usually stick it after the file name.\n\n155\n00:08:02,220 --> 00:08:05,210\nBecause you know PowerShell\nis happy up to that point.\n\n156\n00:08:05,210 --> 00:08:09,340\nThe symbol is dash dash percent.\n\n157\n00:08:09,340 --> 00:08:10,340\nOr hyphen hyphen percent.\n\n158\n00:08:11,420 --> 00:08:16,970\nWhen you put that in,\nthat tells PowerShell from this point on\n\n159\n00:08:16,970 --> 00:08:21,110\neverything after hyphen\nhyphen percent ignore it.\n\n160\n00:08:21,110 --> 00:08:22,250\nDon't process it.\n\n161\n00:08:22,250 --> 00:08:26,014\nJust hand it to whatever program or\ncommand that we're running.\n\n162\n00:08:26,014 --> 00:08:27,160\nAnd let them deal with it.\n\n163\n00:08:27,160 --> 00:08:31,380\nSo now the fact that I have these special\ncharacters over here is no big deal.\n\n164\n00:08:31,380 --> 00:08:34,370\nBecause PowerShell is gonna\nignore everything else and\n\n165\n00:08:34,370 --> 00:08:38,830\ntake all of that and\nfeed it unchanged into icacls.\n\n166\n00:08:38,830 --> 00:08:43,560\nAnd if I run that I should have\na little bit better success and,\n\n167\n00:08:43,560 --> 00:08:44,910\noh it didn't find me.\n\n168\n00:08:44,910 --> 00:08:48,400\nSo, no mapping between account names and\nsecurity IDs was done.\n\n169\n00:08:48,400 --> 00:08:51,120\nSo apparently my name\ndidn't look up right.\n\n170\n00:08:51,120 --> 00:08:52,370\nLet's pick a different user.\n\n171\n00:08:54,250 --> 00:08:55,250\nAll right, you know what?\n\n172\n00:08:55,250 --> 00:08:59,890\nI need to use the local machine names,\nthis is Server 01, there we go.\n\n173\n00:08:59,890 --> 00:09:03,400\nProcess file, successfully\nprocessed one file and it's done.\n\n174\n00:09:03,400 --> 00:09:07,670\nMuch happier by telling it not to process\nanything beyond that point, right?\n\n175\n00:09:07,670 --> 00:09:09,370\nSo you may have to use that,\n\n176\n00:09:09,370 --> 00:09:11,680\nwe really do see that a lot\nwith command line modifiers.\n\n177\n00:09:11,680 --> 00:09:12,980\nAll right so\nif you're trying to run a command and\n\n178\n00:09:12,980 --> 00:09:16,540\nyou get something weird like this up here,\njust tell it where to stop processing.\n\n179\n00:09:16,540 --> 00:09:19,460\nWhere PowerShell is done, and\nthe other program takes over.\n\n180\n00:09:20,820 --> 00:09:21,540\nAll right.\n\n181\n00:09:21,540 --> 00:09:23,870\nSo, couple of little caveats there.\n\n182\n00:09:23,870 --> 00:09:26,490\nFor most people running a binary\nis exactly what we said at\n\n183\n00:09:26,490 --> 00:09:27,690\nthe beginning of the segment.\n\n184\n00:09:27,690 --> 00:09:30,280\nYou type in the name,\nyou press enter, and you're done.\n\n185\n00:09:30,280 --> 00:09:31,240\nAll right?\n\n186\n00:09:31,240 --> 00:09:35,330\nBut if there's spaces in the path or\nfilename, put that ampersand at\n\n187\n00:09:35,330 --> 00:09:38,980\nthe beginning and then surround\nthe command with quotes or apostrophes.\n\n188\n00:09:39,980 --> 00:09:44,540\nIf you have special characters in there\nthough you might need to use the dash dash\n\n189\n00:09:44,540 --> 00:09:48,440\npercent, which tells you stop\nprocessing beyond this point and\n\n190\n00:09:48,440 --> 00:09:50,270\nhand that off to the program.\n\n191\n00:09:50,270 --> 00:09:53,260\nCouple little interesting scenarios there,\nthings that you might bump into and\n\n192\n00:09:53,260 --> 00:09:55,310\nthat's why we had to do\na segment on executing binaries.\n\n193\n00:09:55,310 --> 00:09:57,840\nAlright well I hope you guys\nlearned something new there.\n\n194\n00:09:57,840 --> 00:10:00,786\nIf not, stay tuned,\nwe've got more PowerShell coming up and\n\n195\n00:10:00,786 --> 00:10:03,747\nI'm sure there will be something there for\nyou, stay tuned.\n\n196\n00:10:03,747 --> 00:10:09,409\n>> [MUSIC]\n\n",
          "vimeoId": "113438189"
        },
        {
          "description": "",
          "length": "1616",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-6-help-commands-120214.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-6-help-commands-120214-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-6-help-commands-120214-sm.jpg",
          "title": "Help Commands",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:07.471\n[MUSIC]\n\n2\n00:00:07.471 --> 00:00:11.319\nIn this segment we're gonna take\na look at how we can pull up help for\n\n3\n00:00:11.319 --> 00:00:15.080\nthe various commands that\nwe use in the PowerShell.\n\n4\n00:00:15.080 --> 00:00:18.260\nIt's very unlikely that you're going\nto memorize all the various commands\n\n5\n00:00:18.260 --> 00:00:19.180\nthat you need.\n\n6\n00:00:19.180 --> 00:00:22.990\nAnd so very often we've got\nto turn to the documentation.\n\n7\n00:00:22.990 --> 00:00:25.381\nSometimes you can go to\nMicrosoft's TechNet website and\n\n8\n00:00:25.381 --> 00:00:28.883\nthere is a wealth of information on there\nand it's very easy to navigate and get at.\n\n9\n00:00:28.883 --> 00:00:32.134\nBut if you're dealing with a server\nthat has no web browser or\n\n10\n00:00:32.134 --> 00:00:35.706\nyou're in a protected network\nwhere you have no Internet access,\n\n11\n00:00:35.706 --> 00:00:38.724\nthen you might not be able to\nget to the TechNet website.\n\n12\n00:00:38.724 --> 00:00:42.170\nAnd in that scenario, you need to rely\non the help tools that are available\n\n13\n00:00:42.170 --> 00:00:45.020\ninside of PowrShell and\nfortunately there's a lot of them.\n\n14\n00:00:45.020 --> 00:00:48.240\nThere's actually a lot of different things\nwe can do to get information out of it\n\n15\n00:00:48.240 --> 00:00:50.550\nthat are incredibly useful, all right?\n\n16\n00:00:50.550 --> 00:00:52.000\nSo let's take a look at that.\n\n17\n00:00:52.000 --> 00:00:54.680\nI know in some of the other segments\nthat we've already seen one of\n\n18\n00:00:54.680 --> 00:00:59.750\nthe big commands that I like to run,\nand that is the Get-Help command.\n\n19\n00:00:59.750 --> 00:01:03.410\nThat's kind of number one go to guy\nwhen I need help for something and\n\n20\n00:01:03.410 --> 00:01:07.130\nif you just run Get-Help by itself,\nit'll give you some basic information.\n\n21\n00:01:07.130 --> 00:01:10.940\nAnd when we run that, well it's kind of\na lot of information here that scrolls by.\n\n22\n00:01:10.940 --> 00:01:15.690\nAnd you'll see it's just giving you advice\non how to use the Get-Help command.\n\n23\n00:01:15.690 --> 00:01:18.570\nAnd that's exactly what I'm gonna\nshow you here in just a moment.\n\n24\n00:01:19.800 --> 00:01:23.200\nNow, by default when you run Get-Help,\n\n25\n00:01:23.200 --> 00:01:27.110\nyou can then follow it up by specifying\na command to get the help from.\n\n26\n00:01:27.110 --> 00:01:32.310\nAnd it will pull that help documentation\nright here from the server that you're on.\n\n27\n00:01:32.310 --> 00:01:38.410\nSo if I wanna get help on a command,\nlike I wanna Get-Help Restart-Service, I\n\n28\n00:01:38.410 --> 00:01:43.410\nwanna learn more about that command, when\nI run it, it's gonna pull the help for it.\n\n29\n00:01:43.410 --> 00:01:47.710\nBut notice on my server here, it's saying\nGet-Help cannot find the Help files for\n\n30\n00:01:47.710 --> 00:01:48.870\nthis cmdlet on this computer.\n\n31\n00:01:48.870 --> 00:01:50.810\nAll right, what's that all about?\n\n32\n00:01:50.810 --> 00:01:54.970\nWell, when someone sets up a server\nthey will typically set it up\n\n33\n00:01:54.970 --> 00:01:59.180\nwith the minimum functionality\nnecessary to perform its job, and\n\n34\n00:01:59.180 --> 00:02:01.970\nthey choose to leave off\nthings that aren't required.\n\n35\n00:02:01.970 --> 00:02:06.460\nWell, the help files for PowerShell\naren't necessarily required, and so\n\n36\n00:02:06.460 --> 00:02:08.160\nsome admins will choose to leave them off.\n\n37\n00:02:09.300 --> 00:02:12.460\nNow, if your system is\nconnected to the Internet,\n\n38\n00:02:12.460 --> 00:02:14.730\nyou may just go to the TechNet site and\nuse that.\n\n39\n00:02:14.730 --> 00:02:19.060\nThere's also a little extension we\ncan use to this, we can say Get-Help,\n\n40\n00:02:19.060 --> 00:02:24.400\nthe command we want help on, and then you\ncan add the -Online command, all right.\n\n41\n00:02:24.400 --> 00:02:27.440\nAnd that's gonna tell it to reach out to\nMicrosoft's site, and pull up the help for\n\n42\n00:02:27.440 --> 00:02:29.100\nthat, and see what it did?\n\n43\n00:02:29.100 --> 00:02:32.972\nIt went right to the webpage for\nRestart-Service and\n\n44\n00:02:32.972 --> 00:02:34.320\nthere is the information.\n\n45\n00:02:34.320 --> 00:02:37.010\nHere is the help file and\nit's got the information that I need,\n\n46\n00:02:37.010 --> 00:02:40.590\nthe syntax of the command,\nthe detailed description and\n\n47\n00:02:40.590 --> 00:02:44.270\nall of the other information\nassociated with it all right here.\n\n48\n00:02:45.430 --> 00:02:50.410\nSo that's one option for us, but\nit's still doesn't solve the problem of\n\n49\n00:02:50.410 --> 00:02:52.540\nwhat if I don't have Internet access,\nright?\n\n50\n00:02:52.540 --> 00:02:55.340\nIf I don't have Internet access and\nI want to get this help documentation for\n\n51\n00:02:55.340 --> 00:02:57.610\na command, that doesn't help me.\n\n52\n00:02:57.610 --> 00:03:01.420\nWell, if it's already installed\nthen it's not a big deal.\n\n53\n00:03:01.420 --> 00:03:05.060\nBut if it isn't installed,\nwe just need to install it, all right.\n\n54\n00:03:05.060 --> 00:03:09.600\nNow for me this next step is one that I\npretty much do on servers regardless,\n\n55\n00:03:09.600 --> 00:03:12.650\neven if the help documentation\nis already installed.\n\n56\n00:03:12.650 --> 00:03:14.550\nSometimes it can be out of date.\n\n57\n00:03:14.550 --> 00:03:18.944\nAnd so we have an Update-Help command\nthat'll reach out to Microsoft servers and\n\n58\n00:03:18.944 --> 00:03:22.448\ndownload the latest version of\nthe help documentation for all for\n\n59\n00:03:22.448 --> 00:03:25.570\nall the commandlets you\nhave installed right now.\n\n60\n00:03:25.570 --> 00:03:29.510\nThat's important because you\nmight have added more commandlets\n\n61\n00:03:29.510 --> 00:03:31.560\nsince the last time you\nupdated your help files.\n\n62\n00:03:31.560 --> 00:03:33.100\nSo you may actually be missing some,\n\n63\n00:03:33.100 --> 00:03:35.260\nand here's a chance for\nit to correct that and update it.\n\n64\n00:03:35.260 --> 00:03:36.310\nAnd as service packs and\n\n65\n00:03:36.310 --> 00:03:39.590\nhotfixes come out, updates to\nthe help files may be necessary, too.\n\n66\n00:03:39.590 --> 00:03:42.300\nSo it's definitely a good idea to do it,\nall right.\n\n67\n00:03:42.300 --> 00:03:46.260\nNow the update process can take a little\nwhile, and so I've got a second\n\n68\n00:03:46.260 --> 00:03:49.660\nPowerShell window in the background here\nthat I'm gonna use to do the update.\n\n69\n00:03:49.660 --> 00:03:51.900\nAnd if we want to update it and\nhave it go out and get it,\n\n70\n00:03:51.900 --> 00:03:53.480\nthe command is really simple.\n\n71\n00:03:53.480 --> 00:03:56.560\nIt's just the Update-Help command.\n\n72\n00:03:56.560 --> 00:04:00.550\nAnd when you run that it's\ngonna give us a little prompt.\n\n73\n00:04:00.550 --> 00:04:02.458\nActually apparently mine's\nnot even going to prompt.\n\n74\n00:04:02.458 --> 00:04:05.870\n[LAUGH] Sometimes it will prompt and say\nare you sure you want to get updates for\n\n75\n00:04:05.870 --> 00:04:08.600\nall of your commandlets,\nand you say yes or no.\n\n76\n00:04:08.600 --> 00:04:11.240\nI must not have any extra\nmodules added in here.\n\n77\n00:04:11.240 --> 00:04:12.810\nIf you have extra modules\nit will prompt you,\n\n78\n00:04:12.810 --> 00:04:16.610\njust to kinda give you a little warning\nabout that it might take a long time.\n\n79\n00:04:16.610 --> 00:04:20.730\nBut here you see it's going out, and it's\npulling all this help documentation, and\n\n80\n00:04:20.730 --> 00:04:23.530\nit's flashing by really fast here, but\n\n81\n00:04:23.530 --> 00:04:26.890\nit says locating,\nthen downloading, then installing.\n\n82\n00:04:26.890 --> 00:04:28.780\nThose are the three\nstages it goes through.\n\n83\n00:04:28.780 --> 00:04:30.390\nIt'll locate the help content for\n\n84\n00:04:30.390 --> 00:04:34.140\na particular commandlet, it'll download\nit, and then it'll install it.\n\n85\n00:04:34.140 --> 00:04:38.630\nThis is going to ensure that I have\nthe latest help information on my system.\n\n86\n00:04:38.630 --> 00:04:42.570\nAnd then I'm able to reference it even\nwithout an Internet connection, all right?\n\n87\n00:04:42.570 --> 00:04:46.790\nThat's a pretty handy thing especially if\nyou've got a server that's a core install.\n\n88\n00:04:46.790 --> 00:04:51.390\nNow Microsoft's stance on this is, you\ndon't necessarily need to install the help\n\n89\n00:04:51.390 --> 00:04:56.225\non the server because you should be\ndeveloping an PowerShell scripts or\n\n90\n00:04:56.225 --> 00:04:59.305\ncommands that you're gonna be using\non your own workstation first in\n\n91\n00:04:59.305 --> 00:05:00.365\na test environment.\n\n92\n00:05:00.365 --> 00:05:03.055\nSo by the time you come to the server\nyou don't need the help documentation.\n\n93\n00:05:03.055 --> 00:05:05.955\nWhere you just run the commands that\nyou've already thoroughly tested.\n\n94\n00:05:05.955 --> 00:05:07.160\nThat's why it's not installed here.\n\n95\n00:05:07.160 --> 00:05:09.640\nThat's why it's an optional component.\n\n96\n00:05:09.640 --> 00:05:13.460\nNow I've installed this help\ndocumentation and while it's really,\n\n97\n00:05:13.460 --> 00:05:17.220\nreally unlikely, it has technically\nincreased my attack surface.\n\n98\n00:05:17.220 --> 00:05:21.000\nI put help files on the server that don't\nactually contribute to the function\n\n99\n00:05:21.000 --> 00:05:21.850\nof this server.\n\n100\n00:05:21.850 --> 00:05:24.640\nSo you'll have to take\nthat with a grain of salt.\n\n101\n00:05:24.640 --> 00:05:27.320\nYou know, when you go to deploy this\nin your own environment, you may or\n\n102\n00:05:27.320 --> 00:05:29.600\nmay not actually want to deploy\nthe help files on your server.\n\n103\n00:05:29.600 --> 00:05:33.270\nBut I actually stalled long\nenough there that it finished.\n\n104\n00:05:33.270 --> 00:05:40.430\nSo now that it's done, if I go back\nhere and I do Get-Help Restart-Service,\n\n105\n00:05:40.430 --> 00:05:44.440\nwhen I run that instead of telling\nme it couldn't find a help file,\n\n106\n00:05:44.440 --> 00:05:48.200\nnow I get the help documentation and\nit's right here on this server.\n\n107\n00:05:48.200 --> 00:05:50.310\nIt didn't have to go out\nto the Internet to get it.\n\n108\n00:05:50.310 --> 00:05:50.880\nAll right?\n\n109\n00:05:50.880 --> 00:05:53.540\nSo don't be worried if you see\nyour help files are missing.\n\n110\n00:05:53.540 --> 00:05:58.200\nJust run Update-Help, It'll run that and\nget everything up to date.\n\n111\n00:05:58.200 --> 00:06:01.090\nIt's a good idea to run that periodically\nanyway just to make sure you've got\n\n112\n00:06:01.090 --> 00:06:02.139\nthe latest help documentation.\n\n113\n00:06:03.510 --> 00:06:07.950\nNow, in my scenario,\nI knew the command I was looking for.\n\n114\n00:06:07.950 --> 00:06:13.680\nAnd so I did Get-Help, I punched in\nthe command that I wanted, and here it is.\n\n115\n00:06:13.680 --> 00:06:17.350\nIf you don't know the command that you're\nlooking for, though, you might need to use\n\n116\n00:06:17.350 --> 00:06:21.730\nthe Get-Command commandlet to be able\nto find the command you're looking for.\n\n117\n00:06:21.730 --> 00:06:28.130\nIf I know I'm gonna be working with DNS,\nthen I might need to do get-command and do\n\n118\n00:06:28.130 --> 00:06:32.190\na search for any command having to do with\nDNS, and we can use wildcards for that.\n\n119\n00:06:32.190 --> 00:06:33.810\nI know I've done this\nin another segment but\n\n120\n00:06:33.810 --> 00:06:38.170\nin case you haven't watched\nit get-command *dns*.\n\n121\n00:06:38.170 --> 00:06:41.590\nThose asterisks mean any number\nof characters before and\n\n122\n00:06:41.590 --> 00:06:45.730\nany number of characters after, show me\nall the commands having to do with DNS.\n\n123\n00:06:45.730 --> 00:06:48.890\nAnd I'll see there's, there's actually\nquite a few that are listed in here,\n\n124\n00:06:48.890 --> 00:06:53.645\nand let's see, I must not be a DNS\nserver cuz these are all client ones.\n\n125\n00:06:53.645 --> 00:06:56.835\nIf you're running a DNS server you'll\nhave even more that have to do with\n\n126\n00:06:56.835 --> 00:06:58.505\nthe server itself.\n\n127\n00:06:58.505 --> 00:06:59.855\nThe majority of these are functions,\n\n128\n00:06:59.855 --> 00:07:03.585\nyou'll see there's only a few\ncommandlets like Resolve-DNSName.\n\n129\n00:07:03.585 --> 00:07:06.945\nIf I want to learn more about\none of these I can use Get-Help\n\n130\n00:07:06.945 --> 00:07:08.735\nfollowed by the name of that command.\n\n131\n00:07:08.735 --> 00:07:11.630\nFor example if I wanted\nto pull up the help for\n\n132\n00:07:11.630 --> 00:07:16.721\nGet-DNSClient I could come in here and\nsay Get-Help followed\n\n133\n00:07:16.721 --> 00:07:22.502\nby Get-DNSClient and\nthere's the help documentation for it.\n\n134\n00:07:22.502 --> 00:07:26.310\nAll right now when we get the help\ndocumentation, what is it telling us?\n\n135\n00:07:26.310 --> 00:07:29.735\nWell the format of the help documentation,\n\n136\n00:07:29.735 --> 00:07:33.260\nit actually follows a standard,\na pattern that Microsoft created.\n\n137\n00:07:33.260 --> 00:07:36.800\nSo all the documentation\nis written the same way.\n\n138\n00:07:36.800 --> 00:07:38.613\nWhen you run Get-Help for a command,\n\n139\n00:07:38.613 --> 00:07:41.738\nit's typically gonna return these\nfive areas for us right here.\n\n140\n00:07:41.738 --> 00:07:47.575\nA synopsis which is just a quick short\ndescription of what the command does.\n\n141\n00:07:47.575 --> 00:07:48.357\nIn this case,\n\n142\n00:07:48.357 --> 00:07:53.010\nretrieves details of network interfaces\nconfigured on a specific computer.\n\n143\n00:07:53.010 --> 00:07:57.240\nSo this ones gonna go out and get\ninformation about my network interfaces.\n\n144\n00:07:57.240 --> 00:07:58.732\nAnd then we see the syntax.\n\n145\n00:07:58.732 --> 00:08:02.954\nThis is what we actually type into\nthe PowerShell to use the command.\n\n146\n00:08:02.954 --> 00:08:07.514\nAnd it'll start out with the command\nitself And then it'll list all\n\n147\n00:08:07.514 --> 00:08:12.170\nof the modifiers for that command,\nand there can be a bunch of them.\n\n148\n00:08:12.170 --> 00:08:15.460\nLook at all these that are listed here,\nforget -DnsClient.\n\n149\n00:08:15.460 --> 00:08:17.855\nWell, they're not all required.\n\n150\n00:08:17.855 --> 00:08:21.280\nSome of them are required,\nsome of them are optional, and\n\n151\n00:08:21.280 --> 00:08:23.510\nit can be a little tricky\nto recognize that.\n\n152\n00:08:23.510 --> 00:08:27.550\nWhen you start to look at them,\nthese square brackets are how\n\n153\n00:08:27.550 --> 00:08:32.540\nwe know whether we've got a required\nsetting, or an optional setting, okay?\n\n154\n00:08:32.540 --> 00:08:39.042\nWhen you see one that's written like\nthis -InterFaceAlias String, okay?\n\n155\n00:08:39.042 --> 00:08:45.120\nWhat that's telling me is, when I run\nGet-DNSClient, I can specify the alias for\n\n156\n00:08:45.120 --> 00:08:48.810\nan interface, the name of an interface\nthat I want to find out information for.\n\n157\n00:08:48.810 --> 00:08:53.380\nAnd if I do that, I need to specify\nthe string, the name that I'm looking for.\n\n158\n00:08:53.380 --> 00:08:57.520\nAnd it's surrounded by\nthese square brackets,\n\n159\n00:08:57.520 --> 00:09:00.910\ntelling me that this is\nan optional parameter.\n\n160\n00:09:00.910 --> 00:09:05.840\nI don't have to specify this if don't\nwant to, I can leave it off, right?\n\n161\n00:09:05.840 --> 00:09:10.080\nWhen we have one that's required, let's\nsee if any of these are actually required.\n\n162\n00:09:10.080 --> 00:09:13.120\nSo this one's optional,\ncuz they're grouped together,\n\n163\n00:09:13.120 --> 00:09:15.390\nthis one's optional cuz\nthey're grouped together.\n\n164\n00:09:15.390 --> 00:09:18.150\nThe next one's optional,\nare they all optional in this one?\n\n165\n00:09:18.150 --> 00:09:19.340\nIt looks like they are.\n\n166\n00:09:19.340 --> 00:09:20.860\nYeah, they're all optional on this one.\n\n167\n00:09:20.860 --> 00:09:25.200\nOkay so, sometimes you'll have\na command where they're all optional.\n\n168\n00:09:25.200 --> 00:09:29.510\nIn other words,\nI can just run get-DnsClient, all right?\n\n169\n00:09:29.510 --> 00:09:32.900\nAnd when I run that by itself,\nit runs, right?\n\n170\n00:09:32.900 --> 00:09:37.360\nI didn't have to provide any\nmodifiers if I didn't want to.\n\n171\n00:09:37.360 --> 00:09:39.560\nBut there's other commands\nthat you do have to.\n\n172\n00:09:39.560 --> 00:09:42.140\nSo, for example, Restart-Service.\n\n173\n00:09:42.140 --> 00:09:45.330\nIf I just run that by itself,\nit's not very happy about it.\n\n174\n00:09:45.330 --> 00:09:49.410\nAnd now it's prompting me for\nother values that I needed to provided.\n\n175\n00:09:49.410 --> 00:09:53.080\nIt's asking for\nsome kind of input that I didn't give it.\n\n176\n00:09:53.080 --> 00:09:55.080\nAnd I could go and\nstart to specify that if I wanted.\n\n177\n00:09:55.080 --> 00:09:59.830\nIt's just telling me hey, at position one,\nwe needed a parameter called InputObject,\n\n178\n00:09:59.830 --> 00:10:01.820\nand we didn't give it one, all right?\n\n179\n00:10:01.820 --> 00:10:06.910\nSo, what we can do is we can\ndo get-help for that command.\n\n180\n00:10:06.910 --> 00:10:08.350\nThat'll be a better example for us.\n\n181\n00:10:11.034 --> 00:10:16.339\nAnd when I pull up it's information,\nin the syntax, I see Restart-Service and\n\n182\n00:10:16.339 --> 00:10:20.553\nthen we've got this -InputObject\n-ServiceController, and\n\n183\n00:10:20.553 --> 00:10:25.010\nthen we've got -Exclude, -Force,\na few other things, right?\n\n184\n00:10:25.010 --> 00:10:26.690\nSo it's giving us these\nvarious information,\n\n185\n00:10:26.690 --> 00:10:28.780\nthese various values that we can provide.\n\n186\n00:10:28.780 --> 00:10:31.620\nBut right down here,\nthis is the most common usage.\n\n187\n00:10:31.620 --> 00:10:35.180\nThere's actually three different usages\nfor this command that they're listing.\n\n188\n00:10:35.180 --> 00:10:41.500\nThe last one is the one that we normally\ndo, Restart-Service -Name and a string.\n\n189\n00:10:41.500 --> 00:10:44.290\nThe name of the service we're starting,\nbut look how it's written.\n\n190\n00:10:44.290 --> 00:10:50.070\nSee how -Name and -String,\nthey're not surrounded by square brackets.\n\n191\n00:10:50.070 --> 00:10:52.678\nSure, -Name has square brackets around it,\nand\n\n192\n00:10:52.678 --> 00:10:57.780\n-String, it actually contains the square\nbrackets indicating that there's a string.\n\n193\n00:10:57.780 --> 00:11:01.440\nBut there's not a set of square brackets\nthat actually encompasses both of them.\n\n194\n00:11:03.040 --> 00:11:05.470\nBecause there's no brackets\naround both of them,\n\n195\n00:11:05.470 --> 00:11:09.010\nthat's our indicator that\nthis is a required value.\n\n196\n00:11:09.010 --> 00:11:11.230\nI have to provide a name.\n\n197\n00:11:12.860 --> 00:11:17.482\nNow, in this scenario, there's actually\na little bit something special here.\n\n198\n00:11:17.482 --> 00:11:22.870\nThat -Name, that's actually the default\nparameter for Restart-Service, so\n\n199\n00:11:22.870 --> 00:11:27.230\nI could leave that part out if I wanted,\nbut I'd have to provide the string.\n\n200\n00:11:27.230 --> 00:11:32.100\nSo if I did something like, let me\nswitch to my administrative shell here.\n\n201\n00:11:32.100 --> 00:11:34.450\nSo I'm gonna do Restart-Service.\n\n202\n00:11:34.450 --> 00:11:38.480\nI could say -Name and\nthen the name of the service.\n\n203\n00:11:38.480 --> 00:11:40.660\nAnd so I'll do Dnsclient.\n\n204\n00:11:40.660 --> 00:11:41.613\nAll right?\n\n205\n00:11:41.613 --> 00:11:44.190\nActually, it's Dnscache,\nis it what it's called.\n\n206\n00:11:44.190 --> 00:11:45.080\nThere we go.\n\n207\n00:11:45.080 --> 00:11:47.340\nSo, I just restarted that service.\n\n208\n00:11:47.340 --> 00:11:51.890\nBut I could leave off -Name\nbecause that's the default.\n\n209\n00:11:51.890 --> 00:11:56.220\nThe default parameter is -Name so\nit knows it, and it's happy with that.\n\n210\n00:11:56.220 --> 00:11:59.160\nAll right, so\nwhen we're reading the help file,\n\n211\n00:11:59.160 --> 00:12:01.660\nthat's one of the more\ncryptic things to understand.\n\n212\n00:12:01.660 --> 00:12:07.070\nWhen you're looking at the syntax here,\nlet me clear my screen, and when we go and\n\n213\n00:12:07.070 --> 00:12:12.270\nlook at the syntax here,\nif these values are separated and\n\n214\n00:12:12.270 --> 00:12:15.690\nnot grouped together in square bracket,\nthat means it's required.\n\n215\n00:12:15.690 --> 00:12:19.620\nIf they're combined like this one,\n-Exclude String and\n\n216\n00:12:19.620 --> 00:12:23.590\nthey've got square brackets around\nboth sides, that means it's optional.\n\n217\n00:12:23.590 --> 00:12:24.980\nWe don't have to include it.\n\n218\n00:12:24.980 --> 00:12:25.570\nAll right?\n\n219\n00:12:25.570 --> 00:12:29.030\nBut there's our syntax that it kind\nof lays out as it goes through and\n\n220\n00:12:29.030 --> 00:12:29.880\nprovides that information.\n\n221\n00:12:29.880 --> 00:12:33.440\nIf you see something like this, -Force,\nand it's not followed by any kind of\n\n222\n00:12:33.440 --> 00:12:36.850\nstring or other value that we provide,\nthat one's gonna be optional also.\n\n223\n00:12:36.850 --> 00:12:41.340\nThere's no second value attached to it,\nso you don't have to provide that.\n\n224\n00:12:41.340 --> 00:12:46.160\nSo it's just when we see\na parameter followed by a string or\n\n225\n00:12:46.160 --> 00:12:49.260\ninput of some sort and\nthey're not surrounded by square brackets.\n\n226\n00:12:49.260 --> 00:12:50.100\nThat's when they're required.\n\n227\n00:12:52.359 --> 00:12:56.710\nAll right, so that was the synopsis,\nthe description of the command.\n\n228\n00:12:56.710 --> 00:13:01.540\nThere's the syntax, the command line that\nwe're actually going to be typing in and\n\n229\n00:13:01.540 --> 00:13:03.970\nthen a detailed description.\n\n230\n00:13:03.970 --> 00:13:06.160\nThe synopsis is designed\nto be a short summary.\n\n231\n00:13:06.160 --> 00:13:09.140\nLike a one sentence type thing,\nalthough sometimes it's longer.\n\n232\n00:13:09.140 --> 00:13:13.190\nThe description, on the other hand,\nit might be a paragraph like this one is,\n\n233\n00:13:13.190 --> 00:13:15.390\nit might actually be several pages.\n\n234\n00:13:15.390 --> 00:13:17.480\nThere's a few of them,\nlike the time server commands,\n\n235\n00:13:17.480 --> 00:13:21.460\nthat are really, really long,\nbased on whatever it is that command does.\n\n236\n00:13:21.460 --> 00:13:24.570\nSo it may be a huge description,\nit may be very brief like this one.\n\n237\n00:13:24.570 --> 00:13:27.990\nThis one just giving us a detailed\nexplanation of what happens.\n\n238\n00:13:27.990 --> 00:13:33.700\nAnd then the last part that it displays\nare the related links and remarks.\n\n239\n00:13:33.700 --> 00:13:36.711\nThe related links are other websites or\n\n240\n00:13:36.711 --> 00:13:40.630\nother commandlets that we might want\nto look at that are related to this.\n\n241\n00:13:40.630 --> 00:13:43.220\nAnd the remarks are just other comments.\n\n242\n00:13:43.220 --> 00:13:45.700\nIn this case, the comments happen\nto be some examples, right,\n\n243\n00:13:45.700 --> 00:13:47.510\nbut they aren't always examples.\n\n244\n00:13:48.700 --> 00:13:51.140\nYou know what, actually, this one's\ntelling us how to get the examples.\n\n245\n00:13:51.140 --> 00:13:54.090\nBut the remarks can be anything that\n\n246\n00:13:54.090 --> 00:13:57.130\nthe author of this command help\nfile decided to put in there.\n\n247\n00:13:57.130 --> 00:13:59.088\nI mean, they could put all sorts of stuff.\n\n248\n00:13:59.088 --> 00:14:02.230\nBut, on related links,\nthe online information here,\n\n249\n00:14:02.230 --> 00:14:04.810\nthat's telling us where to go and\nget the help file on the website.\n\n250\n00:14:04.810 --> 00:14:08.840\nAnd then here are other\ncommands related to this one.\n\n251\n00:14:08.840 --> 00:14:12.650\nStop a service, start a service,\nresume, or pause, suspend.\n\n252\n00:14:12.650 --> 00:14:16.420\nSo there's the different commands right\nthere that are related to this one.\n\n253\n00:14:16.420 --> 00:14:17.370\nAll good information.\n\n254\n00:14:18.800 --> 00:14:22.540\nBut, this is not the full help file.\n\n255\n00:14:22.540 --> 00:14:26.470\nThis is actually an abbreviated\nform of the help for this command.\n\n256\n00:14:26.470 --> 00:14:29.790\nMicrosoft is just showing us\nwhat's most commonly needed.\n\n257\n00:14:29.790 --> 00:14:35.560\nIf you want to see the full file,\nthe whole shebang, you can run Get-Help,\n\n258\n00:14:35.560 --> 00:14:40.210\nthe name of the command and\nyou can follow that up with -Full.\n\n259\n00:14:40.210 --> 00:14:43.930\nThat will show you the whole\nhelp documentation.\n\n260\n00:14:43.930 --> 00:14:49.140\nNow that help documentation is going to\nextend beyond one screen, almost always.\n\n261\n00:14:49.140 --> 00:14:53.140\nAnd so\nI usually pipe that into the more command.\n\n262\n00:14:53.140 --> 00:14:57.330\nAnd that way, every page, it'll stop and\nyou can hit space bar to advance it.\n\n263\n00:14:57.330 --> 00:14:58.310\nSo I'm going to do that.\n\n264\n00:14:59.600 --> 00:15:03.300\nAnd so here we see the name,\nsynopsis, syntax, the description.\n\n265\n00:15:03.300 --> 00:15:05.150\nSo far, things are the same.\n\n266\n00:15:05.150 --> 00:15:06.630\nBut now I've got parameters.\n\n267\n00:15:06.630 --> 00:15:07.140\nWhat is this?\n\n268\n00:15:07.140 --> 00:15:10.790\nWell, it's gonna take each and\nevery one of these parameters up here,\n\n269\n00:15:10.790 --> 00:15:12.280\nlike -Exclude.\n\n270\n00:15:12.280 --> 00:15:14.130\nWell, what does -Exclude do?\n\n271\n00:15:14.130 --> 00:15:15.710\nIt excludes something.\n\n272\n00:15:15.710 --> 00:15:16.850\nWhat is it excluding?\n\n273\n00:15:16.850 --> 00:15:20.440\nWell, we can look down here, and\nit'll tell us what it's excluding.\n\n274\n00:15:20.440 --> 00:15:21.810\nSo we can just scroll down until we find,\n\n275\n00:15:21.810 --> 00:15:25.320\nhere it is,\n-Exclude omits the specified services.\n\n276\n00:15:25.320 --> 00:15:27.610\nThe value of this parameter\nqualifies the name.\n\n277\n00:15:27.610 --> 00:15:31.710\nEnter a name element or a pattern,\nsuch as s, star, wildcards are permitted.\n\n278\n00:15:31.710 --> 00:15:35.010\nSo, if I want to restart all\nof my services, except for\n\n279\n00:15:35.010 --> 00:15:39.850\nthis one, I can do it, or\nany one that starts with S, or whatever.\n\n280\n00:15:39.850 --> 00:15:40.350\nWe can do that.\n\n281\n00:15:40.350 --> 00:15:43.510\nAnd then we'll see -Force, -Include.\n\n282\n00:15:43.510 --> 00:15:47.350\nIt's basically giving me the detailed\ninformation about each one and\n\n283\n00:15:47.350 --> 00:15:50.440\nit's also clarifying in black and\nwhite terms,\n\n284\n00:15:50.440 --> 00:15:53.290\nno room for argument,\nwhether it's required or not, right?\n\n285\n00:15:53.290 --> 00:15:55.210\nSo we get that information right here.\n\n286\n00:15:55.210 --> 00:15:58.101\nVery easy to tell whether we need it.\n\n287\n00:15:58.101 --> 00:16:02.415\nAll right, now beyond that We\nget some additional inputs.\n\n288\n00:16:02.415 --> 00:16:06.040\nThese are inputs, in other words,\nwhere it's getting the information from.\n\n289\n00:16:06.040 --> 00:16:09.360\nWhen we run restart dash service,\nwhere does it get it's data?\n\n290\n00:16:09.360 --> 00:16:11.090\nAnd, you're normally\ngoing to see two things.\n\n291\n00:16:11.090 --> 00:16:14.230\nYou're normally going to see this guy,\nsystem.string,\n\n292\n00:16:14.230 --> 00:16:19.960\nwhich is data that you've provided it or\nyou might see Service Controller, right?\n\n293\n00:16:19.960 --> 00:16:23.550\nWell, ServiceController, that's because\nthis is a restart service command.\n\n294\n00:16:23.550 --> 00:16:26.040\nOn other commands, you probably\nwon't see the ServiceController.\n\n295\n00:16:26.040 --> 00:16:30.290\nYou'll see whatever application, or\nservice or whatever it is process-wise,\n\n296\n00:16:30.290 --> 00:16:33.890\nthat is tied to that command that you're\nrunning but System.String is almost always\n\n297\n00:16:33.890 --> 00:16:37.930\nthere, because that's us, providing\ndata but you'll also see this line here.\n\n298\n00:16:37.930 --> 00:16:42.450\nYou can pipe a service object or a string\nthat contains a service name into it.\n\n299\n00:16:42.450 --> 00:16:45.030\nThat means this is a pipelineable command.\n\n300\n00:16:45.030 --> 00:16:47.920\nNot every commandlet supports pipelining,\nso\n\n301\n00:16:47.920 --> 00:16:50.500\nit's a good idea to double check that\nbefore we start to put it in use.\n\n302\n00:16:51.960 --> 00:16:53.490\nThat also gives us the output, right?\n\n303\n00:16:53.490 --> 00:16:56.110\nAnd the default output for this one none.\n\n304\n00:16:56.110 --> 00:16:59.950\nYou guys saw when I ran\nthe restart service DNS cache\n\n305\n00:16:59.950 --> 00:17:02.410\nit just moved me to another line and\nthat was it, I got no output,\n\n306\n00:17:02.410 --> 00:17:04.972\nno feedback whatsoever,\nthat's the default, right?\n\n307\n00:17:04.972 --> 00:17:08.630\nAnd then it says or\nservice process server controller.\n\n308\n00:17:08.630 --> 00:17:10.680\nIt's just telling the service\ncontroller that it's done.\n\n309\n00:17:12.510 --> 00:17:13.170\nAlright.\n\n310\n00:17:13.170 --> 00:17:16.760\nBeyond that we get notes and\nthe notes are really valuable.\n\n311\n00:17:16.760 --> 00:17:20.160\nThis is where whoever authored\nthis command help file,\n\n312\n00:17:20.160 --> 00:17:25.340\ndecided to put examples,\nother information, anecdotes,\n\n313\n00:17:25.340 --> 00:17:27.390\nthere's all sorts of crazy\nstuff to be found in here.\n\n314\n00:17:27.390 --> 00:17:29.510\nAnd these are normally\nreally easy to read.\n\n315\n00:17:29.510 --> 00:17:31.371\nThey're written in plain english and\nthey kind of explain and\n\n316\n00:17:31.371 --> 00:17:32.133\ngive you some examples.\n\n317\n00:17:32.133 --> 00:17:35.595\nSo here they're showing,\nrestart-service winmgmt,\n\n318\n00:17:35.595 --> 00:17:39.285\nand it's just telling us that\nthis is gonna restart the WMI.\n\n319\n00:17:39.285 --> 00:17:40.910\nAnd then there's example two.\n\n320\n00:17:40.910 --> 00:17:45.040\nAnd they're just laying out a couple\nof different examples of how to\n\n321\n00:17:45.040 --> 00:17:49.900\nuse this command then we get to our\nrelated links and that's the end of it.\n\n322\n00:17:49.900 --> 00:17:53.370\nSo quite a bit of information\nin the full help file.\n\n323\n00:17:54.640 --> 00:17:56.830\nNow for me, I'm normally in a hurry.\n\n324\n00:17:56.830 --> 00:17:59.640\nIf I'm having to pull up help for\na command, I need to run it.\n\n325\n00:17:59.640 --> 00:18:00.210\nI'm in a hurry.\n\n326\n00:18:00.210 --> 00:18:03.640\nI don't have time to sift through\nthis whole help documentation.\n\n327\n00:18:03.640 --> 00:18:05.940\nI just need to see some examples.\n\n328\n00:18:05.940 --> 00:18:09.230\nI'm guilty of this,\njust give me the examples and let me go.\n\n329\n00:18:09.230 --> 00:18:13.550\nWell, when we run get-help,\nwe can tack onto that,\n\n330\n00:18:13.550 --> 00:18:16.630\ninstead of -full,\nthere's a few other options.\n\n331\n00:18:16.630 --> 00:18:21.320\nSo we can say like -examples and\nwhen you run that, so\n\n332\n00:18:21.320 --> 00:18:27.820\nI can get-help restart-service-examples\nit cuts out the rest.\n\n333\n00:18:27.820 --> 00:18:31.720\nWe see the name and the synopsis and\nthen it just cuts right to the examples,\n\n334\n00:18:31.720 --> 00:18:32.660\nthe notes.\n\n335\n00:18:32.660 --> 00:18:34.050\nAnd I get that information right there.\n\n336\n00:18:34.050 --> 00:18:36.911\nAnd the reason I'll do that a lot\nof times is because I'm probably\n\n337\n00:18:36.911 --> 00:18:39.510\nnot doing something crazy and\nout of the ordinary.\n\n338\n00:18:39.510 --> 00:18:42.594\nI'm probably doing something that is\na standard use case for Microsoft.\n\n339\n00:18:42.594 --> 00:18:46.515\nAnd so the odds are they've got the exact\nsyntax that I need right there.\n\n340\n00:18:46.515 --> 00:18:49.360\nAnd if I just need a quick refresher.\n\n341\n00:18:49.360 --> 00:18:50.360\nI know how the command works,\n\n342\n00:18:50.360 --> 00:18:53.470\nI just need a quick refresher\nthe examples work out really well.\n\n343\n00:18:53.470 --> 00:18:58.520\nSo -full that gave me the whole\ndocumentation -examples,\n\n344\n00:18:58.520 --> 00:19:02.410\nthat took me right to the examples and\ngave me a much more concise view.\n\n345\n00:19:04.350 --> 00:19:07.170\nThere's another little option\nthat I kind of like which is,\n\n346\n00:19:07.170 --> 00:19:13.333\nwhen we use get-dash-help with a command,\nyou can add the dash show window command.\n\n347\n00:19:13.333 --> 00:19:13.880\nAll right.\n\n348\n00:19:13.880 --> 00:19:18.620\nShow window is kind of neat because\nsometimes I want to have the documentation\n\n349\n00:19:18.620 --> 00:19:23.700\non my screen and have the power\nshell on my screen at the same time.\n\n350\n00:19:23.700 --> 00:19:25.290\nWell, if I'm using the TechNet website,\n\n351\n00:19:25.290 --> 00:19:28.050\nif I'm using the web-based help,\nI can do that, right?\n\n352\n00:19:28.050 --> 00:19:31.430\nI can pull it up in a web browser, stick\nthat on one side of my screen and go but\n\n353\n00:19:31.430 --> 00:19:34.590\nif I don't have an internet connection,\nI can't use the web browser.\n\n354\n00:19:34.590 --> 00:19:39.440\nWell, -ShowWindow, what does is it\ntakes my help documentation and\n\n355\n00:19:39.440 --> 00:19:40.980\nputs it in its own window.\n\n356\n00:19:40.980 --> 00:19:44.590\nAnd when you run that,\nnow we get this separate window, and\n\n357\n00:19:44.590 --> 00:19:47.050\nthere's my documentation right there.\n\n358\n00:19:47.050 --> 00:19:48.110\nI can take it.\n\n359\n00:19:48.110 --> 00:19:49.490\nMove it off to the side of my screen.\n\n360\n00:19:49.490 --> 00:19:54.100\nI can move my PowerShell over here\nwhich is not gonna snap, there we go.\n\n361\n00:19:54.100 --> 00:19:56.220\nSo I can move my PowerShell over here and\n\n362\n00:19:56.220 --> 00:20:01.170\nnow I can be looking at the documentation\nwhile I'm working with the command.\n\n363\n00:20:01.170 --> 00:20:04.920\nAnd the show window command, see how\nit automatically defaulted to full.\n\n364\n00:20:04.920 --> 00:20:07.120\nThey figure, hey if you're\ngonna be in a separate window,\n\n365\n00:20:07.120 --> 00:20:09.370\nyou might as well show\nthe full documentation.\n\n366\n00:20:09.370 --> 00:20:12.757\nAnd they give you this awesome find\nfeature right here at the top.\n\n367\n00:20:12.757 --> 00:20:16.237\nSo, when I pulled up the full,\nif I just wanna learn about excluded,\n\n368\n00:20:16.237 --> 00:20:20.137\nI can type it in and now it's gonna show\nme all the information for excluded and\n\n369\n00:20:20.137 --> 00:20:22.123\nI can scroll right through and find it.\n\n370\n00:20:22.123 --> 00:20:25.593\nThere's the syntax and\nthen I can jump down here and\n\n371\n00:20:25.593 --> 00:20:29.910\nI can see where they're using\nit in the example right here.\n\n372\n00:20:29.910 --> 00:20:33.540\nWe wanna restart services,\nany services starts with net and\n\n373\n00:20:33.540 --> 00:20:35.340\nwe wanna exclude net logoff, right?\n\n374\n00:20:35.340 --> 00:20:39.530\nSo I see that example, and now I can\ngo over here and start to type it.\n\n375\n00:20:39.530 --> 00:20:40.817\nSo -ShowWindow is a pretty\nneat one to have available.\n\n376\n00:20:44.169 --> 00:20:46.485\nAll right, that's a pretty neat one.\n\n377\n00:20:46.485 --> 00:20:50.910\nThere are a few other things that\nwe can do with the help system.\n\n378\n00:20:50.910 --> 00:20:52.027\nSo far we've been looking at get-help.\n\n379\n00:20:52.027 --> 00:20:55.928\nAnd I talked about update-help to\nmake sure we've got the help files.\n\n380\n00:20:55.928 --> 00:21:02.130\nAnd those are all pretty common, pretty\nstandard things that we need to have.\n\n381\n00:21:02.130 --> 00:21:09.260\nSome of the other things that we might\nwanna do, I did -full, we did -examples.\n\n382\n00:21:09.260 --> 00:21:10.718\nThere's -detailed.\n\n383\n00:21:10.718 --> 00:21:12.658\nAll right.\nNow, not every command has -detailed.\n\n384\n00:21:12.658 --> 00:21:15.075\nLet's see if restart service does.\n\n385\n00:21:15.075 --> 00:21:20.703\nSo I'm going to do get-help\nRestart-service-detailed.\n\n386\n00:21:20.703 --> 00:21:23.391\nAnd when I run that,\non many of the commands\n\n387\n00:21:23.391 --> 00:21:27.349\nit'll actually be the same as full but\non some of the commands,\n\n388\n00:21:27.349 --> 00:21:32.506\ndetailed will have some additional\ninformation that's useful for developers,\n\n389\n00:21:32.506 --> 00:21:37.685\npeople who are using API interfaces to be\nable to reach in and manage the commands.\n\n390\n00:21:37.685 --> 00:21:40.476\nOn this one, yeah, if you look at it here,\n\n391\n00:21:40.476 --> 00:21:45.599\nit's not really any different than the\nfull output on this one but if we browsed\n\n392\n00:21:45.599 --> 00:21:51.320\naround I'm sure we could stumble upon\na command sooner or later that had it.\n\n393\n00:21:51.320 --> 00:21:57.050\nBut basically the full usually\ngives us everything right here.\n\n394\n00:21:57.050 --> 00:21:59.350\nAll right, I think that's about it.\n\n395\n00:21:59.350 --> 00:22:03.390\nThere's one other thing that is kind\nof handy to mention on this one.\n\n396\n00:22:03.390 --> 00:22:06.540\nThere is an alias for get -help, but\n\n397\n00:22:06.540 --> 00:22:09.020\nit's a little bit different\nthan a normal alias.\n\n398\n00:22:09.020 --> 00:22:10.630\nNormally we do an alias.\n\n399\n00:22:10.630 --> 00:22:15.580\nWe create an alias as a name and\nthe name just ties to a commandlet and\n\n400\n00:22:15.580 --> 00:22:16.940\nthat's basically it.\n\n401\n00:22:16.940 --> 00:22:19.660\nWell, the alias in this case is help.\n\n402\n00:22:19.660 --> 00:22:22.230\nHelp is mapped to get -help.\n\n403\n00:22:22.230 --> 00:22:25.850\nSo, if I wanted help for this file I could\nactually use the help command to do it.\n\n404\n00:22:25.850 --> 00:22:26.960\nLet me show you.\n\n405\n00:22:26.960 --> 00:22:31.990\nSo, if I do get -help,\nlet me start at the start of the screen.\n\n406\n00:22:31.990 --> 00:22:37.280\nSo I'll do \"get-help\" for\n\"restart-service\".\n\n407\n00:22:37.280 --> 00:22:40.730\nWhen I run that, it was more information\nthan what fit on the screen so\n\n408\n00:22:40.730 --> 00:22:42.800\nit scrolled of the top but I got my help.\n\n409\n00:22:42.800 --> 00:22:45.040\nThat was the full version of the command.\n\n410\n00:22:45.040 --> 00:22:49.530\nWell, if I run help restart-service.\n\n411\n00:22:51.080 --> 00:22:56.460\nHelp is an alias of get -help, but\nwhen I run it, notice what it did.\n\n412\n00:22:56.460 --> 00:22:59.660\nIt puts the more command in by default.\n\n413\n00:22:59.660 --> 00:23:04.170\nWhen you use the help alias it\nautomatically applies a pipeline into\n\n414\n00:23:04.170 --> 00:23:06.880\nthe more command and now it's paginated.\n\n415\n00:23:06.880 --> 00:23:09.090\nAll right, so\nit's not like a normal alias.\n\n416\n00:23:09.090 --> 00:23:11.870\nA normal alias is just\na name to a commandlet, and\n\n417\n00:23:11.870 --> 00:23:14.130\nit doesn't modify the functionality\nof that commandlet at all.\n\n418\n00:23:14.130 --> 00:23:18.470\nIt's just a name being mapped but,\nin this case, it's a name being mapped and\n\n419\n00:23:18.470 --> 00:23:20.170\nit applies the more command.\n\n420\n00:23:20.170 --> 00:23:23.210\nSo, pretty handy if you can just\nwanna quickly view a help file,\n\n421\n00:23:23.210 --> 00:23:26.750\nyou can use that but\nthere's some limitations to it,\n\n422\n00:23:26.750 --> 00:23:30.930\nyou know, as far as it just\ndefaults to that base example.\n\n423\n00:23:30.930 --> 00:23:35.460\nIf I did -examples after it,\nit can jump in and\n\n424\n00:23:35.460 --> 00:23:38.480\nnow we've got that or we can do -full.\n\n425\n00:23:38.480 --> 00:23:41.240\nRight, so it still accepts those\ncommand line modifiers, and\n\n426\n00:23:41.240 --> 00:23:44.690\nit applies the more pagination for\nme, so that can be pretty handy.\n\n427\n00:23:44.690 --> 00:23:49.354\nSo take advantage of that alias,\nit's a pretty cool one.\n\n428\n00:23:49.354 --> 00:23:51.838\nAll right, but other than that,\nthat is about it.\n\n429\n00:23:51.838 --> 00:23:56.129\nThe only other things worth mentioning\nhere is that when you get-help One of\n\n430\n00:23:56.129 --> 00:23:58.757\nthe really handy things\nis Tab autocomplete.\n\n431\n00:23:58.757 --> 00:24:02.240\nWhen you start to type a command inside\nof the PowerShell, you can hit Tab and\n\n432\n00:24:02.240 --> 00:24:04.590\nit'll try and\nguess what command you were typing.\n\n433\n00:24:04.590 --> 00:24:07.195\nAnd if it guesses wrong,\nyou just keep hitting Tab over and\n\n434\n00:24:07.195 --> 00:24:08.749\nover again until it gets it right.\n\n435\n00:24:08.749 --> 00:24:13.187\nSo for example, earlier I tried\nto do Restart-Service DnsClient,\n\n436\n00:24:13.187 --> 00:24:17.775\nbut the name of, it was actually DnsCache,\nand if I didn't know that,\n\n437\n00:24:17.775 --> 00:24:21.770\nI could try and guess, I could try and\nstumble my way through.\n\n438\n00:24:21.770 --> 00:24:22.830\nLet me show you what I mean.\n\n439\n00:24:22.830 --> 00:24:27.519\nSo, if I run Get-Help, and then, Get-Dns,\n\n440\n00:24:27.519 --> 00:24:31.050\nand I can't remember is it client?\n\n441\n00:24:31.050 --> 00:24:31.990\nIs it cash?\n\n442\n00:24:31.990 --> 00:24:37.309\nI can hit Tab and my Tab autocomplete\nis gonna try and guess the command.\n\n443\n00:24:37.309 --> 00:24:39.569\nAnd so, I'll see there is, DnsClient.\n\n444\n00:24:39.569 --> 00:24:41.330\nThere's DnsClientCache.\n\n445\n00:24:41.330 --> 00:24:43.930\nSo, it's got a couple of different\nones that it'll scroll through and\n\n446\n00:24:43.930 --> 00:24:45.130\nshow me those different options.\n\n447\n00:24:45.130 --> 00:24:46.890\nSo, you can use Tab autocomplete.\n\n448\n00:24:46.890 --> 00:24:50.010\nYou can also do things like wildcards.\n\n449\n00:24:50.010 --> 00:24:55.370\nIf you do Get-Help, Get-Dns*, it doesn't\ngive you the full help for everyone.\n\n450\n00:24:55.370 --> 00:24:56.750\nWell, not that you can see.\n\n451\n00:24:56.750 --> 00:25:00.487\nWhat it's actually doing is it's\nputting it in a table so that I can\n\n452\n00:25:00.487 --> 00:25:04.910\nsee each of the commands, and the help\nis actually being displayed over here.\n\n453\n00:25:04.910 --> 00:25:06.980\nIt's just in a table, so I don't know it.\n\n454\n00:25:06.980 --> 00:25:12.080\nIf I did this same command and I pipe\nthat into the format-list commandlet,\n\n455\n00:25:12.080 --> 00:25:17.010\nwhich you can abbreviate to fl if\nyou want but I'll do format-list.\n\n456\n00:25:17.010 --> 00:25:19.960\nWhen I run that,\nit's displaying the help file for\n\n457\n00:25:19.960 --> 00:25:23.320\nevery one of those commands in line.\n\n458\n00:25:23.320 --> 00:25:26.480\nAnd that may or\nmay not be what I actually want.\n\n459\n00:25:26.480 --> 00:25:30.140\nYou can actually cause a little bit of\ntrouble with that if you're not careful.\n\n460\n00:25:30.140 --> 00:25:31.780\nSo, not terribly useful, but\n\n461\n00:25:31.780 --> 00:25:36.110\nI'll use it sometimes to find the commands\njust to figure out what I'm looking for.\n\n462\n00:25:36.110 --> 00:25:40.530\nBut I'll usually use Get-Command to do it,\nbecause when you do Get-Help,\n\n463\n00:25:40.530 --> 00:25:42.460\nit's actually loading those help files.\n\n464\n00:25:42.460 --> 00:25:44.529\nDid you see the green bar\nthat flashed by on my screen?\n\n465\n00:25:44.529 --> 00:25:46.509\nIt was real fast, but it still did it.\n\n466\n00:25:46.509 --> 00:25:50.629\nIt had to query those help files,\nand that can take a little\n\n467\n00:25:50.629 --> 00:25:55.546\nwhile if you did an excessively\nlarge query, versus Get-Command.\n\n468\n00:25:55.546 --> 00:25:59.480\nAnd then here, I could do Get-Dns*, right?\n\n469\n00:25:59.480 --> 00:26:03.160\nWhen I run that, I didn't get that green\nbar flashing by, and that's cuz I wasn't\n\n470\n00:26:03.160 --> 00:26:06.750\nloading the help files,\nit was just pulling the command list.\n\n471\n00:26:06.750 --> 00:26:10.490\nSo, I usually use Get-Command instead\nof Get-Help to search for commands.\n\n472\n00:26:10.490 --> 00:26:11.850\nAll right.\n\n473\n00:26:11.850 --> 00:26:16.089\nOther than that, that's basically how\nwe can pull help from the PowerShell.\n\n474\n00:26:16.089 --> 00:26:16.849\nIt's really useful.\n\n475\n00:26:16.849 --> 00:26:19.778\nIt's nice to have that inline\ncommand help available for\n\n476\n00:26:19.778 --> 00:26:21.190\nus to be able to get to that.\n\n477\n00:26:21.190 --> 00:26:23.698\nMore often than not though, I like\nto rely on the TechNet pages because\n\n478\n00:26:23.698 --> 00:26:25.370\nthey've got a lot of\ngood information there.\n\n479\n00:26:25.370 --> 00:26:27.360\nIt's fully searchable, really handy.\n\n480\n00:26:27.360 --> 00:26:30.300\nThere's some good web\npages in the TechNet site\n\n481\n00:26:30.300 --> 00:26:33.580\nthat will give you all sorts of\nPowerShell examples and new scenarios.\n\n482\n00:26:33.580 --> 00:26:35.390\nDefinitely good stuff there.\n\n483\n00:26:35.390 --> 00:26:37.940\nBut, if you're in a hurry,\nif you don't have internet access,\n\n484\n00:26:37.940 --> 00:26:40.690\nthe help that's imbedded in the module,\nit's pretty handy.\n\n485\n00:26:40.690 --> 00:26:42.362\nYou should definitely use it.\n\n486\n00:26:42.362 --> 00:26:45.482\nAll right, well, that's about it for\nthe help documentation.\n\n487\n00:26:45.482 --> 00:26:46.523\nI hope you guys enjoyed the segment.\n\n488\n00:26:46.523 --> 00:26:47.521\nStay tuned.\n\n489\n00:26:47.521 --> 00:26:50.301\nWe've got more PowerShell coming up.\n\n490\n00:26:50.301 --> 00:26:54.640\n[SOUND]\n\n",
          "vimeoId": "113925056"
        },
        {
          "description": "",
          "length": "1107",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-7-piping-command-output-120214.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-7-piping-command-output-120214-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-7-piping-command-output-120214-sm.jpg",
          "title": "Piping Command Output",
          "transcript": "1\n00:00:00,000 --> 00:00:08,135\n[MUSIC]\n\n2\n00:00:08,135 --> 00:00:12,755\nIn this segment we're gonna take a look at\npiping command output from one command to\n\n3\n00:00:12,755 --> 00:00:14,042\nanother.\n\n4\n00:00:14,042 --> 00:00:17,080\nIn PowerShell we have what's\ncalled the command pipeline.\n\n5\n00:00:17,080 --> 00:00:21,470\nAnd what that means is that when we run\na command we may want to do additional\n\n6\n00:00:21,470 --> 00:00:24,500\nthings with the output other\nthan just look at it, right?\n\n7\n00:00:24,500 --> 00:00:29,130\nThe traditional command pipeline that we\nhave is you run a command and something\n\n8\n00:00:29,130 --> 00:00:32,600\ngets displayed on the screen and you look\nat it with your eyeballs and that's it.\n\n9\n00:00:32,600 --> 00:00:35,420\nRight.\nThat's our command pipeline normally.\n\n10\n00:00:35,420 --> 00:00:41,110\nBut sometimes we want to take\nthe results of one command and\n\n11\n00:00:41,110 --> 00:00:43,090\nfeed it into another command.\n\n12\n00:00:43,090 --> 00:00:47,690\nSo the output from one command\nbecomes the input for another command.\n\n13\n00:00:47,690 --> 00:00:48,900\nAll right.\n\n14\n00:00:48,900 --> 00:00:51,430\nYou can use this for\na number of different things.\n\n15\n00:00:51,430 --> 00:00:56,990\nFor example, you might want to\nrestart certain services but\n\n16\n00:00:56,990 --> 00:00:59,030\nyou don't necessarily know\nwhat those services are.\n\n17\n00:00:59,030 --> 00:01:03,960\nSo you might use a Get-Service command,\nor something like that, to query for\n\n18\n00:01:03,960 --> 00:01:08,950\ncertain services, and it makes a list,\nand you take that output, and feed that\n\n19\n00:01:08,950 --> 00:01:12,440\nright back into the Restart-Service\ncommand, right, that commandlet.\n\n20\n00:01:12,440 --> 00:01:15,460\nAnd it takes the output\nfrom the first command,\n\n21\n00:01:15,460 --> 00:01:18,670\nuses it as input on the second command,\nand takes action on it.\n\n22\n00:01:18,670 --> 00:01:22,630\nAnd you can even pipeline\nseveral layers deep if you want.\n\n23\n00:01:22,630 --> 00:01:25,350\nNow a lot of us do this even\nwithout thinking about it, and\n\n24\n00:01:25,350 --> 00:01:27,120\nlet me give you an example.\n\n25\n00:01:27,120 --> 00:01:30,350\nActually, let me get into a PowerShell\nhere before I give you an example.\n\n26\n00:01:30,350 --> 00:01:35,330\nAll right, so\nif I take something like Get-Service.\n\n27\n00:01:35,330 --> 00:01:35,830\nRight?\n\n28\n00:01:35,830 --> 00:01:39,790\nWhen I run Get-Service,\nit gives me a list of all of the services.\n\n29\n00:01:39,790 --> 00:01:40,340\nAll right?\n\n30\n00:01:40,340 --> 00:01:43,230\nWell, there was more than\nwhat fit on my screen.\n\n31\n00:01:43,230 --> 00:01:45,050\nAnd, that can be a little excessive.\n\n32\n00:01:45,050 --> 00:01:46,280\nRight?\nIt's just way more.\n\n33\n00:01:46,280 --> 00:01:48,160\nI can scroll back and find things.\n\n34\n00:01:48,160 --> 00:01:52,170\nBut, I might want to add\npagination to that, right?\n\n35\n00:01:52,170 --> 00:01:54,350\nPagination, that just\nmeans every 24 lines,\n\n36\n00:01:54,350 --> 00:01:57,030\nput in a stop that says\nPress any key to continue.\n\n37\n00:01:58,150 --> 00:02:02,520\nAnd the easiest way to do that is to\ntake the output from Get-Service,\n\n38\n00:02:02,520 --> 00:02:07,169\nand feed that into another command,\nthe more commandlet.\n\n39\n00:02:07,169 --> 00:02:14,040\nAll right?\nAnd more is a built in part of the system.\n\n40\n00:02:14,040 --> 00:02:15,940\nSee how it's not an alias for anything.\n\n41\n00:02:15,940 --> 00:02:20,450\nMore is a command that's been\na part of Windows and DOS forever.\n\n42\n00:02:20,450 --> 00:02:23,500\nAnd it just adds that\npagination to a screen.\n\n43\n00:02:23,500 --> 00:02:28,360\nSo if I wanna use it,\nI can say Get-Service, and\n\n44\n00:02:28,360 --> 00:02:30,375\nthen I can use the | symbol.\n\n45\n00:02:30,375 --> 00:02:35,010\nNow the | symbol, it's a little weird\nthe way that it's rendered on the screen.\n\n46\n00:02:35,010 --> 00:02:40,140\nIt's actually two vertical lines,\none on top of the other.\n\n47\n00:02:40,140 --> 00:02:44,320\nWhen you look on screen, it looks like one\nvertical line, but it is actually two.\n\n48\n00:02:44,320 --> 00:02:46,700\nAnd if you look on your keyboard,\nit's typically two.\n\n49\n00:02:46,700 --> 00:02:50,200\nAnd you know I say that as I look at my\nkeyboard where it's a solid, single one.\n\n50\n00:02:50,200 --> 00:02:52,575\nOn a normal, 110-key or\n\n51\n00:02:52,575 --> 00:02:57,650\n104-key Windows keyboard it'll be two\nvertical lines, one on top of the other.\n\n52\n00:02:57,650 --> 00:03:01,710\nAnd it's typically located right\nabove your Enter key, or Return.\n\n53\n00:03:01,710 --> 00:03:03,870\nIt'll be right above that or\nright beneath your Backspace key.\n\n54\n00:03:03,870 --> 00:03:04,920\nIt doesn't have to be.\n\n55\n00:03:04,920 --> 00:03:06,850\nYour keyboard might\nhave it somewhere else.\n\n56\n00:03:06,850 --> 00:03:11,080\nBut it's usually there and\nit's usually the backslash key too.\n\n57\n00:03:11,080 --> 00:03:14,320\nSo you have to hold Shift to\nget it to get that pipe symbol.\n\n58\n00:03:14,320 --> 00:03:18,180\nBut all the pipe symbol says\nis it's telling PowerShell,\n\n59\n00:03:18,180 --> 00:03:22,460\nas of this symbol,\neverything to the left is one command.\n\n60\n00:03:22,460 --> 00:03:24,200\nRun it.\n\n61\n00:03:24,200 --> 00:03:27,610\nRun it, and instead of displaying\nthe output on the screen,\n\n62\n00:03:28,910 --> 00:03:35,030\nfeed the output as input into whatever I\ntype on the other side of this pipe symbol\n\n63\n00:03:36,280 --> 00:03:40,340\nand then from there, take that output and\ndisplay that on the screen.\n\n64\n00:03:41,450 --> 00:03:44,342\nAnd the more command is one of\nthe most simple versions of that.\n\n65\n00:03:44,342 --> 00:03:47,070\nI'm gonna take the output\nof get dash service, and\n\n66\n00:03:47,070 --> 00:03:49,470\nI will pipe that into the more command.\n\n67\n00:03:50,810 --> 00:03:54,820\nWhen I run that, I get the same output\nI had a minute ago, but there's my\n\n68\n00:03:54,820 --> 00:03:59,600\nmore prompt, and I can press a key and\nI can advance at my leisure, all right?\n\n69\n00:03:59,600 --> 00:04:02,340\nNow, that one's not too\nterribly spectacular,\n\n70\n00:04:02,340 --> 00:04:04,350\nthere's other ones that\nare a little more impressive.\n\n71\n00:04:05,510 --> 00:04:10,220\nOne of my problems here with Get-Service\nis that it displays a lot of stuff, right?\n\n72\n00:04:10,220 --> 00:04:13,910\nAnd I see these three columns,\nstatus, name, display name.\n\n73\n00:04:13,910 --> 00:04:16,437\nBut there's actually more [COUGH],\nexcuse me,\n\n74\n00:04:16,437 --> 00:04:21,210\nmore to each of those services than\nwhat's being displayed on the screen.\n\n75\n00:04:21,210 --> 00:04:24,170\nSo what if I wanna see that other stuff?\n\n76\n00:04:24,170 --> 00:04:28,750\nWell, there's another command\ncalled Format-List that will help\n\n77\n00:04:28,750 --> 00:04:30,300\nme see that other stuff.\n\n78\n00:04:30,300 --> 00:04:36,638\nAnd so, I can pipe the output\nof Get-Service into Format-List.\n\n79\n00:04:36,638 --> 00:04:38,949\nBut the output for Format-List,\n\n80\n00:04:38,949 --> 00:04:43,020\n[COUGH] it's gonna be even longer\nthan what I originally had.\n\n81\n00:04:44,370 --> 00:04:46,662\nSo, I might want to pipe that\ninto another command too.\n\n82\n00:04:46,662 --> 00:04:50,410\nI might wanna pipe that more.\n\n83\n00:04:50,410 --> 00:04:53,020\nNow, I'm doing three stages.\n\n84\n00:04:53,020 --> 00:04:56,990\nCommand one, the output becomes input for\ncommand two.\n\n85\n00:04:56,990 --> 00:05:00,510\nCommand two runs, and the output for\ncommand two becomes the input for\n\n86\n00:05:00,510 --> 00:05:01,420\ncommand three.\n\n87\n00:05:01,420 --> 00:05:03,950\nYou can pipeline as\nmany times as you want.\n\n88\n00:05:03,950 --> 00:05:05,520\nAll right, these are nested commands.\n\n89\n00:05:05,520 --> 00:05:07,410\nTheir gonna run one after the other,\n\n90\n00:05:07,410 --> 00:05:10,810\neach one building off of\nthe output of the previous one.\n\n91\n00:05:10,810 --> 00:05:15,310\nSo, pretty important process here cuz we\ncan really use this to create some power.\n\n92\n00:05:15,310 --> 00:05:18,480\nAnd when I run this, well, actually,\nlet me run it without the more command.\n\n93\n00:05:18,480 --> 00:05:19,268\nI'll just run it like this.\n\n94\n00:05:19,268 --> 00:05:21,400\nGet-Service | Format-List.\n\n95\n00:05:21,400 --> 00:05:24,970\nAnd when I run it,\nthat's a lot of information.\n\n96\n00:05:24,970 --> 00:05:28,370\nI see the additional columns that I\ncouldn't see in the table a minute ago.\n\n97\n00:05:28,370 --> 00:05:32,170\nSure, I get Name, DisplayName, and\nStatus, but now I see DependentServices,\n\n98\n00:05:32,170 --> 00:05:36,450\nServiceDescription, CanPause,\nCanShutdown, CanStop, and ServiceType.\n\n99\n00:05:36,450 --> 00:05:38,640\nA lot of additional stuff.\n\n100\n00:05:38,640 --> 00:05:41,790\nAnd if I pipe that into the more command.\n\n101\n00:05:43,620 --> 00:05:47,430\nNow, it's the same output but\npaginated, all right?\n\n102\n00:05:47,430 --> 00:05:50,020\nSo three commands involved in this.\n\n103\n00:05:50,020 --> 00:05:51,810\nThat's the glory of pipelining, right?\n\n104\n00:05:51,810 --> 00:05:53,370\nYou can pipeline over and over and\n\n105\n00:05:53,370 --> 00:05:58,440\nover again to create all sorts of\ninteresting output that matches your needs\n\n106\n00:05:58,440 --> 00:06:03,140\nthat may be very different than the output\nthat Microsoft normally gives you.\n\n107\n00:06:03,140 --> 00:06:06,070\nWe're going to do another segment later on\nwhere we'll talk about different ways to\n\n108\n00:06:06,070 --> 00:06:07,220\nformat output.\n\n109\n00:06:07,220 --> 00:06:10,390\nBut for right now I'm just using this to\nkind of demonstrate the different ways\n\n110\n00:06:10,390 --> 00:06:13,930\nthat we can feed the output\nof one command into another.\n\n111\n00:06:15,380 --> 00:06:16,160\nAll right.\n\n112\n00:06:16,160 --> 00:06:18,800\nSo that's a pretty basic\nexample of pipelining.\n\n113\n00:06:18,800 --> 00:06:22,180\nBut, I didn't really do anything\nwith the data that I got.\n\n114\n00:06:22,180 --> 00:06:26,080\nI ran a query, Get-Service,\ngive me all the services.\n\n115\n00:06:26,080 --> 00:06:28,860\nBut then, all I really did was\nchange the format of the output.\n\n116\n00:06:28,860 --> 00:06:30,110\nThat's not too fun.\n\n117\n00:06:30,110 --> 00:06:33,800\nBut you can actually take\nactions based on various things.\n\n118\n00:06:33,800 --> 00:06:39,930\nSo, for example, if I want to restart\nevery service that has to deal with dns.\n\n119\n00:06:39,930 --> 00:06:40,580\nAll right.\n\n120\n00:06:40,580 --> 00:06:42,480\nWell let me show you how we can do that.\n\n121\n00:06:42,480 --> 00:06:49,500\nIf I take Get-Service and\nI do *dns*, right?\n\n122\n00:06:49,500 --> 00:06:52,980\nIt's gonna show me every service\nthat has to do with dns.\n\n123\n00:06:52,980 --> 00:06:55,410\nWell, guess I picked a lame example\nwhere there's only one of those.\n\n124\n00:06:55,410 --> 00:06:58,880\n[LAUGH] So\nsome of them will have multiple services.\n\n125\n00:06:58,880 --> 00:06:59,520\nThis one just has one.\n\n126\n00:06:59,520 --> 00:07:01,600\nWhat would be a better one to pick?\n\n127\n00:07:01,600 --> 00:07:02,530\nI don't want to do RPC.\n\n128\n00:07:02,530 --> 00:07:03,960\nThat would be bad.\n\n129\n00:07:03,960 --> 00:07:06,940\nLet's just take a look at our screen here,\nsee if I can spot something.\n\n130\n00:07:09,110 --> 00:07:11,030\nI could do my virtual machine stuff.\n\n131\n00:07:11,030 --> 00:07:14,620\nI could do Windows Update stuff,\nthat could be fun.\n\n132\n00:07:14,620 --> 00:07:16,470\nSee how much trouble we can\ncause with Windows Update?\n\n133\n00:07:17,560 --> 00:07:21,660\nSo let me do a Get-Service for wu*.\n\n134\n00:07:21,660 --> 00:07:23,220\nThere, all right?\n\n135\n00:07:23,220 --> 00:07:27,230\nSo I've got two services, and they're both\nstopped, so that's not terribly exciting.\n\n136\n00:07:27,230 --> 00:07:29,170\nBut they're right there,\nand I can see these.\n\n137\n00:07:29,170 --> 00:07:31,260\nAnd I guess one of them's Windows Update.\n\n138\n00:07:31,260 --> 00:07:32,960\nThe other one is actually the user driver.\n\n139\n00:07:32,960 --> 00:07:33,520\nWell, whatever.\n\n140\n00:07:33,520 --> 00:07:34,430\nIt'll work for my example.\n\n141\n00:07:35,650 --> 00:07:39,240\nSo if I wanna restart both of those,\nwell I could take this output and\n\n142\n00:07:39,240 --> 00:07:46,089\nI could feed that into\nthe Restart-Service commandlet.\n\n143\n00:07:46,089 --> 00:07:46,974\nRight?\n\n144\n00:07:46,974 --> 00:07:50,600\nNow not every commandlet works with this.\n\n145\n00:07:50,600 --> 00:07:51,910\nAnd there's a reason for that.\n\n146\n00:07:51,910 --> 00:07:54,140\nThe output, here is a table.\n\n147\n00:07:54,140 --> 00:07:58,550\nIt's a table listing all of\nthe services that matched my query.\n\n148\n00:07:58,550 --> 00:08:01,110\nWell Restart-Service may or\n\n149\n00:08:01,110 --> 00:08:05,820\nmay not be set up to receive\na table as its input, all right?\n\n150\n00:08:05,820 --> 00:08:07,538\nDoesn't hurt to try.\nWe can give it a shot, but\n\n151\n00:08:07,538 --> 00:08:11,570\nif you get an error like I just did,\nwell that's what's telling me, hey,\n\n152\n00:08:11,570 --> 00:08:13,690\nI'm not set up to receive it like that.\n\n153\n00:08:13,690 --> 00:08:17,950\nI can't handle restarting more\nthan one service at the same time.\n\n154\n00:08:17,950 --> 00:08:19,350\nAll right.\n\n155\n00:08:19,350 --> 00:08:22,700\nWhen that happens,\nit doesn't mean that you can't pipeline,\n\n156\n00:08:22,700 --> 00:08:25,320\nit just means you have to do it\na slightly different way, all right?\n\n157\n00:08:25,320 --> 00:08:28,440\nSometimes, this'll work just fine, right?\n\n158\n00:08:28,440 --> 00:08:32,620\nThe command, your second command will\nsupport receiving a matrix or receiving\n\n159\n00:08:32,620 --> 00:08:37,470\na table in and it'll act on it and it will\nrestart you to the services or whatever.\n\n160\n00:08:37,470 --> 00:08:40,430\nBut other times, you get errors like this.\n\n161\n00:08:40,430 --> 00:08:45,660\nAnd we just have to modify our pipeline\nprocedure a little bit, to say take\n\n162\n00:08:45,660 --> 00:08:50,160\neach individual line of our\nfirst command's output and\n\n163\n00:08:50,160 --> 00:08:53,430\nfeed it into the second\ncommand one at a time.\n\n164\n00:08:53,430 --> 00:08:55,990\nIn other words,\nrun that second command once for\n\n165\n00:08:55,990 --> 00:08:58,760\nevery single line of that\nfirst command's output.\n\n166\n00:08:58,760 --> 00:09:00,860\nThis is a little bit more advanced, but\n\n167\n00:09:00,860 --> 00:09:03,380\nit's something that\nyou'll commonly run into.\n\n168\n00:09:03,380 --> 00:09:05,970\nSo if you get a bunch of error, like this.\n\n169\n00:09:05,970 --> 00:09:10,030\nActually, here looking at my errors, my\nerrors are actually tied more to the fact\n\n170\n00:09:10,030 --> 00:09:12,280\nthat I tried to stop services\nthat were already stopped.\n\n171\n00:09:12,280 --> 00:09:14,208\nSo let's try something valid here.\n\n172\n00:09:14,208 --> 00:09:18,610\nI'm just gonna stay start service cuz\nthey're both started, or, both stopped.\n\n173\n00:09:18,610 --> 00:09:20,360\nSo if I do start, oh,\nI got an error there.\n\n174\n00:09:20,360 --> 00:09:23,010\nCannot be started due\nto the following error,\n\n175\n00:09:24,110 --> 00:09:25,880\nservice controller error, and, am I, oh.\n\n176\n00:09:25,880 --> 00:09:27,640\nI'm not an administrator.\n\n177\n00:09:27,640 --> 00:09:28,870\nThat'll probably be my problem there.\n\n178\n00:09:28,870 --> 00:09:32,760\nSo let me jump over to a PowerShell\nwhere I'm running it as an admin,\n\n179\n00:09:32,760 --> 00:09:37,230\nand we'll see if that works for\nus a little bit better here.\n\n180\n00:09:38,570 --> 00:09:43,990\nAnd we'll find out here in a moment\nwhether or not that worked for us.\n\n181\n00:09:43,990 --> 00:09:48,810\nSo, there we go, Start-Service was\nperfectly happy receiving that table and\n\n182\n00:09:48,810 --> 00:09:49,530\nit dealt with it.\n\n183\n00:09:49,530 --> 00:09:50,180\nRight?\n\n184\n00:09:50,180 --> 00:09:52,425\nSo, I'm gonna go ahead and stop those,\n\n185\n00:09:52,425 --> 00:09:54,775\ncuz I just don't need them\nrunning during the show.\n\n186\n00:09:54,775 --> 00:09:55,785\nBut there we go.\n\n187\n00:09:55,785 --> 00:10:00,395\nIt's handling that table,\neven though it wouldn't normally do that.\n\n188\n00:10:00,395 --> 00:10:04,815\nNow if I have a command that just\noutright won't deal with the table.\n\n189\n00:10:04,815 --> 00:10:06,145\nI know this one got happy again, but\n\n190\n00:10:06,145 --> 00:10:10,305\nif it won't deal with the able, then I've\ngotta do what I was saying a minute ago.\n\n191\n00:10:10,305 --> 00:10:13,935\nRun that second command one at at time,\nover and over again, and\n\n192\n00:10:13,935 --> 00:10:15,330\nlet it do its job.\n\n193\n00:10:15,330 --> 00:10:19,170\nFor that we have to use another command,\nand then here is where we start to\n\n194\n00:10:19,170 --> 00:10:23,760\nget into a little bit of stuff that\na developer would normally work with.\n\n195\n00:10:23,760 --> 00:10:28,890\nWe have to create what is called a foreach\nloop and a foreach loop just says for\n\n196\n00:10:28,890 --> 00:10:34,020\neach line in our original output do this\ncommand and you're gonna loop through it\n\n197\n00:10:34,020 --> 00:10:37,180\nover and over and over again until you run\nout of lines to run and then you'll stop.\n\n198\n00:10:37,180 --> 00:10:38,270\nAll right.\n\n199\n00:10:38,270 --> 00:10:41,030\nSo, we just have to modify how that works.\n\n200\n00:10:41,030 --> 00:10:46,860\nAs an example, let's see,\nwhat would be a good example for this?\n\n201\n00:10:46,860 --> 00:10:47,595\nLet's see.\n\n202\n00:10:47,595 --> 00:10:48,916\nGet-process.\n\n203\n00:10:48,916 --> 00:10:54,100\nAll right, Get-Process will return to me\n\n204\n00:10:54,100 --> 00:10:57,760\na list of all the processes running\non my computer right now, okay.\n\n205\n00:10:57,760 --> 00:10:59,530\nSo there's all the processes.\n\n206\n00:10:59,530 --> 00:11:01,679\nBut it returns kind of\na lot of information.\n\n207\n00:11:02,980 --> 00:11:05,620\nSo, I see not just the processes,\nlike a process name.\n\n208\n00:11:05,620 --> 00:11:10,290\nI also see their IDs, I can see their\nvirtual memory, their CPU utilization.\n\n209\n00:11:10,290 --> 00:11:14,750\nI see tons of information about them,\nnot just a name.\n\n210\n00:11:14,750 --> 00:11:17,460\nWell maybe I do just want the name,\nand that's all I want.\n\n211\n00:11:17,460 --> 00:11:20,450\nWell, we'll learn some filter\ncommands that make that really easy.\n\n212\n00:11:20,450 --> 00:11:21,877\nBut there's another way\nthat I can pull it.\n\n213\n00:11:23,180 --> 00:11:28,430\nWhen you run Get-Process, that command\nruns, and this output comes out.\n\n214\n00:11:28,430 --> 00:11:32,830\nWe don't see it, but the output\nis actually stored in a variable.\n\n215\n00:11:34,000 --> 00:11:39,320\nSo PowerShell creates a variable\nautomatically and it's called $_.\n\n216\n00:11:39,320 --> 00:11:43,650\nIt's a temporary variable that's\nonly around while this command runs.\n\n217\n00:11:43,650 --> 00:11:47,350\nAnd when we take the output for\nour command, and we feed it into\n\n218\n00:11:47,350 --> 00:11:50,270\nthe next command, the next command's\nreally just looking for that variable.\n\n219\n00:11:50,270 --> 00:11:52,890\nIt's saying hey,\nis there anything in $_ underscore?\n\n220\n00:11:52,890 --> 00:11:56,030\nAnd if there is, that's the data\nthat I'm using as my input.\n\n221\n00:11:56,030 --> 00:11:57,680\nSo that's kinda what\nhappens in the background.\n\n222\n00:11:57,680 --> 00:11:59,260\nWe don't normally see it.\n\n223\n00:11:59,260 --> 00:12:06,040\nWell if I wanna pull just the names that\nare out of this list, well I could try it.\n\n224\n00:12:06,040 --> 00:12:11,570\nI could say Get-Process and\nI could pipe that into Write-Host,\n\n225\n00:12:11,570 --> 00:12:16,070\nwhich is a commandlet that displays\nthings on your screen, and\n\n226\n00:12:16,070 --> 00:12:20,320\nI could say $_ .name.\n\n227\n00:12:20,320 --> 00:12:26,139\nSo I'm saying write on my screen\nthe name value from inside of $_,\n\n228\n00:12:26,139 --> 00:12:32,780\nthat variable that's storing all\nthe data from my first command.\n\n229\n00:12:32,780 --> 00:12:37,280\nSo whenever you see that $_ it's almost\nalways used in a pipeline because it's\n\n230\n00:12:37,280 --> 00:12:39,870\nreferencing the output\nfrom the previous command.\n\n231\n00:12:39,870 --> 00:12:43,938\nNow, this is syntactically correct, but\n\n232\n00:12:43,938 --> 00:12:50,275\nthe problem here is Get-Process\nis gonna return a ton of entries.\n\n233\n00:12:50,275 --> 00:12:54,540\nBut Write-Host is expecting one thing.\n\n234\n00:12:54,540 --> 00:12:56,790\nIt's expecting a single string.\n\n235\n00:12:56,790 --> 00:12:58,060\nI'm about to give it a table.\n\n236\n00:12:58,060 --> 00:13:00,110\nIt's gonna get really upset about that.\n\n237\n00:13:00,110 --> 00:13:04,250\nAnd we do $_, that's referring\nto the whole table and the name.\n\n238\n00:13:04,250 --> 00:13:06,280\nWell, there's a name for\nall these different processes so\n\n239\n00:13:06,280 --> 00:13:09,120\nit's not gonna be too happy\nabout that when I run it.\n\n240\n00:13:09,120 --> 00:13:11,220\nHere, let's actually run it.\n\n241\n00:13:11,220 --> 00:13:12,450\nWhoops!\n\n242\n00:13:12,450 --> 00:13:13,890\nWell, shoot, that wasn't fair.\n\n243\n00:13:13,890 --> 00:13:17,300\nLet me [LAUGH] so I do it a second time.\n\n244\n00:13:17,300 --> 00:13:18,159\nLet me do this again.\n\n245\n00:13:18,159 --> 00:13:21,190\nI added an extra slash there by accident\nso let me just get that out of there.\n\n246\n00:13:21,190 --> 00:13:22,050\nThere we go.\n\n247\n00:13:22,050 --> 00:13:26,180\nSo if I run that, I get a ton of errors.\n\n248\n00:13:26,180 --> 00:13:27,880\nWhy am I getting a bunch of errors?\n\n249\n00:13:27,880 --> 00:13:32,220\nWell, the reason is it's trying\nto run this table of data,\n\n250\n00:13:32,220 --> 00:13:34,260\nwhich it's not set up to deal with.\n\n251\n00:13:34,260 --> 00:13:37,550\nAnd so, that's where it just gets\nreally upset and it lists it here.\n\n252\n00:13:37,550 --> 00:13:41,562\nAnd, if we read the actual error,\nyou can see right here,\n\n253\n00:13:41,562 --> 00:13:46,100\nWrite-Host : The input object cannot\nbe bound to any parameters for\n\n254\n00:13:46,100 --> 00:13:50,580\nthe command either because the command\ndoes not take pipeline input or\n\n255\n00:13:50,580 --> 00:13:53,400\nthe input and its properties do not match\nthe parameters to take pipeline input.\n\n256\n00:13:54,430 --> 00:13:55,760\nIt failed with a pipeline input.\n\n257\n00:13:56,840 --> 00:14:00,100\nSo here's where we can implement one of\nthese loops that I was talking about.\n\n258\n00:14:00,100 --> 00:14:04,418\nSo to fix this one, what we would\ndo is modify it a little bit.\n\n259\n00:14:04,418 --> 00:14:09,680\nInstead of Get-Process and\n\n260\n00:14:09,680 --> 00:14:12,880\nthen going right into Write-Host,\nI'm gonna bring in another command.\n\n261\n00:14:12,880 --> 00:14:19,250\nI'm gonna put in Foreach, whoops,\nI'm gonna spell for right.\n\n262\n00:14:19,250 --> 00:14:21,580\nThat'll be the start of success here.\n\n263\n00:14:21,580 --> 00:14:27,469\nSo ForEach-Object and\nthen in parenthesis or\n\n264\n00:14:27,469 --> 00:14:33,811\nsquiggly parenthesis I'm\ngonna say Write-Host\n\n265\n00:14:33,811 --> 00:14:38,800\n$_ .name and then I'll close that.\n\n266\n00:14:39,850 --> 00:14:40,400\nOkay.\n\n267\n00:14:40,400 --> 00:14:41,750\nOh, I lost my -Object.\n\n268\n00:14:41,750 --> 00:14:42,900\nLet me go fix that.\n\n269\n00:14:42,900 --> 00:14:45,070\nApparently I hit something\non the keyboard there.\n\n270\n00:14:45,070 --> 00:14:46,170\nThere we go.\n\n271\n00:14:46,170 --> 00:14:49,760\nSo what this is gonna say\nis the original command\n\n272\n00:14:49,760 --> 00:14:51,430\nis gonna output more\nthan one line of data.\n\n273\n00:14:51,430 --> 00:14:53,320\nI'm gonna have more than one entry.\n\n274\n00:14:53,320 --> 00:14:56,935\nSo, instead of running Write-Host\nagainst the whole thing,\n\n275\n00:14:56,935 --> 00:15:02,950\nForEach-Object, for each line in\nthe original output, run Write-Host once.\n\n276\n00:15:02,950 --> 00:15:07,760\nSo, if I've got 50 processes running, it's\ngonna run the Write-Host command 50 times,\n\n277\n00:15:08,850 --> 00:15:11,280\none for each line of the original output.\n\n278\n00:15:11,280 --> 00:15:15,800\nBut the cool thing here is that Write-Host\ndoesn't support multiline input,\n\n279\n00:15:15,800 --> 00:15:19,160\nnow it's getting it one at a time,\nit'll be perfectly happy.\n\n280\n00:15:19,160 --> 00:15:22,790\nAnd so when I run that,\nI get the names of my processes.\n\n281\n00:15:22,790 --> 00:15:26,660\nIt ran successfully, no errors,\nand there we go, right?\n\n282\n00:15:26,660 --> 00:15:32,690\nSo slight variation of what we ran before,\nright?\n\n283\n00:15:32,690 --> 00:15:34,958\nSo if we take a look at the two commands,\n\n284\n00:15:34,958 --> 00:15:40,580\nthere was Get-Process which I\npipelined into Write-Host and\n\n285\n00:15:40,580 --> 00:15:44,690\nI used that $_ variable to\nspecify that input that I wanted.\n\n286\n00:15:44,690 --> 00:15:47,465\nAnd the only reason I had to do that\ncuz I could have let that off, but\n\n287\n00:15:47,465 --> 00:15:50,460\nWrite-Host would have just written\nexactly what Get-Process outputted,\n\n288\n00:15:50,460 --> 00:15:52,430\nit would have been pointless, right?\n\n289\n00:15:52,430 --> 00:15:53,810\nBut I did the .name.\n\n290\n00:15:53,810 --> 00:15:56,640\nI was telling it I wanted\nthat property specifically.\n\n291\n00:15:56,640 --> 00:15:58,150\nI didn't want all the other properties.\n\n292\n00:15:58,150 --> 00:16:00,590\nSo that's why I had to do the $_.\n\n293\n00:16:00,590 --> 00:16:02,640\nBut that's the one that\ngenerated an error.\n\n294\n00:16:02,640 --> 00:16:07,940\nWhen I added the foreach loop in there,\nor ForEach-Object, that's\n\n295\n00:16:07,940 --> 00:16:11,220\nwhat gave me the ability to run it one at\na time, and the command was successful.\n\n296\n00:16:11,220 --> 00:16:15,390\nSo just slight variation\nof the command to do it.\n\n297\n00:16:15,390 --> 00:16:17,940\nSo pretty useful thing when\nit comes to pipelining.\n\n298\n00:16:17,940 --> 00:16:22,080\nYou'll find that most of the commands\nthat you have do support pipelining.\n\n299\n00:16:22,080 --> 00:16:24,220\nAnd you'll see it in\nthe help documentation.\n\n300\n00:16:24,220 --> 00:16:30,930\nIf I pull up the get-help, for\nlet's say, Restart-Service,\n\n301\n00:16:30,930 --> 00:16:35,110\nand I'm gonna pull up the full,\nwhen we go in here and\n\n302\n00:16:35,110 --> 00:16:38,240\nwe start to read some of the different\ninformation that it's providing us.\n\n303\n00:16:38,240 --> 00:16:42,000\nAs you scroll through and see all these\nparameters, down here under inputs, right?\n\n304\n00:16:42,000 --> 00:16:43,710\nHow do you feed input to it?\n\n305\n00:16:43,710 --> 00:16:45,160\nMost of the time you'll see system string.\n\n306\n00:16:45,160 --> 00:16:46,910\nThat's us feeding input to it.\n\n307\n00:16:46,910 --> 00:16:48,410\nBut you'll also see this.\n\n308\n00:16:48,410 --> 00:16:52,480\nYou can pipe a service object or\na string that contains objects into it.\n\n309\n00:16:52,480 --> 00:16:56,800\nSo it's letting us know that you can\npipeline things in for this command.\n\n310\n00:16:56,800 --> 00:17:00,360\nNot every command has that, some of\nthem don't support pipelining input.\n\n311\n00:17:00,360 --> 00:17:01,730\nBut you'll find the majority of them do.\n\n312\n00:17:03,080 --> 00:17:03,730\nAll right, so\n\n313\n00:17:03,730 --> 00:17:07,690\nas far as our command pipeline, those are\nbasically the things we need to remember.\n\n314\n00:17:07,690 --> 00:17:11,400\nFirst off that you can pipeline as\nmany commands in chain as you want.\n\n315\n00:17:11,400 --> 00:17:13,770\nEventually it gets really confusing and\noverwhelming.\n\n316\n00:17:13,770 --> 00:17:17,030\nSo I find that I don't normally\ngo beyond like four or five.\n\n317\n00:17:17,030 --> 00:17:18,480\nBut you can keep going.\n\n318\n00:17:18,480 --> 00:17:20,540\nI'm not even sure if\nthere is an actual limit.\n\n319\n00:17:20,540 --> 00:17:22,530\nI've seen some pretty crazy examples.\n\n320\n00:17:22,530 --> 00:17:25,607\nBut you just keep putting that\npipeline character, the pipe,\n\n321\n00:17:25,607 --> 00:17:28,743\nthat two vertical bar symbol in\nbetween each of your commands and\n\n322\n00:17:28,743 --> 00:17:31,437\njust the output for\none becomes the input for the next.\n\n323\n00:17:31,437 --> 00:17:34,907\nAnd it creates a chain reaction\nuntil it gets to the last one and\n\n324\n00:17:34,907 --> 00:17:37,660\nthat's when it displays\noutput on your screen.\n\n325\n00:17:38,890 --> 00:17:41,870\nAll right.\nNow we're gonna see that pipeline through\n\n326\n00:17:41,870 --> 00:17:44,930\ntons of other segments as we\ngo through PowerShell because\n\n327\n00:17:44,930 --> 00:17:47,840\nyou can really use it to manipulate\nyour data and create some cool stuff.\n\n328\n00:17:49,180 --> 00:17:52,140\nBut as far as this one,\nthat's about it right there.\n\n329\n00:17:52,140 --> 00:17:55,280\nSo in this episode we got a chance\nto see how to use the pipeline.\n\n330\n00:17:55,280 --> 00:18:00,290\nWe got to see how to use the $_ variable\nand we got to see a little quirk with\n\n331\n00:18:00,290 --> 00:18:03,250\nsome commands where they don't\nsupport multiline input.\n\n332\n00:18:03,250 --> 00:18:06,835\nAnd so we saw the ForEach-Object\ncommandlet that can correct that for\n\n333\n00:18:06,835 --> 00:18:10,964\nus, allowing us to run that command over\nand over and over again to compensate for\n\n334\n00:18:10,964 --> 00:18:11,954\nmultiline input.\n\n335\n00:18:11,954 --> 00:18:13,416\nSo good stuff.\n\n336\n00:18:13,416 --> 00:18:16,037\nDefinitely something you'll end\nup using in the real world.\n\n337\n00:18:16,037 --> 00:18:20,690\nI hope you guys enjoyed the segment, stay\ntuned, we got more PowerShell coming up.\n\n338\n00:18:20,690 --> 00:18:27,239\n[MUSIC]\n\n",
          "vimeoId": "113924735"
        },
        {
          "description": "",
          "length": "1393",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-8-formatting-command-output-120214.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-8-formatting-command-output-120214-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-8-formatting-command-output-120214-sm.jpg",
          "title": "Formatting Command Output",
          "transcript": "1\n00:00:00,006 --> 00:00:04,630\n[SOUND] In this segment, we're gonna take\n\n2\n00:00:04,630 --> 00:00:09,251\na look at some of the ways\nthat we can modify\n\n3\n00:00:09,251 --> 00:00:14,683\nthe format of the command\noutput in PowerShell.\n\n4\n00:00:14,683 --> 00:00:18,244\nA lot of times you'll find that the way\nthe output is given to you on the screen\n\n5\n00:00:18,244 --> 00:00:19,468\nIt is not the most useful,\n\n6\n00:00:19,468 --> 00:00:23,470\nor just isn't in a format that's useful\nin the way that you intend it to be.\n\n7\n00:00:23,470 --> 00:00:27,050\nMicrosoft can't anticipate everybody's\nuse-case scenario, so they try and\n\n8\n00:00:27,050 --> 00:00:30,080\ncreate something that's\npractical in most environments.\n\n9\n00:00:30,080 --> 00:00:31,940\nBut oftentimes you'll need to modify it.\n\n10\n00:00:31,940 --> 00:00:34,980\nFortunately they give us a collection\nof tools that let us do that.\n\n11\n00:00:34,980 --> 00:00:37,810\nAnd, I'm gonna show you those right now.\n\n12\n00:00:37,810 --> 00:00:43,420\nSo the, first one that I want to talk\nabout is one that I use quite a bit.\n\n13\n00:00:43,420 --> 00:00:48,330\nWhen we run most commands they'll\ngive you output in a table format.\n\n14\n00:00:48,330 --> 00:00:53,680\nThe only problem is you can't really fit\nall that much on a normal computer screen.\n\n15\n00:00:53,680 --> 00:00:56,860\nSo, when it displays that\ntable there's usually some\n\n16\n00:00:56,860 --> 00:00:58,820\npieces that are missing from it.\n\n17\n00:00:58,820 --> 00:01:01,350\nSo, you don't see all\nthe information that you want.\n\n18\n00:01:01,350 --> 00:01:02,950\nLet me show you an example.\n\n19\n00:01:02,950 --> 00:01:06,882\nSo here on my PowerShell if I run\nget-service It's gonna pull up a list of\n\n20\n00:01:06,882 --> 00:01:08,558\nthe services on my computer and\n\n21\n00:01:08,558 --> 00:01:13,270\nI'm just gonna pipe that in to the more\ncommand here so it won't go too crazy.\n\n22\n00:01:13,270 --> 00:01:18,170\nBut you'll see it's giving me the status,\nthe name and the display name.\n\n23\n00:01:18,170 --> 00:01:19,640\nAnd that's it.\n\n24\n00:01:19,640 --> 00:01:23,519\nSo I'm just getting three columns\nin this table as it's arranged.\n\n25\n00:01:24,530 --> 00:01:27,310\nBut there's other columns\nthat are available.\n\n26\n00:01:27,310 --> 00:01:31,620\nThere's more data that it just didn't\nhave room on the screen to put in, right?\n\n27\n00:01:31,620 --> 00:01:35,100\nAnd there's even data that it did\ngive me that it didn't have room for.\n\n28\n00:01:35,100 --> 00:01:38,320\nSee all these guys that have an ellipses\nafter the end of them, the three dots,\n\n29\n00:01:38,320 --> 00:01:42,870\nthat lets me know that it had to\ntruncate that to fit it on the screen.\n\n30\n00:01:42,870 --> 00:01:46,850\nSo the default listing format\nmay not be perfect, right?\n\n31\n00:01:46,850 --> 00:01:50,940\nMicrosoft tried to find something that\nwas a good balance for most users, but\n\n32\n00:01:50,940 --> 00:01:53,930\nif we want that additional information,\nwe might want to change it.\n\n33\n00:01:53,930 --> 00:01:56,650\nSo when you run a command,\n\n34\n00:01:56,650 --> 00:02:00,480\nit's actually being fed through another\ncommandlet called format-table, and\n\n35\n00:02:00,480 --> 00:02:05,220\nthat's whats taking the output from your\nfirst command and making it into a table.\n\n36\n00:02:05,220 --> 00:02:10,010\nInstead of that what we\ncan do is we can take that\n\n37\n00:02:10,010 --> 00:02:14,970\ncommand and\nwe can pipe it into format dash list.\n\n38\n00:02:16,190 --> 00:02:18,660\nThat's another variation.\n\n39\n00:02:18,660 --> 00:02:22,330\nSo the default is format dash table,\nthis is gonna be format dash list.\n\n40\n00:02:22,330 --> 00:02:26,310\nNow it's gonna display those\nproperties one after another.\n\n41\n00:02:26,310 --> 00:02:28,430\nAnd you'll be able to\nsee them all all right.\n\n42\n00:02:28,430 --> 00:02:32,690\nWhen I run that, I still get name,\nI still get status right.\n\n43\n00:02:32,690 --> 00:02:34,570\nSo I still see some of those.\n\n44\n00:02:34,570 --> 00:02:37,560\nBut I also see the full display name,\n\n45\n00:02:37,560 --> 00:02:42,180\ndependencies, the services we depend on,\nand that depend on us.\n\n46\n00:02:42,180 --> 00:02:45,300\nWe see whether we can pause,\nwhether we can shut down, so\n\n47\n00:02:45,300 --> 00:02:47,590\nI'm seeing more information.\n\n48\n00:02:47,590 --> 00:02:50,920\nAnd it's got more room on\nthe screen to list it,\n\n49\n00:02:50,920 --> 00:02:55,100\nbecause it's being written out\none property per line, right?\n\n50\n00:02:55,100 --> 00:02:58,400\nSo this gives us a lot more visibility\ninto what we're looking for.\n\n51\n00:02:58,400 --> 00:02:59,790\nAnd we see that full set of data.\n\n52\n00:02:59,790 --> 00:03:03,720\nSo that's a pretty handy way to go about\ndoing that, is just switching from\n\n53\n00:03:03,720 --> 00:03:08,240\nthe default of format dash\ntable over to format dash list.\n\n54\n00:03:08,240 --> 00:03:11,120\nNow, that default,\nlet's talk about that just a little bit.\n\n55\n00:03:11,120 --> 00:03:17,320\nIf I run get dash service, and\nI just run it by itself, right?\n\n56\n00:03:17,320 --> 00:03:19,980\nWell, I see it as a table.\n\n57\n00:03:19,980 --> 00:03:24,235\nIf I take that same command,\nand I pipe that into\n\n58\n00:03:24,235 --> 00:03:31,830\nFormat-Table, right,\nwhen I run that I get the same data.\n\n59\n00:03:31,830 --> 00:03:34,470\nBy default,\nyou're being fed through Format-Table, so\n\n60\n00:03:34,470 --> 00:03:36,210\nyou don't have to specify that one.\n\n61\n00:03:36,210 --> 00:03:38,990\nSo you might ask yourself if\nwe never have to specify it,\n\n62\n00:03:38,990 --> 00:03:41,160\nwhy do Microsoft even bother\nputting the command in there.\n\n63\n00:03:41,160 --> 00:03:45,080\nWhy would I need Format-Table\nif that's the default, right?\n\n64\n00:03:45,080 --> 00:03:51,010\nWell the reason is Format-Table actually\ntakes some modifiers, all right.\n\n65\n00:03:51,010 --> 00:03:52,650\nIf we pull up the help for it.\n\n66\n00:03:52,650 --> 00:03:55,316\nI do Get-Help Format-Table.\n\n67\n00:03:56,780 --> 00:04:02,540\nYou can see in here that it\ntakes inputs of properties.\n\n68\n00:04:02,540 --> 00:04:07,640\nThat we can actually tell it, hey for\nthis property, I want you to autosize.\n\n69\n00:04:07,640 --> 00:04:09,950\nOr for this property,\nI want you to set a certain width,\n\n70\n00:04:09,950 --> 00:04:13,920\nyou can set all sorts of customizations\nbased on the properties.\n\n71\n00:04:13,920 --> 00:04:17,280\nYou can change their names, you can do\nall sorts of crazy things if you want\n\n72\n00:04:17,280 --> 00:04:18,560\nbased on the information you want to get.\n\n73\n00:04:18,560 --> 00:04:22,060\nSo you can construct\nthe table differently.\n\n74\n00:04:22,060 --> 00:04:26,240\nThe way I use this most commonly is\nsimply to select the columns that I want.\n\n75\n00:04:26,240 --> 00:04:28,660\nI don't necessarily wanna\nget all the columns.\n\n76\n00:04:28,660 --> 00:04:31,410\nThere's a few that I'm looking for\nand those are the ones that I need.\n\n77\n00:04:31,410 --> 00:04:36,110\nI don't mind a table format as long as I\ncan read the data that I'm looking for.\n\n78\n00:04:36,110 --> 00:04:43,100\nSo, an example that might\nbe like Get-Service And\n\n79\n00:04:43,100 --> 00:04:46,142\nI might pipe that into Format-Table,\nwhich for\n\n80\n00:04:46,142 --> 00:04:50,900\nall intents and purposes it already does,\nbut now I'm gonna add on to that.\n\n81\n00:04:50,900 --> 00:04:56,130\nAnd I'm gonna say Name, ServiceType,\n\n82\n00:04:56,130 --> 00:05:00,130\nand Canshutdown.\n\n83\n00:05:00,130 --> 00:05:01,620\nAll right?\n\n84\n00:05:01,620 --> 00:05:04,300\nI want it to tell me\njust those three things.\n\n85\n00:05:04,300 --> 00:05:09,250\nThe default is that it's gonna show me the\nstatus, the name, and the service type.\n\n86\n00:05:09,250 --> 00:05:12,050\nBut I wanna see Names,\nServiceType, and Canshutdown.\n\n87\n00:05:12,050 --> 00:05:16,430\nAnd so\nwhen I run that now I get a table but\n\n88\n00:05:16,430 --> 00:05:18,040\nit's showing me the data that I wanted.\n\n89\n00:05:18,040 --> 00:05:19,030\nThere's the name.\n\n90\n00:05:19,030 --> 00:05:20,150\nThere's the service type.\n\n91\n00:05:20,150 --> 00:05:20,920\nThere's Canshutdown.\n\n92\n00:05:20,920 --> 00:05:21,960\nAll right?\n\n93\n00:05:21,960 --> 00:05:22,950\nI see them all and\n\n94\n00:05:22,950 --> 00:05:26,950\nmy screen is wide enough that it's\nactually spread this out a good bit.\n\n95\n00:05:26,950 --> 00:05:30,680\nIf I adjusted that, it would change it.\n\n96\n00:05:30,680 --> 00:05:33,240\nI've got my width, I think,\nset at 110 characters right now, so\n\n97\n00:05:33,240 --> 00:05:34,660\nthat's why it's so wide.\n\n98\n00:05:34,660 --> 00:05:37,810\nBut on a normal command prompt,\nI think it defaults to 80, so\n\n99\n00:05:37,810 --> 00:05:39,510\nthis would be a lot more narrow.\n\n100\n00:05:39,510 --> 00:05:42,300\nBut basically laying it out, and\nnow I get the information I want.\n\n101\n00:05:42,300 --> 00:05:44,750\nSo that's why we have Format-Table.\n\n102\n00:05:44,750 --> 00:05:47,920\nReal easy way to go through and\npick just the data I want.\n\n103\n00:05:47,920 --> 00:05:50,250\nNow I don't have to convert to a list.\n\n104\n00:05:50,250 --> 00:05:54,790\nBecause a list it's really easy to scan\nover a table and find the information you\n\n105\n00:05:54,790 --> 00:05:57,430\nwant, but the list,\nyou've gotta go through pages of data.\n\n106\n00:05:57,430 --> 00:05:58,170\nThat to find stuff.\n\n107\n00:05:58,170 --> 00:06:01,960\nSo it doesn't really make it\nvery useful for you right?\n\n108\n00:06:01,960 --> 00:06:03,450\nIt can be challenging to work\nwith that kind of output.\n\n109\n00:06:04,560 --> 00:06:09,170\nSo those are some examples right there of\nhow we can use that to find the different\n\n110\n00:06:09,170 --> 00:06:11,080\ndata that we're looking for.\n\n111\n00:06:11,080 --> 00:06:13,160\nThere's a few other things that we can do.\n\n112\n00:06:13,160 --> 00:06:17,620\nLike what if I don't know\nwhat these column names are?\n\n113\n00:06:17,620 --> 00:06:21,110\nWell, when I ran the command originally,\n\n114\n00:06:21,110 --> 00:06:26,420\nwhen I did Get-Service,\nI always saw these three columns.\n\n115\n00:06:26,420 --> 00:06:29,660\nSo, I don't even necessarily\nknow that there's other columns.\n\n116\n00:06:29,660 --> 00:06:31,030\nI might assume that there are, right?\n\n117\n00:06:31,030 --> 00:06:32,360\nBut, I don't really know.\n\n118\n00:06:32,360 --> 00:06:39,440\nAnd when I ran Get-Service and I piped\nit into Format-List, well, there, sure.\n\n119\n00:06:39,440 --> 00:06:43,460\nI saw each of the column names but\nyou don't have to use Get-Service.\n\n120\n00:06:43,460 --> 00:06:45,750\nYou don't have to use the actual\ncommand to find those column names.\n\n121\n00:06:45,750 --> 00:06:50,316\nYou can actually find it using\nanother command called Get-Member.\n\n122\n00:06:50,316 --> 00:06:55,050\nGet-Member will let you know what\nall of those properties are.\n\n123\n00:06:55,050 --> 00:06:57,390\nInside of Powershell,\nwhen you get output like this,\n\n124\n00:06:57,390 --> 00:07:01,330\nit's almost always a property and\nits associated value, right?\n\n125\n00:07:01,330 --> 00:07:04,560\nSo, the property names,\nthese are like the columns in your table.\n\n126\n00:07:04,560 --> 00:07:10,390\nAnd so I could go in and\nI could say Get-Service and\n\n127\n00:07:10,390 --> 00:07:15,030\npipe that into Get-Member,\nlike that, and when you run it,\n\n128\n00:07:15,030 --> 00:07:18,570\nit's gonna show me all the different\nthings that are inside of it.\n\n129\n00:07:18,570 --> 00:07:20,060\nAnd there's name.\n\n130\n00:07:20,060 --> 00:07:24,260\nAnd you'll see some of the other ones\nare in here too Canshutdown, and so on.\n\n131\n00:07:24,260 --> 00:07:26,920\nAnd there's even more that\nare tucked away in here.\n\n132\n00:07:26,920 --> 00:07:29,160\nWell, a lot of these are methods and\n\n133\n00:07:29,160 --> 00:07:31,270\nwe can't really do a whole heck\nof a lot with the methods.\n\n134\n00:07:31,270 --> 00:07:33,030\nThose are for being called programmatic.\n\n135\n00:07:33,030 --> 00:07:38,130\nThey're sort of like a function but\na little more powerful, but\n\n136\n00:07:38,130 --> 00:07:43,390\nthe alias properties right here, and\nthe actual properties right here.\n\n137\n00:07:43,390 --> 00:07:45,300\nThose are the ones that we can work with.\n\n138\n00:07:45,300 --> 00:07:48,880\nAnd so we can see all these different\nproperties that are available and\n\n139\n00:07:48,880 --> 00:07:49,980\nwhere they are coming from.\n\n140\n00:07:49,980 --> 00:07:52,220\nHow it is actually deriving that data.\n\n141\n00:07:52,220 --> 00:07:54,170\nSo Get-Member is a way to see that.\n\n142\n00:07:54,170 --> 00:07:55,530\nFor most of us, we don't need that.\n\n143\n00:07:55,530 --> 00:07:58,256\nWe don't need to go that in depth.\n\n144\n00:07:58,256 --> 00:08:02,462\nYou can just do format list, and find\nthem right there, and then go through and\n\n145\n00:08:02,462 --> 00:08:03,944\nprovide the ones you want.\n\n146\n00:08:03,944 --> 00:08:05,940\nBut this is an easy way to do that.\n\n147\n00:08:05,940 --> 00:08:10,004\nAnd we get it without having to deal with\npage after page of services being listed.\n\n148\n00:08:10,004 --> 00:08:14,700\nHere it's just telling me what\nthat command would output.\n\n149\n00:08:14,700 --> 00:08:18,360\nAll right,\na couple other things that we can do.\n\n150\n00:08:18,360 --> 00:08:22,321\nWith Format-Table, I showed you there were\na lot of different options in there for\n\n151\n00:08:22,321 --> 00:08:23,750\nmodifying things.\n\n152\n00:08:23,750 --> 00:08:27,136\nAnother neat one is Format-Wide.\n\n153\n00:08:27,136 --> 00:08:31,610\nSo, Format-Table and Format-List,\nwe use those all the time.\n\n154\n00:08:31,610 --> 00:08:34,210\nBut, Format-Wide is a weird one.\n\n155\n00:08:34,210 --> 00:08:38,560\nWhen you run that, what it does\nis it stretches out the width of\n\n156\n00:08:38,560 --> 00:08:43,240\nevery column to ensure that\nno characters get truncated.\n\n157\n00:08:43,240 --> 00:08:47,460\nSo, the longest value in a particular\ncolumn will determine the width,\n\n158\n00:08:47,460 --> 00:08:49,570\nit's auto sized by default.\n\n159\n00:08:49,570 --> 00:08:53,400\nSo Format-Wide just\neliminates truncated data.\n\n160\n00:08:53,400 --> 00:08:56,722\nAnd if I run that I'll find output\nthat's normally pretty useless,\n\n161\n00:08:56,722 --> 00:08:58,550\n[LAUGH] in my opinion.\n\n162\n00:08:58,550 --> 00:09:02,470\nBut, so it's giving me this wide\nformatting in laying things out.\n\n163\n00:09:02,470 --> 00:09:05,420\nAnd so I'm starting to see the names and\nI've got enough room\n\n164\n00:09:05,420 --> 00:09:08,640\non my screen that what it's actually\ndoing is listing my services.\n\n165\n00:09:08,640 --> 00:09:11,200\nAnd I'll have a name here,\nand another name here,\n\n166\n00:09:11,200 --> 00:09:13,650\nthat's two different\nservices on the same line.\n\n167\n00:09:13,650 --> 00:09:17,270\nAnd an app ID service, an app info,\nand it's going through and\n\n168\n00:09:17,270 --> 00:09:20,970\nlaying them out in a wide format,\nwhich in this case is two columns.\n\n169\n00:09:20,970 --> 00:09:24,280\nSome commands if the data is small\nenough it might be three columns.\n\n170\n00:09:24,280 --> 00:09:28,630\nSo you may see other variations of\nthis where it lays it out differently.\n\n171\n00:09:28,630 --> 00:09:31,730\nSo if I do like Get-Command.\n\n172\n00:09:31,730 --> 00:09:34,740\nRight, that's the one that lists all\nthe different power shell commands that\n\n173\n00:09:34,740 --> 00:09:35,385\nare available.\n\n174\n00:09:35,385 --> 00:09:43,325\nAnd if I type that into Format-Wide.\n\n175\n00:09:43,325 --> 00:09:47,423\nWhen I do that now it's displaying,\nwell let's go in two columns also, so\n\n176\n00:09:47,423 --> 00:09:50,720\nhere I'm seeing the commands one per line,\nright?\n\n177\n00:09:50,720 --> 00:09:56,288\nFormat-Wide though does take a lot of\nmodifiers so if we do Get-Help for\n\n178\n00:09:56,288 --> 00:10:02,650\nFormat-Wide, you'll see that we can\nspecify how the auto-sizing is done.\n\n179\n00:10:02,650 --> 00:10:05,570\nYou can indicate particular columns and\ntheir data types.\n\n180\n00:10:05,570 --> 00:10:07,180\nYou can do all sorts of various things,\n\n181\n00:10:07,180 --> 00:10:10,300\nexpanding other screens,\ngrouping things together.\n\n182\n00:10:10,300 --> 00:10:12,390\nYou can the sort orders on some of these.\n\n183\n00:10:12,390 --> 00:10:16,290\nSo there's some really neat stuff in here\nthat'll help you to be able to clean\n\n184\n00:10:16,290 --> 00:10:16,790\nup your data.\n\n185\n00:10:18,460 --> 00:10:19,360\nAll right.\n\n186\n00:10:19,360 --> 00:10:22,600\nSo those are a few of the different\nways we can modify the output,\n\n187\n00:10:22,600 --> 00:10:25,470\nbut all of those have one thing in common.\n\n188\n00:10:25,470 --> 00:10:29,500\nWhat they did,\nis they modified the output to our screen.\n\n189\n00:10:29,500 --> 00:10:32,060\nWe don't always want to\noutput to our screen.\n\n190\n00:10:32,060 --> 00:10:35,010\nWe might want to output to a file instead.\n\n191\n00:10:35,010 --> 00:10:39,080\nWhen we output to a file we might be using\nthat to then feed into some other software\n\n192\n00:10:39,080 --> 00:10:43,910\nto do other various tasks and\nthere's two main ones that I use for this.\n\n193\n00:10:43,910 --> 00:10:47,940\nSometimes I wanna output\ndata as an HTML file,\n\n194\n00:10:47,940 --> 00:10:51,080\nit's basically like a webpage so\nthat I can use it in a report right,\n\n195\n00:10:51,080 --> 00:10:53,680\nconvert it over to a PDF or\nsomething and send it to people.\n\n196\n00:10:53,680 --> 00:10:56,950\nGives you a nice quick easy output that's\nin a format that can be rendered by\n\n197\n00:10:56,950 --> 00:10:58,280\nany system.\n\n198\n00:10:58,280 --> 00:11:02,510\nThe other option is a CSV,\na Comma Separated Values file.\n\n199\n00:11:02,510 --> 00:11:06,850\nThat's a table file that can be used by\nalmost any spreadsheet software out there.\n\n200\n00:11:06,850 --> 00:11:12,800\nSo if you're using Microsoft Excel or\nNumbers from Apple or\n\n201\n00:11:12,800 --> 00:11:16,700\nwhatever the Open Office version,\nMath or whatever they call it.\n\n202\n00:11:16,700 --> 00:11:18,740\nSo, [LAUGH] you can bring it in there and\n\n203\n00:11:18,740 --> 00:11:21,930\nyou can start to work with it in a table\nright there in your spreadsheet software.\n\n204\n00:11:21,930 --> 00:11:24,910\nThese work really easy,\nlet me show you an example.\n\n205\n00:11:24,910 --> 00:11:28,331\nI've been working with Get-Service,\nso we'll stick with that one.\n\n206\n00:11:28,331 --> 00:11:31,550\nSo, I'll say, Get-Service and\n\n207\n00:11:31,550 --> 00:11:36,101\nI'm gonna pipe that into export,\nnot that one,\n\n208\n00:11:36,101 --> 00:11:41,544\nwe'll do this one first,\nconvert to- HTML, all right.\n\n209\n00:11:41,544 --> 00:11:45,014\nAnd I'm gonna be converting the output\nfrom Get-Service into HTML.\n\n210\n00:11:45,014 --> 00:11:49,181\nAnd then I can tell it exactly\nwhat I want, so in my case,\n\n211\n00:11:49,181 --> 00:11:51,414\nI just want a few properties.\n\n212\n00:11:52,945 --> 00:11:59,345\nSo I'll say, property name and\nstatus, and if I\n\n213\n00:11:59,345 --> 00:12:03,625\njust run it like this, it's actually gonna\ndisplay the HTML on my screen, right.\n\n214\n00:12:03,625 --> 00:12:07,955\nSo if I just run that, there it is,\nit's HTML, but it's on my screen, and so\n\n215\n00:12:07,955 --> 00:12:09,975\nwhat I need to do, is add another command.\n\n216\n00:12:11,145 --> 00:12:15,200\nThe pipeline command we've been using,\nthe two vertical lines That says take\n\n217\n00:12:15,200 --> 00:12:19,380\nthe output for one command and\nuse it as the input for another command.\n\n218\n00:12:20,900 --> 00:12:23,750\nI'm gonna use the greater\nthan symbol this time.\n\n219\n00:12:23,750 --> 00:12:27,900\nAnd the greater than symbol what that\nmeans is take the output from the previous\n\n220\n00:12:27,900 --> 00:12:31,270\ncommand and convert it into, or\n\n221\n00:12:31,270 --> 00:12:35,310\nredirect it from the screen\nto somewhere else, all right?\n\n222\n00:12:35,310 --> 00:12:37,080\nAnd in my case I'm gonna\nredirect it to a file.\n\n223\n00:12:37,080 --> 00:12:42,661\nI'm gonna send that to C:\\Services.html,\nall right.\n\n224\n00:12:42,661 --> 00:12:45,250\nSo I'm just gonna write it to that file.\n\n225\n00:12:45,250 --> 00:12:50,340\nOkay, I could have done like\nGet-Service and just done\n\n226\n00:12:50,340 --> 00:12:56,440\nright off the bat and thrown that into\nservices.txt, like that as a text file.\n\n227\n00:12:56,440 --> 00:12:59,370\nAnd now it's going to dump\nit right out as a text file.\n\n228\n00:12:59,370 --> 00:13:01,050\nI didn't do any formatting.\n\n229\n00:13:01,050 --> 00:13:05,270\nBut when I ran it this time,\nI piped it through convert to a HTML, and\n\n230\n00:13:05,270 --> 00:13:08,040\nnow it's going to dump\nit out as HTML content.\n\n231\n00:13:08,040 --> 00:13:12,824\nAnd so when I browse on my C drive,\nand find those two files,\n\n232\n00:13:12,824 --> 00:13:15,041\nhere they are, all right.\n\n233\n00:13:15,041 --> 00:13:20,344\nAnd this one is the Services.Text file,\nif I open it up, I'll just choose WordPad,\n\n234\n00:13:20,344 --> 00:13:25,562\nthere it is, that's the same information\nthat I got on my screen a moment ago.\n\n235\n00:13:25,562 --> 00:13:29,700\nAll right, so I can see it right there\nit's laid out for me, there's the data.\n\n236\n00:13:29,700 --> 00:13:31,810\nJust in a raw text file.\n\n237\n00:13:31,810 --> 00:13:36,490\nBut this other one,\nthis is an HTML file, and if I open it,\n\n238\n00:13:36,490 --> 00:13:40,650\nin Internet Explorer, here it is, and\nit's being rendered, and it's a little bit\n\n239\n00:13:40,650 --> 00:13:44,500\ndifferent because I picked particular\ncolumns, I picked name and status.\n\n240\n00:13:44,500 --> 00:13:47,385\nAnd so, it's laying them out,\nand it's typed for\n\n241\n00:13:47,385 --> 00:13:50,750\nHTML, so it looks nice and\npretty and there's my data.\n\n242\n00:13:50,750 --> 00:13:52,500\nI say nice and pretty,\nit's not very flashy, is it?\n\n243\n00:13:52,500 --> 00:13:57,454\nIt's just text laid out, but\nit's in that HTML format.\n\n244\n00:13:57,454 --> 00:14:00,310\nAll right, so pretty handy if\nyou're trying to generate reports.\n\n245\n00:14:00,310 --> 00:14:03,560\nI'll do this when I'm pulling up\nthings like lists of computers that\n\n246\n00:14:03,560 --> 00:14:05,530\nhaven't logged in, in over 90 days,\n\n247\n00:14:05,530 --> 00:14:10,030\nor list of users with passwords that\nhaven't been reset in the last 90 days.\n\n248\n00:14:10,030 --> 00:14:10,800\nThings like that,\n\n249\n00:14:10,800 --> 00:14:13,130\ncuz I'll wanna generate that as the list\nthat I can then show to people.\n\n250\n00:14:13,130 --> 00:14:15,990\nAnd I can tick people off on that list and\nsay yep, yep, I got that person,\n\n251\n00:14:15,990 --> 00:14:17,590\ngot that person and go down the line.\n\n252\n00:14:17,590 --> 00:14:20,040\nIt's pretty handy to have that\noutput in a report type format.\n\n253\n00:14:20,040 --> 00:14:25,760\nAll right, so that was let's see,\nwhat was all that?\n\n254\n00:14:25,760 --> 00:14:26,660\nThere we go.\n\n255\n00:14:26,660 --> 00:14:29,480\nSo that was convert to HTML.\n\n256\n00:14:29,480 --> 00:14:32,280\nAs well as just the redirect prompt there,\n\n257\n00:14:32,280 --> 00:14:36,020\nthe greater than symbol that\nredirects the output into a file.\n\n258\n00:14:36,020 --> 00:14:37,260\nI also mentioned CSVs.\n\n259\n00:14:37,260 --> 00:14:40,160\nAnd that was the command I\nalmost typed a minute ago.\n\n260\n00:14:40,160 --> 00:14:44,120\nI could say, Get-Service and\nI could pipe that into\n\n261\n00:14:44,120 --> 00:14:51,940\nthe Export-CSV command and\nspecify a file name for that one.\n\n262\n00:14:51,940 --> 00:14:55,970\nI actually don't need the redirect option\non this one, I can just specify the path,\n\n263\n00:14:55,970 --> 00:14:59,810\nand I'll put it as services.CSV.\n\n264\n00:14:59,810 --> 00:15:02,310\nYou can actually put the extension\nto do whatever you want, but\n\n265\n00:15:02,310 --> 00:15:06,000\nit makes life a lot easier if you use the\ncorrect extension, so I'll use CSV here.\n\n266\n00:15:06,000 --> 00:15:09,354\nSo I'm just going to export that out,\nand when I run it, there it goes, and\n\n267\n00:15:09,354 --> 00:15:11,024\non my C drive I should have a new file.\n\n268\n00:15:13,949 --> 00:15:15,420\nServices.CSV.\n\n269\n00:15:15,420 --> 00:15:19,170\nAnd I don't have a spreadsheet\nprogram here on my server, so\n\n270\n00:15:19,170 --> 00:15:21,520\nI'm just gonna edit that\nwith a text editor.\n\n271\n00:15:21,520 --> 00:15:26,460\nAnd what you'll see is that it's\nproperly formatted for a CSV.\n\n272\n00:15:26,460 --> 00:15:29,560\nThe first line contains my column names.\n\n273\n00:15:29,560 --> 00:15:31,340\nActually, I guess my\nfirst line is my typing.\n\n274\n00:15:31,340 --> 00:15:34,770\nBut the first real line,\nthis guy, are my column names.\n\n275\n00:15:34,770 --> 00:15:39,390\nName, RequiredServices,\nCanPauseAndContinue, and so on.\n\n276\n00:15:39,390 --> 00:15:42,210\nAnd then after that,\neach of the services are listed,\n\n277\n00:15:42,210 --> 00:15:46,080\none service per line, and\ntheir values are separated by a comma.\n\n278\n00:15:46,080 --> 00:15:51,350\nEvery time there's a comma, that indicates\nthat it's the end of that column and\n\n279\n00:15:51,350 --> 00:15:53,010\nnow we're moving to the next column.\n\n280\n00:15:53,010 --> 00:15:55,957\nIt's formatted as a CSV,\nwe can feed this into Microsoft Excel or\n\n281\n00:15:55,957 --> 00:15:57,361\nother spreadsheet programs.\n\n282\n00:15:57,361 --> 00:16:00,672\nAnd then we can sort and filter and\ndo all the crazy things that we do with\n\n283\n00:16:00,672 --> 00:16:03,722\nspreadsheets without having to\nfight with PowerShell to do it.\n\n284\n00:16:03,722 --> 00:16:04,265\nAll right.\n\n285\n00:16:04,265 --> 00:16:09,063\nSo that's another handy system you can use\nfor outputting It's also handy if you have\n\n286\n00:16:09,063 --> 00:16:11,794\nother systems that require\ninput of some sort and\n\n287\n00:16:11,794 --> 00:16:14,310\nthey expect that input to be in CSV.\n\n288\n00:16:14,310 --> 00:16:18,120\nSo I've used this with like\nsynchronizing email distribution lists.\n\n289\n00:16:18,120 --> 00:16:21,820\nI might export it with a PowerShell\ncommand, dumping it as a CSV, so\n\n290\n00:16:21,820 --> 00:16:24,990\na third party system could import\nit to have the mailing list, or\n\n291\n00:16:24,990 --> 00:16:26,460\nwhatever it was that we were doing.\n\n292\n00:16:26,460 --> 00:16:28,359\nSo, that kind of functionality\nis pretty handy.\n\n293\n00:16:31,059 --> 00:16:35,210\nAll right, so,\nthat was regular onscreen output.\n\n294\n00:16:35,210 --> 00:16:37,680\nRight, we did the format list and\nall those guys.\n\n295\n00:16:37,680 --> 00:16:39,760\nWe had the HTML and CSVs.\n\n296\n00:16:39,760 --> 00:16:42,180\nWhat else do we have?\n\n297\n00:16:42,180 --> 00:16:42,680\nFiltering.\n\n298\n00:16:44,240 --> 00:16:48,382\nSometimes we wanna filter output and\nI've sort of showed that to you, right?\n\n299\n00:16:48,382 --> 00:16:50,780\nWhere I was filtering\nbased on column names.\n\n300\n00:16:50,780 --> 00:16:52,600\nI was saying I just want these columns.\n\n301\n00:16:52,600 --> 00:16:55,730\nBut we might wanna filter based\non the results themselves and\n\n302\n00:16:55,730 --> 00:16:57,740\nthere's a few different ways\nthat we can go about that.\n\n303\n00:16:57,740 --> 00:17:01,600\nSo let me show you the two main\nways that we can filter our output.\n\n304\n00:17:01,600 --> 00:17:04,150\nSo let me get back to my shell here.\n\n305\n00:17:05,300 --> 00:17:09,180\nAll right,\nI'm gonna take the Get-Process command.\n\n306\n00:17:09,180 --> 00:17:12,210\nThe Get-Process shows\nme a ton of processes.\n\n307\n00:17:12,210 --> 00:17:14,450\nIt's everything that's running\non my server right now.\n\n308\n00:17:14,450 --> 00:17:16,070\nSo I see them and there they are.\n\n309\n00:17:16,070 --> 00:17:19,200\nMy server's fairly idle, so\nthere's really not that much.\n\n310\n00:17:19,200 --> 00:17:24,010\nBut you can see in my list,\nI've got Internet Explorer right there.\n\n311\n00:17:24,010 --> 00:17:26,830\nSo I'm running Internet Explorer\non my computer right now.\n\n312\n00:17:26,830 --> 00:17:28,910\nIt's up and running and\napparently it's running twice.\n\n313\n00:17:28,910 --> 00:17:31,760\nSo I've got two tabs open or something.\n\n314\n00:17:31,760 --> 00:17:36,070\nOh, I probably do have two\ntabs from that HTML file.\n\n315\n00:17:36,070 --> 00:17:36,890\nOh, I guess not.\n\n316\n00:17:36,890 --> 00:17:38,580\nWell anyhow, for\nsome reason I've got two processes.\n\n317\n00:17:39,620 --> 00:17:41,903\nWell, if I wanna look\nat that process output,\n\n318\n00:17:41,903 --> 00:17:44,490\nI may want to manipulate\nwhat columns I get, right?\n\n319\n00:17:44,490 --> 00:17:46,340\nWhich is what we saw earlier.\n\n320\n00:17:46,340 --> 00:17:49,380\nOr I might want to manipulate\nwhich processes I'm seeing.\n\n321\n00:17:49,380 --> 00:17:52,295\nSo let's take an example of,\nlet's start with a column.\n\n322\n00:17:52,295 --> 00:17:54,775\nColumn names.\nI'm gonna filter the column names cuz I\n\n323\n00:17:54,775 --> 00:17:56,835\ndon't wanna see all these\ncolumns that are here.\n\n324\n00:17:56,835 --> 00:18:01,121\nAnd we even saw earlier that sometimes\nthere's columns that aren't displayed that\n\n325\n00:18:01,121 --> 00:18:02,035\nactually exist.\n\n326\n00:18:02,035 --> 00:18:05,548\nSo like get-member could show us that\nthere might be more columns than what fit\n\n327\n00:18:05,548 --> 00:18:06,888\non the screen.\n\n328\n00:18:06,888 --> 00:18:10,910\nSo I'm gonna manipulate this output\nby changing the columns that I need.\n\n329\n00:18:10,910 --> 00:18:14,950\nNow when we used Format-List,\nFormat-List let me do that too,\n\n330\n00:18:14,950 --> 00:18:18,720\nI mean not list, Format-Table,\nthat one let us pick the column names.\n\n331\n00:18:18,720 --> 00:18:22,060\nBut we didn't actually have to use that,\nwe could have used another option.\n\n332\n00:18:22,060 --> 00:18:24,583\nWe could have used Select-Object.\n\n333\n00:18:24,583 --> 00:18:30,420\nI'm gonna do Get-Process, and\nI'm gonna pipe that into Select-Object.\n\n334\n00:18:30,420 --> 00:18:35,750\nThat commandlet let's us do filtering,\n\n335\n00:18:35,750 --> 00:18:38,065\nand we can filter based\non all sorts of things.\n\n336\n00:18:38,065 --> 00:18:41,425\nI'm gonna filter based on property,\nand I'm gonna\n\n337\n00:18:41,425 --> 00:18:45,925\nsay that I want the process name and\nthe ID.\n\n338\n00:18:45,925 --> 00:18:47,545\nThat's all I want, all right?\n\n339\n00:18:47,545 --> 00:18:50,205\nSo I'm just gonna give it those values,\nand I'll run it.\n\n340\n00:18:50,205 --> 00:18:52,300\nAnd now, I get that output.\n\n341\n00:18:52,300 --> 00:18:57,330\nNow, that's not really any different\nthan using Format-Table to do it, right?\n\n342\n00:18:57,330 --> 00:19:01,020\nAnd in reality Format-Table,\nis just calling Select-Object.\n\n343\n00:19:01,020 --> 00:19:02,470\nThat's exactly how it works.\n\n344\n00:19:02,470 --> 00:19:05,510\nSo, it's really part and parcel,\nthey're kind of the same thing.\n\n345\n00:19:06,630 --> 00:19:09,540\nBut what if I want to\nfilter this even more?\n\n346\n00:19:09,540 --> 00:19:13,925\nWhat if I just want to see processes\nthat are Internet Explorer?\n\n347\n00:19:13,925 --> 00:19:14,850\nRight?\n\n348\n00:19:14,850 --> 00:19:16,770\nIf I'm on a busy terminal server,\n\n349\n00:19:16,770 --> 00:19:19,450\nthere could be hundreds of\nthousands of processes.\n\n350\n00:19:19,450 --> 00:19:21,470\nI just want to find Internet Explorer.\n\n351\n00:19:21,470 --> 00:19:26,520\nNow I'm not filtering by column name,\nI'm filtering by a value in a cell.\n\n352\n00:19:26,520 --> 00:19:29,500\nI wanna look in this cell\nover here in this column and\n\n353\n00:19:29,500 --> 00:19:33,150\nfind just the ones that match\nInternet Explorer, right?\n\n354\n00:19:33,150 --> 00:19:36,910\nThat's a little bit harder to do,\nbut it definitely can be done.\n\n355\n00:19:36,910 --> 00:19:39,530\nWhat we do is we use a different command.\n\n356\n00:19:39,530 --> 00:19:41,868\nWe use the Where-Object.\n\n357\n00:19:41,868 --> 00:19:46,925\nSelect-Object, that let us pick those\nproperty values, those columns.\n\n358\n00:19:46,925 --> 00:19:50,170\nWhere-Object is like a qualifier.\n\n359\n00:19:50,170 --> 00:19:52,370\nWe're saying yeah,\ngo ahead and get these objects,\n\n360\n00:19:52,370 --> 00:19:56,780\nwhere the object meets a certain set\nof criteria that we define, all right.\n\n361\n00:19:56,780 --> 00:20:00,000\nSo, I'm gonna take this, and actually\nwe'll just get rid of Select-Object\n\n362\n00:20:00,000 --> 00:20:04,100\njust to make life a little bit easier for\nus, and I'll pipe that into Where-Object,\n\n363\n00:20:04,100 --> 00:20:07,750\nand now I'm gonna specify my criteria.\n\n364\n00:20:07,750 --> 00:20:09,860\nNow you can have all sorts of criteria.\n\n365\n00:20:09,860 --> 00:20:11,640\nYou can get very advanced with this.\n\n366\n00:20:11,640 --> 00:20:15,370\nSo this is another one of those commands\nwhere we bring in those squiggly brackets.\n\n367\n00:20:15,370 --> 00:20:19,168\nBecause now we can go multiline, you can\nput in all sorts of syntax variations,\n\n368\n00:20:19,168 --> 00:20:20,313\nand have at it, right?\n\n369\n00:20:20,313 --> 00:20:22,520\nBut I'm gonna keep mine pretty simple.\n\n370\n00:20:22,520 --> 00:20:26,088\nI'm just gonna say where, and\nI'm gonna query that name value.\n\n371\n00:20:26,088 --> 00:20:28,950\nNow I'm gonna use the dollar\nsign underscore variable,\n\n372\n00:20:28,950 --> 00:20:33,080\nthat's basically representing\nthe output from the first command.\n\n373\n00:20:33,080 --> 00:20:36,120\nAnd I'm going to query based on name.\n\n374\n00:20:36,120 --> 00:20:39,000\nNow name is just an alias for\nprocess name, so I could do either one.\n\n375\n00:20:39,000 --> 00:20:41,030\nI'll just do name because\nI'm a lazy typer.\n\n376\n00:20:41,030 --> 00:20:45,295\nSo, I'll say $_.Name, so\n\n377\n00:20:45,295 --> 00:20:52,195\nwhere the name -eq where\nit equals -iexplorer.\n\n378\n00:20:52,195 --> 00:20:56,370\nAll right?\nI just wanna find processes where the name\n\n379\n00:20:56,370 --> 00:21:02,420\nis iexplorer, and\nwhen I run that, I get nothing.\n\n380\n00:21:02,420 --> 00:21:04,010\nWhy did I get nothing?\n\n381\n00:21:04,010 --> 00:21:05,260\nOh, it's not called iexplorer.\n\n382\n00:21:05,260 --> 00:21:08,400\nIt's called iexplore, so if I get the name\nright, that'll help a little bit.\n\n383\n00:21:08,400 --> 00:21:11,410\nSo, there we go, iexplore.\n\n384\n00:21:11,410 --> 00:21:16,490\nAnd now, I get my output, and\nI just see those processes.\n\n385\n00:21:16,490 --> 00:21:21,465\nSo, we can use Select-Object\nto pick the columns, and\n\n386\n00:21:21,465 --> 00:21:25,350\nWhere-Object to pick the rows.\n\n387\n00:21:25,350 --> 00:21:28,280\nAnd you can combine the two\nto get very specific, right?\n\n388\n00:21:28,280 --> 00:21:34,199\nI might wanna say, where the object\nis iexplore, and then further,\n\n389\n00:21:34,199 --> 00:21:40,640\nsay Select-Object, and\nspecify just the properties that I want.\n\n390\n00:21:40,640 --> 00:21:47,540\nSo property name, or I guess process name,\nif we're gonna keep the naming right.\n\n391\n00:21:47,540 --> 00:21:49,240\nAnd what else?\n\n392\n00:21:49,240 --> 00:21:50,140\nID.\n\n393\n00:21:50,140 --> 00:21:51,831\nI think that was what I did earlier.\n\n394\n00:21:51,831 --> 00:21:54,900\nAnd now,\nsorry my heads on top of it there.\n\n395\n00:21:54,900 --> 00:21:57,920\nNow I get just those process names and\njust those IDs.\n\n396\n00:21:57,920 --> 00:22:01,560\nI've combined those two commands\nto generate the result I want.\n\n397\n00:22:01,560 --> 00:22:04,170\nMy formatting has a little\nbit to be desired here.\n\n398\n00:22:04,170 --> 00:22:06,970\nSo I might want to then pipe\nthis again into Format-Table\n\n399\n00:22:06,970 --> 00:22:10,690\nto be able to specify the width of\nthe columns, and adjust that too.\n\n400\n00:22:10,690 --> 00:22:13,660\nSo, pretty neat different methods there.\n\n401\n00:22:13,660 --> 00:22:16,130\nBut, just remember\nthe basic rule of thumb.\n\n402\n00:22:16,130 --> 00:22:18,350\nSelect-Object is great for\npicking columns.\n\n403\n00:22:18,350 --> 00:22:21,540\nWhere-Object is great for picking rows.\n\n404\n00:22:21,540 --> 00:22:26,990\nAll right, between those different\nmethods, those are ways that we can modify\n\n405\n00:22:26,990 --> 00:22:32,230\nthe output of a command and get exactly\nwhat we want in the way that we need it.\n\n406\n00:22:32,230 --> 00:22:36,175\nAll right, so in this segment, we got\na chance to take a look Format-List,\n\n407\n00:22:36,175 --> 00:22:38,870\nFormat-Table, and Format-Wide.\n\n408\n00:22:38,870 --> 00:22:44,270\nWe got a chance to see export-CSV,\nas well as convert to HTML, right?\n\n409\n00:22:44,270 --> 00:22:46,910\nSome really neat ones there for\noutputting those values.\n\n410\n00:22:46,910 --> 00:22:49,850\nWe saw the redirect prompt, right?\n\n411\n00:22:49,850 --> 00:22:54,238\nThe greater than symbol to redirect output\nto a file, and we got a chance to see\n\n412\n00:22:54,238 --> 00:22:58,330\nSelect-Object and Where-Object to\nfilter the output of our commands.\n\n413\n00:22:58,330 --> 00:23:01,530\nLot of good stuff in there to\nbe able to change our output.\n\n414\n00:23:01,530 --> 00:23:03,410\nAll right.\nWell, I hope you guys enjoyed the segment.\n\n415\n00:23:03,410 --> 00:23:10,583\nStay tuned,\nwe've got more PowerShell coming up.\n\n416\n00:23:10,583 --> 00:23:13,290\n[MUSIC]\n\n",
          "vimeoId": "113925179"
        },
        {
          "description": "",
          "length": "735",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-9-script-execution-policies-120214.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-9-script-execution-policies-120214-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-9-script-execution-policies-120214-sm.jpg",
          "title": "Script Execution Policies",
          "transcript": "1\n00:00:00,025 --> 00:00:05,520\n[SOUND] In this segment, we're gonna take\n\n2\n00:00:05,520 --> 00:00:12,594\na look at\nPowerShell's Script Execution Policies.\n\n3\n00:00:12,594 --> 00:00:16,603\nWhen you get started with PowerShell, one\nof the features that Microsoft promotes\n\n4\n00:00:16,603 --> 00:00:18,640\nis how easy it is to write scripts.\n\n5\n00:00:18,640 --> 00:00:21,650\nBut you might've noticed that on\nmost systems, when you try and\n\n6\n00:00:21,650 --> 00:00:25,290\nrun a script, you get an error\ntelling you access denied.\n\n7\n00:00:25,290 --> 00:00:30,370\nBy default, the majority of systems\nout there have the scripting disabled.\n\n8\n00:00:30,370 --> 00:00:34,630\nAnd that seems unfortunate, but\nit's there to protect you from, well,\n\n9\n00:00:34,630 --> 00:00:37,130\nnot just from yourself,\nbut from other people too.\n\n10\n00:00:37,130 --> 00:00:39,820\nSo basically Microsoft says,\nhey, scripting is great.\n\n11\n00:00:39,820 --> 00:00:44,580\nIt's very powerful, but you probably\ndon't want it on unless you need it.\n\n12\n00:00:44,580 --> 00:00:48,200\nSo they turn it off by default, and\nthen it's up to you to go and modify that.\n\n13\n00:00:48,200 --> 00:00:50,650\nNow, it's really easy to change it.\n\n14\n00:00:50,650 --> 00:00:52,210\nWe just need to know to do it.\n\n15\n00:00:52,210 --> 00:00:54,800\nWe have what are called\nscript execution policies.\n\n16\n00:00:55,940 --> 00:00:59,120\nAnd these are the policies that define\nwhat scripts we're allowed to run.\n\n17\n00:00:59,120 --> 00:01:02,280\nMicrosoft classifies scripts\na few different ways, all right.\n\n18\n00:01:02,280 --> 00:01:06,190\nThere are trusted scripts,\nand untrusted scripts.\n\n19\n00:01:06,190 --> 00:01:09,110\nA trusted script is one\nthat's been digitally signed.\n\n20\n00:01:09,110 --> 00:01:13,510\nIn other words, whoever wrote the script,\ngot a digital signature,\n\n21\n00:01:13,510 --> 00:01:17,200\na certificate, a private key,\npublic key pair, that they could then\n\n22\n00:01:17,200 --> 00:01:21,120\nattach a digital signature to the script,\nto show that it hadn't been modified.\n\n23\n00:01:21,120 --> 00:01:25,480\nThat way when you run it, if you trust\nwhoever issued that certificate,\n\n24\n00:01:25,480 --> 00:01:29,870\nyou'll be able to verify that the script\nhasn't been modified, and run it, and\n\n25\n00:01:29,870 --> 00:01:33,190\nknow that it's written to run the way\nthat it was originally intended, and\n\n26\n00:01:33,190 --> 00:01:36,160\nsomebody hasn't modified\nit to add their own code.\n\n27\n00:01:36,160 --> 00:01:37,470\nThat's a great idea, and\n\n28\n00:01:37,470 --> 00:01:42,010\nit's definitely something that\nmost people would want, but.\n\n29\n00:01:42,010 --> 00:01:44,010\nIf you're writing your own scripts,\n\n30\n00:01:44,010 --> 00:01:48,060\nyou probably don't necessarily have\na public key infrastructure, or\n\n31\n00:01:48,060 --> 00:01:51,070\nwant to go through the headache of\ndigitally signing your scripts.\n\n32\n00:01:51,070 --> 00:01:54,230\nAnd so,\nMicrosoft has several different tiers\n\n33\n00:01:54,230 --> 00:01:58,750\nof other types of scripts that we can run,\nand it really comes down to location.\n\n34\n00:01:58,750 --> 00:02:02,160\nDigitally signed scripts are trusted,\nand they're allowed to run.\n\n35\n00:02:03,790 --> 00:02:07,952\nUntrusted script, scripts that aren't\ndigitally signed, are not allowed to run,\n\n36\n00:02:07,952 --> 00:02:08,950\nall right?\n\n37\n00:02:08,950 --> 00:02:12,310\nAnd that's the default policy\nthat you've got in PowerShell.\n\n38\n00:02:12,310 --> 00:02:16,540\nSo when get a script from Microsoft,\nfor example, it will likely run, but\n\n39\n00:02:16,540 --> 00:02:18,740\nif you write your own,\nit's gonna be blocked.\n\n40\n00:02:20,000 --> 00:02:23,960\nNow, when we go to adjust the policy,\nwe can loosen those restrictions a bit.\n\n41\n00:02:23,960 --> 00:02:24,850\nAnd we can say, all right,\n\n42\n00:02:24,850 --> 00:02:29,370\nwell, we'll allow the system to run\nscripts in certain scenarios, all right.\n\n43\n00:02:29,370 --> 00:02:32,850\nAnd those scenarios all boil down\nto where the script is stored.\n\n44\n00:02:32,850 --> 00:02:36,920\nLocal scripts are ones that are stored\nright there on that machine.\n\n45\n00:02:36,920 --> 00:02:38,190\nYou're saying hey, I wrote a script.\n\n46\n00:02:38,190 --> 00:02:41,570\nIt's stored right here on the machine,\nand I wanna run it, all right.\n\n47\n00:02:41,570 --> 00:02:44,160\nSo we might wanna loosen\nthe policy to say, that's okay.\n\n48\n00:02:44,160 --> 00:02:47,400\nWe'll run digitally signed scripts, and\nthe ones that we've got locally stored.\n\n49\n00:02:48,660 --> 00:02:51,890\nBut you might have scripts that\nare stored on a network share, and\n\n50\n00:02:51,890 --> 00:02:53,070\nthose are not allowed.\n\n51\n00:02:53,070 --> 00:02:56,420\nSo we might have to loosen\nthe restrictions even more, and say yeah,\n\n52\n00:02:56,420 --> 00:03:00,100\nwe'll allow these untrusted scripts\nto run from a network store.\n\n53\n00:03:00,100 --> 00:03:01,610\nBut that's a problem.\n\n54\n00:03:01,610 --> 00:03:04,380\nBecause now if an attacker is\ntrying to get into your system,\n\n55\n00:03:04,380 --> 00:03:06,320\nwhere are their scripts gonna be?\n\n56\n00:03:06,320 --> 00:03:07,370\nNot locally, right?\n\n57\n00:03:07,370 --> 00:03:08,400\nThey'll be remote.\n\n58\n00:03:08,400 --> 00:03:10,650\nSo that's the exact thing\nyou don't want to do.\n\n59\n00:03:10,650 --> 00:03:14,980\nSo by adjusting this policy, you're\nweakening the security of your server.\n\n60\n00:03:14,980 --> 00:03:19,190\nMicrosoft's recommendation is,\nif you're going to be writing scripts,\n\n61\n00:03:19,190 --> 00:03:23,110\ndeploy a public key infrastructure, and\ndigitally sign all of your scripts.\n\n62\n00:03:23,110 --> 00:03:25,730\nBut most people don't\nhave that PKI in place.\n\n63\n00:03:25,730 --> 00:03:29,210\nSo the next best thing is,\n\n64\n00:03:29,210 --> 00:03:34,520\nonly run scripts that are digitally\nsigned or stored locally on that server.\n\n65\n00:03:34,520 --> 00:03:37,590\nOnes that have been copied to, or\nwritten right on that server, so\n\n66\n00:03:37,590 --> 00:03:41,160\nthat you can verify their\nauthenticity before you run them.\n\n67\n00:03:41,160 --> 00:03:43,180\nLet's take a look at those policies now,\nand how we can work with them, and\n\n68\n00:03:43,180 --> 00:03:44,810\nhow we can change them, all lright.\n\n69\n00:03:44,810 --> 00:03:48,620\nFirst off, you probably want to know what\nyour execution policy is to start with.\n\n70\n00:03:48,620 --> 00:03:54,190\nAnd we've got the get\ndash execution policy,\n\n71\n00:03:54,190 --> 00:03:59,060\nthere we go, commandlet and it'll\nreturn what policy we're in right now.\n\n72\n00:03:59,060 --> 00:04:03,210\nThere's four different policies, and for\nmost people restricted is the default.\n\n73\n00:04:03,210 --> 00:04:06,220\nI say most,\nbecause depending on who installed server,\n\n74\n00:04:06,220 --> 00:04:08,620\nthey can override that as part\nof the installation option.\n\n75\n00:04:08,620 --> 00:04:10,240\nSo it could have been changed or\n\n76\n00:04:10,240 --> 00:04:12,950\na group policy object could\nchange that setting too.\n\n77\n00:04:12,950 --> 00:04:16,050\nBut if you just do a default install\n,it's typically going to be restricted,\n\n78\n00:04:16,050 --> 00:04:18,460\nand that's what I'm in right here.\n\n79\n00:04:18,460 --> 00:04:23,170\nThat means that I will run digitally\nsigned certificates, I mean scripts and\n\n80\n00:04:23,170 --> 00:04:24,620\nthat's it all right.\n\n81\n00:04:24,620 --> 00:04:26,240\nI won't run any others.\n\n82\n00:04:26,240 --> 00:04:29,230\nSo for example i've written\na script here on my desktop.\n\n83\n00:04:30,420 --> 00:04:31,135\nAnd there it is.\n\n84\n00:04:31,135 --> 00:04:31,880\nCustomize.ps1.\n\n85\n00:04:31,880 --> 00:04:36,470\nThis is a script that I tote around\nthat customizes my user interface.\n\n86\n00:04:36,470 --> 00:04:39,220\nI'm not a big fan of the whole\nblue background, and\n\n87\n00:04:39,220 --> 00:04:40,260\nwhite text and all that stuff.\n\n88\n00:04:40,260 --> 00:04:43,990\nSo I manipulate it, and I just have\na little script that does that for me.\n\n89\n00:04:43,990 --> 00:04:50,518\nSo if I try and run that script,\nI get an error, all right.\n\n90\n00:04:50,518 --> 00:04:52,010\nIn the error a script cannot be loaded,\n\n91\n00:04:52,010 --> 00:04:54,600\nbecause running scripts is\ndisabled on this system.\n\n92\n00:04:54,600 --> 00:04:59,250\nFor more information, see about\nexecution policy at blah,blah,blah.\n\n93\n00:04:59,250 --> 00:05:01,200\nAnd so it's telling me to go enroute.\n\n94\n00:05:01,200 --> 00:05:06,620\nWell I can change that execution policy\nto allow for the scripts to run.\n\n95\n00:05:06,620 --> 00:05:10,520\nThe command that we use for that,\nis the set execution policy.\n\n96\n00:05:10,520 --> 00:05:14,260\nAnd if we pull up our help\ndocumentation on it, it's just,\n\n97\n00:05:14,260 --> 00:05:17,180\nset execution dash policy.\n\n98\n00:05:17,180 --> 00:05:21,370\nIt will give you the basic command syntax\nfor it, In the four different levels.\n\n99\n00:05:21,370 --> 00:05:24,740\nWhich actually it doesn't list\nthe four different levels, does it?\n\n100\n00:05:24,740 --> 00:05:27,030\nWell anyhow,\nlet's do the full output here, and\n\n101\n00:05:27,030 --> 00:05:32,240\nsee if it's included in the notes.\n\n102\n00:05:32,240 --> 00:05:33,630\nWell there's really just four levels.\n\n103\n00:05:33,630 --> 00:05:35,430\nRight?\nRestricted is the default.\n\n104\n00:05:35,430 --> 00:05:35,950\nOkay.\nThere are.\n\n105\n00:05:35,950 --> 00:05:36,870\nAll four of them.\n\n106\n00:05:36,870 --> 00:05:38,820\nSo, restricted is that default.\n\n107\n00:05:38,820 --> 00:05:41,390\nAnd, here they just call\nit all all signed, but\n\n108\n00:05:41,390 --> 00:05:45,660\nif I move up a little bit,\nthere we go, there's restricted.\n\n109\n00:05:45,660 --> 00:05:50,000\nSo restricted, and that means we're not\ngoing to let any scripts run whatsoever.\n\n110\n00:05:50,000 --> 00:05:53,390\nRestricted here we're actually\ndisabling all the scripts.\n\n111\n00:05:53,390 --> 00:05:58,440\nAll sign now we're saying, we'll let those\ndigitally signed ones run, but any non\n\n112\n00:05:58,440 --> 00:06:01,330\ndigitally signed ones or untrusted ones,\nwe're not going to let those run at all.\n\n113\n00:06:02,390 --> 00:06:05,230\nAfter that we start to get\ninto some of the weaker ones.\n\n114\n00:06:05,230 --> 00:06:06,620\nAnd the main ones that\nwe're going to deal with,\n\n115\n00:06:06,620 --> 00:06:10,326\nare these next two,\nremote signed and unrestricted.\n\n116\n00:06:10,326 --> 00:06:15,620\nThe remote signed says,\nI will allow digitally signed scripts,\n\n117\n00:06:15,620 --> 00:06:18,450\nwhether they are local or\nremote, i'll allow those to run.\n\n118\n00:06:19,860 --> 00:06:25,090\nBut, if it's remote and\nit's not signed, I won't let it run.\n\n119\n00:06:25,090 --> 00:06:27,370\nSo if it's remote it's gotta be signed.\n\n120\n00:06:27,370 --> 00:06:30,980\nIf it's local,\nit doesn't have to be signed.\n\n121\n00:06:30,980 --> 00:06:33,760\nRemote signed's what most\npeople switch to, because they\n\n122\n00:06:33,760 --> 00:06:37,220\nwant to make sure remote scripts don't\nrun unless they're digitally signed, but\n\n123\n00:06:37,220 --> 00:06:39,540\nlocally they want to allow them,\nall right?\n\n124\n00:06:39,540 --> 00:06:43,270\nAnd they can do that and allow that, and\nthen you'll have that certificate, or\n\n125\n00:06:43,270 --> 00:06:47,660\nyou'll have that script that you can run,\nwithout having to digitally sign it.\n\n126\n00:06:47,660 --> 00:06:49,660\nThe next one is unrestricted though,\nand that's the worst one.\n\n127\n00:06:49,660 --> 00:06:51,420\nAnd that's where we say we don't care.\n\n128\n00:06:51,420 --> 00:06:54,100\nWe'll run scripts from wherever,\nwho cares right.\n\n129\n00:06:54,100 --> 00:06:57,470\nAnd that'll run, and\nnow you open yourself up to vulnerability,\n\n130\n00:06:57,470 --> 00:07:00,485\ncuz somebody could have modified\nthat script, and you won't know.\n\n131\n00:07:00,485 --> 00:07:02,735\nYou've got no way to verify that\nmodifications haven't been made.\n\n132\n00:07:03,865 --> 00:07:05,705\nSo, those are the main ones that we go to.\n\n133\n00:07:05,705 --> 00:07:08,395\nThere's a few others like bypass,\nall right.\n\n134\n00:07:08,395 --> 00:07:11,355\nBypass basically just shuts\noff the polices all together.\n\n135\n00:07:11,355 --> 00:07:13,605\nWhich is very much like unrestricted.\n\n136\n00:07:13,605 --> 00:07:17,080\nAnd then undefined means\nwe don't have a policy.\n\n137\n00:07:17,080 --> 00:07:18,360\nYou're not normally\ngoing to have that one,\n\n138\n00:07:18,360 --> 00:07:21,270\nthat would be something like in a group\npolicy object ,when you say undefined,\n\n139\n00:07:21,270 --> 00:07:23,510\nand it would leave it up to the client\nto make their own decision.\n\n140\n00:07:23,510 --> 00:07:27,910\nSo those are some of the different\nvalues that we'll see.\n\n141\n00:07:27,910 --> 00:07:31,902\nBut the four main ones are,\nrestricted, remote signed,\n\n142\n00:07:31,902 --> 00:07:35,330\nunrestricted, and\nthat all signed right there.\n\n143\n00:07:36,620 --> 00:07:38,780\nAll right.\nSo how does this affect us?\n\n144\n00:07:38,780 --> 00:07:41,020\nWell, I couldn't run\nthat script a moment ago,\n\n145\n00:07:41,020 --> 00:07:44,520\nbecause I'm not allowing\nmy locally signed one.\n\n146\n00:07:44,520 --> 00:07:45,070\nAll right?\n\n147\n00:07:45,070 --> 00:07:46,730\nOr my locally unsigned ones.\n\n148\n00:07:46,730 --> 00:07:49,910\nSo, I might wanna change to remote signed.\n\n149\n00:07:49,910 --> 00:07:51,920\nI don't wanna run remote ones\nunless they're digitally signed,\n\n150\n00:07:51,920 --> 00:07:52,850\nbut local is okay.\n\n151\n00:07:52,850 --> 00:07:53,600\nI wanna allow it.\nAll right?\n\n152\n00:07:54,680 --> 00:07:57,510\nWell, let me just switch over\nto a PowerShell that was run\n\n153\n00:07:57,510 --> 00:07:59,290\nas an administrator,\nwhich is not this one.\n\n154\n00:08:00,560 --> 00:08:02,700\nI guess, let me launch\na PowerShell as an administrator.\n\n155\n00:08:04,550 --> 00:08:05,980\nAll right.\nAnd I'm gonna do\n\n156\n00:08:05,980 --> 00:08:11,750\nthe Set-ExecutionPolicy RemoteSigned,\nright?\n\n157\n00:08:11,750 --> 00:08:13,190\nI'm gonna flip it so\n\n158\n00:08:13,190 --> 00:08:18,460\nthat I'm going to allow local scripts\nto run, even if they're not signed.\n\n159\n00:08:18,460 --> 00:08:19,420\nAll right.\n\n160\n00:08:19,420 --> 00:08:24,280\nNow if I go back to my other PowerShell\nWhen I tried to run that script just\n\n161\n00:08:24,280 --> 00:08:26,380\na moment ago I got the big error,\n\n162\n00:08:26,380 --> 00:08:28,800\nthis guy right here where it\ntold me I wasn't allowed.\n\n163\n00:08:28,800 --> 00:08:34,700\nWell now I'm gonna rerun that command,\nI'm gonna rerun it, and this time it ran.\n\n164\n00:08:35,966 --> 00:08:39,540\nAll right, it ran and now I've got my\ngreen text with the black background,\n\n165\n00:08:39,540 --> 00:08:42,390\nthat I like so much, and\nit's laid out right here, and\n\n166\n00:08:42,390 --> 00:08:44,330\nit's got everything I need, all right.\n\n167\n00:08:44,330 --> 00:08:47,142\nSo, it let me run that script now,\nbecause we're in that remote signed mode.\n\n168\n00:08:47,142 --> 00:08:50,530\nAll right now,\nwhat if I didn't run it from here?\n\n169\n00:08:51,780 --> 00:08:54,260\nWhat if I ran it from\na network location instead?\n\n170\n00:08:56,702 --> 00:09:00,370\nAll right, well I copied that\nover to a map network drive, and\n\n171\n00:09:00,370 --> 00:09:06,190\nif I go over here and run it,\nI still get a failure.\n\n172\n00:09:06,190 --> 00:09:08,430\nThat's the same exact\nscript I ran a moment ago.\n\n173\n00:09:08,430 --> 00:09:11,880\nThe difference is the script I ran\na moment ago is right here on my C drive,\n\n174\n00:09:11,880 --> 00:09:15,130\nright on the local system,\nthis one is on a mapped drive.\n\n175\n00:09:15,130 --> 00:09:18,730\nX colon, I mapped that here to\nanother server here in the office, and\n\n176\n00:09:18,730 --> 00:09:22,980\nit's telling me that it can't run, and\nthat's because of my execution policy.\n\n177\n00:09:22,980 --> 00:09:26,245\nIt's not allowed to run because it's\nremote, and it's not digitally signed.\n\n178\n00:09:29,010 --> 00:09:29,810\nAll right.\n\n179\n00:09:29,810 --> 00:09:32,930\nIf I go and\nI switch my policy to unrestricted,\n\n180\n00:09:32,930 --> 00:09:35,310\nwhich is a really bad idea,\nbut we'll do it.\n\n181\n00:09:37,280 --> 00:09:39,700\nRight, so\nI'll switch over to unrestricted,\n\n182\n00:09:39,700 --> 00:09:45,290\nnow I can run scripts from wherever, and\nif I jump back over here, I can try and\n\n183\n00:09:45,290 --> 00:09:50,040\nrun the script from my network share,\nand now it's just giving me a warning.\n\n184\n00:09:51,250 --> 00:09:54,230\nAnd I can say, see in that warning\nright there, that's actually the,\n\n185\n00:09:54,230 --> 00:09:55,960\nactually I need to say r for run.\n\n186\n00:09:55,960 --> 00:10:01,210\nThat's the difference between\nunrestricted and bypass.\n\n187\n00:10:01,210 --> 00:10:04,010\nWhen you say unrestricted,\nyou're saying any script can run.\n\n188\n00:10:04,010 --> 00:10:06,920\nBypass you're disabling the check so\nany script can run.\n\n189\n00:10:06,920 --> 00:10:08,060\nThe difference is this warning.\n\n190\n00:10:08,060 --> 00:10:10,620\nIf you have bypass you\nwon't even get the warning.\n\n191\n00:10:10,620 --> 00:10:14,350\nSo when I do this, I'll just hit Run Once,\nand it's gonna run, and\n\n192\n00:10:14,350 --> 00:10:16,690\nthere's my customizations, right?\n\n193\n00:10:16,690 --> 00:10:20,710\nSo nice little set of security policies,\n\n194\n00:10:20,710 --> 00:10:24,020\nvery easy to modify,\nit's the default that trips people up.\n\n195\n00:10:24,020 --> 00:10:26,640\nI've heard from people where they said,\nman, PowerShell is just not working for\n\n196\n00:10:26,640 --> 00:10:28,880\nme, it won't run my scripts.\n\n197\n00:10:28,880 --> 00:10:30,570\nAnd I say well what\nhappened when you ran it?\n\n198\n00:10:30,570 --> 00:10:32,140\nThey say I got an error.\n\n199\n00:10:32,140 --> 00:10:35,760\nAnd then I say one of my favorite things,\nwhich is well did you read the error?\n\n200\n00:10:35,760 --> 00:10:38,670\nSometimes it tells you what's going on,\nand they'll say well, ya know,\n\n201\n00:10:38,670 --> 00:10:40,380\nI really didn't.\n\n202\n00:10:40,380 --> 00:10:42,950\nAnd it's right there you,\njust have to change that execution policy.\n\n203\n00:10:42,950 --> 00:10:48,450\nI'm gonna move mine back to remote signed.\n\n204\n00:10:48,450 --> 00:10:49,240\nAnd when I do that.\n\n205\n00:10:52,020 --> 00:10:56,050\nNow I'll to be back to where I\ncan't run scripts off the network,\n\n206\n00:10:56,050 --> 00:10:57,070\nunless they're digitally signed.\n\n207\n00:10:58,410 --> 00:10:58,980\nAll right.\n\n208\n00:10:58,980 --> 00:11:04,720\nSo those are the execution policies\nthat we have inside of PowerShell.\n\n209\n00:11:04,720 --> 00:11:09,210\nNow for digitally signed scripts, there's\nactually several different steps you have\n\n210\n00:11:09,210 --> 00:11:13,450\nto go through to sign one, and it's\na little beyond the scope of this segment.\n\n211\n00:11:13,450 --> 00:11:14,330\nSo I'm going to save that.\n\n212\n00:11:14,330 --> 00:11:17,430\nI will probably do another segment later,\nto show how to digitally sign them.\n\n213\n00:11:17,430 --> 00:11:19,590\nBecause it's kind of\nintegrated with Visual Studio.\n\n214\n00:11:19,590 --> 00:11:22,580\nSo you have to create your\nscript there and sign it.\n\n215\n00:11:22,580 --> 00:11:26,350\nAnd I know they added some of the base\nfunctionality into ISE, but I don't,\n\n216\n00:11:26,350 --> 00:11:31,020\nactually I've never signed a script in\nISE, so I'm not sure if it'll do it there.\n\n217\n00:11:31,020 --> 00:11:33,910\nBut it is a little bit more\nof an involved process.\n\n218\n00:11:33,910 --> 00:11:38,240\nBut for our database scripting,\nyou might choose to flip on remote signed,\n\n219\n00:11:38,240 --> 00:11:41,090\nrun your local script, and\nthen flip it back to restricted again.\n\n220\n00:11:41,090 --> 00:11:41,830\nAll right.\n\n221\n00:11:41,830 --> 00:11:43,150\nIf you're not running\nscripts all the time,\n\n222\n00:11:43,150 --> 00:11:46,420\nyou don't need to leave the policies\nset a particular way for a long period.\n\n223\n00:11:46,420 --> 00:11:49,230\nSo, you've got options with\nhow you wanna manipulate that,\n\n224\n00:11:49,230 --> 00:11:50,420\njust remember that you can.\n\n225\n00:11:50,420 --> 00:11:52,450\nYou have the different options\nthat are available to you,\n\n226\n00:11:52,450 --> 00:11:54,230\nand pick the one that meets your needs.\n\n227\n00:11:55,430 --> 00:11:58,420\nAll right, so in this segment, we got\na chance to take a look at the execution\n\n228\n00:11:58,420 --> 00:12:00,580\npolicies that are a part of PowerShell,\nand\n\n229\n00:12:00,580 --> 00:12:04,545\nhow they influence us\nbeing able to run scripts.\n\n230\n00:12:04,545 --> 00:12:10,285\nI hope you guys enjoyed this segment.\n\n231\n00:12:10,285 --> 00:12:14,285\nStay tuned, we've got more\nPowerShell coming down the road.\n\n",
          "vimeoId": "113925109"
        },
        {
          "description": "",
          "length": "2024",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-10-customizing-the-interface-120314.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-10-customizing-the-interface-120314-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-10-customizing-the-interface-120314-sm.jpg",
          "title": "Customizing the Interface",
          "transcript": "1\n00:00:00,000 --> 00:00:07,841\n[SOUND].\n\n2\n00:00:07,841 --> 00:00:08,666\nIn this segment,\n\n3\n00:00:08,666 --> 00:00:12,031\nwe're gonna take a look at customizing\nthe PowerShell user interface.\n\n4\n00:00:13,090 --> 00:00:15,510\nBelieve it or not,\nwhen you fire up the PowerShell,\n\n5\n00:00:15,510 --> 00:00:19,420\nit may not actually be visually aligned\nto the way that you expect it to be,\n\n6\n00:00:19,420 --> 00:00:21,670\nor in a way that you find pleasant.\n\n7\n00:00:21,670 --> 00:00:25,250\nIn fact, if you ask me, I really hate the\ndefault configuration in PowerShell, and\n\n8\n00:00:25,250 --> 00:00:26,380\nfind it pretty unusable.\n\n9\n00:00:26,380 --> 00:00:27,980\nLet me show you what I mean.\n\n10\n00:00:27,980 --> 00:00:31,410\nIf I fire up the PowerShell here on\nthis server, I'm just gonna launch it,\n\n11\n00:00:31,410 --> 00:00:36,730\nit's gonna pop up and for me, if I'm\nsitting at the computer, this font size,\n\n12\n00:00:36,730 --> 00:00:40,940\nthis color scheme, the arrangement\nof the window, it's suitable.\n\n13\n00:00:40,940 --> 00:00:42,270\nIt's enough to get by.\n\n14\n00:00:42,270 --> 00:00:45,850\nBut I find as I get older,\nI appreciate larger text a little more.\n\n15\n00:00:45,850 --> 00:00:50,470\nAnd especially on the show, I always wanna\nhave a larger font, and larger layouts.\n\n16\n00:00:50,470 --> 00:00:53,840\nTo make it more clear, so\nit shows up better in the recording.\n\n17\n00:00:53,840 --> 00:00:57,090\nAnd so, I've gotten in the habit\nof kind of rearranging,\n\n18\n00:00:57,090 --> 00:01:01,550\nchanging the PowerShell to match\nmy own personal needs, all right?\n\n19\n00:01:01,550 --> 00:01:03,870\nNow there's a few different\nways we can go about that.\n\n20\n00:01:03,870 --> 00:01:08,400\nWe can set various things to customize it,\nand one of the problems we have,\n\n21\n00:01:08,400 --> 00:01:12,290\nis that some of those settings\ndon't last through a ,uh, you know,\n\n22\n00:01:12,290 --> 00:01:15,240\nclosing the PowerShell and opening it\nagain, we start to lose our settings.\n\n23\n00:01:15,240 --> 00:01:18,080\nOr if we go around to multiple computers,\n\n24\n00:01:18,080 --> 00:01:20,800\nhow do you create that\nconsistent view across them?\n\n25\n00:01:20,800 --> 00:01:23,030\nSo I'm gonna show a couple of\ndifferent way to handle that.\n\n26\n00:01:23,030 --> 00:01:25,330\nWe're gonna customize this interface, and\n\n27\n00:01:25,330 --> 00:01:28,450\ncreate a script to be able to solve\nsome of the problems that we can have.\n\n28\n00:01:28,450 --> 00:01:32,080\nSo that's we're were gonna\nbe going in this segment.\n\n29\n00:01:32,080 --> 00:01:34,050\nSo let's just start with\nthe PowerShell itself, and\n\n30\n00:01:34,050 --> 00:01:36,700\nwe're gonna fo the easy route on this one.\n\n31\n00:01:36,700 --> 00:01:39,810\nThe easiest way to change\nthe way the powershell looks,\n\n32\n00:01:39,810 --> 00:01:42,660\nis right here through\nthe graphical user interface.\n\n33\n00:01:42,660 --> 00:01:47,000\nIn my title bar for the Windows\nPowerShell, we can right click and\n\n34\n00:01:47,000 --> 00:01:49,520\nyou can go to properties.\n\n35\n00:01:49,520 --> 00:01:51,730\nAnd IN the properties tab for\nthe PowerShell window,\n\n36\n00:01:51,730 --> 00:01:54,580\nyou'll be able to go in and\nchange all sorts of things.\n\n37\n00:01:54,580 --> 00:01:56,070\nThe size of your cursor.\n\n38\n00:01:56,070 --> 00:01:58,360\nThe buffer size for your command history.\n\n39\n00:01:58,360 --> 00:02:00,420\nNotice I've got mine set to 50, right.\n\n40\n00:02:00,420 --> 00:02:02,060\nThe default is actually 64.\n\n41\n00:02:02,060 --> 00:02:04,490\nApparently I messed with that,\nbut you could go through and\n\n42\n00:02:04,490 --> 00:02:06,620\nstart to adjust things like that.\n\n43\n00:02:06,620 --> 00:02:10,350\nUnder the font, we could choose\nwhat font is going to be rendering,\n\n44\n00:02:10,350 --> 00:02:13,520\nnow the font that it uses is\ncalled a raster font, and\n\n45\n00:02:13,520 --> 00:02:16,990\nMicrosoft likes to use those\nbecause they scale really well.\n\n46\n00:02:16,990 --> 00:02:19,480\nIf you have high resolution or\nlow resolution monitors.\n\n47\n00:02:19,480 --> 00:02:21,800\nRaster fonts pretty much look the same.\n\n48\n00:02:21,800 --> 00:02:24,440\nBut, if you've got a high\nresolution monitor,\n\n49\n00:02:24,440 --> 00:02:27,040\nthe default raster font is really,\nreally tiny.\n\n50\n00:02:27,040 --> 00:02:31,150\nSo at a minimum, we may wanna\nbump up the size of that font.\n\n51\n00:02:31,150 --> 00:02:33,740\nPersonally, I like to switch to\na different font altogether, and\n\n52\n00:02:33,740 --> 00:02:37,690\nyou'll see there's only a couple\navailable, Consolas and Lucida Console.\n\n53\n00:02:38,700 --> 00:02:42,450\nThese are both console fonts, and\nthat means that they have a fixed width.\n\n54\n00:02:42,450 --> 00:02:45,715\nFixed width is really important for\na font in PowerShell,\n\n55\n00:02:45,715 --> 00:02:50,220\nbecause It's really all text based, but\nsometimes it almost looks like a picture.\n\n56\n00:02:50,220 --> 00:02:53,130\nYou guys have seen at this point where\nwe have outputs arranged like a table,\n\n57\n00:02:53,130 --> 00:02:55,830\nwhere it needs the columns to\nall be the same width, and\n\n58\n00:02:55,830 --> 00:02:58,700\na lot of fonts have variable widths for\nletters.\n\n59\n00:02:58,700 --> 00:03:03,590\nSo like the letter W, might be a lot\nwider than the letter I, and that causes\n\n60\n00:03:03,590 --> 00:03:07,830\na problem when you're trying to draw,\nwell basically antsy art on the screen.\n\n61\n00:03:07,830 --> 00:03:10,496\nSo we need a fixed font.\n\n62\n00:03:10,496 --> 00:03:14,270\nThe thing is that PowerShell is being\ncalled to a very low level in Windows, and\n\n63\n00:03:14,270 --> 00:03:16,020\nso it doesn't have access to most fonts.\n\n64\n00:03:16,020 --> 00:03:17,290\nThey're not even available.\n\n65\n00:03:17,290 --> 00:03:20,985\nSo you might have a hundred different\nfonts on your computer, but\n\n66\n00:03:20,985 --> 00:03:23,060\nPowerShell will only show these three.\n\n67\n00:03:23,060 --> 00:03:26,680\nThese are the three that Microsoft\nhas developed and attached to it.\n\n68\n00:03:26,680 --> 00:03:31,260\nNow Lucida Console and Consolas,\nthey're traditional fonts,\n\n69\n00:03:31,260 --> 00:03:32,770\nlike what a lot of us will use.\n\n70\n00:03:32,770 --> 00:03:36,720\nand you'll see that you can pick the font\nsize here based on the pixel height.\n\n71\n00:03:36,720 --> 00:03:38,950\nHow many pixels tall each letter is.\n\n72\n00:03:38,950 --> 00:03:40,930\nAnd I usually bump mine\nup to something like 14.\n\n73\n00:03:40,930 --> 00:03:43,940\nHere on this show,\nI'll normally go even higher to 18,\n\n74\n00:03:43,940 --> 00:03:47,510\nto be able to get it to show up\nnice in the recordings, right?\n\n75\n00:03:47,510 --> 00:03:48,760\nAnd you get a little preview down here,\n\n76\n00:03:48,760 --> 00:03:50,450\nthat lets you know what\nit's gonna be like.\n\n77\n00:03:52,510 --> 00:03:54,930\nThe layout tab is probably\nthe most important, though.\n\n78\n00:03:54,930 --> 00:03:58,230\nThere's two sections here in the layout\ntab that I like to manipulate.\n\n79\n00:03:58,230 --> 00:04:01,561\nThe top part is the screen buffer, and the\nmiddle part is the window size, all right.\n\n80\n00:04:02,890 --> 00:04:06,300\nThe screen buffer is basically what\nyou can scroll back, all right.\n\n81\n00:04:07,450 --> 00:04:10,680\nAs we start running commands and\ndoing things in the PowerShell.\n\n82\n00:04:10,680 --> 00:04:12,760\nThings are gonna go off our screen, right?\n\n83\n00:04:12,760 --> 00:04:15,260\nSo for\nexample if I go back to my PowerShell, and\n\n84\n00:04:15,260 --> 00:04:17,500\nyou'll see my new font has taken effect.\n\n85\n00:04:17,500 --> 00:04:20,540\nIf I do get-service,\nhere's all my services.\n\n86\n00:04:20,540 --> 00:04:23,130\nWell it was more than what would\nfit on this one screen, so\n\n87\n00:04:23,130 --> 00:04:24,955\nI got to scroll back to get to those.\n\n88\n00:04:24,955 --> 00:04:27,012\nAnd as I scroll back I can see them,\nthat's wonderful, right.\n\n89\n00:04:28,075 --> 00:04:32,795\nWell, if I keep doing things like this,\nif I do, for example, like a,\n\n90\n00:04:32,795 --> 00:04:38,185\nlet's do a, something like that.\n\n91\n00:04:39,290 --> 00:04:43,140\nOh you know what,\nit's not going to let me do that, is it?\n\n92\n00:04:43,140 --> 00:04:43,950\nWhat would be a good one?\n\n93\n00:04:43,950 --> 00:04:49,890\nWell, I guess we could kind of, let's do\nget-windowsfeature, that's a good one.\n\n94\n00:04:49,890 --> 00:04:52,410\nNow, when I start running these\ncommands that are multi-screen,\n\n95\n00:04:52,410 --> 00:04:55,840\nyou'll notice my scroll bar moving\ndown the line as it runs, right?\n\n96\n00:04:55,840 --> 00:04:59,130\nGenerating that output, and,\nas I start to scroll back.\n\n97\n00:05:00,320 --> 00:05:02,390\nSee how my get-service is gone?\n\n98\n00:05:02,390 --> 00:05:04,360\nI can't scroll back to that anymore.\n\n99\n00:05:04,360 --> 00:05:08,400\nThat's because my buffer is only\nset to a certain amount of lines.\n\n100\n00:05:08,400 --> 00:05:12,170\nWell personally, I like to be able\nto scroll back a good distance,\n\n101\n00:05:12,170 --> 00:05:16,290\nto see commands that I might have run 20\ncommands ago, and to see their output.\n\n102\n00:05:16,290 --> 00:05:18,940\nI can always look at the history\nfrom my commands, but\n\n103\n00:05:18,940 --> 00:05:20,960\nI don't see the output in the history.\n\n104\n00:05:20,960 --> 00:05:24,730\nWhen you get to -history,\nit's just showing the commands you ran.\n\n105\n00:05:24,730 --> 00:05:27,620\nIt's not actually showing\nyou what the output was.\n\n106\n00:05:27,620 --> 00:05:31,160\nSo bumping up that buffer is really handy.\n\n107\n00:05:31,160 --> 00:05:32,140\nThere's two bumpers.\n\n108\n00:05:32,140 --> 00:05:33,310\nThere's the vertical bumper.\n\n109\n00:05:33,310 --> 00:05:34,190\nThat's your scroll back.\n\n110\n00:05:34,190 --> 00:05:35,290\nThat's what I just showed you right here.\n\n111\n00:05:35,290 --> 00:05:37,720\nThis is how far back I can go vertically.\n\n112\n00:05:37,720 --> 00:05:40,520\nAnd there's a horizontal buffer\nwhich would be left and right.\n\n113\n00:05:40,520 --> 00:05:43,550\nI don't find that one terribly useful,\nso I don't normally mess with it, but\n\n114\n00:05:43,550 --> 00:05:46,070\nif you have data that runs off\nthe right side of your screen,\n\n115\n00:05:46,070 --> 00:05:48,250\nit'll enable you to be able to view that.\n\n116\n00:05:48,250 --> 00:05:50,150\nSo if I go back into my properties.\n\n117\n00:05:51,260 --> 00:05:55,860\nI can go to my layout, and under screen\nbuffer, the width is set to 80, and\n\n118\n00:05:55,860 --> 00:05:57,170\nI'm fine with that.\n\n119\n00:05:57,170 --> 00:06:00,150\nI don't need to see things off\nthe edge of my screen, but\n\n120\n00:06:00,150 --> 00:06:01,470\nthe height is only set to 300.\n\n121\n00:06:01,470 --> 00:06:05,250\nI'm gonna bump that up to 3,000,\nall right?\n\n122\n00:06:05,250 --> 00:06:06,970\nWhen I bump that up to 3,000,\n\n123\n00:06:06,970 --> 00:06:11,390\nnow it's gonna store the last\n3,000 lines that I've run.\n\n124\n00:06:11,390 --> 00:06:14,430\nSo as I run something like get-service,\nall right,\n\n125\n00:06:14,430 --> 00:06:16,150\nsure that was more than one screen.\n\n126\n00:06:16,150 --> 00:06:20,080\nAnd when I run get dash Windows feature,\nit's going to run that.\n\n127\n00:06:20,080 --> 00:06:22,730\nThat's more than one screen,\nI think I ran it three times a moment ago.\n\n128\n00:06:22,730 --> 00:06:24,930\nSo let me run it three times again.\n\n129\n00:06:24,930 --> 00:06:28,930\nAnd when I run it, well, see how my scroll\nbar is not all the way to the bottom.\n\n130\n00:06:28,930 --> 00:06:30,140\nThat means I've still got buffer room,\n\n131\n00:06:30,140 --> 00:06:32,680\nI've got all this buffer\nroom still available.\n\n132\n00:06:32,680 --> 00:06:37,350\nBut if I start to scroll back, there's\nthe output from Get-Windows feature, and\n\n133\n00:06:37,350 --> 00:06:39,400\nhere's the output for Get-Service.\n\n134\n00:06:39,400 --> 00:06:40,960\nI can scroll back and see that.\n\n135\n00:06:40,960 --> 00:06:44,590\nIt's really handy, especially if you're\ndealing with large amounts of output,\n\n136\n00:06:44,590 --> 00:06:47,525\nto have a good bit of scroll back buffer.\n\n137\n00:06:48,575 --> 00:06:51,155\nAnd if you've been scrolling around like\nthis, you can always just push enter and\n\n138\n00:06:51,155 --> 00:06:52,655\nit will jump right back to your prompt and\n\n139\n00:06:52,655 --> 00:06:55,265\nget you, kind of,\nback to the current line.\n\n140\n00:06:55,265 --> 00:06:56,775\nSo definitely a neat thing to set.\n\n141\n00:06:56,775 --> 00:06:59,630\nI almost always bump up\nmy scrollback buffer.\n\n142\n00:06:59,630 --> 00:07:00,560\nI usually go to 5,000 lines.\n\n143\n00:07:01,750 --> 00:07:04,690\nDo be aware, that scrollback buffer,\nit is being stored in RAM, and so\n\n144\n00:07:04,690 --> 00:07:05,440\nit consumes memory.\n\n145\n00:07:05,440 --> 00:07:08,450\nBut we're just talking about text here.\n\n146\n00:07:08,450 --> 00:07:12,850\nSo 5000 lines of text, usually adds up to\nless than about 100 kilobytes of data.\n\n147\n00:07:12,850 --> 00:07:14,680\nSo you're not talking about\na huge amount of memory.\n\n148\n00:07:14,680 --> 00:07:17,860\nBut the bigger you make that buffer,\nthe more memory it is taking.\n\n149\n00:07:19,370 --> 00:07:22,570\nAll right, so those are a few\nof the things that we can tweak.\n\n150\n00:07:22,570 --> 00:07:24,690\nLet's look at some of the other ones.\n\n151\n00:07:24,690 --> 00:07:27,500\nNow, on high resolution monitors,\n\n152\n00:07:27,500 --> 00:07:30,570\nyou likely have a lot of screen\nreal estate, a lot of room.\n\n153\n00:07:30,570 --> 00:07:34,390\nWhat I was adjusting there was a virtual\nsize for my window, my buffer, but\n\n154\n00:07:34,390 --> 00:07:37,150\nyou also have the physical\nsize of the window.\n\n155\n00:07:37,150 --> 00:07:39,650\nRight now,\nmy window's only 80 characters wide.\n\n156\n00:07:39,650 --> 00:07:41,730\nI've got plenty of extra\nroom here on the screen.\n\n157\n00:07:41,730 --> 00:07:43,350\nI might want to go up to\nsomething like 110, all right.\n\n158\n00:07:44,390 --> 00:07:49,380\nSo I'll bump it up to 110 characters,\nso it's a wider window.\n\n159\n00:07:49,380 --> 00:07:53,640\nAnd my height is set to 26 characters,\nbut I've got more room vertically.\n\n160\n00:07:53,640 --> 00:07:56,583\nSo I might wanna bump that up,\nmaybe I'll go to 32.\n\n161\n00:07:56,583 --> 00:07:57,490\nAll right.\n\n162\n00:07:57,490 --> 00:07:59,583\nSo we can bump those in.\n\n163\n00:07:59,583 --> 00:08:00,860\nAnd get those set.\n\n164\n00:08:00,860 --> 00:08:02,792\nThe last part here is the window position.\n\n165\n00:08:02,792 --> 00:08:05,159\nAnd I never bother setting that\nbecause you can just drag and\n\n166\n00:08:05,159 --> 00:08:06,208\nmove the window, right.\n\n167\n00:08:06,208 --> 00:08:08,870\nBut if you want to have some\nsort of initial position,\n\n168\n00:08:08,870 --> 00:08:12,970\nyou specify the left most pixel and\nthe top most pixel you want in the window.\n\n169\n00:08:12,970 --> 00:08:15,720\nSo you're basically arranging\nthis corner right here.\n\n170\n00:08:15,720 --> 00:08:17,640\nSo that's why my numbers are nice and\nlow right now,\n\n171\n00:08:17,640 --> 00:08:20,100\nif I were to move this down to the bottom\nright, the numbers would get really big.\n\n172\n00:08:22,150 --> 00:08:24,400\nWhen I say okay,\nthose changes are gonna take effect,\n\n173\n00:08:24,400 --> 00:08:29,040\nand you'll see that my PowerShell\nnow fills a lot more of my screen.\n\n174\n00:08:29,040 --> 00:08:33,160\nNow I can start to take advantage of\nthe high resolution that I've got, and\n\n175\n00:08:33,160 --> 00:08:38,020\nwhen I start to run things like\nget-windowsfeature, I'll see\n\n176\n00:08:38,020 --> 00:08:41,860\nthat some of the things that we're getting\ntruncated, aren't being truncated anymore.\n\n177\n00:08:41,860 --> 00:08:45,780\nThat it's gotta a little more room to\nwrite and it'll take advantage of that.\n\n178\n00:08:45,780 --> 00:08:50,630\nEspecially if your running it through\nsomething like format-wide or\n\n179\n00:08:50,630 --> 00:08:51,450\nother utilities.\n\n180\n00:08:51,450 --> 00:08:54,640\nIt gives you more room to be\nable to lay those out too.\n\n181\n00:08:54,640 --> 00:08:56,540\nDefinitely nice to take advantage of that.\n\n182\n00:08:56,540 --> 00:08:59,940\nYou'll notice in PowerShell that, it\ndoesn't really give you the ability to go\n\n183\n00:08:59,940 --> 00:09:01,680\nthrough and\nstart manipulating things like this.\n\n184\n00:09:01,680 --> 00:09:05,100\nIf I manipulate it,\nsee how I have a scroll bar now?\n\n185\n00:09:05,100 --> 00:09:08,420\nSo even though I've made\nthe physical window smaller,\n\n186\n00:09:08,420 --> 00:09:13,380\nI still have a 110 wide window,\nI'm just not seeing all of it, right.\n\n187\n00:09:13,380 --> 00:09:16,600\nSo it doesn't actually redo my output.\n\n188\n00:09:16,600 --> 00:09:19,320\nSo if I start running a long command here.\n\n189\n00:09:19,320 --> 00:09:22,670\nSo this is going to be\na very long command.\n\n190\n00:09:24,500 --> 00:09:26,640\nAnd it will wrap around the screen, right.\n\n191\n00:09:26,640 --> 00:09:29,740\nSo I'm typing and\nsee what's happening here?\n\n192\n00:09:29,740 --> 00:09:34,900\nInstead of wrapping around the screen,\nit's just scrolling me over, right.\n\n193\n00:09:34,900 --> 00:09:38,870\nIf I made my actual window size smaller,\nif I changed it to say it was only\n\n194\n00:09:38,870 --> 00:09:41,830\n60 characters wide, then at 60 characters,\nit would screen wrap.\n\n195\n00:09:41,830 --> 00:09:44,150\nAnd it would just jump me\ndown to the next line.\n\n196\n00:09:44,150 --> 00:09:48,070\nBut as long as I've got my width set\nhigher, it's gonna continue to write, and\n\n197\n00:09:48,070 --> 00:09:49,650\nit'll create that scroll line.\n\n198\n00:09:49,650 --> 00:09:52,900\nSo just something to be aware of there's\nyou tweak that window to match the size\n\n199\n00:09:52,900 --> 00:09:53,470\nthat you need to be.\n\n200\n00:09:53,470 --> 00:09:55,160\nAll right,\n\n201\n00:09:55,160 --> 00:09:59,200\nnow these are all nice things to do,\nbump up the font size, change the font,\n\n202\n00:09:59,200 --> 00:10:03,510\nbump up the window size, definitely\nbump up that scroll back buffer, right.\n\n203\n00:10:03,510 --> 00:10:05,260\nThe vertical buffer.\n\n204\n00:10:05,260 --> 00:10:07,470\nThose are all things we want to adjust.\n\n205\n00:10:07,470 --> 00:10:10,570\nAnother thing I like to\nadjust is the color scheme.\n\n206\n00:10:10,570 --> 00:10:12,830\nThe color scheme of white on blue.\n\n207\n00:10:12,830 --> 00:10:15,800\nWell that was a prominent\none like back in the 90s,\n\n208\n00:10:15,800 --> 00:10:19,523\nif you ran WordStar or\nWordPerfect, like WordPerfect 5.1,\n\n209\n00:10:19,523 --> 00:10:22,760\nway back blue background,\nwhite text, really, really common.\n\n210\n00:10:23,850 --> 00:10:26,530\nBut in today's world it's not\nnecessarily the most common.\n\n211\n00:10:26,530 --> 00:10:30,240\nSo you might wanna change that to\nsome other arrangement that you like.\n\n212\n00:10:30,240 --> 00:10:33,020\nMicrosoft picked this one because they\nwanted to make sure that it was easy for\n\n213\n00:10:33,020 --> 00:10:38,290\nyou to differentiate, whether you are in\na command prompt or a PowerShell.\n\n214\n00:10:38,290 --> 00:10:41,970\nBut if you're not worried about that, if\nthis PS indicator right here is enough for\n\n215\n00:10:41,970 --> 00:10:45,080\nyou, you might wanna go back\nto the old DOS configuration.\n\n216\n00:10:45,080 --> 00:10:47,320\nSo you could go in here,\ninto your properties.\n\n217\n00:10:48,660 --> 00:10:52,870\nAnd go into colors, and here you\ncan change the color of your text,\n\n218\n00:10:52,870 --> 00:10:57,150\nyour background, and pop ups which\nwe don't really get in PowerShell.\n\n219\n00:10:57,150 --> 00:11:02,740\nI can take my screen text and maybe I want\nto, I'll leave that gray that's fine.\n\n220\n00:11:02,740 --> 00:11:06,080\nAnd then for the screen background,\nmaybe I want it to be black.\n\n221\n00:11:06,080 --> 00:11:09,940\nSo I'll go ahead and send it to me black\nso it looks like a regular command prompt.\n\n222\n00:11:09,940 --> 00:11:12,360\nNow when I say okay to that,\nthe blue is gone,\n\n223\n00:11:12,360 --> 00:11:14,350\nnow it looks like\na regular command prompt.\n\n224\n00:11:14,350 --> 00:11:16,320\nAnd I know,\nbecause I've got a PS right there,\n\n225\n00:11:16,320 --> 00:11:19,230\nin my prompt, that, that's all I need.\n\n226\n00:11:19,230 --> 00:11:22,070\nI know I'm in PowerShell, I don't need\nanything special telling me otherwise.\n\n227\n00:11:23,480 --> 00:11:26,990\nSo I've got all that set, and\nthe nice part about this is,\n\n228\n00:11:26,990 --> 00:11:33,020\nif I close my window and I open it again,\nit remembers it, all right.\n\n229\n00:11:33,020 --> 00:11:37,580\nIt's modified that shortcut to\ninclude the changes that we've made.\n\n230\n00:11:37,580 --> 00:11:41,840\nSo very easy to customize that user\ninterface to match what works for\n\n231\n00:11:41,840 --> 00:11:46,120\nyour system, and if we go and\ndo run as an administrator,\n\n232\n00:11:46,120 --> 00:11:49,580\nwe'll see that that gets the settings too,\nso whether you're running as just\n\n233\n00:11:49,580 --> 00:11:53,610\na regular user or just administrator,\nit's tied to you, your user account.\n\n234\n00:11:53,610 --> 00:11:55,830\nThe registry is storing these settings and\n\n235\n00:11:55,830 --> 00:11:58,950\nnow it will launch with\nthe settings that you want.\n\n236\n00:11:58,950 --> 00:12:04,920\nThe only problem with this,\nis that it's just on this one computer.\n\n237\n00:12:04,920 --> 00:12:06,430\nIf I go to another computer and\n\n238\n00:12:06,430 --> 00:12:10,230\nfire up the PowerShell, it's not gonna\nremember these settings I put in place,\n\n239\n00:12:10,230 --> 00:12:13,200\nand the PowerShell on the other computer\nis gonna launch the blue background, and\n\n240\n00:12:13,200 --> 00:12:17,050\nthe white foreground, and so\nthat's going to kind of mess things up.\n\n241\n00:12:17,050 --> 00:12:21,000\nSo what we need to do\nis we need to jump in,\n\n242\n00:12:21,000 --> 00:12:25,140\nand find a way to get this to\nwork that we can automate.\n\n243\n00:12:25,140 --> 00:12:25,890\nThat we can script,\n\n244\n00:12:25,890 --> 00:12:28,740\nthat we can have be a part of our\nuser profile that roams with us.\n\n245\n00:12:28,740 --> 00:12:32,490\nOr that we can at least quickly apply to\nmake these settings without having to go\n\n246\n00:12:32,490 --> 00:12:34,860\nthrough, and adjust it every\nsingle time we log into a system.\n\n247\n00:12:35,940 --> 00:12:38,190\nSo that's what I want to show you next.\n\n248\n00:12:38,190 --> 00:12:41,600\nBut what you've seen so\nfar like using the graphical interface and\n\n249\n00:12:41,600 --> 00:12:42,730\nit's definitely the easiest.\n\n250\n00:12:42,730 --> 00:12:45,190\nYou just browse through,\npick your options and you're done.\n\n251\n00:12:45,190 --> 00:12:46,160\nAll right.\n\n252\n00:12:46,160 --> 00:12:48,540\nSame thing works for\nthe regular Windows command prompt.\n\n253\n00:12:48,540 --> 00:12:51,000\nSo if you wanna customize\nthat you can too.\n\n254\n00:12:51,000 --> 00:12:53,650\nSame exact process based on the GUI.\n\n255\n00:12:53,650 --> 00:12:54,240\nRight.\n\n256\n00:12:54,240 --> 00:12:57,290\nFrom the regular command prompt though,\nthat's the only way you've got.\n\n257\n00:12:57,290 --> 00:12:58,500\nIn PowerShell,\n\n258\n00:12:58,500 --> 00:13:02,010\nwe actually have a series of command lists\nwe can use to do the same customization.\n\n259\n00:13:03,140 --> 00:13:08,470\nBefore we do that though, I want to go\nahead and reset my shell back to default.\n\n260\n00:13:08,470 --> 00:13:12,240\nAnd there's not really a great easy way to\ndo it when I've overwritten it in the GUI.\n\n261\n00:13:12,240 --> 00:13:16,128\nSo let's do this, let's stop and take a\nquick break, I'll reset my PowerShell back\n\n262\n00:13:16,128 --> 00:13:19,368\nto the defaults, and when we get back,\nI'll show you how to do that same\n\n263\n00:13:19,368 --> 00:13:22,611\nprocess again, but this time we'll\nuse PowerShell commands to do it.\n\n264\n00:13:22,611 --> 00:13:24,888\nSo stay tuned,\nwe'll be back in just a moment.\n\n265\n00:13:24,888 --> 00:13:28,280\n[SOUND] All right,\n\n266\n00:13:28,280 --> 00:13:33,712\nwelcome back, everybody.\n\n267\n00:13:33,712 --> 00:13:36,659\nSo what I did is I went ahead and\ntook my PowerShell, and\n\n268\n00:13:36,659 --> 00:13:40,634\njust reverted it back to the basic\nconfiguration like we'd expect when we\n\n269\n00:13:40,634 --> 00:13:43,450\nlaunch the PowerShell the first time.\n\n270\n00:13:43,450 --> 00:13:46,320\nWell, I did that for almost everything.\n\n271\n00:13:46,320 --> 00:13:49,290\nI went ahead and\nleft the font size to the larger size.\n\n272\n00:13:49,290 --> 00:13:51,180\nFont size is a really weird thing.\n\n273\n00:13:52,290 --> 00:13:55,210\nThere are no PowerShell commands\nthat'll let us manipulate the font\n\n274\n00:13:55,210 --> 00:13:58,270\nsize inside of the PowerShell\nconsole itself.\n\n275\n00:13:58,270 --> 00:14:01,080\nThat's actually controlled\nby the Window's kernel.\n\n276\n00:14:01,080 --> 00:14:03,930\nSo if I wanted to adjust\nthe font size programmatically,\n\n277\n00:14:03,930 --> 00:14:06,760\nyou have to do a really advanced\ncall to the kernel, and\n\n278\n00:14:06,760 --> 00:14:10,800\nit's not something that necessarily\nworks on all of the Microsoft systems.\n\n279\n00:14:10,800 --> 00:14:12,050\nSo it's not recommended.\n\n280\n00:14:12,050 --> 00:14:14,630\nWell for me that's okay because\n\n281\n00:14:14,630 --> 00:14:18,440\nI normally pick a different font size\nbased on the resolution that I'm using.\n\n282\n00:14:18,440 --> 00:14:22,005\nSo when I go from computer to computer I\ndon't necessarily know what the screen\n\n283\n00:14:22,005 --> 00:14:25,408\nresolution is gonna be, so I've just\ngotten into the habit of setting that\n\n284\n00:14:25,408 --> 00:14:27,800\nfont size manually, right,\nwe saw that in the GUI.\n\n285\n00:14:27,800 --> 00:14:29,520\nWe pulled up the GUI here.\n\n286\n00:14:29,520 --> 00:14:32,400\nWe can go into properties, and\nwe can go into the font, and\n\n287\n00:14:32,400 --> 00:14:35,188\nwe can bump that size up right\nthere pretty straightforward, but\n\n288\n00:14:35,188 --> 00:14:40,080\nprogrammatically in PowerShell we don't\nhave a great way to do that, all right.\n\n289\n00:14:40,080 --> 00:14:43,310\nEverything else, though, the foreground\ncolor, the background color,\n\n290\n00:14:43,310 --> 00:14:49,290\nthe scroll back buffer, the window size,\nall of that, we can customize.\n\n291\n00:14:49,290 --> 00:14:49,820\nAll right.\n\n292\n00:14:49,820 --> 00:14:51,880\nAnd then there's even some other\nthings that we can customize too,\n\n293\n00:14:51,880 --> 00:14:54,550\nthat go beyond what we see up\nhere in the properties screen,\n\n294\n00:14:54,550 --> 00:14:57,480\nright, there are only so many different\noptions in there to manipulate.\n\n295\n00:14:57,480 --> 00:14:58,760\nThere's a few more that we can do.\n\n296\n00:14:58,760 --> 00:14:59,860\nAll right.\n\n297\n00:14:59,860 --> 00:15:02,850\nNow I mentioned that when I\ngo from computer to computer,\n\n298\n00:15:02,850 --> 00:15:05,850\nI don't like to have to go through and\ndo all these customizations over again, so\n\n299\n00:15:05,850 --> 00:15:09,650\nI have a little script that I carry\naround, and I run this quick script and\n\n300\n00:15:09,650 --> 00:15:11,760\nit configures the prompt\nthe way that I want it.\n\n301\n00:15:11,760 --> 00:15:15,060\nIt does it programmatically, so I don't\nhave to go and find all those options.\n\n302\n00:15:16,260 --> 00:15:18,270\nLet me show you the script,\nI could go through and\n\n303\n00:15:18,270 --> 00:15:20,890\ntype the commands here one at a time.\n\n304\n00:15:20,890 --> 00:15:23,170\nBut I guess, let's do that.\n\n305\n00:15:23,170 --> 00:15:25,390\nLet's kind of go through it and\nsee what happens.\n\n306\n00:15:25,390 --> 00:15:28,360\nWhen we go through and\nwe do this type of a configuration,\n\n307\n00:15:28,360 --> 00:15:33,120\nwe're punching in these values, and we\nhave to remember a few little caveats and\n\n308\n00:15:33,120 --> 00:15:37,790\nI'll show you what I mean but let me\njust pull this document up right here.\n\n309\n00:15:37,790 --> 00:15:39,958\nSo that we can see what I'm about to do.\n\n310\n00:15:39,958 --> 00:15:44,685\nSo here's my script that runs whenever\nI sit down on a new computer and\n\n311\n00:15:44,685 --> 00:15:47,958\nkind of fire it up and\nstart to work with things.\n\n312\n00:15:47,958 --> 00:15:51,542\nI launch this script and\nI start to do my configuration.\n\n313\n00:15:51,542 --> 00:15:54,333\nLet's see if I can get\nmy window aligned here.\n\n314\n00:15:54,333 --> 00:15:57,802\nAll right, so, when I go through and\ndo this configuration,\n\n315\n00:15:57,802 --> 00:16:02,292\nI'm basically sending the same things\nwe saw in the GUI Just programatically.\n\n316\n00:16:02,292 --> 00:16:06,078\nThe issue with doing it programatically\nis that the commands, the parameters,\n\n317\n00:16:06,078 --> 00:16:08,870\nthat we have to modify,\nthey can be kind of long.\n\n318\n00:16:08,870 --> 00:16:13,060\nSo I normally define a few variables to\nmake that a little bit easier for me.\n\n319\n00:16:13,060 --> 00:16:17,480\nThe majority of the settings\nare all controlled by the $host.\n\n320\n00:16:17,480 --> 00:16:19,440\nThat's a variable that points\nto our computer, right,\n\n321\n00:16:19,440 --> 00:16:23,220\nso our computer.UI.RawUI right?\n\n322\n00:16:23,220 --> 00:16:25,070\nThat's the user interface.\n\n323\n00:16:25,070 --> 00:16:28,090\nAnd so that's where pretty much\nall of the settings we're gonna\n\n324\n00:16:28,090 --> 00:16:29,930\nmanipulate are located, all right?\n\n325\n00:16:29,930 --> 00:16:33,250\nWell, I usually create a little\nshortcut variable that points to it and\n\n326\n00:16:33,250 --> 00:16:37,610\nthat's what I'm doing right here,\nconsole = $host.UI.RawUI.\n\n327\n00:16:37,610 --> 00:16:40,340\nSo, now for every other command I don't\nhave to type that all the way out.\n\n328\n00:16:40,340 --> 00:16:42,270\nI can just type $console, right?\n\n329\n00:16:42,270 --> 00:16:44,080\nIt's a simple variable.\n\n330\n00:16:44,080 --> 00:16:46,887\nAnd if we jump over here,\nI can throw that in, and\n\n331\n00:16:46,887 --> 00:16:49,570\nnow I've got that variable created, right.\n\n332\n00:16:49,570 --> 00:16:50,548\nThat's exciting.\n\n333\n00:16:50,548 --> 00:16:54,000\nWell, from there,\nwe can start to set our other things.\n\n334\n00:16:54,000 --> 00:16:54,580\nAll right.\n\n335\n00:16:54,580 --> 00:16:56,730\nAnd you'll see that that's what\nI do on my next two lines,\n\n336\n00:16:56,730 --> 00:17:01,981\nis I call the dollar sign console., so I'm\nmodifying a parameter of the raw UI and\n\n337\n00:17:01,981 --> 00:17:06,980\nI'm changing foreground color to green and\nbackground color to black.\n\n338\n00:17:06,980 --> 00:17:10,620\nI like the old green screens that we had\non monochrome systems back in the day.\n\n339\n00:17:10,620 --> 00:17:13,180\nIt's a little bit easier for\nme to read and so that's what I do.\n\n340\n00:17:13,180 --> 00:17:14,460\nI just kind of change it.\n\n341\n00:17:14,460 --> 00:17:17,210\nAnd most colors,\nyou can just refer to by name.\n\n342\n00:17:17,210 --> 00:17:19,590\nLike this, green, black, or whatever.\n\n343\n00:17:19,590 --> 00:17:23,460\nThere are some that aren't included and\nthere's other ways you can specify\n\n344\n00:17:23,460 --> 00:17:28,400\nthe color, too, like doing an actual, the\nPantone codes or whatever they're called.\n\n345\n00:17:28,400 --> 00:17:29,750\nSo you can put various things in there,\n\n346\n00:17:29,750 --> 00:17:31,900\nRGB values,\nthat's the one I'm thinking of.\n\n347\n00:17:31,900 --> 00:17:35,620\nBut I usually just do the names because\nI can't remember the RGB values.\n\n348\n00:17:35,620 --> 00:17:37,930\nSo, I'm gonna go ahead and apply these.\n\n349\n00:17:37,930 --> 00:17:42,220\nNow, these are applying\nright against the console.\n\n350\n00:17:42,220 --> 00:17:45,000\nSo, the console is applying as the raw UI.\n\n351\n00:17:45,000 --> 00:17:48,330\nThis should basically\ntake effect immediately.\n\n352\n00:17:48,330 --> 00:17:53,490\nWhen I make these changes,\nif I come over here and paste those in,\n\n353\n00:17:53,490 --> 00:17:58,360\nI see after running this command,\nmy foreground changed to green, all right,\n\n354\n00:17:58,360 --> 00:18:02,760\nand after running this command,\nmy background changed to black.\n\n355\n00:18:02,760 --> 00:18:06,210\nBut, notice what it did there,\nmy whole background isn't black,\n\n356\n00:18:06,210 --> 00:18:08,365\njust part of my background.\n\n357\n00:18:08,365 --> 00:18:11,590\nPowerShell doesn't\nupdate the whole screen.\n\n358\n00:18:11,590 --> 00:18:15,820\nWhenever you generate some new data, it\nonly updates the parts of the screens that\n\n359\n00:18:15,820 --> 00:18:20,100\nit has to, so everything that is\nrefreshing from now on will have a black\n\n360\n00:18:20,100 --> 00:18:23,160\nbackground, but I'm gonna see\na lot of artifacts like this.\n\n361\n00:18:23,160 --> 00:18:28,140\nIf I run get- service, right,\nit's gonna go and get that.\n\n362\n00:18:28,140 --> 00:18:32,500\nAnd see how part of my screen is\nstill blue there at the bottom, and\n\n363\n00:18:32,500 --> 00:18:36,270\neven on the sides and that's because\nit didn't write to those areas.\n\n364\n00:18:36,270 --> 00:18:39,240\nSo, I really need to clear\nmy screen first to do it.\n\n365\n00:18:39,240 --> 00:18:43,040\nAnd I can just use the clear shortcut,\nI'll just type clear, and that'll wipe it\n\n366\n00:18:43,040 --> 00:18:48,220\nout, and now my whole screen will be\ngreen foreground, black background.\n\n367\n00:18:48,220 --> 00:18:51,780\nJust for reference,\nthe clear command is actually an alias.\n\n368\n00:18:51,780 --> 00:18:54,460\nIt's an alias for the Clear-Host command.\n\n369\n00:18:54,460 --> 00:18:56,460\nSo, that's the commandlet\nthat's actually tied to that.\n\n370\n00:18:56,460 --> 00:19:00,610\nSo you could run either one They\ndo the same thing, all right.\n\n371\n00:19:00,610 --> 00:19:03,420\nSo those changes took effect right away.\n\n372\n00:19:04,780 --> 00:19:09,270\nA lot of the other changes that we might\nwanna make don't take effect right away.\n\n373\n00:19:09,270 --> 00:19:14,030\nWe may need to designate a width and\na height, and then apply them together.\n\n374\n00:19:14,030 --> 00:19:18,860\nAnd that's what I do for the rest of\nmy file, is I tackle the scrollback or\n\n375\n00:19:18,860 --> 00:19:20,160\nthe buffer, right?\n\n376\n00:19:20,160 --> 00:19:25,641\nSo the scrollback buffer is tied\nunder host.UI.RawUI.BufferSize.\n\n377\n00:19:25,641 --> 00:19:28,446\nAnd so\nhere I'm just defining another variable,\n\n378\n00:19:28,446 --> 00:19:33,130\na variable called scrollback that\npoints to that buffer size, all right.\n\n379\n00:19:33,130 --> 00:19:35,720\nAnd so I'll come over here and\nI'll define that one.\n\n380\n00:19:35,720 --> 00:19:42,690\nAnd down a little bit we'll have another\none, let's see, right here, $window.\n\n381\n00:19:42,690 --> 00:19:46,540\nThis is going to be the window size,\nand much like the scrollback,\n\n382\n00:19:46,540 --> 00:19:49,580\nI'm just pointing it to\n$console.WindowSize.\n\n383\n00:19:49,580 --> 00:19:53,200\nSo now I can just reference scrollback and\nwindow, and\n\n384\n00:19:53,200 --> 00:19:56,120\nthose will basically refer to\nthose two values, all right?\n\n385\n00:19:56,120 --> 00:19:58,140\nAnd we can provide our other settings.\n\n386\n00:19:58,140 --> 00:20:00,629\nI'm changing my scrollback\nheight to 3,000,\n\n387\n00:20:00,629 --> 00:20:03,560\nI wanna be able to scroll\nback 3,000 lines of text.\n\n388\n00:20:04,570 --> 00:20:07,650\nAnd then for my width, well,\nI want it to be a 110.\n\n389\n00:20:07,650 --> 00:20:11,350\nI want my buffer to basically\ntrack a 110th of my width because\n\n390\n00:20:11,350 --> 00:20:13,480\nthat's what I want my\nwindow to have ultimately.\n\n391\n00:20:13,480 --> 00:20:16,190\nI want it to be a 110 characters wide,\nall right?\n\n392\n00:20:16,190 --> 00:20:21,100\nWell, I can go and throw that and\nthere's my scrollback settings, all right?\n\n393\n00:20:21,100 --> 00:20:24,950\nI can do the same thing with\nmy window width and height.\n\n394\n00:20:24,950 --> 00:20:28,309\nNow I'm going to set these to 110 and 35.\n\n395\n00:20:28,309 --> 00:20:30,030\nYou do have to be a little\nbit careful here.\n\n396\n00:20:30,030 --> 00:20:33,210\nThis is a problem I ran into before\nthe show, my script was failing and\n\n397\n00:20:33,210 --> 00:20:34,270\nI couldn't figure out why.\n\n398\n00:20:35,350 --> 00:20:39,260\nWhat was going on is when\nyou set that window height,\n\n399\n00:20:39,260 --> 00:20:43,550\nif you it do it programmatically in\nPowerShell it looks at your screen and\n\n400\n00:20:43,550 --> 00:20:47,510\nit figures out how many lines\nyou can render on your screen.\n\n401\n00:20:47,510 --> 00:20:50,450\nAnd if you set this number to\nsomething higher than what'll\n\n402\n00:20:50,450 --> 00:20:54,960\nactually fit on the screen, when you go\nto apply it you'll get an error, right.\n\n403\n00:20:54,960 --> 00:20:56,750\nThat doesn't happen in the GUI.\n\n404\n00:20:56,750 --> 00:21:01,300\nYou can go in the GUI and\nin here if I go to layout\n\n405\n00:21:01,300 --> 00:21:05,720\nI can take something like my height and\nI can make it insanely tall.\n\n406\n00:21:05,720 --> 00:21:06,800\nI can go to 100 lines.\n\n407\n00:21:06,800 --> 00:21:09,520\nThat's way more than\nwhat'll fit on my screen.\n\n408\n00:21:09,520 --> 00:21:11,310\nOh, apparently I just did the wrong thing.\n\n409\n00:21:11,310 --> 00:21:13,670\nLet me go back to that.\n\n410\n00:21:13,670 --> 00:21:15,030\nAnd, well, it didn't let me go that high.\n\n411\n00:21:15,030 --> 00:21:16,090\nLet's just go something smaller then.\n\n412\n00:21:16,090 --> 00:21:17,392\n40.\nAll right.\n\n413\n00:21:17,392 --> 00:21:20,090\nSo, I'll set my window height\nsize to have a height of 40 and\n\n414\n00:21:20,090 --> 00:21:21,880\nsee how it's off the bottom of my screen.\n\n415\n00:21:21,880 --> 00:21:23,580\nI can't see the bottom of that window.\n\n416\n00:21:23,580 --> 00:21:26,010\nAnd the GUI is perfectly\nhappy letting you do that.\n\n417\n00:21:26,010 --> 00:21:27,880\nBut when you do it programmatically,\n\n418\n00:21:27,880 --> 00:21:32,490\nit is gonna hold you to what\nwill fit on your screen.\n\n419\n00:21:33,610 --> 00:21:36,620\nSo make sure that you put a value\nthat fits within that range.\n\n420\n00:21:36,620 --> 00:21:37,380\nSo I'm gonna do 35.\n\n421\n00:21:37,380 --> 00:21:39,740\nI think I can actually\nfit 36 on this screen but\n\n422\n00:21:39,740 --> 00:21:42,540\nI'll go 35 for right now just to set it.\n\n423\n00:21:42,540 --> 00:21:46,810\nSo I've got that window height and\nwindow width setting.\n\n424\n00:21:46,810 --> 00:21:49,140\nNow when I did the foreground color and\nthe background color,\n\n425\n00:21:49,140 --> 00:21:53,820\nthey took effect right away, but\nwhen I did these they didn't take effect.\n\n426\n00:21:53,820 --> 00:21:54,550\nNow why is that?\n\n427\n00:21:54,550 --> 00:21:58,160\nWell, when I did foreground and\nbackground,\n\n428\n00:21:58,160 --> 00:22:03,490\nI tied those right to $console,\nright, which pointed to my raw UI.\n\n429\n00:22:03,490 --> 00:22:07,055\nIn this case,\nI've tied these To $window and\n\n430\n00:22:07,055 --> 00:22:11,800\n$scrollback so they didn't actually\napply all the way upstream yet.\n\n431\n00:22:11,800 --> 00:22:14,430\nThat's why the changes\naren't in effect right now.\n\n432\n00:22:14,430 --> 00:22:18,070\nIf I want that to happen I've gotta\nbasically tie those variables together.\n\n433\n00:22:18,070 --> 00:22:21,530\nAnd so we can do that.\n\n434\n00:22:21,530 --> 00:22:26,477\nHere I'm gonna take $scrollback and\nI'll set it equal to $console., or wait,\n\n435\n00:22:26,477 --> 00:22:27,831\nthat's not correct.\n\n436\n00:22:27,831 --> 00:22:29,340\nHere, other way around.\n\n437\n00:22:29,340 --> 00:22:33,140\nI need $console.BufferSize\nto equal $scrollback.\n\n438\n00:22:33,140 --> 00:22:35,850\nThat's the opposite of what was up here,\nright.\n\n439\n00:22:35,850 --> 00:22:39,080\nInstead of mapping my new\nvariable to the old one,\n\n440\n00:22:39,080 --> 00:22:42,260\nI need to map my old variable to\nthe new one to get the new settings.\n\n441\n00:22:42,260 --> 00:22:45,450\nAnd so I'll just come over here,\nand I'll do that.\n\n442\n00:22:45,450 --> 00:22:49,280\nAll right, notice my scroll\nbars down here just updated\n\n443\n00:22:49,280 --> 00:22:52,060\nto reflect that larger buffer, right.\n\n444\n00:22:52,060 --> 00:22:54,120\nSo my larger buffer is now in play.\n\n445\n00:22:54,120 --> 00:22:55,230\nIt's active.\n\n446\n00:22:55,230 --> 00:22:56,350\nAnd I'm ready to go.\n\n447\n00:22:56,350 --> 00:22:59,660\nI need to do the same thing\nwith my window size, and so\n\n448\n00:22:59,660 --> 00:23:04,990\nright here I've got\n$console.WindowSize = $window.\n\n449\n00:23:04,990 --> 00:23:06,990\nAnd I'll apply that one too.\n\n450\n00:23:06,990 --> 00:23:09,370\nAnd there goes my window resizing.\n\n451\n00:23:09,370 --> 00:23:13,220\nAnd now I've got a PowerShell that fits\npretty much my whole screen, right.\n\n452\n00:23:13,220 --> 00:23:17,200\nThat's a good size for that PowerShell and\nmy buffers are aligned with it and\n\n453\n00:23:17,200 --> 00:23:18,500\neverything's in place.\n\n454\n00:23:18,500 --> 00:23:21,580\nNow when I start running things\nlike get-service, right,\n\n455\n00:23:21,580 --> 00:23:23,070\nit's got a lot more room to play.\n\n456\n00:23:23,070 --> 00:23:27,150\nNow, get-service the table\nformat here is still not\n\n457\n00:23:27,150 --> 00:23:29,680\ndividing everything out quite properly.\n\n458\n00:23:29,680 --> 00:23:37,668\nSo, what I might wanna do is pipe that\ninto format-table with a little -auto and\n\n459\n00:23:37,668 --> 00:23:42,014\nwhen you do that it'll\nrealign that table so\n\n460\n00:23:42,014 --> 00:23:46,375\nthat it fits the screen\na little bit better.\n\n461\n00:23:46,375 --> 00:23:49,710\nSo see up here where some of these were\ngetting truncated, now they aren't.\n\n462\n00:23:49,710 --> 00:23:52,083\nLet's take one like Win RM right there.\n\n463\n00:23:52,083 --> 00:23:59,375\nSo I'm going to do get-service, Win rm.\n\n464\n00:23:59,375 --> 00:24:00,542\nAnd you'll see that it's truncated.\n\n465\n00:24:00,542 --> 00:24:03,826\nI've got the little three dot\nellipsis right there, but\n\n466\n00:24:03,826 --> 00:24:07,112\nif I pipe that into Format-Table -Auto,\nin other words\n\n467\n00:24:07,112 --> 00:24:11,149\nautomatically determine the width of\nthe columns now it pulls it up and\n\n468\n00:24:11,149 --> 00:24:15,802\nit's rearranged everything on the screen\nand so it can write it all the way out and\n\n469\n00:24:15,802 --> 00:24:20,230\nit took out all that extra space like\nall this empty space right here.\n\n470\n00:24:20,230 --> 00:24:22,930\nThat's really useful when you're\nrunning a command that has a lot of\n\n471\n00:24:22,930 --> 00:24:26,450\noutput like more output than\nwhat will fit on the screen.\n\n472\n00:24:26,450 --> 00:24:29,800\nSo, now we can start to take\nadvantage of the rest of those cells.\n\n473\n00:24:29,800 --> 00:24:33,930\nIt will go all the way up to 110 wide\nversus the other one that's still kind of\n\n474\n00:24:33,930 --> 00:24:35,750\nholding itself here to that\n80 characters from earlier.\n\n475\n00:24:38,090 --> 00:24:41,610\nAl lright.\nSo, now we've adjusted our window size and\n\n476\n00:24:41,610 --> 00:24:45,620\nwe've adjusted our font size, and so\nthat stuff is pretty cool, right.\n\n477\n00:24:45,620 --> 00:24:48,700\nWe've also adjusted our buffer size,\nso those are all kind of in place.\n\n478\n00:24:48,700 --> 00:24:50,910\nFont size was the only one that\nwe couldn't do programatically,\n\n479\n00:24:50,910 --> 00:24:54,100\nthe other ones we could I don't\nnormally stop here though.\n\n480\n00:24:54,100 --> 00:24:58,310\nYou might have noticed in my script\nthat I had a few other entries in there.\n\n481\n00:24:58,310 --> 00:24:59,200\nLet's see where is that?\n\n482\n00:24:59,200 --> 00:25:00,410\nHere we go.\n\n483\n00:25:00,410 --> 00:25:05,340\nSo right here in the middle I\nhave $MaximumHistoryCount = 150.\n\n484\n00:25:05,340 --> 00:25:05,940\nAll right?\n\n485\n00:25:07,310 --> 00:25:12,110\nThe maximum history count by default\nin PowerShell is 64 commands.\n\n486\n00:25:12,110 --> 00:25:12,900\nI like to record more.\n\n487\n00:25:12,900 --> 00:25:15,580\nI like to have a little\nmore history in there so\n\n488\n00:25:15,580 --> 00:25:17,510\nthat I can pull this\nbackup when I need them.\n\n489\n00:25:17,510 --> 00:25:19,410\nSo I usually bump it up to about 150.\n\n490\n00:25:19,410 --> 00:25:24,690\nThat's pretty handy cause if you started\nto exceed that amount of commands well,\n\n491\n00:25:24,690 --> 00:25:27,290\nit'll start to override the older\nones with the newer ones.\n\n492\n00:25:27,290 --> 00:25:30,770\nWhich, if I spell it right,\nthat command will actually work.\n\n493\n00:25:30,770 --> 00:25:33,260\nWell I've got a whopping 22\ncommands in my history, so\n\n494\n00:25:33,260 --> 00:25:37,972\nit's not anything spectacular right now,\nbut I can bump that up just by saying\n\n495\n00:25:37,972 --> 00:25:41,800\n$MaximumHistoryCount = 150, and\nnow it'll track the previous 150 commands.\n\n496\n00:25:44,470 --> 00:25:48,070\nThe last thing that I like to modify,\nis the prompt itself.\n\n497\n00:25:48,070 --> 00:25:51,080\nRight here it says PS C:\\.\n\n498\n00:25:51,080 --> 00:25:53,870\nSo it's got PS to let me\nknow I'm in power shell.\n\n499\n00:25:53,870 --> 00:25:58,580\nAnd then it's got the current path, C:\\.\n\n500\n00:25:58,580 --> 00:26:02,680\nYou can change that prompt\nto be whatever you want.\n\n501\n00:26:02,680 --> 00:26:05,900\nWhen the prompt is displayed,\nit's actually calling a function.\n\n502\n00:26:05,900 --> 00:26:08,770\nThere's a function called Prompt.\n\n503\n00:26:08,770 --> 00:26:11,715\nAnd if we do like Get-Command.\n\n504\n00:26:11,715 --> 00:26:15,845\n[SOUND] When we look in here and\nit lists like all the various functions,\n\n505\n00:26:15,845 --> 00:26:19,555\nwell actually it's an alias name so\nit won't show up in there.\n\n506\n00:26:19,555 --> 00:26:22,503\nBut basically,\nthere's a function called Prompt.\n\n507\n00:26:22,503 --> 00:26:25,450\nAnd that's what it's pulling\nto be able to adjust that.\n\n508\n00:26:25,450 --> 00:26:27,430\nWe should be able to do\na get dash help for prompt.\n\n509\n00:26:27,430 --> 00:26:28,540\nLet's see if that works for us.\n\n510\n00:26:29,680 --> 00:26:33,150\nThere we go, so it's just telling us that\nwe could call that prompt function and\n\n511\n00:26:33,150 --> 00:26:37,710\nit dictates exactly what's going to be on\nour prompt, and it's got some links to\n\n512\n00:26:37,710 --> 00:26:40,620\nMicrosoft's page to help you a bit,\nbut let me just show you how it works.\n\n513\n00:26:40,620 --> 00:26:44,400\nIn my script,\nI'm actually overriding my prompt and\n\n514\n00:26:44,400 --> 00:26:48,620\nchanging it, and so what I'm doing is\nI'm basically saying the prompt as it is\n\n515\n00:26:48,620 --> 00:26:51,640\ndoesn't necessarily have all the stuff\nthat I want, so I'm going to change it.\n\n516\n00:26:51,640 --> 00:26:57,130\nSo, I call function Prompt,\nand then squiggly brackets.\n\n517\n00:26:57,130 --> 00:27:00,190\nOnce you get in the squiggly brackets,\n\n518\n00:27:00,190 --> 00:27:04,060\nanything that you put between\nwill become your new prompt.\n\n519\n00:27:04,060 --> 00:27:06,980\nAnd that will replace the existing prompt.\n\n520\n00:27:06,980 --> 00:27:08,490\nAnd because it's a squiggly bracket or\n\n521\n00:27:08,490 --> 00:27:11,210\ncurly bracket,\nyou can put all sorts of things in there.\n\n522\n00:27:11,210 --> 00:27:14,680\nYou can call other commandlets to\ngenerate whatever's gonna be represented.\n\n523\n00:27:16,200 --> 00:27:20,260\nWhen they run it, they're just doing\na little text field that says PS and\n\n524\n00:27:20,260 --> 00:27:24,271\nthey're doing a, I believe it's\nGet-Location that pulls the path.\n\n525\n00:27:24,271 --> 00:27:26,093\nLet me just verify that.\n\n526\n00:27:26,093 --> 00:27:28,090\nYeah, get-location.\n\n527\n00:27:28,090 --> 00:27:30,776\nSo, when you run get-location,\nthat pulls the path you're on.\n\n528\n00:27:30,776 --> 00:27:31,752\nSo, that's all they're doing.\n\n529\n00:27:31,752 --> 00:27:36,627\nThey're saying display the text PS and\na space and then run Get-Location and\n\n530\n00:27:36,627 --> 00:27:37,692\nput the path in.\n\n531\n00:27:37,692 --> 00:27:40,180\nThen stick a greater than sign on the end.\n\n532\n00:27:40,180 --> 00:27:42,040\nRight, that's the default prompt.\n\n533\n00:27:42,040 --> 00:27:50,120\nBut we could say function\nprompt { This is my prompt,\n\n534\n00:27:53,040 --> 00:27:57,430\nlike that and well oh shoot,\nI wasn't syntactically correct so\n\n535\n00:27:57,430 --> 00:28:00,410\nit's just dropped it to have that\nbasic PS at the very beginning.\n\n536\n00:28:00,410 --> 00:28:05,670\nI probably need to change this\nto be more of a Write-Host.\n\n537\n00:28:05,670 --> 00:28:10,010\nAnd then put that in parentheses,\nor in quotation marks, there we go.\n\n538\n00:28:10,010 --> 00:28:10,570\nThere.\n\n539\n00:28:10,570 --> 00:28:14,010\nSo now, every time I press enter, see how\nit's showing me, this is my prompt and\n\n540\n00:28:14,010 --> 00:28:17,640\nthen I get the PS so\nI can put whatever I want in there.\n\n541\n00:28:17,640 --> 00:28:19,300\nTo be able to do that.\n\n542\n00:28:19,300 --> 00:28:23,180\nWell, we have to be a little bit careful,\nnotice that my prompt,\n\n543\n00:28:23,180 --> 00:28:27,040\nif I clear my screen my prompt\nis now two lines, right.\n\n544\n00:28:27,040 --> 00:28:29,900\nI get this is my prompt,\nfollowed by the actual prompt, and\n\n545\n00:28:29,900 --> 00:28:31,830\nthen I can start typing my command.\n\n546\n00:28:31,830 --> 00:28:35,180\nAnd there's no space after PS.\n\n547\n00:28:35,180 --> 00:28:38,070\nSo I get PS>, and\nthen I'm immediately typing my command.\n\n548\n00:28:38,070 --> 00:28:39,610\nAnd that can be a little confusing.\n\n549\n00:28:39,610 --> 00:28:42,410\nSo we normally do want to\napply a little bit of finesse.\n\n550\n00:28:42,410 --> 00:28:44,610\nWhen we start to modify that prompt.\n\n551\n00:28:44,610 --> 00:28:46,460\nAnd let me just show\nyou the one that I use.\n\n552\n00:28:46,460 --> 00:28:48,830\nSo, let's pull it up here.\n\n553\n00:28:48,830 --> 00:28:49,800\nThere we go.\n\n554\n00:28:49,800 --> 00:28:54,270\nSo the one that I use, I go into\nfunction prompt, and I say Write-Host.\n\n555\n00:28:54,270 --> 00:28:56,330\nI go ahead and leave the PS there,\n\n556\n00:28:56,330 --> 00:28:59,350\nbecause I do like to remember\nthat I'm in the PowerShell.\n\n557\n00:28:59,350 --> 00:29:02,170\nAnd then, I display a square bracket.\n\n558\n00:29:02,170 --> 00:29:05,590\nAnd in side of that, get-date, all right?\n\n559\n00:29:05,590 --> 00:29:10,650\nThe reason I do get-date is, a lot of\ntimes I will copy the stuff that I've run\n\n560\n00:29:10,650 --> 00:29:14,300\nand paste it places, and\nI want to remember when I did that, right?\n\n561\n00:29:14,300 --> 00:29:15,740\nSo I use get-date.\n\n562\n00:29:15,740 --> 00:29:18,390\nYou could do other things,\nlike get-location and\n\n563\n00:29:18,390 --> 00:29:20,380\nyou'd have your path in there, right?\n\n564\n00:29:20,380 --> 00:29:23,048\nAnd it would just be separated out\nby these square brackets that I've\n\n565\n00:29:23,048 --> 00:29:24,180\nstuck around it.\n\n566\n00:29:24,180 --> 00:29:24,810\nRight?\n\n567\n00:29:24,810 --> 00:29:26,970\nAnd then I have that\nclosing greater than sign.\n\n568\n00:29:26,970 --> 00:29:29,100\nBut I could leave that\noff if I didn't want it.\n\n569\n00:29:29,100 --> 00:29:31,400\nOr maybe I wanted a colon instead.\n\n570\n00:29:31,400 --> 00:29:34,200\nRight?\nMaybe you're coming from the Cisco\n\n571\n00:29:34,200 --> 00:29:34,820\nworld or whatever.\n\n572\n00:29:34,820 --> 00:29:38,560\nAnd you wanna have a colon or\na pound symbol or whatever.\n\n573\n00:29:38,560 --> 00:29:41,350\nYou could specify whatever\nvariation you wanted right there.\n\n574\n00:29:41,350 --> 00:29:42,400\nIt'll be perfectly happy with it.\n\n575\n00:29:43,470 --> 00:29:45,680\nBut it's what comes next\nthat's kind of important.\n\n576\n00:29:45,680 --> 00:29:49,020\nIf you're using Write-Host\nto display text on screen,\n\n577\n00:29:49,020 --> 00:29:53,160\nyou probably wanna add\n-NoNewLine to the end.\n\n578\n00:29:53,160 --> 00:29:57,510\nThat way your prompt is just on one\nline instead of two or three or four,\n\n579\n00:29:57,510 --> 00:29:58,580\ndepending on what all you've run.\n\n580\n00:30:00,700 --> 00:30:03,400\nI'm also changing the foreground\ncolor of my prompt.\n\n581\n00:30:03,400 --> 00:30:06,590\nI didn't have to do that, but I'm doing it\nhere just to show you guys as an example.\n\n582\n00:30:06,590 --> 00:30:09,050\nSo I want my prompt to be in cyan.\n\n583\n00:30:09,050 --> 00:30:14,060\nMy regular text is gonna be green, this\nwill be in cyan, very easy to tell the two\n\n584\n00:30:14,060 --> 00:30:17,420\napart, so I'll know when I'm looking\nat a prompt versus my actual command.\n\n585\n00:30:19,010 --> 00:30:24,526\nAnd then I'm using the return function\nto return a space at the end.\n\n586\n00:30:24,526 --> 00:30:27,520\nIt's a good idea to have a space\nto separate your commands out\n\n587\n00:30:27,520 --> 00:30:28,410\nfrom the prompt.\n\n588\n00:30:28,410 --> 00:30:30,610\nAnd so I'm just saying return and\n\n589\n00:30:30,610 --> 00:30:34,550\na space surrounded by quote marks there,\njust to let it know to fill that in.\n\n590\n00:30:34,550 --> 00:30:36,720\nAnd then I close it out, all right.\n\n591\n00:30:36,720 --> 00:30:41,490\nSo this is what I use, and\nI'm just going to copy that and\n\n592\n00:30:41,490 --> 00:30:43,790\nwe'll paste that right\nhere into our prompt.\n\n593\n00:30:46,120 --> 00:30:48,400\nAll right, and there's my new prompt.\n\n594\n00:30:48,400 --> 00:30:51,810\nI've got PS still, so\nI know I'm in Powershell.\n\n595\n00:30:51,810 --> 00:30:53,340\nAnd I see the date written out.\n\n596\n00:30:53,340 --> 00:30:55,890\nAnd I could modify get-date\nto show just time or\n\n597\n00:30:55,890 --> 00:30:58,020\nwhatever if you really\nwanted to manipulate that.\n\n598\n00:30:58,020 --> 00:31:01,460\nI then see a colon, and\nnow I can start to type my commands.\n\n599\n00:31:01,460 --> 00:31:03,015\nAnd so I can do Get-Help.\n\n600\n00:31:03,015 --> 00:31:06,093\nOr Get-Member,all right.\n\n601\n00:31:06,093 --> 00:31:08,240\nAnd I can start to pull up my help.\n\n602\n00:31:08,240 --> 00:31:09,750\nMy foreground is in green.\n\n603\n00:31:09,750 --> 00:31:14,970\nMy background is in black and my prompt\nis customized the way I want it and\n\n604\n00:31:14,970 --> 00:31:16,580\nI'm ready to rock.\n\n605\n00:31:16,580 --> 00:31:18,830\nSo pretty straight forward.\n\n606\n00:31:18,830 --> 00:31:20,350\nPretty easy to do.\n\n607\n00:31:20,350 --> 00:31:25,520\nNow, in my little example here,\nI have all those various settings.\n\n608\n00:31:25,520 --> 00:31:26,680\nI changed the buffer size.\n\n609\n00:31:26,680 --> 00:31:27,690\nI changed the scroll back.\n\n610\n00:31:27,690 --> 00:31:28,950\nI changed the window size.\n\n611\n00:31:28,950 --> 00:31:30,490\nI changed the coloring.\n\n612\n00:31:30,490 --> 00:31:31,970\nAll of that, all right?\n\n613\n00:31:31,970 --> 00:31:34,520\nAnd we just saw,\ngoing ahead and applying it but\n\n614\n00:31:34,520 --> 00:31:37,650\nthere's one problem with\nwhat were doing here.\n\n615\n00:31:37,650 --> 00:31:40,760\nWatch what happens if\nI close my PowerShell.\n\n616\n00:31:40,760 --> 00:31:46,795\nSo if I close my PowerShell and I open it\nagain, well, some of the setting stayed.\n\n617\n00:31:46,795 --> 00:31:47,945\nSome didn't.\n\n618\n00:31:47,945 --> 00:31:51,535\nMy coloring stayed, but\nmy window size is gone.\n\n619\n00:31:51,535 --> 00:31:53,555\nMy window size is gone.\n\n620\n00:31:53,555 --> 00:31:55,665\nMy scroll back buffer is gone.\n\n621\n00:31:55,665 --> 00:31:57,845\nMy prompt is gone.\n\n622\n00:31:57,845 --> 00:32:01,860\nNot every setting survives closing\nthe window and opening it again.\n\n623\n00:32:01,860 --> 00:32:04,720\nIn fact, here, it's really just that\nforeground and background that stayed.\n\n624\n00:32:04,720 --> 00:32:07,930\nEverything else has\nreverted back to default.\n\n625\n00:32:07,930 --> 00:32:08,750\nAll right?\n\n626\n00:32:08,750 --> 00:32:12,260\nSo, if we want these commands\nto always be present,\n\n627\n00:32:12,260 --> 00:32:15,890\nwe probably want to stick them\nin our PowerShell profile.\n\n628\n00:32:17,170 --> 00:32:20,487\nNow we haven't talked about\nPowerShell profiles yet, but\n\n629\n00:32:20,487 --> 00:32:22,609\nwhen you launch a PowerShell window,\n\n630\n00:32:22,609 --> 00:32:27,273\nthose default settings have to come from\nsomewhere, and they come from a profile.\n\n631\n00:32:27,273 --> 00:32:31,737\nAnd there's actually four different\nprofiles that are available depending on\n\n632\n00:32:31,737 --> 00:32:32,740\nyour need.\n\n633\n00:32:32,740 --> 00:32:35,440\nAnd so it's definitely something\nthat we need to address, but\n\n634\n00:32:35,440 --> 00:32:39,420\nI wanna separate that out\ninto another segment.\n\n635\n00:32:39,420 --> 00:32:43,450\nSo, what we really need to do is once\nwe figured out our customizations,\n\n636\n00:32:43,450 --> 00:32:47,510\nwe need to take them and\nput them into our profile.\n\n637\n00:32:47,510 --> 00:32:50,690\nAnd that's going to make it\nsurvive session after session.\n\n638\n00:32:50,690 --> 00:32:52,900\nYou'll be able to close your window and\nopen it again and\n\n639\n00:32:52,900 --> 00:32:55,870\nit will always be set\nthe way that you want.\n\n640\n00:32:55,870 --> 00:33:00,060\nSo if you're watching these PowerShell\nepisodes in order, stay tuned.\n\n641\n00:33:00,060 --> 00:33:03,280\nThe very next one we're going to show\nthose profiles and how they work.\n\n642\n00:33:03,280 --> 00:33:06,060\nIf you're watching them out\nof order that's fine too,\n\n643\n00:33:06,060 --> 00:33:10,070\njust jump over to the profile one and I'll\nshow you right in there how to save this\n\n644\n00:33:10,070 --> 00:33:14,360\ninto your profile so that your\ncustomizations will always be there.\n\n645\n00:33:14,360 --> 00:33:17,870\nSo, in this segment, we got a chance\nto see how to customize the appearance\n\n646\n00:33:17,870 --> 00:33:19,740\nof our power shell using the GUI,\n\n647\n00:33:19,740 --> 00:33:23,290\nwhich was really easy, and then we got\nto see how to do it programatically.\n\n648\n00:33:23,290 --> 00:33:26,520\nIt was a little more complex, but you\nhad more power and additional features,\n\n649\n00:33:26,520 --> 00:33:29,430\nlike changing the prompt,\nwhich are really nice.\n\n650\n00:33:29,430 --> 00:33:32,050\nSimple customizations to make\nthe PowerShell a more friendly\n\n651\n00:33:32,050 --> 00:33:32,930\nenvironment for us.\n\n652\n00:33:32,930 --> 00:33:35,610\nAll right, well,\nI hope you guys enjoyed the segment.\n\n653\n00:33:35,610 --> 00:33:38,072\nStay tuned,\nwe've got more PowerShell coming up.\n\n654\n00:33:38,072 --> 00:33:44,830\n[MUSIC]\n\n",
          "vimeoId": "113925835"
        },
        {
          "description": "",
          "length": "1153",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-11-powershell-profiles-120314.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-11-powershell-profiles-120314-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-11-powershell-profiles-120314-sm.jpg",
          "title": "PowerShell Profiles",
          "transcript": "1\n00:00:00,445 --> 00:00:08,361\n[SOUND]\nIn\n\n2\n00:00:08,361 --> 00:00:12,030\nthis segment we're gonna take\na look at PowerShell user profiles.\n\n3\n00:00:12,030 --> 00:00:16,041\nI know in some of our other segments I've\nmentioned how we can put changes into\n\n4\n00:00:16,041 --> 00:00:19,067\neffect in PowerShell and\nthen when we close PowerShell and\n\n5\n00:00:19,067 --> 00:00:21,750\nopen it again those changes are gone.\n\n6\n00:00:21,750 --> 00:00:26,500\nAnd the way that we prevent that, the way\nthat we get settings to stay present from\n\n7\n00:00:26,500 --> 00:00:29,880\nsession to session,\nis by putting them into a profile.\n\n8\n00:00:29,880 --> 00:00:33,220\nA profile is simply a,\nwell it's a file, is really a script,\n\n9\n00:00:33,220 --> 00:00:37,740\nit's a PowerShell script, that runs\nevery time you launch PowerShell.\n\n10\n00:00:37,740 --> 00:00:39,860\nAnd these are happening in the background\nand you don't even know it.\n\n11\n00:00:39,860 --> 00:00:45,400\nWhen you launch PowerShell, there's\nactually four different scripts that run\n\n12\n00:00:45,400 --> 00:00:47,870\nto make the console prompt that you see,\n\n13\n00:00:47,870 --> 00:00:52,230\nto set things the way that you\nwant them when you get in there.\n\n14\n00:00:52,230 --> 00:00:53,700\nWhy four scripts?\n\n15\n00:00:53,700 --> 00:00:55,865\nWell there's different types.\n\n16\n00:00:55,865 --> 00:00:58,838\nFor example they're actually\ndivided into two categories.\n\n17\n00:00:58,838 --> 00:01:03,596\nThere are some profiles that run just for\nyou, the user, and\n\n18\n00:01:03,596 --> 00:01:09,580\nthere are other profiles that run for\neverybody, it's global.\n\n19\n00:01:09,580 --> 00:01:12,890\nAnd there's scripts that run just for\nuser accounts,\n\n20\n00:01:12,890 --> 00:01:18,290\nlike yourself, and there's scripts that\nrun for user accounts and programs.\n\n21\n00:01:18,290 --> 00:01:21,310\nRight, remember that you're not the only\nperson that can use the PowerShell.\n\n22\n00:01:21,310 --> 00:01:23,520\nA lot of other programs will too.\n\n23\n00:01:23,520 --> 00:01:25,827\nMicrosoft Exchange is\na great example of that.\n\n24\n00:01:25,827 --> 00:01:29,242\nIn Microsoft Exchange if you\nlaunch the GUI and you go in and\n\n25\n00:01:29,242 --> 00:01:32,240\nyou right click on a mailbox and\nyou choose delete,\n\n26\n00:01:32,240 --> 00:01:36,512\nwell, it doesn't actually just go and\ndelete it through a direct call.\n\n27\n00:01:36,512 --> 00:01:40,532\nIt actually calls the PowerShell, and it\nruns the, I think it's remove-mailbox, or\n\n28\n00:01:40,532 --> 00:01:43,540\nsomething like that, to remove\nthe mailbox and get out of there.\n\n29\n00:01:43,540 --> 00:01:45,880\nSo it's using the PowerShell too.\n\n30\n00:01:45,880 --> 00:01:48,043\nSo when you set one of\nthese scripts to run,\n\n31\n00:01:48,043 --> 00:01:51,290\nyou may not want it to run when\nExchange is using the PowerShell,\n\n32\n00:01:51,290 --> 00:01:54,137\nyou just want it to run when\nusers to use the PowerShell.\n\n33\n00:01:54,137 --> 00:01:58,032\nSo Microsoft understands that and\nthey've given us the ability\n\n34\n00:01:58,032 --> 00:02:01,795\nto define four different scripts\nto impact how that happens.\n\n35\n00:02:01,795 --> 00:02:05,130\nAll right, let me show you\nthe scripts before we dive in.\n\n36\n00:02:05,130 --> 00:02:09,340\nSo, I just have a Notepad window here\nwhere I threw the script files in.\n\n37\n00:02:09,340 --> 00:02:13,650\nSo, each of them are kinda just listed\nhere based on who they apply to.\n\n38\n00:02:13,650 --> 00:02:17,510\nSo you'll see that we have some\nscripts that apply to All Users.\n\n39\n00:02:17,510 --> 00:02:21,680\nAnd we have other scripts that\njust apply to the Current User.\n\n40\n00:02:21,680 --> 00:02:24,600\nAnd then we have scripts\nthat apply to users and\n\n41\n00:02:24,600 --> 00:02:27,750\nshells versus ones that\njust apply to users.\n\n42\n00:02:27,750 --> 00:02:31,052\nNow users/shells, that shells part,\nthat means programs.\n\n43\n00:02:31,052 --> 00:02:37,506\nSo if any program calls up a shell to run\na command these will affect that too.\n\n44\n00:02:37,506 --> 00:02:41,877\nSo when I'm creating a script, maybe I\nhave a script that changes my foreground\n\n45\n00:02:41,877 --> 00:02:46,331\nand background color, changes my window\nsize, personalization stuff for me.\n\n46\n00:02:46,331 --> 00:02:48,919\nWell, for me that's great.\n\n47\n00:02:48,919 --> 00:02:52,520\nI want that to go on my\ncurrent user profile.\n\n48\n00:02:52,520 --> 00:02:55,650\nBut Exchange doesn't need to do that.\n\n49\n00:02:55,650 --> 00:02:57,940\nIt doesn't care about the color\nof the command prompt.\n\n50\n00:02:57,940 --> 00:03:01,110\nIt doesn't care about the window size,\nit's running in the background,\n\n51\n00:03:01,110 --> 00:03:03,640\nwe don't even see the window so\nwho cares what color it is.\n\n52\n00:03:03,640 --> 00:03:07,330\nSo I wouldn't want to put\nthat in Current Users/Shells,\n\n53\n00:03:07,330 --> 00:03:10,270\nI'd want it to just go in\nmy own individual user.\n\n54\n00:03:10,270 --> 00:03:14,638\nIf I wanted all of my users to\nhave this same color layout and\n\n55\n00:03:14,638 --> 00:03:18,036\nscreen size,\nI could put it under All Users.\n\n56\n00:03:18,036 --> 00:03:22,550\nOr, if I had a change that I wanted to put\nin place in PowerShell that I wanted to\n\n57\n00:03:22,550 --> 00:03:26,510\naffect every single thing that uses\nthe PowerShell no matter what,\n\n58\n00:03:26,510 --> 00:03:29,794\nI would put it under the All Users/Shells,\nall right.\n\n59\n00:03:29,794 --> 00:03:33,877\nSo that's why we have these four\ndifferent profiles, so we can pick and\n\n60\n00:03:33,877 --> 00:03:35,590\nchoose where the stuff goes.\n\n61\n00:03:36,710 --> 00:03:40,581\nNow the profiles themselves are just\nstored in PowerShell scripts.\n\n62\n00:03:40,581 --> 00:03:43,844\nSo you'll see down here\nwhere I've got Profile.ps1.\n\n63\n00:03:43,844 --> 00:03:46,350\nOr Power-Shell_profile.ps1.\n\n64\n00:03:46,350 --> 00:03:49,194\nThese are the files that are stored in it.\n\n65\n00:03:49,194 --> 00:03:55,398\nAnd ps1 those are just, well those\nare Microsoft PowerShell scripts.\n\n66\n00:03:55,398 --> 00:03:57,872\nps1 stands for PowerShell version 1.0.\n\n67\n00:03:57,872 --> 00:04:00,370\nI'm running 4.0, they're still called ps1.\n\n68\n00:04:00,370 --> 00:04:01,890\nThat's just kinda how it is.\n\n69\n00:04:01,890 --> 00:04:05,934\nSo you'll see that kinda layout sometimes,\nit's a little bit odd.\n\n70\n00:04:05,934 --> 00:04:09,050\nI've got some stray hyphens in here,\nI'm gonna get rid of those.\n\n71\n00:04:09,050 --> 00:04:10,494\nThat'll cause some problems.\n\n72\n00:04:10,494 --> 00:04:14,829\nAll right, so basically those\nare what are going to help me to\n\n73\n00:04:14,829 --> 00:04:18,450\ndefine what runs under what scenarios.\n\n74\n00:04:18,450 --> 00:04:23,012\nIf it's something like my own\npersonal user customizations, font,\n\n75\n00:04:23,012 --> 00:04:26,400\ncolor, the prompt,\n\n76\n00:04:26,400 --> 00:04:30,360\nthe actual value of the window size, that\nstuff I'm going to put under current user.\n\n77\n00:04:30,360 --> 00:04:33,510\nAnd so\nI'm going to browse into my user profile.\n\n78\n00:04:33,510 --> 00:04:35,590\nAnd in my user profile\ninside of Documents,\n\n79\n00:04:35,590 --> 00:04:37,570\nI'll have a folder called\nWindows PowerShell.\n\n80\n00:04:37,570 --> 00:04:41,548\nAnd inside that Windows PowerShell folder,\nI'll have a file called\n\n81\n00:04:41,548 --> 00:04:45,604\nMicrosoft.PowerShell_profile.ps1, and\nthat's gonna be it.\n\n82\n00:04:45,604 --> 00:04:49,694\nI'll see that file, and that's the script\nthat's gonna run when my system runs.\n\n83\n00:04:49,694 --> 00:04:54,010\nNow, if I go and look for\nthat right now, I may not have it.\n\n84\n00:04:54,010 --> 00:04:56,114\nA lot of these profiles don't exist, and\n\n85\n00:04:56,114 --> 00:04:59,432\nthat means there is no script that\nruns when we launch the system.\n\n86\n00:04:59,432 --> 00:05:04,293\nThat it's just gonna go with the defaults,\nso don't be surprised if you go into your\n\n87\n00:05:04,293 --> 00:05:09,280\nprofile and you go into Documents, and you\ndon't have a Windows PowerShell folder.\n\n88\n00:05:09,280 --> 00:05:12,797\nI don't because I haven't\ncustomized any settings.\n\n89\n00:05:12,797 --> 00:05:15,298\nAnd if we look, we may actually\nfind that none of these exist.\n\n90\n00:05:15,298 --> 00:05:17,663\nSo if I take the one that's\nCurrent User/Shells,\n\n91\n00:05:17,663 --> 00:05:20,830\nwell that would be in this\nWindowsPowerShell folder also.\n\n92\n00:05:20,830 --> 00:05:22,810\nYou know, I've got a few mistakes.\n\n93\n00:05:22,810 --> 00:05:25,791\nLooks like my system went\na little hyphen crazy here.\n\n94\n00:05:25,791 --> 00:05:27,990\nSo let me just rearrange some of those.\n\n95\n00:05:27,990 --> 00:05:28,912\nThere we go.\n\n96\n00:05:28,912 --> 00:05:33,120\nAnd so anyhow, so we can find those files.\n\n97\n00:05:33,120 --> 00:05:35,190\nIn this case,\nboth of these two are missing.\n\n98\n00:05:35,190 --> 00:05:36,990\nThe current user ones don't exist.\n\n99\n00:05:36,990 --> 00:05:38,490\nI'm just running with default.\n\n100\n00:05:38,490 --> 00:05:40,350\nWell what about the all users one?\n\n101\n00:05:40,350 --> 00:05:43,890\nWell the all user ones\nthey're tucked away under\n\n102\n00:05:43,890 --> 00:05:46,490\nyour Windows installation folder/system32.\n\n103\n00:05:46,490 --> 00:05:50,087\nAnd then you'll see\nWindows PowerShell in there.\n\n104\n00:05:50,087 --> 00:05:54,771\nSo if I go and take a look at that,\nI'll just browse to\n\n105\n00:05:54,771 --> 00:06:00,201\nC://Windows/System32/PowerShell well\nI can see,\n\n106\n00:06:00,201 --> 00:06:02,975\nwait, it's not PowerShell.\n\n107\n00:06:02,975 --> 00:06:06,160\nIt's WindowsPowerShell, there we go.\n\n108\n00:06:06,160 --> 00:06:09,120\nWhen I browse in there,\nI've got a Version 1.0 folder.\n\n109\n00:06:09,120 --> 00:06:12,422\nNow, I am running PowerShell version 4.0.\n\n110\n00:06:12,422 --> 00:06:16,010\nWell, this is one of those spots were\nMicrosoft kinda made a little mistake.\n\n111\n00:06:16,010 --> 00:06:20,950\nThey put the version number in the path\nfor a file that PowerShell depends on,\n\n112\n00:06:20,950 --> 00:06:25,206\nand they didn't want you to have\nto maintain separate profiles for\n\n113\n00:06:25,206 --> 00:06:27,334\neach version of the PowerShell,\n\n114\n00:06:27,334 --> 00:06:31,745\nso they decided just to stick with\nthe version 1.0 for all of them.\n\n115\n00:06:31,745 --> 00:06:34,166\nNow, we're locked into that, and\nthey don't wanna change that,\n\n116\n00:06:34,166 --> 00:06:35,789\ncuz it'll break backwards compatibility.\n\n117\n00:06:35,789 --> 00:06:38,977\nSo we'll probably be on\nPowerShell 23.7 one day, and\n\n118\n00:06:38,977 --> 00:06:44,350\nwe'll still be in the version 1.0 folder\nhere, so these are the things that happen.\n\n119\n00:06:44,350 --> 00:06:47,340\nBut if I go into that,\nI'll see there's a ton of junk in here.\n\n120\n00:06:47,340 --> 00:06:48,430\nYou shouldn't say junk, right?\n\n121\n00:06:48,430 --> 00:06:53,332\nThere's a ton of technology waiting to be\nused in here, and if we take a look at it,\n\n122\n00:06:53,332 --> 00:06:56,047\nwe may or\nmay not actually find the profiles.\n\n123\n00:06:56,047 --> 00:07:01,747\nSo if I'm looking in here, I'm going to\nlook for profile.ps1 and I don't see it.\n\n124\n00:07:01,747 --> 00:07:07,014\nAnd I'm going to look for the Microsoft\none, and I probably won't see it either.\n\n125\n00:07:07,014 --> 00:07:08,759\nI guess I could've just looked for\nany script.\n\n126\n00:07:08,759 --> 00:07:12,771\nSo here's the only scripts that I\ngot right here and none of them\n\n127\n00:07:12,771 --> 00:07:17,313\nare the profile, so I actually have\nzero profiles in place right now but\n\n128\n00:07:17,313 --> 00:07:19,447\nyou can just create these files.\n\n129\n00:07:19,447 --> 00:07:21,467\nYou can edit them in any text editor.\n\n130\n00:07:21,467 --> 00:07:23,270\nAnd put them in place.\n\n131\n00:07:23,270 --> 00:07:24,590\nAnd now you do have a profile.\n\n132\n00:07:25,860 --> 00:07:29,147\nNow there's a few other ways that we\ncan go about creating it, too, so\n\n133\n00:07:29,147 --> 00:07:31,450\nI'll show you some of that\nhere in just a moment.\n\n134\n00:07:31,450 --> 00:07:38,583\nBut at it's most simple all we have\nto do is take what we want to run.\n\n135\n00:07:38,583 --> 00:07:42,888\nWhat commands we want to run,\nwhen we launch the PowerShell, and\n\n136\n00:07:42,888 --> 00:07:48,687\nput them in a file called profile.ps1 or\nMicrosoft.PowerShell_profile.ps1 and\n\n137\n00:07:48,687 --> 00:07:51,450\nstore that in the associated directory.\n\n138\n00:07:51,450 --> 00:07:53,973\nAnd when we do that,\nnow every time you're in the PowerShell,\n\n139\n00:07:53,973 --> 00:07:55,173\nwe'll run in that scenario.\n\n140\n00:07:55,173 --> 00:07:56,980\nRight so, pretty,\npretty straightforward process.\n\n141\n00:07:58,192 --> 00:07:59,910\nAll right let's take\na look at this in action.\n\n142\n00:08:01,220 --> 00:08:05,731\nPersonally it's pretty rare that\nI modify most of the profiles.\n\n143\n00:08:05,731 --> 00:08:09,146\nThe only one that I ever really modify is\nthis one right here Current User because,\n\n144\n00:08:09,146 --> 00:08:10,049\nmaybe I'm selfish.\n\n145\n00:08:10,049 --> 00:08:12,210\nI don't know,\nI just care about my own settings.\n\n146\n00:08:12,210 --> 00:08:15,540\nI don't want to mess with my programs so I\nreally never want to mess with the shells.\n\n147\n00:08:15,540 --> 00:08:16,890\nAll right?\n\n148\n00:08:16,890 --> 00:08:20,630\nBut I usually don't want to mess with\nAll Users either because I have different\n\n149\n00:08:20,630 --> 00:08:25,540\npreferences than other people so\nI usually just go and set my own.\n\n150\n00:08:25,540 --> 00:08:30,910\nWell, when you launch the PowerShell,\nyou need a way to figure out what your,\n\n151\n00:08:30,910 --> 00:08:34,950\nwhat's called like a primary profile,\nthe main profile that's tied to you.\n\n152\n00:08:34,950 --> 00:08:39,491\nAnd there's actually a variable called\n$profile, and you can query that, and\n\n153\n00:08:39,491 --> 00:08:42,110\nit will tell you what\nyour primary profile is.\n\n154\n00:08:42,110 --> 00:08:47,606\nLet me show you what I mean, if I fire up\nmy PowerShell, I can just type $profile.\n\n155\n00:08:47,606 --> 00:08:51,995\nAnd when I run it,\nit's going to tell me my main profile and\n\n156\n00:08:51,995 --> 00:08:57,093\nyou'll see\nc:/user/donpezet/documents/windowspowersh-\n\n157\n00:08:57,093 --> 00:09:00,886\nell/microsoft.powershell_profile.ps1.\n\n158\n00:09:00,886 --> 00:09:03,518\nAnd if I go back to my screen here,\n\n159\n00:09:03,518 --> 00:09:08,700\nthat's the one that matches up\nwith the Current User not shells.\n\n160\n00:09:08,700 --> 00:09:10,058\nIt doesn't mean the other\nones didn't apply.\n\n161\n00:09:10,058 --> 00:09:11,220\nThe other ones did apply.\n\n162\n00:09:12,230 --> 00:09:16,580\nBut this is the one that's specific\nto me and the session that I'm in\n\n163\n00:09:16,580 --> 00:09:20,030\nversus one that might be more\ngeneric tied to other people.\n\n164\n00:09:20,030 --> 00:09:23,690\nSo, that's the one that I typically\nmodify when I want to have settings that\n\n165\n00:09:23,690 --> 00:09:24,950\napply to me.\n\n166\n00:09:24,950 --> 00:09:27,250\nAnd I want them to apply every\ntime that I launch the PowerShell.\n\n167\n00:09:28,300 --> 00:09:28,860\nAll right.\nSo that's\n\n168\n00:09:28,860 --> 00:09:31,680\nthe first thing that we need to be\naware of with PowerShell profiles,\n\n169\n00:09:31,680 --> 00:09:33,060\nis just the fact that there's\nmore than one of them.\n\n170\n00:09:33,060 --> 00:09:34,110\nThere's four.\n\n171\n00:09:35,430 --> 00:09:38,316\nThe next thing is, if we wanna modify it.\n\n172\n00:09:38,316 --> 00:09:41,883\nNow, I have,\nfrom another segment that we did,\n\n173\n00:09:41,883 --> 00:09:45,630\na little script that we made,\nthis guy right here.\n\n174\n00:09:45,630 --> 00:09:47,488\nLet me open that with Notepad.\n\n175\n00:09:47,488 --> 00:09:48,816\nHere, so here's a script.\n\n176\n00:09:48,816 --> 00:09:52,977\nWe did a segment on customizing\nthe appearance of the PowerShell.\n\n177\n00:09:52,977 --> 00:09:56,559\nAnd we went through and we changed\nour foreground and background color,\n\n178\n00:09:56,559 --> 00:10:00,861\nwe changed our scroll back and buffer, and\nall that good stuff, our command history.\n\n179\n00:10:00,861 --> 00:10:05,734\nAnd we even redefined our prompt, and\nthe issue was when we did this if\n\n180\n00:10:05,734 --> 00:10:10,536\nwe closed PowerShell and\nlaunched it again, we lost our commands.\n\n181\n00:10:10,536 --> 00:10:13,576\nAnd so what I want to do is I\nwant to take these commands and\n\n182\n00:10:13,576 --> 00:10:16,320\nactually store them in my profile.\n\n183\n00:10:16,320 --> 00:10:18,626\nSo, I could go ahead and\njust write this out,\n\n184\n00:10:18,626 --> 00:10:20,953\nthese are all the commands\nthat I want to run.\n\n185\n00:10:20,953 --> 00:10:24,718\nAnd I could save this as\none of these file names.\n\n186\n00:10:24,718 --> 00:10:29,563\nI could save it as this one right here and\nthat would become my profile, all right?\n\n187\n00:10:29,563 --> 00:10:34,531\nOr I could go through and create the file\nthrough the PowerShell if I wanted to,\n\n188\n00:10:34,531 --> 00:10:37,918\nin the case that,\nmaybe I've already got that file or\n\n189\n00:10:37,918 --> 00:10:41,553\nmaybe there's already settings\nthat I want to bring in.\n\n190\n00:10:41,553 --> 00:10:42,974\nThere's a few different\nways we can go about it.\n\n191\n00:10:42,974 --> 00:10:48,312\nIf you already have a profile then\nyou would just edit that file and\n\n192\n00:10:48,312 --> 00:10:51,140\nadd in the commands that you want.\n\n193\n00:10:51,140 --> 00:10:53,870\nSo to get that file created\nwe can manually create it or\n\n194\n00:10:53,870 --> 00:10:56,608\nthere is actually a little\ncommand we can run to do it.\n\n195\n00:10:56,608 --> 00:11:00,920\nLet me go to my window here, all right?\n\n196\n00:11:00,920 --> 00:11:05,742\nAnd in our PowerShell,\nyou can actually run New-Item.\n\n197\n00:11:05,742 --> 00:11:10,370\nThat's a command you can run to create\npretty much any item that you want and\n\n198\n00:11:10,370 --> 00:11:12,882\nI'm gonna tell it to create my profile.\n\n199\n00:11:12,882 --> 00:11:17,548\nSo what it's gonna do is it's gonna\nlook at that profile variable which\n\n200\n00:11:17,548 --> 00:11:20,170\nreturned my main profile.\n\n201\n00:11:20,170 --> 00:11:22,070\nAnd it's going to create a new item there,\nright?\n\n202\n00:11:22,070 --> 00:11:24,137\nSo it's going to create a new file for me.\n\n203\n00:11:24,137 --> 00:11:26,417\nAnd I can tell it that the type is file.\n\n204\n00:11:26,417 --> 00:11:30,122\nAnd I have to do that type part because\nNew-Item can create all sorts of things,\n\n205\n00:11:30,122 --> 00:11:31,640\nnot just files.\n\n206\n00:11:31,640 --> 00:11:37,360\nAnd then I can tell it -force if the file\nalready exists, this'll override it.\n\n207\n00:11:37,360 --> 00:11:40,330\nMine doesn't exist, so I don't technically\nneed that, but I'll go ahead and run it.\n\n208\n00:11:40,330 --> 00:11:41,930\nAnd it's gonna create it, right?\n\n209\n00:11:41,930 --> 00:11:45,920\nSo that's a quick way to get that\nfile created and in place but\n\n210\n00:11:45,920 --> 00:11:47,240\nlook at the length.\n\n211\n00:11:47,240 --> 00:11:49,020\nIt's zero, there's nothing in it.\n\n212\n00:11:49,020 --> 00:11:52,370\nSo it's really just creating\nan empty file and if I go and\n\n213\n00:11:52,370 --> 00:11:54,110\nbrowse into my Documents folder now.\n\n214\n00:11:55,680 --> 00:11:59,276\nNow I do have a Windows PowerShell\npath and in there,\n\n215\n00:11:59,276 --> 00:12:01,664\nthere's my PowerShell profile.\n\n216\n00:12:01,664 --> 00:12:03,447\nI could have created them by hand, but\n\n217\n00:12:03,447 --> 00:12:06,806\nby using the New-Item command it\nensured that I didn't get any typos.\n\n218\n00:12:06,806 --> 00:12:09,697\nIt made the path, it made the file,\nit put it in place, and\n\n219\n00:12:09,697 --> 00:12:12,110\nI know there's no typos in there.\n\n220\n00:12:12,110 --> 00:12:14,180\nNow I can just edit this file.\n\n221\n00:12:14,180 --> 00:12:15,040\nSo I'll go ahead and edit that.\n\n222\n00:12:15,040 --> 00:12:17,700\nAnd, oh I don't want to use the ISE.\n\n223\n00:12:17,700 --> 00:12:18,547\nHere let me get out of that.\n\n224\n00:12:21,136 --> 00:12:22,390\nI'm gonna open that with Notepad.\n\n225\n00:12:22,390 --> 00:12:27,281\nAnd it's empty, I'm just gonna paste in,\noh apparently paste in nothing.\n\n226\n00:12:27,281 --> 00:12:30,481\n[LAUGH] I'm gonna paste in that\nlittle script that we wrote in\n\n227\n00:12:30,481 --> 00:12:33,235\nthe other episode so\nthat these commands will run.\n\n228\n00:12:33,235 --> 00:12:37,560\nNow technically I don't have to run\nall of these commands every time.\n\n229\n00:12:37,560 --> 00:12:41,250\nSome of them actually do get saved like\nthe foreground and background color.\n\n230\n00:12:41,250 --> 00:12:42,696\nThose do get saved.\n\n231\n00:12:42,696 --> 00:12:45,695\nSo I don't technically have to run them\nevery time, but since I've never run them,\n\n232\n00:12:45,695 --> 00:12:46,978\nI'm gonna go ahead and put it here.\n\n233\n00:12:46,978 --> 00:12:49,166\nIt doesn't hurt to go ahead and\nrerun it over and\n\n234\n00:12:49,166 --> 00:12:51,830\nover again every time\nyou launch your prompt.\n\n235\n00:12:51,830 --> 00:12:54,520\nJust be aware the more\nthat you put in here,\n\n236\n00:12:54,520 --> 00:12:58,330\nthe longer it can take the prompt\nto create on the screen.\n\n237\n00:12:58,330 --> 00:13:01,890\nWe'll see more of that when we talk\nabout add on modules in another segment.\n\n238\n00:13:01,890 --> 00:13:04,550\nYou can get it where launching\nPowerShell can take several minutes and\n\n239\n00:13:04,550 --> 00:13:06,560\nthat's super frustrating.\n\n240\n00:13:06,560 --> 00:13:07,870\nIf you've ever worked\nwith Microsoft Exchange,\n\n241\n00:13:07,870 --> 00:13:09,520\nyou know where I'm coming from on that.\n\n242\n00:13:09,520 --> 00:13:13,950\nBut things like this, just simple\nmodifications, that'll only take a second,\n\n243\n00:13:13,950 --> 00:13:15,830\nnot even seconds it'll\nbe really really fast.\n\n244\n00:13:15,830 --> 00:13:17,630\nWe'll see here in a moment.\n\n245\n00:13:17,630 --> 00:13:20,589\nSo I'm gonna put all that right here in\nthis ps1 file, and I'm just gonna save it.\n\n246\n00:13:22,310 --> 00:13:25,100\nAll right, so that's now saved,\nthat's in my profile.\n\n247\n00:13:27,090 --> 00:13:30,380\nAnd basically, every time I launch\na PowerShell, it's gonna look for\n\n248\n00:13:30,380 --> 00:13:32,760\nthis file and it's gonna run\nthe commands that are in it.\n\n249\n00:13:32,760 --> 00:13:36,869\nSo I'm gonna close this PowerShell window,\nand I'll launch a new one.\n\n250\n00:13:37,930 --> 00:13:42,733\nAnd for a brief moment there we saw\nthat blue screen with the grey text\n\n251\n00:13:42,733 --> 00:13:46,622\nyou know that kind of layout,\nlike we had a moment ago.\n\n252\n00:13:46,622 --> 00:13:50,757\nAnd then all of a sudden it changed,\nand now I've got my new prompt and\n\n253\n00:13:50,757 --> 00:13:54,180\nI've got my new window size and\nall of that's in place and\n\n254\n00:13:54,180 --> 00:13:57,273\nnow I can just get in here and\nstart to work, right?\n\n255\n00:13:57,273 --> 00:13:57,944\nI can go and\n\n256\n00:13:57,944 --> 00:14:02,890\ndo all the various things that I need to\ndo in my new happy environment, right?\n\n257\n00:14:02,890 --> 00:14:06,089\nSo I can run get-help and\noff we go, right?\n\n258\n00:14:06,089 --> 00:14:07,691\nSo very cool.\n\n259\n00:14:07,691 --> 00:14:11,903\nVery simple way to do that, and\nnow if I go to another machine,\n\n260\n00:14:11,903 --> 00:14:14,749\nI can just copy that profile file with me.\n\n261\n00:14:14,749 --> 00:14:17,857\nAnd now the new machine will be configured\nthe same way as the old machine,\n\n262\n00:14:17,857 --> 00:14:19,490\nI've got my settings right in there.\n\n263\n00:14:19,490 --> 00:14:23,430\nOr, if I have a roaming user profile,\nthat file,\n\n264\n00:14:23,430 --> 00:14:26,630\nthat PowerShell profile,\nwas stored in my user profile.\n\n265\n00:14:26,630 --> 00:14:27,830\nSo, if I have a roaming profile and\n\n266\n00:14:27,830 --> 00:14:31,620\nI go to five different computers,\nmy profile roams with me and\n\n267\n00:14:31,620 --> 00:14:36,740\nthat means my PowerShell settings now roam\nwith me and that's pretty cool, right?\n\n268\n00:14:36,740 --> 00:14:39,882\nNow that only happens with the user ones,\nthe Current User ones.\n\n269\n00:14:39,882 --> 00:14:45,338\nSee how Current User, both of these\nare in the %UserProfile% variable,\n\n270\n00:14:45,338 --> 00:14:51,065\nright, my user director, versus these\nguys up here, which are %Windir%.\n\n271\n00:14:51,065 --> 00:14:53,077\nThat's where you installed Windows.\n\n272\n00:14:53,077 --> 00:14:57,430\nUsually C:\\Windows and\nthat's not gonna travel with you.\n\n273\n00:14:57,430 --> 00:15:00,290\nSo make sure you put your settings\n\n274\n00:15:00,290 --> 00:15:02,786\nin the profile that is appropriate for\nhow you use it.\n\n275\n00:15:04,890 --> 00:15:06,270\nAll right.\n\n276\n00:15:06,270 --> 00:15:08,690\nAnother little shortcut that\nI use from time to time,\n\n277\n00:15:08,690 --> 00:15:14,710\nI showed you how $profile\nreturns the path of the profile.\n\n278\n00:15:14,710 --> 00:15:18,510\nYou could also do notepad$profile and\n\n279\n00:15:18,510 --> 00:15:21,500\nthat's a quick way to edit that one and\nget right into it.\n\n280\n00:15:21,500 --> 00:15:23,880\nAnd now you can add whatever\nit is that you need.\n\n281\n00:15:23,880 --> 00:15:27,070\nSo if you have other commands,\nother things you want to put in place,\n\n282\n00:15:27,070 --> 00:15:30,530\nyou can fill them in here and\nnow you're in business.\n\n283\n00:15:30,530 --> 00:15:35,890\nAn example of something I like to do,\nif we do aliases, so\n\n284\n00:15:35,890 --> 00:15:41,130\nif I do a Set-Alias and I map edit to\n\n285\n00:15:41,130 --> 00:15:46,320\nnotepad, all right, because I type edit a\nlot and I get annoyed when I forget that.\n\n286\n00:15:46,320 --> 00:15:46,890\nRight?\nSo\n\n287\n00:15:46,890 --> 00:15:51,870\nnow I can type edit $profile and\nthat works, right?\n\n288\n00:15:51,870 --> 00:15:56,620\nBut remember with aliases,\nif I close my window and I open a new one\n\n289\n00:15:58,490 --> 00:16:01,460\nI can type, edit $profile.\n\n290\n00:16:01,460 --> 00:16:05,570\nAnd I get an error,\nthe aliases die when your session dies.\n\n291\n00:16:05,570 --> 00:16:08,655\nSo now, what I could do,\nis I could say, notepad $profile.\n\n292\n00:16:09,900 --> 00:16:13,040\nAnd I could just add, right here,\nyou know, really, anywhere in here.\n\n293\n00:16:13,040 --> 00:16:14,390\nYou've got a lot of flexibility.\n\n294\n00:16:14,390 --> 00:16:16,080\nI'll stick mine right at the top.\n\n295\n00:16:16,080 --> 00:16:20,380\nAnd I'll just say Set-Alias edit notepad.\n\n296\n00:16:20,380 --> 00:16:21,010\nAll right, so\n\n297\n00:16:21,010 --> 00:16:26,510\nnow that alias is part of my profile and\nI won't have to worry about creating it.\n\n298\n00:16:26,510 --> 00:16:30,180\nI can fire up a new PowerShell and,\n\n299\n00:16:30,180 --> 00:16:33,220\nyou know I probably should set\nthe window position on that one.\n\n300\n00:16:33,220 --> 00:16:36,830\nBut my window is constantly\nlaunching off to the side.\n\n301\n00:16:36,830 --> 00:16:38,820\nYou can set the starting\nwindow position to be 1,1,\n\n302\n00:16:38,820 --> 00:16:41,520\nwhich would be right up\nat the top left corner.\n\n303\n00:16:41,520 --> 00:16:43,833\nI probably should do that, but anyhow.\n\n304\n00:16:43,833 --> 00:16:48,835\nI'll do edit $profile and\nnow my alias works.\n\n305\n00:16:48,835 --> 00:16:53,075\nSo aliases, visual customizations,\n\n306\n00:16:53,075 --> 00:16:56,215\nany other types of settings, you might\nwanna change your directory, right?\n\n307\n00:16:56,215 --> 00:16:59,557\nThat's another one I like because it\nalways starts me off with my user profile.\n\n308\n00:16:59,557 --> 00:17:04,457\nSo I might do a Set-Location C:\\, right?\n\n309\n00:17:04,457 --> 00:17:10,993\nSo we'll pop that in there and\nnow when I launch my PowerShell.\n\n310\n00:17:10,993 --> 00:17:15,063\nWhen it launches, it normally\nlaunches to your user profile, so\n\n311\n00:17:15,063 --> 00:17:17,291\nit would be C:\\User\\DonPezet.\n\n312\n00:17:17,291 --> 00:17:22,531\nBut now if I do a Get-Location,\nI can see that I'm in C:\\.\n\n313\n00:17:22,531 --> 00:17:23,112\nRight?\n\n314\n00:17:23,112 --> 00:17:25,416\nI didn't put that in my prompt,\nso I don't see it there.\n\n315\n00:17:25,416 --> 00:17:30,548\nBut I am now in C:/, and\nI can start working right from there.\n\n316\n00:17:30,548 --> 00:17:31,129\nAll right.\n\n317\n00:17:31,129 --> 00:17:33,135\nSo, neat little customizations like that.\n\n318\n00:17:33,135 --> 00:17:35,525\nAnd they'll now stay as\npart of your profile.\n\n319\n00:17:35,525 --> 00:17:37,075\nSo, very cool stuff.\n\n320\n00:17:37,075 --> 00:17:39,695\nYeah, that's really about it.\n\n321\n00:17:39,695 --> 00:17:41,955\nOh, a couple little caveats,\nthings to remember.\n\n322\n00:17:43,085 --> 00:17:47,032\nFirst, the user profile, it is a script.\n\n323\n00:17:47,032 --> 00:17:47,589\nAll right?\n\n324\n00:17:47,589 --> 00:17:48,529\nIt's a ps1 file.\n\n325\n00:17:48,529 --> 00:17:49,752\nIt's a script.\n\n326\n00:17:49,752 --> 00:17:53,125\nSo, remember your script execution policy.\n\n327\n00:17:53,125 --> 00:17:56,248\nIf you haven't watched it, we filmed\na segment on script execution policies.\n\n328\n00:17:56,248 --> 00:17:59,729\nAnd if yours is set to restricted,\nwhich is the default,\n\n329\n00:17:59,729 --> 00:18:01,769\nscripts aren't allowed to run.\n\n330\n00:18:01,769 --> 00:18:03,801\nSo when you go to launch your PowerShell,\n\n331\n00:18:03,801 --> 00:18:06,192\nthe PowerShell profiles\nactually don't work.\n\n332\n00:18:06,192 --> 00:18:10,499\nIn restricted mode PowerShell\nprofiles won't run, all right.\n\n333\n00:18:10,499 --> 00:18:15,261\nIf you've put it in remote signed well,\nthe local scripts are allowed to run and\n\n334\n00:18:15,261 --> 00:18:17,630\nnow your profiles will work.\n\n335\n00:18:17,630 --> 00:18:24,430\nSo, if you have configured this and\nyou find that it's not working, right.\n\n336\n00:18:24,430 --> 00:18:27,390\nSo, if I come in here and\n\n337\n00:18:27,390 --> 00:18:32,581\nI do Set-ExecutionPolicy Restricted.\n\n338\n00:18:32,581 --> 00:18:34,450\nAll right, so\nI'm just going to change that.\n\n339\n00:18:34,450 --> 00:18:37,056\nAll right, so\nnow I'm gonna launch my PowerShell.\n\n340\n00:18:37,056 --> 00:18:40,880\nAnd I immediately get an error and\nnone of my settings took effect.\n\n341\n00:18:40,880 --> 00:18:42,270\nIt's cuz the script wasn't allowed to run.\n\n342\n00:18:43,300 --> 00:18:47,030\nSo be aware of that, you do need to\nallow scripts to run in order for\n\n343\n00:18:47,030 --> 00:18:48,690\nthe profiles to work.\n\n344\n00:18:48,690 --> 00:18:50,590\nOtherwise, you will always\nget the default profile.\n\n345\n00:18:51,980 --> 00:18:55,050\nAll right, so those are a few little\nthings that we just need to be aware of.\n\n346\n00:18:55,050 --> 00:18:58,344\nThat's how the profiles work,\nthey're incredibly useful and\n\n347\n00:18:58,344 --> 00:19:01,829\nthey really help you customize\nthe PowerShell and make it your own.\n\n348\n00:19:01,829 --> 00:19:03,489\nAll right, well,\nI hope you guys enjoyed this segment.\n\n349\n00:19:03,489 --> 00:19:07,071\nStay tuned,\nwe've got more PowerShell coming up!\n\n350\n00:19:07,071 --> 00:19:13,419\n[SOUND]\n\n",
          "vimeoId": "113925635"
        },
        {
          "description": "",
          "length": "1951",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-12-Extending-The-PowerShell-120314.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-12-Extending-The-PowerShell-120314-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-12-Extending-The-PowerShell-120314-sm.jpg",
          "title": "Extending the PowerShell",
          "transcript": "1\n00:00:00,014 --> 00:00:07,355\n[MUSIC]\n\n2\n00:00:07,355 --> 00:00:11,554\nIn this segment we're going to take\na look at extending the functionality of\n\n3\n00:00:11,554 --> 00:00:14,470\nPowerShell through add-on modules.\n\n4\n00:00:14,470 --> 00:00:17,580\nThe PowerShell, it's pretty powerful,\nwell I guess that's the name.\n\n5\n00:00:17,580 --> 00:00:22,250\nBecause it's got a lot of functionality\nthat's built into it, but There\n\n6\n00:00:22,250 --> 00:00:25,610\nare oftentimes where you'll bump into\nthings that you need that aren't there.\n\n7\n00:00:25,610 --> 00:00:27,720\nAnd when Microsoft\ndesigned the PowerShell,\n\n8\n00:00:27,720 --> 00:00:32,000\nthey intended it to be flexible, to grow\nwith the needs of the customers, and\n\n9\n00:00:32,000 --> 00:00:35,520\nthat's why they enabled\nthe ability to add on modules,\n\n10\n00:00:35,520 --> 00:00:38,910\nthat would basically put in\nthe functionality we were missing.\n\n11\n00:00:38,910 --> 00:00:42,460\nAnd that might be functionality that\nMicrosoft adds later on themselves.\n\n12\n00:00:42,460 --> 00:00:45,600\nOr it might be a functionality\nthat third parties add on.\n\n13\n00:00:45,600 --> 00:00:48,980\nAnybody can write an add on module for\nPowerShell and\n\n14\n00:00:48,980 --> 00:00:52,520\ncreate new commandlets, and new\nfunctionality that wasn't there before.\n\n15\n00:00:52,520 --> 00:00:53,670\nIt's pretty neat stuff.\n\n16\n00:00:53,670 --> 00:00:54,410\nAll right.\n\n17\n00:00:54,410 --> 00:00:58,190\nWell let's start with the official\nmodules, the ones that are built in, and\n\n18\n00:00:58,190 --> 00:01:00,190\nthen we'll kind of go from there.\n\n19\n00:01:00,190 --> 00:01:03,180\nNow, throughout this show we've\nseen several different modules,\n\n20\n00:01:03,180 --> 00:01:06,150\nthat really we never addressed as modules.\n\n21\n00:01:06,150 --> 00:01:08,820\nWe just have commandlets that\nare available and we use them.\n\n22\n00:01:08,820 --> 00:01:09,460\nAl lright.\n\n23\n00:01:09,460 --> 00:01:13,830\nWell the base modules of PowerShell are,\nthere included,\n\n24\n00:01:13,830 --> 00:01:15,030\nthere included with the OS.\n\n25\n00:01:15,030 --> 00:01:18,820\nAnd it's not just one module,\nthere's actually a good 20 or 30 modules,\n\n26\n00:01:18,820 --> 00:01:21,950\nthat are part of the base\ninstallation of PowerShell.\n\n27\n00:01:21,950 --> 00:01:24,630\nThey're up and running and\ndoing various things that you need.\n\n28\n00:01:24,630 --> 00:01:28,030\nAnd then as you add software,\n\n29\n00:01:28,030 --> 00:01:31,570\nthe software you install may\nadd additional modules too.\n\n30\n00:01:31,570 --> 00:01:34,150\nSo for example on my server here,\nlet's take a look at this one.\n\n31\n00:01:35,380 --> 00:01:40,970\nIf I fire open my command prompt, or\nmy PoweShell, and I do a Get-Command.\n\n32\n00:01:40,970 --> 00:01:44,320\nI'll see all the different commands\nthat i've got available, right.\n\n33\n00:01:44,320 --> 00:01:48,540\nAnd there is quite a few out\nhere it's quite the list, right.\n\n34\n00:01:48,540 --> 00:01:52,840\nAnd as I look at each command it's\ngot commandlet name, and over here on\n\n35\n00:01:52,840 --> 00:01:57,060\nthe right, it has some information if I\nscroll all the way to the top and look.\n\n36\n00:01:57,060 --> 00:01:59,150\nThat's the module name, all right.\n\n37\n00:01:59,150 --> 00:02:02,140\nEach of these commands\nare coming from a module.\n\n38\n00:02:02,140 --> 00:02:04,900\nAnd some of these\nare installed by default.\n\n39\n00:02:04,900 --> 00:02:06,710\nSome of these have been added.\n\n40\n00:02:06,710 --> 00:02:10,650\nWell, I'm in the function section here,\nlet me get down to just the commandlets.\n\n41\n00:02:10,650 --> 00:02:11,600\nHere we go.\n\n42\n00:02:11,600 --> 00:02:16,799\nSo you'll see some of these are listed\nas Microsft.PowerShell.core,\n\n43\n00:02:16,799 --> 00:02:21,390\nor\nMicrosoft.PowerShell.utility.diagnostics.\n\n44\n00:02:21,390 --> 00:02:24,800\nThose are the base commandlets\nthat are a part of PowerShell\n\n45\n00:02:24,800 --> 00:02:27,000\nthat everyone is going to have.\n\n46\n00:02:27,000 --> 00:02:30,080\nBut you start getting into some\nof these other modules like\n\n47\n00:02:30,080 --> 00:02:32,070\nthe ActiveDirectory module\".\n\n48\n00:02:32,070 --> 00:02:34,310\nNot everyone's going to have that.\n\n49\n00:02:34,310 --> 00:02:37,690\nMy server that I'm on right now,\nis an Active Directory domain controller.\n\n50\n00:02:37,690 --> 00:02:41,740\nAnd because of that, when I installed\nthe active directory management tools,\n\n51\n00:02:41,740 --> 00:02:44,830\nit automatically added\nthe active directory modules.\n\n52\n00:02:44,830 --> 00:02:48,290\nI also installed Microsoft SQL on here.\n\n53\n00:02:48,290 --> 00:02:51,290\nAnd, because I did that,\nwhen it set that up,\n\n54\n00:02:51,290 --> 00:02:55,550\nit also added some SQL tools,\nand I'll see some right here.\n\n55\n00:02:55,550 --> 00:03:00,368\nSQLPS, that's the SQL PowerShell,\nand so here's Get-SqlIntstance,\n\n56\n00:03:00,368 --> 00:03:05,490\nGet-SqlDatabase, right, these were added\nbecause I'm running Microsoft SQL Server.\n\n57\n00:03:05,490 --> 00:03:09,940\nSo one of the easiest ways to add\nadditional functionality to PowerShell,\n\n58\n00:03:09,940 --> 00:03:11,380\nIs just to install your software.\n\n59\n00:03:11,380 --> 00:03:15,060\nAll right, when you install your software,\nthese modules come along with it.\n\n60\n00:03:16,080 --> 00:03:18,240\nAnother example might be DNS.\n\n61\n00:03:18,240 --> 00:03:22,540\nSo if I take a look at any\ncommand that involves DNS.\n\n62\n00:03:22,540 --> 00:03:28,320\nWell I'm a DNS server, and so here's\nall these different DNS commandlets,\n\n63\n00:03:28,320 --> 00:03:30,420\nthat were added as a part\nof the DNS module.\n\n64\n00:03:30,420 --> 00:03:31,110\nRight?\n\n65\n00:03:31,110 --> 00:03:33,790\nWell, what about something\nthat I'm not running though?\n\n66\n00:03:33,790 --> 00:03:35,670\nSomething like DHCP.\n\n67\n00:03:35,670 --> 00:03:40,820\nWell if I wanna manage a DHCP server,\nI can do Get-Command*DHCP*.\n\n68\n00:03:40,820 --> 00:03:43,510\nI don't have any DHCP commandlets.\n\n69\n00:03:43,510 --> 00:03:46,610\nThat doesn't mean they don't exist.\n\n70\n00:03:46,610 --> 00:03:48,500\nI'm just not running that module,\nall right?\n\n71\n00:03:48,500 --> 00:03:50,180\nThere is a module for that.\n\n72\n00:03:50,180 --> 00:03:52,240\nI don't have it installed.\n\n73\n00:03:52,240 --> 00:03:55,830\nSo, I've got a couple of choices\nabout how I can add that support.\n\n74\n00:03:55,830 --> 00:03:57,540\nOne, I can install the DHCP server.\n\n75\n00:03:57,540 --> 00:03:58,820\nThat would do it.\n\n76\n00:03:58,820 --> 00:04:00,770\nBut what if I'm on my workstation?\n\n77\n00:04:00,770 --> 00:04:03,230\nI'm on a Windows 7 or\nWindows 8 machine, and\n\n78\n00:04:03,230 --> 00:04:05,530\nI'm wanting to manage\na server that's running DHCP.\n\n79\n00:04:05,530 --> 00:04:08,250\nSo I don't want to be\na DHCP server myself.\n\n80\n00:04:08,250 --> 00:04:10,440\nI just want to manage somebody else,\nright.\n\n81\n00:04:10,440 --> 00:04:12,810\nWell I need the module\nwithout installing the roll.\n\n82\n00:04:14,390 --> 00:04:17,200\nWell, for Microsoft services,\n\n83\n00:04:17,200 --> 00:04:21,640\nthey have what's called the remote\nserver administration tool, so the RSAT.\n\n84\n00:04:21,640 --> 00:04:24,430\nAnd the RSAT is that collection\nof utilities that you can use to\n\n85\n00:04:24,430 --> 00:04:25,490\nmanage the server.\n\n86\n00:04:25,490 --> 00:04:29,220\nAnd that collection most people\nthink of it as the GUI's, right?\n\n87\n00:04:29,220 --> 00:04:31,580\nIt's got all the graphical\nuser interface utilities,\n\n88\n00:04:31,580 --> 00:04:33,950\nfrom managing all the server roles.\n\n89\n00:04:33,950 --> 00:04:37,000\nBut it also has the PowerShell modules.\n\n90\n00:04:37,000 --> 00:04:40,090\nSo if we install the RSAT, then\n\n91\n00:04:40,090 --> 00:04:43,990\nwe'll be able to add in the PowerShell\nmodules from whatever pieces we want.\n\n92\n00:04:43,990 --> 00:04:46,510\nAnd so that's another way\nthat we can get those added.\n\n93\n00:04:46,510 --> 00:04:50,260\nNow when you install a module,\nthere's really not all that much to it.\n\n94\n00:04:50,260 --> 00:04:54,480\nA module's simply a file that gets\ncopied to one of two locations.\n\n95\n00:04:54,480 --> 00:04:58,820\nThere is a global module folder, that's\navailable for every user of this computer,\n\n96\n00:04:58,820 --> 00:05:01,640\nand then there's a module folder\nthat's available just for\n\n97\n00:05:01,640 --> 00:05:03,890\nyou, the individual user, all right.\n\n98\n00:05:03,890 --> 00:05:06,420\nSo you can have some that are just\navailable for your account and\n\n99\n00:05:06,420 --> 00:05:09,290\nnot other people, or\nones that are installed for everyone.\n\n100\n00:05:09,290 --> 00:05:12,130\nSo, when we do something\nlike installing the RSAT,\n\n101\n00:05:12,130 --> 00:05:15,330\nwhat we're really doing is just copying\na few modules into those folders.\n\n102\n00:05:15,330 --> 00:05:16,700\nLet me show you an example.\n\n103\n00:05:16,700 --> 00:05:21,890\nSo here I'm gonna take my user account,\nand I'm just gonna browse into my profile,\n\n104\n00:05:21,890 --> 00:05:25,380\nso if I go into my Don Pezet folder and\ninto Documents.\n\n105\n00:05:25,380 --> 00:05:29,050\nI've got my Windows PowerShell folder, and\nif you don't see that Windows PowerShell\n\n106\n00:05:29,050 --> 00:05:31,200\nfolder, that just means\nyou're running all defaults.\n\n107\n00:05:31,200 --> 00:05:32,800\nYou haven't added anything, right?\n\n108\n00:05:32,800 --> 00:05:35,200\nAnd many people will see that.\n\n109\n00:05:35,200 --> 00:05:38,220\nBut if I go into it, I can see that\nI've got my profile right there, and\n\n110\n00:05:38,220 --> 00:05:40,640\nright above it I've got a Modules folder.\n\n111\n00:05:40,640 --> 00:05:46,020\nAnd inside of there, I can see any modules\nthat I've added, just for my account.\n\n112\n00:05:46,020 --> 00:05:48,360\nAnd right now, I don't have any.\n\n113\n00:05:48,360 --> 00:05:51,220\nI haven't added any modules just for me.\n\n114\n00:05:51,220 --> 00:05:54,620\nBut I know there's a ton of modules,\nthere's the active directory one, and\n\n115\n00:05:54,620 --> 00:05:56,480\nall those guys, where are they?\n\n116\n00:05:56,480 --> 00:05:58,100\nWell, they're stored in\nthe Windows directory.\n\n117\n00:05:58,100 --> 00:06:03,580\nIf I browse to C:/windows Slash system 32\n\n118\n00:06:03,580 --> 00:06:08,470\nSlash windows PoweShelll.\n\n119\n00:06:08,470 --> 00:06:11,561\nAnd then in the diversion 1.0 folder.\n\n120\n00:06:11,561 --> 00:06:13,500\nI'll see a bunch of stuff, right.\n\n121\n00:06:13,500 --> 00:06:15,590\nCuz this is really all\nthe PowerShell stuff.\n\n122\n00:06:15,590 --> 00:06:17,520\nWell what i'm looking for\nis this Modules folder.\n\n123\n00:06:17,520 --> 00:06:24,780\nSo that's c:/system 32\nWindowsPowerShell/Version1.0/Modules.\n\n124\n00:06:24,780 --> 00:06:31,830\nAnd in there, I'll see each module\nin its own separate folder.\n\n125\n00:06:31,830 --> 00:06:32,480\nSo for example,\n\n126\n00:06:32,480 --> 00:06:35,960\nthe DNS Server modules, they're\nright here in the DNS Server folder.\n\n127\n00:06:35,960 --> 00:06:38,650\nThe Active Directory modules,\nthey're right here in this folder.\n\n128\n00:06:38,650 --> 00:06:39,830\nAnd you can go down the line, and\n\n129\n00:06:39,830 --> 00:06:42,860\nkind of look at all the different\nmodules that have been installed.\n\n130\n00:06:42,860 --> 00:06:45,310\nThe PowerShell ones are all right here.\n\n131\n00:06:45,310 --> 00:06:47,430\nThe other ones like\nnetwork interface stuff.\n\n132\n00:06:47,430 --> 00:06:48,270\nIt's there.\n\n133\n00:06:48,270 --> 00:06:49,910\nNFS and so on.\n\n134\n00:06:49,910 --> 00:06:54,370\nEach of the modules that I currently have\navailable to me inside of PowerShell.\n\n135\n00:06:54,370 --> 00:06:58,430\nSo if I want to add additional modules,\nI could copy them right\n\n136\n00:06:58,430 --> 00:07:01,440\nhere into the folder, but\nwe normally do it through the software.\n\n137\n00:07:01,440 --> 00:07:03,230\nWhen we install a software package,\n\n138\n00:07:03,230 --> 00:07:06,740\nit automatically adds\nthe modules,so I mentioned DHCP.\n\n139\n00:07:06,740 --> 00:07:09,120\nIf I look at my list\nhere I don't see DHCP.\n\n140\n00:07:09,120 --> 00:07:11,080\nIt doesn't have a folder so\n\n141\n00:07:11,080 --> 00:07:15,940\nthe module's not here so\nif I want it I have to go and install it.\n\n142\n00:07:15,940 --> 00:07:21,400\nI'm going to fire up my server manager,\nand I'm going to go up to Manage.\n\n143\n00:07:22,430 --> 00:07:23,240\nActually I'll wait here.\n\n144\n00:07:23,240 --> 00:07:25,140\nIt's just doing it's\nlittle server query thing.\n\n145\n00:07:25,140 --> 00:07:28,230\nThere we go.\nI'll go to Manage and Add Roles and\n\n146\n00:07:28,230 --> 00:07:28,980\nFeatures.\n\n147\n00:07:28,980 --> 00:07:31,110\nNow I don't want to add\nthe DHCP server role.\n\n148\n00:07:31,110 --> 00:07:33,780\nI don't want to actually be a DHCP server.\n\n149\n00:07:33,780 --> 00:07:37,970\nSo, I'm gonna skip over the roles,\nand I'm gonna go right to features.\n\n150\n00:07:37,970 --> 00:07:41,957\nSo I'm gonna just move past this,\npast the server selection, past the roles,\n\n151\n00:07:41,957 --> 00:07:46,064\nI'm not changing anything there, and\non the feature screen, I'm gonna look for\n\n152\n00:07:46,064 --> 00:07:48,345\nthe Remote Server Administration Toolkit.\n\n153\n00:07:48,345 --> 00:07:51,665\nAnd if I scroll down,\nI'll find it right here,\n\n154\n00:07:51,665 --> 00:07:55,733\nRemote Server Administration Tools,\nand If I expand it,\n\n155\n00:07:55,733 --> 00:08:00,231\nI can find my Feature and\nRole Administration And DHCP is a role.\n\n156\n00:08:00,231 --> 00:08:05,020\nSo I'm gonna go under role administration\nand in here somewhere, I'll find DHCP.\n\n157\n00:08:05,020 --> 00:08:06,250\nHere's the DHCP server tools.\n\n158\n00:08:07,260 --> 00:08:12,050\nNow, most of us think of that entry as\ninstalling the graphical tools, or DHCP,\n\n159\n00:08:12,050 --> 00:08:13,720\nwhich it does, right?\n\n160\n00:08:13,720 --> 00:08:17,390\nBut, if I look at the notes over here,\nit installs the tools for\n\n161\n00:08:17,390 --> 00:08:21,960\nthe MMC snap-in,\nit installs some netsh commands, and\n\n162\n00:08:21,960 --> 00:08:25,530\nit installs a PowerShell module for\nthe DHCP server.\n\n163\n00:08:25,530 --> 00:08:27,546\nSo, that's exactly what I want.\n\n164\n00:08:27,546 --> 00:08:31,990\nI'm gonna check that off and hit Next,\nand then I'll let it install.\n\n165\n00:08:31,990 --> 00:08:36,070\nThat's gonna add the PowerShell\nmodule that I need, and\n\n166\n00:08:36,070 --> 00:08:39,420\nnow I'll be able to use that module.\n\n167\n00:08:39,420 --> 00:08:40,000\nAll right?\n\n168\n00:08:40,000 --> 00:08:41,850\nNow, I'm gonna give it\na moment while it does that.\n\n169\n00:08:41,850 --> 00:08:44,170\nIt actually takes longer\nthan it really should.\n\n170\n00:08:44,170 --> 00:08:46,890\nThe file that it's copying is,\nI don't know,\n\n171\n00:08:46,890 --> 00:08:50,090\nit's something like a massive 30 k or\nsomething.\n\n172\n00:08:50,090 --> 00:08:53,290\nA very tiny file, but\nit always takes forever to get that added.\n\n173\n00:08:53,290 --> 00:08:56,580\nI guess the GUI components probably\ntake it a little bit longer.\n\n174\n00:08:56,580 --> 00:08:58,410\nBut it's gonna copy over, and\n\n175\n00:08:58,410 --> 00:09:02,100\nwhen it's done, I should be able\nto go back to my Modules folder.\n\n176\n00:09:03,360 --> 00:09:05,640\nAnd I'm just going to refresh this screen.\n\n177\n00:09:05,640 --> 00:09:09,500\nAnd I should see, there it is,\na DHCP server folder.\n\n178\n00:09:09,500 --> 00:09:12,150\nThat's the module that was just added.\n\n179\n00:09:12,150 --> 00:09:16,720\nAnd now that it's been added, I'll have\nthe DHCP commands available to me.\n\n180\n00:09:16,720 --> 00:09:23,330\nNow if I go back to my PowerShell\nwindow and do a Get-Command *dhcp* and\n\n181\n00:09:23,330 --> 00:09:28,550\nrun that, now I've got a bunch of\ncommands available, all from that module.\n\n182\n00:09:28,550 --> 00:09:30,410\nI didn't even have to\nreopen the PowerShell.\n\n183\n00:09:30,410 --> 00:09:33,910\nIt's just automatically there and\nnow it's available, all right?\n\n184\n00:09:33,910 --> 00:09:35,580\nPretty cool stuff.\n\n185\n00:09:35,580 --> 00:09:37,575\nNow the module files themselves,\n\n186\n00:09:37,575 --> 00:09:39,756\nI mentioned that anybody can create them,\nright?\n\n187\n00:09:39,756 --> 00:09:43,848\nIf we go into that, you'll see\nthat there may be just one file or\n\n188\n00:09:43,848 --> 00:09:45,713\nthere may be several files.\n\n189\n00:09:45,713 --> 00:09:49,917\nPowerShell modules are text files and\n\n190\n00:09:49,917 --> 00:09:53,594\ntheir saved as a name dot PSM1 and\n\n191\n00:09:53,594 --> 00:09:58,340\nthat's pretty much all there is to them.\n\n192\n00:09:58,340 --> 00:09:59,330\nIf we take a look at one,\n\n193\n00:09:59,330 --> 00:10:04,040\nlike here, the DHCP Server Database,\nI'll go ahead and edit that one.\n\n194\n00:10:05,840 --> 00:10:10,200\nYou'll see that it's written as basically\nan XML file and it's just laying out\n\n195\n00:10:10,200 --> 00:10:13,310\nexactly what this command is, so\nhere's some static commandlets.\n\n196\n00:10:13,310 --> 00:10:15,040\nI've got a verb called get.\n\n197\n00:10:15,040 --> 00:10:15,580\nRight?\n\n198\n00:10:15,580 --> 00:10:19,010\nSo here is a get command\nwith this being added.\n\n199\n00:10:19,010 --> 00:10:23,260\nAnd, as we go down the list,\nthis one is get computer name.\n\n200\n00:10:23,260 --> 00:10:24,160\nAnd then, under that,\n\n201\n00:10:24,160 --> 00:10:28,580\nit's showing you exactly what it's going\nto get and where that data comes from.\n\n202\n00:10:28,580 --> 00:10:31,300\nSo they're just defining exactly\nhow that command works and\n\n203\n00:10:31,300 --> 00:10:33,230\nthen how it's output works.\n\n204\n00:10:33,230 --> 00:10:36,660\nHow you get that information\ndisplayed back on your screen.\n\n205\n00:10:36,660 --> 00:10:40,820\nIt's all written here in XML and\nit's pretty easy to read.\n\n206\n00:10:40,820 --> 00:10:45,380\nIn this case it's pulling data and it's\nactually pulling it from the CIM database,\n\n207\n00:10:45,380 --> 00:10:49,960\nwhich is where the WMI stores\na lot of its data, and so\n\n208\n00:10:49,960 --> 00:10:52,720\nit's actually querying\nthe WMI on the backend.\n\n209\n00:10:52,720 --> 00:10:53,700\nWe don't see that though,\n\n210\n00:10:53,700 --> 00:10:57,410\nwe just see get-database, or\nget-hostname, or whatever.\n\n211\n00:10:57,410 --> 00:11:01,050\nIn the back end,\nit's interacting with the WMI, right?\n\n212\n00:11:01,050 --> 00:11:03,160\nSo Microsoft has already defined these for\nus.\n\n213\n00:11:03,160 --> 00:11:05,671\nWe just load them in and\nnow we've got the commands.\n\n214\n00:11:05,671 --> 00:11:08,722\nNow we can have at it and\nwhen you start managing DHCP servers,\n\n215\n00:11:08,722 --> 00:11:11,490\neven though we're not running\nthe DHCP server itself.\n\n216\n00:11:12,760 --> 00:11:16,280\nYou'll find that when you install\neven third party software,\n\n217\n00:11:16,280 --> 00:11:19,390\nthat a lot of times they'll\nadd PowerShell modules, too.\n\n218\n00:11:19,390 --> 00:11:22,210\nSo that is one way to go about it.\n\n219\n00:11:22,210 --> 00:11:27,690\nThe only problem with this solution\nis I had to install the GUI tools for\n\n220\n00:11:27,690 --> 00:11:31,280\nthe DHCP server also,\nand I may not want that.\n\n221\n00:11:31,280 --> 00:11:33,870\nIf I just want the PowerShell\nmodule files and\n\n222\n00:11:33,870 --> 00:11:38,430\nthat's it, I can copy that folder\nthat was in the modules folder.\n\n223\n00:11:38,430 --> 00:11:41,390\nCopy it, and then uninstall\nthe management tools for DHCP.\n\n224\n00:11:41,390 --> 00:11:44,640\nThen I can just put this folder back, and\n\n225\n00:11:44,640 --> 00:11:48,320\nnow I'll just have those PowerShell\ncommandlets, and that's it.\n\n226\n00:11:48,320 --> 00:11:51,440\nSo there's a few different ways you\ncan go about it to get that in place.\n\n227\n00:11:51,440 --> 00:11:54,870\nSo, but that is basically how it works.\n\n228\n00:11:54,870 --> 00:11:58,320\nThese modules,\nthey really do extend that functionality.\n\n229\n00:11:58,320 --> 00:12:01,230\nNow, that's great,\nwhat we just saw right there, right?\n\n230\n00:12:01,230 --> 00:12:05,090\nEasily added in a Microsoft one, we got\nadditional functionality out of, out if.\n\n231\n00:12:05,090 --> 00:12:06,713\nThat's wonderful, right?\n\n232\n00:12:06,713 --> 00:12:11,073\nBut, where things get really powerful\nis where you go out to the internet and\n\n233\n00:12:11,073 --> 00:12:15,028\nthird party companies, and\nother individuals just like yourself,\n\n234\n00:12:15,028 --> 00:12:19,528\nhave written some great PowerShell\nmodules that do some kind of enhancement,\n\n235\n00:12:19,528 --> 00:12:22,867\nsomething that's not offered\nin the stock solution, and\n\n236\n00:12:22,867 --> 00:12:25,963\nyou can use those to really\nachieve some neat things.\n\n237\n00:12:25,963 --> 00:12:27,046\nAll right?\n\n238\n00:12:27,046 --> 00:12:31,743\nFor example, in one of the shows earlier,\nI mentioned how setting the Windows\n\n239\n00:12:31,743 --> 00:12:36,960\nposition for your PowerShell screen is not\nsomething that's very easy to do, right?\n\n240\n00:12:36,960 --> 00:12:40,190\nIt doesn't really give us a great\nway to position it on the screen.\n\n241\n00:12:40,190 --> 00:12:41,230\nBut there's a third\n\n242\n00:12:41,230 --> 00:12:45,380\nparty commandlet out there called\nset-windowposition, that does it.\n\n243\n00:12:45,380 --> 00:12:46,020\nSomebody went and\n\n244\n00:12:46,020 --> 00:12:48,860\nactually wrote the commandlet that\nwould provide that functionality.\n\n245\n00:12:48,860 --> 00:12:51,930\nIt's not present in PowerShell,\nbut you can add it on.\n\n246\n00:12:51,930 --> 00:12:56,360\nAlright, one that I actually used myself\nis one that's called find string.\n\n247\n00:12:57,490 --> 00:13:04,963\nIn PowerShell,\nyou have a command called Select-String.\n\n248\n00:13:04,963 --> 00:13:07,916\nThe commandlet, Select-String,\n\n249\n00:13:07,916 --> 00:13:12,720\nwhat it does is it lets you\nfind a text string in files.\n\n250\n00:13:12,720 --> 00:13:16,220\nIt's very much like the Linux or\nUnix grep command, or g-rep or\n\n251\n00:13:16,220 --> 00:13:17,130\nwhatever you wanna call it.\n\n252\n00:13:17,130 --> 00:13:21,800\nWhere it will scan across any number of\nfiles and return every line that contains\n\n253\n00:13:21,800 --> 00:13:25,930\na string of characters that you provide\nit with, right, and it does a good job.\n\n254\n00:13:25,930 --> 00:13:27,630\nIt works pretty well.\n\n255\n00:13:27,630 --> 00:13:31,840\nBut, there's one thing it doesn't do, and\nthat's what's called match highlighting.\n\n256\n00:13:31,840 --> 00:13:35,470\nMatch highlighting is where it actually\nhighlights exactly the words that we've\n\n257\n00:13:35,470 --> 00:13:37,280\nreferenced that match it.\n\n258\n00:13:37,280 --> 00:13:40,610\nAnd so\nthere's a third party commandlet out there\n\n259\n00:13:40,610 --> 00:13:43,680\nthat does basically the same\nthing called find stream.\n\n260\n00:13:43,680 --> 00:13:45,750\nIt actually uses select stream.\n\n261\n00:13:45,750 --> 00:13:50,210\nThe only difference is, when it runs and\nfinds our data, it then\n\n262\n00:13:50,210 --> 00:13:54,650\nhighlights the words that match, like so I\ncan tell exactly where that word came in.\n\n263\n00:13:54,650 --> 00:13:57,180\nIt's a neat little module,\nI've used it a number of times.\n\n264\n00:13:57,180 --> 00:13:58,760\nBut it's not from Microsoft.\n\n265\n00:13:58,760 --> 00:14:03,550\nIt's just a free one that somebody\nwrote and posted on the Internet, and\n\n266\n00:14:03,550 --> 00:14:04,820\nit works really well.\n\n267\n00:14:04,820 --> 00:14:07,670\nWell, for that module,\nI went out and downloaded it and\n\n268\n00:14:07,670 --> 00:14:09,700\nI wanna add it to my PowerShell.\n\n269\n00:14:09,700 --> 00:14:12,780\nAnd when you do that, you make a decision.\n\n270\n00:14:12,780 --> 00:14:16,420\nDo you wanna add it just for you or\ndo you wanna add it for everybody?\n\n271\n00:14:16,420 --> 00:14:16,970\nAll right.\n\n272\n00:14:16,970 --> 00:14:21,210\nIf I wanna add it for everybody,\nI need to put it into\n\n273\n00:14:21,210 --> 00:14:26,350\nthe\nC:/Windows/System32/WindowsPowerShell/Ver-\n\n274\n00:14:26,350 --> 00:14:28,921\nsion1.0/Modules folder.\n\n275\n00:14:28,921 --> 00:14:32,300\nI throw it there and\nit'll be available for everybody.\n\n276\n00:14:32,300 --> 00:14:36,320\nBut if I want it available for just me,\nthan I need to put it in my own profile.\n\n277\n00:14:37,520 --> 00:14:42,380\nAnd so if I go into my profile, I actually\ndownloaded this one before the show so\n\n278\n00:14:42,380 --> 00:14:43,580\nI've got it right here.\n\n279\n00:14:43,580 --> 00:14:46,760\nI've got it in a folder called\nfind string and inside of there,\n\n280\n00:14:46,760 --> 00:14:50,630\nthere's the find string commandlet,\nand if we edit that.\n\n281\n00:14:50,630 --> 00:14:52,039\nOr here I'll just open it in a window pad.\n\n282\n00:14:53,090 --> 00:14:54,200\nAll right, here it is.\n\n283\n00:14:54,200 --> 00:14:56,880\nYou'll see that it's not\na terribly complex thing.\n\n284\n00:14:56,880 --> 00:15:01,588\nIt's really just taking Select-String and\nadding that word matching, right?\n\n285\n00:15:01,588 --> 00:15:03,560\nSo that's really all it does.\n\n286\n00:15:03,560 --> 00:15:06,150\nBut obviously it's more than I\nwould have written myself, so\n\n287\n00:15:06,150 --> 00:15:07,490\nit's kind of nice to have it.\n\n288\n00:15:07,490 --> 00:15:09,400\nBut basically, this is it.\n\n289\n00:15:09,400 --> 00:15:13,190\nAnd I can take that and\ncopy it into my own folder, and\n\n290\n00:15:13,190 --> 00:15:14,850\nit'll become available for me.\n\n291\n00:15:14,850 --> 00:15:15,620\nAll right.\n\n292\n00:15:15,620 --> 00:15:18,800\nNow i'm gonna do just that,\ni'm gonna copy this find string folder,\n\n293\n00:15:18,800 --> 00:15:23,830\nand I'm gonna go into my windows\nPowerShell and modules folder.\n\n294\n00:15:23,830 --> 00:15:26,100\nAnd i'll paste it right here okay.\n\n295\n00:15:26,100 --> 00:15:32,010\nSo I've now got it pasted into my own\nmodules and now it's pretty much ready.\n\n296\n00:15:32,010 --> 00:15:37,400\nWell, when you install software, one of\nthe things that it'll do is automatically\n\n297\n00:15:37,400 --> 00:15:41,950\nimport the module for you and\nget the module loaded and ready to run.\n\n298\n00:15:41,950 --> 00:15:44,000\nSo, you install the software and\nyou're done.\n\n299\n00:15:44,000 --> 00:15:47,965\nBut went you copy it over like this,\nsometimes they can automatically load,\n\n300\n00:15:47,965 --> 00:15:49,737\nbut most of the times they don't.\n\n301\n00:15:49,737 --> 00:15:51,837\nSo, while I just added Find-String,\n\n302\n00:15:51,837 --> 00:15:54,776\nI won't be surprised if it's\nnot actually there yet.\n\n303\n00:15:54,776 --> 00:15:55,901\nSo if I run Find-String.\n\n304\n00:15:55,901 --> 00:15:56,478\nOh it did!\n\n305\n00:15:56,478 --> 00:15:59,282\nIt actually went ahead and\nloaded it for me and there it is.\n\n306\n00:15:59,282 --> 00:16:01,070\nSo sometimes it will do that.\n\n307\n00:16:01,070 --> 00:16:03,450\nSometimes it will go ahead and\nload for you.\n\n308\n00:16:03,450 --> 00:16:07,140\nIf it doesn't you can\nalways load it yourself\n\n309\n00:16:07,140 --> 00:16:11,848\nby saying Import-Module and\nspecifying the module that you want to in,\n\n310\n00:16:11,848 --> 00:16:16,430\nokay now Import-Module is\na little bit interesting because\n\n311\n00:16:16,430 --> 00:16:20,730\nthe way it works is you say Import-Module\nand then just the name of the module.\n\n312\n00:16:20,730 --> 00:16:26,490\nSo I should say Find-Stringand\nit will import it.\n\n313\n00:16:26,490 --> 00:16:30,020\nNow how does it know where to look for\nthat module?\n\n314\n00:16:30,020 --> 00:16:32,330\nWell it's going to look\nin those two places.\n\n315\n00:16:32,330 --> 00:16:36,270\nThe location that's global inside\nof the Windows folder, and\n\n316\n00:16:36,270 --> 00:16:38,930\nthe location that's local to you,\ninside of your profile.\n\n317\n00:16:38,930 --> 00:16:41,790\nSo that's where it's gonna look\nby default, and it's looking for\n\n318\n00:16:41,790 --> 00:16:44,380\na folder called Fing-String.\n\n319\n00:16:44,380 --> 00:16:47,340\nAnd whatever's in that folder,\nit's gonna load.\n\n320\n00:16:47,340 --> 00:16:53,570\nBecause that folder, sure it might\nhave one, .psm1 file like I do.\n\n321\n00:16:53,570 --> 00:16:54,530\nOr it might have 50 of them.\n\n322\n00:16:54,530 --> 00:16:56,210\nAnd if that's the case\nit will load all 50.\n\n323\n00:16:56,210 --> 00:16:59,170\nSo what you're really\nproviding is that folder name\n\n324\n00:16:59,170 --> 00:17:00,950\ninside of the models directory.\n\n325\n00:17:00,950 --> 00:17:02,470\nAll right, so it's going to look for\nthat and import those.\n\n326\n00:17:03,710 --> 00:17:05,940\nOnce it's imported, you ready to rock.\n\n327\n00:17:05,940 --> 00:17:08,540\nNow what if you want\nto import a module and\n\n328\n00:17:08,540 --> 00:17:12,690\nfor some reason you don't want to put\nit in one of those two directions.\n\n329\n00:17:12,690 --> 00:17:15,280\nWell first off,\nyou should really reevaluate that, right?\n\n330\n00:17:15,280 --> 00:17:18,760\nIt's not that big of a deal to copy,\nbut if you have some reason where you\n\n331\n00:17:18,760 --> 00:17:23,720\nabsolutely just have to put it somewhere\nelse It actually can pull them in from\n\n332\n00:17:23,720 --> 00:17:28,900\nother places, but\nit's gonna use the Windows $path variable.\n\n333\n00:17:28,900 --> 00:17:34,995\nInside of Windows we have\nthe $path variable and,\n\n334\n00:17:38,175 --> 00:17:42,146\nIt's not gonna echo that for me, is it.\n\n335\n00:17:42,146 --> 00:17:43,390\nOh shoot.\n\n336\n00:17:43,390 --> 00:17:48,186\nWell the path variable,\nwhich apparently I can't seem to remember.\n\n337\n00:17:53,686 --> 00:17:56,450\nThere we go.\nLet me bump that size up.\n\n338\n00:17:56,450 --> 00:18:01,050\nThe path variable, it just stores all\nthe directories that Windows will search\n\n339\n00:18:01,050 --> 00:18:02,220\nwhen it looks for commands.\n\n340\n00:18:02,220 --> 00:18:05,260\nAnd it's normally used for\nexactly that, command execution.\n\n341\n00:18:05,260 --> 00:18:09,240\nBut the module import\nprocess can use it too.\n\n342\n00:18:09,240 --> 00:18:12,620\nIt can use it to scan through\nall of these other directories.\n\n343\n00:18:12,620 --> 00:18:16,410\nAnd if you look at mine,\nI've got c:/Windows/System32.\n\n344\n00:18:16,410 --> 00:18:21,035\nI've got c:/Windows,\na couple of other System32 folders.\n\n345\n00:18:21,035 --> 00:18:23,960\nHere's that PowerShell folder.\n\n346\n00:18:23,960 --> 00:18:27,330\nRight, so\nthere's my PowerShell\\v1.0 folder.\n\n347\n00:18:27,330 --> 00:18:28,920\nI've got my SQL server client.\n\n348\n00:18:28,920 --> 00:18:31,930\nAnd all these different directories\nthat are a part of my path.\n\n349\n00:18:31,930 --> 00:18:34,390\nIf you want to install a module and\nyou can't for\n\n350\n00:18:34,390 --> 00:18:38,040\nsome reason copy it into one of\nthe two main module folders,\n\n351\n00:18:38,040 --> 00:18:43,210\nthen instead you could add the folder\nthat it's into your path and\n\n352\n00:18:43,210 --> 00:18:46,460\nthen you'll be able to import it\nbecause now it's in the search path.\n\n353\n00:18:46,460 --> 00:18:47,110\nAll right?\n\n354\n00:18:47,110 --> 00:18:48,580\nI personally don't like to do this.\n\n355\n00:18:48,580 --> 00:18:52,767\nI don't like to manipulate the path\ninside of Windows if I don't have to but\n\n356\n00:18:52,767 --> 00:18:56,621\nthis is one of those cases where\nsince we're only providing a name and\n\n357\n00:18:56,621 --> 00:18:59,431\nnot a directory,\nwe don't really have a choice.\n\n358\n00:18:59,431 --> 00:19:06,031\nAll right, so we may need to\ndo that otherwise that's that.\n\n359\n00:19:06,031 --> 00:19:10,360\nNow if we have a module and\nwe decide we don't need it anymore,\n\n360\n00:19:10,360 --> 00:19:15,854\nif we want to get rid of that module,\nwell we use import-module to bring it in,\n\n361\n00:19:15,854 --> 00:19:19,230\nwe can use remove-module to get rid of it.\n\n362\n00:19:19,230 --> 00:19:21,960\nThere is one little caveat to that though,\nall right?\n\n363\n00:19:21,960 --> 00:19:25,640\nRight now I have my\nFind-String module installed.\n\n364\n00:19:25,640 --> 00:19:30,280\nSo if I say get-command Find-String,\nI can see it right there.\n\n365\n00:19:30,280 --> 00:19:32,850\nSo I've got it, and\nit came from the Find-String module.\n\n366\n00:19:33,870 --> 00:19:38,840\nI could say Remove-Module, Find-String.\n\n367\n00:19:38,840 --> 00:19:40,480\nAnd that's gonna remove it.\n\n368\n00:19:40,480 --> 00:19:44,820\nAlright, but the command is still there.\n\n369\n00:19:44,820 --> 00:19:45,810\nWhat the heck is going on there?\n\n370\n00:19:45,810 --> 00:19:47,270\nI removed it, and now it's right back.\n\n371\n00:19:48,580 --> 00:19:53,290\nIf you have a module that auto registers,\nremember how it automatically activated.\n\n372\n00:19:53,290 --> 00:19:56,060\nI didn't have to run\nthe import module command.\n\n373\n00:19:56,060 --> 00:19:59,470\nWell if you have one that auto registers,\nand you remove it, what's it gonna do?\n\n374\n00:19:59,470 --> 00:20:02,610\nIt's just gonna turn right around and\nauto register again.\n\n375\n00:20:02,610 --> 00:20:06,820\nSo if it's a module that you had\nused the import command with,\n\n376\n00:20:06,820 --> 00:20:09,880\nthen you'll use the remove command and\nthat'll get rid of it.\n\n377\n00:20:09,880 --> 00:20:12,720\nBut if it's a module that\nautomatically came in.\n\n378\n00:20:12,720 --> 00:20:15,230\nThe way you get rid of it is\nto just go and delete it.\n\n379\n00:20:15,230 --> 00:20:16,850\nDelete it or\nmove it out of that directory.\n\n380\n00:20:18,100 --> 00:20:23,970\nSo if I go back to that folder and\nI just delete it out of there.\n\n381\n00:20:23,970 --> 00:20:25,490\nSo there goes Find-String, it's gone.\n\n382\n00:20:26,890 --> 00:20:30,050\nNow I can go back and do my query and\n\n383\n00:20:30,050 --> 00:20:33,100\nit's still there because\nI haven't removed it yet.\n\n384\n00:20:33,100 --> 00:20:37,290\nAnd now I can run that Remove,\nwherever it went, there we go.\n\n385\n00:20:37,290 --> 00:20:38,700\nRemove.\n\n386\n00:20:38,700 --> 00:20:41,050\nAnd now it's gone.\n\n387\n00:20:41,050 --> 00:20:42,170\nRight, now when I go and query that,\n\n388\n00:20:42,170 --> 00:20:45,120\nit's gonna tell me there's no command\ncalled find-string, all right?\n\n389\n00:20:45,120 --> 00:20:47,325\nSo the problem is that\nautomatic registration, right?\n\n390\n00:20:47,325 --> 00:20:49,815\nThat's just re-registering\nitself after I remove it.\n\n391\n00:20:49,815 --> 00:20:52,645\nThe Remove-Module command does work but\n\n392\n00:20:52,645 --> 00:20:54,915\nsometimes it's not obvious\nbecause of the auto registration.\n\n393\n00:20:55,925 --> 00:20:59,315\nSo that's how I can get\nthat command back out.\n\n394\n00:20:59,315 --> 00:21:03,615\nBut once the command is there,\nonce the module is in place and\n\n395\n00:21:03,615 --> 00:21:07,190\nregistered and happy you use\nit just like any other module.\n\n396\n00:21:08,300 --> 00:21:13,400\nSo for example I've got a CSV file here.\n\n397\n00:21:13,400 --> 00:21:17,820\nAnd if I take a look at what's in it,\nit's a CSV and\n\n398\n00:21:17,820 --> 00:21:21,670\nit's listing a bunch of user accounts and\nI can see my user account right here\n\n399\n00:21:21,670 --> 00:21:26,940\nmaybe I wanna look at that file and I just\nwanna see the line that has my name in it.\n\n400\n00:21:26,940 --> 00:21:31,370\nWell, here I've got maybe 15 lines,no big\ndeal but what if this was 15,000 lines.\n\n401\n00:21:32,410 --> 00:21:35,720\nI don't wanna search it to find\njust the line with my name.\n\n402\n00:21:35,720 --> 00:21:43,310\nSo, I could use Select-String,\nwhich is the built-in PowerShell command.\n\n403\n00:21:43,310 --> 00:21:47,530\nSo, if I do that, if I just use my built\nin Select-String, well it goes like this,\n\n404\n00:21:47,530 --> 00:21:52,230\nshould we say select dash string path,\nwe tell it the file we're pulling it from\n\n405\n00:21:53,400 --> 00:21:55,790\nand then we tell it the pattern\nthat we're looking for.\n\n406\n00:21:56,810 --> 00:22:02,150\nSo I'm gonna look for any line that\nincludes the word Pezet, all right.\n\n407\n00:22:02,150 --> 00:22:03,000\nSo it searches it.\n\n408\n00:22:03,000 --> 00:22:03,780\nIt finds it.\n\n409\n00:22:03,780 --> 00:22:04,280\nThere's a line.\n\n410\n00:22:04,280 --> 00:22:05,210\nThat worked.\n\n411\n00:22:05,210 --> 00:22:06,540\nOkay.\n\n412\n00:22:06,540 --> 00:22:11,250\nBut, I now have my new so\na Find-String that I can use.\n\n413\n00:22:11,250 --> 00:22:14,220\nIt does the same thing but\nwith syntax highlighting.\n\n414\n00:22:14,220 --> 00:22:16,750\nSo if I do Find-String,\nmy new little add on,\n\n415\n00:22:16,750 --> 00:22:21,830\nI can punch in the word I'm looking for\nwhich is present.\n\n416\n00:22:21,830 --> 00:22:24,090\nAnd then I can tell it what to look in and\n\n417\n00:22:24,090 --> 00:22:28,400\nI can specify that individual file and\nit's going to search it.\n\n418\n00:22:28,400 --> 00:22:32,210\nAnd there it is, and it's giving me\ntwo things the other one didn't.\n\n419\n00:22:32,210 --> 00:22:37,110\nThe other one gave me the file\nname on the same line as the file,\n\n420\n00:22:37,110 --> 00:22:40,130\nversus here it's separated them out and\ndone a little highlighting.\n\n421\n00:22:40,130 --> 00:22:43,675\nAnd then after so that here's\nthe line with Don Pezet on it, and\n\n422\n00:22:43,675 --> 00:22:45,395\nit's highlighting the word that matched.\n\n423\n00:22:45,395 --> 00:22:47,245\nKind of a nice little add-on, right?\n\n424\n00:22:47,245 --> 00:22:49,715\nNot anything spectacular,\nyou wouldn't pay thousands of dollars for\n\n425\n00:22:49,715 --> 00:22:53,445\nthat functionality, but for\na free module add-on, it's pretty useful,\n\n426\n00:22:53,445 --> 00:22:54,342\nand it's nice to have.\n\n427\n00:22:56,352 --> 00:22:59,192\nRight.\nIf you have a roaming user profile, and\n\n428\n00:22:59,192 --> 00:23:03,502\nyou've stored this commandlet in your\nmodules folder in your documents folder,\n\n429\n00:23:03,502 --> 00:23:05,962\nas you move from machine to machine\nto machine, it will follow you and\n\n430\n00:23:05,962 --> 00:23:07,850\nyou'll always have that\ncommandlet available.\n\n431\n00:23:07,850 --> 00:23:08,450\nAll right.\n\n432\n00:23:08,450 --> 00:23:11,290\nBut if you don't have a roaming user\nprofile when you go from machine to\n\n433\n00:23:11,290 --> 00:23:14,670\nmachine to machine you may or\nmay not have that command available.\n\n434\n00:23:14,670 --> 00:23:19,010\nSo a lot of people prefer not to use\nadd on modules like these just for\n\n435\n00:23:19,010 --> 00:23:20,530\nconsistency right.\n\n436\n00:23:20,530 --> 00:23:23,890\nYou don't want to rely on a module like\nthis and all of a sudden you get a new\n\n437\n00:23:23,890 --> 00:23:26,110\ncomputer and you've got to figure\nout all the modules that you missed.\n\n438\n00:23:26,110 --> 00:23:27,580\nAnd and those back in.\n\n439\n00:23:27,580 --> 00:23:30,620\nThat's why Microsoft puts that\nprofile in your Documents folder,\n\n440\n00:23:30,620 --> 00:23:32,830\nbecause most people back\nup their Documents folder.\n\n441\n00:23:32,830 --> 00:23:36,020\nWhen you move to a new computer you\ncopy your Documents folder over, and\n\n442\n00:23:36,020 --> 00:23:39,290\nnow you've got all your PowerShell stuff,\nthat's why they chose that location.\n\n443\n00:23:39,290 --> 00:23:44,390\nSo these are an example of an add-on\nmodule that adds that functionality.\n\n444\n00:23:44,390 --> 00:23:47,438\nIf you go and do a Google search on the\nInternet you will find thousands of add-on\n\n445\n00:23:47,438 --> 00:23:48,543\nmodules that are out there.\n\n446\n00:23:48,543 --> 00:23:51,692\nSome from very big companies like Dell and\nQuest.\n\n447\n00:23:51,692 --> 00:23:53,480\nThey have a bunch of\nthem that are out there.\n\n448\n00:23:53,480 --> 00:23:55,796\nThere's also ones that are just\nfrom individual people.\n\n449\n00:23:55,796 --> 00:23:56,860\nPeople like you and me.\n\n450\n00:23:56,860 --> 00:23:59,651\nThat had a need, and\nwent ahead and made it, right?\n\n451\n00:23:59,651 --> 00:24:03,050\nMade the command that met their needs,\nand maybe you have that same need, right?\n\n452\n00:24:03,050 --> 00:24:04,800\nMaybe it was something\nthat you were looking for.\n\n453\n00:24:04,800 --> 00:24:06,190\nThat's how I came across this one.\n\n454\n00:24:06,190 --> 00:24:10,500\nI was looking for a command that better\nrecreated what I had with grep but\n\n455\n00:24:10,500 --> 00:24:13,360\ninside of PowerShell, and\nselect-string wasn't cutting it for me.\n\n456\n00:24:13,360 --> 00:24:15,700\nAnd so I came across this one and\nit works well.\n\n457\n00:24:16,880 --> 00:24:22,270\nSo those are some examples there of adding\non that functionality into PowerShell.\n\n458\n00:24:22,270 --> 00:24:25,310\nLet me see if I'm missing anything.\n\n459\n00:24:25,310 --> 00:24:26,710\nOh, there is one other thing.\n\n460\n00:24:28,690 --> 00:24:33,370\nWhen we add on modules like these,\nIf I'm adding SQL and\n\n461\n00:24:34,620 --> 00:24:38,012\nExchange, whatever all these\nthird party software modules.\n\n462\n00:24:38,012 --> 00:24:41,200\nI may have to install a bunch of stuff\nto my machine to get those modules.\n\n463\n00:24:41,200 --> 00:24:43,440\nAnd if I'm just gonna need it one time,\n\n464\n00:24:43,440 --> 00:24:46,120\nit's kind of a waste to add\nmodules that I'm not gonna need.\n\n465\n00:24:46,120 --> 00:24:51,770\nThe more modules that you have,\nthe slower PowerShell gets at launch time.\n\n466\n00:24:51,770 --> 00:24:54,370\nNot when it's running, so\nlike once you're in and running,\n\n467\n00:24:54,370 --> 00:24:56,620\nit runs the same regardless\nof how many modules you have.\n\n468\n00:24:56,620 --> 00:25:00,580\nBut when you first launch PowerShell,\nit has to index your modules and\n\n469\n00:25:00,580 --> 00:25:02,390\nget those commands ready.\n\n470\n00:25:02,390 --> 00:25:04,660\nAnd it will slow that time down.\n\n471\n00:25:04,660 --> 00:25:08,550\nSo for example if you launch your\nPowerShell on a Microsoft Exchange server,\n\n472\n00:25:08,550 --> 00:25:13,610\nit's not uncommon for it to sit and pause\nfor upwards of to a minute in some cases.\n\n473\n00:25:13,610 --> 00:25:16,360\nAnd that is a long time in computers.\n\n474\n00:25:16,360 --> 00:25:22,970\nSo we try to minimize the amount of\nPowerShell modules that we add on.\n\n475\n00:25:22,970 --> 00:25:26,610\nBut if you just need one right now, and\n\n476\n00:25:26,610 --> 00:25:30,660\nthere's another computer that already has\nit, or maybe the server already has it,\n\n477\n00:25:30,660 --> 00:25:34,900\nyou can actually tell it to load\nthe modules from that other server.\n\n478\n00:25:34,900 --> 00:25:39,110\nAll right, there's a function inside\nof PowerShell called remoting.\n\n479\n00:25:39,110 --> 00:25:43,180\nRemoting is where you connect your\nPowerShell to another system.\n\n480\n00:25:43,180 --> 00:25:47,180\nAnd I'm gonna show that in another segment\nwhere we talk about remote management.\n\n481\n00:25:47,180 --> 00:25:50,280\nBut one of neat aspects of\nremoting is you can say,\n\n482\n00:25:50,280 --> 00:25:53,230\ndon't fully connect me to the other side.\n\n483\n00:25:53,230 --> 00:25:54,900\nJust grab their modules.\n\n484\n00:25:54,900 --> 00:25:59,660\nGive me the same modules that they already\nhave, just for this session, all right.\n\n485\n00:25:59,660 --> 00:26:02,560\nI don't recommend it because it's not\nthe greatest thing cuz you can bump into\n\n486\n00:26:02,560 --> 00:26:06,690\nconflicts where they might have a module\nthat's newer than the one you've already\n\n487\n00:26:06,690 --> 00:26:08,070\ngot or vice versa and so\n\n488\n00:26:08,070 --> 00:26:10,570\nnow they bump into each other\nbecause they have the same module.\n\n489\n00:26:10,570 --> 00:26:14,340\nYou'll get a lot of errors when you\nturn it on as it hits those duplicates.\n\n490\n00:26:14,340 --> 00:26:18,340\nAnd then the ones that aren't\nthe same like the new ones,\n\n491\n00:26:18,340 --> 00:26:21,440\nthe additional ones, those that get\nadded in and then it will work great.\n\n492\n00:26:21,440 --> 00:26:25,470\nThis is something I really don't use very\noften just because it's kind of a mess and\n\n493\n00:26:25,470 --> 00:26:27,120\nthere is a better option.\n\n494\n00:26:27,120 --> 00:26:32,100\nSo if you're looking to do this,\nto load Powershell modules temporarily.\n\n495\n00:26:32,100 --> 00:26:34,220\nBe sure to check out our\nremote management episode.\n\n496\n00:26:34,220 --> 00:26:35,870\nI'll show you guys a better way to do it.\n\n497\n00:26:35,870 --> 00:26:39,730\nFor completeness, let me show you right\nhere how to load modules from another\n\n498\n00:26:39,730 --> 00:26:42,160\nserver for temporary use.\n\n499\n00:26:42,160 --> 00:26:47,570\nThe way we do it is from inside of\nour PowerShell, we just need to give\n\n500\n00:26:47,570 --> 00:26:51,060\nit a heads up that we're gonna be loading\nthese commands from somewhere else.\n\n501\n00:26:52,080 --> 00:26:54,380\nAnd it does take two lines to do this one.\n\n502\n00:26:54,380 --> 00:26:58,580\nI'm going to create a variable called s.\n\n503\n00:26:58,580 --> 00:27:02,212\nAnd I'm going to store the output of\na command which is going to be the New\n\n504\n00:27:02,212 --> 00:27:06,540\n-PSSession command.\n\n505\n00:27:06,540 --> 00:27:08,080\nAnd, I'm going to specify a computer.\n\n506\n00:27:08,080 --> 00:27:09,900\nAnd this will be the remote computer.\n\n507\n00:27:09,900 --> 00:27:13,090\nWho it is,\nthat has the module that you want.\n\n508\n00:27:13,090 --> 00:27:13,730\nAll right.\n\n509\n00:27:13,730 --> 00:27:15,160\nSo, my server is called Server01.\n\n510\n00:27:15,160 --> 00:27:16,800\nI'm actually going to connect to myself.\n\n511\n00:27:16,800 --> 00:27:18,190\nJust to show it.\n\n512\n00:27:18,190 --> 00:27:21,250\nBut you'd specify some other server or\nworkstation,\n\n513\n00:27:21,250 --> 00:27:22,458\nthat had the modules you needed.\n\n514\n00:27:22,458 --> 00:27:28,734\nSo, I'm saying,\nset this session as a variable called $S.\n\n515\n00:27:29,750 --> 00:27:32,793\nSo, that's gonna store it and it's gonna\nget angry at me what's its problem,\n\n516\n00:27:32,793 --> 00:27:34,290\naccess denied, oh, shoot!\n\n517\n00:27:34,290 --> 00:27:35,850\nI need to be an administrator\nto do this and\n\n518\n00:27:35,850 --> 00:27:38,960\nI did not run my PowerShell\nwith administrative privileges.\n\n519\n00:27:38,960 --> 00:27:40,830\nSo, let me switch that around.\n\n520\n00:27:45,380 --> 00:27:47,040\nThere we go and we'll try this again.\n\n521\n00:27:47,040 --> 00:27:48,780\nAll right, there.\n\n522\n00:27:48,780 --> 00:27:53,150\nSo now I'm giving this variable\nthat allows me to call that session\n\n523\n00:27:53,150 --> 00:27:53,930\nwhenever I want.\n\n524\n00:27:53,930 --> 00:27:58,460\nSo now I can call a PowerShell connection\nover to Server01 whenever I want.\n\n525\n00:27:58,460 --> 00:28:02,155\nAnd from here, I just say,\n\n526\n00:28:02,155 --> 00:28:08,550\nImport-PSSession-Session $S, right.\n\n527\n00:28:08,550 --> 00:28:10,800\nReferencing the one I stored up here.\n\n528\n00:28:10,800 --> 00:28:14,930\nSo, I'm going to import\nthe PowerShell Session from that server.\n\n529\n00:28:14,930 --> 00:28:18,680\nImport, just like when I imported modules,\nthat's what it's going to do here,\n\n530\n00:28:18,680 --> 00:28:23,100\nit's going to take whatever modules are\navailable to a session on that server and\n\n531\n00:28:23,100 --> 00:28:25,990\nconnect them into this\nsession temporarily.\n\n532\n00:28:25,990 --> 00:28:26,630\nRight?\n\n533\n00:28:26,630 --> 00:28:29,260\nAnd when I run that it's\ngonna reach out and\n\n534\n00:28:29,260 --> 00:28:30,790\nit's gonna pull\nthe information from there.\n\n535\n00:28:30,790 --> 00:28:33,270\nNow, expect to see some errors.\n\n536\n00:28:33,270 --> 00:28:35,550\nRight?\nYou're gonna get errors anytime there's\n\n537\n00:28:35,550 --> 00:28:36,280\nduplicates.\n\n538\n00:28:36,280 --> 00:28:38,690\nRight?\nHere I've got some unsafe command names.\n\n539\n00:28:38,690 --> 00:28:41,580\nWhich is usually just telling me that\nthere's a duplicate that's in there.\n\n540\n00:28:41,580 --> 00:28:45,050\nAnd if I scroll back up,\nlooks like I didn't get all that many.\n\n541\n00:28:46,550 --> 00:28:47,930\nHere I'm seeing, let's see.\n\n542\n00:28:47,930 --> 00:28:50,380\nWhich one did it die out on?\n\n543\n00:28:50,380 --> 00:28:53,500\nHere it says, proxy creation has been\nskipped for the question mark command\n\n544\n00:28:53,500 --> 00:28:57,490\nbecause the Windows PowerShell cannot\nverify the safety of the command name.\n\n545\n00:28:57,490 --> 00:29:01,310\nSo it's got some kind of grievance\nthere with that particular command.\n\n546\n00:29:01,310 --> 00:29:02,800\nBut I'm not too worried about that.\n\n547\n00:29:02,800 --> 00:29:07,140\nBecause right after it, I see all the\nother commands that it tried to import.\n\n548\n00:29:07,140 --> 00:29:10,280\nAnd notice how all these are warnings,\nright.\n\n549\n00:29:10,280 --> 00:29:13,670\nIt says warning, and if I go all the way\nto the bottom, it'll tell me here.\n\n550\n00:29:15,720 --> 00:29:20,510\nIt's giving us a warning, because it\nwould shadow an existing local command.\n\n551\n00:29:20,510 --> 00:29:21,440\nSo in this case,\n\n552\n00:29:21,440 --> 00:29:25,220\nit's saying you've already got\nthe command locally, you don't need it.\n\n553\n00:29:25,220 --> 00:29:29,150\nBut anything that was different that\ndidn't throw an error, it would bring in,\n\n554\n00:29:29,150 --> 00:29:30,390\nand we now have.\n\n555\n00:29:30,390 --> 00:29:32,940\nAnd it's creating a temporary module.\n\n556\n00:29:32,940 --> 00:29:34,440\nSee this ModuleType script?\n\n557\n00:29:34,440 --> 00:29:39,160\nIt's creating a temporary module that\ngives me all the various commands\n\n558\n00:29:39,160 --> 00:29:41,020\nthat are present on that other server.\n\n559\n00:29:41,020 --> 00:29:45,000\nAnd now I can work as if those modules\nwere local, even though they're not.\n\n560\n00:29:45,000 --> 00:29:47,620\nAnd when I close this\nPowerShell window and\n\n561\n00:29:47,620 --> 00:29:50,780\nopen a new one, all those\ncommands are now gone, all right.\n\n562\n00:29:50,780 --> 00:29:54,305\nSo this is a good way to do\nthat temporarily, but for\n\n563\n00:29:54,305 --> 00:29:57,135\nme, from my own personal experience,\nyou get so\n\n564\n00:29:57,135 --> 00:30:00,455\nmany conflicts with it that you can\nget some really erratic behavior.\n\n565\n00:30:00,455 --> 00:30:02,685\nAnd so I recommend you don't use it.\n\n566\n00:30:02,685 --> 00:30:05,685\nWhile the functionality is there,\nI typically don't.\n\n567\n00:30:05,685 --> 00:30:10,345\nI use PSSession, but\nI use it to create a full connection,\n\n568\n00:30:10,345 --> 00:30:12,745\nwhere sure, I'm running\nPowerShell on my own machine, but\n\n569\n00:30:12,745 --> 00:30:15,920\nI'm actually seeing the PowerShell\non the remote machine.\n\n570\n00:30:15,920 --> 00:30:19,320\nThat means you're using all the commands\nfrom the remote machine and\n\n571\n00:30:19,320 --> 00:30:20,770\nthat eliminates the conflicts.\n\n572\n00:30:20,770 --> 00:30:23,270\nThat ensures that you're running\na consistent environment.\n\n573\n00:30:23,270 --> 00:30:25,460\nI prefer that much more than this method.\n\n574\n00:30:25,460 --> 00:30:26,010\nAll right?\n\n575\n00:30:26,010 --> 00:30:28,200\nBut, for completeness,\nI did want to show that just so\n\n576\n00:30:28,200 --> 00:30:29,520\nyou're aware that you can do it.\n\n577\n00:30:30,760 --> 00:30:31,670\nWhat is it that they say?\n\n578\n00:30:31,670 --> 00:30:33,940\nJust because you can do something\ndoesn't mean you should.\n\n579\n00:30:33,940 --> 00:30:35,120\nThis is one of those cases.\n\n580\n00:30:36,180 --> 00:30:38,530\nAll right.\nSo that's about it for\n\n581\n00:30:38,530 --> 00:30:40,500\nadding on functionality.\n\n582\n00:30:40,500 --> 00:30:44,490\nDo be careful if you're going out there\nand downloading third party modules.\n\n583\n00:30:44,490 --> 00:30:47,410\nYou need to download them from\npeople you trust because,\n\n584\n00:30:47,410 --> 00:30:50,540\nif you go to run a module and it says oh,\nyou need to be an administrator and\n\n585\n00:30:50,540 --> 00:30:53,440\nyou've run the modules in administrator,\ndo you know what it's doing?\n\n586\n00:30:53,440 --> 00:30:56,630\nThere could be all sorts of\ncraziness written in the code for\n\n587\n00:30:56,630 --> 00:30:59,510\nthat module that you don't know,\nso do a code review.\n\n588\n00:30:59,510 --> 00:31:00,280\nSkim over it.\n\n589\n00:31:00,280 --> 00:31:02,260\nLook at it.\nSee what it's doing.\n\n590\n00:31:02,260 --> 00:31:03,040\nIt might be phoning home.\n\n591\n00:31:03,040 --> 00:31:04,310\nIt might be sending emails or\n\n592\n00:31:04,310 --> 00:31:09,090\ndata back to an external server,\nyou won't know unless you look, all right?\n\n593\n00:31:09,090 --> 00:31:13,180\nOr just use modules that\ncome from trusted providers.\n\n594\n00:31:13,180 --> 00:31:15,120\nSo if you're getting\nsoftware from Microsoft and\n\n595\n00:31:15,120 --> 00:31:17,295\nit's got PowerShell modules,\nyou can trust that.\n\n596\n00:31:17,295 --> 00:31:19,470\nAll right,\nthen Microsoft made all this stuff.\n\n597\n00:31:19,470 --> 00:31:22,830\nOr if you go into Oracle or\nDell or somewhere like that and\n\n598\n00:31:22,830 --> 00:31:25,310\nthey have PowerShell modules for\nyou, that's great.\n\n599\n00:31:25,310 --> 00:31:27,260\nAll right,\nthose are companies that you can trust.\n\n600\n00:31:27,260 --> 00:31:29,020\nWell, I shouldn't have said Oracle.\n\n601\n00:31:29,020 --> 00:31:31,120\nBut companies that you\nshould be able to trust.\n\n602\n00:31:31,120 --> 00:31:35,950\nBut if you're downloading a module\nthat was written by John Doe and\n\n603\n00:31:35,950 --> 00:31:39,310\nwas posted to GitHub and\nyou're pulling it from there.\n\n604\n00:31:39,310 --> 00:31:40,300\nYou just don't know.\n\n605\n00:31:40,300 --> 00:31:45,170\nSo, you've got to skim over that and\nmake sure it's something you can trust.\n\n606\n00:31:45,170 --> 00:31:49,790\nIn this segment we got a chance to see how\nto bring in modules into PowerShell to\n\n607\n00:31:49,790 --> 00:31:52,860\nadd additional commands and\nfunctionality, and it's the sky's limit.\n\n608\n00:31:52,860 --> 00:31:55,250\nThere's a lot of stuff\nyou can do there and\n\n609\n00:31:55,250 --> 00:31:59,120\nwe wrapped up the segment taking a look\nat importing a PowerShell session.\n\n610\n00:31:59,120 --> 00:32:02,350\nAll the commands from another\nsession on a remote system.\n\n611\n00:32:02,350 --> 00:32:03,570\nAnd while it's not a great idea,\n\n612\n00:32:03,570 --> 00:32:07,120\nit certainly is possible so\nwe got a chance to see that.\n\n613\n00:32:07,120 --> 00:32:11,060\nAll right, well if you're interesting\nin seeing how to do it the right way\n\n614\n00:32:11,060 --> 00:32:14,750\nbe sure to check out our remote\nmanagement section, or that segment.\n\n615\n00:32:14,750 --> 00:32:17,350\nWe've got a section on there where we\nshow the other method that I mention.\n\n616\n00:32:17,350 --> 00:32:19,290\nYou'll definitely wanna check that out.\n\n617\n00:32:19,290 --> 00:32:21,380\nOtherwise, that's about it for\nthis segment.\n\n618\n00:32:21,380 --> 00:32:27,452\nSo stay tuned,\nwe've got more PowerShell coming up.\n\n619\n00:32:27,452 --> 00:32:30,812\n[MUSIC]\n\n",
          "vimeoId": "113926277"
        },
        {
          "description": "",
          "length": "1164",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-13-local-vs-remote-management-120314.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-13-local-vs-remote-management-120314-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-13-local-vs-remote-management-120314-sm.jpg",
          "title": "Local vs Remote Management",
          "transcript": "1\n00:00:00,000 --> 00:00:07,865\n[MUSIC]\n\n2\n00:00:07,865 --> 00:00:11,755\n>> In this segment we're going to take\na look at local management versus remote\n\n3\n00:00:11,755 --> 00:00:14,270\nmanagement inside a PowerShell.\n\n4\n00:00:14,270 --> 00:00:16,990\nThe majority of the time we're working\nin PowerShell we're doing what's called\n\n5\n00:00:16,990 --> 00:00:18,200\nlocal management.\n\n6\n00:00:18,200 --> 00:00:21,140\nIn other words, all the commandlets\nthat we run they're running against\n\n7\n00:00:21,140 --> 00:00:24,760\nthe server that we're sitting on or\nthe workstation or whatever.\n\n8\n00:00:24,760 --> 00:00:28,060\nSo I'm on a Windows 7 machine and\nI fire up the PowerShell,\n\n9\n00:00:28,060 --> 00:00:32,310\nany commands I type, are running\nagainst my Windows 7 machine, and\n\n10\n00:00:32,310 --> 00:00:36,685\nif I wanna run against some other machine,\nwell that's just not the default.\n\n11\n00:00:36,685 --> 00:00:39,905\nSo, there's not really all that\nmuch to say about local management.\n\n12\n00:00:39,905 --> 00:00:42,235\nYou launch the PowerShell and\nyou type stuff.\n\n13\n00:00:42,235 --> 00:00:43,705\nRight?\nIt's what we've done in all of\n\n14\n00:00:43,705 --> 00:00:47,695\nthe various segments for this series so\nfar is just straight up local management.\n\n15\n00:00:47,695 --> 00:00:49,305\nNothing special there.\n\n16\n00:00:49,305 --> 00:00:51,675\nBut remote management,\nthere's something special.\n\n17\n00:00:51,675 --> 00:00:52,345\nRight?\n\n18\n00:00:52,345 --> 00:00:56,260\nRemote management is where I want to\nrun a PowerShell on my own machine but\n\n19\n00:00:56,260 --> 00:01:00,100\nI wanted to actually perform\nactions on other machines.\n\n20\n00:01:01,360 --> 00:01:05,410\nSometimes that can be easy,\nsometimes it's not, all right?\n\n21\n00:01:05,410 --> 00:01:09,330\nThe best case scenario is that\nthe command you're running\n\n22\n00:01:09,330 --> 00:01:11,630\nsupports providing a target.\n\n23\n00:01:11,630 --> 00:01:15,000\nSome of the command links you run\nwill actually have a target value.\n\n24\n00:01:15,000 --> 00:01:18,140\nAnd if you leave the target off it just\ndefaults to your local machine, so\n\n25\n00:01:18,140 --> 00:01:20,395\nit's defaulting to local management.\n\n26\n00:01:20,395 --> 00:01:22,600\nBut you might to run it\nagainst a different machine,\n\n27\n00:01:22,600 --> 00:01:24,020\nyou'll be able to do that.\n\n28\n00:01:24,020 --> 00:01:26,214\nLet me show you an example,\nI'm gonna fire up my PowerShell.\n\n29\n00:01:27,770 --> 00:01:31,970\nAnd let's take a look at get-aduser.\n\n30\n00:01:31,970 --> 00:01:36,620\nGet-aduser is a command that will\nquery the active directory and\n\n31\n00:01:36,620 --> 00:01:39,910\nreturn back information about\na user account, all right?\n\n32\n00:01:39,910 --> 00:01:44,470\nThe default for it is to run against,\nwell, the machine you're on if you're\n\n33\n00:01:44,470 --> 00:01:47,840\na domain controller or whatever domain\ncontroller you've authenticated again.\n\n34\n00:01:47,840 --> 00:01:51,780\nBut if you want to run it against\na particular domain controller\n\n35\n00:01:51,780 --> 00:01:53,340\nit supports a target.\n\n36\n00:01:53,340 --> 00:01:55,140\nNow how,\nhow do we know if it's worked a target?\n\n37\n00:01:55,140 --> 00:01:59,310\nWell it was that shell and\nwe'll find out in the syntax.\n\n38\n00:01:59,310 --> 00:02:03,400\nSo in the syntax with a command\nwhat you're looking for\n\n39\n00:02:03,400 --> 00:02:08,700\nis somewhere where it asks for\na computer name or server name.\n\n40\n00:02:08,700 --> 00:02:10,650\nAnd here it will actually\nshow up as server.\n\n41\n00:02:10,650 --> 00:02:11,640\nLet's see if we can find that.\n\n42\n00:02:11,640 --> 00:02:12,670\nThere we go.\n\n43\n00:02:12,670 --> 00:02:15,150\nDash server and a stream.\n\n44\n00:02:15,150 --> 00:02:18,730\nAnd notice how they're surrounded by the\nsquare brackets which means it's optional.\n\n45\n00:02:18,730 --> 00:02:21,580\nIf I leave that off, it's gonna try and\nquery against myself.\n\n46\n00:02:21,580 --> 00:02:22,760\nIf I'm a domain controller, or\n\n47\n00:02:22,760 --> 00:02:25,030\nwhatever domain controller\nI authenticate it against.\n\n48\n00:02:25,030 --> 00:02:27,860\nBut if I specify this\ndash server in a string,\n\n49\n00:02:27,860 --> 00:02:30,640\nI'm telling it what remote\nserver I want it to connect to.\n\n50\n00:02:30,640 --> 00:02:33,780\nAnd instead of running\nthe command on my computer,\n\n51\n00:02:33,780 --> 00:02:35,790\nit's going to run the command\non that computer.\n\n52\n00:02:36,810 --> 00:02:38,280\nThat's remote management, and\n\n53\n00:02:38,280 --> 00:02:42,940\nit's as easy as that if\nthe command you have supports it.\n\n54\n00:02:42,940 --> 00:02:44,560\nNot every command does.\n\n55\n00:02:44,560 --> 00:02:46,460\nYes, all right this one does.\n\n56\n00:02:46,460 --> 00:02:47,720\nSo if I were to run that right?\n\n57\n00:02:47,720 --> 00:02:53,440\nIf I were to run get dash AD User,\nwhoops, that was not what I wanted.\n\n58\n00:02:53,440 --> 00:02:59,488\nGet dash AD User dash identity Don Pezet.\n\n59\n00:02:59,488 --> 00:03:02,615\nI am not giving it a server to connect to.\n\n60\n00:03:02,615 --> 00:03:04,305\nWell, I am a domain controller so\n\n61\n00:03:04,305 --> 00:03:07,385\nit's going to run against my machine and\nit's going to query it, and there we go.\n\n62\n00:03:07,385 --> 00:03:11,095\nI get the answer back,\nit ran right here on this machine.\n\n63\n00:03:11,095 --> 00:03:14,435\nBut if I add to the end\nof that dash server, and\n\n64\n00:03:14,435 --> 00:03:17,990\nI specify a server name,\nmine's called Server01,\n\n65\n00:03:17,990 --> 00:03:22,060\nIf I do that, now it's going to run it,\nsee how it's pausing?\n\n66\n00:03:22,060 --> 00:03:28,110\nThat pause is it establishing a WinRM\nconnection to the other server.\n\n67\n00:03:28,110 --> 00:03:30,880\nIn this case it's myself but\nit still does the same process.\n\n68\n00:03:30,880 --> 00:03:33,360\nIt uses Windows remote management, WinRM.\n\n69\n00:03:33,360 --> 00:03:37,350\nTo connect to the other server and execute\nthe power shell command on that other\n\n70\n00:03:37,350 --> 00:03:39,810\nserver to then return back and\ngive me the data.\n\n71\n00:03:39,810 --> 00:03:44,880\nNow I get the exact same data because\nit came from me in the first place.\n\n72\n00:03:44,880 --> 00:03:47,250\nBut it did execute it on the other server.\n\n73\n00:03:47,250 --> 00:03:52,520\nSo, super easy there assuming that\nwe've got WinRM enabled, right?\n\n74\n00:03:52,520 --> 00:03:56,220\nWinRM, Windows Remote Management, that's\na part of the Windows operating system,\n\n75\n00:03:56,220 --> 00:03:59,490\nin Windows 7, Windows 8,\nWindows Server 2008, Server 2012.\n\n76\n00:03:59,490 --> 00:04:05,980\nBut even though it's enabled by default,\nit's usually blocked on our firewalls.\n\n77\n00:04:05,980 --> 00:04:09,610\nSo a lot of times, if you're gonna be\nusing this, if you're gonna use WinRM\n\n78\n00:04:09,610 --> 00:04:13,150\nyou'll need to go and adjust\nthe firewall rules on your servers or\n\n79\n00:04:13,150 --> 00:04:16,180\non your workstations to\nallow WinRM connections.\n\n80\n00:04:16,180 --> 00:04:19,520\nNow you might ask yourself why wouldn't\nMicrosoft turn that on by default?\n\n81\n00:04:19,520 --> 00:04:23,200\nWell Microsoft doesn't want you\nto turn it on for everybody.\n\n82\n00:04:23,200 --> 00:04:25,680\nYou don't want everybody to be able to\nconnect to your system using WinRM.\n\n83\n00:04:27,030 --> 00:04:31,390\nSo the idea is you use something like an\nactive directory group policy object and\n\n84\n00:04:31,390 --> 00:04:36,800\nyou say create a firewall rule that\nallows winrm traffic from this IP and\n\n85\n00:04:36,800 --> 00:04:40,500\nyou specify the IP address of your\nwork station as an IT support person.\n\n86\n00:04:40,500 --> 00:04:41,810\nOr you say this server.\n\n87\n00:04:41,810 --> 00:04:45,960\nYou specify particular hosts that\nare allowed to connect using WinRL.\n\n88\n00:04:46,990 --> 00:04:51,430\nThat way it's not increasing you attack\nsurface any greater than it needs to be.\n\n89\n00:04:51,430 --> 00:04:54,720\nBut that's a really simple way\nto remotely manage the system,\n\n90\n00:04:54,720 --> 00:04:56,840\nif your command supports it.\n\n91\n00:04:56,840 --> 00:05:00,080\nWhat if your command doesn't support it?\n\n92\n00:05:00,080 --> 00:05:04,850\nIf I wanna execute a command on a remote\nsever and it doesn't have a dash server,\n\n93\n00:05:04,850 --> 00:05:10,150\nor dash computer name, or whatever flag or\nparameter that I can specify.\n\n94\n00:05:10,150 --> 00:05:14,420\nWell in that case,\nI need to do command proxying somehow.\n\n95\n00:05:15,560 --> 00:05:19,370\nAnd I've kind of already showed one\nway to do it in another episode.\n\n96\n00:05:19,370 --> 00:05:23,620\nIf you watched the episode where\nwe talked about importing modules\n\n97\n00:05:23,620 --> 00:05:28,217\nI talked about proxying through\na PS session or PowerShell session.\n\n98\n00:05:29,290 --> 00:05:30,880\nWhen you run aPowerShell,\n\n99\n00:05:30,880 --> 00:05:34,140\nwhat you're actually doing is\ncreating a PowerShell session.\n\n100\n00:05:34,140 --> 00:05:38,440\nPretty hard to say, I'm gonna sell\nPowerShell sessions by the sea shore.\n\n101\n00:05:38,440 --> 00:05:41,390\nBut if we create a PowerShell session,\n\n102\n00:05:41,390 --> 00:05:43,930\nwe're actually doing that\nagainst our own machine.\n\n103\n00:05:43,930 --> 00:05:47,590\nWe're connecting to our own machine and\nthat's fast enough and easy.\n\n104\n00:05:47,590 --> 00:05:52,050\nBut when we do a proxy,\nwhat we're doing is we're establishing\n\n105\n00:05:52,050 --> 00:05:56,690\na PowerShell session against\na remote host, somebody else.\n\n106\n00:05:56,690 --> 00:05:59,670\nAnd now the commands we type look\nlike we're running them here locally,\n\n107\n00:05:59,670 --> 00:06:02,690\nbut their actually being sent to\nthe other side and running from there.\n\n108\n00:06:02,690 --> 00:06:03,290\nAll right.\n\n109\n00:06:03,290 --> 00:06:06,240\nAnd in that modules episode,\nI showed how we could\n\n110\n00:06:06,240 --> 00:06:10,290\nimport modules that were installed on\na remote machine into our local machine so\n\n111\n00:06:10,290 --> 00:06:13,190\nwe could use them temporarily\nwithout having to install them.\n\n112\n00:06:13,190 --> 00:06:15,960\nAnd, I think I've said it\nprobably three or four times now,\n\n113\n00:06:15,960 --> 00:06:17,330\nI absolutely hate doing that.\n\n114\n00:06:17,330 --> 00:06:19,730\nIt's not the greatest solution.\n\n115\n00:06:19,730 --> 00:06:22,700\nAnd at the time I said if you wanna\nlearn the right way to do it,\n\n116\n00:06:22,700 --> 00:06:25,270\njump over to the remote management\nepisode and we'll show it there.\n\n117\n00:06:25,270 --> 00:06:27,360\nWell that's where we're at now.\n\n118\n00:06:27,360 --> 00:06:30,630\nSo when it comes to remotely\nexecuting these commands\n\n119\n00:06:30,630 --> 00:06:33,940\nthat option of proxying your\ncommands that's an option for us.\n\n120\n00:06:33,940 --> 00:06:36,310\nIt's not a very good one but\nit is an option.\n\n121\n00:06:36,310 --> 00:06:36,890\nSo it's out there.\n\n122\n00:06:38,120 --> 00:06:43,860\nOption number two is I could remote\ndesktop into that other server.\n\n123\n00:06:43,860 --> 00:06:45,830\nIf I wanna run that\ncommand from server 05,\n\n124\n00:06:45,830 --> 00:06:50,010\nI could remote desktop into server 05 and\nI could run it from there.\n\n125\n00:06:50,010 --> 00:06:51,710\nThat's another option.\n\n126\n00:06:51,710 --> 00:06:57,040\nBut if that server is in an area where\nI can't establish remote desktop to it,\n\n127\n00:06:57,040 --> 00:07:01,500\nmaybe it's in a DMZ or\nwe don't have an interactive shell to it.\n\n128\n00:07:01,500 --> 00:07:05,630\nMaybe it's a Windows server 2008 machine\nrunning Windows server core mode,\n\n129\n00:07:05,630 --> 00:07:07,210\nwhich doesn't give us PowerShell.\n\n130\n00:07:07,210 --> 00:07:08,460\nIf that's the case,\n\n131\n00:07:08,460 --> 00:07:12,420\nthen remote desktopping into it is\nnot really gonna help me much at all.\n\n132\n00:07:12,420 --> 00:07:15,850\nSituations like those\nmay prevent that option.\n\n133\n00:07:15,850 --> 00:07:19,250\nAnd so with that,\nwe're left with option number three.\n\n134\n00:07:19,250 --> 00:07:24,320\nAnd option number three is where,\nwe use Windows remote management\n\n135\n00:07:24,320 --> 00:07:30,270\nto establish a shell session that's\nactually executing on the remote server.\n\n136\n00:07:30,270 --> 00:07:33,110\nThink of it as like remote desktop for\nPowerShell.\n\n137\n00:07:33,110 --> 00:07:33,630\nRight?\nBut\n\n138\n00:07:33,630 --> 00:07:35,770\ninstead of seeing a graphical\nuser interface desktop,\n\n139\n00:07:35,770 --> 00:07:37,790\nwe're just seeing our\nPowerShell interface.\n\n140\n00:07:37,790 --> 00:07:40,690\nBut everything we run,\nis actually running on that other server.\n\n141\n00:07:41,860 --> 00:07:46,490\nAnd to do that we use\nthe Powershell session or\n\n142\n00:07:46,490 --> 00:07:49,990\nPS session command and\nthat will let us get that prompt so\n\n143\n00:07:49,990 --> 00:07:52,210\nthat we're able to start entering\ncommands into that remote system.\n\n144\n00:07:53,610 --> 00:07:59,590\nIf we want to see that in action,\nit's actually really easy.\n\n145\n00:07:59,590 --> 00:08:03,820\nAll we do is we use the enter\nPS session command.\n\n146\n00:08:03,820 --> 00:08:05,700\nSo I could come in here and\n\n147\n00:08:05,700 --> 00:08:11,450\nsay enter-PSsession followed by the name\nof the server that I want to connect to.\n\n148\n00:08:11,450 --> 00:08:13,750\nSo I want to connect to Server01.\n\n149\n00:08:13,750 --> 00:08:18,800\nWhen I run that oh, am I an administrator?\n\n150\n00:08:18,800 --> 00:08:20,140\nI am not an administrator.\n\n151\n00:08:20,140 --> 00:08:23,260\nYou do need to run your PowerShell\nas an administrator to do this.\n\n152\n00:08:23,260 --> 00:08:24,390\nSo let me just relaunch that.\n\n153\n00:08:25,400 --> 00:08:29,890\nThere we go.\nSo Enter PSsession Server01.\n\n154\n00:08:29,890 --> 00:08:32,007\nThere we go.\n\n155\n00:08:32,007 --> 00:08:37,240\nAll right, now I'm in a remove PowerShell.\n\n156\n00:08:37,240 --> 00:08:40,070\nAll right, and\nsee what happened to my prompt?\n\n157\n00:08:40,070 --> 00:08:43,840\nI still have my PS prompt but\non the left side I now see Server01.\n\n158\n00:08:43,840 --> 00:08:48,110\nAnd what that's letting me know\nis while I am in PowerShell and\n\n159\n00:08:48,110 --> 00:08:50,540\nwhile it does look like\nit's running right here,\n\n160\n00:08:50,540 --> 00:08:54,360\nin reality the shell I'm seeing\nis on that remote server.\n\n161\n00:08:54,360 --> 00:08:55,440\nOkay, now\n\n162\n00:08:55,440 --> 00:08:57,450\nI'm able to connect to that remote\nserver cuz it's not actually remote.\n\n163\n00:08:57,450 --> 00:08:58,110\nIt's just myself.\n\n164\n00:08:58,110 --> 00:08:59,880\nI'm just connecting right back to myself.\n\n165\n00:08:59,880 --> 00:09:04,740\nIf this were a remote server i would just\nneed to make sure that my user account\n\n166\n00:09:04,740 --> 00:09:06,670\nhad administrative access\nto the other system right?\n\n167\n00:09:06,670 --> 00:09:09,008\nI got to have permissions to access it.\n\n168\n00:09:09,008 --> 00:09:12,930\nAnd the WinRM settings have to be open\non the firewall to allow me to connect.\n\n169\n00:09:12,930 --> 00:09:15,080\nAll right?\nNow Microsoft's all ready made the WinRM\n\n170\n00:09:15,080 --> 00:09:18,470\nsettings inside of firewall, so\nit's not like we have to go and\n\n171\n00:09:18,470 --> 00:09:20,330\nlook up anything too crazy.\n\n172\n00:09:20,330 --> 00:09:25,730\nIf we go into the Windows firewall and\nadvanced security panel, we can go in\n\n173\n00:09:25,730 --> 00:09:30,920\nthere to the inbound rules and you'll see\njust a bunch of rules that are in there.\n\n174\n00:09:30,920 --> 00:09:35,760\nBut if you scroll through, eventually\nyou will find the Remote Management.\n\n175\n00:09:36,790 --> 00:09:38,520\nAnd it's buried down in here somewhere.\n\n176\n00:09:41,980 --> 00:09:43,020\nAnd let's see.\nHere we go.\n\n177\n00:09:43,020 --> 00:09:44,470\nWindows Remote Management.\n\n178\n00:09:44,470 --> 00:09:47,660\nAnd you can see I've turned it on on mine,\nso I've got my little green check mark.\n\n179\n00:09:47,660 --> 00:09:48,600\nIt's enabled.\n\n180\n00:09:48,600 --> 00:09:49,700\nSo it's right there.\n\n181\n00:09:49,700 --> 00:09:52,920\nAnd what you can do is\nyou can take these and\n\n182\n00:09:52,920 --> 00:09:54,410\nyou can run with them like they are,\nright?\n\n183\n00:09:54,410 --> 00:09:56,220\nYou just turn them on and there they go.\n\n184\n00:09:56,220 --> 00:09:59,680\nBut the problem is if you just turn\nthem on, it's really open for anybody.\n\n185\n00:09:59,680 --> 00:10:03,380\nSo now, anybody can try to connect, they\nstill have to provide credentials, right?\n\n186\n00:10:03,380 --> 00:10:04,990\nThey have to have a valid\nactive directory account.\n\n187\n00:10:04,990 --> 00:10:07,110\nThey've got to be\nan administrator to do it.\n\n188\n00:10:07,110 --> 00:10:10,460\nBut anybody could attempt it, so\nthey could attempt to brute force.\n\n189\n00:10:10,460 --> 00:10:14,540\nSo what I always recommend is take\nthe rule one step further, right?\n\n190\n00:10:14,540 --> 00:10:19,318\nIf we take one of these rules, notice the,\nlet me move my screen around a little bit\n\n191\n00:10:19,318 --> 00:10:24,565\nhere all right,\nnotice the profile for each of these.\n\n192\n00:10:24,565 --> 00:10:27,385\nThis one is for domain and\nprivate networks.\n\n193\n00:10:27,385 --> 00:10:29,315\nThis one is for public.\n\n194\n00:10:29,315 --> 00:10:31,525\nSee how I've got it turned on for public.\n\n195\n00:10:31,525 --> 00:10:33,730\nThat's not really the greatest idea is it?\n\n196\n00:10:33,730 --> 00:10:37,720\nSo we might choose to disable that if\nI'm on a public network I don't want it.\n\n197\n00:10:37,720 --> 00:10:42,150\nWell, if I'm on a server, it's not likely\nsomething I'm moving around very often.\n\n198\n00:10:42,150 --> 00:10:45,910\nSo it's usually going to be on that domain\nor private, so it probably doesn't matter.\n\n199\n00:10:45,910 --> 00:10:48,910\nBut I'm gonna turn it off anyway\njust to be on the safe side.\n\n200\n00:10:48,910 --> 00:10:52,010\nBut the other rule, this one that\nsays windows remote management and\n\n201\n00:10:52,010 --> 00:10:53,460\nit's domain and private.\n\n202\n00:10:53,460 --> 00:10:55,690\nI'm gonna modify that one too.\n\n203\n00:10:55,690 --> 00:10:58,230\nWhen you go into the settings for\nthat firewall rule.\n\n204\n00:10:58,230 --> 00:11:03,200\nYou'll have in here where you can\nspecify the remote computers.\n\n205\n00:11:03,200 --> 00:11:04,810\nWho's allowed to connect.\n\n206\n00:11:04,810 --> 00:11:08,800\nAnd what I can do is I can say\nonly allow authorized computers.\n\n207\n00:11:08,800 --> 00:11:11,590\nOnly allow connections\nfrom these computers.\n\n208\n00:11:11,590 --> 00:11:15,550\nAnd then I can start to specify\nwho is allowed to connect.\n\n209\n00:11:15,550 --> 00:11:19,880\nDetailing right in there particular IP's\nor ranges, I might have an old subnet and\n\n210\n00:11:19,880 --> 00:11:22,710\nI could approve those to limit it.\n\n211\n00:11:22,710 --> 00:11:24,450\nNow, for me giving it an error, let's see.\n\n212\n00:11:24,450 --> 00:11:28,090\nOnly when the action is set\nto allow only secure, oh,\n\n213\n00:11:28,090 --> 00:11:30,450\nI don't have my secure\nconnection turned on, but\n\n214\n00:11:30,450 --> 00:11:35,420\nbasically that is where I can just punch\nthat data in and set that restriction, and\n\n215\n00:11:35,420 --> 00:11:39,950\nin most IT environments you'll just have\na handful of people who are actually using\n\n216\n00:11:39,950 --> 00:11:43,420\nWindows Remote PowerShell so\nyou'll approve their workstations.\n\n217\n00:11:43,420 --> 00:11:46,010\nNow, if they're using DHCP,\nif their IP address has changed,\n\n218\n00:11:46,010 --> 00:11:47,530\nthat can be a bit problematic.\n\n219\n00:11:47,530 --> 00:11:50,350\nSo, you'll see there's other settings in\nhere that you kind of tweak to achieve\n\n220\n00:11:50,350 --> 00:11:55,520\nthat same goal but for the most part these\nare some of the ones that we can use.\n\n221\n00:11:55,520 --> 00:11:57,550\nActually, I was doing that\nin the wrong spot wasn't I?\n\n222\n00:11:57,550 --> 00:12:01,200\nI was under remote computers If I'd\ngone under scope, there we go.\n\n223\n00:12:01,200 --> 00:12:04,620\nThere's where I could have\nspecified the remote IP addresses.\n\n224\n00:12:04,620 --> 00:12:06,640\nThat's why it was giving me an error,\nI was in the wrong spot.\n\n225\n00:12:06,640 --> 00:12:09,020\nSo, we look here, I can specify it as IPs.\n\n226\n00:12:09,020 --> 00:12:12,560\nSo, I might specify it as the IP\naddress as my own workstation, which,\n\n227\n00:12:12,560 --> 00:12:14,520\nI don't know, so let's go find that out.\n\n228\n00:12:15,560 --> 00:12:16,220\nSo I am 192.168.29.3.\n\n229\n00:12:16,220 --> 00:12:18,062\nSo I'll go and punch that in.\n\n230\n00:12:18,062 --> 00:12:25,670\nAll right so now it's added and\nthen I could add in any other\n\n231\n00:12:25,670 --> 00:12:30,540\nIP addresses that I wanted to make sure\nthat they'd be able to connect, all right.\n\n232\n00:12:30,540 --> 00:12:34,250\nSo you punch them in, and now Windows\nremote management is a lot more secure.\n\n233\n00:12:34,250 --> 00:12:36,300\nSo that's why Microsoft has\nthis turned off by default.\n\n234\n00:12:36,300 --> 00:12:39,660\nThey want to give you the chance to go\nin and secure that a little bit more.\n\n235\n00:12:39,660 --> 00:12:41,500\nAll right.\n\n236\n00:12:41,500 --> 00:12:46,310\nSo, once that's done, you'll be able to\nfire up that Windows PowerShell, and it's\n\n237\n00:12:46,310 --> 00:12:49,640\ngonna run under your user credentials, so\nit's gonna reach out to that server and if\n\n238\n00:12:49,640 --> 00:12:54,020\nyou have administrative privileges on that\nserver, you'll get this shell right here.\n\n239\n00:12:54,020 --> 00:12:59,940\nNow, every command I run, even ones\nthat don't specify a server target,\n\n240\n00:12:59,940 --> 00:13:04,240\nwill be able to execute and execute as if\nthey were running on that other server,\n\n241\n00:13:04,240 --> 00:13:06,780\nbecause they actually are running\non that other server.\n\n242\n00:13:06,780 --> 00:13:08,720\nI'm not looking at my machine anymore.\n\n243\n00:13:08,720 --> 00:13:10,130\nI'm looking at the remote.\n\n244\n00:13:10,130 --> 00:13:14,840\nSo, when I want to use a module that I\ndon't have installed, this is what I use.\n\n245\n00:13:14,840 --> 00:13:16,620\nI just do a remote shell.\n\n246\n00:13:16,620 --> 00:13:20,850\nI do a PS session to that remote system\nand now I don't have to worry about\n\n247\n00:13:20,850 --> 00:13:24,690\nconflicting commands and duplicate\nentries and differing versions and\n\n248\n00:13:24,690 --> 00:13:28,670\nall the other problems we have\nwhen we do the command proxies.\n\n249\n00:13:28,670 --> 00:13:33,040\nHere, everything is running on the remote\nserver, so everything works out great, and\n\n250\n00:13:33,040 --> 00:13:35,680\nthat's really what we want to\nachieve when we use PowerShell.\n\n251\n00:13:37,042 --> 00:13:42,120\nAll right, so pretty easy to do,\nnothing too terribly spectacular there.\n\n252\n00:13:42,120 --> 00:13:50,020\nThere is another option that I want to\nmention, and that's invoke command option.\n\n253\n00:13:50,020 --> 00:13:54,290\nWhen I run a Shell like this with\nPSssesion, I'm now in a Shell.\n\n254\n00:13:54,290 --> 00:13:57,160\nI can run a whole series of commands and\nthey're all going to run to\n\n255\n00:13:57,160 --> 00:13:59,340\nthat remote system because\nthat's what I'm looking for.\n\n256\n00:14:00,520 --> 00:14:03,250\nBut if I just want to run one command,\n\n257\n00:14:03,250 --> 00:14:05,850\nI want to run one command\nto that remote system.\n\n258\n00:14:05,850 --> 00:14:10,150\nWell if I go into a shell I\nmight forget that I did that.\n\n259\n00:14:10,150 --> 00:14:11,810\nIt's right here in the prompt.\n\n260\n00:14:11,810 --> 00:14:13,600\nBut you know how we get\nwhen we're in a hurry.\n\n261\n00:14:13,600 --> 00:14:14,620\nSo I might forget, and\n\n262\n00:14:14,620 --> 00:14:16,600\nnow I'm running things on\na different system than I thought.\n\n263\n00:14:16,600 --> 00:14:18,180\nAnd I start to cause some problems.\n\n264\n00:14:18,180 --> 00:14:22,190\nSo if it's just gonna be one command\nthat I'm gonna run remotely.\n\n265\n00:14:22,190 --> 00:14:25,970\nInstead of doing a full shell like this\n\n266\n00:14:25,970 --> 00:14:29,340\nI can use a different commandlet to be\nable to push that along, all right?\n\n267\n00:14:29,340 --> 00:14:34,670\nI need to get out of this session so\nI'm going to type Exit PSsession and\n\n268\n00:14:34,670 --> 00:14:39,050\nthat'll put me back and now see how my\nprompt, it dropped that server one.\n\n269\n00:14:39,050 --> 00:14:41,290\nNow I'm right back to my own session.\n\n270\n00:14:41,290 --> 00:14:47,540\nAll right, now if I just wanted to\nrun one command on that remote side,\n\n271\n00:14:47,540 --> 00:14:52,150\nthe commandlet for\nthat is invoke dash command, right?\n\n272\n00:14:52,150 --> 00:14:54,270\nWe're gonna run a command but not on us,\n\n273\n00:14:54,270 --> 00:14:58,250\nwe're gonna invoke it\non some other system.\n\n274\n00:14:58,250 --> 00:15:02,070\nAnd what this does is it lets\nus take really any command, and\n\n275\n00:15:02,070 --> 00:15:06,860\nwe just copy the command, throw it to the\nother system, let the other system run it,\n\n276\n00:15:06,860 --> 00:15:11,080\nand then bring the output back and\nshow us the output, all right?\n\n277\n00:15:11,080 --> 00:15:13,010\nSo it's a temporary session.\n\n278\n00:15:13,010 --> 00:15:15,059\nJust a temporary one used\nto run this one command.\n\n279\n00:15:16,240 --> 00:15:20,210\nAnd with it you basically\nspecify a computer name.\n\n280\n00:15:20,210 --> 00:15:21,940\nAnd here's the really\ncool part about this one.\n\n281\n00:15:21,940 --> 00:15:25,420\nThis one is actually a little\nbit better than the shell.\n\n282\n00:15:25,420 --> 00:15:28,460\nBecause I can specify more\nthan one computer name.\n\n283\n00:15:28,460 --> 00:15:33,930\nI could say server01, server02, server03.\n\n284\n00:15:33,930 --> 00:15:36,910\nAnd i'm just separating them with commas.\n\n285\n00:15:36,910 --> 00:15:37,520\nRight?\n\n286\n00:15:37,520 --> 00:15:39,300\nSo by doing this it's gonna reach out and\n\n287\n00:15:39,300 --> 00:15:43,280\nrun whatever I'm about to type\non all three of those servers.\n\n288\n00:15:43,280 --> 00:15:47,460\nWhen I did the PS session, that shell,\nthat's just one server but\n\n289\n00:15:47,460 --> 00:15:48,130\nhere I can do multiple.\n\n290\n00:15:49,210 --> 00:15:52,130\nSo now I'm gonna invoke\na command on those servers.\n\n291\n00:15:52,130 --> 00:15:54,920\nI'm gonna reach out to them and\ntell them to do something and\n\n292\n00:15:54,920 --> 00:15:56,920\nnow I can tell them what I want.\n\n293\n00:15:56,920 --> 00:16:01,490\nOne of the problems I might bump into with\nthis, though, is the authentication piece.\n\n294\n00:16:01,490 --> 00:16:05,240\nWell, it's gonna run under my credentials,\nso I probably don't have to specify any.\n\n295\n00:16:05,240 --> 00:16:09,590\nBut I can specify the credentials here in\nline if I need to, just to let it know.\n\n296\n00:16:09,590 --> 00:16:14,670\nI could come in and say, -Credential, and\n\n297\n00:16:14,670 --> 00:16:20,040\nspecify my domain and whatever\n\n298\n00:16:20,040 --> 00:16:25,170\naccount it is that I'm using so that it\nknows what credential I want to run as.\n\n299\n00:16:25,170 --> 00:16:27,250\nIf I don't have that password\nit's going to prompt me for it so\n\n300\n00:16:27,250 --> 00:16:29,670\nI'll have to provide the password, but I\ndon't have to put it here in the command.\n\n301\n00:16:30,820 --> 00:16:35,300\nIn my case though, I just need to\nrun it as me and that will be fine.\n\n302\n00:16:35,300 --> 00:16:37,590\nAnd I'll go ahead and get rid of these\nother servers because they don't exist.\n\n303\n00:16:37,590 --> 00:16:39,560\nI'll just run this against server01.\n\n304\n00:16:39,560 --> 00:16:43,750\nNow, after that I can\nspecify what I want to run.\n\n305\n00:16:43,750 --> 00:16:45,900\nNow, if it's a single command I\ncan just throw it in here but\n\n306\n00:16:45,900 --> 00:16:49,500\nwhat we normally do is we\nthrow it into a script block.\n\n307\n00:16:49,500 --> 00:16:53,130\nA script block is like the curly\nbrackets I was talking about earlier.\n\n308\n00:16:53,130 --> 00:16:55,970\nThe curly brackets are nice cuz you can\nactually put more than one command in\n\n309\n00:16:55,970 --> 00:16:59,090\nthere and they'll all run as part\nof that instantaneous session.\n\n310\n00:16:59,090 --> 00:17:06,970\nSo, I could do something like {\nget-process } and close that out.\n\n311\n00:17:06,970 --> 00:17:08,810\nSo now, it's gonna.\n\n312\n00:17:08,810 --> 00:17:11,642\nCreate a temporary session to server01.\n\n313\n00:17:11,642 --> 00:17:14,790\nOn server01,\nit's going to run get-process and\n\n314\n00:17:14,790 --> 00:17:17,610\nthen the output will be displayed\nright here on my screen.\n\n315\n00:17:17,610 --> 00:17:20,540\nAnd if I was to do comma server two,\ncomma server three,\n\n316\n00:17:20,540 --> 00:17:23,040\nit would reach out to all three of them.\n\n317\n00:17:23,040 --> 00:17:25,930\nAnd then I would get the output for\neach one on my screen and\n\n318\n00:17:25,930 --> 00:17:27,710\nI could see those processes.\n\n319\n00:17:27,710 --> 00:17:30,550\nSo when I run that,\nit's reaching out to it, and\n\n320\n00:17:30,550 --> 00:17:33,880\nthere's the processes all\ncoming from that system.\n\n321\n00:17:33,880 --> 00:17:37,980\nAnd notice that it actually has\nthat extra column over here, it's\n\n322\n00:17:37,980 --> 00:17:42,320\nadding a column called PS computer name,\nso that I remember where that came from.\n\n323\n00:17:42,320 --> 00:17:45,360\nBecause if I'm running this\non more than one system\n\n324\n00:17:45,360 --> 00:17:46,820\nI need to be aware of that, right.\n\n325\n00:17:46,820 --> 00:17:52,220\nI need to know that it's from one host or\nanother.\n\n326\n00:17:54,050 --> 00:17:56,820\nSo, that's another cool little\nway to go out there and do that.\n\n327\n00:17:56,820 --> 00:18:01,652\nThese are temporary versus PSSession\nwhere once we go into a PSSession,\n\n328\n00:18:01,652 --> 00:18:05,210\nyou Enter -PSSession, you're now\nin that shell until you exit it.\n\n329\n00:18:05,210 --> 00:18:07,790\nAnd so you can stay in there for\nhours on end.\n\n330\n00:18:07,790 --> 00:18:10,910\nInvoke command, runs once, and it's done.\n\n331\n00:18:10,910 --> 00:18:15,040\nNow I'm out of that system, and\nI'm back to working on my regular machine.\n\n332\n00:18:15,040 --> 00:18:16,960\nSee my prompt never changed.\n\n333\n00:18:16,960 --> 00:18:18,270\nI'm still on my own machine.\n\n334\n00:18:19,920 --> 00:18:22,520\nAll right.\nSo, that's pretty much it for\n\n335\n00:18:22,520 --> 00:18:23,340\nremote managements.\n\n336\n00:18:23,340 --> 00:18:24,330\nIt's pretty straight forward.\n\n337\n00:18:24,330 --> 00:18:26,030\nMicrosoft made it easy.\n\n338\n00:18:26,030 --> 00:18:29,880\nJust remember that the three or\nfour real options we have.\n\n339\n00:18:29,880 --> 00:18:31,020\nCheck your command.\n\n340\n00:18:31,020 --> 00:18:34,350\nYour commandlet may already have\nan option for specifying remote servers,\n\n341\n00:18:34,350 --> 00:18:38,280\nin which case, that's the easiest,\nstick with that, all right?\n\n342\n00:18:38,280 --> 00:18:42,810\nOr you can try and proxy your commands\nby using the import session but\n\n343\n00:18:42,810 --> 00:18:45,810\nthat's my least favorite so that's where\nyou start to get command conflicts.\n\n344\n00:18:45,810 --> 00:18:47,280\nI don't like that one.\n\n345\n00:18:47,280 --> 00:18:51,800\nOur third option is to do a PSsession and\ncreate that shell to the other side.\n\n346\n00:18:51,800 --> 00:18:55,230\nWhen we do that now we're logged into\nthe other system and running our commands.\n\n347\n00:18:55,230 --> 00:18:56,610\nThat works great.\n\n348\n00:18:56,610 --> 00:19:00,540\nOur last option was, well,\nif we use invoke command and\n\n349\n00:19:00,540 --> 00:19:02,020\nwe can run our commands\non that remote system.\n\n350\n00:19:02,020 --> 00:19:03,630\nGet in and get out.\n\n351\n00:19:03,630 --> 00:19:04,420\nAnd move on.\n\n352\n00:19:04,420 --> 00:19:08,440\nSo, all different methods of\nremotely managing systems.\n\n353\n00:19:09,850 --> 00:19:12,070\nAll right, well,\nI hope you guys enjoyed that segment.\n\n354\n00:19:12,070 --> 00:19:15,846\nThat's about all I've got on that one,\nso we'll wrap it up here, but\n\n355\n00:19:15,846 --> 00:19:18,930\nstay tuned,\nwe've got more PowerShell coming up next.\n\n356\n00:19:18,930 --> 00:19:24,089\n[MUSIC]\n\n",
          "vimeoId": "113926276"
        },
        {
          "description": "",
          "length": "1422",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-14-powershell-ise-120314.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-14-powershell-ise-120314-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-14-powershell-ise-120314-sm.jpg",
          "title": "PowerShell ISE",
          "transcript": "1\n00:00:00,008 --> 00:00:09,197\n[SOUND]\nIn this segment,\n\n2\n00:00:09,197 --> 00:00:11,810\nwe're gonna take a look\nat the PowerShell ISE.\n\n3\n00:00:11,810 --> 00:00:16,510\nThe PowerShell ISE is a integrated\nscripting environment.\n\n4\n00:00:16,510 --> 00:00:17,960\nNow what the heck is that?\n\n5\n00:00:17,960 --> 00:00:22,190\nWell, if you've ever worked with a\ndeveloper or if you've done any developing\n\n6\n00:00:22,190 --> 00:00:25,890\nyourself you'll know that most\nprogrammers work in what's called an IDE,\n\n7\n00:00:25,890 --> 00:00:27,840\nan integrated development environment.\n\n8\n00:00:27,840 --> 00:00:31,170\nAnd what an IDE allows them\nto do is to write their code.\n\n9\n00:00:31,170 --> 00:00:35,780\nThey can write all their source code and\nimmediately compile and\n\n10\n00:00:35,780 --> 00:00:38,850\nexecute it right there from\ninside of their development file.\n\n11\n00:00:38,850 --> 00:00:41,740\nSo they can make a change launch\ntheir program and test it.\n\n12\n00:00:41,740 --> 00:00:43,620\nMake another change launch\ntheir program and test it.\n\n13\n00:00:43,620 --> 00:00:46,000\nDoing it all right from one location.\n\n14\n00:00:46,000 --> 00:00:51,090\nNow IDEs used to be really basic like\nthat back in well, in the 1980s.\n\n15\n00:00:51,090 --> 00:00:56,180\nBut in today's world, IDEs normally have\na lot of additional functionality, too.\n\n16\n00:00:56,180 --> 00:00:59,280\nLike helping us check for\nerrors in our source code.\n\n17\n00:00:59,280 --> 00:01:02,430\nSo as we start to write our programming\nlanguage, if there's any mistakes in\n\n18\n00:01:02,430 --> 00:01:05,840\nthere, it'll help you spot them even\nbefore you compile and run them.\n\n19\n00:01:05,840 --> 00:01:09,320\nWell, power shell is not\na programming language.\n\n20\n00:01:09,320 --> 00:01:11,420\nIt's really a scripting language.\n\n21\n00:01:11,420 --> 00:01:15,980\nAnd so, Microsoft wanted to create an IDE,\nbut for a scripting language.\n\n22\n00:01:15,980 --> 00:01:18,430\nThat's why they call it power shell ISE.\n\n23\n00:01:18,430 --> 00:01:20,470\nAnd it works just like those IDE's do.\n\n24\n00:01:20,470 --> 00:01:25,330\nWe can write our PowerShell scripts and\nit will check them If there's a mistake or\n\n25\n00:01:25,330 --> 00:01:27,330\nerror it will try and\nhighlight that for us.\n\n26\n00:01:27,330 --> 00:01:31,390\nAnd it gives us the ability to run\nthem right from a single environment.\n\n27\n00:01:31,390 --> 00:01:34,230\nNow the PowerShell ISC was\nintroduced in PowerShell 2.0.\n\n28\n00:01:34,230 --> 00:01:37,530\nIt wasn't in the original one,\nthey added it after the fact.\n\n29\n00:01:37,530 --> 00:01:40,680\nAnd it's gotten more\nadvanced over the years.\n\n30\n00:01:40,680 --> 00:01:44,760\nSo in the newer versions we actually\nhave what's called IntelliSense, and\n\n31\n00:01:44,760 --> 00:01:47,800\nthat's where you start\nto type a command and\n\n32\n00:01:47,800 --> 00:01:50,920\nit'll actually give you suggestions\nas to what should go after it.\n\n33\n00:01:50,920 --> 00:01:53,920\nNow we have tab auto complete\nthat kind of does that, but\n\n34\n00:01:53,920 --> 00:01:57,810\nwhat I'm talking about are when\nwe specify those property values.\n\n35\n00:01:57,810 --> 00:02:00,970\nSo, you might have seen in some of the\nepisodes where I'll do something like when\n\n36\n00:02:00,970 --> 00:02:05,710\nI'm pipelining some of the commands, I'll\nsay dollar sign underscore dot name and\n\n37\n00:02:05,710 --> 00:02:09,470\nthat's saying dot name,\nthat's the property I want.\n\n38\n00:02:09,470 --> 00:02:13,300\nFrom dollar sign underscore, that's\nthe result of a previous command, right?\n\n39\n00:02:13,300 --> 00:02:17,290\nWell, with IntelliSense on, you can\ntype dollar sign underscore dot and\n\n40\n00:02:17,290 --> 00:02:20,570\nall of a sudden it'll give you a list\nof the properties to pick from.\n\n41\n00:02:20,570 --> 00:02:22,770\nAnd so instead of having to\nremember the property name myself,\n\n42\n00:02:22,770 --> 00:02:25,180\nI can just pick it right there\nfrom that list and off you go.\n\n43\n00:02:25,180 --> 00:02:27,000\nThat makes writing scripts a lot easier.\n\n44\n00:02:27,000 --> 00:02:29,980\nIt's definitely something that\nmakes things more convenient.\n\n45\n00:02:29,980 --> 00:02:33,190\nAnd you can have one central place\nto edit and work with your scripts.\n\n46\n00:02:33,190 --> 00:02:34,930\nLoad them, run them, and work with them.\n\n47\n00:02:35,930 --> 00:02:39,510\nAlright, now PowerShell ISE is installed\nautomatically as a part of the PowerShell.\n\n48\n00:02:39,510 --> 00:02:43,710\nSo, if you've got PowerShell,\nyou've got PowerShell ISE.\n\n49\n00:02:43,710 --> 00:02:46,970\nTo launch it, Well,\nyou just run it, right?\n\n50\n00:02:46,970 --> 00:02:47,760\nLet me show you what I mean.\n\n51\n00:02:48,910 --> 00:02:53,240\nIn Windows Server 2012, which is what I'm\nrunning, the power shell icon is added to\n\n52\n00:02:53,240 --> 00:02:56,970\nthe task bar automatically and\nif you right click on it,\n\n53\n00:02:56,970 --> 00:03:00,530\nyou'll see one of the options right\nhere is the Windows Powershell ISE.\n\n54\n00:03:00,530 --> 00:03:02,488\nYou can even run it as\nan administrator if you want.\n\n55\n00:03:02,488 --> 00:03:06,070\nOn Windows seven, and Windows Server 2008,\nit's under your start menu,\n\n56\n00:03:06,070 --> 00:03:10,250\nyou can go under there and\nyou'll find Windows PowerShell ISE.\n\n57\n00:03:10,250 --> 00:03:14,490\nWhen you launch the ISE,\nit's gonna look something like this.\n\n58\n00:03:14,490 --> 00:03:17,100\nThe window is made up of three panes.\n\n59\n00:03:17,100 --> 00:03:19,820\nIn the first pane, this is your code.\n\n60\n00:03:19,820 --> 00:03:21,220\nThis is what you're writing.\n\n61\n00:03:21,220 --> 00:03:24,229\nThe script or\ncommands that you're gonna be executing.\n\n62\n00:03:25,360 --> 00:03:27,970\nAt the bottom you have\na power shell window.\n\n63\n00:03:27,970 --> 00:03:29,760\nThis is an active power shell window.\n\n64\n00:03:29,760 --> 00:03:32,770\nI can get in here,\nrun get-help or whatever and\n\n65\n00:03:32,770 --> 00:03:35,038\nactually, did you guys see\nIntelliSense kick in there?\n\n66\n00:03:35,038 --> 00:03:36,060\nI type get-h.\n\n67\n00:03:36,060 --> 00:03:41,340\nOh now It's not gonna do it cuz I there,\nlet's try that again, there.\n\n68\n00:03:41,340 --> 00:03:45,920\nI typed get-h and it's already showing me\nall the commands that start with get-h.\n\n69\n00:03:45,920 --> 00:03:48,240\nHelp, history, host, hotfix, and\n\n70\n00:03:48,240 --> 00:03:51,740\nit's even showing me their\nsyntax all right here in line.\n\n71\n00:03:51,740 --> 00:03:54,110\nAnd I can just ignore that and\nkeep typing, and\n\n72\n00:03:54,110 --> 00:03:57,860\nit's gonna keep updating\nto show what I'm typing.\n\n73\n00:03:57,860 --> 00:03:59,240\nRight?\nSo, really kind of\n\n74\n00:03:59,240 --> 00:04:00,390\na neat thing there that it does that.\n\n75\n00:04:00,390 --> 00:04:02,070\nThat's what intellisense adds.\n\n76\n00:04:02,070 --> 00:04:05,120\nSo even if I'm not worried\nabout writing scripts.\n\n77\n00:04:05,120 --> 00:04:08,710\nI might still use this just to make it\neasier to get the commands that I want.\n\n78\n00:04:08,710 --> 00:04:12,270\nSo I can type get-help and\nrun it and there went my help file.\n\n79\n00:04:12,270 --> 00:04:14,930\nAnd I can scroll back up and\nread that, there it is.\n\n80\n00:04:14,930 --> 00:04:16,620\nThe same as a regular PowerShell session.\n\n81\n00:04:16,620 --> 00:04:20,770\nThis is just a PowerShell window down\nhere with Intelliscents added on top.\n\n82\n00:04:21,920 --> 00:04:22,690\nAll right.\n\n83\n00:04:22,690 --> 00:04:26,850\nOn the right side of the screen,\nI can see all of my commands.\n\n84\n00:04:26,850 --> 00:04:29,170\nThere's a giant list of all\nthe commands right here.\n\n85\n00:04:29,170 --> 00:04:33,160\nThat's rapidly searchable, and\nI can filter it by module.\n\n86\n00:04:33,160 --> 00:04:35,970\nSo I can say, you know what,\nI just wanna see the DNS commands.\n\n87\n00:04:35,970 --> 00:04:37,960\nSo let me get down here to DNS server.\n\n88\n00:04:37,960 --> 00:04:41,160\nAnd now I'm just seeing\nthe DNS server commands.\n\n89\n00:04:41,160 --> 00:04:43,570\nSo cool part about that\nis if I'm down here and\n\n90\n00:04:43,570 --> 00:04:46,790\nI'm running commands,\nup here I can choose a command and\n\n91\n00:04:46,790 --> 00:04:50,960\nit's gonna give me information on it and\nyou know my head's sitting on top of it.\n\n92\n00:04:50,960 --> 00:04:52,470\nLet me change my window size.\n\n93\n00:04:52,470 --> 00:04:53,610\nThere you go.\n\n94\n00:04:53,610 --> 00:04:56,870\nSo it's showing me the command right\nthere, giving me a basic description.\n\n95\n00:04:56,870 --> 00:04:59,670\nAnd then I've got the insert and\ncopy options.\n\n96\n00:04:59,670 --> 00:05:03,110\nIf I hit insert, it's going to\ninsert it wherever my cursor was.\n\n97\n00:05:03,110 --> 00:05:07,650\nSo my cursor was down here, apparently\nI hit some extra letter as there.\n\n98\n00:05:07,650 --> 00:05:11,750\nMy cursor was down here, and when I hit\ninsert, it added it in there for me.\n\n99\n00:05:11,750 --> 00:05:16,570\nOr up here, if I come down and\nedit this little script file.\n\n100\n00:05:16,570 --> 00:05:20,360\nAnd I hit insert, it's gonna throw it in,\noh actually it threw it in down there but\n\n101\n00:05:20,360 --> 00:05:21,870\nit should have thrown it in up here.\n\n102\n00:05:21,870 --> 00:05:23,400\nBut quick, easy way to do that,\n\n103\n00:05:23,400 --> 00:05:28,100\nwe can also do copy and\nthen just come in and paste it.\n\n104\n00:05:28,100 --> 00:05:29,120\nAnd there it is too.\n\n105\n00:05:29,120 --> 00:05:30,150\nSo, oh!\n\n106\n00:05:30,150 --> 00:05:32,540\nI know what to do with the a's,\nit's an IPV6 record right?\n\n107\n00:05:32,540 --> 00:05:36,850\nSo we're adding a resource record or\nAAAA, that would be an IPV6 record.\n\n108\n00:05:38,180 --> 00:05:40,510\nAll right, so kind of neat, right,\n\n109\n00:05:40,510 --> 00:05:43,820\nit's all designed to make your\nlife a little bit easier.\n\n110\n00:05:43,820 --> 00:05:48,060\nThe other nice thing about it is you can\nhave more than one script open at a time\n\n111\n00:05:48,060 --> 00:05:51,460\nso the one I'm looking at it\nright now is profile dot .ps1.\n\n112\n00:05:51,460 --> 00:05:55,720\nIf you watch the segment on customizing\nthe user interface for PowerShell.\n\n113\n00:05:55,720 --> 00:05:58,790\nThis is the script that I wrote in\nthat episode that had all the various\n\n114\n00:05:58,790 --> 00:06:00,620\nsettings to configure my system.\n\n115\n00:06:00,620 --> 00:06:03,340\nAnd it's laid that out.\n\n116\n00:06:03,340 --> 00:06:05,110\nAnd it's colorized it.\n\n117\n00:06:05,110 --> 00:06:09,510\nThe coloring is designed to help me\nrecognize when i've made mistakes and\n\n118\n00:06:09,510 --> 00:06:10,400\nother things.\n\n119\n00:06:10,400 --> 00:06:13,850\nSo notice like dollar sign console here,\nthat's a variable.\n\n120\n00:06:13,850 --> 00:06:17,990\nAnd then the property after it foreground\ncolor is listed and it's in black.\n\n121\n00:06:17,990 --> 00:06:21,920\nIt's letting me know that there\nis a difference between those two\n\n122\n00:06:21,920 --> 00:06:24,230\nas far as what their purpose is.\n\n123\n00:06:24,230 --> 00:06:27,190\nAnd let me just kind of zoom in on this\na little bit so you can see it better.\n\n124\n00:06:27,190 --> 00:06:28,630\nBut you can see that coloring.\n\n125\n00:06:28,630 --> 00:06:32,900\nSo all my variable names are nice and\nbright red so I can spot where I'm using\n\n126\n00:06:32,900 --> 00:06:35,950\nthose variables and\nthen I can see the various modifications.\n\n127\n00:06:35,950 --> 00:06:42,090\nNow when I defined this dollar sign\nconsole I pointed at it, host.UI.rawUI and\n\n128\n00:06:42,090 --> 00:06:45,470\nI started pulling up things like\nforeground color and background color.\n\n129\n00:06:45,470 --> 00:06:49,250\nHere's another area where IntelliSense\ncan come in really handy.\n\n130\n00:06:49,250 --> 00:06:50,660\nSee how I'm starting according to type and\n\n131\n00:06:50,660 --> 00:06:53,260\nit recognizes that variable\nthat I've created.\n\n132\n00:06:53,260 --> 00:06:54,960\nAnd I just hit tab to select it.\n\n133\n00:06:54,960 --> 00:06:57,130\nWhatever's highlighted it'll hit tab and\nit'll punch it in.\n\n134\n00:06:57,130 --> 00:06:59,040\nYou can hit enter it does the same thing.\n\n135\n00:06:59,040 --> 00:07:03,830\nAnd then when I do a period if I'm\nactually referencing the real item\n\n136\n00:07:03,830 --> 00:07:06,180\nthen it'll start to give me\nthe suggestions to be on that.\n\n137\n00:07:06,180 --> 00:07:08,816\nAnd apparently it's not\ngoing to pull that one.\n\n138\n00:07:08,816 --> 00:07:14,480\nSo let's do post.ui.rawui.\n\n139\n00:07:14,480 --> 00:07:15,660\nThere we go.\n\n140\n00:07:15,660 --> 00:07:20,140\nAnd as I start to go under raw ui\nnow I can see background color,\n\n141\n00:07:20,140 --> 00:07:23,810\nbuffer size, cursor position,\nkey available, foreground color.\n\n142\n00:07:23,810 --> 00:07:29,010\nAll the various other entries that I\nmight use as a part of that, right?\n\n143\n00:07:29,010 --> 00:07:33,970\nSo, now if I'm somebody who has bad\nmemory, which is exactly how I am, and\n\n144\n00:07:33,970 --> 00:07:37,710\nI can't quite remember the exact syntax,\nI just have to type a little bit and\n\n145\n00:07:37,710 --> 00:07:40,950\nit will give me all the suggestions and\nthen I can just pick from the list, right.\n\n146\n00:07:40,950 --> 00:07:42,780\nThat makes it a lot easier.\n\n147\n00:07:42,780 --> 00:07:47,250\nSo when you're writing a script,\nPowerShell ISE is really handy.\n\n148\n00:07:47,250 --> 00:07:50,634\nNow when it's just a series of commands\nlike this is not too terribly spectacular.\n\n149\n00:07:50,634 --> 00:07:53,893\nWhere it gets really handy is when\nyou're doing things like functions.\n\n150\n00:07:53,893 --> 00:07:55,994\nAnd here's that function\nwhere I customize the prompt.\n\n151\n00:07:55,994 --> 00:07:57,477\nAnd see what its done?\n\n152\n00:07:57,477 --> 00:08:01,281\nIt's colorized it so that I know\nthat prompt is the function, and\n\n153\n00:08:01,281 --> 00:08:04,601\nthen I opened those curly brackets,\nand it went ahead and\n\n154\n00:08:04,601 --> 00:08:09,870\ncreated where I can compact that, because\nit knows it's all part of the function.\n\n155\n00:08:09,870 --> 00:08:13,480\nAnd the reason it's doing that is a lot\nof people prefer to lay things out\n\n156\n00:08:13,480 --> 00:08:15,040\na little bit more cleanly.\n\n157\n00:08:15,040 --> 00:08:18,560\nWhere you indent lines, this is\ncalled good coding etiquette, right,\n\n158\n00:08:18,560 --> 00:08:21,770\nmaking it nice, neat, and\neasy to read and recognize.\n\n159\n00:08:21,770 --> 00:08:25,020\nSo we might have it laid out a little bit\ndifferently, and they just wanna make\n\n160\n00:08:25,020 --> 00:08:29,300\nit easy for us to collapse and\nbe able to occupy a little less space.\n\n161\n00:08:30,390 --> 00:08:33,730\nNow if I make a mistake,\nsee that little red,\n\n162\n00:08:33,730 --> 00:08:37,010\ncurly underline there letting me know\nthat there's some kind of a mistake here?\n\n163\n00:08:37,010 --> 00:08:40,950\nSo it's warning me about that, and\nI can look for those little underlines and\n\n164\n00:08:40,950 --> 00:08:43,170\nthat'll help me to isolate\nwhere there's a problem.\n\n165\n00:08:43,170 --> 00:08:48,010\nOr if I forget to close my curly bracket\nlike that, it's kind of hard to see, but\n\n166\n00:08:48,010 --> 00:08:51,720\nthere's a red curly underline\nunder that bracket now,\n\n167\n00:08:51,720 --> 00:08:54,560\nletting me know there's something\nwrong with that bracket.\n\n168\n00:08:54,560 --> 00:08:55,490\nNow I've got an idea.\n\n169\n00:08:55,490 --> 00:08:56,820\nI can say well,\nalright there's something wrong with that,\n\n170\n00:08:56,820 --> 00:09:00,250\nlet me look and\ncan see if I've got a close, and I don't.\n\n171\n00:09:00,250 --> 00:09:01,580\nAnd I can put it back in.\n\n172\n00:09:01,580 --> 00:09:04,110\nNow it closes and it's healthy.\n\n173\n00:09:04,110 --> 00:09:06,460\nAlright that's called syntax validation.\n\n174\n00:09:06,460 --> 00:09:09,770\nIt's just checking to make sure that my\nsyntax is correct before letting it run.\n\n175\n00:09:11,230 --> 00:09:13,230\nWhen I write a script like this,\n\n176\n00:09:13,230 --> 00:09:16,490\nyou can actually hit this little play\nbutton right here and it'll run it.\n\n177\n00:09:16,490 --> 00:09:18,200\nSo I can run this script from here.\n\n178\n00:09:19,340 --> 00:09:20,370\nAnd it's gonna run it.\n\n179\n00:09:20,370 --> 00:09:21,820\nIt's telling me it's about to save it.\n\n180\n00:09:21,820 --> 00:09:23,200\nI haven't saved it so.\n\n181\n00:09:23,200 --> 00:09:25,890\nI'll say okay and\nit just ran it down here.\n\n182\n00:09:25,890 --> 00:09:28,980\nAnd I can see that my\nprompt has changed and\n\n183\n00:09:28,980 --> 00:09:32,540\napparently I've inserted\nsome more commands somehow.\n\n184\n00:09:32,540 --> 00:09:37,670\nBut it went ahead and ran that script and\nnow it's got that entered in here.\n\n185\n00:09:37,670 --> 00:09:40,380\nWith my new prompt colors,\nand all that stuff.\n\n186\n00:09:40,380 --> 00:09:42,240\nLooks like some of it didn't take effect.\n\n187\n00:09:42,240 --> 00:09:46,160\nI was changing that syntax and\nbecause it does colorizing,\n\n188\n00:09:46,160 --> 00:09:49,200\nthe color changes that I put in\naren't necessarily taking effect.\n\n189\n00:09:49,200 --> 00:09:52,590\nAnd apparently it wants to turn it purple.\n\n190\n00:09:52,590 --> 00:09:54,530\nBut, it did turn green there for a second.\n\n191\n00:09:54,530 --> 00:09:56,950\nSo you'll see where it is\nactually taking effect.\n\n192\n00:09:56,950 --> 00:09:59,350\nBut, it's kind of neat\nto be able to do that.\n\n193\n00:09:59,350 --> 00:10:01,850\nJust start to write your script and\ntest it out.\n\n194\n00:10:01,850 --> 00:10:04,090\nNow there's a few features\nin here that I really like.\n\n195\n00:10:04,090 --> 00:10:06,790\nI 've talked about\nIntelliSense it's pretty cool.\n\n196\n00:10:06,790 --> 00:10:09,360\nAnother one is selective execution.\n\n197\n00:10:10,610 --> 00:10:13,730\nMaybe I don't want to\ntest my whole script,\n\n198\n00:10:13,730 --> 00:10:16,070\nmaybe I just want to test part of it.\n\n199\n00:10:16,070 --> 00:10:19,350\nSo I had a problem with my prompt and\nI want to change that.\n\n200\n00:10:19,350 --> 00:10:22,030\nSo, right now,\nI'm displaying the current folder.\n\n201\n00:10:22,030 --> 00:10:22,900\nAnd I decide, you know what?\n\n202\n00:10:22,900 --> 00:10:24,120\nI'm gonna change that.\n\n203\n00:10:24,120 --> 00:10:27,550\nInstead of displaying the current folder,\nI wanna come in and\n\n204\n00:10:27,550 --> 00:10:31,270\ndisplay the current date, right?\n\n205\n00:10:31,270 --> 00:10:34,840\nSo I might choose to\ncomment out some code.\n\n206\n00:10:34,840 --> 00:10:36,390\nI'll just put a little hash mark there.\n\n207\n00:10:36,390 --> 00:10:38,210\nAnd see how that all just turned green?\n\n208\n00:10:38,210 --> 00:10:41,220\nThat's letting me know that that's not\ngonna run, that's gonna get ignored.\n\n209\n00:10:41,220 --> 00:10:44,728\nAnd on this next line,\nI'm gonna take $ current folder and\n\n210\n00:10:44,728 --> 00:10:50,100\nI'm just gonna replace that with let's\nsee, get dash date should do for me.\n\n211\n00:10:50,100 --> 00:10:51,040\nI'll be get dash date.\n\n212\n00:10:52,260 --> 00:10:55,580\nAlright, and I can't remember with get\ndate if I have to stick a dollar sign\n\n213\n00:10:55,580 --> 00:10:58,580\nbefore that or not, I don't think I do.\n\n214\n00:10:58,580 --> 00:10:59,280\nWell, I can test.\n\n215\n00:10:59,280 --> 00:11:03,840\nI don't necessarily want to test my\nwhole script, I can just highlight that\n\n216\n00:11:03,840 --> 00:11:08,900\nfunction, and now when I go up and\nhit Execute, it's only going to run\n\n217\n00:11:08,900 --> 00:11:11,690\nthat little piece, well, actually\nthis one will run the whole thing.\n\n218\n00:11:11,690 --> 00:11:14,630\nThe button right beside it,\nthat guy, runs selection.\n\n219\n00:11:14,630 --> 00:11:17,370\nThat's the one that's just gonna\nrun what I've got highlighted and\n\n220\n00:11:17,370 --> 00:11:21,140\nwhen I run that it's just gonna\nrun the line that I provided.\n\n221\n00:11:21,140 --> 00:11:24,620\nSo it runs that function and\nsure enough my prompt changes and\n\n222\n00:11:24,620 --> 00:11:26,340\nnow it's got that data in there.\n\n223\n00:11:26,340 --> 00:11:30,300\nBut I'm kind of having a hard time reading\nthat because the prompt is a dark blue so\n\n224\n00:11:30,300 --> 00:11:34,050\nI might want to go in here and\nchange that prompt color.\n\n225\n00:11:34,050 --> 00:11:34,870\nWhere did I set that?\n\n226\n00:11:36,340 --> 00:11:38,330\nSomewhere in here I set the prompt color.\n\n227\n00:11:38,330 --> 00:11:40,040\nOh actually it was in that function.\n\n228\n00:11:40,040 --> 00:11:43,630\nSo I might choose to change that to\nsomething a little bit brighter like white\n\n229\n00:11:45,890 --> 00:11:48,290\nand so now I can go in and take that.\n\n230\n00:11:48,290 --> 00:11:50,810\nAnd I will selectively\nrun just that piece.\n\n231\n00:11:50,810 --> 00:11:52,020\nNow the prompt is nice and white.\n\n232\n00:11:52,020 --> 00:11:53,900\nEasy for me to read and I can spot it.\n\n233\n00:11:53,900 --> 00:12:00,410\nSo quick and easy ways to modify your\nsyntax, test it, ensure that it's working.\n\n234\n00:12:00,410 --> 00:12:03,610\nWhen it's working we can\nthen save this script.\n\n235\n00:12:03,610 --> 00:12:05,960\nCopy it over to our server and\nrun it there.\n\n236\n00:12:05,960 --> 00:12:10,050\nAnd we know it's gonna run right the first\ntime because we've already tested it and\n\n237\n00:12:10,050 --> 00:12:14,420\ndebugged it, and worked with it\nright here inside of PowerShell ISE.\n\n238\n00:12:14,420 --> 00:12:15,700\nSo pretty neat.\n\n239\n00:12:15,700 --> 00:12:17,850\nYou'll see I've got\na second script open here.\n\n240\n00:12:17,850 --> 00:12:19,240\nThis one was pretty basic.\n\n241\n00:12:19,240 --> 00:12:20,950\nThis is just basic stuff.\n\n242\n00:12:20,950 --> 00:12:23,880\nBut here's a more complex one that\nwas written by the guys at Microsoft.\n\n243\n00:12:23,880 --> 00:12:27,290\nSo this one is a active\ndirectory user creation script.\n\n244\n00:12:27,290 --> 00:12:29,710\nSo it's designed to import a csv and\n\n245\n00:12:29,710 --> 00:12:33,570\ncreate active directory users for\nevery entry inside of the csv.\n\n246\n00:12:33,570 --> 00:12:38,580\nAnd so if I start to scroll down you'll\nsee where there's a lot of variables and\n\n247\n00:12:38,580 --> 00:12:40,520\nfunctions and syntax.\n\n248\n00:12:40,520 --> 00:12:44,700\nAnd when you're writing a complex\nfile like this, it can get really,\n\n249\n00:12:44,700 --> 00:12:47,640\nreally difficult to keep track\nof all the different settings.\n\n250\n00:12:47,640 --> 00:12:50,480\nSo as you go through here,\nit's helping you.\n\n251\n00:12:50,480 --> 00:12:52,200\nKinda helping you keep track of that.\n\n252\n00:12:52,200 --> 00:12:56,780\nAnd laying it out and spotting when\nyou're missing those brackets and so on.\n\n253\n00:12:56,780 --> 00:13:00,480\nDefinitely making life a lot easier for\nyou.\n\n254\n00:13:00,480 --> 00:13:03,310\nAlright, so that's the power shell ISE.\n\n255\n00:13:03,310 --> 00:13:06,940\nIt does have more features like\ndebugging for trying to find errors.\n\n256\n00:13:06,940 --> 00:13:09,260\nYou can actually do a stepped execution,\n\n257\n00:13:09,260 --> 00:13:12,680\nwhere when it runs it'll just go\nthrough and run to a certain point.\n\n258\n00:13:12,680 --> 00:13:14,850\nYou can do other things.\n\n259\n00:13:14,850 --> 00:13:18,600\nThere's add-ons that you can punch\ninto it that extend its functionality.\n\n260\n00:13:18,600 --> 00:13:20,325\nThere's a lot of neat\nstuff that's in there.\n\n261\n00:13:21,405 --> 00:13:24,095\nOne problem with the PowerShell ISE though\n\n262\n00:13:24,095 --> 00:13:27,105\nis that Microsoft's got a pretty\ntight stranglehold on it.\n\n263\n00:13:27,105 --> 00:13:32,100\nAnd they're not really allowing a lot of\nother people to do too much extra to it.\n\n264\n00:13:32,100 --> 00:13:34,150\nSo you can write some add ons to it.\n\n265\n00:13:34,150 --> 00:13:38,630\nBut the add ons don't really deviate too\nfar from what you can do in the PowerShell\n\n266\n00:13:38,630 --> 00:13:40,060\nalready, all right?\n\n267\n00:13:40,060 --> 00:13:44,720\nAnd that's led other companies to create\nsoftware that's very similar to this.\n\n268\n00:13:44,720 --> 00:13:47,740\nThere's a company out there, or there\nwas a company out there, called Quest.\n\n269\n00:13:47,740 --> 00:13:48,830\nAnd I liked Quest.\n\n270\n00:13:48,830 --> 00:13:50,530\nEvery product they made was great.\n\n271\n00:13:50,530 --> 00:13:54,300\nWell, Dell bought them a few years ago,\nso now it's from Dell.\n\n272\n00:13:54,300 --> 00:14:01,600\nBut Quest had created this, open,\nfreely available program called PowerGUI.\n\n273\n00:14:01,600 --> 00:14:05,730\nAnd it was designed to be an integrated\nscripting environment for PowerShell.\n\n274\n00:14:05,730 --> 00:14:08,680\nWell, you might ask yourself,\nwe've already got Powershell ISE,\n\n275\n00:14:08,680 --> 00:14:10,220\nwhy would we want this other one?\n\n276\n00:14:10,220 --> 00:14:12,560\nWell, the other one really does the same\nstuff, everything that we just saw,\n\n277\n00:14:12,560 --> 00:14:17,340\nall that PowerGUI does also, but it's a\nlittle more open, and they allow people to\n\n278\n00:14:17,340 --> 00:14:20,960\nwrite all sorts of additional tools for\nit to extend its functionality.\n\n279\n00:14:20,960 --> 00:14:26,450\nSo there's a lot of people out there that\nprefer the power GUI to the power ISC.\n\n280\n00:14:26,450 --> 00:14:30,164\nNow, Powershell ISC, it's included with\nPowershell so if I'm gonna use one,\n\n281\n00:14:30,164 --> 00:14:32,370\nthat's the one that I'm gonna use.\n\n282\n00:14:32,370 --> 00:14:35,160\nBut, I do wanna bring up the other one\nbecause you will see it mentioned on\n\n283\n00:14:35,160 --> 00:14:38,970\nwebpages and other places,\na lot of people do like it.\n\n284\n00:14:38,970 --> 00:14:41,970\nIt's got some neat stuff that\nyou don't necessarily get here.\n\n285\n00:14:41,970 --> 00:14:46,138\nOne of my favorite ones, let me\nswitch over to [COUGH] the power GUI.\n\n286\n00:14:46,138 --> 00:14:49,912\nAll right.\n\n287\n00:14:49,912 --> 00:14:56,250\n[COUGH]\nSo if we look here, this is the power GUI,\n\n288\n00:14:56,250 --> 00:15:01,930\nand the screen is very similar to what\nwe saw over in the power shell ISE.\n\n289\n00:15:01,930 --> 00:15:05,100\nWhen we look in here I've got\nmy files that I have open.\n\n290\n00:15:05,100 --> 00:15:06,350\nNow, that's a little bit different, right?\n\n291\n00:15:06,350 --> 00:15:09,870\nI didn't have that in the ISE,\nbut here I've got this\n\n292\n00:15:09,870 --> 00:15:13,490\nfolder that I've navigated to, and\nall of the files that are inside of it.\n\n293\n00:15:13,490 --> 00:15:15,090\nSo, it gives you a quick navigation.\n\n294\n00:15:15,090 --> 00:15:16,865\nAnd you can hide that\nif you don't want it.\n\n295\n00:15:16,865 --> 00:15:19,045\nAnd now we're a little bit\nmore in line with the ISE.\n\n296\n00:15:20,555 --> 00:15:22,595\nI can see my script right here.\n\n297\n00:15:22,595 --> 00:15:24,035\nWhat it is that I'm writing.\n\n298\n00:15:25,375 --> 00:15:26,755\nAnd I can zoom in on that.\n\n299\n00:15:26,755 --> 00:15:30,325\nAnd so here's that same profile\nscript from a moment ago.\n\n300\n00:15:30,325 --> 00:15:32,580\nNothing too terribly spectacular there.\n\n301\n00:15:32,580 --> 00:15:36,080\nAnd if I go to that create\nad users one I can see it.\n\n302\n00:15:36,080 --> 00:15:37,060\nAnd here it is laid out.\n\n303\n00:15:37,060 --> 00:15:40,909\nSo we get full syntax highlighting,\nhelping us spot those errors,\n\n304\n00:15:40,909 --> 00:15:42,472\nas we work with our system.\n\n305\n00:15:42,472 --> 00:15:45,924\nSo if I go through and I take something\nlike removing that squiggly bracket\n\n306\n00:15:45,924 --> 00:15:48,039\nwhich breaks that bracket,\nnow I can look and\n\n307\n00:15:48,039 --> 00:15:51,545\nI guess it's probably hard to see on\nthe camera but there's a little yellow\n\n308\n00:15:51,545 --> 00:15:54,906\nbar right there letting me know that\nthere's some kind of issue there.\n\n309\n00:15:54,906 --> 00:15:58,462\nAn issue Is that I didn't\nclose out that bracket.\n\n310\n00:15:58,462 --> 00:16:01,222\nAnd so if I close it,\nit's gonna kinda clean that up and\n\n311\n00:16:01,222 --> 00:16:03,040\nget that sorted out for me.\n\n312\n00:16:03,040 --> 00:16:07,320\nSo it's tracking that stuff,\nhelping me to locate issues.\n\n313\n00:16:07,320 --> 00:16:14,980\nIntelliSense is a copyright, trademarked,\nproprietary technology from Microsoft.\n\n314\n00:16:14,980 --> 00:16:17,750\nSo it doesn't have straight\nup IntelliSense, but\n\n315\n00:16:17,750 --> 00:16:20,120\nit has something kind of to replace it.\n\n316\n00:16:20,120 --> 00:16:23,140\nIf we take a look at me typing here,\n\n317\n00:16:23,140 --> 00:16:25,880\nsee how it is automatically\nproviding me with stuff.\n\n318\n00:16:25,880 --> 00:16:28,440\nSo they don't call this IntelliSense\nbecause that's copyrighted, but\n\n319\n00:16:28,440 --> 00:16:32,610\nit is the same basic idea and\nI'm seeing those same options here,\n\n320\n00:16:32,610 --> 00:16:36,050\nall the different things that\nI can specify, all right?\n\n321\n00:16:36,050 --> 00:16:40,440\nOne of the things that I like is,\nin this, I created a bunch of variables.\n\n322\n00:16:40,440 --> 00:16:41,958\nWell, if I look over here,\n\n323\n00:16:41,958 --> 00:16:46,510\nyou can see where it's actually\nsuggesting some various variables to me.\n\n324\n00:16:46,510 --> 00:16:49,248\nThings like Scriptroute and\nprevious commands,\n\n325\n00:16:49,248 --> 00:16:52,055\nthese little double ampersands and stuff.\n\n326\n00:16:52,055 --> 00:16:55,226\nAnd so you'll see some of the variables\nthat are available up here there and\n\n327\n00:16:55,226 --> 00:16:56,850\nit'll change based on your context.\n\n328\n00:16:56,850 --> 00:17:00,152\nSo depending on where you're\nworking inside of the PowerShell,\n\n329\n00:17:00,152 --> 00:17:04,245\nyou may see some, or all of those, or\neven more, based on what you're running.\n\n330\n00:17:04,245 --> 00:17:10,890\nSo, if I were to take this script and\nrun it ,it's gonna execute and as it runs.\n\n331\n00:17:10,890 --> 00:17:14,380\nI guess it ran kind of fast there,\ndidn't it?\n\n332\n00:17:14,380 --> 00:17:15,148\nBut as it runs,\n\n333\n00:17:15,148 --> 00:17:19,810\nthis variable screen will actually update\nto show when those variables get created.\n\n334\n00:17:19,810 --> 00:17:22,690\nAnd so now I can see there's $console.\n\n335\n00:17:22,690 --> 00:17:26,040\nWe should see $scrollback, $window.\n\n336\n00:17:26,040 --> 00:17:28,330\nThose are the variables that I\nmade as part of the script and so\n\n337\n00:17:28,330 --> 00:17:30,860\nit's showing them and\nwhat their values are.\n\n338\n00:17:30,860 --> 00:17:34,320\nSo I can see by the time\nthis script finishes\n\n339\n00:17:34,320 --> 00:17:36,910\nwhat did each of those variables contain?\n\n340\n00:17:36,910 --> 00:17:40,676\nSo it gives us visibility into something\nwe wouldn't normally see, and my prompt,\n\n341\n00:17:40,676 --> 00:17:42,700\nI should have changed\nit back to white again.\n\n342\n00:17:42,700 --> 00:17:44,580\nIt's really hard to see\nwhen it's that dark blue.\n\n343\n00:17:44,580 --> 00:17:47,140\nLet me rerun that.\n\n344\n00:17:49,840 --> 00:17:51,045\nSo I'll just rerun it, there we go.\n\n345\n00:17:51,045 --> 00:17:54,570\nSo I can see that my prompt did update,\nI've got my new syntax here,\n\n346\n00:17:54,570 --> 00:17:59,860\nand if I run Get-help,\nit's gonna run that and\n\n347\n00:17:59,860 --> 00:18:03,090\nthat output is gonna come up here on\nthe screen and it scrolled past it.\n\n348\n00:18:03,090 --> 00:18:06,010\nI guess my foreground color\nhas changed to black somehow.\n\n349\n00:18:06,010 --> 00:18:10,350\nI shouldn't say black,\nit's all right here, isn't it.\n\n350\n00:18:10,350 --> 00:18:12,690\nLet me just make my\nforeground color white,\n\n351\n00:18:12,690 --> 00:18:17,191\nmy background color blue,\nand we'll re-execute.\n\n352\n00:18:20,440 --> 00:18:22,460\nHere we go, and now we can write Get-Help.\n\n353\n00:18:22,460 --> 00:18:25,590\nNotice when I type Get-Help,\nit's not actually letting me type\n\n354\n00:18:25,590 --> 00:18:29,990\nhere in the console, it's making me\ntype down here, in this separate bar.\n\n355\n00:18:29,990 --> 00:18:33,630\nThat's kind of nice, it does make it\na little easier to edit because up here,\n\n356\n00:18:33,630 --> 00:18:35,860\nif you have a mistake\nhalfway through your command,\n\n357\n00:18:35,860 --> 00:18:38,110\nyou can't just click your cursor and\nbe halfway.\n\n358\n00:18:38,110 --> 00:18:43,040\nYou have to use your arrow keys, but down\nhere I can click my cursor wherever I want\n\n359\n00:18:43,040 --> 00:18:46,440\nand it'll jump around and\nget to it, and that's kind of nice.\n\n360\n00:18:46,440 --> 00:18:48,060\nAnd your history still works.\n\n361\n00:18:48,060 --> 00:18:51,345\nYou can still use up and down arrows while\nyou're down here to pull up the commands\n\n362\n00:18:51,345 --> 00:18:54,080\nthat you've typed before,\nso that's kind of nice.\n\n363\n00:18:54,080 --> 00:18:56,749\nBut now that's gonna run and\nthere's my output.\n\n364\n00:18:56,749 --> 00:19:01,829\nI guess my foreground stayed black,\nwhich is not showing up on.\n\n365\n00:19:01,829 --> 00:19:05,901\nWhat you guys are seeing, you're just\nseeing the blue plane there, but\n\n366\n00:19:05,901 --> 00:19:09,790\nit's just black on blue,\nwhich is practically impossible to read.\n\n367\n00:19:11,170 --> 00:19:14,156\nYeah, I guess my foreground\ncolor is just not taking effect.\n\n368\n00:19:14,156 --> 00:19:17,680\nWell, in Power GUI I know we have the\nsettings, if I go into the preferences or\n\n369\n00:19:17,680 --> 00:19:23,790\noptions, you can go in there and\ncustomize the colors somewhere in here.\n\n370\n00:19:23,790 --> 00:19:26,330\nWell, whatever,\nI don't wanna fight with all that.\n\n371\n00:19:26,330 --> 00:19:32,550\nBut you can get that changed and\nget everything kind of in place.\n\n372\n00:19:32,550 --> 00:19:33,105\nAnd it's neat.\n\n373\n00:19:33,105 --> 00:19:35,625\nYou know, it's just another\nsimple way to work the thing.\n\n374\n00:19:35,625 --> 00:19:39,955\nThe PowerGUI itself is not necessarily\ndistinct from PowerShell ISE,\n\n375\n00:19:39,955 --> 00:19:41,515\nuntil you get to the add-ons.\n\n376\n00:19:41,515 --> 00:19:46,155\nWith PowerGUI, what really makes it\nspecial is what they call PowerPacks.\n\n377\n00:19:46,155 --> 00:19:49,135\nAnd pretty much anybody can write\nPowerPacks to stick on here and\n\n378\n00:19:49,135 --> 00:19:51,535\ndo all sorts of crazy other things.\n\n379\n00:19:51,535 --> 00:19:55,570\nIt's kinda like adding modules to\nPowerShell, and they're available for\n\n380\n00:19:55,570 --> 00:19:58,320\ndownload right from the PowerGUI\nsite which, if you ever wanna go to,\n\n381\n00:19:58,320 --> 00:20:04,400\nis PowerGUI.org and it'll redirect to\nDell because Dell controls it now.\n\n382\n00:20:04,400 --> 00:20:08,315\nSo if you go to PowerGUI.org, you'll end\nup right here on the Dell Tech Center.\n\n383\n00:20:08,315 --> 00:20:12,095\nAnd this is the PowerGUI page, and\nyou can download it from here.\n\n384\n00:20:12,095 --> 00:20:15,355\nThey've got their documentation and\nother information.\n\n385\n00:20:15,355 --> 00:20:20,200\nAnd in here, they've got a link somewhere,\nright here, that goes to the PowerPacks.\n\n386\n00:20:20,200 --> 00:20:21,270\nAnd when you go into the PowerPacks,\n\n387\n00:20:21,270 --> 00:20:23,790\nyou'll see they've got ones for\nall sorts of things.\n\n388\n00:20:23,790 --> 00:20:30,110\nThey've got Windows Media Player, Twitter,\nFacebook, you'll find Amazon Web Services,\n\n389\n00:20:30,110 --> 00:20:34,580\nall sorts of PowerPacks they've added\nto create that additional functionality\n\n390\n00:20:34,580 --> 00:20:38,240\nwithout having to go and install\nthe management tools for that software.\n\n391\n00:20:38,240 --> 00:20:39,460\nThat's kinda nice.\n\n392\n00:20:39,460 --> 00:20:42,980\nWith the PowerShell ISE, a lot of the\nadd-ons to it come with the software so\n\n393\n00:20:42,980 --> 00:20:46,150\nyou've gotta go and install that, and\nthat makes it a little more challenging.\n\n394\n00:20:46,150 --> 00:20:50,170\nSo, you'll see a lot of neat\nstuff in there, it's pretty cool.\n\n395\n00:20:50,170 --> 00:20:54,540\nSo the PowerShell ISE or the PowerGUI,\nthey really do the same thing.\n\n396\n00:20:54,540 --> 00:20:58,300\nThey're giving you that graphical\ndevelopment type interface\n\n397\n00:20:58,300 --> 00:21:01,790\nthat lets you write out a script,\ndo debugging, checking,\n\n398\n00:21:01,790 --> 00:21:04,880\nand testing,\nall from a controlled environment.\n\n399\n00:21:04,880 --> 00:21:09,700\nAnd then when it's ready, you save your\nscript, you take it over to a server, and\n\n400\n00:21:09,700 --> 00:21:13,130\nyou execute it knowing that the script\nwill work right the first time,\n\n401\n00:21:13,130 --> 00:21:16,910\nbecause you've already done thorough\ntesting and development, right?\n\n402\n00:21:16,910 --> 00:21:19,170\nThat's what PowerShell ISE is for.\n\n403\n00:21:19,170 --> 00:21:22,260\nNow, a lot of people aren't even\naware of the PowerShell ISE, but\n\n404\n00:21:22,260 --> 00:21:24,020\nit is installed by default.\n\n405\n00:21:24,020 --> 00:21:26,540\nIt's just most people click\non the icon down here, and\n\n406\n00:21:26,540 --> 00:21:30,210\nnever think about right-clicking\non it to see these other options.\n\n407\n00:21:30,210 --> 00:21:33,633\nBut even in your screen, if you go and\npull up your start screen and\n\n408\n00:21:33,633 --> 00:21:37,695\nstart typing in PowerShell, you'll see\nwhere the ISE shows up right there.\n\n409\n00:21:37,695 --> 00:21:42,814\nSo, it is available, it's a part of\nPowerShell from 2.0 on, it's there.\n\n410\n00:21:42,814 --> 00:21:47,000\nAll right, it seems like there's\nsomething else that I wanted to mention.\n\n411\n00:21:49,890 --> 00:21:53,570\nOh, one other nice thing that I\nlike to use with PowerShell ISE\n\n412\n00:21:53,570 --> 00:21:58,270\nis it has context-sensitive help, and\nlet me show you what I mean by that.\n\n413\n00:21:58,270 --> 00:22:00,774\nIf I go back into PowerShell,\ninto the PowerShell ISE,\n\n414\n00:22:00,774 --> 00:22:02,380\nI'm gonna do an all new file.\n\n415\n00:22:02,380 --> 00:22:04,150\nRight, so I'm just getting started.\n\n416\n00:22:04,150 --> 00:22:07,410\nWell, if I hit F1 on my keyboard,\n\n417\n00:22:07,410 --> 00:22:09,660\nit's gonna pull up the help\ndocumentation just for PowerShell.\n\n418\n00:22:09,660 --> 00:22:13,220\nSo here it is, PowerShell ISE,\nits help file.\n\n419\n00:22:13,220 --> 00:22:17,850\nBut if I start typing, so\nif I'm doing Get-Help and\n\n420\n00:22:17,850 --> 00:22:21,290\nthen I press F1, it's gonna take\nme to the help documentation.\n\n421\n00:22:21,290 --> 00:22:23,640\nAnd [LAUGH] it totally failed to do it.\n\n422\n00:22:23,640 --> 00:22:27,210\nIt's supposed to take me to the health\ndocumentation for Get-Help.\n\n423\n00:22:27,210 --> 00:22:29,220\nDid I not have my cursor\nin the right spot?\n\n424\n00:22:31,030 --> 00:22:31,760\nLet's try that again.\n\n425\n00:22:33,490 --> 00:22:34,740\nThere we go.\n\n426\n00:22:34,740 --> 00:22:36,970\nI put my cursor on Get-Help this time.\n\n427\n00:22:36,970 --> 00:22:38,930\nAnd there it goes,\nit popped up the right window.\n\n428\n00:22:38,930 --> 00:22:43,760\nAnd I'm getting the help for that command,\nso I didn't have to run Get-Help myself,\n\n429\n00:22:43,760 --> 00:22:48,390\nit actually ran it for me and it did\nthat show window modifier to make it\n\n430\n00:22:48,390 --> 00:22:53,350\npop up in an extra window and now I've got\nthe syntax for that command right here.\n\n431\n00:22:53,350 --> 00:22:57,910\nJust by using the F1 key, you click on the\ncommand you want help on, you hit F1 and\n\n432\n00:22:57,910 --> 00:23:00,860\nit comes up and\nyou could even pick other things.\n\n433\n00:23:00,860 --> 00:23:03,180\nYou know, I've got get-date right here.\n\n434\n00:23:03,180 --> 00:23:07,200\nAnd if we go on pullet,\nhere's the help forget-date.\n\n435\n00:23:07,200 --> 00:23:08,730\nSo not even from my script up here,\n\n436\n00:23:08,730 --> 00:23:12,390\njust from the actual console window and\nit gave me the help that I needed.\n\n437\n00:23:12,390 --> 00:23:13,960\nPretty cool, pretty convenient, right.\n\n438\n00:23:13,960 --> 00:23:16,660\nThose are some of the things\nthat we get with PowerShell ISE\n\n439\n00:23:16,660 --> 00:23:20,390\nthat are a lot easier to work with\nthan just being in the console itself.\n\n440\n00:23:21,922 --> 00:23:23,820\nAll right, well,\nthat's all I've got on those.\n\n441\n00:23:23,820 --> 00:23:25,780\nObviously there's a lot of\npower to those utilities.\n\n442\n00:23:25,780 --> 00:23:27,330\nDefinitely experiment around with them,\nbut for\n\n443\n00:23:27,330 --> 00:23:31,952\nmost people that's the basic functionality\nthat you need to use them successfully.\n\n444\n00:23:31,952 --> 00:23:33,788\nAll right, well,\nI hope you guys enjoyed this segment.\n\n445\n00:23:33,788 --> 00:23:37,141\nStay tuned,\nwe've got more PowerShell coming up.\n\n446\n00:23:37,141 --> 00:23:42,900\n[SOUND]\n\n",
          "vimeoId": "113926891"
        },
        {
          "description": "",
          "length": "1337",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-15-powershell-drives-120514.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-15-powershell-drives-120514-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-1-15-powershell-drives-120514-sm.jpg",
          "title": "PowerShell Drives",
          "transcript": "WEBVTT\n\n1\n00:00:00.000 --> 00:00:08.040\n[MUSIC]\n\n2\n00:00:08.040 --> 00:00:11.890\nIn this segment we're gonna take\na look at PowerShell drives.\n\n3\n00:00:11.890 --> 00:00:14.970\nNow, most of us have worked with hard\ndrives at one point or another and\n\n4\n00:00:14.970 --> 00:00:18.950\nif you're using the PowerShell,\nit's pretty likely that you have too.\n\n5\n00:00:18.950 --> 00:00:22.830\nAnd so we're used to the way of thinking\nthat's been available inside of Windows\n\n6\n00:00:22.830 --> 00:00:28.280\nand DOS way back 20, 30 years ago,\nwhere we have a folder structure and\n\n7\n00:00:28.280 --> 00:00:31.460\nwe navigate around on our\nhard drive to access files.\n\n8\n00:00:31.460 --> 00:00:34.875\nWell, you can do all that\nin the PowerShell, too, but\n\n9\n00:00:34.875 --> 00:00:38.720\nin the PowerShell,\nthey're not actually files.\n\n10\n00:00:38.720 --> 00:00:39.720\nThey look like they are.\n\n11\n00:00:39.720 --> 00:00:41.880\nIt looks like we're browsing\naround in that folder structure,\n\n12\n00:00:41.880 --> 00:00:43.395\nbut we really aren't.\n\n13\n00:00:43.395 --> 00:00:49.410\nPowerShell, the whole interface, is really\njust kind of emulating what we're used to.\n\n14\n00:00:49.410 --> 00:00:53.050\nAnd that means in PowerShell, because\nthese aren't really the folder structures\n\n15\n00:00:53.050 --> 00:00:58.240\nthat we're looking at, it can represent\nall sorts of things as a drive letter.\n\n16\n00:00:58.240 --> 00:01:01.930\nSo, when I say PowerShell drives,\nI'm not just talking about your C drive or\n\n17\n00:01:01.930 --> 00:01:03.360\na file system.\n\n18\n00:01:03.360 --> 00:01:07.220\nA PowerShell drive could\npoint to a lot of things.\n\n19\n00:01:07.220 --> 00:01:11.290\nThings like the registry or\nyour variable store,\n\n20\n00:01:11.290 --> 00:01:14.710\nyour alias store, it can point to\nall sorts of of really cool things.\n\n21\n00:01:14.710 --> 00:01:16.250\nAnd allows you to navigate around and\n\n22\n00:01:16.250 --> 00:01:18.820\nwork with it as if it were\npart of the file system.\n\n23\n00:01:18.820 --> 00:01:23.820\nSo it takes this older mentality, this\nmethodology we've been using for years and\n\n24\n00:01:23.820 --> 00:01:27.360\nyears and years, and then places\nit on top of other technologies,\n\n25\n00:01:27.360 --> 00:01:28.580\nwhich is really powerful.\n\n26\n00:01:29.620 --> 00:01:33.230\nLet me show you some examples and we'll\nkind of get an idea of how this works.\n\n27\n00:01:33.230 --> 00:01:36.440\nAnd then we'll do and a few more segments\nlater on when we'll show how to work with\n\n28\n00:01:36.440 --> 00:01:38.270\nspecific entities inside of it.\n\n29\n00:01:38.270 --> 00:01:40.830\nBut let's just start by\ntaking a look at how\n\n30\n00:01:40.830 --> 00:01:43.990\nregular file system functions\nhappen inside of PowerShell.\n\n31\n00:01:43.990 --> 00:01:45.545\nSo I'm going to fire up my PowerShell.\n\n32\n00:01:46.810 --> 00:01:50.980\nAnd once we're in, it gives me\na representation that's a file system.\n\n33\n00:01:50.980 --> 00:01:55.080\nRight, I see I'm in C:\\Users\\Don Pezet.\n\n34\n00:01:55.080 --> 00:01:57.700\nAnd if I want to change directories and\n\n35\n00:01:57.700 --> 00:02:02.985\nthings like that,\nI can do cd..to move up one directory.\n\n36\n00:02:02.985 --> 00:02:06.765\nOr, if I'm in my own directory like that,\n\n37\n00:02:06.765 --> 00:02:09.745\nI could do cd\\,\nto go all the way to the root.\n\n38\n00:02:09.745 --> 00:02:12.785\nThose commands have been\npresent in Windows forever.\n\n39\n00:02:12.785 --> 00:02:14.635\nRight, and present in DOS before that.\n\n40\n00:02:14.635 --> 00:02:16.095\nThese are not anything new.\n\n41\n00:02:17.145 --> 00:02:20.625\nAnd if I've got a C drive and\na D drive, and an E drive,\n\n42\n00:02:20.625 --> 00:02:25.740\nI could always switch between those\nby typing e: or d:, and switching.\n\n43\n00:02:25.740 --> 00:02:26.370\nRight.\n\n44\n00:02:26.370 --> 00:02:30.110\nSo those commands that we're used to,\nthey're are still there, right,\n\n45\n00:02:30.110 --> 00:02:31.170\nthey still work.\n\n46\n00:02:31.170 --> 00:02:33.210\nBut they're really aliases.\n\n47\n00:02:33.210 --> 00:02:37.170\nNotice when I tried to change to e:, I\nwas trying to switch to that other drive.\n\n48\n00:02:37.170 --> 00:02:38.740\nLook at the error that I got,\n\n49\n00:02:38.740 --> 00:02:41.090\nwell I don't have an E drive\nright that's my first problem.\n\n50\n00:02:41.090 --> 00:02:42.660\nBut I got an error and\n\n51\n00:02:42.660 --> 00:02:47.060\nit's telling me that set location\ncannot find the drive, all right.\n\n52\n00:02:47.060 --> 00:02:52.895\nSo when I tried to switch by just typing\nE: it was actually hitting an alias for\n\n53\n00:02:52.895 --> 00:02:56.290\nset-location to try and\nchange that drive to access it.\n\n54\n00:02:56.290 --> 00:02:58.360\nAnd then just letting me know\nthat a drive doesn't exist for\n\n55\n00:02:58.360 --> 00:03:02.910\nthat name and it's a PowerShell object\nthat it's referencing down here.\n\n56\n00:03:02.910 --> 00:03:08.440\nNow, that object could actually\npoint to a lot of stuff, right.\n\n57\n00:03:08.440 --> 00:03:10.590\nIn fact, depending on\nthe software you've installed,\n\n58\n00:03:10.590 --> 00:03:12.420\nyou may have all sorts of crazy\nthings that even I don't.\n\n59\n00:03:12.420 --> 00:03:13.750\nBut let's take a look at the defaults.\n\n60\n00:03:13.750 --> 00:03:16.060\nI just have the default stuff on mine.\n\n61\n00:03:16.060 --> 00:03:19.862\nI'm going to run Get-PSDrives.\n\n62\n00:03:19.862 --> 00:03:22.880\nOops, sorry, it's not plural, Get-PSDrive.\n\n63\n00:03:22.880 --> 00:03:23.580\nThere we go.\n\n64\n00:03:24.580 --> 00:03:29.500\nSo when I do Get-PSDrive, it lists\nthe drives that I have on my system.\n\n65\n00:03:29.500 --> 00:03:31.200\nAnd I can see that I've\ngot a handful of them.\n\n66\n00:03:31.200 --> 00:03:35.630\nI did not make any of these, these were\nall put here by default in Windows.\n\n67\n00:03:35.630 --> 00:03:37.870\nAnd I can see the C drive.\n\n68\n00:03:37.870 --> 00:03:40.920\nRight.\nThere is that hard drive that I'm in\n\n69\n00:03:40.920 --> 00:03:41.950\nright now.\n\n70\n00:03:41.950 --> 00:03:46.280\nIt shows that I'm using 22 gigs of it,\nit's actually a 40 gig drive, and\n\n71\n00:03:46.280 --> 00:03:50.370\nit's a file system, and\nI reference it as C:\\.\n\n72\n00:03:50.370 --> 00:03:53.540\nI've got a D:\\ and an A:\\.\n\n73\n00:03:53.540 --> 00:03:56.150\nSo I've got a few other pads\nthere that I can navigate.\n\n74\n00:03:56.150 --> 00:04:01.430\nIn terms of the file system,\nthose are the ones we're used to, right?\n\n75\n00:04:01.430 --> 00:04:03.200\nBut what are all these other things?\n\n76\n00:04:03.200 --> 00:04:08.230\nWell, all the other ones that are listed\nhere are other types of drives, and\n\n77\n00:04:08.230 --> 00:04:11.420\nsome of them are really cool like\nthe registry ones right here.\n\n78\n00:04:11.420 --> 00:04:13.098\nH K C U.\n\n79\n00:04:13.098 --> 00:04:15.560\nWhat kind of drive letter is that?\n\n80\n00:04:15.560 --> 00:04:19.430\nIf I type HKCU:.\n\n81\n00:04:19.430 --> 00:04:21.510\nWell, it gives me an error right.\n\n82\n00:04:21.510 --> 00:04:26.250\nSo it's telling me here that it's not\nrecognizing the name of a command-let.\n\n83\n00:04:26.250 --> 00:04:29.010\nWell that's because it's not\nlike a single drive letter.\n\n84\n00:04:29.010 --> 00:04:35.030\nBut if I try and change directory into it,\nHKCU:, my path changes.\n\n85\n00:04:35.030 --> 00:04:38.110\nI just changed into a new drive.\n\n86\n00:04:38.110 --> 00:04:39.150\nA drive called HKCU.\n\n87\n00:04:39.150 --> 00:04:39.890\nWhat the heck is that?\n\n88\n00:04:39.890 --> 00:04:43.260\nWell that stands for H key current user.\n\n89\n00:04:43.260 --> 00:04:44.780\nThat's a registry hive.\n\n90\n00:04:44.780 --> 00:04:48.210\nIf you want to edit values or\nquery values from the registry,\n\n91\n00:04:48.210 --> 00:04:53.560\nyou can browse right into your\nregistry as if it were a file system.\n\n92\n00:04:53.560 --> 00:04:55.100\nAnd you can start to browse into here.\n\n93\n00:04:55.100 --> 00:05:00.030\nSo if I wanted to find things that\nrun when my computer starts, right?\n\n94\n00:05:00.030 --> 00:05:03.210\nSo I might go into HK current user,\nor HP current user.\n\n95\n00:05:03.210 --> 00:05:05.500\nGo into, what is it software?\n\n96\n00:05:05.500 --> 00:05:07.320\nLet's see if I can remember this one.\n\n97\n00:05:07.320 --> 00:05:10.616\nSoftware, Microsoft and Windows.\n\n98\n00:05:10.616 --> 00:05:15.785\nAnd current version.\n\n99\n00:05:15.785 --> 00:05:17.990\nAnd run I believe is the next folder.\n\n100\n00:05:17.990 --> 00:05:19.300\nYep, there it is.\n\n101\n00:05:19.300 --> 00:05:22.520\nSo I just browsed into my registry.\n\n102\n00:05:22.520 --> 00:05:26.220\nAnd I can just run a dir and\nsee if there's anything in there.\n\n103\n00:05:26.220 --> 00:05:29.850\nNow each of these providers\nworks a little bit differently.\n\n104\n00:05:29.850 --> 00:05:32.638\nAnd we're going to do a segment on\nthe registry a little bit later.\n\n105\n00:05:32.638 --> 00:05:34.100\nBut that dir command,\n\n106\n00:05:34.100 --> 00:05:36.960\nnormally it says show me all\nthe files that are in this folder.\n\n107\n00:05:38.000 --> 00:05:41.370\nWell, what files do I have\ninside of my registry?\n\n108\n00:05:41.370 --> 00:05:42.330\nNone.\n\n109\n00:05:42.330 --> 00:05:47.780\nThe dir command is not really functional,\nfor the registry.\n\n110\n00:05:47.780 --> 00:05:51.180\nInstead of looking for files,\nI should be looking for parameters.\n\n111\n00:05:51.180 --> 00:05:52.510\nRight?\nIn the registry,\n\n112\n00:05:52.510 --> 00:05:54.470\neach folder is called a key.\n\n113\n00:05:54.470 --> 00:05:56.220\nAnd that's what I've been\nnavigating right there, folder.\n\n114\n00:05:56.220 --> 00:05:59.640\nSo when I type dir, it's looking for\nfolders and it's not finding any.\n\n115\n00:05:59.640 --> 00:06:01.670\nSo now I need to look for parameters.\n\n116\n00:06:01.670 --> 00:06:04.380\nI need to start diving into it, and\nwe'll do a segment on the registry and\n\n117\n00:06:04.380 --> 00:06:05.460\nI'll show you guys how to do that.\n\n118\n00:06:05.460 --> 00:06:07.390\nHow to work with those\nregistry values in there.\n\n119\n00:06:07.390 --> 00:06:10.920\nBut what I wanted to show you though was\nthat I'm accessing the registry as if it\n\n120\n00:06:10.920 --> 00:06:11.700\nwas a file system.\n\n121\n00:06:12.760 --> 00:06:18.089\nThe same thing goes for things like\naliases and functions, when I did get-PS\n\n122\n00:06:18.089 --> 00:06:24.160\ndrive, I saw that I had Function,\nAlias, Variable, Cert, right.\n\n123\n00:06:24.160 --> 00:06:27.880\nEach one of these is pointing at\nsome kind of resource in my system.\n\n124\n00:06:27.880 --> 00:06:28.940\nCert, for example.\n\n125\n00:06:28.940 --> 00:06:30.270\nI didn't run this as an administrator, so\n\n126\n00:06:30.270 --> 00:06:32.530\nit's probably gonna get\nmad at me at one point.\n\n127\n00:06:32.530 --> 00:06:36.590\nBut if I change into that Cert directory,\nand I start looking around,\n\n128\n00:06:36.590 --> 00:06:40.740\nI can see I've got user certificates and\nlocal machine certificates.\n\n129\n00:06:40.740 --> 00:06:44.850\nI'll go into my user certificates,\nsince I should have access to that.\n\n130\n00:06:44.850 --> 00:06:45.710\nAnd I can pull it up and\n\n131\n00:06:45.710 --> 00:06:49.050\nI can start to see some of\nthe different folders I have in there.\n\n132\n00:06:49.050 --> 00:06:53.850\nSo if I want to see who I trust, right,\nmy trust certificates, or my certificates,\n\n133\n00:06:53.850 --> 00:06:55.880\nthe ones that are assigned to me.\n\n134\n00:06:55.880 --> 00:06:57.850\nI can go in here and start to look.\n\n135\n00:06:57.850 --> 00:07:00.850\nBut again it's looking for\nfiles, and I don't have any.\n\n136\n00:07:00.850 --> 00:07:02.880\nWell I guess it's possible I\ndon't have any certificates,\n\n137\n00:07:02.880 --> 00:07:04.540\nlet's test that out real quick.\n\n138\n00:07:04.540 --> 00:07:08.028\nSo if I go into my, oh,\nthat's not what I wanted.\n\n139\n00:07:11.434 --> 00:07:15.020\nI just want a, and let's see it's\ngonna fight me here isn't it.\n\n140\n00:07:17.000 --> 00:07:20.060\nWell you know I'll just make sure I have\na certificate here I'll encrypt something.\n\n141\n00:07:20.060 --> 00:07:22.690\nIf you just encrypt a single file on\nyour hard drive that will make it create\n\n142\n00:07:22.690 --> 00:07:26.650\na certificate for your user account and\nwe can do that real quick.\n\n143\n00:07:28.310 --> 00:07:31.060\nThere, so now at a minimum I'm\ngoing to have one certificate.\n\n144\n00:07:31.060 --> 00:07:33.480\nBut I have to be an administer?\n\n145\n00:07:33.480 --> 00:07:35.310\nOh, it's because it's in the root folder.\n\n146\n00:07:35.310 --> 00:07:35.930\nShoot.\n\n147\n00:07:35.930 --> 00:07:39.830\nThat should be fine as long\nas I'm still the owner.\n\n148\n00:07:39.830 --> 00:07:42.510\nIt's always something making things\nmore complex than they should be.\n\n149\n00:07:42.510 --> 00:07:43.660\nHere.\nI'll do something on the desktop\n\n150\n00:07:43.660 --> 00:07:47.200\njust be on the safe side; I'll take\nthis PowerShell script and encrypt it.\n\n151\n00:07:47.200 --> 00:07:48.882\nSo once that's encrypted well,\n\n152\n00:07:48.882 --> 00:07:51.834\nI need a certificate to be\nable to encrypt things, right.\n\n153\n00:07:51.834 --> 00:07:55.065\nSo when I encrypt that it's creating\nan EFS certificate for me and\n\n154\n00:07:55.065 --> 00:07:57.015\nthat should be one of my certificates.\n\n155\n00:07:57.015 --> 00:07:58.050\nAnd actually there is.\n\n156\n00:07:58.050 --> 00:07:58.701\nAll right.\n\n157\n00:07:58.701 --> 00:08:00.639\nSo I see that I do now have a certificate.\n\n158\n00:08:00.639 --> 00:08:03.560\nThere's the thumbprint for it and\nI can pull additional information.\n\n159\n00:08:03.560 --> 00:08:08.090\nThe certificate store is\nbeing represented as a drive,\n\n160\n00:08:08.090 --> 00:08:10.270\nas like a hard drive, on my system.\n\n161\n00:08:10.270 --> 00:08:12.190\nIt's a virtual drive, it's not real.\n\n162\n00:08:12.190 --> 00:08:12.840\nRight?\n\n163\n00:08:12.840 --> 00:08:14.940\nBut I can access it as if it was.\n\n164\n00:08:14.940 --> 00:08:16.430\nAnd that can be pretty convenient.\n\n165\n00:08:16.430 --> 00:08:18.190\nThat can make things a lot easier.\n\n166\n00:08:18.190 --> 00:08:20.900\nWe also saw alias, was another one.\n\n167\n00:08:20.900 --> 00:08:24.150\nSo if I, and I keep using CD right,\n\n168\n00:08:24.150 --> 00:08:28.470\nchange directory cuz that's what\nwe've used for 20, 30 years.\n\n169\n00:08:28.470 --> 00:08:29.560\nBut it's really set location.\n\n170\n00:08:29.560 --> 00:08:33.480\nSo I could say Set-Location alias, and\n\n171\n00:08:33.480 --> 00:08:36.540\nnow I'm in my alias drive and\nif I pull up a directory there.\n\n172\n00:08:36.540 --> 00:08:38.310\nHere's all the aliases that I've defined.\n\n173\n00:08:39.480 --> 00:08:41.950\nThe ones that are really fun, variables.\n\n174\n00:08:41.950 --> 00:08:47.214\nSo if I do a set location to variable,\n\n175\n00:08:47.214 --> 00:08:51.640\nwe go in here and here's the variables\nthat my system has right now.\n\n176\n00:08:51.640 --> 00:08:55.010\nSo I can look at all my variables and\nwhat their values are.\n\n177\n00:08:55.010 --> 00:08:58.740\nAnd these are constantly changing\nas we work, as we create things.\n\n178\n00:08:58.740 --> 00:09:00.800\nThey're being created, they're stored.\n\n179\n00:09:00.800 --> 00:09:06.711\nSo if I say something like $ console\n\n180\n00:09:06.711 --> 00:09:14.410\n=host.UI.RawUI something like that.\n\n181\n00:09:14.410 --> 00:09:16.650\nI can pull up my directory here, and\n\n182\n00:09:16.650 --> 00:09:19.370\nsomewhere in here I'll find\nthat console variable.\n\n183\n00:09:19.370 --> 00:09:22.658\nThere it is, there's console and\nsee how it's exploded it.\n\n184\n00:09:22.658 --> 00:09:25.600\nI did $ host when I defined it.\n\n185\n00:09:25.600 --> 00:09:27.925\nWell, Windows exploded\ndollar sign hosting to\n\n186\n00:09:27.925 --> 00:09:31.410\nsystem.management.automation.internal.h-\nost.\n\n187\n00:09:31.410 --> 00:09:34.090\nAnd so I didn't have to do that part.\n\n188\n00:09:34.090 --> 00:09:35.020\nIt did that.\n\n189\n00:09:35.020 --> 00:09:38.620\nAnd then it took where I\nmentioned UI.rawUI and\n\n190\n00:09:38.620 --> 00:09:41.960\nit exploded that into internal\nhost Rall user interface.\n\n191\n00:09:41.960 --> 00:09:45.252\nSo I can actually see\nwhat's in those variables.\n\n192\n00:09:45.252 --> 00:09:48.500\nAnd I'm really just working\nwith it like my file system.\n\n193\n00:09:48.500 --> 00:09:49.990\nWhat were some other ones.\n\n194\n00:09:49.990 --> 00:09:53.571\nWe do get-psdrive.\n\n195\n00:09:53.571 --> 00:09:55.971\nThere are some some fun ones in here.\n\n196\n00:09:55.971 --> 00:09:59.480\nWe've got function if we wanna look\nat the functions that we made.\n\n197\n00:09:59.480 --> 00:10:04.910\nWSMan that the Windows management is part\nof the wmi, we've got environment for\n\n198\n00:10:04.910 --> 00:10:08.800\nthe PowerShell environment pulling things\nlike the modules that we've got loaded and\n\n199\n00:10:08.800 --> 00:10:12.550\nother information, and\nI think that's the bulk of them.\n\n200\n00:10:12.550 --> 00:10:15.710\nSo these are the ones that\nare created automatically.\n\n201\n00:10:15.710 --> 00:10:17.470\nI didn't create a single one of these.\n\n202\n00:10:17.470 --> 00:10:18.919\nThese were all done by the system.\n\n203\n00:10:20.110 --> 00:10:24.220\nWhere the PS drives here really cool\nthough, is that you can create your own.\n\n204\n00:10:24.220 --> 00:10:26.660\nYou can actually add more to this.\n\n205\n00:10:26.660 --> 00:10:30.120\nI might want to have a drive letter\nthat doesn't point to a drive but\n\n206\n00:10:30.120 --> 00:10:33.320\npoints to a particular\nfolder in the drive.\n\n207\n00:10:33.320 --> 00:10:34.290\nI can do that.\n\n208\n00:10:34.290 --> 00:10:39.340\nOr a drive letter or name that points to\na particular location in the registry.\n\n209\n00:10:39.340 --> 00:10:41.749\nWe don't wanna necessarily have to go\nthrough and retype things over and\n\n210\n00:10:41.749 --> 00:10:43.590\nover and\nover again if we want to access them.\n\n211\n00:10:43.590 --> 00:10:45.970\nIf we can map a drive letter to it,\nit'll make life easier.\n\n212\n00:10:46.970 --> 00:10:49.410\nSo those are some of the cool\nthings that we can do, but\n\n213\n00:10:49.410 --> 00:10:51.590\nyou've got to know what\nyour system supports.\n\n214\n00:10:51.590 --> 00:10:54.510\nSo get-psdrive.\n\n215\n00:10:54.510 --> 00:10:57.290\nThat's what showed me\nthe drives that I had.\n\n216\n00:10:57.290 --> 00:11:02.860\nThere's another command\nwhich is get-psprovider.\n\n217\n00:11:02.860 --> 00:11:06.300\nEach one of these drives,\nsee how it has a provider column.\n\n218\n00:11:06.300 --> 00:11:08.970\nThat's telling me what's\nmaking that drive function.\n\n219\n00:11:08.970 --> 00:11:12.610\nIf it's a file system one, like a hard\ndrive letter, it's a file system provider.\n\n220\n00:11:12.610 --> 00:11:15.560\nThere's an alias provider,\na registry provider, and so on.\n\n221\n00:11:15.560 --> 00:11:16.760\nThese are different\nproviders that we have.\n\n222\n00:11:17.760 --> 00:11:20.720\nAs you install additional\nsoftware on your servers or\n\n223\n00:11:20.720 --> 00:11:23.380\non your client,\nyou might get more providers.\n\n224\n00:11:23.380 --> 00:11:26.580\nYou might get some other ones that\njust aren't part of the base install.\n\n225\n00:11:26.580 --> 00:11:30.410\nSo you can run Get-PSProvider and\nsee if there's any other ones.\n\n226\n00:11:30.410 --> 00:11:32.700\nI don't think I have anybody\nthat didn't show up there.\n\n227\n00:11:32.700 --> 00:11:35.200\nYeah, they're all normal.\n\n228\n00:11:35.200 --> 00:11:37.940\nI've seen some that are out there\nwritten by other companies that\n\n229\n00:11:37.940 --> 00:11:42.500\nthat had some really cool stuff like\nthe ability to connect F.T.P. servers.\n\n230\n00:11:42.500 --> 00:11:44.990\nSo you can have a driver\nthat maps right to an F.T.P.\n\n231\n00:11:44.990 --> 00:11:46.760\nserver you can browse right into it.\n\n232\n00:11:46.760 --> 00:11:51.220\nI've seen the same thing with the secure\nF.T.P. like over an SH tunnel.\n\n233\n00:11:51.220 --> 00:11:54.260\nYou can do all that stuff,\nif you get the edition right,\n\n234\n00:11:54.260 --> 00:11:56.110\nif you get the provider for it.\n\n235\n00:11:56.110 --> 00:11:58.290\nBut these are the providers\nthat are included alias,\n\n236\n00:11:58.290 --> 00:12:04.640\nenvironment file system and so, so any of\nthose items we can map to a drive name.\n\n237\n00:12:04.640 --> 00:12:07.490\nAnd you know normally I say\na drive letter but here's a name.\n\n238\n00:12:07.490 --> 00:12:10.020\nNoticed when I went to like H.K. see you.\n\n239\n00:12:10.020 --> 00:12:11.630\nI went to H.K. see you colon.\n\n240\n00:12:11.630 --> 00:12:14.690\nSo it's not just a letter,\nit's whatever we want it to be.\n\n241\n00:12:14.690 --> 00:12:16.790\nWe're just used to seeing the letters.\n\n242\n00:12:16.790 --> 00:12:19.600\nBecause 30 years ago they decided\nthat's what we were going to use.\n\n243\n00:12:19.600 --> 00:12:21.360\nAnd if you wanna do that, you can do it.\n\n244\n00:12:21.360 --> 00:12:25.080\nYou can map X: to a particular\nlocation in the registry.\n\n245\n00:12:25.080 --> 00:12:25.931\nIt'll work.\n\n246\n00:12:25.931 --> 00:12:28.650\nBut, we'll oftentimes do a name.\n\n247\n00:12:28.650 --> 00:12:31.740\nSo for example, I like to map some\nthings that makes it easier for\n\n248\n00:12:31.740 --> 00:12:32.420\nme to get my documents.\n\n249\n00:12:33.430 --> 00:12:37.040\nSo if I have a bunch a PowerShell scripts,\nI probably store those somewhere.\n\n250\n00:12:37.040 --> 00:12:39.662\nLike in My Documents folder or\nwhatever, right?\n\n251\n00:12:39.662 --> 00:12:46.482\nSo if I change to my C drive and\nI'll get into.\n\n252\n00:12:46.482 --> 00:12:47.950\nOops.\n\n253\n00:12:47.950 --> 00:12:52.720\nUser \\Don Pezet\\Documents.\n\n254\n00:12:52.720 --> 00:12:55.890\nAnd I'm gonna make a directory\ncalled scripts, all right?\n\n255\n00:12:55.890 --> 00:13:00.898\nSo, maybe that's where I keep all of my\nscripts right there in the scripts folder.\n\n256\n00:13:00.898 --> 00:13:04.500\nAnd I wanna be able to get to that easy\nI don't wanna have to change in here.\n\n257\n00:13:04.500 --> 00:13:05.870\nRemember that when we run a script,\n\n258\n00:13:05.870 --> 00:13:07.850\na PowerShell script we've\nalways got to provide the path.\n\n259\n00:13:07.850 --> 00:13:13.060\nWe have to say like ./profile/ps1,\nif I'm gonna run that script, or\n\n260\n00:13:13.060 --> 00:13:17.310\nif I'm in another folder, I might have\nto type the whole path to get to it.\n\n261\n00:13:17.310 --> 00:13:21.230\nAnd I might not wanna do that,\nit's kind of a pain.\n\n262\n00:13:21.230 --> 00:13:25.030\nAnd you'll see here because mine has\nspaces in it it has to do the ampersand at\n\n263\n00:13:25.030 --> 00:13:26.140\nthe beginning.\n\n264\n00:13:26.140 --> 00:13:31.390\nAnd all that just if I want\nto run this little script.\n\n265\n00:13:31.390 --> 00:13:33.620\nSo that's what I have to type and\nthat's a lot.\n\n266\n00:13:33.620 --> 00:13:37.720\nAnd I think I've said it in other segments\nI'm a lazy typer, so I hate to do that, so\n\n267\n00:13:37.720 --> 00:13:42.480\nif I've got that script,\nand I wanna run it easily.\n\n268\n00:13:42.480 --> 00:13:45.020\nI might wanna make some\nkind of an alias for that.\n\n269\n00:13:45.020 --> 00:13:46.870\nSo I'm to drop the script right in there.\n\n270\n00:13:46.870 --> 00:13:47.370\nThere we go.\n\n271\n00:13:48.460 --> 00:13:49.160\nIt's not actually got it.\n\n272\n00:13:49.160 --> 00:13:53.972\nAll right so\nI'm going to create my own P.S. drive and\n\n273\n00:13:53.972 --> 00:13:59.105\nyou can do that with the new dash P.S.\ndrive command one.\n\n274\n00:13:59.105 --> 00:14:01.159\nAll right, so you can create a P.S.\n\n275\n00:14:01.159 --> 00:14:05.290\ndrive and all you have to do is tell\nit the provider that you're gonna use.\n\n276\n00:14:05.290 --> 00:14:09.040\nThe name you want the drive to have,\nand where it should point to, and\n\n277\n00:14:09.040 --> 00:14:11.400\nwhere it points to is gonna\nvary based on the provider.\n\n278\n00:14:11.400 --> 00:14:14.020\nIf you pick the registry provider\nyou'll point it to a registry key,\n\n279\n00:14:14.020 --> 00:14:15.890\na folder inside your registry.\n\n280\n00:14:15.890 --> 00:14:17.810\nIf you pick the file system\none like I'm about to do,\n\n281\n00:14:17.810 --> 00:14:19.750\nthen it'll point to\na folder on the hard drive.\n\n282\n00:14:19.750 --> 00:14:23.370\nIf you pick the certificate store,\nyou'll point to a particular place there.\n\n283\n00:14:23.370 --> 00:14:27.180\nBut it's all about creating a kind of like\nan alias, that makes life easy for you.\n\n284\n00:14:27.180 --> 00:14:33.196\nAll right so I'm gonna do that\nI'm gonna do one called -name,\n\n285\n00:14:33.196 --> 00:14:36.501\noops, I'll say -name scripts.\n\n286\n00:14:36.501 --> 00:14:38.400\nSo I'm gonna create one\nthat I call scripts, or\n\n287\n00:14:38.400 --> 00:14:41.370\nI might want to call it psscripts or\nsomething just so I can.\n\n288\n00:14:41.370 --> 00:14:43.610\nRemember that these are my\nPowerShell scripts, but,\n\n289\n00:14:43.610 --> 00:14:45.040\nwhatever I want that name to be.\n\n290\n00:14:46.100 --> 00:14:49.110\nAnd then,\nI need to specify where it's gonna go.\n\n291\n00:14:49.110 --> 00:14:52.340\nIn fact, I'll stick with just calling it\nscripts, I don't want it to be too long.\n\n292\n00:14:53.470 --> 00:14:54.010\nAll right.\n\n293\n00:14:54.010 --> 00:14:55.841\nSo the next thing I wanna\nsay is what the provider is.\n\n294\n00:14:55.841 --> 00:15:00.971\nSo, I'll say PS provider, and my provider\nis gonna be the file system provider.\n\n295\n00:15:00.971 --> 00:15:03.000\nAnd I'm just getting that right\nhere from this list up here.\n\n296\n00:15:03.000 --> 00:15:05.820\nFile system is the one that points to\nfile systems so that's what I'm typing.\n\n297\n00:15:07.640 --> 00:15:09.760\nThen you have to specify the root.\n\n298\n00:15:09.760 --> 00:15:11.810\nWhere does the things start?\n\n299\n00:15:11.810 --> 00:15:14.320\nAnd, let me move this so\nit's not covered by my head.\n\n300\n00:15:15.480 --> 00:15:18.115\nThere we go.\nSo we have to say where it points to, and\n\n301\n00:15:18.115 --> 00:15:19.290\nso you say dash root.\n\n302\n00:15:19.290 --> 00:15:21.333\nWhat is the root of this new drive.\n\n303\n00:15:21.333 --> 00:15:23.420\nAnd then we give it that path.\n\n304\n00:15:23.420 --> 00:15:31.700\nAnd the path for\nme is C:\\users\\DonPezet\\documents\\scripts.\n\n305\n00:15:31.700 --> 00:15:33.060\nThere we go.\n\n306\n00:15:33.060 --> 00:15:34.691\nAnd that's gonna be my\nmapping right there.\n\n307\n00:15:34.691 --> 00:15:37.463\nAll right?\nSo I'm telling it where I want it point\n\n308\n00:15:37.463 --> 00:15:42.250\nto, what provider I want it to use, and\nwhat name the driver is going to have.\n\n309\n00:15:42.250 --> 00:15:45.427\nAnd when I run that,\nnow I've got a new drive.\n\n310\n00:15:45.427 --> 00:15:51.834\nIf I do a Get-PSDrive I'll see I've\ngot a drive in here called scripts.\n\n311\n00:15:51.834 --> 00:15:54.739\nAnd if I change to it, if I go to CD.\n\n312\n00:15:54.739 --> 00:15:56.405\nWell, here let me get out of this one.\n\n313\n00:15:56.405 --> 00:15:58.235\nSo there, I'm on my C drive.\n\n314\n00:15:58.235 --> 00:16:04.524\nAnd if I do a change directory or\nset dash location to scripts colon and\n\n315\n00:16:04.524 --> 00:16:08.110\nI pull up a list, there's my profile.\n\n316\n00:16:09.380 --> 00:16:15.700\nSo now if I'm working on my hard drive and\nI'm in some crazy sub folder somewhere.\n\n317\n00:16:15.700 --> 00:16:18.040\nLike I'm working on a host file or\nsomething.\n\n318\n00:16:18.040 --> 00:16:19.470\nSo I'm way in here.\n\n319\n00:16:19.470 --> 00:16:21.110\nAnd I want to run that script.\n\n320\n00:16:21.110 --> 00:16:26.290\nI don't have to type the full path C:\\\nusers\\DonPezet\\documents\\ whatever,\n\n321\n00:16:26.290 --> 00:16:32.500\nI can just type Scripts:/profile.ps.one.\n\n322\n00:16:32.500 --> 00:16:34.580\nRight?\nScripts colon that would be like\n\n323\n00:16:34.580 --> 00:16:36.100\nsaying C colon backslash.\n\n324\n00:16:36.100 --> 00:16:40.000\nRight so the root of that drive profile\nps one that's what I want to run.\n\n325\n00:16:40.000 --> 00:16:47.880\nAnd it'll run and apparently I'm going\nto trip the [LAUGH] whoops, well shoot.\n\n326\n00:16:47.880 --> 00:16:51.700\nI tripped my little security policy\nthere by running that script\n\n327\n00:16:51.700 --> 00:16:53.210\nfrom a non-trusted location.\n\n328\n00:16:53.210 --> 00:16:56.780\nBut you saw that it worked, right, that it\njumped over to that script location and\n\n329\n00:16:56.780 --> 00:16:58.380\nit ran that file.\n\n330\n00:16:58.380 --> 00:16:59.620\nThat's what these are about.\n\n331\n00:16:59.620 --> 00:17:02.230\nYou certainly don't have to use PS drives.\n\n332\n00:17:02.230 --> 00:17:03.830\nThey're a convenience factor.\n\n333\n00:17:03.830 --> 00:17:06.586\nThey're something that you can create\nthat makes it easy to be able to access\n\n334\n00:17:06.586 --> 00:17:08.754\nresources without having to\ngo through crazy navigation.\n\n335\n00:17:08.754 --> 00:17:12.836\nOn the file system that's definitely\ntrue but on things like the registry,\n\n336\n00:17:12.836 --> 00:17:17.106\nit makes working with the registry a lot\neasier, because you used to have to do it\n\n337\n00:17:17.106 --> 00:17:20.707\nthrough CIM calls and those things\nare really difficult to write.\n\n338\n00:17:20.707 --> 00:17:22.180\nNow we can do it right\nthrough the PS drive.\n\n339\n00:17:23.340 --> 00:17:24.920\nNow I do want to point one thing out here,\n\n340\n00:17:24.920 --> 00:17:28.690\nwhich is if I do a get dash PS drive,\nwhoops, or break point.\n\n341\n00:17:28.690 --> 00:17:33.010\n[LAUGH]\nIf I do a get dash PS drive,\n\n342\n00:17:33.010 --> 00:17:35.970\nnotice that my drive is gone right.\n\n343\n00:17:35.970 --> 00:17:38.980\nIt didn't survive me reloading my session.\n\n344\n00:17:38.980 --> 00:17:43.060\nIf you create your own PS drives they do\ngo away when you close your PowerShell\n\n345\n00:17:43.060 --> 00:17:43.970\nsession.\n\n346\n00:17:43.970 --> 00:17:45.510\nSo if this is something\nyou're going to use a lot,\n\n347\n00:17:45.510 --> 00:17:48.570\nyou need to put it in your profile, right.\n\n348\n00:17:48.570 --> 00:17:52.070\nHave it as part of your profile that\nruns when you launch the PowerShell so\n\n349\n00:17:52.070 --> 00:17:54.200\nit's recreated every time, right.\n\n350\n00:17:54.200 --> 00:17:56.270\nAnd if you don't know how to\nwork with those profiles,\n\n351\n00:17:56.270 --> 00:17:57.720\nwe've already filmed a segment on that.\n\n352\n00:17:57.720 --> 00:18:00.160\nCheck it out.\nThey're called PowerShell profiles, and\n\n353\n00:18:00.160 --> 00:18:04.790\nit's how to create things that stick\nwith you between sessions, all right.\n\n354\n00:18:05.830 --> 00:18:09.020\nOne thing to remember though\nis that in that segment,\n\n355\n00:18:09.020 --> 00:18:11.240\nmost of the time we work with\nour own personal profiles.\n\n356\n00:18:12.240 --> 00:18:14.420\nBut if you want to create\na mapping like this and\n\n357\n00:18:14.420 --> 00:18:16.930\nyou're going to use it in your scripts.\n\n358\n00:18:16.930 --> 00:18:19.950\nIf somebody else tries to run that script,\nthey don't have those mappings,\n\n359\n00:18:19.950 --> 00:18:21.170\nit's not going to work.\n\n360\n00:18:21.170 --> 00:18:25.300\nSo you might want to put these\nmappings in your global profiles.\n\n361\n00:18:25.300 --> 00:18:27.273\nThe ones that apply to users and\nshells, right?\n\n362\n00:18:27.273 --> 00:18:28.256\nThe default profiles.\n\n363\n00:18:28.256 --> 00:18:33.079\nThe ones found in\nc:/windows/system32/powershell.\n\n364\n00:18:33.079 --> 00:18:34.920\nThe ones that are buried down in there.\n\n365\n00:18:34.920 --> 00:18:36.920\nThose are the ones that\napply to all users, and\n\n366\n00:18:36.920 --> 00:18:38.470\nyou might want to consider that.\n\n367\n00:18:38.470 --> 00:18:40.200\nThe other option is not to use these.\n\n368\n00:18:40.200 --> 00:18:43.250\nAnd in your scripts instead just to use\nthe ones that you know are going to\n\n369\n00:18:43.250 --> 00:18:44.030\nbe present.\n\n370\n00:18:44.030 --> 00:18:46.660\nThat's why Microsoft\ncreates these by default.\n\n371\n00:18:46.660 --> 00:18:49.140\nRight.\nBecause everyone will have those.\n\n372\n00:18:49.140 --> 00:18:50.340\nYou can use them in your scripts and\n\n373\n00:18:50.340 --> 00:18:53.720\nyou'll be just fine,\neven if somebody else runs them.\n\n374\n00:18:53.720 --> 00:18:55.640\nSo just be aware of that.\n\n375\n00:18:55.640 --> 00:18:59.860\nThe other thing is if you create\na PS drive so I'll do another one.\n\n376\n00:18:59.860 --> 00:19:02.150\nMaybe I'll do one to\nthe registry this time right so\n\n377\n00:19:02.150 --> 00:19:06.650\nI might say new PS drive dash name.\n\n378\n00:19:06.650 --> 00:19:11.390\nAnd I'll call this the run.\n\n379\n00:19:11.390 --> 00:19:16.221\nRight, so these would be things that run\nwhen my system starts up or when logon or\n\n380\n00:19:16.221 --> 00:19:16.950\nwhatever.\n\n381\n00:19:16.950 --> 00:19:19.310\nSo I'm gonna map somewhere\ninto the registry.\n\n382\n00:19:19.310 --> 00:19:21.540\nAnd I'll set my provider as registry.\n\n383\n00:19:22.790 --> 00:19:27.021\nAnd then I need to specify the route and\nfor the route I just need tell\n\n384\n00:19:27.021 --> 00:19:30.588\nit where I'm gonna to be mapping to and\nso I might map to.\n\n385\n00:19:30.588 --> 00:19:41.545\nHKCU:/SOFTWARE/Microsoft/Windows/Current\n\n386\n00:19:41.545 --> 00:19:44.954\nVersion/run.\n\n387\n00:19:48.775 --> 00:19:52.737\nAll right, so I'm creating that mapping,\nwhat did I do here?\n\n388\n00:19:52.737 --> 00:19:55.183\nA perimeter cannot be found\nthat matches provider.\n\n389\n00:19:55.183 --> 00:19:57.018\nShoot.\nIs it PS provider?\n\n390\n00:19:57.018 --> 00:19:58.550\nOh, it is PS provider.\n\n391\n00:19:58.550 --> 00:19:59.810\nThere's a little typo on my part there.\n\n392\n00:19:59.810 --> 00:20:02.690\nLet me change that from dash\nprovider to dash PS provider.\n\n393\n00:20:02.690 --> 00:20:03.780\nThere we go.\n\n394\n00:20:03.780 --> 00:20:06.850\nAll right so\nnow I've got this new PS drive.\n\n395\n00:20:09.660 --> 00:20:10.537\nAnd so there it is.\n\n396\n00:20:10.537 --> 00:20:13.958\nI can see I've created this\none that's called run.\n\n397\n00:20:13.958 --> 00:20:17.290\nAnd if I were to change into it would take\nme right into that eight key current user\n\n398\n00:20:17.290 --> 00:20:19.630\nand into that key to be\nable to browse to it.\n\n399\n00:20:19.630 --> 00:20:25.970\nIf I want to get rid of it, I can use\nthe remove dash PS drive command line.\n\n400\n00:20:25.970 --> 00:20:27.410\nOne little word of advice though.\n\n401\n00:20:27.410 --> 00:20:32.120\nIt doesn't work if you\nare in the drive yourself.\n\n402\n00:20:32.120 --> 00:20:38.950\nSo if I'm in that PS drive and I'm working\naround in here doing whatever direction.\n\n403\n00:20:38.950 --> 00:20:40.270\nI'm already all the way in aren't I?\n\n404\n00:20:40.270 --> 00:20:40.940\nYup.\n\n405\n00:20:40.940 --> 00:20:45.790\nSo if I'm in there and I'm working and\nI try and do a remove dash PS drive.\n\n406\n00:20:47.140 --> 00:20:52.030\nAnd I specify that name in the name\nof mine is just run, right.\n\n407\n00:20:52.030 --> 00:20:53.900\nIt's going to get an error because\nit says it's in use, right, so\n\n408\n00:20:53.900 --> 00:20:56.480\nyou've got to get out of the drive first.\n\n409\n00:20:56.480 --> 00:20:58.820\nAnd you can just move to another drive or\nwhatever and\n\n410\n00:20:58.820 --> 00:21:01.390\nthen you'll be able to remove it and\nit's gone right.\n\n411\n00:21:01.390 --> 00:21:04.423\nSo if you're just using it temporarily,\nlike you have a script and\n\n412\n00:21:04.423 --> 00:21:06.818\nat the beginning of the script\nit creates a mapping.\n\n413\n00:21:06.818 --> 00:21:09.853\nAnd then at the end of the script\nyou want to remove it again,\n\n414\n00:21:09.853 --> 00:21:11.629\nyou just use remove dash PS drive.\n\n415\n00:21:11.629 --> 00:21:12.960\nIt's pretty cool functionality.\n\n416\n00:21:12.960 --> 00:21:15.490\nIt's one that a lot of people\ndon't even know is there.\n\n417\n00:21:15.490 --> 00:21:18.940\nBecause when we look at this prompt,\nwe immediately think file system.\n\n418\n00:21:18.940 --> 00:21:21.490\nAnd we expect things to\nwork like a file system.\n\n419\n00:21:21.490 --> 00:21:24.770\nBut over time you start to learn that hey,\n\n420\n00:21:24.770 --> 00:21:27.110\nI'm not really looking\nat the file system here.\n\n421\n00:21:27.110 --> 00:21:31.370\nIt's making it look like that,\nit's making it look pretty but in reality.\n\n422\n00:21:31.370 --> 00:21:34.310\nI'm looking at just output of\nvariables coming from PowerShell.\n\n423\n00:21:34.310 --> 00:21:35.810\nAnd so these things, these drive letters,\n\n424\n00:21:35.810 --> 00:21:38.440\nthey can represent\nwhatever I want them to.\n\n425\n00:21:38.440 --> 00:21:39.660\nAnd that's what PS Drives are all about.\n\n426\n00:21:41.380 --> 00:21:42.080\nAll right.\nSo,\n\n427\n00:21:42.080 --> 00:21:45.340\nin this segment we got a chance to take\na look at what PowerShell drives were.\n\n428\n00:21:45.340 --> 00:21:47.530\nWe saw the default ones\nthat were already there.\n\n429\n00:21:47.530 --> 00:21:49.600\nWe got a chance to see how to create them.\n\n430\n00:21:49.600 --> 00:21:50.140\nWork with them.\n\n431\n00:21:50.140 --> 00:21:51.930\nAnd ultimately remove them.\n\n432\n00:21:51.930 --> 00:21:55.671\nAnd just another thing to remember as I\nmentioned we might want to add those to\n\n433\n00:21:55.671 --> 00:21:59.179\nour profile so they'll be launched\nin created every time that we launch\n\n434\n00:21:59.179 --> 00:22:01.417\na PowerShell and they're available for us.\n\n435\n00:22:01.417 --> 00:22:02.949\nIt's a really cool technology.\n\n436\n00:22:02.949 --> 00:22:06.195\nSomething you can take advantage of to\nmake your life a little bit easier.\n\n437\n00:22:06.195 --> 00:22:08.062\nAll right well I hope you\nguys enjoyed the segment.\n\n438\n00:22:08.062 --> 00:22:15.215\nStay tuned we've got more\nPowerShell coming up.\n\n",
          "vimeoId": "114693800"
        }
      ],
      "title": "Getting Started with PowerShell"
    },
    {
      "episodes": [
        {
          "description": "",
          "length": "1004",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-1-add-remove-roles-features-120514.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-1-add-remove-roles-features-120514-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-1-add-remove-roles-features-120514-sm.jpg",
          "title": "Add/Remove Roles and Features",
          "transcript": "1\n00:00:00,125 --> 00:00:08,236\n[MUSIC]\n\n2\n00:00:08,236 --> 00:00:12,268\nIn this segment, we're gonna take a look\nat how to add and remove Windows roles and\n\n3\n00:00:12,268 --> 00:00:14,640\nfeatures via the Powershell.\n\n4\n00:00:14,640 --> 00:00:16,720\nNow this is a pretty easy function.\n\n5\n00:00:16,720 --> 00:00:19,530\nI know a lot of you guys probably use the\nserver manager and go right in there and\n\n6\n00:00:19,530 --> 00:00:21,140\nadd whatever roles you want.\n\n7\n00:00:21,140 --> 00:00:25,740\nBut if you're trying to deploy large\nquantities of servers one of the easiest\n\n8\n00:00:25,740 --> 00:00:29,260\nthings to automate is having the basic\nroles and features installed.\n\n9\n00:00:29,260 --> 00:00:33,590\nWe can write a PowerShell Script\nthat not only deploys various roles\n\n10\n00:00:33,590 --> 00:00:34,190\nbut then goes on.\n\n11\n00:00:34,190 --> 00:00:37,060\nOn to configure them, and\nget them set the way we want.\n\n12\n00:00:37,060 --> 00:00:40,440\nSo whenever we deploy a new server, we\ncan just throw a windows server image on\n\n13\n00:00:40,440 --> 00:00:44,060\nthere, and then run a powershell\nscript and now we've got a DNS server.\n\n14\n00:00:44,060 --> 00:00:46,440\nOr run a powershell scrip and\nnow we've got an FTP server.\n\n15\n00:00:46,440 --> 00:00:49,500\nRun a powershell script and\nnow we've got our web server, right.\n\n16\n00:00:49,500 --> 00:00:53,670\nReally quick, really easy to set up and\nspawn; but the first step of that\n\n17\n00:00:53,670 --> 00:00:56,680\nis getting the right roles and\nfeatures in place, alright.\n\n18\n00:00:56,680 --> 00:00:59,410\nNow, the process I managed to get with\nthe Powershell is actually pretty easy.\n\n19\n00:00:59,410 --> 00:01:01,910\nThere's only a handful of commands\nthat we need to remember.\n\n20\n00:01:01,910 --> 00:01:04,520\nand the output of those\ncommands is pretty informative,\n\n21\n00:01:04,520 --> 00:01:07,650\nso this is one of the simpler\ntasks that we have to deal with.\n\n22\n00:01:07,650 --> 00:01:10,780\nBut, there's a lot of terminology in\nit that can be difficult to remember,\n\n23\n00:01:10,780 --> 00:01:13,330\nso I always rely on some of my\nget commands to pull that up.\n\n24\n00:01:13,330 --> 00:01:14,520\nAnd let me show you what I mean.\n\n25\n00:01:15,550 --> 00:01:20,030\nThe first command I want to show you is\nthe get dash Windows feature command.\n\n26\n00:01:20,030 --> 00:01:23,300\nNow I know we're talking\nabout roles in features, but\n\n27\n00:01:23,300 --> 00:01:26,330\nin the power shell it doesn't\ndiscriminate between the two.\n\n28\n00:01:26,330 --> 00:01:28,650\nIt treats roles and features the same way.\n\n29\n00:01:28,650 --> 00:01:31,320\nIn fact, all throughout Windows\nthey're treated the same way,\n\n30\n00:01:31,320 --> 00:01:35,610\nthe only difference is in the GUI\nthat we see in the server manager.\n\n31\n00:01:35,610 --> 00:01:40,170\nMicrosoft does that as a favor to us to\nsay if it's a role, that's a big deal.\n\n32\n00:01:40,170 --> 00:01:42,920\nThat's something that needs\nadditional configuration.\n\n33\n00:01:42,920 --> 00:01:44,950\nIf it's a feature, that's a minor thing.\n\n34\n00:01:44,950 --> 00:01:46,720\nProbably doesn't need\nconfiguration at all.\n\n35\n00:01:46,720 --> 00:01:51,035\nSo that's simply a separation they\nmake in the GUI, not on the back end.\n\n36\n00:01:51,035 --> 00:01:54,245\nSo, on the back end we'll never\nreally see that word role.\n\n37\n00:01:54,245 --> 00:01:55,705\nWe're always gonna see feature.\n\n38\n00:01:55,705 --> 00:01:58,995\nSo, pretty much everything is\ntreated as a feature back here and\n\n39\n00:01:58,995 --> 00:02:02,155\nif I do get dash Windows feature,\n\n40\n00:02:02,155 --> 00:02:06,870\nit's going to give me a list of all of the\nfeatures that are available to Windows.\n\n41\n00:02:06,870 --> 00:02:10,190\nAnd it lays them out in a nice\nlittle hierarchical view and\n\n42\n00:02:10,190 --> 00:02:15,420\nyou'll see how some of these have\nlittle xs to the left of them, right?\n\n43\n00:02:15,420 --> 00:02:18,720\nAnd that x is letting me know\nthat that one is installed and\n\n44\n00:02:18,720 --> 00:02:21,820\nthen after that some of them\nhave empty boxes to the left and\n\n45\n00:02:21,820 --> 00:02:24,870\nthat's letting me know that\nthey are not installed, right?\n\n46\n00:02:24,870 --> 00:02:27,850\nThere's really three different\nstatuses that we'll see here.\n\n47\n00:02:27,850 --> 00:02:30,530\nThere's installed so we've already got it.\n\n48\n00:02:30,530 --> 00:02:34,900\nThere's available which means\nit's on our hard drive but\n\n49\n00:02:34,900 --> 00:02:36,350\nit's in the protected storage.\n\n50\n00:02:36,350 --> 00:02:38,270\nWe haven't actually moved it out for use.\n\n51\n00:02:38,270 --> 00:02:41,580\nSo you can't use it yet but\nit is available if you want it.\n\n52\n00:02:41,580 --> 00:02:43,800\nThe third one is remove.\n\n53\n00:02:43,800 --> 00:02:46,470\nYou wont really see remove by default.\n\n54\n00:02:46,470 --> 00:02:50,980\nWhen you deploy a server all of\nthe installation files from Windows Server\n\n55\n00:02:50,980 --> 00:02:53,050\n2012 are copied along with it.\n\n56\n00:02:53,050 --> 00:02:55,780\nAnd you may not want that,\nyou may not want to have these\n\n57\n00:02:55,780 --> 00:02:58,600\nextra files sitting there because it\ncan increase your attack surface.\n\n58\n00:02:58,600 --> 00:03:03,170\nSo in high security environments,\nthey'll remove the installation files.\n\n59\n00:03:03,170 --> 00:03:07,620\nAnd if that happens, you'll see\nthe feature or roll listed here and\n\n60\n00:03:07,620 --> 00:03:09,588\nover here on it's status it will say,\nremoved.\n\n61\n00:03:09,588 --> 00:03:13,990\nAnd that let;s you know that it's not\ninstalled and if you ant to install it,\n\n62\n00:03:13,990 --> 00:03:17,670\nyou're gonna need to bring\nalong a Windows Media disc or\n\n63\n00:03:17,670 --> 00:03:20,915\nhave a network chair somewhere that has\nthe Windows installation files on it.\n\n64\n00:03:20,915 --> 00:03:23,840\n'Cause otherwise, we're not gonna\nbe able to get to it, all right?\n\n65\n00:03:23,840 --> 00:03:26,380\nSo those are the three statuses\nthat we'll see as long.\n\n66\n00:03:26,380 --> 00:03:28,830\nAs it's listed as available,\nwe can install it and\n\n67\n00:03:28,830 --> 00:03:29,950\nwe won't have to provide any media.\n\n68\n00:03:31,190 --> 00:03:33,940\nNow, this view does get\na little bit cluttered.\n\n69\n00:03:33,940 --> 00:03:37,140\nSo, one nice thing that we can do\nis we can filter it a good bit.\n\n70\n00:03:37,140 --> 00:03:40,390\nAnd the filtering,\nMicrosoft's actually anticipated this, so\n\n71\n00:03:40,390 --> 00:03:41,910\nthey created some shortcuts.\n\n72\n00:03:41,910 --> 00:03:45,890\nThe long way to filter this would\nbe to do like a crazy query.\n\n73\n00:03:45,890 --> 00:03:50,790\nBut if I just wanted to see what was\ninstalled, for example, the long form of\n\n74\n00:03:50,790 --> 00:03:56,460\nit would be to do Get-windowsFeature and\n\n75\n00:03:56,460 --> 00:04:00,820\nthen pipe that output into\na filter like where object.\n\n76\n00:04:00,820 --> 00:04:08,960\nSo I'll do where-object $_ and\nI'm gonna query the install state.\n\n77\n00:04:10,190 --> 00:04:15,550\nAnd I'm looking for where that install\nstate is listed as Installed, right?\n\n78\n00:04:15,550 --> 00:04:18,620\nSo there's my filter\njust showing me those.\n\n79\n00:04:18,620 --> 00:04:22,240\nWell now it's gonna give me a list and\nI'll see all the installed ones, right?\n\n80\n00:04:22,240 --> 00:04:26,230\nBut Microsoft knows that this is\na pretty common query and so they\n\n81\n00:04:26,230 --> 00:04:30,700\nactually made that kind of a default of\npart of the syntax in get WindowsFeature.\n\n82\n00:04:30,700 --> 00:04:35,930\nYou can just run get-WindowsFeature,\nwell if you can spell it.\n\n83\n00:04:35,930 --> 00:04:42,260\nThere, get-windowsFeature, and then you\ncan pipe that and say where install.\n\n84\n00:04:42,260 --> 00:04:46,920\nThe install status, that one's actually\nthe primary value for this table.\n\n85\n00:04:46,920 --> 00:04:50,610\nSo when we just say where install,\nit'll automatically do that and\n\n86\n00:04:50,610 --> 00:04:52,950\nbring it right up, and we can do that for\nthe other statuses too.\n\n87\n00:04:52,950 --> 00:04:57,420\nYou can say like where available and\nit'll bring those up and it'll show\n\n88\n00:04:57,420 --> 00:05:01,520\nthe ones that are available for install\nwhich apparently it didn't pull for me.\n\n89\n00:05:01,520 --> 00:05:05,650\nAll right,\nwell [LAUGH] one I actually do a little\n\n90\n00:05:05,650 --> 00:05:10,470\nmore often is I'll do -ne,\nso not equal to installed.\n\n91\n00:05:10,470 --> 00:05:12,600\nIn other words, show me all\nthe ones that aren't installed,\n\n92\n00:05:12,600 --> 00:05:15,340\nwhich apparently it didn't like that\none either, what have I done here?\n\n93\n00:05:15,340 --> 00:05:17,820\nOh, with that one because\nI'm doing a modifier,\n\n94\n00:05:17,820 --> 00:05:22,040\nI actually have to specify install\nstate as what I'm querying.\n\n95\n00:05:22,040 --> 00:05:24,800\nSo, where the install state\nis not equal to install then,\n\n96\n00:05:24,800 --> 00:05:29,820\nI'll bet that's why my available\nquery didn't work a minute ago, too.\n\n97\n00:05:29,820 --> 00:05:32,440\nSo, when you run these,\nthe aliases are nice,\n\n98\n00:05:32,440 --> 00:05:37,090\nthey make life a little bit more simple\nbut you have to remember what they are.\n\n99\n00:05:37,090 --> 00:05:38,470\nSo, that's the challenge there.\n\n100\n00:05:39,500 --> 00:05:40,670\nAll right,\nI went through those kind of quickly.\n\n101\n00:05:40,670 --> 00:05:42,590\nLet me just recap the commands that I did.\n\n102\n00:05:42,590 --> 00:05:47,140\nSo to pull the list of installed ones,\nI said get-windowsFeature, and\n\n103\n00:05:47,140 --> 00:05:49,430\nI typed that into where, install.\n\n104\n00:05:49,430 --> 00:05:54,590\nAll right, and then to get the ones that\nwere not installed I had to add a little\n\n105\n00:05:54,590 --> 00:05:59,400\nbit more to that and so I said where\nInstallState is not equal to Installed.\n\n106\n00:05:59,400 --> 00:06:02,458\nAnd that'll give me the ones that are\navailable and the ones that are removed.\n\n107\n00:06:02,458 --> 00:06:05,010\nSo it kinda breaks that out for\nus and we can see it.\n\n108\n00:06:05,010 --> 00:06:10,250\nSo those are available, more commonly\nthough, I'm not looking for all of them.\n\n109\n00:06:10,250 --> 00:06:12,140\nI'm looking for a particular feature.\n\n110\n00:06:12,140 --> 00:06:15,530\nI might be just interested\nin one particular thing.\n\n111\n00:06:15,530 --> 00:06:19,200\nSo I might do something\nlike get-windowsfeature and\n\n112\n00:06:19,200 --> 00:06:23,710\nthen specify a particular\nfeature like DHCP and\n\n113\n00:06:23,710 --> 00:06:26,290\nnow it's gonna bring back\nthat DHCP server, right.\n\n114\n00:06:26,290 --> 00:06:31,080\nSo there it is, that's the one and\nyou can actually do some wild-carding\n\n115\n00:06:31,080 --> 00:06:34,080\nin here to pull up other ones,\ncuz there might be more than one.\n\n116\n00:06:34,080 --> 00:06:38,210\nFor example there's the DHCP server,\nand then there's the DHCP tools for\n\n117\n00:06:38,210 --> 00:06:40,575\nmanaging it that are part of the RSAT,\nright?\n\n118\n00:06:40,575 --> 00:06:43,915\nSo when I added those\nasterisks around DHCP that\n\n119\n00:06:43,915 --> 00:06:46,615\nhelped me see all of the stuff\nthat's involved with DHCP.\n\n120\n00:06:46,615 --> 00:06:49,445\nThe only problem with that is it\ndoesn't really show the hierarchy.\n\n121\n00:06:49,445 --> 00:06:53,080\nSo like DHCP server tools\nhere is a part of the RSAT.\n\n122\n00:06:53,080 --> 00:06:57,460\nSo if I wanted to add it, I have to\nkind of work through that process.\n\n123\n00:06:57,460 --> 00:07:01,000\nBut you can install it or remove it just\nby using this shortcut name right here.\n\n124\n00:07:01,000 --> 00:07:02,650\nSo that's really all you need.\n\n125\n00:07:02,650 --> 00:07:05,410\nSo we don't necessarily\nneed to see the hierarchy\n\n126\n00:07:05,410 --> 00:07:06,740\nin order to add that particular value.\n\n127\n00:07:06,740 --> 00:07:10,940\nAnd that leads us to the next part is if\nwe want to install it, like if I want to\n\n128\n00:07:10,940 --> 00:07:15,760\nbe a DHCP server I can see it's available,\nI haven't installed it, I can add it now.\n\n129\n00:07:15,760 --> 00:07:19,830\nLet's start with something really\nsimple like the Telnet Client.\n\n130\n00:07:19,830 --> 00:07:24,410\nThe Telnet Client used to be installed\nin Windows by default, so you used to be\n\n131\n00:07:24,410 --> 00:07:28,890\nable to type Telnet and provide a host and\nconnect to it and you'll see it's not\n\n132\n00:07:28,890 --> 00:07:32,210\ninstalled by default anymore because,\nwell because Telnet sucks.\n\n133\n00:07:32,210 --> 00:07:36,160\nBut we do still need it sometimes,\nright, so if you want to install it,\n\n134\n00:07:36,160 --> 00:07:37,290\nit is available.\n\n135\n00:07:37,290 --> 00:07:40,080\nSo if we do get-WindowsFeature and\n\n136\n00:07:40,080 --> 00:07:43,030\nwe search for\nanything with the word Telnet in it.\n\n137\n00:07:43,030 --> 00:07:45,600\nWe'll see that we've got the telnet\nclient and the telnet server,\n\n138\n00:07:45,600 --> 00:07:46,910\nthey're both available.\n\n139\n00:07:46,910 --> 00:07:49,722\nAll I really care about on\nthis screen are the names.\n\n140\n00:07:49,722 --> 00:07:52,570\nI wanna know the name so\nI can install these.\n\n141\n00:07:52,570 --> 00:07:59,740\nAnd when you go to install,\nyou just say add-windowsFeature and\n\n142\n00:07:59,740 --> 00:08:01,680\nthen you specify what you want to install.\n\n143\n00:08:01,680 --> 00:08:05,850\nI wanna install the Telnet client, right?\n\n144\n00:08:05,850 --> 00:08:07,810\nSo I'll run that and\nit's gonna go and install it.\n\n145\n00:08:07,810 --> 00:08:10,300\nIt's available so I've already\ngot the installation files and\n\n146\n00:08:10,300 --> 00:08:13,850\nit's gonna bring it in and\nI don't have permissions, all right?\n\n147\n00:08:13,850 --> 00:08:16,600\nWell, I am an administrator\non this system.\n\n148\n00:08:16,600 --> 00:08:19,490\nBut I didn't run my power shell\nwith administrative privileges.\n\n149\n00:08:19,490 --> 00:08:20,640\nSo it's, flagging me on that.\n\n150\n00:08:20,640 --> 00:08:26,040\nSo I'm gonna copy that and\nI'm gonna relaunch my power shell\n\n151\n00:08:26,040 --> 00:08:29,900\nas an administrator this time.\n\n152\n00:08:29,900 --> 00:08:35,240\nAnd once that's done, now I can rerun that\ncommand and this time it'll be happy.\n\n153\n00:08:35,240 --> 00:08:38,400\nSo you do have to be an administrator to\nadd this stuff, in the GUI it would have\n\n154\n00:08:38,400 --> 00:08:42,840\njust prompted me, but here in Poweshell I\nactually have to relaunch the shell.\n\n155\n00:08:42,840 --> 00:08:45,750\nAnd once that's done I'll\nhave the Telnet client.\n\n156\n00:08:45,750 --> 00:08:48,660\nIt will be installed and\nbe available to run.\n\n157\n00:08:48,660 --> 00:08:52,560\nIf I'm installing a role, something like\nthe active director domain services,\n\n158\n00:08:52,560 --> 00:08:55,930\nthen there's usually follow\nconfigurations that I need to do.\n\n159\n00:08:55,930 --> 00:08:59,000\nBut in this case, it installed,\nI can see it's successful.\n\n160\n00:08:59,000 --> 00:09:01,870\nIt's not pending a reboot, so\n\n161\n00:09:01,870 --> 00:09:03,960\nthat means I'm good,\nI don't have to do anything else.\n\n162\n00:09:03,960 --> 00:09:07,610\nIf it says yes there, then that means I\nneed to reboot for it to take effect, and\n\n163\n00:09:07,610 --> 00:09:08,780\nso I could reboot.\n\n164\n00:09:08,780 --> 00:09:12,980\nIf you want that to be automatic,\nyou can add it to the end like this,\n\n165\n00:09:12,980 --> 00:09:17,130\nyou can say, -restart and\nthen after it adds it, if this is a yes,\n\n166\n00:09:17,130 --> 00:09:19,520\nit'll restart, if this is a no,\nthen it won't restart.\n\n167\n00:09:19,520 --> 00:09:22,240\nSo you can actually always\nhave restart there.\n\n168\n00:09:22,240 --> 00:09:24,720\nBut you might wanna schedule that\nrestart for a later time, so\n\n169\n00:09:24,720 --> 00:09:25,550\nthat's why it's not the default.\n\n170\n00:09:25,550 --> 00:09:29,170\nAll right, so I should have that client.\n\n171\n00:09:29,170 --> 00:09:33,140\nIf I go back to my command prompt here,\nand I try and telnet again, now I can see\n\n172\n00:09:33,140 --> 00:09:36,660\nthat Telnet client is actually there and\nworking, it's been installed.\n\n173\n00:09:40,180 --> 00:09:44,280\nNow when I automate something like this,\nlike if I'm rolling out a web server or\n\n174\n00:09:44,280 --> 00:09:47,600\nwhatever and I'm writing a script\nthat automates the deployment of it.\n\n175\n00:09:47,600 --> 00:09:51,120\nI'll typically need to install\nmore than one roller feature.\n\n176\n00:09:51,120 --> 00:09:54,780\nAnd if you need to do that, you don't\nhave to run the command more than once.\n\n177\n00:09:54,780 --> 00:09:57,720\nYou can actually install more than\none feature at the same time.\n\n178\n00:09:58,730 --> 00:10:04,590\nSo for example, if I want to install DNS\nand WINS, I wanna install both, rIght?\n\n179\n00:10:04,590 --> 00:10:09,780\nWell, I can find those features like DNS,\n\n180\n00:10:09,780 --> 00:10:12,820\nwhich is actually just called DNS and\nWINS which is called WINS.\n\n181\n00:10:12,820 --> 00:10:14,610\nSo, I already know their names.\n\n182\n00:10:14,610 --> 00:10:20,122\nAnd if I want to add them, I can just\ndo add dash windows feature- DNA comma,\n\n183\n00:10:20,122 --> 00:10:25,170\nWINS, Telnet-dash-server- however many I\n\n184\n00:10:25,170 --> 00:10:29,720\nneed- I can go through and specify those,\nand it's gonna install them, all right?\n\n185\n00:10:29,720 --> 00:10:33,110\nNow notice up here the DNS for\nme is already installed.\n\n186\n00:10:33,110 --> 00:10:35,300\nI'm already a DNS server, right?\n\n187\n00:10:35,300 --> 00:10:37,940\nSo, what's gonna happen\nif I run this again?\n\n188\n00:10:37,940 --> 00:10:42,740\nNothing, so, it's just gonna say no change\nneeded, and move on to the next ones.\n\n189\n00:10:42,740 --> 00:10:45,570\nSo it will install the other\nones that I'm missing, and\n\n190\n00:10:45,570 --> 00:10:47,340\nI'll skip over the ones\nthat are already there.\n\n191\n00:10:47,340 --> 00:10:49,370\nSo if you've got a PowerShell script, and\n\n192\n00:10:49,370 --> 00:10:51,700\none of the things that you wanna\ndo is check the prerequisites.\n\n193\n00:10:51,700 --> 00:10:53,390\nAre these roles installed,\nand if they're not,\n\n194\n00:10:53,390 --> 00:10:57,100\ninstall them, you could skip the check and\nsay go ahead and add it.\n\n195\n00:10:57,100 --> 00:10:59,830\nCuz if it's already there,\nit just leaves it be, all right?\n\n196\n00:10:59,830 --> 00:11:01,150\nSo when I run this,\n\n197\n00:11:01,150 --> 00:11:05,050\nit's gonna install those three,\nwell they're not all roles, right?\n\n198\n00:11:05,050 --> 00:11:07,930\nDNS is a role, but WINS is a feature,\nand Telnet is a feature.\n\n199\n00:11:07,930 --> 00:11:12,000\nSo it's gonna add those in And the DNS\none, it's gonna skip right past that,\n\n200\n00:11:12,000 --> 00:11:14,180\nand then it's gonna do WINS and Telnet.\n\n201\n00:11:14,180 --> 00:11:17,800\nSo here I can see I had success and\nnotice the feature result.\n\n202\n00:11:17,800 --> 00:11:19,310\nJust Telnet server and WINS.\n\n203\n00:11:19,310 --> 00:11:22,610\nIt left out DNS because\nit didnt have to do it.\n\n204\n00:11:22,610 --> 00:11:26,800\nIf I had run DNS just by itself\nIf I just take those guys out and\n\n205\n00:11:26,800 --> 00:11:30,340\njust do DNS then here's where\nit tells me no change needed.\n\n206\n00:11:30,340 --> 00:11:34,220\nThat's the exit code, I got exit code\nof success here because it installed on\n\n207\n00:11:34,220 --> 00:11:36,650\nthe other one so\nthat's why I didn't see that.\n\n208\n00:11:36,650 --> 00:11:40,870\nBut that's what it did, it's installed\nthe roll, I've now got that functionality.\n\n209\n00:11:40,870 --> 00:11:43,480\nI've got WINS and telnet server and\n\n210\n00:11:43,480 --> 00:11:47,240\nall that other good stuff and I can go\nin and I can start to manage those.\n\n211\n00:11:48,390 --> 00:11:51,790\nHopefully, none of you guys\nhave any WIN Servers anymore.\n\n212\n00:11:51,790 --> 00:11:54,600\nBut if you do, then here's our tool.\n\n213\n00:11:54,600 --> 00:11:55,100\nWonderful.\n\n214\n00:11:56,290 --> 00:12:00,360\nSo pretty easy to add those roles in and\nget them in place.\n\n215\n00:12:00,360 --> 00:12:02,650\nNot anything too spectacular there.\n\n216\n00:12:02,650 --> 00:12:07,060\nI'm trying launch my wins panel, it's\nbeen so long since I've gone in there.\n\n217\n00:12:07,060 --> 00:12:10,610\nOh, did I not install, oh,\n\n218\n00:12:10,610 --> 00:12:13,550\nI had to have installed\nthe management tool for it, right?\n\n219\n00:12:13,550 --> 00:12:18,060\nWell, anyhow,\nwe can always do get dash command,\n\n220\n00:12:18,060 --> 00:12:22,340\nand look for any, actually wins is\nnot power shell enabled, is it?\n\n221\n00:12:23,480 --> 00:12:24,900\nNope, it sure isn't.\n\n222\n00:12:24,900 --> 00:12:27,160\nSo I see the WINS application is there but\n\n223\n00:12:27,160 --> 00:12:30,610\nthey never added any PowerShell commands\nfor it cuz it's so old and pointless.\n\n224\n00:12:30,610 --> 00:12:34,360\nSame thing with Telnet,\nbut yeah, they are there.\n\n225\n00:12:34,360 --> 00:12:36,120\nThey're available, they're working.\n\n226\n00:12:36,120 --> 00:12:36,880\nAnd now I can go and use them.\n\n227\n00:12:36,880 --> 00:12:41,370\nAll right if we wanna get rid of\na feature, if we wanna uninstall it.\n\n228\n00:12:41,370 --> 00:12:45,870\nWell, to add it,\nwe use the add dash Windows feature and,\n\n229\n00:12:45,870 --> 00:12:47,700\nto remove it, we just use remove.\n\n230\n00:12:47,700 --> 00:12:50,130\nAnd it's the same thing,\nwe just specify the name, so,\n\n231\n00:12:50,130 --> 00:12:53,090\nif I don't want wins\nanymore I can do remove.\n\n232\n00:12:53,090 --> 00:12:58,040\nAnd, actually you know, before I do that,\nlet's just verify, I'm gonna do get dash.\n\n233\n00:12:58,040 --> 00:13:04,740\nWindowsFeature WINS, just to verify\nthat it does show up as installed.\n\n234\n00:13:04,740 --> 00:13:07,500\nI can see its installed state right\nthere as showing as installed.\n\n235\n00:13:07,500 --> 00:13:08,730\nI know it's good.\n\n236\n00:13:08,730 --> 00:13:15,080\nAnd, now I can do Remove-WindowsFeature\nWINS, and it's gonna remove it.\n\n237\n00:13:15,080 --> 00:13:17,670\nAnd when it's done, it will let me know\nthat it's gone and then I can only\n\n238\n00:13:17,670 --> 00:13:21,920\nquery it again with Get-WindowsFeature to\nverify that it is actually gone, right?\n\n239\n00:13:21,920 --> 00:13:24,210\nIt's a good idea to check that stuff.\n\n240\n00:13:24,210 --> 00:13:24,970\nSo, we'll let that run.\n\n241\n00:13:24,970 --> 00:13:25,970\nShouldn't take too terribly long.\n\n242\n00:13:25,970 --> 00:13:26,730\nThere we go.\n\n243\n00:13:26,730 --> 00:13:29,645\nIt is telling me that I need\nto do a restart, right?\n\n244\n00:13:29,645 --> 00:13:32,455\nSo, it's not actually gone yet.\n\n245\n00:13:32,455 --> 00:13:38,065\nIt succeeded, but a restart is necessary\nand so if I pull up that feature,\n\n246\n00:13:38,065 --> 00:13:42,370\nthe feature status Uninstall pending,\nright?\n\n247\n00:13:42,370 --> 00:13:45,420\nSo I've done the uninstall,\nbut it's not complete.\n\n248\n00:13:45,420 --> 00:13:47,508\nIt may still be running,\nI'll need to do a reboot.\n\n249\n00:13:47,508 --> 00:13:53,260\n[COUGH] All right, so those are some of\nthe basic things that we need to do there.\n\n250\n00:13:53,260 --> 00:13:58,690\nNow, I do want to mention one other thing\nI've done all of this from a server and\n\n251\n00:13:58,690 --> 00:14:00,140\non a Windows Server machine.\n\n252\n00:14:00,140 --> 00:14:02,060\nWindows Server 2012 or Server 2008,\n\n253\n00:14:02,060 --> 00:14:04,960\nthey've got all the various\ncommandlets that I just used.\n\n254\n00:14:06,300 --> 00:14:11,940\nBut if you're running the Powershell on\na Windows 7 or Windows 8 workstation.\n\n255\n00:14:11,940 --> 00:14:15,390\nThey don't have all the server\ncommandlets by default, all right?\n\n256\n00:14:15,390 --> 00:14:20,370\nSo if you've installed the RSAT,\nthe remote server administration tools on\n\n257\n00:14:20,370 --> 00:14:24,450\nyour system, then you'll likely have\nall these and it'll work just fine.\n\n258\n00:14:24,450 --> 00:14:27,320\nBut if you haven't installed the RSAT,\nthen it might not work, so\n\n259\n00:14:27,320 --> 00:14:29,590\nyou might get that some of these\ncommandlets are not available.\n\n260\n00:14:29,590 --> 00:14:31,570\nAnd installing the RSAT\ntakes care of that.\n\n261\n00:14:31,570 --> 00:14:35,460\nInstalling the server manager,\nthat's the real big piece in the RSAT.\n\n262\n00:14:35,460 --> 00:14:38,430\nThat's what's gonna take care of that and\ngive you that functionality, all right.\n\n263\n00:14:38,430 --> 00:14:39,600\nBut you can always double check it.\n\n264\n00:14:39,600 --> 00:14:41,800\nYou might need to import the module for\nthat.\n\n265\n00:14:41,800 --> 00:14:46,850\nDo I have that written down?\n\n266\n00:14:46,850 --> 00:14:47,710\nHere, I'll just test.\n\n267\n00:14:47,710 --> 00:14:49,720\nI think I remember it offhand.\n\n268\n00:14:49,720 --> 00:14:52,490\nIf we do Import Module,\nI think it's just called ServerManager.\n\n269\n00:14:53,560 --> 00:14:54,500\nYeah, that's it.\n\n270\n00:14:54,500 --> 00:14:57,590\nSo, if you're on a workstation,\non a client machine, and\n\n271\n00:14:57,590 --> 00:15:01,130\nsome of those applets weren't there,\nthe Windows Feature applets.\n\n272\n00:15:01,130 --> 00:15:04,350\nIf they weren't there, you can run\nImport-Module ServerManager, and\n\n273\n00:15:04,350 --> 00:15:06,620\nthat's what's going to\nactivate those commands.\n\n274\n00:15:06,620 --> 00:15:08,360\nBut you've got to have\nthe Server Manager available, so\n\n275\n00:15:08,360 --> 00:15:12,030\nthat means you've got to have\nthe RSAT installed on your system.\n\n276\n00:15:12,030 --> 00:15:14,580\nSo I just wanted to throw that one out\nthere in case you bump into some of these\n\n277\n00:15:14,580 --> 00:15:16,640\ncommands not working for you.\n\n278\n00:15:16,640 --> 00:15:20,840\nNormally when I do stuff like this, I'm\nautomating something on a server, and so\n\n279\n00:15:20,840 --> 00:15:23,430\nI know those command words are already\nthere, I don't have to add them.\n\n280\n00:15:25,320 --> 00:15:29,610\nAll right, so that's basically it,\nI don't have too much more to say on it.\n\n281\n00:15:29,610 --> 00:15:34,800\nJust remember that get dash Windows\nFeature is a really handy command because\n\n282\n00:15:34,800 --> 00:15:37,540\nif you're anything like me, you can't\nremember the names of half of these\n\n283\n00:15:37,540 --> 00:15:41,660\nthings, and Microsoft is very specific\nabout the name you want to use.\n\n284\n00:15:41,660 --> 00:15:45,590\nSo, in the output for\nGet -WindowsFeature, you're looking for\n\n285\n00:15:45,590 --> 00:15:49,970\nthis column right here in the middle,\nthis column that's the name Because that's\n\n286\n00:15:49,970 --> 00:15:54,280\nthe one that's gonna help you find what\nyou should be typing into your command.\n\n287\n00:15:54,280 --> 00:15:56,230\nAnd sometimes the names\nare very different.\n\n288\n00:15:56,230 --> 00:15:58,050\nThat's where it gets really challenging.\n\n289\n00:15:58,050 --> 00:16:01,870\nWhen you look at something like this guy\nright here, Identity Federation Support.\n\n290\n00:16:01,870 --> 00:16:05,720\nBut then it's actually called\nADRMS-Identity, right?\n\n291\n00:16:05,720 --> 00:16:07,940\nSo how do we know what that name is?\n\n292\n00:16:07,940 --> 00:16:10,030\nAnd normally they're at least close.\n\n293\n00:16:10,030 --> 00:16:14,560\nBut some of them aren't, some of them\nare really a good bit different, so So you\n\n294\n00:16:14,560 --> 00:16:18,280\nbasically just have to go in here, find\nthat value and bring it in from there.\n\n295\n00:16:19,820 --> 00:16:22,760\nAll right, so that's about it for\nroles and features.\n\n296\n00:16:22,760 --> 00:16:26,800\nIn this segment, we got a chance to see\nhow to add Windows roles and features.\n\n297\n00:16:26,800 --> 00:16:28,290\nWe saw how to query their status and\n\n298\n00:16:28,290 --> 00:16:32,160\nthen ultimately remove them if we were\ndone, pretty straightforward process.\n\n299\n00:16:32,160 --> 00:16:33,200\nNothing too challenging there.\n\n300\n00:16:33,200 --> 00:16:35,950\nAll right I hope you guys\nenjoyed this segment.\n\n301\n00:16:35,950 --> 00:16:40,982\nStay tuned,\nwe've got more Powershell coming up.\n\n302\n00:16:40,982 --> 00:16:44,829\n[SOUND]\n\n",
          "vimeoId": "114693799"
        },
        {
          "description": "",
          "length": "1682",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-2-working-with-disks-120514.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-2-working-with-disks-120514-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-2-working-with-disks-120514-sm.jpg",
          "title": "Working With Disks",
          "transcript": "1\n00:00:00,008 --> 00:00:08,004\n[MUSIC]\n\n2\n00:00:08,004 --> 00:00:11,532\nIn this segment we're gonna take\na look at managing our disks, and\n\n3\n00:00:11,532 --> 00:00:13,170\nvolumes with the PowerShell.\n\n4\n00:00:13,170 --> 00:00:17,404\nNow, for most of us, when we go to manage\nour hard drives inside of Windows Server,\n\n5\n00:00:17,404 --> 00:00:20,330\nor Windows desktop, Windows 7, Windows 8.\n\n6\n00:00:20,330 --> 00:00:22,350\nWe typically use the computer\nmanagement tool,\n\n7\n00:00:22,350 --> 00:00:23,530\nto go under the disc management tool.\n\n8\n00:00:23,530 --> 00:00:26,450\nWe've got a nice little\nGUI to manage everything.\n\n9\n00:00:26,450 --> 00:00:28,250\nIf we want to automate, or script thing.\n\n10\n00:00:28,250 --> 00:00:31,220\nWe have a command line you\ngo to called disc part.\n\n11\n00:00:31,220 --> 00:00:34,790\nAnd those are perfectly adequate tools\nthat do everything that we need.\n\n12\n00:00:34,790 --> 00:00:39,760\nBut Powershell has the full capabilities\nof managing our disks and volumes also.\n\n13\n00:00:39,760 --> 00:00:43,450\nSo, there's a lot that we can do\nright from inside of the Powershell.\n\n14\n00:00:43,450 --> 00:00:46,310\nThat doesn't require the use\nof those external tools.\n\n15\n00:00:46,310 --> 00:00:47,300\nAnd that's very handy.\n\n16\n00:00:47,300 --> 00:00:50,230\nBecause you might be automating\nthe deployment of a server.\n\n17\n00:00:50,230 --> 00:00:55,980\nWhere storage is provided on a SAN, and\nthe server is going to see that storage.\n\n18\n00:00:55,980 --> 00:00:57,650\nAnd it just needs to provision it out.\n\n19\n00:00:57,650 --> 00:01:01,640\nCreate a partition, format it, give it\na drive letter, and make it available.\n\n20\n00:01:01,640 --> 00:01:04,110\nSo that's what we're going to\nlook at here in this segment.\n\n21\n00:01:04,110 --> 00:01:05,970\nHow we manage those disc volumes.\n\n22\n00:01:05,970 --> 00:01:07,860\nFrom inside of the Powershell.\n\n23\n00:01:07,860 --> 00:01:10,360\nSo let's start by diving\ninto our Powershell.\n\n24\n00:01:10,360 --> 00:01:14,430\nAnd covering just some few basic\ncommands that we need to be aware of.\n\n25\n00:01:14,430 --> 00:01:15,250\nAnd you know what?\n\n26\n00:01:15,250 --> 00:01:17,490\nI've made my prompt really tiny here.\n\n27\n00:01:17,490 --> 00:01:18,560\nSo let me.\n\n28\n00:01:18,560 --> 00:01:19,860\nLet me bump that up really quick.\n\n29\n00:01:19,860 --> 00:01:22,020\nSo it's something we can actually read.\n\n30\n00:01:22,020 --> 00:01:25,940\nAs opposed to the microscopic\nthing that I've got on the screen.\n\n31\n00:01:25,940 --> 00:01:28,900\nAnd what we're gonna do is\nwe're gonna dive in here and\n\n32\n00:01:28,900 --> 00:01:30,550\njust kinda mess around with some things.\n\n33\n00:01:30,550 --> 00:01:33,760\nThe first command that I wanna\ndo is simply querying what\n\n34\n00:01:33,760 --> 00:01:35,820\ndisks are on my system.\n\n35\n00:01:35,820 --> 00:01:40,300\nSo I can do a Get-Disk, and\n\n36\n00:01:40,300 --> 00:01:43,590\nthat will give me a list of\nthe disks that are in my system.\n\n37\n00:01:43,590 --> 00:01:46,790\nNow if you get an error like I did.\n\n38\n00:01:46,790 --> 00:01:50,230\nIt usually means that you launched\nthe PowerShell not as an administrator.\n\n39\n00:01:50,230 --> 00:01:53,180\nSo I just launched it as a regular user,\nand I'm getting permission denied.\n\n40\n00:01:53,180 --> 00:01:56,670\nSo I'm going to relaunch that PowerShell\nas an administrator this time.\n\n41\n00:01:57,790 --> 00:02:03,880\nAnd we'll do Get-Disk a second time,\nand hopefully have some better results.\n\n42\n00:02:03,880 --> 00:02:06,965\nNow that little query that\nit runs in the background.\n\n43\n00:02:06,965 --> 00:02:09,135\nIt is querying the virtual disc service,\n\n44\n00:02:09,135 --> 00:02:12,965\nand it can take it a moment to render\nthat and display it on screen.\n\n45\n00:02:12,965 --> 00:02:16,035\nBut mine jumped up here, and\nit's showing me that I've got two discs.\n\n46\n00:02:16,035 --> 00:02:18,055\nNow I'm running this on top of VMWare.\n\n47\n00:02:18,055 --> 00:02:20,030\nSo it's showing them as VMWare discs.\n\n48\n00:02:20,030 --> 00:02:23,750\nIn real life land, you'll usually see\nthat Seagate, or Western Digital, or\n\n49\n00:02:23,750 --> 00:02:25,860\nwhatever other name you've\nassociated with it.\n\n50\n00:02:25,860 --> 00:02:30,100\nUnless it's on a SAN,\nin which case you might see a one ID or\n\n51\n00:02:30,100 --> 00:02:31,000\nsomething of that nature.\n\n52\n00:02:31,000 --> 00:02:33,620\nSo you could see any number of\nthings under friendly name.\n\n53\n00:02:33,620 --> 00:02:35,540\nBut the important parts\nthat we worry about,\n\n54\n00:02:35,540 --> 00:02:37,370\nare things like the number over here.\n\n55\n00:02:37,370 --> 00:02:40,110\nWhich we'll need to know if\nwe're gonna modify these.\n\n56\n00:02:40,110 --> 00:02:42,910\nThe operational status,\nwhether it's online or offline,\n\n57\n00:02:42,910 --> 00:02:46,060\nand then lastly the size and formatting.\n\n58\n00:02:46,060 --> 00:02:49,610\nSo this first disc that it found\nis 60GB in size and it's MBR.\n\n59\n00:02:49,610 --> 00:02:54,310\nIt's using the master boot\nrecordm as opposed to like GPT.\n\n60\n00:02:56,610 --> 00:02:59,700\nThey're the new partitioning\ntable format in Windows.\n\n61\n00:02:59,700 --> 00:03:01,450\nThe bottom window says RAW.\n\n62\n00:03:01,450 --> 00:03:05,900\nAnd RAW is what we'll see when we\nhave a disk that has no format.\n\n63\n00:03:05,900 --> 00:03:08,440\nThis is a brand new disk\nit has no partitions on it.\n\n64\n00:03:08,440 --> 00:03:10,760\nIt's actually unusable the way that it is.\n\n65\n00:03:10,760 --> 00:03:15,290\nIn fact if I launch explorer,\nwhat I expect to see is a C drive, there.\n\n66\n00:03:15,290 --> 00:03:17,050\nAnd I don't see any other drives.\n\n67\n00:03:17,050 --> 00:03:20,943\nAnd that's because this one has\nno format on it, t's just RAW.\n\n68\n00:03:20,943 --> 00:03:26,880\nNow, Get-Disk will list your physical\ndisks, and your virtual disks.\n\n69\n00:03:26,880 --> 00:03:30,870\nRemember in Windows server 2012,\nand Windows 7, Windows 8.\n\n70\n00:03:30,870 --> 00:03:33,440\nYou can create virtual hard disks.\n\n71\n00:03:33,440 --> 00:03:36,230\nAnd you can mount those, and\nthey show up like regular disks.\n\n72\n00:03:36,230 --> 00:03:38,150\nGet dash disk will show those.\n\n73\n00:03:38,150 --> 00:03:40,600\nIf you have CD drives that are mounted,\nif you have a CD in there,\n\n74\n00:03:40,600 --> 00:03:41,830\nit can show those, too.\n\n75\n00:03:41,830 --> 00:03:43,820\nSo you do get a little bit\nof a mixture of things.\n\n76\n00:03:43,820 --> 00:03:48,180\nAnd as a result Microsoft decided to\noffer a couple of extra commands,\n\n77\n00:03:48,180 --> 00:03:50,720\nlike Get-PhysicalDisk.\n\n78\n00:03:50,720 --> 00:03:52,870\nWhen I add that,\nnow it's just gonna look for\n\n79\n00:03:52,870 --> 00:03:55,500\nthe ones that are actual\nphysical disks on the system.\n\n80\n00:03:55,500 --> 00:03:59,300\nAnd exclude other things like VHDs,\nthe virtual hard drives.\n\n81\n00:03:59,300 --> 00:04:03,690\nIf I change that to Get-VirtualDisk.\n\n82\n00:04:03,690 --> 00:04:05,130\nWell, now it's gonna\nshow the virtual disks.\n\n83\n00:04:05,130 --> 00:04:06,180\nI don't have any.\n\n84\n00:04:06,180 --> 00:04:08,200\nSo we've got a few variations.\n\n85\n00:04:08,200 --> 00:04:11,040\nNow I don't normally use these two\ncommands, I'm showing them here just for\n\n86\n00:04:11,040 --> 00:04:12,030\ncompleteness.\n\n87\n00:04:12,030 --> 00:04:15,530\nBut most of the systems that I work on,\nand most of the systems, in general,\n\n88\n00:04:15,530 --> 00:04:17,010\ndon't have a ton of hard drives.\n\n89\n00:04:17,010 --> 00:04:20,770\nSo Get-Disk isn't gonna give you\nan overwhelming amount of data.\n\n90\n00:04:20,770 --> 00:04:24,110\nUnless you happen to have a ton of\ndrives attached for some reason.\n\n91\n00:04:24,110 --> 00:04:26,820\nAnd that's where we can\nstart to filter it down.\n\n92\n00:04:26,820 --> 00:04:28,990\nBut get-disk,\nthat's just how we see what's there.\n\n93\n00:04:28,990 --> 00:04:30,840\nWe're looking for\nthe discs that are on our system.\n\n94\n00:04:32,730 --> 00:04:37,440\nWhen you format a disc, when you erase it,\nlayout a partition, format it and\n\n95\n00:04:37,440 --> 00:04:38,530\ngive it a letter.\n\n96\n00:04:38,530 --> 00:04:39,900\nThat changes things.\n\n97\n00:04:39,900 --> 00:04:41,260\nYou've got the physical disk.\n\n98\n00:04:41,260 --> 00:04:44,150\nBut now you've got a volume that\nyou've created on top of it.\n\n99\n00:04:44,150 --> 00:04:47,260\nAnd if you wanna see those,\nthat's a little different.\n\n100\n00:04:47,260 --> 00:04:50,580\nUp here it's just telling me this drive\nexists, and that's the size of it.\n\n101\n00:04:50,580 --> 00:04:53,570\nBut that drive could be divided\ninto two or three partitions.\n\n102\n00:04:53,570 --> 00:04:56,280\nI wouldn't see that with Get-Disk,\nit doesn't show that.\n\n103\n00:04:56,280 --> 00:04:57,080\nRight.\n\n104\n00:04:57,080 --> 00:04:59,990\nBut if I take a look at the volumes,\nI will.\n\n105\n00:04:59,990 --> 00:05:03,460\nAnd we've got the get-volume command.\n\n106\n00:05:03,460 --> 00:05:08,280\nAnd when I run that, that's gonna show me\nthe actual volumes that are in my system.\n\n107\n00:05:08,280 --> 00:05:10,340\nAnd if you look at\nthe ones that come back.\n\n108\n00:05:10,340 --> 00:05:12,930\nWell I'll see a few\ndifferent things in here.\n\n109\n00:05:12,930 --> 00:05:17,930\nI've got my C drive,\nmy A drive, my D drive.\n\n110\n00:05:17,930 --> 00:05:18,950\nMy A and D.\n\n111\n00:05:18,950 --> 00:05:22,610\nA is a virtual floppy disk and\nD is a CD ROM drive.\n\n112\n00:05:22,610 --> 00:05:23,980\nNeither one is mounted.\n\n113\n00:05:23,980 --> 00:05:25,380\nSo that there is nothing in them.\n\n114\n00:05:25,380 --> 00:05:28,260\nSo they are basically empty\nthey have no file system.\n\n115\n00:05:28,260 --> 00:05:29,020\nIt says they are healthy.\n\n116\n00:05:29,020 --> 00:05:30,830\nBut they are not actually doing anything.\n\n117\n00:05:30,830 --> 00:05:34,490\nBut here I can see a fix drive.\n\n118\n00:05:34,490 --> 00:05:35,100\nDrive C.\n\n119\n00:05:35,100 --> 00:05:37,290\nThat's formatted NTFS.\n\n120\n00:05:37,290 --> 00:05:39,370\nIt's 40 gigs used, 60 gigs total.\n\n121\n00:05:39,370 --> 00:05:41,060\nThat's my actual volume.\n\n122\n00:05:41,060 --> 00:05:44,570\nIf my physical disc was divided into more\nthan one partition, I'd see it here.\n\n123\n00:05:44,570 --> 00:05:46,480\nI'd see each of those discs listed.\n\n124\n00:05:46,480 --> 00:05:49,540\nThat we're building up the individual\npartitions on the disk.\n\n125\n00:05:49,540 --> 00:05:50,200\nAll right.\n\n126\n00:05:50,200 --> 00:05:52,130\nBut in my case I just see the C drive.\n\n127\n00:05:52,130 --> 00:05:54,610\nNow, it doesn't alphabetize these.\n\n128\n00:05:54,610 --> 00:05:56,630\nIt actually lays them out\nkind of in a weird order.\n\n129\n00:05:56,630 --> 00:06:00,870\nSo one of the things I like to do,\nis add a little extra to that.\n\n130\n00:06:00,870 --> 00:06:05,200\nAnd say sort object, driver letter.\n\n131\n00:06:05,200 --> 00:06:07,760\nAnd that way it sorts it and\nthrows it back by drive letter.\n\n132\n00:06:07,760 --> 00:06:10,530\nIf you've got a lot of disks\nagain that can be kind of useful\n\n133\n00:06:10,530 --> 00:06:11,770\nto get that organized.\n\n134\n00:06:11,770 --> 00:06:17,130\nBut otherwise it just kind of\nlays them out like we saw there.\n\n135\n00:06:17,130 --> 00:06:22,220\nAlright now volumes,\nthose really match to our partitions.\n\n136\n00:06:22,220 --> 00:06:26,760\nBut If you've got some dynamic discs and\nsome basic discs\n\n137\n00:06:26,760 --> 00:06:29,890\nthere is actually a difference\nbetween the volume and a partition.\n\n138\n00:06:29,890 --> 00:06:32,195\nSo when you're pulling this up,\n\n139\n00:06:32,195 --> 00:06:35,970\nGet-Volume is kind of just assuming\nthat we're following the new methods.\n\n140\n00:06:35,970 --> 00:06:37,929\nBut you also have Get-Partition.\n\n141\n00:06:39,570 --> 00:06:44,140\nAnd if I run that, see how it\nleft off that A and the D drives?\n\n142\n00:06:44,140 --> 00:06:46,180\nThose removable media.\n\n143\n00:06:46,180 --> 00:06:49,230\nIt kinda left those out and\nit left my C drive.\n\n144\n00:06:49,230 --> 00:06:51,080\nThe volume that was there.\n\n145\n00:06:51,080 --> 00:06:53,230\nSo I can see it as an actual partition.\n\n146\n00:06:53,230 --> 00:06:54,940\nYou don't partition a floppy disk.\n\n147\n00:06:54,940 --> 00:06:57,130\nYou don't partition a CD drive.\n\n148\n00:06:57,130 --> 00:06:58,790\nAnd so that's why those are gone.\n\n149\n00:06:58,790 --> 00:07:01,620\nThis view that we get right here\nis very similar to what's above.\n\n150\n00:07:01,620 --> 00:07:03,830\nI see the drive letter that's assigned.\n\n151\n00:07:03,830 --> 00:07:05,460\nI see the size over here.\n\n152\n00:07:05,460 --> 00:07:07,310\nI don't see how much is used.\n\n153\n00:07:07,310 --> 00:07:10,260\nI see the offset on the disk for\nthat partition.\n\n154\n00:07:10,260 --> 00:07:12,580\nSo I see some basic information that.\n\n155\n00:07:12,580 --> 00:07:13,370\nMaybe important to me.\n\n156\n00:07:13,370 --> 00:07:18,160\nYou can actually do a format-list on it,\nand you will see more.\n\n157\n00:07:18,160 --> 00:07:22,490\nSo it gives you additional information\non that as far as wether it is active or\n\n158\n00:07:22,490 --> 00:07:26,590\na boot drive, whether it is hidden and\njust additional information there.\n\n159\n00:07:26,590 --> 00:07:30,530\nSo the data is there,\nyou just do not see it on that screen.\n\n160\n00:07:30,530 --> 00:07:33,730\nNow remember that when\nwe do get dash volume,\n\n161\n00:07:33,730 --> 00:07:35,070\nit's going to include all sorts of media.\n\n162\n00:07:35,070 --> 00:07:39,750\nBut when you do Get-Partition, now we're\ntalking about actual disk partitions.\n\n163\n00:07:39,750 --> 00:07:43,380\nWhich you'll typically only see on\nhard drives, and on some flash media.\n\n164\n00:07:45,250 --> 00:07:49,730\nAll right so with all of that we're just\nlooking at what we've got right now.\n\n165\n00:07:49,730 --> 00:07:53,899\nWe saw Get-Disc, Get-PhysicalDisc,\nGet-VirtualDisc,\n\n166\n00:07:53,899 --> 00:07:56,420\nGet-Volume, and Get-Partition.\n\n167\n00:07:56,420 --> 00:08:00,620\nBut if we want to work with it,\nremember I've got that extra disc.\n\n168\n00:08:00,620 --> 00:08:04,579\nThat second one here that's\noffline it's got no data on it.\n\n169\n00:08:04,579 --> 00:08:08,250\nIf I wanna partition that, I wanna create\na partition on there, get it formatted and\n\n170\n00:08:08,250 --> 00:08:09,090\nget it available.\n\n171\n00:08:10,330 --> 00:08:13,070\nWell, we've got a series of\ncommands that can do that too.\n\n172\n00:08:13,070 --> 00:08:17,340\nSo the first thing that I wanna do\nis I need to bring that disk online.\n\n173\n00:08:17,340 --> 00:08:21,925\nWhen you hook a new blank disk up to\nyour system, if it's truly blank,\n\n174\n00:08:21,925 --> 00:08:26,146\nnothing on it, it will go offline\nwhen you hook it up to Windows.\n\n175\n00:08:26,146 --> 00:08:29,305\nIf it's been used on another computer\nsomewhere else, then if it's already\n\n176\n00:08:29,305 --> 00:08:32,820\npartitioned or whatever, sometimes the\nmanufacturers will do that at the factory.\n\n177\n00:08:32,820 --> 00:08:34,130\nThey'll throw a partition on there.\n\n178\n00:08:34,130 --> 00:08:36,120\nThen it might go online right away.\n\n179\n00:08:36,120 --> 00:08:38,940\nAnd if that's the case,\nyou can skip this next step.\n\n180\n00:08:38,940 --> 00:08:42,646\nBut if you're offline, what you\nneed to do is initialize the disk.\n\n181\n00:08:42,646 --> 00:08:46,563\nInitializing it brings it online and\ngets it ready for our format.\n\n182\n00:08:46,563 --> 00:08:52,835\nSo that's what I'm gonna run next is\nI'm gonna do the Initialize-Disk.\n\n183\n00:08:52,835 --> 00:08:54,875\nAnd if you were using the disk manager,\nright,\n\n184\n00:08:54,875 --> 00:08:58,695\nthe GUI, let me get into that real quick.\n\n185\n00:08:58,695 --> 00:08:59,965\nWhen you see an offline disk,\n\n186\n00:08:59,965 --> 00:09:03,685\nyou would actually have that option to\nright-click on it and choose initialize.\n\n187\n00:09:03,685 --> 00:09:06,525\nAnd so that's exactly what I'm\ndoing here from the command line.\n\n188\n00:09:06,525 --> 00:09:10,885\nSo if I were to go into disk management,\nand find that empty disk right here,\n\n189\n00:09:10,885 --> 00:09:15,430\nit's offline, and if I right-click,\nI can bring it online.\n\n190\n00:09:15,430 --> 00:09:18,540\nAnd then I'll get a little prompt\nthat's gonna ask me to initialize it.\n\n191\n00:09:18,540 --> 00:09:23,840\nSo that's the same process in the GUI that\nI'm seeing down here in the PowerShell.\n\n192\n00:09:23,840 --> 00:09:25,180\nAll right.\n\n193\n00:09:25,180 --> 00:09:27,490\nSo I'm gonna say Initialize-Disk, and\n\n194\n00:09:27,490 --> 00:09:30,880\nthen I have to tell it the disk\nthat I'm gonna be working with.\n\n195\n00:09:30,880 --> 00:09:32,770\nAnd we do that by specifying the number.\n\n196\n00:09:32,770 --> 00:09:35,500\nRemember I mentioned that number\nover here is kind of important.\n\n197\n00:09:35,500 --> 00:09:36,970\nI don't want to initialize disk number 0,\n\n198\n00:09:36,970 --> 00:09:40,970\nbecause that's where my operating system\nis, [LAUGH] it'll just give you an error,\n\n199\n00:09:40,970 --> 00:09:46,720\nbut I'm gonna go ahead and do number 1,\nand that's gonna initialize it.\n\n200\n00:09:46,720 --> 00:09:49,590\nNow, the disk is not offline anymore.\n\n201\n00:09:49,590 --> 00:09:50,870\nNow it's online.\n\n202\n00:09:50,870 --> 00:09:55,175\nIf I do a Get-Disk again,\nit shows as Online and\n\n203\n00:09:55,175 --> 00:09:58,400\nit set it up for GPT instead of MBR.\n\n204\n00:09:58,400 --> 00:10:02,040\nMBR are the old master boot record, that's\nthe old way of partitioning out a disk.\n\n205\n00:10:02,040 --> 00:10:03,670\nGPT is the new way.\n\n206\n00:10:03,670 --> 00:10:06,360\nIt supports larger partitions,\nmore partitions, so\n\n207\n00:10:06,360 --> 00:10:07,970\nit gives us a lot more flexibility.\n\n208\n00:10:07,970 --> 00:10:11,920\nThat's generally what you want unless\nyou're gonna be taking this disk\n\n209\n00:10:11,920 --> 00:10:15,810\noff of your Windows machine and hooking\nit up to a Linux or a Mac or whatever.\n\n210\n00:10:15,810 --> 00:10:18,020\nIn that scenario, you might wanna go MBR.\n\n211\n00:10:18,020 --> 00:10:19,340\nI could have done that.\n\n212\n00:10:19,340 --> 00:10:24,220\nIf you do Get-Help Initialize-Disk,\nit's actually an option in there.\n\n213\n00:10:25,720 --> 00:10:26,330\nOh, shoot.\n\n214\n00:10:26,330 --> 00:10:29,830\nI don't have my help documentation\nloaded on this one, so\n\n215\n00:10:29,830 --> 00:10:31,090\nit's just gonna give me the syntax.\n\n216\n00:10:31,090 --> 00:10:33,980\nBut you do have an option in here,\nright here.\n\n217\n00:10:33,980 --> 00:10:37,563\nFor the partition style,\nyou can specify MBR.\n\n218\n00:10:37,563 --> 00:10:40,440\nAnd when you do that, that's what's\ngonna set it and make it an MBR.\n\n219\n00:10:42,970 --> 00:10:46,630\nAll right, so now that my disk is online,\nthat's great.\n\n220\n00:10:46,630 --> 00:10:51,180\nBut if I look back here in my\nDisk Manager I can see it's online.\n\n221\n00:10:51,180 --> 00:10:55,023\nAnd there's still no partition, right,\nit's still not ready for me to use, and so\n\n222\n00:10:55,023 --> 00:10:57,600\nthat's the next step on\ngetting this one ready.\n\n223\n00:10:57,600 --> 00:11:01,620\nYou initialize the disk and\nthen you create your volumes on it.\n\n224\n00:11:01,620 --> 00:11:05,750\nSo the next thing that I'm gonna do is I'm\ngonna say New-Partition and when we do\n\n225\n00:11:05,750 --> 00:11:10,350\nthat, we need to specify, again, the disk\nthat we're gonna be building this on.\n\n226\n00:11:10,350 --> 00:11:14,390\nSo, I'll specify DiskNumber 1.\n\n227\n00:11:14,390 --> 00:11:16,800\nSo that's the number I'm working on and\n\n228\n00:11:16,800 --> 00:11:21,530\nthen when I create this disk, the odds\nare I want to assign a drive letter to it.\n\n229\n00:11:21,530 --> 00:11:22,980\nSo I need to go ahead and do that.\n\n230\n00:11:22,980 --> 00:11:24,665\nIf you don't specify a drive letter,\n\n231\n00:11:24,665 --> 00:11:27,410\nPowerShell will not\nautomatically attach one.\n\n232\n00:11:27,410 --> 00:11:30,382\nWe can always come back and\nadd it using the set-partition.\n\n233\n00:11:30,382 --> 00:11:34,020\nSo that'll modify an existing one, but in\nmy case I'm just gonna do it right here.\n\n234\n00:11:34,020 --> 00:11:36,920\nI'll say AssignDriveLetter.\n\n235\n00:11:38,710 --> 00:11:41,370\nAnd I could specify which\nletter I want it to have.\n\n236\n00:11:41,370 --> 00:11:44,180\nIf I leave it blank, it'll just\npick the next available letter, and\n\n237\n00:11:44,180 --> 00:11:44,910\nthat's what I'm gonna do.\n\n238\n00:11:44,910 --> 00:11:46,540\nSo I'll just let it go.\n\n239\n00:11:46,540 --> 00:11:49,350\nAnd then I've got\na couple of options here.\n\n240\n00:11:49,350 --> 00:11:53,563\nI could say -UseMaxSize,\nwhich is the default.\n\n241\n00:11:53,563 --> 00:11:55,938\nActually, it's Maximum, I think.\n\n242\n00:11:55,938 --> 00:11:58,896\nLet's do some tab auto complete and\nmake sure I give you the right one.\n\n243\n00:11:58,896 --> 00:12:00,610\nThere it is, there's MaximumSize.\n\n244\n00:12:00,610 --> 00:12:01,800\nUseMaximumSize.\n\n245\n00:12:01,800 --> 00:12:03,120\nThat's the default.\n\n246\n00:12:03,120 --> 00:12:07,010\nIf I were to leave it off, it'll just make\none partition that spans the entire disk,\n\n247\n00:12:07,010 --> 00:12:12,220\ncovers the whole thing, and then it\nassigns it a letter and it's ready to go.\n\n248\n00:12:12,220 --> 00:12:13,560\nAnd that's what a lot of us want,\n\n249\n00:12:13,560 --> 00:12:15,759\na lot of us just want one big\npartition across the entire disk.\n\n250\n00:12:16,970 --> 00:12:21,570\nBut if I want to create something smaller,\nthen I'm gonna need to change that.\n\n251\n00:12:21,570 --> 00:12:23,000\nAnd I'll need to tell it that size.\n\n252\n00:12:23,000 --> 00:12:25,271\nSo, I'm gonna say -size, oops,\n\n253\n00:12:25,271 --> 00:12:29,070\n[INAUDIBLE] there we go, and\nI'll do a 64 gigabyte drive.\n\n254\n00:12:30,140 --> 00:12:32,640\nThe drive itself is 128 gigs, so\nI'm just grabbing half of it.\n\n255\n00:12:35,630 --> 00:12:39,620\nAnd when I run that, it partitions it and\nit assigns it a drive letter.\n\n256\n00:12:39,620 --> 00:12:42,230\nAnd so when I look in the background here,\n\n257\n00:12:42,230 --> 00:12:44,990\nI can see that I now\nhave a 64 gig partition.\n\n258\n00:12:44,990 --> 00:12:48,960\nIt's showing as raw because it\nhas no format but it is there.\n\n259\n00:12:48,960 --> 00:12:52,230\nSo there it is, 64 gigs and\nit's ready to rock.\n\n260\n00:12:52,230 --> 00:12:54,070\nAll right, now where's the drive letter?\n\n261\n00:12:54,070 --> 00:12:57,450\nWell, you don't see drive letters\nuntil the disk is mounted.\n\n262\n00:12:57,450 --> 00:13:00,090\nAnd it's not gonna mount\nthe disk until it's formatted.\n\n263\n00:13:00,090 --> 00:13:04,510\nBut it will remember, it'll remember that\nit's supposed to have a drive letter.\n\n264\n00:13:04,510 --> 00:13:07,130\nSo as soon as I format it,\nit will get one.\n\n265\n00:13:07,130 --> 00:13:10,705\nBut for right now,\nit's pretty much ready to rock.\n\n266\n00:13:10,705 --> 00:13:14,420\n[COUGH] If I want, well, actually,\nI can see it right here.\n\n267\n00:13:14,420 --> 00:13:16,060\nSee how it says DriveLetter E?\n\n268\n00:13:16,060 --> 00:13:18,900\nSo it's right here on the screen,\nI could do Get-Partition and\n\n269\n00:13:18,900 --> 00:13:19,990\nthat would show it too.\n\n270\n00:13:19,990 --> 00:13:23,140\nIt's remembering that it\nshould have drive letter E,\n\n271\n00:13:23,140 --> 00:13:27,280\neven though it doesn't actually have\nit yet because it's not been formatted.\n\n272\n00:13:28,400 --> 00:13:29,700\nSo now I need to format it.\n\n273\n00:13:29,700 --> 00:13:34,440\nAnd we can do that, we've got\nFormat-volume, which kind of maps to\n\n274\n00:13:34,440 --> 00:13:38,990\nthe old command line format command,\nbut we'll just say format-volume, and\n\n275\n00:13:38,990 --> 00:13:43,040\nthen we need to tell it what we're gonna\nformat and how we wanna format it.\n\n276\n00:13:43,040 --> 00:13:48,771\nI'm gonna format this one,\nI'll say -DriveLetter, and this is E.\n\n277\n00:13:48,771 --> 00:13:53,480\nAnd then -FileSystem NTFS.\n\n278\n00:13:53,480 --> 00:13:56,762\nYou do have a few options there for\nfile system,\n\n279\n00:13:56,762 --> 00:13:59,396\nwe can format things fat32 or xfat.\n\n280\n00:13:59,396 --> 00:14:00,867\nPros and cons of all of those but\n\n281\n00:14:00,867 --> 00:14:04,715\nnormally we want NTFS because that's\nwhere we're gonna get file permissions,\n\n282\n00:14:04,715 --> 00:14:08,360\ndisk encryption, all that other\ngood stuff that most of us need.\n\n283\n00:14:08,360 --> 00:14:10,380\nSo I'll just format it as NTFS.\n\n284\n00:14:11,750 --> 00:14:12,700\nThat's gonna format it,\n\n285\n00:14:12,700 --> 00:14:15,510\nand it's just giving me a warning\nhere that it is gonna erase the disk.\n\n286\n00:14:15,510 --> 00:14:16,140\nI'm okay with that.\n\n287\n00:14:17,410 --> 00:14:18,660\nAnd there it goes.\n\n288\n00:14:18,660 --> 00:14:20,030\nAnd now it's formatted.\n\n289\n00:14:20,030 --> 00:14:25,370\nNow I can see it as my\nE drive formatted NTFS,\n\n290\n00:14:25,370 --> 00:14:28,950\nit's a fixed disk, and it is healthy.\n\n291\n00:14:28,950 --> 00:14:32,230\nSo it's up, it's healthy,\nand it's ready to rock.\n\n292\n00:14:34,355 --> 00:14:38,771\nSo let's verify that the partition\nactually shows up, and\n\n293\n00:14:38,771 --> 00:14:41,990\nwe can just go back and do Get-Partition.\n\n294\n00:14:41,990 --> 00:14:43,990\nAnd I can see right there,\nI've got my E drive.\n\n295\n00:14:43,990 --> 00:14:48,800\nOr if I do Get-volume,\nI get the nice, pretty view of it.\n\n296\n00:14:48,800 --> 00:14:53,070\nAnd so I'll do Get-volume and there's that\nE drive right there that we just created.\n\n297\n00:14:53,070 --> 00:14:58,120\nIt's NTFS, it's fixed, it's healthy, and\nit's 63.9 gigs remaining out of 64 gigs,\n\n298\n00:14:58,120 --> 00:15:03,820\nso it created an exactly 64 gig partition\nthere for me, and it's ready to rock.\n\n299\n00:15:03,820 --> 00:15:06,850\nAll right, so creating that partition and\nformatting it,\n\n300\n00:15:06,850 --> 00:15:07,750\nthat worked out pretty well.\n\n301\n00:15:07,750 --> 00:15:11,820\nNow one little warning,\nyou might have noticed in the background\n\n302\n00:15:11,820 --> 00:15:16,330\nhere that I've got this little yellow\nfolder that's flashing at me here.\n\n303\n00:15:16,330 --> 00:15:19,550\nAnd if I look at it,\nit's asking to format the disk.\n\n304\n00:15:19,550 --> 00:15:24,700\nWindows will automatically detect\nthat that disk needs to be formatted.\n\n305\n00:15:24,700 --> 00:15:28,820\nThat was after I created the partition but\nbefore I formatted it, so\n\n306\n00:15:28,820 --> 00:15:32,440\nin between that time Windows automatically\ndetected it and is prompting.\n\n307\n00:15:32,440 --> 00:15:35,610\nIf I hit Format disk, it's actually\ngonna format it a second time.\n\n308\n00:15:35,610 --> 00:15:38,830\nSo we can just ignore that and\ncancel it and that'll knock that out.\n\n309\n00:15:38,830 --> 00:15:40,190\nNow I don't have to worry about it.\n\n310\n00:15:41,190 --> 00:15:45,840\nAll right, so I've created the partition,\nI've formatted it, now it's ready for use.\n\n311\n00:15:45,840 --> 00:15:49,190\nIf I'm an end user or whatever,\nI can browse, I've got that E drive.\n\n312\n00:15:49,190 --> 00:15:53,615\nI can start copying data to it and\neverything's perfect.\n\n313\n00:15:53,615 --> 00:15:56,270\nEverything's working just\nthe way that we want it to.\n\n314\n00:15:56,270 --> 00:15:58,830\nCompletely flawless as these\nthings always are, right?\n\n315\n00:15:58,830 --> 00:16:03,842\n[LAUGH] So now I can go back and I'll just\nthrow some data on there to do it and,\n\n316\n00:16:03,842 --> 00:16:07,200\napparently I have to be\nadministrator to do that.\n\n317\n00:16:07,200 --> 00:16:08,280\nThere we go.\n\n318\n00:16:08,280 --> 00:16:11,512\nSo I've copied data into it,\nthat drive is available.\n\n319\n00:16:11,512 --> 00:16:14,000\nAll right now,\nonce we've got the disk available,\n\n320\n00:16:14,000 --> 00:16:18,090\nand that's really the end of that, right,\nwe just let it run, and off we go.\n\n321\n00:16:18,090 --> 00:16:21,490\nBut there are some more things that we\ncan do to a disk after it's been made.\n\n322\n00:16:21,490 --> 00:16:24,990\nIf we look back in the disk manager,\nwe made a 64 gig disk.\n\n323\n00:16:24,990 --> 00:16:26,960\nThere's still more space at the end.\n\n324\n00:16:26,960 --> 00:16:30,300\nI might want to extend this\ndisk to fill up that space or\n\n325\n00:16:30,300 --> 00:16:35,050\nI might want to shrink it to have it take\nless space depending on what my needs are.\n\n326\n00:16:35,050 --> 00:16:38,940\nWell, you can do shrink and\ngrow operations from the PowerShell.\n\n327\n00:16:38,940 --> 00:16:43,250\nYou can do it right here in the GUI also\nbut I'm gonna do it in the PowerShell\n\n328\n00:16:43,250 --> 00:16:47,580\njust to have that kind of full\nset of commands for us there.\n\n329\n00:16:47,580 --> 00:16:52,010\nSo if I want to shrink or grow this one,\nthe commands are fairly straightforward.\n\n330\n00:16:52,010 --> 00:16:55,440\nWe actually use\nthe Resize-Partition command.\n\n331\n00:16:56,680 --> 00:17:00,790\nSo this is gonna resize it, and\nit's the same for shrinking or growing.\n\n332\n00:17:00,790 --> 00:17:03,920\nYou resize it, you tell it what\npartition you're gonna resize, and\n\n333\n00:17:03,920 --> 00:17:05,620\nthen you give it a new size.\n\n334\n00:17:05,620 --> 00:17:08,350\nIf it's smaller than the existing size,\nthen it'll shrink it.\n\n335\n00:17:08,350 --> 00:17:10,570\nIf it's bigger than the existing size,\nit'll grow it.\n\n336\n00:17:10,570 --> 00:17:12,970\nSo it's not two different commands,\nit's just one.\n\n337\n00:17:12,970 --> 00:17:15,260\nAnd so I'm gonna repartition it.\n\n338\n00:17:15,260 --> 00:17:22,004\nAnd I'll say that it is disk number one,\nand then partition number.\n\n339\n00:17:25,954 --> 00:17:27,410\nPartition number 1.\n\n340\n00:17:27,410 --> 00:17:29,500\nRight now, actually I'd be\nwrong if I did that wouldn't I?\n\n341\n00:17:29,500 --> 00:17:30,890\nIt's partition number 2.\n\n342\n00:17:30,890 --> 00:17:34,040\nI'm getting these numbers right here for\nmy output up above.\n\n343\n00:17:34,040 --> 00:17:34,580\nRight?\n\n344\n00:17:34,580 --> 00:17:36,950\nWhen I ran the get dash disc.\n\n345\n00:17:36,950 --> 00:17:40,400\nWhen was the last time we ran that?\n\n346\n00:17:40,400 --> 00:17:41,000\nSomewhere in here.\n\n347\n00:17:41,000 --> 00:17:41,650\nHere.\n\n348\n00:17:41,650 --> 00:17:46,880\nI can see I Get-Partition,\ndisk number one, partition number 2.\n\n349\n00:17:46,880 --> 00:17:48,070\nThat's my E drive.\n\n350\n00:17:48,070 --> 00:17:50,280\nThat's the one I'm working on right now.\n\n351\n00:17:50,280 --> 00:17:51,880\nSo I can see it right there.\n\n352\n00:17:51,880 --> 00:17:54,920\nAnd that's what I'm\nfeeding into this command.\n\n353\n00:17:54,920 --> 00:17:59,165\nSo I come in, I say resize partition.\n\n354\n00:17:59,165 --> 00:18:01,900\nResize-partition-disc1-partition2.\n\n355\n00:18:01,900 --> 00:18:04,940\nAnd now I tell it the new\nsize that I want.\n\n356\n00:18:04,940 --> 00:18:08,590\nAnd in my scenario,\nmaybe I'll shrink it first.\n\n357\n00:18:08,590 --> 00:18:12,340\nSo I'm gonna come in here and\nsay size 36 gigabytes.\n\n358\n00:18:12,340 --> 00:18:14,090\nAll right?\nSo I'm gonna cut it in half.\n\n359\n00:18:14,090 --> 00:18:18,730\nAnd when I run that, it's gonna run and\nit's gonna shrink it down.\n\n360\n00:18:18,730 --> 00:18:21,830\nAnd, now it should be a 36-gig partition,\n\n361\n00:18:21,830 --> 00:18:25,000\nversus the larger partition\nthat it was before.\n\n362\n00:18:25,000 --> 00:18:28,850\nSo if I do a Get-volume,\n\n363\n00:18:28,850 --> 00:18:34,070\nnow I can look at it and, sure enough,\nit shows us a 36-gig disk right there.\n\n364\n00:18:34,070 --> 00:18:37,170\nAnd, back here,\nI can see it's even updated in the GUI.\n\n365\n00:18:37,170 --> 00:18:38,550\nIt's already reflecting that 36 gigs.\n\n366\n00:18:38,550 --> 00:18:39,050\nAll right.\n\n367\n00:18:40,480 --> 00:18:43,190\nIf I wanted to make it bigger,\nI can just bring that command back and\n\n368\n00:18:43,190 --> 00:18:46,100\nI can put a larger size in there.\n\n369\n00:18:46,100 --> 00:18:48,215\nWhat if I wanted to fill the whole drive?\n\n370\n00:18:48,215 --> 00:18:50,385\nWell if you wanted to\nfill the whole drive.\n\n371\n00:18:50,385 --> 00:18:55,125\nYou've got the ability to just\nleave that off and when we run it.\n\n372\n00:18:55,125 --> 00:18:57,975\nOh actually you know it is still going\nto ask me the size of it there isn't it?\n\n373\n00:18:57,975 --> 00:19:01,605\nLet's see I believe it's\nthat use maximum size.\n\n374\n00:19:01,605 --> 00:19:05,825\nNope it's not going to do that either.\n\n375\n00:19:05,825 --> 00:19:10,343\nAll right well we'll just do a little\nget-dash disk and see what our max is.\n\n376\n00:19:10,343 --> 00:19:13,570\nSo we've got 128 gigs as our max.\n\n377\n00:19:13,570 --> 00:19:17,180\nSo I'll go ahead and just designate that\nas my next one so I'll say dash size,\n\n378\n00:19:17,180 --> 00:19:19,880\n128 gigabytes, and I'll run that.\n\n379\n00:19:19,880 --> 00:19:21,200\nI'm just gonna try and expand it.\n\n380\n00:19:21,200 --> 00:19:24,050\nNow this is a common problem that you\nrun into when you're trying to get\n\n381\n00:19:24,050 --> 00:19:26,460\nextended all the way to\nthe end of the drive.\n\n382\n00:19:26,460 --> 00:19:30,770\nAnd the problem is although\nit says 128 gigs you don't\n\n383\n00:19:30,770 --> 00:19:33,880\nactually have a full 128 gigs available,\nright?\n\n384\n00:19:33,880 --> 00:19:36,180\nThe size is kinda being rounded for us.\n\n385\n00:19:36,180 --> 00:19:42,100\nSo when I told it 128 gigs it doesn't\ntruly have that much space to grow.\n\n386\n00:19:42,100 --> 00:19:44,800\nSo there is a command line tag which I\n\n387\n00:19:44,800 --> 00:19:47,140\nthought was that use maximum\nsize to go to the full one.\n\n388\n00:19:47,140 --> 00:19:49,316\nLet's just double check our\nhelp documentation here.\n\n389\n00:19:49,316 --> 00:19:54,935\nFor the Resize-Partition.\n\n390\n00:19:57,419 --> 00:20:00,350\nAnd we'll see if we can't spot it here.\n\n391\n00:20:00,350 --> 00:20:03,050\nSo we specify that dash size and\n\n392\n00:20:03,050 --> 00:20:06,600\nthere is another option in here\nthat I am just not seeing.\n\n393\n00:20:11,135 --> 00:20:13,320\nYeah, maybe I'm just\nremembering this wrong.\n\n394\n00:20:13,320 --> 00:20:15,650\nSo I do not see an option\nto tell it to go ahead and\n\n395\n00:20:15,650 --> 00:20:17,600\njust do the full size, interesting.\n\n396\n00:20:17,600 --> 00:20:23,880\nSo you know what I'm gonna do,\nI'm gonna do a get-disk,\n\n397\n00:20:23,880 --> 00:20:26,530\nand let me do that as a format.\n\n398\n00:20:27,590 --> 00:20:31,410\nDash list, and we'll see if we can't\nfigure out what our biggest space is.\n\n399\n00:20:31,410 --> 00:20:37,028\nSo, right here it's showing us at 128 GB,\nand it's, hm.\n\n400\n00:20:37,028 --> 00:20:41,832\nYou know, it is just still rounding that\nfor me, so, well, I don't wanna dive\n\n401\n00:20:41,832 --> 00:20:46,240\ntoo deep into rationalizing out that\nnumber, so here's what I'll do.\n\n402\n00:20:46,240 --> 00:20:49,170\nI'm gonna just make this\na little bit lower, and\n\n403\n00:20:49,170 --> 00:20:52,110\nwe'll see how close we can get to that.\n\n404\n00:20:52,110 --> 00:20:54,940\nSo I'm just going to convert that\nfrom gigabytes down to megabytes and\n\n405\n00:20:54,940 --> 00:20:55,870\nlet it create.\n\n406\n00:20:55,870 --> 00:21:03,460\nSo instead of doing 128 gigs I did\n127,900 megabytes which is 127.9 gigs.\n\n407\n00:21:03,460 --> 00:21:08,580\nSo really close,\nthat 128 which should have run.\n\n408\n00:21:08,580 --> 00:21:09,090\nThere we go.\nBut\n\n409\n00:21:09,090 --> 00:21:11,230\nsee how I have some extra\nspace right there at the end.\n\n410\n00:21:11,230 --> 00:21:15,090\nSo we kinda have to calculate out\nwhat that maximum number is and\n\n411\n00:21:15,090 --> 00:21:15,970\nget that to resize.\n\n412\n00:21:15,970 --> 00:21:19,740\nBut it can be a little tricky\nto get that exact number.\n\n413\n00:21:19,740 --> 00:21:23,380\nIt's because the way that they\nmeasure the hard drive sizes and\n\n414\n00:21:23,380 --> 00:21:26,940\nthe way that we convert\nour units of measurement.\n\n415\n00:21:26,940 --> 00:21:30,380\nSo growing it, though,\nyou just specify that larger size.\n\n416\n00:21:30,380 --> 00:21:33,570\nIt'll grow to fill that space, as long\nas it's available, and then off you go.\n\n417\n00:21:33,570 --> 00:21:35,570\nAnd then you can shrink\nit again if you want.\n\n418\n00:21:35,570 --> 00:21:36,350\nVery dynamic.\n\n419\n00:21:36,350 --> 00:21:36,940\nVery easy to do.\n\n420\n00:21:39,540 --> 00:21:40,220\nAll right.\nWhat are some\n\n421\n00:21:40,220 --> 00:21:43,330\nof the other things we that might need\nto do with a disk that we've got?\n\n422\n00:21:43,330 --> 00:21:46,100\nFormatting it, bringing it online,\nthose are some things.\n\n423\n00:21:46,100 --> 00:21:49,010\nWe might need to give it a volume label,\nright.\n\n424\n00:21:49,010 --> 00:21:50,630\nWhen people format drives,\n\n425\n00:21:50,630 --> 00:21:53,010\nthey usually give them a name and\nthe name shows up here.\n\n426\n00:21:53,010 --> 00:21:56,360\nAnd if you don't,\nit just gives it local disk, right?\n\n427\n00:21:56,360 --> 00:21:59,380\nSo, I've got local disk E, local disk C.\n\n428\n00:21:59,380 --> 00:22:02,280\nWhen you format it,\nyou have the option to give it a label.\n\n429\n00:22:02,280 --> 00:22:05,140\nIf you didn't like I did,\nyou can always go there after the fact and\n\n430\n00:22:05,140 --> 00:22:05,740\ngive it a label.\n\n431\n00:22:05,740 --> 00:22:07,060\nIt doesn't mess with your data.\n\n432\n00:22:07,060 --> 00:22:09,520\nSo we can always add one if we want.\n\n433\n00:22:09,520 --> 00:22:13,620\nthe commands that I've been doing, things\nlike resize partition, new-partition,\n\n434\n00:22:13,620 --> 00:22:15,460\nthose are all creating new things.\n\n435\n00:22:15,460 --> 00:22:19,500\nBut you can use the set-command\nto go in and change something.\n\n436\n00:22:19,500 --> 00:22:25,188\nSo I can come in and say set-partition.\n\n437\n00:22:25,188 --> 00:22:28,265\nAnd its got a label option\nthat we can use to go in and\n\n438\n00:22:28,265 --> 00:22:31,100\ndesignate what we want that label to be.\n\n439\n00:22:31,100 --> 00:22:33,550\nSo that's what I'm gonna do here.\n\n440\n00:22:33,550 --> 00:22:38,660\nI'll just say set,\nactually I need to do set dash volume,\n\n441\n00:22:38,660 --> 00:22:43,540\nand then I'll say DriveLetter E,\n\n442\n00:22:43,540 --> 00:22:46,420\nand I'm gonna come in and\nspecify what I want that label to be.\n\n443\n00:22:47,710 --> 00:22:50,760\nAll right, so I didn't assign\na volume label when I formatted,\n\n444\n00:22:50,760 --> 00:22:53,650\nI'm just gonna do Get-volume here so\nI can see that.\n\n445\n00:22:53,650 --> 00:22:56,510\nAnd when I look at it, you'll see file\nsystem label and it's blank, and so\n\n446\n00:22:56,510 --> 00:22:57,540\nis the C drive, right?\n\n447\n00:22:57,540 --> 00:22:59,120\nThey were just never set.\n\n448\n00:22:59,120 --> 00:23:03,580\nSo what's happening is Windows is just\nassigning it that local disk name, and\n\n449\n00:23:03,580 --> 00:23:05,780\nI can go in and\nI can change that if I want.\n\n450\n00:23:05,780 --> 00:23:09,000\nSo to change it,\nI just need to say Set-volume and\n\n451\n00:23:09,000 --> 00:23:13,250\nthen I need to specify the drive letter,\nso I'll do DriveLetter E.\n\n452\n00:23:13,250 --> 00:23:16,140\nAnd then I'm gonna do\nthe NewFileSystemLabel.\n\n453\n00:23:18,520 --> 00:23:20,200\nAnd then I need to give it a name, right?\n\n454\n00:23:20,200 --> 00:23:21,560\nSo if this is my E drive, you know?\n\n455\n00:23:21,560 --> 00:23:23,190\nMaybe that's my storage drive.\n\n456\n00:23:23,190 --> 00:23:25,050\nThat's where I'm gonna put data.\n\n457\n00:23:25,050 --> 00:23:28,090\nWell, I might wanna go and\nredo the C drive also.\n\n458\n00:23:28,090 --> 00:23:33,160\nSo I'll give that one a label of,\nI don't know, operating system.\n\n459\n00:23:35,910 --> 00:23:36,960\nLet's see, is that too long?\n\n460\n00:23:36,960 --> 00:23:37,670\nNope.\nOkay.\n\n461\n00:23:37,670 --> 00:23:39,910\nThere's a maximum amount of characters for\nthe label.\n\n462\n00:23:39,910 --> 00:23:44,847\nSo, I've just given them names, now if I\ndo get-volume, in addition to having drive\n\n463\n00:23:44,847 --> 00:23:48,298\nletters I'll be able to see these\nlabels that are attached so\n\n464\n00:23:48,298 --> 00:23:50,550\nI can start to identify what these are.\n\n465\n00:23:50,550 --> 00:23:52,670\nAnd Windows will pick up on those, too.\n\n466\n00:23:52,670 --> 00:23:55,470\nIf I go back to my explorer I can see\nthey've now got those nice little labels\n\n467\n00:23:55,470 --> 00:23:56,009\nright there.\n\n468\n00:23:56,009 --> 00:23:57,749\nOperating System, Storage.\n\n469\n00:23:57,749 --> 00:24:01,350\nIt's there it's available and ready to go.\n\n470\n00:24:01,350 --> 00:24:05,090\nAll right let's see do\nI have anything else?\n\n471\n00:24:05,090 --> 00:24:06,840\nOh routine maintenance.\n\n472\n00:24:06,840 --> 00:24:10,270\nCreating partitions, getting a drive\nformatted, getting it in place,\n\n473\n00:24:10,270 --> 00:24:11,460\nthat's part of the job right?\n\n474\n00:24:11,460 --> 00:24:13,110\nWe do that once but\n\n475\n00:24:13,110 --> 00:24:17,640\nthen while we use the disc over time\nthere's things we might need to do to it.\n\n476\n00:24:17,640 --> 00:24:20,220\nOne of those maintenance tasks I\nalready showed you, that was resizing.\n\n477\n00:24:20,220 --> 00:24:24,410\nWe might need to grow or shrink our\npartition, but some of the other\n\n478\n00:24:24,410 --> 00:24:29,570\nthings that we might need to do are things\nlike checking the disk for errors,\n\n479\n00:24:29,570 --> 00:24:33,950\nright, in the event that we have any kind\nof disk write errors or defragmentation.\n\n480\n00:24:33,950 --> 00:24:35,470\nWe may need to defragment a drive,\n\n481\n00:24:35,470 --> 00:24:39,150\nand you can do both of those\nfrom the PowerShell also, right?\n\n482\n00:24:39,150 --> 00:24:43,810\nSo let's say that my E drive,\nI've been copying a lot of data to it and\n\n483\n00:24:43,810 --> 00:24:47,460\ndeleting a lot of data, and\nfragmentation has started to happen, and\n\n484\n00:24:47,460 --> 00:24:50,040\nI just wanna go and do some good\nclean maintenance on it, check it for\n\n485\n00:24:50,040 --> 00:24:53,830\nerrors just to make sure it's fine and\nthen defragment.\n\n486\n00:24:53,830 --> 00:24:57,880\nAll right well, all I have to do\nis go back to my PowerShell and\n\n487\n00:24:57,880 --> 00:25:01,930\nI can say,\nlet's see we'll start with defragmenting.\n\n488\n00:25:01,930 --> 00:25:10,100\nI'll say Optimize-Volume -DriveLetter E.\n\n489\n00:25:10,100 --> 00:25:12,110\nThat's gonna tell it to go and\ndefragment that.\n\n490\n00:25:12,110 --> 00:25:14,820\nNow this command is hard to remember\nbecause it doesn't have defrag\n\n491\n00:25:14,820 --> 00:25:15,320\nin the name.\n\n492\n00:25:15,320 --> 00:25:16,785\nBut that's exactly what it's gonna do.\n\n493\n00:25:16,785 --> 00:25:20,570\nOptimize-Volume is basically defragment.\n\n494\n00:25:20,570 --> 00:25:24,610\nNow I just created that disk, I haven't\ncopied any files or anything like that so\n\n495\n00:25:24,610 --> 00:25:26,310\nit's really not gonna need it.\n\n496\n00:25:26,310 --> 00:25:29,990\nAnd if it's also a virtual drive so\nit's a little upset about that.\n\n497\n00:25:29,990 --> 00:25:31,880\nSo it's telling me here\nI got a general error,\n\n498\n00:25:31,880 --> 00:25:34,980\nit's not covered by a more\nspecific code and so on.\n\n499\n00:25:34,980 --> 00:25:38,020\nI'm trying to defragment a disc\nthat can't be defragmented.\n\n500\n00:25:38,020 --> 00:25:42,040\nBut on a traditional disc it'll run,\nand defragment it and get it clean.\n\n501\n00:25:43,060 --> 00:25:46,490\nNow, defragmentation is one\nthing that we might need to do.\n\n502\n00:25:46,490 --> 00:25:48,980\nChecking for errors is another right?\n\n503\n00:25:48,980 --> 00:25:52,848\nAnd if we need to check for errors,\nthe command for that is very similar.\n\n504\n00:25:52,848 --> 00:25:58,621\nIt's: Repair-Volume, and\nthen we specify the drive letter and\n\n505\n00:25:58,621 --> 00:26:02,650\nthat's going to be my E drive, all right?\n\n506\n00:26:02,650 --> 00:26:04,010\nAnd so this is the equivalent of running,\n\n507\n00:26:04,010 --> 00:26:06,720\nlike, check disk from\nthe regular command prompt.\n\n508\n00:26:06,720 --> 00:26:11,540\nHere it's just Repair-Volume and so if we\nrun that, it's going to look at it, and\n\n509\n00:26:11,540 --> 00:26:14,530\nI get a real fast response from this\none because it's a virtual drive,\n\n510\n00:26:14,530 --> 00:26:15,630\nno errors found.\n\n511\n00:26:15,630 --> 00:26:17,650\nIn real life it might\nactually take a while to run.\n\n512\n00:26:17,650 --> 00:26:20,720\nIt could take hours if it's\na massive Drive to run, for\n\n513\n00:26:20,720 --> 00:26:21,530\nme it's gonna run real quick.\n\n514\n00:26:22,530 --> 00:26:26,160\nAll right, so, optimize-volume and\nrepair-volume.\n\n515\n00:26:26,160 --> 00:26:30,000\nThose two guys right there, they're\ngonna take care of defragmenting and\n\n516\n00:26:30,000 --> 00:26:30,650\nchecking for errors.\n\n517\n00:26:30,650 --> 00:26:33,340\nSo that somethings that you might\nwanna set as a scheduled task.\n\n518\n00:26:33,340 --> 00:26:37,210\nDefragmenting is usually a scheduled task\non your system, but you can set these to\n\n519\n00:26:37,210 --> 00:26:40,750\nrun at a time that was acceptable in your\nenvironment and you'll be good to go.\n\n520\n00:26:42,530 --> 00:26:45,420\nAll right, so\nworking with disks from the command line,\n\n521\n00:26:45,420 --> 00:26:48,790\nfrom the PowerShell,\nit's not that big of a deal, right?\n\n522\n00:26:48,790 --> 00:26:51,910\nDisk part from the regular command\nprompt works perfectly fine, but\n\n523\n00:26:51,910 --> 00:26:55,230\nif you're trying to automate things\nthrough PowerShell, it's always best to\n\n524\n00:26:55,230 --> 00:26:58,990\nuse native commandlets if you can and\nthese are the ones that take care of it.\n\n525\n00:26:58,990 --> 00:27:01,740\nAnd there's really not anything\nthat we can do in the GUI or\n\n526\n00:27:01,740 --> 00:27:04,540\nin this part that you\ncan't do from right here.\n\n527\n00:27:04,540 --> 00:27:08,862\nSo you do get a lot of flexibility and\npower right inside the power shell.\n\n528\n00:27:08,862 --> 00:27:12,340\nAll right, so in this segment, we got\na chance to see how to initialize a new\n\n529\n00:27:12,340 --> 00:27:17,220\ndisk, create a partition on it, format\nit and get it lettered and ready to go,\n\n530\n00:27:17,220 --> 00:27:22,770\nwe saw how to resize the disk,\ndefragment it and check it for errors.\n\n531\n00:27:22,770 --> 00:27:24,420\nSo we saw a lot of good stuff.\n\n532\n00:27:24,420 --> 00:27:27,380\nI guess the only thing I left out\nis if you wanna get rid of a disk,\n\n533\n00:27:27,380 --> 00:27:30,770\nit would be Remove-Partition,\nkind of goes without saying.\n\n534\n00:27:30,770 --> 00:27:33,340\nSo you would say\nRemove-Partition-DriveLetter and\n\n535\n00:27:33,340 --> 00:27:34,400\nthe letter.\n\n536\n00:27:34,400 --> 00:27:37,190\nAnd that would take that partition\nout if you were done with it.\n\n537\n00:27:37,190 --> 00:27:39,710\nBe careful with that, though, because you\n\n538\n00:27:39,710 --> 00:27:42,580\ndo get warnings when you go to remove\nit but it's not the same as in the GUI.\n\n539\n00:27:42,580 --> 00:27:44,410\nYou don't get a ton of warnings on it.\n\n540\n00:27:44,410 --> 00:27:48,270\nSo it is easier to accidentally remove\na volume if you're not careful.\n\n541\n00:27:49,300 --> 00:27:52,630\nAll right, well that's about it for\nmanaging disks inside of the Powershell.\n\n542\n00:27:52,630 --> 00:27:53,880\nI hope you guys enjoyed the segment.\n\n543\n00:27:53,880 --> 00:27:57,441\nStay tuned,\nwe got more Powershell coming up.\n\n544\n00:27:57,441 --> 00:28:02,660\n[MUSIC]\n\n",
          "vimeoId": "114693802"
        },
        {
          "description": "",
          "length": "1835",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-3-registry-operations-120514.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-3-registry-operations-120514-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-3-registry-operations-120514-sm.jpg",
          "title": "Registry Operations",
          "transcript": "1\n00:00:00,226 --> 00:00:08,063\n[MUSIC]\n\n2\n00:00:08,063 --> 00:00:08,963\nIn this segment,\n\n3\n00:00:08,963 --> 00:00:12,750\nwe're gonna take a look at registry\noperations inside of the PowerShell.\n\n4\n00:00:13,780 --> 00:00:17,880\nAs you start to automate processes you'll\nfind that there's commonly a need for\n\n5\n00:00:17,880 --> 00:00:21,000\nyou to either query\nthe Windows registry to\n\n6\n00:00:21,000 --> 00:00:23,420\nfind out information about\nthe systems configuration.\n\n7\n00:00:23,420 --> 00:00:27,680\nOr maybe even to change the registry,\nto modify the configuration of a system.\n\n8\n00:00:27,680 --> 00:00:30,310\nAnd you can do all that\nfrom within the PowerShell.\n\n9\n00:00:30,310 --> 00:00:33,460\nInside of the PowerShell there's actually\nsome really neat functionality that allows\n\n10\n00:00:33,460 --> 00:00:37,850\nit to access all sorts of different\nthings beyond our normal services and\n\n11\n00:00:37,850 --> 00:00:40,450\nfile type operations that we expect.\n\n12\n00:00:40,450 --> 00:00:44,270\nAnd the registry is one of those things\nthat's included that is a little bit\n\n13\n00:00:44,270 --> 00:00:47,380\nbeyond what the average user thinks of\nwhen they start working with PowerShell.\n\n14\n00:00:48,380 --> 00:00:51,190\nOne of the ways that we're able to\ndo this is through what's called\n\n15\n00:00:51,190 --> 00:00:52,780\na PowerShell drive.\n\n16\n00:00:52,780 --> 00:00:56,550\nIf you haven't watched our segment on\nPowerShell drives yet, I encourage you to\n\n17\n00:00:56,550 --> 00:01:00,640\nwatch that before this video because I\nshow you how those PowerShell drives work.\n\n18\n00:01:00,640 --> 00:01:02,520\nAnd how they can interact\nwith the registry.\n\n19\n00:01:02,520 --> 00:01:05,090\nBut I'm gonna make use of\none of those right here.\n\n20\n00:01:05,090 --> 00:01:09,420\nInside of the PowerShell it actually\nalready has some mappings to\n\n21\n00:01:09,420 --> 00:01:12,418\ntwo particular hives\ninside of the registry.\n\n22\n00:01:12,418 --> 00:01:16,960\nH key current user and\nH key local machine.\n\n23\n00:01:16,960 --> 00:01:21,070\nWhen we modify the registry,\nwe're almost always modifying keys and\n\n24\n00:01:21,070 --> 00:01:24,350\nvalues that are inside of those two hives.\n\n25\n00:01:24,350 --> 00:01:27,200\nAnd Microsoft knows that, so\nthey've given us visibility into it.\n\n26\n00:01:27,200 --> 00:01:29,400\nLet me show you what I mean.\n\n27\n00:01:29,400 --> 00:01:33,460\nWhen you go into the PowerShell, we're\nused to seeing things like our C drive and\n\n28\n00:01:33,460 --> 00:01:38,120\nnavigating around this user\ninterface as a file system.\n\n29\n00:01:38,120 --> 00:01:40,090\nThat's what we're used to seeing.\n\n30\n00:01:40,090 --> 00:01:43,250\nBut there's actually some\ndrive letters that are mapped\n\n31\n00:01:43,250 --> 00:01:44,730\nthat aren't letters at all.\n\n32\n00:01:44,730 --> 00:01:46,260\nThey're actually words.\n\n33\n00:01:46,260 --> 00:01:52,270\nIf you do get-ps drive you can see\nPowerShell drives that are defined and\n\n34\n00:01:52,270 --> 00:01:56,850\nthere's these two guys right here,\nHKCU and HKLM.\n\n35\n00:01:56,850 --> 00:02:01,380\nThose are registry mappings, and\nthey're mapped to H key current user and\n\n36\n00:02:01,380 --> 00:02:02,600\nH key local machine.\n\n37\n00:02:02,600 --> 00:02:06,640\nSo we can actually access\nthose portions of the registry\n\n38\n00:02:06,640 --> 00:02:08,450\nright here from the command line.\n\n39\n00:02:08,450 --> 00:02:14,540\nI can type CD or\nChange Directory, HKCM: so\n\n40\n00:02:14,540 --> 00:02:20,270\njust like I might type CDC: to change\nto the C drive, here I'm doing HKCM.\n\n41\n00:02:20,270 --> 00:02:26,001\nAnd when I do that it's\ngonna give me in here.\n\n42\n00:02:26,001 --> 00:02:26,962\nOh, it's HKLM.\nI guess maybe if I used the right letters.\n\n43\n00:02:26,962 --> 00:02:28,830\nThere we go.\nAnd now my prompt is going to change, and\n\n44\n00:02:28,830 --> 00:02:34,800\nI'm in hp local machine, and\nif I do DIR like a directory, it's\n\n45\n00:02:34,800 --> 00:02:38,430\ngonna pull up a list and I'll start to see\nsome of the things that are in there..\n\n46\n00:02:38,430 --> 00:02:42,180\nNow keep in mind that even as an\nadministrator you can see I'm running this\n\n47\n00:02:42,180 --> 00:02:46,350\nas an administrator, there are some things\nin the register we don't have access to,\n\n48\n00:02:46,350 --> 00:02:48,210\nthe SAM database is one of those.\n\n49\n00:02:48,210 --> 00:02:50,600\nThat's the security\ndatabase inside of Windows.\n\n50\n00:02:50,600 --> 00:02:53,460\nSo that's why I got an error\nright there in the list.\n\n51\n00:02:53,460 --> 00:02:56,910\nThat's to be expected because I'm\nnot allowed to look in there.\n\n52\n00:02:56,910 --> 00:03:00,000\nBut if I change into one of these\nother subfolders like if I change\n\n53\n00:03:00,000 --> 00:03:02,820\ninto the software folder.\n\n54\n00:03:02,820 --> 00:03:08,010\nI can do a DIR and now I start to see\nthe various keys that are inside of there.\n\n55\n00:03:08,010 --> 00:03:11,040\nNow be aware of the terminology here.\n\n56\n00:03:11,040 --> 00:03:15,760\nInside of the registry you have folders\nand those folders are called keys.\n\n57\n00:03:15,760 --> 00:03:18,920\nInside of a key you might have other keys.\n\n58\n00:03:18,920 --> 00:03:22,340\nOr you might have other properties,\nall right?\n\n59\n00:03:22,340 --> 00:03:24,660\nAnd then each property has a value.\n\n60\n00:03:24,660 --> 00:03:27,652\nLet's look at the graphical user interface\nto kind of get a better idea of that.\n\n61\n00:03:27,652 --> 00:03:30,547\nI'm gonna go into the registry, and\n\n62\n00:03:30,547 --> 00:03:34,850\nI'm gnna go into H key current or\nH key local machine.\n\n63\n00:03:36,230 --> 00:03:38,390\nAnd I'll go into software, all right.\n\n64\n00:03:38,390 --> 00:03:41,990\nNow that's where I'm at inside\nof the PowerShell right now.\n\n65\n00:03:41,990 --> 00:03:44,070\nI'm in this software folder.\n\n66\n00:03:44,070 --> 00:03:46,390\nAnd as I continue to navigate down,\n\n67\n00:03:46,390 --> 00:03:49,460\nI'm just navigating from folder to folder,\nright.\n\n68\n00:03:49,460 --> 00:03:52,120\nI'm going from key to key.\n\n69\n00:03:52,120 --> 00:03:59,060\nSo, I'm in the software, and\nthen if I go into Microsoft and Windows.\n\n70\n00:03:59,060 --> 00:04:03,480\nHere, I'll go into,\nI want to go into Windows NT.\n\n71\n00:04:04,550 --> 00:04:07,540\nI got to put quotes around it\ncuz there's a space in it.\n\n72\n00:04:07,540 --> 00:04:11,250\nAnd then I'm going to go\ninto current version.\n\n73\n00:04:11,250 --> 00:04:14,490\nAnd then I'm gonna go into winlogon.\n\n74\n00:04:16,290 --> 00:04:21,490\nSo I just changed all the way down into\nthat particular area of the registry.\n\n75\n00:04:21,490 --> 00:04:23,890\nIf I go back to my GUI,\nI can do the same thing.\n\n76\n00:04:23,890 --> 00:04:25,740\nI can go to Microsoft and\n\n77\n00:04:25,740 --> 00:04:30,690\nI can find Windows NT here on\nthe list somewhere eventually.\n\n78\n00:04:30,690 --> 00:04:32,300\nThere it is.\n\n79\n00:04:32,300 --> 00:04:36,090\nAnd inside of Windows NT,\nI can find Current Version, and\n\n80\n00:04:36,090 --> 00:04:39,810\ninside of Current Version,\nI can find WinLogon.\n\n81\n00:04:39,810 --> 00:04:40,960\nRight?\n\n82\n00:04:40,960 --> 00:04:43,020\nSo there's WinLogon, all right?\n\n83\n00:04:43,020 --> 00:04:44,380\nNow when I look at WinLogon,\n\n84\n00:04:44,380 --> 00:04:48,350\nhere in the GUI I see all these\nvalues inside of it, right?\n\n85\n00:04:48,350 --> 00:04:52,420\nBut in my PowerShell,\nI'm in that same WinLogon folder.\n\n86\n00:04:52,420 --> 00:04:57,330\nAnd if I do DIR, I just see this,\nalternate shells,\n\n87\n00:04:57,330 --> 00:05:01,520\nGP extensions, and\nauto logon check, and that's it.\n\n88\n00:05:01,520 --> 00:05:02,730\nWhere's everything else?\n\n89\n00:05:02,730 --> 00:05:05,530\nRight here in the GUI,\nI see a ton of stuff.\n\n90\n00:05:05,530 --> 00:05:08,170\nBut back there I'm only seeing a couple.\n\n91\n00:05:08,170 --> 00:05:12,310\nWell the reason is what it's showing\nme in the command line when I\n\n92\n00:05:12,310 --> 00:05:16,890\ndo those DIR commands,\nthat's just showing me the keys.\n\n93\n00:05:16,890 --> 00:05:20,760\nIf I expand out the win log\non folder over here and\n\n94\n00:05:20,760 --> 00:05:23,400\nlook I've got a key\ncalled alternate shells.\n\n95\n00:05:23,400 --> 00:05:26,560\nAuto log on check, GP extensions\nthat's where those are coming from.\n\n96\n00:05:26,560 --> 00:05:31,120\nThose are keys,\nit's not showing me the properties.\n\n97\n00:05:31,120 --> 00:05:35,180\nSo in PowerShell we navigate\nbased on the keys, but\n\n98\n00:05:35,180 --> 00:05:38,010\nwhat we really want at the end\nof the day are the properties.\n\n99\n00:05:38,010 --> 00:05:41,520\nWe wanna either see, A,\nwhat's in a property,\n\n100\n00:05:41,520 --> 00:05:43,820\nso what's a property's current value.\n\n101\n00:05:43,820 --> 00:05:47,220\nOr B,\nwe need to change the value of a property.\n\n102\n00:05:47,220 --> 00:05:47,770\nAll right?\n\n103\n00:05:47,770 --> 00:05:50,970\nSo when we work with a registry,\ngetting to the folder,\n\n104\n00:05:50,970 --> 00:05:52,600\nthat's only part of our battle.\n\n105\n00:05:52,600 --> 00:05:55,250\nThe other part is dealing\nwith the property.\n\n106\n00:05:55,250 --> 00:06:00,670\nNow, I used the DIR commands and\nthe CD, the change directory commands,\n\n107\n00:06:00,670 --> 00:06:03,360\nand that's the real problem\nwith what I was doing here.\n\n108\n00:06:03,360 --> 00:06:06,230\nThose map to something a little\nbit different, all right?\n\n109\n00:06:06,230 --> 00:06:11,829\nWhen you use CD, change directory,\nthat's actually mapped to Set-Location.\n\n110\n00:06:11,829 --> 00:06:14,290\nAll right.\nAnd if you think of what that means.\n\n111\n00:06:14,290 --> 00:06:17,440\nI'm just sending the location\nof mt current context.\n\n112\n00:06:17,440 --> 00:06:20,470\nSo where I'm running\ncommands from right now.\n\n113\n00:06:20,470 --> 00:06:24,883\nSo I set my location to HTLM\n\n114\n00:06:24,883 --> 00:06:29,806\n:\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\winlogon.\n\n115\n00:06:29,806 --> 00:06:37,205\nWhen I do DIR, DIR is actually alias for\nGet-ChildItem.\n\n116\n00:06:37,205 --> 00:06:38,135\nAll right.\n\n117\n00:06:38,135 --> 00:06:41,035\nAnd when you're running Get-ChildItem,\n\n118\n00:06:41,035 --> 00:06:45,740\nit's saying what's a child of\nthe current key that I'm in.\n\n119\n00:06:45,740 --> 00:06:49,370\nWell the properties,\nthose are properties of the current key,\n\n120\n00:06:49,370 --> 00:06:52,600\nthey're not children of the current key\nand that's why they don't show up, and\n\n121\n00:06:52,600 --> 00:06:55,020\nit's because of what DIR is mapped to.\n\n122\n00:06:55,020 --> 00:06:58,290\nSo instead, what I really need\nto use is not get-ChildItem,\n\n123\n00:06:58,290 --> 00:07:01,066\nI need to use get-ItemProperty.\n\n124\n00:07:01,066 --> 00:07:05,320\nGet-ItemProperty of the path that I'm in\n\n125\n00:07:05,320 --> 00:07:09,210\nwill show me that list of properties and\nthat's what we really expect to see here.\n\n126\n00:07:09,210 --> 00:07:09,810\nRight?\n\n127\n00:07:09,810 --> 00:07:15,340\nSo, if I do Get-ItemProperty and\nthen I need to tell it a path and\n\n128\n00:07:15,340 --> 00:07:20,400\nso I can specify .\\ that means the current\ndirectory, the one that I'm in.\n\n129\n00:07:20,400 --> 00:07:22,290\nIf I was somewhere else,\nI might have to write it out.\n\n130\n00:07:22,290 --> 00:07:23,750\nSo, I'll just do a .\\.\n\n131\n00:07:23,750 --> 00:07:28,290\nAnd now I get a list of all of\nthe properties that are inside of there.\n\n132\n00:07:28,290 --> 00:07:33,030\nSo that was Get-ItemProperty,\nfollowed by the path, I'm already in it.\n\n133\n00:07:33,030 --> 00:07:36,520\nSo now I can look down this list and\nI see all sorts of things,\n\n134\n00:07:36,520 --> 00:07:40,090\nlike DefaultDomainName, which is blank.\n\n135\n00:07:40,090 --> 00:07:44,880\nAnd if I go back over to the GUI, I can\nfind default domain name right there.\n\n136\n00:07:44,880 --> 00:07:46,230\nThat's the property.\n\n137\n00:07:46,230 --> 00:07:49,180\nAnd I can see that it's value is empty.\n\n138\n00:07:49,180 --> 00:07:52,199\nSo now I'm seeing what's on this screen.\n\n139\n00:07:52,199 --> 00:07:58,018\nSo on the left side that's set location,\nget-childitem.\n\n140\n00:07:58,018 --> 00:08:01,182\nOn the right side That\nis Get-ItemProperty,\n\n141\n00:08:01,182 --> 00:08:06,140\nthat's how we get those values and\nlook at what's in there.\n\n142\n00:08:06,140 --> 00:08:08,190\nSo a little bit different\nthan what we're used to.\n\n143\n00:08:09,280 --> 00:08:13,440\nThe other thing to keep in mind is\nthat I navigated into that directory.\n\n144\n00:08:13,440 --> 00:08:16,500\nWe're not always gonna be there,\nwe're not always gonna have that.\n\n145\n00:08:16,500 --> 00:08:20,570\nSo, for example, I might,\nlet me just put it back here.\n\n146\n00:08:20,570 --> 00:08:23,290\nI'm gonna change back to my C: drive,\nright?\n\n147\n00:08:23,290 --> 00:08:24,984\nSo when I launch the PowerShell,\n\n148\n00:08:24,984 --> 00:08:27,898\nit's usually gonna default\nto my user profile, right?\n\n149\n00:08:27,898 --> 00:08:36,185\nSo I might be somewhere like this,\nActually,\n\n150\n00:08:36,185 --> 00:08:39,023\nit would normally start like right in my\nprofile, so something like that, right?\n\n151\n00:08:39,023 --> 00:08:42,700\nSo I fire up a new PowerShell,\nand here I am, right?\n\n152\n00:08:42,700 --> 00:08:46,759\nAnd if I want to query\nthose registry key values,\n\n153\n00:08:46,759 --> 00:08:53,106\nI can still do Get-ItemProperty but\nthe path is gonna be a lot more complex.\n\n154\n00:08:53,106 --> 00:08:55,570\nAnd you know it's an optional modifier,\n-Path.\n\n155\n00:08:55,570 --> 00:08:56,420\nYou don't have to put that there,\n\n156\n00:08:56,420 --> 00:08:59,430\ncuz it assumes you're gonna provide\nthe path next, but I'll do it.\n\n157\n00:08:59,430 --> 00:09:01,120\nAnd then you can specify that path.\n\n158\n00:09:01,120 --> 00:09:06,358\nAnd so I could say, HKLM,\nH-key local machine,\n\n159\n00:09:06,358 --> 00:09:11,478\n\\Software\\Microsoft\\Windows NT, shoot,\n\n160\n00:09:11,478 --> 00:09:18,460\nI've got a space, so I gotta go back\nhere and throw in a quote mark,\n\n161\n00:09:18,460 --> 00:09:23,730\n\\Currentversion\\winlogon, like that.\n\n162\n00:09:23,730 --> 00:09:26,650\nAnd now it's gonna give me\nthose properties for that path.\n\n163\n00:09:27,660 --> 00:09:29,970\nSo I can run that and there they are.\n\n164\n00:09:29,970 --> 00:09:33,910\nSo I don't have to navigate to that\nother folder if I don't want to.\n\n165\n00:09:33,910 --> 00:09:38,197\nBut if I don't navigate to it then I am\ngoing to have to lay out that full path\n\n166\n00:09:38,197 --> 00:09:39,315\nthat's in there.\n\n167\n00:09:39,315 --> 00:09:41,220\nAnd the same thing goes for\nthe regular user.\n\n168\n00:09:41,220 --> 00:09:45,198\nIf I want to see programs\nthat run when I log in,\n\n169\n00:09:45,198 --> 00:09:51,940\nthings that auto run well I could do\nGet-ItemProperty like we saw moment ago.\n\n170\n00:09:51,940 --> 00:09:53,773\nLet me move that up on my screen.\n\n171\n00:09:53,773 --> 00:09:59,891\nBut I'm gonna change this a little bit,\nbecause I want it to be HKCU,\n\n172\n00:09:59,891 --> 00:10:05,169\nH Key Current User\n\\Software\\Microsoft\\Windows, and\n\n173\n00:10:05,169 --> 00:10:11,731\nactually I need to get rid of the NT\non this one, \\CurrentVersion\\Run.\n\n174\n00:10:11,731 --> 00:10:16,773\nAnything in that folder, when I log into\nWindows, is going to run as I log in.\n\n175\n00:10:16,773 --> 00:10:20,730\nAnd so here I'm pulling up the item\nproperty for that, and there's nothing.\n\n176\n00:10:20,730 --> 00:10:24,106\nNothing on my system is set to run\nwhen I log in, so that's cool.\n\n177\n00:10:24,106 --> 00:10:27,490\nSo I've got that, and\nI can query it and pull it up.\n\n178\n00:10:27,490 --> 00:10:28,023\nAll right?\n\n179\n00:10:28,023 --> 00:10:33,079\nThis is the way that most of us are gonna\nreference those registry entries and\n\n180\n00:10:33,079 --> 00:10:37,273\nthat's making use of that\nPowerShell drive for the registry.\n\n181\n00:10:37,273 --> 00:10:40,691\nAll right, there is actually\nanother way to write this,\n\n182\n00:10:40,691 --> 00:10:45,300\nlike a long hand way of doing it,\nwithout using the PowerShell drive.\n\n183\n00:10:45,300 --> 00:10:48,310\nThat little shortcut right there actually\nexplodes out into something very,\n\n184\n00:10:48,310 --> 00:10:49,260\nvery large.\n\n185\n00:10:49,260 --> 00:10:53,120\nIf I wanted to type the full syntax for\nthis it's actually a bit different.\n\n186\n00:10:53,120 --> 00:10:54,060\nLet me just show you guys.\n\n187\n00:10:54,060 --> 00:10:57,480\nYou probably won't do this in real\nlife because it is kind of annoying.\n\n188\n00:10:57,480 --> 00:10:58,980\nBut let me just show you so\n\n189\n00:10:58,980 --> 00:11:03,995\nthat you can know what that full syntax\nactually would be is it would be\n\n190\n00:11:03,995 --> 00:11:13,480\nMicrosoft.PowerShell.Core\\Registry.\n\n191\n00:11:13,480 --> 00:11:16,970\nSo that's me calling the calling\nthe actual, oh I'm spelling Core wrong.\n\n192\n00:11:16,970 --> 00:11:21,400\nThat's me calling the actual module that's\nallowing me to access the registry.\n\n193\n00:11:21,400 --> 00:11:25,901\nSo Microsoft.Powershell.Core\\Registry::\nand\n\n194\n00:11:25,901 --> 00:11:30,986\nthen I specify HKEY_Current,\nactually it's all capital,\n\n195\n00:11:30,986 --> 00:11:37,356\nit's not really case sensitive, but\nthey always write it in capitals here.\n\n196\n00:11:37,356 --> 00:11:44,440\nHKEY_CURRENT_USER\\Software\\Microsoft\\Wind-\nows\\CurrentVersion\\Run, right?\n\n197\n00:11:44,440 --> 00:11:45,960\nThat's where I'm looking.\n\n198\n00:11:45,960 --> 00:11:51,460\nSo, Microsoft PowerShell core/registry\nis the module that's loading it.\n\n199\n00:11:51,460 --> 00:11:56,160\nAnd then the :: says this is the path\nthat I want to send to that module.\n\n200\n00:11:56,160 --> 00:11:57,350\nAnd it gets this long path.\n\n201\n00:11:57,350 --> 00:12:01,190\nSo considerably longer command, I mean,\nI had to wrap around the screen for\n\n202\n00:12:01,190 --> 00:12:04,580\nthat one,\nversus using the PowerShell drive there.\n\n203\n00:12:04,580 --> 00:12:06,520\nThat saves you quite a bit.\n\n204\n00:12:06,520 --> 00:12:08,350\nBut the result is the same.\n\n205\n00:12:08,350 --> 00:12:09,310\nIt queries it.\n\n206\n00:12:09,310 --> 00:12:11,515\nI get that it's empty.\n\n207\n00:12:11,515 --> 00:12:13,924\nAll right.\nSo looking at these values is pretty\n\n208\n00:12:13,924 --> 00:12:15,820\nstraightforward, right?\n\n209\n00:12:15,820 --> 00:12:19,606\nWe go and we query them, we can see them,\nthey come up on the screen.\n\n210\n00:12:19,606 --> 00:12:20,940\nSo that's cool.\n\n211\n00:12:20,940 --> 00:12:24,560\n[LAUGH] But\nwhat if we wanna work with these more?\n\n212\n00:12:24,560 --> 00:12:26,630\nWell, we've gotta think about\nthe different ways that we\n\n213\n00:12:26,630 --> 00:12:28,380\nwork with the values that are on there.\n\n214\n00:12:28,380 --> 00:12:31,800\nOne of the things that\nwe're going to do is to\n\n215\n00:12:31,800 --> 00:12:34,630\nbasically query values like we saw here,\nand\n\n216\n00:12:34,630 --> 00:12:37,770\nactually there's a little problem\nwith the way that I'm querying this.\n\n217\n00:12:37,770 --> 00:12:43,470\nWhen I query something, like for\nexample when I queried winlogon,\n\n218\n00:12:43,470 --> 00:12:48,981\nit's pretty rare that you'll want\nto see all of the properties.\n\n219\n00:12:48,981 --> 00:12:53,440\nInside of the PowerShell you're normally\nlooking for one in particular, right?\n\n220\n00:12:53,440 --> 00:12:57,940\nLike, I wanna know what that default\ndomain is set to, or default username.\n\n221\n00:12:57,940 --> 00:13:01,356\nI wanna know what the default username is,\nor actually, let's do last used.\n\n222\n00:13:01,356 --> 00:13:04,856\nThis is one that I make\nuse of every now and then.\n\n223\n00:13:04,856 --> 00:13:09,740\nIn the active directory, it's hard to\ntell like who uses what computers.\n\n224\n00:13:09,740 --> 00:13:13,970\nAnd so I will often times write some\nscripts that will reach out there and\n\n225\n00:13:13,970 --> 00:13:16,950\nquery this, LastUsedUsername.\n\n226\n00:13:16,950 --> 00:13:20,193\nAnd that way it can tell me,\nI can like generate a quick report and\n\n227\n00:13:20,193 --> 00:13:22,835\nI can see who was the last\nuser on various machines and\n\n228\n00:13:22,835 --> 00:13:25,440\nnow I have an idea of what\nusers use what computers.\n\n229\n00:13:25,440 --> 00:13:28,335\nPut a person to a PC.\n\n230\n00:13:28,335 --> 00:13:33,630\nIf I want to query the LastUsedUsername\nof this system I can do it this way,\n\n231\n00:13:33,630 --> 00:13:35,240\nbut I get a lot of stuff, don't I?\n\n232\n00:13:35,240 --> 00:13:39,780\nI get a ton of information back here and\nvisually, yeah I can look and find it.\n\n233\n00:13:39,780 --> 00:13:43,270\nBut if if I'm trying to do this\nprogrammatically, all I want is Don Pezet.\n\n234\n00:13:43,270 --> 00:13:44,000\nThat's all I want.\n\n235\n00:13:44,000 --> 00:13:47,880\nI just want that name to come back and\nnot all this other stuff.\n\n236\n00:13:47,880 --> 00:13:51,315\nWell the default way of pulling that\nup isn't really gonna be adequate.\n\n237\n00:13:51,315 --> 00:13:56,180\nSo I'm gonna need feed it through some\nfilters to be able to achieve what I want.\n\n238\n00:13:57,250 --> 00:13:59,480\nWell there's a few different\nways to go about that and\n\n239\n00:13:59,480 --> 00:14:02,740\nI've got a couple of examples on\nhow you can kinda pare that down.\n\n240\n00:14:02,740 --> 00:14:07,148\nAnd get it a little more reasonable\nas far as what we're getting.\n\n241\n00:14:07,148 --> 00:14:11,750\nIf I wanna jump in here and\npull a very particular one,\n\n242\n00:14:11,750 --> 00:14:16,981\nwhat I can do is I can take this\nGet-ItemProperty that I ran.\n\n243\n00:14:16,981 --> 00:14:18,285\nI'm just gonna adjust my window here.\n\n244\n00:14:18,285 --> 00:14:21,165\nI don't want my head to be on top\nof this cuz it's gonna wrap around\n\n245\n00:14:21,165 --> 00:14:22,765\nthe screen again.\n\n246\n00:14:22,765 --> 00:14:24,585\nAnd there we go.\n\n247\n00:14:24,585 --> 00:14:27,615\nSo I'm gonna do this\nGet-ItemProperty -Path.\n\n248\n00:14:27,615 --> 00:14:30,435\nI'm pointing it at winlogon\njust like I did before.\n\n249\n00:14:30,435 --> 00:14:32,845\nThe difference here is I wanna take it and\nmodify it so\n\n250\n00:14:32,845 --> 00:14:34,460\nI only get that one value back.\n\n251\n00:14:35,565 --> 00:14:40,620\nSo what I'll do is I'm\ngonna put this command\n\n252\n00:14:40,620 --> 00:14:44,520\nin a little bit of a different context,\nall right?\n\n253\n00:14:44,520 --> 00:14:50,580\nI'm gonna say -Name, and I'm gonna specify\nexactly which one I'm looking for,\n\n254\n00:14:50,580 --> 00:14:54,325\nand I'm looking for the last,\nwhat was the actual name of it?\n\n255\n00:14:54,325 --> 00:15:01,148\nLastUsedUsername, LastUsedUsername.\n\n256\n00:15:01,148 --> 00:15:02,148\nThere we go.\n\n257\n00:15:02,148 --> 00:15:02,690\nAll right.\n\n258\n00:15:02,690 --> 00:15:06,423\nSo, I just extended that a little bit and\nnow it's diving in and\n\n259\n00:15:06,423 --> 00:15:08,320\ngetting just that property.\n\n260\n00:15:08,320 --> 00:15:09,100\nRight?\nSo, here it is.\n\n261\n00:15:09,100 --> 00:15:12,440\nLastUsedUsername, that's what I queried.\n\n262\n00:15:12,440 --> 00:15:14,356\nNow, it did get some other\nstuff along with it.\n\n263\n00:15:14,356 --> 00:15:16,430\nThis is just provider information though.\n\n264\n00:15:16,430 --> 00:15:18,500\nAnd that will be ignored\nby most commands but\n\n265\n00:15:18,500 --> 00:15:21,670\nI did just get LastUsedUsername Don Pezet.\n\n266\n00:15:21,670 --> 00:15:23,106\nBut it's still not perfect.\n\n267\n00:15:23,106 --> 00:15:27,190\nBecause even if it had just given me this\none line I don't need this other text.\n\n268\n00:15:27,190 --> 00:15:31,590\nI want to return just Don Pezet and\nthat's it.\n\n269\n00:15:31,590 --> 00:15:35,728\nBut, it doesn't do that by default,\nit displays all of this other garbage.\n\n270\n00:15:35,728 --> 00:15:39,760\nSo, I'm gonna modify my command once more,\nI'm going to take the command\n\n271\n00:15:39,760 --> 00:15:43,157\nas it's written, and\nI'm going to surround it in parentheses.\n\n272\n00:15:45,040 --> 00:15:49,410\nSo, by sticking it in parentheses\nPowerShell knows that I'm treating this as\n\n273\n00:15:49,410 --> 00:15:50,348\none big object.\n\n274\n00:15:50,348 --> 00:15:55,668\nSo, that's one big object, go and get that\ndata, and then I'm going to add a dot,\n\n275\n00:15:55,668 --> 00:16:00,389\nwhich is what tells it, get that data and\njust give me a particular piece.\n\n276\n00:16:00,389 --> 00:16:07,249\nAnd I'm going to tell it I want\njust The last used username.\n\n277\n00:16:07,249 --> 00:16:08,408\nThere we go.\n\n278\n00:16:08,408 --> 00:16:09,300\nAll right.\n\n279\n00:16:09,300 --> 00:16:11,850\nSo, it's kind of a double query.\n\n280\n00:16:11,850 --> 00:16:15,390\nI'm querying the registry to\npull the last used username, and\n\n281\n00:16:15,390 --> 00:16:20,090\nthen I'm querying my output to give\nme just the last used username.\n\n282\n00:16:20,090 --> 00:16:23,370\nIt's almost like a pipe command,\nbut it's not piping two commands.\n\n283\n00:16:23,370 --> 00:16:27,170\nThis is all done in one command,\nit's very efficient, runs pretty quick.\n\n284\n00:16:27,170 --> 00:16:31,550\nAnd when I run that now\nI get just my name back.\n\n285\n00:16:31,550 --> 00:16:32,990\nI just get Don Pazet.\n\n286\n00:16:34,190 --> 00:16:38,920\nSo the cool part there is I can take\nsomething like this big long command and\n\n287\n00:16:38,920 --> 00:16:41,360\nwe can take it and store it in a variable.\n\n288\n00:16:41,360 --> 00:16:49,040\nSo I could say like $pcuser Equals that,\nright?\n\n289\n00:16:49,040 --> 00:16:54,777\nAnd now if I ever do a Write-Host $pcuser,\n\n290\n00:16:54,777 --> 00:17:00,020\nit's just gonna echo that, Don Pezet,\nright, so that's all I get back.\n\n291\n00:17:00,020 --> 00:17:01,800\nSo it does require a little\nbit of manipulation.\n\n292\n00:17:01,800 --> 00:17:06,230\nIf you're just trying to pull the value\nout of a particular registry key,\n\n293\n00:17:06,230 --> 00:17:07,550\nthat's the easiest way to do it.\n\n294\n00:17:07,550 --> 00:17:09,240\nThere are other ways to do it but\n\n295\n00:17:09,240 --> 00:17:13,010\nthat's the easiest one that I've\nfound over the last several years.\n\n296\n00:17:13,010 --> 00:17:15,730\nSo that gives me exactly\nthe information I want.\n\n297\n00:17:15,730 --> 00:17:19,670\nNow I'm reading values out of the registry\nand I can do that right in my scripts.\n\n298\n00:17:19,670 --> 00:17:23,360\nI can check for things like this and\nI can report it back to wherever I need.\n\n299\n00:17:23,360 --> 00:17:25,310\nSo pretty neat stuff there.\n\n300\n00:17:25,310 --> 00:17:29,870\nI used to do this all the time where we'd\nhave a branch office that we were gonna do\n\n301\n00:17:29,870 --> 00:17:33,940\nmaintenance on, and if there was\na computer that I thought might be\n\n302\n00:17:33,940 --> 00:17:37,055\ninfected by a virus or\nI was gonna take offline for some reason.\n\n303\n00:17:37,055 --> 00:17:39,095\nI could query this and\nfind that last person who used it.\n\n304\n00:17:39,095 --> 00:17:40,503\nAnd I can reach out to them.\n\n305\n00:17:40,503 --> 00:17:42,605\nAnd I can say hey Bob or Sally or\n\n306\n00:17:42,605 --> 00:17:44,785\nwhatever, I need to take\nthat computer offline.\n\n307\n00:17:44,785 --> 00:17:46,115\nDo you share it with anybody else?\n\n308\n00:17:46,115 --> 00:17:47,405\nIf so, can you let them know too.\n\n309\n00:17:47,405 --> 00:17:48,695\nWe're taking that computer offline.\n\n310\n00:17:48,695 --> 00:17:50,970\nAnd so\nthat's how we keep people kind of posted.\n\n311\n00:17:52,700 --> 00:17:57,290\nAll right, so that's an example\nof querying a registry value.\n\n312\n00:17:57,290 --> 00:18:01,600\nBut what if we want to actually\nmodify one, or create one.\n\n313\n00:18:01,600 --> 00:18:05,110\nSo there's all sorts of different things\nwe can do there for creating things.\n\n314\n00:18:05,110 --> 00:18:07,080\nNow, typically we're not creating keys,\n\n315\n00:18:07,080 --> 00:18:10,870\nwe're not normally creating folders inside\nof the registry, we're typically creating\n\n316\n00:18:10,870 --> 00:18:14,100\nproperties, we're adding values or\nremoving values or whatever.\n\n317\n00:18:14,100 --> 00:18:17,610\nSo there's a few different\nways we can go about that.\n\n318\n00:18:17,610 --> 00:18:21,780\nWhen it comes to, let's see,\nwhat should we do first here?\n\n319\n00:18:21,780 --> 00:18:25,900\nLet's do, we could modify one I suppose.\n\n320\n00:18:25,900 --> 00:18:27,580\n>> We have a few different commands.\n\n321\n00:18:27,580 --> 00:18:32,440\nThey're all really the same,\nright so if I do Get-Command and\n\n322\n00:18:32,440 --> 00:18:34,130\nI look for *-ItemProperty, right?\n\n323\n00:18:35,860 --> 00:18:38,180\nSo the item properties\nare what we're manipulating.\n\n324\n00:18:38,180 --> 00:18:42,030\nAnd you'll see where we've got\nGet Item Property, New Item Property,\n\n325\n00:18:42,030 --> 00:18:43,090\nRemove Item Property.\n\n326\n00:18:43,090 --> 00:18:44,810\nThose are the three main ones that we use.\n\n327\n00:18:44,810 --> 00:18:45,340\nAlright?\n\n328\n00:18:45,340 --> 00:18:48,620\nSo I just used get item\nproperty to query one.\n\n329\n00:18:48,620 --> 00:18:51,530\nI could use New Item Property\nto make a new one and\n\n330\n00:18:51,530 --> 00:18:55,330\nI just need to tell it the path and\nthe value, you specify that.\n\n331\n00:18:55,330 --> 00:18:59,080\nAnd then the Set-ItemProperty,\nthat's how I populate it.\n\n332\n00:18:59,080 --> 00:19:01,500\nThat's how I give that property a value.\n\n333\n00:19:01,500 --> 00:19:03,992\nSo, if I want to do define a registry key,\n\n334\n00:19:03,992 --> 00:19:09,311\nit's Set-ItemProperty that I'm making use\nof to do that, to put that value in there.\n\n335\n00:19:09,311 --> 00:19:12,840\nSo, we've got a number of different\n\n336\n00:19:12,840 --> 00:19:15,800\nthings that we might choose\nto put in place or mess with.\n\n337\n00:19:15,800 --> 00:19:18,400\nLet's start by, maybe we'll remove one.\n\n338\n00:19:18,400 --> 00:19:22,300\nSo that default domain policy,\nif I want to get rid of that one.\n\n339\n00:19:22,300 --> 00:19:23,020\nIf I go back here.\n\n340\n00:19:23,020 --> 00:19:26,920\nWhen you log into Windows,\nthere's a default domain that it uses.\n\n341\n00:19:26,920 --> 00:19:28,030\nAnd you'll see mine's blank.\n\n342\n00:19:28,030 --> 00:19:29,200\nI don't have one set.\n\n343\n00:19:29,200 --> 00:19:31,200\nSo I'm not worried about\nlosing any data there.\n\n344\n00:19:31,200 --> 00:19:32,810\nSo if I wanna get that value out of there.\n\n345\n00:19:32,810 --> 00:19:36,180\nI just wanna take that property out and\nget it done with.\n\n346\n00:19:36,180 --> 00:19:41,990\nI can go in here and\nI can say Remove-ItemProperty and\n\n347\n00:19:41,990 --> 00:19:43,520\nthen I need to specify the property.\n\n348\n00:19:43,520 --> 00:19:46,380\nNow this is where things do get\na little bit challenging because\n\n349\n00:19:46,380 --> 00:19:48,240\nof how long these commands can be.\n\n350\n00:19:48,240 --> 00:19:51,460\nAnd if you've got like\na PowerShell drive set up.\n\n351\n00:19:51,460 --> 00:19:53,070\nYou can set up short cuts or\n\n352\n00:19:53,070 --> 00:19:57,570\nif you navigate to that folder that'll\nmake your commands a lot shorter too.\n\n353\n00:19:57,570 --> 00:20:00,630\nSo I'm gonna do that to save me some time.\n\n354\n00:20:00,630 --> 00:20:05,180\nI'm gonna just set my location\n\n355\n00:20:05,180 --> 00:20:10,257\nto HKLM\\Software\\Microsoft,\n\n356\n00:20:10,257 --> 00:20:13,763\nand we need Windows NT.\n\n357\n00:20:16,165 --> 00:20:24,060\n\\CurrentVersion\\Winlogon, which we'll\nget to eventually, there, all right.\n\n358\n00:20:24,060 --> 00:20:27,150\nSo by changing my path, now when I start\nto run these commands, I don't have to\n\n359\n00:20:27,150 --> 00:20:32,830\nspecify a big long path, I can just say\n./, ./ meaning the current directory.\n\n360\n00:20:32,830 --> 00:20:33,849\nThat's what I'm working in.\n\n361\n00:20:33,849 --> 00:20:36,500\nAll right, so if I wanna wipe one out,\n\n362\n00:20:36,500 --> 00:20:41,532\nI can say Remove-ItemProperty.\n\n363\n00:20:41,532 --> 00:20:43,370\nAll right, so\nI tell it I'm wiping one out.\n\n364\n00:20:43,370 --> 00:20:46,930\nI need to tell it the path, but\ntha path is easy for me now, right,\n\n365\n00:20:46,930 --> 00:20:49,310\nbecause the path, in this case,\nis right here, right?\n\n366\n00:20:49,310 --> 00:20:52,380\nSo the property is right in\nthe folder that I'm in and\n\n367\n00:20:52,380 --> 00:20:54,990\nI need to tell it which\none I'm getting rid of.\n\n368\n00:20:54,990 --> 00:20:58,555\nAnd so in my case I want\nto get rid of the default.\n\n369\n00:21:01,355 --> 00:21:05,200\nDomain, which I believe\nis what it was called.\n\n370\n00:21:05,200 --> 00:21:09,340\nIt was right here I got whoops,\nI got my GUI in the background,\n\n371\n00:21:09,340 --> 00:21:10,380\nI can just look there.\n\n372\n00:21:10,380 --> 00:21:12,240\nDefault Domain Name,\nthat's what it was called.\n\n373\n00:21:13,720 --> 00:21:17,640\nSo, I'm just letting it know here that\nI want to remove that item property.\n\n374\n00:21:17,640 --> 00:21:21,425\nThe path is right here in this\ndirectory that I'm in and\n\n375\n00:21:21,425 --> 00:21:25,920\nthe property needs to specified\nseparate from the path.\n\n376\n00:21:25,920 --> 00:21:29,000\nSo I need to say -Name, there we go.\n\n377\n00:21:29,000 --> 00:21:32,970\nSo, the path is right here in this folder,\nthis key that I'm in and then -Name.\n\n378\n00:21:32,970 --> 00:21:37,060\nThe name of the property I want to\nget rid of is default domain name.\n\n379\n00:21:37,060 --> 00:21:38,130\nSo I'll run that.\n\n380\n00:21:38,130 --> 00:21:40,220\nYou don't get a lot of\nfeedback on this command, so\n\n381\n00:21:40,220 --> 00:21:42,000\nit's always a good idea to verify, right.\n\n382\n00:21:42,000 --> 00:21:43,010\nSo it did something.\n\n383\n00:21:43,010 --> 00:21:45,290\nIt moved to the a next line and\ndidn't give me an error.\n\n384\n00:21:45,290 --> 00:21:47,509\nSo I probably need to\ndo a Get-ItemProperty.\n\n385\n00:21:49,110 --> 00:21:52,070\nAnd I can just look for\nthe path right here.\n\n386\n00:21:52,070 --> 00:21:55,480\nAnd I'm just going to look and\nsee if I have that default domain name.\n\n387\n00:21:55,480 --> 00:22:00,380\nI see default user name right there,\nbut default domain name is now gone.\n\n388\n00:22:00,380 --> 00:22:02,320\nI've removed that item property.\n\n389\n00:22:02,320 --> 00:22:03,000\nAll right.\n\n390\n00:22:03,000 --> 00:22:07,580\nSo that was just\nRemove-ItemProperty -Path and\n\n391\n00:22:07,580 --> 00:22:10,420\nI didn't have to type anything crazy\ncuz I'm already in the folder.\n\n392\n00:22:10,420 --> 00:22:12,100\nAnd then -Name, the name of the property.\n\n393\n00:22:14,710 --> 00:22:16,360\nNow if I want to create an item property,\n\n394\n00:22:16,360 --> 00:22:19,720\nif I wanna put that one back in,\nit's just New-ItemProperty.\n\n395\n00:22:19,720 --> 00:22:22,938\nSo pretty easy, same basic syntax too.\n\n396\n00:22:22,938 --> 00:22:27,370\nIf we New-ItemProperty,\nwe can then go through and\n\n397\n00:22:27,370 --> 00:22:29,450\nspecify all the various criteria or\n\n398\n00:22:29,450 --> 00:22:33,304\nwhatever it is that we need to have in\nthere to get that one put back in place.\n\n399\n00:22:33,304 --> 00:22:35,449\nI'll say -Path .\\, right,\n\n400\n00:22:35,449 --> 00:22:39,751\nit's gonna be in this particular\nfolder that I'm in right now.\n\n401\n00:22:39,751 --> 00:22:44,710\nThe -Name which will be DefaultDomainName,\nall right?\n\n402\n00:22:44,710 --> 00:22:46,950\nThat's the name of\nthe value I'm modifying.\n\n403\n00:22:46,950 --> 00:22:50,300\nAnd then here I can actually\nspecify the value if I've got it.\n\n404\n00:22:50,300 --> 00:22:52,600\nYou know,\nI might not know what I want yet.\n\n405\n00:22:52,600 --> 00:22:55,860\nI can just say -Value and\nthen what I want that value to be.\n\n406\n00:22:55,860 --> 00:23:01,060\nSo my domain name is \"ITPROTVNET\" and\nso I'll punch that in there.\n\n407\n00:23:01,060 --> 00:23:06,630\nAnd now it's gonna create\nthe default domain name property and\n\n408\n00:23:06,630 --> 00:23:08,120\nset its value to ITPROTVNET.\n\n409\n00:23:08,120 --> 00:23:12,430\nAnd if I look back here,\nI can refresh this screen.\n\n410\n00:23:14,518 --> 00:23:16,940\nNow let's see.\n\n411\n00:23:16,940 --> 00:23:17,970\nDoes it not let me do a refresh?\n\n412\n00:23:19,700 --> 00:23:23,360\nWe'll do the old F5,\nsince I don't have a menu item.\n\n413\n00:23:23,360 --> 00:23:28,080\nBut I can see now default domain name\nis showing as being ITPROTVNET ,right?\n\n414\n00:23:28,080 --> 00:23:32,270\nNow the default thing that it does\nis it creates a string value.\n\n415\n00:23:32,270 --> 00:23:34,400\nSee how it says reg sz.\n\n416\n00:23:34,400 --> 00:23:36,910\nSo it created a string value.\n\n417\n00:23:36,910 --> 00:23:37,870\nBut you don't always want that.\n\n418\n00:23:37,870 --> 00:23:42,820\nNotice how we've got d words up here,\nwhen you create a registry property\n\n419\n00:23:42,820 --> 00:23:44,390\nthere's several different\ntypes that you can make.\n\n420\n00:23:44,390 --> 00:23:48,400\nStrings, binaries, D-words, Q-words,\nall sorts of different stuff.\n\n421\n00:23:48,400 --> 00:23:52,786\nSo the default is a string and most of\nthe stuff in the registry is that way, but\n\n422\n00:23:52,786 --> 00:23:53,948\nnot everything is.\n\n423\n00:23:53,948 --> 00:23:57,877\nSo when you're creating one if you\nneed one of those other types,\n\n424\n00:23:57,877 --> 00:24:02,249\nwell you'll need to specify that too\nalongside of this so that it knows.\n\n425\n00:24:02,249 --> 00:24:07,169\nAnd the way you do that\nis with -PropertyType.\n\n426\n00:24:07,169 --> 00:24:08,349\nAnd then what that type is.\n\n427\n00:24:08,349 --> 00:24:11,781\nNow, I created a string, so\nI could say property type string, but\n\n428\n00:24:11,781 --> 00:24:12,960\nthat's the default.\n\n429\n00:24:12,960 --> 00:24:14,280\nSo, that's why I didn't specify it.\n\n430\n00:24:14,280 --> 00:24:16,440\nBut, just in case you need to\ncreate a d-word or whatever,\n\n431\n00:24:16,440 --> 00:24:20,570\nyou would say property type d-word and\nit would know to create that instead.\n\n432\n00:24:22,520 --> 00:24:23,260\nAll right.\n\n433\n00:24:23,260 --> 00:24:29,002\nSo, if that record already existed,\ninstead of new-item property,\n\n434\n00:24:29,002 --> 00:24:32,710\nI would simply say, set-item property.\n\n435\n00:24:32,710 --> 00:24:34,640\nRight?\nThat's how we modify one.\n\n436\n00:24:34,640 --> 00:24:37,630\nIf I were to take this command here,\nand I wanted to change it,\n\n437\n00:24:37,630 --> 00:24:41,380\nmaybe I've got ITProTVNET,\nand I want to change that to,\n\n438\n00:24:43,180 --> 00:24:46,490\nwe'll just do workgroup Right?\n\n439\n00:24:46,490 --> 00:24:48,910\nSo I want that default\ndomain to be workgroup.\n\n440\n00:24:48,910 --> 00:24:54,130\nI can take this same command and\njust say Set-ItemProperty.\n\n441\n00:24:54,130 --> 00:24:55,220\nThe path is right here,\n\n442\n00:24:55,220 --> 00:24:59,320\nthe name is DefaultDomainName and\nthe value is going to be workgroup.\n\n443\n00:24:59,320 --> 00:25:02,330\nAnd that's gonna set it\nbecause it already exists.\n\n444\n00:25:02,330 --> 00:25:06,930\nAnd so if I go into here and I refresh\nthat I can see that now it's changed.\n\n445\n00:25:06,930 --> 00:25:09,650\nIt's set to workgroup.\n\n446\n00:25:09,650 --> 00:25:17,100\nSo that's creating a property, deleting\na property, and changing a property.\n\n447\n00:25:17,100 --> 00:25:20,160\nAnd those are the three things\nthat we do most of the time.\n\n448\n00:25:20,160 --> 00:25:24,920\nSo you're running a script, and\nyou might create a registry key, so\n\n449\n00:25:24,920 --> 00:25:26,490\nit's doing something.\n\n450\n00:25:26,490 --> 00:25:30,160\nYou then change it to populate it with\nvalues while your script is running and\n\n451\n00:25:30,160 --> 00:25:33,490\nthen when your script is all done,\nyou might remove those registry values.\n\n452\n00:25:33,490 --> 00:25:35,950\nThose three operations,\nthose happen all the time.\n\n453\n00:25:37,410 --> 00:25:39,150\nYou may also need to go through and\n\n454\n00:25:39,150 --> 00:25:41,420\nquery the values to verify\nthat they're there, and\n\n455\n00:25:41,420 --> 00:25:43,950\nthat's where we use that get-ItemProperty\nthat I showed you earlier.\n\n456\n00:25:45,160 --> 00:25:49,660\nAnd so if I want to modify that with\nthis syntax earlier when I did that.\n\n457\n00:25:49,660 --> 00:25:50,700\nLet's see where is my example.\n\n458\n00:25:50,700 --> 00:25:51,630\nHere.\n\n459\n00:25:51,630 --> 00:25:52,520\nThis example was much,\n\n460\n00:25:52,520 --> 00:25:56,990\nmuch longer than I need it to be\nbecause I'm already in that path.\n\n461\n00:25:56,990 --> 00:25:59,440\nSo I could shorten that a good bit.\n\n462\n00:25:59,440 --> 00:26:06,305\nAnd I could say Get-ItemProperty -Path and\nthen point that to the local directory and\n\n463\n00:26:06,305 --> 00:26:10,264\nthen -Name,\nI want to to be DefaultDomainName.\n\n464\n00:26:13,105 --> 00:26:17,323\nAnd then I'm going to tell it that\nI just want default domain name and\n\n465\n00:26:17,323 --> 00:26:19,920\nnot all that other stuff until I query it.\n\n466\n00:26:19,920 --> 00:26:20,540\nAnd there we go.\n\n467\n00:26:20,540 --> 00:26:22,010\nI got work group, right?\n\n468\n00:26:22,010 --> 00:26:26,560\nSo those four commands right there:\ncreating a key modifying a key, or\n\n469\n00:26:26,560 --> 00:26:31,280\nsorry not keys, creating a property,\nmodifying a property, deleting a property,\n\n470\n00:26:31,280 --> 00:26:35,080\nthose are pretty important, and\nthen querying, or getting the property.\n\n471\n00:26:35,080 --> 00:26:38,535\nThose four things are what we\nnormally do inside of our scripts.\n\n472\n00:26:38,535 --> 00:26:39,385\nAll right?\n\n473\n00:26:39,385 --> 00:26:41,635\nNow you can do the keys also.\n\n474\n00:26:41,635 --> 00:26:45,185\nWith the keys you just use\nyour regular director command.\n\n475\n00:26:45,185 --> 00:26:48,545\nSo if I want to make my own sub-folder,\nfor\n\n476\n00:26:48,545 --> 00:26:53,335\nexample, if I've got let's see.\n\n477\n00:26:55,160 --> 00:27:00,610\nIf I want to create my own software\npackage, right, so I might have DonCo.\n\n478\n00:27:00,610 --> 00:27:01,390\nRIght?\n\n479\n00:27:01,390 --> 00:27:05,730\nAnd so, I just created a DonCo folder\nby using MKDIR, make directory.\n\n480\n00:27:05,730 --> 00:27:09,120\nRIght?\nAnd make directory, if I do get-alias,\n\n481\n00:27:09,120 --> 00:27:13,990\nyou can see that that's really just mapped\nto, apparently it mapped to nothing.\n\n482\n00:27:15,850 --> 00:27:16,810\nWell that's interesting.\n\n483\n00:27:17,930 --> 00:27:20,680\nAnyhow it's just should be\nmapped to new-child item.\n\n484\n00:27:20,680 --> 00:27:21,990\nThat may just be something\nthat's built in.\n\n485\n00:27:21,990 --> 00:27:25,090\nI always assumed that was an alias.\n\n486\n00:27:25,090 --> 00:27:31,170\nBasically it's, hm MD is [INAUDIBLE]\nI guess is its own little command.\n\n487\n00:27:31,170 --> 00:27:32,930\nI learned something new everyday I guess.\n\n488\n00:27:32,930 --> 00:27:35,320\nBut I can make those keys really easy.\n\n489\n00:27:35,320 --> 00:27:37,780\nI don't have to do any crazy long syntax\n\n490\n00:27:37,780 --> 00:27:40,550\nbecause the PowerShell drive\nlets me do it, all right.\n\n491\n00:27:40,550 --> 00:27:44,065\nBut I could if I wanted\nto do it the long way.\n\n492\n00:27:44,065 --> 00:27:47,435\nI could do the new-child item and\n\n493\n00:27:47,435 --> 00:27:51,725\nthen specify that path and layout that\nnew folder and kind of go that route too.\n\n494\n00:27:51,725 --> 00:27:52,755\nThey're both effective.\n\n495\n00:27:52,755 --> 00:27:54,635\nThis is just considerably simpler.\n\n496\n00:27:54,635 --> 00:27:58,090\nAnd we get that created, so now I've\ngot a DonCo folder inside of Software.\n\n497\n00:27:58,090 --> 00:28:02,829\nAnd now I can start to create all\nthe values that I needed by doing\n\n498\n00:28:02,829 --> 00:28:08,108\nthe new-ItemProperty, and\nthen specifying the path of right here,\n\n499\n00:28:08,108 --> 00:28:13,940\nand then specifying the name of the\nItemProperty, and the value, and so on.\n\n500\n00:28:13,940 --> 00:28:17,762\nSo maybe I have a property\ncalled Registered, so\n\n501\n00:28:17,762 --> 00:28:22,798\nI'm checking whether people have\nregistered my software, and\n\n502\n00:28:22,798 --> 00:28:28,204\nthe value for it might be false by\ndefault, so I can get that created,\n\n503\n00:28:28,204 --> 00:28:35,360\nand now it's in there, and now I can query\nthat see if people registered my software.\n\n504\n00:28:35,360 --> 00:28:39,990\nAnd then one day somebody can figure out\nmy cheesy registration scheme and go and\n\n505\n00:28:39,990 --> 00:28:41,880\nchange that to true and not pay me.\n\n506\n00:28:41,880 --> 00:28:46,470\nSo that's the basics right there of\nmessing with those records and values.\n\n507\n00:28:46,470 --> 00:28:47,710\nPretty straightforward.\n\n508\n00:28:47,710 --> 00:28:49,950\nThe only tricky part about this is\njust that most people don't know\n\n509\n00:28:49,950 --> 00:28:50,510\nabout it, right?\n\n510\n00:28:50,510 --> 00:28:52,360\nAnd it's really easy to get in there and\n\n511\n00:28:52,360 --> 00:28:55,180\nwork with the registry all from\ninside of the power shell.\n\n512\n00:28:55,180 --> 00:28:59,110\nNow, in real life land,\nif I want to modify a registry value\n\n513\n00:28:59,110 --> 00:29:02,742\nI will almost always just go right here\ninto regedit and do it via the GUI.\n\n514\n00:29:03,970 --> 00:29:07,660\nSo, the time that we make use of it\nhere in the PowerShell is when we want\n\n515\n00:29:07,660 --> 00:29:08,940\nto automate things.\n\n516\n00:29:08,940 --> 00:29:11,760\nWhen you want to run a script and\nhave it manipulate some values.\n\n517\n00:29:11,760 --> 00:29:16,230\nWhen you want to set things,\nlike that default domain name.\n\n518\n00:29:16,230 --> 00:29:19,190\nIf you're in a multi-domain environment,\n\n519\n00:29:19,190 --> 00:29:22,190\nwhen somebody logs in they can\nchoose from the different domains.\n\n520\n00:29:22,190 --> 00:29:24,330\nWell, you might want to\nset their default one, and\n\n521\n00:29:24,330 --> 00:29:27,090\nyou might need to set that\nacross a thousand computers.\n\n522\n00:29:27,090 --> 00:29:28,050\nYou don't want to go to each one.\n\n523\n00:29:28,050 --> 00:29:31,520\nYou could do a group policy object, but\n\n524\n00:29:31,520 --> 00:29:34,460\nif it's an environment where\nyou don't have that control or\n\n525\n00:29:34,460 --> 00:29:37,660\nthat ability you could also just\ndo it through a PowerShell script.\n\n526\n00:29:37,660 --> 00:29:40,380\nAnd you could do it just like this,\npush it along, and\n\n527\n00:29:40,380 --> 00:29:42,830\nnow all those machines get\ntheir default value set.\n\n528\n00:29:42,830 --> 00:29:45,930\nSo pretty cool stuff, pretty useful, and\n\n529\n00:29:45,930 --> 00:29:49,015\ndefinitely something that you'll\nmake use of out in your life land.\n\n530\n00:29:50,322 --> 00:29:52,960\nAll right, I think I've pretty much\ncovered everything that I wanted to.\n\n531\n00:29:52,960 --> 00:29:55,150\nLet me see if I missed\nanything in my notes here.\n\n532\n00:29:55,150 --> 00:29:56,910\nLooks like we got it all.\n\n533\n00:29:56,910 --> 00:30:02,220\nSo In this segment, we got a chance to see\nhow to navigate inside of the registry,\n\n534\n00:30:02,220 --> 00:30:05,450\nbased on using the PowerShell\ndrive functionality.\n\n535\n00:30:05,450 --> 00:30:10,200\nWe got a chance to see how to query\nthe keys inside of the registry as well\n\n536\n00:30:10,200 --> 00:30:14,070\nas well as how to query the properties,\nso how to return the values for\n\n537\n00:30:14,070 --> 00:30:15,040\nthe properties.\n\n538\n00:30:15,040 --> 00:30:18,720\nAnd then lastly we saw how to create,\nchange, and\n\n539\n00:30:18,720 --> 00:30:23,830\nremove those same properties so that we\ncan support our software and our scripts.\n\n540\n00:30:23,830 --> 00:30:26,050\nAll right,\nhopefully you guys enjoyed that segment.\n\n541\n00:30:26,050 --> 00:30:29,035\nStay tuned,\nwe've got more PowerShell coming up.\n\n542\n00:30:29,035 --> 00:30:35,050\n[SOUND]\n\n",
          "vimeoId": "114693801"
        },
        {
          "description": "",
          "length": "1419",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-4-configuring_networking-010515.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-4-configuring_networking-010515-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-4-configuring_networking-010515-sm.jpg",
          "title": "Configuring Networking",
          "transcript": "1\n00:00:00,000 --> 00:00:08,164\n[MUSIC]\n\n2\n00:00:08,164 --> 00:00:11,781\nIn this segment, we're going to be taking\na look at configuring our network adaptors\n\n3\n00:00:11,781 --> 00:00:14,000\nwith using the Microsoft PowerShell.\n\n4\n00:00:14,000 --> 00:00:16,640\nNow I know for me, when I use PowerShell,\n\n5\n00:00:16,640 --> 00:00:18,730\na lot of times I try to get in and\nget out as fast as I can.\n\n6\n00:00:18,730 --> 00:00:22,270\nAnd not mess with it too much because\nI don't remember the commands.\n\n7\n00:00:22,270 --> 00:00:27,420\nAnd so with a new server, one of the first\nthings that I need to do is assign an IP\n\n8\n00:00:27,420 --> 00:00:30,740\naddress to it and open up some firewall\nports so I can remote manage it.\n\n9\n00:00:30,740 --> 00:00:34,840\nAnd then that's the end of me using\nPowerShell on a core server installer or\n\n10\n00:00:34,840 --> 00:00:35,630\nsomething like that.\n\n11\n00:00:35,630 --> 00:00:36,470\nSo.\nthose\n\n12\n00:00:36,470 --> 00:00:38,651\nare some of the things that we\nare going to take a look at here.\n\n13\n00:00:38,651 --> 00:00:39,770\n>> Yeah, cause you really have to.\n\n14\n00:00:39,770 --> 00:00:41,430\nWhen you first set up\nthat core installation,\n\n15\n00:00:41,430 --> 00:00:43,048\nyou know you are going to\nend up managing it remotely.\n\n16\n00:00:43,048 --> 00:00:47,290\nBut, you can't manage it remotely\nuntil you have set up your WinRM,\n\n17\n00:00:47,290 --> 00:00:48,240\nyour remote management.\n\n18\n00:00:48,240 --> 00:00:50,750\nSet up your firewall rules and\ngiven it a name, and\n\n19\n00:00:50,750 --> 00:00:53,740\ngiven it an IP address, conjoin it to\nthe domain and all that good stuff.\n\n20\n00:00:53,740 --> 00:00:56,810\nSo we've got to know those commands at\nleast to get that guy on the network,\n\n21\n00:00:56,810 --> 00:00:58,110\nget it manageable.\n\n22\n00:00:58,110 --> 00:01:02,350\nAnd then from then on we can use\nour remote management and our GUIs.\n\n23\n00:01:02,350 --> 00:01:06,190\nThank God. [LAUGH] >> Now the tricky\npart here is inside of the PowerShell\n\n24\n00:01:06,190 --> 00:01:09,900\nthere is more than one way to\nreference your network adapter.\n\n25\n00:01:09,900 --> 00:01:12,580\nSo we have a series of\ncommands that we can use,\n\n26\n00:01:12,580 --> 00:01:13,970\njust like all of the other\nPowerShell shows.\n\n27\n00:01:13,970 --> 00:01:17,740\nOur get commands, our set commands,\nour remove or whatever.\n\n28\n00:01:18,820 --> 00:01:21,490\nBut how do we reference which\nadapter we're working with?\n\n29\n00:01:21,490 --> 00:01:23,840\nBecause on a server you'll typically\nhave more than one adapter.\n\n30\n00:01:23,840 --> 00:01:25,300\nEven on a desktop or laptop though,\n\n31\n00:01:25,300 --> 00:01:28,190\nyou might have a wireless and\na wired adapter, Bluetooth.\n\n32\n00:01:28,190 --> 00:01:29,940\nRight, they all show up as adapters.\n\n33\n00:01:29,940 --> 00:01:31,830\nSo let's start with the real basics.\n\n34\n00:01:31,830 --> 00:01:33,920\nHow do we get information\nabout our network adapter?\n\n35\n00:01:35,000 --> 00:01:38,720\nWell, the first thing command we're gonna\nsee is the get-netadapter command and\n\n36\n00:01:38,720 --> 00:01:41,950\nif we just run that, here,\nI'll fire that up in my PowerShell.\n\n37\n00:01:41,950 --> 00:01:45,150\nI'll just run get-netadapter.\n\n38\n00:01:45,150 --> 00:01:48,420\nThat'll give me my list of network\nadapters that are in my system.\n\n39\n00:01:48,420 --> 00:01:52,480\nAnd I can see that I've gone one, it's an\nIntel 82574L gigabit network connection.\n\n40\n00:01:52,480 --> 00:01:56,130\n>> Nice [LAUGH]\n>> It's got a name,\n\n41\n00:01:56,130 --> 00:01:58,270\nin this case it's called local network.\n\n42\n00:01:58,270 --> 00:02:01,530\nIt's got a description,\nwhich is that big long run-on there.\n\n43\n00:02:01,530 --> 00:02:04,540\nIt's got an interface index, which is 12.\n\n44\n00:02:04,540 --> 00:02:05,838\nAnd, what is that?\n\n45\n00:02:05,838 --> 00:02:09,190\n>> [LAUGH]\n>> That's Microsoft just assigning\n\n46\n00:02:09,190 --> 00:02:11,000\na numerical identifier to your interface.\n\n47\n00:02:11,000 --> 00:02:13,750\nAnd they do that because,\nyou have a lot of virtual interfaces too,\n\n48\n00:02:13,750 --> 00:02:15,593\nlike your IPv6 tunnel interfaces.\n\n49\n00:02:15,593 --> 00:02:16,410\n>> Mm-hm, tunnel, yep.\n\n50\n00:02:16,410 --> 00:02:19,400\n>> They come and go and so you may or\nmay not have those numbers and\n\n51\n00:02:19,400 --> 00:02:21,290\nthey just give a simple\nway to reference them.\n\n52\n00:02:22,760 --> 00:02:25,490\n>> Yeah, that's a real good command\nto know cuz that one, like you said,\n\n53\n00:02:25,490 --> 00:02:27,250\ngives you the list of\neverything you've got.\n\n54\n00:02:27,250 --> 00:02:29,240\nAnd then you got your choice of\nhow you wanna reference that.\n\n55\n00:02:29,240 --> 00:02:30,250\nDo you wanna reference it by name or\n\n56\n00:02:30,250 --> 00:02:33,080\ndo you wanna reference\nit by that index number?\n\n57\n00:02:33,080 --> 00:02:36,270\nIt's also a reason I usually change\nthe names on most of my adapters.\n\n58\n00:02:36,270 --> 00:02:40,030\nTo something a little shorter,\nLAN1, LAN2 no spaces.\n\n59\n00:02:40,030 --> 00:02:43,170\nUnfortunately I still gotta use my\nquotes in PowerShell, in the prompt,\n\n60\n00:02:43,170 --> 00:02:45,110\nin the old school command prompt.\n\n61\n00:02:45,110 --> 00:02:46,270\nIf you didn't have any spaces in there,\n\n62\n00:02:46,270 --> 00:02:49,220\nthen you could get away without\nthe quotations around it.\n\n63\n00:02:49,220 --> 00:02:50,050\n>> Yeah, and you know that,\n\n64\n00:02:50,050 --> 00:02:52,740\nthat name, that was just\nthe automatically assigned one.\n\n65\n00:02:52,740 --> 00:02:54,940\nI didn't assign it.\n\n66\n00:02:54,940 --> 00:02:56,600\nIs my search anywhere not gonna work?\n\n67\n00:02:56,600 --> 00:02:59,370\nThere, network and sharing center.\n\n68\n00:02:59,370 --> 00:03:02,390\nSo, you know, if you go in your network\nand sharing center into your adapter,\n\n69\n00:03:02,390 --> 00:03:04,240\nsee how it's just called\nlocal network right there?\n\n70\n00:03:04,240 --> 00:03:09,846\nAnd I could rename that, you know,\ncall it IT Pro TV studio.\n\n71\n00:03:09,846 --> 00:03:15,174\n>> Now that's even longer than\nwhat you started with [LAUGH]\n\n72\n00:03:15,174 --> 00:03:17,003\n>> You know, it sort of is, isn't it.\n\n73\n00:03:17,003 --> 00:03:20,670\nSo heck maybe we just call it LAN.\n\n74\n00:03:20,670 --> 00:03:22,060\n>> Call it LAN one and\nLAN two, that's what I do.\n\n75\n00:03:22,060 --> 00:03:23,230\n>> Easy as possible.\n\n76\n00:03:23,230 --> 00:03:25,730\nSo then, that's what's being\nreturned right back here.\n\n77\n00:03:25,730 --> 00:03:30,040\nIf I do get-netadapter,\nnow it's got that nice short name of LAN.\n\n78\n00:03:30,040 --> 00:03:33,910\nThat does make a lot of the other\ncommands we're gonna run easier.\n\n79\n00:03:33,910 --> 00:03:35,760\nYou really have a couple of choices here.\n\n80\n00:03:35,760 --> 00:03:37,780\nAnd as we work with it you need to pick,\n\n81\n00:03:37,780 --> 00:03:40,530\ndo you want to go with\nthe interface index number?\n\n82\n00:03:40,530 --> 00:03:44,140\nThat's easy if you know the Interface\nindex number or you can query to get it.\n\n83\n00:03:44,140 --> 00:03:47,730\nOr do you want to use the named identifier\nadapter which can be easier because\n\n84\n00:03:47,730 --> 00:03:49,140\nthey're simple to remember.\n\n85\n00:03:49,140 --> 00:03:50,410\nBut it's up to you.\n\n86\n00:03:50,410 --> 00:03:52,750\nSo when you're watching this show,\n\n87\n00:03:52,750 --> 00:03:54,260\nif you're watching this\nlive you won't see this.\n\n88\n00:03:54,260 --> 00:03:56,940\nBut if you're watching this recorded\nyou'll see the show notes beneath\n\n89\n00:03:56,940 --> 00:04:00,930\nthe episode and\na lot of the commands we list twice.\n\n90\n00:04:00,930 --> 00:04:04,400\nOnce using the interface index number and\nonce using the name.\n\n91\n00:04:04,400 --> 00:04:06,990\nTwo different ways to run the same command\nbased on the information you know.\n\n92\n00:04:06,990 --> 00:04:11,020\nOne of the things I like\nto do with names is,\n\n93\n00:04:11,020 --> 00:04:16,680\nthe interface index number can vary\nfrom server to server to server.\n\n94\n00:04:16,680 --> 00:04:18,950\nBut if you take your server and\nyou say all right,\n\n95\n00:04:18,950 --> 00:04:20,660\nhere's gonna be my management\ninterface adapter.\n\n96\n00:04:20,660 --> 00:04:22,690\nAnd so I'm gonna rename it management.\n\n97\n00:04:22,690 --> 00:04:25,990\nSo now on all of your servers you\nhave an adapter called management.\n\n98\n00:04:25,990 --> 00:04:28,040\nThe index number might be\ndifferent on all of your servers,\n\n99\n00:04:28,040 --> 00:04:29,760\nbut the name is always management.\n\n100\n00:04:29,760 --> 00:04:32,910\nNow you can easily create one\nscript that can run on everywhere\n\n101\n00:04:32,910 --> 00:04:34,530\nbecause the name is always the same.\n\n102\n00:04:34,530 --> 00:04:38,070\nThe interface index number,\nto my knowledge you can't change but\n\n103\n00:04:38,070 --> 00:04:39,160\nyou might be able to.\n\n104\n00:04:39,160 --> 00:04:41,120\n>> No, I think it generates it and\nyou never really know.\n\n105\n00:04:41,120 --> 00:04:42,140\nIt does seem to start with 12.\n\n106\n00:04:42,140 --> 00:04:44,720\nI don't know why it starts\nwith that number but\n\n107\n00:04:44,720 --> 00:04:47,250\nI've seen where on just\nabout every machine I go to.\n\n108\n00:04:47,250 --> 00:04:50,340\nMultiple network adapters they start\nat 12, 13, 14 and work their way up.\n\n109\n00:04:50,340 --> 00:04:53,040\n>> They must reserve the others for\nsomething, who knows.\n\n110\n00:04:53,040 --> 00:04:58,169\nProbably SharePoint or\nMSN messenger [LAUGH].\n\n111\n00:04:58,169 --> 00:05:03,330\nAll right well, so now we've got some\nbasic information about our adapter.\n\n112\n00:05:03,330 --> 00:05:07,050\nAnd if we want wanna work with it, well\nwe've more get commands that we can use.\n\n113\n00:05:07,050 --> 00:05:08,670\nThere is more than what shows\nup here on this screen.\n\n114\n00:05:08,670 --> 00:05:10,780\nSee how my link speed is\nbeing truncated and all.\n\n115\n00:05:10,780 --> 00:05:16,550\nSo if we pipe that into format list,\nwe can see all the additional information.\n\n116\n00:05:16,550 --> 00:05:19,950\nI can see it's an 802.3 adapter, which\npretty much everything these days is.\n\n117\n00:05:19,950 --> 00:05:21,480\n>> Right.\nI can see that it's up.\n\n118\n00:05:21,480 --> 00:05:23,010\nIt's a 1-gig connector.\n\n119\n00:05:23,010 --> 00:05:26,970\nI can see that speed, and the driver\ninformation is attached there also.\n\n120\n00:05:28,500 --> 00:05:31,350\n>> Yeah, this git net adapter is\nreally giving me properties about\n\n121\n00:05:31,350 --> 00:05:32,150\nthe adapter itself.\n\n122\n00:05:32,150 --> 00:05:36,330\nThat's we're not seeing our TCPI settings\nand things like that, or IP address.\n\n123\n00:05:36,330 --> 00:05:38,580\nThat's not showing up in there\nthat's a different command.\n\n124\n00:05:38,580 --> 00:05:40,970\nIt was a git-net IP address, I think.\n\n125\n00:05:40,970 --> 00:05:41,710\nI don't know about you.\n\n126\n00:05:41,710 --> 00:05:43,940\nI still use ipconfig half\nthe time when I'm in PowerShell.\n\n127\n00:05:43,940 --> 00:05:45,610\n>> Yeah.\n>> It's actually shorter to type.\n\n128\n00:05:45,610 --> 00:05:49,055\nI know you can do your tab autofill and\nstuff like that.\n\n129\n00:05:49,055 --> 00:05:52,550\nBut, there's an alias for ipconfig, so\n\n130\n00:05:52,550 --> 00:05:54,195\nI can still use that\nright here in PowerShell.\n\n131\n00:05:54,195 --> 00:05:57,090\n>> Get-NetIPAddress.\n\n132\n00:05:57,090 --> 00:06:00,400\nAnd that returns all that\ninformation about what your IPs are.\n\n133\n00:06:00,400 --> 00:06:03,930\nAll right, so we get that information, we\ncan see it, we can start to work with it.\n\n134\n00:06:03,930 --> 00:06:07,330\nAnd some of the things that we're gonna\nwanna do are are things like adding new\n\n135\n00:06:07,330 --> 00:06:10,810\ninterfaces if we're tunneling or\nmodifying these interfaces.\n\n136\n00:06:10,810 --> 00:06:12,920\nAttaching IP addresses to an interface.\n\n137\n00:06:12,920 --> 00:06:16,360\nAnd so we've got our standard get and\nset commands that we use for that for\n\n138\n00:06:16,360 --> 00:06:18,390\nchanging and modifying things.\n\n139\n00:06:18,390 --> 00:06:22,090\nThe first one that I want\nto talk about is DHCP.\n\n140\n00:06:22,090 --> 00:06:26,540\nFor a lot of us this initial configuration\nis as simple as turning on DHCP.\n\n141\n00:06:26,540 --> 00:06:28,620\nAnd typically that's the default for\n\n142\n00:06:28,620 --> 00:06:32,750\nyour system, usually DHCP is already on\nand you don't have to worry about it.\n\n143\n00:06:32,750 --> 00:06:36,200\nBut let's say that I want to turn\non DHCP or I want to turn it off.\n\n144\n00:06:36,200 --> 00:06:38,230\nWell turning it off is just a matter\nof assigning a static, right?\n\n145\n00:06:38,230 --> 00:06:40,100\n>> Yeah cause really when\nyou first set up that core,\n\n146\n00:06:40,100 --> 00:06:41,790\nyou guys have all installed server before.\n\n147\n00:06:41,790 --> 00:06:43,830\nWhen we install server core for\nthe first time or\n\n148\n00:06:43,830 --> 00:06:46,760\nwhen we install server for the core,\nit's got that default configuration.\n\n149\n00:06:46,760 --> 00:06:50,040\nWhich means it's going to have\na generated name by Windows,\n\n150\n00:06:50,040 --> 00:06:54,490\nsome kind of Win dash blah blah blah, and\nit's gonna have a dynamic IP address.\n\n151\n00:06:54,490 --> 00:06:56,350\nIn most of our servers,\nwe're not gonna want that, right?\n\n152\n00:06:56,350 --> 00:06:58,270\nWe're gonna wanna statically map that.\n\n153\n00:06:58,270 --> 00:07:01,810\nSo, one of the first few commands we're\ngonna do is gonna be to statically map\n\n154\n00:07:01,810 --> 00:07:04,670\nthat IP address and to disable the DHCP.\n\n155\n00:07:05,780 --> 00:07:09,560\n>> Alright, so this command, we'll go\nahead and show some of the different ways\n\n156\n00:07:09,560 --> 00:07:12,160\nto run it with a different name and\ninterface index, and all that stuff.\n\n157\n00:07:12,160 --> 00:07:14,050\nFuture commands, we'll just show one way.\n\n158\n00:07:14,050 --> 00:07:19,230\nBut, let's say I wanna modify this\nwhen all I know is my interface name.\n\n159\n00:07:19,230 --> 00:07:21,390\nAll right, now this is how I am.\n\n160\n00:07:21,390 --> 00:07:24,420\nI'm gonna show you guys the command that\nI run, normally, first, which is not\n\n161\n00:07:24,420 --> 00:07:28,290\nnecessarily the easiest one, but\nit is based on what I can keep in my head.\n\n162\n00:07:28,290 --> 00:07:31,070\nI can remember the name of an adapter,\nand that's about it.\n\n163\n00:07:31,070 --> 00:07:37,410\nWhen you run get-netadapter, it actually\nreturns a list of all your adapters.\n\n164\n00:07:37,410 --> 00:07:41,100\nSo if I had five different net adapters\nthey'd all come back here, but\n\n165\n00:07:41,100 --> 00:07:42,660\nyou can add a little more to that.\n\n166\n00:07:42,660 --> 00:07:46,695\nYou can say get-netadapter and\nyou can specify an individual name.\n\n167\n00:07:46,695 --> 00:07:48,655\nNow I can remember that.\n\n168\n00:07:48,655 --> 00:07:51,125\nI know my adapter is called LAN.\n\n169\n00:07:51,125 --> 00:07:54,515\nThe output looks the same but\nit is actually filtered at this point so\n\n170\n00:07:54,515 --> 00:07:57,081\nI'm just seeing that one adapter.\n\n171\n00:07:57,081 --> 00:07:59,274\n>> Right.\n>> You can use pipelining to say,\n\n172\n00:07:59,274 --> 00:08:01,005\ntake that one adapter and\n\n173\n00:08:01,005 --> 00:08:06,619\npipe it into another command to modify\nsomething like whether DHCP is turned on.\n\n174\n00:08:06,619 --> 00:08:07,391\nOr not.\n\n175\n00:08:07,391 --> 00:08:10,998\nI do this because it means I don't\nhave to remember interface indexes,\n\n176\n00:08:10,998 --> 00:08:14,820\nI don't have to query to get it,\nit just kinda rolls it all into one.\n\n177\n00:08:14,820 --> 00:08:17,240\nGet this adapter, and take this action.\n\n178\n00:08:17,240 --> 00:08:20,561\nAnd the action I'm gonna\ntake is to disable DHCP.\n\n179\n00:08:20,561 --> 00:08:27,618\nSo I'll say Set-NetIPInterface\n-DHCP Disabled,\n\n180\n00:08:27,618 --> 00:08:33,900\nlike that, and\nthat's going to turn off DHCP.\n\n181\n00:08:33,900 --> 00:08:37,665\nNow, I got a permission denied message,\nbecause I didn't run my\n\n182\n00:08:37,665 --> 00:08:41,120\nPowerShell as an administrator,\nso it's a little mad at me here.\n\n183\n00:08:41,120 --> 00:08:42,750\nSo that's what that's error is all about.\n\n184\n00:08:42,750 --> 00:08:44,500\nSomewhere in here it'll say,\npermission denied.\n\n185\n00:08:44,500 --> 00:08:46,510\nI mean, you get access denied right there.\n\n186\n00:08:46,510 --> 00:08:49,515\nBut what I'll do is, I'll just copy\nthat because I'm a lazy typer.\n\n187\n00:08:49,515 --> 00:08:51,753\n>> [LAUGH]\n>> And I'll open up a new PowerShell\n\n188\n00:08:51,753 --> 00:08:55,100\nwindow, and\nthis time I will run it as administrator.\n\n189\n00:08:57,300 --> 00:08:58,020\nThere we go.\n\n190\n00:08:58,020 --> 00:08:59,580\nAnd we'll just repeat the same thing.\n\n191\n00:08:59,580 --> 00:09:02,970\nAnd we'll run it, and that's gonna\ndisable DHCP on that interface.\n\n192\n00:09:02,970 --> 00:09:05,676\nNow, I didn't assign a static IP,\nor did I?\n\n193\n00:09:05,676 --> 00:09:07,100\n>> No.\n\n194\n00:09:07,100 --> 00:09:07,930\nI don't think so.\n\n195\n00:09:07,930 --> 00:09:08,725\nNo.\n>> I don't remember now.\n\n196\n00:09:08,725 --> 00:09:09,260\n>> [LAUGH]\n>> So,\n\n197\n00:09:09,260 --> 00:09:11,560\nat this point I technically\ndon't have an IP address,\n\n198\n00:09:11,560 --> 00:09:13,100\nwhich is not a great place the be.\n\n199\n00:09:13,100 --> 00:09:14,190\n>> Right.\n\n200\n00:09:14,190 --> 00:09:17,948\n>> That is one way to run\na command on an adapter.\n\n201\n00:09:17,948 --> 00:09:22,270\nI use Get-NetAdapter to get the adapter,\nto find out which\n\n202\n00:09:22,270 --> 00:09:26,230\nnick I want it to modify, and then I pipe\nthat into the command that modified it.\n\n203\n00:09:26,230 --> 00:09:27,080\nAll right.\n\n204\n00:09:27,080 --> 00:09:28,440\nI didn't have to do it that way.\n\n205\n00:09:28,440 --> 00:09:31,520\nI could have rolled it all together\ninto one command if I wanted to, or\n\n206\n00:09:31,520 --> 00:09:33,670\nI could have used the interface\nindex number, right?\n\n207\n00:09:33,670 --> 00:09:36,950\nSo we;ve got different choices\nbased on what we want to achieve.\n\n208\n00:09:36,950 --> 00:09:40,130\nSo let me show you another\nway to go about that.\n\n209\n00:09:40,130 --> 00:09:46,770\nWe could say, for example,\non Set-NetIPInterface,\n\n210\n00:09:46,770 --> 00:09:50,180\nif I do the Get-Help for it.\n\n211\n00:09:50,180 --> 00:09:50,910\nWhoops.\n\n212\n00:09:50,910 --> 00:09:54,260\nIf I would be a little more\npatient with my tab auto complete.\n\n213\n00:09:54,260 --> 00:09:57,360\nNo, there are too many net commands for\nme to try that.\n\n214\n00:09:57,360 --> 00:09:58,814\nThere we go.\n\n215\n00:09:58,814 --> 00:10:02,774\n[LAUGH] Sometimes it is faster\nto type the command out, but\n\n216\n00:10:02,774 --> 00:10:08,467\nif you look at all the different things\nthat you can do with Set-NetIPInterface,\n\n217\n00:10:08,467 --> 00:10:13,362\nyou'll see that it's got\n-Interfacealias and -InterfaceIndex.\n\n218\n00:10:13,362 --> 00:10:18,571\nSo I could have taken\nthis command that I ran,\n\n219\n00:10:18,571 --> 00:10:23,919\nI could've collapsed\nthat into one command,\n\n220\n00:10:23,919 --> 00:10:30,250\nwhere I said -InterfaceIndex\n12 -DHCP Disabled.\n\n221\n00:10:30,250 --> 00:10:33,090\nIt's the exact same command,\nit's gonna do the same thing.\n\n222\n00:10:33,090 --> 00:10:36,450\nIt's going to reach out to whatever\nnetwork adapter is interface 12, and\n\n223\n00:10:36,450 --> 00:10:39,100\nit's gonna disable DHCP, all right?\n\n224\n00:10:39,100 --> 00:10:42,080\nThe only advantage here is,\nif I'm sitting at a new computer and\n\n225\n00:10:42,080 --> 00:10:45,720\nI know what that network adapter is\ncalled, I can do this command without\n\n226\n00:10:45,720 --> 00:10:48,645\nhaving to query what the interface\nindexes are, and all that stuff.\n\n227\n00:10:48,645 --> 00:10:50,070\n>> Mm-hm.\n>> It's easier and\n\n228\n00:10:50,070 --> 00:10:51,700\nthat's the way that I normally do it.\n\n229\n00:10:51,700 --> 00:10:55,070\nBut technically, the second command\nis shorter and does the same thing.\n\n230\n00:10:56,530 --> 00:10:58,448\nAssuming I don't have any typos,\nit should do the same thing.\n\n231\n00:10:58,448 --> 00:10:59,708\nThere we go.\n\n232\n00:10:59,708 --> 00:11:01,120\n>> [LAUGH]\n>> All right.\n\n233\n00:11:01,120 --> 00:11:05,089\nSo now that I've turned off DHCP,\nI probably need to set an IP address,\n\n234\n00:11:05,089 --> 00:11:06,070\nright, Mike?\n\n235\n00:11:06,070 --> 00:11:06,620\n>> Right.\n\n236\n00:11:06,620 --> 00:11:07,620\nYep.\n\n237\n00:11:07,620 --> 00:11:10,400\nYeah, I'm gonna say that's gonna make\nit a little bit easier to communicate\n\n238\n00:11:10,400 --> 00:11:12,035\nwith that computer over the network,\nright?\n\n239\n00:11:12,035 --> 00:11:13,810\n[LAUGH]\n>> It's funny how IP works, isn't it?\n\n240\n00:11:13,810 --> 00:11:14,690\n>> [LAUGH]\n>> All right,\n\n241\n00:11:14,690 --> 00:11:16,550\nso let's say we wanna do that.\n\n242\n00:11:16,550 --> 00:11:23,110\nAnd we can use the Set-NetIPInterface,\nor I'm sorry, New-NetIPAddress.\n\n243\n00:11:23,110 --> 00:11:25,030\nWe actually have a different command for\nthat one.\n\n244\n00:11:25,030 --> 00:11:28,740\nIt does get a little confusing, whether\nyou have set commands, or new commands,\n\n245\n00:11:28,740 --> 00:11:29,670\nor whatever.\n\n246\n00:11:29,670 --> 00:11:33,760\nBut what happens is IPv6\nchanged a lot of things.\n\n247\n00:11:33,760 --> 00:11:36,540\nIt used to be that,\nwhen you had a network adaptor,\n\n248\n00:11:36,540 --> 00:11:40,720\nyou usually only have one IP address\non it, and that was about it.\n\n249\n00:11:40,720 --> 00:11:43,180\nWell, you could have more than one.\n\n250\n00:11:43,180 --> 00:11:44,990\nBut you normally just have one address.\n\n251\n00:11:44,990 --> 00:11:49,510\nWell with IPv6, you almost always\nhave more than one address.\n\n252\n00:11:49,510 --> 00:11:52,170\nAnd so, instead of making it\nwhere there's a set command,\n\n253\n00:11:52,170 --> 00:11:55,680\nlike you're setting one address,\nnow you have a new command.\n\n254\n00:11:55,680 --> 00:11:59,307\nYou say, new IP address, you're actually\nattaching an IP address to the interface,\n\n255\n00:11:59,307 --> 00:12:01,720\nand then you can remove\nold ones if you need to.\n\n256\n00:12:01,720 --> 00:12:02,860\nSo you get that flexibility.\n\n257\n00:12:02,860 --> 00:12:05,210\nIt's all built around having\nmore than one address.\n\n258\n00:12:06,600 --> 00:12:08,590\nAll right, so\nlet's say that I want to assign one.\n\n259\n00:12:08,590 --> 00:12:09,270\nRight?\n\n260\n00:12:09,270 --> 00:12:13,170\nWell, this command can get a little bit\nlong, so let me change my window here so\n\n261\n00:12:13,170 --> 00:12:16,335\nit's not, I don't want my\nhead to cover up the command.\n\n262\n00:12:16,335 --> 00:12:17,740\n>> [LAUGH]\n>> I'll just clear that out.\n\n263\n00:12:17,740 --> 00:12:18,940\nAll right.\n\n264\n00:12:18,940 --> 00:12:23,440\nSo, if I want to assign an IP address,\nin the show notes I put like\n\n265\n00:12:23,440 --> 00:12:27,158\nthree different ways that you can do it,\nbut let me just show you one of the ways\n\n266\n00:12:27,158 --> 00:12:30,040\nthat's probably the most detailed,\nbecause it helps with IPv4 and IPv6.\n\n267\n00:12:30,040 --> 00:12:36,182\nBasically, what we can do is, we can come\nin and we can say, New-NetIPAddress.\n\n268\n00:12:36,182 --> 00:12:39,240\nAll right, so\nwe're creating a new IP address.\n\n269\n00:12:39,240 --> 00:12:43,020\nI can then tell it the interface\nthat it's going to be on, and\n\n270\n00:12:43,020 --> 00:12:47,470\nI could say, the interface alias,\nand point to the name.\n\n271\n00:12:47,470 --> 00:12:51,236\nOr I could say InterfaceIndex,\nif I know the index number, minus 12.\n\n272\n00:12:51,236 --> 00:12:54,980\nSo, either way, and that's why there's\nmore than one in the show notes.\n\n273\n00:12:54,980 --> 00:12:57,560\nAnd then we say the address family.\n\n274\n00:12:57,560 --> 00:12:59,240\nNow, this is really important.\n\n275\n00:12:59,240 --> 00:13:04,370\nThe address family is gonna tell it\nwhether we're doing IPv4 or IPv6.\n\n276\n00:13:05,810 --> 00:13:09,030\nSo, in our newer operating systems,\nWindows Vista and higher,\n\n277\n00:13:09,030 --> 00:13:12,710\nWindows Server 2008 and higher,\nIPv6 is enabled by default.\n\n278\n00:13:12,710 --> 00:13:15,920\nBut not only that,\nit's preferred over IPv4.\n\n279\n00:13:15,920 --> 00:13:18,600\nSo you gotta specify whether\nyou're doing IPv4 or IPv6.\n\n280\n00:13:20,870 --> 00:13:22,890\nAll right, we follow that up with\nthe address that we're attaching.\n\n281\n00:13:22,890 --> 00:13:26,240\nSo I'll just say, IPAddress, and\nthen what address I want it to have.\n\n282\n00:13:26,240 --> 00:13:29,712\nI'll do, what would be a safe address?\n\n283\n00:13:29,712 --> 00:13:32,162\nWe'll do 192.168.29.3, all right,\n\n284\n00:13:32,162 --> 00:13:34,730\nso that's the address that\nI'm going to attach to it.\n\n285\n00:13:34,730 --> 00:13:38,090\nNow, you might be tempted to stop there,\nbut there's actually a little more\n\n286\n00:13:38,090 --> 00:13:41,204\ninformation we need to provide,\nfor example, the subnet mask.\n\n287\n00:13:41,204 --> 00:13:43,340\n>> Yeah, right.\nThink about your TCP/IP properties,\n\n288\n00:13:43,340 --> 00:13:44,040\nif you go in there and\n\n289\n00:13:44,040 --> 00:13:47,350\nconfigure that through the GUI,\nyou still gotta configure your IP address,\n\n290\n00:13:47,350 --> 00:13:50,980\nyour subnet mask, your default gateway,\nand a couple of other things.\n\n291\n00:13:50,980 --> 00:13:52,550\nWe're gonna need DNS servers, as well.\n\n292\n00:13:53,650 --> 00:13:54,875\n>> Yep.\nSo we're gonna specify that.\n\n293\n00:13:54,875 --> 00:13:58,660\nNow, this is tricky, because for\nall of these years in the GUI,\n\n294\n00:13:58,660 --> 00:14:00,930\nhow does Microsoft ask us\nto put in the subnet mask?\n\n295\n00:14:00,930 --> 00:14:05,080\n255.255.255.0, or\nwhatever the case may be.\n\n296\n00:14:05,080 --> 00:14:10,370\n>> Yeah, that 32 bit dotted decimal\nnotation is kind of what we're used to.\n\n297\n00:14:10,370 --> 00:14:12,220\nBut here in the PowerShell,\nthat's not what they want.\n\n298\n00:14:12,220 --> 00:14:14,720\nNow they want what's\ncalled a prefix length.\n\n299\n00:14:14,720 --> 00:14:16,368\nAnd the reason they switched to this is,\n\n300\n00:14:16,368 --> 00:14:19,040\nthe old dotted decimal notation\nreally doesn't work for IPv6.\n\n301\n00:14:19,040 --> 00:14:21,185\nYou end up with these massive numbers.\n\n302\n00:14:21,185 --> 00:14:23,440\n>> [LAUGH] Right?\n>> So, they switched to the prefix model.\n\n303\n00:14:23,440 --> 00:14:27,063\nAnd the prefix model just says,\nhow many bits are in the subnet mask?\n\n304\n00:14:27,063 --> 00:14:28,666\n>> Yeah, how many ones do you have?\n\n305\n00:14:28,666 --> 00:14:30,955\nEasy enough.\n\n306\n00:14:30,955 --> 00:14:31,570\n>> Mm-hm.\n\n307\n00:14:31,570 --> 00:14:32,536\n>> So if we're doing, like,\n\n308\n00:14:32,536 --> 00:14:36,440\na 255.255.255.0, that's like a class C\nsubnet mask, you know, what we'd expect.\n\n309\n00:14:36,440 --> 00:14:41,290\nOr they'll sometimes call it a 24-bit\nsubnet mask, cuz there's 24 ones in it.\n\n310\n00:14:41,290 --> 00:14:46,000\nSo, when I come in here and\nI specify that prefix length, so\n\n311\n00:14:46,000 --> 00:14:50,580\nI'll say prefix length 24, and\nI screen wrapped there, but\n\n312\n00:14:50,580 --> 00:14:52,900\nprefix length 24,\nthat's telling it 255.255.255.0.\n\n313\n00:14:52,900 --> 00:14:58,188\nJust for your own reference,\na class A, 255.000,\n\n314\n00:14:58,188 --> 00:15:01,784\nthat would be an 8-bit prefix length,\n\n315\n00:15:01,784 --> 00:15:06,590\na class B is a 16-bit,\nand a class C is a 24-bit.\n\n316\n00:15:06,590 --> 00:15:09,170\nAll right, so there's my prefix length,\nI've got that set.\n\n317\n00:15:09,170 --> 00:15:10,300\nI do need a little more.\n\n318\n00:15:10,300 --> 00:15:13,160\nAnd again,\nthis is tying into that whole IPv6 thing.\n\n319\n00:15:13,160 --> 00:15:17,090\nWith IPv6, you can have addresses\nthat are link local or unicast.\n\n320\n00:15:17,090 --> 00:15:18,850\nThere's all sorts of variations.\n\n321\n00:15:18,850 --> 00:15:23,750\nAnd so in IPv4,\nI need to tell it that my type is unicast,\n\n322\n00:15:23,750 --> 00:15:25,400\nand that's actually the default.\n\n323\n00:15:25,400 --> 00:15:28,980\nI could leave that off, but I wanted to\nput it here, so you guys are aware of it.\n\n324\n00:15:28,980 --> 00:15:30,920\nEspecially for\nthose of you that are assigning IPv6.\n\n325\n00:15:32,470 --> 00:15:33,290\nAnd, am I done?\n\n326\n00:15:33,290 --> 00:15:34,020\nOh, nope.\n\n327\n00:15:34,020 --> 00:15:34,679\n>> Last but not least.\n\n328\n00:15:34,679 --> 00:15:36,330\n>> Something important.\n>> Yeah, we got that default gateway,\n\n329\n00:15:36,330 --> 00:15:37,670\nif we wanna get off of our subnet.\n\n330\n00:15:39,040 --> 00:15:42,090\n>> Yeah, you don't have to have a default\ngateway, I could have left this off.\n\n331\n00:15:42,090 --> 00:15:42,660\n>> Right.\n\n332\n00:15:42,660 --> 00:15:44,301\n>> But if you want a route between\nmore than that one network,\n\n333\n00:15:44,301 --> 00:15:45,050\nyou're going to need it.\n\n334\n00:15:45,050 --> 00:15:46,650\nSo, it's almost a given\nthat we're gonna have it.\n\n335\n00:15:46,650 --> 00:15:51,650\nAnd so I'll punch in my default gateway,\nwhich is I believe .2 on this network.\n\n336\n00:15:51,650 --> 00:15:52,340\nAll right.\n\n337\n00:15:52,340 --> 00:15:55,270\nSo, everything that I've specified here\n\n338\n00:15:55,270 --> 00:15:57,170\nis what we'd normally\nspecify in an adapter, right?\n\n339\n00:15:57,170 --> 00:15:59,970\nOur IP address, our subnet mask,\nand our default gateway.\n\n340\n00:15:59,970 --> 00:16:01,411\nI used InterfaceIndex to reference it.\n\n341\n00:16:01,411 --> 00:16:06,165\nI could have said Interfacealias, or\nI could have done the Get-NetAdapter,\n\n342\n00:16:06,165 --> 00:16:10,208\nand type that output into the new\nnet IP address and left that part.\n\n343\n00:16:10,208 --> 00:16:11,082\nPart off, right?\n\n344\n00:16:11,082 --> 00:16:12,666\nThose are the three different\nways that I could have done this.\n\n345\n00:16:12,666 --> 00:16:17,422\nI'm gonna run it and I can see that\napparently I already have that IP address,\n\n346\n00:16:17,422 --> 00:16:19,776\nso let's pick something different.\n\n347\n00:16:19,776 --> 00:16:24,625\nI must already be .3, so let's go to .33.\n\n348\n00:16:25,645 --> 00:16:30,495\nAnd I already have a default gateway,\nis what it's complaining about now.\n\n349\n00:16:30,495 --> 00:16:32,725\nYou can only have one default gateway, and\n\n350\n00:16:32,725 --> 00:16:38,155\nwhen you use the new command,\nit's not replacing, it's adding to it.\n\n351\n00:16:38,155 --> 00:16:41,588\nSo I've already got a default gateway,\nso I just need to remove that.\n\n352\n00:16:41,588 --> 00:16:46,500\nAnd actually it probably did add .33,\noh no it didn't, there we go, so\n\n353\n00:16:46,500 --> 00:16:47,690\nit went ahead and added it.\n\n354\n00:16:47,690 --> 00:16:51,651\nSo now I've got .33,\nbut it was a new IP so\n\n355\n00:16:51,651 --> 00:16:57,990\nit's actually in addition to the IP's\nthat I might have already had.\n\n356\n00:16:57,990 --> 00:17:02,834\nSo if I do a get-net,\nI keep doing tab autocomplete on that, and\n\n357\n00:17:02,834 --> 00:17:07,360\nthere's just so\nmany ones that start with net, all right.\n\n358\n00:17:07,360 --> 00:17:10,270\nSo if I look here I can see all\nthe different IP addresses that I have and\n\n359\n00:17:10,270 --> 00:17:13,190\nsure enough I do have 192.168.29.3,\nand there's .33, so\n\n360\n00:17:13,190 --> 00:17:18,170\nI got that one added, and\nI probably have few others.\n\n361\n00:17:18,170 --> 00:17:21,630\nThere's my IPv6 loop back and stuff.\n\n362\n00:17:21,630 --> 00:17:26,060\nSo, you'll see these different IPv6 and\nIPv4 addresses and so on all in here.\n\n363\n00:17:26,060 --> 00:17:30,810\nSo, the new command did exactly what\nit said and created the new address.\n\n364\n00:17:32,920 --> 00:17:38,690\nIf we wanted to remove it, let's see,\nis this one, is it remove or is it delete?\n\n365\n00:17:39,975 --> 00:17:42,500\nHere, we'll do a quick query on this one.\n\n366\n00:17:42,500 --> 00:17:47,660\nI always get confused on this one where,\nthere it is, remove.\n\n367\n00:17:47,660 --> 00:17:50,070\nSometimes it's removed,\nsometimes it's delete.\n\n368\n00:17:50,070 --> 00:17:51,910\nThey have different terminology.\n\n369\n00:17:51,910 --> 00:17:52,850\nBut I can come back and\n\n370\n00:17:52,850 --> 00:17:57,790\nI can do remove-net IP address to remove\nthat .3 if I don't want that one on there.\n\n371\n00:17:57,790 --> 00:18:03,324\nAnd I can actually come in here and take\nmy old command and modify it a little bit\n\n372\n00:18:03,324 --> 00:18:09,770\nto say, I could probably leave that off\nbut I'll just leave it on there for now.\n\n373\n00:18:09,770 --> 00:18:12,350\nSo I'm gonna change this so\nmy syntax will read,\n\n374\n00:18:12,350 --> 00:18:17,656\nremove dash netipaddress from interface\nindex 12 address family IPv4.\n\n375\n00:18:17,656 --> 00:18:22,410\nThe address is 192.168.29.3,\nwe're gonna remove it,\n\n376\n00:18:22,410 --> 00:18:25,280\nit's just asking me to verify,\nI'll say yes.\n\n377\n00:18:25,280 --> 00:18:30,350\nAnd it's asking me to double\nsuper secret provision verify.\n\n378\n00:18:30,350 --> 00:18:31,410\nThere we go.\n\n379\n00:18:31,410 --> 00:18:34,781\nAnd so we'll remove that, and\nnow I just have the one IP address.\n\n380\n00:18:34,781 --> 00:18:42,365\nAnd I can do the get-netipaddress and\nI can verify that it's gone from there.\n\n381\n00:18:42,365 --> 00:18:43,860\nAnd I don't see it in my list there.\n\n382\n00:18:45,620 --> 00:18:46,402\nAnd actually,\n\n383\n00:18:46,402 --> 00:18:50,340\nif we pump that through format table\nit's a little bit easier to see.\n\n384\n00:18:50,340 --> 00:18:54,999\nSo I just ran get-netipaddress and\nI pipe that into the format-table command,\n\n385\n00:18:54,999 --> 00:18:56,448\nwhich has an alias of ft.\n\n386\n00:18:56,448 --> 00:18:58,410\nAnd that way I can just see\nall the addresses right there.\n\n387\n00:18:58,410 --> 00:19:03,190\nSo, I can see that .3 is now gone and\nwe're good and clear.\n\n388\n00:19:03,190 --> 00:19:08,160\nSo, let me just pull up\nmy history real quick.\n\n389\n00:19:08,160 --> 00:19:11,640\nSo looking at my get history you'll\nsee that that new -netip address,\n\n390\n00:19:11,640 --> 00:19:14,470\nthat's how we added that\naddress to our system.\n\n391\n00:19:14,470 --> 00:19:18,070\nAnd then I follow that up with the remove\n-net IP address to get rid of the address\n\n392\n00:19:18,070 --> 00:19:18,950\nthat I had from before.\n\n393\n00:19:20,700 --> 00:19:24,130\n>> They are real good commands,\nI don't know about you, I find that\n\n394\n00:19:24,130 --> 00:19:27,190\ntypically going through the GUI's\na little bit faster with this process.\n\n395\n00:19:27,190 --> 00:19:31,097\nWith the power shell, it's a pretty\nlong command just to set my IP address,\n\n396\n00:19:31,097 --> 00:19:35,127\nbut there still, you've got to know\nthem because if you're working with that\n\n397\n00:19:35,127 --> 00:19:37,531\nserver core you don't have that GUI,\nright?\n\n398\n00:19:37,531 --> 00:19:38,991\nAnd so\nthat's where this really comes into play,\n\n399\n00:19:38,991 --> 00:19:40,400\nit's not something i'm\never gonna automate.\n\n400\n00:19:40,400 --> 00:19:41,710\nI'm not gonna script this,\n\n401\n00:19:41,710 --> 00:19:45,060\nthere's too many things in there that are\nspecific to that machine that i'm setting.\n\n402\n00:19:45,060 --> 00:19:48,350\nSo it really doesn't make for a good\nscript, or something i'm gonna automate.\n\n403\n00:19:48,350 --> 00:19:52,304\nBut as you're setting up those new\nserver cores to get your network going,\n\n404\n00:19:52,304 --> 00:19:55,531\nthat's when these commands\nare really gonna come in handy.\n\n405\n00:19:55,531 --> 00:19:59,304\n>> All right now there's a lot of times\nwhere I stop right here and said I'm done,\n\n406\n00:19:59,304 --> 00:20:02,800\nI got my IP address, got my default\ngateway, I'm done I walk away.\n\n407\n00:20:02,800 --> 00:20:04,280\n>> Easy one to forget right here,\nisn't it?\n\n408\n00:20:04,280 --> 00:20:06,325\n>> And\nthen stuff isn't quite working right.\n\n409\n00:20:06,325 --> 00:20:07,600\n>> Why can't I join into the domain?\n\n410\n00:20:07,600 --> 00:20:09,770\nWhy is it telling me I can't\nfind the domain controller?\n\n411\n00:20:09,770 --> 00:20:12,080\nIt's on the same network,\nit's got the damn right IP address.\n\n412\n00:20:12,080 --> 00:20:14,200\n>> It's funniest thing cuz\nthat's exactly how it goes down.\n\n413\n00:20:14,200 --> 00:20:16,050\n>> I know.\n[LAUGH] >> It's always joining the domain.\n\n414\n00:20:16,050 --> 00:20:16,960\n>> Yeah.\n\n415\n00:20:16,960 --> 00:20:18,530\n>> DNS servers, right?\n\n416\n00:20:18,530 --> 00:20:21,900\nWhen we're in the GUI, you see little\nDNS fields right there beneath the IP.\n\n417\n00:20:21,900 --> 00:20:23,880\nThose are optional,\nyou don't have to have them.\n\n418\n00:20:23,880 --> 00:20:26,330\nBut if you don't, you are gonna have\na hard time doing a lot of things,\n\n419\n00:20:26,330 --> 00:20:27,750\nlike joining a domain.\n\n420\n00:20:27,750 --> 00:20:30,650\nSo we probably want to\nassign some DNS servers,\n\n421\n00:20:30,650 --> 00:20:33,420\ndomain lookup servers to\nbe able to do that, right?\n\n422\n00:20:33,420 --> 00:20:37,390\nSo simple command for this one, we can\nadd them in, and we'll be in business.\n\n423\n00:20:37,390 --> 00:20:40,820\nSo, for this one if we go back to our\nPowerShell, the command we're looking for\n\n424\n00:20:40,820 --> 00:20:44,280\nis set-dns\n>> It's a long one.\n\n425\n00:20:44,280 --> 00:20:47,740\n>> Client,\nI'm gonna use my tab auto-complete, there.\n\n426\n00:20:47,740 --> 00:20:51,000\nDNS client server address.\n\n427\n00:20:51,000 --> 00:20:53,770\nThere we go, so\nset-dnsclientserveraddress, and\n\n428\n00:20:53,770 --> 00:20:56,150\nthis is where we can assign those\nname servers to our system,\n\n429\n00:20:56,150 --> 00:20:58,638\nso it will be able to do name look-ups.\n\n430\n00:20:58,638 --> 00:20:59,420\n>> Mm-hm.\n\n431\n00:20:59,420 --> 00:21:02,324\nYeah, just first thing that's gonna\nhappen is you're going to go through and\n\n432\n00:21:02,324 --> 00:21:04,615\nyou're going to set your TCP IP\nsettings on that server core.\n\n433\n00:21:04,615 --> 00:21:08,342\nYou're gonna try to join into the domain,\nand remember it's gotta do a DNS look-up\n\n434\n00:21:08,342 --> 00:21:10,600\nto find,\nit knows the name of the main controller,\n\n435\n00:21:10,600 --> 00:21:14,190\nit's gotta find that IP address and it\nneeds DNS to do that so you're gonna fail.\n\n436\n00:21:14,190 --> 00:21:17,030\nAnd so you gotta come back and run this\nand it's non-showing, it's the same thing,\n\n437\n00:21:17,030 --> 00:21:19,570\nyou do your set-DNS client server address,\n\n438\n00:21:19,570 --> 00:21:23,080\nspecify which network adapter you're\ntrying to et these properties on,\n\n439\n00:21:23,080 --> 00:21:28,180\nand then it's just -server addresses and\nyou can list out multiple.\n\n440\n00:21:28,180 --> 00:21:31,260\nJust like you can in the GUI,\nyou've got your preferred, your alternate.\n\n441\n00:21:31,260 --> 00:21:34,270\nYou can even go to that DNS tab, and\nyou can list several alternates.\n\n442\n00:21:34,270 --> 00:21:37,100\nHere you're just gonna\nseparate them with commas.\n\n443\n00:21:37,100 --> 00:21:39,330\n>> And that's the part I always forget so\nI was waiting for you to say that.\n\n444\n00:21:39,330 --> 00:21:40,690\n>> [LAUGH]\n>> So, yep, so\n\n445\n00:21:40,690 --> 00:21:43,340\nyou just separated them with commas,\nlike I knew that all along.\n\n446\n00:21:43,340 --> 00:21:47,116\nI always forget and then I just end up\njust sending one DNS server cuz I'm like\n\n447\n00:21:47,116 --> 00:21:50,306\nscrew it, I can't remember,\nare there spaces or semicolons?\n\n448\n00:21:50,306 --> 00:21:52,100\nAll right so it'll be commas.\n\n449\n00:21:52,100 --> 00:21:56,410\nSo, I'll go and set my own server's a DNS\nservers, so I'll put 192.168.29.33 and\n\n450\n00:21:56,410 --> 00:22:00,830\nthen maybe as my back up\nI'll just put Google.\n\n451\n00:22:00,830 --> 00:22:02,745\nOr somebody,\nyou know some open DNS server.\n\n452\n00:22:02,745 --> 00:22:03,270\n>> Mm-hm.\n\n453\n00:22:03,270 --> 00:22:04,730\n>> And so I'll punch that in there.\n\n454\n00:22:04,730 --> 00:22:07,698\nNow I've got my DNS server set up and\nI can do my look up.\n\n455\n00:22:07,698 --> 00:22:10,259\nSo now this machine is ready\nto go to join the domain or\n\n456\n00:22:10,259 --> 00:22:13,940\ndo the other things that we need to,\nit's got that stuff assigned.\n\n457\n00:22:13,940 --> 00:22:19,340\nAnd we can go our get-netip address or\nget-DNS client server.\n\n458\n00:22:19,340 --> 00:22:23,520\nYou can start to pull a lot\nof that information back and\n\n459\n00:22:23,520 --> 00:22:26,490\nsee actually, let's see.\n\n460\n00:22:28,170 --> 00:22:28,760\nThere we go.\n\n461\n00:22:28,760 --> 00:22:32,030\nSo we can start to pull it up and\nsee what servers are attached.\n\n462\n00:22:32,030 --> 00:22:36,950\nNow be careful, remember with the IP\naddress, we did new-net IP address,\n\n463\n00:22:36,950 --> 00:22:40,220\nand that added an address, but\ndidn't remove what we already had.\n\n464\n00:22:40,220 --> 00:22:41,470\nWell, this is a set command.\n\n465\n00:22:41,470 --> 00:22:43,680\nAnd with set commands they do replace, so\n\n466\n00:22:43,680 --> 00:22:46,790\nI replaced whatever DNS\nservers that I had before.\n\n467\n00:22:46,790 --> 00:22:50,160\nSo it's kind of over written those,\nbut it is assigned and\n\n468\n00:22:50,160 --> 00:22:52,320\nI assign those to my LAN interface.\n\n469\n00:22:52,320 --> 00:22:54,860\nAnd you'll see my\nISATAP Tunnel follow that but.\n\n470\n00:22:54,860 --> 00:22:56,340\nAnd there we go.\n\n471\n00:22:56,340 --> 00:23:00,170\nSo, getting an IP address assigned,\ngetting DNS, pretty straightforward.\n\n472\n00:23:01,570 --> 00:23:02,550\nAll right, well, in this segment,\n\n473\n00:23:02,550 --> 00:23:07,250\nwe got a chance to see working with our\nnetwork adapters via the PowerShell.\n\n474\n00:23:07,250 --> 00:23:11,250\nWe saw assigning an IP address and\nsubnet mask and we got a chance to take\n\n475\n00:23:11,250 --> 00:23:14,640\na look assigning a name look up server so\nwe can actually do real work.\n\n476\n00:23:15,940 --> 00:23:19,850\nI hope you guys enjoyed that, stay tuned,\nwe have more PowerShell coming up,\n\n477\n00:23:19,850 --> 00:23:22,400\nespecially we have a firewall episode,\n\n478\n00:23:22,400 --> 00:23:24,800\ncuz that's the normally the next\nprocedure here, is we go in and\n\n479\n00:23:24,800 --> 00:23:28,900\nset our firewall settings to make sure we\ncan actually get to the daggum server.\n\n480\n00:23:28,900 --> 00:23:34,156\nBut those are coming up, so stay tuned for\nthat, and we'll be back after this.\n\n481\n00:23:34,156 --> 00:23:39,920\n[SOUND]\n\n",
          "vimeoId": "116155654"
        },
        {
          "description": "",
          "length": "1418",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-6-managing_services-0106015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-6-managing_services-0106015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-6-managing_services-0106015-sm.jpg",
          "title": "Managing Services",
          "transcript": "1\n00:00:00,007 --> 00:00:08,099\n[MUSIC]\n\n2\n00:00:08,099 --> 00:00:11,663\nIn this segment we're gonna take a look\nat managing background services using\n\n3\n00:00:11,663 --> 00:00:13,650\nthe Microsoft PowerShell.\n\n4\n00:00:13,650 --> 00:00:16,610\nOn any server, and really on your\nworkstations too, there's a number\n\n5\n00:00:16,610 --> 00:00:19,290\nof services that are running in the\nbackground that we may need to manipulate,\n\n6\n00:00:19,290 --> 00:00:22,010\nand they might be the ones that\nare built into Windows that came\n\n7\n00:00:22,010 --> 00:00:23,290\nwith the operating system.\n\n8\n00:00:23,290 --> 00:00:26,300\nWhen they might be third party\nwants that we've added on.\n\n9\n00:00:26,300 --> 00:00:28,620\nEither way,\nwe can manage them with the PowerShell and\n\n10\n00:00:28,620 --> 00:00:31,850\nthat's really useful if you're trying to\nscript and automate certain activities.\n\n11\n00:00:31,850 --> 00:00:34,550\n>> Absolutely.\n>> Now for the most part,\n\n12\n00:00:34,550 --> 00:00:38,750\ntypically you're just gonna be looking for\na broken services and starting them again.\n\n13\n00:00:38,750 --> 00:00:42,490\nThere's some typical really rudimentary\nthings that everybody does.\n\n14\n00:00:42,490 --> 00:00:43,930\nI wanna start with those commands.\n\n15\n00:00:43,930 --> 00:00:45,630\nAnd then we'll move into some\nof the more advanced things.\n\n16\n00:00:45,630 --> 00:00:49,310\nI will say this, just right off the bat,\nMicrosoft did not spend a lot of\n\n17\n00:00:49,310 --> 00:00:52,620\ntime adding a bunch of service\nfunctionality into the PowerShell.\n\n18\n00:00:52,620 --> 00:00:55,530\nSo, some of things we see here will\nrequire us to get a little bit\n\n19\n00:00:55,530 --> 00:00:57,910\ncreate with how we use\nthe PowerShell to work with it.\n\n20\n00:00:59,180 --> 00:01:02,600\nLet's start with a real simple one which\nis simply getting a list of our services,\n\n21\n00:01:02,600 --> 00:01:05,871\nand as you'd think the command\nis just get-services.\n\n22\n00:01:05,871 --> 00:01:08,390\n>> Pretty straight forward.\n\n23\n00:01:08,390 --> 00:01:10,600\n>> Sorry.\nIt's get-service, it's not plural.\n\n24\n00:01:10,600 --> 00:01:11,410\nThere we go.\n\n25\n00:01:11,410 --> 00:01:15,500\nSo if we get that service, we get a list\nof services that are available and\n\n26\n00:01:15,500 --> 00:01:16,340\nthere's a bunch of to them.\n\n27\n00:01:16,340 --> 00:01:21,260\nAnd this is the equivalent of going\nto that control panel item right, or\n\n28\n00:01:21,260 --> 00:01:26,300\nadministrative tool, if I were to go into,\napparently I'm spelling challenged today.\n\n29\n00:01:26,300 --> 00:01:30,010\nBut if I go into the services\nadministrative tool, I get this list of\n\n30\n00:01:30,010 --> 00:01:33,211\nall the services that are on my system and\nthe ones that are running, and so on.\n\n31\n00:01:33,211 --> 00:01:35,560\nIf I went back,\nhere that's exactly what I'm seeing too.\n\n32\n00:01:37,330 --> 00:01:41,600\nOne of the nice things about this though\nis that, it does display the service name\n\n33\n00:01:41,600 --> 00:01:43,530\nbut those names might not be\nwhat you're familiar with.\n\n34\n00:01:43,530 --> 00:01:45,110\nThat's because every\nservice has two names.\n\n35\n00:01:45,110 --> 00:01:48,800\nYou have a service name and\na display name.\n\n36\n00:01:48,800 --> 00:01:50,680\nI'm seeing the service name here.\n\n37\n00:01:50,680 --> 00:01:51,740\nFollowed by that display name.\n\n38\n00:01:51,740 --> 00:01:54,660\nSo there might be a service\nthat I'm really used to,\n\n39\n00:01:54,660 --> 00:01:57,490\nlike the DNS client, right?\n\n40\n00:01:57,490 --> 00:01:59,200\nAnd so\nthat's what I'm used to seeing it as,\n\n41\n00:01:59,200 --> 00:02:02,750\nand in the administrative\ntool that's what it shows up.\n\n42\n00:02:02,750 --> 00:02:06,490\nBut you'll see here, there's a service\nname attached to it, Dnscache.\n\n43\n00:02:06,490 --> 00:02:09,340\nAs we work with the services,\na lot of times we're expected to\n\n44\n00:02:09,340 --> 00:02:12,150\nknow the actual service name and\nnot the display name, and so\n\n45\n00:02:12,150 --> 00:02:14,630\nthat's something we'll have to kind of\ncompete against as we work with this.\n\n46\n00:02:14,630 --> 00:02:16,320\n>> Okay,\nwell that makes it a little challenging.\n\n47\n00:02:17,742 --> 00:02:20,070\n>> All right so,\ngetting a list of services, that's great.\n\n48\n00:02:20,070 --> 00:02:22,170\nNow I know what's going on on my system.\n\n49\n00:02:22,170 --> 00:02:23,690\nI might want to filter that a bit.\n\n50\n00:02:23,690 --> 00:02:26,860\nI know Mike when I told you we were\ngonna film this show, Mike said yeah,\n\n51\n00:02:26,860 --> 00:02:29,465\nwe really need to have one more that\njust shows like running services.\n\n52\n00:02:29,465 --> 00:02:30,550\n>> Mm-hm, right.\n\n53\n00:02:30,550 --> 00:02:32,255\n>> Or maybe even ones that aren't running.\n\n54\n00:02:32,255 --> 00:02:33,090\n[LAUGH]\n>> Yeah, exactly.\n\n55\n00:02:33,090 --> 00:02:35,030\nIt is nice to be able to\nfilter that list down and\n\n56\n00:02:35,030 --> 00:02:36,260\nfind exactly what you're looking for.\n\n57\n00:02:36,260 --> 00:02:38,870\nI need to know, is this service running,\n\n58\n00:02:38,870 --> 00:02:41,890\nor which services are actually\nrunning on my machine?\n\n59\n00:02:41,890 --> 00:02:43,400\nCuz that list can get a little long.\n\n60\n00:02:43,400 --> 00:02:44,500\n>> It can get really long.\n\n61\n00:02:44,500 --> 00:02:46,760\nEspecially on systems where you've\ninstalled a lot of software.\n\n62\n00:02:46,760 --> 00:02:48,110\nYou see this on workstations more.\n\n63\n00:02:48,110 --> 00:02:49,990\nServers are normally pretty clean.\n\n64\n00:02:49,990 --> 00:02:53,190\nBut just like any PowerShell command,\nwe can use sort object.\n\n65\n00:02:53,190 --> 00:02:55,210\nAnd Where-Object to change that,\n\n66\n00:02:55,210 --> 00:02:58,050\nright, Sort-Object lets us just arrange\nthe way that things are being ordered on\n\n67\n00:02:58,050 --> 00:03:01,150\nthe screen, and\nWhere-Object will let us filter it.\n\n68\n00:03:01,150 --> 00:03:06,085\nSo, if I take Get-Service and I'm just\ngoing to pipe that commands output into\n\n69\n00:03:06,085 --> 00:03:10,460\nSort-object, and\nwe can tell it what we want to sort by.\n\n70\n00:03:10,460 --> 00:03:12,500\nYou can sort by any of these\ndifferent columns over here.\n\n71\n00:03:12,500 --> 00:03:13,880\nI'm going to sort it by status.\n\n72\n00:03:15,560 --> 00:03:17,670\nWhen I run that, it's going to sort it.\n\n73\n00:03:17,670 --> 00:03:19,900\nSo now, I've got all of my running\nservices right here at the bottom.\n\n74\n00:03:19,900 --> 00:03:21,880\nI've got my stopped ones\nthat are above that.\n\n75\n00:03:21,880 --> 00:03:23,450\nSo I can see each of those.\n\n76\n00:03:23,450 --> 00:03:24,970\nAnd they're just in the list.\n\n77\n00:03:24,970 --> 00:03:26,130\nThere they are.\n\n78\n00:03:26,130 --> 00:03:28,990\nIt's very, very exciting.\n\n79\n00:03:28,990 --> 00:03:30,560\nIt's not terribly exciting.\n\n80\n00:03:30,560 --> 00:03:34,450\nNow, I might want to use something like\nWhere-object to tell it only to show me\n\n81\n00:03:34,450 --> 00:03:37,470\nthe stopped services, or\njust show me the running services.\n\n82\n00:03:37,470 --> 00:03:41,580\nSo we can filter beyond that if we want\nto, so I can get rid of sort object.\n\n83\n00:03:41,580 --> 00:03:42,225\nAnd I can change that.\n\n84\n00:03:42,225 --> 00:03:43,672\n>> Mm-hm.\n\n85\n00:03:43,672 --> 00:03:46,560\n>> Now, Where-object the syntax is\nalways a little weird on this one.\n\n86\n00:03:46,560 --> 00:03:47,955\n>> It's a little goofy, isn't it?\n\n87\n00:03:47,955 --> 00:03:50,960\n>> Cuz what you have to do, you have\nto call that variable that represents\n\n88\n00:03:50,960 --> 00:03:53,080\nthe output of the first commands\npart of our pipe lining.\n\n89\n00:03:53,080 --> 00:03:54,595\n>> Yeah.\n>> If you watched our pipe lining episode,\n\n90\n00:03:54,595 --> 00:03:55,610\nyou already know about this.\n\n91\n00:03:55,610 --> 00:03:57,645\nBut-\n>> Because really treating that list,\n\n92\n00:03:57,645 --> 00:04:00,070\nGet-Services, returning a list\nof all the services, and\n\n93\n00:04:00,070 --> 00:04:01,610\nit's treating it like an object.\n\n94\n00:04:01,610 --> 00:04:04,108\nAnd then that object is that $_.\n\n95\n00:04:04,108 --> 00:04:09,800\nWhich is referring to the object in the\nprevious command in the pipeline spit out.\n\n96\n00:04:09,800 --> 00:04:13,450\nAnd then you can call different variables,\nor different properties of that object.\n\n97\n00:04:13,450 --> 00:04:16,220\nIn this case,\nI think you're gonna use the status.\n\n98\n00:04:16,220 --> 00:04:17,797\n>> Yup, so\nwe're just gonna take a look at that, and\n\n99\n00:04:17,797 --> 00:04:19,539\nthat's exactly what that\ncommand is saying, right?\n\n100\n00:04:19,539 --> 00:04:24,219\nIs look at the output from our first\ncommand $_, and inside of that output,\n\n101\n00:04:24,219 --> 00:04:26,390\nlook for the status value in there.\n\n102\n00:04:26,390 --> 00:04:27,830\nSo we want to find the status.\n\n103\n00:04:27,830 --> 00:04:32,400\nAnd I'm gonna say where\nthat is equal to stopped.\n\n104\n00:04:32,400 --> 00:04:36,480\nI'm gonna put it in quotes, I don't think\nI actually have to, but I'm going to.\n\n105\n00:04:36,480 --> 00:04:38,300\nIf there's spaces,\nobviously you do need that.\n\n106\n00:04:38,300 --> 00:04:39,670\nBut I'll just do it like that.\n\n107\n00:04:39,670 --> 00:04:43,560\n>> Sometimes if it's a string, sometimes\nyou gotta out those darn quotes around it.\n\n108\n00:04:43,560 --> 00:04:46,830\n>> So I'm just saying,\nshow me anybody whose status is stopped.\n\n109\n00:04:46,830 --> 00:04:49,410\nAnd there we go,\nI get my list of the stopped status.\n\n110\n00:04:49,410 --> 00:04:52,810\nStop services and no running services.\n\n111\n00:04:52,810 --> 00:04:55,120\nThe running services are left out and\nthat's that.\n\n112\n00:04:56,320 --> 00:04:59,155\nOr if I'm just looking for a particular\nservice, I could always just do\n\n113\n00:04:59,155 --> 00:05:03,120\nGet-Service, maybe I'm looking for\nthe computer browser service.\n\n114\n00:05:03,120 --> 00:05:08,440\nI might come in here and say Get-Service\nbrowser, right, and there it is.\n\n115\n00:05:08,440 --> 00:05:11,340\nNow, the problem comes in with that name.\n\n116\n00:05:11,340 --> 00:05:16,740\nIf I do Get-Service and\nthen I put in, if I spell it right,\n\n117\n00:05:16,740 --> 00:05:20,750\nif I put in \"Computer Browser\", and\nsee how I'm putting it in quotes, it does\n\n118\n00:05:20,750 --> 00:05:26,590\nreturn it back, it returns both with\nthe display name or with the actual name.\n\n119\n00:05:26,590 --> 00:05:28,530\nThere can be some problems\nwith that sometimes,\n\n120\n00:05:28,530 --> 00:05:32,370\nsome of the names don't quite return or\nyou might just not know the names exactly,\n\n121\n00:05:32,370 --> 00:05:41,555\nand so you can use wildcards in this, I\ncould do like Get-Service br*, like that.\n\n122\n00:05:41,555 --> 00:05:45,375\nAnd that's gonna show me anyone that has\nbr, so it will find browser and broker,\n\n123\n00:05:45,375 --> 00:05:47,305\nand so each of those are kinda\nturning up in different ways.\n\n124\n00:05:47,305 --> 00:05:48,195\n>> That's really handy,\n\n125\n00:05:48,195 --> 00:05:50,245\nespecially when you don't know\nthe actual what it calls it.\n\n126\n00:05:50,245 --> 00:05:54,765\nBecause as you saw in that previous little\ndemonstration there, that the display name\n\n127\n00:05:54,765 --> 00:05:57,605\nand the name of the actual server\nsometimes don't match up very nicely.\n\n128\n00:05:57,605 --> 00:06:00,645\n>> And there's more information then\nwhat's being displayed on the screen,\n\n129\n00:06:00,645 --> 00:06:02,790\nI know we've seen that\nin other segments too.\n\n130\n00:06:02,790 --> 00:06:06,220\nBut like if I do Get-Service\n\"Computer browser\",\n\n131\n00:06:06,220 --> 00:06:08,750\nit's just showing status names and\ndisplay names.\n\n132\n00:06:08,750 --> 00:06:10,240\nBut if I add a little bit more to that,\n\n133\n00:06:10,240 --> 00:06:13,910\nlike if I type that through,\nwe'll do Format-List, right?\n\n134\n00:06:15,560 --> 00:06:17,990\nYou can see there's name,\ndisplay name and status, but\n\n135\n00:06:17,990 --> 00:06:23,010\nthere's also Dependent services,\nthe services that we depend on.\n\n136\n00:06:23,010 --> 00:06:26,100\nWhether it can shut down,\nwhether it can stop, whether it can pause.\n\n137\n00:06:26,100 --> 00:06:27,750\nNot every service can pause.\n\n138\n00:06:27,750 --> 00:06:29,260\nAnd then what the service type is.\n\n139\n00:06:29,260 --> 00:06:31,590\nSo you see some additional information.\n\n140\n00:06:31,590 --> 00:06:34,550\nBut here's where we start to bump\ninto some of the real problems.,\n\n141\n00:06:34,550 --> 00:06:36,940\nMicrosoft didn't add\nall of the information.\n\n142\n00:06:36,940 --> 00:06:38,190\nSo there's a lot of stuff like that.\n\n143\n00:06:38,190 --> 00:06:40,180\nRecovery options that don't show up here.\n\n144\n00:06:40,180 --> 00:06:41,430\nOur user credentials, right?\n\n145\n00:06:41,430 --> 00:06:43,830\nWhat user account is this\nservice gonna run as.\n\n146\n00:06:43,830 --> 00:06:45,380\nIt doesn't show up in here, right?\n\n147\n00:06:45,380 --> 00:06:47,280\nSo we don't get all the information,\n\n148\n00:06:47,280 --> 00:06:49,900\nwe want and that's because power\nshell is still an evolving product.\n\n149\n00:06:49,900 --> 00:06:52,550\nMicrosoft is adding more and\nmore to it over time.\n\n150\n00:06:52,550 --> 00:06:55,770\nThere are limits to what we can do and\nas a result,\n\n151\n00:06:55,770 --> 00:07:00,650\nmost people are really only\ngonna use PowerShell to stop,\n\n152\n00:07:00,650 --> 00:07:04,730\nstart, and restart services and\nthat's about it.\n\n153\n00:07:04,730 --> 00:07:06,980\nWell, fortunately those\ncommands are really easy.\n\n154\n00:07:06,980 --> 00:07:11,510\nYou've got Stop-Service and\nthen the service that you want to stop.\n\n155\n00:07:11,510 --> 00:07:15,060\nSo if I want to stop the browser,\nI can stop it.\n\n156\n00:07:15,060 --> 00:07:18,720\nWhich I guess it was already stopped so\nthat wasn't too exciting.\n\n157\n00:07:18,720 --> 00:07:23,270\nI can start the service, so\nI can start it up and it'll run.\n\n158\n00:07:23,270 --> 00:07:26,690\nNow mine,\nit says it can't start because, why?\n\n159\n00:07:26,690 --> 00:07:27,430\nWhat's its problem?\n\n160\n00:07:28,530 --> 00:07:29,240\nI've got an error.\n\n161\n00:07:29,240 --> 00:07:30,830\nService command exception.\n\n162\n00:07:30,830 --> 00:07:32,440\nJust says it doesn't wanna start.\n\n163\n00:07:32,440 --> 00:07:34,410\nProbably because I've got\nfile sharing turned off.\n\n164\n00:07:34,410 --> 00:07:35,830\nThe-\n>> Right.\n\n165\n00:07:35,830 --> 00:07:39,970\n>> When it asked me what network I was on,\nI probably chose public.\n\n166\n00:07:39,970 --> 00:07:42,820\nBad habit that, but we could actually\njust double check that over here, and\n\n167\n00:07:42,820 --> 00:07:46,170\ncheck the computer browser service,\nand see if we.\n\n168\n00:07:46,170 --> 00:07:49,120\nOh, it won't start because it's disabled.\n\n169\n00:07:49,120 --> 00:07:49,871\nThere's another new one.\n\n170\n00:07:49,871 --> 00:07:52,633\nNotice that the startup type\ndidn't show up earlier.\n\n171\n00:07:52,633 --> 00:07:55,518\nIt didn't tell me that this was set\nto disabled or manual or automatic,\n\n172\n00:07:55,518 --> 00:07:56,348\nI didn't see that.\n\n173\n00:07:56,348 --> 00:07:59,169\nIt' another limitation so\nif I change that.\n\n174\n00:07:59,169 --> 00:08:00,130\nWe'll just change to manual.\n\n175\n00:08:02,030 --> 00:08:03,850\nWe'll do that via PowerShell\nhere in a minute.\n\n176\n00:08:03,850 --> 00:08:05,540\nBut I'll just do it via GUI,\nsince I'm in there.\n\n177\n00:08:06,840 --> 00:08:10,610\nAll right, so now if I try and\nstart that service up, there we go.\n\n178\n00:08:10,610 --> 00:08:12,100\nNow it actually started.\n\n179\n00:08:12,100 --> 00:08:15,540\nAnd if I do a Get-Service computer\nbrowser I can look at it and\n\n180\n00:08:15,540 --> 00:08:17,025\nI can see that it is actually running.\n\n181\n00:08:17,025 --> 00:08:18,160\n>> Mm-hm.\n\n182\n00:08:18,160 --> 00:08:20,910\nAnd another thing I like to do with some\nof those commands, cuz as we were talking\n\n183\n00:08:20,910 --> 00:08:24,020\nabout in that previous segment [COUGH]\nit doesn't show you any outfit, right?\n\n184\n00:08:24,020 --> 00:08:27,350\nSo if that command works you\ndon't see anything in return.\n\n185\n00:08:27,350 --> 00:08:28,500\nAnd then you can turn around and\n\n186\n00:08:28,500 --> 00:08:30,990\ndo another Get-Service to\nverify that it started.\n\n187\n00:08:30,990 --> 00:08:35,610\nYou could also add a -PassThru to the end\nof that stop or start service, and\n\n188\n00:08:35,610 --> 00:08:39,610\nit'll return information about that\nservice that you just ran that command on.\n\n189\n00:08:39,610 --> 00:08:42,530\nSo it just saves you from having to\ntype another command, I guess, but\n\n190\n00:08:42,530 --> 00:08:44,248\nyou're making your first\ncommand a little bit longer.\n\n191\n00:08:44,248 --> 00:08:51,180\nVideo stop service -PassThru\n>> There we go and it thinks.\n\n192\n00:08:51,180 --> 00:08:53,720\nThere we go and we actually get\nour little status message link so\n\n193\n00:08:53,720 --> 00:08:54,830\nit's waiting to stop.\n\n194\n00:08:54,830 --> 00:08:55,960\nThen we get our output then it's done.\n\n195\n00:08:57,480 --> 00:09:01,750\nAll right, now a lot of times it's not\nthat we want to just stop or just start.\n\n196\n00:09:01,750 --> 00:09:02,770\nWe normally wanna do both.\n\n197\n00:09:02,770 --> 00:09:04,331\nWe wanna restart a service, right.\n\n198\n00:09:04,331 --> 00:09:07,744\nMaybe something like a print spooler has\ngotten stuck, I know that happens a lot.\n\n199\n00:09:07,744 --> 00:09:08,292\n>> Every day.\n\n200\n00:09:08,292 --> 00:09:10,420\n[LAUGH]\n>> So,\n\n201\n00:09:10,420 --> 00:09:15,540\nyou might say Restart-Service and\nthen the name of that service.\n\n202\n00:09:15,540 --> 00:09:16,240\nSo I will do the spore.\n\n203\n00:09:16,240 --> 00:09:18,220\nAnd there it's going to go,\nit's going to restart.\n\n204\n00:09:18,220 --> 00:09:21,940\nAnd I don't get that output so\nwe'll add in the pass view like Mike said.\n\n205\n00:09:21,940 --> 00:09:24,680\nAnd won't get too much more output there.\n\n206\n00:09:24,680 --> 00:09:25,560\n>> Yeah.\nYou don't get to see it,\n\n207\n00:09:25,560 --> 00:09:28,800\nit stops then restarts and\nin the end the status us running.\n\n208\n00:09:29,930 --> 00:09:33,270\n>> All right, so that's it for\nreally the basic operations.\n\n209\n00:09:33,270 --> 00:09:36,050\nBut I don't want to stop there,\nnow as far as what Microsoft has given us,\n\n210\n00:09:36,050 --> 00:09:39,190\nthat is kind of the limit of\nwhat they really give us.\n\n211\n00:09:39,190 --> 00:09:41,370\nBut there are a few other\nthings that we can do.\n\n212\n00:09:41,370 --> 00:09:43,890\nActually, I'm leaving one thing out.\n\n213\n00:09:43,890 --> 00:09:48,470\nI mentioned how I couldn't see whether\nthis one was set to manually start or\n\n214\n00:09:48,470 --> 00:09:52,990\nautomatic start or whatever,\nI can't see it but I actually can set it.\n\n215\n00:09:52,990 --> 00:09:54,480\nWe can set that value.\n\n216\n00:09:54,480 --> 00:09:56,400\nThe computer browser.\n\n217\n00:09:56,400 --> 00:10:00,090\nIt was set to disabled, and\nI switched it over to manual.\n\n218\n00:10:00,090 --> 00:10:03,440\nI did it via the GUI, but I could have\ndone that from the PowerShell here.\n\n219\n00:10:03,440 --> 00:10:07,245\nWe could have just said set-service right?\n\n220\n00:10:07,245 --> 00:10:10,385\nRemember when you see set that means\nwe're changing something that's existing.\n\n221\n00:10:10,385 --> 00:10:14,035\nSo I'm gonna change my browser service and\nI'll use\n\n222\n00:10:14,035 --> 00:10:19,840\nthe -startuptype value to manipulate\nwhat it's startup type is gonna be.\n\n223\n00:10:19,840 --> 00:10:21,080\nThere's three main startup types.\n\n224\n00:10:21,080 --> 00:10:24,190\nThere's manual, automatic, and disabled.\n\n225\n00:10:25,200 --> 00:10:28,380\nSo, I might wanna set this\none to automatic, and\n\n226\n00:10:28,380 --> 00:10:33,730\nif I jump back I can see that\nI'm set to manual right now.\n\n227\n00:10:33,730 --> 00:10:38,490\nIf I change that to automatic I can\njump back here and refresh this.\n\n228\n00:10:39,490 --> 00:10:42,022\nI can jump back here and\nattempt to refresh that.\n\n229\n00:10:42,022 --> 00:10:44,160\n>> [LAUGH]\n>> All right, at some point, there we go.\n\n230\n00:10:45,330 --> 00:10:47,760\nAnd now I can see it\nswitched over to automatic.\n\n231\n00:10:47,760 --> 00:10:48,390\nAll right.\n\n232\n00:10:48,390 --> 00:10:49,520\nSo we can change that.\n\n233\n00:10:49,520 --> 00:10:52,190\nI can even put it back\nto disabled if I want.\n\n234\n00:10:52,190 --> 00:10:57,270\nAnd put that right back to\nhow it was before all right.\n\n235\n00:10:57,270 --> 00:10:58,810\nAnd I left it, did I leave it stopped?\n\n236\n00:10:58,810 --> 00:10:59,620\nI left it stopped.\n\n237\n00:10:59,620 --> 00:11:01,940\nSo we're kinda back where\nwe were in the beginning.\n\n238\n00:11:03,090 --> 00:11:05,750\nAll right but, what if I wanna do\nsomething a little more advanced?\n\n239\n00:11:05,750 --> 00:11:10,600\nAll right what if I wanna change\nthe user account that this runs as?\n\n240\n00:11:10,600 --> 00:11:14,000\nEvery service runs as\na particular user account.\n\n241\n00:11:14,000 --> 00:11:19,010\nAnd if you look at that GUI,\nhere we go, if we look at the GUI for\n\n242\n00:11:19,010 --> 00:11:21,070\ncomputer browser,\nif I were to double click on that and\n\n243\n00:11:21,070 --> 00:11:25,060\ngo to log on I can see it's set to\nlog on with a Local System Account.\n\n244\n00:11:25,060 --> 00:11:26,870\nA lot of your services are.\n\n245\n00:11:26,870 --> 00:11:28,460\nNot all of them are, though.\n\n246\n00:11:28,460 --> 00:11:32,846\nSometimes you'll have ones that log in\nas a user or as the system account.\n\n247\n00:11:32,846 --> 00:11:34,290\nOr something different.\n\n248\n00:11:34,290 --> 00:11:35,770\n>> A lot of times we want to change that,\nright,\n\n249\n00:11:35,770 --> 00:11:38,250\ncuz one of those accounts might\nhave too many permissions.\n\n250\n00:11:38,250 --> 00:11:41,140\nAnd that puts us at a risk because\nif that service gets compromised,\n\n251\n00:11:41,140 --> 00:11:43,390\nthen that attacker has\ntoo many permissions.\n\n252\n00:11:43,390 --> 00:11:46,400\nOr the account might not have enough\npermissions to do what you need it to do.\n\n253\n00:11:46,400 --> 00:11:49,510\nSo a lot of times we're creating now,\nespecially with 2012,\n\n254\n00:11:49,510 --> 00:11:51,820\nwe're creating those\nGroup Managed Service Accounts.\n\n255\n00:11:51,820 --> 00:11:54,070\nand I need to be able to go\nback to that service then and\n\n256\n00:11:54,070 --> 00:11:55,680\ntell it what account I\nwant it to run under.\n\n257\n00:11:56,960 --> 00:11:59,580\n>> Yeah and if we look at this one,\nlike I've got a little SQL server\n\n258\n00:11:59,580 --> 00:12:02,510\nrunning on here and it's running\nas a dedicated service account.\n\n259\n00:12:02,510 --> 00:12:06,080\nSo I can see, I've got an account\ncalled MSSQLserver right there.\n\n260\n00:12:06,080 --> 00:12:08,130\nThat's the credential that it runs as.\n\n261\n00:12:08,130 --> 00:12:09,410\nIf I want to change that,\n\n262\n00:12:09,410 --> 00:12:12,580\nthere's not really a great way\nto do it from the PowerShell.\n\n263\n00:12:12,580 --> 00:12:16,150\nBut, you can use the WMI or\nthe CIM to be able to tap in to do it.\n\n264\n00:12:16,150 --> 00:12:18,960\nThese are the other management\nfaces inside of Windows.\n\n265\n00:12:18,960 --> 00:12:22,100\nAnd in the PowerShell we actually\ndo have some commands that let us\n\n266\n00:12:22,100 --> 00:12:23,390\ninteract with those.\n\n267\n00:12:23,390 --> 00:12:26,210\nThese commands are gonna be much longer\nbecause we're basically having to\n\n268\n00:12:26,210 --> 00:12:30,120\ntell the power shell to reach\nout to a different system\n\n269\n00:12:30,120 --> 00:12:32,620\nto then manipulate the data\nwe want to manipulate.\n\n270\n00:12:32,620 --> 00:12:34,950\nOver time, Microsoft will add\nmore of these commands in and\n\n271\n00:12:34,950 --> 00:12:37,920\nwe won't have to do that anymore,\nbut for now we do.\n\n272\n00:12:37,920 --> 00:12:40,370\nAll right, so\nlet me show you an example of that.\n\n273\n00:12:41,640 --> 00:12:45,080\nWhat I'm gonna do is I'm gonna say,\ninstead of executing a normal command.\n\n274\n00:12:45,080 --> 00:12:49,980\nAnd let me resize this so\nmy head won't cover up the full command.\n\n275\n00:12:49,980 --> 00:12:54,226\nBut instead of just typing in\na normal command, I'm going to do\n\n276\n00:12:54,226 --> 00:12:59,550\ninvoke-cim method.\n\n277\n00:12:59,550 --> 00:13:04,130\nI'm reaching into the CIM and\nhaving it do some work for me.\n\n278\n00:13:04,130 --> 00:13:06,830\nSo Microsoft does give us\nthe command to be able to do that,\n\n279\n00:13:06,830 --> 00:13:09,740\nit's just not directly for\nworking with our services.\n\n280\n00:13:10,900 --> 00:13:16,800\nAnd I'm gonna be doing a Change,\nand I'll put in my arguments here.\n\n281\n00:13:16,800 --> 00:13:20,570\nMy argument is I need\nto change my StartName.\n\n282\n00:13:20,570 --> 00:13:23,840\nStartName is the argument that\nsets who the user account is so\n\n283\n00:13:23,840 --> 00:13:27,920\nthat run as, whatever they call it,\nStartName for whatever reason.\n\n284\n00:13:27,920 --> 00:13:31,265\nI don't know necessarily the logic behind\nthat, [LAUGH] but it is what it's called.\n\n285\n00:13:31,265 --> 00:13:35,567\n>> [LAUGH]\n>> And I'll set it to whatever I am, so\n\n286\n00:13:35,567 --> 00:13:40,940\nif I'm in a domain,\nITPROTV/dpezzet for example.\n\n287\n00:13:40,940 --> 00:13:42,670\nI'm gonna set that as my start name,\n\n288\n00:13:42,670 --> 00:13:45,500\nthat's the account that I\nwant this thing to start as.\n\n289\n00:13:45,500 --> 00:13:50,750\nI can then set my start password cuz\nit needs to know the password to use.\n\n290\n00:13:50,750 --> 00:13:53,790\nAnd I'll put in whatever\nthat happens to be.\n\n291\n00:13:53,790 --> 00:13:57,500\nNow you guys know my password.\n\n292\n00:13:57,500 --> 00:14:01,490\n>> Oh No! [LAUGH] >> So I'll punch\nthat one in and now it knows what\n\n293\n00:14:01,490 --> 00:14:04,650\nwe want to change but we haven't told it\nwhat service we want to change it for.\n\n294\n00:14:04,650 --> 00:14:08,140\nAnd here's where things get hard\nbecause we have to do a CIM query.\n\n295\n00:14:08,140 --> 00:14:11,000\nAnd CIM has its own little query language.\n\n296\n00:14:11,000 --> 00:14:13,830\nWhich I don't know anybody who has it\nmemorized, but I'm sure somebody does.\n\n297\n00:14:13,830 --> 00:14:15,162\n>> Surely not.\nWell, somebody does.\n\n298\n00:14:15,162 --> 00:14:19,870\n>> It's actually pretty similar to SQL,\nbut not exactly.\n\n299\n00:14:19,870 --> 00:14:23,390\n>> It really is close to Transact-SQL,\nit's just different class names, right.\n\n300\n00:14:23,390 --> 00:14:25,960\nSo you gotta know those Win32_Service and\nthings like that, but\n\n301\n00:14:25,960 --> 00:14:27,330\nthe structures the same.\n\n302\n00:14:27,330 --> 00:14:30,030\nSelect all, select asterisk from, and\n\n303\n00:14:30,030 --> 00:14:31,680\nyou get your where clauses and\nthings like that.\n\n304\n00:14:31,680 --> 00:14:33,780\nBut you see it really is\nstarting to get clunky,\n\n305\n00:14:33,780 --> 00:14:35,740\nbecause we're not using\nnative PowerShell commands.\n\n306\n00:14:35,740 --> 00:14:39,890\nRight, we're actually having to provide\nall the information that the SIN method\n\n307\n00:14:39,890 --> 00:14:40,561\nwould need.\n\n308\n00:14:40,561 --> 00:14:43,528\nAll right instead of just using\nour normal PowerShell syntax.\n\n309\n00:14:43,528 --> 00:14:48,417\n>> So what it's gonna do, is it's gonna\nrun this query select star from Win32\n\n310\n00:14:48,417 --> 00:14:51,140\nservice where name equals browser.\n\n311\n00:14:51,140 --> 00:14:54,040\nSo it's looking for\nany service name browser.\n\n312\n00:14:54,040 --> 00:14:58,240\nAnd then it's gonna change the arguments\non that server so the start name and\n\n313\n00:14:58,240 --> 00:15:00,340\nstart password are my name and password.\n\n314\n00:15:00,340 --> 00:15:01,010\nAll right?\n\n315\n00:15:01,010 --> 00:15:03,940\nThat's gonna make that service\nrun under that account.\n\n316\n00:15:03,940 --> 00:15:09,010\nNow, one thing to watch out for, this\nquery has to be surrounded in quote marks,\n\n317\n00:15:09,010 --> 00:15:10,610\nright, because there's spaces in it.\n\n318\n00:15:10,610 --> 00:15:13,520\nWell, browser has to be surrounded\nin quote marks also, or\n\n319\n00:15:13,520 --> 00:15:16,950\nwhatever the name of your service is,\nand you can't use double quotes in both\n\n320\n00:15:16,950 --> 00:15:19,830\nplaces, so\nI use double quotes around the query.\n\n321\n00:15:19,830 --> 00:15:24,770\nAnd I use single apostrophes\naround the word browser, so\n\n322\n00:15:24,770 --> 00:15:27,870\nthere's actually an apostrophe followed by\na double quote right there at the end of\n\n323\n00:15:27,870 --> 00:15:28,430\nthe word browser.\n\n324\n00:15:28,430 --> 00:15:31,840\nAnd when we run that,\nassuming that I don't have a typo,\n\n325\n00:15:31,840 --> 00:15:36,060\nwhich apparently I do, then it will go\nahead and apply that and get it set.\n\n326\n00:15:36,060 --> 00:15:39,940\nSo it is complaining about let's see.\n\n327\n00:15:39,940 --> 00:15:41,030\nDid I spell arguments wrong?\n\n328\n00:15:42,310 --> 00:15:45,000\nIt says cannot evaluate\nparameter argument's because\n\n329\n00:15:45,000 --> 00:15:48,220\nargument is specified as a script\nblock and there is no input.\n\n330\n00:15:49,310 --> 00:15:50,180\nWell isn't that exciting.\n\n331\n00:15:50,180 --> 00:15:52,580\nI must have a typo.\n\n332\n00:15:52,580 --> 00:15:55,446\nLet me just scan over this real quick and\nsee if I can't spot my typo.\n\n333\n00:15:55,446 --> 00:15:55,968\nAll right.\nSo\n\n334\n00:15:55,968 --> 00:15:57,559\nnow it's time for the joy of power shell.\n\n335\n00:15:57,559 --> 00:15:58,940\nWe get to find my mistakes.\n\n336\n00:15:58,940 --> 00:15:59,486\nRight.\n\n337\n00:15:59,486 --> 00:16:00,838\nSo, it's easy to make them.\n\n338\n00:16:00,838 --> 00:16:04,177\nYou know, as I look at the command here,\nthere's a couple of problems right.\n\n339\n00:16:04,177 --> 00:16:06,499\n>> They definitely let you\nknow when you make a mistake,\n\n340\n00:16:06,499 --> 00:16:09,635\nyou get that red text everywhere,\nyour screen starts bleeding on you.\n\n341\n00:16:09,635 --> 00:16:10,780\n[LAUGH]\n>> And sadly,\n\n342\n00:16:10,780 --> 00:16:12,320\nthere's more than one mistake here.\n\n343\n00:16:12,320 --> 00:16:15,000\nBut it's complaining about\none in particula,r about my\n\n344\n00:16:15,000 --> 00:16:17,210\narguments not having any input.\n\n345\n00:16:17,210 --> 00:16:19,150\nAnd the problem is,\nI did this script block, and\n\n346\n00:16:19,150 --> 00:16:20,980\nI didn't stick an @\nsymbol at the beginning.\n\n347\n00:16:20,980 --> 00:16:25,720\nWhen you do that, the squiggly brackets\nis an input to a modifier like that.\n\n348\n00:16:25,720 --> 00:16:27,440\nIt's gotta have an @ symbol before it.\n\n349\n00:16:27,440 --> 00:16:28,960\nSo I just need to add that on.\n\n350\n00:16:28,960 --> 00:16:32,400\nThe other problem is I, well,\nI assume it's a problem,\n\n351\n00:16:32,400 --> 00:16:36,640\nI'll correct it before it becomes one,\nis that I used a fake name here.\n\n352\n00:16:36,640 --> 00:16:38,670\nI'm just gonna switch\nthat to a valid account.\n\n353\n00:16:38,670 --> 00:16:40,275\nThis machine is called server 01.\n\n354\n00:16:40,275 --> 00:16:41,090\n>> Mm-hm.\n>> And so\n\n355\n00:16:41,090 --> 00:16:42,740\nI'm just gonna provide that there.\n\n356\n00:16:42,740 --> 00:16:45,690\nSo that should be enough to get\nus in business right there.\n\n357\n00:16:45,690 --> 00:16:47,330\nAnd I'll go ahead and run it.\n\n358\n00:16:47,330 --> 00:16:49,860\nAnd I get my return value of zero there.\n\n359\n00:16:49,860 --> 00:16:51,770\nSo it looks like it is happy.\n\n360\n00:16:51,770 --> 00:16:53,965\nAnd I guess we can verify that real quick.\n\n361\n00:16:53,965 --> 00:16:56,170\n>> Mm-hm.\n>> Let me just jump back to my\n\n362\n00:16:56,170 --> 00:16:56,700\nscreen here.\n\n363\n00:16:56,700 --> 00:16:59,440\nSo here's my computer browser service,\nit's disabled.\n\n364\n00:16:59,440 --> 00:17:01,380\nRight now it's set to\nrun as the local system.\n\n365\n00:17:01,380 --> 00:17:03,040\nI'm just gonna refresh that.\n\n366\n00:17:03,040 --> 00:17:05,600\nAnd let's see what happens there.\n\n367\n00:17:05,600 --> 00:17:08,380\nAnd sure enough,\nnow it shows as running as DPezet.\n\n368\n00:17:08,380 --> 00:17:11,900\nNow it did change it to dot slash DPezet.\n\n369\n00:17:11,900 --> 00:17:12,530\nBut that's okay.\n\n370\n00:17:12,530 --> 00:17:14,755\nDot, that means this computer, which is.\n\n371\n00:17:14,755 --> 00:17:16,297\n>> [CROSSTALK], yeah.\n\n372\n00:17:16,297 --> 00:17:17,720\nSo a little bit different\nthan what I punched in.\n\n373\n00:17:17,720 --> 00:17:20,180\nBut it did actually change this,\nnow that user account is set.\n\n374\n00:17:20,180 --> 00:17:23,600\nNow, if the service was\nrunning when I did that,\n\n375\n00:17:23,600 --> 00:17:26,070\nit doesn't actually take effect\nuntil you restart it, so\n\n376\n00:17:26,070 --> 00:17:30,090\nI'd need to do a restart-service,\nand that would push that along.\n\n377\n00:17:30,090 --> 00:17:33,800\nBut, that long command right there,\nthat's what took care of it.\n\n378\n00:17:33,800 --> 00:17:37,396\nAnd we've got Invoke-Cimmethod,\nthat's me calling the sIM.\n\n379\n00:17:37,396 --> 00:17:42,012\nI did -name Change to let it know\nthat's the method I'm using, a change.\n\n380\n00:17:42,012 --> 00:17:45,760\n-Arguments, that's where I provided\nStartName and StartPassword,\n\n381\n00:17:45,760 --> 00:17:47,190\nthe two values I wanted to change.\n\n382\n00:17:47,190 --> 00:17:51,040\nAnd then the query that specified\nwho I wanted to change it on.\n\n383\n00:17:51,040 --> 00:17:54,498\nAnd I did All services where\nthe name equals browser,\n\n384\n00:17:54,498 --> 00:17:57,260\nreached in there,changed it,\nand now it's happy.\n\n385\n00:17:58,300 --> 00:18:00,860\nSo, it's kind of a convoluted\nway to go about things,\n\n386\n00:18:00,860 --> 00:18:03,200\nwe gotta jump through these\nlittle hoops to get it in place.\n\n387\n00:18:03,200 --> 00:18:07,720\nOnce it's done, it actually works\npretty well, and now it's in place.\n\n388\n00:18:07,720 --> 00:18:09,380\nWe're using the PowerShell,l but\n\n389\n00:18:09,380 --> 00:18:13,280\ntechnically we're really using the SIM\nhere to make the changes that we want.\n\n390\n00:18:13,280 --> 00:18:14,790\nNow if I wanted to verify this,\n\n391\n00:18:14,790 --> 00:18:20,690\nI had to jump over to my GUI utility\nto do it here, and that's because,\n\n392\n00:18:20,690 --> 00:18:25,840\nI don't have a great PowerShell command\nto be able to start as options, right.\n\n393\n00:18:25,840 --> 00:18:26,570\n>> Right.\n>> But\n\n394\n00:18:26,570 --> 00:18:27,720\nthere are ways to do it, right Mike?\n\n395\n00:18:27,720 --> 00:18:28,840\n>> There's a couple, yeah, we can do.\n\n396\n00:18:28,840 --> 00:18:32,310\nI think we can use that same query\nbasically, to return that information.\n\n397\n00:18:33,680 --> 00:18:34,610\nFormat it as a table.\n\n398\n00:18:35,640 --> 00:18:39,070\nSo we could use like a,\nwe could use the sIM to do it.\n\n399\n00:18:39,070 --> 00:18:41,280\nWe could use the WMI to do it too.\n\n400\n00:18:41,280 --> 00:18:43,040\nWe got that GWMI?\n\n401\n00:18:43,040 --> 00:18:44,380\n>> GWMI yes.\n\n402\n00:18:44,380 --> 00:18:48,490\n>> Which is just an alias for get dash\n>> Something longer than that right?\n\n403\n00:18:48,490 --> 00:18:50,580\n>> Windows management instrumentation.\n\n404\n00:18:50,580 --> 00:18:54,740\n>> Yeah, it's a long one,\ngwmi, let's find it in here.\n\n405\n00:18:54,740 --> 00:18:55,860\nI'm pulling up the aliases.\n\n406\n00:18:55,860 --> 00:18:56,498\nThere it is.\n\n407\n00:18:56,498 --> 00:19:00,660\nIt's just Get-WMyObject, so we can reach\nin using one of those other methods,\n\n408\n00:19:00,660 --> 00:19:02,850\nto be able to pull the service back and\nreturn whether or\n\n409\n00:19:02,850 --> 00:19:09,010\nnot that actually functions, so\nIf I do that get-wmiobject, or\n\n410\n00:19:09,010 --> 00:19:14,420\nGWMI, we can then follow\nit up with win32_service.\n\n411\n00:19:14,420 --> 00:19:18,710\nWe can pipe that into Format-Table,\n\n412\n00:19:18,710 --> 00:19:22,520\nand I'm just gonna do name and start name\n>> And what's it's gonna do,\n\n413\n00:19:22,520 --> 00:19:25,160\nis it's gonna return to me\na list from all of my services,\n\n414\n00:19:25,160 --> 00:19:29,170\nalong with what user account they\nstart as, and so they're gonna go, and\n\n415\n00:19:29,170 --> 00:19:33,640\nI can find my browser service in here,\nburied in here somewhere.\n\n416\n00:19:33,640 --> 00:19:38,590\nRight there, browser, and I can see it set\nto run as dot slash the changes in place,\n\n417\n00:19:38,590 --> 00:19:42,540\nso again PowerShell can't\ngive me that information, but\n\n418\n00:19:42,540 --> 00:19:45,850\nthe WMI can, so we're using PowerShell\nto reach out to another system.\n\n419\n00:19:47,620 --> 00:19:51,230\nNow, where it gets really bad,\nare some of the other features and\n\n420\n00:19:51,230 --> 00:19:52,910\nservices like the recovery options.\n\n421\n00:19:52,910 --> 00:19:54,510\nIf I go into my recovery options here for\n\n422\n00:19:54,510 --> 00:19:59,260\ncomputer browser, right, what happens if\nthe computer browser service crashes?\n\n423\n00:19:59,260 --> 00:20:00,580\nWell under recovery option,\n\n424\n00:20:00,580 --> 00:20:03,300\nyou can see that the first time\nit crashes restart the service.\n\n425\n00:20:03,300 --> 00:20:07,130\nSecond time or whatever, go ahead and\nrestart the service,or take no action,\n\n426\n00:20:07,130 --> 00:20:08,560\nor reboot the server, right?\n\n427\n00:20:08,560 --> 00:20:10,470\nYou can say all sorts of things in here.\n\n428\n00:20:10,470 --> 00:20:13,370\nYou can set the timers for how long\nit takes to reset the counters, and\n\n429\n00:20:13,370 --> 00:20:16,470\nall of that, right here in this GUI.\n\n430\n00:20:16,470 --> 00:20:19,905\nUnfortunately, For this one, there's\nnot really a great way to do it from\n\n431\n00:20:19,905 --> 00:20:24,815\nthe PowerShell, and even the WMI and the\nSIM are fairly limited on this one too.\n\n432\n00:20:24,815 --> 00:20:27,905\nSo, you're better off\nreaching out to another\n\n433\n00:20:27,905 --> 00:20:29,405\ncommand line utility that's out there.\n\n434\n00:20:29,405 --> 00:20:31,375\nThere's a command line utility called SC,\n\n435\n00:20:32,465 --> 00:20:35,265\nwhich is the service\nconfiguration utility.\n\n436\n00:20:35,265 --> 00:20:38,145\nWe can call that from inside a PowerShell,\nit's just an executable.\n\n437\n00:20:38,145 --> 00:20:40,895\nYou do have to type .exe on\nthe end of it or it doesn't work.\n\n438\n00:20:40,895 --> 00:20:44,310\nIf I just run SC It, oh,\nI'm a liar, look at that.\n\n439\n00:20:44,310 --> 00:20:45,840\nOh no, it's not working.\n\n440\n00:20:45,840 --> 00:20:49,380\nSC is an alias to Set-Content,\nso that's not working, and\n\n441\n00:20:49,380 --> 00:20:50,890\nit's trying to call Set-Content.\n\n442\n00:20:50,890 --> 00:20:56,525\nBut if I do sc.exe, that runs the utility\nthat I want the service configuration.\n\n443\n00:20:56,525 --> 00:21:00,065\nSo we can still use that to reach out and\nmodify some of the other things.\n\n444\n00:21:00,065 --> 00:21:01,575\nA little outside of the PowerShell scope,\nbut\n\n445\n00:21:01,575 --> 00:21:04,595\nI just want to show you a quick example\nof that, just so you are aware.\n\n446\n00:21:05,765 --> 00:21:11,152\nSo for example I might say SC,\noh, let me clear my screen here,\n\n447\n00:21:11,152 --> 00:21:14,170\nSC.exe, followed by what it\nis that I'm doing, right?\n\n448\n00:21:14,170 --> 00:21:18,810\nSo I wanna modify the failure settings for\nthe browser service.\n\n449\n00:21:18,810 --> 00:21:20,850\nThat's the one I've been\nworking with this show.\n\n450\n00:21:20,850 --> 00:21:25,040\nI'm gonna say reset\nthe counter after 24 hours, and\n\n451\n00:21:25,040 --> 00:21:27,240\nyou have to do it in seconds,\nso that's 86,400 seconds.\n\n452\n00:21:28,520 --> 00:21:32,210\nAnd then I'll say the actions,\nare going to be,\n\n453\n00:21:33,430 --> 00:21:37,270\nrestart the service if it fails, and\n\n454\n00:21:37,270 --> 00:21:40,150\nthese are in milliseconds, so\nI'm basically saying in a minute.\n\n455\n00:21:40,150 --> 00:21:42,880\nIf the service fails, wait a minute,\nin case it recovers on its own, and\n\n456\n00:21:42,880 --> 00:21:44,380\nif it doesn't, go ahead and\nrestart the service.\n\n457\n00:21:45,620 --> 00:21:54,040\nAnd then I'll say reboot at 30,000\nmilliseconds, or five minutes.\n\n458\n00:21:54,040 --> 00:21:55,970\n>> Second failure option.\n\n459\n00:21:55,970 --> 00:21:58,050\n>> If we try to restart the service, or\n\n460\n00:21:58,050 --> 00:22:03,020\nwhatever, and it doesn't come back up,\nwell, just reboot the whole server, right?\n\n461\n00:22:03,020 --> 00:22:05,450\nYeah, that would be my second,\nI could do another one.\n\n462\n00:22:05,450 --> 00:22:12,650\nI could come in here and say, like restart\nslash I could even say 6,000 again.\n\n463\n00:22:12,650 --> 00:22:13,780\nSo, wait a minute.\n\n464\n00:22:13,780 --> 00:22:14,980\nTry and restart.\n\n465\n00:22:14,980 --> 00:22:15,610\nWait another minute.\n\n466\n00:22:15,610 --> 00:22:16,690\nTry and restart.\n\n467\n00:22:16,690 --> 00:22:18,720\nWait five minutes and\nthen reboot or whatever.\n\n468\n00:22:18,720 --> 00:22:21,040\nYou specify each of\nthose different options.\n\n469\n00:22:21,040 --> 00:22:24,510\nI'm gonna say, if it doesn't survive that\nfirst reboot, I mean the first restart,\n\n470\n00:22:24,510 --> 00:22:25,220\njust go ahead and reboot.\n\n471\n00:22:25,220 --> 00:22:25,910\n>> Just reboot the whole thing.\n\n472\n00:22:25,910 --> 00:22:26,640\n>> All right?\n\n473\n00:22:26,640 --> 00:22:29,470\nNow this command, you can do this\nin the regular command prompt.\n\n474\n00:22:29,470 --> 00:22:31,110\nYou don't have to do this in PowerShell.\n\n475\n00:22:31,110 --> 00:22:35,150\nBut it's unfortunately kind of the only\neasy way tobe able to get in and\n\n476\n00:22:35,150 --> 00:22:35,810\nmanipulate that data.\n\n477\n00:22:35,810 --> 00:22:38,520\nAnd you'll see my configuration\nchanges succeeded, and\n\n478\n00:22:38,520 --> 00:22:39,660\nnow those values are in place.\n\n479\n00:22:39,660 --> 00:22:44,230\nSo, sometimes you're trying to get\nthe PowerShell to do something.\n\n480\n00:22:44,230 --> 00:22:46,910\nIs like getting a square peg\nto fit in a round hole, and\n\n481\n00:22:46,910 --> 00:22:50,870\nit just makes sense to use some of\nthe other utilities that are out there.\n\n482\n00:22:50,870 --> 00:22:53,820\n>> Eventually we'll see a lot of those\ncommands included in PowerShell,\n\n483\n00:22:53,820 --> 00:22:58,280\nbecause PowerShell, in the end,\nis gonna be the one to rule them all.\n\n484\n00:22:58,280 --> 00:22:59,629\n>> Yeah, eventually.\n[LAUGH] All right well,\n\n485\n00:22:59,629 --> 00:23:01,190\nI think that's about it for services.\n\n486\n00:23:01,190 --> 00:23:05,870\nSo in this segment we got a chance to\nsee how to view our services, start,\n\n487\n00:23:05,870 --> 00:23:08,260\nstop, restart services,\nthat was a good time.\n\n488\n00:23:08,260 --> 00:23:12,600\nWe saw how to use the SIM to modify\nthe start up account for a service, and\n\n489\n00:23:12,600 --> 00:23:16,640\nstart a password, and we saw using\nthe WMI to query that data back and\n\n490\n00:23:16,640 --> 00:23:18,590\nverify that it was in place.\n\n491\n00:23:18,590 --> 00:23:22,400\nAnd lastly we saw using an external\nutility, to be able to modify the service\n\n492\n00:23:22,400 --> 00:23:24,900\nstatus so, a couple of\ndifferent ways to work with it.\n\n493\n00:23:24,900 --> 00:23:25,730\nIt's all neat stuff.\n\n494\n00:23:25,730 --> 00:23:27,131\nDefinitely things that can be used.\n\n495\n00:23:27,131 --> 00:23:27,829\n>> Absolutely.\n\n496\n00:23:27,829 --> 00:23:29,408\n>> All right, well,\nI hope you guys enjoyed the segment.\n\n497\n00:23:29,408 --> 00:23:32,783\nStay tuned,\nwe got more PowerShell coming up.\n\n498\n00:23:32,783 --> 00:23:38,970\n[MUSIC]\n\n",
          "vimeoId": "116155662"
        },
        {
          "description": "",
          "length": "678",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-7-managing_processes-0106015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-7-managing_processes-0106015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-7-managing_processes-0106015-sm.jpg",
          "title": "Managing Proceses",
          "transcript": "1\n00:00:00,240 --> 00:00:08,059\n[MUSIC]\n\n2\n00:00:08,059 --> 00:00:11,655\nIn this segment we're going to take\na look at managing processes from within\n\n3\n00:00:11,655 --> 00:00:13,600\nthe Microsoft PowerShell.\n\n4\n00:00:13,600 --> 00:00:15,140\nMost of us are familiar with the,\n\n5\n00:00:15,140 --> 00:00:19,350\nthe graphical interface that we have,\nit's called the Task Manager in Windows.\n\n6\n00:00:19,350 --> 00:00:21,170\nAnd it lets you see all of your processes,\n\n7\n00:00:21,170 --> 00:00:23,230\nwhat's running,\ntheir CPU loads and all that.\n\n8\n00:00:23,230 --> 00:00:28,060\nAnd that's great if you're sitting at\nthe machine and you've got your GUI handy.\n\n9\n00:00:28,060 --> 00:00:29,780\nBut if you're trying to work\nwith things from the PowerShell\n\n10\n00:00:29,780 --> 00:00:30,990\nit's not particularly useful.\n\n11\n00:00:30,990 --> 00:00:33,530\nSo fortunately we have a whole suite of\n\n12\n00:00:33,530 --> 00:00:37,240\nutilities that we can use from the\nPowerShell to really do the same thing.\n\n13\n00:00:37,240 --> 00:00:38,580\nLet's take a look at it.\n\n14\n00:00:38,580 --> 00:00:41,000\nSo here on this machine I've got\nthe Task Manager pulled up and so\n\n15\n00:00:41,000 --> 00:00:42,450\nI've got my processes that are running,\n\n16\n00:00:42,450 --> 00:00:45,705\nyou see like I'm running Internet Explorer\nand some of the other the other\n\n17\n00:00:45,705 --> 00:00:50,835\nthings like the memory they're using and\nso on, all presented right here.\n\n18\n00:00:50,835 --> 00:00:54,675\nI can get that same data\nfrom within the PowerShell.\n\n19\n00:00:54,675 --> 00:00:56,811\nIf I just do Get-Process.\n\n20\n00:00:56,811 --> 00:01:00,915\nGet-Process is kind of like\ntask manager for PowerShell.\n\n21\n00:01:00,915 --> 00:01:04,075\nIt'll show me all the processes that\nare running on this system, and\n\n22\n00:01:04,075 --> 00:01:05,975\nI see there's CPU utilization.\n\n23\n00:01:05,975 --> 00:01:10,310\nI see their memory, network bandwidth,\nhow many handles they've got open.\n\n24\n00:01:10,310 --> 00:01:11,940\nAll listed right here.\n\n25\n00:01:11,940 --> 00:01:15,350\nSame data that we're looking at\ninside of the GUI based task manager.\n\n26\n00:01:16,480 --> 00:01:18,540\nNow the only negative about this view is,\n\n27\n00:01:18,540 --> 00:01:21,710\nunlike the task manager,\nthis is not being dynamically updated.\n\n28\n00:01:21,710 --> 00:01:22,710\nSo the task manager,\n\n29\n00:01:22,710 --> 00:01:26,190\nit's showing you real time data on\nthe utilization on your system.\n\n30\n00:01:26,190 --> 00:01:28,080\nHere, it's a point in time.\n\n31\n00:01:28,080 --> 00:01:31,390\nThis is how things look\nright then when I ran it.\n\n32\n00:01:31,390 --> 00:01:32,900\nNot how it is necessarily right now.\n\n33\n00:01:34,180 --> 00:01:37,430\nNow if I wanna get detailed information\nabout a process, I can do that.\n\n34\n00:01:37,430 --> 00:01:40,600\nEvery process is listed\nalong with a process ID.\n\n35\n00:01:40,600 --> 00:01:42,310\nThat's this column right here.\n\n36\n00:01:42,310 --> 00:01:44,130\nAnd if I take the ID for one.\n\n37\n00:01:44,130 --> 00:01:46,120\nLike, I'll take Internet Explorer here.\n\n38\n00:01:46,120 --> 00:01:47,000\nIt's 3288.\n\n39\n00:01:47,000 --> 00:01:51,260\nWell, I can take that process ID and\nI can add to Get-Process.\n\n40\n00:01:51,260 --> 00:01:52,659\nAnd say Get-Process.\n\n41\n00:01:53,780 --> 00:02:00,030\n- id 3288 and now it'll get me\ninformation about that process itself.\n\n42\n00:02:00,030 --> 00:02:04,640\nWell, you might ask yourself, well wait\na minute Don, it's the same thing right?\n\n43\n00:02:04,640 --> 00:02:06,220\nIt's really just showing the same data.\n\n44\n00:02:06,220 --> 00:02:08,960\nWell the key thing to remember\nhere is there's always more\n\n45\n00:02:08,960 --> 00:02:10,970\nthan what shows up on the screen.\n\n46\n00:02:10,970 --> 00:02:17,010\nIf I were to take that and\npipe that through Format-List,\n\n47\n00:02:17,010 --> 00:02:20,910\nnow I can see, well, actually less,\nright, I'm seeing less data now.\n\n48\n00:02:20,910 --> 00:02:24,920\nID handle CPU name,\nwhat happened to all of that other stuff?\n\n49\n00:02:24,920 --> 00:02:28,370\nWell, the problem here is that the data\nthat we're getting from get dash\n\n50\n00:02:28,370 --> 00:02:31,020\nprocess is actually being pulled\nfrom more than one location,\n\n51\n00:02:31,020 --> 00:02:34,700\nand it's being rendered on the screen,\nand it looks like it's all just one\n\n52\n00:02:34,700 --> 00:02:37,250\nset of data but it's actually coming\nfrom more than one background.\n\n53\n00:02:37,250 --> 00:02:39,010\nYou'll notice that there some\nthings that are even missing,\n\n54\n00:02:39,010 --> 00:02:42,200\nlike what user is responsible for\ngenerating these processes.\n\n55\n00:02:42,200 --> 00:02:46,160\nSo when we start to manipulate that\ndata sometimes we lose some of it and\n\n56\n00:02:46,160 --> 00:02:48,160\nwe have to pull it from other locations.\n\n57\n00:02:49,200 --> 00:02:53,900\nAll right now we can also do things\nlike Get-Process instead of- id,\n\n58\n00:02:53,900 --> 00:02:56,040\nwe can just do like a name.\n\n59\n00:02:56,040 --> 00:03:02,743\nSo if I want to get the process for\niexplorer, Internet Explorer is iexplorer.\n\n60\n00:03:02,743 --> 00:03:04,000\nNow it'll pull that up and\n\n61\n00:03:04,000 --> 00:03:08,070\nthe nice thing here is that I might have\nmore than one process with that name.\n\n62\n00:03:08,070 --> 00:03:09,140\nAnd it'll list it.\n\n63\n00:03:09,140 --> 00:03:12,560\nAnd if there's more than one process that\nI'm looking or I can actually just set\n\n64\n00:03:12,560 --> 00:03:17,610\ncommas in here, and I can say show\nme I explore as well as explorer.\n\n65\n00:03:17,610 --> 00:03:20,800\nI want both, and\nnow I get that filtered view there, too.\n\n66\n00:03:20,800 --> 00:03:24,550\nSo couple of different ways that we can\nmanipulate this data to be able to get\n\n67\n00:03:24,550 --> 00:03:26,340\nexactly what we want.\n\n68\n00:03:26,340 --> 00:03:31,098\nNow, if we're going through the trouble\nto look at processes we're probably\n\n69\n00:03:31,098 --> 00:03:33,269\nconcerned about CPU utilization.\n\n70\n00:03:33,269 --> 00:03:35,180\nAt least for me,\nthat's why I'm normally going.\n\n71\n00:03:35,180 --> 00:03:39,710\nSometimes it's memory or whatever but\na lot of times it's just CPU utilization.\n\n72\n00:03:39,710 --> 00:03:42,840\nSo when we go in here we might\nwanna sort this information.\n\n73\n00:03:42,840 --> 00:03:46,750\nAnd you'll notice when I just do\na straight up Get-Process the data's not\n\n74\n00:03:46,750 --> 00:03:47,930\nreally sorted.\n\n75\n00:03:47,930 --> 00:03:53,120\nIt's kinda spread out just in any order,\nit's not truly random, it's actually\n\n76\n00:03:53,120 --> 00:03:57,110\nalphabetized by the process name and so\nit's just kinda just listed in that order.\n\n77\n00:03:57,110 --> 00:03:58,190\nWell that might make sense for\n\n78\n00:03:58,190 --> 00:04:01,040\nwhat we want, it might not make sense for\nwhat we want.\n\n79\n00:04:01,040 --> 00:04:04,330\nIf I wanna see who's using\nthe most CPU from my system,\n\n80\n00:04:04,330 --> 00:04:09,380\nwell I can take Get-Process and\nI can feed that into Sort-Object and\n\n81\n00:04:09,380 --> 00:04:13,450\nI can sort that out to put it in\nthe order that I want, all right.\n\n82\n00:04:13,450 --> 00:04:15,610\nSo, let me show you an example of that.\n\n83\n00:04:15,610 --> 00:04:18,450\nI'm going to pipe that into Sort-Object,\n\n84\n00:04:18,450 --> 00:04:22,750\nand I'll need to pick what I want to\nsort by, and I'm gonna sort by CPU.\n\n85\n00:04:22,750 --> 00:04:26,070\nAnd so when I do that,\nnow it is sorted by CPU.\n\n86\n00:04:26,070 --> 00:04:28,570\nAnd it goes from lowest to highest so\n\n87\n00:04:28,570 --> 00:04:32,760\nyou'll see my highest CPU utilizer\nright there, down at the bottom.\n\n88\n00:04:32,760 --> 00:04:38,230\nYou can change that if you want if you\njust add -descending to the end of it,\n\n89\n00:04:38,230 --> 00:04:42,360\nthat will flip the order so the highest\nis at the beginning and the lowest is\n\n90\n00:04:42,360 --> 00:04:46,042\nat the bottom, and now I can see that\nsame data just in a different order.\n\n91\n00:04:46,042 --> 00:04:48,120\nSo, Sort-Object is a great way to do that.\n\n92\n00:04:49,870 --> 00:04:51,890\nAll right, some of the other\nthings that we might want to do,\n\n93\n00:04:51,890 --> 00:04:53,460\nwe might want to kill a process.\n\n94\n00:04:53,460 --> 00:04:56,280\nIf I see somebody taking\nup too much CPU or\n\n95\n00:04:56,280 --> 00:04:59,230\njust annoying me in general,\nmaybe like Internet Explorer here,\n\n96\n00:04:59,230 --> 00:05:01,810\nit's just sitting there in\nthe background but it's doing something.\n\n97\n00:05:01,810 --> 00:05:03,200\nSo I decide that I want to kill it.\n\n98\n00:05:03,200 --> 00:05:04,430\nI just want to get it out of there.\n\n99\n00:05:04,430 --> 00:05:08,160\nWell, we can use Stop-Process to do that.\n\n100\n00:05:08,160 --> 00:05:13,030\nIf we run Stop-Process and\nthen the process that we want to kill off,\n\n101\n00:05:13,030 --> 00:05:14,370\nthat will knock it off.\n\n102\n00:05:14,370 --> 00:05:17,065\nNow if I just do Stop-Process iexplorer,\nwell,\n\n103\n00:05:17,065 --> 00:05:20,650\nthere's more than one process\ncalled iexplorer right now.\n\n104\n00:05:20,650 --> 00:05:24,555\nIn Internet Explorer every time you open\nup a tab, it runs in its own process.\n\n105\n00:05:24,555 --> 00:05:29,735\nSo if I do Stop-Process iexplorer,\nit'll kill Internet Explorer outright.\n\n106\n00:05:29,735 --> 00:05:34,075\nBut if I just wanna kill a particular tab,\nI'll need to do it by the id number so\n\n107\n00:05:34,075 --> 00:05:36,000\nI can get that specific one.\n\n108\n00:05:36,000 --> 00:05:38,950\nWe don't normally do that because it's\nreally hard to tell which process ID\n\n109\n00:05:38,950 --> 00:05:40,500\na tab is tied to.\n\n110\n00:05:40,500 --> 00:05:44,380\nBut in other software you might have\na reason to kill off a particular process.\n\n111\n00:05:44,380 --> 00:05:46,250\nAnd you'd use the ID for that.\n\n112\n00:05:46,250 --> 00:05:51,995\nIn fact, if you do a Get-Help,\nfor Stop-Process,\n\n113\n00:05:51,995 --> 00:05:58,710\nyou'll see that it accepts i\n-d but- name is the default.\n\n114\n00:05:58,710 --> 00:05:59,860\nSo it's expecting a name.\n\n115\n00:05:59,860 --> 00:06:01,260\nYou can provide it the ID.\n\n116\n00:06:01,260 --> 00:06:03,010\nIt's up to you,\nwhichever one you want to provide.\n\n117\n00:06:04,350 --> 00:06:08,160\nNow also keep in mind that you do need\nto have permissions to stop the task.\n\n118\n00:06:08,160 --> 00:06:12,470\nIf you're just a regular user, you're not\ngoing to be able to kill others' tasks.\n\n119\n00:06:12,470 --> 00:06:16,060\nBut if you're an administrator and you've\nrun your PowerShell with administrative\n\n120\n00:06:16,060 --> 00:06:18,690\nprivileges, you'll be able to\nstop other people's tasks.\n\n121\n00:06:18,690 --> 00:06:22,840\nAnd you can say Stop-Process iexplorer.\n\n122\n00:06:22,840 --> 00:06:26,230\nAnd I've got my Internet Explorer windows\ndown here, so I've got like Google News,\n\n123\n00:06:26,230 --> 00:06:28,000\nand slash dot pulled up, and\n\n124\n00:06:28,000 --> 00:06:32,520\nI'm just gonna run this Stop-Process and\nit's letting me know that, oh sorry,\n\n125\n00:06:32,520 --> 00:06:37,430\nI need to throw in this dash name, so\nit knows what to look for, there we go.\n\n126\n00:06:37,430 --> 00:06:40,820\nAnd I can see that Internet Explorer\njust dropped right out of the bottom.\n\n127\n00:06:40,820 --> 00:06:46,870\nSo that was Stop-Process -name iexplorer,\nand it killed Internet Explorer outright.\n\n128\n00:06:46,870 --> 00:06:50,980\nIf I do a Get-Process,\n\n129\n00:06:50,980 --> 00:06:56,240\niexplorer, now it's gonna return back and\ntell me there's nothing.\n\n130\n00:06:56,240 --> 00:06:58,990\nThere were no processes called iexplorer.\n\n131\n00:06:58,990 --> 00:07:01,880\nAnd I know I didn't have a syntax\nerror cuz if I just change that to,\n\n132\n00:07:01,880 --> 00:07:04,240\nlike, explorer, that returns back.\n\n133\n00:07:04,240 --> 00:07:06,120\nRight?\nSo there were just no processes\n\n134\n00:07:06,120 --> 00:07:06,755\ncalled iexplorer.\n\n135\n00:07:08,800 --> 00:07:12,730\nAll right, there are some other neat\nlittle tricks that we can do with this.\n\n136\n00:07:12,730 --> 00:07:17,190\nFor most people, that's all you need right\nthere, Get-Process and Stop-Process.\n\n137\n00:07:17,190 --> 00:07:20,860\nThose are the two main ones that we use,\nbut there's another one that I like,\n\n138\n00:07:20,860 --> 00:07:25,440\nif you want to hunt for processes that\nare frozen, that are not responding.\n\n139\n00:07:25,440 --> 00:07:27,490\nYou know how sometimes\na program will lock up and\n\n140\n00:07:27,490 --> 00:07:29,390\nin the task manager it will\njust say not responding and\n\n141\n00:07:29,390 --> 00:07:34,150\nyou can try an end the task that way We\ncan actually use the PowerShell to query\n\n142\n00:07:34,150 --> 00:07:38,030\nfor which processes are not responding,\nand then attempt to terminate them.\n\n143\n00:07:38,030 --> 00:07:41,390\nOr maybe we just wanna query and\nsee which one's not responding, right.\n\n144\n00:07:41,390 --> 00:07:44,710\nSo that command,\nit actually involves more than one thing.\n\n145\n00:07:44,710 --> 00:07:47,760\nI'm gonna start with Get-Process,\nall right, so\n\n146\n00:07:47,760 --> 00:07:53,720\nthat's gonna pull my process list, and\nI'm gonna pipe that into where-object.\n\n147\n00:07:53,720 --> 00:07:57,570\nRemember, we can use where-object to\nfilter the output that we're getting, so\n\n148\n00:07:57,570 --> 00:08:01,540\nI'm gonna filter this out, and I'm gonna\nfilter it out with a little filter script.\n\n149\n00:08:03,850 --> 00:08:06,780\nAnd my filter script is\ngonna be a fairly simple one\n\n150\n00:08:06,780 --> 00:08:09,428\nI'm going to start by\ntaking my original data.\n\n151\n00:08:09,428 --> 00:08:10,860\nSo that $_,\n\n152\n00:08:10,860 --> 00:08:14,420\nthat's a reference that says whatever\nthe output from the first command is.\n\n153\n00:08:14,420 --> 00:08:19,410\nSo Get-Process is output and\nthen dot responding.\n\n154\n00:08:20,560 --> 00:08:27,370\nWe didn't see it up here, up here in this\ntable there's no column called responding.\n\n155\n00:08:27,370 --> 00:08:31,410\nAnd when I did that format list,\nremember we saw even less.\n\n156\n00:08:31,410 --> 00:08:32,990\nBut it doesn't mean the data isn't there.\n\n157\n00:08:32,990 --> 00:08:35,300\nIt's just not being rendered on screen.\n\n158\n00:08:35,300 --> 00:08:40,510\nAnd so I'm referencing a value that\ndoesn't necessarily show up by default.\n\n159\n00:08:40,510 --> 00:08:42,200\nResponding, right?\n\n160\n00:08:42,200 --> 00:08:45,650\nIf the app is not responding,\nthen it's gonna fail that, right?\n\n161\n00:08:45,650 --> 00:08:52,819\nSo I'm gonna say,$_Responding -eq $False.\n\n162\n00:08:52,819 --> 00:08:56,500\nIf it reflects false,\nthat means it's not responding and\n\n163\n00:08:56,500 --> 00:09:00,180\nthat's an app that I need to kill off,\nalright.\n\n164\n00:09:00,180 --> 00:09:03,480\nNow, if I just run it like that well,\n\n165\n00:09:03,480 --> 00:09:08,410\nthat's gonna return a list of any apps\nthat are currently not responding.\n\n166\n00:09:08,410 --> 00:09:14,160\nBut I can take that and I can pipe\nthat one more time into stop-process.\n\n167\n00:09:14,160 --> 00:09:17,835\nAnd now it will say,\ngive me a list of my processes.\n\n168\n00:09:17,835 --> 00:09:20,775\nFilter it down to just the ones\nthat are not responding and\n\n169\n00:09:20,775 --> 00:09:23,325\nwhatever ones are not responding,\nstop them.\n\n170\n00:09:23,325 --> 00:09:25,955\nAll right.\nSo we're kind of stepping through as we go\n\n171\n00:09:25,955 --> 00:09:29,970\nthrough and thin our list out and\nthen stop those processes outright.\n\n172\n00:09:29,970 --> 00:09:31,560\nAnd it kills them out.\n\n173\n00:09:31,560 --> 00:09:34,000\nNow in my case there weren't any\nprocesses that weren't responding so\n\n174\n00:09:34,000 --> 00:09:35,540\nthat's not gonna happen.\n\n175\n00:09:35,540 --> 00:09:39,450\nBut you can make really neat commands like\nthese, right, a series of commands that\n\n176\n00:09:39,450 --> 00:09:43,930\nwork together to achieve your goal and you\ncan automate sorts of things with this.\n\n177\n00:09:43,930 --> 00:09:44,990\nSo really cool.\n\n178\n00:09:44,990 --> 00:09:48,840\nYou can query like what the CPU load\nis of a very particular process,\n\n179\n00:09:48,840 --> 00:09:51,140\nmaybe you're trying to develop\nyour own logging system.\n\n180\n00:09:51,140 --> 00:09:52,020\nYou can do that.\n\n181\n00:09:52,020 --> 00:09:55,470\nThere's really no limit to what\nyou can achieve with this.\n\n182\n00:09:55,470 --> 00:09:58,420\nBut, just keep in mind that basically\neverything that you can do inside of\n\n183\n00:09:58,420 --> 00:10:02,520\nthe task manager, well, you can do\nright here through the PowerShell.\n\n184\n00:10:02,520 --> 00:10:06,000\nThe only one that really gives you\na problem is which user is attached to\n\n185\n00:10:06,000 --> 00:10:06,600\nthe process.\n\n186\n00:10:06,600 --> 00:10:10,220\nFor whatever reason, Microsoft hasn't\nadded that support into Powershell yet.\n\n187\n00:10:10,220 --> 00:10:14,202\nBy the time you watch this video maybe\nthey will have, but at this time I'm\n\n188\n00:10:14,202 --> 00:10:18,400\nnot aware of anyway to see what\nuser's responsible for that process.\n\n189\n00:10:18,400 --> 00:10:22,740\nVersus if I go into the task manager, well\nin the task manager you can quickly and\n\n190\n00:10:22,740 --> 00:10:26,630\neasily see which users\nare tied to which processes.\n\n191\n00:10:26,630 --> 00:10:29,530\nWhen I see something like\nWindows Explorer right here,\n\n192\n00:10:29,530 --> 00:10:32,090\nI can see that D Pezet is who launched it.\n\n193\n00:10:32,090 --> 00:10:32,630\nRight?\n\n194\n00:10:32,630 --> 00:10:34,590\nWell, the PowerShell doesn't show that.\n\n195\n00:10:34,590 --> 00:10:36,570\nMicrosoft will probably\nadd that in the future.\n\n196\n00:10:36,570 --> 00:10:40,330\nIf you guys out there in TV land know\na way to do that, definitely let me know.\n\n197\n00:10:40,330 --> 00:10:43,740\nI haven't seen a way to do that, so\nthat's one thing that we can't do, but\n\n198\n00:10:43,740 --> 00:10:47,630\notherwise pulling our data back,\nlooking at how it's going,\n\n199\n00:10:47,630 --> 00:10:52,800\nstopping processes those functions we\ncan easily do from in the power shop.\n\n200\n00:10:52,800 --> 00:10:55,350\nSo in this segment we got\na chance to see Get-Process,\n\n201\n00:10:55,350 --> 00:10:57,838\nwhich is like our PowerShell\nbased task manager.\n\n202\n00:10:57,838 --> 00:11:02,680\nWe saw Stop-Process, how we could stop\nany or kill off any processes running.\n\n203\n00:11:02,680 --> 00:11:06,470\nAnd lastly, I showed you guys how to\ndetect not responding processes and\n\n204\n00:11:06,470 --> 00:11:07,630\nhow to stop them also.\n\n205\n00:11:07,630 --> 00:11:10,070\nI hope you guys enjoyed the segment.\n\n206\n00:11:10,070 --> 00:11:10,660\nStay tuned.\n\n207\n00:11:10,660 --> 00:11:16,119\nWe've got more PowerShell,coming up.\n\n208\n00:11:16,119 --> 00:11:18,450\n[SOUND]\n\n",
          "vimeoId": "116155658"
        },
        {
          "description": "",
          "length": "1762",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-8-configuring_printers-0106015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-8-configuring_printers-0106015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-8-configuring_printers-0106015-sm.jpg",
          "title": "Configuring Printers",
          "transcript": "1\n00:00:00,025 --> 00:00:04,852\n[SOUND] All right in this\nsegment we are going to\n\n2\n00:00:04,852 --> 00:00:09,046\nbe looking at PowerShell commands that\n\n3\n00:00:09,046 --> 00:00:14,012\nare going to allow me to\nwork with my printers.\n\n4\n00:00:14,012 --> 00:00:16,335\nYay printers [LAUGH].\n\n5\n00:00:16,335 --> 00:00:18,510\nThose of you that have seen me before,\n\n6\n00:00:18,510 --> 00:00:21,680\nand some as you might know,\nprinters are not my favorite thing.\n\n7\n00:00:21,680 --> 00:00:24,870\nThey are always seem to be\ncausing problems, but anyway.\n\n8\n00:00:24,870 --> 00:00:28,860\nWe're going to take a look at some of our\nPowerShell commands that we can use to\n\n9\n00:00:28,860 --> 00:00:30,310\nAdd printers to our servers,\n\n10\n00:00:30,310 --> 00:00:35,020\nour print servers, as well as adding\nthe printers to the clients themselves.\n\n11\n00:00:35,020 --> 00:00:37,160\nSo let's just dive right in and\nget started.\n\n12\n00:00:37,160 --> 00:00:40,640\nThese are the HOL labs,\nthat you guys have access to.\n\n13\n00:00:40,640 --> 00:00:46,250\nAnd I've got our 2012, I think it's\nthe 2012 set of lab machines pulled up.\n\n14\n00:00:46,250 --> 00:00:48,840\nI think is what's called on the HOL page.\n\n15\n00:00:48,840 --> 00:00:51,830\nAnd here I am on server\none that's running 2012R2.\n\n16\n00:00:53,100 --> 00:00:55,460\nAnd I'm gonna pull up PowerShell.\n\n17\n00:00:55,460 --> 00:00:57,180\nSo the first thing I'm gonna do.\n\n18\n00:00:57,180 --> 00:00:59,640\nThere's a few steps that\nare involved in adding a printer.\n\n19\n00:00:59,640 --> 00:01:03,160\nYou guys, we've added printers through\nthe GUI interface before, I'm sure.\n\n20\n00:01:03,160 --> 00:01:05,590\nWhen we go to add a printer,\nwe've gotta do a couple of things.\n\n21\n00:01:05,590 --> 00:01:08,610\nWe've gotta make sure we've got\nthe driver For the printer.\n\n22\n00:01:08,610 --> 00:01:11,240\nWe've gotta create a port for\nthat printer.\n\n23\n00:01:11,240 --> 00:01:12,950\nAnd then we've gotta\ncreate the printer itself.\n\n24\n00:01:12,950 --> 00:01:14,890\nRight?\nRemember in Microsoft land,\n\n25\n00:01:14,890 --> 00:01:17,060\nthe thing that sits on your desk, or\n\n26\n00:01:17,060 --> 00:01:20,360\nis sitting over there in the corner of\nthe office, that's not the printer.\n\n27\n00:01:20,360 --> 00:01:22,310\nRight?\nThat's the print device.\n\n28\n00:01:22,310 --> 00:01:26,990\nWhat we've gotta do is create the printer,\nwhich is the icon Within our devices and\n\n29\n00:01:26,990 --> 00:01:31,370\nprinters window, in our control\npanel in our operating system.\n\n30\n00:01:31,370 --> 00:01:33,950\nSo the first thing I'm gonna do,\nis I'm gonna install the print driver.\n\n31\n00:01:35,290 --> 00:01:36,560\nSo the command for that.\n\n32\n00:01:36,560 --> 00:01:39,110\nI've got a link that I'm\ngonna post to the show notes.\n\n33\n00:01:39,110 --> 00:01:42,490\nIn fact I can pull that up real\nquick just to show you guys.\n\n34\n00:01:42,490 --> 00:01:44,590\nMicrosoft has a great page\nof course on tech net.\n\n35\n00:01:45,900 --> 00:01:50,020\nAnd here on again, I'll put that note or\nthis link in our show notes.\n\n36\n00:01:50,020 --> 00:01:53,010\nHere you can see all the different\ncommands I have available for\n\n37\n00:01:53,010 --> 00:01:54,950\nworking for working with my printers.\n\n38\n00:01:54,950 --> 00:01:57,710\nThings like add printer,\nadd printer driver,\n\n39\n00:01:57,710 --> 00:02:01,850\nadd printer port,\nobviously to begin to set this up.\n\n40\n00:02:01,850 --> 00:02:05,480\nAnd then once you've got printers On\nstall, then we've got our get command,\n\n41\n00:02:05,480 --> 00:02:09,360\nwhere we can retrieve properties\nabout those printers, get printer,\n\n42\n00:02:09,360 --> 00:02:14,230\nget printer driver, get printer port,\nget printer properties.\n\n43\n00:02:14,230 --> 00:02:16,460\nWe can also work with\nthe jobs through PowerShell.\n\n44\n00:02:16,460 --> 00:02:19,660\nWe can pull back a list\nof the running jobs.\n\n45\n00:02:19,660 --> 00:02:24,570\nWe can stop and start those jobs,\nresume those jobs, cancel jobs,\n\n46\n00:02:24,570 --> 00:02:25,830\nand things like that.\n\n47\n00:02:25,830 --> 00:02:26,550\nSo let's get started.\n\n48\n00:02:26,550 --> 00:02:30,130\nFirst thing we're going to do again,\nis switch back here to my server and\n\n49\n00:02:30,130 --> 00:02:31,860\nI'm going to install the print drivers.\n\n50\n00:02:31,860 --> 00:02:37,150\nThat's going to be add-printerdriver,\nIf I could spell,\n\n51\n00:02:37,150 --> 00:02:43,620\nit would make the auto-fill a little\nbit easier, add-printerDriver.\n\n52\n00:02:43,620 --> 00:02:45,180\nNow I'm gonna go ahead and\n\n53\n00:02:45,180 --> 00:02:48,680\nuse the switch computer name,\njust to show you guys the switch.\n\n54\n00:02:49,690 --> 00:02:52,280\nBecause I'm running it on the machine\nthat I'm installing the printer,\n\n55\n00:02:52,280 --> 00:02:53,510\nI could just leave that blank.\n\n56\n00:02:53,510 --> 00:02:57,170\nIt will default, if I don't use\nthe -ComputerName parameter,\n\n57\n00:02:57,170 --> 00:03:00,390\nit's gonna default to the machine I'm\nactually running this command on.\n\n58\n00:03:00,390 --> 00:03:03,890\nIf I was doing a remote session\nwith another server, again,\n\n59\n00:03:03,890 --> 00:03:06,730\nI could leave out that -ComputerName,\nbecause I'm on that server,\n\n60\n00:03:06,730 --> 00:03:13,654\nremoting in to it, and it would assume,\nor default, to the local machine.\n\n61\n00:03:13,654 --> 00:03:19,610\nBut I'll do it anyway, -Computer,\nand this guy's name is server one,\n\n62\n00:03:19,610 --> 00:03:23,200\nand then the name of the print\ndriver that I'm installing.\n\n63\n00:03:23,200 --> 00:03:28,010\nSo, I'm going to do a dash name, and\nI'm using a class driver here that's\n\n64\n00:03:28,010 --> 00:03:32,550\nalready installed on this machine, or\nit has available through the Windows.\n\n65\n00:03:32,550 --> 00:03:38,538\nSo, we're going to go to Dell, Color,\n\n66\n00:03:38,538 --> 00:03:44,702\nwhich one did I use here, laser, pcl6,\n\n67\n00:03:44,702 --> 00:03:50,184\nif I remember right, class driver.\n\n68\n00:03:50,184 --> 00:03:53,120\nHit Enter.\n\n69\n00:03:53,120 --> 00:03:56,100\nAnd evidently I can't spell.\n\n70\n00:03:56,100 --> 00:03:57,320\nSomewhere in here.\n\n71\n00:03:57,320 --> 00:04:03,908\nDell color laser PCL 6,\nI misspelled class, how about that.\n\n72\n00:04:03,908 --> 00:04:11,730\nAll right, there There we go so\nnow I've got that driver installed.\n\n73\n00:04:11,730 --> 00:04:16,240\nThe next thing I'm gonna do, is I'm\ngonna create a port for this printer.\n\n74\n00:04:16,240 --> 00:04:19,950\nJust gonna create a standard TCP/IP port,\nhopefully you guys have seen that or\n\n75\n00:04:19,950 --> 00:04:22,170\ngone through the GUI to do that before.\n\n76\n00:04:22,170 --> 00:04:27,642\nAnd we're gonna use PowerShell to do that,\nand it's just an Add-PrinterPort command.\n\n77\n00:04:27,642 --> 00:04:32,055\nSo Add, Dash printer port and\n\n78\n00:04:32,055 --> 00:04:38,880\nmy parameters for that one again I\ncan leave off the dash computer name,\n\n79\n00:04:38,880 --> 00:04:41,800\nbecause I'm doing it on the machine\nthat I want to install the printer on.\n\n80\n00:04:41,800 --> 00:04:45,290\nI'll throw it in there just for\nour example here.\n\n81\n00:04:45,290 --> 00:04:49,730\nSo computer name Server one, and\n\n82\n00:04:49,730 --> 00:04:53,210\nthen dash name, and\nthe name I want to give that port.\n\n83\n00:04:53,210 --> 00:04:57,190\nAnd just to keep things simple, I'm going\nto use the IP address as the name of that\n\n84\n00:04:57,190 --> 00:05:04,721\nport, so in this case the server's\naddress is 192168.1.103.\n\n85\n00:05:07,910 --> 00:05:10,340\nAnd then I need the printer host address.\n\n86\n00:05:10,340 --> 00:05:17,070\nAll right, so that's gonna be\na dash printer post address.\n\n87\n00:05:17,070 --> 00:05:21,110\nAnd again it's gonna be the IP\naddress of this computer.\n\n88\n00:05:22,150 --> 00:05:24,764\nSo, 192 dot 168 dot 1 dot 103.\n\n89\n00:05:26,670 --> 00:05:32,300\nI hit Enter, and hopefully no red text\nmeans my command worked successfully.\n\n90\n00:05:32,300 --> 00:05:36,120\nSo now I've got the printer driver\ninstalled, and I've got a port created.\n\n91\n00:05:36,120 --> 00:05:39,270\nAnd if we wanna take a look at\nthis to see what I've done so far.\n\n92\n00:05:40,320 --> 00:05:44,610\nI'm gonna go back over here to,\nlet's see where I can do this from.\n\n93\n00:05:44,610 --> 00:05:48,287\nLet's pull up my control panel.\n\n94\n00:05:51,375 --> 00:05:56,600\nAnd if we want to take a look, I'm gonna\ngo into my View devices and printers.\n\n95\n00:05:56,600 --> 00:05:58,712\nAnd then I'm gonna pretend\nlike I wanna add a printer.\n\n96\n00:06:02,776 --> 00:06:04,770\nAnd I'm gonna choose to add it manually.\n\n97\n00:06:07,990 --> 00:06:11,761\nAnd in my list of available ports,\nyou'll see the port that I just created.\n\n98\n00:06:11,761 --> 00:06:17,918\nThe 192.168.1.103 listed\nas a standard TCP/IP port.\n\n99\n00:06:17,918 --> 00:06:20,815\nSo my PowerShell commands worked,\nI've installed the driver, and\n\n100\n00:06:20,815 --> 00:06:24,265\nI've installed the, or\ncreated a port for that printer.\n\n101\n00:06:26,165 --> 00:06:29,055\nSo the next step then,\nwould be to actually create the printer,\n\n102\n00:06:29,055 --> 00:06:32,345\nthe little icon you know, attaching\nthe printer to this print server.\n\n103\n00:06:33,425 --> 00:06:35,455\nAnd the command for that is add-printer.\n\n104\n00:06:35,455 --> 00:06:40,660\nSo we'll do an add-printer,\n\n105\n00:06:40,660 --> 00:06:44,470\nand then we're gonna call this guy,\nwell first let me do a dash computer name.\n\n106\n00:06:46,450 --> 00:06:47,990\nAnd that's gonna be server one.\n\n107\n00:06:49,650 --> 00:06:52,732\nAnd then the name that I\nwanna call the printer, and\n\n108\n00:06:52,732 --> 00:06:55,534\nin this case I'm gonna\ncall it sales printer.\n\n109\n00:06:59,550 --> 00:07:03,922\nAnd then the driver, in this one, the\ndriver has to be already installed, right,\n\n110\n00:07:03,922 --> 00:07:07,620\nI'm telling it what driver I wanna\nuse with this particular printer.\n\n111\n00:07:07,620 --> 00:07:11,250\nSo I have to have already installed\nthat driver at this point.\n\n112\n00:07:11,250 --> 00:07:15,180\nSo driver name, and again, you know what?\n\n113\n00:07:15,180 --> 00:07:16,060\nMike's gonna cheat.\n\n114\n00:07:17,100 --> 00:07:18,570\nWe won't cheat.\n\n115\n00:07:18,570 --> 00:07:20,470\nGonna just copy that, but we can do it.\n\n116\n00:07:20,470 --> 00:07:25,772\nDell color laser PCL6\n\n117\n00:07:25,772 --> 00:07:31,930\nclass printer, or class driver.\n\n118\n00:07:34,812 --> 00:07:36,070\nAll right,\nnow that's going to be in quotes for\n\n119\n00:07:36,070 --> 00:07:39,670\nmy spaces there, and\nthen I want to share this printer.\n\n120\n00:07:39,670 --> 00:07:41,840\nNormally if you're installing\na printer on a print server,\n\n121\n00:07:41,840 --> 00:07:45,250\nyou want to share it so your clients\ncan access that printer, right?\n\n122\n00:07:45,250 --> 00:07:47,986\nSo the parameter for\nthat is just dash shared, and\n\n123\n00:07:47,986 --> 00:07:51,010\nthat's going to share that printer out.\n\n124\n00:07:51,010 --> 00:07:52,680\nAnd just like when you go\nthrough the GUI interface,\n\n125\n00:07:52,680 --> 00:07:55,560\nyou get a little check mark to\nallow you to share that printer.\n\n126\n00:07:55,560 --> 00:07:56,898\nAnd there you're gonna get a share name,\nright?\n\n127\n00:07:56,898 --> 00:07:59,720\nThose share name might be different\nfrom the actual name of the printer.\n\n128\n00:07:59,720 --> 00:08:04,706\nIn this case, I'm gonna call this guy And\n\n129\n00:08:04,706 --> 00:08:08,010\nso I'll do a -ShareName.\n\n130\n00:08:08,010 --> 00:08:11,100\nAnd I'm just gonna call this\nsomething like SalesPrint.\n\n131\n00:08:11,100 --> 00:08:15,410\nAnd then the PortName,\n\n132\n00:08:17,660 --> 00:08:22,320\nand I used the IP address as\nthe PortName in that previous command.\n\n133\n00:08:22,320 --> 00:08:25,128\nSo again, 192.168.1.103.\n\n134\n00:08:27,889 --> 00:08:30,898\nAnd I'm gonna go ahead and\npublish this as well.\n\n135\n00:08:30,898 --> 00:08:35,940\nNow, if you want your clients to be\nable to add these printers themselves,\n\n136\n00:08:35,940 --> 00:08:37,930\nright, we've done this in the GUI before.\n\n137\n00:08:37,930 --> 00:08:41,210\nWe wanna go in and make sure that printer\nis published in active directory so\n\n138\n00:08:41,210 --> 00:08:45,140\nwhen they pull up their add printers\nwizard, They can find their printer\n\n139\n00:08:45,140 --> 00:08:48,530\neasily and they can pick it and\nadd it to their client machine.\n\n140\n00:08:48,530 --> 00:08:51,330\nIf I wanna publish this through\nthe PowerShell command it's just\n\n141\n00:08:51,330 --> 00:08:52,310\nthe word publish.\n\n142\n00:08:53,850 --> 00:08:55,020\nOr published, I should say.\n\n143\n00:08:55,020 --> 00:08:56,590\nI'm gonna hit enter.\n\n144\n00:08:58,540 --> 00:09:03,730\nAnd again, no red text means we\nhave not made any major typos.\n\n145\n00:09:03,730 --> 00:09:05,490\nSo I've got three commands I've run so\nfar there.\n\n146\n00:09:05,490 --> 00:09:07,840\nI've done the Add-PrinterDriver,\n\n147\n00:09:07,840 --> 00:09:10,940\nI gave the name of the computer\nthat I'm installing that driver on.\n\n148\n00:09:10,940 --> 00:09:14,940\nI can leave that off because I'm running\nthese commands on this particular machine.\n\n149\n00:09:14,940 --> 00:09:17,960\nAnd then the name of the driver\nthat I'm trying to install.\n\n150\n00:09:17,960 --> 00:09:21,250\nThen we added the printer port,\nso we created a new port for\n\n151\n00:09:21,250 --> 00:09:23,290\nthat printer with the add\nprinter port command.\n\n152\n00:09:23,290 --> 00:09:26,460\nAgain, name of the computer\nyou're creating that port on.\n\n153\n00:09:26,460 --> 00:09:30,280\nThen the name that you wanna assign to\nthe port, it doesn't have to be the IP\n\n154\n00:09:30,280 --> 00:09:34,420\naddress, makes it a little bit easier\nsometimes when you're working with them.\n\n155\n00:09:34,420 --> 00:09:36,130\nThen the actual host address for\n\n156\n00:09:36,130 --> 00:09:39,805\nthat printer port which would be\nthe IP address of your print server.\n\n157\n00:09:39,805 --> 00:09:41,610\n[COUGH] Excuse me.\n\n158\n00:09:41,610 --> 00:09:44,540\nAnd then the last command is\nthat Add-Printer command.\n\n159\n00:09:44,540 --> 00:09:46,640\nI've got my -ComputerName and\nthen server1.\n\n160\n00:09:46,640 --> 00:09:52,110\nThen we've got the name that we want\nto assign to the printer itself,\n\n161\n00:09:52,110 --> 00:09:56,390\nwe've got the driver that that printer\nis going to use, we've shared it, by\n\n162\n00:09:56,390 --> 00:10:00,980\ndoing a --Shared, and then we've got the\nshared name, whatever we wanna call it.\n\n163\n00:10:00,980 --> 00:10:04,700\nRemember that's gonna be the UNC path,\nthat you would connect to it manually\n\n164\n00:10:04,700 --> 00:10:12,300\nIn this case \\\\server1\\SalesPrint,\nand then the name of the port, and\n\n165\n00:10:12,300 --> 00:10:17,340\nuse the IP address for the name, and then\nwe also publish that in active directory.\n\n166\n00:10:17,340 --> 00:10:22,720\nSo at this point, the printer is good to\ngo, on in this particular print server.\n\n167\n00:10:22,720 --> 00:10:24,400\nNext thing I'd want to do then,\n\n168\n00:10:24,400 --> 00:10:27,252\nwould be to install that\nprinter on one of my clients.\n\n169\n00:10:27,252 --> 00:10:34,420\nSo, I'm going to switch over the CL1 here,\nclient one and see what we've got.\n\n170\n00:10:34,420 --> 00:10:38,530\nActually, before I do that,\nlet me switch back to server1 real quick,\n\n171\n00:10:38,530 --> 00:10:40,270\njust to show you guys,\nI forgot to show you.\n\n172\n00:10:40,270 --> 00:10:43,430\nNow that we've added that printer,\nall right,\n\n173\n00:10:43,430 --> 00:10:46,130\nearlier I showed you when\nI added the printer port,\n\n174\n00:10:46,130 --> 00:10:50,120\nit showed up in the list of ports when\nI went to add a printer manually.\n\n175\n00:10:50,120 --> 00:10:53,024\nIf I go to view devices and\nprinters at this point,\n\n176\n00:10:53,024 --> 00:10:55,800\nthere is my sales printer\nthat we just created.\n\n177\n00:10:59,140 --> 00:11:01,480\nAll right,\nnow let's go back over to the client.\n\n178\n00:11:05,819 --> 00:11:08,559\nAnd let's wake my client up,\nevidently he went to sleep.\n\n179\n00:11:11,480 --> 00:11:12,560\nSo we'll get this guy woke up.\n\n180\n00:11:12,560 --> 00:11:14,589\nAnd then the first thing I wanna do is,\n\n181\n00:11:14,589 --> 00:11:18,713\nI'm gonna show you by going through\nthe GUI, you know, making sure that that\n\n182\n00:11:18,713 --> 00:11:23,356\nprinter was published correctly, or that\nit did successfully publish that printer.\n\n183\n00:11:25,856 --> 00:11:26,640\nMm.\n\n184\n00:11:26,640 --> 00:11:27,530\nPassword.\n\n185\n00:11:29,315 --> 00:11:30,430\nKeep your fingers crossed.\n\n186\n00:11:30,430 --> 00:11:34,837\n[NOISE] First try, I like it.\n\n187\n00:11:34,837 --> 00:11:39,561\nAll right, so\nhere I am logged on to CL-1 and\n\n188\n00:11:39,561 --> 00:11:44,641\nif I go over to my control panel,\nand take a look at,\n\n189\n00:11:44,641 --> 00:11:49,389\nlet's just go to,\nview devices and printers.\n\n190\n00:11:51,370 --> 00:11:52,770\nThen I'm gonna click, add a printer.\n\n191\n00:11:55,530 --> 00:11:58,000\nAnd because I published,\nhopefully you guys can see that there,\n\n192\n00:11:58,000 --> 00:12:01,870\nbecause I published that, when I used\nthat command I used the -published,\n\n193\n00:12:01,870 --> 00:12:05,180\nyou can see that it made that object an\nactive directory, makes it very easy for\n\n194\n00:12:05,180 --> 00:12:08,630\nmy clients to find that printer and\nadd it if they want to.\n\n195\n00:12:08,630 --> 00:12:11,490\nSo there's my sales printer on server1.\n\n196\n00:12:11,490 --> 00:12:13,210\nWe don't use the stinking GUI, right?\n\n197\n00:12:13,210 --> 00:12:15,880\nWe wanna see how to do\nthis through PowerShell.\n\n198\n00:12:15,880 --> 00:12:17,990\nSo let's take a peek at those commands.\n\n199\n00:12:17,990 --> 00:12:19,620\nIt's actually a very easy command.\n\n200\n00:12:21,100 --> 00:12:22,780\nWe're gonna fire up PowerShell.\n\n201\n00:12:23,870 --> 00:12:25,830\nAnd all we really need\nto know is the UNC path,\n\n202\n00:12:25,830 --> 00:12:28,670\nthere's gonna be a parameter\ncalled connection name.\n\n203\n00:12:28,670 --> 00:12:31,214\nSo we're using the same command,\nadd-printer.\n\n204\n00:12:32,720 --> 00:12:36,090\nBut instead of adding all the information,\nI'm not adding the printer physically,\n\n205\n00:12:36,090 --> 00:12:38,220\nit's not attached to this machine, right?\n\n206\n00:12:38,220 --> 00:12:41,760\nSo I'm not going through and I'm not doing\nthe add port and the add drivers and\n\n207\n00:12:41,760 --> 00:12:42,810\nthings like that.\n\n208\n00:12:42,810 --> 00:12:46,880\nAll I need to know is, how do I connect\nto that printer via the network?\n\n209\n00:12:46,880 --> 00:12:48,670\nIt's already shared out.\n\n210\n00:12:48,670 --> 00:12:53,419\nSo, connection name, and\nthen the UNC path for that shared printer,\n\n211\n00:12:53,419 --> 00:12:58,330\nwhich is gonna be the name of the server\nback-slash name of the printer,\n\n212\n00:12:58,330 --> 00:13:01,249\nor the shared name of the printer, right?\n\n213\n00:13:01,249 --> 00:13:03,940\nWhich could be different from\nthe actual name of the printer.\n\n214\n00:13:03,940 --> 00:13:06,940\nIn this case, I called it salesprint.\n\n215\n00:13:09,880 --> 00:13:11,220\nAnd we'll hit enter and that's it.\n\n216\n00:13:11,220 --> 00:13:12,380\nThat's the command.\n\n217\n00:13:12,380 --> 00:13:15,857\nAnd give it a minute, this guy's\na little bit low on memory, so he seems.\n\n218\n00:13:15,857 --> 00:13:17,620\nThere we go, that's not too bad.\n\n219\n00:13:17,620 --> 00:13:22,240\nSo, no red text, means my command\nhopefully works successfully.\n\n220\n00:13:22,240 --> 00:13:23,140\nWe will find out.\n\n221\n00:13:23,140 --> 00:13:25,195\nLet's take a peek,\nI'm gonna go over to my Control Panel.\n\n222\n00:13:29,555 --> 00:13:37,490\nTake a look at my devices and printers,\nand again, this guy's a little bit slow.\n\n223\n00:13:37,490 --> 00:13:38,280\nThere it goes.\n\n224\n00:13:38,280 --> 00:13:40,470\nYou see it just popped up on my screen.\n\n225\n00:13:40,470 --> 00:13:44,100\nAnd eventually I'll actually get a check\nmark showing it as my default printer.\n\n226\n00:13:45,200 --> 00:13:48,767\nSo there it is, we now have\na printer installed on my client.\n\n227\n00:13:48,767 --> 00:13:51,625\nAll right, so\na few commands we ran through there,\n\n228\n00:13:51,625 --> 00:13:56,945\nwe added the driver itself to the server,\nwe created\n\n229\n00:13:56,945 --> 00:14:01,865\nthe port on the server, and\nthen we installed the actual printer.\n\n230\n00:14:01,865 --> 00:14:05,015\nThen we went over to the client,\nwe ran that add printer connection again,\n\n231\n00:14:05,015 --> 00:14:08,415\nthis time with just a -connection\nname parameter, and\n\n232\n00:14:08,415 --> 00:14:10,890\ngave it the UNC path for the printer.\n\n233\n00:14:10,890 --> 00:14:15,130\nSo, basic printer commands and\nthat's what we got.\n\n234\n00:14:15,130 --> 00:14:19,930\nAdding a printer to the print server,\nadding that printer to the client.\n\n235\n00:14:19,930 --> 00:14:21,760\nBut let's not stop there,\nwe got a few more things.\n\n236\n00:14:21,760 --> 00:14:24,364\nYou know,\nonce we've got that printer installed,\n\n237\n00:14:24,364 --> 00:14:26,765\nmore things that we can\ndo through PowerShell.\n\n238\n00:14:26,765 --> 00:14:30,370\nCuz we've got a lot of different commands\nthat we can use to manage these printers.\n\n239\n00:14:30,370 --> 00:14:35,340\nAs I was saying earlier, we can work\nwith the print jobs themselves.\n\n240\n00:14:35,340 --> 00:14:39,400\nWe can stop and start jobs and\nthings like that.\n\n241\n00:14:39,400 --> 00:14:41,680\nSo let's take a peek at a few\nof those commands here.\n\n242\n00:14:42,700 --> 00:14:47,257\nFrom the client, what I'm gonna do is, I'm\njust gonna print something real quick so\n\n243\n00:14:47,257 --> 00:14:48,920\nthat we have a job to work with.\n\n244\n00:14:51,369 --> 00:14:53,289\nSo let me make a quick\nlittle text document here.\n\n245\n00:15:01,480 --> 00:15:02,580\nWe'll call it print test.\n\n246\n00:15:07,499 --> 00:15:10,820\nAnd we'll do everybody's favorite,\nhello world, right?\n\n247\n00:15:13,730 --> 00:15:18,179\nWe'll save that file and\nthen let's print that file.\n\n248\n00:15:24,280 --> 00:15:29,680\nA little file print action and there's my\nprinter on server1, and I'll click print.\n\n249\n00:15:31,642 --> 00:15:34,030\nAll right, so at this point,\nI've got a print job over there,\n\n250\n00:15:34,030 --> 00:15:37,630\nshould be sitting in the queue\nof the printer on server1.\n\n251\n00:15:37,630 --> 00:15:42,752\nLet's switch back over to server1 and\nsee what we can find here.\n\n252\n00:15:42,752 --> 00:15:46,620\nAll right,\nfirst thing I'm going to want to do.\n\n253\n00:15:46,620 --> 00:15:49,460\nOh, one thing I did, well, I'll talk\nabout that here in just a second.\n\n254\n00:15:49,460 --> 00:15:52,220\nFirst thing I wanna do is,\nI wanna get a list of the print jobs.\n\n255\n00:15:52,220 --> 00:15:55,441\nIf I'm gonna work with a print\njob through PowerShell,\n\n256\n00:15:55,441 --> 00:15:58,669\nit's going to assign an ID\nto the different print jobs.\n\n257\n00:15:58,669 --> 00:16:02,545\nAnd so, if I wanna stop a job, or\ncancel a job, or restart a job, or\n\n258\n00:16:02,545 --> 00:16:05,751\nsomething like that,\nI'm gonna have to know that ID.\n\n259\n00:16:05,751 --> 00:16:12,408\nTo get the ID,\nit's a command called get-printjob.\n\n260\n00:16:12,408 --> 00:16:18,250\nAll right, it helps if you tell it what\nprinter you wanna get those jobs for.\n\n261\n00:16:18,250 --> 00:16:20,135\nLet's try it again,\n\n262\n00:16:20,135 --> 00:16:25,460\nget-printjob-printername and\nthen we called it sales print.\n\n263\n00:16:28,210 --> 00:16:33,050\nAnd here I can see a list of the different\njobs waiting on that printer.\n\n264\n00:16:33,050 --> 00:16:36,545\nSo there's the ID number that I\nwas referring to there, alright.\n\n265\n00:16:36,545 --> 00:16:41,955\nID number two,\nI can see that's coming from Notepad.\n\n266\n00:16:41,955 --> 00:16:44,635\nI don't think it shows me.\n\n267\n00:16:44,635 --> 00:16:45,855\nIt shows me my submitted time.\n\n268\n00:16:45,855 --> 00:16:47,425\nFor some reason it doesn't\nhave my computer name.\n\n269\n00:16:47,425 --> 00:16:50,675\nI'm not sure why it's not returning\nthe name of that computer.\n\n270\n00:16:50,675 --> 00:16:54,595\nBut now that I've got that ID,\nI can work with that particular print job.\n\n271\n00:16:55,650 --> 00:17:02,370\nAll right so if I wanted to say,\nlet's suspend that particular print job.\n\n272\n00:17:02,370 --> 00:17:04,440\nIf we wanted to pause it.\n\n273\n00:17:04,440 --> 00:17:09,211\nSuspend dash print job, all right.\n\n274\n00:17:09,211 --> 00:17:14,100\nYou gotta tell it what printer the job is\non and so that's gonna be printer name\n\n275\n00:17:15,510 --> 00:17:21,740\nAnd that's gonna be sales print, and\nthen I need the dash ID parameter.\n\n276\n00:17:21,740 --> 00:17:25,560\nThat's where I'm gonna specify which\nparticular job on this printer\n\n277\n00:17:25,560 --> 00:17:28,900\nI want to work with and\nin my case that's gonna be ID number two.\n\n278\n00:17:31,740 --> 00:17:36,390\nAnd we can see that no red text, meaning\nthat I did not, that it had no errors,\n\n279\n00:17:36,390 --> 00:17:37,160\nit should be printing.\n\n280\n00:17:37,160 --> 00:17:39,310\nIn fact if we do another get print job, I\n\n281\n00:17:41,460 --> 00:17:45,810\ncan see over here my job status that,\nthat job is now paused.\n\n282\n00:17:45,810 --> 00:17:49,650\nAll right, so\nyou could use this if you had\n\n283\n00:17:49,650 --> 00:17:54,520\na large print queue and you see a big\ndocument getting ready to be printed and\n\n284\n00:17:54,520 --> 00:17:57,680\nyou've got a bunch of small documents\nbehind it that you wanna go ahead and\n\n285\n00:17:57,680 --> 00:18:00,640\nallow to print you could\nsuspend that big print job.\n\n286\n00:18:00,640 --> 00:18:03,550\nLet those other ones finish, print,\nand then you can go back and\n\n287\n00:18:03,550 --> 00:18:05,180\nresume that print job.\n\n288\n00:18:05,180 --> 00:18:09,170\nSo once those smaller print jobs are\nprinted, how do we go about resuming it?\n\n289\n00:18:09,170 --> 00:18:12,320\nWell, same way we suspended it,\nwe just switch the verb.\n\n290\n00:18:12,320 --> 00:18:15,850\nAll right, remember with PowerShell,\nit's relatively easy to work with.\n\n291\n00:18:15,850 --> 00:18:17,350\nOnce you learn your different nouns,\n\n292\n00:18:17,350 --> 00:18:21,360\nyou're just changing the verb, what you\nwanna do with that particular noun.\n\n293\n00:18:21,360 --> 00:18:24,950\nSo in this case, we've got our\nprint job is gonna be our noun.\n\n294\n00:18:24,950 --> 00:18:30,070\nWe use the keyword or the verb\nsuspend to pause that print job, and\n\n295\n00:18:30,070 --> 00:18:32,760\nto resume it, you'll never guess\nwhat we're gonna use for a verb.\n\n296\n00:18:34,650 --> 00:18:38,010\nYes, resume, that's exactly right.\n\n297\n00:18:39,110 --> 00:18:43,880\nSo resume-printjob and\nthen the name of the printer,\n\n298\n00:18:43,880 --> 00:18:47,180\nso PrinterName,\ntell it what printer we're working with.\n\n299\n00:18:47,180 --> 00:18:51,690\nAnd that's sales print and\n\n300\n00:18:51,690 --> 00:18:56,000\nthen a -id, and id 2 for\nthat particular print job.\n\n301\n00:18:57,260 --> 00:18:59,250\nNo red text is a good thing.\n\n302\n00:18:59,250 --> 00:19:02,250\nWe take another look at our queue,\nwe can do a little get print job for\n\n303\n00:19:02,250 --> 00:19:03,270\nthat sales print printer.\n\n304\n00:19:04,790 --> 00:19:09,270\nAnd now I've got an error listed there,\nprobably cuz there is no printer, but\n\n305\n00:19:09,270 --> 00:19:12,170\nI can see over here in\nthe status that it is printing,\n\n306\n00:19:12,170 --> 00:19:14,080\neven though I've got\nan error listed there.\n\n307\n00:19:14,080 --> 00:19:16,370\nAnd that's just cuz we're\nlying to the computer.\n\n308\n00:19:16,370 --> 00:19:17,758\nI don't actually have a printer.\n\n309\n00:19:17,758 --> 00:19:21,310\n[COUGH] Excuse me.\n\n310\n00:19:21,310 --> 00:19:24,540\nAnother thing you might wanna do\nwith a print job is cancel it.\n\n311\n00:19:24,540 --> 00:19:28,150\nWhat if somebody sent a big print job over\nthere and you don't want it to print or\n\n312\n00:19:28,150 --> 00:19:29,190\nthey didn't mean to print it or\n\n313\n00:19:29,190 --> 00:19:33,930\nthey started printing a 800-page\ndocument on your printer?\n\n314\n00:19:33,930 --> 00:19:37,760\nSo we can also remove a print job and\nsame thing, right.\n\n315\n00:19:37,760 --> 00:19:40,430\nWe're just changing the verb\nthat we're working with.\n\n316\n00:19:40,430 --> 00:19:41,850\nSame noun, print job.\n\n317\n00:19:41,850 --> 00:19:43,470\nWe're just going to change\nthe verb to remove.\n\n318\n00:19:45,200 --> 00:19:48,300\nSo remove-printjob.\n\n319\n00:19:48,300 --> 00:19:54,080\nLet's not remove the printer,\nremove-print job.\n\n320\n00:19:54,080 --> 00:19:58,843\nThe name of the printer that\nI wanna remove this job from.\n\n321\n00:20:01,975 --> 00:20:05,807\nAnd then the ID number of the print\njob that I'm trying to remove.\n\n322\n00:20:07,826 --> 00:20:13,690\nNo red text, we'll do a little get\nprint job to view our queue and\n\n323\n00:20:13,690 --> 00:20:18,165\nyou can see that the status is deleting.\n\n324\n00:20:18,165 --> 00:20:20,445\nI'll try to throw that out\nin a table here real quick.\n\n325\n00:20:25,712 --> 00:20:28,845\nAnd it didn't like that,\npiping it out into a table.\n\n326\n00:20:28,845 --> 00:20:31,245\nInteresting, maybe a list?\n\n327\n00:20:34,815 --> 00:20:36,560\nOh, don't like that one either.\n\n328\n00:20:36,560 --> 00:20:40,030\nAll right, so anyway, so we have,\nnow that we've got that printer installed,\n\n329\n00:20:40,030 --> 00:20:43,760\nwe've seen the commands we're gonna\nuse to take a look at the jobs, right?\n\n330\n00:20:43,760 --> 00:20:46,250\nGet that print job, name of the printer,\n\n331\n00:20:46,250 --> 00:20:49,210\ndash printer name,\nthat's gonna return the queue basically.\n\n332\n00:20:49,210 --> 00:20:52,055\nYou're gonna see all the jobs that\nare listed on that printer and\n\n333\n00:20:52,055 --> 00:20:53,250\ntheir current status.\n\n334\n00:20:53,250 --> 00:20:57,490\nYou want to pause a print job,\nwe use the verb suspend,\n\n335\n00:20:57,490 --> 00:21:01,490\nsuspend dash print job dash printer name,\nname of the printer.\n\n336\n00:21:01,490 --> 00:21:06,010\nAnd then dash ID, and the ID number of\nthat particular print job which we were\n\n337\n00:21:06,010 --> 00:21:10,650\nable to retrieve from the get-printjob\nwhich shows me all of those IDs.\n\n338\n00:21:10,650 --> 00:21:13,530\nAnd then we just change up the verb\ndepending on what we want to do.\n\n339\n00:21:13,530 --> 00:21:19,160\nIf we want to suspend that print job,\nif we want to restart that print job.\n\n340\n00:21:19,160 --> 00:21:23,490\nIf we want to resume that print job or\nif we want to remove that print job.\n\n341\n00:21:25,660 --> 00:21:29,090\nSo, we've seen commands that we can\nuse to actually set up the printer\n\n342\n00:21:29,090 --> 00:21:30,556\nInstall that printer on the print server.\n\n343\n00:21:30,556 --> 00:21:35,000\nWe created the port, we created\nthe driver, we created the printer.\n\n344\n00:21:35,000 --> 00:21:38,940\nWe added the printer to the client\nusing that add printer command and\n\n345\n00:21:38,940 --> 00:21:41,860\nthen dash connection name and\nthen giving it the UNC path.\n\n346\n00:21:41,860 --> 00:21:46,940\nAnd then we've seen how we can work with\nthe actual print jobs on the printer.\n\n347\n00:21:46,940 --> 00:21:50,582\nThe last thing that I wanna show you\nguys is to work with the spooler itself,\n\n348\n00:21:50,582 --> 00:21:52,200\nall right.\n\n349\n00:21:52,200 --> 00:21:57,280\nBut these commands are really, we're not\nusing the printer nouns in this case,\n\n350\n00:21:57,280 --> 00:21:58,900\nright, because the spooler is a service.\n\n351\n00:21:58,900 --> 00:22:01,360\nSo we're gonna work with it\njust like any other service.\n\n352\n00:22:01,360 --> 00:22:05,850\nSo if you want to stop a service, start a\nservice, restart a service, anything like\n\n353\n00:22:05,850 --> 00:22:10,070\nthat we're using our service now, and\nwe're just changing the verb, all right?\n\n354\n00:22:10,070 --> 00:22:12,400\nAnd the name of the service, is spooler.\n\n355\n00:22:12,400 --> 00:22:18,870\nSo if you weren't sure what the name of\nthat service was you can do a get-service,\n\n356\n00:22:18,870 --> 00:22:21,870\nand then you can slowly\nscroll through the list and\n\n357\n00:22:21,870 --> 00:22:27,700\nthen eventually find it or\nyou could Google it, right?\n\n358\n00:22:27,700 --> 00:22:32,510\nBut there is my spooler service,\nthere's my Print Spooler and\n\n359\n00:22:32,510 --> 00:22:35,320\nyou can see currently it is running.\n\n360\n00:22:35,320 --> 00:22:40,100\nSo if I wanna stop that or pause that,\n\n361\n00:22:40,100 --> 00:22:45,630\nwe can do a stop-service, and\nthen just the name of the service,\n\n362\n00:22:45,630 --> 00:22:51,160\nwhich in this case is spooler which is\nnot spelled like that, there we go.\n\n363\n00:22:52,700 --> 00:22:55,140\nAnd you know what I'm gonna do, let me\ntry to, I'm gonna start that back up.\n\n364\n00:22:55,140 --> 00:22:57,823\nTo start it,\nit's just gonna be start-service.\n\n365\n00:23:03,882 --> 00:23:08,280\nI'm going to change that up just a little\nbit, I think I've shown you guys or\n\n366\n00:23:08,280 --> 00:23:12,995\nwe've talked about this parameter in\nother shows or other segments here.\n\n367\n00:23:12,995 --> 00:23:15,945\nNow remember you've got that pass through,\none of the things about PowerShell\n\n368\n00:23:15,945 --> 00:23:20,555\nis it doesn't show you output typically\nif the command was successful, all right.\n\n369\n00:23:20,555 --> 00:23:24,550\nBut we've got that dash pass\nthrough A parameter that we can\n\n370\n00:23:24,550 --> 00:23:28,220\nadd to most of our commands that\nwill give us a little bit of output.\n\n371\n00:23:28,220 --> 00:23:33,090\nSo for example,\nif I use that with that same command,\n\n372\n00:23:33,090 --> 00:23:38,844\nI'm gonna do a stop-service spooler and\nthen, -passthru.\n\n373\n00:23:39,990 --> 00:23:43,270\nAnd what you'll see is instead of just not\nreturning anything and coming back to my\n\n374\n00:23:43,270 --> 00:23:47,740\nnormal prompt, I'm actually getting\nsome status on that particular service.\n\n375\n00:23:47,740 --> 00:23:49,606\nSo I can see that that status is stopped.\n\n376\n00:23:49,606 --> 00:23:56,131\nNow I could have done a get-service and\nthen spooler.\n\n377\n00:24:01,564 --> 00:24:02,886\nTo see that same information.\n\n378\n00:24:02,886 --> 00:24:06,860\nBut by adding that -passthrough I don't\nhave to run two separate commands.\n\n379\n00:24:06,860 --> 00:24:08,980\nAll right, so I can see that information.\n\n380\n00:24:08,980 --> 00:24:12,865\nIf we want to start that spooler\nservice back up we're going to\n\n381\n00:24:12,865 --> 00:24:19,145\nstart-service space spooler, and\nI'll do another passthrough.\n\n382\n00:24:21,740 --> 00:24:24,750\nAnd I can see my spooler\nservice is now running.\n\n383\n00:24:24,750 --> 00:24:28,440\nSo again, working with the spooler is\nreally just like working with any other\n\n384\n00:24:28,440 --> 00:24:31,640\nservice, we've got\nthe same verbs available.\n\n385\n00:24:31,640 --> 00:24:38,950\nI can restart that spooler service,\nrestart-service,\n\n386\n00:24:38,950 --> 00:24:40,810\nname of the service you want to restart.\n\n387\n00:24:43,010 --> 00:24:45,721\nI'll do a -passthrough, but\nit's really not gonna show me anything,\n\n388\n00:24:45,721 --> 00:24:49,465\nit's just gonna show me that it's running,\ncuz it's gonna stop it and then start it.\n\n389\n00:24:49,465 --> 00:24:52,275\nSo in the end the status\nshould remain running.\n\n390\n00:24:52,275 --> 00:24:53,665\nSometimes you know how those printers are.\n\n391\n00:24:53,665 --> 00:24:57,055\nYou gotta kick that spooler in the butt,\nget it going again, so\n\n392\n00:24:57,055 --> 00:24:59,665\nyou can restart that spooler service.\n\n393\n00:24:59,665 --> 00:25:03,735\nAnd then in the end,\nif I wanted to remove the printer,\n\n394\n00:25:03,735 --> 00:25:04,995\ndo I want to remove the printer now?\n\n395\n00:25:06,840 --> 00:25:08,260\nI think we're about done with this.\n\n396\n00:25:08,260 --> 00:25:11,990\nAnd so if I was done with that printer,\nI could do a remove printer.\n\n397\n00:25:11,990 --> 00:25:13,440\nI don't think I actually wanna remove it.\n\n398\n00:25:13,440 --> 00:25:20,700\nBut you can do a Remove-Printer, and\nthen the name of the printer-name.\n\n399\n00:25:20,700 --> 00:25:27,709\nAnd in this case, salesprint, and if I hit\nEnter, obviously I would lose my printer.\n\n400\n00:25:27,709 --> 00:25:28,600\nWhat the heck, let's do it.\n\n401\n00:25:31,294 --> 00:25:33,813\nDid I get an extra space in there or\nsomething?\n\n402\n00:25:38,329 --> 00:25:39,316\nYeah.\n\n403\n00:25:43,310 --> 00:25:45,250\nOh, that's my share name, sorry.\n\n404\n00:25:45,250 --> 00:25:46,160\nWhat did we call that?\n\n405\n00:25:46,160 --> 00:25:47,063\nSalesprinter?\n\n406\n00:25:52,566 --> 00:25:55,230\nIt's not liking that either.\n\n407\n00:25:55,230 --> 00:25:57,979\nBecause I would need quotes around that\nbecause there are spaces in there.\n\n408\n00:26:05,491 --> 00:26:07,760\nThere we go.\n\n409\n00:26:07,760 --> 00:26:08,940\nEventually we'll get that right.\n\n410\n00:26:08,940 --> 00:26:11,240\nSo remember when you're doing that\nremove command, you wanna use the name,\n\n411\n00:26:11,240 --> 00:26:12,290\nnot the share name.\n\n412\n00:26:12,290 --> 00:26:14,360\nRight, I shared it out as salesprint.\n\n413\n00:26:14,360 --> 00:26:17,590\nBut the actual name of\nthe printer was salesprinter.\n\n414\n00:26:17,590 --> 00:26:19,500\nSo when you do that -name parameter there,\n\n415\n00:26:19,500 --> 00:26:21,410\nyou wanna use the actual\nname of the printer.\n\n416\n00:26:21,410 --> 00:26:24,130\nIf it's got spaces in it,\ndon't forget to delimit those,\n\n417\n00:26:24,130 --> 00:26:27,070\notherwise PowerShell sees it as\na single word and then looks at that\n\n418\n00:26:27,070 --> 00:26:29,750\nsecond word as a new command and\nit doesn't know what to do with it.\n\n419\n00:26:31,660 --> 00:26:33,110\nAll right, ladies and\n\n420\n00:26:33,110 --> 00:26:38,140\ngentlemen, those are the commands we\ncan use to work with our printers.\n\n421\n00:26:38,140 --> 00:26:39,220\nAgain, there's more.\n\n422\n00:26:39,220 --> 00:26:41,500\nI'll shoot that link to you guys\nout there in the show notes,\n\n423\n00:26:41,500 --> 00:26:44,240\nthere's a lot of other things\nwe can do with the printer.\n\n424\n00:26:44,240 --> 00:26:47,690\nOne thing we didn't talk\nabout was permissions and\n\n425\n00:26:47,690 --> 00:26:51,200\nlet's hit that real quick\nbefore we call this a segment.\n\n426\n00:26:51,200 --> 00:26:52,380\nWith the printer permissions,\n\n427\n00:26:52,380 --> 00:26:57,270\nwe can configure the printer\npermissions using PowerShell.\n\n428\n00:26:57,270 --> 00:27:01,890\nYou're gonna be setting up what they\ncall it the, you're gonna use SDDL or\n\n429\n00:27:01,890 --> 00:27:05,240\nthe security descriptor\ndefinition language.\n\n430\n00:27:05,240 --> 00:27:08,024\nA little beyond the scope\nof this particular segment.\n\n431\n00:27:08,024 --> 00:27:11,710\nIt's the same thing I would use if I\nwas setting permissions on files and\n\n432\n00:27:11,710 --> 00:27:13,504\nfolders though from PowerShell.\n\n433\n00:27:13,504 --> 00:27:16,766\nAnd if I remember right, I might have\nmade a link for us here for that.\n\n434\n00:27:19,610 --> 00:27:20,900\nOr maybe it's on my notes here.\n\n435\n00:27:20,900 --> 00:27:22,420\nLet's pull that up just real quick.\n\n436\n00:27:23,640 --> 00:27:24,870\nI'll show you guys what I'm talking about.\n\n437\n00:27:30,850 --> 00:27:32,230\nSomewhere I've got that link.\n\n438\n00:27:32,230 --> 00:27:32,930\nThere it is.\n\n439\n00:27:35,120 --> 00:27:37,097\nSo these, as you can see,\nthese are in my show notes already so\n\n440\n00:27:37,097 --> 00:27:38,287\nI'll make sure you guys have those.\n\n441\n00:27:47,366 --> 00:27:48,230\nAll right.\n\n442\n00:27:48,230 --> 00:27:51,080\nAnd this was just a link out\nagain back to Microsoft and\n\n443\n00:27:51,080 --> 00:27:54,010\nyou can see here that when you're working\nwith these security descriptors from\n\n444\n00:27:54,010 --> 00:27:59,190\nPowerShell, there is the syntax for\n\n445\n00:27:59,190 --> 00:28:03,430\nsetting that, your ace_type,\nyour different flags that you want to set.\n\n446\n00:28:03,430 --> 00:28:07,416\nNow what permissions you want to assign,\nthe GUID that you're assigning these\n\n447\n00:28:07,416 --> 00:28:09,700\npermissions over, so\nthe object GUID, the identifier for\n\n448\n00:28:09,700 --> 00:28:14,870\nthat printer in this case, whether\nit's gonna inherit permissions, and\n\n449\n00:28:14,870 --> 00:28:18,237\nthen the SID, the account SID that\nyou're assigning the permissions to.\n\n450\n00:28:19,945 --> 00:28:21,595\nAnd they give you this good reference.\n\n451\n00:28:21,595 --> 00:28:25,165\nIt's got all the different options\nthat you can use, like the Ace Types.\n\n452\n00:28:26,615 --> 00:28:28,655\nAlso, the flags are contained here.\n\n453\n00:28:28,655 --> 00:28:30,915\nWe've got the different\nrights that you can assign.\n\n454\n00:28:33,170 --> 00:28:36,320\nAnd then of course, it's not gonna know\nthe GUIDs for your particular objects or\n\n455\n00:28:36,320 --> 00:28:37,660\nanything like that.\n\n456\n00:28:37,660 --> 00:28:40,520\nAnd then our resource\nattributes that we can specify.\n\n457\n00:28:40,520 --> 00:28:41,450\nSo you can do it,\n\n458\n00:28:41,450 --> 00:28:45,180\nyou can specify permissions on\nthose printers using PowerShell.\n\n459\n00:28:45,180 --> 00:28:48,030\nThat might be something that we'd wanna\nscript because that's gonna be a pretty\n\n460\n00:28:48,030 --> 00:28:49,950\ncomplex command to write out and\n\n461\n00:28:49,950 --> 00:28:53,102\na lot of times you wanna use the same\npermissions on multiple printers.\n\n462\n00:28:53,102 --> 00:28:56,435\nSo that'd be a really good one to save and\nnot have to type out manually each time\n\n463\n00:28:56,435 --> 00:29:00,100\ncuz it's typically gonna involve coming in\nand doing some research, making sure you\n\n464\n00:29:00,100 --> 00:29:03,400\nget those flags set up correctly and\nthe permissions set up properly.\n\n465\n00:29:03,400 --> 00:29:04,760\nSave that out as a script.\n\n466\n00:29:04,760 --> 00:29:10,145\nAnd then whenever you create a new\nprinter, you can just throw that on there.\n\n467\n00:29:10,145 --> 00:29:13,561\nAll right, so I hope you guys\nenjoyed this segment and stay tuned,\n\n468\n00:29:13,561 --> 00:29:14,905\nwe'll be back with more.\n\n469\n00:29:14,905 --> 00:29:22,530\n[SOUND]\n\n",
          "vimeoId": "116155661"
        },
        {
          "description": "",
          "length": "726",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-9-file_operations-0107015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-9-file_operations-0107015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-9-file_operations-0107015-sm.jpg",
          "title": "File Operations",
          "transcript": "1\n00:00:00,452 --> 00:00:07,546\n[MUSIC]\n\n2\n00:00:07,546 --> 00:00:11,172\nIn this segment,\nwe're gonna take a look at working with\n\n3\n00:00:11,172 --> 00:00:14,130\ndata stored in a file\nfrom within PowerShell.\n\n4\n00:00:14,130 --> 00:00:16,027\nLike it gets kind of confusing fast there,\ndoesn't it?\n\n5\n00:00:16,027 --> 00:00:17,090\n>> [LAUGH] It does.\n\n6\n00:00:17,090 --> 00:00:20,260\n>> What I mean is,\ntaking data from the PowerShell screen and\n\n7\n00:00:20,260 --> 00:00:21,830\noutputting that into a file.\n\n8\n00:00:21,830 --> 00:00:23,020\nOr, the opposite way around,\n\n9\n00:00:23,020 --> 00:00:26,410\ntaking data from a file and\ninputting that into PowerShell commands.\n\n10\n00:00:26,410 --> 00:00:28,100\nIt's a pretty useful\nthing to be able to do.\n\n11\n00:00:28,100 --> 00:00:28,620\n>> Yeah, it really is.\n\n12\n00:00:28,620 --> 00:00:31,250\nThere's a lot of times where you run a\ncommand in PowerShell, and it'll spit out\n\n13\n00:00:31,250 --> 00:00:34,020\na whole bunch of information, but\nI wanna save that information.\n\n14\n00:00:34,020 --> 00:00:36,610\nI wanna keep it in a file for\nfuture reference, or I wanna\n\n15\n00:00:36,610 --> 00:00:41,970\nrun that command every so often and have\na running record of what's been going on.\n\n16\n00:00:41,970 --> 00:00:45,410\nSo one of the commands we wanna\ntake a look at is gonna be\n\n17\n00:00:45,410 --> 00:00:47,160\nto put it out to a file.\n\n18\n00:00:47,160 --> 00:00:48,890\nThe command is simply out-file.\n\n19\n00:00:48,890 --> 00:00:51,170\nLet me pull up my machine here.\n\n20\n00:00:53,140 --> 00:00:56,650\nAnd in PowerShell,\nwell do a getprocess command.\n\n21\n00:00:56,650 --> 00:01:00,505\nThatll spill out of lot information, and\nyou guys remember that from the other day.\n\n22\n00:01:00,505 --> 00:01:01,618\nIf we do a get process.\n\n23\n00:01:03,996 --> 00:01:07,885\nIt's gonna list all the processes that\nare currently running on this machine.\n\n24\n00:01:07,885 --> 00:01:11,735\nNow if I wanted to save this information,\nwe're gonna dump this out to a file,\n\n25\n00:01:11,735 --> 00:01:16,340\nlet me get my, PowerShell maximize there.\n\n26\n00:01:16,340 --> 00:01:18,770\nSo we can take that same command.\n\n27\n00:01:18,770 --> 00:01:22,720\nWe can do another get process, and we're\njust gonna pipe that out into an out-file.\n\n28\n00:01:22,720 --> 00:01:25,836\nWe'll do a little out-file.\n\n29\n00:01:25,836 --> 00:01:29,230\nAnd the parameters for\nthat one is just the file path.\n\n30\n00:01:29,230 --> 00:01:31,840\nYou got to tell it where you\nwant to store that file.\n\n31\n00:01:31,840 --> 00:01:36,168\nSo I'm gonna do a -filepath, and\nI've got a folder created on my F drive,\n\n32\n00:01:36,168 --> 00:01:38,545\nhopefully I created that this morning.\n\n33\n00:01:38,545 --> 00:01:40,845\n>> [LAUGH]\n>> We will find out, let's see.\n\n34\n00:01:40,845 --> 00:01:42,160\nYep, doing a tab auto filled.\n\n35\n00:01:42,160 --> 00:01:45,890\nSo scripts, and then the name of\nthe file that you wanna create.\n\n36\n00:01:45,890 --> 00:01:47,941\nWe'll call it something like processes.\n\n37\n00:01:52,643 --> 00:01:53,200\nRight.\n\n38\n00:01:53,200 --> 00:01:53,880\n>> Sweet.\n\n39\n00:01:53,880 --> 00:01:54,380\n>> That's it.\n\n40\n00:01:54,380 --> 00:01:55,370\nAnd it's that simple.\n\n41\n00:01:55,370 --> 00:01:59,910\nSo we go take a look on my F drive and\nscripts.\n\n42\n00:01:59,910 --> 00:02:04,220\nI've got a file called processes,\nand there we go.\n\n43\n00:02:04,220 --> 00:02:05,230\nSo that's the first thing,\n\n44\n00:02:05,230 --> 00:02:09,320\nis just to simply dump the results of\nthat command out into a text file.\n\n45\n00:02:09,320 --> 00:02:12,240\nNext thing I want to show you with\nthis command is, what's gonna happen.\n\n46\n00:02:12,240 --> 00:02:13,590\nWhat if that file name already exists?\n\n47\n00:02:13,590 --> 00:02:16,522\nLike let's say I ran that today and\nthen tomorrow I want to come in and\n\n48\n00:02:16,522 --> 00:02:17,560\nrun that same command.\n\n49\n00:02:17,560 --> 00:02:21,742\nIf I go back over here to PowerShell,\nand try to run that same command,\n\n50\n00:02:21,742 --> 00:02:27,220\nit's gonna run the command, and if we\ntake a look it will end up overwriting.\n\n51\n00:02:27,220 --> 00:02:28,977\nI guess there's really\nnothing to show you.\n\n52\n00:02:28,977 --> 00:02:30,800\n>> [LAUGH]\n>> But it's gonna overwrite that existing\n\n53\n00:02:30,800 --> 00:02:32,341\nfile and that might not be what you want.\n\n54\n00:02:32,341 --> 00:02:33,140\nRight?\n\n55\n00:02:33,140 --> 00:02:36,790\nSo there is a switch that'll prevent that\nif you don't know that the file exists,\n\n56\n00:02:36,790 --> 00:02:39,330\nif the file exists already or\nnot, or if you know it exists and\n\n57\n00:02:39,330 --> 00:02:42,990\nyou don't want to replace it,\nyou can do what's called a NoClobber.\n\n58\n00:02:42,990 --> 00:02:46,160\nI kinda like the name of that.\n\n59\n00:02:46,160 --> 00:02:49,109\nNoClobber, if I run that with\nthe NoClobber parameter,\n\n60\n00:02:49,109 --> 00:02:50,700\nyou'll see I get an error.\n\n61\n00:02:50,700 --> 00:02:56,050\nSo it's telling me here that\nthe processes.txt already exists and\n\n62\n00:02:56,050 --> 00:02:57,577\nit's not gonna overwrite that file.\n\n63\n00:02:57,577 --> 00:03:02,069\nThe other thing we can do with this\ncommand is, maybe I do want to,\n\n64\n00:03:02,069 --> 00:03:05,500\nI wanna run that process every day,\nbut I wanna keep a running total, or\n\n65\n00:03:05,500 --> 00:03:09,400\nI wanna compile that data up.\n\n66\n00:03:09,400 --> 00:03:13,290\nSo we can actually append that data\nto the end of an existing file.\n\n67\n00:03:13,290 --> 00:03:16,810\nAnd all youre gonna do is add, youre\ngonna go ahead and the NoClobber option,\n\n68\n00:03:16,810 --> 00:03:20,250\nand then were gonna add another\nparameter called Append.\n\n69\n00:03:20,250 --> 00:03:20,920\nHandy enough.\n\n70\n00:03:22,590 --> 00:03:25,400\nSo I run that and\nyou see this time I don't get an error.\n\n71\n00:03:25,400 --> 00:03:28,642\nIf I go look at that file,\nclose the other one.\n\n72\n00:03:32,436 --> 00:03:34,750\nWe'll see I should have\ntwo sets of results.\n\n73\n00:03:34,750 --> 00:03:38,490\nLet's say I left the first set of results\nfrom the first time I run the command.\n\n74\n00:03:38,490 --> 00:03:41,030\nAnd then it just added\nto the end of that file\n\n75\n00:03:41,030 --> 00:03:44,060\nthe output from that second\ntime I run that command.\n\n76\n00:03:44,060 --> 00:03:47,180\n>> And now, when you use the out-file\ncommand like Mike is doing,\n\n77\n00:03:47,180 --> 00:03:50,430\nnotice its not manipulating\nthe output in any way.\n\n78\n00:03:50,430 --> 00:03:53,490\nIts showing exactly what\nwouldve been on the screen, but\n\n79\n00:03:53,490 --> 00:03:55,580\ninstead putting it in\na file on the hard drive.\n\n80\n00:03:55,580 --> 00:04:00,160\nAnd there is an alias for this that's put\nin place which is the greater than symbol.\n\n81\n00:04:00,160 --> 00:04:04,710\nSo if Mike had run like get-process and\nthen a greater than symbol and\n\n82\n00:04:04,710 --> 00:04:08,188\na file name, it's the same thing and\nthat's just an alias for Alt-file.\n\n83\n00:04:08,188 --> 00:04:10,620\nThe advantage of Alt-file is\nyou get the other options.\n\n84\n00:04:10,620 --> 00:04:11,508\nThe -NoClobber.\n\n85\n00:04:11,508 --> 00:04:13,190\n>> Right.\n>> The -Append, so you see those.\n\n86\n00:04:13,190 --> 00:04:15,000\nSo if you're watching this show and\nyou're thinking,\n\n87\n00:04:15,000 --> 00:04:16,965\noh why did Mike type that long command?\n\n88\n00:04:16,965 --> 00:04:18,298\n>> [LAUGH]\n>> Well it's to get the full power of\n\n89\n00:04:18,298 --> 00:04:19,229\nthe options that are there.\n\n90\n00:04:19,229 --> 00:04:20,440\n>> Exactly.\n\n91\n00:04:20,440 --> 00:04:23,870\n>> The other thing is if\nyou do want to manipulate\n\n92\n00:04:23,870 --> 00:04:27,850\nthe way this is being represented here\nin the text file you can and if you\n\n93\n00:04:27,850 --> 00:04:32,910\nhaven't watched it already we recorded a\nsegment called, Formatting Command Output.\n\n94\n00:04:32,910 --> 00:04:34,668\nI think it was, what was that?\n\n95\n00:04:34,668 --> 00:04:38,150\nLike 1.8 if you look at\nthe numbers on the episodes.\n\n96\n00:04:38,150 --> 00:04:42,900\nAnd in that show, or in that segment,\nI demonstrated how you could\n\n97\n00:04:42,900 --> 00:04:47,866\nuse export-csv as well as convert-html.\n\n98\n00:04:47,866 --> 00:04:50,562\nI'll make sure I got those right.\n\n99\n00:04:50,562 --> 00:04:52,860\nYes, it's convert2-html,\n\n100\n00:04:52,860 --> 00:04:57,700\nif you use those commands in conjunction\nwith Mike's, it'll output the text file.\n\n101\n00:04:57,700 --> 00:04:59,270\nBut it can format it as HTML.\n\n102\n00:04:59,270 --> 00:05:02,722\nSo it'll render in a web browser or\nit'll output it as a CSV a comma-separated\n\n103\n00:05:02,722 --> 00:05:06,142\nvalues, so you can then import it into\nspreadsheet software, or whatever.\n\n104\n00:05:06,142 --> 00:05:08,010\n>> RIght.\n>> So you can do some really cool stuff\n\n105\n00:05:08,010 --> 00:05:08,970\nwith this.\n\n106\n00:05:08,970 --> 00:05:12,740\nBut at it's basics, out-file stores\nit right there in text file and\n\n107\n00:05:12,740 --> 00:05:15,360\nnow you've got that record,\nyou can store it, save it, use it.\n\n108\n00:05:15,360 --> 00:05:17,140\nWhatever.\n>> Yeah, that hard copy.\n\n109\n00:05:17,140 --> 00:05:20,370\nAll right.\nSo that's taking the data that's being\n\n110\n00:05:20,370 --> 00:05:23,210\nreturned from our command and\nit's dumping it out into the file.\n\n111\n00:05:23,210 --> 00:05:26,290\nAnother thing we want might want to do is\nwe might wanna take data that's already in\n\n112\n00:05:26,290 --> 00:05:28,350\na file and bring that into PowerShell.\n\n113\n00:05:28,350 --> 00:05:30,088\nAnd we'll start out\nwith a very simple one.\n\n114\n00:05:30,088 --> 00:05:33,850\nWe're just gonna dump the contents\nof a file onto the screen here.\n\n115\n00:05:33,850 --> 00:05:36,112\nAnd that's gonna be get-content.\n\n116\n00:05:38,703 --> 00:05:40,422\nAnd then the path to the file,\nso in my case,\n\n117\n00:05:40,422 --> 00:05:42,104\nI've got a file over\non that F drive again.\n\n118\n00:05:45,006 --> 00:05:47,180\nWe'll see if I can find it, there it is.\n\n119\n00:05:47,180 --> 00:05:50,029\nAnd I'm just gonna pipe that, so\nthat command there, get-content,\n\n120\n00:05:50,029 --> 00:05:53,820\nis gonna go read that file and\ngrab the data that's in that file.\n\n121\n00:05:53,820 --> 00:05:56,480\nSo now it's got that information,\nwhat do I wanna do with it?\n\n122\n00:05:56,480 --> 00:06:01,070\nThis time I wanna put it out and I wanna\ndisplay it in my PowerShell Window, and\n\n123\n00:06:01,070 --> 00:06:05,010\nthat's just gonna be out-string.\n\n124\n00:06:05,010 --> 00:06:08,940\nAnd I hit that, and the text file was\njust a simple list of computer names, and\n\n125\n00:06:08,940 --> 00:06:10,290\nthere it dumped it out to the screen.\n\n126\n00:06:10,290 --> 00:06:13,890\nSo if you ever want to display\na file information in PowerShell for\n\n127\n00:06:13,890 --> 00:06:17,340\nsome reason, pretty simple to do but\nwe can take that a step further.\n\n128\n00:06:17,340 --> 00:06:21,540\nIf we wanna get a little more complex with\nour commands cuz the usefulness of that,\n\n129\n00:06:21,540 --> 00:06:22,540\nnot really practical.\n\n130\n00:06:22,540 --> 00:06:23,340\nRight?\n\n131\n00:06:23,340 --> 00:06:24,400\nSo if we wanna,\n\n132\n00:06:24,400 --> 00:06:27,870\nmaybe we've got a list of computers\nwe wanna do something with that list.\n\n133\n00:06:27,870 --> 00:06:29,220\nRight?\nUse that information.\n\n134\n00:06:29,220 --> 00:06:31,850\nI think Don's got us a good\nexample here for that.\n\n135\n00:06:31,850 --> 00:06:34,040\n>> All right, so let me show you guys\na practical application of this.\n\n136\n00:06:34,040 --> 00:06:37,980\nI've got a Windows server machine here and\nif I take a look at it.\n\n137\n00:06:37,980 --> 00:06:41,800\nMaybe I want to install some\nkind of feature or role.\n\n138\n00:06:41,800 --> 00:06:43,480\nRight?\nI'll just pick an easy one\n\n139\n00:06:43,480 --> 00:06:45,210\nas an example like the Telnet client.\n\n140\n00:06:45,210 --> 00:06:48,980\nSo if I look I don't have the Telnet\nclient installed on this server.\n\n141\n00:06:48,980 --> 00:06:50,840\nWell if I want to install it,\n\n142\n00:06:50,840 --> 00:06:54,745\nI know that I can do the add-Windows\nfeature command and I can add it in.\n\n143\n00:06:54,745 --> 00:06:56,230\nRight?\nOr I could do the GUI,\n\n144\n00:06:56,230 --> 00:06:58,790\njust go into server manager and add it.\n\n145\n00:06:58,790 --> 00:07:02,610\nBut what if I wanted to install\nthe Telnet client on 100 servers or\n\n146\n00:07:02,610 --> 00:07:06,010\n1000 servers or if I wanted to make\nthis part of my routine build operation.\n\n147\n00:07:06,010 --> 00:07:08,032\nWhen I build up new servers,\nI want that to be there.\n\n148\n00:07:08,032 --> 00:07:09,060\nAll right?\n\n149\n00:07:09,060 --> 00:07:11,790\nWell, what I could do is I\ncould create a text file that\n\n150\n00:07:11,790 --> 00:07:15,600\nhad a list of all of the servers\nI wanted to install to.\n\n151\n00:07:15,600 --> 00:07:18,990\nAnd I could put in there\nwho I wanted to install to.\n\n152\n00:07:18,990 --> 00:07:23,360\nAnd then, I could read from that file,\nand run a script against it.\n\n153\n00:07:23,360 --> 00:07:26,150\nExecuting that script against each and\nevery machine in the file.\n\n154\n00:07:26,150 --> 00:07:27,090\nAll right.\n\n155\n00:07:27,090 --> 00:07:28,240\nLet me show you an example, so\n\n156\n00:07:28,240 --> 00:07:32,458\nyou can see how this works I'm gonna\nfire up a PowerShell window here.\n\n157\n00:07:32,458 --> 00:07:37,910\nAnd my fonts is going a little\nmicroscopic on me here.\n\n158\n00:07:37,910 --> 00:07:38,820\nSo let me bump that up.\n\n159\n00:07:38,820 --> 00:07:40,910\nBut basically I've got a text file,\n\n160\n00:07:40,910 --> 00:07:45,890\nand I'm just gonna put some host names\nin there, nothing too crazy or fancy.\n\n161\n00:07:45,890 --> 00:07:47,820\nLet me get into my scripts folder.\n\n162\n00:07:48,880 --> 00:07:49,930\nIf I can type it.\n\n163\n00:07:49,930 --> 00:07:51,030\nThere we go.\n\n164\n00:07:51,030 --> 00:07:54,310\nAnd I've made a file\njust called hosts.txt.\n\n165\n00:07:54,310 --> 00:07:55,450\nAnd what you would do,\n\n166\n00:07:55,450 --> 00:07:59,320\nis you would just put in whatever\nhosts that you wanted to install to.\n\n167\n00:07:59,320 --> 00:08:01,140\nYou could just add them right in here.\n\n168\n00:08:01,140 --> 00:08:04,890\nAnd for the sake of this example,\nI've just got my one machine, server01.\n\n169\n00:08:04,890 --> 00:08:09,150\nSo I just put in localhost server01,\nit's really just the same server over and\n\n170\n00:08:09,150 --> 00:08:10,220\nover and over again.\n\n171\n00:08:10,220 --> 00:08:12,640\nWell, it will only install the role or\nfeature once.\n\n172\n00:08:12,640 --> 00:08:13,140\nRight?\n>> Right.\n\n173\n00:08:13,140 --> 00:08:14,098\n>> It wont do it over and over and over.\n\n174\n00:08:14,098 --> 00:08:17,180\nBut you could put as many computers\nin this list as you wanted.\n\n175\n00:08:17,180 --> 00:08:19,610\nAnd if you didn't have that file\nyou could whip one up real quick.\n\n176\n00:08:19,610 --> 00:08:21,420\nYou could use like Notepad.\n\n177\n00:08:21,420 --> 00:08:24,590\nAnd it's just a straight up\nlist of the servers we want,\n\n178\n00:08:24,590 --> 00:08:26,142\njust like Mike had in his example.\n\n179\n00:08:26,142 --> 00:08:27,360\nAll right?\n\n180\n00:08:27,360 --> 00:08:31,600\nBut then I've written a little PowerShell\nscript here called install-telnet.\n\n181\n00:08:31,600 --> 00:08:36,580\nAnd if I pull that up,\nit's pretty simple in what it does.\n\n182\n00:08:36,580 --> 00:08:39,170\nIt creates a variable\ncalled dollar sign hosts.\n\n183\n00:08:39,170 --> 00:08:41,810\nAnd then I use that\nget-content that Mike showed.\n\n184\n00:08:41,810 --> 00:08:42,880\n>> There's that same command.\n\n185\n00:08:42,880 --> 00:08:44,750\nRight?\n>> And it's gonna read whatever that\n\n186\n00:08:44,750 --> 00:08:46,565\nfile is, into that variable.\n\n187\n00:08:46,565 --> 00:08:48,250\n>> Yeah, so\ninstead of dumping it out on the screen,\n\n188\n00:08:48,250 --> 00:08:50,280\nwe're actually gonna store that\ninformation in that variable.\n\n189\n00:08:51,390 --> 00:08:53,190\n>> And then we can call invoke command.\n\n190\n00:08:53,190 --> 00:08:56,600\nInvoke command lets you run commands\nremotely on other systems and\n\n191\n00:08:56,600 --> 00:09:00,394\nI'm gonna say Invoke-Command\n-ComputerName $hosts.\n\n192\n00:09:00,394 --> 00:09:03,780\nRight?\nI'm gonna run a command on each\n\n193\n00:09:03,780 --> 00:09:07,210\nof the hosts listed in that variable\nwhich is coming from that file.\n\n194\n00:09:07,210 --> 00:09:09,000\nAnd then I'm gonna run a script block.\n\n195\n00:09:09,000 --> 00:09:11,321\nAnd in that script block,\nI can put whatever I want.\n\n196\n00:09:11,321 --> 00:09:13,840\n>> Yeah.\n>> As big a script as I need.\n\n197\n00:09:13,840 --> 00:09:17,920\nIn my case, I'm just saying,\nAdd-WindowsFeature Telnet-Client.\n\n198\n00:09:17,920 --> 00:09:18,510\nRight?\nSo,\n\n199\n00:09:18,510 --> 00:09:20,850\nthis is gonna run through for\neach of the hosts in that file.\n\n200\n00:09:22,070 --> 00:09:23,450\nWhen I'm done.\n\n201\n00:09:23,450 --> 00:09:24,465\nI can execute that.\n\n202\n00:09:24,465 --> 00:09:25,009\nRight?\n\n203\n00:09:25,009 --> 00:09:28,010\nNow, I do need to have windows\nremote management enabled on\n\n204\n00:09:28,010 --> 00:09:30,420\nthe other servers to connect\nto them with invoke command.\n\n205\n00:09:30,420 --> 00:09:33,880\nAnd I need to have my script execution\npolicy set here to be able to run scripts\n\n206\n00:09:33,880 --> 00:09:34,990\nin the first place.\n\n207\n00:09:34,990 --> 00:09:38,470\nBut assuming that we've done all that,\nI can run my script.\n\n208\n00:09:38,470 --> 00:09:42,540\nAnd it's gonna execute and it's gonna\nreach out to each server in that list.\n\n209\n00:09:42,540 --> 00:09:43,900\nIt's reading that text file.\n\n210\n00:09:43,900 --> 00:09:47,370\nSo, I'm getting my input\nfrom the file system and\n\n211\n00:09:47,370 --> 00:09:50,390\nthen I'm starting to work with\nthat data and running through.\n\n212\n00:09:50,390 --> 00:09:53,920\nAnd I can see I'm starting my installation\nthat's because it's running right on me.\n\n213\n00:09:53,920 --> 00:09:56,870\nAnd then it's gonna try and\nrun over and over again on myself.\n\n214\n00:09:56,870 --> 00:10:00,100\nCuz remember I did local host,\nI did server01, and\n\n215\n00:10:00,100 --> 00:10:01,710\nI put them in more than once.\n\n216\n00:10:01,710 --> 00:10:05,350\nWell the first time, it actually did have\nto install it, but on the other ones,\n\n217\n00:10:05,350 --> 00:10:07,240\nit was already installed,\nso it just says, success,\n\n218\n00:10:07,240 --> 00:10:09,880\nsuccess, success, it's already done.\n\n219\n00:10:09,880 --> 00:10:13,200\nBut it would run through and\ninstall on each of those different nodes.\n\n220\n00:10:13,200 --> 00:10:14,892\nNow, if I fire up a command prompt.\n\n221\n00:10:16,714 --> 00:10:18,389\nIf it ever comes up, there we go.\n\n222\n00:10:18,389 --> 00:10:20,790\n>> [LAUGH]\n>> I can see I've got Telnet installed.\n\n223\n00:10:20,790 --> 00:10:21,340\nRight?\n\n224\n00:10:21,340 --> 00:10:22,530\nSo.\n>> That's powerful stuff there.\n\n225\n00:10:22,530 --> 00:10:23,450\nI mean really because think about it.\n\n226\n00:10:23,450 --> 00:10:24,940\n>> It really is.\n>> That, you can write all these different\n\n227\n00:10:24,940 --> 00:10:28,690\nscripts if your job was to roll out new\nservers all the time, you've gotta install\n\n228\n00:10:28,690 --> 00:10:32,880\nDNS or DHCP or whatever, get your\nbaseline configuration you wanna do.\n\n229\n00:10:32,880 --> 00:10:35,390\nYou could write this script,\ntake some time, write that script.\n\n230\n00:10:35,390 --> 00:10:38,690\nAnd then every time you roll out another\nten servers you just change your\n\n231\n00:10:38,690 --> 00:10:39,245\ntext file.\n\n232\n00:10:39,245 --> 00:10:40,831\nRight?\nYou're just making a text file with\n\n233\n00:10:40,831 --> 00:10:43,288\nthe name of those computers, and\nyou just pull that file in there.\n\n234\n00:10:43,288 --> 00:10:44,410\n>> Yeah.\n>> Very powerful.\n\n235\n00:10:44,410 --> 00:10:46,854\n>> It can be useful, ever if you're\nonly doing something on one server.\n\n236\n00:10:46,854 --> 00:10:49,570\nRight?\nLet's say I got ten different scripts, and\n\n237\n00:10:49,570 --> 00:10:52,040\nI'm gonna be running them\nall on this one server.\n\n238\n00:10:52,040 --> 00:10:54,950\nBut then I want to take those ten scripts\nand go to another server and run them.\n\n239\n00:10:54,950 --> 00:10:58,630\nWhat if I want to edit all ten scripts\nto reflect the new server name.\n\n240\n00:10:58,630 --> 00:11:02,210\nSo I could have one file called host.txt,\nor whatever you wanna call it, and\n\n241\n00:11:02,210 --> 00:11:04,020\nyou put the computer name there, and\n\n242\n00:11:04,020 --> 00:11:06,850\nall ten of your other scripts\njust read from that one file.\n\n243\n00:11:06,850 --> 00:11:09,680\nSo now when you want to port it from\nsystem to system you can just edit that\n\n244\n00:11:09,680 --> 00:11:12,930\none file and all the other scripts\nfeed from it and they're fine.\n\n245\n00:11:12,930 --> 00:11:15,310\nRight?\nSo, pretty cool stuff and\n\n246\n00:11:15,310 --> 00:11:18,652\ndefinitely something you'll see\nout there in the real world.\n\n247\n00:11:18,652 --> 00:11:21,195\n>> And PowerShell has all the other\ncommands that you used to using from\n\n248\n00:11:21,195 --> 00:11:23,275\nthe command prompt like\ncreating directories and\n\n249\n00:11:23,275 --> 00:11:26,015\nmoving files and copying and\nthings like that.\n\n250\n00:11:26,015 --> 00:11:28,775\nSo we'll throw a link in\nthe show notes for that as well.\n\n251\n00:11:28,775 --> 00:11:29,275\n>> Yeah.\n\n252\n00:11:29,275 --> 00:11:33,665\nWe covered some of that in just the\nregular navigation segments that we filmed\n\n253\n00:11:33,665 --> 00:11:37,602\non PowerShell, but the you don't want\nto loiter on something really easy.\n\n254\n00:11:37,602 --> 00:11:40,300\n>> [LAUGH]\n>> So, but that stuff is out there.\n\n255\n00:11:40,300 --> 00:11:41,700\nAll right.\nSo in this segment,\n\n256\n00:11:41,700 --> 00:11:46,090\nwe got a chance to see how to\ntake data from PowerShell and\n\n257\n00:11:46,090 --> 00:11:48,070\noutput it to a text file.\n\n258\n00:11:48,070 --> 00:11:50,810\nAnd we got a chance to see\nhow to take a text file and\n\n259\n00:11:50,810 --> 00:11:53,900\ninput that into the PowerShell, and some\nof the different ways we can use that.\n\n260\n00:11:53,900 --> 00:11:55,360\nIt's really cool stuff.\n\n261\n00:11:55,360 --> 00:11:56,590\nIt's something that you'll have fun with.\n\n262\n00:11:56,590 --> 00:11:57,240\nAll right.\n\n263\n00:11:57,240 --> 00:11:58,710\nI hope you guys enjoyed the segment.\n\n264\n00:11:58,710 --> 00:11:59,290\nStay tuned.\n\n265\n00:11:59,290 --> 00:12:03,351\nWe've got more PowerShell coming up.\n\n266\n00:12:03,351 --> 00:12:06,769\n[SOUND]\n\n",
          "vimeoId": "116357247"
        },
        {
          "description": "",
          "length": "1349",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-10-configuring_windows_firewall-010515.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-10-configuring_windows_firewall-010515-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-2-10-configuring_windows_firewall-010515-sm.jpg",
          "title": "Configuring Windows Firewall",
          "transcript": "1\n00:00:00,000 --> 00:00:05,234\n[SOUND] In this segment we're gonna take\n\n2\n00:00:05,234 --> 00:00:13,333\na look at managing the Window's\nfirewall from Powershell.\n\n3\n00:00:13,333 --> 00:00:17,542\nNow the windows firewall was introduced\nalong time ago, right back in windows XP.\n\n4\n00:00:17,542 --> 00:00:20,617\nBut the powershell is newer, and so\nMicrosoft has steadily been adding more\n\n5\n00:00:20,617 --> 00:00:22,405\ncommands in there to be\nable to work with it.\n\n6\n00:00:22,405 --> 00:00:26,490\nBut it is a good idea to get used to it,\nit is a great way to automate things.\n\n7\n00:00:26,490 --> 00:00:30,510\nWhen you're deploying software and\nnew servers, you'll often times want to:\n\n8\n00:00:30,510 --> 00:00:35,570\nenable or disable the firewall, depending,\nright, and then create or modify\n\n9\n00:00:35,570 --> 00:00:39,700\nrules within the firewall to be able\nto access the stuff you need to access.\n\n10\n00:00:39,700 --> 00:00:42,640\nSo that's what were going to take\na look at right here in this segment.\n\n11\n00:00:43,940 --> 00:00:47,210\nNow one of the first things that we'll\nwant to do is make sure that the firewall\n\n12\n00:00:47,210 --> 00:00:48,690\nis turned on.\n\n13\n00:00:48,690 --> 00:00:51,870\nDon't assume that it is,\nunless you installed the server,\n\n14\n00:00:51,870 --> 00:00:53,190\nit is installed by default.\n\n15\n00:00:53,190 --> 00:00:54,900\nBut somebody else might\nhave turned it off.\n\n16\n00:00:54,900 --> 00:00:58,295\nSo we can always quickly turn that on or\noff and remember,\n\n17\n00:00:58,295 --> 00:01:01,245\nwith the firewall that we have\nscopes to deal with, right.\n\n18\n00:01:01,245 --> 00:01:02,455\nWhat are the default ones?\n\n19\n00:01:02,455 --> 00:01:03,395\nThere's domain.\n\n20\n00:01:03,395 --> 00:01:06,345\n>> Domain, private and then public.\n\n21\n00:01:06,345 --> 00:01:09,795\n>> So, when somebody plugs into a network\nfor the first time it's gonna detect as\n\n22\n00:01:09,795 --> 00:01:11,815\none of those three,\nit gives them the option to pick.\n\n23\n00:01:11,815 --> 00:01:15,370\nAnd so we have different firewall\nsettings for each of those scopes.\n\n24\n00:01:15,370 --> 00:01:17,950\nSo you can manage them as a whole or\nyou can manage them individually.\n\n25\n00:01:17,950 --> 00:01:21,160\nSo these are all things that kind of\ncomplicate working with the firewall\n\n26\n00:01:21,160 --> 00:01:21,830\nfrom the PowerShell.\n\n27\n00:01:22,980 --> 00:01:24,110\n>> Right.\n>> All right, well one of the commands\n\n28\n00:01:24,110 --> 00:01:27,990\nthat I'm used to, just a quick and\ndirty make sure the firewall is turned on,\n\n29\n00:01:27,990 --> 00:01:30,590\nis a nice little simple one\nthat we'll start with here,\n\n30\n00:01:30,590 --> 00:01:36,052\nwhich is the set-net\nfirewall profile command.\n\n31\n00:01:36,052 --> 00:01:40,660\nSo set, anytime you see set,\nthat means we're changing a setting.\n\n32\n00:01:41,770 --> 00:01:47,310\nAnd everything we need is nested under\nSet-NetFirewall\\Profile, there we go.\n\n33\n00:01:48,760 --> 00:01:52,620\nSometimes Tab autocomplete is faster,\nsometimes it's painful, but basically\n\n34\n00:01:52,620 --> 00:01:56,340\neverything that we need Well, for\nthe most part, is right here under this.\n\n35\n00:01:56,340 --> 00:01:59,030\nAnd like the name implies,\nwe're saying, set net firewall, so\n\n36\n00:01:59,030 --> 00:02:00,170\nwe're working with the firewall.\n\n37\n00:02:00,170 --> 00:02:01,345\n>> Right.\n>> But profile, right?\n\n38\n00:02:01,345 --> 00:02:03,220\n>> Mm-hm.\n>> It expects us to make changes\n\n39\n00:02:03,220 --> 00:02:04,730\nbased on a profile basis.\n\n40\n00:02:04,730 --> 00:02:09,400\nSo is this a change to the domain firewall\npolicy, or the public firewall policy?\n\n41\n00:02:09,400 --> 00:02:10,755\nOr the private home.\n\n42\n00:02:10,755 --> 00:02:12,800\n>> Mm-hm.\n>> Or whatever they call it these days.\n\n43\n00:02:12,800 --> 00:02:16,380\nAll right, for me, I'm gonna say all.\n\n44\n00:02:16,380 --> 00:02:19,360\nI wanna modify all of\nthe scopes in one fell swoop.\n\n45\n00:02:19,360 --> 00:02:25,920\nI want my firewall turned on so\n-all -enabled.\n\n46\n00:02:25,920 --> 00:02:27,610\nWhich I will set to true.\n\n47\n00:02:28,940 --> 00:02:31,950\nThat's gonna make sure that\nmy firewall is turned on for\n\n48\n00:02:31,950 --> 00:02:34,600\nall of the various scopes\nthat are involved.\n\n49\n00:02:36,060 --> 00:02:37,790\nAnd I could follow that up with a get-net.\n\n50\n00:02:37,790 --> 00:02:42,060\nThere's so\nmany commands that start with net.\n\n51\n00:02:42,060 --> 00:02:43,460\nI gotta stop doing that.\n\n52\n00:02:43,460 --> 00:02:47,500\nBut we can go with\na get-net firewall profile.\n\n53\n00:02:47,500 --> 00:02:50,040\nAnd it'll return the various\ninformation there, and\n\n54\n00:02:50,040 --> 00:02:52,350\nyou can see whether they're enabled or\nnot.\n\n55\n00:02:52,350 --> 00:02:55,130\nAnd, you know, here I'll just\nquick format that as a table,\n\n56\n00:02:55,130 --> 00:02:58,085\nbecause right here I can see domain,\nprivate and public,\n\n57\n00:02:58,085 --> 00:03:02,210\njust like Mike said, and enabled\nstatus is now set true on each one.\n\n58\n00:03:02,210 --> 00:03:03,780\n>> Alright.\n>> Alright, so quick and\n\n59\n00:03:03,780 --> 00:03:06,440\neasy way to verify whether our\nfirewall is enabled or not.\n\n60\n00:03:06,440 --> 00:03:10,880\nIf we wanted to turn the firewall off\nmaybe I don't want the firewall for\n\n61\n00:03:10,880 --> 00:03:12,130\nmy domain network.\n\n62\n00:03:12,130 --> 00:03:12,760\nRight?\n\n63\n00:03:12,760 --> 00:03:14,740\nLet domain machines\nconnect however they want.\n\n64\n00:03:14,740 --> 00:03:17,090\nI'm not saying that's a great idea.\n\n65\n00:03:17,090 --> 00:03:17,850\n>> Right.\n>> I'm just saying-\n\n66\n00:03:17,850 --> 00:03:18,800\n>> I'm going to go ahead and\n\n67\n00:03:18,800 --> 00:03:19,710\ntry that at home.\n\n68\n00:03:19,710 --> 00:03:21,950\n>> But\nDon said just turn the firewall off.\n\n69\n00:03:21,950 --> 00:03:24,130\n>> We don't need it.\n\n70\n00:03:24,130 --> 00:03:26,270\n>> I love it when I read-\n>> How to's and\n\n71\n00:03:26,270 --> 00:03:29,210\nsuggestions on the internet and people are\nlike, oh, you want to get that working?\n\n72\n00:03:29,210 --> 00:03:30,020\nSure.\nStep one.\n\n73\n00:03:30,020 --> 00:03:30,581\nTurn off your firewall.\n\n74\n00:03:30,581 --> 00:03:31,880\n>> [LAUGH]\n>> I was like, well, all right.\n\n75\n00:03:31,880 --> 00:03:33,180\nThat's kind of pointless.\n\n76\n00:03:33,180 --> 00:03:34,220\n>> Skip from that one.\n\n77\n00:03:34,220 --> 00:03:35,970\n>> Stop reading right there.\n\n78\n00:03:35,970 --> 00:03:37,710\nBut what we could have\ndone is come through and\n\n79\n00:03:37,710 --> 00:03:42,545\ninstead of like -all, we could have\nspecified a particular profile, right?\n\n80\n00:03:42,545 --> 00:03:43,060\n>> Mm-hm.\n\n81\n00:03:43,060 --> 00:03:46,740\n>> So if I want my domain profile\nnot to have the firewall,\n\n82\n00:03:46,740 --> 00:03:48,820\nI could go and\ndisable that just for that one.\n\n83\n00:03:48,820 --> 00:03:53,710\nAnd what you would do is instead of -all,\nyou would say -name followed by the name,\n\n84\n00:03:53,710 --> 00:03:54,449\nso I'll say domain.\n\n85\n00:03:55,590 --> 00:04:00,530\nAnd instead of -enable true I'll\nchange that to -enable false.\n\n86\n00:04:00,530 --> 00:04:04,746\nSo the full command reads,\nset -netfirewallprofile\n\n87\n00:04:04,746 --> 00:04:07,960\n-name domain -enable False.\n\n88\n00:04:09,330 --> 00:04:12,540\nAnd, I put false in quote marks, I don't\nthink you have to cuz it's a single word,\n\n89\n00:04:12,540 --> 00:04:14,330\nbut I'll do it anyway.\n\n90\n00:04:14,330 --> 00:04:19,090\nSo, there it's set, and now when I\nrun my get dash net firewall profile,\n\n91\n00:04:19,090 --> 00:04:23,140\nI can look and I can see that the firewall\nis turned off from my domain network.\n\n92\n00:04:23,140 --> 00:04:24,900\nBut turned on for private and public.\n\n93\n00:04:26,550 --> 00:04:30,780\nNow on a server, your server is normally\nonly plugged into one network and\n\n94\n00:04:30,780 --> 00:04:31,560\nit's not moving.\n\n95\n00:04:31,560 --> 00:04:36,240\nIt's just there and that's the end of it\nbut on a laptop this may be different.\n\n96\n00:04:36,240 --> 00:04:41,210\nSo, at home you might be on your private\nnetwork and then you get to work and\n\n97\n00:04:41,210 --> 00:04:42,280\nyour on your domain network.\n\n98\n00:04:42,280 --> 00:04:44,180\nThen you go to Starbucks and\nyou're on your public.\n\n99\n00:04:44,180 --> 00:04:46,050\nSo you're moving between these\ndifferent scopes all the time.\n\n100\n00:04:46,050 --> 00:04:50,953\nSo that makes a lot more sense on a mobile\ndevice than like a desktop or server.\n\n101\n00:04:50,953 --> 00:04:54,100\nAlright, now those are real\nhigh level commands.\n\n102\n00:04:54,100 --> 00:04:56,920\nJust modifying whether\nthe firewall is running or not.\n\n103\n00:04:58,450 --> 00:05:02,240\nThe default firewall rules that Microsoft\ncreates are usually suitable for\n\n104\n00:05:02,240 --> 00:05:03,450\nmost end users.\n\n105\n00:05:03,450 --> 00:05:06,680\nBut if you're running a server,\nyou're gonna need to change that.\n\n106\n00:05:06,680 --> 00:05:09,350\nYour server's gonna be running some kind\nof application that you want your end\n\n107\n00:05:09,350 --> 00:05:10,790\nusers to have access to.\n\n108\n00:05:10,790 --> 00:05:14,230\nAnd you'll need to add exceptions to the\nfirewall to allow those people to come in.\n\n109\n00:05:14,230 --> 00:05:16,630\nAnd that's what we want\nto take a look at next.\n\n110\n00:05:16,630 --> 00:05:17,350\n>> Right.\n\n111\n00:05:17,350 --> 00:05:18,630\nAnd the commands can get a little long.\n\n112\n00:05:18,630 --> 00:05:20,580\nThese are really good ones\nto write out a Scripts.\n\n113\n00:05:20,580 --> 00:05:22,590\nSo if you're setting up a DNS server,\n\n114\n00:05:22,590 --> 00:05:26,140\na DHCP server, you can write out\nthese commands, same as a script.\n\n115\n00:05:26,140 --> 00:05:28,710\nAnd every time you ever set up a new\nserver, you just fire up that script, and\n\n116\n00:05:28,710 --> 00:05:32,530\nyou can set up all your firewall rules for\nthat particular service.\n\n117\n00:05:32,530 --> 00:05:35,770\n>> Yeah, if you want to view your firewall\nrules, see what's already in there,\n\n118\n00:05:35,770 --> 00:05:41,070\nyou can do a get dash\nnet firewall rule and\n\n119\n00:05:41,070 --> 00:05:43,220\nwhen you run that command,\nyou'll get all your firewall rules.\n\n120\n00:05:43,220 --> 00:05:45,510\n>> You might want to use\na more switch with that one.\n\n121\n00:05:45,510 --> 00:05:47,960\n>> There's one or\ntwo rules created by default.\n\n122\n00:05:47,960 --> 00:05:50,190\n>> Right.\n[LAUGH]\n\n123\n00:05:50,190 --> 00:05:52,560\n>> And they're not all enabled.\n\n124\n00:05:52,560 --> 00:05:53,500\nThat's the other thing,\n\n125\n00:05:53,500 --> 00:05:57,500\nthat if you look, like this very last\none right here you can see enable false.\n\n126\n00:05:57,500 --> 00:05:58,650\n>> False, yeah.\n\n127\n00:05:58,650 --> 00:06:03,540\n>> Microsoft just created a bunch of rules\nin there that fit a standard use case but\n\n128\n00:06:03,540 --> 00:06:06,080\nthey know that not everybody needs them so\nsome of them are disabled,\n\n129\n00:06:06,080 --> 00:06:09,950\nsome of them are enabled but there are a\nlot of them and that means you'll probably\n\n130\n00:06:09,950 --> 00:06:13,250\nwant to use search modifiers to be\nable to find exactly what you want.\n\n131\n00:06:13,250 --> 00:06:16,500\nOr at a minimum it would have looked\na little better if I would have done\n\n132\n00:06:16,500 --> 00:06:21,410\nformat table but I guess you get less\noutput when you do format table.\n\n133\n00:06:21,410 --> 00:06:24,480\nYou can see all of the different\nones that are in there and\n\n134\n00:06:24,480 --> 00:06:26,750\nthe pieces of their names and stuff.\n\n135\n00:06:26,750 --> 00:06:27,800\nThere's a lot that's in there.\n\n136\n00:06:28,830 --> 00:06:30,230\nI've kind of gotten to\nthe point where there's so\n\n137\n00:06:30,230 --> 00:06:32,640\nmany in there that I don't\neven bother looking anymore.\n\n138\n00:06:32,640 --> 00:06:35,040\nIf I wanna open something on the firewall,\nI just create my own rule.\n\n139\n00:06:35,040 --> 00:06:36,085\n>> Just create your own, exactly.\n\n140\n00:06:36,085 --> 00:06:38,561\n>> And just kind of ignore\nwhat's already in there.\n\n141\n00:06:38,561 --> 00:06:41,840\nWhat did I do to gen- Oh I\naccidentally pasted my clipboard text.\n\n142\n00:06:41,840 --> 00:06:46,310\nSo anyhow, so if we want to go in and\ncreate our own rule, it's easy enough.\n\n143\n00:06:46,310 --> 00:06:47,970\n>> But there is something\nwe need to keep in mind.\n\n144\n00:06:47,970 --> 00:06:51,890\nWhen you create a firewall rule, you're\ncreating an exception to the firewall.\n\n145\n00:06:51,890 --> 00:06:56,730\nAnd that exception is usually going\nto be based one of two things.\n\n146\n00:06:56,730 --> 00:07:00,250\nIt's either going to be based\non the program that's running.\n\n147\n00:07:00,250 --> 00:07:04,260\nSo you say this program is allowed\nto communicate however it wants.\n\n148\n00:07:04,260 --> 00:07:06,550\nOr it's based on a particular port number.\n\n149\n00:07:07,760 --> 00:07:12,460\nSo, in the show nodes, I use\nan example of the FileZilla FTP server.\n\n150\n00:07:12,460 --> 00:07:15,950\nSo, I've got FileZilla FTP\nserver installed on my machine.\n\n151\n00:07:15,950 --> 00:07:18,510\nI want people to be able to\nconnect to it on ports 20 and 21,\n\n152\n00:07:18,510 --> 00:07:21,580\nbecause that's what FTP uses.\n\n153\n00:07:21,580 --> 00:07:25,350\nSo, I could create a firewall\nrule that opened ports 20 and 21.\n\n154\n00:07:25,350 --> 00:07:30,410\nOr, I could create\na firewall rule that opened.\n\n155\n00:07:30,410 --> 00:07:33,880\n>> The files of a program and so\nwhatever ports it requests, let it have.\n\n156\n00:07:35,270 --> 00:07:37,330\nNow why would I do one versus the other?\n\n157\n00:07:37,330 --> 00:07:40,140\nWell, if you know exactly\nwhat ports you need,\n\n158\n00:07:40,140 --> 00:07:42,420\nyou're always better off doing ports.\n\n159\n00:07:42,420 --> 00:07:44,680\nSo that's what we're normally gonna use.\n\n160\n00:07:44,680 --> 00:07:47,230\nBut sometimes you don't know\nwhat ports you're going to need.\n\n161\n00:07:47,230 --> 00:07:47,840\n>> Right.\n>> For\n\n162\n00:07:47,840 --> 00:07:52,960\nexample with FTP, we have passive FTP,\nwhere the clients will negotiate out.\n\n163\n00:07:52,960 --> 00:07:53,900\nNegotiate\n>> Negotiate out?\n\n164\n00:07:53,900 --> 00:07:57,140\n>> Will negotiate a random\nport number to use.\n\n165\n00:07:57,140 --> 00:07:58,210\n>> Right.\n>> And they'll jump over to this\n\n166\n00:07:58,210 --> 00:07:58,900\nother port.\n\n167\n00:07:58,900 --> 00:08:00,560\nWell if it's random,\nhow can you predict that?\n\n168\n00:08:00,560 --> 00:08:01,792\n>> You cannot.\n>> You can't.\n\n169\n00:08:01,792 --> 00:08:03,358\nSo in that scenario [CROSSTALK]\n>> Some programs like to\n\n170\n00:08:03,358 --> 00:08:06,458\nopen up extra ports, just to,\nthey'll establish a port on a known port.\n\n171\n00:08:06,458 --> 00:08:08,601\n>> Mm-hm.\nBut then it'll open up additional,\n\n172\n00:08:08,601 --> 00:08:11,606\nthe dynamic range,\nto speed up the progress, or whatever, and\n\n173\n00:08:11,606 --> 00:08:14,125\nyou don't know what ports\nthose are gonna be either.\n\n174\n00:08:14,125 --> 00:08:19,001\nOne big difference too, when you do it by\nport number, you're opening that port for\n\n175\n00:08:19,001 --> 00:08:22,070\nany application,\nthat wants to use that port.\n\n176\n00:08:22,070 --> 00:08:23,190\nIf you do it by application,\n\n177\n00:08:23,190 --> 00:08:27,260\nthen it's only that FileZilla,\nthat's gonna be able to use 20, and 21.\n\n178\n00:08:27,260 --> 00:08:30,460\nAnything else that tries to use it,\nis not gonna be allowed through that, so\n\n179\n00:08:30,460 --> 00:08:34,080\na little bit difference in who's gonna\nbe allowed to use that exception, or\n\n180\n00:08:34,080 --> 00:08:36,270\ntake advantage of that exception,\nin your firewall.\n\n181\n00:08:36,270 --> 00:08:38,140\n>> And you know,\nI didn't put it in the show notes, but\n\n182\n00:08:38,140 --> 00:08:41,060\nI'm glad you mentioned that Mike,\nbecause you can actually combine these.\n\n183\n00:08:41,060 --> 00:08:42,120\nSo you can be very specific.\n\n184\n00:08:42,120 --> 00:08:46,690\nYou can say these ports for this program,\nand now you've really dialed it in.\n\n185\n00:08:46,690 --> 00:08:49,520\nBut for most of us, it's basically,\ngoing to be based on port numbers, and\n\n186\n00:08:49,520 --> 00:08:50,350\nprograms there.\n\n187\n00:08:50,350 --> 00:08:52,600\nThe thing to remember\nabout the port numbers is,\n\n188\n00:08:52,600 --> 00:08:57,730\nif this is a server, only one program\ncan be bound to a port, at a given time.\n\n189\n00:08:57,730 --> 00:08:59,050\nSo if one program already has it, and\n\n190\n00:08:59,050 --> 00:09:01,060\nanother program launches it,\nit won't be able to grab that port.\n\n191\n00:09:01,060 --> 00:09:02,390\nSo you're kind of safe.\n\n192\n00:09:02,390 --> 00:09:04,040\nBut it's not like that on a desktop.\n\n193\n00:09:04,040 --> 00:09:04,760\n>> Right.\n>> On a desktop,\n\n194\n00:09:04,760 --> 00:09:06,230\nyou probably don't run\nthe programs all the time.\n\n195\n00:09:06,230 --> 00:09:08,080\nYou launch different ones,\nat different times, and\n\n196\n00:09:08,080 --> 00:09:10,920\nthat's where you start to get into that\nsecurity weakness, like Mike mentioned.\n\n197\n00:09:10,920 --> 00:09:13,460\n>> Right.\n>> And it's better to combine the ports,\n\n198\n00:09:13,460 --> 00:09:14,390\nand the program into one.\n\n199\n00:09:14,390 --> 00:09:15,680\n>> Yeah, exactly.\n\n200\n00:09:15,680 --> 00:09:16,849\n>> All right.\nWell let's take a look at this,\n\n201\n00:09:16,849 --> 00:09:17,720\nlet's start with port numbers.\n\n202\n00:09:17,720 --> 00:09:19,400\n>> Yeah.\nHow do we do this in PowerShell?\n\n203\n00:09:19,400 --> 00:09:21,095\nWhat do we do?\n>> We use magic.\n\n204\n00:09:21,095 --> 00:09:23,625\n[LAUGH] It's Microsoft magic.\n\n205\n00:09:23,625 --> 00:09:25,510\n>> [LAUGH]\n>> So we're gonna use the,\n\n206\n00:09:25,510 --> 00:09:28,158\nNew-NetFirewallRule, command.\n\n207\n00:09:28,158 --> 00:09:29,240\nAll right.\n\n208\n00:09:29,240 --> 00:09:32,170\nSo that's gonna be adding\na new rule to our system.\n\n209\n00:09:32,170 --> 00:09:34,740\nAnd I'm gonna give it a name,\nthat I can recognize.\n\n210\n00:09:34,740 --> 00:09:37,210\nSo I'll say DisplayName,\nand I'll give it a name.\n\n211\n00:09:37,210 --> 00:09:39,520\nNow, I'm gonna do this on ports.\n\n212\n00:09:39,520 --> 00:09:42,036\nAnd I want this to be,\nwe'll run with that FileZilla example.\n\n213\n00:09:42,036 --> 00:09:43,780\nRight.\nSo since I'm just doing ports,\n\n214\n00:09:43,780 --> 00:09:46,530\nI'm gonna give it a real generic name,\nlike FTP Traffic.\n\n215\n00:09:46,530 --> 00:09:48,255\nRight?\nBecause like Mike said,\n\n216\n00:09:48,255 --> 00:09:51,409\nthis could apply to any program running,\nnot just FileZilla.\n\n217\n00:09:51,409 --> 00:09:54,330\nSo I'm just giving it a name,\nthat I can recognize, and\n\n218\n00:09:54,330 --> 00:09:56,270\nthen I need to tell it the direction.\n\n219\n00:09:56,270 --> 00:09:57,130\nAll right.\n\n220\n00:09:57,130 --> 00:10:01,640\nBy default,\nall outbound traffic is allowed.\n\n221\n00:10:01,640 --> 00:10:06,590\nAnd all inbound traffic is blocked, except\nfor what there's a rule for, accepting it.\n\n222\n00:10:06,590 --> 00:10:10,310\nSo I'm creating an exception,\nwhich needs to be an inbound.\n\n223\n00:10:10,310 --> 00:10:12,010\nRight?\nThese are inbound connections to my\n\n224\n00:10:12,010 --> 00:10:12,510\nserver.\n\n225\n00:10:12,510 --> 00:10:17,870\nSo I'll say, -direction inbound, and\nthen, I need to specify the port.\n\n226\n00:10:17,870 --> 00:10:22,600\nNow, you can specify the local port,\nor the remote port.\n\n227\n00:10:22,600 --> 00:10:24,620\nThe remote port is the source, and\n\n228\n00:10:24,620 --> 00:10:27,290\nthe local port, is the destination,\nfor inbound traffic.\n\n229\n00:10:27,290 --> 00:10:28,317\nFor outbound, it's the opposite.\n\n230\n00:10:28,317 --> 00:10:28,940\nRight?\nBut for\n\n231\n00:10:28,940 --> 00:10:31,410\ninbound traffic,\nif I'm running an FTP server,\n\n232\n00:10:31,410 --> 00:10:34,230\nthe client could use whatever\nsource port they wanted.\n\n233\n00:10:34,230 --> 00:10:36,980\nThe destination is gonna be 20, or 21.\n\n234\n00:10:36,980 --> 00:10:41,160\nSo I'll say, -LocalPort,\nand then the port numbers.\n\n235\n00:10:41,160 --> 00:10:41,800\nRight?\n\n236\n00:10:41,800 --> 00:10:45,460\nNow if it was just a single port,\nI could write, that port.\n\n237\n00:10:45,460 --> 00:10:46,050\nRight? 21. >> Right.\n\n238\n00:10:46,050 --> 00:10:46,990\n>> Port 21.\n\n239\n00:10:46,990 --> 00:10:49,561\nIf it's more than one port right,\n\n240\n00:10:49,561 --> 00:10:54,890\nlike let's say this was a web server,\nI might need to do 80,443.\n\n241\n00:10:54,890 --> 00:10:56,476\nRight?\nSo now, it's doing both, for\n\n242\n00:10:56,476 --> 00:10:57,260\nHTTP, and HTTPS.\n\n243\n00:10:58,540 --> 00:11:02,020\nOr if it's a range of ports,\nlike FTP is 20, and 21,\n\n244\n00:11:02,020 --> 00:11:05,520\nthey're right next to each other,\nI could say 20 through 21.\n\n245\n00:11:05,520 --> 00:11:08,952\nSo you can specify several different ways,\nwhat ports you wanna open.\n\n246\n00:11:08,952 --> 00:11:12,870\nAll right.\n\n247\n00:11:12,870 --> 00:11:16,670\nIf I stop right there, well, I haven't\nspecified an action, so I'll get an error.\n\n248\n00:11:16,670 --> 00:11:18,110\n>> Right.\n>> But if I were to stop right here,\n\n249\n00:11:18,110 --> 00:11:22,920\nas far as the ports,\nit would open up TCP, and UDP.\n\n250\n00:11:22,920 --> 00:11:26,020\n>> Well, I just wanna do TCP,\nfor this particular one.\n\n251\n00:11:26,020 --> 00:11:32,960\nAnd so, I'm gonna say, -Protocol TCP,\nso it knows it's just TCP traffic.\n\n252\n00:11:32,960 --> 00:11:36,535\nNow, FTP can use UDP's, so\nthat might cause some problems.\n\n253\n00:11:36,535 --> 00:11:37,985\nI'll have to go, and update that.\n\n254\n00:11:37,985 --> 00:11:39,435\nBut if I left that off,\nit would actually do both.\n\n255\n00:11:40,795 --> 00:11:45,785\nAnd then lastly, probably the most\nimportant part, is I specify, -Action, and\n\n256\n00:11:45,785 --> 00:11:46,525\nwhat I want it to do.\n\n257\n00:11:46,525 --> 00:11:48,192\nDo I wanna allow this, or deny it?\n\n258\n00:11:48,192 --> 00:11:49,952\nRight?\nThere's actually a third option.\n\n259\n00:11:49,952 --> 00:11:51,922\nIs the third one secure?\n\n260\n00:11:51,922 --> 00:11:52,422\n>> What's that?\n\n261\n00:11:52,422 --> 00:11:53,452\nSorry.\n\n262\n00:11:53,452 --> 00:11:55,662\n>> You got allow, deny,\nand secure, I believe.\n\n263\n00:11:55,662 --> 00:11:57,082\n>> Yes, if you want to encrypt it, yep.\n\n264\n00:11:57,082 --> 00:12:00,612\n>> So allow and deny, that's pretty self\nexplanatory, we allow the traffic through,\n\n265\n00:12:00,612 --> 00:12:03,740\nor we deny it, but that secure one,\nis if you're doing IP SAC.\n\n266\n00:12:03,740 --> 00:12:05,500\nAnd we're not really tackling that here,\nin this segment,\n\n267\n00:12:05,500 --> 00:12:07,770\nbut that means we wanna\nencrypt the traffic.\n\n268\n00:12:07,770 --> 00:12:09,640\nSo in my case though, I'm gonna say allow.\n\n269\n00:12:09,640 --> 00:12:11,550\nI wanna allow this traffic through.\n\n270\n00:12:11,550 --> 00:12:13,530\nSo that's gonna create that firewall rule.\n\n271\n00:12:13,530 --> 00:12:14,610\n>> There it is.\n\n272\n00:12:14,610 --> 00:12:16,710\nNow I've got a rule called FTP Traffic.\n\n273\n00:12:16,710 --> 00:12:21,040\nIt's enabled, it's attached to any\nprofile, I didn't specify a profile.\n\n274\n00:12:21,040 --> 00:12:22,750\n>> You didn't specify which one.\n\n275\n00:12:22,750 --> 00:12:25,771\n>> And then it's inbound,\nit's allowed, it's up and running, and\n\n276\n00:12:25,771 --> 00:12:26,730\nwe're in business.\n\n277\n00:12:26,730 --> 00:12:29,454\nAnd I actually don't see the port\nnumbers in here, but that's fine,\n\n278\n00:12:29,454 --> 00:12:32,680\nyou'd have to pull the detailed\ninformation to get that.\n\n279\n00:12:32,680 --> 00:12:34,340\nAll right.\nSo my rule's in place, and\n\n280\n00:12:34,340 --> 00:12:34,940\nI'm in business.\n\n281\n00:12:36,150 --> 00:12:39,640\nNow I can run any FTP server that I want,\nand\n\n282\n00:12:39,640 --> 00:12:42,190\nclients will be able to connect on 20,\nand 21.\n\n283\n00:12:42,190 --> 00:12:44,930\nNow when I start to run it,\nI'm gonna bump into problems.\n\n284\n00:12:44,930 --> 00:12:48,750\nProblems like, what about UDP,\nright, because FTP uses that.\n\n285\n00:12:48,750 --> 00:12:51,680\nOr what about those random port numbers,\nfor passive connections,\n\n286\n00:12:51,680 --> 00:12:52,840\nthey're gonna fail too.\n\n287\n00:12:52,840 --> 00:12:55,664\nSo I might be pulling my hair out,\ntrying to get my FTP server to work,\n\n288\n00:12:55,664 --> 00:12:58,510\nbut at a minimum, 4, 20, and\n21, are now accepting traffic.\n\n289\n00:12:58,510 --> 00:12:59,129\n>> Right.\n\n290\n00:12:59,129 --> 00:13:00,218\n>> All right.\n\n291\n00:13:00,218 --> 00:13:02,679\nLet me just pull that full\ncommand back up again.\n\n292\n00:13:02,679 --> 00:13:06,110\nSo I started by specifying\nthe display name of the rule,\n\n293\n00:13:06,110 --> 00:13:11,300\nthe direction of the traffic, the port\nnumbers of the traffic, the protocol used.\n\n294\n00:13:11,300 --> 00:13:17,730\nAnd that's the layer four protocol,\nnot the actual session protocol,\n\n295\n00:13:17,730 --> 00:13:19,690\nand then whether we allow it, or deny it.\n\n296\n00:13:19,690 --> 00:13:20,222\nWhat that action is.\n\n297\n00:13:20,222 --> 00:13:22,390\nAll right.\nThose are all the pieces, of that command.\n\n298\n00:13:23,940 --> 00:13:26,970\nIf I wanted to do this based on a program,\nthough, it's a good bit different.\n\n299\n00:13:28,400 --> 00:13:30,010\nAll right.\nWith a program,\n\n300\n00:13:30,010 --> 00:13:32,910\nI would need to come back here,\nand adjust things a little bit.\n\n301\n00:13:32,910 --> 00:13:36,209\nActually, you know what here,\nI can edit that line.\n\n302\n00:13:36,209 --> 00:13:41,006\nSo whereas, I did New-NetFirewallRule\nDisplay name FTP Traffic,\n\n303\n00:13:41,006 --> 00:13:43,330\nnow I wanna get really specific.\n\n304\n00:13:43,330 --> 00:13:43,950\nOkay.\n\n305\n00:13:43,950 --> 00:13:48,826\nI'm gonna make this new one, my FileZilla\ntraffic, and I'm gonna get rid of\n\n306\n00:13:48,826 --> 00:13:53,790\nthe FTP part too, because I'm really\njust saying any traffic for FileZilla.\n\n307\n00:13:53,790 --> 00:13:56,530\nWhatever FileZilla requests,\nwe're gonna give it to them.\n\n308\n00:13:56,530 --> 00:13:57,640\nAll right.\n\n309\n00:13:57,640 --> 00:13:59,730\nSo that's just the display name there,\nthough.\n\n310\n00:13:59,730 --> 00:14:01,750\nIt doesn't actually change anything.\n\n311\n00:14:01,750 --> 00:14:04,580\nBut my direction, is still inbound, and\n\n312\n00:14:04,580 --> 00:14:07,370\nmy port numbers,\nthis is where things start to change.\n\n313\n00:14:07,370 --> 00:14:08,248\nAll right.\n\n314\n00:14:08,248 --> 00:14:09,990\nI don't wanna be specific\nabout port numbers,\n\n315\n00:14:09,990 --> 00:14:11,663\ncuz I don't know what ports,\nit's gonna use.\n\n316\n00:14:11,663 --> 00:14:13,460\n>> You might wanna use\nsome different port.\n\n317\n00:14:13,460 --> 00:14:14,730\nSo I've gotta be ready to handle that.\n\n318\n00:14:14,730 --> 00:14:17,730\nI've gotta be ready to handle, whatever\nit asks for, just allow it through.\n\n319\n00:14:17,730 --> 00:14:21,480\nThis is the equivalent of going into\nthe GUI, and saying allow a program,\n\n320\n00:14:21,480 --> 00:14:22,640\nthrough the firewall.\n\n321\n00:14:22,640 --> 00:14:25,165\nRight?\nYou get that little, easy GUI option,\n\n322\n00:14:25,165 --> 00:14:27,580\nthat's what this is gonna be like.\n\n323\n00:14:27,580 --> 00:14:32,020\nSo what I need to do is,\nin the show notes,\n\n324\n00:14:32,020 --> 00:14:34,870\nI get really specific, as far as like,\nwhat profile you wanna use.\n\n325\n00:14:34,870 --> 00:14:36,330\nI'm not gonna mess with any of that.\n\n326\n00:14:36,330 --> 00:14:38,140\nBut I am gonna add\na little bit more to this.\n\n327\n00:14:38,140 --> 00:14:41,400\nSo, I'm gonna get rid of these ports,\nand protocols, and\n\n328\n00:14:41,400 --> 00:14:43,762\nI guess I'll get rid of the action queues,\njust make life a little more simple on me.\n\n329\n00:14:43,762 --> 00:14:44,590\nAll right.\n\n330\n00:14:44,590 --> 00:14:47,730\nI'll leave that direction as inbound,\nalthough, I could probably leave that off.\n\n331\n00:14:47,730 --> 00:14:53,440\nAnd I'm gonna say, -Program, and\nnow, I need to specify the program.\n\n332\n00:14:53,440 --> 00:14:54,230\nAll right.\n\n333\n00:14:54,230 --> 00:14:59,620\nAnd here, you need to point the full path,\nto the executable that's being run.\n\n334\n00:14:59,620 --> 00:15:01,200\n>> Can't just type in FileZilla.exe.\n\n335\n00:15:01,200 --> 00:15:03,659\nIt has to know where that\nexecutable is stored at.\n\n336\n00:15:03,659 --> 00:15:06,443\n>> Yeah, and be careful on this one,\nbecause often times,\n\n337\n00:15:06,443 --> 00:15:10,329\nthere will be one executable for the GUI,\nthat used the management server, and\n\n338\n00:15:10,329 --> 00:15:12,600\ndifferent executable for\nthe server itself.\n\n339\n00:15:12,600 --> 00:15:16,324\nFileZilla is one like that, that the\nFileZilla icon, that you might see on your\n\n340\n00:15:16,324 --> 00:15:20,120\ncomputer, that's actually just a GUI,\nthat's not what's opening up ports.\n\n341\n00:15:20,120 --> 00:15:24,333\nThere's a server service, that's sitting\nin another location, that is the actual\n\n342\n00:15:24,333 --> 00:15:27,980\nexecutable we need to allow., so\nhere we just specificed that program.\n\n343\n00:15:27,980 --> 00:15:31,727\nSo if I had FileZilla,\nI would say, C:\\program files.\n\n344\n00:15:33,110 --> 00:15:34,842\nThe hardest part here, is the typing.\n\n345\n00:15:34,842 --> 00:15:36,206\n>> [LAUGH]\n>> \\program files, and\n\n346\n00:15:36,206 --> 00:15:37,662\nactually, that ones 32 bit, isn't it?\n\n347\n00:15:37,662 --> 00:15:39,222\n>> It should tab, auto fill for\nyou, on your path.\n\n348\n00:15:39,222 --> 00:15:41,365\nWon't it?\n>> Well, I don't even, actually know,\n\n349\n00:15:41,365 --> 00:15:42,421\nif I have it installed.\n\n350\n00:15:42,421 --> 00:15:43,381\n>> Oh yeah that's true.\n\n351\n00:15:43,381 --> 00:15:45,958\n[LAUGH]\n>> I'm using it as an example,\n\n352\n00:15:45,958 --> 00:15:48,362\nI don't know if I have it,\nmaybe I do, let's see.\n\n353\n00:15:48,362 --> 00:15:51,342\nDo I have, nah see I don't even have,\nso I'll just make it up.\n\n354\n00:15:51,342 --> 00:15:56,462\nSo C:\\prgramfiles\\86\\, and now,\nI need to say where it would be installed.\n\n355\n00:15:56,462 --> 00:16:01,408\nSo it would be,\nlike FileZilla server\\ ,and then\n\n356\n00:16:01,408 --> 00:16:05,441\nit's called, FileZillaserver.exe.\n\n357\n00:16:05,441 --> 00:16:06,375\nThere we go.\n\n358\n00:16:06,375 --> 00:16:09,036\nAll right.\nSo I'm just specifying where that program\n\n359\n00:16:09,036 --> 00:16:11,583\nis\n>> Now when that program runs.\n\n360\n00:16:11,583 --> 00:16:15,598\nWhatever it asks for, the firewall's\ngonna recognize and allow or\n\n361\n00:16:15,598 --> 00:16:17,790\ndeny it based on what I specify next.\n\n362\n00:16:17,790 --> 00:16:18,758\nI guess I need to put that, don't I?\n\n363\n00:16:18,758 --> 00:16:22,480\n-Action Allow.\n\n364\n00:16:22,480 --> 00:16:24,634\n>> Yeah, but you didn't specify\na protocol, so it could be TCP,\n\n365\n00:16:24,634 --> 00:16:28,540\nit could be UDP, and you didn't specify\na specific port number, so it could be any\n\n366\n00:16:28,540 --> 00:16:30,890\nport that that program wants to open up\n>> Yeah,\n\n367\n00:16:30,890 --> 00:16:32,770\nand it really is whatever\nthat program wants.\n\n368\n00:16:32,770 --> 00:16:35,340\nSo that if the program asks for\na port to open, it will.\n\n369\n00:16:35,340 --> 00:16:37,590\nNow, pros and cons with that, right?\n\n370\n00:16:37,590 --> 00:16:40,790\nOn a positive side,\nI know my FTP transfers will work.\n\n371\n00:16:40,790 --> 00:16:42,510\nI know that 20 and 21 will be open,\n\n372\n00:16:42,510 --> 00:16:46,960\nI know that the passive port numbers that\nit picks, those will be open, great.\n\n373\n00:16:46,960 --> 00:16:50,390\nBut FileZilla also has a little\nmanagement interface that it runs, and\n\n374\n00:16:50,390 --> 00:16:53,270\nthat management interface is\ntied to a particular port.\n\n375\n00:16:53,270 --> 00:16:55,200\nA port number you pick\nwhen you install it.\n\n376\n00:16:55,200 --> 00:16:56,560\nThat's gonna be open, too.\n\n377\n00:16:56,560 --> 00:16:58,120\nAnd it's gonna be open to everybody,\nright?\n\n378\n00:16:58,120 --> 00:17:01,410\nCuz I didn't specify like a source\ntraffic here or anything.\n\n379\n00:17:01,410 --> 00:17:04,720\nSo, I'll probably wanna add a second rule\n\n380\n00:17:04,720 --> 00:17:07,200\nthat restricts access to\nthat management port, right?\n\n381\n00:17:07,200 --> 00:17:10,100\nClose that off so\nthat people can't try and attach that, or\n\n382\n00:17:10,100 --> 00:17:11,050\nmaybe I don't care, I don't know.\n\n383\n00:17:11,050 --> 00:17:13,190\nBut you'll probably wanna\nadd another rule for it.\n\n384\n00:17:13,190 --> 00:17:15,990\nBut the point of this example is\nto show attaching that program.\n\n385\n00:17:15,990 --> 00:17:20,530\nAnd if I run that,\nnow I have a rule called FileZilla Traffic\n\n386\n00:17:20,530 --> 00:17:24,988\nthat's tied to that program specifically\nand any ports it requests, will be open.\n\n387\n00:17:24,988 --> 00:17:32,301\nAll right, so that gets it open,\nthat makes that one running.\n\n388\n00:17:32,301 --> 00:17:33,361\nLet's talk about that management port.\n\n389\n00:17:33,361 --> 00:17:37,001\nNow, the management port,\nyou pick that when you do the install.\n\n390\n00:17:37,001 --> 00:17:41,224\nSo I'll just a pick a random port,\nmaybe I'll say one, two,\n\n391\n00:17:41,224 --> 00:17:44,560\nwe'll just do 12345, there we go.\n\n392\n00:17:44,560 --> 00:17:47,978\nSo let's say that's our management\nport number, 12345, right?\n\n393\n00:17:47,978 --> 00:17:52,262\nI wanna create a rule that restricts\nwho is allowed to get to it.\n\n394\n00:17:52,262 --> 00:17:57,270\nI wanna make it where only people on\nmy local network can get to that port.\n\n395\n00:17:57,270 --> 00:17:58,400\nSo if somebody's out on the Internet,\n\n396\n00:17:58,400 --> 00:18:01,510\nI want them to be able to FTP\nto my server, that's cool.\n\n397\n00:18:01,510 --> 00:18:04,210\nBut I don't want to them to try and\nmanage my server.\n\n398\n00:18:04,210 --> 00:18:08,170\nSo for this one, it's a little trickier\nbecause the rules we've created so\n\n399\n00:18:08,170 --> 00:18:10,340\nfar have been based on your destination.\n\n400\n00:18:10,340 --> 00:18:13,900\nNow I need a rule based on the source,\nwho's coming in, and\n\n401\n00:18:13,900 --> 00:18:17,240\nthat's a different kind of firewall rule.\n\n402\n00:18:17,240 --> 00:18:20,120\nAll right, so for this one,\nit's actually not that hard.\n\n403\n00:18:20,120 --> 00:18:22,090\nIt's an easier rule, really.\n\n404\n00:18:22,090 --> 00:18:27,265\nWe can come in and we can say,\nwell, I got a choice.\n\n405\n00:18:27,265 --> 00:18:28,805\nI could do a new rule, right?\n\n406\n00:18:28,805 --> 00:18:32,541\nI could do New-FirewallRule and\ncreate a new rule based on that port, or\n\n407\n00:18:32,541 --> 00:18:34,940\nI could modify the existing\nrule if I wanted.\n\n408\n00:18:34,940 --> 00:18:37,120\nIf I wanted to go back and\nchange it and say,\n\n409\n00:18:37,120 --> 00:18:41,000\nI only want local people to be able to\nFTP into that server or whatever, right?\n\n410\n00:18:41,000 --> 00:18:42,930\nSo you got some flexibility here.\n\n411\n00:18:42,930 --> 00:18:47,312\nIf I wanted to do it that way,\nwhere I just change it so\n\n412\n00:18:47,312 --> 00:18:53,792\nthat only local people can connect,\ninstead of saying New-FirewallRule,\n\n413\n00:18:53,792 --> 00:18:58,076\nwhich is what we've been doing,\nI could come in and\n\n414\n00:18:58,076 --> 00:19:02,983\nsay, Set-NetFirewallRule,\nor something or another.\n\n415\n00:19:02,983 --> 00:19:04,070\nThere we go.\n\n416\n00:19:04,070 --> 00:19:09,220\nAnd just remember that New creates a new\none, Set modifies an existing one.\n\n417\n00:19:09,220 --> 00:19:11,910\nAnd so I can then go in and\nmodify whatever that rule was,\n\n418\n00:19:11,910 --> 00:19:13,610\nusually based on display name, right?\n\n419\n00:19:13,610 --> 00:19:21,650\nSo I would say display name\nis FileZilla Traffic, okay?\n\n420\n00:19:21,650 --> 00:19:24,050\nAnd so, now I'm modifying that rule and\n\n421\n00:19:24,050 --> 00:19:25,844\nI just specify whatever\nelse it is I wanna do.\n\n422\n00:19:25,844 --> 00:19:29,723\nI'm gonna add remote address,\nso -RemoteAddress, and\n\n423\n00:19:29,723 --> 00:19:34,010\nspecify who it is I want and\nyou can do a whole range of addresses.\n\n424\n00:19:35,881 --> 00:19:38,140\n>> Yeah, notice he's not using\nall the other commands either.\n\n425\n00:19:38,140 --> 00:19:42,700\nSo, because the rule already exists, he\ndoesn't have to specify the protocols and\n\n426\n00:19:42,700 --> 00:19:43,600\nthings like that.\n\n427\n00:19:43,600 --> 00:19:47,730\nHe's just adding or modifying that\nexisting rule or adding a new parameter\n\n428\n00:19:47,730 --> 00:19:50,620\nto an existing rule, so\nit's just specifying that remote address.\n\n429\n00:19:51,680 --> 00:19:56,690\n>> So when I run that,\nnow the FileZilla rule, anybody or\n\n430\n00:19:56,690 --> 00:20:00,520\nany port that FileZilla server requests,\nwill be opened.\n\n431\n00:20:00,520 --> 00:20:04,420\nBut, only if the client's\naddress is in this range.\n\n432\n00:20:04,420 --> 00:20:09,220\n192.168.29.1 through 254,\nwill they be allowed to connect.\n\n433\n00:20:09,220 --> 00:20:14,169\nI've added restrictions to that rule,\nand that's pretty easy to do, all right?\n\n434\n00:20:14,169 --> 00:20:17,310\nI might want to do that, if I just\nwanna do it from the management port,\n\n435\n00:20:17,310 --> 00:20:20,570\nI would've needed to create\na new net firewall rule, right?\n\n436\n00:20:20,570 --> 00:20:22,410\nBut if I wanted to\nrestrict all the traffic,\n\n437\n00:20:22,410 --> 00:20:24,000\nthen it's really easy to do it right here.\n\n438\n00:20:24,000 --> 00:20:26,720\nYou can verify all this\nin the GUI if you want.\n\n439\n00:20:26,720 --> 00:20:31,610\nIt's a little bit easier sometimes\nin the GUI to see this stuff, but\n\n440\n00:20:31,610 --> 00:20:34,210\nif you're on a core server install,\nyou don't necessarily have that, so\n\n441\n00:20:34,210 --> 00:20:36,110\nthat's why it's important\nto know both ways.\n\n442\n00:20:36,110 --> 00:20:40,924\nBut if we come in here, here's my\nFileZilla traffic rule that we just made,\n\n443\n00:20:40,924 --> 00:20:43,707\nand if I pull it up,\nI can look at programs and\n\n444\n00:20:43,707 --> 00:20:45,840\nthere it's tied to the program.\n\n445\n00:20:45,840 --> 00:20:51,151\nRemote Computers and oh wait,\nit's not there, is it?\n\n446\n00:20:51,151 --> 00:20:52,491\n>> Just go up there to the bottom of that.\n\n447\n00:20:52,491 --> 00:20:53,351\n>> There we go, yep.\n\n448\n00:20:53,351 --> 00:20:57,146\nIt gets confusing cuz under Remote\nComputers, you expect to see it there, but\n\n449\n00:20:57,146 --> 00:21:01,302\nthat's really when we're talking about\nthe encrypted connections, right?\n\n450\n00:21:01,302 --> 00:21:04,052\nBut if we go back to scope,\nhere's where we can see the remote IP\n\n451\n00:21:04,052 --> 00:21:06,352\naddress right there is\nwhere it's specified.\n\n452\n00:21:06,352 --> 00:21:09,950\nSo there's that range, these are the\npeople that are allowed to connect, and\n\n453\n00:21:09,950 --> 00:21:11,653\nthen the program that was tied to it.\n\n454\n00:21:11,653 --> 00:21:16,383\nVersus the other rule we made,\nif I pull it up and I go to its scope,\n\n455\n00:21:16,383 --> 00:21:21,028\nthey're just set to Any Any, and\nif I go to Protocols and Ports,\n\n456\n00:21:21,028 --> 00:21:24,742\nhere's where it's locked\ninto that 20 to 21.\n\n457\n00:21:24,742 --> 00:21:28,375\nAll right so, all said and done,\nworking with the firewall rules,\n\n458\n00:21:28,375 --> 00:21:30,050\nreally not that hard, right?\n\n459\n00:21:30,050 --> 00:21:35,488\nThe commands that we used were\nmostly Get-NetFirewallProfile or\n\n460\n00:21:35,488 --> 00:21:39,660\nGet-NetFirewallRule, and\nthen the alternatives of new and\n\n461\n00:21:39,660 --> 00:21:41,820\nset that we used in addition to those.\n\n462\n00:21:41,820 --> 00:21:43,597\nAnd then you've got remove also,\n\n463\n00:21:43,597 --> 00:21:47,030\nif you wanna remove the firewall\nrules to get them out of there, and\n\n464\n00:21:47,030 --> 00:21:50,111\nyou can always modify them as\nfar as -Enable true or false.\n\n465\n00:21:50,111 --> 00:21:54,771\nYou might wanna temporarily turn a rule\noff and then turn it back on again,\n\n466\n00:21:54,771 --> 00:21:57,411\nand you can do that, too using -Enable.\n\n467\n00:21:57,411 --> 00:21:57,911\n>> Good.\n\n468\n00:21:59,010 --> 00:22:03,580\n>> All right, so in this segment,\nwe got a chance to see how to enable and\n\n469\n00:22:03,580 --> 00:22:07,930\ndisable our firewall, how to create\nnew rules and modify the rules.\n\n470\n00:22:07,930 --> 00:22:11,415\nWe saw how to create rules based\non a program verses a port, and\n\n471\n00:22:11,415 --> 00:22:12,756\nthose are the typical,\n\n472\n00:22:12,756 --> 00:22:17,331\nday to day objectives that we have when\nworking with firewall rules and Windows.\n\n473\n00:22:17,331 --> 00:22:19,340\nAll right,\nwell I hope you guys enjoyed this segment.\n\n474\n00:22:19,340 --> 00:22:23,440\nStay tuned,\nwe've got more PowerShell coming up.\n\n475\n00:22:23,440 --> 00:22:29,200\n[SOUND]\n\n",
          "vimeoId": "116155656"
        }
      ],
      "title": "Server Management"
    },
    {
      "episodes": [
        {
          "description": "",
          "length": "126",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-1-installing_dns-0107015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-1-installing_dns-0107015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-1-installing_dns-0107015-sm.jpg",
          "title": "Installing DNS",
          "transcript": "1\n00:00:00,025 --> 00:00:02,979\n[SOUND] In this segment,\n\n2\n00:00:02,979 --> 00:00:08,592\nwe're gonna take a look\nat installing the DNS\n\n3\n00:00:08,592 --> 00:00:13,329\nrole on a server through PowerShell.\n\n4\n00:00:13,329 --> 00:00:16,607\nOften times, we wanna set up a DNS server\nbut we might be doing this remotely,\n\n5\n00:00:16,607 --> 00:00:19,342\nfrom our workstation setting DNS\nup on a server somewhere else.\n\n6\n00:00:19,342 --> 00:00:23,485\nOr it might be a core install of the\nserver, where we have access to PowerShell\n\n7\n00:00:23,485 --> 00:00:26,436\nand we wanna install DNS,\nbut we don't have the GUIs.\n\n8\n00:00:26,436 --> 00:00:28,201\nThat's what we're going\nto look at right here.\n\n9\n00:00:28,201 --> 00:00:30,026\n>> And\nit's a pretty straight forward command,\n\n10\n00:00:30,026 --> 00:00:31,960\nI think we've done this\nin a few other segments.\n\n11\n00:00:31,960 --> 00:00:36,700\nWe're just gonna use the install\ndash Windows feature commandlet, So\n\n12\n00:00:36,700 --> 00:00:42,358\nInstall-WindowsFeature, And\n\n13\n00:00:42,358 --> 00:00:44,903\nthen the name of the role that I wanna\ninstall in this case is gonna be dns.\n\n14\n00:00:44,903 --> 00:00:48,541\nAnd then the only other thing I have\nto choose or decide is, whether or\n\n15\n00:00:48,541 --> 00:00:50,814\nnot I wanna include the management tools.\n\n16\n00:00:50,814 --> 00:00:55,374\nAnd typically we do, so I'm gonna just\ntype in IncludeManagementTools as one of\n\n17\n00:00:55,374 --> 00:00:56,320\nmy parameters.\n\n18\n00:00:56,320 --> 00:00:59,679\n>> If this were a core server install,\nyou'd wanna install the DNS server,\n\n19\n00:00:59,679 --> 00:01:02,387\nbut there's no point in\ninstalling the management tools,\n\n20\n00:01:02,387 --> 00:01:04,138\nbecause you can't run them, right?\n\n21\n00:01:04,138 --> 00:01:07,950\nThese are the GUI tools and\nsome command line utilities you can't use.\n\n22\n00:01:07,950 --> 00:01:11,580\nThe management tools are what you\ntypically want on your workstation, but\n\n23\n00:01:11,580 --> 00:01:13,860\nif you are gonna be managing\nthis from the server itself,\n\n24\n00:01:13,860 --> 00:01:16,620\nif it is a full server install, you might\nas well install the management tools.\n\n25\n00:01:16,620 --> 00:01:18,520\nBut you do have to provide that option,\nif you leave it off,\n\n26\n00:01:18,520 --> 00:01:19,820\nit doesn't install them by default.\n\n27\n00:01:19,820 --> 00:01:21,688\n>> Exactly.\n\n28\n00:01:21,688 --> 00:01:26,475\nSo we hit that, that's pretty much it, we\ncan watch it run, and it will install DNS.\n\n29\n00:01:26,475 --> 00:01:29,873\n>> Now once it gets installed,\nit's there, it's actually running,\n\n30\n00:01:29,873 --> 00:01:31,220\nit does start the service,\n\n31\n00:01:31,220 --> 00:01:34,695\nwhich I guess we can verify when we\nget that service after this is done.\n\n32\n00:01:34,695 --> 00:01:38,589\nBut it'll install it, it'll start running,\nbut it's not really doing much for\n\n33\n00:01:38,589 --> 00:01:41,648\nus because there's no zone, so\nwe've got some more work to do.\n\n34\n00:01:41,648 --> 00:01:45,093\nBut the basic installation is right there,\nand yeah, Mike just queried it,\n\n35\n00:01:45,093 --> 00:01:48,381\nwe can see the DNS server's up,\nit's running, and we're in business.\n\n36\n00:01:48,381 --> 00:01:51,154\nSo, key thing to remember\nhere is simply whether or\n\n37\n00:01:51,154 --> 00:01:54,130\nnot you choose to include\nthe management tools or not.\n\n38\n00:01:54,130 --> 00:01:56,190\nBut otherwise, installing DNS?\n\n39\n00:01:56,190 --> 00:01:57,082\nSuper easy.\n\n40\n00:01:57,082 --> 00:01:59,605\nAll right, well in this segment\nwe saw installing DNS, I know,\n\n41\n00:01:59,605 --> 00:02:01,262\nnot the most exciting thing in the world.\n\n42\n00:02:01,262 --> 00:02:02,940\n>> [LAUGH]\n>> [LAUGH] But stay tuned,\n\n43\n00:02:02,940 --> 00:02:06,121\nbecause in our following segments we're\ngonna show how we configure DNS to\n\n44\n00:02:06,121 --> 00:02:08,762\nactually get it to be useful,\nto get it to be doing something.\n\n45\n00:02:08,762 --> 00:02:13,329\nAs it stands right here we've basically\ncreated a DNS caching server, but\n\n46\n00:02:13,329 --> 00:02:15,368\nwe likely want to do more with it.\n\n47\n00:02:15,368 --> 00:02:19,280\nSo be sure to check out our other\nsegments as we start to configure DNS.\n\n48\n00:02:19,280 --> 00:02:26,604\n[SOUND]\n\n",
          "vimeoId": "116357248"
        },
        {
          "description": "",
          "length": "1056",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-2-managing_zones-0107015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-2-managing_zones-0107015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-2-managing_zones-0107015-sm.jpg",
          "title": "Managing Zones",
          "transcript": "1\n00:00:00,000 --> 00:00:08,203\n[MUSIC]\n\n2\n00:00:08,203 --> 00:00:11,396\nIn this segment, we're gonna take\na look at one of the first things we do\n\n3\n00:00:11,396 --> 00:00:12,840\nwhen we set up a new DNS Server.\n\n4\n00:00:12,840 --> 00:00:16,610\nWhich is, configuring and\nmanaging our zones.\n\n5\n00:00:16,610 --> 00:00:19,195\nA DNS server is not terribly useful\nwithout some zones in there.\n\n6\n00:00:19,195 --> 00:00:21,380\nFrom being able to do forward and\nreverse lookups.\n\n7\n00:00:21,380 --> 00:00:24,460\nAnd so, that's what we're\ngoing to look at right here.\n\n8\n00:00:24,460 --> 00:00:26,210\n>> All right.\nSo we're going to start by setting up,\n\n9\n00:00:26,210 --> 00:00:28,920\nas we know from DNS, there's different\ntypes of zones we can create.\n\n10\n00:00:28,920 --> 00:00:31,750\nWe've got our primary, and\nour secondaries, and our stubs.\n\n11\n00:00:31,750 --> 00:00:33,730\nWe can choose to do active\ndirectory integrated.\n\n12\n00:00:33,730 --> 00:00:37,100\nOr we can set it up as a separate\nfile if it's not a domain controller.\n\n13\n00:00:37,100 --> 00:00:39,550\nOr if we choose just not to do\nactive directory integrator.\n\n14\n00:00:39,550 --> 00:00:42,620\nSo the first command I'm going to do is\nI'm just going to add a primary zone.\n\n15\n00:00:42,620 --> 00:00:44,540\nThis server is a domain controller.\n\n16\n00:00:44,540 --> 00:00:46,850\nAnd hes already got a zone for\ncontoso.com.\n\n17\n00:00:46,850 --> 00:00:48,560\nIts Active Directory integrated.\n\n18\n00:00:48,560 --> 00:00:50,610\nAnd Im gonna add a second\nzone to the server.\n\n19\n00:00:50,610 --> 00:00:57,143\nSo the command is gonna be\nadd-dnsserver primary zone.\n\n20\n00:00:57,143 --> 00:00:59,955\nOops, So not enough letters,\ntry that one more time.\n\n21\n00:00:59,955 --> 00:01:02,618\nWe're not going to tab\nthrough all of that.\n\n22\n00:01:02,618 --> 00:01:05,063\nSo, add -dnsserver primary zone.\n\n23\n00:01:05,063 --> 00:01:08,995\nAnd then -name, and the name of\nthe zone that you want to create.\n\n24\n00:01:08,995 --> 00:01:17,120\nIn this case I'm just going to\ncall it west01.contoso.com, oops.\n\n25\n00:01:17,120 --> 00:01:20,060\nAnd after the name, we're going\nto give it the replication scope.\n\n26\n00:01:20,060 --> 00:01:22,540\nBecause this is going to be\nactive directory integrated,\n\n27\n00:01:22,540 --> 00:01:24,940\nif you think back to running\nthrough this through your GUI.\n\n28\n00:01:24,940 --> 00:01:27,575\nYou've got to choose if I'm going\nto replicate this to all domain\n\n29\n00:01:27,575 --> 00:01:29,846\ncontrollers in the domain\nthat are running DNS.\n\n30\n00:01:29,846 --> 00:01:32,861\nAll domain controllers in\nthe force that are running DNS.\n\n31\n00:01:32,861 --> 00:01:35,850\nAnd so the parameter for\nthat is just replication scope.\n\n32\n00:01:35,850 --> 00:01:38,060\nAnd I'm going to do forest for that one.\n\n33\n00:01:38,060 --> 00:01:42,721\nAnd then I can add a little -passthrough\nif we want to see a little bit of\n\n34\n00:01:42,721 --> 00:01:45,095\noutput for that, I'll hit enter.\n\n35\n00:01:48,495 --> 00:01:52,380\nAnd there I can see I have now\ncreated a zone, west01.contoso.com.\n\n36\n00:01:52,380 --> 00:01:55,190\nIt is a primary for the zone type.\n\n37\n00:01:55,190 --> 00:01:59,650\nIsDSIntegrated is listed as true,\nall right.\n\n38\n00:01:59,650 --> 00:02:04,125\nAnd if we take a look at my DNS console,\nand I refresh my Forward Lookup Zones.\n\n39\n00:02:06,536 --> 00:02:09,370\nI now have a zone for west01.contoso.com.\n\n40\n00:02:09,370 --> 00:02:11,460\nAnd when I look at Forward Lookup Zones,\n\n41\n00:02:11,460 --> 00:02:14,260\nI can see that it is\nActive Directory Integrated.\n\n42\n00:02:14,260 --> 00:02:14,850\nAll right.\n\n43\n00:02:14,850 --> 00:02:17,350\nSo that's one type of\nzone that we can create.\n\n44\n00:02:17,350 --> 00:02:19,610\n>> And for most people, active\ndirectory integrated is what you want.\n\n45\n00:02:19,610 --> 00:02:22,340\nBut one of the things Mike said at\nthe beginning of the segment was, hey,\n\n46\n00:02:22,340 --> 00:02:24,730\nthis guy is an active\ndirectory domain controller.\n\n47\n00:02:24,730 --> 00:02:27,190\nIf you're going to be\nrunning your DNS server\n\n48\n00:02:27,190 --> 00:02:29,480\nnot on an active directory\ndomain controller.\n\n49\n00:02:29,480 --> 00:02:31,750\nWell, you don't really\nhave that option anymore.\n\n50\n00:02:31,750 --> 00:02:36,690\nSo you need to go old school, and create\nwhat's called the standard primary zone.\n\n51\n00:02:36,690 --> 00:02:39,710\nOne that's not stored in the active\ndirectory, but instead stored in a file.\n\n52\n00:02:40,750 --> 00:02:43,100\n>> You know what,\nI don't think this guy is running DNS.\n\n53\n00:02:43,100 --> 00:02:46,135\nSo let's install -windowsfeature.\n\n54\n00:02:46,135 --> 00:02:47,790\n>> [LAUGH]\n>> I forgot about that.\n\n55\n00:02:47,790 --> 00:02:50,655\n>> It is hard to add a zone to\na server not actually running DNS.\n\n56\n00:02:50,655 --> 00:02:53,180\n>> [LAUGH]\n>> All right, so\n\n57\n00:02:53,180 --> 00:02:54,390\nwe're get that running real quick.\n\n58\n00:02:55,580 --> 00:02:56,680\nSuccess was true.\n\n59\n00:02:56,680 --> 00:02:57,660\nBoy that was awfully fast.\n\n60\n00:02:57,660 --> 00:02:59,410\nMaybe I\n>> It must already be running.\n\n61\n00:02:59,410 --> 00:03:00,240\n>> Good.\n\n62\n00:03:00,240 --> 00:03:02,700\nAll right so on this guy,\nthis is not a domain controller.\n\n63\n00:03:02,700 --> 00:03:06,280\nIt's a member server that\nI've installed DNS on.\n\n64\n00:03:06,280 --> 00:03:08,130\nSo we're gonna create\nanother primary zone.\n\n65\n00:03:08,130 --> 00:03:09,880\nThis time I'm gonna do a file based zone.\n\n66\n00:03:09,880 --> 00:03:12,930\nSo this might be something you\nmight run out your DMZ, or\n\n67\n00:03:12,930 --> 00:03:14,820\nsomewhere you need a DNS server.\n\n68\n00:03:14,820 --> 00:03:18,310\nBut you don't wanna put it, or\ndon't have a domain controller.\n\n69\n00:03:18,310 --> 00:03:19,790\nSo the command is gonna be very similar.\n\n70\n00:03:19,790 --> 00:03:26,715\nIt's gonna be add -dnsserver primary zone.\n\n71\n00:03:26,715 --> 00:03:27,410\nSo DNS server primary zone.\n\n72\n00:03:27,410 --> 00:03:29,810\nAnd I've gotta give it a name.\n\n73\n00:03:29,810 --> 00:03:32,824\nSo the name is going to be,\n\n74\n00:03:32,824 --> 00:03:37,758\nlets call this west2.contoso.com.\n\n75\n00:03:40,138 --> 00:03:42,530\nAll right, and what else do I need?\n\n76\n00:03:42,530 --> 00:03:46,830\nAnd for this one, since it's not going\nto be active directory integrated.\n\n77\n00:03:46,830 --> 00:03:49,720\nI've got to give it a name for\nthe file that it's going to create.\n\n78\n00:03:49,720 --> 00:03:52,240\nWhere it's going to store\nthose resource records.\n\n79\n00:03:52,240 --> 00:03:52,980\nAnd again,\n\n80\n00:03:52,980 --> 00:03:56,580\nif you think back to the GUI interface\nyou've gone through that wizard before.\n\n81\n00:03:56,580 --> 00:04:01,865\nSame options there, so\nwe'll say west2.contoso.com.\n\n82\n00:04:01,865 --> 00:04:03,605\n>> You going to do a looks like -zonefile.\n\n83\n00:04:03,605 --> 00:04:07,425\n>> Oops, I forgot my parameter there.\n\n84\n00:04:07,425 --> 00:04:11,014\nSo let's do that, zonefile.\n\n85\n00:04:11,014 --> 00:04:11,770\nThere we go.\n\n86\n00:04:13,290 --> 00:04:13,820\nAnd we hit enter.\n\n87\n00:04:14,830 --> 00:04:17,015\nAnd have it take a look at my DNS console.\n\n88\n00:04:24,506 --> 00:04:26,039\nLet me expand down my\nforward look up zones.\n\n89\n00:04:28,470 --> 00:04:31,310\n>> There you go.\n>> And there's my west2.contoso.com.\n\n90\n00:04:31,310 --> 00:04:34,930\nSo there we created an active directory\nintegrated zone on a domain controller.\n\n91\n00:04:34,930 --> 00:04:38,610\nAnd then now we've created a-\n>> Standard primary.\n\n92\n00:04:38,610 --> 00:04:40,630\n>> Standard primary,\nfrom back in the old days.\n\n93\n00:04:40,630 --> 00:04:43,260\n>> The thing to remember is that\nthe command is really the same,\n\n94\n00:04:43,260 --> 00:04:47,440\nboth times we did add-\ndnsserver primary zone.\n\n95\n00:04:47,440 --> 00:04:52,410\nThe difference was for active directory\nintegrated, you did -replication scope.\n\n96\n00:04:52,410 --> 00:04:54,820\nWhich said what domain controllers\nare going to carry this.\n\n97\n00:04:54,820 --> 00:05:00,555\nAnd then for a standard primary,\njust ones outside, we did a -zone file.\n\n98\n00:05:00,555 --> 00:05:02,935\nInstead of being stored as\na replication scope in the AD,\n\n99\n00:05:02,935 --> 00:05:04,865\nthis one is stored in a file.\n\n100\n00:05:04,865 --> 00:05:07,685\nAnd that file,\nI can never remember, It was what?\n\n101\n00:05:07,685 --> 00:05:11,750\nC:/Windows/System32/DNS, but\nit's just right in there.\n\n102\n00:05:11,750 --> 00:05:13,021\n[CROSSTALK] Just a text files.\n\n103\n00:05:13,021 --> 00:05:14,770\nContains the whole zone.\n\n104\n00:05:14,770 --> 00:05:16,310\nIt's created and you're in business.\n\n105\n00:05:16,310 --> 00:05:20,300\nSo setting up a primary zone like that,\nnot a big deal at all.\n\n106\n00:05:20,300 --> 00:05:21,080\n>> Not at all.\n\n107\n00:05:21,080 --> 00:05:21,664\nAll right.\nSo those\n\n108\n00:05:21,664 --> 00:05:25,890\nare my active directory integrated,\nand my standard primaries.\n\n109\n00:05:25,890 --> 00:05:27,840\nNext thing we want to create is\ngoing to be reverse lookup zone.\n\n110\n00:05:28,950 --> 00:05:31,790\nSo again, the command is similar.\n\n111\n00:05:31,790 --> 00:05:34,760\nWe're gonna change that up.\n\n112\n00:05:34,760 --> 00:05:38,500\nIt starts out the same,\nadd-dnsserverPrimaryZone.\n\n113\n00:05:38,500 --> 00:05:44,990\nAnd then for this one, instead of a zone\nname, we're gonna do a network ID.\n\n114\n00:05:46,460 --> 00:05:47,430\nSo network ID.\n\n115\n00:05:48,720 --> 00:05:53,937\nAnd we're going to,\nI forget what network we're using,\n\n116\n00:05:53,937 --> 00:05:57,141\n192.168.1.0/24.\n\n117\n00:05:57,141 --> 00:05:58,590\nThat one.\n\n118\n00:05:58,590 --> 00:06:01,270\nAnd then again,\nbecause this is the domain controller.\n\n119\n00:06:01,270 --> 00:06:06,190\nSo let's do the -replicationScope.\n\n120\n00:06:06,190 --> 00:06:07,350\nAnd we'll do forest again.\n\n121\n00:06:07,350 --> 00:06:11,880\nSo this is gonna create a reverse lookup\nzone that is active directory integrated.\n\n122\n00:06:13,040 --> 00:06:14,650\nSo let's verify that, that worked.\n\n123\n00:06:14,650 --> 00:06:17,060\nWe'll flip back over to my DNS console.\n\n124\n00:06:17,060 --> 00:06:19,800\nWe'll refresh my good old\nreverse lookup zones here.\n\n125\n00:06:21,390 --> 00:06:25,050\nAnd there she is,\nmy 192.168.1.0 reverse lookup zone.\n\n126\n00:06:27,000 --> 00:06:29,250\nSo that's gonna be an active\ndirectory integrated zone.\n\n127\n00:06:29,250 --> 00:06:32,200\nIf we look at the type,\nthat is active directory integrated.\n\n128\n00:06:32,200 --> 00:06:35,620\nAnd then,\njust like with the standard primaries,\n\n129\n00:06:35,620 --> 00:06:40,490\nthe command to do a file based\nreverse lookup zone is the same thing.\n\n130\n00:06:40,490 --> 00:06:45,300\nInstead of doing the replication scope.\n\n131\n00:06:45,300 --> 00:06:46,710\nWe're going to give it\nthat zone file name.\n\n132\n00:06:48,320 --> 00:06:49,580\nI flip back over here.\n\n133\n00:06:51,390 --> 00:06:56,610\nAnd do another add -dnsserverPrimaryZone.\n\n134\n00:06:56,610 --> 00:07:01,660\nWe'll do a dash name,\nI'm sorry, dash network ID.\n\n135\n00:07:01,660 --> 00:07:03,340\nAnd again, we'll do the same thing.\n\n136\n00:07:03,340 --> 00:07:11,044\n192.168.1.0/24.\n\n137\n00:07:11,044 --> 00:07:14,030\nAnd then, for the zone file.\n\n138\n00:07:14,030 --> 00:07:17,720\nWe'll do instead of the replication scope,\nwe're going to do the zone file.\n\n139\n00:07:17,720 --> 00:07:24,003\nAnd the zone files, reverse look up\nzones or the network ID backwards.\n\n140\n00:07:24,003 --> 00:07:30,880\nSo we'll do 0.168.192.\n\n141\n00:07:30,880 --> 00:07:34,525\nAnd then that reserve dns suffix.\n\n142\n00:07:34,525 --> 00:07:41,670\nin -addr.arpa.dns for that file.\n\n143\n00:07:43,220 --> 00:07:47,010\n>> And that final name, you can actually\nput whatever name you want in there.\n\n144\n00:07:47,010 --> 00:07:50,240\nYou could call it bob.txt if you wanted,\nbut it would still work.\n\n145\n00:07:50,240 --> 00:07:54,190\nBut if you want to kind of\nobserve the normal process.\n\n146\n00:07:54,190 --> 00:07:56,860\nThese are the default file\nnames that Microsoft would use.\n\n147\n00:07:56,860 --> 00:07:59,120\nIf you use the GUI to create that zone,\n\n148\n00:07:59,120 --> 00:08:02,490\nit would create a file named\nexactly like Mike just did there.\n\n149\n00:08:02,490 --> 00:08:05,020\nSo, while you can use whatever you want.\n\n150\n00:08:05,020 --> 00:08:06,800\nYou're usually better off\nsticking with the standards.\n\n151\n00:08:06,800 --> 00:08:10,190\nBecause if somebody else has to come\nbehind you and troubleshoot the server.\n\n152\n00:08:10,190 --> 00:08:12,480\nThey're not gonna know what Bob.txt is.\n\n153\n00:08:12,480 --> 00:08:15,300\nBut they are gonna know what\nthat file name is right there.\n\n154\n00:08:15,300 --> 00:08:15,820\n>> Exactly.\n\n155\n00:08:15,820 --> 00:08:18,060\n>> But, just like Mike said,\ninstead of doing the replication scope,\n\n156\n00:08:18,060 --> 00:08:20,000\nyou just do zone file, and that's it.\n\n157\n00:08:20,000 --> 00:08:22,940\nReally the only difference between\na forward look up zone, and\n\n158\n00:08:22,940 --> 00:08:24,420\na reverse look up zone.\n\n159\n00:08:24,420 --> 00:08:26,800\nIs in a forward look up zone,\nwe gave it a name.\n\n160\n00:08:26,800 --> 00:08:29,530\nIn a reverse look up zone\nwe gave it a network ID.\n\n161\n00:08:29,530 --> 00:08:31,290\nRight?\nThat's the difference between the two.\n\n162\n00:08:32,800 --> 00:08:34,840\n>> All right.\nSo we've set up our primaries,\n\n163\n00:08:34,840 --> 00:08:35,450\nour secondaries.\n\n164\n00:08:35,450 --> 00:08:37,300\nThe next thing I want to do,\nactually I'm sorry.\n\n165\n00:08:37,300 --> 00:08:38,620\nWe set up all of our primaries, right?\n\n166\n00:08:38,620 --> 00:08:41,470\nWe did the active directory integrated,\nand then the standard primary.\n\n167\n00:08:41,470 --> 00:08:44,650\nNext thing we're gonna want to be able\nto do, is provide some redundancy.\n\n168\n00:08:44,650 --> 00:08:47,060\nWe've got a DNS server\nthat's hosting a zone.\n\n169\n00:08:47,060 --> 00:08:49,930\nI want more than one\nDNS Server hosting that zone.\n\n170\n00:08:49,930 --> 00:08:52,050\nIn case one of them fails.\n\n171\n00:08:52,050 --> 00:08:57,480\nSo we on DC1 I've got a zone for\ncontoso.com.\n\n172\n00:08:57,480 --> 00:08:59,210\n>> And that's active directory.\n\n173\n00:08:59,210 --> 00:09:00,090\nIs that active directory?\n\n174\n00:09:00,090 --> 00:09:01,050\n>> That is active directory integrated.\n\n175\n00:09:01,050 --> 00:09:02,420\n>> If they're active directory integrated,\n\n176\n00:09:02,420 --> 00:09:06,340\nremember that any DNS server that you\nbring up that's in that replication scope.\n\n177\n00:09:06,340 --> 00:09:07,750\nItll automatically get the zone.\n\n178\n00:09:07,750 --> 00:09:11,690\nSo youve already got replication there,\nits no big deal, youre done.\n\n179\n00:09:12,810 --> 00:09:18,160\nBut what if that zone is hosted on\na Linux server, or a UNIX Bind server.\n\n180\n00:09:18,160 --> 00:09:21,440\nOr its just hosted in some other domain,\nand you want a copy of it?\n\n181\n00:09:21,440 --> 00:09:24,310\nWell, in that case,\nyou might not be a part of that domain.\n\n182\n00:09:24,310 --> 00:09:26,380\nYou don't get a copy of that DNS zone.\n\n183\n00:09:26,380 --> 00:09:30,420\nAnd you may wanna set up what's\ncalled a standard secondary.\n\n184\n00:09:30,420 --> 00:09:34,490\nAnd a standard secondary being one\nthat is a backup copy of that zone,\n\n185\n00:09:34,490 --> 00:09:36,880\nthat's stored on your own DNS server.\n\n186\n00:09:36,880 --> 00:09:37,610\n>> Exactly.\n\n187\n00:09:37,610 --> 00:09:40,360\nSo we'll go over here,\nI'm gonna go over to serve one, and\n\n188\n00:09:40,360 --> 00:09:42,549\nI'll use him as my secondary.\n\n189\n00:09:43,640 --> 00:09:48,329\nAnd the command for that one is gonna\n\n190\n00:09:48,329 --> 00:09:53,190\nbe add -dnsserverSecondaryZone.\n\n191\n00:09:53,190 --> 00:09:56,270\nAnd for this one, the zone already exists.\n\n192\n00:09:56,270 --> 00:09:59,260\nContoso or DC1 is hosting that zone.\n\n193\n00:09:59,260 --> 00:10:03,160\nSo I've gotta give it the name of the zone\nthat I wanna make this secondary for.\n\n194\n00:10:03,160 --> 00:10:05,550\n>> Which we're gonna do that\n,we'll do west01 I guess.\n\n195\n00:10:05,550 --> 00:10:11,223\nLet's make sure we called it-\n>> I think you called it west1.\n\n196\n00:10:11,223 --> 00:10:13,115\n>> I think I did too.\n\n197\n00:10:13,115 --> 00:10:16,690\nwest2 and nope, west01 and west8.\n\n198\n00:10:16,690 --> 00:10:17,921\nI'm not very consistent with my names.\n\n199\n00:10:17,921 --> 00:10:21,240\n>> [LAUGH]\n>> So\n\n200\n00:10:21,240 --> 00:10:26,570\nwe'll call this one West 01.contoso.com.\n\n201\n00:10:26,570 --> 00:10:30,170\nAnd then because this guy\nis not a domain controller.\n\n202\n00:10:30,170 --> 00:10:32,940\nI'm going to have to create a file\nto store that information in.\n\n203\n00:10:32,940 --> 00:10:34,743\nSo the zone file.\n\n204\n00:10:34,743 --> 00:10:39,751\nAnd again, And we'll just use our\nnative standard convention here,\n\n205\n00:10:39,751 --> 00:10:43,724\nwest01.contoso.com.dns.\n\n206\n00:10:43,724 --> 00:10:45,905\nNow, this is a secondary.\n\n207\n00:10:45,905 --> 00:10:48,085\nSo he's a read-only copy.\n\n208\n00:10:48,085 --> 00:10:50,180\nHe has to get that\ninformation from somewhere.\n\n209\n00:10:50,180 --> 00:10:53,820\nSo in my PowerShell command, I've got\nto specify who that master server is.\n\n210\n00:10:53,820 --> 00:10:55,680\nWho's he getting his copy from?\n\n211\n00:10:55,680 --> 00:10:58,650\nAnd the parameter for\nthat is just masterservers.\n\n212\n00:10:58,650 --> 00:11:05,328\nSo -masterservers, and\nthen the IP address of my master server.\n\n213\n00:11:05,328 --> 00:11:12,071\nIn this case 192.1 68.1.1, and enter.\n\n214\n00:11:12,071 --> 00:11:15,831\nAnd now if I flip over\nhere to my DNS console.\n\n215\n00:11:15,831 --> 00:11:18,000\nI should have a new forward lookup zone.\n\n216\n00:11:19,470 --> 00:11:20,180\nFor west01.\n\n217\n00:11:21,230 --> 00:11:22,690\nBut, I've got an error.\n\n218\n00:11:22,690 --> 00:11:24,860\nI can see that that zone\nhasn't been loaded up.\n\n219\n00:11:24,860 --> 00:11:25,490\nRemember when you're.\n\n220\n00:11:25,490 --> 00:11:28,020\nSetting up your secondaries by default.\n\n221\n00:11:28,020 --> 00:11:30,800\nStarting with I think 2008,\nthey finally got it right.\n\n222\n00:11:30,800 --> 00:11:34,690\nBy default DNS servers don't\nallow zone transfers at all.\n\n223\n00:11:34,690 --> 00:11:38,250\nYou have to go in to specify who is\nallowed to request the copy of that zone.\n\n224\n00:11:38,250 --> 00:11:41,040\nSo even though I've added\nthe secondary zone here, and\n\n225\n00:11:41,040 --> 00:11:43,040\nI've told it who to get the copy from.\n\n226\n00:11:43,040 --> 00:11:46,190\nWhen he calls out dc1, and says,\nhey can I get a copy of that zone?\n\n227\n00:11:46,190 --> 00:11:48,070\ndc1 is saying no.\n\n228\n00:11:48,070 --> 00:11:49,980\nYou can't have a copy of that.\n\n229\n00:11:49,980 --> 00:11:53,540\nSo what we need to do is\ngo back over to our master.\n\n230\n00:11:53,540 --> 00:11:54,540\nIn this case dc.\n\n231\n00:11:55,720 --> 00:11:59,815\nAnd let it know that it's okay to\ngive a copy of that zone to server1.\n\n232\n00:12:01,330 --> 00:12:03,120\nAnd this is a cool command.\n\n233\n00:12:03,120 --> 00:12:05,530\nWe can do a few different\noptions with this.\n\n234\n00:12:05,530 --> 00:12:10,250\nThe command is going to be,\nwe're modifying an existing zone.\n\n235\n00:12:10,250 --> 00:12:12,140\nWe're not creating a new zone here.\n\n236\n00:12:12,140 --> 00:12:16,660\nSo it's gonna be set\n-dnsserverPrimaryZone.\n\n237\n00:12:16,660 --> 00:12:20,230\nSet dash DNS server primary zone.\n\n238\n00:12:20,230 --> 00:12:23,570\nAnd then the name of the zone\nthat you want to modify.\n\n239\n00:12:23,570 --> 00:12:26,190\nIn this case west01.\n\n240\n00:12:26,190 --> 00:12:29,410\nOops, let's make sure we add\nthe name parameter there.\n\n241\n00:12:30,430 --> 00:12:35,030\nThe name is going to\nbe west01.contoso.com.\n\n242\n00:12:35,030 --> 00:12:38,860\nAnd then there's a few different\noptions you can do, right?\n\n243\n00:12:38,860 --> 00:12:41,010\nWe've got the notify option in DNS.\n\n244\n00:12:41,010 --> 00:12:43,910\nNormally, we would do standard\nprimaries and secondaries.\n\n245\n00:12:43,910 --> 00:12:46,810\nThere's an interval,\nfifteen minutes by default.\n\n246\n00:12:46,810 --> 00:12:50,104\nThat refresh interval,\nthat's how often the secondary's going to\n\n247\n00:12:50,104 --> 00:12:52,441\nquery the master to see\nif there's any changes.\n\n248\n00:12:52,441 --> 00:12:55,995\nWith the notify option, I can tell the\nmaster, hey as soon as there's a change,\n\n249\n00:12:55,995 --> 00:12:57,580\nnotify all your secondaries.\n\n250\n00:12:57,580 --> 00:13:00,220\nLet them know there's been a change, and\nthen they won't wait the 15 minutes.\n\n251\n00:13:00,220 --> 00:13:02,450\nThey'll go ahead and\nrequest replication right then.\n\n252\n00:13:02,450 --> 00:13:06,950\nJust speeds up the convergence\non those zones.\n\n253\n00:13:06,950 --> 00:13:08,685\nSo I'm going to do a -notify.\n\n254\n00:13:10,880 --> 00:13:12,720\nAnd there's a few different\noptions you can do here.\n\n255\n00:13:12,720 --> 00:13:16,130\nI'll give you guys the link to TechNet\nthat has the different parameters.\n\n256\n00:13:16,130 --> 00:13:18,800\nYou can decide whether you wanna notify\n\n257\n00:13:18,800 --> 00:13:21,690\nall of the secondaries that\nare getting a copy of that zone.\n\n258\n00:13:21,690 --> 00:13:25,430\nOr you can say, I just wanna\nnotify particular secondaries.\n\n259\n00:13:25,430 --> 00:13:28,380\nFor me,\nI'm just gonna do a notify which says that\n\n260\n00:13:28,380 --> 00:13:31,150\nany secondary that's allowed\nto get a copy of this zone.\n\n261\n00:13:31,150 --> 00:13:33,060\nGo ahead and notify them anytime\nthere has been a change.\n\n262\n00:13:34,790 --> 00:13:37,270\nAnd then I have to tell who\nthe secondary server is.\n\n263\n00:13:37,270 --> 00:13:40,700\nWho's allowed to reach out and\nget a copy of that zone file.\n\n264\n00:13:40,700 --> 00:13:43,589\nAnd the parameter for\nthat is gonna be secondary service.\n\n265\n00:13:45,560 --> 00:13:47,130\nAnd then we do it by IP address.\n\n266\n00:13:47,130 --> 00:13:49,282\nIn this case, 192.168.\n\n267\n00:13:49,282 --> 00:13:50,345\nWhat are we?\n\n268\n00:13:50,345 --> 00:13:53,610\n.1.103 for server1.\n\n269\n00:13:55,490 --> 00:13:58,780\nAnd then what do we?\n\n270\n00:13:58,780 --> 00:13:59,850\nAnd then we're gonna choose.\n\n271\n00:13:59,850 --> 00:14:03,159\nSo if you think back to the GUI,\nwe're telling it who the secondary is.\n\n272\n00:14:04,300 --> 00:14:07,090\nWe also have to decide whose allowed\nto get the zone transferred.\n\n273\n00:14:07,090 --> 00:14:10,780\nIn the GUIs you've got the options,\nno transfers at all.\n\n274\n00:14:10,780 --> 00:14:13,730\nYou've got the option to any\nserver that requests it.\n\n275\n00:14:13,730 --> 00:14:16,820\nWhich means I can open up a command\nprompt and request a zone transfer.\n\n276\n00:14:16,820 --> 00:14:21,080\nWe could say only to named servers\nlisted on the named servers tab.\n\n277\n00:14:21,080 --> 00:14:23,780\nOr we can say the specific name servers.\n\n278\n00:14:23,780 --> 00:14:27,780\nAnd I can list the ones that\nare allowed to request that transfer.\n\n279\n00:14:27,780 --> 00:14:34,210\nAnd so in my case, I'm going to do the\nanybody that's all secondaries basically.\n\n280\n00:14:34,210 --> 00:14:36,799\nSo the option is going to be\ntransfer to secure servers.\n\n281\n00:14:38,000 --> 00:14:43,250\nSo it's going to be a -secure secondaries.\n\n282\n00:14:43,250 --> 00:14:47,600\nAnd then, we're going to use the option,\ntransfer to any server,\n\n283\n00:14:47,600 --> 00:14:49,725\nwould be the mistake, right.\n\n284\n00:14:49,725 --> 00:14:53,130\n>> [LAUGH]\n>> Transfer to secure servers is the one\n\n285\n00:14:53,130 --> 00:14:54,730\nthat I wanna do.\n\n286\n00:14:54,730 --> 00:14:56,990\nTransferToZoneNameServer.\n\n287\n00:14:56,990 --> 00:15:01,090\nThat'd be one that I can specify which\nparticular servers I wanted that to go to.\n\n288\n00:15:02,960 --> 00:15:04,010\nAlright.\nSo I hit enter on that.\n\n289\n00:15:04,010 --> 00:15:05,970\nNow if we take a look at the zone now.\n\n290\n00:15:07,140 --> 00:15:08,790\nSo back here on the properties of west01.\n\n291\n00:15:08,790 --> 00:15:10,100\nAnd lemme refresh that.\n\n292\n00:15:10,100 --> 00:15:11,659\nMake sure we get all those changes.\n\n293\n00:15:13,070 --> 00:15:14,650\nTake a look at\nthe properties of that zone.\n\n294\n00:15:14,650 --> 00:15:17,240\nAnd I go over here to\nthe Zone Transfers tab.\n\n295\n00:15:17,240 --> 00:15:21,070\nI can see zone transfers\nare now being allowed.\n\n296\n00:15:21,070 --> 00:15:26,010\nOnly to the following server, and then\nthere's the IP address of the secondary.\n\n297\n00:15:26,010 --> 00:15:27,880\nIf I go down to my Notify options.\n\n298\n00:15:27,880 --> 00:15:31,650\nYou'll see that automatic\nnotify is turned on.\n\n299\n00:15:31,650 --> 00:15:34,340\nServer is listed on the name\nservers tab is selected.\n\n300\n00:15:36,100 --> 00:15:39,160\nSo we'll go ahead and,\nI'm just having trouble resolving that.\n\n301\n00:15:40,430 --> 00:15:41,830\nThere we go.\nIt looks like he's got it though.\n\n302\n00:15:42,980 --> 00:15:48,040\nSo now if I switch over to server1,\n\n303\n00:15:48,040 --> 00:15:49,980\nlet's check and\nsee if we're allowed to get that zone now.\n\n304\n00:15:49,980 --> 00:15:53,110\nAnd there we go.\n\n305\n00:15:53,110 --> 00:15:55,610\nSo now the secondary's\nallowed to query that master.\n\n306\n00:15:55,610 --> 00:15:59,550\nAnd retrieve a copy of that zone file\nanytime there's a change being made\n\n307\n00:15:59,550 --> 00:16:00,330\nto that zone file.\n\n308\n00:16:00,330 --> 00:16:03,330\nThe master's gonna notify the secondary,\nand he'll request that copy again.\n\n309\n00:16:04,920 --> 00:16:06,580\n>> All right, and that's pretty much that.\n\n310\n00:16:06,580 --> 00:16:09,580\nSo just remember the little\nsubtle differences between them.\n\n311\n00:16:09,580 --> 00:16:12,470\nWhen it came to forward lookup zones,\nwell, for\n\n312\n00:16:12,470 --> 00:16:15,550\nthat one we really just to make the\ndecision whether it was active directory\n\n313\n00:16:15,550 --> 00:16:19,920\nintegrated or whether it was a standard,\nprimary, outside of the active directory.\n\n314\n00:16:19,920 --> 00:16:23,700\nThe difference there being whether\nwe gave it a replication scope, or\n\n315\n00:16:23,700 --> 00:16:27,750\nwhether we gave it\na zone file to store in.\n\n316\n00:16:27,750 --> 00:16:30,640\nFor the reverse lookup zones,\nthose are basically the same.\n\n317\n00:16:30,640 --> 00:16:31,360\nWe created those.\n\n318\n00:16:31,360 --> 00:16:33,310\nAnd again, you specified\na replication scope if it was\n\n319\n00:16:33,310 --> 00:16:34,450\nactive directory integrated.\n\n320\n00:16:34,450 --> 00:16:36,650\nOr a zone file if they were outside.\n\n321\n00:16:36,650 --> 00:16:39,310\nFor the secondary zones though,\nit was a good bit different.\n\n322\n00:16:39,310 --> 00:16:41,180\nRight, we had a little bit\nof security we had to jump\n\n323\n00:16:41,180 --> 00:16:42,650\nthrough there to get that opened up.\n\n324\n00:16:42,650 --> 00:16:48,060\nAnd then we got that replica copy from\nthere, adding it as a standard secondary.\n\n325\n00:16:48,060 --> 00:16:50,430\nNot a primary zone this time,\nbut a secondary zone.\n\n326\n00:16:50,430 --> 00:16:53,360\nSo those are some of the different\nzones that we can create.\n\n327\n00:16:53,360 --> 00:16:56,990\nAnd that's one of the first steps that\nwe take when we set up a new DNS server.\n\n328\n00:16:56,990 --> 00:17:02,790\nYou've got to have the zones there, before\nyou can start responding to DNS queries.\n\n329\n00:17:02,790 --> 00:17:06,120\nNow the zones we created still\naren't particularly useful.\n\n330\n00:17:06,120 --> 00:17:08,520\n>> No. [LAUGH] >> You need to get\nsome host records in there, so\n\n331\n00:17:08,520 --> 00:17:09,720\nyou can provide some information.\n\n332\n00:17:09,720 --> 00:17:11,240\nAnd right now we don't have any.\n\n333\n00:17:11,240 --> 00:17:13,345\nSo make sure you stay tuned.\n\n334\n00:17:13,345 --> 00:17:15,960\nBecause we have more segments coming down\nthe line where we're going to cover all\n\n335\n00:17:15,960 --> 00:17:18,100\nthose host records, and\ngetting those put in there.\n\n336\n00:17:18,100 --> 00:17:20,780\nBut as far as our basic\noperation of creating zones,\n\n337\n00:17:20,780 --> 00:17:22,720\nwe saw several different examples here.\n\n338\n00:17:22,720 --> 00:17:24,677\nAnd it's really about that, right Mike?\n\n339\n00:17:24,677 --> 00:17:25,690\n>> I think so, we got it all covered.\n\n340\n00:17:25,690 --> 00:17:27,720\n>> All right,\nwell I hope you guys enjoyed this segment.\n\n341\n00:17:27,720 --> 00:17:32,619\nStay tuned,\nwe've got more PowerShell coming up.\n\n342\n00:17:32,619 --> 00:17:36,579\n[MUSIC]\n\n",
          "vimeoId": "116357249"
        },
        {
          "description": "",
          "length": "1382",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-3-managing_dns_records-0107015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-3-managing_dns_records-0107015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-3-managing_dns_records-0107015-sm.jpg",
          "title": "Managing DNS Records",
          "transcript": "1\n00:00:00,025 --> 00:00:07,878\n[MUSIC]\n\n2\n00:00:07,878 --> 00:00:13,510\nIn this segment we're going to take a look\nat creating records inside of a DNS zone.\n\n3\n00:00:13,510 --> 00:00:16,200\nThe zones are pretty useless until we\nactually get some records in there to be\n\n4\n00:00:16,200 --> 00:00:16,930\nable to query against.\n\n5\n00:00:16,930 --> 00:00:18,830\nThat's what we're gonna see here.\n\n6\n00:00:18,830 --> 00:00:21,890\nNow there are a lot of different\nrecord types inside of DNS.\n\n7\n00:00:21,890 --> 00:00:24,410\nSo we're just gonna run down the list and\nmaybe hit them in,\n\n8\n00:00:24,410 --> 00:00:27,695\nI don't know whatever order,\npopularity maybe, or something.\n\n9\n00:00:27,695 --> 00:00:29,090\n>> [LAUGH] Alphabetical, we'll do that.\n\n10\n00:00:29,090 --> 00:00:31,610\n>> That could be fun.\n\n11\n00:00:31,610 --> 00:00:34,530\nWell no, I guess I should redefine fun.\n\n12\n00:00:34,530 --> 00:00:37,340\nBut anyhow, let's run through here and\nwe'll get some records created.\n\n13\n00:00:37,340 --> 00:00:40,650\nWe'll start with the most common one,\nwhich is a simple A record.\n\n14\n00:00:40,650 --> 00:00:42,620\nAnd just to refresh,\n\n15\n00:00:42,620 --> 00:00:48,220\nan A record Is simply a mapping between\na hostname and an IPv4 address.\n\n16\n00:00:48,220 --> 00:00:50,420\nIt's a little variation between IPv4 and\nIPv6.\n\n17\n00:00:50,420 --> 00:00:52,560\nBut we'll just start right here.\n\n18\n00:00:52,560 --> 00:00:53,820\n>> Yeah.\nIt's a good one to start with.\n\n19\n00:00:53,820 --> 00:00:56,300\nA lot of these are gonna be created,\ndepending on what we're talking about,\n\n20\n00:00:56,300 --> 00:01:00,080\na lot of these usually we're gonna have\ndynamic updates enabled on our zones.\n\n21\n00:01:00,080 --> 00:01:03,430\nSo the client should be creating\na lot of their own records.\n\n22\n00:01:03,430 --> 00:01:05,240\nBut if we need to go in there and\nmanually create one,\n\n23\n00:01:05,240 --> 00:01:06,790\nthese are the commands we're gonna use.\n\n24\n00:01:08,102 --> 00:01:09,590\n>> And now I keep calling them records,\n\n25\n00:01:09,590 --> 00:01:13,060\nbut technically the official\nname is a resource record.\n\n26\n00:01:13,060 --> 00:01:16,685\nAnd so the PowerShell commandlet that\nwe're gonna use for all of this is going\n\n27\n00:01:16,685 --> 00:01:20,795\nto be the add-dnsserver\nresource record command list.\n\n28\n00:01:20,795 --> 00:01:23,085\nA nice short one, easy to remember.\n\n29\n00:01:23,085 --> 00:01:25,385\nSo let me just fire up\nmy PowerShell here and\n\n30\n00:01:25,385 --> 00:01:27,415\nyou'll see add-DnsServerResourceRecord.\n\n31\n00:01:27,415 --> 00:01:30,991\nAnd the syntax that we use here is pretty\nmuch the same for all of these, but\n\n32\n00:01:30,991 --> 00:01:34,586\nit does vary just a little bit based\non the type of record we're creating.\n\n33\n00:01:34,586 --> 00:01:37,390\nSo, that's the main\ncommand we're gonna use.\n\n34\n00:01:37,390 --> 00:01:40,020\nI wanna create an A Record, so\nI'm just gonna come in here and\n\n35\n00:01:40,020 --> 00:01:43,120\ntell it what zone I'm working with.\n\n36\n00:01:43,120 --> 00:01:47,550\nAnd maybe I want to create a record for\nmy laptop, so I've got my donlaptop.\n\n37\n00:01:47,550 --> 00:01:50,450\nI want to create a record for\nit in lab.itpro.tv.\n\n38\n00:01:50,450 --> 00:01:53,580\nSo the zone I'm going to work\nwith is going to be lab.itpro.tv,\n\n39\n00:01:53,580 --> 00:01:58,700\nand then I'll specify that\nI'm creating an A record, -A.\n\n40\n00:01:58,700 --> 00:02:03,480\nAnd then I'll specify -Name and\nwhat I want it to be.\n\n41\n00:02:03,480 --> 00:02:06,710\nNow I want it to be donlaptop, right.\n\n42\n00:02:06,710 --> 00:02:10,903\nI don't wanna specify\ndonlaptop.lab.itpro.tv, cuz it already\n\n43\n00:02:10,903 --> 00:02:15,599\nknows the domain from the zone name up\nhere, so it's really just the A records\n\n44\n00:02:15,599 --> 00:02:18,545\nname itself, and so when I run, uh-oh\n>> Oops.\n\n45\n00:02:18,545 --> 00:02:19,428\n[LAUGH]\n>> I kinda left\n\n46\n00:02:19,428 --> 00:02:21,212\noff an important part there, didn't I?\n\n47\n00:02:21,212 --> 00:02:23,339\n[LAUGH]\n>> So after I specify the name,\n\n48\n00:02:23,339 --> 00:02:24,920\nthe whole point of this is to\n>> [LAUGH]\n\n49\n00:02:24,920 --> 00:02:25,864\n>> Map a name to an IP so\n\n50\n00:02:25,864 --> 00:02:29,581\nI probably need to add just a little bit\nmore to this command to get it working\n\n51\n00:02:29,581 --> 00:02:30,711\nthe way that I need it.\n\n52\n00:02:30,711 --> 00:02:32,806\nSo,\n>> It is nice that it was gonna prompt\n\n53\n00:02:32,806 --> 00:02:35,380\nyou, letting you know that hey,\nyou're missing a couple things here\n\n54\n00:02:35,380 --> 00:02:37,290\n>> Dear Don, quit being a moron.\n\n55\n00:02:37,290 --> 00:02:38,000\nAdd this in here.\n\n56\n00:02:38,000 --> 00:02:43,300\nSo I'll go ahead and say IPv4 address,\nand what address I want it to be?\n\n57\n00:02:43,300 --> 00:02:47,310\nAnd I guess I should know what my address\nis, but I'll just put one in here.\n\n58\n00:02:47,310 --> 00:02:48,710\nI think I'm 240.\n\n59\n00:02:48,710 --> 00:02:51,190\nSo we'll put that in, and\nthat's my IP address.\n\n60\n00:02:51,190 --> 00:02:53,030\nNow if I run this,\n\n61\n00:02:53,030 --> 00:02:55,770\nit's got all the information that\nit needs to be happy, right?\n\n62\n00:02:55,770 --> 00:02:58,200\nIt's got my host name, which is donlaptop.\n\n63\n00:02:58,200 --> 00:03:00,040\nIts got my IP address that\nits gonna map to, and\n\n64\n00:03:00,040 --> 00:03:01,940\nit knows the zone thats\ngonna create it in.\n\n65\n00:03:01,940 --> 00:03:05,140\nSo I could stop right here,\nbut theres a few\n\n66\n00:03:05,140 --> 00:03:08,390\nmore values that we might wanna specify\nto get this record working right.\n\n67\n00:03:08,390 --> 00:03:09,530\nRight, Mike?\n\n68\n00:03:09,530 --> 00:03:10,060\n>> Yeah, exactly.\n\n69\n00:03:10,060 --> 00:03:11,990\nOne of thems gonna be the time delay.\n\n70\n00:03:11,990 --> 00:03:15,990\nIf you create a new record, you've got\non your SOA, on your start of authority,\n\n71\n00:03:15,990 --> 00:03:18,420\nyou've got the default TTL,\nor time to live.\n\n72\n00:03:18,420 --> 00:03:20,490\nThat's how long other DNS servers or\n\n73\n00:03:20,490 --> 00:03:24,488\nclients that are retrieving that resource\nrecord are gonna cache that information.\n\n74\n00:03:24,488 --> 00:03:27,435\nSo we wanna specify something\nother than the default,\n\n75\n00:03:27,435 --> 00:03:31,020\nwhatever's listed on the SOA,\nwe can specify that here.\n\n76\n00:03:31,020 --> 00:03:33,278\n>> Yep, so I'll put a time to\nlive of one hour in there.\n\n77\n00:03:33,278 --> 00:03:36,918\nSo now, if somebody caches this,\nand it gets to be an hour old,\n\n78\n00:03:36,918 --> 00:03:38,795\nthen they'll have to refresh.\n\n79\n00:03:38,795 --> 00:03:39,740\n>> Exactly.\n\n80\n00:03:39,740 --> 00:03:42,500\nAnother we might want to do is age record.\n\n81\n00:03:42,500 --> 00:03:47,370\nNow this is a parameter normally when you\nmanually create records in DNS they're\n\n82\n00:03:47,370 --> 00:03:50,030\nconsidered static, so\nthey don't get a timestamp.\n\n83\n00:03:50,030 --> 00:03:53,490\nAnd that's not necessarily a bad thing,\nbut what'll happen is your aging and\n\n84\n00:03:53,490 --> 00:03:56,600\nscavenging process won't work\non those static records, right,\n\n85\n00:03:56,600 --> 00:03:59,860\nthere gonna be there forever\nuntil you manually remove them.\n\n86\n00:03:59,860 --> 00:04:03,780\nSo if you wanna let aging and scavenging,\nlike if Don's laptop ever goes away, do I\n\n87\n00:04:03,780 --> 00:04:07,880\nwant that record removed automatically\nonce it's reached a certain point?\n\n88\n00:04:07,880 --> 00:04:10,490\nAnd if I do we just use\nthe parameter age record.\n\n89\n00:04:10,490 --> 00:04:11,070\nWhat that's going to do,\n\n90\n00:04:11,070 --> 00:04:15,030\ninstead of listing as static, it's going\nto time stamp it, and now whatever your\n\n91\n00:04:15,030 --> 00:04:18,530\naging scavenging settings are,\nit'll remove that record if necessary.\n\n92\n00:04:19,780 --> 00:04:23,670\nAnd another perimeter you\ncan do is allow update any.\n\n93\n00:04:23,670 --> 00:04:24,503\n>> Oh, I didnt do that, shoot.\n\n94\n00:04:24,503 --> 00:04:26,120\n>> Oh, thats okay, yeah,\nit doesnt really matter.\n\n95\n00:04:26,120 --> 00:04:30,510\nBut theres a couple other parameters\nyou can use, the AllowUpdateAny.\n\n96\n00:04:30,510 --> 00:04:34,070\nAnd thats just gonna make sure that\nanybody thats listed as the owner of that\n\n97\n00:04:34,070 --> 00:04:38,570\nrecord is allowed to actually make changes\nto that record or update that record.\n\n98\n00:04:38,570 --> 00:04:41,640\n>> And I couldve done like\na Set-DnsServerResourceRecord to go and\n\n99\n00:04:41,640 --> 00:04:44,510\nmodify the existing record that\nI just made if I wanted to.\n\n100\n00:04:44,510 --> 00:04:46,770\nBut otherwise we can\nhave that set up there.\n\n101\n00:04:46,770 --> 00:04:51,575\nAll right, so thats basically\ngetting a IPv4 A record created, and\n\n102\n00:04:51,575 --> 00:04:57,754\na IPv6 A record, its pretty much the same\nexcept theyre not A, theyre 4A records.\n\n103\n00:04:57,754 --> 00:04:59,220\n>> Quad A, yeah.\n\n104\n00:04:59,220 --> 00:05:01,530\n>> If I modify,\nI just gonna modify the same command and\n\n105\n00:05:01,530 --> 00:05:04,120\nIll actually just I'll\nleave some of this off.\n\n106\n00:05:04,120 --> 00:05:06,710\nWe'll go a little more simple on this one.\n\n107\n00:05:06,710 --> 00:05:09,340\nInstead of -A, I'm gonna say -AAAA,\nright, the quad A record.\n\n108\n00:05:09,340 --> 00:05:12,212\n>> [LAUGH] That just\ndrives me crazy with that.\n\n109\n00:05:12,212 --> 00:05:14,260\n>> I'm gonna stick with\nmy same laptop name.\n\n110\n00:05:14,260 --> 00:05:19,230\nBut then for the IP address, instead of\nsaying IPv4Address, I'll say IPv6Address,\n\n111\n00:05:19,230 --> 00:05:23,230\nand then what that address is going to be.\n\n112\n00:05:23,230 --> 00:05:26,810\nSo, I can put in whatever\nmine actually happens to be.\n\n113\n00:05:26,810 --> 00:05:28,629\nI don't know it, so\nI guess I could make one up.\n\n114\n00:05:28,629 --> 00:05:33,813\nI'll do fd00::1234.\n\n115\n00:05:33,813 --> 00:05:35,100\nIt'll be easy to spot.\n\n116\n00:05:35,100 --> 00:05:38,435\nAnd so, I could specify that right\nin there, just throw it in, and\n\n117\n00:05:38,435 --> 00:05:40,800\nthen that's gonna be my quad A records.\n\n118\n00:05:40,800 --> 00:05:43,960\nSo now I've got an IPv6 address,\nand an IPv4 address.\n\n119\n00:05:43,960 --> 00:05:50,850\nNow, I can verify that in my GUI,\nif I fire up my DNS management tool, here.\n\n120\n00:05:50,850 --> 00:05:54,932\nI'll go into my forward lookup zone and\nlab.itpro.tv, and\n\n121\n00:05:54,932 --> 00:05:57,240\nthere I can see donlaptop.\n\n122\n00:05:57,240 --> 00:06:01,836\nHas a host A record, and\nan IPv6 four A record.\n\n123\n00:06:01,836 --> 00:06:03,086\nThey're all right there.\n\n124\n00:06:03,086 --> 00:06:06,380\nThere's that nice,\nunabbreviated address that it added.\n\n125\n00:06:06,380 --> 00:06:07,920\nSo it's got those addresses.\n\n126\n00:06:07,920 --> 00:06:13,060\nIf I take a look at that A record, I can\nsee it's got the values and that's it.\n\n127\n00:06:13,060 --> 00:06:16,150\nI don't see things like time deliver,\ncuz the GUI hides that by default.\n\n128\n00:06:16,150 --> 00:06:18,420\nI got to turn on the advanced view.\n\n129\n00:06:18,420 --> 00:06:20,600\nWe're going advanced today, there we go.\n\n130\n00:06:20,600 --> 00:06:23,080\nBut I can see delete this\nrecord when it becomes stale,\n\n131\n00:06:23,080 --> 00:06:25,310\ncuz we set that age record option.\n\n132\n00:06:25,310 --> 00:06:29,299\nI can see my time to live is 1 hour\nright down here, so that's set.\n\n133\n00:06:29,299 --> 00:06:33,971\nSo I can see that information did carry\nover into the record versus my IPv6,\n\n134\n00:06:33,971 --> 00:06:38,570\nwhere I didn't set those, so\nI don't have delete the record, is static,\n\n135\n00:06:38,570 --> 00:06:42,086\nit's time to live,\nwell I guess the default was an hour.\n\n136\n00:06:42,086 --> 00:06:44,170\n>> The default was set to an hour,\ntoo, so yep.\n\n137\n00:06:44,170 --> 00:06:46,070\n>> All right, so\nnothing too special there.\n\n138\n00:06:46,070 --> 00:06:49,260\nBut we can see those records and\nthey're in place.\n\n139\n00:06:49,260 --> 00:06:51,570\nThose A records and quad A records,\n\n140\n00:06:51,570 --> 00:06:54,530\nthose are our normal forward lookup\nrecords that we use for hosts.\n\n141\n00:06:54,530 --> 00:06:55,730\nIt's probably the most common.\n\n142\n00:06:55,730 --> 00:06:56,876\n>> Yeah, definitely.\nThose are what\n\n143\n00:06:56,876 --> 00:06:59,610\nwe call the primary resource record types.\n\n144\n00:06:59,610 --> 00:07:00,260\nGot to have those.\n\n145\n00:07:00,260 --> 00:07:04,130\nThat way, a client can query DNS or\nwhoever can query DNS, so\n\n146\n00:07:04,130 --> 00:07:07,000\nthey can get the IP address for\nthe machine they're trying to connect to.\n\n147\n00:07:07,000 --> 00:07:10,360\nOther records you might need though,\nyou might want to do an alias, right.\n\n148\n00:07:10,360 --> 00:07:13,320\nA good old C name or\ncanonical name record.\n\n149\n00:07:13,320 --> 00:07:15,190\nAnd we can add one of those\nwith PowerShell as well.\n\n150\n00:07:15,190 --> 00:07:19,711\nAnd that just allows me to map\na second name to the same IP address.\n\n151\n00:07:19,711 --> 00:07:22,340\nA lot of times we'll use that,\nused to use it a lot for www,\n\n152\n00:07:22,340 --> 00:07:26,103\nI don't see that as much anymore, there's\ndifferent ways we can handle that, but\n\n153\n00:07:26,103 --> 00:07:29,750\njust again, allows you to add\na second name to the same IP address.\n\n154\n00:07:29,750 --> 00:07:33,150\n>> Yep, so when we run this we would\nbasically just say that we were creating\n\n155\n00:07:33,150 --> 00:07:36,700\na C name, so instead of -A,\nor -4A, we'd say -C name.\n\n156\n00:07:36,700 --> 00:07:38,430\nAnd on this one it starts to\nget a little bit different,\n\n157\n00:07:38,430 --> 00:07:43,188\nwe do have to provide it a name, and\nso we can limit that www model, right.\n\n158\n00:07:43,188 --> 00:07:45,480\nSo I'm gonna pretend that\nI've got a host called www,\n\n159\n00:07:45,480 --> 00:07:49,350\nand then I'm going to map\nthat to another record.\n\n160\n00:07:49,350 --> 00:07:54,295\nSo instead of pointing to an IP address,\nI need to point to a other host, and\n\n161\n00:07:54,295 --> 00:07:57,805\nso we'll say -hostNameAlias.\n\n162\n00:07:57,805 --> 00:07:59,511\n>> To me the switches are a little\nbackwards there, aren't they?\n\n163\n00:07:59,511 --> 00:08:01,923\nI don't know.\nFor me it seems logically the alias would\n\n164\n00:08:01,923 --> 00:08:05,622\nbe the one that I'm giving www, and\nthe name would be Don's laptop.\n\n165\n00:08:05,622 --> 00:08:08,188\nSo, remember that, it's kinda backwards,\nat least in my opinion.\n\n166\n00:08:08,188 --> 00:08:11,365\n>> Yeah, you're providing\nthe name of the CName record,\n\n167\n00:08:11,365 --> 00:08:14,620\nnot the name of the actual\nhost that you're pointing to.\n\n168\n00:08:14,620 --> 00:08:15,360\nIt is a little weird.\n\n169\n00:08:15,360 --> 00:08:16,860\nBut then we would specify it.\n\n170\n00:08:16,860 --> 00:08:21,610\nNow, the host name alias isn't\nnecessarily in the same zone.\n\n171\n00:08:21,610 --> 00:08:24,320\nSo, even though I've got\nthe zone name right here, I'll\n\n172\n00:08:24,320 --> 00:08:28,950\nhave to provide the fully qualified domain\nname for whoever I'm pointing this to.\n\n173\n00:08:28,950 --> 00:08:34,686\nSo for example, I've got server\n01 is the server that I'm on.\n\n174\n00:08:34,686 --> 00:08:38,996\nAnd so, I might want to point\nto Server01.lab.itpro.tv.\n\n175\n00:08:38,996 --> 00:08:41,895\nSo, when I do that it'll punch it in.\n\n176\n00:08:41,895 --> 00:08:42,875\nNow, I do have a slight problem,\n\n177\n00:08:42,875 --> 00:08:45,795\nwhich I don't think I ever created\nan A record for that server.\n\n178\n00:08:45,795 --> 00:08:49,725\nSo, I'm gonna add an A record real quick\nfor that server, just to get it in there,\n\n179\n00:08:49,725 --> 00:08:54,005\nand we'll say that it's, actually I\ndon't know what IP address it is,\n\n180\n00:08:54,005 --> 00:08:55,985\nI'll just say it's .100.\n\n181\n00:08:55,985 --> 00:08:58,020\nAnd so,\nI'm just gonna add an A record for that.\n\n182\n00:08:58,020 --> 00:09:01,810\nAnd the reason I'm doing that is\nI need to have an A record for\n\n183\n00:09:01,810 --> 00:09:06,520\nserver 01 because the CNAME I made\nis gonna do a lookup for that value.\n\n184\n00:09:06,520 --> 00:09:08,310\n>> A CNAME record doesn't\npoint to an IP address,\n\n185\n00:09:08,310 --> 00:09:09,990\nit points to a fully\nqualified domain name.\n\n186\n00:09:09,990 --> 00:09:12,720\nAnd then it's gotta turn around and\nlook up that fully qualified domain name\n\n187\n00:09:12,720 --> 00:09:16,630\nto get the A record, and that's where it's\ngonna get the IP address for that alias.\n\n188\n00:09:17,960 --> 00:09:21,410\n>> So, if I do a quick nslookup for\nserver01.lab.itpro.tv, Oh, you know what?\n\n189\n00:09:21,410 --> 00:09:26,550\nI need to tell it to use\nme as the DNS server.\n\n190\n00:09:26,550 --> 00:09:27,640\nThere, okay.\n\n191\n00:09:27,640 --> 00:09:28,507\nSo I get a response back.\n\n192\n00:09:28,507 --> 00:09:32,490\nThe server01 is 10.1.230.100.\n\n193\n00:09:32,490 --> 00:09:39,830\nIf I change that, and do a lookup for\nwww.lab.itpro.tv, I get 10.1.230.100.\n\n194\n00:09:39,830 --> 00:09:42,240\nI get this same IP.\n\n195\n00:09:42,240 --> 00:09:44,280\nBut see how it shows that it is an alias.\n\n196\n00:09:44,280 --> 00:09:46,870\nIt lets me know that it is an alias for\nserver01.\n\n197\n00:09:46,870 --> 00:09:50,470\nSo it's in place,\nwe've now got that alias.\n\n198\n00:09:50,470 --> 00:09:53,910\nSo we've seen -A, -4 As,\n>> [LAUGH]\n\n199\n00:09:53,910 --> 00:09:55,010\n>> And dash CName.\n\n200\n00:09:56,580 --> 00:09:58,090\nSome of the other records we might create?\n\n201\n00:09:58,090 --> 00:09:58,880\n>> Like a pointer record.\n\n202\n00:09:58,880 --> 00:10:01,090\nIf we want to set up reverse look up zone,\nso\n\n203\n00:10:01,090 --> 00:10:03,830\nthat we can look up something by IP\naddress and return the name, right.\n\n204\n00:10:03,830 --> 00:10:07,060\nNormally you know the name of\nthe node you're trying to connect to.\n\n205\n00:10:07,060 --> 00:10:08,840\nYou want a return IP address.\n\n206\n00:10:08,840 --> 00:10:11,970\nIf I have an IP address, like from\na log file or something like that, and\n\n207\n00:10:11,970 --> 00:10:15,520\nI want to return the name, that's when\nwe need that reverse lookup zones.\n\n208\n00:10:15,520 --> 00:10:20,263\nFor one, we'll have to make sure\nwe got a reverse lookup zone.\n\n209\n00:10:20,263 --> 00:10:21,450\nIf I can say that, reverse lookup created.\n\n210\n00:10:21,450 --> 00:10:23,140\nAnd then within that reverse lookup zone,\n\n211\n00:10:23,140 --> 00:10:26,790\nwe create what we call PTR\nrecords,or pointer records.\n\n212\n00:10:26,790 --> 00:10:28,695\nAnd they do just\nthe opposite of an A record.\n\n213\n00:10:28,695 --> 00:10:32,520\nThey're going to point an IP address\nback to a fully qualified domain name.\n\n214\n00:10:33,740 --> 00:10:36,370\n>> So if I wanna create one of those,\nI'm still gonna be working\n\n215\n00:10:36,370 --> 00:10:41,430\nwithin the add DNS server resource record.\n\n216\n00:10:41,430 --> 00:10:42,790\nSo that same command.\n\n217\n00:10:42,790 --> 00:10:45,830\nBut this time, I'm going to\nspecify that I'm doing a name,\n\n218\n00:10:45,830 --> 00:10:48,880\nand what the name of this\nrecord is going to be.\n\n219\n00:10:48,880 --> 00:10:52,050\nAnd the name is the IP address, right.\n\n220\n00:10:52,050 --> 00:10:54,220\nSo the IP address for a host,\n\n221\n00:10:54,220 --> 00:10:56,710\nlet's say I want to create,\nactually let me just verify here.\n\n222\n00:10:56,710 --> 00:11:01,250\nI do have a reverse look up zone for\n10.1.230, and it's empty right now,\n\n223\n00:11:01,250 --> 00:11:03,180\nthere's no PTRs in it.\n\n224\n00:11:03,180 --> 00:11:06,690\nSo, I'm going to be creating one for\nmy laptop, which I said was .240.\n\n225\n00:11:06,690 --> 00:11:09,570\nSo for the name,\nI'm just gonna to put 240.\n\n226\n00:11:09,570 --> 00:11:12,100\n>> Right, because it already knows\nthe prefix for the subnet, right.\n\n227\n00:11:12,100 --> 00:11:14,500\nSo you just need that last,\nin this case we're using a 24 bit, so\n\n228\n00:11:14,500 --> 00:11:16,580\nwe need that last octet in there.\n\n229\n00:11:16,580 --> 00:11:19,790\n>> Right, its got to know that part,\nwhich well see here in just a second,\n\n230\n00:11:19,790 --> 00:11:21,540\nbecause just giving it that,\nthats not enough.\n\n231\n00:11:21,540 --> 00:11:23,610\nRight now it doesnt know where for\nthat to go.\n\n232\n00:11:23,610 --> 00:11:29,430\nSo Im going add to that a little bit with\n-Ptr, and heres where Im telling it\n\n233\n00:11:29,430 --> 00:11:33,980\nthe reverse zone that its actually gonna\nfall under, or that it is under, sorry.\n\n234\n00:11:33,980 --> 00:11:35,700\nAnd then I need to say my zone name.\n\n235\n00:11:35,700 --> 00:11:38,570\nThere we go, and thats where\nIm gonna tell it where to go.\n\n236\n00:11:38,570 --> 00:11:43,031\nAnd in my case, it's going into this zone.\n\n237\n00:11:43,031 --> 00:11:48,450\nAnd reverse lookup zones have weird names,\nright?\n\n238\n00:11:48,450 --> 00:11:51,595\nIt's 10.1.230 kind of written in reverse,\n\n239\n00:11:51,595 --> 00:11:57,540\n.in-addr which is internet address .arpa,\nthe whole Internet naming.\n\n240\n00:11:57,540 --> 00:11:59,228\n>> Reverse resolution protocol, yeah.\n\n241\n00:11:59,228 --> 00:12:00,690\n>> It all kinda came from there.\n\n242\n00:12:00,690 --> 00:12:01,500\nAnd so,\n\n243\n00:12:01,500 --> 00:12:05,160\nit's gonna throw all of that in there, and\nthat's how it's gonna know where to go.\n\n244\n00:12:05,160 --> 00:12:07,310\nAnd if you don't know\nwhat that name should be,\n\n245\n00:12:07,310 --> 00:12:09,450\nyou can always look in your GUI and\nsee it, right?\n\n246\n00:12:09,450 --> 00:12:12,100\nIt's got that name right there tied to it.\n\n247\n00:12:12,100 --> 00:12:14,158\nBut now it's gonna know\nwhere to create it.\n\n248\n00:12:14,158 --> 00:12:19,100\nWe're doing -Ptr, so it knows I'm\ndoing a pointer, -name, and instead of\n\n249\n00:12:19,100 --> 00:12:22,180\na word like Don laptop, I do 240 and then-\n>> And\n\n250\n00:12:22,180 --> 00:12:25,200\nthen we have one more little bit there,\nwe're gonna add the ptr domain name.\n\n251\n00:12:26,450 --> 00:12:27,230\n>> The oh, yep.\n\n252\n00:12:27,230 --> 00:12:30,393\n>> That still kind of needs that\nfully qualified domain name, or,\n\n253\n00:12:30,393 --> 00:12:32,690\nI think that's what it's\ntrying to do there.\n\n254\n00:12:33,810 --> 00:12:36,540\n>> Well this is where we have to map\nit back to who it's actually tied to.\n\n255\n00:12:36,540 --> 00:12:41,230\nSo it now knows that there's a 240,\nbut who does it actually point to?\n\n256\n00:12:41,230 --> 00:12:43,850\nAnd it's gonna point to, let me,\nmy head's gonna get on top of that.\n\n257\n00:12:43,850 --> 00:12:46,350\nLet me just move that a little bit.\n\n258\n00:12:46,350 --> 00:12:46,900\nNot enough.\nBut\n\n259\n00:12:46,900 --> 00:12:48,800\nnow it needs to know who to point back to.\n\n260\n00:12:48,800 --> 00:12:52,310\nAnd so, I'll just come in here and\nsay that the pointer domain name,\n\n261\n00:12:52,310 --> 00:12:55,380\nI now point it to the fully\nqualified domain name of who it is.\n\n262\n00:12:55,380 --> 00:13:02,344\nSo in my case,\nthat's donlaptop.lab.itpro.tv.\n\n263\n00:13:02,344 --> 00:13:07,590\nSo now it knows who that\npointer is attached to.\n\n264\n00:13:07,590 --> 00:13:10,380\nSo, the name here,\nthat's my IP address, or part of it,\n\n265\n00:13:10,380 --> 00:13:12,250\nthe rest of it comes from the zone.\n\n266\n00:13:12,250 --> 00:13:14,240\nAnd then the pointer domain name,\n\n267\n00:13:14,240 --> 00:13:17,800\nthat's the fully qualified\nhost name that this maps to.\n\n268\n00:13:17,800 --> 00:13:20,501\nSo now when I do an nslookup for like,\n\n269\n00:13:20,501 --> 00:13:25,484\nDonlaptop.lab.ITPro.TV, I\nget 10.1.230.240.\n\n270\n00:13:25,484 --> 00:13:29,484\nLet me make sure that actually\nran against my own DNS server.\n\n271\n00:13:29,484 --> 00:13:31,540\nThere, it did.\n\n272\n00:13:31,540 --> 00:13:37,920\nBut if I do that same lookup, not for\nmy host name, but for my IP instead.\n\n273\n00:13:37,920 --> 00:13:44,620\nIf I say, lookup 10.1.230.240,\nand tell me who has that IP.\n\n274\n00:13:44,620 --> 00:13:48,360\nWhen it does that lookup,\nit gets Donlaptop.lab.itprotv.\n\n275\n00:13:48,360 --> 00:13:52,350\nThe result lookup is working.\n\n276\n00:13:52,350 --> 00:13:53,140\n>> Easy enough.\n\n277\n00:13:53,140 --> 00:13:55,350\n>> So and I can double-check that\nrecord if I come back here and\n\n278\n00:13:55,350 --> 00:13:56,830\nI can refresh my zone.\n\n279\n00:13:56,830 --> 00:13:57,840\nI can see there it is, 10.1.230.240.\n\n280\n00:13:57,840 --> 00:14:01,740\nThere's a point of record pointing\nto donlaptop, it's right there.\n\n281\n00:14:01,740 --> 00:14:06,460\n>> So that covers most of our primary,\nwell for connecting to hosts or\n\n282\n00:14:06,460 --> 00:14:07,270\nnodes on your network.\n\n283\n00:14:07,270 --> 00:14:10,770\nYou've got your A records, your quad\nA records, and then your PTR records, and\n\n284\n00:14:10,770 --> 00:14:12,610\nalso RC name records, our aliases.\n\n285\n00:14:12,610 --> 00:14:15,270\nBut then we also have some other\nrecords that allow me to Find\n\n286\n00:14:16,430 --> 00:14:19,650\nwhich servers are providing\ndifferent services on the network.\n\n287\n00:14:19,650 --> 00:14:21,490\nFor example we've got MX records for\nour exchange.\n\n288\n00:14:21,490 --> 00:14:23,764\nIn fact,\nMike was just mentioning out there.\n\n289\n00:14:23,764 --> 00:14:26,640\nMike, that was a good segway,\nthat's the next one we're gonna hit here,\n\n290\n00:14:26,640 --> 00:14:31,650\nis an exchange record or\nan exchanger record, or an MX record.\n\n291\n00:14:31,650 --> 00:14:33,270\nAnd again, the syntax is very similar.\n\n292\n00:14:33,270 --> 00:14:37,290\nYou can see that it's still gonna\nbe the Add-DnsServerResourceRecord.\n\n293\n00:14:37,290 --> 00:14:40,480\nJust gonna specify a different type\nof record that we're gonna create.\n\n294\n00:14:40,480 --> 00:14:43,610\nAnd this one's gonna require\na little bit different information.\n\n295\n00:14:43,610 --> 00:14:44,980\n>> Yeah, these are weird.\n\n296\n00:14:44,980 --> 00:14:47,620\nMail exchange change records\nare just outright weird.\n\n297\n00:14:47,620 --> 00:14:50,390\nSo when we go to add one,\nwe have to give it a name.\n\n298\n00:14:50,390 --> 00:14:53,820\nBut the name is pretty particular,\nso I'm gonna give it a name.\n\n299\n00:14:53,820 --> 00:14:55,741\nAnd the name is going to be .-MX.\n\n300\n00:14:55,741 --> 00:15:00,920\nOops, actually that's actually not right,\nis it?\n\n301\n00:15:00,920 --> 00:15:03,450\nIt just needs to be the name is dot.\n\n302\n00:15:03,450 --> 00:15:07,560\nSo, the MX record doesn't\ntechnically have a name.\n\n303\n00:15:07,560 --> 00:15:10,380\nIt is an MX record, and\nthen, in its return value,\n\n304\n00:15:10,380 --> 00:15:12,440\nit contains a list of servers.\n\n305\n00:15:12,440 --> 00:15:16,640\nSo the name is kind of an odd one,\nand let's see,\n\n306\n00:15:16,640 --> 00:15:18,340\nthat should be happy with the dot.\n\n307\n00:15:18,340 --> 00:15:19,805\nThere are some times\nwhere you need to do a-\n\n308\n00:15:19,805 --> 00:15:21,435\n>> Just leave it blank, or?\n\n309\n00:15:21,435 --> 00:15:24,510\n>> You can leave it blank,\nor you can do an @ symbol.\n\n310\n00:15:24,510 --> 00:15:26,790\nLet's give it a shot here\nwith just leaving it blank,\n\n311\n00:15:26,790 --> 00:15:29,070\nso that it knows that it\ndoesn't actually have a name.\n\n312\n00:15:29,070 --> 00:15:32,140\nAnd then after that, we say -MX, so\nthat it knows that it's an MX record.\n\n313\n00:15:32,140 --> 00:15:35,027\nAnd then we need to follow it up with\nwhat zone that we're gonna to be\n\n314\n00:15:35,027 --> 00:15:36,200\ncreating this in.\n\n315\n00:15:36,200 --> 00:15:39,160\nSo I'm creating a record for\nlab at itpro.tv.\n\n316\n00:15:39,160 --> 00:15:45,390\nAnd then, inside of lab.itpro.tv,\nI create this MX record.\n\n317\n00:15:45,390 --> 00:15:48,520\nNow it needs to know what\nservers are gonna be tied to it.\n\n318\n00:15:48,520 --> 00:15:50,409\nSo I've gotta provide a little\nmore information than what\n\n319\n00:15:50,409 --> 00:15:51,186\nwe've got right here.\n\n320\n00:15:51,186 --> 00:15:53,897\nSo I'm gonna say -MailExchange.\n\n321\n00:15:53,897 --> 00:15:58,877\nAnd then the server or servers,\nyou may have more than one.\n\n322\n00:15:58,877 --> 00:15:59,400\nServer.\n\n323\n00:15:59,400 --> 00:16:01,745\nMx record is really like a text field, and\n\n324\n00:16:01,745 --> 00:16:04,990\nyou can have several servers\nthat are inside of it.\n\n325\n00:16:04,990 --> 00:16:06,210\nI'm gonna add just one.\n\n326\n00:16:06,210 --> 00:16:07,980\nI'll do mail.lab.itpro.tv,\n\n327\n00:16:07,980 --> 00:16:13,600\nwhich is not a real server, but\nI'll punch that one in there.\n\n328\n00:16:13,600 --> 00:16:16,560\nAnd, you can have preference,\nor a weight, to them.\n\n329\n00:16:16,560 --> 00:16:20,170\nSo if you have multiple servers,\nwhich one do you go to first.\n\n330\n00:16:20,170 --> 00:16:21,860\nIt's a numerical value.\n\n331\n00:16:21,860 --> 00:16:25,185\nThe lower the number,\nthe more preferred the server is.\n\n332\n00:16:25,185 --> 00:16:27,741\nSo, most people usually do like 10,\n20, 30, 40.\n\n333\n00:16:27,741 --> 00:16:29,621\nBut you could do 1, 2, 3, 4 if you wanted.\n\n334\n00:16:29,621 --> 00:16:31,200\nYou've got some flexibility.\n\n335\n00:16:31,200 --> 00:16:35,859\nI'm going to do let's see,\nI'll do -Preference 10.\n\n336\n00:16:35,859 --> 00:16:38,950\nSo, that's pretty common right there.\n\n337\n00:16:38,950 --> 00:16:41,730\nSo, let's run that, and it actually got a\nlittle upset about that name [CROSSTALK].\n\n338\n00:16:41,730 --> 00:16:44,198\n>> Yeah, let me throw that back in.\n\n339\n00:16:44,198 --> 00:16:45,596\nWe'll make it happy.\n\n340\n00:16:45,596 --> 00:16:49,020\nThere's our dot.\n\n341\n00:16:49,020 --> 00:16:50,090\n>> There we go, that looks better.\n\n342\n00:16:50,090 --> 00:16:52,220\nSo, it did complain and\nneeded that dot in there,\n\n343\n00:16:52,220 --> 00:16:56,260\njust so it knew that it was kind of an\nempty value, so now I've got an MX record,\n\n344\n00:16:56,260 --> 00:17:01,670\nthat points to mail.lab.itpro.tv, and it's\ngot a preference of 10, and it's in place.\n\n345\n00:17:01,670 --> 00:17:04,470\nNow, I do want to verify that\njust to make sure it's clear.\n\n346\n00:17:04,470 --> 00:17:07,720\nI'll go back here to my\nforward lookup zone and\n\n347\n00:17:07,720 --> 00:17:09,660\nI'll just refresh that real quick.\n\n348\n00:17:09,660 --> 00:17:13,310\nAnd now I can see that I've got\na mail exchanger record right here.\n\n349\n00:17:13,310 --> 00:17:16,490\nAnd see how for\nthe name it says same as parent folder.\n\n350\n00:17:16,490 --> 00:17:17,760\nThat's what the dot means.\n\n351\n00:17:17,760 --> 00:17:21,070\nThat means this is a mail exchanger,\nnot for just an individual host,\n\n352\n00:17:21,070 --> 00:17:23,880\nbut for lab.itpro.tv.\n\n353\n00:17:23,880 --> 00:17:29,170\nAnd then it's got mail.lab.itpro.tv\nright there, with a preference of 10.\n\n354\n00:17:29,170 --> 00:17:31,375\n>> And one of the things I like\nto do when I'm working is,\n\n355\n00:17:31,375 --> 00:17:34,140\na lot of us have used the GUI for\na long time, the GUI.\n\n356\n00:17:34,140 --> 00:17:38,570\nAnd now we're starting to use PowerShell\nto get a little more Administrative,\n\n357\n00:17:38,570 --> 00:17:40,950\ngetting more powerful with our\nadministration, be able to script things,\n\n358\n00:17:40,950 --> 00:17:42,040\nautomate things.\n\n359\n00:17:42,040 --> 00:17:45,130\nBut I always like to think about,\nokay when I was in the GUI,\n\n360\n00:17:45,130 --> 00:17:46,430\nwhat did I have to fill in?\n\n361\n00:17:46,430 --> 00:17:49,439\nThink about the wizard that you went\nthrough cuz you're providing all\n\n362\n00:17:49,439 --> 00:17:52,815\nof the same information in this PowerShell\ncommand that you would in the GUIs.\n\n363\n00:17:52,815 --> 00:17:56,815\nSo if you right-click New MX Record,\nalways leave that first line blank.\n\n364\n00:17:56,815 --> 00:18:00,715\nAnd it says it's gonna use the parent\ndomain name if you do that.\n\n365\n00:18:00,715 --> 00:18:02,365\nKinda helps remember what\nswitches I need to do and\n\n366\n00:18:02,365 --> 00:18:03,932\nwhat values I need to put in there.\n\n367\n00:18:03,932 --> 00:18:05,052\n>> Yep.\n\n368\n00:18:05,052 --> 00:18:08,592\nThe last record type we wanna talk\nabout is probably the weirdest.\n\n369\n00:18:08,592 --> 00:18:10,582\nWe saw with MX servers,\nor mail exchangers,\n\n370\n00:18:10,582 --> 00:18:16,200\nthat's a pretty specific example of a\nservice that's directly supported by DNS.\n\n371\n00:18:16,200 --> 00:18:20,570\nThe people that designed this whole\nnaming service, they said you know what,\n\n372\n00:18:20,570 --> 00:18:24,260\nwe don't wanna keep adding specific\nrecords for services out there.\n\n373\n00:18:24,260 --> 00:18:27,720\nSo instead they created a generic\nservice type resource record,\n\n374\n00:18:27,720 --> 00:18:33,180\nwhich is called an SRV record, and SRVs\ncan point to any service that's out there.\n\n375\n00:18:33,180 --> 00:18:36,390\nIf they had to do it all over again today,\nwe wouldn't have MX records,\n\n376\n00:18:36,390 --> 00:18:38,990\ninstead they would use SRV records also.\n\n377\n00:18:38,990 --> 00:18:41,180\nBut we have SRV records for\neverything else.\n\n378\n00:18:41,180 --> 00:18:45,140\nThe active directory uses the heck out of\nthese, but there are other programs and\n\n379\n00:18:45,140 --> 00:18:48,170\nprotocols that can make use of it too,\nso we do see these quite a bit.\n\n380\n00:18:49,170 --> 00:18:52,325\nSRV records,\nDNS doesn't really know what they are.\n\n381\n00:18:52,325 --> 00:18:55,845\nSo we have to provide a lot of\nadditional information to them so\n\n382\n00:18:55,845 --> 00:18:57,715\nit knows exactly what to\nhand off to the clients.\n\n383\n00:18:58,837 --> 00:19:01,365\nAll right, so let me show you\nan example of an SRV record.\n\n384\n00:19:01,365 --> 00:19:05,005\nMike, you put one in the show notes which\nis an example for finding a SIP server for\n\n385\n00:19:05,005 --> 00:19:06,880\nvoice over IP.\n\n386\n00:19:06,880 --> 00:19:13,320\nSo if I wanna add that,\nI'll do the Add-DnsServerResourceRecord,\n\n387\n00:19:13,320 --> 00:19:16,250\nlike we've been doing, but\nI'm gonna modify this just a little bit.\n\n388\n00:19:16,250 --> 00:19:19,300\nI need to tell it we're doing\nan SRV record, so I'll say, -Srv.\n\n389\n00:19:19,300 --> 00:19:23,250\nI need to give it a name, and\nwe're just gonna call this one sip.\n\n390\n00:19:24,560 --> 00:19:27,510\nSo, this will be sip.lab.itpro.tv.\n\n391\n00:19:27,510 --> 00:19:30,970\nAll right, I need to give it a zone name.\n\n392\n00:19:30,970 --> 00:19:32,850\nWhich will be lab.itpro.tv.\n\n393\n00:19:32,850 --> 00:19:36,620\nSo there I'm defining what the record\nis going to be called, and\n\n394\n00:19:36,620 --> 00:19:38,640\nthen I need to tell it\nwhat it's going to be.\n\n395\n00:19:38,640 --> 00:19:43,680\nNow, SRV records, a lot like mail\nexchanges have what they are,\n\n396\n00:19:43,680 --> 00:19:48,440\nthey have their preference, which one's\nhigher priority, or lower priority, so\n\n397\n00:19:48,440 --> 00:19:49,060\nI need to give that.\n\n398\n00:19:49,060 --> 00:19:50,980\nNow, instead of preference\nthey do call it priority.\n\n399\n00:19:52,060 --> 00:19:56,540\nSo I'll give this one a priority of 0,\nlower number is better.\n\n400\n00:19:56,540 --> 00:20:00,360\nI can give it a weight which\nsays if there's a tie, if\n\n401\n00:20:00,360 --> 00:20:04,820\nI have two servers at the same priority,\nhow do I divide my traffic up amongst it.\n\n402\n00:20:04,820 --> 00:20:08,220\nMaybe I want half my traffic to go one and\nhalf my traffic to go with another.\n\n403\n00:20:08,220 --> 00:20:10,960\nI can specify that with a weight value.\n\n404\n00:20:10,960 --> 00:20:14,990\nAnd then, because it doesn't know\nwhat kind of software this is,\n\n405\n00:20:14,990 --> 00:20:17,280\nI need to give it a port number.\n\n406\n00:20:17,280 --> 00:20:20,960\nWhen we connect to this,\nit needs to know what port to use and\n\n407\n00:20:20,960 --> 00:20:25,890\nsip usually uses 5060, 5-0-6-0,\nso I'll punch that in.\n\n408\n00:20:25,890 --> 00:20:29,900\nSo now, any VoIP phone on my network, if\nit's looking for a SIP server, it can just\n\n409\n00:20:29,900 --> 00:20:34,530\nlook for sip.lab.itprotv and it's gonna\nreturn that, oh yeah, yeah, that exists.\n\n410\n00:20:34,530 --> 00:20:35,860\nWe've got a SIP service.\n\n411\n00:20:35,860 --> 00:20:37,230\nIt's on port 5060.\n\n412\n00:20:37,230 --> 00:20:40,320\nAnd it's tied to a particular host.\n\n413\n00:20:40,320 --> 00:20:42,710\nAnd that's the last time\nI need to throw in here.\n\n414\n00:20:42,710 --> 00:20:45,360\nWhich is -DomainName.\n\n415\n00:20:47,080 --> 00:20:49,590\n>> It's a lot like your C\nname records on any of these.\n\n416\n00:20:49,590 --> 00:20:50,980\nIt doesn't point to an IP address.\n\n417\n00:20:50,980 --> 00:20:54,719\nIt points back to a fully qualified domain\nname, and then it's gonna turn around and\n\n418\n00:20:54,719 --> 00:20:57,315\nlook at the A record for\nthat fully qualified domain name.\n\n419\n00:20:57,315 --> 00:21:03,238\n>> Yep, so then I might have a server on\nmy network that is server01.lab.itpro.tv.\n\n420\n00:21:03,238 --> 00:21:07,860\nMaybe that's running some kind of PBX\nsoftware, or some kind of VoIP system.\n\n421\n00:21:07,860 --> 00:21:09,590\nAnd so,\nthat's what people are gonna reach out to,\n\n422\n00:21:09,590 --> 00:21:11,130\nthat's the record this\nis all gonna point to.\n\n423\n00:21:12,220 --> 00:21:15,770\nSo, when I run that, that gets created,\nand now I've got this SRV record.\n\n424\n00:21:15,770 --> 00:21:19,244\nNow, a lot of companies like Microsoft,\nwhenever they give it a name for\n\n425\n00:21:19,244 --> 00:21:21,990\nSRV records,\nthey'll start it with an underscore.\n\n426\n00:21:21,990 --> 00:21:25,960\nYou don't have to do that, but\nmost people do because it makes it easy\n\n427\n00:21:25,960 --> 00:21:29,290\nvisually to recognize that hey\nthis is a service not a host.\n\n428\n00:21:29,290 --> 00:21:31,450\nNo host name would ever\nstart with an underscore,\n\n429\n00:21:31,450 --> 00:21:35,350\nin fact with DNS names you're typically\nnot allowed to use an underscore.\n\n430\n00:21:35,350 --> 00:21:39,510\nAnd so that really separates out\nSRV records from normal records.\n\n431\n00:21:39,510 --> 00:21:43,840\nBut if I go back to my GUI here, if I go\nto lab.itpro.tv, and I'll just refresh\n\n432\n00:21:43,840 --> 00:21:49,340\nthat, I should now have this SRV record\nright here, Service Location Record.\n\n433\n00:21:49,340 --> 00:21:54,200\nIt's called sip, and\nit points to server01.lab.itpro.tv.\n\n434\n00:21:54,200 --> 00:21:58,030\nIt's on port 5060 and\nit's got a priority and weight of 0.\n\n435\n00:21:58,030 --> 00:21:59,860\nThe record is created and it's there.\n\n436\n00:22:01,420 --> 00:22:02,410\n>> Beautiful thing.\n\n437\n00:22:02,410 --> 00:22:06,170\n>> And with all of these commands, I've\nbeen using Add-DnsServerResourceRecord.\n\n438\n00:22:06,170 --> 00:22:09,320\nYou've also got\nSet-DnsServerResourceRecord,\n\n439\n00:22:09,320 --> 00:22:13,670\nwhich lets you modify these if you need\nto change values on them after the fact.\n\n440\n00:22:13,670 --> 00:22:17,040\nBut otherwise, creating the records\nis pretty straight forward.\n\n441\n00:22:17,040 --> 00:22:21,340\nThere are other records that are out\nthere, like NS records, and so on.\n\n442\n00:22:21,340 --> 00:22:25,280\nThey're a lot less commonly modified, so\nwe won't tackle them here in the show.\n\n443\n00:22:25,280 --> 00:22:27,235\nBut if you ever pull up\nthe help documentation for\n\n444\n00:22:27,235 --> 00:22:31,450\nAdd-DnsServerResourceRecord, you'll see\nall the other types that are out there.\n\n445\n00:22:31,450 --> 00:22:33,950\nBut the ones we've shown are the ones\nthat most people are going to work\n\n446\n00:22:33,950 --> 00:22:34,710\nwith on a regular basis.\n\n447\n00:22:36,570 --> 00:22:40,500\nAll right so in this segment, we got a\nchance to see creating those host records.\n\n448\n00:22:40,500 --> 00:22:43,502\nPutting it in place,\nverifying that it actually took effect,\n\n449\n00:22:43,502 --> 00:22:45,380\nthat they're there and\nthat they're working.\n\n450\n00:22:45,380 --> 00:22:48,290\nSo we saw several of different\nresource types that were out there.\n\n451\n00:22:48,290 --> 00:22:50,150\nKeep in mind that there are others\nthat you might want to learn about.\n\n452\n00:22:51,150 --> 00:22:53,188\nAll right,\nwell I hope you guys enjoyed that segment.\n\n453\n00:22:53,188 --> 00:22:58,659\nStay tuned,\nwe got more PowerShell, coming up.\n\n454\n00:22:58,659 --> 00:23:02,700\n[SOUND]\n\n",
          "vimeoId": "116357252"
        },
        {
          "description": "",
          "length": "474",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-4-monitoring_dns_status-0107015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-4-monitoring_dns_status-0107015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-3-4-monitoring_dns_status-0107015-sm.jpg",
          "title": "Monitoring DNS Status",
          "transcript": "1\n00:00:00,000 --> 00:00:08,333\n[MUSIC]\n\n2\n00:00:08,333 --> 00:00:09,099\nIn this segment,\n\n3\n00:00:09,099 --> 00:00:12,020\nwe're gonna take a look at monitoring\nthe status of our DNS server.\n\n4\n00:00:12,020 --> 00:00:15,190\nYou know, once we get DNS fired up and\nrunning, we get our zones created,\n\n5\n00:00:15,190 --> 00:00:17,670\nour records in there and\nit's working, that's great.\n\n6\n00:00:17,670 --> 00:00:20,670\nBut how do we keep an eye\non it performance-wise?\n\n7\n00:00:20,670 --> 00:00:23,030\nIf you're at the machine,\nyou could use your graphical utilities,\n\n8\n00:00:23,030 --> 00:00:24,110\nthings like a performance monitor.\n\n9\n00:00:24,110 --> 00:00:25,070\nThey're fine.\n\n10\n00:00:25,070 --> 00:00:28,540\nBut in the PowerShell, we've got a couple\nof neat commands that we can use.\n\n11\n00:00:28,540 --> 00:00:30,100\nSome of them, you guys are probably\nalready familiar with.\n\n12\n00:00:30,100 --> 00:00:34,890\nLike, if I just want to see if the service\nis running, I can do a Get-Service dns.\n\n13\n00:00:34,890 --> 00:00:36,850\nThat's not anything too exciting, here,\n\n14\n00:00:36,850 --> 00:00:39,430\nlet me fire that up,\nin a Powershell prompt.\n\n15\n00:00:40,430 --> 00:00:42,865\nAnd I'll just do Get-Service dns,\nand I can see it's running.\n\n16\n00:00:42,865 --> 00:00:43,440\nWoo-hoo!\n\n17\n00:00:43,440 --> 00:00:43,940\nRight?\n\n18\n00:00:43,940 --> 00:00:44,632\nWe're in business.\n\n19\n00:00:44,632 --> 00:00:46,340\n>> [LAUGH] It's a good start.\n\n20\n00:00:46,340 --> 00:00:49,750\n>> That's great, but wouldn't it be\ngreat to have better insight into what\n\n21\n00:00:49,750 --> 00:00:51,960\nthe server's actually doing.\n\n22\n00:00:51,960 --> 00:00:55,110\nAnd for that,\nwe've got a couple of other neat commands.\n\n23\n00:00:55,110 --> 00:00:57,200\n>> Got that good old Get-DnsServer.\n\n24\n00:00:57,200 --> 00:01:01,360\nAnd this command is gonna pull back all\nthe configurations on my DNS server.\n\n25\n00:01:01,360 --> 00:01:05,390\nYou get to see things like what my, I'm\ntrying to think of some of the good ones\n\n26\n00:01:05,390 --> 00:01:08,430\nwe use, like the socket pool size,\nand things like that.\n\n27\n00:01:08,430 --> 00:01:10,493\nI mean,\nit shows a ton of information in here.\n\n28\n00:01:10,493 --> 00:01:12,250\n>> I'm gonna pipe this\ninto the more command.\n\n29\n00:01:12,250 --> 00:01:14,371\n>> Yeah, probably a good idea.\n\n30\n00:01:14,371 --> 00:01:16,401\n[LAUGH]\n>> So Get-DnsServer,\n\n31\n00:01:16,401 --> 00:01:19,734\nit returns really information\nabout your server configuration.\n\n32\n00:01:19,734 --> 00:01:20,950\nRight?\n\n33\n00:01:20,950 --> 00:01:22,780\nAll the various that it's got configured,\n\n34\n00:01:22,780 --> 00:01:25,380\na lot of these are gonna be defaults\nthat you haven't messed with.\n\n35\n00:01:25,380 --> 00:01:28,130\nSome of them will be the other things\nthat maybe you have messed with.\n\n36\n00:01:28,130 --> 00:01:29,950\nThen you can go in there and evaluate.\n\n37\n00:01:29,950 --> 00:01:32,208\nYou guys see all the different\nthings we can query on.\n\n38\n00:01:32,208 --> 00:01:35,592\nSo if you're trying to verify\na server's configuration,\n\n39\n00:01:35,592 --> 00:01:38,361\nthis is the command for\nyou, Get-DnsServer.\n\n40\n00:01:38,361 --> 00:01:41,520\nAnd when Mike says there's a lot of\nstuff in there, he is not lying.\n\n41\n00:01:41,520 --> 00:01:44,270\nThere is a ton of information in here.\n\n42\n00:01:44,270 --> 00:01:46,292\nAs we scroll through,\nyou'll just see there is quite a bit.\n\n43\n00:01:46,292 --> 00:01:48,360\n>> I'm trying to think of some of\nthe things I've used this for.\n\n44\n00:01:48,360 --> 00:01:50,320\nPrimarily, one was the saga pool size,\n\n45\n00:01:50,320 --> 00:01:53,090\ncuz you can change the amount of\nports that are available for that.\n\n46\n00:01:53,090 --> 00:01:57,840\nThe other one is that caching right there,\nI think is, where is it?\n\n47\n00:01:57,840 --> 00:01:59,300\nNo, not the caching.\n\n48\n00:01:59,300 --> 00:02:01,910\nAnyway, there's a couple\nof them in there like the,\n\n49\n00:02:01,910 --> 00:02:04,584\noh how long it stays locked\nwhen you get cache, right?\n\n50\n00:02:04,584 --> 00:02:06,799\nCuz we can now change that\nlocking percentage, so\n\n51\n00:02:06,799 --> 00:02:09,720\nit's a quick easy command\nto see what it's set to.\n\n52\n00:02:09,720 --> 00:02:12,640\n>> Yeah, I know I've manipulated some\nof this like this max time to live.\n\n53\n00:02:12,640 --> 00:02:15,260\nSometimes you don't want to have\na time to live that's and entire day,\n\n54\n00:02:15,260 --> 00:02:16,500\nwhich is the default.\n\n55\n00:02:16,500 --> 00:02:17,850\nSo you can in and manipulate that.\n\n56\n00:02:17,850 --> 00:02:20,040\nAnd that way if you try and\ncache a record from the Internet, and\n\n57\n00:02:20,040 --> 00:02:22,840\nthey say that it's going to be 72 hours.\n\n58\n00:02:22,840 --> 00:02:24,580\nWell, if your server has\na maximum of 12 hours,\n\n59\n00:02:24,580 --> 00:02:26,770\nit will ignore the 72 and make it 12.\n\n60\n00:02:26,770 --> 00:02:27,420\nRight?\n\n61\n00:02:27,420 --> 00:02:28,625\nSo you can manipulate those things.\n\n62\n00:02:28,625 --> 00:02:30,620\nYou need to be able to verify\nthose settings right here.\n\n63\n00:02:30,620 --> 00:02:32,470\nIt's all kind of tucked away in it.\n\n64\n00:02:32,470 --> 00:02:35,100\nThere's a route hint servers\nthat are listed, and so on.\n\n65\n00:02:35,100 --> 00:02:36,260\nIt goes on and on.\n\n66\n00:02:36,260 --> 00:02:40,312\nSo quite a bit of data in there on\nthe configuration of your server.\n\n67\n00:02:40,312 --> 00:02:40,833\n>> All right.\n\n68\n00:02:40,833 --> 00:02:43,700\nAnd then we can change that to a\nSet-DnsServer if we want to modify some of\n\n69\n00:02:43,700 --> 00:02:44,500\nthose parameters.\n\n70\n00:02:44,500 --> 00:02:45,550\n>> Yeah.\n\n71\n00:02:45,550 --> 00:02:51,160\nAnother one that we've got\nis Get-DnsServerStatistics.\n\n72\n00:02:51,160 --> 00:02:53,900\n>> This is a new one that came out\nrecently, when they added a bunch of new\n\n73\n00:02:53,900 --> 00:02:57,960\ncommands to the DNS module, and this one\npulls back a lot of information as well.\n\n74\n00:02:59,095 --> 00:02:59,915\n>> Now when you run it,\n\n75\n00:02:59,915 --> 00:03:04,525\nthe default is going to give you\nstatistics on the DNS server as a whole.\n\n76\n00:03:04,525 --> 00:03:06,645\nAnd that [LAUGH] can be\na ton of information.\n\n77\n00:03:06,645 --> 00:03:07,896\nSome of it's pretty handy,\n\n78\n00:03:07,896 --> 00:03:11,293\nyou can see how long it's been since\nthe last time the statistics were reset.\n\n79\n00:03:11,293 --> 00:03:15,498\nAnd then you can start to see information\nabout how many queries it's handled,\n\n80\n00:03:15,498 --> 00:03:19,137\nyou know what it's response times are,\nany other information, and\n\n81\n00:03:19,137 --> 00:03:21,730\nit is screen after screen\nafter screen of stuff.\n\n82\n00:03:21,730 --> 00:03:22,970\nIt can be quite a bit.\n\n83\n00:03:22,970 --> 00:03:25,460\n>> And if you have multiple\nzones on that DNS server,\n\n84\n00:03:25,460 --> 00:03:26,630\nthis is just gonna summarize it.\n\n85\n00:03:26,630 --> 00:03:29,910\nSo it's going to take all the information\nfrom all the zones and summarize and\n\n86\n00:03:29,910 --> 00:03:30,650\ngive you one report back.\n\n87\n00:03:31,660 --> 00:03:34,060\nBut we can also throw in a name of a zone.\n\n88\n00:03:34,060 --> 00:03:37,720\nWhat if we want to see the statistics\non a particular zone that this DNS\n\n89\n00:03:37,720 --> 00:03:38,780\nserver is handling?\n\n90\n00:03:38,780 --> 00:03:41,440\nAll we have to do is do that same\ncommand and then do a dash zone name,\n\n91\n00:03:41,440 --> 00:03:44,950\ntype in the name of the zone, and\nnow we're seeing zone specific statistics.\n\n92\n00:03:46,160 --> 00:03:47,610\n>> Yep.\nSo that kind of filters things out.\n\n93\n00:03:47,610 --> 00:03:51,290\nThat's good, because a lot of those\nscreens are caching related, and\n\n94\n00:03:51,290 --> 00:03:53,070\nwe don't necessarily need to see\nthose when we're looking for\n\n95\n00:03:53,070 --> 00:03:55,400\ninformation on a particular zone.\n\n96\n00:03:55,400 --> 00:03:57,960\nSo I can see this zone has\nhandled a whopping five queries,\n\n97\n00:03:57,960 --> 00:03:59,420\nit's running here on my laptop.\n\n98\n00:03:59,420 --> 00:04:00,260\n>> [LAUGH]\n>> [LAUGH] So we're not gonna see\n\n99\n00:04:00,260 --> 00:04:01,240\na ton of stuff there.\n\n100\n00:04:01,240 --> 00:04:02,550\nQueries that I've responded to.\n\n101\n00:04:02,550 --> 00:04:04,550\nQuery failures, right?\n\n102\n00:04:04,550 --> 00:04:07,043\nWe can see other things like\nthose are just the A records.\n\n103\n00:04:07,043 --> 00:04:09,920\nI can see the quad A records,\npointers, CName.\n\n104\n00:04:09,920 --> 00:04:12,590\nI'm getting statistics for\neach of these, so\n\n105\n00:04:12,590 --> 00:04:15,550\nI can get an idea of how much traffic\nthis server has been handling, and\n\n106\n00:04:15,550 --> 00:04:18,505\nit breaks all of those out into\nthe individual record types.\n\n107\n00:04:18,505 --> 00:04:19,400\nRight?\n\n108\n00:04:19,400 --> 00:04:23,160\nAnd so past that I start to get the zone\ntransfer information this AXFR and\n\n109\n00:04:23,160 --> 00:04:25,600\nIXFR, those are my zone transfers.\n\n110\n00:04:25,600 --> 00:04:27,270\nSo, I can see how much have I send out,\n\n111\n00:04:27,270 --> 00:04:31,560\nhow much have I received, how much\ndata really is this server moving.\n\n112\n00:04:31,560 --> 00:04:32,330\n>> Absolutely.\n\n113\n00:04:32,330 --> 00:04:34,950\n>> And so, it all gets laid out there,\nand it's pretty handy.\n\n114\n00:04:34,950 --> 00:04:37,280\nThe only problem is, the statistics,\n\n115\n00:04:37,280 --> 00:04:40,800\nthey've really been running since\nDNS was installed in this server.\n\n116\n00:04:40,800 --> 00:04:44,540\nSo if you've got a DNS server that's been\nup for a year, you're seeing information\n\n117\n00:04:44,540 --> 00:04:49,160\nabout how much that server's done in\nthat year, you might want to clear out\n\n118\n00:04:49,160 --> 00:04:52,580\nthe statistics to start from scratch and\nsay, I just want to see the last 24 hours.\n\n119\n00:04:52,580 --> 00:04:55,730\nSo let's clear it out, let it run for\n24 hours, and then look.\n\n120\n00:04:55,730 --> 00:04:58,910\nSo you might need to wipe those\nstatistics from time to time, and\n\n121\n00:04:58,910 --> 00:05:04,750\nyou do that with the, actually\nwith the Get-DnsServer statistics.\n\n122\n00:05:04,750 --> 00:05:08,270\nIt's one of those weird times where\nthe get command can actually do something.\n\n123\n00:05:08,270 --> 00:05:12,042\n>> Yeah, it's gonna return all of\nthe information at the same time, wipe it.\n\n124\n00:05:12,042 --> 00:05:13,930\nSo it might be something\nyou wanna pipe out,\n\n125\n00:05:13,930 --> 00:05:15,975\nlike we saw in a couple\nof the other segments.\n\n126\n00:05:15,975 --> 00:05:20,190\nPipe that result out to a text file or\nsomething to save that information.\n\n127\n00:05:20,190 --> 00:05:24,600\nSo if I add dash clear to the end of it,\nright, that's gonna wipe those statistics\n\n128\n00:05:24,600 --> 00:05:29,230\nand now when I pull it back up, see all\nmy queries have been reset to zeroes.\n\n129\n00:05:29,230 --> 00:05:33,620\nJust by adding that dash clear, that reset\nit and now as we start to do look ups.\n\n130\n00:05:33,620 --> 00:05:38,602\nSo if I start looking up\nlike donlaptop.lab.itpro.tv,\n\n131\n00:05:38,602 --> 00:05:41,000\nagainst my server, right?\n\n132\n00:05:41,000 --> 00:05:42,633\nSo I'll do a couple other queries,\n\n133\n00:05:42,633 --> 00:05:47,060\nactually I'm probably gonna start pulling\nthose off of my own local cache, won't I?\n\n134\n00:05:47,060 --> 00:05:48,875\nWell no,\nI don't think nslookup ever does that.\n\n135\n00:05:48,875 --> 00:05:49,914\nWell, we can find out.\n\n136\n00:05:49,914 --> 00:05:51,458\n>> [CROSSTALK] Nslookup\nshould bypass the cache.\n\n137\n00:05:51,458 --> 00:05:52,420\nThere we go.\n\n138\n00:05:52,420 --> 00:05:55,520\nAnd so I can see there are those four\nqueries that I just ran right there.\n\n139\n00:05:55,520 --> 00:05:57,167\nI can see it, they did the look ups.\n\n140\n00:05:57,167 --> 00:06:00,597\nIt did the look up for the four A record\nalso, because I gave it a name and\n\n141\n00:06:00,597 --> 00:06:01,833\nthere are multiple IPs.\n\n142\n00:06:01,833 --> 00:06:04,282\nSo it shows up, but\neverything else is still zeroed out,\n\n143\n00:06:04,282 --> 00:06:05,667\ncuz I haven't looked those up.\n\n144\n00:06:05,667 --> 00:06:06,730\nAll right.\n\n145\n00:06:06,730 --> 00:06:09,612\nSo, couple of good ways to\nsee the statistics there.\n\n146\n00:06:09,612 --> 00:06:12,125\nNow you could use your\nperformance monitor, right?\n\n147\n00:06:12,125 --> 00:06:15,084\nYour service profile.\n\n148\n00:06:15,084 --> 00:06:18,042\nThere's all those different tools out\nthere that monitor it with a GUI.\n\n149\n00:06:18,042 --> 00:06:21,727\nAnd they give you a lot of power in\nlogging and so on, but if you just want\n\n150\n00:06:21,727 --> 00:06:26,150\nquick and easy, look at it, get some\ninformation, Get-DnsServerStatistics.\n\n151\n00:06:26,150 --> 00:06:27,062\nIt's a great utility for you.\n\n152\n00:06:27,062 --> 00:06:28,458\nAll right.\n\n153\n00:06:28,458 --> 00:06:31,368\nSo in this segment we got a chance\nto see a few different ways to\n\n154\n00:06:31,368 --> 00:06:34,870\nmonitor performance on our servers,\nstatistics on our server.\n\n155\n00:06:34,870 --> 00:06:38,025\nWe saw Get-Service,\njust to make sure the service was running.\n\n156\n00:06:38,025 --> 00:06:41,316\nGet-DnsServer to look at\nthe configuration and\n\n157\n00:06:41,316 --> 00:06:46,542\nGet-DnsServerStatistics to look at\nour actual performance information.\n\n158\n00:06:46,542 --> 00:06:51,319\nOne other thing if you guys want to learn\na little bit more, Mike was showing me\n\n159\n00:06:51,319 --> 00:06:55,950\nright before the show that with\na Get-DnsServer, you can actually export\n\n160\n00:06:55,950 --> 00:07:01,123\nthat XML to back up that configuration and\nrestore it on another server if you want.\n\n161\n00:07:01,123 --> 00:07:02,410\nSo there's some neat utilities out there.\n\n162\n00:07:02,410 --> 00:07:03,750\nMike, do you remember\nwhat that command was?\n\n163\n00:07:03,750 --> 00:07:06,944\n>> It was,\nyou could do that same Get-DnsServer, and\n\n164\n00:07:06,944 --> 00:07:09,122\nthen you do an Export-Clixml, and\n\n165\n00:07:09,122 --> 00:07:14,292\nthat's gonna generate an XML file with all\nthe configuration from that DNS server.\n\n166\n00:07:14,292 --> 00:07:17,339\nSo as Don was saying, I can use it as\na backup, if I ever have a problem,\n\n167\n00:07:17,339 --> 00:07:18,960\nI can restore my server.\n\n168\n00:07:18,960 --> 00:07:22,650\nOr if I wanna set up another DNS server\nwith those same configurations, I can use\n\n169\n00:07:22,650 --> 00:07:26,990\nthat XML file, that it generated, to\nmove those settings to a new DNS server.\n\n170\n00:07:26,990 --> 00:07:28,160\n>> Yeah, so pretty cool stuff there.\n\n171\n00:07:28,160 --> 00:07:30,870\nYou know PowerShell has\na lot of power to it.\n\n172\n00:07:30,870 --> 00:07:32,509\nEvery time we say there's\na command missing,\n\n173\n00:07:32,509 --> 00:07:35,083\nwell there's like 15 other awesome\ncommands that are already there.\n\n174\n00:07:35,083 --> 00:07:38,250\nSo it's just a matter of figuring\nthem out and putting them to use.\n\n175\n00:07:38,250 --> 00:07:38,876\n>> It is.\n\n176\n00:07:38,876 --> 00:07:41,195\n>> All right.\nWell, that's about it for\n\n177\n00:07:41,195 --> 00:07:43,510\nmonitoring DNS statistics.\n\n178\n00:07:43,510 --> 00:07:45,070\nHope you guys enjoyed the segment.\n\n179\n00:07:45,070 --> 00:07:48,042\nStay tuned, we've got more\nPowerShell coming down the line.\n\n180\n00:07:48,042 --> 00:07:53,984\n{MUSIC]\n\n",
          "vimeoId": "116357255"
        }
      ],
      "title": "DNS"
    },
    {
      "episodes": [
        {
          "description": "",
          "length": "225",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-1-installing_dhcp_server-0108015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-1-installing_dhcp_server-0108015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-1-installing_dhcp_server-0108015-sm.jpg",
          "title": "Installing DHCP Server",
          "transcript": "1\n00:00:00,000 --> 00:00:08,378\n[MUSIC]\n\n2\n00:00:08,378 --> 00:00:11,836\nIn this segment, we're going to take\na look at installing DHCP server,\n\n3\n00:00:11,836 --> 00:00:14,020\nusing the Microsoft Power Shell.\n\n4\n00:00:14,020 --> 00:00:16,440\nIt's not really any different\nthan any other role or feature.\n\n5\n00:00:16,440 --> 00:00:17,770\nIt's a pretty straight forward install.\n\n6\n00:00:17,770 --> 00:00:19,110\nThis'll be a short segment.\n\n7\n00:00:19,110 --> 00:00:20,220\nBut we need to see it nonetheless.\n\n8\n00:00:20,220 --> 00:00:21,760\nIf you're going to set up a DHCP server,\n\n9\n00:00:21,760 --> 00:00:24,380\nthis is really going\nto be step number one.\n\n10\n00:00:24,380 --> 00:00:27,540\nWell, step number one I guess\nafter getting a server, right?\n\n11\n00:00:27,540 --> 00:00:29,590\nProbably have to have a server\nsomewhere to do this.\n\n12\n00:00:29,590 --> 00:00:34,330\nBut to add the DHCP server functionality\nto a Windows server machine.\n\n13\n00:00:34,330 --> 00:00:38,100\nWe just use the add Windows feature\ncommand line that we've seen for\n\n14\n00:00:38,100 --> 00:00:39,370\npretty much every other role.\n\n15\n00:00:39,370 --> 00:00:41,930\nSo I'm going to fire up my PowerShell,\nand I'm gonna have at it.\n\n16\n00:00:41,930 --> 00:00:44,910\nWell, I guess before I do that\nmaybe I should verify whether or\n\n17\n00:00:44,910 --> 00:00:46,450\nnot I'm actually running DHCP server.\n\n18\n00:00:46,450 --> 00:00:48,040\n>> That's a good idea.\n\n19\n00:00:48,040 --> 00:00:50,160\nInstead of an install we\ncould do a get command.\n\n20\n00:00:50,160 --> 00:00:50,660\n>> Yeah.\n\n21\n00:00:52,220 --> 00:00:54,050\nSo, we'll just do a get-windowsfeature and\n\n22\n00:00:54,050 --> 00:00:56,760\nif I just run that by itself,\nman do you get some outputs.\n\n23\n00:00:56,760 --> 00:00:59,758\nSo, I'm gonna make sure to qualify\nthat and just stick dhcp on the end.\n\n24\n00:00:59,758 --> 00:01:02,385\nI'll say get-windowsfeature dhcp.\n\n25\n00:01:02,385 --> 00:01:07,265\nThat'll run pretty quick, and there I\ncan see DHCP Server is recognized, but\n\n26\n00:01:07,265 --> 00:01:08,045\nit's not installed.\n\n27\n00:01:08,045 --> 00:01:09,875\nIt's got an empty little box right there.\n\n28\n00:01:09,875 --> 00:01:11,385\nInstall state is available.\n\n29\n00:01:11,385 --> 00:01:14,136\nIt's available to be installed, but\nit's not actually installed yet.\n\n30\n00:01:14,136 --> 00:01:15,464\n>> Let's do it.\n\n31\n00:01:15,464 --> 00:01:20,332\n>> So we'll just go ahead and\nsay add-windowsFeature dhcp.\n\n32\n00:01:20,332 --> 00:01:22,372\nThat's all we need to\ndo to do the install.\n\n33\n00:01:22,372 --> 00:01:25,532\nNow, if I'm on a server\nthat's a core server install.\n\n34\n00:01:25,532 --> 00:01:29,296\nSo no GUI,\nthat's really all I need to run.\n\n35\n00:01:29,296 --> 00:01:31,936\n>> Right?\n>> But I'm on a full install, and so\n\n36\n00:01:31,936 --> 00:01:34,436\nI might want to install\nthe management tools also.\n\n37\n00:01:34,436 --> 00:01:38,476\nIt doesn't do that by default, so I may\nneed to add a little bit more to this.\n\n38\n00:01:38,476 --> 00:01:41,713\nTo say, include management tools.\n\n39\n00:01:42,783 --> 00:01:44,073\nSo that it knows to put those on there.\n\n40\n00:01:44,073 --> 00:01:45,463\nAnd I'll get the graphical tools also.\n\n41\n00:01:45,463 --> 00:01:48,643\nIf we're just working in PowerShell\nwe don't care about that.\n\n42\n00:01:48,643 --> 00:01:51,233\nbut in my case we'll go ahead and do it.\n\n43\n00:01:51,233 --> 00:01:53,240\nAll right.\nSo we'll run that and it'll install.\n\n44\n00:01:53,240 --> 00:01:55,170\nDoesn't take terribly long to do it,\nright.\n\n45\n00:01:55,170 --> 00:01:57,162\nDHCP's not the biggest of services.\n\n46\n00:01:57,162 --> 00:01:58,190\n>> Right.\nThat's what I always tell people.\n\n47\n00:01:58,190 --> 00:02:00,180\nYou know,\ninstalling the roles is very easy.\n\n48\n00:02:00,180 --> 00:02:02,030\nIt's configuring the roles after the fact,\nand\n\n49\n00:02:02,030 --> 00:02:03,920\nmaking it do what you need\nit to do on your network.\n\n50\n00:02:03,920 --> 00:02:06,150\nThat's where the skill set\nreally comes into play.\n\n51\n00:02:06,150 --> 00:02:08,950\n>> Yeah.\nOnce this is done, you know what,\n\n52\n00:02:08,950 --> 00:02:10,040\nif you had to describe it, Mike.\n\n53\n00:02:10,040 --> 00:02:13,720\nWhat exactly would the DHCP server\ndo after this install is done?\n\n54\n00:02:13,720 --> 00:02:14,830\n>> Absolutely nothing.\n\n55\n00:02:14,830 --> 00:02:15,690\n>> Absolutely nothing.\n\n56\n00:02:15,690 --> 00:02:17,360\nYeah, it's non functional.\n\n57\n00:02:17,360 --> 00:02:21,130\nThere is a lot more to do, but\nthe install is pretty straight forward.\n\n58\n00:02:21,130 --> 00:02:22,620\nAnd you know I say it\ndoesn't take to long.\n\n59\n00:02:22,620 --> 00:02:25,100\nIn typical Microsoft fashion it\njumps to 92% and then sits there.\n\n60\n00:02:25,100 --> 00:02:26,050\n>> And it just stops.\n\n61\n00:02:26,050 --> 00:02:27,570\n>> So there we go.\n\n62\n00:02:27,570 --> 00:02:29,190\nI can see that it did finish the install.\n\n63\n00:02:29,190 --> 00:02:30,530\nSuccess is true.\n\n64\n00:02:30,530 --> 00:02:31,730\nRestart needed, no.\n\n65\n00:02:31,730 --> 00:02:32,940\nSo I don't need to reboot.\n\n66\n00:02:32,940 --> 00:02:33,720\nThat's kind of nice.\n\n67\n00:02:33,720 --> 00:02:34,850\nI got a success.\n\n68\n00:02:34,850 --> 00:02:38,200\nIf I just want to do a double\nsuper secret verification.\n\n69\n00:02:38,200 --> 00:02:43,090\nI can go a get-windowsfeature dhcp,\nand this time we should see that\n\n70\n00:02:43,090 --> 00:02:46,570\nit's got a little check mark letting us\nknow that it's installed on X, I think.\n\n71\n00:02:46,570 --> 00:02:47,270\nAn X.\n\n72\n00:02:47,270 --> 00:02:49,580\nAnd then over here,\ninstall state is installed.\n\n73\n00:02:49,580 --> 00:02:50,590\nSo I've got it.\n\n74\n00:02:50,590 --> 00:02:55,630\nAnd I could even go a little bit\nfurther and do a get-service.\n\n75\n00:02:55,630 --> 00:02:57,330\nWell that really didn't pan out, did it?\n\n76\n00:02:57,330 --> 00:02:58,950\nThere, get-service DHCP.\n\n77\n00:02:58,950 --> 00:03:01,090\nAnd I can see, oh,\nthat's my client though.\n\n78\n00:03:01,090 --> 00:03:05,410\nShoot, let me just add a star on that.\n\n79\n00:03:05,410 --> 00:03:08,270\nThere we go.\nGet-Service DHCP Server is what\n\n80\n00:03:08,270 --> 00:03:09,110\nit's actually called.\n\n81\n00:03:09,110 --> 00:03:11,420\nAnd I can see the server is there,\nand it's running.\n\n82\n00:03:11,420 --> 00:03:14,590\nSo we're installed,\nwe are now a DHCP server.\n\n83\n00:03:14,590 --> 00:03:15,710\nAlbeit, not a very functional one.\n\n84\n00:03:15,710 --> 00:03:17,070\n>> Right.\n\n85\n00:03:17,070 --> 00:03:19,580\n>> All right, so like I said,\npretty short segment on this one.\n\n86\n00:03:19,580 --> 00:03:24,550\nWhat we just saw was installing\nDHCP server using the PowerShell.\n\n87\n00:03:24,550 --> 00:03:27,525\nNow if you're asking yourself why did I\njust waste my time watching this episode?\n\n88\n00:03:27,525 --> 00:03:29,614\n>> [LAUGH]\n>> Well it is important, but keep in mind,\n\n89\n00:03:29,614 --> 00:03:33,089\nwe're right about to follow that up with\nmore segments covering how to get it\n\n90\n00:03:33,089 --> 00:03:34,686\nconfigured and actually useful.\n\n91\n00:03:34,686 --> 00:03:36,392\nSo definitely stay tuned for that.\n\n92\n00:03:36,392 --> 00:03:39,298\nThere's more PowerShell coming up.\n\n93\n00:03:39,298 --> 00:03:45,349\n[MUSIC]\n\n",
          "vimeoId": "116358130"
        },
        {
          "description": "",
          "length": "342",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-2-authorizing_dhcp_server-0108015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-2-authorizing_dhcp_server-0108015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-2-authorizing_dhcp_server-0108015-sm.jpg",
          "title": "Authorizing DHCP Server",
          "transcript": "1\n00:00:00,000 --> 00:00:04,900\n[SOUND] In this segment, we're gonna\n\n2\n00:00:04,900 --> 00:00:10,273\ntake a look at an often overlooked step,\n\n3\n00:00:10,273 --> 00:00:15,184\nwhich is authorizing a DHCP server.\n\n4\n00:00:15,184 --> 00:00:19,882\nNow, we have to authorize a DHCP server\nif we have a Windows DHCP server in\n\n5\n00:00:19,882 --> 00:00:22,040\na domain environment.\n\n6\n00:00:22,040 --> 00:00:23,630\nWhen you have the active\ndirectory present,\n\n7\n00:00:23,630 --> 00:00:27,190\nit will purposefully suppress\nany DHCP server you bring up.\n\n8\n00:00:27,190 --> 00:00:29,670\nIt will not allow it to\nfunction unless it's\n\n9\n00:00:29,670 --> 00:00:31,890\nbeen authorized by\na network administrator.\n\n10\n00:00:31,890 --> 00:00:34,375\nThis is something really easy\nto overlook from the PowerShell.\n\n11\n00:00:34,375 --> 00:00:38,585\nIn the GUI when you're setting this up,\nyou get little red flags, warning messages\n\n12\n00:00:38,585 --> 00:00:42,045\nthat you're not authorized, but\nfrom the PowerShell you don't get those.\n\n13\n00:00:42,045 --> 00:00:44,915\nSo if you just installed your DHCP server,\nit's not gonna function.\n\n14\n00:00:44,915 --> 00:00:48,260\nYou might set up your scopes, your\nexclusions, and all that, and it won't\n\n15\n00:00:48,260 --> 00:00:52,050\nfunction until you authorize it, so\nwe definitely need to take a look at that.\n\n16\n00:00:52,050 --> 00:00:56,100\n>> And Active Directory maintains a list\nof authorized DHCP servers, so really all\n\n17\n00:00:56,100 --> 00:00:59,760\nwe're doing is we're adding the name of an\nIP address for this server to that list.\n\n18\n00:00:59,760 --> 00:01:03,870\nAnd then every time that machine starts\nup, every time DHCP service starts up,\n\n19\n00:01:03,870 --> 00:01:06,130\nit queries Active Directory and\nsays, hey let me look at that list.\n\n20\n00:01:06,130 --> 00:01:10,270\nAm I in that list and if it's not in\nthe list, the service will start up, but\n\n21\n00:01:10,270 --> 00:01:13,070\nit will report an error, and\nit just won't service clients.\n\n22\n00:01:13,070 --> 00:01:14,313\n>> Yeah and\nI'm glad you mentioned that, Mike.\n\n23\n00:01:14,313 --> 00:01:15,172\nLet's take a look at that list.\n\n24\n00:01:15,172 --> 00:01:18,100\nWe can actually pull the list of\nDHCP servers that are approved.\n\n25\n00:01:18,100 --> 00:01:19,919\nI'm gonna see if I'm in that list.\n\n26\n00:01:21,080 --> 00:01:23,540\nThe command for it is,\nits not very intuitive,\n\n27\n00:01:23,540 --> 00:01:26,960\nbecause youd think it would have\nauthorize in the name, but it doesnt.\n\n28\n00:01:26,960 --> 00:01:30,997\nSo Im gonna say Get-DHCPServerInDC.\n\n29\n00:01:30,997 --> 00:01:34,381\nAll right, in other words,\nreach out to a domain controller, and\n\n30\n00:01:34,381 --> 00:01:36,670\nsee what DHCP servers are listed.\n\n31\n00:01:36,670 --> 00:01:38,655\nNow, if you run it and\nyou get nothing back,\n\n32\n00:01:38,655 --> 00:01:40,864\nthat means you have no\nauthorized DHCP servers.\n\n33\n00:01:40,864 --> 00:01:44,232\nIf you do have some DHCP servers out\nthere, they'll be listed right here, and\n\n34\n00:01:44,232 --> 00:01:46,950\nyou can see which servers\nare already authorized, all right.\n\n35\n00:01:46,950 --> 00:01:51,800\nIn my case, I've installed DHCP,\nor at least I think I have.\n\n36\n00:01:51,800 --> 00:01:56,520\nIf I do get Windows feature DHCP, let's\nsee if I've actually got it installed.\n\n37\n00:01:56,520 --> 00:01:58,913\nSo I should have DHCP installed.\n\n38\n00:01:58,913 --> 00:02:03,260\nYeah, I do, but I'm not gonna function\nunless I authorize the server, so\n\n39\n00:02:03,260 --> 00:02:05,930\nlet's get this thing authorized.\n\n40\n00:02:05,930 --> 00:02:09,060\nNow authorizing it is not hard, but\n\n41\n00:02:09,060 --> 00:02:12,740\nit is easy to forget, and\nthe command is a little bit long.\n\n42\n00:02:12,740 --> 00:02:17,586\nWhat we need to do is\nsay Add-DHCPServerInDC,\n\n43\n00:02:17,586 --> 00:02:22,160\nall right, and then we need to provide\nthe information about this system.\n\n44\n00:02:22,160 --> 00:02:27,165\nSo I am gonna do the DNS name for\nthis server, and mine is server01.,\n\n45\n00:02:27,165 --> 00:02:31,650\noh shoot,\nI've actually forgotten what my domain is.\n\n46\n00:02:33,620 --> 00:02:35,078\n[LAUGH] That's always convenient,\nisn't it?\n\n47\n00:02:35,078 --> 00:02:39,450\nLet's see, I think I am lab.itpro.tv.\n\n48\n00:02:39,450 --> 00:02:41,250\nLet me just pull that up.\n\n49\n00:02:41,250 --> 00:02:45,280\nI'm sure there's twenty easier ways to\ndo this than the way that I'm doing it.\n\n50\n00:02:45,280 --> 00:02:47,420\nBut, where's my fully\nqualified domain name?\n\n51\n00:02:47,420 --> 00:02:47,961\nI thought it was in here.\n\n52\n00:02:47,961 --> 00:02:48,762\n>> I'm looking.\n\n53\n00:02:48,762 --> 00:02:51,220\nI don't see her yet.\n\n54\n00:02:51,220 --> 00:02:53,480\n>> Well, shoot.\n>> IP config all, just do a little.\n\n55\n00:02:53,480 --> 00:02:56,190\n>> Oh yeah it is in there, isn't it?\n\n56\n00:02:56,190 --> 00:02:58,130\nAs I go into the wrong window here.\n\n57\n00:02:58,130 --> 00:03:00,410\nWe do need our fully qualified\ndomain name, though, or\n\n58\n00:03:00,410 --> 00:03:02,430\nit's not gonna work out too well for us.\n\n59\n00:03:02,430 --> 00:03:04,490\nPretty sure it's lab.itpro.tv.\n\n60\n00:03:04,490 --> 00:03:06,912\nIf you get it wrong, it's not going to\nwork, so we do need to get it right.\n\n61\n00:03:06,912 --> 00:03:07,737\nOh, just itprotv.net.\n\n62\n00:03:07,737 --> 00:03:08,632\nSee, I'm glad I checked.\n\n63\n00:03:08,632 --> 00:03:09,759\nThere we go.\n\n64\n00:03:09,759 --> 00:03:14,325\nSo, I'm gonna say -dnsname\nserver01.itprotv.net, so\n\n65\n00:03:14,325 --> 00:03:16,820\nthat's my DHCP server.\n\n66\n00:03:16,820 --> 00:03:20,470\nAnd I'm gonna give it its IP address,\nalso.\n\n67\n00:03:20,470 --> 00:03:24,403\nAnd the IP address for this server,\nI guess I need to know that also.\n\n68\n00:03:24,403 --> 00:03:30,688\nAnd I should be able to find out right\nhere in the same screen, 192.168.29.3.\n\n69\n00:03:30,688 --> 00:03:32,241\nSo I'll punch that in, and\n\n70\n00:03:32,241 --> 00:03:36,099\nI'll probably need an extra little\nspace in there to make it happy.\n\n71\n00:03:36,099 --> 00:03:40,608\nAll right, now when I specify this,\nI'm just gonna be adding this server\n\n72\n00:03:40,608 --> 00:03:44,550\nto the list, the DNS name and\nIP address to the authorized side.\n\n73\n00:03:44,550 --> 00:03:48,620\nNow I need to be a domain administrator\nfor this to work, and I am,\n\n74\n00:03:48,620 --> 00:03:51,190\nand I launch my PowerShell with\nadministrative privileges.\n\n75\n00:03:51,190 --> 00:03:54,060\nIf I'm not a domain admin,\nI can't run that command.\n\n76\n00:03:54,060 --> 00:03:56,290\nI can't authorize a DHCP server,\nso that's important.\n\n77\n00:03:58,370 --> 00:04:00,890\n>> So now we should be able to go get\nthat list again, and see if we show up.\n\n78\n00:04:00,890 --> 00:04:01,490\n>> Yeah, so\n\n79\n00:04:01,490 --> 00:04:06,690\nif I run that get-windowsFeature dhcp,\noops, sorry, not that one.\n\n80\n00:04:06,690 --> 00:04:08,140\nWe already knew it was installed.\n\n81\n00:04:08,140 --> 00:04:14,670\nI want to run the get-dhcpServerInDC,\nwhich I thought was in my history.\n\n82\n00:04:14,670 --> 00:04:15,742\nThere it is.\nAnd now it runs, and\n\n83\n00:04:15,742 --> 00:04:18,677\ninstead of getting an empty return,\nI actually get an entry.\n\n84\n00:04:18,677 --> 00:04:22,670\nI see 192.168.29.3 is right there.\n\n85\n00:04:22,670 --> 00:04:26,422\nIt's authorized and\nit's mapped to server 01.itprotv.net.\n\n86\n00:04:26,422 --> 00:04:29,020\nAll right, we're authorized.\n\n87\n00:04:29,020 --> 00:04:32,090\nNow, we're ready to start\nusing that DHCP server.\n\n88\n00:04:32,090 --> 00:04:36,000\nIf we don't do this,\nwe will not issue out IP addresses, and\n\n89\n00:04:36,000 --> 00:04:38,910\nit's super easy to overlook that from\nthe PowerShell, so real important.\n\n90\n00:04:40,090 --> 00:04:40,730\nAll right.\n\n91\n00:04:40,730 --> 00:04:43,860\nIf we ever want to deauthorize a server,\nlike we're decommissioning it,\n\n92\n00:04:43,860 --> 00:04:46,450\ngetting it out of there,\nthe command is really the same.\n\n93\n00:04:46,450 --> 00:04:54,790\nExcept instead of Add-DhcpServerInDC,\nyou would just say remove.\n\n94\n00:04:54,790 --> 00:04:58,628\nAnd if we say remove that same command,\nit'll take it out and\n\n95\n00:04:58,628 --> 00:05:00,260\ndeauthorize that server.\n\n96\n00:05:00,260 --> 00:05:03,710\nAnd the server doesn't have to be\nonline to deauthorize it, so if you've\n\n97\n00:05:03,710 --> 00:05:06,780\nalready gotten rid of that DHCP server,\nand it's still just kind of sitting around\n\n98\n00:05:06,780 --> 00:05:10,360\nauthorized even though it no longer\nexists, you can go to another server or\n\n99\n00:05:10,360 --> 00:05:13,042\nyour work station and run this and\nthat would deauthorize it.\n\n100\n00:05:13,042 --> 00:05:17,310\nAll right, well,\nin this segment we got a chance to see\n\n101\n00:05:17,310 --> 00:05:20,340\nauthorizing that DHCP server\nto get it functional.\n\n102\n00:05:20,340 --> 00:05:21,710\nNow, it's up and running.\n\n103\n00:05:21,710 --> 00:05:25,350\nSo if you've been following all of our\nsegments in order, we've installed DHCP.\n\n104\n00:05:25,350 --> 00:05:26,740\nWe've authorized it.\n\n105\n00:05:26,740 --> 00:05:29,860\nThe next steps for\nus are gonna be creating our scopes and\n\n106\n00:05:29,860 --> 00:05:31,805\ngetting this thing actually\ndoing something useful.\n\n107\n00:05:31,805 --> 00:05:33,710\n>> Right.\n>> So that's what's coming up next.\n\n108\n00:05:33,710 --> 00:05:34,419\nBe sure to stay tuned.\n\n109\n00:05:34,419 --> 00:05:37,088\nWe've got more PowerShell coming up next.\n\n110\n00:05:37,088 --> 00:05:42,373\n[SOUND]\n\n",
          "vimeoId": "116358131"
        },
        {
          "description": "",
          "length": "775",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-3-managing_scopes-0108015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-3-managing_scopes-0108015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-3-managing_scopes-0108015-sm.jpg",
          "title": "Managing Scopes",
          "transcript": "1\n00:00:00,000 --> 00:00:05,969\n[MUSIC]\n\n2\n00:00:08,232 --> 00:00:09,148\nIn this segment,\n\n3\n00:00:09,148 --> 00:00:13,390\nwe're gonna take a look at managing\nscopes inside of the DHCP server.\n\n4\n00:00:13,390 --> 00:00:15,366\nOnce you get a DHCP server up and running,\n\n5\n00:00:15,366 --> 00:00:18,418\nit's not particularly useful\nuntil we actually put some scopes\n\n6\n00:00:18,418 --> 00:00:21,317\nin there to tell it what addresses\nit's allowed to hand out.\n\n7\n00:00:21,317 --> 00:00:24,250\nThat's a pretty important step and\nyou don't just provide a,\n\n8\n00:00:24,250 --> 00:00:26,850\nwell I guess you could just\nprovide a range of IP's, but\n\n9\n00:00:26,850 --> 00:00:30,307\nthere's normally other things we\nprovide along with it to customize it.\n\n10\n00:00:30,307 --> 00:00:31,540\n>> Absolutely.\n\n11\n00:00:31,540 --> 00:00:35,440\nOnce we've authorized it It's allowed to\npass out IP addresses on the network now,\n\n12\n00:00:35,440 --> 00:00:37,570\nbut if it doesn't have a pool\nof addresses to pass out,\n\n13\n00:00:37,570 --> 00:00:39,050\nit's not gonna be able to do it.\n\n14\n00:00:39,050 --> 00:00:41,940\nAnd then our scope has a whole bunch\nof properties that we can associate\n\n15\n00:00:41,940 --> 00:00:43,470\nwith it that we'll go\nthrough here with PowerShell.\n\n16\n00:00:44,470 --> 00:00:47,480\n>> All right, so let's just start\nout with getting a scope created.\n\n17\n00:00:47,480 --> 00:00:52,410\nIt's pretty easy, we've got a command\nwhich is the Add-DhcpServerScope.\n\n18\n00:00:52,410 --> 00:00:56,860\nNow there is a little bit more to it\nnow because we have IPv4 scopes and\n\n19\n00:00:56,860 --> 00:00:59,060\nIPv6 scopes.\n\n20\n00:00:59,060 --> 00:01:03,584\nSo the command is not actually\nAdd-DhcpServerScope, or\n\n21\n00:01:03,584 --> 00:01:07,646\nit's Add-DchpServerv4Scope,\nor v6 scope, so\n\n22\n00:01:07,646 --> 00:01:13,060\nthat it knows which address\nfamily we're operating in, right?\n\n23\n00:01:13,060 --> 00:01:15,350\nIn the older versions of Windows,\nyou didn't really have that problem, but\n\n24\n00:01:15,350 --> 00:01:17,740\nthere are gonna be moments where we\nhave IPv6 and we've gotta remember that.\n\n25\n00:01:17,740 --> 00:01:19,660\n>> Exactly.\nAlmost all of the commands can be\n\n26\n00:01:19,660 --> 00:01:20,390\nused for either one.\n\n27\n00:01:20,390 --> 00:01:24,690\nYou've just gotta specify, and the noun\npart of the command would be v4 or v6.\n\n28\n00:01:24,690 --> 00:01:26,270\n>> All right.\n\n29\n00:01:26,270 --> 00:01:27,480\nSo let's go ahead and get one created.\n\n30\n00:01:27,480 --> 00:01:31,340\nLet's say I wanna create a DCHP scope for\nthe studio here, right.\n\n31\n00:01:31,340 --> 00:01:32,305\nSo for our machines.\n\n32\n00:01:32,305 --> 00:01:33,480\nWe'll see what I can break.\n\n33\n00:01:33,480 --> 00:01:36,917\n>> All right. [LAUGH] >> So\nI'm gonna do Add-DhcpServer,\n\n34\n00:01:36,917 --> 00:01:41,570\nif I spell it right,\nmy tab ough to complete a word.\n\n35\n00:01:41,570 --> 00:01:45,709\nSo I'm gonna come in here and\nsay Add-DhcpServerv4, and\n\n36\n00:01:45,709 --> 00:01:49,370\n[LAUGH] tab auto complete\nsometimes does not pay off.\n\n37\n00:01:49,370 --> 00:01:50,420\nThere it is.\n\n38\n00:01:50,420 --> 00:01:51,850\nDhcpServerv4Scope.\n\n39\n00:01:51,850 --> 00:01:54,700\nIf I want to IPv6 it\nwould just be a v6 scope,\n\n40\n00:01:54,700 --> 00:01:56,990\notherwise the commands\nare basically identical.\n\n41\n00:01:56,990 --> 00:01:59,550\nAnd then I need to give it some\ninformation about the scope I'm creating,\n\n42\n00:01:59,550 --> 00:02:01,800\nand a minimum you'll\nwant to give it a name.\n\n43\n00:02:01,800 --> 00:02:05,040\nAnd I'll call this one the ITProTV Studio.\n\n44\n00:02:05,040 --> 00:02:07,670\n>> The name doesn't really do\nanything functionally, but\n\n45\n00:02:07,670 --> 00:02:10,930\nwhen you're working with that DHCP server,\nand you've got a bunch of different scope\n\n46\n00:02:10,930 --> 00:02:12,950\nfor your client subnet,\nfor your server backbone,\n\n47\n00:02:12,950 --> 00:02:16,670\nthings like that, the name helps you\nknow which one you're working with.\n\n48\n00:02:16,670 --> 00:02:22,210\n>> And then the three required\noptions are the beginning IP,\n\n49\n00:02:22,210 --> 00:02:25,310\nthe ending IP, and the sub net mask.\n\n50\n00:02:25,310 --> 00:02:27,420\nAnd so those are the three other\nthings we need to provide.\n\n51\n00:02:27,420 --> 00:02:29,890\nThat's the bare minimum\nto get a scope created.\n\n52\n00:02:29,890 --> 00:02:31,800\nBeginning, end ,and subnet mask.\n\n53\n00:02:32,850 --> 00:02:36,663\nSo I'll just come in here and\nI'll say StartRange.\n\n54\n00:02:36,663 --> 00:02:42,363\nAnd I'm gonna start this\none at 192.168.29.100.\n\n55\n00:02:42,363 --> 00:02:45,604\nAnd then I can say EndRange,\n\n56\n00:02:45,604 --> 00:02:51,555\nwhich is gonna be 192.168.29.150.\n\n57\n00:02:51,555 --> 00:02:54,527\nOr maybe I'll do 149 so\nit's a nice even 50 addresses.\n\n58\n00:02:54,527 --> 00:02:55,756\n>> I like it.\n\n59\n00:02:55,756 --> 00:02:59,597\n>> So I'll go and\nspecify as a start and the end, and\n\n60\n00:02:59,597 --> 00:03:05,877\nthen I need my subnet mask at the very\nend, so I'll just add that -SubnetMask,\n\n61\n00:03:05,877 --> 00:03:09,853\nand this one we'll just\ndo as a slash 24 class C.\n\n62\n00:03:09,853 --> 00:03:12,504\n255.255.255.0.\n\n63\n00:03:12,504 --> 00:03:17,058\nSo once I've got that punched in, it's\nthe name of the scope, the beginning IP,\n\n64\n00:03:17,058 --> 00:03:19,785\nthe ending IP, and the subnet mask.\n\n65\n00:03:19,785 --> 00:03:25,525\nNow, a lot of this can be changed after\nthe fact using Set-DhcpServerScope.\n\n66\n00:03:25,525 --> 00:03:28,447\nYou can change things like\nthe beginning and ending IP address.\n\n67\n00:03:28,447 --> 00:03:32,707\nBut that subnet mask is one of those few\nthings in here that you can't change.\n\n68\n00:03:32,707 --> 00:03:36,117\nSo make sure you get that set right,\notherwise you gotta remove the scope and\n\n69\n00:03:36,117 --> 00:03:37,467\nrecreate it, and that can be a pain.\n\n70\n00:03:39,407 --> 00:03:43,050\nAll right so, now I've got a scope,\nor at least I think I do.\n\n71\n00:03:43,050 --> 00:03:47,229\nRight?\nI guess we could verify that with\n\n72\n00:03:47,229 --> 00:03:51,783\na quick get-DhcpServerv4Scope.\n\n73\n00:03:53,090 --> 00:03:56,340\nI don't even know why I bother\nwith that one completely [LAUGH]\n\n74\n00:03:56,340 --> 00:03:57,460\n>> Some of them it works really well,\n\n75\n00:03:57,460 --> 00:03:58,400\nsome of them you gotta type so\n\n76\n00:03:58,400 --> 00:04:00,375\nmany letters that you might as\nwell just finish typing it out.\n\n77\n00:04:00,375 --> 00:04:02,250\n[LAUGH]\n>> I could have typed five characters, or\n\n78\n00:04:02,250 --> 00:04:03,865\nI could hit Tab 12 times.\n\n79\n00:04:03,865 --> 00:04:05,520\n>> [LAUGH]\n>> So anyhow,\n\n80\n00:04:05,520 --> 00:04:08,110\nyou can see right here that Scope\nthat we made, ITProTV Studio.\n\n81\n00:04:08,110 --> 00:04:10,550\nIt is active by default,\nso be aware of that.\n\n82\n00:04:10,550 --> 00:04:12,940\nI'm serving up addresses right now.\n\n83\n00:04:12,940 --> 00:04:16,980\nIt's got a StartRange of 192.168.29.100,\nall the way to 149.\n\n84\n00:04:16,980 --> 00:04:18,861\nThe LeaseDuration is at the default.\n\n85\n00:04:18,861 --> 00:04:23,031\nThere were a lot of other options I\ncould have provided on that line, but\n\n86\n00:04:23,031 --> 00:04:26,450\nthe minimum was the start,\nthe end, and the subnet mask.\n\n87\n00:04:26,450 --> 00:04:28,530\nAnd so, it's got all of that,\nand it's ready to rock.\n\n88\n00:04:28,530 --> 00:04:30,428\nI've got my scope.\n>> And that's something to keep in mind,\n\n89\n00:04:30,428 --> 00:04:32,050\nis that is different\nfrom the GUI interface.\n\n90\n00:04:32,050 --> 00:04:35,160\nWhen you create that scope through\nthe GUI, there's a check mark that you can\n\n91\n00:04:35,160 --> 00:04:38,900\nchoose, but by default, it's not gonna\nbe the scope, it's not gonna be active.\n\n92\n00:04:38,900 --> 00:04:41,830\nSo, you set that scope up, and then it\ngives you a chance to go back in and\n\n93\n00:04:41,830 --> 00:04:43,730\nset some of the additional parameters, and\n\n94\n00:04:43,730 --> 00:04:44,860\nthen you can activate\nit when you're ready.\n\n95\n00:04:44,860 --> 00:04:48,600\nWith PowerShell, it's gonna be active\nas soon as you run that command.\n\n96\n00:04:48,600 --> 00:04:50,970\n>> Yeah, so\nlet's say I created a second one here.\n\n97\n00:04:50,970 --> 00:04:54,582\nSo I'll just go in, and\nI'm gonna create a ITProTV Studio 2.\n\n98\n00:04:54,582 --> 00:04:57,130\nThat's in a different network, right.\n\n99\n00:04:57,130 --> 00:04:59,000\nSo now I've got two of these scopes.\n\n100\n00:04:59,000 --> 00:05:01,630\nAnd I can see them both created here,\nand their ranges.\n\n101\n00:05:01,630 --> 00:05:09,190\nIf I wanna get rid of a scope, it's\njust gonna be Remove-dhcpServerv4Scope,\n\n102\n00:05:09,190 --> 00:05:12,920\nand then all you have\nto provide is the name.\n\n103\n00:05:12,920 --> 00:05:17,080\nYou don't have to provide all the other\ninformation that we did before.\n\n104\n00:05:17,080 --> 00:05:19,440\nYou can just say, I'm sorry,\nnot the name, the scope ID.\n\n105\n00:05:20,510 --> 00:05:21,400\nThere we go, ScopeID.\n\n106\n00:05:21,400 --> 00:05:24,970\nAnd the scope ID, notice how the scope\nID is not actually the name,\n\n107\n00:05:24,970 --> 00:05:29,500\nit's the subnet or\nthe network that this is attached to.\n\n108\n00:05:29,500 --> 00:05:31,100\nSo if I wanna get rid\nof this 192.168.28.0,\n\n109\n00:05:31,100 --> 00:05:37,050\nthat's what I have to punch in, and\nwe can punch that in right there.\n\n110\n00:05:37,050 --> 00:05:40,190\nWe don't have to provide all the other\ndetails, start range, end range,\n\n111\n00:05:40,190 --> 00:05:40,960\nsubnet mask.\n\n112\n00:05:40,960 --> 00:05:45,500\nWe just specify that scope ID And\nthatll remove it, and now its gone.\n\n113\n00:05:45,500 --> 00:05:49,570\nAll right, so\npretty straightforward there, but\n\n114\n00:05:49,570 --> 00:05:52,470\nwe dont normally stop right here,\nthis scope is gonna be pretty boring.\n\n115\n00:05:52,470 --> 00:05:56,430\nIf machines boot up on our network,\ntheyll get an IP address and thats it.\n\n116\n00:05:56,430 --> 00:05:57,450\n>> And thats about it, right?\n\n117\n00:05:57,450 --> 00:06:00,090\nAnd thats where the power\nof DHCP comes into play.\n\n118\n00:06:00,090 --> 00:06:03,440\nWe can pass out all the other TCP IP\nconfigurations and more stuff.\n\n119\n00:06:03,440 --> 00:06:07,870\nAnd then more, your DNS server address,\nyour default gateway.\n\n120\n00:06:07,870 --> 00:06:10,130\nAll this stuff we're going to need\nto really function on a network.\n\n121\n00:06:10,130 --> 00:06:10,870\n>> Yep.\n\n122\n00:06:10,870 --> 00:06:12,840\nIn the show notes for this episode,\n\n123\n00:06:12,840 --> 00:06:17,470\nI'm gonna include a link to\nthis Microsoft TechNet article.\n\n124\n00:06:17,470 --> 00:06:20,910\nAnd in this TechNet article, they\nhighlight all the different options that\n\n125\n00:06:20,910 --> 00:06:25,580\nwe can provide to a scope, so that we can\ngive our clients a configuration to use\n\n126\n00:06:25,580 --> 00:06:29,470\nwhen they boot up and get a DHCP address,\nbut there's a lot of them.\n\n127\n00:06:29,470 --> 00:06:33,670\nAnd there's a lot that a lot of\npeople aren't really going to use.\n\n128\n00:06:33,670 --> 00:06:34,990\nSo I'll include the link to that article,\nbut\n\n129\n00:06:34,990 --> 00:06:38,230\nwhat I want to show you here in\nthe video are the most common ones.\n\n130\n00:06:38,230 --> 00:06:40,910\nThings like who your DNS\nservers are going to be, and\n\n131\n00:06:40,910 --> 00:06:43,370\nwho your default gateway is going to be.\n\n132\n00:06:43,370 --> 00:06:45,760\nThose are the two things that\nwe really need to get good,\n\n133\n00:06:45,760 --> 00:06:47,800\nclean functionality on our DHCP server.\n\n134\n00:06:49,198 --> 00:06:51,940\nWell, since I've already created my scope,\nI just need to go in and\n\n135\n00:06:51,940 --> 00:06:53,770\nmodify the options on it.\n\n136\n00:06:53,770 --> 00:06:57,920\nAnd to that, were gonna say Set,\nand actually let me move this,\n\n137\n00:06:57,920 --> 00:07:01,230\ncuz this is gonna be a long command, and\nI don't want my head to cover it up.\n\n138\n00:07:01,230 --> 00:07:02,708\n>> Just the command looks long enough.\n\n139\n00:07:02,708 --> 00:07:05,268\n[LAUGH]\n>> So all right, here,\n\n140\n00:07:05,268 --> 00:07:07,260\nwe'll start from the top.\n\n141\n00:07:07,260 --> 00:07:10,490\nSo, we're gonna come in here and we're\nbasically gonna set this option, right?\n\n142\n00:07:10,490 --> 00:07:15,935\nSo I'll just say\nSet-DHCPServerv4OptionValue.\n\n143\n00:07:20,990 --> 00:07:22,880\nThat's the main commandlet right there.\n\n144\n00:07:22,880 --> 00:07:26,630\nSet-DHCPServerv4OptionValue, we\ncan go in here, and\n\n145\n00:07:26,630 --> 00:07:28,120\nwe can set all of our various options.\n\n146\n00:07:28,120 --> 00:07:31,202\nAnd you can even start to\ncreate some new options with\n\n147\n00:07:31,202 --> 00:07:34,000\nthe Add-DhcpServerv4OptionValue.\n\n148\n00:07:34,000 --> 00:07:36,513\nCuz you might have custom\noptions that you need to make.\n\n149\n00:07:36,513 --> 00:07:42,070\nBut for the most part, we can use\nthe built-in ones and they're just fine.\n\n150\n00:07:42,070 --> 00:07:46,200\nAll right, so I'm gonna be modifying my\nscope ID that we just made a moment ago,\n\n151\n00:07:46,200 --> 00:07:47,450\nwhich for me is 192.168.29.0.\n\n152\n00:07:47,450 --> 00:07:51,710\nAnd now I provide the various\noptions that I want it to have.\n\n153\n00:07:51,710 --> 00:07:53,538\nI mention DNS server, right.\n\n154\n00:07:53,538 --> 00:08:03,010\nSo I'll say -DnsServer and maybe my DNS\nserver here is going to be 192.168.29.3.\n\n155\n00:08:03,010 --> 00:08:05,150\nSo that's the DNS server that\nI'm gonna give to people.\n\n156\n00:08:05,150 --> 00:08:07,392\nIf I had more than one I\nwould just do a comma and\n\n157\n00:08:07,392 --> 00:08:09,463\nlist the other ones that were available.\n\n158\n00:08:09,463 --> 00:08:11,647\nYou can do more than one DNS server.\n\n159\n00:08:11,647 --> 00:08:13,200\nAll right.\n\n160\n00:08:13,200 --> 00:08:15,610\nI might choose to do a DNS suffix also,\nand\n\n161\n00:08:15,610 --> 00:08:19,730\nthat's -DnsDomain, and\nthen we specify what domain they're in.\n\n162\n00:08:19,730 --> 00:08:22,700\nI'm in ITProTV.net,\nI believe is what I'm in.\n\n163\n00:08:22,700 --> 00:08:25,290\nAll right.\n\n164\n00:08:25,290 --> 00:08:29,895\nAnd then,\nthat default gateway which is -Router and\n\n165\n00:08:29,895 --> 00:08:37,279\nthen the ip address of your router\nwhich on my network is 192.168.29.2.\n\n166\n00:08:37,279 --> 00:08:40,720\nSo, right here I see the main\noptions that we're gonna set.\n\n167\n00:08:40,720 --> 00:08:45,500\nThe default gateway, the DNS server, and\nI went ahead and did the DNS suffix also.\n\n168\n00:08:45,500 --> 00:08:48,300\nBut there's plenty more options that\nare out there that you can set,\n\n169\n00:08:48,300 --> 00:08:55,050\nmaybe win servers and other things,\nhopefully not, but I'll run that.\n\n170\n00:08:55,050 --> 00:08:57,750\nThere was a little message that popped\nup there, just a little status setting.\n\n171\n00:08:57,750 --> 00:09:02,900\nIt goes by real fast, and then we get\nour prompt, my options are set, right?\n\n172\n00:09:02,900 --> 00:09:05,920\nSo now when my clients go to connect, they\ndon't just get an IP address and a subnet\n\n173\n00:09:05,920 --> 00:09:10,700\nmask, they also get the other supporting\ninformation that they need, right?\n\n174\n00:09:10,700 --> 00:09:13,110\nIf I want to verify that,\nI can jump back to my GUI,\n\n175\n00:09:13,110 --> 00:09:15,090\nit's probably the easiest way to see it.\n\n176\n00:09:15,090 --> 00:09:18,775\nAnd I don't see any scopes here, but\nif I refresh this screen, I should.\n\n177\n00:09:18,775 --> 00:09:21,850\nThere's my scope, 192.169 29.0.\n\n178\n00:09:21,850 --> 00:09:23,240\nIt's called ItProTV studio.\n\n179\n00:09:23,240 --> 00:09:28,320\nAnd if I go down to Scope Options,\nthere's the router, DNS servers,\n\n180\n00:09:28,320 --> 00:09:32,650\nand domain name, all set just\nlike we did from the PowerShell.\n\n181\n00:09:32,650 --> 00:09:38,750\nNow, because I created this scope from\nthe PowerShell, It was active by default.\n\n182\n00:09:39,980 --> 00:09:41,850\nBut there may be times when\nwe're troubleshooting or\n\n183\n00:09:41,850 --> 00:09:46,050\ndealing with other issues that we might\nwant to disable a scope temporarily, or\n\n184\n00:09:46,050 --> 00:09:48,780\nmaybe we created it disabled,\nand now we're ready to enable it.\n\n185\n00:09:48,780 --> 00:09:51,170\nWell, that's another thing that\nwe can do from the PowerShell,\n\n186\n00:09:51,170 --> 00:09:54,170\nis you can turn these scopes on and\noff as you need it.\n\n187\n00:09:54,170 --> 00:09:55,713\nAnd it's really not a hard command.\n\n188\n00:09:55,713 --> 00:10:01,290\nIt's Set-DHCPServerv4Scope -ScopeID,\n\n189\n00:10:01,290 --> 00:10:07,440\nwe have to tell it which\nscope we're working with.\n\n190\n00:10:09,210 --> 00:10:12,640\nAnd then, we can say -State, and for\n\n191\n00:10:12,640 --> 00:10:17,850\nthe state there's really just two\nvalues which is active and inactive.\n\n192\n00:10:19,170 --> 00:10:23,320\nSo if I say inactive,\nthat's gonna disable the scope.\n\n193\n00:10:23,320 --> 00:10:27,650\nThe scope still exists, but we're no\nlonger handing out addresses for it.\n\n194\n00:10:27,650 --> 00:10:29,280\nAnd back here in DHTP,\n\n195\n00:10:29,280 --> 00:10:34,870\nif I refresh this screen,\nwhat I should see is that scope there.\n\n196\n00:10:34,870 --> 00:10:36,260\nIt's got a little red circle on it.\n\n197\n00:10:36,260 --> 00:10:37,720\nIt's been deactivated.\n\n198\n00:10:37,720 --> 00:10:38,410\nIt's inactive.\n\n199\n00:10:39,470 --> 00:10:40,330\nAll right.\n\n200\n00:10:40,330 --> 00:10:43,970\nAnd if I go back to my PowerShell and\nrun that same command but change this\n\n201\n00:10:43,970 --> 00:10:48,900\nto Active, now when I run that it's active\nand it's handing out addresses again.\n\n202\n00:10:48,900 --> 00:10:51,560\nI can come back here and\nrefresh this screen.\n\n203\n00:10:52,715 --> 00:10:54,895\nAnd I can see that it is now active.\n\n204\n00:10:54,895 --> 00:10:58,075\nSo, pretty easy to turn those on and\noff as needed.\n\n205\n00:10:58,075 --> 00:11:01,505\nAnd we can use Get-DhcpServerv4Scope\nto find out whether or\n\n206\n00:11:01,505 --> 00:11:03,335\nnot they're active or inactive.\n\n207\n00:11:03,335 --> 00:11:10,320\nSo, if I inactivate it again,\nand run the scope command.\n\n208\n00:11:10,320 --> 00:11:12,860\nAnd I'm just going to leave off the ID so\nit'll display everything.\n\n209\n00:11:12,860 --> 00:11:15,620\nYou can see in here,\nI've got that state of Inactive.\n\n210\n00:11:15,620 --> 00:11:19,611\nSo pretty easy to verify that\nfrom the PowerShell too.\n\n211\n00:11:19,611 --> 00:11:20,885\nI like the GUI.\n\n212\n00:11:20,885 --> 00:11:22,371\nSomething like this, inactivating and\n\n213\n00:11:22,371 --> 00:11:24,780\nactivating a scope is not something\nI'm going to do all the time.\n\n214\n00:11:24,780 --> 00:11:26,560\nSo I'll usually use the GUI for it.\n\n215\n00:11:26,560 --> 00:11:29,337\n>> [CROSSTALK] [INAUDIBLE],\nor something like that?\n\n216\n00:11:29,337 --> 00:11:32,769\n>> Yeah, maybe you've got some kind of\nscripted response, like a threat response\n\n217\n00:11:32,769 --> 00:11:35,595\nor something that you want to\ninactivate that scope really quick so\n\n218\n00:11:35,595 --> 00:11:38,030\nyou're not hitting on addresses.\n\n219\n00:11:38,030 --> 00:11:41,240\nOr maybe you only want to hand out DHCP\naddresses during certain times of the day.\n\n220\n00:11:41,240 --> 00:11:43,070\nYou could automate it\nwith something like this.\n\n221\n00:11:44,570 --> 00:11:48,820\nAll right well, All in all, working\nwith the scopes, not that big of a deal.\n\n222\n00:11:48,820 --> 00:11:50,270\nRight.\nThe trick is just remembering what\n\n223\n00:11:50,270 --> 00:11:51,620\noptions you want to set.\n\n224\n00:11:51,620 --> 00:11:54,050\nWe really just saw three different\ncommands in there, right.\n\n225\n00:11:54,050 --> 00:11:57,530\nIf I do a get-history,\nwe'll kind of see the ones that I did.\n\n226\n00:11:57,530 --> 00:12:01,270\nThere was the Add-DHCPServerv4Scope,\n\n227\n00:12:01,270 --> 00:12:05,990\nthere was the set DHCP\nserver option value.\n\n228\n00:12:05,990 --> 00:12:08,750\nI guess really just that and the GET.\n\n229\n00:12:08,750 --> 00:12:11,180\nGet-DhcpServerv4Scope.\n\n230\n00:12:11,180 --> 00:12:13,230\nSo really just a handful\nof commands there and\n\n231\n00:12:13,230 --> 00:12:15,770\njust different options that we're\nusing with it to achieve our goals.\n\n232\n00:12:17,752 --> 00:12:21,280\nAll right, well in this segment we got\na chance to see how to create those DHCP\n\n233\n00:12:21,280 --> 00:12:26,040\nscopes, how to modify the scopes,\nand how to set options on them and\n\n234\n00:12:26,040 --> 00:12:29,920\nat the very end there we took a look at\nactivating and inactivating those scopes.\n\n235\n00:12:29,920 --> 00:12:31,650\nSo, pretty good stuff.\n\n236\n00:12:31,650 --> 00:12:36,080\nAt this point, we typically consider our\nDHCP server functional and ready to run.\n\n237\n00:12:37,972 --> 00:12:40,060\nAll right,\nwell I hope you guys enjoyed the segment.\n\n238\n00:12:40,060 --> 00:12:43,660\nStay tuned because we do have a little\nbit more of Dhcop coming up, but\n\n239\n00:12:43,660 --> 00:12:46,210\notherwise we have other PowerShell\nepisodes coming up too.\n\n240\n00:12:46,210 --> 00:12:47,420\nSo stay tuned.\n\n241\n00:12:47,420 --> 00:12:48,903\nThere'll be more after this.\n\n242\n00:12:48,903 --> 00:12:55,129\n[MUSIC]\n\n",
          "vimeoId": "116358132"
        },
        {
          "description": "",
          "length": "306",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-4-dhcp_exclusions-0108015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-4-dhcp_exclusions-0108015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-4-dhcp_exclusions-0108015-sm.jpg",
          "title": "DHCP Exclusions",
          "transcript": "1\n00:00:00,025 --> 00:00:05,397\n[SOUND] In this segment we're gonna take\n\n2\n00:00:05,397 --> 00:00:13,711\na look at creating exclusions\ninside of a DHCP server scope.\n\n3\n00:00:13,711 --> 00:00:17,547\nWhen we create a scope, they let us\npick the beginning IP of a range and\n\n4\n00:00:17,547 --> 00:00:18,950\nthe ending IP of a range.\n\n5\n00:00:18,950 --> 00:00:22,800\nAnd sometimes that works out great for us,\nwe have a whole block of IPs we wanna use.\n\n6\n00:00:22,800 --> 00:00:26,110\nThere are times where there's particular\nIPs that we need to leave out right.\n\n7\n00:00:26,110 --> 00:00:27,600\nAnd I'm not talking about a reservation,\n\n8\n00:00:27,600 --> 00:00:29,770\nwhere I wanna map it to\none host all the time.\n\n9\n00:00:29,770 --> 00:00:31,430\nI mean I wanna leave it out all together.\n\n10\n00:00:31,430 --> 00:00:33,710\nI don't want DHCP to touch it.\n\n11\n00:00:33,710 --> 00:00:37,730\n>> Somebody statically mapped a print\nserver a long time ago before you set that\n\n12\n00:00:37,730 --> 00:00:41,470\nscope up, and now that address you can't\nchange or you don't wanna change it.\n\n13\n00:00:41,470 --> 00:00:42,018\nBut again, so\n\n14\n00:00:42,018 --> 00:00:44,780\nI gotta make sure that my DHCP server\ndoesn't pass out that IP address.\n\n15\n00:00:45,830 --> 00:00:48,910\n>> So let's take a look at that process,\nit is pretty straightforward.\n\n16\n00:00:48,910 --> 00:00:52,950\nI've got a scope that I've created\nin a previous segment, and so\n\n17\n00:00:52,950 --> 00:00:59,160\nI'm gonna just pull that scope up real\nquick, it's the 192.168.29.0 scope.\n\n18\n00:00:59,160 --> 00:01:02,899\nAnd it runs from .100 all the way to .49.\n\n19\n00:01:02,899 --> 00:01:03,414\nI've got 50 IPs.\n\n20\n00:01:03,414 --> 00:01:08,202\nWell let's say that .107\n\n21\n00:01:08,202 --> 00:01:11,780\nwas already in use by a machine on\nthe network that's statically assigned.\n\n22\n00:01:11,780 --> 00:01:14,170\nSo not using DHCP,\nit's just statically assigned.\n\n23\n00:01:14,170 --> 00:01:16,680\nI wanna tell DHCP to leave that alone.\n\n24\n00:01:16,680 --> 00:01:22,230\nNot to mess with .7, and to do that,\nI can create an exclusion to map it out.\n\n25\n00:01:22,230 --> 00:01:25,930\nNow, when you create an exclusion,\nyou can exclude a single IP, or\n\n26\n00:01:25,930 --> 00:01:27,800\nyou can exclude a range of IPs.\n\n27\n00:01:27,800 --> 00:01:29,790\nIt's up to you how you want to do it.\n\n28\n00:01:29,790 --> 00:01:31,770\nBut, I'm gonna exclude just\na single one to start one.\n\n29\n00:01:31,770 --> 00:01:32,620\nI'll do a range afterwards.\n\n30\n00:01:32,620 --> 00:01:35,340\nI'm gonna knock out .7.\n\n31\n00:01:35,340 --> 00:01:36,205\n>> 107.\n\n32\n00:01:36,205 --> 00:01:37,682\n>> 107, sorry.\n\n33\n00:01:37,682 --> 00:01:42,093\nSo, I'm gonna come in here and just say,\n\n34\n00:01:42,093 --> 00:01:46,393\nAdd-DhcpServerv4ExclusionRange.\n\n35\n00:01:46,393 --> 00:01:50,180\nAnd, even though I'm excluding just one\nIP, you still say it's an exclusion range.\n\n36\n00:01:50,180 --> 00:01:53,810\nIt's just gonna start and\nstop at the exact same IP.\n\n37\n00:01:53,810 --> 00:01:56,030\nThen I tell it what\nscope I'm working with.\n\n38\n00:01:56,030 --> 00:02:01,473\nSo I'll say -ScopeID 192.168.29.0,\nis my ScopeID.\n\n39\n00:02:01,473 --> 00:02:03,920\nAnd now, I need to tell it the exclusion.\n\n40\n00:02:03,920 --> 00:02:07,390\nAnd very similar to creating\nan actual scope, we say start range,\n\n41\n00:02:07,390 --> 00:02:08,680\nand an end range.\n\n42\n00:02:09,730 --> 00:02:14,830\nSo if we say -StartRange, in my case it's\n\n43\n00:02:14,830 --> 00:02:20,970\ngoing to be 192.168.29.107, and\nmy EndRange is gonna be the same IP.\n\n44\n00:02:20,970 --> 00:02:25,500\nIf I just wanna include one IP,\nI just list it as the start and the end.\n\n45\n00:02:25,500 --> 00:02:27,930\nIt's both for that particular exclusion.\n\n46\n00:02:29,470 --> 00:02:32,540\nAnd so when I run that,\nit should be happy.\n\n47\n00:02:32,540 --> 00:02:33,080\nHow do I know it worked?\n\n48\n00:02:33,080 --> 00:02:34,490\nWell I can query these.\n\n49\n00:02:34,490 --> 00:02:40,149\nI can do a Get-DhcpServerv4ExclusionRange.\n\n50\n00:02:40,149 --> 00:02:42,130\nAnd now, I can see I've got\na range from 107 to 107, right?\n\n51\n00:02:42,130 --> 00:02:44,540\nThat one's excluded out.\n\n52\n00:02:45,690 --> 00:02:48,170\nIf I wanted to do a block of IPs well,\n\n53\n00:02:48,170 --> 00:02:51,150\nyou just put different IPs in\nthe beginning and in the end.\n\n54\n00:02:51,150 --> 00:02:54,520\nBe careful though, it does get unhappy\nif you do things like overlapping.\n\n55\n00:02:54,520 --> 00:02:58,324\nSo, if I wanted to exclude 105 to 110.\n\n56\n00:02:59,330 --> 00:03:03,408\nRight, if I go in here and modify that\nprevious command like that, they overlap.\n\n57\n00:03:03,408 --> 00:03:06,751\nSo I'd actually need to remove\nthe exclusion for 107, and\n\n58\n00:03:06,751 --> 00:03:08,950\nthen add the block for 105 to 110.\n\n59\n00:03:10,950 --> 00:03:12,550\nIf they don't overlap,\nit's no big deal though.\n\n60\n00:03:12,550 --> 00:03:16,764\nSo like if I wanted to\nexclude 110 through 115.\n\n61\n00:03:18,150 --> 00:03:22,935\nI can just come in here and\nmodify this, and now when I do my\n\n62\n00:03:22,935 --> 00:03:27,380\nGet-DhcpServerv4ExclusionRange, I'll\nsee the two ranges.\n\n63\n00:03:27,380 --> 00:03:33,104\nThe first one is just a single IP,\nthe second one is that range, 110 to 115.\n\n64\n00:03:33,104 --> 00:03:36,989\nNow, this is different than a reservation,\nbecause what this does is,\n\n65\n00:03:36,989 --> 00:03:40,620\nit tells DHCP to pretend like\nthese IPs don't even exist.\n\n66\n00:03:40,620 --> 00:03:41,664\nDon't hand them out.\n\n67\n00:03:41,664 --> 00:03:44,000\nIf somebody asked for\nan IP, don't issue this.\n\n68\n00:03:44,000 --> 00:03:45,770\nDon't even pretend these are around.\n\n69\n00:03:45,770 --> 00:03:47,320\nJust ignore it.\n\n70\n00:03:47,320 --> 00:03:48,670\nReservations are a lot different.\n\n71\n00:03:48,670 --> 00:03:51,010\nWe put specialized requirements on those.\n\n72\n00:03:51,010 --> 00:03:52,870\nBut here, you just ignore it.\n\n73\n00:03:52,870 --> 00:03:55,340\nAll right, once they're in place,\n\n74\n00:03:55,340 --> 00:03:59,830\nyou can get rid of them by doing\nthe Remove-DhcpServerv4ExclusionRange.\n\n75\n00:03:59,830 --> 00:04:02,960\nSyntax is the same for the rest of it, you\ncan remove them and get them out of there.\n\n76\n00:04:02,960 --> 00:04:04,890\nOr put them right back again.\n\n77\n00:04:04,890 --> 00:04:07,640\nNotice how each of these do have\ntheir own kind of scope ID.\n\n78\n00:04:07,640 --> 00:04:10,740\nIt's just mapping it to the scope\nID of the actual scope,\n\n79\n00:04:10,740 --> 00:04:14,540\nthis isn't tied to each individual\nrange like each on its own.\n\n80\n00:04:14,540 --> 00:04:17,700\nBut you might have exclusion ranges for\nseveral different scopes.\n\n81\n00:04:17,700 --> 00:04:19,570\nI could have filtered this down and\n\n82\n00:04:19,570 --> 00:04:22,910\nspecified the scope ID that I\nwanted to see exclusion ranges for.\n\n83\n00:04:22,910 --> 00:04:25,930\nThat's useful if you\nhave more than one scope.\n\n84\n00:04:25,930 --> 00:04:28,090\nI don't, I've only got the one scope,\nso I don't need the filter.\n\n85\n00:04:29,752 --> 00:04:30,680\nAll right, but that's basically it,\n\n86\n00:04:30,680 --> 00:04:33,160\nthis is one of the simpler\ntopics that we've got.\n\n87\n00:04:33,160 --> 00:04:35,974\nAdding an exclusion range,\nviewing the exclusion ranges,\n\n88\n00:04:35,974 --> 00:04:37,528\nit's all done with one command.\n\n89\n00:04:37,528 --> 00:04:46,119\nWell, the set, get, and remove variations\nof the DhcpServerv4ExclusionRange command.\n\n90\n00:04:46,119 --> 00:04:46,886\nThat's a long one.\n[LAUGH]\n\n91\n00:04:46,886 --> 00:04:47,482\n>> All right,\n\n92\n00:04:47,482 --> 00:04:50,226\nwell in this segment,\nwe got a chance to see creating,\n\n93\n00:04:50,226 --> 00:04:54,356\nmodifying and removing those exclusions,\npretty straightforward on this one.\n\n94\n00:04:54,356 --> 00:04:55,517\nHope you guys enjoyed the segment.\n\n95\n00:04:55,517 --> 00:05:00,450\nStay tuned, we've got more DHCP and\nmore power shell coming up.\n\n96\n00:05:00,450 --> 00:05:06,590\n[SOUND]\n\n",
          "vimeoId": "116358135"
        },
        {
          "description": "",
          "length": "365",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-5-dhcp_reservations-0108015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-5-dhcp_reservations-0108015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-5-dhcp_reservations-0108015-sm.jpg",
          "title": "DHCP Reservations",
          "transcript": "1\n00:00:00,000 --> 00:00:07,974\n[MUSIC]\n\n2\n00:00:07,974 --> 00:00:08,845\nIn this segment,\n\n3\n00:00:08,845 --> 00:00:13,720\nwe're gonna take a look at creating DHCP\nreservations from the Windows PowerShell.\n\n4\n00:00:13,720 --> 00:00:15,940\nCreating reservation in DHCP\nis really handy, right?\n\n5\n00:00:15,940 --> 00:00:19,730\nWe wanna a machine to boot up and always\nget the same IP address from our pool.\n\n6\n00:00:19,730 --> 00:00:22,210\nOr maybe we want it to\nget custom options or\n\n7\n00:00:22,210 --> 00:00:25,095\nsettings from the other machines that\nare getting IP's from our server.\n\n8\n00:00:25,095 --> 00:00:27,610\n>> Mm-hm\n>> Reservations let us do that, right?\n\n9\n00:00:27,610 --> 00:00:29,301\nBut we gotta get them\ncreated before they function.\n\n10\n00:00:29,301 --> 00:00:30,580\n>> Right\n>> And that's what we're gonna\n\n11\n00:00:30,580 --> 00:00:31,129\nsee right here.\n\n12\n00:00:32,130 --> 00:00:35,730\nNow creating reservation, it's almost\nidentical to creating an exclusion.\n\n13\n00:00:35,730 --> 00:00:38,380\nThe difference is, instead of\nproviding a start and an end IP,\n\n14\n00:00:38,380 --> 00:00:44,540\nwe're providing a specific IP and\na Mac address that's gonna be tied to it.\n\n15\n00:00:44,540 --> 00:00:47,630\nSo a little bit of a variation,\nbut the syntax is pretty familiar.\n\n16\n00:00:47,630 --> 00:00:51,110\nSo let's take a look at that\nright here on my machine.\n\n17\n00:00:51,110 --> 00:00:55,870\nLet's say that I wanna make sure my laptop\nalways gets the same IP address from our\n\n18\n00:00:55,870 --> 00:00:56,716\nDHCP server.\n\n19\n00:00:56,716 --> 00:00:57,610\nAll right.\n\n20\n00:00:57,610 --> 00:01:01,350\nI always wanna get an IP that ends in 123.\n\n21\n00:01:01,350 --> 00:01:04,625\nSo I want to create\na reservation that will do that.\n\n22\n00:01:04,625 --> 00:01:05,570\n>> Mm-hm\n>> All right?\n\n23\n00:01:05,570 --> 00:01:11,265\nSo I'm gonna come in and\nsay Add-DhcpServerv4Reservation.\n\n24\n00:01:11,265 --> 00:01:17,560\nAll right, so\nI'm gonna be adding that reservation in.\n\n25\n00:01:17,560 --> 00:01:20,620\nI need to tell it what scope this\nreservation is a part of, and\n\n26\n00:01:20,620 --> 00:01:24,255\nmy scope that I'm working\nwith is 192.168.29.0.\n\n27\n00:01:24,255 --> 00:01:28,950\nThen I need to tell it the IP address\nthat I want this machine to have.\n\n28\n00:01:28,950 --> 00:01:31,961\nAnd so I'll come in and\njust say -IPAddress.\n\n29\n00:01:31,961 --> 00:01:35,124\nAnd I'm gonna give myself 192.168.29.123.\n\n30\n00:01:35,124 --> 00:01:37,590\nRight.\nThat's the IP address I always want\n\n31\n00:01:37,590 --> 00:01:38,129\nto have.\n\n32\n00:01:38,129 --> 00:01:39,966\nNow here's the important part.\n\n33\n00:01:39,966 --> 00:01:42,647\nWell, I guess let me add\na little bit more to that.\n\n34\n00:01:42,647 --> 00:01:45,741\nThe IP address you pick has\nto be inside of the scope, so\n\n35\n00:01:45,741 --> 00:01:48,788\nyou know your scope does have a start and\nan end range.\n\n36\n00:01:48,788 --> 00:01:50,771\nIt's gotta be inside of there.\n\n37\n00:01:50,771 --> 00:01:53,150\nAnd it cannot be an exclusion range.\n\n38\n00:01:53,150 --> 00:01:57,320\nI know some people will try and exclude an\nIP and then create a reservation for it.\n\n39\n00:01:57,320 --> 00:01:59,010\nThat doesn't work, right?\n\n40\n00:01:59,010 --> 00:01:59,960\n>> When you exclude it,\n\n41\n00:01:59,960 --> 00:02:03,600\nyou're telling the DHCP server you\ncannot pass out this IP address.\n\n42\n00:02:03,600 --> 00:02:05,570\nYou can't use that in a reservation.\n\n43\n00:02:05,570 --> 00:02:06,160\n>> Or if you try and\n\n44\n00:02:06,160 --> 00:02:09,850\ncreate a reservation for\na scope that's outside of the scope IP.\n\n45\n00:02:09,850 --> 00:02:13,310\nSo like my scope goes from\n.100 all the way to .49.\n\n46\n00:02:13,310 --> 00:02:17,470\nIf I tried to create a reservation for\n150, it's outside the scope and\n\n47\n00:02:17,470 --> 00:02:18,040\nwon't let you do it.\n\n48\n00:02:18,040 --> 00:02:21,922\nSo it's gotta be a valid IP\ninside of the current scope.\n\n49\n00:02:21,922 --> 00:02:23,290\nAll right.\n\n50\n00:02:23,290 --> 00:02:26,510\nSo, the next part is the most\nimportant part, which is.\n\n51\n00:02:26,510 --> 00:02:29,110\nThe MAC address of the machine, all right?\n\n52\n00:02:29,110 --> 00:02:32,830\nSo I need to come in and\njust tell it -ClientID, and\n\n53\n00:02:32,830 --> 00:02:35,830\nthen the MAC address, all right?\n\n54\n00:02:35,830 --> 00:02:40,540\nThe MAC address is a 48-bit hexadecimal\nnumber, and when I write, or letters and\n\n55\n00:02:40,540 --> 00:02:41,820\nnumbers, I guess, whatever.\n\n56\n00:02:41,820 --> 00:02:44,440\nWhen we write it,\nit does need to be in a particular format.\n\n57\n00:02:44,440 --> 00:02:48,890\nIt needs to be two characters and a dash,\ntwo characters and a dash, and so on.\n\n58\n00:02:48,890 --> 00:02:53,190\nSo, if I'm gonna create one for my Laptop,\nI'll just punch in my MAC address here, so\n\n59\n00:02:53,190 --> 00:02:54,360\nI'm just gonna get that punched in.\n\n60\n00:02:54,360 --> 00:02:59,460\nAnd I've got it written down on a piece of\npaper here, so I don't have to look it up.\n\n61\n00:02:59,460 --> 00:03:01,410\n>> That is kind of a negative in the GUI,\n\n62\n00:03:01,410 --> 00:03:03,000\nyou don't have to put those dashes in,\nright?\n\n63\n00:03:03,000 --> 00:03:05,730\nWhen you go through wizard,\nyou can just type in your 12 digits there,\n\n64\n00:03:05,730 --> 00:03:07,442\nand it'll assume the dashes.\n\n65\n00:03:07,442 --> 00:03:09,130\nIn PowerShell, you do have to\nput those in, unfortunately.\n\n66\n00:03:10,180 --> 00:03:12,110\n>> And then we need to give it a name.\n\n67\n00:03:12,110 --> 00:03:16,310\nAnd I'll just call this one donlaptop so\nI can remember what it is, all right.\n\n68\n00:03:16,310 --> 00:03:20,070\nAnd that's gonna create that reservation\nso that now whenever my laptop gets an IP\n\n69\n00:03:20,070 --> 00:03:26,390\naddress from the server, it will\nalways get 192.168.29.123, all right.\n\n70\n00:03:26,390 --> 00:03:33,707\nAnd if I run a get-dhcpserverv4reservation\nwhich apparently I spelled wrong, again.\n\n71\n00:03:33,707 --> 00:03:40,570\nApparently I'm going to set record for the\namount of times that I can spell it wrong.\n\n72\n00:03:40,570 --> 00:03:44,810\nThen you'll see it's prompting me for\nmy scope ID, I didn't provide that.\n\n73\n00:03:44,810 --> 00:03:52,330\nSo if I, oops, there we go,\nif I provide my scope ID of 192.168.29.0.\n\n74\n00:03:52,330 --> 00:03:58,540\nSo I'm running get-Dhcpserverv4reservation\n-scope ID and providing the scope.\n\n75\n00:03:58,540 --> 00:04:01,230\nNow, I can see each of\nthe reservations that are out there.\n\n76\n00:04:01,230 --> 00:04:05,495\nSo I can see that .123 is mapped to this\nMAC address, and it's named donlaptop.\n\n77\n00:04:07,310 --> 00:04:08,810\nNow, at this point,\n\n78\n00:04:08,810 --> 00:04:13,830\nI can go even further if I wanted\nusing the set.Dhcpv4reservation.\n\n79\n00:04:13,830 --> 00:04:15,660\nAnd specify other values.\n\n80\n00:04:15,660 --> 00:04:17,370\nYou can even do custom options and\n\n81\n00:04:17,370 --> 00:04:22,070\nreally advanced things that are tailored\njust to this particular reservation.\n\n82\n00:04:22,070 --> 00:04:25,820\nBut that's not as common as like, if we\nwanna override something on a particular\n\n83\n00:04:25,820 --> 00:04:28,820\nbasis, we normally go to that\nparticular system and modify it there.\n\n84\n00:04:28,820 --> 00:04:32,440\nSo right here is pretty much the extent\nof what most people are gonna\n\n85\n00:04:32,440 --> 00:04:33,075\ndo for reservations.\n\n86\n00:04:33,075 --> 00:04:35,190\n>> Mm-hm\n>> You might need to remove one,\n\n87\n00:04:35,190 --> 00:04:36,912\nI guess, [INAUDIBLE].\n\n88\n00:04:36,912 --> 00:04:39,180\nBut otherwise, that's really about it.\n\n89\n00:04:39,180 --> 00:04:41,870\nI'm trying to think of anything\nelse to throw in on this one Mike.\n\n90\n00:04:41,870 --> 00:04:44,770\n>> All right, I cant think of anything,\nI mean, you can do the reservation or\n\n91\n00:04:44,770 --> 00:04:46,790\nyou can see the type\ncolumn there says both,\n\n92\n00:04:46,790 --> 00:04:52,250\ntheyre referring to the DHCP and\nBootP, thats one thing.\n\n93\n00:04:52,250 --> 00:04:53,200\n>> Yeah, defaults to both.\n\n94\n00:04:53,200 --> 00:04:54,300\nMost people just leave it at that.\n\n95\n00:04:54,300 --> 00:04:55,540\n>> Yeah, absolutely.\n\n96\n00:04:55,540 --> 00:04:57,660\nAnd they are very handy,\nand a lot of people wonder,\n\n97\n00:04:57,660 --> 00:05:01,470\nwhy not just go statically map the IP\naddress if youre gonna set a reservation?\n\n98\n00:05:01,470 --> 00:05:03,320\nIt's really because DHCP is so\npowerful, right.\n\n99\n00:05:03,320 --> 00:05:04,890\nIt has all those other options.\n\n100\n00:05:04,890 --> 00:05:08,970\nHere, we're making sure it gets\nthe same IP address every time.\n\n101\n00:05:08,970 --> 00:05:10,850\nBut what if the DNS server changes?\n\n102\n00:05:10,850 --> 00:05:12,770\nOr their default gateway changes?\n\n103\n00:05:12,770 --> 00:05:14,630\nIf I statically map that information,\n\n104\n00:05:14,630 --> 00:05:17,080\nnow I've gotta go manually\nupdate that information.\n\n105\n00:05:17,080 --> 00:05:19,430\nHere, if I change that,\nif that information changes,\n\n106\n00:05:19,430 --> 00:05:21,300\nI update my scope properties.\n\n107\n00:05:21,300 --> 00:05:24,590\nAnd that client will get that new\ninformation still getting the same IP\n\n108\n00:05:24,590 --> 00:05:25,740\naddress every time.\n\n109\n00:05:25,740 --> 00:05:29,443\nAnd it can be handy like making sure I\nknow what the IP address of that kiosk\n\n110\n00:05:29,443 --> 00:05:30,360\nmachine is.\n\n111\n00:05:30,360 --> 00:05:33,550\nSo if I ever have troubles I can\nalways get in to it by IP address.\n\n112\n00:05:35,070 --> 00:05:35,800\n>> It's all cool stuff.\n\n113\n00:05:36,932 --> 00:05:38,620\nAll right,\nwell that pretty much wraps this one up.\n\n114\n00:05:38,620 --> 00:05:42,260\nSo in this segment we got a chance to see\nhow to create that reservation map and\n\n115\n00:05:42,260 --> 00:05:45,180\nget it in place,\ntake a look to hold them back up,\n\n116\n00:05:45,180 --> 00:05:47,920\nreturn what reservations we made,\nand how to remove them.\n\n117\n00:05:47,920 --> 00:05:50,587\nAll pretty straightforward\nusing the get set or\n\n118\n00:05:50,587 --> 00:05:53,794\nremove -Dhcpserverv4reservation command.\n\n119\n00:05:53,794 --> 00:05:54,757\n>> Mm-hm\n>> All right,\n\n120\n00:05:54,757 --> 00:05:57,150\nwell I hope you guys enjoyed this segment.\n\n121\n00:05:57,150 --> 00:05:59,041\nStay tuned,\nwe've got more power show coming up.\n\n122\n00:05:59,041 --> 00:06:05,549\n[MUSIC]\n\n",
          "vimeoId": "116358137"
        },
        {
          "description": "",
          "length": "610",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-6-monitoring_status-0108015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-6-monitoring_status-0108015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-4-6-monitoring_status-0108015-sm.jpg",
          "title": "Monitoring Status",
          "transcript": "1\n00:00:00,000 --> 00:00:07,695\n[MUSIC]\n\n2\n00:00:07,695 --> 00:00:08,535\nIn this segment,\n\n3\n00:00:08,535 --> 00:00:12,470\nwe're gonna take a look at monitoring\nthe status of our DHCP server.\n\n4\n00:00:12,470 --> 00:00:16,590\nFor the most part, when you set up a DHCP\nserver, you get it configured, you turn it\n\n5\n00:00:16,590 --> 00:00:20,200\non, you walk away, and you never mess\nwith it again, that's it, right?\n\n6\n00:00:20,200 --> 00:00:22,488\n>> Until people come crying to you,\nI can't get on the network,\n\n7\n00:00:22,488 --> 00:00:25,449\nI can't get an IP address, and you go oh,\nwow, yeah, I should check that out.\n\n8\n00:00:25,449 --> 00:00:27,736\n>> So there are times when we\nneed to take a look at it,\n\n9\n00:00:27,736 --> 00:00:31,067\nmake sure things are working properly,\nthat we've got IPs available.\n\n10\n00:00:31,067 --> 00:00:33,308\nAnd that's the main thing\nthat we need to track,\n\n11\n00:00:33,308 --> 00:00:36,730\nis making sure that we don't run\nout of IP addresses in our pool.\n\n12\n00:00:36,730 --> 00:00:38,320\nThat used to never be a problem.\n\n13\n00:00:38,320 --> 00:00:41,100\nYou'd create a network or\na pool size that was large enough, and\n\n14\n00:00:41,100 --> 00:00:42,400\nyou never worry about it.\n\n15\n00:00:42,400 --> 00:00:46,210\nBut recently, it's become more of\na problem where people have phones and\n\n16\n00:00:46,210 --> 00:00:47,970\ntablets that are adding, doubling,\n\n17\n00:00:47,970 --> 00:00:50,335\nor tripling the amount of\nIPs a single person takes.\n\n18\n00:00:50,335 --> 00:00:50,930\n>> Mm-hm.\n>> As\n\n19\n00:00:50,930 --> 00:00:53,991\nwe're starting to see more smartwatches\ncome out now, these wearables,\n\n20\n00:00:53,991 --> 00:00:56,480\nthat IP utilization is really\ngone through the roof.\n\n21\n00:00:56,480 --> 00:01:00,485\nSo keeping tabs on how much of your pool\nhas been leased out is pretty important.\n\n22\n00:01:00,485 --> 00:01:01,093\n>> Mm-hm.\n\n23\n00:01:01,093 --> 00:01:04,067\nDefinitely, it is one of the big\nthings that we always run into is,\n\n24\n00:01:04,067 --> 00:01:06,141\nI mean DHCP was a very\ndynamic environment, so\n\n25\n00:01:06,141 --> 00:01:09,830\nwe've gotta make sure we're monitoring it,\nkeeping track of what's going on.\n\n26\n00:01:10,960 --> 00:01:12,127\n>> All right.\nSo let's take a look at\n\n27\n00:01:12,127 --> 00:01:15,188\nsome of the commands that are available\nfor us for helping to monitor, right?\n\n28\n00:01:15,188 --> 00:01:19,381\nThere's some that we've already seen,\nthings like,\n\n29\n00:01:19,381 --> 00:01:22,153\nGet-Service DHCPServer, right?\n\n30\n00:01:22,153 --> 00:01:25,150\nIf we wanna make sure that DHCP\nservice is actually running,\n\n31\n00:01:25,150 --> 00:01:28,500\nwe can quick query it and\nsee if that status is running or not.\n\n32\n00:01:28,500 --> 00:01:30,950\nI know my server is up.\n\n33\n00:01:30,950 --> 00:01:34,500\nIf I'm issuing out IPs,\nI should have leases, and\n\n34\n00:01:34,500 --> 00:01:38,080\nI'll probably want to be able to query and\nlook at the leases that are out there.\n\n35\n00:01:38,080 --> 00:01:41,480\nNow, you may have a ton of leases or\nyou may have a very small amount.\n\n36\n00:01:41,480 --> 00:01:44,780\nIt just depends on the size of\nthe client base on your system.\n\n37\n00:01:44,780 --> 00:01:47,940\nBut either way,\nthe commands are all pretty much the same.\n\n38\n00:01:47,940 --> 00:01:53,420\nWe can run get-DHCPServerv4Leases,\nor lease.\n\n39\n00:01:53,420 --> 00:01:55,375\nSorry, it's singular.\n\n40\n00:01:55,375 --> 00:02:00,028\nGet-DHCPServerv4Lease, and\nyou do have to specify a scope ID.\n\n41\n00:02:00,028 --> 00:02:03,709\nSo I'll do -ScopeID and\nspecify the scope that I'm looking at.\n\n42\n00:02:03,709 --> 00:02:08,210\nI'm gonna look at the 192.168.29.0 scope.\n\n43\n00:02:08,210 --> 00:02:12,130\nWhen I run that, it's gonna show\nall of the leases that I have.\n\n44\n00:02:12,130 --> 00:02:12,850\nNow, I've only got one,\n\n45\n00:02:12,850 --> 00:02:15,650\nthis is a reservation that we\ncreated in another segment.\n\n46\n00:02:15,650 --> 00:02:20,150\nI can see the IP address that's assigned,\nthe MAC address tied to that machine and\n\n47\n00:02:20,150 --> 00:02:22,810\nit's HostName, and I can see it's state.\n\n48\n00:02:22,810 --> 00:02:28,020\nNow normally you'll see Active or\nInactiveReservation, like this.\n\n49\n00:02:28,020 --> 00:02:31,670\nActive means that somebody's\nactively using that address.\n\n50\n00:02:31,670 --> 00:02:33,710\nInactive would mean it's not in use.\n\n51\n00:02:33,710 --> 00:02:37,165\nNow normally inactive means the IP\nbecomes available for use again.\n\n52\n00:02:37,165 --> 00:02:38,960\nIt'll be issued out for\nuse to other people.\n\n53\n00:02:38,960 --> 00:02:42,570\nBut InactiveReservation\nmeans it's being held.\n\n54\n00:02:42,570 --> 00:02:45,470\nThis client is not up and\nusing the address yet, but\n\n55\n00:02:45,470 --> 00:02:48,845\nif they want it, it's being reserved and\nit would go active when they ask for it.\n\n56\n00:02:48,845 --> 00:02:50,150\n>> Mm-hm.\n\n57\n00:02:50,150 --> 00:02:53,780\nAnother good one to use with\nthat one is that BadLeases.\n\n58\n00:02:53,780 --> 00:02:55,410\n>> Oh yeah.\n>> Because that's one that you'll run\n\n59\n00:02:55,410 --> 00:03:00,035\ninto like you've got an issue if a client,\nif there's a conflict of addresses like if\n\n60\n00:03:00,035 --> 00:03:03,280\na DHCP tries to pass out an address\nto a node, but then the IP\n\n61\n00:03:03,280 --> 00:03:07,340\naddresses may be statically mapped to\nsomething else and we get a conflict.\n\n62\n00:03:07,340 --> 00:03:10,480\nIt'll report it with that\nbad lease as a parameter.\n\n63\n00:03:10,480 --> 00:03:13,880\n>> Yeah, there's actually another type of\nlease that might not show up by default,\n\n64\n00:03:13,880 --> 00:03:16,410\nwhich is when you have a routing and\nremote access server.\n\n65\n00:03:16,410 --> 00:03:19,800\nIt will grab pools of IPs to use for\nVPN clients.\n\n66\n00:03:19,800 --> 00:03:22,590\n>> And,\nthose might not show up by default too.\n\n67\n00:03:22,590 --> 00:03:23,550\nSo, there is another one.\n\n68\n00:03:23,550 --> 00:03:27,530\nInstead of BadLeases,\nwe can say AllLeases.\n\n69\n00:03:27,530 --> 00:03:31,799\nAnd now it'll show you everything,\ngood, bad, inactive, active,\n\n70\n00:03:31,799 --> 00:03:33,806\nones that are for remote access.\n\n71\n00:03:33,806 --> 00:03:35,456\nIt'll show you all leases.\n\n72\n00:03:35,456 --> 00:03:40,230\nNow, in my database here I've only\ngot one lease, so it's no big deal.\n\n73\n00:03:40,230 --> 00:03:43,080\nBut, what if you've got thousands of them?\n\n74\n00:03:43,080 --> 00:03:44,740\nThis can get really out of hand.\n\n75\n00:03:44,740 --> 00:03:47,210\nIf you're looking for\nsomething in particular,\n\n76\n00:03:47,210 --> 00:03:51,690\ndon't forget about the Where-Object\nfilter that's available, right?\n\n77\n00:03:51,690 --> 00:03:56,110\nWe can take our command output, and\nwe can pipe that into Where-Object, and\n\n78\n00:03:56,110 --> 00:03:57,660\nyou can filter based on anything.\n\n79\n00:03:57,660 --> 00:04:01,750\nSo I could say if a particular property,\nlike if I'm looking for a HostName,\n\n80\n00:04:03,580 --> 00:04:08,850\nI could say I'm trying to find that\nwhere it equals donlaptop, right.\n\n81\n00:04:08,850 --> 00:04:11,010\nAnd now it's gonna return just that lease.\n\n82\n00:04:11,010 --> 00:04:14,530\nOr I could say I'm looking for\na particular IP.\n\n83\n00:04:14,530 --> 00:04:21,132\nSo I could say the Property is\nIPAddress and say it equals 10.\n\n84\n00:04:21,132 --> 00:04:27,275\n192.168.29.123, and\nit's gonna return that one.\n\n85\n00:04:27,275 --> 00:04:30,830\nNow, the get-dhcp server v4 release,\n\n86\n00:04:30,830 --> 00:04:35,630\nit does actually have a dash IP\naddress and dash computer name option.\n\n87\n00:04:35,630 --> 00:04:36,970\nI've never been able to\nget to those to work.\n\n88\n00:04:36,970 --> 00:04:39,530\nWe were trying during the break\nbefore this segment started,\n\n89\n00:04:39,530 --> 00:04:41,410\nbecause we had some\nquestions in the chat room.\n\n90\n00:04:41,410 --> 00:04:42,680\nI've never been able to get it to work.\n\n91\n00:04:42,680 --> 00:04:46,460\nSo, Where-Object, you know that works,\nyou just parse your output together.\n\n92\n00:04:46,460 --> 00:04:52,422\nSo, quick, easy and\nthere's your information on that lease.\n\n93\n00:04:52,422 --> 00:04:55,150\nThere is another neat command\nthat I do want to show,\n\n94\n00:04:55,150 --> 00:04:58,030\nwhich is to pull up our\nDHCP server statistics.\n\n95\n00:04:58,030 --> 00:05:00,880\nSometimes you just want to know\nhow many IPs we have left,\n\n96\n00:05:00,880 --> 00:05:02,810\nhow much of our pool is in use?\n\n97\n00:05:02,810 --> 00:05:04,610\nWhat are the statistics for our server?\n\n98\n00:05:04,610 --> 00:05:07,020\nAnd so, there's a cool command for that.\n\n99\n00:05:07,020 --> 00:05:08,170\n>> Yeah.\nThis is the kind of thing you want to\n\n100\n00:05:08,170 --> 00:05:12,270\nmonitor proactively, cuz I want to know\nbefore I run out of IP addresses, right.\n\n101\n00:05:12,270 --> 00:05:15,800\nI don't want to wait until I've got nodes\non the network that can't connect, or\n\n102\n00:05:15,800 --> 00:05:18,200\npeople are saying they\ncan't get any access.\n\n103\n00:05:18,200 --> 00:05:19,980\nSo you monitor those\non a regular basis and\n\n104\n00:05:19,980 --> 00:05:21,970\nyou can see that trend, things like that.\n\n105\n00:05:21,970 --> 00:05:23,210\nIf we keep going at this rate,\n\n106\n00:05:23,210 --> 00:05:25,680\nin a few more weeks we're\ngonna be out of IP addresses.\n\n107\n00:05:25,680 --> 00:05:28,500\nSo if you're not monitoring it, you're\nnot gonna know until there's a problem.\n\n108\n00:05:28,500 --> 00:05:31,802\n>> Yeah, and\nthis one's a record setter for long names.\n\n109\n00:05:31,802 --> 00:05:36,520\nIt's Get-DhcpServerv4ScopeStatistics, and\n\n110\n00:05:36,520 --> 00:05:39,420\nunfortunately tab autocomplete\nreally doesn't help you on this one.\n\n111\n00:05:39,420 --> 00:05:42,304\nBecause it's not unique until you\nget to that [INAUDIBLE] key word.\n\n112\n00:05:42,304 --> 00:05:45,624\nBut, it's a long one and then you just\ntell it the scope that you want to see.\n\n113\n00:05:45,624 --> 00:05:50,283\nI'm gonna say scope id 192.168.29.0,\nand when you run that,\n\n114\n00:05:50,283 --> 00:05:53,270\nyou'll get some information back on it.\n\n115\n00:05:53,270 --> 00:05:58,540\nThe scope id, how many free or\nin use leases that it has,\n\n116\n00:05:58,540 --> 00:06:02,070\nthe percentage in use, the reserved IP's.\n\n117\n00:06:02,070 --> 00:06:04,790\nAny pending leases,\nwhere we've offered to somebody, but\n\n118\n00:06:04,790 --> 00:06:06,500\nthey haven't acknowledged it yet.\n\n119\n00:06:06,500 --> 00:06:07,350\nSo you start to see that.\n\n120\n00:06:07,350 --> 00:06:09,320\nAnd there's actually more\nthen what fits on the screen,\n\n121\n00:06:09,320 --> 00:06:11,850\nif we do a format list on it.\n\n122\n00:06:11,850 --> 00:06:13,350\nYou'll see a little bit more here.\n\n123\n00:06:13,350 --> 00:06:17,290\nAddress is free on this server,\nfree on partner servers, and so on.\n\n124\n00:06:17,290 --> 00:06:21,300\nThis information gets displayed letting us\nknow the status of this system, all right?\n\n125\n00:06:21,300 --> 00:06:23,840\nMy system's not actively\nissuing out DHCP addresses, so\n\n126\n00:06:23,840 --> 00:06:27,900\nmost of this is useless,\nmy address has three as zero, that's odd.\n\n127\n00:06:27,900 --> 00:06:29,410\n>> I'm not sure why that's\nshowing up as zero.\n\n128\n00:06:29,410 --> 00:06:30,750\nI was thinking the same thing.\n\n129\n00:06:30,750 --> 00:06:32,520\nShould have 50 in there, right?\n\n130\n00:06:32,520 --> 00:06:34,725\n>> I should have, well,\n49 because I've got that reservation.\n\n131\n00:06:34,725 --> 00:06:38,110\n>> But yeah, it's odd that that's\nshowing up as zero on mine, maybe I-\n\n132\n00:06:38,110 --> 00:06:39,670\n>> The scope is active, right?\n\n133\n00:06:39,670 --> 00:06:40,959\nWe didn't disable it at some point?\n\n134\n00:06:41,960 --> 00:06:44,230\n>> Yeah, not that I know of.\n\n135\n00:06:44,230 --> 00:06:45,900\nOh, did we leave it deactivated?\n\n136\n00:06:45,900 --> 00:06:47,380\n>> I know we were playing with it, so.\n\n137\n00:06:47,380 --> 00:06:49,210\n>> I might have left it deactivated.\n\n138\n00:06:49,210 --> 00:06:51,080\nThat might be why it's\nshowing three as zero.\n\n139\n00:06:51,080 --> 00:06:55,980\nWhen you deactivate a scope it's not\nissuing out any more leases, and\n\n140\n00:06:55,980 --> 00:06:58,734\nso it may well show up as zero like that.\n\n141\n00:06:58,734 --> 00:06:59,675\nLet's see.\n\n142\n00:06:59,675 --> 00:07:01,231\nOh, my scope is inactive.\n\n143\n00:07:01,231 --> 00:07:01,811\n>> Is it?\n\n144\n00:07:01,811 --> 00:07:06,551\n>> I just did a get-dhcpserverserver4scope\nand sure enough the state is inactive so\n\n145\n00:07:06,551 --> 00:07:11,200\nI really need to go in there and,\nactually, itd be faster to use the GUI.\n\n146\n00:07:11,200 --> 00:07:13,221\nThis is exactly what we shouldnt\ndo in during a [INAUDIBLE]\n\n147\n00:07:13,221 --> 00:07:13,769\n>> [LAUGH]\n\n148\n00:07:13,769 --> 00:07:14,625\n>> But might as well\n\n149\n00:07:14,625 --> 00:07:15,790\nactivate it real quick.\n\n150\n00:07:15,790 --> 00:07:17,904\nSo thats why it-\n>> If you need to see that command,\n\n151\n00:07:17,904 --> 00:07:19,827\nwatch the previous segment\nwe ran on PowerShell,\n\n152\n00:07:19,827 --> 00:07:21,632\nwe showed you how to\ndeactivate those scopes.\n\n153\n00:07:21,632 --> 00:07:27,529\n>> Well, yeah, I guess if we wanna be all\nPowerShell politically correct, whatever.\n\n154\n00:07:27,529 --> 00:07:29,514\n>> [LAUGH] I want to watch Don type more.\n\n155\n00:07:29,514 --> 00:07:34,970\n>> Yeah, set-dchpserverv4scope -ScopeID\n\n156\n00:07:34,970 --> 00:07:41,391\n192.168.29.0- Status Active-\n>> State.\n\n157\n00:07:41,391 --> 00:07:43,081\n>> Oh, state active.\n\n158\n00:07:43,081 --> 00:07:43,976\nWell see, there we go.\n\n159\n00:07:43,976 --> 00:07:44,938\nI should have known it.\n\n160\n00:07:44,938 --> 00:07:45,775\nSo now it's active.\n\n161\n00:07:45,775 --> 00:07:46,750\nAnd it's up and running.\n\n162\n00:07:46,750 --> 00:07:49,260\nSo let's pull those statistics again.\n\n163\n00:07:49,260 --> 00:07:51,530\n>> See if we get some better response.\n\n164\n00:07:51,530 --> 00:07:53,026\n>> Now I've got Free 42, Inuse 1.\n\n165\n00:07:53,026 --> 00:07:55,767\nNow, odd that I would get Free 42,\n\n166\n00:07:55,767 --> 00:08:00,643\nwhen I've got a scope that should\nbe 50 IPs and Reservation 1.\n\n167\n00:08:00,643 --> 00:08:02,080\nWhy 42?\n\n168\n00:08:02,080 --> 00:08:06,790\nWell, in another segment,\nwe created some exclusion ranges, and\n\n169\n00:08:06,790 --> 00:08:09,370\nI excluded six or seven IP's-\n>> That's right.\n\n170\n00:08:09,370 --> 00:08:10,870\nYep.\n>> I think I excluded seven IP's.\n\n171\n00:08:10,870 --> 00:08:14,480\nSo, I excluded some IP's, and\nthose are coming out of that pool, so\n\n172\n00:08:14,480 --> 00:08:18,590\nit's not showing them there, but\nI can see now my usage is 2.3% usage, so\n\n173\n00:08:18,590 --> 00:08:21,490\nI have one address out there,\nand it is a reservation.\n\n174\n00:08:21,490 --> 00:08:24,270\nSo, quick,\neasy way to see the statistics, and hey,\n\n175\n00:08:24,270 --> 00:08:25,930\nit benefited us here\n>> Right.\n\n176\n00:08:25,930 --> 00:08:27,340\n>> Saw that my scope was inactive.\n\n177\n00:08:27,340 --> 00:08:32,060\n[LAUGH]\nAnd that might actually be why some of our\n\n178\n00:08:32,060 --> 00:08:36,040\nfilters weren't working earlier, if it's\ninactive it might not be returning them.\n\n179\n00:08:36,040 --> 00:08:40,970\nBut either way pulling up basic statistics\non your DHCP server, just a great way of\n\n180\n00:08:40,970 --> 00:08:43,940\nevaluating whether functioning right,\nand just to run some basic tasks.\n\n181\n00:08:43,940 --> 00:08:46,770\n>> Like I said, it really should be\nsomething that we do periodically,\n\n182\n00:08:46,770 --> 00:08:49,920\njust to keep an eye on what's going on,\nbecause it is a very dynamic environment.\n\n183\n00:08:49,920 --> 00:08:51,872\nThings change.\nYou have an influx of people that\n\n184\n00:08:51,872 --> 00:08:54,145\nare coming in with new phones and\ntablets, and\n\n185\n00:08:54,145 --> 00:08:56,428\nyou run out of IP addresses\nbefore you know it.\n\n186\n00:08:56,428 --> 00:08:57,590\n>> Yeah.\nAbsolutely.\n\n187\n00:08:57,590 --> 00:09:00,360\nAll right, well that's about it for\nstatistics.\n\n188\n00:09:00,360 --> 00:09:01,930\nObviously there's other\nthings you can monitor.\n\n189\n00:09:01,930 --> 00:09:05,370\nIf you reach into the WMI or\nthe CIM there's a ton of stuff there, but\n\n190\n00:09:05,370 --> 00:09:08,990\nit kind of gets outside of\nthe PowerShell on that one, so.\n\n191\n00:09:08,990 --> 00:09:11,710\n>> And we're currently using PowerShell 4,\nright?\n\n192\n00:09:11,710 --> 00:09:13,090\nWe're on version 4.1 here.\n\n193\n00:09:13,090 --> 00:09:15,185\n>> Yeah, we had a question in\nthe chatroom about which version of\n\n194\n00:09:15,185 --> 00:09:16,180\nPowerShell this was in.\n\n195\n00:09:16,180 --> 00:09:19,137\nWe've been using PowerShell version 4 for\nall of our different stuff.\n\n196\n00:09:19,137 --> 00:09:21,681\nIt's what's packaged\nwith Windows Server 2012.\n\n197\n00:09:21,681 --> 00:09:23,715\nIf you're in the older\nversions of Power Shell,\n\n198\n00:09:23,715 --> 00:09:25,760\nsome of the statistics\ncommands aren't there.\n\n199\n00:09:25,760 --> 00:09:27,360\nThose are usually the newer ones.\n\n200\n00:09:27,360 --> 00:09:31,400\nBut the other ones we've used as far\nas the DHCP leases and reservations,\n\n201\n00:09:31,400 --> 00:09:33,520\nthose have all been there for a long time.\n\n202\n00:09:34,582 --> 00:09:38,210\nAll right, well,\nin this segment we got a chance to see\n\n203\n00:09:38,210 --> 00:09:40,840\nhow to pull some statistics for\nour DHCP server.\n\n204\n00:09:40,840 --> 00:09:47,040\nWe also looked at how to pull up our\nactive leases, as well as special type\n\n205\n00:09:47,040 --> 00:09:51,240\nleases, like bad leases, or those remote\naccess leases that might be out there.\n\n206\n00:09:51,240 --> 00:09:54,860\nAnd we get to see pulling up information\njust on a scope on generals.\n\n207\n00:09:54,860 --> 00:09:58,210\nSo all good stuff for\nmonitoring the status of a DHCP server.\n\n208\n00:09:58,210 --> 00:10:01,010\nAll right, well,\nI hope you guys enjoyed the segment.\n\n209\n00:10:01,010 --> 00:10:03,053\nStay tuned.\nWe've got more PowerShell coming up.\n\n210\n00:10:03,053 --> 00:10:10,029\n[MUSIC]\n\n",
          "vimeoId": "116358801"
        }
      ],
      "title": "DHCP"
    },
    {
      "episodes": [
        {
          "description": "",
          "length": "856",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-1-installing_active_directory_retape-11415.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-1-installing_active_directory_retape-11415-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-1-installing_active_directory_retape-11415-sm.jpg",
          "title": "Installing Active Directory",
          "transcript": "1\n00:00:01,040 --> 00:00:03,790\nIn this\n\n2\n00:00:08,530 --> 00:00:11,740\nsegment, we're gonna take a look at\ninstalling the active directory domain\n\n3\n00:00:11,740 --> 00:00:13,620\nservices using PowerShell.\n\n4\n00:00:14,930 --> 00:00:18,590\nSo, one of the first things you're gonna\ndo if you're setting up a new forest, or\n\n5\n00:00:18,590 --> 00:00:21,660\nif you're adding another\ndomain to your forest, or\n\n6\n00:00:21,660 --> 00:00:24,180\nif you're adding an additional\ndomain controller.\n\n7\n00:00:24,180 --> 00:00:27,530\nTo an existing domain, part of\ninstalling the active directory and\n\n8\n00:00:27,530 --> 00:00:30,210\ngetting that configured\nis installing the role.\n\n9\n00:00:30,210 --> 00:00:32,920\nSo let's take a look at how we\ncan do that through PowerShell.\n\n10\n00:00:32,920 --> 00:00:35,710\nIf we pull up my screen here, the command\nis pretty straightforward it's just going\n\n11\n00:00:35,710 --> 00:00:40,900\nto be install dash windows feature, And\n\n12\n00:00:40,900 --> 00:00:46,840\nthen the name of the role that I want\nto install, dash name parameter and\n\n13\n00:00:46,840 --> 00:00:52,030\nthe name is going to be AD\ndash domain dash services.\n\n14\n00:00:52,030 --> 00:00:55,980\nSo that's the name of the role\nthat I want to install.\n\n15\n00:00:55,980 --> 00:00:59,730\nI also have to decide whether or not I\nwant to include the management tools.\n\n16\n00:00:59,730 --> 00:01:01,610\nIn this case, I am going to, so\n\n17\n00:01:01,610 --> 00:01:06,480\nI'll do the include Management tools,\nand I'll hit Enter, and\n\n18\n00:01:06,480 --> 00:01:10,600\nthat's gonna go ahead and install the role\nactive directory domain services.\n\n19\n00:01:10,600 --> 00:01:14,760\nNow, remember while this is installing,\nwhen you install a role like this,\n\n20\n00:01:14,760 --> 00:01:17,170\nonce it's finished,\nI don't have a domain controller, right?\n\n21\n00:01:17,170 --> 00:01:20,860\nBut I've installed all the pieces,\nI've unpacked all the pieces necessary\n\n22\n00:01:20,860 --> 00:01:24,460\nTo make this a domain controller,\nbut I still have to go back and\n\n23\n00:01:24,460 --> 00:01:28,060\nactually configure the Active\nDirectory Domain Services role, so\n\n24\n00:01:28,060 --> 00:01:29,600\nthat I can make this a domain controller.\n\n25\n00:01:29,600 --> 00:01:32,460\nSo this command is just\ninstalling the role.\n\n26\n00:01:32,460 --> 00:01:35,320\nSo probably what we should do here\nis take a little TV time out,\n\n27\n00:01:35,320 --> 00:01:38,470\nLet this finish installing the role,\nwe'll come back and\n\n28\n00:01:38,470 --> 00:01:43,130\nwe'll verify that, that role got installed\nsuccessfully, and we'll go from there.\n\n29\n00:01:43,130 --> 00:01:45,068\nSo, we'll see you guys back\nhere in just a couple minutes.\n\n30\n00:01:45,068 --> 00:01:52,837\n[MUSIC]\n\n31\n00:01:52,837 --> 00:01:54,875\nSo, that command has completed, and\n\n32\n00:01:54,875 --> 00:01:59,610\nlet's see if we can verify that that\nrole got installed successfully.\n\n33\n00:01:59,610 --> 00:02:01,390\nSo, we take a look at my screen here.\n\n34\n00:02:01,390 --> 00:02:05,290\nI can see the exit code was success,\nso everything looks good.\n\n35\n00:02:05,290 --> 00:02:09,340\nSo, how do I verify that it\nactually installed that role?\n\n36\n00:02:09,340 --> 00:02:11,620\nMy favorite way is just to\nget a list of the commands.\n\n37\n00:02:11,620 --> 00:02:14,350\nMake sure that they module for\nactive directory got installed.\n\n38\n00:02:14,350 --> 00:02:18,520\nBy installing that role that's gonna\ninclude the active directory module for\n\n39\n00:02:18,520 --> 00:02:19,700\nWindows powershell.\n\n40\n00:02:19,700 --> 00:02:23,900\nSo that it'll have all the commands\nnecessary to work with active directory\n\n41\n00:02:23,900 --> 00:02:26,920\nas well as the active\ndirectory deployment module.\n\n42\n00:02:26,920 --> 00:02:31,780\nAll the commands I need to create\na forest, create a new child domain,\n\n43\n00:02:31,780 --> 00:02:34,000\nadd additional domain controllers and\nthings like that.\n\n44\n00:02:34,000 --> 00:02:37,840\nSo let's just do a real\nquick Get command and\n\n45\n00:02:37,840 --> 00:02:43,040\nthen I'm going to pull up the module,\nlet's verify that ADDS deployment module,\n\n46\n00:02:43,040 --> 00:02:49,580\nso ADDS deployment is the name of\nthe module I hit enter and sure enough\n\n47\n00:02:49,580 --> 00:02:54,000\nthere's a list of commands I now have\navailable which is a good indication that\n\n48\n00:02:54,000 --> 00:02:57,810\nthat active directory role was installed,\nagain I don't have a domain controller,\n\n49\n00:02:57,810 --> 00:03:02,295\nI don't have a domain, I didn't create\nanything, All I did was install the roll.\n\n50\n00:03:02,295 --> 00:03:05,735\nAnd in future segment's we'll go back and\nwe'll take a look at these commands.\n\n51\n00:03:05,735 --> 00:03:10,485\nLike the first one we'll be using\nis gonna install that ADDSForest.\n\n52\n00:03:10,485 --> 00:03:13,415\nCreate that first domain\nin our organization.\n\n53\n00:03:13,415 --> 00:03:17,595\nThen in future segments we'll take a look\nat adding, creating a child domain,\n\n54\n00:03:17,595 --> 00:03:21,480\nadding additional domain\ncontrollers to an existing domain.\n\n55\n00:03:21,480 --> 00:03:23,190\nAnd so on.\n\n56\n00:03:23,190 --> 00:03:27,610\nSo in this episode all we really did\nwas we saw how to install the role.\n\n57\n00:03:27,610 --> 00:03:31,500\nIn future segments we'll take a look\nat adding our domain controllers and\n\n58\n00:03:31,500 --> 00:03:32,480\nwe'll go from there.\n\n59\n00:03:32,480 --> 00:03:34,110\nSo I hope you guys enjoyed it.\n\n60\n00:03:34,110 --> 00:03:34,970\nStay tuned.\n\n61\n00:03:34,970 --> 00:03:37,091\nMore PowerShell coming your way.\n\n62\n00:03:37,091 --> 00:03:42,239\n[MUSIC]\n\n",
          "vimeoId": "118259216"
        },
        {
          "description": null,
          "length": "856",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-2-creating_ad_forest-0109015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-2-creating_ad_forest-0109015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-2-creating_ad_forest-0109015-sm.jpg",
          "title": "Creating An AD Forest",
          "transcript": "1\n00:00:00,220 --> 00:00:08,418\n[MUSIC]\n\n2\n00:00:08,418 --> 00:00:12,680\nIn this segment, we're gonna take a look\nat creating an active directory forest\n\n3\n00:00:12,680 --> 00:00:14,250\nfrom the PowerShell.\n\n4\n00:00:14,250 --> 00:00:18,000\nIf you're just getting started with\nactive directory this is step number one.\n\n5\n00:00:18,000 --> 00:00:21,215\nRight, we need to get that forest\ncreated which means Installing\n\n6\n00:00:21,215 --> 00:00:22,851\nthe Active Directory feature and\n\n7\n00:00:22,851 --> 00:00:25,940\nbringing up our first\nActive Directory domain controllers.\n\n8\n00:00:25,940 --> 00:00:27,950\nSo that's what we're gonna kick off,\nright here.\n\n9\n00:00:27,950 --> 00:00:29,450\n>> Let's do it.\nAll right, so\n\n10\n00:00:29,450 --> 00:00:32,250\njust like when you were installing Active\nDirectory through the GUI there's really\n\n11\n00:00:32,250 --> 00:00:33,590\na two step process right?\n\n12\n00:00:33,590 --> 00:00:36,650\nFirst you have to install\nthe role which unpacks all\n\n13\n00:00:36,650 --> 00:00:38,680\nthe files needed to make\nit a domain controller, but\n\n14\n00:00:38,680 --> 00:00:41,870\nremember at the end of that you\ndon't have a domain controller yet.\n\n15\n00:00:41,870 --> 00:00:44,280\nYou still have to go\nthrough the configuration.\n\n16\n00:00:44,280 --> 00:00:46,800\nSo we pull up my screen here, the first\nthing I'm gonna do is install that role,\n\n17\n00:00:46,800 --> 00:00:48,780\nand we've seen this on our\nother PowerShell segments,\n\n18\n00:00:48,780 --> 00:00:51,860\nit's just gonna be our\ninstall-windows feature.\n\n19\n00:00:54,570 --> 00:00:58,500\nAnd there we go, Install-windowsFeature,\nand then the name of that feature that we\n\n20\n00:00:58,500 --> 00:01:03,320\nwant to install is gonna\nbe the AD-domain-services.\n\n21\n00:01:03,320 --> 00:01:06,569\nSo AD-domain-services, and\n\n22\n00:01:06,569 --> 00:01:11,861\nas we've said before in\na couple of other segments,\n\n23\n00:01:11,861 --> 00:01:18,734\nI've got a choice here,\nif I want to install the management tools.\n\n24\n00:01:18,734 --> 00:01:21,054\nThis is going to be a full blown server,\nso\n\n25\n00:01:21,054 --> 00:01:23,651\nwe are going to include\nthe management tools.\n\n26\n00:01:25,300 --> 00:01:27,940\nI'll hit Enter, and\nthat shouldn't take very long.\n\n27\n00:01:27,940 --> 00:01:30,690\nIt'll unpack all those files,\nand get this ready for\n\n28\n00:01:30,690 --> 00:01:32,160\nme to make our domain controller.\n\n29\n00:01:32,160 --> 00:01:34,830\nAnd as Don was saying,\nthe first one we bring up,\n\n30\n00:01:34,830 --> 00:01:36,680\nthe first I have nothing on this network.\n\n31\n00:01:36,680 --> 00:01:39,700\nSo the first server I take, and\nI install an Active Directory on,\n\n32\n00:01:39,700 --> 00:01:41,760\nthat's going to be my forced\nroot domain controller...\n\n33\n00:01:41,760 --> 00:01:44,980\nRight, that's the one that's gonna\nhave a couple of things that no other\n\n34\n00:01:44,980 --> 00:01:47,110\ndomain controllers gonna\nhave in my environment.\n\n35\n00:01:47,110 --> 00:01:52,830\nIt's gonna have the scheme admins group,\nmy enterprise admins group, what else.\n\n36\n00:01:52,830 --> 00:01:57,350\nThat's where the only writable copy\nof the schema's gonna be located so\n\n37\n00:01:57,350 --> 00:02:00,170\nit our special domain controller.\n\n38\n00:02:00,170 --> 00:02:03,370\nIt's got those two forest-wide FSMOs,\nright.\n\n39\n00:02:03,370 --> 00:02:06,570\nThe schema master and the domain\nnaming master are gonna be on there.\n\n40\n00:02:08,000 --> 00:02:10,390\n>> Yeah, it's a pretty important one.\n\n41\n00:02:10,390 --> 00:02:13,540\nAll these tools, at least at this stage,\nare identical no matter what we're doing.\n\n42\n00:02:13,540 --> 00:02:16,470\nBut once we do that setup,\nthis will be a pretty big step.\n\n43\n00:02:16,470 --> 00:02:19,970\nNow there is other infrastructure\nwe probably need to have in\n\n44\n00:02:19,970 --> 00:02:22,270\nplace before we jump\nthrough a lot of this and\n\n45\n00:02:22,270 --> 00:02:24,790\nwe've covered it in some of out other\nsegments so we don't want to do it here.\n\n46\n00:02:24,790 --> 00:02:27,980\nBut you'll typically need things like\na DNS server to be able to store your\n\n47\n00:02:27,980 --> 00:02:28,930\nrecords.\n\n48\n00:02:28,930 --> 00:02:32,330\nYou may need a DHCP server\nto support your clients and\n\n49\n00:02:32,330 --> 00:02:34,930\nso on, So right here step one,\nyou might not be\n\n50\n00:02:34,930 --> 00:02:38,580\nready to just jump right into deploying\nthat active directory but once\n\n51\n00:02:38,580 --> 00:02:41,510\nyou've got your infrastructure in place\nthe steps are pretty straight forward.\n\n52\n00:02:41,510 --> 00:02:43,530\n>> They really are.\n\n53\n00:02:43,530 --> 00:02:46,870\n>> In typical Microsoft fashion\nwe're gonna sit here at 91%.\n\n54\n00:02:46,870 --> 00:02:47,825\n>> [LAUGH]\n>> Waiting, that's.\n\n55\n00:02:47,825 --> 00:02:48,815\n>> Right.\n\n56\n00:02:48,815 --> 00:02:50,215\nAll the way to the end and stop.\n\n57\n00:02:50,215 --> 00:02:52,835\nSo once we get this rolling here,\nwe'll do a quick\n\n58\n00:02:52,835 --> 00:02:56,815\ncommand that we wanna make sure that\nthe role got installed properly.\n\n59\n00:02:56,815 --> 00:02:59,150\nAnd an easy way to do that through\nPowerShell is just to get a list of\n\n60\n00:02:59,150 --> 00:03:00,160\nall the commands, right?\n\n61\n00:03:00,160 --> 00:03:04,140\nCuz when we installed it that should\ninclude the active directory module for\n\n62\n00:03:04,140 --> 00:03:09,700\nWindows PowerShell as well as\nthe ADDS deployment module.\n\n63\n00:03:09,700 --> 00:03:13,370\nThis is a module they've added recently\nthat gives me the ability to run\n\n64\n00:03:13,370 --> 00:03:17,800\nall these commands like add ADDS porous,\nand add ADDS domain,\n\n65\n00:03:17,800 --> 00:03:19,910\na domain controller and things like that.\n\n66\n00:03:19,910 --> 00:03:24,080\nSo there we go the command is finished,\nlooks I've got an Exit Code of Success.\n\n67\n00:03:24,080 --> 00:03:26,530\nSo hopefully everything went well.\n\n68\n00:03:26,530 --> 00:03:32,560\nAs I said, the next thing I'm gonna\ndo is just gonna be a Get-Command and\n\n69\n00:03:32,560 --> 00:03:38,670\nthen, -module, and\nthe name of that module is addsdeployment.\n\n70\n00:03:40,190 --> 00:03:41,810\nAnd as the tab auto-fill work,\n\n71\n00:03:41,810 --> 00:03:45,096\nwhich pretty good indication\nthat it's gonna be there, right.\n\n72\n00:03:45,096 --> 00:03:46,890\n>> [LAUGH]\n>> So hit enter.\n\n73\n00:03:46,890 --> 00:03:51,200\nAnd here you can see the commands,\nand now I can use to deploy my domain\n\n74\n00:03:51,200 --> 00:03:55,630\ncontrollers and set up my active\ndirectory infrastructure from powershell.\n\n75\n00:03:55,630 --> 00:03:59,204\nSo the first one I'm going to do\nagain on this brand new server,\n\n76\n00:03:59,204 --> 00:04:02,780\nwe're going to do an install\ndash ADDS forest.\n\n77\n00:04:02,780 --> 00:04:05,910\nWhen you first look at this you might\nthink well I'm going to create a domain\n\n78\n00:04:05,910 --> 00:04:08,320\nright but it's your first\ndomain in your entire force.\n\n79\n00:04:08,320 --> 00:04:11,520\nSo it's a different\ncommand to set that up.\n\n80\n00:04:11,520 --> 00:04:13,600\n>> And I know one thing that\nyou always say Mike is,\n\n81\n00:04:13,600 --> 00:04:15,234\nremember what you would see in the GUI,\nright.\n\n82\n00:04:15,234 --> 00:04:18,990\nAnd when we launch the GUI one of\nthe first screens we get is a series of\n\n83\n00:04:18,990 --> 00:04:23,460\nradio buttons where it's asking, is\nthis a new forest or an existing forest?\n\n84\n00:04:23,460 --> 00:04:28,380\nOn the next screen it says Is this\na domain controller in a new domain or\n\n85\n00:04:28,380 --> 00:04:30,140\na domain controller in an existing domain?\n\n86\n00:04:30,140 --> 00:04:32,830\nWell, we don't get those as\ncommand line options here,\n\n87\n00:04:32,830 --> 00:04:34,500\nwe get those as separate commands.\n\n88\n00:04:34,500 --> 00:04:38,830\nSo install ADDS domain,\nthat's a new domain,\n\n89\n00:04:38,830 --> 00:04:43,040\nADDS forest, that's a whole new forest and\nADDS domain controller,\n\n90\n00:04:43,040 --> 00:04:45,710\nthat's an additional domain\ncontroller in an existing forest.\n\n91\n00:04:45,710 --> 00:04:49,750\nSo the command we use is what's\ndetermining that scenario.\n\n92\n00:04:49,750 --> 00:04:50,640\n>> Exactly.\nAll right, so\n\n93\n00:04:50,640 --> 00:04:54,188\nwhen we run this command\nthe install-adds forest.\n\n94\n00:04:54,188 --> 00:04:56,830\nThere's a couple different ways\nwe can run about this, right?\n\n95\n00:04:56,830 --> 00:05:00,680\nUsually with PowerShell you've got,\nyou can run the bare minimum, right?\n\n96\n00:05:00,680 --> 00:05:03,850\nThe required parameters and\nyou can get the job done.\n\n97\n00:05:03,850 --> 00:05:07,450\nBut then as always, there's several\ndifferent parameters that I can include,\n\n98\n00:05:07,450 --> 00:05:09,420\ndepending on what I'm trying to do.\n\n99\n00:05:09,420 --> 00:05:13,250\nI've got a link in the show notes that\nwill take you out to TechNet and show you\n\n100\n00:05:13,250 --> 00:05:17,790\nall the different parameters that are\navailable with install dash ADDS forest.\n\n101\n00:05:17,790 --> 00:05:20,600\nThe required ones are going\nto be the name of the domain.\n\n102\n00:05:20,600 --> 00:05:24,960\nI've got to tell it what I'm going to call\nthis and the parameters just, Domain name,\n\n103\n00:05:24,960 --> 00:05:32,570\nand then I'm gonna call this one,\nitprotv.lab and\n\n104\n00:05:32,570 --> 00:05:36,470\nthen the other one is\ngonna be installed-dns.\n\n105\n00:05:36,470 --> 00:05:39,330\nBecause active directory is going to\nrequire DNS, and as Don was saying,\n\n106\n00:05:39,330 --> 00:05:41,590\nyou might have done some\nof this a head of time.\n\n107\n00:05:41,590 --> 00:05:45,220\nYou might have already set up a DNS\nserver, and things like that.\n\n108\n00:05:45,220 --> 00:05:49,100\nIn which case you can use a switch\ndash create DNS delegation.\n\n109\n00:05:50,190 --> 00:05:52,550\nThat would create the delegation\non that DNS server.\n\n110\n00:05:52,550 --> 00:05:55,310\nIn this case I'm just gonna go ahead and\ninstall DNS.\n\n111\n00:05:55,310 --> 00:05:57,470\nI am gonna do a couple\nmore switches in here.\n\n112\n00:05:57,470 --> 00:06:02,260\nI could hit Enter, and we could be done,\nI could have a default forest setup.\n\n113\n00:06:02,260 --> 00:06:06,040\nBut if I do that,\nit's gonna pick the default domain mode,\n\n114\n00:06:06,040 --> 00:06:08,910\nand the forest mode, right?\n\n115\n00:06:08,910 --> 00:06:11,430\nSo I'm gonna go ahead and\nshow you guys the switches for that,\n\n116\n00:06:11,430 --> 00:06:12,610\njust in case you wanted to.\n\n117\n00:06:12,610 --> 00:06:17,730\nSince this is my first server, there's\nno other domain controllers out there,\n\n118\n00:06:17,730 --> 00:06:21,450\nI'm installing 2012 R2,\nthen it would default to\n\n119\n00:06:21,450 --> 00:06:24,710\nthat 2012 R2 domain functional level and\nforest functional level.\n\n120\n00:06:24,710 --> 00:06:27,145\nIf you already had to make, well in\nthis case we've got a new forest, so\n\n121\n00:06:27,145 --> 00:06:28,815\nI wouldn't have any other\ndomain controllers out there.\n\n122\n00:06:28,815 --> 00:06:31,665\n>> Right.\n>> But maybe I want to specify, and let me\n\n123\n00:06:31,665 --> 00:06:36,265\ngo ahead and type as I'm talking here,\nand I'll show you what my options are.\n\n124\n00:06:36,265 --> 00:06:42,215\nSo for my domain mode, I can just hit tab,\nand you can see like default, 2008 mode.\n\n125\n00:06:42,215 --> 00:06:48,790\nAnd I'm kinda wrapping around the screen\nthere, but 2008 R2 mode, 2012 In 2012 R2.\n\n126\n00:06:48,790 --> 00:06:52,540\nSo you might wanna step that down.\n\n127\n00:06:52,540 --> 00:06:55,580\nYou might know ahead of time\nthat you've got plans to install\n\n128\n00:06:55,580 --> 00:06:58,210\na 2008 domain controller, or you're gonna\nbe merging, or something like that.\n\n129\n00:06:58,210 --> 00:07:02,000\nSo maybe you want to use a lower domain\nmode, or forest functional mode.\n\n130\n00:07:02,000 --> 00:07:05,440\n>> The thing I always say is,\nremember that you can't change this.\n\n131\n00:07:05,440 --> 00:07:07,410\n>> Right.\n>> So like, once it's set at 2012 R2 mode,\n\n132\n00:07:07,410 --> 00:07:11,500\nyou can't go back to a lower mode\n>> You can go up to a newer mode, but\n\n133\n00:07:11,500 --> 00:07:13,450\nyou can never go back to an older mode.\n\n134\n00:07:13,450 --> 00:07:16,770\nSo I always tell people,\nhey look at what your requirements are and\n\n135\n00:07:16,770 --> 00:07:18,680\nfigure out which forest\nfunctional level and\n\n136\n00:07:18,680 --> 00:07:22,280\nwhich domain functional level provides\nthe minimum features that you need.\n\n137\n00:07:22,280 --> 00:07:24,275\nWhich one gets you you\nto where you need and\n\n138\n00:07:24,275 --> 00:07:28,815\npick that one cuz you can always increase\nit later, but you can't decrease it.\n\n139\n00:07:28,815 --> 00:07:30,675\nSo, getting this right in\nthe beginning is really important.\n\n140\n00:07:30,675 --> 00:07:33,975\n>> Exactly, and you'll notice\nsometimes the higher functional\n\n141\n00:07:33,975 --> 00:07:37,525\nlevels don't give you any\nadditional functionality.\n\n142\n00:07:38,725 --> 00:07:41,835\nSo, there's no reason to go to 2012 R2\nforce mode because it doesn't give me\n\n143\n00:07:41,835 --> 00:07:44,580\nanything, it just limits\nwhat I can do in the future.\n\n144\n00:07:44,580 --> 00:07:45,950\nBut, let me get that started.\n\n145\n00:07:45,950 --> 00:07:49,810\nI hit my up arrow and\nit brought up that last command there so\n\n146\n00:07:49,810 --> 00:07:55,550\nwe'll go with 2012 R2 mode just\nbecause we can, forest mode as well.\n\n147\n00:07:57,160 --> 00:07:59,190\nIf I could spell forest.\n\n148\n00:07:59,190 --> 00:08:00,460\nWe'll do the same thing.\n\n149\n00:08:00,460 --> 00:08:04,250\nWe'll go to 2012 R2 mode and\nthen what else did I wanna show you?\n\n150\n00:08:04,250 --> 00:08:07,270\nI'm not going to change these but\nI wanna show you the parameter.\n\n151\n00:08:07,270 --> 00:08:09,990\nYou can also set the locations again,\nthink back to the GUI, right?\n\n152\n00:08:09,990 --> 00:08:12,060\nWhen you get towards\nthe end of the wizard,\n\n153\n00:08:12,060 --> 00:08:14,860\nit asked you where do you\nwanna put that NDTS.DIT.\n\n154\n00:08:14,860 --> 00:08:17,880\nWhere do I wanna put the database,\nwhere do I wanna put the log files for\n\n155\n00:08:17,880 --> 00:08:21,720\nthat database, and where do I wanna\nput the SIS file folder structure?\n\n156\n00:08:21,720 --> 00:08:25,124\nAnd if I had a second drive in here,\nI might really want to switch out or\n\n157\n00:08:25,124 --> 00:08:28,180\nsplit up where that database and\nthose log files are located so\n\n158\n00:08:28,180 --> 00:08:30,010\nthey go on different drives.\n\n159\n00:08:30,010 --> 00:08:33,100\nThe parameter for that is just\ngoing to be there's database path.\n\n160\n00:08:35,690 --> 00:08:40,680\nAnd then I could specify something\nlike d:\\ and whatever I wanted to do.\n\n161\n00:08:40,680 --> 00:08:43,900\nSome other parameters you could use in\nthere would be the sys bal path and\n\n162\n00:08:43,900 --> 00:08:45,340\nthe log path.\n\n163\n00:08:45,340 --> 00:08:48,070\nBut for this example I'm just gonna go\nwith what we've got because I've got\n\n164\n00:08:48,070 --> 00:08:50,580\na single drive in this virtual machine.\n\n165\n00:08:50,580 --> 00:08:53,500\nSo I should be able to hit Enter and\nbecause I didn't specify, again,\n\n166\n00:08:53,500 --> 00:08:57,140\nI've got that link to TechNet and it'll\nshow you all these different parameters.\n\n167\n00:08:57,140 --> 00:09:01,290\nIn the command I could have\nspecified the safe mode password,\n\n168\n00:09:01,290 --> 00:09:04,920\nright, the DSRM, the Directory\nService Restore Mode password.\n\n169\n00:09:08,210 --> 00:09:10,000\nBut, best practice, security wise,\n\n170\n00:09:10,000 --> 00:09:13,600\nsays that you don't really wanna type that\nin line if somebody is standing over your\n\n171\n00:09:13,600 --> 00:09:17,850\nshoulder, or if you're saving that in\na script that's gonna be plain text.\n\n172\n00:09:17,850 --> 00:09:21,597\nSo, if you leave that parameter out\nit will do it by default; it will do\n\n173\n00:09:21,597 --> 00:09:24,080\na prompt, and it's gonna secure it.\n\n174\n00:09:24,080 --> 00:09:26,820\nYou'll notice that it's gonna\ngive me some asterisks there and\n\n175\n00:09:26,820 --> 00:09:29,240\nnot show anybody what I'm typing.\n\n176\n00:09:31,360 --> 00:09:34,510\nAnd then, once I do that,\nit's gonna tell me yeah,\n\n177\n00:09:34,510 --> 00:09:36,570\nit's getting ready to make\nit a domain controller.\n\n178\n00:09:36,570 --> 00:09:42,470\nI hit Yes, for all then we'll watch it go\nthrough here and I should've skipped it.\n\n179\n00:09:42,470 --> 00:09:45,570\nThere is another parameter,\nyou can do a skip precheck.\n\n180\n00:09:45,570 --> 00:09:48,860\nIn the real world I typically wanna\ngo through those prechecks and\n\n181\n00:09:48,860 --> 00:09:53,820\nmake sure I have all the requirements\nto install active directory in this lab\n\n182\n00:09:53,820 --> 00:09:58,260\nI probably should have added that switch\nand it would just skip the checks here.\n\n183\n00:09:58,260 --> 00:10:01,480\nSo we'll let it go through that and this\nmight be a good place if we want to do\n\n184\n00:10:01,480 --> 00:10:04,860\na little, oh there is kind\nof cool It's cool to watch.\n\n185\n00:10:04,860 --> 00:10:08,920\nOne of the things that I really like about\nthis, you can watch this right here and\n\n186\n00:10:08,920 --> 00:10:12,880\nyou'll see it go through the different\nsteps of installing active directory.\n\n187\n00:10:12,880 --> 00:10:16,735\nYou'll see it creating the scheme of\npartition, the configuration partition,\n\n188\n00:10:16,735 --> 00:10:22,160\nmy domain partition installing DNS and\nthings like that.\n\n189\n00:10:22,160 --> 00:10:25,640\n>> And, part of this, like what it's doing\nright now, it's actually installing DNS,\n\n190\n00:10:25,640 --> 00:10:28,580\nso it's not even installing\nthe active directory domain yet.\n\n191\n00:10:28,580 --> 00:10:32,020\nWhen it's done with the installing DNS\nit'll create the records, it'll then have\n\n192\n00:10:32,020 --> 00:10:36,270\nto copy a template of the active\ndirectory database over into place and\n\n193\n00:10:36,270 --> 00:10:37,810\nthen start customizing\nit with the install.\n\n194\n00:10:37,810 --> 00:10:39,050\nSo, it does take a minute,\n\n195\n00:10:39,050 --> 00:10:42,530\nmaybe we can just take a little\ntv timeout here and pause.\n\n196\n00:10:42,530 --> 00:10:44,690\nAnd let this run and\nthen when it's done we can pick back up.\n\n197\n00:10:44,690 --> 00:10:47,540\nCuz it can be a little\nboring just staring too so.\n\n198\n00:10:47,540 --> 00:10:48,080\n>> Right.\n[LAUGH]\n\n199\n00:10:48,080 --> 00:10:49,000\n>> Let's take a pause here and\n\n200\n00:10:49,000 --> 00:10:51,860\nas soon as that's completed we'll\njump right back in and go through and\n\n201\n00:10:51,860 --> 00:10:53,020\nverify our installation.\n\n202\n00:10:53,020 --> 00:10:54,469\nSo stay tuned we'll be\nback in just a moment.\n\n203\n00:10:54,469 --> 00:11:01,844\n[MUSIC]\n\n204\n00:11:01,844 --> 00:11:03,980\nAll right that didn't\ntake too terribly long.\n\n205\n00:11:03,980 --> 00:11:07,200\nNow, during the break it\nfinished installing that roll and\n\n206\n00:11:07,200 --> 00:11:08,540\nit rebooted the server.\n\n207\n00:11:08,540 --> 00:11:11,590\nYou know, promoting a domain\ncontroller does require a reboot.\n\n208\n00:11:11,590 --> 00:11:14,500\nSo now the system is rebooted and\nwe're ready to jump back in and\n\n209\n00:11:14,500 --> 00:11:15,620\nverify what happened.\n\n210\n00:11:15,620 --> 00:11:18,570\n>> All right so\nwe'll take a look at my screen over here.\n\n211\n00:11:18,570 --> 00:11:22,470\nI've logged back into the server,\nI've pulled up server manager.\n\n212\n00:11:22,470 --> 00:11:25,150\nAnd all I'm gonna do is go over here\nto one, and you can see I've got active\n\n213\n00:11:25,150 --> 00:11:30,590\ndirectory domain services installed\nhere in my console so if I take a peek.\n\n214\n00:11:30,590 --> 00:11:33,420\nUsually what I'll do,\njust to verify my successful installation,\n\n215\n00:11:33,420 --> 00:11:37,290\nI might open up one of these tools and\njust make sure that everything's there.\n\n216\n00:11:37,290 --> 00:11:41,939\nWe could navigate in windows explorer and\nverify that sysval got created and\n\n217\n00:11:41,939 --> 00:11:44,230\nthat the data base got created.\n\n218\n00:11:44,230 --> 00:11:48,020\nBut im pretty confident by looking at\nthis that active directory opens up\n\n219\n00:11:48,020 --> 00:11:48,840\nwe should be good to go.\n\n220\n00:11:48,840 --> 00:11:53,350\nThe other thing I wanted to show you\nthough is let's take a look at sites and\n\n221\n00:11:53,350 --> 00:11:53,892\nservices.\n\n222\n00:11:53,892 --> 00:11:58,720\nAll right, and I know that is\n\n223\n00:11:58,720 --> 00:12:02,590\nreally small guys I can't really change\nthe size of that but if I come down here\n\n224\n00:12:02,590 --> 00:12:07,000\nto fault first site name and my servers\nthere is my server01, all right.\n\n225\n00:12:08,310 --> 00:12:13,132\nAnd if I take a look at, let's do this.\n\n226\n00:12:16,060 --> 00:12:18,904\nWhat was I gonna show you guys?\n\n227\n00:12:18,904 --> 00:12:19,984\nNow I kinda forgot what\nI was gonna show you.\n\n228\n00:12:19,984 --> 00:12:22,344\n>> You were just gonna make\nsure the domain was there, and\n\n229\n00:12:22,344 --> 00:12:23,505\nthat we had our OUs, and.\n\n230\n00:12:23,505 --> 00:12:24,360\n>> Mm-hm.\n\n231\n00:12:24,360 --> 00:12:26,570\nEverything looks good there,\nI can see my server there.\n\n232\n00:12:26,570 --> 00:12:33,250\nOh, I was gonna show you raising that\ndomain and force functional level.\n\n233\n00:12:33,250 --> 00:12:36,370\nOff Camera: I think you have\nto do it; there you go...\n\n234\n00:12:36,370 --> 00:12:39,005\nThat's domain in trust actually,\nwrong console for that one.\n\n235\n00:12:39,005 --> 00:12:41,380\n>> [LAUGH]\n>> Let's go over to domains and\n\n236\n00:12:41,380 --> 00:12:48,130\ntrust real quick and here we can take\na look, and there I can see my domain.\n\n237\n00:12:48,130 --> 00:12:50,140\nIf I right click on it,\ndo domain functional level,\n\n238\n00:12:50,140 --> 00:12:53,980\nI can see that I'm already at 2212 RT,\nlike we said on our command.\n\n239\n00:12:53,980 --> 00:12:58,370\nMy forest, if I right click up here and\nchange my forest functional level.\n\n240\n00:12:58,370 --> 00:13:02,560\nI'll see that that is sent to 2012 R2,\nas well.\n\n241\n00:13:02,560 --> 00:13:05,880\nSuccess installing my domain controller,\nand\n\n242\n00:13:05,880 --> 00:13:08,980\ncreating a brand new forest for\nactive directory.\n\n243\n00:13:08,980 --> 00:13:12,630\n>> And Mike, why don't you pull up your\nDNS forward look up zone also because\n\n244\n00:13:12,630 --> 00:13:16,370\nyou'll see that when heading created\nall the SRV records necessary\n\n245\n00:13:16,370 --> 00:13:18,760\nthis force is just up and running.\n\n246\n00:13:18,760 --> 00:13:21,670\nWe're ready to join clients to it,\nadd other domains, whatever we need.\n\n247\n00:13:21,670 --> 00:13:23,950\nSo, pretty straightforward, there.\n\n248\n00:13:23,950 --> 00:13:27,050\nReally just that one power shell\ncommand; it does the install.\n\n249\n00:13:27,050 --> 00:13:27,790\nSo if you're automating\n\n250\n00:13:27,790 --> 00:13:29,315\nthe deployment of something like this,\n>> You can.\n\n251\n00:13:29,315 --> 00:13:32,855\nNow most people don't\ncreate forests very often.\n\n252\n00:13:32,855 --> 00:13:35,145\nSo I'll admit this is not one\nyou automate very much but\n\n253\n00:13:35,145 --> 00:13:37,175\nthat doesn't stop Microsoft\nfrom putting it on the exam.\n\n254\n00:13:37,175 --> 00:13:37,995\n>> [LAUGH] Yeah.\n\n255\n00:13:37,995 --> 00:13:40,641\n>> So you know it is out there,\nand we wanna be aware of it.\n\n256\n00:13:40,641 --> 00:13:43,539\nBut yeah, you can see all\nthe records right there all done.\n\n257\n00:13:43,539 --> 00:13:44,055\n>> Very good.\n\n258\n00:13:44,055 --> 00:13:48,505\n>> All right, well, in this segment we got\na chance to see how to create a brand new\n\n259\n00:13:48,505 --> 00:13:53,030\nActive Directory forest from the\nPowerShell, as straightforward as it was.\n\n260\n00:13:53,030 --> 00:13:55,020\nBut stay tuned,\ncause we have more segments coming up.\n\n261\n00:13:55,020 --> 00:13:58,070\nWe're going to show how to create\nnew domains inside of a forest,\n\n262\n00:13:58,070 --> 00:14:01,890\nas well as how to create additional\ndomain controllers in an existing domain.\n\n263\n00:14:01,890 --> 00:14:03,880\nBoth of which are also\npretty straightforward but\n\n264\n00:14:03,880 --> 00:14:06,330\nwe're going to continue on with\nthis Active Directory series, so\n\n265\n00:14:06,330 --> 00:14:07,730\nstay tuned for that.\n\n266\n00:14:07,730 --> 00:14:09,799\nThere's more PowerShell coming up.\n\n267\n00:14:09,799 --> 00:14:15,839\n[MUSIC]\n\n",
          "vimeoId": "118259218"
        },
        {
          "description": "",
          "length": "610",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-2-creating_child_domain-0109015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-2-creating_child_domain-0109015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-2-creating_child_domain-0109015-sm.jpg",
          "title": "Creating Child Domain",
          "transcript": "1\n00:00:00,032 --> 00:00:08,135\n[MUSIC]\n\n2\n00:00:08,135 --> 00:00:12,167\nIn this segment we're going to take\na look at adding a domain controller,\n\n3\n00:00:12,167 --> 00:00:14,390\nor actually adding a domain to a forest.\n\n4\n00:00:14,390 --> 00:00:17,680\nAnd when we add a domain to a forest\nthere's a few different forms it can take.\n\n5\n00:00:17,680 --> 00:00:18,980\nIt could be a child domain.\n\n6\n00:00:18,980 --> 00:00:21,720\nSo we've got a parent\ndomain like Itprotv.net and\n\n7\n00:00:21,720 --> 00:00:25,820\nwe want to create a child of it,\nlab.itprotv.net, or\n\n8\n00:00:25,820 --> 00:00:30,060\nit could be an entirely separate tree,\nsomething like entertainmentlive.com,\n\n9\n00:00:30,060 --> 00:00:33,490\na whole different DNS name\nspace on a separate tree.\n\n10\n00:00:33,490 --> 00:00:36,730\nBut, in both scenarios it's\nall in the same forest.\n\n11\n00:00:36,730 --> 00:00:39,220\nAnd the command that we use is\nactually the same there, too.\n\n12\n00:00:39,220 --> 00:00:41,000\nThere's really just\na little modifier we use.\n\n13\n00:00:41,000 --> 00:00:43,680\nThe command is smart enough to see\nthe domain we're using to determine\n\n14\n00:00:43,680 --> 00:00:45,860\nwhich type of a child\ndomain that we're adding.\n\n15\n00:00:45,860 --> 00:00:48,070\nSo the process is pretty straight forward.\n\n16\n00:00:48,070 --> 00:00:49,470\nThat's what we're gonna see right here!\n\n17\n00:00:50,700 --> 00:00:51,960\n>> All right, so\nlet's take a look at this.\n\n18\n00:00:51,960 --> 00:00:54,730\nWhat I've got, I've got a forest root,\n\n19\n00:00:55,880 --> 00:00:58,990\nwhich is actually www.itprotv.net\nis the one we used.\n\n20\n00:00:58,990 --> 00:01:03,224\nAnd, I can see here this is, I just wanna\nshow you guys that he's running DNS, so\n\n21\n00:01:03,224 --> 00:01:04,734\nit's a domain controller.\n\n22\n00:01:04,734 --> 00:01:07,910\nIt's my forest root domain controller for\nwww.itprotv.net.\n\n23\n00:01:07,910 --> 00:01:10,700\nHe's also running DNS, so\nhe has a zone for itprotv.net.\n\n24\n00:01:10,700 --> 00:01:14,490\nWhat we're going to do is I'm going\nto switch over to this other server.\n\n25\n00:01:14,490 --> 00:01:16,960\nAnd currently this server is\na member of a work group.\n\n26\n00:01:16,960 --> 00:01:18,780\nAnd I'm going to open up Powershell.\n\n27\n00:01:18,780 --> 00:01:21,275\nAnd I'm going to add this\nguy as a child domain.\n\n28\n00:01:21,275 --> 00:01:23,445\nAs we're gonna be creating\na second domain, and\n\n29\n00:01:23,445 --> 00:01:27,205\nmy forest is gonna be part\nof that second domain tree.\n\n30\n00:01:27,205 --> 00:01:30,675\nAnd the command for that, and this guy\nI've already installed the role, right?\n\n31\n00:01:30,675 --> 00:01:33,748\nThe role active directory domain\nservice has been installed.\n\n32\n00:01:33,748 --> 00:01:39,344\nThe next thing we're gonna do\nis configure it as a domain\n\n33\n00:01:39,344 --> 00:01:44,583\ncontroller, and from PowerShell,\nthe command for\n\n34\n00:01:44,583 --> 00:01:50,908\nthat is gonna be install,\n-ADDomain, sorry, ADDSDomain.\n\n35\n00:01:50,908 --> 00:01:51,610\nI always forget that DS in there.\n\n36\n00:01:51,610 --> 00:01:53,110\n>> [LAUGH]\n>> So\n\n37\n00:01:53,110 --> 00:01:54,720\nactive directory domain service domain.\n\n38\n00:01:54,720 --> 00:01:58,060\nAnd then the parameters I'm gonna use with\nthis, first thing I've gotta do is I gotta\n\n39\n00:01:58,060 --> 00:02:01,480\nspecify what the name of this\nnew child domain is going to be.\n\n40\n00:02:01,480 --> 00:02:04,530\nAnd the parameter for\nthat is new domain name.\n\n41\n00:02:04,530 --> 00:02:07,395\nSo newdomainname.\n\n42\n00:02:07,395 --> 00:02:09,320\nAnd then we're gonna call this one lab.\n\n43\n00:02:09,320 --> 00:02:14,090\nNow you could type out\nthe fqtnlab.itprotv.net but\n\n44\n00:02:14,090 --> 00:02:15,970\nit knows that if it's\ngonna be a child domain,\n\n45\n00:02:15,970 --> 00:02:18,978\nit's gonna take that child domain name and\ntack it on to the parent name.\n\n46\n00:02:18,978 --> 00:02:24,010\nYou have specified who that\nparent domain name is, or\n\n47\n00:02:24,010 --> 00:02:25,840\nwhat that parent domain name is.\n\n48\n00:02:25,840 --> 00:02:29,200\nSo it knows what tree, you might have\nmore than one tree in your forest so\n\n49\n00:02:29,200 --> 00:02:31,940\nwhich tree are you adding this domain to?\n\n50\n00:02:31,940 --> 00:02:38,008\nIn our case, that's gonna be ITProTV.net.\n\n51\n00:02:38,008 --> 00:02:39,300\nAnd then I've got to have credentials,\nright?\n\n52\n00:02:39,300 --> 00:02:41,460\nWhat we did in the previous segment,\n\n53\n00:02:41,460 --> 00:02:44,500\nwhen we added that forest root there\nweren't any credentials required, right?\n\n54\n00:02:44,500 --> 00:02:48,520\nI was logged on as the administrator\non that local server and\n\n55\n00:02:48,520 --> 00:02:52,250\nI ran through the configuration\nof that active directory there.\n\n56\n00:02:52,250 --> 00:02:53,090\nNow when you come and\n\n57\n00:02:53,090 --> 00:02:57,180\nadd a child domain, you're adding\nit to an existing network, right?\n\n58\n00:02:57,180 --> 00:02:59,770\nTo an existing forest, so you're gonna\nhave to have permissions within that\n\n59\n00:02:59,770 --> 00:03:02,590\nforest to create that child domain.\n\n60\n00:03:02,590 --> 00:03:07,680\nAnd for security purposes I'm gonna type\nin the parameter is just -prudential.\n\n61\n00:03:07,680 --> 00:03:11,670\nAnd you could specify the user account\nthat you wanted to use to perform this\n\n62\n00:03:11,670 --> 00:03:15,760\nprocess, right, and\naccount in that forest root.\n\n63\n00:03:15,760 --> 00:03:20,740\nFor security, though,\nI'm going to do a Get-Credential.\n\n64\n00:03:20,740 --> 00:03:23,590\nAnd what that's gonna do, is instead of\nme typing it in line where somebody can\n\n65\n00:03:23,590 --> 00:03:27,260\nsee what I was typing, or having it in a\nscript, where somebody could open up that\n\n66\n00:03:27,260 --> 00:03:29,950\nscript, try to edit it, and\nsee those credentials that I used.\n\n67\n00:03:29,950 --> 00:03:34,710\nThis way it's going to prompt me as I run\nthat command to type in those credentials.\n\n68\n00:03:34,710 --> 00:03:37,330\nAnd that's really all\nI need at this point.\n\n69\n00:03:37,330 --> 00:03:39,770\nThat'd be the required parameters.\n\n70\n00:03:39,770 --> 00:03:40,680\nI'm gonna add a couple more.\n\n71\n00:03:40,680 --> 00:03:46,815\nI wanna do an install-DNS so we can have\nDNS on this child domain controller.\n\n72\n00:03:46,815 --> 00:03:50,585\nAnd I'm also gonna go ahead and\ncreate a DNS delegation.\n\n73\n00:03:50,585 --> 00:03:55,277\nThat way it'll go ahead and it'll go up\nto that forest root, it'll go to that DNS\n\n74\n00:03:55,277 --> 00:03:59,279\nserver, and delegate authority for\nthat portion of the name space,\n\n75\n00:03:59,279 --> 00:04:02,946\nlab.itprotv.net to the DNS\nserver that I'm creating here.\n\n76\n00:04:02,946 --> 00:04:05,858\nAnd that's just going to save me\ntime from having to go back and\n\n77\n00:04:05,858 --> 00:04:07,660\ndo that as an extra step in the future.\n\n78\n00:04:07,660 --> 00:04:10,771\nSo we'll create that DNS delegation.\n\n79\n00:04:10,771 --> 00:04:14,440\nAs we saw in some previous segments,\nI could go through, and I could,\n\n80\n00:04:14,440 --> 00:04:18,425\na change where the database in being\ninstalled and the log files and sys log,\n\n81\n00:04:18,425 --> 00:04:20,640\nI'm just going to skip that here.\n\n82\n00:04:20,640 --> 00:04:22,660\nI'm also gonna skip the prechecks.\n\n83\n00:04:22,660 --> 00:04:26,360\nIn the real world you would obviously want\nto go through those pre-req checks to make\n\n84\n00:04:26,360 --> 00:04:30,035\nsure the server had everything you needed,\nthat to be a functional domain controller.\n\n85\n00:04:30,035 --> 00:04:34,955\nTo speed things up here I'm just gonna\ngo ahead and say SkipPreChecks, and\n\n86\n00:04:34,955 --> 00:04:36,015\ndouble check.\n\n87\n00:04:36,015 --> 00:04:40,425\nOne other parameter I'm not gonna use,\nbut we could do a DomainType, all right?\n\n88\n00:04:41,545 --> 00:04:45,880\nNow, DomainType, cuz if I'm adding\nan additional domain to a forest I could\n\n89\n00:04:45,880 --> 00:04:50,760\nbe adding, as Don says, as an additional\ndomain in that tree, like a child domain.\n\n90\n00:04:50,760 --> 00:04:53,400\nI could also be making a new tree,\nlike he said, EdutainmentLive.\n\n91\n00:04:54,480 --> 00:04:58,740\nIn which case, I would just specify\ntree domain instead of child.\n\n92\n00:04:58,740 --> 00:05:01,670\nI could do tree domain,\nI could also do child domain.\n\n93\n00:05:03,810 --> 00:05:08,640\nAnd if I don't specify anything, it's\ngonna assume or default to child domain.\n\n94\n00:05:08,640 --> 00:05:09,679\nWe'll go ahead and run that.\n\n95\n00:05:10,880 --> 00:05:15,654\nAnd it's gonna ask me what\ncredentials am I gonna use to add\n\n96\n00:05:15,654 --> 00:05:20,246\nthis domain to the forest and\nthat's gonna be ITProTv.\n\n97\n00:05:20,246 --> 00:05:24,870\nUse my administrator account and\nour super secret password.\n\n98\n00:05:24,870 --> 00:05:27,560\nAnd then it needs me to set the DSRM.\n\n99\n00:05:27,560 --> 00:05:30,480\nRight, my directory service\nrestore mode password.\n\n100\n00:05:30,480 --> 00:05:34,530\nI could specify that parameter in\nthe command itself, but again for\n\n101\n00:05:34,530 --> 00:05:37,410\nsecurity reasons, so I don't want to type\nit inline, I'm gonna let it prompt me.\n\n102\n00:05:37,410 --> 00:05:39,400\nAnd you'll see it puts\nthe little asterisks up there so\n\n103\n00:05:39,400 --> 00:05:41,090\nnobody can shoulder surf that password.\n\n104\n00:05:43,002 --> 00:05:46,270\nAll right, then I'll say yes to\nmake this guy a domain controller.\n\n105\n00:05:47,710 --> 00:05:49,970\nAnd now it's gonna go through the process.\n\n106\n00:05:49,970 --> 00:05:53,430\nI'm gonna to get the same warnings I\nwould get if I'm doing this in the GUI,\n\n107\n00:05:53,430 --> 00:05:58,340\nbecause 2012 R2 has some security settings\nthat are not gonna allow me to have some\n\n108\n00:05:58,340 --> 00:06:00,240\nof my older domain controllers present.\n\n109\n00:06:00,240 --> 00:06:03,710\nAnd that should be the only one I\nget because it's going to be able to\n\n110\n00:06:03,710 --> 00:06:06,180\ncreate that delegation up\nthere with the force group.\n\n111\n00:06:07,480 --> 00:06:09,870\n>> And now it's going to take a moment to\nrun because of what it's got to do, and\n\n112\n00:06:09,870 --> 00:06:12,840\nthis is actually a little more involved\nthan the one that created forest.\n\n113\n00:06:12,840 --> 00:06:16,480\nWhen we created a forest, an empty copy\nof the active directory was copied,\n\n114\n00:06:16,480 --> 00:06:19,610\nnot emptied, but\na template copy was put in place.\n\n115\n00:06:19,610 --> 00:06:23,560\nBut here, it's actually gotta reach\nout to the infrastructure master, and\n\n116\n00:06:23,560 --> 00:06:26,380\nthe domain mastery and\nclear the name that we chose,\n\n117\n00:06:26,380 --> 00:06:29,450\ncopy down some of the configuration\npreditions, that kind of stuff.\n\n118\n00:06:29,450 --> 00:06:31,620\nAnd, that can make this\ntake a little bit longer.\n\n119\n00:06:31,620 --> 00:06:34,670\nWhen it's done,\nthe system will need to reboot.\n\n120\n00:06:34,670 --> 00:06:37,200\nAnd so there's not a whole lot of\npoint in us sitting here watching\n\n121\n00:06:37,200 --> 00:06:37,880\nthat as it happens.\n\n122\n00:06:37,880 --> 00:06:40,490\nYou can see it's starting\nto churn along there.\n\n123\n00:06:40,490 --> 00:06:42,910\nWhy don't we do this,\nwhy don't we take a quick pause here.\n\n124\n00:06:42,910 --> 00:06:45,020\nWe'll let it run and\nthen it's gonna reboot.\n\n125\n00:06:45,020 --> 00:06:47,380\nAnd as soon as it's done rebooting,\nwe'll pick back up and\n\n126\n00:06:47,380 --> 00:06:50,050\nwe'll verify that our\ndomain has been created.\n\n127\n00:06:50,050 --> 00:06:51,569\nSo stay tuned,\nwe'll be back in just a moment.\n\n128\n00:06:51,569 --> 00:06:56,514\n[MUSIC]\n\n129\n00:06:59,764 --> 00:07:02,910\nAll right, so our server's rebooted and\nnow we're ready to rock.\n\n130\n00:07:02,910 --> 00:07:04,150\nRight, Mike let's take\na look at what happened.\n\n131\n00:07:04,150 --> 00:07:04,690\n>> We should be good to go.\n\n132\n00:07:04,690 --> 00:07:05,760\nLet's see the results here.\n\n133\n00:07:05,760 --> 00:07:08,180\nSo the server rebooted,\nI'm gonna log back in.\n\n134\n00:07:08,180 --> 00:07:10,980\nI can see there's my domain name LAB.\n\n135\n00:07:10,980 --> 00:07:13,612\nI'll log in as that good\nold administrator account.\n\n136\n00:07:16,445 --> 00:07:18,630\nAnd wait for this guy to load up.\n\n137\n00:07:18,630 --> 00:07:22,630\nGive server manager a chance to fire\nup and collect all its information.\n\n138\n00:07:22,630 --> 00:07:24,718\nAnd in fact,\nwhile I'm waiting we'll come back and\n\n139\n00:07:24,718 --> 00:07:27,260\nverify server two is indeed\na domain controller.\n\n140\n00:07:27,260 --> 00:07:32,298\nWhile I'm waiting for server manager\nto load up, though, let's switch\n\n141\n00:07:32,298 --> 00:07:37,578\nback over to the forest root, and\nin my DNS console, I'll refresh this guy,\n\n142\n00:07:37,578 --> 00:07:42,860\nand here I can see where this guy is the\ndomain controller for IT PRO TV dot net,\n\n143\n00:07:42,860 --> 00:07:48,979\nand he's got his own ITPROTV.net, and now\nI have a delegation for lab.ITproTV.net.\n\n144\n00:07:48,979 --> 00:07:51,553\nSo that's pointing over\nthere to server two,\n\n145\n00:07:51,553 --> 00:07:55,610\nwho is that new domain controller\nwe just set up for lab.ITproTV.net.\n\n146\n00:07:55,610 --> 00:07:56,800\nSo that worked great.\n\n147\n00:07:56,800 --> 00:07:58,550\nThat create DNS delegation.\n\n148\n00:07:59,770 --> 00:08:03,820\nFlip back over to server two,\nwho is our new domain controller.\n\n149\n00:08:03,820 --> 00:08:08,390\nServer manager still gathering\nup all of its information.\n\n150\n00:08:08,390 --> 00:08:09,970\nThere it goes.\n\n151\n00:08:09,970 --> 00:08:13,140\nAnd that is the active directory\nin DNS listed over here.\n\n152\n00:08:13,140 --> 00:08:17,470\nI flip over to my DNS console,\nif it'll let me.\n\n153\n00:08:17,470 --> 00:08:18,850\nThe server managers,\n\n154\n00:08:18,850 --> 00:08:21,090\nyou've gotta wait until it's done\ncollecting this information.\n\n155\n00:08:21,090 --> 00:08:24,670\nIf you try to go before that,\nit just gets all angry.\n\n156\n00:08:24,670 --> 00:08:26,100\nAnd here we go, open up DNS.\n\n157\n00:08:28,230 --> 00:08:31,988\nAnd I should see that serve two\nis indeed a DNS server, and\n\n158\n00:08:31,988 --> 00:08:35,134\nhe's hosting his own for lab.itprotv.net.\n\n159\n00:08:35,134 --> 00:08:38,306\nI can see my records in there,\nI can see he has registered all of his\n\n160\n00:08:38,306 --> 00:08:41,290\ndomain controller records,\nKerberos held app.\n\n161\n00:08:41,290 --> 00:08:43,648\nI didn't make this guy a global catalog.\n\n162\n00:08:43,648 --> 00:08:46,980\nIt detected,\nlook like he's a global catalog,\n\n163\n00:08:46,980 --> 00:08:49,990\nbut I could always go back in sites and\nservices and do that.\n\n164\n00:08:49,990 --> 00:08:54,060\nSo there we see how we can use\npowershell to add that child demand.\n\n165\n00:08:54,060 --> 00:08:55,850\nIn fact, I could show you one more thing.\n\n166\n00:08:55,850 --> 00:08:59,225\nIf I pull up my active directory,\ndomains and trusts.\n\n167\n00:09:03,962 --> 00:09:05,864\n[NOISE] And we take a peek in here,\n\n168\n00:09:05,864 --> 00:09:10,023\nwe'll just verify that that trust\nrelationship got established, so\n\n169\n00:09:10,023 --> 00:09:14,689\nI'll expand that ITproTV.net,\nsure enough there's lab.ITproTV.net.\n\n170\n00:09:14,689 --> 00:09:18,686\nIf I pull up the properties for that guy\nand go over to the trust tab, I will see\n\n171\n00:09:18,686 --> 00:09:22,960\nthat it has trust with ITProTV.net and\nit is a parent child trust relationship.\n\n172\n00:09:23,980 --> 00:09:27,200\nSo there you have it,\nhow we can add a second domain or\n\n173\n00:09:27,200 --> 00:09:31,440\nan additional domain, it can be a second,\nthird or fourth domain to our force.\n\n174\n00:09:31,440 --> 00:09:36,270\nWe use that install dash\nADDS4s to do the first one.\n\n175\n00:09:36,270 --> 00:09:39,880\nThis one was the install-ADDS domain.\n\n176\n00:09:39,880 --> 00:09:44,450\nAnd I can do that again and again, right,\nif I wanted to add another child domain or\n\n177\n00:09:44,450 --> 00:09:47,740\na separate tree to that forest.\n\n178\n00:09:47,740 --> 00:09:49,590\n>> Yep,\nthat pretty much wraps that one up.\n\n179\n00:09:49,590 --> 00:09:53,380\nSo, there are a few other little examples\nwe'd like to do like bringing up a domain\n\n180\n00:09:53,380 --> 00:09:54,830\nin an active directory forest.\n\n181\n00:09:54,830 --> 00:09:58,360\nBut for right now, as far as bringing up\na child domain or a new one, that's it.\n\n182\n00:09:58,360 --> 00:10:00,130\nSo, I hope you guys enjoyed that.\n\n183\n00:10:00,130 --> 00:10:03,692\nStay tuned,\nwe've got more power shell coming up.\n\n184\n00:10:03,692 --> 00:10:09,519\n[MUSIC]\n\n",
          "vimeoId": "118259219"
        },
        {
          "description": "",
          "length": "642",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-3-installing_additional_dc-0109015.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-3-installing_additional_dc-0109015-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-3-installing_additional_dc-0109015-sm.jpg",
          "title": "Installing Additional DC",
          "transcript": "1\n00:00:00,000 --> 00:00:08,000\n[MUSIC]\n\n2\n00:00:08,000 --> 00:00:12,070\nIn this segment, we're gonna take a look\nat creating additional domain controllers\n\n3\n00:00:12,070 --> 00:00:13,208\nin an existing domain.\n\n4\n00:00:13,208 --> 00:00:16,568\nAnd this is probably, of the various\nexamples that we've done so far,\n\n5\n00:00:16,568 --> 00:00:18,390\nthis is probably the most common.\n\n6\n00:00:18,390 --> 00:00:19,040\nRight?\n\n7\n00:00:19,040 --> 00:00:22,400\nPeople don't create new forest and\nnew domains everyday.\n\n8\n00:00:22,400 --> 00:00:25,370\nBut people do create new domain\ncontrollers all of the time for\n\n9\n00:00:25,370 --> 00:00:27,980\nexisting domains and forests.\n\n10\n00:00:27,980 --> 00:00:31,170\nYou'll see the process is actually\npretty straight forward, right Mike?\n\n11\n00:00:31,170 --> 00:00:31,925\n>> It really is.\n\n12\n00:00:31,925 --> 00:00:33,750\nA pretty straight forward command.\n\n13\n00:00:33,750 --> 00:00:39,380\nI've got a server here, we've already got\nour domain set up we've got ITProTV.net.\n\n14\n00:00:39,380 --> 00:00:41,272\nAnd what I've done is I've\nbrought up another server,\n\n15\n00:00:41,272 --> 00:00:43,580\nand I want to add a second\ndomain controller.\n\n16\n00:00:43,580 --> 00:00:46,980\nAs Don said, this is something you do\nmuch more regularly for fault tolerance,\n\n17\n00:00:46,980 --> 00:00:50,310\nfor deploying out to a new office,\nor something like that.\n\n18\n00:00:50,310 --> 00:00:54,290\nSo the command, once I've got that roll\ninstalled, if you've watched the previous\n\n19\n00:00:54,290 --> 00:01:00,200\nsegments, to create the domain,\nit was install-adds domain.\n\n20\n00:01:00,200 --> 00:01:03,200\nOnce you've got the domain created,\nnow when you're adding another domain\n\n21\n00:01:03,200 --> 00:01:05,240\ncontroller, you're not creating\nanother domain, right?\n\n22\n00:01:05,240 --> 00:01:08,265\nYou're adding a domain controller to\nan existing domain if you think back\n\n23\n00:01:08,265 --> 00:01:09,230\nto your GUI.\n\n24\n00:01:09,230 --> 00:01:11,458\nSo the command, the noun,\nis slightly different.\n\n25\n00:01:11,458 --> 00:01:18,667\nIt's gonna be\ninstall-ADDSDomainController, right?\n\n26\n00:01:18,667 --> 00:01:20,750\nInstead of just ADDSDomain.\n\n27\n00:01:20,750 --> 00:01:22,780\nAnd then the parameters\nare pretty straightforward.\n\n28\n00:01:22,780 --> 00:01:25,400\nAs always, there's a whole bunch\nof parameters that you can use.\n\n29\n00:01:25,400 --> 00:01:27,880\nI'm gonna give you guys a link\nto Technet so you can go out and\n\n30\n00:01:27,880 --> 00:01:29,560\nsee some of those additional parameters.\n\n31\n00:01:29,560 --> 00:01:32,740\nBut if you just need a second or\nthird or fourth domain controller,\n\n32\n00:01:32,740 --> 00:01:37,130\nall you need to do is use the command\ninstall-ADDSDomainController.\n\n33\n00:01:37,130 --> 00:01:38,310\nI am going to put DNS on here.\n\n34\n00:01:38,310 --> 00:01:43,720\nSo I'll do a little install,\nor -installdns.\n\n35\n00:01:43,720 --> 00:01:48,520\nAnd then the name of the domain that\nI'm adding this domain controller to.\n\n36\n00:01:48,520 --> 00:01:49,990\nThe parameter is going to be domain name.\n\n37\n00:01:49,990 --> 00:01:56,635\nAnd the name of the domain I'm adding\nthis to is going to be ITProTV.net.\n\n38\n00:02:01,540 --> 00:02:07,460\nLet's see if I am going to,\nI'm logged onto this guy as local.\n\n39\n00:02:07,460 --> 00:02:10,440\nI probably am going to\nneed credentials for that.\n\n40\n00:02:10,440 --> 00:02:11,855\nLet's see what it says.\n\n41\n00:02:11,855 --> 00:02:13,290\n>> [LAUGH] Wait a minute.\n\n42\n00:02:13,290 --> 00:02:15,470\nYou need credentials to be able\nto promote a domain controller?\n\n43\n00:02:15,470 --> 00:02:16,390\nWhat's that all about?\n\n44\n00:02:16,390 --> 00:02:20,470\n>> I was trying to think if I\nset this guy as a, I guess.\n\n45\n00:02:20,470 --> 00:02:24,470\nSo let me add, all I'm gonna do is\nadd a credentials switch to this.\n\n46\n00:02:24,470 --> 00:02:27,520\nSo just like we did in our previous\nsegment, I'm gonna do a -credential.\n\n47\n00:02:27,520 --> 00:02:29,570\n>> Mike, your head's covering that up so\nwe can't see it all.\n\n48\n00:02:29,570 --> 00:02:30,945\n>> Sorry,\nlet's bring that up a little bit.\n\n49\n00:02:30,945 --> 00:02:32,885\nOr let's just clear that\nscreen a little bit.\n\n50\n00:02:32,885 --> 00:02:35,800\n[LAUGH] All right, so\nwe'll do that one more time.\n\n51\n00:02:35,800 --> 00:02:38,760\nSo what I'm gonna do is I'm gonna take\nthat same command that I ran, and\n\n52\n00:02:38,760 --> 00:02:41,600\nI'm gonna add a -credential.\n\n53\n00:02:41,600 --> 00:02:43,520\nBecause this guy's not a member server,\nright?\n\n54\n00:02:43,520 --> 00:02:44,920\nHe's in a work group right now.\n\n55\n00:02:44,920 --> 00:02:48,120\nSo I'm logged on as a local admin\nwho's not gonna have any rights within\n\n56\n00:02:48,120 --> 00:02:50,470\nthe domain that I'm trying to add this to.\n\n57\n00:02:50,470 --> 00:02:56,180\nSo -credential and\nthen I'll do a get -credential\n\n58\n00:02:56,180 --> 00:03:00,770\nto have it prompt me for\nthose credentials, all right?\n\n59\n00:03:00,770 --> 00:03:09,050\nSo there we go, I'm going to\ngive it ITProTV\\administrator.\n\n60\n00:03:09,050 --> 00:03:12,208\nMake sure I spell that right.\n\n61\n00:03:12,208 --> 00:03:16,917\nAnd then my DSRM password, my\nDirectory Service Restore Mode password.\n\n62\n00:03:21,375 --> 00:03:25,312\nAnd there it goes, it's gonna run through\nthe process of creating that additional\n\n63\n00:03:25,312 --> 00:03:26,333\ndomain controller.\n\n64\n00:03:26,333 --> 00:03:28,805\nAnother switch, as I said,\nI'll give you guys a link to TechNet so\n\n65\n00:03:28,805 --> 00:03:30,495\nyou can go out and\nlook at all the parameters.\n\n66\n00:03:30,495 --> 00:03:35,370\nAnother one you might find useful\nin some situations, is there is a,\n\n67\n00:03:35,370 --> 00:03:37,810\noh gosh, if I can remember the actual\nwording of this parameter.\n\n68\n00:03:37,810 --> 00:03:39,840\nYou can actually skip\na lot of the initial,\n\n69\n00:03:39,840 --> 00:03:42,700\nit's called dash critical replication.\n\n70\n00:03:42,700 --> 00:03:46,370\nAnd what it'll do is, instead of\nreplicating the entire active directory\n\n71\n00:03:46,370 --> 00:03:51,030\ndatabase and getting it all set up before\nthe reboot, it'll just do the critical\n\n72\n00:03:51,030 --> 00:03:53,820\nreplication and go ahead and reboot and\nget that guy up and running.\n\n73\n00:03:53,820 --> 00:03:57,830\nAnd then it will replicate\nthe other noncritical information\n\n74\n00:03:57,830 --> 00:03:59,340\nas it has time in the background.\n\n75\n00:03:59,340 --> 00:04:01,120\nSo, it can kind of speed up the process,\nor\n\n76\n00:04:01,120 --> 00:04:03,679\nthe deployment, of new domain controllers.\n\n77\n00:04:05,060 --> 00:04:06,750\nWhile that guy's running,\n\n78\n00:04:06,750 --> 00:04:10,870\nwhat I was gonna show you next is\na read-only domain controller.\n\n79\n00:04:10,870 --> 00:04:12,360\nSo, that's the command for\n\n80\n00:04:12,360 --> 00:04:16,090\ninstalling an additional domain\ncontroller in an existing domain.\n\n81\n00:04:16,090 --> 00:04:20,563\nAnother thing that we can do from\nPowerShell is to create a read-only domain\n\n82\n00:04:20,563 --> 00:04:21,340\ncontroller.\n\n83\n00:04:21,340 --> 00:04:24,975\nThe command is actually the same\ncommandlet, so it's going to be\n\n84\n00:04:24,975 --> 00:04:30,980\ninstall-ADSDomainController, just\nlike we did just now.\n\n85\n00:04:30,980 --> 00:04:36,730\nThe difference is, we're gonna add\nthis -ReadOnlyReplica, all right?\n\n86\n00:04:36,730 --> 00:04:41,125\nThat's going to indicate that it is\na Read Only Domain Controller, or an RODC.\n\n87\n00:04:41,125 --> 00:04:43,645\nYou could stop there.\n\n88\n00:04:43,645 --> 00:04:46,295\nThere's some other parameters\nyou can use if you're doing\n\n89\n00:04:46,295 --> 00:04:47,435\na Read Only Domain Controller.\n\n90\n00:04:47,435 --> 00:04:50,979\nLike, you might want to go ahead and set\nwho the delegated administrator account is\n\n91\n00:04:50,979 --> 00:04:54,080\ngoing to be, or what group is going\nto have administrator permissions.\n\n92\n00:04:54,080 --> 00:04:57,560\nRemember we've learned that with\nan RODC you actually have a local\n\n93\n00:04:57,560 --> 00:05:00,060\nadmins group that you can give\nsomebody permissions over.\n\n94\n00:05:00,060 --> 00:05:01,670\nAnother useful parameter you'll find for\n\n95\n00:05:01,670 --> 00:05:06,640\nRODCs is this\n-AllowPasswordReplicationAccountName.\n\n96\n00:05:06,640 --> 00:05:11,270\nRemember RODCs do not cache passwords or\nany passwords by default.\n\n97\n00:05:11,270 --> 00:05:14,620\nWe get to pick and choose whose passwords\nare cached out there on that RODC.\n\n98\n00:05:14,620 --> 00:05:16,070\nThis is how I can go ahead and\n\n99\n00:05:16,070 --> 00:05:20,580\nspecify what user's passwords will\nbe allowed to be cached on that.\n\n100\n00:05:20,580 --> 00:05:23,130\nWhat I've done here is I've\nactually got an empty string.\n\n101\n00:05:23,130 --> 00:05:25,850\nI've got quote,\nquote with nothing in-between there.\n\n102\n00:05:25,850 --> 00:05:30,220\nThat's gonna ensure that that allow\npassword replication group list is blank.\n\n103\n00:05:30,220 --> 00:05:31,700\nThat there's nobody in there.\n\n104\n00:05:31,700 --> 00:05:36,670\nYou could also do\na -DenyPasswordReplecationAccountName,\n\n105\n00:05:36,670 --> 00:05:41,000\nwhich would let you set up the ones you\nwanted to insure were not replicated over\n\n106\n00:05:41,000 --> 00:05:46,400\nto that RODC, but the allow password\nreplication group is blank by default.\n\n107\n00:05:46,400 --> 00:05:49,440\nSo, I blanked it out anyway,\nbut it is blank by default.\n\n108\n00:05:49,440 --> 00:05:52,590\nThe denied RODC password\nreplication group is not blank.\n\n109\n00:05:52,590 --> 00:05:56,520\nThere is some key accounts in there that\nit already knows it's not supposed to\n\n110\n00:05:56,520 --> 00:05:57,510\nallow to be cached.\n\n111\n00:05:57,510 --> 00:06:00,560\nLike the domain admins,\nthe enterprise admins, scheme admins,\n\n112\n00:06:00,560 --> 00:06:01,460\nand things like that.\n\n113\n00:06:01,460 --> 00:06:03,640\nSo if I start that list in this parameter,\n\n114\n00:06:03,640 --> 00:06:05,250\nthen I would have to make\nsure I included all those.\n\n115\n00:06:05,250 --> 00:06:07,740\nBecause it would wipe it\nadd only what I added here.\n\n116\n00:06:07,740 --> 00:06:11,140\nSo typically you're not going to use\nthat parameter when you're running\n\n117\n00:06:11,140 --> 00:06:12,730\nthis command.\n\n118\n00:06:12,730 --> 00:06:15,000\nAlso if you had pre-created.\n\n119\n00:06:15,000 --> 00:06:18,682\nTypically we're going to pre-create\nthe read only domain controller account in\n\n120\n00:06:18,682 --> 00:06:20,000\nactive directory.\n\n121\n00:06:20,000 --> 00:06:25,780\nAnd if I have, then there's a command\ndash or a parameter -UseExistingAccount.\n\n122\n00:06:25,780 --> 00:06:28,340\nAnd that's gonna tell it to go look for\nthe account in active directory,\n\n123\n00:06:28,340 --> 00:06:29,610\nit's already there.\n\n124\n00:06:29,610 --> 00:06:33,430\nAnd to match up that physical server\nwith that account active directory.\n\n125\n00:06:33,430 --> 00:06:37,159\nSo just a few of those parameters we can\nuse if I'm trying to set up a read-only\n\n126\n00:06:37,159 --> 00:06:38,300\ndomain controller.\n\n127\n00:06:38,300 --> 00:06:39,960\nAgain, I've got links\nin the show notes here,\n\n128\n00:06:39,960 --> 00:06:42,560\nI'll make sure you have access to those.\n\n129\n00:06:42,560 --> 00:06:44,950\nSo that should have given\nserve two enough time.\n\n130\n00:06:44,950 --> 00:06:47,180\nLet's go back over there and\nsee what it's doing.\n\n131\n00:06:47,180 --> 00:06:49,840\nIt's in the process of\nrebooting as we speak.\n\n132\n00:06:51,280 --> 00:06:52,700\nSo we'll give this just\na second to pull up.\n\n133\n00:06:54,120 --> 00:06:56,920\nAnd what we should find is that I\nnow have a second domain controller,\n\n134\n00:06:56,920 --> 00:06:59,560\nin fact we could go over\nto serve one already.\n\n135\n00:06:59,560 --> 00:07:01,430\nAnd we could open up active directory.\n\n136\n00:07:02,940 --> 00:07:06,220\nAnd we should be able\nto see that account for\n\n137\n00:07:06,220 --> 00:07:09,340\nthat new domain controller\nthat we just created.\n\n138\n00:07:09,340 --> 00:07:11,780\nI'm gonna open up active\ndirectory users and computers,\n\n139\n00:07:11,780 --> 00:07:14,319\nbecause I'm old school and\nI don't like that.\n\n140\n00:07:14,319 --> 00:07:15,050\n[LAUGH].\n\n141\n00:07:15,050 --> 00:07:18,646\nAnd the active directory administrative\ncenter is the way we're supposed to\n\n142\n00:07:18,646 --> 00:07:19,148\ngo, but.\n\n143\n00:07:19,148 --> 00:07:23,124\nAnd there you can go, I can see that serve\ntwo is, indeed, a new domain controller,\n\n144\n00:07:23,124 --> 00:07:24,917\nI'm in that domain controller as OU.\n\n145\n00:07:24,917 --> 00:07:30,334\nSo I do now have a second domain\ncontroller for ITProTV.net.\n\n146\n00:07:30,334 --> 00:07:31,600\nWe'll flip back over.\n\n147\n00:07:31,600 --> 00:07:34,950\nServer one is still in\nthe process of connecting so,\n\n148\n00:07:35,990 --> 00:07:37,700\nwe'll give it a second there.\n\n149\n00:07:37,700 --> 00:07:40,310\n>> And like we said earlier,\nwe demonstrated in some of our earlier\n\n150\n00:07:40,310 --> 00:07:43,580\nsegments how to create new forests and\nhow create new domains.\n\n151\n00:07:43,580 --> 00:07:45,480\nBut those aren't things\nthat we do regularly.\n\n152\n00:07:45,480 --> 00:07:49,860\nAdding domain controllers like this is if\nyou're going to be adding a large number\n\n153\n00:07:49,860 --> 00:07:53,035\nof domain controllers to a domain,\nit's nice to be able to automate and\n\n154\n00:07:53,035 --> 00:07:55,672\nscript that and the PowerShell commands\ncome in really handy for that.\n\n155\n00:07:55,672 --> 00:07:58,260\n>> Absolutely yeah, this is definitely\none I'd want to write a script for,\n\n156\n00:07:58,260 --> 00:08:00,530\nmaybe set it up so it just prompted me for\n\n157\n00:08:00,530 --> 00:08:05,140\nthe name of the new domain controller or\nthe domain I was adding it to.\n\n158\n00:08:05,140 --> 00:08:09,190\nAnd everything else was already\ntyped out in that script.\n\n159\n00:08:09,190 --> 00:08:11,660\nSo I think, yeah, my nice black screen,\nlet me drop that down so\n\n160\n00:08:11,660 --> 00:08:13,520\nwe're just not looking at blackness there.\n\n161\n00:08:13,520 --> 00:08:14,940\n>> [LAUGH]\n>> He's taking a little while to reboot.\n\n162\n00:08:14,940 --> 00:08:16,260\nHe's getting everything set up.\n\n163\n00:08:16,260 --> 00:08:21,340\nHe's in applying, by default, the main\ncontroller policy, and things like that.\n\n164\n00:08:21,340 --> 00:08:23,680\nLogging in, setting up my profile for\n\n165\n00:08:23,680 --> 00:08:27,540\nthe first time since this is\nthe first time I logged onto here.\n\n166\n00:08:27,540 --> 00:08:28,390\nThere we go.\n\n167\n00:08:28,390 --> 00:08:30,395\nServer manager will open up in a minute,\nand\n\n168\n00:08:30,395 --> 00:08:34,570\nwe'll see that it's now a domain\ncontroller for ITProTV.net.\n\n169\n00:08:34,570 --> 00:08:36,690\n>> Yep, terribly, terribly exciting stuff.\n\n170\n00:08:36,690 --> 00:08:37,220\n>> I know, right?\n\n171\n00:08:37,220 --> 00:08:40,870\n>> The real power with this is that idea\nof the bulk deployment and when you're\n\n172\n00:08:40,870 --> 00:08:43,290\ndoing this with read only domain\ncontrollers, that's where I've seen it.\n\n173\n00:08:43,290 --> 00:08:47,430\nMaybe you work for a school system and you\nwanna place a read only domain controller\n\n174\n00:08:47,430 --> 00:08:50,250\nout at every location, so\nyou have 200 locations.\n\n175\n00:08:50,250 --> 00:08:51,680\nYou gonna be rolling out all these.\n\n176\n00:08:51,680 --> 00:08:55,400\nWell you don't wanna have to manually\nbuild 200 servers if you can avoid it.\n\n177\n00:08:55,400 --> 00:08:59,070\nSo you can just automate that, have them\ndeployed as a read only domain controller,\n\n178\n00:08:59,070 --> 00:08:59,710\nand off they go.\n\n179\n00:08:59,710 --> 00:09:01,650\nNow Mike's logging in here to verify.\n\n180\n00:09:01,650 --> 00:09:05,500\nYou don't actually have to log in to\nverify, we're just doing it to show it.\n\n181\n00:09:05,500 --> 00:09:07,920\nBut it's up, it's operational.\n\n182\n00:09:07,920 --> 00:09:11,870\nThe inter-site topology generator,\nISTG is kicking in and\n\n183\n00:09:11,870 --> 00:09:15,430\nbuilding the replication between this\ndomain controller and the existing ones.\n\n184\n00:09:15,430 --> 00:09:16,380\nAnd it's all automated.\n\n185\n00:09:16,380 --> 00:09:19,170\nMicrosoft has really made it easy,\nonce it's installed.\n\n186\n00:09:19,170 --> 00:09:19,880\n>> They really have.\n\n187\n00:09:19,880 --> 00:09:23,080\nAnd there, we can see active\ndirectory domain service listed.\n\n188\n00:09:23,080 --> 00:09:27,360\nIn fact, we want to go into sites and\nservices, and\n\n189\n00:09:27,360 --> 00:09:28,865\nverify what Don was just saying there.\n\n190\n00:09:28,865 --> 00:09:33,525\nWe can check and take a look at our\nreplication topology, that it's set up.\n\n191\n00:09:33,525 --> 00:09:34,795\n>> Here's hoping I'm right.\n\n192\n00:09:34,795 --> 00:09:35,320\n[LAUGH]\n>> [LAUGH]\n\n193\n00:09:35,320 --> 00:09:36,207\n>> So here's serve two, for\n\n194\n00:09:36,207 --> 00:09:37,515\nexample.\n>> Don said it.\n\n195\n00:09:37,515 --> 00:09:40,095\n>> I can see that it has,\nwell it's thinking about it.\n\n196\n00:09:40,095 --> 00:09:42,720\nIt probably hasn't finished running yet.\n\n197\n00:09:42,720 --> 00:09:46,780\nThere I can see the one from the DC, or\nserve one is already set up, coming back\n\n198\n00:09:46,780 --> 00:09:52,090\nto serve two, serve two will eventually\nget one going back over to server one.\n\n199\n00:09:52,090 --> 00:09:54,760\nSo indeed it is taking over,\nwhere it's good to go.\n\n200\n00:09:54,760 --> 00:09:56,530\n>> Yeah, sometimes you have to be patient.\n\n201\n00:09:56,530 --> 00:09:59,980\nAnd if you don't read only domain\ncontroller, that replication is one way so\n\n202\n00:09:59,980 --> 00:10:02,768\nyou may not see both directions on it,\nbut in this case, we will.\n\n203\n00:10:02,768 --> 00:10:06,170\nIf we just, if we had more\npatience than we actually do.\n\n204\n00:10:06,170 --> 00:10:09,240\n>> And it's a separate\nPowerShell command if you want\n\n205\n00:10:09,240 --> 00:10:11,790\nto pre-create that read-only\ndomain controller account.\n\n206\n00:10:11,790 --> 00:10:15,550\nAnd I'll make sure I throw that command\nin the show notes, as well for you guys.\n\n207\n00:10:15,550 --> 00:10:18,190\nAll right, so in this segment we got\na chance to see how to create a domain\n\n208\n00:10:18,190 --> 00:10:20,560\ncontroller for an existing domain.\n\n209\n00:10:20,560 --> 00:10:24,400\nIt was a pretty easy process, bringing up\nand then the machine goes on from there.\n\n210\n00:10:24,400 --> 00:10:25,990\nPretty useful stuff.\n\n211\n00:10:25,990 --> 00:10:27,650\nAlright, well I hope you\nguys enjoyed the segment.\n\n212\n00:10:27,650 --> 00:10:29,572\nIf you want to learn more, stay tuned,\n\n213\n00:10:29,572 --> 00:10:31,917\nbecause we've got more\nPowerShell coming up.\n\n214\n00:10:31,917 --> 00:10:39,583\n[MUSIC]\n\n215\n00:10:39,583 --> 00:10:41,970\nAll right, we'll save those notes for\n\n",
          "vimeoId": "117181097"
        },
        {
          "description": "",
          "length": "601",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-5-managing_ous-011215.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-5-managing_ous-011215-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-5-managing_ous-011215-sm.jpg",
          "title": "Managing OUs",
          "transcript": "1\n00:00:00,000 --> 00:00:08,113\n[MUSIC]\n\n2\n00:00:08,113 --> 00:00:09,005\nIn this segment,\n\n3\n00:00:09,005 --> 00:00:13,760\nwe're gonna be taking a look at managing\norganizational units with the PowerShell.\n\n4\n00:00:13,760 --> 00:00:16,940\nOrganizational units are a pretty key\npiece inside of the active directory.\n\n5\n00:00:16,940 --> 00:00:20,020\nBecause they're how we sort our various\nuser accounts, computer accounts,\n\n6\n00:00:20,020 --> 00:00:20,890\nand other items.\n\n7\n00:00:20,890 --> 00:00:24,490\nAnd if you're applying group policy\nobjects organizational units are kind of\n\n8\n00:00:24,490 --> 00:00:27,340\nthat key thing that defines\nwhere they're going to apply.\n\n9\n00:00:27,340 --> 00:00:28,680\nSo they're real important.\n\n10\n00:00:28,680 --> 00:00:31,130\nWell, most of us don't create\nthese on a daily basis but\n\n11\n00:00:31,130 --> 00:00:35,270\nif you're ever in a situation where you\nneed to create a large quantity of OU's.\n\n12\n00:00:35,270 --> 00:00:38,510\nIt is far easier to script it and\nautomate it from the PowerShell\n\n13\n00:00:38,510 --> 00:00:41,640\nthan it is to go to the GUI and\nmanually create OU after OU.\n\n14\n00:00:41,640 --> 00:00:43,910\nSo, that's what we're going\nto be taking a look at and\n\n15\n00:00:43,910 --> 00:00:46,370\nMike you've got some great\nexamples lined up for us, right?\n\n16\n00:00:46,370 --> 00:00:48,020\n>> I do, so\nlets take a look at my screen here.\n\n17\n00:00:48,020 --> 00:00:51,880\nThe first thing we're going to do is\nsimply create an organizational unit.\n\n18\n00:00:51,880 --> 00:00:57,030\nAnd the command is pretty straight forward\nits just new-ad organizational unit.\n\n19\n00:00:57,030 --> 00:01:01,240\nAs with most of our PowerShell commands,\nthere's several parameters we can use,\n\n20\n00:01:01,240 --> 00:01:02,840\nmost of them optional.\n\n21\n00:01:02,840 --> 00:01:05,360\nIn fact, the only required parameter\n\n22\n00:01:05,360 --> 00:01:08,480\nis going to be the name that you want\nto give that organizational unit.\n\n23\n00:01:08,480 --> 00:01:13,100\nSo if I just do new-AD organizational unit\nand then the name test and hit enter.\n\n24\n00:01:13,100 --> 00:01:15,680\nYou see I don't get any red text back and\n\n25\n00:01:15,680 --> 00:01:19,320\nif I flip back over to active\ndirectory and refresh that console.\n\n26\n00:01:19,320 --> 00:01:23,050\nThere is my new organizational\nunit called test.\n\n27\n00:01:23,050 --> 00:01:24,245\nAll right, so very simple.\n\n28\n00:01:24,245 --> 00:01:27,840\nNew-AD organizational unit and\nthen the name of the OU.\n\n29\n00:01:27,840 --> 00:01:29,230\nLet's take it a step further, though.\n\n30\n00:01:29,230 --> 00:01:32,370\nLet's do a new-AD organizational unit.\n\n31\n00:01:32,370 --> 00:01:34,150\nAnd for the first one I'm\ngoing to kind of copy that.\n\n32\n00:01:34,150 --> 00:01:36,290\nI want to make one called user accounts.\n\n33\n00:01:36,290 --> 00:01:37,700\nThe parameter,\n\n34\n00:01:37,700 --> 00:01:41,450\nyou'll notice on the previous example\nI didn't specify any parameters.\n\n35\n00:01:41,450 --> 00:01:42,910\nI just put the word test.\n\n36\n00:01:42,910 --> 00:01:44,960\nIt assumes it's the only\nrequired parameter.\n\n37\n00:01:44,960 --> 00:01:47,780\nIt's a positional parameter,\nI don't need anything else.\n\n38\n00:01:47,780 --> 00:01:52,590\nBut I could do a -name, and then the name\nI wanted to give the organizational unit.\n\n39\n00:01:52,590 --> 00:01:55,090\nLike user accounts for example.\n\n40\n00:01:57,140 --> 00:01:59,360\nAgain, I go back in and\nlook at active directory and\n\n41\n00:01:59,360 --> 00:02:04,080\nI'll see that at the root, I should\nhave a new OU called user accounts.\n\n42\n00:02:05,570 --> 00:02:07,890\nThat works well because I\ndidn't provide the path,\n\n43\n00:02:07,890 --> 00:02:11,380\nI didn't tell it where in active directory\nI wanted to make the organizational unit.\n\n44\n00:02:11,380 --> 00:02:15,230\nSo it just had to assume\nthat the root of my domain.\n\n45\n00:02:15,230 --> 00:02:17,050\nBut, if we want to start nesting OUs,\n\n46\n00:02:17,050 --> 00:02:21,390\nget a little fancy, we're going to\nchange this up just a little bit.\n\n47\n00:02:21,390 --> 00:02:23,570\nI'm going to create one called employees.\n\n48\n00:02:25,170 --> 00:02:28,720\nAnd I want to make it inside\nthat user accounts OU.\n\n49\n00:02:28,720 --> 00:02:32,840\nSo, all I'm going to do is I'm going\nto add a -path parameter and then\n\n50\n00:02:32,840 --> 00:02:36,390\nthe distinguished name, or the location,\nof where I want to create the OU.\n\n51\n00:02:36,390 --> 00:02:40,463\nSo in this case, I want to make it inside\nthat other OU called user accounts.\n\n52\n00:02:42,320 --> 00:02:45,938\nAnd then as with most of our\ndistinguished names, OU=useraccounts,\n\n53\n00:02:45,938 --> 00:02:47,879\nand then all of my domain components.\n\n54\n00:02:47,879 --> 00:02:52,343\nSo dc=itprotv, dc=net,\n\n55\n00:02:52,343 --> 00:02:58,682\nif I make sure I type that in there right.\n\n56\n00:02:58,682 --> 00:03:00,390\n>> [LAUGH]\n>> DC=net, and\n\n57\n00:03:00,390 --> 00:03:04,450\nmy quote,\nI should be able to enter no red text.\n\n58\n00:03:04,450 --> 00:03:07,665\nWe flip back over to active directory and\ndo a little refresh.\n\n59\n00:03:07,665 --> 00:03:12,335\nAnd now inside user accounts I\nhave a nested OU called employees.\n\n60\n00:03:12,335 --> 00:03:14,365\nAnd that's typically what we're doing,\nright?\n\n61\n00:03:14,365 --> 00:03:19,115\nWe're organizing my objects so that I\ncan delegate administrative control and\n\n62\n00:03:19,115 --> 00:03:21,100\nscope my group policies.\n\n63\n00:03:21,100 --> 00:03:25,170\nSo we're nesting our OU's according\nto whatever our business model is.\n\n64\n00:03:26,550 --> 00:03:29,290\nBut once you get them created,\nagain there's a lot of other parameters.\n\n65\n00:03:29,290 --> 00:03:32,560\nI've got a link in the show notes that I\ngive you to Tech Net that will give you\n\n66\n00:03:32,560 --> 00:03:35,670\na bunch of additional parameters\nthat you can set on there.\n\n67\n00:03:37,450 --> 00:03:38,730\nOther things we might wanna do.\n\n68\n00:03:38,730 --> 00:03:41,780\nOnce we've got those OUs created,\nwe might want go back and\n\n69\n00:03:41,780 --> 00:03:44,340\nmodify an organizational unit.\n\n70\n00:03:44,340 --> 00:03:47,260\nSo one example of that might\nbe adding a description.\n\n71\n00:03:47,260 --> 00:03:50,630\nAnd the command, remember,\nare new creates.\n\n72\n00:03:50,630 --> 00:03:51,810\nWe switch that verb and\n\n73\n00:03:51,810 --> 00:03:56,230\nwe change it to a set instead of new,\nnow we're modifying an existing object.\n\n74\n00:03:56,230 --> 00:04:00,440\nSo it's just gonna be\nset-ad organizational unit.\n\n75\n00:04:00,440 --> 00:04:02,860\nAnd then the parameter\nthat you want to modify.\n\n76\n00:04:04,030 --> 00:04:08,130\nI might do a -description or\nsomething like that.\n\n77\n00:04:08,130 --> 00:04:11,820\nAnd maybe we put default.\n\n78\n00:04:14,110 --> 00:04:16,470\nOh, let me take that back.\n\n79\n00:04:16,470 --> 00:04:17,020\nOne second,\n\n80\n00:04:17,020 --> 00:04:21,240\nI do have to tell it that I'm not creating\none, I'm modifying an existing one.\n\n81\n00:04:21,240 --> 00:04:24,770\nSo I really need to tell it which\nobject I'm going to be modifying.\n\n82\n00:04:24,770 --> 00:04:29,770\nInstead of a -name,\nit's actually a dash identity parameter.\n\n83\n00:04:29,770 --> 00:04:36,280\nSo a little bit different, if I modify\nthat, let's do the ou=useraccounts\n\n84\n00:04:37,952 --> 00:04:42,813\ndc=itprotv, dc=, what are we doing,\n.net in this one, so\n\n85\n00:04:42,813 --> 00:04:48,710\nthere's the distinguished name for\nthe object that I'm trying to modify.\n\n86\n00:04:50,010 --> 00:04:53,930\nAnd then the parameter I want\nto modify is description, and\n\n87\n00:04:53,930 --> 00:04:57,419\nI'm just going to put the default OU for\n\n88\n00:04:57,419 --> 00:05:03,560\nuser accounts and my quote.\n\n89\n00:05:03,560 --> 00:05:04,730\nHit enter.\n\n90\n00:05:04,730 --> 00:05:06,770\nAnd if we want to go back and\ntake a look at that,\n\n91\n00:05:06,770 --> 00:05:08,530\nI should be able to pull\nup the properties for that.\n\n92\n00:05:08,530 --> 00:05:11,047\nLet's just do a little refresh here.\n\n93\n00:05:14,018 --> 00:05:16,760\nAnd it didn't seem to set my description,\ninteresting.\n\n94\n00:05:18,490 --> 00:05:20,410\nAll right so\nthat's how I modify those guys.\n\n95\n00:05:20,410 --> 00:05:23,380\nI might have to find out why it\ndidn't set that description properly.\n\n96\n00:05:23,380 --> 00:05:24,730\nThere's my description.\n\n97\n00:05:24,730 --> 00:05:27,765\nIt's just not showing on my screen\nout here, normally it would,\n\n98\n00:05:27,765 --> 00:05:29,380\nwe'll figure that out later.\n\n99\n00:05:29,380 --> 00:05:30,670\nSo that's how you go back and modify.\n\n100\n00:05:30,670 --> 00:05:33,190\nAll you're doing is\na set-adorganizationunit.\n\n101\n00:05:33,190 --> 00:05:36,980\nThe identity of the OU that\nyou're trying to modify,\n\n102\n00:05:36,980 --> 00:05:40,510\nand then the particular parameter\nthat you're trying change.\n\n103\n00:05:41,630 --> 00:05:44,450\nSo there's create an OU,\nmodify an existing OU.\n\n104\n00:05:44,450 --> 00:05:49,249\nThe only thing that really leaves us\nis removing an organizational unit.\n\n105\n00:05:50,400 --> 00:05:51,620\nSo let's take a look.\n\n106\n00:05:51,620 --> 00:05:54,150\nLet me flip back over to\nactive directory real quick.\n\n107\n00:05:55,600 --> 00:05:58,970\nAnd I've got an OU called test that\nwe created in the very beginning.\n\n108\n00:05:59,980 --> 00:06:01,930\nNow if I want to delete that.\n\n109\n00:06:01,930 --> 00:06:02,710\nAll right, if we want to remove it,\n\n110\n00:06:02,710 --> 00:06:06,660\nthe command is just gonna be\nremove -ad organizational unit.\n\n111\n00:06:06,660 --> 00:06:08,790\nSome of you might know\nwhere I'm going with this.\n\n112\n00:06:08,790 --> 00:06:12,442\nLet's see if you catch on, remove-ad\n\n113\n00:06:12,442 --> 00:06:17,990\norganizational unit, and then the name\nof the OU that I want to remove.\n\n114\n00:06:17,990 --> 00:06:21,010\nReally need the distinguish name\njust cuz it's at the root so\n\n115\n00:06:21,010 --> 00:06:23,150\nit should be okay if we're\njust using the name.\n\n116\n00:06:23,150 --> 00:06:25,110\nSo you're going to work on,\nwhat do you think?\n\n117\n00:06:25,110 --> 00:06:26,410\n>> Well, you know,\nit's like you always say.\n\n118\n00:06:26,410 --> 00:06:29,085\nRemember what happens in\nthe graphical user interface, right?\n\n119\n00:06:29,085 --> 00:06:30,430\n>> Mm-hm.\n>> If you try and\n\n120\n00:06:30,430 --> 00:06:34,450\ndelete an OU,\never since Windows Server 2003,\n\n121\n00:06:34,450 --> 00:06:37,570\nthere's a little feature in there\nthat's going to stop that from working.\n\n122\n00:06:37,570 --> 00:06:38,560\n>> Exactly.\n\n123\n00:06:38,560 --> 00:06:40,670\nAnd just to show you guys, I'm going\nto use the distinguished name and\n\n124\n00:06:40,670 --> 00:06:43,110\nmake sure that's not why\nwe're getting the error.\n\n125\n00:06:43,110 --> 00:06:51,109\nLet's do a remove-ad\norganizational unit OU = test,\n\n126\n00:06:51,109 --> 00:06:56,563\ndc equals IT Pro TV, dc= equals net.\n\n127\n00:06:58,768 --> 00:07:01,255\nIt says yes I want to remove it,\nI hit a Y.\n\n128\n00:07:02,635 --> 00:07:05,135\nAnd you'll notice I get access is denied.\n\n129\n00:07:05,135 --> 00:07:08,055\nSo what Don is referring to remember\n\n130\n00:07:08,055 --> 00:07:11,750\nnow from when we created a new\norganizational unit by default.\n\n131\n00:07:11,750 --> 00:07:15,000\nThe protect from accidental\ndeletion check mark is checked.\n\n132\n00:07:15,000 --> 00:07:17,160\nIf we go back over to active directory and\n\n133\n00:07:17,160 --> 00:07:20,820\nI pull up the properties of test and\nI've already turned on my advanced view.\n\n134\n00:07:20,820 --> 00:07:23,250\nRemember you don't get to\nsee that object tab if\n\n135\n00:07:23,250 --> 00:07:26,340\nyou don't have your advanced view\nturned on in active directory.\n\n136\n00:07:26,340 --> 00:07:29,410\nAnd there I can see,\nprotect object from accidental deletion.\n\n137\n00:07:30,790 --> 00:07:33,890\n>> It's a funny feature because it's not\nreally protecting you from deletion so\n\n138\n00:07:33,890 --> 00:07:38,100\nmuch as it is accidentally dragging and\ndropping this to another location.\n\n139\n00:07:38,100 --> 00:07:40,060\nSo that was a real problem in the GUI.\n\n140\n00:07:40,060 --> 00:07:43,840\nFrom the PowerShell, it's not a problem\nbut the feature still applies.\n\n141\n00:07:43,840 --> 00:07:46,550\nWe've gotta remember to disable\nthat before we move forward.\n\n142\n00:07:46,550 --> 00:07:47,610\n>> Exactly.\n\n143\n00:07:47,610 --> 00:07:48,560\nSo all we're gonna do,\n\n144\n00:07:48,560 --> 00:07:51,360\nnow I could have unchecked that\nright there in the GUI, right, but.\n\n145\n00:07:51,360 --> 00:07:51,960\n>> That's cheating.\n\n146\n00:07:51,960 --> 00:07:54,770\n>> This is a PowerShell show,\nso let's not do that.\n\n147\n00:07:54,770 --> 00:07:56,880\nSo what I'm gonna do is I'm\ngonna use my set command.\n\n148\n00:07:58,210 --> 00:08:03,130\nSo, just like I did before,\nwe're doing a set-adorganizationalunit.\n\n149\n00:08:03,130 --> 00:08:06,220\nAnd then the name of the OU\nthat I'm trying to modify.\n\n150\n00:08:07,890 --> 00:08:10,690\nAnd then the parameter's\njust going to be a dash, and\n\n151\n00:08:10,690 --> 00:08:15,320\nthis is a long one,\nProtectFromAccidentalDeletion.\n\n152\n00:08:15,320 --> 00:08:18,915\nProtectFromAccidentalDeletion, thank\nGod for tab autofill.\n\n153\n00:08:18,915 --> 00:08:19,900\n>> [LAUGH]\n>> And\n\n154\n00:08:19,900 --> 00:08:24,740\nI'm just gonna set that to a $false and\nhit enter.\n\n155\n00:08:24,740 --> 00:08:27,770\nAnd so what that should do is that's\nbasically clearing that check mark in\n\n156\n00:08:27,770 --> 00:08:29,840\nthe GUI, same thing if I went in there.\n\n157\n00:08:29,840 --> 00:08:32,830\nNow, if I go and\ndo another remove organizational unit.\n\n158\n00:08:34,560 --> 00:08:38,770\nAnd I hit a Y for yes, we get no red text.\n\n159\n00:08:38,770 --> 00:08:40,570\nIf I flip back to overactive directory and\n\n160\n00:08:40,570 --> 00:08:45,458\nrefresh my screen we should\nsee that that test OU is gone.\n\n161\n00:08:45,458 --> 00:08:50,040\nAnd that's it, so it's out of there.\n\n162\n00:08:50,040 --> 00:08:55,520\nYou get that one chance you can hit Y for\nyes, and that's all you get.\n\n163\n00:08:55,520 --> 00:08:58,040\n>> And a great of where I've\nused this in the past was.\n\n164\n00:08:58,040 --> 00:09:02,920\nI worked for an organization where you had\nbranch offices, over 110 branch offices.\n\n165\n00:09:02,920 --> 00:09:04,190\nAnd every branch office had a number.\n\n166\n00:09:04,190 --> 00:09:05,780\nSo it was branch number 1,\n\n167\n00:09:05,780 --> 00:09:10,890\nall the way through branch number 110, and\nwe needed to create OUs for each branch.\n\n168\n00:09:10,890 --> 00:09:13,640\nAnd so, I just whipped up a quick\nlittle PowerShell script and\n\n169\n00:09:13,640 --> 00:09:17,810\nsaid, create an OU that\nwas named branch 001.\n\n170\n00:09:17,810 --> 00:09:22,580\nAnd then, add one to that, and\ncreate branch 002, and add one to that and\n\n171\n00:09:22,580 --> 00:09:26,600\ncreate branch 003; it was just\na little loop that went 110 times.\n\n172\n00:09:26,600 --> 00:09:30,190\nQuickly and easily created 110 OUs,\nall named for the various branches.\n\n173\n00:09:30,190 --> 00:09:32,220\nI didn't have to do it by hand.\n\n174\n00:09:32,220 --> 00:09:33,970\nThat's the kind of thing that you can do,\n\n175\n00:09:33,970 --> 00:09:35,920\nwhen you're creating this\nstuff from the PowerShell.\n\n176\n00:09:35,920 --> 00:09:38,060\nSo, managing OUs, pretty straightforward.\n\n177\n00:09:39,170 --> 00:09:43,200\nSo in this segment, we got a chance\nto see how to create, modify and\n\n178\n00:09:43,200 --> 00:09:47,630\nultimately remove,\nOUs from the PowerShell prompt, right?\n\n179\n00:09:47,630 --> 00:09:50,780\nSo excellent stuff there,\ndefinitely something to take advantage of.\n\n180\n00:09:50,780 --> 00:09:52,210\nHope you guys enjoyed the segment.\n\n181\n00:09:52,210 --> 00:09:57,363\nStay tuned,\nweve got more PowerShell coming up.\n\n182\n00:09:57,363 --> 00:10:01,289\n[SOUND]\n\n",
          "vimeoId": "117181099"
        },
        {
          "description": "",
          "length": "579",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-6-managing_user_accounts-011215.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-6-managing_user_accounts-011215-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-6-managing_user_accounts-011215-sm.jpg",
          "title": "Managing User Accounts",
          "transcript": "1\n00:00:00,191 --> 00:00:08,500\n[MUSIC].\n\n2\n00:00:08,500 --> 00:00:11,922\nIn this segment, we're gonna\nlook at managing user account in\n\n3\n00:00:11,922 --> 00:00:16,391\nthe direct directory via Power Shell cuz\nwe already have our local user accounts.\n\n4\n00:00:16,391 --> 00:00:20,060\nWe're not gonna mess with those but\non the active directory side, we have use\n\n5\n00:00:20,060 --> 00:00:23,672\naccounts, which are put inside of OUs and\nthey have to have group statute and\n\n6\n00:00:23,672 --> 00:00:27,810\nall this other stuff but before we even\nget that far, we've got to get created.\n\n7\n00:00:27,810 --> 00:00:30,890\nSo we're gonna take a look at that\nprocess of creating user accounts and\n\n8\n00:00:30,890 --> 00:00:33,470\nmanipulating their data,\nall via the Power Shell.\n\n9\n00:00:33,470 --> 00:00:34,961\nAll right, Mike.\n\n10\n00:00:34,961 --> 00:00:35,941\nWhat have you got for us today?\n\n11\n00:00:35,941 --> 00:00:37,061\n>> Well, let's take a look.\n\n12\n00:00:37,061 --> 00:00:40,610\nWith these commands,\nthe command is going to be new-aduser.\n\n13\n00:00:40,610 --> 00:00:45,550\nSo pretty straightforward, your new verb,\nyour noun is going to be aduser.\n\n14\n00:00:45,550 --> 00:00:49,641\nAnd at it's simplest form,\nit's new-aduser.\n\n15\n00:00:49,641 --> 00:00:52,380\nIt helps to put a dash in there.\n\n16\n00:00:52,380 --> 00:00:56,380\nNew-aduser, and then you could just\ngive it a name like I did here.\n\n17\n00:00:56,380 --> 00:01:00,620\nAnd at this point, I have a new user\naccount, hopefully, called Nate.\n\n18\n00:01:00,620 --> 00:01:02,440\nWe'll go in here and\nrefresh Active Directory.\n\n19\n00:01:02,440 --> 00:01:06,201\nAnd we'll take a look\ninside my Users container.\n\n20\n00:01:06,201 --> 00:01:09,241\nAnd sure enough,\nthere is a user named Nate.\n\n21\n00:01:09,241 --> 00:01:12,486\nNow if you can see I know this is\nvery small on the screen there, but\n\n22\n00:01:12,486 --> 00:01:16,321\nif you look really closely at that icon;\nyou'll notice that that account for\n\n23\n00:01:16,321 --> 00:01:17,690\nNate is disabled, right?\n\n24\n00:01:17,690 --> 00:01:20,390\nI didn't set any parameters\nwhen I ran that command,\n\n25\n00:01:20,390 --> 00:01:24,360\nI gave it the one required command\nto create that new user account.\n\n26\n00:01:24,360 --> 00:01:28,192\nAnd that was the name of the account.\n\n27\n00:01:28,192 --> 00:01:31,610\nSo [INAUDIBLE] there are several different\nparameters I can throw in there, in fact\n\n28\n00:01:31,610 --> 00:01:35,460\nI'll give you guys the link to the notes\nout there and some technical commands.\n\n29\n00:01:36,730 --> 00:01:39,160\nMany, many different parameters\nI can throw in there.\n\n30\n00:01:39,160 --> 00:01:42,605\nLet's take a look at a couple of those,\nbecause normally we're going to want\n\n31\n00:01:42,605 --> 00:01:45,640\nto set a few more than that at least,\nyou know, we want to enable it.\n\n32\n00:01:45,640 --> 00:01:49,713\nAnd you guys remember with server\n2012 R2 if you create an account and\n\n33\n00:01:49,713 --> 00:01:53,710\nyou do not set the password,\nthe account is going to be disabled.\n\n34\n00:01:53,710 --> 00:01:57,330\nSo we might wanna try to set that\npassword in our command, and\n\n35\n00:01:57,330 --> 00:01:58,430\nwe might want to also enable it.\n\n36\n00:01:58,430 --> 00:02:01,160\nJust because you set the password doesn't\nmean it's automatically be enabled.\n\n37\n00:02:01,160 --> 00:02:04,600\nYou'd have to set the password and\nenable the account, but if you don't set\n\n38\n00:02:04,600 --> 00:02:09,070\nthe password Active Directory will\nnot let you enable that account.\n\n39\n00:02:09,070 --> 00:02:11,520\nSo, let's try another one, I'm gonna do\na little bit longer command this time.\n\n40\n00:02:11,520 --> 00:02:14,140\nWe're gonna do New-ADUser.\n\n41\n00:02:14,140 --> 00:02:19,075\nAnd I'm gonna do a- Name and\nthen I'll give it a name.\n\n42\n00:02:19,075 --> 00:02:22,575\nWe'll call this one Ronnie Wong.\n\n43\n00:02:24,485 --> 00:02:25,955\nAnd then I'll throw in a few more.\n\n44\n00:02:25,955 --> 00:02:30,095\nAnd like I said, there are several like\ngiven name would be like his first name.\n\n45\n00:02:31,895 --> 00:02:35,271\nWe can do his last name which is\ngonna be a- Surname parameter.\n\n46\n00:02:39,111 --> 00:02:42,433\nAnd then some more important ones that\nwe typically want to set would be like\n\n47\n00:02:42,433 --> 00:02:44,131\nthe user principal name, all right?\n\n48\n00:02:44,131 --> 00:02:48,659\nSo we'll do a user principal name and\n\n49\n00:02:48,659 --> 00:02:54,071\nwe'll call that rwong.@itprotv.net.\n\n50\n00:02:54,071 --> 00:02:58,611\nAnd let's also do that SAMACCOUNTNAME,\nthat pre-Windows 2000 logon name.\n\n51\n00:02:58,611 --> 00:03:01,491\nAnd we'll do rwong.\n\n52\n00:03:01,491 --> 00:03:05,720\nAnd then I'm gonna go ahead and\ndo an enable, so a -enabled.\n\n53\n00:03:05,720 --> 00:03:07,440\nI'm gonna set that to a true or 1.\n\n54\n00:03:07,440 --> 00:03:11,420\nYou can actually do either one,\n$true or a 1.\n\n55\n00:03:11,420 --> 00:03:14,440\nAnd then the key here is to make sure I\nset the password otherwise I won't be\n\n56\n00:03:14,440 --> 00:03:15,610\nable to enable it.\n\n57\n00:03:15,610 --> 00:03:21,280\nAnd we're gonna use the AccountPassword\nparameter, -AccountPassword.\n\n58\n00:03:21,280 --> 00:03:23,202\nAnd then there's a couple\ndifferent ways you can do this.\n\n59\n00:03:23,202 --> 00:03:26,840\nYou can provide the password in line,\nor you can prompt, and\n\n60\n00:03:26,840 --> 00:03:30,220\nit really depends on what you're trying\nto do, if I was automating this,\n\n61\n00:03:30,220 --> 00:03:32,490\nrunning through a script,\nI might want to go ahead and\n\n62\n00:03:32,490 --> 00:03:36,470\nset the parameter in the command,\nor the password in the command, and\n\n63\n00:03:36,470 --> 00:03:39,575\nthen I can go but have them change\ntheir password their next log on.\n\n64\n00:03:39,575 --> 00:03:42,230\nAnd I'm creating a single account,\nI might want to just go ahead and\n\n65\n00:03:42,230 --> 00:03:44,490\nhave it prompt me right here\nwhich is what I'm going to do for\n\n66\n00:03:44,490 --> 00:03:47,840\nthis particular example,\njust so you can see that option.\n\n67\n00:03:47,840 --> 00:03:54,220\nIt's just a Read-Host, and\nthen as secure string and\n\n68\n00:03:54,220 --> 00:03:57,040\nthat's going to cause it to put those\nlittle asterisks out there to hide what\n\n69\n00:03:57,040 --> 00:04:00,900\nI'm typing in case somebody is shoulder\nsurfing, looking over my shoulder.\n\n70\n00:04:00,900 --> 00:04:03,880\nAnd then I'm gonna set\nthe prompt to just say Password.\n\n71\n00:04:06,670 --> 00:04:10,820\nAnd I will end that guy with a little\nclose parentheses and hit enter.\n\n72\n00:04:10,820 --> 00:04:14,695\n>> Your spelling doesn't really matter\non Password, it's just a prompt there.\n\n73\n00:04:14,695 --> 00:04:19,440\n>> [LAUGH] Yeah,\nyou can see my prompt now says Passoword.\n\n74\n00:04:19,440 --> 00:04:22,270\nSo you know, and then I'll go ahead and\nset his password.\n\n75\n00:04:22,270 --> 00:04:25,760\nNotice it's not showing you what\nI'm typing for that password.\n\n76\n00:04:25,760 --> 00:04:28,460\n>> And this one's extra secure, because if\nanybody's shoulder surfing, they just see\n\n77\n00:04:28,460 --> 00:04:31,750\nthe stars, and they don't think it's\na password because it's spelled wrong.\n\n78\n00:04:31,750 --> 00:04:33,320\nSo it's an extra level.\n\n79\n00:04:33,320 --> 00:04:35,630\n>> You know,\nI like many layers of security.\n\n80\n00:04:35,630 --> 00:04:38,840\nIt's an important part of security\nin our network environment.\n\n81\n00:04:38,840 --> 00:04:41,830\nSo if I flip back over here to\nactive directory I did specify\n\n82\n00:04:41,830 --> 00:04:45,160\nthe path of where I wanted to\ncreate that user account so\n\n83\n00:04:45,160 --> 00:04:48,140\nit should have just gone\ninto my User's container.\n\n84\n00:04:48,140 --> 00:04:50,510\nAnd sure enough there is Ronnie Wong.\n\n85\n00:04:50,510 --> 00:04:53,300\nAnd you'll notice from that\nlittle icon that it is enabled.\n\n86\n00:04:53,300 --> 00:04:54,500\nSo the account is ready to go.\n\n87\n00:04:54,500 --> 00:04:56,600\nHe could sign on with it at this point.\n\n88\n00:04:56,600 --> 00:05:02,170\nGot a first name and last name,\nwe also set that SAMACCOUNTNAME.\n\n89\n00:05:02,170 --> 00:05:04,950\nAnd what else; and\nwe set the password for that guy.\n\n90\n00:05:04,950 --> 00:05:07,661\nSo, there is creating,\nexcuse me close that.\n\n91\n00:05:07,661 --> 00:05:12,210\nThere's our creating a user\naccount from active directory.\n\n92\n00:05:12,210 --> 00:05:15,650\nNow once you've got these guys created,\ntypically, you don't wanna stop there.\n\n93\n00:05:15,650 --> 00:05:17,350\nWe're gonna have to go back occasionally,\nand\n\n94\n00:05:17,350 --> 00:05:19,990\nmake changes to some of\nthese user accounts.\n\n95\n00:05:19,990 --> 00:05:22,070\nAnd all we do is swap out the verb, right?\n\n96\n00:05:22,070 --> 00:05:24,640\nJust like everything else\nwe've done with PowerShell.\n\n97\n00:05:24,640 --> 00:05:27,600\nNew is, typically, my create verb.\n\n98\n00:05:27,600 --> 00:05:31,890\nSet is going to be my modifier,\nmy right verb.\n\n99\n00:05:31,890 --> 00:05:35,870\nSo we're just gonna change that verb,\nSet-ADUser.\n\n100\n00:05:35,870 --> 00:05:39,640\nAnd then depending on what I want to\nchange and who I want to modify, for\n\n101\n00:05:39,640 --> 00:05:43,270\nthis one, instead of a -name,\nit's a -name you create but,\n\n102\n00:05:43,270 --> 00:05:47,596\nwhen you're trying to modify something\nthey want you to do a -Identity, so\n\n103\n00:05:47,596 --> 00:05:52,710\n-Identity, and there's several ways\nyou can refer to a user account.\n\n104\n00:05:52,710 --> 00:05:55,500\nSome parameter, some of these\ncommandlets are very specific,\n\n105\n00:05:55,500 --> 00:05:59,120\nyou can only use the distinguished name or\nthe GUID.\n\n106\n00:05:59,120 --> 00:06:00,750\nOthers are a little more flexible and\n\n107\n00:06:00,750 --> 00:06:05,190\nthey'll let you use like\nthe SAMACCOUNTNAME and things like that.\n\n108\n00:06:05,190 --> 00:06:08,340\nAnd this is one of those, so\nI can just do an rwong and\n\n109\n00:06:08,340 --> 00:06:12,620\nit's gonna know what I'm referring to,\nand then what parameter do I wanna set.\n\n110\n00:06:12,620 --> 00:06:17,334\nMaybe I wanna set his manager\n\n111\n00:06:17,334 --> 00:06:21,876\nto Don Pezet and hit Enter.\n\n112\n00:06:21,876 --> 00:06:27,750\nAnd -manager could not be resolved,\nthat's nice.\n\n113\n00:06:27,750 --> 00:06:28,741\nWell let's just set his description.\n\n114\n00:06:28,741 --> 00:06:33,523\nSome of these parameters, what you're\ngonna find is, you can't set them,\n\n115\n00:06:33,523 --> 00:06:36,110\ndepending on the command you're using.\n\n116\n00:06:36,110 --> 00:06:38,409\nWe'll just call this guy, host.\n\n117\n00:06:40,850 --> 00:06:43,130\nI'll explain what I mean here in a second.\n\n118\n00:06:43,130 --> 00:06:44,670\nSo that should set that description.\n\n119\n00:06:44,670 --> 00:06:46,650\nI've got a link in the show notes for you.\n\n120\n00:06:46,650 --> 00:06:49,190\nWhat you'll find is some of these\nparameters you can set during\n\n121\n00:06:49,190 --> 00:06:53,810\nthe creation command but you can't set\nthem the same way during the set user.\n\n122\n00:06:53,810 --> 00:06:56,340\nYou have to actually do\na dash other attributes, and\n\n123\n00:06:56,340 --> 00:06:59,450\nthen make like a little block and\nfill those attributes in.\n\n124\n00:06:59,450 --> 00:07:03,130\nSo some of them you can set inline, some\nof them you're going to have to go and\n\n125\n00:07:03,130 --> 00:07:04,920\ndo a dash other parameters.\n\n126\n00:07:04,920 --> 00:07:07,260\nIt's on that link that I'll\ngive you in the show notes but\n\n127\n00:07:07,260 --> 00:07:09,320\nthere you see I've\nmodified Ronnie's account.\n\n128\n00:07:09,320 --> 00:07:11,870\nI set his description as a host.\n\n129\n00:07:14,050 --> 00:07:17,670\nAnd then the last thing we might need to\nbe able to do with power shell to manage\n\n130\n00:07:17,670 --> 00:07:19,810\nour user accounts is gonna be remove one.\n\n131\n00:07:19,810 --> 00:07:20,540\nAll right.\n\n132\n00:07:20,540 --> 00:07:22,010\nAt the end of it's lifetime,\n\n133\n00:07:22,010 --> 00:07:25,480\nif you no longer need that account, I need\nto remove it from from active directory,\n\n134\n00:07:25,480 --> 00:07:28,190\nit might have been some test accounts,\nmight have been an account.\n\n135\n00:07:28,190 --> 00:07:32,520\nI don't know about you, Don, I don't\nlike deleting user accounts that often.\n\n136\n00:07:32,520 --> 00:07:33,725\n>> I usually disable.\n\n137\n00:07:33,725 --> 00:07:38,310\n>> Disable them or move them into an OU,\nand maybe a year from now, delete it if I\n\n138\n00:07:38,310 --> 00:07:44,700\nneed to but it's a straightforward\ncommand, just Remove-ADUser.\n\n139\n00:07:44,700 --> 00:07:48,960\nAnd then the identity, and I'll go and\n\n140\n00:07:48,960 --> 00:07:53,930\nfind that Nate account that I created and\nyes to remove it.\n\n141\n00:07:55,720 --> 00:07:56,660\nAnd it should be gone.\n\n142\n00:07:56,660 --> 00:08:00,570\nIf we flip back over to active directory\nand I refresh, we can see there it is.\n\n143\n00:08:00,570 --> 00:08:05,570\nI do a little refresh, and\nNate's account is now gone.\n\n144\n00:08:05,570 --> 00:08:08,370\nSo there's working with my user accounts,\nwe saw that we could\n\n145\n00:08:08,370 --> 00:08:11,290\ncreate the user account, modify that,\nand then delete that guy.\n\n146\n00:08:12,640 --> 00:08:16,203\n>> So Mike, I was looking at where you\nwent to set the manager a moment ago and\n\n147\n00:08:16,203 --> 00:08:19,884\nI just was trying to debug it real quick\nand find out where it went wrong, and\n\n148\n00:08:19,884 --> 00:08:23,291\nthen I noticed it says cannot find\nan object with identity Don Pezet.\n\n149\n00:08:23,291 --> 00:08:25,151\nDo I have an account?\n\n150\n00:08:25,151 --> 00:08:26,591\n>> No, oh.\n\n151\n00:08:26,591 --> 00:08:30,865\n>> With manager, it's not, manager is just\none of those fields you can type whatever\n\n152\n00:08:30,865 --> 00:08:33,870\nthe heck you want in,\nit actually ties to another AD user.\n\n153\n00:08:33,870 --> 00:08:36,478\nSo its it's looking for me and\nI don't have an account, and so\n\n154\n00:08:36,478 --> 00:08:39,730\nthat's why it's doing that, but\notherwise you're syntactically correct.\n\n155\n00:08:39,730 --> 00:08:41,550\nThat's my big word of the day right there,\nsyntactically.\n\n156\n00:08:41,550 --> 00:08:44,679\n>> Syntactically, I like that,\n>> So yeah,\n\n157\n00:08:44,679 --> 00:08:46,885\njust set ADUser dash\nmanager on that one but\n\n158\n00:08:46,885 --> 00:08:51,065\nyou're exactly right, there are other\nones [INAUDIBLE] do the other object tag.\n\n159\n00:08:51,065 --> 00:08:52,025\nSuper annoying.\n\n160\n00:08:52,025 --> 00:08:54,856\n>> Yeah, like title I think is one\nof them that pops up in there.\n\n161\n00:08:54,856 --> 00:08:57,456\nI don't why they won't let you set\nthat straight from the command there.\n\n162\n00:08:57,456 --> 00:09:01,285\n>> Yeah, those are things we'll see\nevolve over time as power shell moves on.\n\n163\n00:09:01,285 --> 00:09:04,575\nBy the time we got power shell 10 it\nwill be a usable product [LAUGH] but\n\n164\n00:09:04,575 --> 00:09:08,000\nuntil then we have a little\nbit of grey area there.\n\n165\n00:09:08,000 --> 00:09:12,490\nAll right guys, well in this segment we\ngot a chance to see creating modifying and\n\n166\n00:09:12,490 --> 00:09:15,720\nremoving a user account\nall via the Power Shell.\n\n167\n00:09:15,720 --> 00:09:18,790\nNow stay tuned, because we've got\nan episode coming up on groups.\n\n168\n00:09:18,790 --> 00:09:22,580\nTypically when we create a user account,\nour very next step is to\n\n169\n00:09:22,580 --> 00:09:25,890\nput them in the necessary groups for\nthem to perform their job.\n\n170\n00:09:25,890 --> 00:09:27,871\nSo really that segment's going to\ngo hand in hand with this one.\n\n171\n00:09:27,871 --> 00:09:29,391\nYou definitely want to check that one out.\n\n172\n00:09:29,391 --> 00:09:32,760\nSo stay tuned, more Power Shell coming up.\n\n173\n00:09:32,760 --> 00:09:39,170\n[MUSIC]\n\n",
          "vimeoId": "117181100"
        },
        {
          "description": "",
          "length": "569",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-7-managing_groups-011215.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-7-managing_groups-011215-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-7-managing_groups-011215-sm.jpg",
          "title": "Managing Groups",
          "transcript": "1\n00:00:00,000 --> 00:00:08,058\n[MUSIC]\n\n2\n00:00:08,058 --> 00:00:08,855\nIn this segment,\n\n3\n00:00:08,855 --> 00:00:12,450\nwe're gonna take a look at managing\ngroups inside of the PowerShell.\n\n4\n00:00:12,450 --> 00:00:15,910\nWhen you create user accounts inside of\nthe AD, one of the next steps that you\n\n5\n00:00:15,910 --> 00:00:19,960\ntake is to assign permissions to them, and\nassigning permissions requires groups.\n\n6\n00:00:19,960 --> 00:00:23,650\nSo, definitely a key piece\ninside of our IT infrastructure.\n\n7\n00:00:23,650 --> 00:00:26,050\nAnd if we're trying to automate\nthe creation of user accounts,\n\n8\n00:00:26,050 --> 00:00:28,260\nthis is something that you'll\nwanna work into your script.\n\n9\n00:00:28,260 --> 00:00:29,860\nSo, let's take a look at it, Mike.\n\n10\n00:00:29,860 --> 00:00:31,850\n>> All right, let's take a peak here.\n\n11\n00:00:31,850 --> 00:00:34,650\nSo, as we continue on with these\ndifferent commands, same idea,\n\n12\n00:00:34,650 --> 00:00:36,860\nwe're just going to use a different noun,\nright.\n\n13\n00:00:36,860 --> 00:00:39,930\nWe've seen how to create users,\nwe've seen how to create OU's.\n\n14\n00:00:39,930 --> 00:00:44,710\nNow, we wanna create groups, we swap\nout the noun, we change it to ADGroup.\n\n15\n00:00:44,710 --> 00:00:49,085\nSo, let's start with a simple one,\nwe're just gonna do new-adGroup.\n\n16\n00:00:49,085 --> 00:00:50,435\nAnd then the parameters,\n\n17\n00:00:50,435 --> 00:00:54,745\nas always there's several parameters that\nwe can use with that ADGroup command.\n\n18\n00:00:54,745 --> 00:00:58,775\nI'll give you guys the notes, or the link\nto the notes in our show notes to show\n\n19\n00:00:58,775 --> 00:01:00,885\nyou some of the additional parameters.\n\n20\n00:01:00,885 --> 00:01:03,787\nI'm gonna give it a name,\nso I'm gonna specify name.\n\n21\n00:01:03,787 --> 00:01:09,670\nI'm just gonna call it HOSTS, if I can\nspell that, that's a tricky word to spell.\n\n22\n00:01:09,670 --> 00:01:17,420\nAnd then I'll do the SAMACCOUTNAME,\nand I'm gonna call that HOSTS as well.\n\n23\n00:01:17,420 --> 00:01:21,138\nAnd then, just like when you go through\nthe GUI, think about right-click,\n\n24\n00:01:21,138 --> 00:01:21,890\nnew group.\n\n25\n00:01:21,890 --> 00:01:25,130\nThere's really only a couple parameters\nyou have to specify, right, the name of\n\n26\n00:01:25,130 --> 00:01:29,530\nthe group, and then you've got your group\ncategory and your group scope or your\n\n27\n00:01:29,530 --> 00:01:33,230\ngroup type and your group scope depending\non which book you're reading there.\n\n28\n00:01:33,230 --> 00:01:37,010\nThe group category is gonna be,\nremember there's two options here.\n\n29\n00:01:37,010 --> 00:01:38,370\nI've got distribution.\n\n30\n00:01:38,370 --> 00:01:39,970\nAnd I've got security.\n\n31\n00:01:39,970 --> 00:01:43,960\nWe're gonna do a security group cuz I\nwant to use this to assign permissions.\n\n32\n00:01:43,960 --> 00:01:47,360\nSo I want to make sure it gets an SID,\nand make it a security principle.\n\n33\n00:01:47,360 --> 00:01:51,080\nIf I did distribution,\nthat would be email applications only.\n\n34\n00:01:51,080 --> 00:01:55,650\nNo SID, it's not a security principle,\nyou cannot use it to assign permissions.\n\n35\n00:01:55,650 --> 00:01:59,990\nAnd then the next parameter I wanna\nadd is going to be my GroupScope.\n\n36\n00:01:59,990 --> 00:02:03,934\nAnd I've got three choices there,\nI've got my domain local,\n\n37\n00:02:03,934 --> 00:02:07,840\nI've got my global, and\nI've got my universal.\n\n38\n00:02:07,840 --> 00:02:10,080\nAnd we'll go with global for this one.\n\n39\n00:02:10,080 --> 00:02:14,990\nAnd then if I hit Enter there,\nit would just create it at the root.\n\n40\n00:02:14,990 --> 00:02:19,860\nIf I want I can specify a path, and\nthen its just the distinguished\n\n41\n00:02:19,860 --> 00:02:23,560\nname of where I wanna create\nthat group in active directory.\n\n42\n00:02:23,560 --> 00:02:28,260\nAnd Ive gonna go ahead and put it,\nIve got an OU called groups, I think.\n\n43\n00:02:28,260 --> 00:02:32,372\nSo Im gonna tell you ou=groups,\n\n44\n00:02:32,372 --> 00:02:37,784\ndc=itprotv, dc=net,\n\n45\n00:02:37,784 --> 00:02:43,720\nand should be able to hit Enter and\nno red text is usually a good sign.\n\n46\n00:02:43,720 --> 00:02:49,653\nSo, well come back in here and refresh my\nconsole and I take a look at my group.\n\n47\n00:02:49,653 --> 00:02:53,298\nSo, sure enough,\nthere is my host group and\n\n48\n00:02:53,298 --> 00:02:57,247\nyou'll see that it is\na global security group.\n\n49\n00:02:57,247 --> 00:02:59,408\nSo that is creating\na group from PowerShell.\n\n50\n00:02:59,408 --> 00:03:05,290\nIt's just new-adgroup, give it a SAM\naccount name, give it a group scope,\n\n51\n00:03:05,290 --> 00:03:09,000\nglobal universal domain local,\nand give it a group category,\n\n52\n00:03:09,000 --> 00:03:13,710\neither security or distribution group,\ndepending on what you're trying to do.\n\n53\n00:03:13,710 --> 00:03:17,550\nOnce I've got that group created, next\nthing we might want to be able to do with\n\n54\n00:03:17,550 --> 00:03:19,870\na group is to go back and modify a group.\n\n55\n00:03:19,870 --> 00:03:24,220\nFor example, one of the things we\ntypically do is change the group scope.\n\n56\n00:03:24,220 --> 00:03:25,340\nIf we create a group and\n\n57\n00:03:25,340 --> 00:03:29,105\nactive directory through the GUI,\nthe default is global security group.\n\n58\n00:03:29,105 --> 00:03:32,575\nI don't know about you, Don, several\nI've gone in and created a group and\n\n59\n00:03:32,575 --> 00:03:34,365\nkind of forgot to change those.\n\n60\n00:03:34,365 --> 00:03:37,055\nYou go to type the name,\nyou hit the Enter, and you go, oh smack,\n\n61\n00:03:37,055 --> 00:03:39,495\nI wanted to change that into a universal\ngroup or something like that.\n\n62\n00:03:39,495 --> 00:03:42,317\n>> It's funny cuz that's exactly\nwhat I say, I'm like, oh smack.\n\n63\n00:03:42,317 --> 00:03:44,771\n>> [LAUGH]\n>> I don't think I've ever said that but\n\n64\n00:03:44,771 --> 00:03:46,594\n[LAUGH]\n>> [LAUGH] I thought that was where I got\n\n65\n00:03:46,594 --> 00:03:48,410\nthat from was you.\n\n66\n00:03:48,410 --> 00:03:51,552\nSo, we can change the verb\nto a set command, so\n\n67\n00:03:51,552 --> 00:03:54,870\nset is gonna modify an existing object.\n\n68\n00:03:54,870 --> 00:03:57,330\nSo, Set-ADGroup.\n\n69\n00:03:57,330 --> 00:04:00,632\nThe name of the group\nthat I want to modify.\n\n70\n00:04:00,632 --> 00:04:03,470\nActually hat's gonna be an identity\nparameter in this case.\n\n71\n00:04:03,470 --> 00:04:06,630\nRemember when you change when you're\ndoing the new commands, it's -name.\n\n72\n00:04:06,630 --> 00:04:10,380\nWhen you're doing the commands,\nit's typically -identity.\n\n73\n00:04:10,380 --> 00:04:14,000\nOr you could leave identity off and\njust provide that name.\n\n74\n00:04:14,000 --> 00:04:16,380\nAnd what did I call that one, Hosts.\n\n75\n00:04:18,030 --> 00:04:21,360\nAnd lets modify the group scope, so\n\n76\n00:04:21,360 --> 00:04:26,410\nI can just put in a little -groupscope.\n\n77\n00:04:26,410 --> 00:04:28,479\nAnd Im gonna change that\none over to universal.\n\n78\n00:04:30,030 --> 00:04:33,740\nAnd if I go back into my\nGUI at this point, and\n\n79\n00:04:33,740 --> 00:04:38,390\nI pull up the properties,\nwe'll see that is now a universal group.\n\n80\n00:04:38,390 --> 00:04:41,330\nKeep in mind all my rules still apply,\nright.\n\n81\n00:04:41,330 --> 00:04:45,490\nSo if I was trying to convert\na universal group into a global group,\n\n82\n00:04:45,490 --> 00:04:50,350\nI can do that unless there's members\nof that universal group that are going\n\n83\n00:04:50,350 --> 00:04:53,530\nto violate the rules of what\na global group can contain.\n\n84\n00:04:53,530 --> 00:04:57,360\nThat a global group can only\ncontain users from the same domain.\n\n85\n00:04:57,360 --> 00:04:59,840\nSo I'd have to make sure I\nwasn't violating any of that,\n\n86\n00:04:59,840 --> 00:05:04,390\nI'd have to remove users\nfirst if necessary.\n\n87\n00:05:04,390 --> 00:05:06,970\nAnd then the last thing that\nI want to be able to do\n\n88\n00:05:06,970 --> 00:05:11,070\nwith PowerShell is to remove a group\nwhen I no longer need that group.\n\n89\n00:05:11,070 --> 00:05:15,145\nAnd as you can imagine the command\nis going to be remove-adgroup.\n\n90\n00:05:16,960 --> 00:05:18,625\nAnd we'll just do a -identity.\n\n91\n00:05:20,640 --> 00:05:23,760\nI really don't even need that one but\nI'll go ahead and put it in there.\n\n92\n00:05:23,760 --> 00:05:26,570\nI could just do remove-adgroup hosts and\n\n93\n00:05:26,570 --> 00:05:28,380\nthat would go find that group and\nremove it.\n\n94\n00:05:28,380 --> 00:05:33,120\nOr I can do a -identity hosts,\nYes to confirm.\n\n95\n00:05:34,135 --> 00:05:34,822\nNo red text.\n\n96\n00:05:34,822 --> 00:05:39,073\nRemember, unlike organizational units,\nOUs by default when you create them,\n\n97\n00:05:39,073 --> 00:05:41,648\nthey're protected from\naccidental deletion.\n\n98\n00:05:41,648 --> 00:05:44,816\nSo if I were to try to run this\ncommand on an OU without unchecking or\n\n99\n00:05:44,816 --> 00:05:47,468\nrunning the command to remove\nthat protection first,\n\n100\n00:05:47,468 --> 00:05:51,080\nI would have gotten an error,\nas we saw in a previous segment.\n\n101\n00:05:51,080 --> 00:05:52,610\nGroups, however, when you create those,\n\n102\n00:05:52,610 --> 00:05:55,010\nthey're not protected from\naccidental deletion by default.\n\n103\n00:05:55,010 --> 00:05:57,880\nI can go back in there and turn that on,\nbut they're not by default.\n\n104\n00:05:57,880 --> 00:06:00,590\nSo in this case the remove\ncommand worked just fine.\n\n105\n00:06:00,590 --> 00:06:03,610\nThe group is no longer there,\nand we would lose that group.\n\n106\n00:06:03,610 --> 00:06:08,270\nJust remember, think back to our\nlessons or our previous segments,\n\n107\n00:06:08,270 --> 00:06:11,970\nwhen you remove that group you lose\nthe SID associated with that group,\n\n108\n00:06:11,970 --> 00:06:13,550\nyou lose all the membership of that group.\n\n109\n00:06:13,550 --> 00:06:16,260\nSo, be careful when you\ngo into deleting groups.\n\n110\n00:06:16,260 --> 00:06:17,090\n>> Yeah.\n\n111\n00:06:17,090 --> 00:06:19,510\nAnother thing to remember, and this is\nthe one that's always hard for me is,\n\n112\n00:06:19,510 --> 00:06:22,230\nin the GUI there's two different\nways to do groups, right,\n\n113\n00:06:22,230 --> 00:06:24,480\nyou can put a user into a group.\n\n114\n00:06:24,480 --> 00:06:28,050\nOr you can go to a group and modify\nit's membership and add users into it.\n\n115\n00:06:28,050 --> 00:06:30,600\nBut in the PowerShell,\nit's really all the same,\n\n116\n00:06:30,600 --> 00:06:32,180\nregardless of which way\nthat you look at it.\n\n117\n00:06:32,180 --> 00:06:35,727\nSo there's only one set of commands from\nthe PowerShell versus the two different\n\n118\n00:06:35,727 --> 00:06:36,677\npathways in the GUI.\n\n119\n00:06:36,677 --> 00:06:37,373\nA little bit of a difference there.\n\n120\n00:06:37,373 --> 00:06:38,905\n>> Exactly.\n\n121\n00:06:38,905 --> 00:06:40,430\nIn fact, that's one thing we didn't do.\n\n122\n00:06:40,430 --> 00:06:42,320\nDid we?\nWe didn't ad anybody to our group.\n\n123\n00:06:42,320 --> 00:06:44,190\nSo let's go back and do that.\n\n124\n00:06:44,190 --> 00:06:46,820\nI went ahead and recreated that group,\nthat host group.\n\n125\n00:06:46,820 --> 00:06:49,320\nAnd to add a user to\na group from PowerShell,\n\n126\n00:06:49,320 --> 00:06:53,685\nit's gonna be add-adgroupmember.\n\n127\n00:06:53,685 --> 00:06:55,680\nThat's gonna be the command.\n\n128\n00:06:55,680 --> 00:06:58,210\nAnd then the main the name of the group\nthat I wanna add somebody to,\n\n129\n00:06:58,210 --> 00:07:01,450\nin this case hosts, and\nthen the user account.\n\n130\n00:07:01,450 --> 00:07:04,880\nAnd you can do a comma separated list\nat this point, so if youre adding\n\n131\n00:07:04,880 --> 00:07:09,140\nmultiple users into this group, I dont\nhave to run this command for each one.\n\n132\n00:07:09,140 --> 00:07:12,710\nI can just find that, so lets do a little\nrwong, she would still be out there.\n\n133\n00:07:14,280 --> 00:07:15,590\nAll right.\nAnd now, if I go back, so\n\n134\n00:07:15,590 --> 00:07:18,180\nit's just, add-adgroupmember.\n\n135\n00:07:18,180 --> 00:07:22,360\nYou can do a -identity, and then the name\nof the group, and in this case, hosts.\n\n136\n00:07:22,360 --> 00:07:25,760\nAnd then the members that I wanna add,\nrwong.\n\n137\n00:07:25,760 --> 00:07:28,540\nI could have done a comma separated list.\n\n138\n00:07:28,540 --> 00:07:31,790\nGo back into active directory,\nand refresh my council.\n\n139\n00:07:33,650 --> 00:07:35,240\nAnd where did I create that group?\n\n140\n00:07:35,240 --> 00:07:38,350\nI did that inside my groups OU.\n\n141\n00:07:39,620 --> 00:07:44,000\nI pull up the properties for hosts and I\nlook at that Members tab, and sure enough,\n\n142\n00:07:44,000 --> 00:07:47,130\nRonnie Wong is now a member\nof our host group.\n\n143\n00:07:47,130 --> 00:07:49,350\nSo there we can see we can add.\n\n144\n00:07:49,350 --> 00:07:51,210\nThere is a remove command a swell.\n\n145\n00:07:52,420 --> 00:07:54,560\nI don't think I want to get\ninto that one right now.\n\n146\n00:07:54,560 --> 00:07:58,950\nBut this is just gonna be\nchanging up the verb on that one.\n\n147\n00:07:58,950 --> 00:08:02,740\n>> And you also have get-adgroupmember, so\nif Mike wanted to verify that membership,\n\n148\n00:08:02,740 --> 00:08:05,790\nhe had to hunt and figure out,\nwhere did I put that host group.\n\n149\n00:08:05,790 --> 00:08:10,130\nIf you don't want to do that you can do\nget-adgroupmember hosts and just run that,\n\n150\n00:08:10,130 --> 00:08:13,150\nit'll return who's in it and\nyou can see Ronnie's right there.\n\n151\n00:08:13,150 --> 00:08:15,690\nSo very easy to work with\nthese from the PowerShell.\n\n152\n00:08:15,690 --> 00:08:17,940\nPut people into a group,\ntake them out of a group.\n\n153\n00:08:17,940 --> 00:08:20,020\nAdd, remove, really straight forward.\n\n154\n00:08:20,020 --> 00:08:21,400\nAnd a pretty cool thing to have.\n\n155\n00:08:21,400 --> 00:08:24,170\nThe nice thing about this is\nthat you can script it and\n\n156\n00:08:24,170 --> 00:08:25,970\nyou can set it to run at certain times.\n\n157\n00:08:25,970 --> 00:08:31,210\nBecause I might want Mike to be in\na group, but not until midnight tonight.\n\n158\n00:08:31,210 --> 00:08:33,400\nMaybe he doesn't actually start\nwork until tomorrow morning.\n\n159\n00:08:33,400 --> 00:08:36,610\nSo I don't want to put him in\nthe group now until it's closer to\n\n160\n00:08:36,610 --> 00:08:37,820\nthe time that he starts.\n\n161\n00:08:37,820 --> 00:08:42,080\nOr maybe I know that Mike is changing\njob roles six months from now.\n\n162\n00:08:42,080 --> 00:08:43,980\nI don't want to disable\nhis account in six months.\n\n163\n00:08:43,980 --> 00:08:45,500\nWindows makes that easy.\n\n164\n00:08:45,500 --> 00:08:48,020\nInstead, I just want to take him\nout of some groups in six months.\n\n165\n00:08:48,020 --> 00:08:50,715\nSo I can write a quick PowerShell\nscript that says just remove Mike\n\n166\n00:08:50,715 --> 00:08:51,305\nfrom this group,\n\n167\n00:08:51,305 --> 00:08:55,145\nand I then I can schedule it to run six\nmonths from now at midnight or whenever.\n\n168\n00:08:55,145 --> 00:08:57,826\nThat's the power of being able to\ndo this stuff from the PowerShell,\n\n169\n00:08:57,826 --> 00:08:59,408\nas well as doing things in bulk, right?\n\n170\n00:08:59,408 --> 00:09:02,659\nAdding into a bunch of groups\nall at once or whatever.\n\n171\n00:09:02,659 --> 00:09:04,485\nThat's something that\nbecomes a lot more simple.\n\n172\n00:09:04,485 --> 00:09:05,155\n>> All right, exactly.\n\n173\n00:09:06,155 --> 00:09:09,545\n>> All right, so in this segment we got a\nchance to see how to create groups, how to\n\n174\n00:09:09,545 --> 00:09:12,675\nmodify the groups that we've created,\nand then how to add people into them,\n\n175\n00:09:12,675 --> 00:09:16,540\nwhich is kind of an important piece\nif we anticipate using them, right?\n\n176\n00:09:16,540 --> 00:09:19,390\nGotta have people in the group\nto get any work done.\n\n177\n00:09:19,390 --> 00:09:20,657\nAll right, I hope you guys enjoyed that.\n\n178\n00:09:20,657 --> 00:09:23,954\nStay tuned,\nwe've got more power shell coming up.\n\n179\n00:09:23,954 --> 00:09:29,029\n[MUSIC]\n\n",
          "vimeoId": "117181102"
        },
        {
          "description": "",
          "length": "570",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-8-import_export_data-011215.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-8-import_export_data-011215-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-8-import_export_data-011215-sm.jpg",
          "title": "Import Export Data",
          "transcript": "1\n00:00:00,000 --> 00:00:08,305\n[MUSIC]\n\n2\n00:00:08,305 --> 00:00:10,986\nIn this segment,\nwe gonna take a look at importing and\n\n3\n00:00:10,986 --> 00:00:14,490\nexporting data to the active\ndirectory,data PowerShell.\n\n4\n00:00:14,490 --> 00:00:16,110\nAnd most commonly this\nis gonna be done for\n\n5\n00:00:16,110 --> 00:00:21,840\ndoing things like creating user accounts\nor other activities, as far as importing.\n\n6\n00:00:21,840 --> 00:00:24,730\nOn the exporting side,\nit's just generating reports.\n\n7\n00:00:24,730 --> 00:00:28,450\nFinding information out about the users\nthat are inside of our active directory.\n\n8\n00:00:28,450 --> 00:00:32,360\nPowerShell gives us quite a few utilities\nto do that so let's take a look.\n\n9\n00:00:32,360 --> 00:00:33,740\n>> Let's take a peek here.\n\n10\n00:00:33,740 --> 00:00:36,300\nSo one of the things, you're probably\nfamiliar if you've worked with active\n\n11\n00:00:36,300 --> 00:00:40,860\ndirectory any amount of time, you might\nbe familiar with some tools like CSVDE Or\n\n12\n00:00:40,860 --> 00:00:45,030\nL div DE, these were command line\ntools that we could use to import and\n\n13\n00:00:45,030 --> 00:00:47,570\nexport data out of Active Directory.\n\n14\n00:00:47,570 --> 00:00:51,330\nPowerShell let's us do that,\nlet's us work with our CSV files.\n\n15\n00:00:51,330 --> 00:00:56,340\nWe can actually use PowerShell to go get\nthat CSV file, load it up into variable,\n\n16\n00:00:56,340 --> 00:00:59,390\nand then just do a Foreach loop and\nwork our way through that CSV file.\n\n17\n00:00:59,390 --> 00:01:02,260\nYour first question might be, why?\n\n18\n00:01:02,260 --> 00:01:03,290\nWhy the heck would I do that?\n\n19\n00:01:03,290 --> 00:01:07,590\nI already have CSVDE, I can use\nCSVDE to pull in that text file and\n\n20\n00:01:07,590 --> 00:01:08,490\ndump it in Active Directory,\n\n21\n00:01:08,490 --> 00:01:11,890\nbecause you can create new objects\nin Active Directory with CSVDE.\n\n22\n00:01:12,930 --> 00:01:17,450\nWhat you cannot do With CSVED,\nis set the password.\n\n23\n00:01:17,450 --> 00:01:19,480\nRight?\nWhich mean all those accounts that you\n\n24\n00:01:19,480 --> 00:01:23,170\ncreate, you're gonna have to go back,\nand set the password,\n\n25\n00:01:23,170 --> 00:01:26,470\nthen you're gonna have to go back again,\nand enable those accounts.\n\n26\n00:01:26,470 --> 00:01:28,980\nWhich I could do with\nthe PowerShell script as well.\n\n27\n00:01:28,980 --> 00:01:33,100\nBut if I use PowerShell to bring\nthe CSV file in the first place,\n\n28\n00:01:33,100 --> 00:01:37,160\nI can go ahead and set the password\nthen as well as enable the account.\n\n29\n00:01:37,160 --> 00:01:37,860\nI can do it all in one step.\n\n30\n00:01:37,860 --> 00:01:41,570\nWhat's really cool is typically we're\ngoing to be doing this with a script, so\n\n31\n00:01:41,570 --> 00:01:44,180\nI can,\nin fact let me pull it up the script.\n\n32\n00:01:44,180 --> 00:01:45,550\nFirst I'll pull up the CSV file.\n\n33\n00:01:45,550 --> 00:01:47,530\nYou guys have seen.\n\n34\n00:01:47,530 --> 00:01:49,900\nLet me modify my extension\non this guy real quick.\n\n35\n00:01:51,915 --> 00:01:54,550\nYou guys have seen a CSV file, I'm sure.\n\n36\n00:01:54,550 --> 00:01:56,640\nI want to pull it up and\nshow you what I've got in there.\n\n37\n00:01:58,080 --> 00:02:02,006\nAll right, and let's bump that font\nup a wee bit so we can see it on TV.\n\n38\n00:02:03,586 --> 00:02:06,010\nAll right.\n\n39\n00:02:06,010 --> 00:02:11,460\nSo, like any other CSV file I've got\nseparate lines on each line is one object.\n\n40\n00:02:11,460 --> 00:02:15,890\nThe values on one line represent one\nobject, they're separated by commas.\n\n41\n00:02:15,890 --> 00:02:18,750\nOn that very first line,\nI've got what we call our header row.\n\n42\n00:02:18,750 --> 00:02:21,480\nWhere I'm defining the order\nof those attributes, right?\n\n43\n00:02:21,480 --> 00:02:23,730\nWhat order those attributes\nare gonna appear in.\n\n44\n00:02:23,730 --> 00:02:24,600\nSo, I've got first name,\n\n45\n00:02:24,600 --> 00:02:27,740\ncomma, last name, comma, department,\nand comma default password.\n\n46\n00:02:27,740 --> 00:02:32,400\nNow, notice I'm not using the actual name\nwe would see in Active Directory, and\n\n47\n00:02:32,400 --> 00:02:36,320\nthat's okay because we're gonna be\nswapping them up when we run our script.\n\n48\n00:02:36,320 --> 00:02:39,780\nIf I was doing this with CSVDE,\nthat would fail, right?\n\n49\n00:02:39,780 --> 00:02:41,940\nThere is no first name attribute,\nit's a given name.\n\n50\n00:02:41,940 --> 00:02:45,240\nThere is no last name attribute,\nit's dash surname.\n\n51\n00:02:45,240 --> 00:02:49,940\nSo because I'm using a script, I can put a\nlittle more user friendly information here\n\n52\n00:02:49,940 --> 00:02:55,110\nand you use this, you might have a brand\nnew network that you're setting up and\n\n53\n00:02:55,110 --> 00:02:59,460\nyou want to create all of your users in\nbulk or maybe hrs hiring a whole slew,\n\n54\n00:02:59,460 --> 00:03:01,460\nmaybe they're bringing in\n20 new employees next week.\n\n55\n00:03:01,460 --> 00:03:04,700\nThey've already I've already got\na spreadsheet, with first name, last name,\n\n56\n00:03:04,700 --> 00:03:08,190\nsome address information, and\nthings like that in the spreadsheet.\n\n57\n00:03:08,190 --> 00:03:12,460\nI can save it as a CSV file, and\nturn around and import it with PowerShell.\n\n58\n00:03:12,460 --> 00:03:15,930\nNow let me show you the script\nthat I've written here\n\n59\n00:03:15,930 --> 00:03:18,605\nyou're gonna edit this newusers.ps1.\n\n60\n00:03:18,605 --> 00:03:22,095\nPowerShell will open up, there we go.\n\n61\n00:03:22,095 --> 00:03:26,920\n[LAUGH] And I simply have a couple of\nvariables at the beginning, a csvfile and\n\n62\n00:03:26,920 --> 00:03:30,210\nthen the path to that csvfile.\n\n63\n00:03:31,670 --> 00:03:36,040\nAnd on the following line,\nwhere do I wanna create these new users.\n\n64\n00:03:36,040 --> 00:03:40,420\nI'm gonna put them in UserAccounts,\n\n65\n00:03:40,420 --> 00:03:43,670\nI'm pretty sure I have an OU\ncalled user accounts in there.\n\n66\n00:03:43,670 --> 00:03:46,660\nSo I'm just storing that information and\nvariables.\n\n67\n00:03:46,660 --> 00:03:49,400\nAnd then I've got a $users= and\n\n68\n00:03:49,400 --> 00:03:54,660\nthere's my PowerShell command,\nimport-CSV, this is what's gonna go out,\n\n69\n00:03:54,660 --> 00:03:59,650\nfind that CSV file, and\nstore that in this variable $users.\n\n70\n00:03:59,650 --> 00:04:01,980\nSo with this script I've given\nmyself a little flexibility.\n\n71\n00:04:01,980 --> 00:04:07,670\nI could have just done Import-CSV and\nthen the path to that CSV file.\n\n72\n00:04:07,670 --> 00:04:11,910\nBut instead I put in a variable up here,\nso if I want to reuse this next week,\n\n73\n00:04:11,910 --> 00:04:13,190\nI can just come in here.\n\n74\n00:04:13,190 --> 00:04:17,510\nAnd modify the name or\nthe location of that CSV file or\n\n75\n00:04:17,510 --> 00:04:21,420\nmodify the OU that I wanna\ndump those user accounts in.\n\n76\n00:04:21,420 --> 00:04:23,700\nI don't have to rewrite\nthe entire script every time, so\n\n77\n00:04:23,700 --> 00:04:26,079\nthere's a little bit\nof re-usability there.\n\n78\n00:04:26,079 --> 00:04:32,040\nSo there's $users Import-CSV and then the\nvariable, it's gonna go pull that file and\n\n79\n00:04:32,040 --> 00:04:36,157\nthen the actual PowerShell\nscript four each $I and\n\n80\n00:04:36,157 --> 00:04:40,730\n$user so it's going to loop through\neach line in that CSV file and\n\n81\n00:04:40,730 --> 00:04:44,320\nit's going to set their display\nname we're gonna right.\n\n82\n00:04:44,320 --> 00:04:48,490\nWe're going to plug two strings\ntogether with a space in between them,\n\n83\n00:04:48,490 --> 00:04:50,710\nthat firstName and that LastName.\n\n84\n00:04:50,710 --> 00:04:55,130\nNow these are the names from the CSV file,\nso\n\n85\n00:04:55,130 --> 00:04:58,455\nif I'd called them something else,\ngiven name, surname Name.\n\n86\n00:04:58,455 --> 00:05:00,435\nJust name, whatever.\n\n87\n00:05:00,435 --> 00:05:02,325\nI would change those there.\n\n88\n00:05:02,325 --> 00:05:04,865\nThe dollar sign display name is\nthe attribute that we're gonna\n\n89\n00:05:04,865 --> 00:05:07,625\nchange in active directory\non that user account.\n\n90\n00:05:07,625 --> 00:05:10,625\nI've also got a $SecurePass,\n\n91\n00:05:10,625 --> 00:05:14,695\nand I'm setting that equal\nto ConvertTo-Securestring.\n\n92\n00:05:14,695 --> 00:05:19,295\nAnd then I'm just gonna pull from\nthe CSVfile whatever I've got in that\n\n93\n00:05:19,295 --> 00:05:22,650\nlast column if you will\nthat DefaultPassword.\n\n94\n00:05:22,650 --> 00:05:24,680\nI'm doing it as plain text.\n\n95\n00:05:24,680 --> 00:05:27,860\nAnd then the final part of the script\nis the actual new user command.\n\n96\n00:05:27,860 --> 00:05:30,730\nSo until here we've just been\ngetting everything set up so\n\n97\n00:05:30,730 --> 00:05:33,720\nthat I can now run the new-ad user.\n\n98\n00:05:33,720 --> 00:05:38,410\nSo it's new-Aduser-Name and\nit's gonna grab the first name.\n\n99\n00:05:38,410 --> 00:05:42,430\n-Given, and\nit's gonna go grab the FirstName again.\n\n100\n00:05:43,500 --> 00:05:46,710\nSurname is gonna be their\nLastName from the CSV file.\n\n101\n00:05:46,710 --> 00:05:49,500\nDisplayName, it's gonna\ndo the $DisplayName.\n\n102\n00:05:49,500 --> 00:05:53,330\nAnd remember,\nI set that equal to FirstName concatenated\n\n103\n00:05:53,330 --> 00:05:54,255\nwith their LastName.\n\n104\n00:05:55,390 --> 00:05:57,820\nAnd then I've got their department pulling\nfrom the CSV file, and then the path,\n\n105\n00:05:57,820 --> 00:06:03,810\npulling from the variable we set\nat the beginning of this script,\n\n106\n00:06:03,810 --> 00:06:05,560\nand then the account password.\n\n107\n00:06:05,560 --> 00:06:08,640\nIt's going to grab the password\nout of that file and\n\n108\n00:06:08,640 --> 00:06:11,190\nit's going to Enable that account.\n\n109\n00:06:11,190 --> 00:06:14,070\n>> Because the default is that\nthe accounts we create will be disabled,\n\n110\n00:06:14,070 --> 00:06:17,230\nwhich you may want, but in our case we're\ngoing to go ahead and bring them live.\n\n111\n00:06:17,230 --> 00:06:18,070\n>> So let's find out.\n\n112\n00:06:18,070 --> 00:06:20,750\nWe've got that script set up, we're going\nto go ahead and execute this script.\n\n113\n00:06:20,750 --> 00:06:26,529\nJust going to save the script before I\nrun it, the changes that I made there.\n\n114\n00:06:29,290 --> 00:06:31,900\nAnd barring any red text,\nwe should be successful,\n\n115\n00:06:31,900 --> 00:06:35,800\nso if I go take a look in\nActive Directory, and I think I did that,\n\n116\n00:06:35,800 --> 00:06:40,127\nwhat, in User Accounts,\nwhere did I make that?\n\n117\n00:06:40,127 --> 00:06:41,660\n>> [LAUGH]\n>> Now I forgot where I\n\n118\n00:06:41,660 --> 00:06:42,445\nactually made it there.\n\n119\n00:06:42,445 --> 00:06:45,050\nou=UserAccounts, so\nlet's refresh this screen.\n\n120\n00:06:46,540 --> 00:06:50,620\nAnd sure enough there are my three new\nemployees that have pulled from that\n\n121\n00:06:50,620 --> 00:06:51,590\nCSV file.\n\n122\n00:06:51,590 --> 00:06:54,840\nAnd if I pull one of them up,\nI'll see it's got the first name,\n\n123\n00:06:54,840 --> 00:06:59,560\nthe last name the display name and I'll\nalso notice that the accounts are enabled.\n\n124\n00:06:59,560 --> 00:07:01,370\nSo they're ready to go at this point.\n\n125\n00:07:01,370 --> 00:07:03,580\nThey've got that default password set.\n\n126\n00:07:03,580 --> 00:07:07,020\nthat have pulled from that so at this\npoint if the user could log on with\n\n127\n00:07:07,020 --> 00:07:09,920\nthose accounts,\nwe could have them change their password.\n\n128\n00:07:09,920 --> 00:07:12,780\nAnd there's other parameters as you saw\nin the previous segments, when you go to\n\n129\n00:07:12,780 --> 00:07:17,150\ncreate a new user I could have used any\nof those parameters If that CVS had more\n\n130\n00:07:17,150 --> 00:07:21,250\ninformation, like somebody had gone in,\nfilled in department, things like that.\n\n131\n00:07:21,250 --> 00:07:26,750\nAddress, city, state, zip, phone numbers,\nfaxes, all that can be in that text file,\n\n132\n00:07:26,750 --> 00:07:30,080\nand I could populate all that with\njust running that one script.\n\n133\n00:07:30,080 --> 00:07:31,350\n>> Yeah, basically yeah.\n\n134\n00:07:31,350 --> 00:07:32,190\n>> And that is it.\n\n135\n00:07:32,190 --> 00:07:34,200\nThat is importing users with CSV.\n\n136\n00:07:35,390 --> 00:07:40,340\n>> Now, as far as exporting users,\nwell, do we have an example for\n\n137\n00:07:40,340 --> 00:07:40,880\nthem in this segment?\n\n138\n00:07:40,880 --> 00:07:42,026\n>> You know, I did not set one up.\n\n139\n00:07:42,026 --> 00:07:46,625\n>> Okay, we actually did cover that in\nanother segment if you go back into our\n\n140\n00:07:46,625 --> 00:07:51,075\nearlier part of the series, which was\nactually in the very beginning of\n\n141\n00:07:51,075 --> 00:07:53,993\nthe series,\nback in the one point whatevers.\n\n142\n00:07:53,993 --> 00:07:57,090\nI did one on formating output.\n\n143\n00:07:57,090 --> 00:08:00,200\nAnd what you could do is you\ncan use get dash AD user and\n\n144\n00:08:00,200 --> 00:08:02,230\nthat's what's gonna let you\npull up your user list.\n\n145\n00:08:02,230 --> 00:08:03,510\nOr get dash anything right?\n\n146\n00:08:03,510 --> 00:08:08,090\nYou can get whatever the heck you want out\nof the Active Directory or anywhere else.\n\n147\n00:08:08,090 --> 00:08:13,303\nAnd you can pipe that into\nthe export CSV command lit and\n\n148\n00:08:13,303 --> 00:08:16,530\nthen [INAUDIBLE] dump it out as\na CSV is that's what you want.\n\n149\n00:08:16,530 --> 00:08:21,250\nThere's the convert dash two HTML command\nlet also that will dump that out.\n\n150\n00:08:21,250 --> 00:08:24,627\nSo, there's a few different\nones that are out there.\n\n151\n00:08:24,627 --> 00:08:26,813\nPulls out really quick here, 1.8 so\n\n152\n00:08:26,813 --> 00:08:30,600\nin 1.8 we did a segment called\nFormatting Command Output.\n\n153\n00:08:30,600 --> 00:08:34,070\nJump over and check that one out, cuz it\nhandles all the export stuff right there.\n\n154\n00:08:34,070 --> 00:08:35,670\nAnd if not just tied to Active Directory,\n\n155\n00:08:35,670 --> 00:08:38,370\nit's really tied to everything\ninside of the PowerShell.\n\n156\n00:08:38,370 --> 00:08:41,780\nBut if you want to create that CSV,\nmaybe have a test domain.\n\n157\n00:08:41,780 --> 00:08:44,680\nAnd you want to export the users\nfrom this test domain and\n\n158\n00:08:44,680 --> 00:08:47,250\nthen go import them in\nyour production domain.\n\n159\n00:08:47,250 --> 00:08:51,400\nYou would use the export-CSV\ncommand let to get that data out.\n\n160\n00:08:51,400 --> 00:08:52,080\nAnd then you go and\n\n161\n00:08:52,080 --> 00:08:56,810\nyou use a script like Mike's to bring that\ndata in from that CSV, and move it along.\n\n162\n00:08:56,810 --> 00:08:58,180\nSo that's kind of the other side of it.\n\n163\n00:08:58,180 --> 00:08:59,810\nDefinitely check out that other segment.\n\n164\n00:08:59,810 --> 00:09:03,170\nIt is titled formatting command output,\nand it's all right in there.\n\n165\n00:09:04,402 --> 00:09:07,660\nAll right, so in this segment we got\na chance to see how to import data from\n\n166\n00:09:07,660 --> 00:09:08,260\na CSV.\n\n167\n00:09:08,260 --> 00:09:11,440\nMost particularly to create user\naccounts inside of the Active Directory.\n\n168\n00:09:11,440 --> 00:09:14,470\nIterate through that and\ncreate all those accounts, all at once.\n\n169\n00:09:14,470 --> 00:09:15,920\nVery nice and easy to do.\n\n170\n00:09:15,920 --> 00:09:18,790\nBeats the heck out of using the GUI for\nsomething like this.\n\n171\n00:09:18,790 --> 00:09:19,690\n>> Absolutely.\n\n172\n00:09:19,690 --> 00:09:21,340\n>> Alright,\nwell I hope you guys enjoyed the segment.\n\n173\n00:09:21,340 --> 00:09:22,420\nStay tuned.\n\n174\n00:09:22,420 --> 00:09:24,512\nWe've got more PowerShell coming up.\n\n175\n00:09:24,512 --> 00:09:30,369\n[MUSIC]\n\n",
          "vimeoId": "117181104"
        },
        {
          "description": "",
          "length": "980",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-9-performing_bulk_operations-011215.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-9-performing_bulk_operations-011215-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-5-9-performing_bulk_operations-011215-sm.jpg",
          "title": "Performing Bulk Operations",
          "transcript": "1\n00:00:00,000 --> 00:00:07,972\n[MUSIC]\n\n2\n00:00:07,972 --> 00:00:11,674\nIn this segment we're gonna take a look\nat performing bulk operations inside of\n\n3\n00:00:11,674 --> 00:00:13,310\nthe Active Directory.\n\n4\n00:00:13,310 --> 00:00:18,140\nThe whole glory of PowerShell, if it has\nany glory, is the fact that it makes it\n\n5\n00:00:18,140 --> 00:00:22,770\nreally easy to make large quantities\nof changes really rapidly.\n\n6\n00:00:22,770 --> 00:00:25,570\nIf I just have to change a value for\none user, I'll just go into\n\n7\n00:00:25,570 --> 00:00:29,450\nActive Directory the computers do it in\nthe GUI, why mess around with a script?\n\n8\n00:00:29,450 --> 00:00:33,330\nBut, if I have to change 1000 users,\nforget that, you don't want to go and\n\n9\n00:00:33,330 --> 00:00:35,910\ndo that in a GUI,\nthat PowerShell is where it's at.\n\n10\n00:00:35,910 --> 00:00:39,250\nSo, Mike you've got a couple example for\nus of ways to do that, right?\n\n11\n00:00:39,250 --> 00:00:42,620\n>> I do, hopefully,\n[LAUGH] yeah, it really is,\n\n12\n00:00:42,620 --> 00:00:46,450\nit's advantageous because in the GUI\nyou can do some bulk operations, right?\n\n13\n00:00:46,450 --> 00:00:49,220\nIf you can select all the users\nyou want to work with,\n\n14\n00:00:49,220 --> 00:00:52,460\nyou can pull up the properties and\nyou'll see the things that you can change\n\n15\n00:00:52,460 --> 00:00:54,390\nwhen you have more than\none object selected.\n\n16\n00:00:54,390 --> 00:00:55,920\nThe problem is the selection, right?\n\n17\n00:00:55,920 --> 00:00:58,220\nIf they're all in the same OU and\nthey're all on the same screen,\n\n18\n00:00:58,220 --> 00:01:01,490\nI can use my different techniques like\nclick on the first one, hold down Shift,\n\n19\n00:01:01,490 --> 00:01:02,660\nclick on the last one.\n\n20\n00:01:02,660 --> 00:01:03,800\nWhat if they're in different OUs,\n\n21\n00:01:03,800 --> 00:01:05,780\ndifferent locations\nwithin Active Directory?\n\n22\n00:01:05,780 --> 00:01:08,560\nNo way to select those\nmultiple objects and\n\n23\n00:01:08,560 --> 00:01:10,570\nyou cant change all the parameters\nwhen youre in the GUI.\n\n24\n00:01:10,570 --> 00:01:12,490\nSo thats really where\nPowerShell comes into play,\n\n25\n00:01:12,490 --> 00:01:16,615\nthe ability to find what Im looking for\nand then make changes en masse.\n\n26\n00:01:16,615 --> 00:01:17,275\nSo let's take a look.\n\n27\n00:01:17,275 --> 00:01:19,945\nThe first thing you're gonna need\nto be able to do is find what\n\n28\n00:01:19,945 --> 00:01:20,495\nyou're looking for.\n\n29\n00:01:20,495 --> 00:01:24,185\nWe somehow need to select\nthe objects that I wanna change.\n\n30\n00:01:24,185 --> 00:01:27,425\nAnd we're gonna use a Get-ADUser command.\n\n31\n00:01:27,425 --> 00:01:32,745\nAnd if I just do a Get-ADUser,\nit does require a filter parameter.\n\n32\n00:01:32,745 --> 00:01:35,535\nYou can do an asterisk for the filter and\n\n33\n00:01:35,535 --> 00:01:39,120\nit should return all the users\nI have in Active Directory.\n\n34\n00:01:39,120 --> 00:01:43,065\nIncluding things like my built-in\nadministrator account, my guest account,\n\n35\n00:01:43,065 --> 00:01:46,836\nmy Kerberos Ticket-Granting Ticket Service\naccount and things like that,\n\n36\n00:01:46,836 --> 00:01:49,250\ntypically not what we're trying to do.\n\n37\n00:01:49,250 --> 00:01:51,290\nSo, we can do a couple\nof different things,\n\n38\n00:01:51,290 --> 00:01:54,390\nwe can change up the filter to\nchange what we're looking for.\n\n39\n00:01:54,390 --> 00:01:56,948\nWe can also adjust the search base.\n\n40\n00:01:56,948 --> 00:02:00,310\nSo for example; I'm gonna come back\nin here and add, I'm gonna reuse this\n\n41\n00:02:00,310 --> 00:02:03,380\ncommand a few times, so I'm gonna add\nit to the beginning of this command.\n\n42\n00:02:03,380 --> 00:02:05,210\nI'm gonna do a search base.\n\n43\n00:02:05,210 --> 00:02:09,850\nAnd this is telling it where\nI want to start the search.\n\n44\n00:02:09,850 --> 00:02:13,030\nFor example, if I put in here for\nsearch base,\n\n45\n00:02:13,030 --> 00:02:16,930\nit's going to be a distinguished name so\nsomething like OU equals,\n\n46\n00:02:16,930 --> 00:02:22,370\nwhere'd I put those accounts,\nhost, which is inside the user\n\n47\n00:02:22,370 --> 00:02:27,920\naccounts OU,\nwhich is my domain component, ITPROTV.\n\n48\n00:02:27,920 --> 00:02:30,650\nDC equals net,\n\n49\n00:02:30,650 --> 00:02:35,570\nput a little quote on the end of that, and\nI leave the filter as an asterisk, so all.\n\n50\n00:02:36,570 --> 00:02:41,440\nSo this time, it only returns the three\nusers that are inside that organization,\n\n51\n00:02:41,440 --> 00:02:43,830\nagain so you're just telling\nthat where to start that search.\n\n52\n00:02:46,070 --> 00:02:48,400\nNext, let's try to add a filter to it.\n\n53\n00:02:48,400 --> 00:02:50,980\nSo, I'm gonna get, and I'm gonna leave\nto use that same command, Get-ADUser.\n\n54\n00:02:50,980 --> 00:02:55,560\nWe're gonna start in that OU, and\nlet's do a filter, something like.\n\n55\n00:02:55,560 --> 00:02:59,400\nLet's say we're looking for,\nI need to set the company, right?\n\n56\n00:02:59,400 --> 00:03:02,170\nThe more attributes you fill out on\nthe user account and Active Directory,\n\n57\n00:03:02,170 --> 00:03:06,060\nthe easier it is to find and search for\nobjects for other users to work with them.\n\n58\n00:03:06,060 --> 00:03:08,830\nBut unfortunately,\nin IT a lot of times we don't.\n\n59\n00:03:08,830 --> 00:03:12,960\nWe just fill in the name, the CM account\nname, the password, we let it go.\n\n60\n00:03:12,960 --> 00:03:15,540\nSo maybe we wanna go back and\nwe wanna add that company.\n\n61\n00:03:15,540 --> 00:03:17,030\nWe could do a filter.\n\n62\n00:03:17,030 --> 00:03:20,070\nI was trying to find all of the user\naccounts that had a blank company,\n\n63\n00:03:20,070 --> 00:03:21,160\nfor example.\n\n64\n00:03:21,160 --> 00:03:24,410\nI could do a -not to negate.\n\n65\n00:03:24,410 --> 00:03:32,424\nAnd then inside my parentheses here,\nI could do company-like and\n\n66\n00:03:32,424 --> 00:03:38,870\njust an empty quote, or I'm sorry\nactually let's do an asterisk in there.\n\n67\n00:03:38,870 --> 00:03:42,590\nSo if we take a minute and read that,\nwe're finished closing it up.\n\n68\n00:03:42,590 --> 00:03:44,710\n>> Do you need to get rid of\nan asterisk after filter?\n\n69\n00:03:44,710 --> 00:03:48,790\n>> No, that's going to bring them\nall in there, oh yes, sorry my bad.\n\n70\n00:03:48,790 --> 00:03:49,990\nLeft the old filter in there, thank you.\n\n71\n00:03:52,362 --> 00:03:55,450\nAll right so now we got a filter where\nit's saying company like anything.\n\n72\n00:03:55,450 --> 00:03:59,030\nBut then we've got the word not in\nfront of that, so not like anything,\n\n73\n00:03:59,030 --> 00:04:01,260\nwhich should be blank.\n\n74\n00:04:01,260 --> 00:04:03,390\nSo we hit Enter,\nI can see that all three user accounts,\n\n75\n00:04:03,390 --> 00:04:05,970\ncuz I'm still on that search base,\njust that host OU.\n\n76\n00:04:05,970 --> 00:04:11,070\nI can see all three users must have\na blank company attribute, and\n\n77\n00:04:11,070 --> 00:04:19,190\nwe can see that if we do a Get-ADUser.\n\n78\n00:04:19,190 --> 00:04:23,590\nLet's do a, I'm actually gonna reuse that\nsame command, we'll stay in that same one.\n\n79\n00:04:23,590 --> 00:04:32,010\nThen I'm gonna add a -property and\nwe're gonna do a company.\n\n80\n00:04:33,890 --> 00:04:36,640\n>> Yeah, company, notice in\nthe output from the command above,\n\n81\n00:04:36,640 --> 00:04:39,000\ncompany is not one of\nthe values that's returned.\n\n82\n00:04:39,000 --> 00:04:44,450\nSo, for whatever reason, Get-ADUser just\nreturns this real subset of options.\n\n83\n00:04:44,450 --> 00:04:46,170\nSo, if you wanna display other things,\n\n84\n00:04:46,170 --> 00:04:49,680\nlike who they're managed by,\nor whether they're locked out.\n\n85\n00:04:49,680 --> 00:04:51,800\nThose are tucked away under Properties.\n\n86\n00:04:51,800 --> 00:04:55,190\nAnd so Mike's just adding in\nthat property called company\n\n87\n00:04:55,190 --> 00:04:58,080\nto be able to get it back and here we can\nsee just the name and the company and\n\n88\n00:04:58,080 --> 00:05:00,250\nyou'll see the company is blank for\nall three.\n\n89\n00:05:00,250 --> 00:05:01,360\n>> Exactly.\n\n90\n00:05:01,360 --> 00:05:03,780\nSo if we wanted to set those companies,\n\n91\n00:05:03,780 --> 00:05:06,860\nif we want to do that in bulk,\nbecause we can do it singly, right?\n\n92\n00:05:06,860 --> 00:05:10,576\nWe could just a set-ADUser Mike and\nthen -company and\n\n93\n00:05:10,576 --> 00:05:13,850\nthen whatever value you want to set it to.\n\n94\n00:05:13,850 --> 00:05:18,330\nIf you want to use all three, we're gonna\ntake this, and we're gonna pipe it out.\n\n95\n00:05:18,330 --> 00:05:21,990\nSo I will say as a precaution,\n\n96\n00:05:21,990 --> 00:05:24,825\nanytime you're gonna do bulk operations,\nyou want to be really careful.\n\n97\n00:05:24,825 --> 00:05:26,420\n>> [LAUGH]\n>> Because you're getting ready to make\n\n98\n00:05:26,420 --> 00:05:29,510\nchanges to multiple objects\nat the same time, right?\n\n99\n00:05:29,510 --> 00:05:33,790\nSo I'll always run my filter first, like\nI'm gonna run this command one more time.\n\n100\n00:05:33,790 --> 00:05:39,090\nOops, let me take that back out,\nI forgot we added to that guy.\n\n101\n00:05:39,090 --> 00:05:41,430\nLet's take out that little pipe there.\n\n102\n00:05:43,650 --> 00:05:48,180\nAnd I can see that it only returns the\nthree users I want to make a change to.\n\n103\n00:05:48,180 --> 00:05:50,780\nWhat if I had mistyped my filter and\n\n104\n00:05:50,780 --> 00:05:54,860\ninstead of getting just those three users,\nI got all the users in the company.\n\n105\n00:05:54,860 --> 00:05:56,120\nAnd I didn't bother to test it.\n\n106\n00:05:56,120 --> 00:05:59,760\nI went ahead and piped it into\nsay a Disable Account command, or\n\n107\n00:05:59,760 --> 00:06:00,750\nsomething like that, right.\n\n108\n00:06:00,750 --> 00:06:03,820\nI could end up disabling all\nthe accounts in the entire company\n\n109\n00:06:03,820 --> 00:06:05,300\nin one quick command.\n\n110\n00:06:05,300 --> 00:06:09,180\nSo always check the first\npart of your syntax.\n\n111\n00:06:09,180 --> 00:06:13,200\nMake sure that it is returning the list\nof user accounts that you wanna modify.\n\n112\n00:06:13,200 --> 00:06:18,590\nOnce you're sure the list is returning\nwhat you want then we can go and\n\n113\n00:06:18,590 --> 00:06:26,140\npipe that into a set-ADUser and\nlet's set that company.\n\n114\n00:06:26,140 --> 00:06:30,335\n>> You know that's one of the negatives\n\n115\n00:06:30,335 --> 00:06:33,585\nof the GUI is that you can only\nchange one thing at a time, right?\n\n116\n00:06:33,585 --> 00:06:37,485\nBut one of the positives of the GUI is\nyou can only mess up one thing at time.\n\n117\n00:06:37,485 --> 00:06:39,445\nAnd here you can mess up\nan infinite amount, so.\n\n118\n00:06:39,445 --> 00:06:40,775\n>> Oh, absolutely.\n\n119\n00:06:40,775 --> 00:06:43,525\n>> You've tested yours and\nnow you're basically setting that company.\n\n120\n00:06:43,525 --> 00:06:44,775\n>> Yep.\n\n121\n00:06:44,775 --> 00:06:46,790\nSo, and I shouldn't get any results.\n\n122\n00:06:46,790 --> 00:06:50,750\nNow if I go find that command\nwhere we pulled back all of those,\n\n123\n00:06:50,750 --> 00:06:52,340\nthat's gonna give us a blank one.\n\n124\n00:06:52,340 --> 00:06:53,790\nLet's just write a new command.\n\n125\n00:06:53,790 --> 00:06:59,736\nLet's do it Get -ADUser -searchbase.\n\n126\n00:07:03,195 --> 00:07:07,212\nActually that's gonna take too long,\nI'll get all of them.\n\n127\n00:07:07,212 --> 00:07:10,530\nWe'll do a Get -ADUser.\n\n128\n00:07:10,530 --> 00:07:14,770\nAnd let's do a -filter,\nand we'll do that to all,\n\n129\n00:07:14,770 --> 00:07:19,710\nwe'll make sure we grab that\ncompany attribute so property,\n\n130\n00:07:19,710 --> 00:07:25,620\nI want to include company, and\nthen let's format that out into a table or\n\n131\n00:07:25,620 --> 00:07:29,220\na list, let's do a table name and company.\n\n132\n00:07:31,030 --> 00:07:35,170\nAnd there I can see those three user\naccounts Don, Mike, and Ronnie and\n\n133\n00:07:35,170 --> 00:07:37,520\ntheir company is now all set to ITproTV.\n\n134\n00:07:38,630 --> 00:07:43,302\nWe're able to take that Get User command,\nwork it up, set our filter,\n\n135\n00:07:43,302 --> 00:07:47,230\nyou know, looking for like blank company.\n\n136\n00:07:47,230 --> 00:07:50,460\nAnd then once I know I've got the right\nlist of users coming back, I can just\n\n137\n00:07:50,460 --> 00:07:54,520\npipe that into my set command and I can\nform whatever action I want at that point.\n\n138\n00:07:54,520 --> 00:07:57,490\n>> And it's not much different than if you\nwere performing this on a single user.\n\n139\n00:07:57,490 --> 00:08:01,960\nIf you look at Mike's command,\nSet -ADUser -company itprotv.\n\n140\n00:08:01,960 --> 00:08:06,310\nIf you wanted to set the company for\none user, you do that same command,\n\n141\n00:08:06,310 --> 00:08:10,510\nyou would just add -identity, and the name\nof the person you wanted to modify, right?\n\n142\n00:08:10,510 --> 00:08:13,030\nSo all we're doing here is\nleaving off the -identity.\n\n143\n00:08:13,030 --> 00:08:16,210\nThe identity is actually coming\nfrom the previous command.\n\n144\n00:08:16,210 --> 00:08:17,460\nAnd you stack them together.\n\n145\n00:08:17,460 --> 00:08:19,430\nSo, if you know how to change\nthe value for one user,\n\n146\n00:08:19,430 --> 00:08:22,870\nyou know how to change the value for\nmultiple values simply by\n\n147\n00:08:22,870 --> 00:08:26,610\npiping the value of your query into\nyour command, pretty straight forward.\n\n148\n00:08:26,610 --> 00:08:30,300\n>> Exactly, and you can do a lot of\nreally neat things with these commands.\n\n149\n00:08:30,300 --> 00:08:32,640\nLike another one that we could\ndo is maybe I want to look for\n\n150\n00:08:32,640 --> 00:08:36,790\nall of the users that haven't logged on in\nthe last 90 days or something like that,\n\n151\n00:08:36,790 --> 00:08:38,790\nsomething we gotta do periodically.\n\n152\n00:08:38,790 --> 00:08:41,770\nWe can show an example of that.\n\n153\n00:08:41,770 --> 00:08:43,400\nIf I go out and do a, let's see here.\n\n154\n00:08:43,400 --> 00:08:47,750\nWhat I'm gonna do here, I'm gonna set\na creative variable called logondate.\n\n155\n00:08:47,750 --> 00:08:52,630\nAnd I'm going to set\nthat equal to get date\n\n156\n00:08:54,710 --> 00:09:00,600\nand let's add to that a negative 90 for\nexample.\n\n157\n00:09:00,600 --> 00:09:04,480\n>> So that would be basically\nthe variable that's storing\n\n158\n00:09:04,480 --> 00:09:07,280\nwhatever day it was 90\ndays prior to today.\n\n159\n00:09:07,280 --> 00:09:08,000\nThree months ago.\n\n160\n00:09:08,000 --> 00:09:09,090\n>> Exactly.\n\n161\n00:09:09,090 --> 00:09:10,530\nAnd then I could turn around and\n\n162\n00:09:10,530 --> 00:09:15,290\ndo a Get-ADUser command and\nI'm gonna do a filter.\n\n163\n00:09:17,120 --> 00:09:23,924\nThen for my filter, I will do a lastlogon,\n\n164\n00:09:23,924 --> 00:09:30,384\nis less than or equal to my $logondate.\n\n165\n00:09:30,384 --> 00:09:32,832\nAnd in that little block.\n\n166\n00:09:35,851 --> 00:09:40,366\n>> All right, so that would return anybody\nwho hasn't logged in, in the last 90 days.\n\n167\n00:09:40,366 --> 00:09:40,950\n>> Mm-hm.\n\n168\n00:09:40,950 --> 00:09:47,106\nSo, yeah, get-ADUser-filter last logon\nless than or equal to 90 days ago.\n\n169\n00:09:47,106 --> 00:09:51,060\nSo, anybody that has not\nlogged on in 90 days or more.\n\n170\n00:09:51,060 --> 00:09:52,543\nSo that gives me a list of all the users.\n\n171\n00:09:52,543 --> 00:09:55,910\nI don't want to disable, like,\nmy Kerberos Ticket-Granting Ticket or\n\n172\n00:09:55,910 --> 00:09:56,898\nanything like that.\n\n173\n00:09:56,898 --> 00:10:00,730\nIf I did a search base, I guess I\ncould limit that to just that one OU.\n\n174\n00:10:02,010 --> 00:10:05,799\nLet's do that, let's do a search base, and\n\n175\n00:10:05,799 --> 00:10:09,698\nwe'll set that equal to\nthat OU equals hosts.\n\n176\n00:10:09,698 --> 00:10:14,923\nWhich is inside user accounts\nwhich is inside IT protv.net.\n\n177\n00:10:14,923 --> 00:10:20,336\nAnd now it's just getting two\nusers because I logged on using\n\n178\n00:10:20,336 --> 00:10:26,082\none of those user accounts a minute\nago testing some things out.\n\n179\n00:10:26,082 --> 00:10:30,672\nSo there's two user accounts\nthat haven't logged on\n\n180\n00:10:30,672 --> 00:10:35,530\nin the last 90 days, so\nmaybe I want to disable those.\n\n181\n00:10:35,530 --> 00:10:40,310\nThey're no longer needed, they were temp\nworkers, I forgot to set on an expiration\n\n182\n00:10:40,310 --> 00:10:43,360\ndate on those accounts, so I use my\ncommand to go find any accounts that\n\n183\n00:10:43,360 --> 00:10:47,199\nare still hanging out there that nobody's\nused, and I can just do a disable.\n\n184\n00:10:49,554 --> 00:10:50,483\n>> If I could spell.\n\n185\n00:10:53,596 --> 00:10:58,490\nAccount and\nnow it will disable those two accounts.\n\n186\n00:10:59,910 --> 00:11:01,390\n>> Yeah.\nQuick and easy.\n\n187\n00:11:01,390 --> 00:11:04,380\nIf you have user accounts that\nhaven't logged in in ninety days,\n\n188\n00:11:04,380 --> 00:11:06,600\nthose are probably employees\nwho were terminated.\n\n189\n00:11:06,600 --> 00:11:11,540\nThat have you know just nobody knew or\nremembered to disable them when they left.\n\n190\n00:11:11,540 --> 00:11:14,970\nSo it's usually saved to disable those or\ncomputer accounts, right.\n\n191\n00:11:14,970 --> 00:11:17,900\nThey might be computers that have\nbeen decommissioned and removed so\n\n192\n00:11:17,900 --> 00:11:21,520\nthis is a great way to ensure that we\ndon't have straggling accounts laying\n\n193\n00:11:21,520 --> 00:11:23,100\naround in our Active Directory.\n\n194\n00:11:23,100 --> 00:11:26,880\nYou could automate this and set it\nto run once a day or once a week and\n\n195\n00:11:26,880 --> 00:11:30,680\nit would just scan through the AD looking\nfor any users that hadn't logged in and\n\n196\n00:11:30,680 --> 00:11:31,460\ndisable them.\n\n197\n00:11:31,460 --> 00:11:35,930\nIt's a great way to improve security,\nright, real simple, all done, right here.\n\n198\n00:11:35,930 --> 00:11:37,380\n>> Another handy one to do might be,\n\n199\n00:11:37,380 --> 00:11:42,110\nin a previous segment we used a script\nto create a bunch of new user accounts.\n\n200\n00:11:42,110 --> 00:11:46,400\nAnd in that script we set their\npassword to a generic password so\n\n201\n00:11:46,400 --> 00:11:49,250\nthat we could enable the account and\nthey could go logon.\n\n202\n00:11:49,250 --> 00:11:53,300\nWhat we didn't do is tell it that I want\nthem to change their password in the next\n\n203\n00:11:53,300 --> 00:11:56,550\nlogon, right, so\nlet's say we hired 15 new people,\n\n204\n00:11:56,550 --> 00:11:59,490\nand I used a script to create\nthose new accounts and\n\n205\n00:11:59,490 --> 00:12:02,440\nset their password to a generic\npassword that everybody knows.\n\n206\n00:12:02,440 --> 00:12:06,320\nThey walk in on Monday, I say here's\nyour account name, here's your password,\n\n207\n00:12:06,320 --> 00:12:08,620\ngo sit at your cubicle,\ngo ahead and logon.\n\n208\n00:12:08,620 --> 00:12:11,560\nWell when they logon that first time,\nI want them to have to\n\n209\n00:12:11,560 --> 00:12:14,920\nchange their password to something\nthat they know, and nobody else knows.\n\n210\n00:12:14,920 --> 00:12:18,070\nI don't wanna have to go through Active\nDirectory, and open up the properties on\n\n211\n00:12:18,070 --> 00:12:21,000\neach one of those user accounts,\nand check that little checkmark.\n\n212\n00:12:21,000 --> 00:12:23,370\nUser must change password at next logon.\n\n213\n00:12:23,370 --> 00:12:28,372\nSo what I can do is, I can just pipe this\nout into a change password at next logon.\n\n214\n00:12:28,372 --> 00:12:31,150\n[SOUND]\n>> [LAUGH]\n\n215\n00:12:31,150 --> 00:12:35,459\n>> If we do a set-ADUser first and\n\n216\n00:12:35,459 --> 00:12:40,601\nthen a -changePasswordatLogon and\n\n217\n00:12:40,601 --> 00:12:43,607\nset that to a $true.\n\n218\n00:12:43,607 --> 00:12:48,429\nAnd if we flip over to Active Directory\nand I do a little refresh.\n\n219\n00:12:50,650 --> 00:12:52,140\nAnd we take a look at Don's account.\n\n220\n00:12:53,240 --> 00:12:56,610\nI'll say user must change password\nat next logon is indeed checked.\n\n221\n00:12:57,650 --> 00:13:02,270\nSo just a couple of things that we can\ndo using PowerShell to automate making\n\n222\n00:13:02,270 --> 00:13:05,110\nchanges to bulk objects.\n\n223\n00:13:05,110 --> 00:13:08,080\nIt's really limited to your creativity.\n\n224\n00:13:08,080 --> 00:13:11,070\n>> Another one that is worthwhile\nto remember with this, because you\n\n225\n00:13:11,070 --> 00:13:16,570\nare changing multiple accounts,\nis remember the -what if operator.\n\n226\n00:13:16,570 --> 00:13:17,830\nMike, do you ever use that one?\n\n227\n00:13:17,830 --> 00:13:18,900\n>> I don't use it often.\n\n228\n00:13:18,900 --> 00:13:20,300\nI probably should.\n\n229\n00:13:20,300 --> 00:13:22,610\n>> Bring up the command you're\nin to disable the account.\n\n230\n00:13:22,610 --> 00:13:25,170\nWell, I guess that's not gonna quite work,\nis it?\n\n231\n00:13:25,170 --> 00:13:27,260\nSo, you know,\nhe disabled some accounts in bulk.\n\n232\n00:13:27,260 --> 00:13:29,895\nWhat if we wanted to re-enable\nthose same accounts?\n\n233\n00:13:29,895 --> 00:13:31,980\n>> Mm-hm.\n>> Well, he's looking for that logon date,\n\n234\n00:13:31,980 --> 00:13:34,940\nwhich is not going to work.\n\n235\n00:13:34,940 --> 00:13:37,140\nWell, no, I guess the logon\ndate hasn't changed, right.\n\n236\n00:13:37,140 --> 00:13:39,110\nSo you could run that same command, right?\n\n237\n00:13:39,110 --> 00:13:42,867\nLooking for people who haven't\nlogged in in the last 90 days and\n\n238\n00:13:42,867 --> 00:13:46,762\ninstead of disable -88,\nyou can say enable that 88 account and\n\n239\n00:13:46,762 --> 00:13:49,244\nthen at the very end of\nthat add a -what if.\n\n240\n00:13:49,244 --> 00:13:53,838\nAnd what -what if does is it doesn't\nactually run the command that\n\n241\n00:13:53,838 --> 00:13:57,960\nyou're putting in, right, so\nwhen he does -what if and.\n\n242\n00:13:57,960 --> 00:13:58,655\n>> Spells it right.\n\n243\n00:13:58,655 --> 00:14:00,170\n[LAUGH]\n>> And once that's in there,\n\n244\n00:14:00,170 --> 00:14:02,880\nit's going to show what would happen,\nright?\n\n245\n00:14:02,880 --> 00:14:03,810\nAnd see how it's saying,\n\n246\n00:14:03,810 --> 00:14:07,020\nwhat if performing the operation\nset on target Don.\n\n247\n00:14:07,020 --> 00:14:09,090\nPerforming the operation on Ronnie.\n\n248\n00:14:09,090 --> 00:14:10,270\n>> But not Mike.\n\n249\n00:14:10,270 --> 00:14:13,290\n>> But not Mike, right,\nbecause you didn't show up in that list.\n\n250\n00:14:13,290 --> 00:14:16,140\nBut the other thing is it's\nnot actually doing it.\n\n251\n00:14:16,140 --> 00:14:19,690\nIt didn't actually perform\nthe operation on me or Ronnie.\n\n252\n00:14:19,690 --> 00:14:21,680\nIt's just saying,\nif you were to run this command,\n\n253\n00:14:21,680 --> 00:14:23,400\nhere's the people that would be affected.\n\n254\n00:14:23,400 --> 00:14:27,220\nSo when you're in your testing stages\nwhen you're not quite certain yet,\n\n255\n00:14:27,220 --> 00:14:29,960\nuse that-what if to do a quick test.\n\n256\n00:14:29,960 --> 00:14:32,370\nMake sure you get,\nwhat looks like the right users back.\n\n257\n00:14:32,370 --> 00:14:35,960\nBecause if you start seeing the Kerberos\nTicket-Granting Ticket Service.\n\n258\n00:14:35,960 --> 00:14:37,530\nYou mentioned that one, Mike.\n\n259\n00:14:37,530 --> 00:14:39,875\nIf you were to mess that thing up,\nthat's bad.\n\n260\n00:14:39,875 --> 00:14:41,770\n[LAUGH] You do not want that.\n\n261\n00:14:41,770 --> 00:14:43,320\nSo it would be that red flag,\n\n262\n00:14:43,320 --> 00:14:45,786\nyou'd get a chance to see it\nbefore you did any damage, right?\n\n263\n00:14:45,786 --> 00:14:50,500\nRemember -what if,\nalmost almost all of the set and\n\n264\n00:14:50,500 --> 00:14:54,703\nmodified commands support that-whatif so\ndefinitely use it.\n\n265\n00:14:54,703 --> 00:14:58,576\n>> That's another one where now that\nI've once I've determined that I did get\n\n266\n00:14:58,576 --> 00:15:01,782\nthe right users back I could just\ntake the what if off of there and\n\n267\n00:15:01,782 --> 00:15:04,950\nexecute my command so\nI don't have to retype the whole thing.\n\n268\n00:15:04,950 --> 00:15:09,360\n>> There is another one that I\nnever use which is -confirm.\n\n269\n00:15:09,360 --> 00:15:13,410\nIf you want it to prompt you for\neach one, that yes, no all prompt,\n\n270\n00:15:13,410 --> 00:15:16,610\nand that way you can go one by one and\nverify.\n\n271\n00:15:16,610 --> 00:15:19,040\nSo, if you want to make sure, yeah,\ngo ahead and search the AD for\n\n272\n00:15:19,040 --> 00:15:21,090\npeople who haven't\nlogged in in 90 days but\n\n273\n00:15:21,090 --> 00:15:23,600\none by one give me a chance to accept or\ndeny, right?\n\n274\n00:15:23,600 --> 00:15:27,870\nYou can throw a -confirm on the end and\nit'll confirm each step along the way.\n\n275\n00:15:27,870 --> 00:15:31,300\nSo -whatif, -confirm, good ones to use\nwhen you're doing bulk operations.\n\n276\n00:15:33,230 --> 00:15:36,470\nAll right, well, in this segment\nwe got a chance to see how to\n\n277\n00:15:36,470 --> 00:15:38,760\nhandle bulk operations in the PowerShell.\n\n278\n00:15:38,760 --> 00:15:42,410\nWe come up with some kind of get command\nthat gathers all the objects you want\n\n279\n00:15:42,410 --> 00:15:43,260\nto modify.\n\n280\n00:15:43,260 --> 00:15:46,850\nAnd we pipe that into a set or\na modified command to actually go in and\n\n281\n00:15:46,850 --> 00:15:49,510\nchange those values and\nget them put in place.\n\n282\n00:15:49,510 --> 00:15:51,910\nPretty easy to do, very powerful.\n\n283\n00:15:51,910 --> 00:15:54,890\nWe also talk about some ways to test and\nmake sure we don't screw it up!\n\n284\n00:15:54,890 --> 00:15:55,820\nRight?\n>> [LAUGH]\n\n285\n00:15:55,820 --> 00:15:57,220\n>> Running our get command\n\n286\n00:15:57,220 --> 00:15:59,640\nwith the filter first to verify\nwe get the results we want.\n\n287\n00:15:59,640 --> 00:16:01,850\nUsing what if, using confirm, right?\n\n288\n00:16:01,850 --> 00:16:04,300\nAll different modifiers that\nare pretty handy there.\n\n289\n00:16:04,300 --> 00:16:08,480\nReally good stuff and this is truly\nwhat the PowerShell is designed for.\n\n290\n00:16:08,480 --> 00:16:09,260\nBulk changes.\n\n291\n00:16:10,330 --> 00:16:11,790\nAll right, well,\nI hope you guys enjoyed this segment.\n\n292\n00:16:11,790 --> 00:16:14,450\nStay tuned we've got more\nPowerShell coming up.\n\n293\n00:16:14,450 --> 00:16:20,109\n[MUSIC]\n\n",
          "vimeoId": "117182048"
        }
      ],
      "title": "Active Directory Domain Services"
    },
    {
      "episodes": [
        {
          "description": "",
          "length": "242",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-1-installing_hyperv-011315.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-1-installing_hyperv-011315-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-1-installing_hyperv-011315-sm.jpg",
          "title": "Installing Hyper-V",
          "transcript": "1\n00:00:00,000 --> 00:00:05,457\n[MUSIC]\n\n2\n00:00:08,161 --> 00:00:13,200\nAll right, in this segment, we're going to\nbe using PowerShell to install Hyper-V.\n\n3\n00:00:13,200 --> 00:00:14,589\nSo let's take a look at\nwhat we've got here.\n\n4\n00:00:15,810 --> 00:00:18,224\nI've got a server and I've got\nserver manager opened up currently.\n\n5\n00:00:18,224 --> 00:00:21,278\nAs we can see, there are no roles\ninstalled on it currently and\n\n6\n00:00:21,278 --> 00:00:24,392\nwe're going to take this server and\nmake it a Hyper-V server so\n\n7\n00:00:24,392 --> 00:00:26,551\nwe can use it to host\nour virtual machines.\n\n8\n00:00:26,551 --> 00:00:30,987\nSo I'm going to pull up PowerShell, and\nas we've seen in previous segments,\n\n9\n00:00:30,987 --> 00:00:34,838\nthe installing of the role,\nis a pretty straight forward command.\n\n10\n00:00:34,838 --> 00:00:40,144\nIt's gonna be, install-windowsfeature and\n\n11\n00:00:40,144 --> 00:00:45,581\nthe name of the role that\nwe're trying to install\n\n12\n00:00:45,581 --> 00:00:50,636\nis going to be a Hyper-V, so name Hyper-V.\n\n13\n00:00:50,636 --> 00:00:56,580\nAnd then I have to decide whether or not\nI want to include the management tools,\n\n14\n00:00:56,580 --> 00:01:00,377\nwhich I'm going to try to\nspell a little bit better\n\n15\n00:01:06,665 --> 00:01:10,794\nThey include those management tools, and\nHyper-V is one of the roles that's going\n\n16\n00:01:10,794 --> 00:01:13,250\nto require a restart to\nfinish the installation.\n\n17\n00:01:13,250 --> 00:01:16,570\nSo, I am going to include\na restart perimeter\n\n18\n00:01:16,570 --> 00:01:19,700\nwhich will force that machine to restart\non the completion of this command.\n\n19\n00:01:19,700 --> 00:01:21,580\nSo, I'll go ahead and run that command.\n\n20\n00:01:21,580 --> 00:01:25,790\nIt's gonna collect the data and\nit's gonna begin installing that role.\n\n21\n00:01:25,790 --> 00:01:27,836\nSo that you guys don't\nhave to sit here and\n\n22\n00:01:27,836 --> 00:01:31,656\nwatch the progress bar go across the\nscreen, we'll take a quick TV time out.\n\n23\n00:01:31,656 --> 00:01:33,823\nWe come back the server\nwill have rebooted and\n\n24\n00:01:33,823 --> 00:01:37,313\nwe'll verify that Hyper-V has been\ninstalled so we'll be right back.\n\n25\n00:01:37,313 --> 00:01:43,241\n[SOUND] [SOUND] All right,\nand through the magic of TV,\n\n26\n00:01:43,241 --> 00:01:47,160\nthat was the fastest reboot ever.\n\n27\n00:01:47,160 --> 00:01:50,608\nSo if we take a look at my screen now,\nweve installed that role, the server is\n\n28\n00:01:50,608 --> 00:01:54,404\nrebooted, and Im gonna open up PowerShell\njust to make sure everything went well.\n\n29\n00:01:54,404 --> 00:01:57,970\nCouple ways we could verify\nthat that role was installed.\n\n30\n00:01:57,970 --> 00:02:03,592\nOne of them is gonna check on the service,\nsee well do a get-service.\n\n31\n00:02:03,592 --> 00:02:05,375\nI'm really having a hard\ntime typing today.\n\n32\n00:02:05,375 --> 00:02:09,565\nget-service, the name of that service\nis VMMS and there I already can see\n\n33\n00:02:09,565 --> 00:02:15,130\nthe Hyper-V Virtual Machine Management\nservice is running, so that's a good sign.\n\n34\n00:02:15,130 --> 00:02:18,302\nThe other thing I can do is a get-vmhost.\n\n35\n00:02:20,296 --> 00:02:24,750\nAnd that should tell me about the physical\nmachine that I've installed this role on.\n\n36\n00:02:24,750 --> 00:02:27,700\nThere I can see the name of\nthe machine is actually VMHOST,\n\n37\n00:02:27,700 --> 00:02:28,940\nwe did that intentionally.\n\n38\n00:02:28,940 --> 00:02:33,080\nIt's got a couple logical processors\nthere, I can see its memory capabilities.\n\n39\n00:02:33,080 --> 00:02:37,631\nAnother command I could run that's not\ngonna be so exciting just yet is get-vm.\n\n40\n00:02:37,631 --> 00:02:39,908\nWe'll run this one in a segment coming up,\n\n41\n00:02:39,908 --> 00:02:42,330\nbecause right now I have\nno virtual machine.\n\n42\n00:02:42,330 --> 00:02:46,710\nWe just installed Hyper-V, so I don't\nreally have anything to look at there.\n\n43\n00:02:46,710 --> 00:02:51,760\nAnother command I could do would be a\nget-command, especially useful when we're\n\n44\n00:02:51,760 --> 00:02:56,675\ngetting familiar with Hyper-V and what\nI can do with Hyper-V from PowerShell.\n\n45\n00:02:56,675 --> 00:03:04,234\nSo I do a get-command -module, and the\nname of that module is gonna be hyper-v.\n\n46\n00:03:04,234 --> 00:03:07,990\nAnd you can see there's quite a few\ncommands that I can use to manipulate\n\n47\n00:03:07,990 --> 00:03:12,435\nthe physical server you know the virtual\nmachine host itself the virtual machines,\n\n48\n00:03:12,435 --> 00:03:13,910\nthe virtual switches.\n\n49\n00:03:13,910 --> 00:03:17,929\nEverything associated with managing and\nmaintaining these virtual machines.\n\n50\n00:03:17,929 --> 00:03:21,694\nNow the one thing I want to point out\nis these commands became available with\n\n51\n00:03:21,694 --> 00:03:22,785\nPowerShell 3.0.\n\n52\n00:03:22,785 --> 00:03:27,678\nThat's when they added the module for\nHyper-V to give us the ability to work\n\n53\n00:03:27,678 --> 00:03:31,130\nwith the Hyper-V server\nfrom my PowerShell prompt.\n\n54\n00:03:32,980 --> 00:03:36,300\nSo, in this segment,\nwe installed the role Hyper-V.\n\n55\n00:03:36,300 --> 00:03:39,140\nGot that installed,\nverified that was installed.\n\n56\n00:03:39,140 --> 00:03:42,875\nIn future segments coming up, we're gonna\ntake a look at all of the things we can do\n\n57\n00:03:42,875 --> 00:03:45,710\nwith our Hyper-V server,\nnow that we've got it installed.\n\n58\n00:03:45,710 --> 00:03:49,670\nWe'll take a look at creating some virtual\nswitches, creating some virtual machines\n\n59\n00:03:49,670 --> 00:03:52,450\nand then managing and\nmaintaining those virtual machines.\n\n60\n00:03:52,450 --> 00:03:55,651\nSo you guys stay tuned,\nmore PowerShell coming up.\n\n61\n00:03:55,651 --> 00:03:57,460\n[MUSIC]\n\n",
          "vimeoId": "117182050"
        },
        {
          "description": "",
          "length": "712",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-2-configuring_vms-011315.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-2-configuring_vms-011315-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-2-configuring_vms-011315-sm.jpg",
          "title": "Configuring VMs",
          "transcript": "1\n00:00:00,000 --> 00:00:07,441\n[MUSIC]\n\n2\n00:00:07,441 --> 00:00:11,882\nIn this segment, we're gonna take a look\nat how we can use PowerShell to create\n\n3\n00:00:11,882 --> 00:00:16,560\nvirtual machines and manage those\nvirtual machines on a Hyper-V server.\n\n4\n00:00:16,560 --> 00:00:18,750\nSo let's dive in and see what we've got.\n\n5\n00:00:18,750 --> 00:00:21,150\nFirst thing I'm gonna do is we're gonna\ngo ahead and create a virtual machine.\n\n6\n00:00:21,150 --> 00:00:24,800\nIn a previous segment I've\ninstalled Hyper-V on this server.\n\n7\n00:00:24,800 --> 00:00:28,050\nSo Ive got a brand new Hyper-V server,\nnothing created yet.\n\n8\n00:00:28,050 --> 00:00:30,190\nNow I did do a little\nbit behind the scenes.\n\n9\n00:00:30,190 --> 00:00:35,310\nWere gonna take a look at another segment\nat how I can create my virtual switches\n\n10\n00:00:35,310 --> 00:00:38,495\nthat we use to network these\nvirtual machines together, and\n\n11\n00:00:38,495 --> 00:00:41,165\nwith our physical network in\nour corporate environment.\n\n12\n00:00:41,165 --> 00:00:42,835\nI'm gonna save that for\nanother segment, so\n\n13\n00:00:42,835 --> 00:00:47,785\nI precreated a switch that I can use\nwhen I create these virtual machines.\n\n14\n00:00:47,785 --> 00:00:51,090\nSo let's take a look at the command and\nhow we can create some virtual machines.\n\n15\n00:00:51,090 --> 00:00:54,132\nThe syntax is relatively straight forward.\n\n16\n00:00:54,132 --> 00:00:58,762\nIt's going to be new-vm is\nthe command that we're gonna use.\n\n17\n00:00:58,762 --> 00:01:02,785\nAnd I can do it a couple of different\nways, we can do new-vm and then just\n\n18\n00:01:02,785 --> 00:01:07,430\ngive it a name and hit enter and you'll\nsee it actually created a virtual machine.\n\n19\n00:01:07,430 --> 00:01:09,196\nNow I've used all of my defaults.\n\n20\n00:01:09,196 --> 00:01:12,136\nIf I was to go into my Hyper-V settings,\nI've got my defaults for\n\n21\n00:01:12,136 --> 00:01:15,342\nwhere it's going to create the virtual\nmachine configuration files,\n\n22\n00:01:15,342 --> 00:01:18,725\nwhere it's gonna create, in fact,\nthis one didn't create a hard drive.\n\n23\n00:01:18,725 --> 00:01:21,691\nI didn't specify to create\na hard drive in the command,\n\n24\n00:01:21,691 --> 00:01:24,670\nI didn't attach an existing\nhard drive in the command.\n\n25\n00:01:24,670 --> 00:01:28,300\nAnd if you think to the GUI, right, if you\ngo back to the wizard cuz most of us have\n\n26\n00:01:28,300 --> 00:01:29,980\ngone through the wizard at this point.\n\n27\n00:01:29,980 --> 00:01:32,720\nWe're now moving on to using PowerShell,\nwe can start automating this,\n\n28\n00:01:32,720 --> 00:01:33,870\nget a little more powerful.\n\n29\n00:01:33,870 --> 00:01:36,879\nThink about the options that you had\nto choose when you're creating a new VM\n\n30\n00:01:36,879 --> 00:01:39,666\nthrough the wizard, right,\ninside the graphical user interface.\n\n31\n00:01:39,666 --> 00:01:41,882\nYou gotta specify the name and\nthe location.\n\n32\n00:01:41,882 --> 00:01:46,940\nWell, since I didn't specify, I gave it\na name, it used all my default locations.\n\n33\n00:01:46,940 --> 00:01:48,640\nI didn't attach a virtual hard drive.\n\n34\n00:01:48,640 --> 00:01:49,330\nSo it just left it.\n\n35\n00:01:49,330 --> 00:01:51,539\nIt does not have a virtual\nhard drive at this point.\n\n36\n00:01:51,539 --> 00:01:53,931\nSo not the most useful command, right?\n\n37\n00:01:53,931 --> 00:01:57,149\nJust wanted to show you that you\ncould do that and then go back and\n\n38\n00:01:57,149 --> 00:01:59,050\nadd the rest of it later.\n\n39\n00:01:59,050 --> 00:02:02,530\nNext I wanna show you a command where I\nactually specify a few more parameters,\n\n40\n00:02:02,530 --> 00:02:05,590\nmake it a more useful virtual machine.\n\n41\n00:02:05,590 --> 00:02:08,400\nI'm gonna start out the same, new-vm.\n\n42\n00:02:08,400 --> 00:02:10,320\nI'm gonna give this\nvirtual machine a name.\n\n43\n00:02:10,320 --> 00:02:15,421\nI'm gonna call it something like web01,\nkeep it nice and short.\n\n44\n00:02:15,421 --> 00:02:17,169\nNext parameter I'm gonna use,\n\n45\n00:02:17,169 --> 00:02:20,413\nI'm gonna specify how much\nmemory it has when it starts up.\n\n46\n00:02:20,413 --> 00:02:24,443\nAnd the parameter for that is gonna be\n\n47\n00:02:24,443 --> 00:02:30,167\n-MemoryStartupBytes, -MemoryStartupBytes.\n\n48\n00:02:30,167 --> 00:02:34,252\nI'll go ahead and\ngive this guy 2048, a couple gigs.\n\n49\n00:02:34,252 --> 00:02:37,663\nAll right, and\nthat's gonna be in megabytes, and\n\n50\n00:02:37,663 --> 00:02:40,380\nthen I'm gonna attach it to a network.\n\n51\n00:02:40,380 --> 00:02:41,970\nNow again,\nI've already created this network,\n\n52\n00:02:41,970 --> 00:02:45,530\nI'll show you how to create those\nnetworks in a later segment.\n\n53\n00:02:45,530 --> 00:02:51,280\nSo the parameter's gonna be -SwitchName,\n-SwitchName,\n\n54\n00:02:51,280 --> 00:02:54,870\nand the one I created was called lan,\nor I just called it lan for short.\n\n55\n00:02:56,450 --> 00:03:02,652\nAnd then I can do a -NewVHDPath,\n-NewVHDPath,\n\n56\n00:03:02,652 --> 00:03:08,271\nand I'll specify where\nI wanna create that.\n\n57\n00:03:08,271 --> 00:03:12,556\nRemember when you configure your Hyper-V\nserver you can specify what your default\n\n58\n00:03:12,556 --> 00:03:14,402\nlocations are for creating these.\n\n59\n00:03:14,402 --> 00:03:17,909\nAnd then you don't have to provide these,\nbut if you want to create it in\n\n60\n00:03:17,909 --> 00:03:21,534\nan alternate location, you can provide\nthis parameter in the command and\n\n61\n00:03:21,534 --> 00:03:23,920\nyou can use that alternate location.\n\n62\n00:03:23,920 --> 00:03:29,106\nFor me, I'm gonna do c:\\,\nI think I made a folder called virtuals.\n\n63\n00:03:29,106 --> 00:03:30,198\nYeah, I did.\n\n64\n00:03:30,198 --> 00:03:34,610\nI'll just dump it in there, and\nthen I'm gonna give that disc a name.\n\n65\n00:03:34,610 --> 00:03:40,260\nI'm going to call it webo1-disc1 and\nwe'll go ahead and\n\n66\n00:03:40,260 --> 00:03:44,441\nmake that a vhdx, that new generation, and\n\n67\n00:03:44,441 --> 00:03:48,063\nthen the size is -NewVHDSizeBytes.\n\n68\n00:03:48,063 --> 00:03:51,709\nSo, -NewVHDSizeBytes.\n\n69\n00:03:51,709 --> 00:03:57,701\nAnd I'm going to make\nthis one 64GB in size.\n\n70\n00:03:57,701 --> 00:03:59,363\nGo ahead and hit Enter.\n\n71\n00:03:59,363 --> 00:04:03,990\nNow if I didn't make any crazy typos\nit should create that machine.\n\n72\n00:04:03,990 --> 00:04:08,106\nNow, in this case, it created what we'd\ncall a dynamically expanding drive, right?\n\n73\n00:04:08,106 --> 00:04:10,644\nYou guys have gone through the episodes\nhopefully where we've talked\n\n74\n00:04:10,644 --> 00:04:12,332\nabout Hyper-V and virtual machines before.\n\n75\n00:04:12,332 --> 00:04:17,395\nIt creates a dynamically expanding drive,\nmeaning it's not actually 64 gigabytes.\n\n76\n00:04:17,395 --> 00:04:22,175\nIt completed almost immediately, so\nright now it's about 4 megs in size and\n\n77\n00:04:22,175 --> 00:04:24,244\nit'll grow as I add data to them.\n\n78\n00:04:24,244 --> 00:04:28,127\nWhen I install my operating system, when\nI configure it, when I add files to it,\n\n79\n00:04:28,127 --> 00:04:29,051\nthings like that.\n\n80\n00:04:29,051 --> 00:04:32,812\nThat drive will expand to\na maximum of 64 gigabytes.\n\n81\n00:04:32,812 --> 00:04:36,379\nSo, that's really what I'm specifying\nthere, is the max size for\n\n82\n00:04:36,379 --> 00:04:38,954\nthat dynamically expanding drive,\nall right.\n\n83\n00:04:38,954 --> 00:04:41,738\nSo, now I've got a virtual\nmachine that we can work with and\n\n84\n00:04:41,738 --> 00:04:44,816\nlet's take a look at a couple of\nthe commands I might use for that.\n\n85\n00:04:44,816 --> 00:04:48,635\nThe first one,\none I find very useful is just Get-VM.\n\n86\n00:04:48,635 --> 00:04:51,497\nNow if I do a get-vm,\nwe saw that a previous segment, and\n\n87\n00:04:51,497 --> 00:04:54,460\nI didn't have any virtual\nmachines at that point.\n\n88\n00:04:54,460 --> 00:04:57,330\nNow that I've got a virtual machine,\nor a couple of virtual machines,\n\n89\n00:04:57,330 --> 00:05:00,450\nI can see a little bit of information\nabout those virtual machines.\n\n90\n00:05:00,450 --> 00:05:04,360\nI've got one called test, I've got one\ncalled web01, both of them are currently\n\n91\n00:05:04,360 --> 00:05:08,470\nturned off so they're not using any\nCPU and they're not using any memory.\n\n92\n00:05:08,470 --> 00:05:09,730\nReal quick easy command,\n\n93\n00:05:09,730 --> 00:05:13,210\nthough, if I need to take a look at any\nof my Hyper-V servers, and see which\n\n94\n00:05:13,210 --> 00:05:17,690\none of my machines is soaking up a lot\nof my resources, easy command to use.\n\n95\n00:05:17,690 --> 00:05:19,750\nNow, I can get a little more\nspecific with that command.\n\n96\n00:05:19,750 --> 00:05:21,771\nWe can take that get-vm command,\n\n97\n00:05:21,771 --> 00:05:26,315\nadd the name of a particular virtual\nmachine that I wanna get information on.\n\n98\n00:05:26,315 --> 00:05:29,197\nAnd if I just do it like that\nI get the same information,\n\n99\n00:05:29,197 --> 00:05:33,395\nit's just filtered to that one machine,\nwhich could be handy if you have dozens\n\n100\n00:05:33,395 --> 00:05:35,986\nof machines and\nyou want to see a particular one.\n\n101\n00:05:35,986 --> 00:05:39,980\nYou can also use wildcards in here,\nwhich is another very handy thing to do.\n\n102\n00:05:39,980 --> 00:05:44,984\nLike if I had several web servers and\nalso additional servers as well.\n\n103\n00:05:44,984 --> 00:05:49,714\nIf I wanted to see just some information\nabout the web servers, I had web01,\n\n104\n00:05:49,714 --> 00:05:52,866\nweb01, web03,\nI could do a get-vm web *, and\n\n105\n00:05:52,866 --> 00:05:56,660\nI would see just the virtual\nmachines I started with web.\n\n106\n00:05:56,660 --> 00:05:58,090\nSo very handy there.\n\n107\n00:05:58,090 --> 00:05:59,686\nAnd another command,\nwhat I like to do, though,\n\n108\n00:05:59,686 --> 00:06:01,740\nis I want a little more information\nabout that virtual machine.\n\n109\n00:06:01,740 --> 00:06:03,782\nI want to see what some\nof the configuration is.\n\n110\n00:06:03,782 --> 00:06:07,530\nLike in the GUI if we were to go in and\nright-click on our virtual machine and\n\n111\n00:06:07,530 --> 00:06:10,460\nchoose settings and\npull up that settings page.\n\n112\n00:06:10,460 --> 00:06:14,530\nI could do that here by\npiping out the get-vm,\n\n113\n00:06:14,530 --> 00:06:19,020\nname of the virtual machine,\npipe that into a select all.\n\n114\n00:06:19,020 --> 00:06:21,786\nI'll just do a select and\nthen an asterisk, and\n\n115\n00:06:21,786 --> 00:06:25,867\nI should get all that information or\nthe majority of the information,\n\n116\n00:06:25,867 --> 00:06:28,789\na lot of the information I'm looking for\nanyway.\n\n117\n00:06:28,789 --> 00:06:32,212\nLike I can see the current\nstate is that it's off.\n\n118\n00:06:32,212 --> 00:06:35,630\nI can see memory assign,\nit's not turned on right now so\n\n119\n00:06:35,630 --> 00:06:38,740\nit's not really using any resources.\n\n120\n00:06:38,740 --> 00:06:43,166\nWhere the snapshots are going,\nwhat my automatic start and\n\n121\n00:06:43,166 --> 00:06:45,130\nstop action is, things like that.\n\n122\n00:06:45,130 --> 00:06:50,550\nAnd all of these parameters can be set\nthrough PowerShell using a set-vm command,\n\n123\n00:06:50,550 --> 00:06:51,130\nright.\n\n124\n00:06:51,130 --> 00:06:53,910\nAnd then we can use\nthe name of the parameter.\n\n125\n00:06:53,910 --> 00:06:56,939\nFor example, let's say I want to\nchange the number of processors.\n\n126\n00:06:56,939 --> 00:07:00,625\nI can see right here, this virtual\nmachine has a processor count of one.\n\n127\n00:07:00,625 --> 00:07:01,144\nAll right.\n\n128\n00:07:01,144 --> 00:07:06,926\nSo if I wanna give it another processor,\nI can do a Set-VMProcessor.\n\n129\n00:07:06,926 --> 00:07:11,492\nAll right, so I'm specifying that\nattribute that I'm trying to change on\n\n130\n00:07:11,492 --> 00:07:14,251\nthat virtual machine, Set-VMProcessor.\n\n131\n00:07:14,251 --> 00:07:16,169\nAnd the name of that is web01,\n\n132\n00:07:16,169 --> 00:07:19,872\nthe machine I'm trying to make\nthe configuration change to.\n\n133\n00:07:19,872 --> 00:07:22,579\nAnd we'll set that to a -Count of 2,\n\n134\n00:07:22,579 --> 00:07:26,396\nI'm assuming I have a couple\nprocessors available.\n\n135\n00:07:26,396 --> 00:07:28,637\nIt should take care of that.\n\n136\n00:07:28,637 --> 00:07:34,016\nIt doesn't give me a lot of information\nback, so I could run another get-vm web01,\n\n137\n00:07:34,016 --> 00:07:37,570\nwe'll just pipe that out into\na select all or a select *.\n\n138\n00:07:39,370 --> 00:07:42,630\nAnd now I can see the number\nof processors is up to 2.\n\n139\n00:07:42,630 --> 00:07:47,370\nSo I was able to modify a configuration\nsetting on that virtual machine\n\n140\n00:07:47,370 --> 00:07:50,640\nvia PowerShell.\n\n141\n00:07:50,640 --> 00:07:55,981\nAnother one that you might find\nuseful in the production environment,\n\n142\n00:07:55,981 --> 00:07:59,015\ndon't usually use the dynamic memory.\n\n143\n00:07:59,015 --> 00:08:00,424\nBut in a test environment,\n\n144\n00:08:00,424 --> 00:08:03,925\nI really like the dynamic memory\nbecause it's a test environment.\n\n145\n00:08:03,925 --> 00:08:05,958\nI'm not looking for extreme performance.\n\n146\n00:08:05,958 --> 00:08:09,635\nI want to be able to fire up as many\nmachines as I can at the same time so\n\n147\n00:08:09,635 --> 00:08:13,565\nI'll typically use this dynamic memory but\njust so you guys know how.\n\n148\n00:08:13,565 --> 00:08:19,432\nSet-VMMemory and then the name of\nthe server I'm setting that memory on,\n\n149\n00:08:19,432 --> 00:08:24,726\nweb01, the parameter of that one is\ngoing to be -DynamicMemoryEnabled,\n\n150\n00:08:24,726 --> 00:08:27,300\n-DynamicMemoryEnabled.\n\n151\n00:08:27,300 --> 00:08:34,610\nAnd I'm just going to set that to a $true,\nhit Enter, and we are good to go.\n\n152\n00:08:34,610 --> 00:08:38,660\nSo more commands that we might use with\na virtual machine once we've got them\n\n153\n00:08:38,660 --> 00:08:41,205\ncreated, the ability to start and\nstop the VM.\n\n154\n00:08:41,205 --> 00:08:44,550\nLike this, now, I don't have an operating\nsystem installed on this machine yet.\n\n155\n00:08:44,550 --> 00:08:45,990\nWe just created it.\n\n156\n00:08:45,990 --> 00:08:50,409\nBut I can go ahead and start the VM or\nattempt to start the VM anyway.\n\n157\n00:08:50,409 --> 00:08:56,308\nWe're going to a start-vm, and then the\nname of the VM I'm trying to start, web01.\n\n158\n00:08:56,308 --> 00:09:00,310\nAnd it'll fire the machine up, I mean,\nthe virtual machine will start, right,\n\n159\n00:09:00,310 --> 00:09:02,113\nit's just not going to go anywhere.\n\n160\n00:09:02,113 --> 00:09:05,247\nIt's going to come to that screen and\nsay no boot device detected, right,\n\n161\n00:09:05,247 --> 00:09:08,830\nbecause I don't have anything\ninstalled on that particular machine.\n\n162\n00:09:08,830 --> 00:09:11,978\nIf I go back and\nget some status on that machine,\n\n163\n00:09:11,978 --> 00:09:16,780\nI can see that it is currently running and\nit is using the two gigs of memory\n\n164\n00:09:16,780 --> 00:09:20,126\nthat I assigned to it when\nI created that machine.\n\n165\n00:09:20,126 --> 00:09:22,100\nUptime 14 seconds.\n\n166\n00:09:22,100 --> 00:09:22,623\nWoo hoo!\n\n167\n00:09:22,623 --> 00:09:24,747\nIts like a record for\na Microsoft machine.\n\n168\n00:09:24,747 --> 00:09:31,640\nAll right, so then if I wanna stop that,\nthe command is simply stop-vm.\n\n169\n00:09:31,640 --> 00:09:34,030\nAnd then the name of the VM\nthat I'm trying to stop.\n\n170\n00:09:35,620 --> 00:09:37,320\nYes to actually stop that guy.\n\n171\n00:09:37,320 --> 00:09:38,650\nOh, you know what?\n\n172\n00:09:38,650 --> 00:09:41,440\nI haven't installed\nthe integration services.\n\n173\n00:09:41,440 --> 00:09:45,720\nIt'll stop it anyway, it's just warning me\nthere that it's not gonna be a graceful\n\n174\n00:09:45,720 --> 00:09:48,630\nshutdown because I haven't\ninstalled the integration services.\n\n175\n00:09:48,630 --> 00:09:51,310\nThere's no operating system on\nthe virtual machine yet, so\n\n176\n00:09:51,310 --> 00:09:54,120\nI can't really install\nthose integration services.\n\n177\n00:09:54,120 --> 00:09:56,820\nSo there we get to see how to stop and\nstart that guy.\n\n178\n00:09:56,820 --> 00:09:59,620\nThe other nice thing about that,\nremember I said we could use wildcards.\n\n179\n00:09:59,620 --> 00:10:01,730\nWe can use wildcards in\nthis command as well.\n\n180\n00:10:01,730 --> 00:10:06,491\nSo if I have five webservers,\nweb01, 2, 3, 4,\n\n181\n00:10:06,491 --> 00:10:10,200\nand 5, I could do a start-vm web*.\n\n182\n00:10:10,200 --> 00:10:14,600\nAnd that would fire up all five of those\nmachines, or you could do the same thing\n\n183\n00:10:14,600 --> 00:10:17,720\nif you wanted to shut them all down, or\nyou can shut every virtual machine down.\n\n184\n00:10:17,720 --> 00:10:20,590\nYou can do a start-vm, or a stop-vm,\n\n185\n00:10:20,590 --> 00:10:24,720\nand an asterisk with no name at all,\nand that will start or\n\n186\n00:10:24,720 --> 00:10:29,470\nstop all of the virtual machines that\nare residing on that Hyper-V host.\n\n187\n00:10:31,120 --> 00:10:34,070\nAll right so in this segment, oh, and\nI didn't, let me delete a vm for you guys.\n\n188\n00:10:34,070 --> 00:10:36,530\nAnother thing you might\nhave to do is remove one.\n\n189\n00:10:36,530 --> 00:10:39,820\nSo the command is just simply\ngonna be delete-vm and\n\n190\n00:10:39,820 --> 00:10:40,940\nthen the name of that machine.\n\n191\n00:10:40,940 --> 00:10:44,700\nI'll go ahead and delete that test virtual\nmachine we created earlier in the segment.\n\n192\n00:10:44,700 --> 00:10:46,920\nSo delete-vm.\n\n193\n00:10:46,920 --> 00:10:48,398\nI say delete, I meant remove.\n\n194\n00:10:48,398 --> 00:10:52,989\nHow about remove-vm, and then test.\n\n195\n00:10:52,989 --> 00:10:57,751\nAnd it's gonna ask are you sure you\nwant to remove that virtual machine?\n\n196\n00:10:57,751 --> 00:11:00,723\nI'll say yes and it will be gone.\n\n197\n00:11:00,723 --> 00:11:03,682\nRemember when you're running\nHyper-V without a system center\n\n198\n00:11:03,682 --> 00:11:07,189\nconfiguration manager when you delete\na machine like that you're deleting\n\n199\n00:11:07,189 --> 00:11:08,460\nthe configuration files.\n\n200\n00:11:08,460 --> 00:11:10,682\nThe hard drive itself is\nstill going to be there so\n\n201\n00:11:10,682 --> 00:11:12,536\nsomething that you have to keep in mind.\n\n202\n00:11:12,536 --> 00:11:15,756\nYou have to go back and delete that\nfile if I truly wanted to get rid of all\n\n203\n00:11:15,756 --> 00:11:17,679\nthe components of that virtual machine.\n\n204\n00:11:17,679 --> 00:11:18,589\nAll right so\n\n205\n00:11:18,589 --> 00:11:24,517\nin this segment we've learned how we\ncan use PowerShell to manage Hyper-V.\n\n206\n00:11:24,517 --> 00:11:27,455\nWe took a look at creating\na virtual machine.\n\n207\n00:11:27,455 --> 00:11:31,080\nOnce we created a virtual machine\nwe looked at how we start and\n\n208\n00:11:31,080 --> 00:11:35,274\nstop the machine, make changes to\nthe configuration of the machine,\n\n209\n00:11:35,274 --> 00:11:38,772\nas well as remove the machine\nat the end of its usefulness.\n\n210\n00:11:38,772 --> 00:11:42,643\nSo I hope you guys enjoyed\ntoday's segment, stay tuned,\n\n211\n00:11:42,643 --> 00:11:44,936\nmore PowerShell coming your way.\n\n212\n00:11:44,936 --> 00:11:51,849\n[MUSIC]\n\n",
          "vimeoId": "117182053"
        },
        {
          "description": "",
          "length": "672",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-3-configuring_vhds-011315.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-3-configuring_vhds-011315-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-3-configuring_vhds-011315-sm.jpg",
          "title": "Configuring VHDs",
          "transcript": "1\n00:00:00,370 --> 00:00:08,726\n[MUSIC]\n\n2\n00:00:08,726 --> 00:00:11,989\nIn this segment, we're gonna use\nPowerShell to configure some virtual hard\n\n3\n00:00:11,989 --> 00:00:15,000\ndrives, for our virtual\nmachines on our Hyper-V server.\n\n4\n00:00:15,000 --> 00:00:17,018\nSo let's dive right in and\nsee what we've got.\n\n5\n00:00:17,018 --> 00:00:22,410\nGot our Hyper-V, in a previous segment\nwe installed a Hyper-V on this server.\n\n6\n00:00:22,410 --> 00:00:24,220\nWe also created a couple\nof virtual machines.\n\n7\n00:00:24,220 --> 00:00:28,020\nNow I'm going to take a look at\ncreating some additional hard drives.\n\n8\n00:00:28,020 --> 00:00:29,210\nSo the first thing I want to do for\n\n9\n00:00:29,210 --> 00:00:32,855\nyou guys is create a dynamic\nvirtual hard drive.\n\n10\n00:00:32,855 --> 00:00:36,765\nProduction environment, typically we don't\nuse these dynamic virtual hard drives.\n\n11\n00:00:36,765 --> 00:00:40,295\nBecause we lose a little bit of\nperformance when that drive has to grow.\n\n12\n00:00:40,295 --> 00:00:44,410\nWe can also run into some issues if\nwe over allocate that drive space.\n\n13\n00:00:44,410 --> 00:00:45,970\nAs they grow they might run out of space.\n\n14\n00:00:45,970 --> 00:00:48,470\nThey can also become\nfragmented as they grow.\n\n15\n00:00:48,470 --> 00:00:52,130\nBut in a test environment before I\nmove them to a production environment,\n\n16\n00:00:52,130 --> 00:00:53,540\nwe're just testing new technologies.\n\n17\n00:00:53,540 --> 00:00:55,780\nDynamic drives are very useful.\n\n18\n00:00:55,780 --> 00:00:59,810\nWhen we used that command earlier in\na previous segment to create a VM.\n\n19\n00:00:59,810 --> 00:01:04,010\nIt creates a dynamically\nexpanding drive by default.\n\n20\n00:01:04,010 --> 00:01:08,200\nIf I want to create a virtual\nmachine with a fix size drive.\n\n21\n00:01:08,200 --> 00:01:11,420\nI'd actually have to create\nthat drive ahead of time, and\n\n22\n00:01:11,420 --> 00:01:14,160\nthen attach it to the virtual machine.\n\n23\n00:01:14,160 --> 00:01:17,860\nI can attach it to that virtual machine\nafter I create the virtual machine.\n\n24\n00:01:17,860 --> 00:01:22,710\nOr I can attach it during the creation\nusing the command I used to create.\n\n25\n00:01:22,710 --> 00:01:24,510\nIn the VM or the virtual machine.\n\n26\n00:01:24,510 --> 00:01:25,190\nSo let's see how you do it.\n\n27\n00:01:25,190 --> 00:01:27,340\nThe command is just simply New-VHD.\n\n28\n00:01:27,340 --> 00:01:32,710\nAnd then where do I wanna\ncreate this virtual hard drive?\n\n29\n00:01:32,710 --> 00:01:34,800\nThe parameter for that is gonna be -Path.\n\n30\n00:01:34,800 --> 00:01:39,401\nAnd I have a folder, I believe,\nwe'll find out here.\n\n31\n00:01:39,401 --> 00:01:44,990\nNow, C:\\Virtuals\\VHD.\n\n32\n00:01:44,990 --> 00:01:46,560\nSo I'm going to drop it in there.\n\n33\n00:01:46,560 --> 00:01:49,660\nThat's where we keep all our virtual\nhard drives on our Hyper-V server.\n\n34\n00:01:49,660 --> 00:01:52,080\nAnd then the name of the drive\nthat I want to create.\n\n35\n00:01:52,080 --> 00:01:57,304\nSo I'm going to call this web01 -Disk2.\n\n36\n00:01:57,304 --> 00:02:01,690\nAnd I'll make it a VHDX,a\nsecond generation there.\n\n37\n00:02:01,690 --> 00:02:05,430\nAnd then the size of that drive I'll\nspecify with a size bytes command.\n\n38\n00:02:08,551 --> 00:02:10,080\nAnd I'll go ahead and create this one.\n\n39\n00:02:10,080 --> 00:02:11,720\nSince it's a dynamically expanding,\n\n40\n00:02:11,720 --> 00:02:14,710\nI'm gonna go ahead and\ncreate a 36 gigabyte drive.\n\n41\n00:02:14,710 --> 00:02:16,850\nSo I don't have to wait for\nit to be created.\n\n42\n00:02:16,850 --> 00:02:17,670\nI'll go ahead and hit enter.\n\n43\n00:02:19,390 --> 00:02:23,000\nAnd there we see I have a new drive,\nweb01 -Disc2.\n\n44\n00:02:23,000 --> 00:02:27,260\nIt's 36 gigabytes, but\nit's a dynamically expanding drive.\n\n45\n00:02:27,260 --> 00:02:30,360\nSo right now it's taking up\nabout four megs in space.\n\n46\n00:02:30,360 --> 00:02:40,000\nIn fact, we flip over there,\nwe're up with that C:\\Virtuals\\VHD.\n\n47\n00:02:40,000 --> 00:02:41,220\nAnd we take a look,\n\n48\n00:02:41,220 --> 00:02:44,440\nthere's the disc I created in\na previous segment Web01 -Disc1.\n\n49\n00:02:44,440 --> 00:02:48,450\nAnd there's the one I just created,\nWeb01 -Disc 2,\n\n50\n00:02:48,450 --> 00:02:52,500\nboth of which are about four megs in size,\nbecause they're dynamically expanding.\n\n51\n00:02:52,500 --> 00:02:54,260\nThere's no data in there yet.\n\n52\n00:02:54,260 --> 00:02:56,840\nWe haven't installed an operating system,\nor anything like that.\n\n53\n00:02:59,200 --> 00:03:01,100\nAll right, so\nthat's our dynamically expanding disk.\n\n54\n00:03:01,100 --> 00:03:03,910\nThe other disk that we can create\nwould be a fixed size disk.\n\n55\n00:03:03,910 --> 00:03:08,810\nWhen we create a fixed size VHD, it's\ngonna go ahead and grab all of the space.\n\n56\n00:03:08,810 --> 00:03:11,150\nSo I created a 36 gigabyte drive.\n\n57\n00:03:11,150 --> 00:03:16,210\nIt's gonna go ahead and allocate 36\ngigabytes of hard drive space to that VHD.\n\n58\n00:03:16,210 --> 00:03:19,260\nThe command is very similar.\n\n59\n00:03:19,260 --> 00:03:20,374\nIt's new-VHD.\n\n60\n00:03:23,200 --> 00:03:28,716\nAnd we're gonna give it a path and\nI'll use that same path there.\n\n61\n00:03:28,716 --> 00:03:32,590\nC:/Virtual/VHD, and\nthen the name of this disk.\n\n62\n00:03:32,590 --> 00:03:35,472\nI'm gonna call it,\n\n63\n00:03:35,472 --> 00:03:40,391\nstick with my naming convention,\n\n64\n00:03:40,391 --> 00:03:46,336\nwe'll call it web01 -Disk3.VHDX.\n\n65\n00:03:46,336 --> 00:03:49,316\nAnd then I'm gonna add a parameter,\n-fixed.\n\n66\n00:03:49,316 --> 00:03:53,287\nThat's what's gonna change it from\na dynamically expanding drive,\n\n67\n00:03:53,287 --> 00:03:54,575\nto a fixed size drive.\n\n68\n00:03:54,575 --> 00:03:57,215\nAnd then same parameter for the size.\n\n69\n00:03:57,215 --> 00:03:58,015\n-sizebytes.\n\n70\n00:03:59,905 --> 00:04:04,245\nAnd I am going to just create\na three gigabyte drive.\n\n71\n00:04:04,245 --> 00:04:06,275\nJust so that I don't want to wait for\nit to create.\n\n72\n00:04:07,425 --> 00:04:08,727\nSo three gigabytes.\n\n73\n00:04:08,727 --> 00:04:09,227\nI'll hit enter.\n\n74\n00:04:14,624 --> 00:04:18,360\nCreates that virtual Hard Drive, notice\nit's taking a little longer to create.\n\n75\n00:04:18,360 --> 00:04:21,684\nIt's actually taking longer to\ncreate this 3 gigabyte drive,\n\n76\n00:04:21,684 --> 00:04:25,560\nthan it did to create that 36\ngigabyte in the previous command.\n\n77\n00:04:25,560 --> 00:04:28,850\nAgain, because that 36 gigabyte\ndrive was dynamically expanding.\n\n78\n00:04:28,850 --> 00:04:30,560\nIt starts out at 4 megs,\n\n79\n00:04:30,560 --> 00:04:35,540\nthis one is actually claiming the 3\ngigs of space on my physical disc.\n\n80\n00:04:35,540 --> 00:04:38,120\nSo we'll let this finish up, and\nthen I'll show you guys that drive.\n\n81\n00:04:40,900 --> 00:04:44,980\nWe'll do a little, we'll clear that\nscreen out and do a directory.\n\n82\n00:04:46,190 --> 00:04:50,400\nAnd I can see Disk3 is\nindeed 3 gigabytes in size.\n\n83\n00:04:50,400 --> 00:04:52,290\nEven though there's no data in there.\n\n84\n00:04:52,290 --> 00:04:54,460\nSo that's a fixed drive.\n\n85\n00:04:54,460 --> 00:04:56,910\nBetter performance because I don't\nhave to worry about it expanding in\n\n86\n00:04:56,910 --> 00:04:57,660\nthe middle of usage.\n\n87\n00:04:57,660 --> 00:05:01,030\nI don't have to worry about it becoming\nfragmented or anything like that.\n\n88\n00:05:01,030 --> 00:05:04,325\nBut I do have to have the space\navailable when I create the drive.\n\n89\n00:05:04,325 --> 00:05:08,430\nAnd it takes a little bit longer\nto initially create that drive.\n\n90\n00:05:08,430 --> 00:05:12,280\nThird type of drive I can create in\nHyper-V with my virtual machines,\n\n91\n00:05:12,280 --> 00:05:14,070\nis going to be a differencing disk.\n\n92\n00:05:14,070 --> 00:05:18,510\nDifferencing disks are when we want to,\nwe have a base drive, and\n\n93\n00:05:18,510 --> 00:05:20,850\nwe wanna keep that base\ndrive the way it is.\n\n94\n00:05:20,850 --> 00:05:25,650\nAnd we're gonna make a second drive\nthat stores all of the changes.\n\n95\n00:05:25,650 --> 00:05:26,380\nThese are, again,\n\n96\n00:05:26,380 --> 00:05:29,610\nsomething you're never probably gonna\nuse in a production environment.\n\n97\n00:05:29,610 --> 00:05:32,510\nBut, in the test environment,\nthey can be very handy.\n\n98\n00:05:32,510 --> 00:05:37,120\nI have a base drive for 2012 R2.\n\n99\n00:05:37,120 --> 00:05:39,660\nAnd I take that base drive,\nI set it aside.\n\n100\n00:05:39,660 --> 00:05:42,580\nAnd then when I create\nmy new virtual machines,\n\n101\n00:05:42,580 --> 00:05:47,680\nI create differencing drives based off or\nlinked back to that base drive.\n\n102\n00:05:47,680 --> 00:05:50,810\nSo, I can have several virtual\nmachines with their own hard drives.\n\n103\n00:05:50,810 --> 00:05:52,410\nTheir own distancing drives.\n\n104\n00:05:52,410 --> 00:05:54,950\nPointing back to that one base drive.\n\n105\n00:05:54,950 --> 00:05:56,670\nSo all the files that are in common,\n\n106\n00:05:56,670 --> 00:06:00,000\nthe operating system installation\nis on that base drive.\n\n107\n00:06:00,000 --> 00:06:01,680\nBut when I create the differencing drive,\n\n108\n00:06:01,680 --> 00:06:04,590\nthat's the drive that I assign\nto the virtual machine itself.\n\n109\n00:06:04,590 --> 00:06:08,460\nAnd so when I give that server a name,\nadd roles to it, and things like that.\n\n110\n00:06:08,460 --> 00:06:10,850\nThose are stored in that\ndifferencing drive.\n\n111\n00:06:10,850 --> 00:06:14,640\nSo I could have more than one server,\ndifferent names, different roles.\n\n112\n00:06:14,640 --> 00:06:17,180\nAll pointed back to that one base drive.\n\n113\n00:06:17,180 --> 00:06:19,340\nBut as you can imagine, if I have four or\n\n114\n00:06:19,340 --> 00:06:22,130\nfive servers,\neach with their own differencing drive.\n\n115\n00:06:22,130 --> 00:06:25,070\nAll pointed back to that one base drive.\n\n116\n00:06:25,070 --> 00:06:26,850\nMy performance is gonna degrade, right?\n\n117\n00:06:26,850 --> 00:06:30,390\nI'm gonna have a lot of contention\ntrying to read that base drive.\n\n118\n00:06:30,390 --> 00:06:33,490\nSo again, nothing I'm gonna use\nin a production environment.\n\n119\n00:06:33,490 --> 00:06:36,470\nBut in a test environment, when I'm\nwhipping out a little test network and\n\n120\n00:06:36,470 --> 00:06:38,590\nI need to throw out three or\nfour servers real quick.\n\n121\n00:06:38,590 --> 00:06:41,310\nAnd I don't want to take up\na lot of space or a lot of time.\n\n122\n00:06:41,310 --> 00:06:43,210\nThey work fantastic for that.\n\n123\n00:06:43,210 --> 00:06:47,082\nThe command is gonna be new-VHD again.\n\n124\n00:06:47,082 --> 00:06:51,590\nSo new-VHD, and for this one,\na little bit different.\n\n125\n00:06:51,590 --> 00:06:53,820\nBecause I'm making a differencing drive.\n\n126\n00:06:53,820 --> 00:06:55,660\nI've got to tell it where\nthat base drive is.\n\n127\n00:06:55,660 --> 00:06:59,770\nAnd in Microsoft lingo, or at least in the\nHyper-V commands, the PowerShell commands\n\n128\n00:06:59,770 --> 00:07:02,910\nthat work with Hyper-V, they're\ngoing to call that the parent drive.\n\n129\n00:07:02,910 --> 00:07:05,580\nWe're going to do a dash parent path and\n\n130\n00:07:05,580 --> 00:07:09,610\nI'm going to tell it where\nthat parent drive is.\n\n131\n00:07:09,610 --> 00:07:13,190\nAnd just for giggles,\nI'm going to use the one we already have.\n\n132\n00:07:13,190 --> 00:07:16,320\nSo I go Virtuals, VHD.\n\n133\n00:07:17,850 --> 00:07:19,460\nAnd we'll just use that web01 -Disk1.\n\n134\n00:07:19,460 --> 00:07:21,300\nAgain there's nothing\ninstalled on that drive.\n\n135\n00:07:21,300 --> 00:07:24,590\nBut just to show you this command,\nand then the rest of the command.\n\n136\n00:07:24,590 --> 00:07:26,970\nSo that's where the parent\ndrive is going to be.\n\n137\n00:07:26,970 --> 00:07:30,560\nAnd then the actual differencing drive,\nmy path.\n\n138\n00:07:30,560 --> 00:07:31,820\nBack to the original command.\n\n139\n00:07:31,820 --> 00:07:34,130\nJust like when we created a fixed drive,\nor\n\n140\n00:07:34,130 --> 00:07:36,080\nwhen I created a dynamically\nexpanding drive.\n\n141\n00:07:36,080 --> 00:07:38,820\nI have to tell it where I\nwant to create this drive.\n\n142\n00:07:38,820 --> 00:07:41,360\nAnd I'll put it in the same place here.\n\n143\n00:07:41,360 --> 00:07:49,400\nWe'll just go C:\\Virtuals\\VHDs,\nand we'll give it a name.\n\n144\n00:07:49,400 --> 00:07:53,232\nAnd I'll call this one maybe web02\n\n145\n00:07:53,232 --> 00:07:58,920\n-Disk1.vhdx.\n\n146\n00:07:58,920 --> 00:08:02,690\nAnd the last thing I've got add\nis the perimeter differencing.\n\n147\n00:08:04,000 --> 00:08:06,810\nLet it know I'm making\na differencing disk.\n\n148\n00:08:06,810 --> 00:08:07,310\nHit enter.\n\n149\n00:08:08,930 --> 00:08:11,069\nLet that thing whirl and\ngrind for a second.\n\n150\n00:08:12,290 --> 00:08:16,730\nAnd then if I do another directory,\nI can see I now have this.\n\n151\n00:08:16,730 --> 00:08:17,348\nWhere'd she go?\n\n152\n00:08:17,348 --> 00:08:20,310\nweb02 -Disk1, alright.\n\n153\n00:08:20,310 --> 00:08:22,010\nIt's pointed back to that base drive.\n\n154\n00:08:22,010 --> 00:08:24,620\nSo if I was to create a virtual machine,\nand\n\n155\n00:08:24,620 --> 00:08:27,980\nassign a web02 -Disk 1\nto that virtual Machine.\n\n156\n00:08:27,980 --> 00:08:30,730\nAnything I did to that machine\nwould be stored in there.\n\n157\n00:08:30,730 --> 00:08:35,540\nThe operating system itself would\nstill be in that web01 -Disk1.\n\n158\n00:08:35,540 --> 00:08:38,070\nNot a good example here,\nwouldn't work out too well.\n\n159\n00:08:38,070 --> 00:08:42,190\nBut that's the idea behind\nthese difference in drives.\n\n160\n00:08:42,190 --> 00:08:44,240\nNot really gonna see those\nin a production environment.\n\n161\n00:08:44,240 --> 00:08:46,710\nGreat for test environments though.\n\n162\n00:08:46,710 --> 00:08:48,510\nAll right.\n\n163\n00:08:48,510 --> 00:08:50,400\nSo now I've got a bunch of drives.\n\n164\n00:08:50,400 --> 00:08:51,770\nI've got a couple of virtual machines.\n\n165\n00:08:51,770 --> 00:08:54,680\nHow do I attach these drives\nto those virtual machines?\n\n166\n00:08:54,680 --> 00:08:56,480\nThat's the next thing we're\ngonna take a look at.\n\n167\n00:08:56,480 --> 00:09:02,380\nAnd the command for\nthat is just gonna be Add-VMHardDiskDrive.\n\n168\n00:09:02,380 --> 00:09:06,324\nLet's do an Add- VMHardDiskDrive.\n\n169\n00:09:06,324 --> 00:09:10,700\nI've got to tell it the name of the\nvertical that I'm trying to attach this\n\n170\n00:09:10,700 --> 00:09:12,170\nhard drive to.\n\n171\n00:09:12,170 --> 00:09:16,390\nAs we'd use the VM name parameter.\n\n172\n00:09:16,390 --> 00:09:18,603\nAnd we'll say maybe web01.\n\n173\n00:09:18,603 --> 00:09:21,980\nAnd let's attach that second disk.\n\n174\n00:09:21,980 --> 00:09:27,080\nSo, I've got Web 01 for the name of\nthe virtual machine, and then -path.\n\n175\n00:09:27,080 --> 00:09:29,210\nAnd the path to the drive\nthat I'm trying to add.\n\n176\n00:09:29,210 --> 00:09:32,657\nSo Virtuals\\VHD and\n\n177\n00:09:32,657 --> 00:09:38,360\nthen web01 -Disk2.vhdx.\n\n178\n00:09:38,360 --> 00:09:43,230\nAnd then if I want to\nhit that one more time.\n\n179\n00:09:43,230 --> 00:09:49,710\nAnd change that to web01 -Disk3.vhdx.\n\n180\n00:09:49,710 --> 00:09:55,420\nSo, at this point I've added two\nmore drives to that virtual machine.\n\n181\n00:09:55,420 --> 00:09:57,100\nLet's see if we can see.\n\n182\n00:09:57,100 --> 00:10:00,700\nIf we do a get -VM web01.\n\n183\n00:10:00,700 --> 00:10:05,580\nAnd we pipe that out into a select all.\n\n184\n00:10:09,767 --> 00:10:11,870\nIt's gonna show me here.\n\n185\n00:10:11,870 --> 00:10:15,310\nLet's see if I can see the actual\ndrives that are installed.\n\n186\n00:10:16,610 --> 00:10:19,220\nAnd it does not show me the actual drives.\n\n187\n00:10:19,220 --> 00:10:24,830\nI see hard drive on IDE controller 0,\nhard drive on a controller 1, and at 1,1.\n\n188\n00:10:24,830 --> 00:10:27,611\nSo it shows me that there\nare three drives attached.\n\n189\n00:10:27,611 --> 00:10:30,676\nI can see 2 of them are attached\nto IDE controller 0.\n\n190\n00:10:30,676 --> 00:10:33,180\nOne of them attached to IDE controller 1.\n\n191\n00:10:33,180 --> 00:10:37,539\nIt doesn't really show me the names of\nthe locations of those hard drives there.\n\n192\n00:10:39,050 --> 00:10:42,560\nAlright so that is how we're going to\nwork with our virtual hard drives.\n\n193\n00:10:42,560 --> 00:10:46,090\nWe saw how we could create\na dynamically expanding drive.\n\n194\n00:10:46,090 --> 00:10:49,230\nWe saw how we could create\na fixed data drive.\n\n195\n00:10:49,230 --> 00:10:51,665\nWe also saw how we can\ncreate a differencing drive.\n\n196\n00:10:51,665 --> 00:10:55,580\nThen once we had those created,\nwe saw how we could go back and\n\n197\n00:10:55,580 --> 00:10:59,000\nattach a VHD to an existing\nvirtual machine.\n\n198\n00:11:00,770 --> 00:11:02,190\nSo I hope you guys enjoyed this segment.\n\n199\n00:11:02,190 --> 00:11:05,253\nStay tuned more PowerShell\ncoming up in just a few.\n\n200\n00:11:05,253 --> 00:11:07,630\n[MUSIC]\n\n",
          "vimeoId": "117182055"
        },
        {
          "description": "",
          "length": "490",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-4-configuring_virtual_switches-011315.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-4-configuring_virtual_switches-011315-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-4-configuring_virtual_switches-011315-sm.jpg",
          "title": "Configuring Virtual Switches",
          "transcript": "1\n00:00:00,730 --> 00:00:07,963\n[MUSIC]\n\n2\n00:00:07,963 --> 00:00:12,603\nIn this segment we're going to take a look\nat how we can use PowerShell to work\n\n3\n00:00:12,603 --> 00:00:16,070\nwith our virtual switches\non a Hyper-V Server.\n\n4\n00:00:16,070 --> 00:00:17,830\nLet's take a look at what we got here and\n\n5\n00:00:17,830 --> 00:00:21,320\nwhen we talk about our virtual switches in\nHyper-V we've really got three different\n\n6\n00:00:21,320 --> 00:00:24,160\ntypes of virtual switches\nthat we can create.\n\n7\n00:00:24,160 --> 00:00:27,030\nBefore, they recently switched\nover to virtual switches,\n\n8\n00:00:27,030 --> 00:00:29,620\nthey used to be called virtual networks.\n\n9\n00:00:29,620 --> 00:00:32,340\nI think by 2008 they started\ncalling them virtual switches.\n\n10\n00:00:32,340 --> 00:00:34,160\nBut there's really three\ndifferent types I can create.\n\n11\n00:00:34,160 --> 00:00:37,430\nI can create a,\nif I can remember their names.\n\n12\n00:00:37,430 --> 00:00:40,020\nYou can create a private virtual switch.\n\n13\n00:00:40,020 --> 00:00:42,660\nWhich is only gonna be used\nby the virtual machines,\n\n14\n00:00:42,660 --> 00:00:44,850\nthat are running on that Hyper-V host.\n\n15\n00:00:44,850 --> 00:00:47,790\nI can create an internal, virtual switch.\n\n16\n00:00:47,790 --> 00:00:51,780\nWhich will be used again by the virtual\nmachines running on that particular host,\n\n17\n00:00:51,780 --> 00:00:53,760\nas well as the host itself.\n\n18\n00:00:53,760 --> 00:00:56,620\nAnd then you can create an external,\nwhich would give those\n\n19\n00:00:56,620 --> 00:01:01,430\nvirtual machines that are connected to the\nexternal network access to the external\n\n20\n00:01:01,430 --> 00:01:05,260\nmedia into our local area network,\nthe rest of the corporate network,\n\n21\n00:01:05,260 --> 00:01:09,290\npossibly the Internet depending on how\nwe then have our network routed out.\n\n22\n00:01:09,290 --> 00:01:13,510\nSo lets take a look at the commands we can\nuse to configure those virtual switches.\n\n23\n00:01:14,820 --> 00:01:18,570\nI'm gonna pull up PowerShell,\nclear my screen a little bit.\n\n24\n00:01:20,370 --> 00:01:23,570\nAnd the first one I'm gonna do, the first\ncommand I wanna run is just to get a list\n\n25\n00:01:23,570 --> 00:01:25,990\nof what switches I already\nhave if I have any.\n\n26\n00:01:25,990 --> 00:01:31,458\nAnd the command is just\ngonna be Get-VMswitch.\n\n27\n00:01:31,458 --> 00:01:35,110\nAnd I can see I have one switch currently.\n\n28\n00:01:35,110 --> 00:01:39,400\nI've got one and it's an internal type,\nso that means it's going to be accessible\n\n29\n00:01:39,400 --> 00:01:43,370\nto the virtual machines as well\nas the host operating system, and\n\n30\n00:01:43,370 --> 00:01:47,190\nI've given it a name of LAN,\npretty straightforward there.\n\n31\n00:01:47,190 --> 00:01:51,392\nSo if we wanna create\na new virtual switch,\n\n32\n00:01:51,392 --> 00:01:55,372\nthe command is gonna be New-VMswitch.\n\n33\n00:01:55,372 --> 00:02:00,038\nI'm gonna give it a name, if I've got\nspaces in the name I am going to need to\n\n34\n00:02:00,038 --> 00:02:04,277\nlimit that if I can say that,\nI'll have to puts quotes around that.\n\n35\n00:02:04,277 --> 00:02:07,702\nFor this one I'm just going to call it,\nlet's see which one I wanna do first,\n\n36\n00:02:07,702 --> 00:02:08,978\ncan we create this private?\n\n37\n00:02:08,978 --> 00:02:16,760\nI'll call it Private LAN, just so we can\nsee the difference in our list here.\n\n38\n00:02:16,760 --> 00:02:19,280\nSo I'm gonna give it\na name of Private LAN, and\n\n39\n00:02:19,280 --> 00:02:24,240\nthen the switch type is\nreally where I'm deciding\n\n40\n00:02:24,240 --> 00:02:28,210\nwhether it's gonna be private,\ninternal, or external for this one.\n\n41\n00:02:28,210 --> 00:02:29,410\nI'll do private.\n\n42\n00:02:29,410 --> 00:02:34,260\nAnd then I can add notes if I want,\nI usually don't, but\n\n43\n00:02:34,260 --> 00:02:40,710\njust to show you that you can, we can do a\nnotes parameter maybe something like this\n\n44\n00:02:40,710 --> 00:02:45,650\nis an isolated network.\n\n45\n00:02:47,450 --> 00:02:50,750\nCould help other admins that\nare working on this Hyper-V Server.\n\n46\n00:02:52,160 --> 00:02:52,930\nSo go ahead and hit Enter.\n\n47\n00:02:54,080 --> 00:02:58,620\nAnd that will create a new,\nprivate switch-type named Private LAN.\n\n48\n00:02:59,770 --> 00:03:04,840\nSo if I go back and do another\nGet-VMSwitch, I can see I now have two.\n\n49\n00:03:04,840 --> 00:03:06,680\nOne called LAN that's internal.\n\n50\n00:03:06,680 --> 00:03:11,730\nA second one called Private LAN,\nthat is of the private switch type.\n\n51\n00:03:11,730 --> 00:03:15,550\nNow if we want to create\nan external virtual switch.\n\n52\n00:03:15,550 --> 00:03:19,410\nIf I want to give these virtual machines\nthe ability to connect with the rest of my\n\n53\n00:03:19,410 --> 00:03:23,550\nnetwork beyond the host that they\nare running on, so other computers\n\n54\n00:03:23,550 --> 00:03:28,770\non the network, or possibly the Internet,\nif we've got things routed out properly.\n\n55\n00:03:28,770 --> 00:03:32,120\nThe command for that is gonna be the same,\nwe're just gonna switch,\n\n56\n00:03:32,120 --> 00:03:35,630\nfor this one though, a little bit\ndifferent, because I've got to bind\n\n57\n00:03:35,630 --> 00:03:39,990\nthe virtual switch to a physical\nnetwork adapter in that machine, right.\n\n58\n00:03:39,990 --> 00:03:43,940\nSo it can have access to\nthe actual corporate network.\n\n59\n00:03:43,940 --> 00:03:47,440\nSo for that I need to know what physical\n\n60\n00:03:49,200 --> 00:03:54,010\nnetworks adapters I have\nin this Hyper-V host.\n\n61\n00:03:54,010 --> 00:04:00,995\nSo the command for\nthat is going to be Get-NetAdapter.\n\n62\n00:04:00,995 --> 00:04:05,330\nGet-NetAdapter, and I want to see\nwhat the name of these guys are, so\n\n63\n00:04:05,330 --> 00:04:10,300\nI'm going to do a -Name and then *, that\nshould return all of my network adapters\n\n64\n00:04:10,300 --> 00:04:13,530\nthat I have available on this\nHyper-V host, and I'll go ahead and\n\n65\n00:04:13,530 --> 00:04:21,325\npipe that out into a format list command\nand I can see that I have several.\n\n66\n00:04:21,325 --> 00:04:23,480\nI've got my vEthernet (LAN).\n\n67\n00:04:23,480 --> 00:04:28,190\nI've got my physical adapter there,\nEthernet.\n\n68\n00:04:28,190 --> 00:04:31,720\nGot a couple others in this particular\nhost that we're not worried about for\n\n69\n00:04:31,720 --> 00:04:32,260\nthis segment.\n\n70\n00:04:32,260 --> 00:04:35,060\nStudent Side, Test 1 and Test 2.\n\n71\n00:04:35,060 --> 00:04:38,580\nThe one I created earlier, though, or\n\n72\n00:04:38,580 --> 00:04:43,770\nthat private network is not in this list.\n\n73\n00:04:43,770 --> 00:04:45,950\nSo, again those are my\nphysical network adapters.\n\n74\n00:04:45,950 --> 00:04:48,560\nIf I was to go in my network connections\n\n75\n00:04:48,560 --> 00:04:51,870\non this particular host that's\nwhat I would see there.\n\n76\n00:04:51,870 --> 00:04:55,300\nSo now that I know I want to create one,\nI want to attach to that Ethernet.\n\n77\n00:04:55,300 --> 00:04:59,910\nAll right, so this network adapter\nhere is really the one I want\n\n78\n00:04:59,910 --> 00:05:05,250\nto bind this external network adapter to,\nor this external virtual switch to.\n\n79\n00:05:05,250 --> 00:05:07,712\nThe command to create\none starts out the same.\n\n80\n00:05:07,712 --> 00:05:13,260\nNew -VMSwitch and\n\n81\n00:05:13,260 --> 00:05:19,750\nI'm going to give it a name,\nlet's do a -Name.\n\n82\n00:05:19,750 --> 00:05:24,490\nAnd we're gonna call this one External.\n\n83\n00:05:25,790 --> 00:05:27,620\nBecause I'm very creative like that.\n\n84\n00:05:27,620 --> 00:05:31,220\nWe'll call it External and then\nthe adapter that I want to bind it to.\n\n85\n00:05:31,220 --> 00:05:35,360\nThis is where the command differs a little\nbit from creating that private or\n\n86\n00:05:35,360 --> 00:05:37,470\nthat internal virtual switch.\n\n87\n00:05:37,470 --> 00:05:40,120\nCuz I'm binding it to\na physical network adapter.\n\n88\n00:05:41,790 --> 00:05:44,850\nSo NetAdapterName is that parameter.\n\n89\n00:05:44,850 --> 00:05:52,820\nAnd then in my case it's named ethernet,\nand then if we think back to the GUI,\n\n90\n00:05:52,820 --> 00:05:57,710\nwhen you're creating a virtual switch\nlike this I can choose whether or\n\n91\n00:05:57,710 --> 00:06:01,360\nnot I want to allow the management\noperating system to have access to that.\n\n92\n00:06:01,360 --> 00:06:06,950\nSo I can throw in a parameter\ncalled AllowManagementOS and\n\n93\n00:06:06,950 --> 00:06:09,658\nI can set that to $true,\n\n94\n00:06:09,658 --> 00:06:13,940\nwhich will be the same as checking that\ncheck mark when I go through the graphical\n\n95\n00:06:13,940 --> 00:06:18,730\nuser interface now this is going to cause\nwhen you create a new external adapter.\n\n96\n00:06:18,730 --> 00:06:23,320\nWhen you bind something to a physical\nnetwork adapter, in that Hyper-V host,\n\n97\n00:06:23,320 --> 00:06:28,630\nthere is going to be a momentary break in\nconnectivity with that network adapter.\n\n98\n00:06:28,630 --> 00:06:32,170\nSo typically,\nwhen I'm remoted into a Hyper-V host and\n\n99\n00:06:32,170 --> 00:06:35,080\nI make one of these,\nusually remote desktop doesn't crap out,\n\n100\n00:06:35,080 --> 00:06:39,100\nit does not break it long enough for\nme to loose my remote desktop connection.\n\n101\n00:06:39,100 --> 00:06:41,740\nWe'll keep our fingers crossed here and\nsee what happens, so I'll hit Enter.\n\n102\n00:06:44,837 --> 00:06:48,437\nAnd we should see a little bit\nof a glitch there, maybe or\n\n103\n00:06:48,437 --> 00:06:51,900\nI might drop the connection altogether.\n\n104\n00:06:51,900 --> 00:06:52,690\nThere we go.\n\n105\n00:06:52,690 --> 00:06:55,420\nSo you saw that it did temporarily\ndrop my connection and\n\n106\n00:06:55,420 --> 00:06:58,890\nthen of course Remote Desktop attempts\nto reconnect there in the background.\n\n107\n00:06:58,890 --> 00:07:00,470\nIt reconnected just fine.\n\n108\n00:07:00,470 --> 00:07:02,510\nAnd I can see the results of my command.\n\n109\n00:07:02,510 --> 00:07:06,090\nThere's a new network, or\nvirtual switch, named External.\n\n110\n00:07:06,090 --> 00:07:08,610\nIt is of the external switch type, and\n\n111\n00:07:08,610 --> 00:07:13,900\nit is bound to my Gigabit Network adapter\nthat I have in that Hyper-V host.\n\n112\n00:07:13,900 --> 00:07:17,322\nSo if we go back and take a look now\nat that initial command that we run,\n\n113\n00:07:17,322 --> 00:07:24,350\nGet-VMSwitch, we'll see now I have\nthree different virtual switches.\n\n114\n00:07:24,350 --> 00:07:28,510\nI got an Internal virtual switch name LAN,\na private virtual switch named\n\n115\n00:07:28,510 --> 00:07:34,480\nPrivate LAN, and\nan external virtual switch named External.\n\n116\n00:07:34,480 --> 00:07:37,490\nSo in this segment we worked\nwith our virtual switches.\n\n117\n00:07:37,490 --> 00:07:41,660\nWe saw how we could create the different\ntypes of virtual switches that I'm allowed\n\n118\n00:07:41,660 --> 00:07:44,020\nto make within my Hyper-V Server.\n\n119\n00:07:44,020 --> 00:07:47,030\nWe created a private virtual switch,\n\n120\n00:07:47,030 --> 00:07:51,440\nwe created an internal virtual switch,\nas well as an external virtual switch.\n\n121\n00:07:51,440 --> 00:07:55,380\nThat was bound to a physical network\nadapter, in that Hyper-V host and\n\n122\n00:07:55,380 --> 00:07:59,570\nnow I can give my virtual machines access\nto the rest of the corporate network.\n\n123\n00:08:00,660 --> 00:08:05,369\nSo, say tuned,\nmore PowerShell coming your way.\n\n124\n00:08:05,369 --> 00:08:10,309\n[MUSIC]\n\n",
          "vimeoId": "117182057"
        },
        {
          "description": "",
          "length": "398",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-5-configuring_vm_snapshots-011315.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-5-configuring_vm_snapshots-011315-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-5-configuring_vm_snapshots-011315-sm.jpg",
          "title": "Configuring VM Snapshots",
          "transcript": "1\n00:00:00,012 --> 00:00:04,593\n[SOUND] In this segment, we're gonna\n\n2\n00:00:04,593 --> 00:00:09,320\ntake a look at using PowerShell to work\n\n3\n00:00:09,320 --> 00:00:14,207\nwith our snapshots on a Hyper V server.\n\n4\n00:00:14,207 --> 00:00:19,035\nSo our snapshots, or checkpoints,\ndepending on which book you're reading and\n\n5\n00:00:19,035 --> 00:00:20,885\nwhich version you're using.\n\n6\n00:00:20,885 --> 00:00:24,495\nWe started out calling them checkpoints,\nthey're now called snapshots.\n\n7\n00:00:24,495 --> 00:00:28,240\nYou'll actually see in our commands,\nthey still use both terms, but\n\n8\n00:00:28,240 --> 00:00:33,210\nthese snapshots or checkpoints are just\npoints in time that I can roll back to.\n\n9\n00:00:33,210 --> 00:00:37,560\nThey're really handy if I'm getting ready\nto make some major configuration change,\n\n10\n00:00:37,560 --> 00:00:41,160\ninstall some application on\nthe server that I'm testing, and\n\n11\n00:00:41,160 --> 00:00:43,980\nI want to have a roll back point.\n\n12\n00:00:43,980 --> 00:00:48,190\nIf something goes wrong, I want to\nbe able to roll that server back in\n\n13\n00:00:48,190 --> 00:00:50,380\ntime to before I started that operation.\n\n14\n00:00:50,380 --> 00:00:54,300\nNow again, this is another one of those\nthings that really are not recommended in\n\n15\n00:00:54,300 --> 00:00:59,320\na production environment,\nexcept for temporary use.\n\n16\n00:00:59,320 --> 00:01:03,570\nOnce you've created a snapshot or\na checkpoint, you can merge them back in.\n\n17\n00:01:03,570 --> 00:01:06,472\nThey are gonna cause some\nperformance degradation,\n\n18\n00:01:06,472 --> 00:01:09,480\nbecause they're basically\ndifferencing disks.\n\n19\n00:01:09,480 --> 00:01:12,900\nIn a previous segment,\nwe talked about differencing disks and\n\n20\n00:01:12,900 --> 00:01:17,790\nhow you have a base drive and then a drive\nthat stores all the changes that are being\n\n21\n00:01:17,790 --> 00:01:21,080\nmade so when don't effect\nthat underlying base drive.\n\n22\n00:01:21,080 --> 00:01:24,720\nSo when you read from that, when a virtual\nmachine reading from its hard drive,\n\n23\n00:01:24,720 --> 00:01:27,710\nit's really reading from\ntwo different VHDs, right?\n\n24\n00:01:27,710 --> 00:01:32,890\nAnd the more checkpoints I create,\nthose are gonna be the ADHD drives, and\n\n25\n00:01:32,890 --> 00:01:33,850\nit's just gonna cause,\n\n26\n00:01:35,110 --> 00:01:37,620\na degradation performance is\njust the best way to say it.\n\n27\n00:01:37,620 --> 00:01:41,020\nSo you really want to avoid using\nthem in a production environment.\n\n28\n00:01:41,020 --> 00:01:42,330\nIf you do have to create one,\n\n29\n00:01:42,330 --> 00:01:45,750\nthey're really good in test environments,\ncuz I'll take a server and\n\n30\n00:01:45,750 --> 00:01:49,175\nI wanna do something to it,\nI'll make a quick checkpoint, or snapshot.\n\n31\n00:01:49,175 --> 00:01:51,435\nI'll do whatever it is\nI'm trying to test out.\n\n32\n00:01:51,435 --> 00:01:55,095\nWhen I'm done, I just roll it back and\nI'm back to a fresh installer server,\n\n33\n00:01:55,095 --> 00:01:59,015\nif that's I took the checkpoint,\nand I can try something else.\n\n34\n00:01:59,015 --> 00:02:01,795\nIn a production environment,\nbecause of the performance degradation,\n\n35\n00:02:01,795 --> 00:02:05,705\nnot really recommended, but if you\nare getting ready to do some, like a major\n\n36\n00:02:05,705 --> 00:02:09,450\nWindows update that you're not sure,\nyou know, you haven't tested it out.\n\n37\n00:02:09,450 --> 00:02:12,670\nShouldn't be testing it in a production\nenvironment in the first place, but\n\n38\n00:02:12,670 --> 00:02:16,920\nassuming there was some reason you needed\nto do something to a production machine,\n\n39\n00:02:16,920 --> 00:02:18,900\nyou could create a checkpoint and\n\n40\n00:02:18,900 --> 00:02:23,160\nthen have the ability to roll back\nto that checkpoint if you needed to.\n\n41\n00:02:23,160 --> 00:02:26,890\nSo let's take a look at the commands\nthat we can use to perform that.\n\n42\n00:02:26,890 --> 00:02:33,789\nThe first thing we're gonna do is,\nwe're gonna need to create a checkpoint,\n\n43\n00:02:33,789 --> 00:02:38,713\nand the command for\nthat is gonna be checkpoint dash VM.\n\n44\n00:02:38,713 --> 00:02:42,900\nThe name of the virtual machine that I\nam trying to make this checkpoint on,\n\n45\n00:02:42,900 --> 00:02:47,417\nwe'll do web oh one, and then you can see\nright in the middle of the command we're\n\n46\n00:02:47,417 --> 00:02:51,624\ngonna change our naming convention,\nnow we're gonna call it a snapshot.\n\n47\n00:02:51,624 --> 00:02:52,820\nThank you Microsoft.\n\n48\n00:02:52,820 --> 00:02:57,612\nSo snapshot name, and I'm just gonna\n\n49\n00:02:57,612 --> 00:03:02,717\nname it something like prior to update.\n\n50\n00:03:02,717 --> 00:03:04,200\nHit Enter.\n\n51\n00:03:04,200 --> 00:03:08,692\nAnd I don't have a web oh one, really?\n\n52\n00:03:08,692 --> 00:03:10,560\nOh, silly me.\n\n53\n00:03:10,560 --> 00:03:13,070\nThat is not the parameter; that\nis the name of the computer.\n\n54\n00:03:13,070 --> 00:03:15,450\nSo let's swap that up just a little bit.\n\n55\n00:03:15,450 --> 00:03:21,015\nLet's do a dash name, and\n\n56\n00:03:21,015 --> 00:03:27,740\nthen the name of the virtual machine, I\nwanna make that snapshot on is web oh one.\n\n57\n00:03:27,740 --> 00:03:29,110\nSo, there it creates that checkpoint.\n\n58\n00:03:30,580 --> 00:03:32,740\nIf I wanna see what\ncheckpoints are available,\n\n59\n00:03:32,740 --> 00:03:35,970\nI might have made several checkpoints,\nhopefully not, but,\n\n60\n00:03:35,970 --> 00:03:39,796\nwe can do a get VM, and now we're gonna\nchange over and use the word, snapshot.\n\n61\n00:03:39,796 --> 00:03:46,630\nSo, get dash VM snapshot, dash VM name,\nand we'll do web oh one again.\n\n62\n00:03:49,918 --> 00:03:53,300\nAnd, it will list all of the different\nsnapshots that I have available.\n\n63\n00:03:54,680 --> 00:03:59,330\nSo, I've made one snapshot for\nthis guy prior to update, and the date and\n\n64\n00:03:59,330 --> 00:04:01,330\ntime that that snapshot was created.\n\n65\n00:04:02,380 --> 00:04:04,700\nLet's make another one just for\ngiggles real quick.\n\n66\n00:04:04,700 --> 00:04:10,650\nWe'll call this one, I don't know,\nhow about something like after update.\n\n67\n00:04:10,650 --> 00:04:13,513\nWouldn't make a whole lot of sense,\nbut just for example for our lab here,\n\n68\n00:04:13,513 --> 00:04:14,797\nI'll create a second snapshot.\n\n69\n00:04:14,797 --> 00:04:19,707\nAnd now we'll have something\na little more exciting to\n\n70\n00:04:19,707 --> 00:04:24,840\nlook at when I do that get snapshot,\nour get VM snapshot.\n\n71\n00:04:24,840 --> 00:04:28,710\nNow you can see I have two\nseparate snapshots created,\n\n72\n00:04:28,710 --> 00:04:31,620\none prior to update, one after update.\n\n73\n00:04:34,620 --> 00:04:37,820\nSo that's how I can create\na snapshot in the first place,\n\n74\n00:04:37,820 --> 00:04:40,670\nand get a list of available snapshots.\n\n75\n00:04:40,670 --> 00:04:44,030\nThe last thing I want to show you for\nthe snapshots is how do I use them?\n\n76\n00:04:44,030 --> 00:04:46,840\nWhat if that update did cause a problem,\nand\n\n77\n00:04:46,840 --> 00:04:51,650\nI want to roll back to that point in\ntime before I applied that update?\n\n78\n00:04:51,650 --> 00:04:58,660\nWell, the command is simply\nrestore dash VM snapshot,\n\n79\n00:04:58,660 --> 00:05:03,500\nand then the name of the snapshot\nthat I want to really, and\n\n80\n00:05:03,500 --> 00:05:07,090\nthese parameters can go in either order,\nI prefer to name this VM first.\n\n81\n00:05:07,090 --> 00:05:11,000\nSo let's do VM name, and\nthat's gonna be web oh one.\n\n82\n00:05:12,670 --> 00:05:19,078\nAnd then the name of the snapshot,\nand that's gonna be prior to update.\n\n83\n00:05:26,636 --> 00:05:28,930\nAnd it will ask me if I wanna do this.\n\n84\n00:05:28,930 --> 00:05:35,050\nI'll say yes, Y for yes, and\nit's gonna apply the checkpoint.\n\n85\n00:05:35,050 --> 00:05:38,800\nNotice that I needed the name of that\nsnapshot in order to apply it, which is\n\n86\n00:05:38,800 --> 00:05:44,410\nwhy that get dash VM snapshot command is\nvery handy, cuz it lists those snapshots.\n\n87\n00:05:44,410 --> 00:05:48,411\nYou can also see this\nParent Snapshot Name in that command,\n\n88\n00:05:48,411 --> 00:05:52,652\nthe after update is like a chain,\nor a hierarchy, if you will,\n\n89\n00:05:52,652 --> 00:05:57,853\nI've got that base drive, and then I've\ngot that prior to update snapshot,\n\n90\n00:05:57,853 --> 00:06:01,076\nand then I've got that\nafter update snapshot.\n\n91\n00:06:01,076 --> 00:06:05,570\nSo all three of those are really\nrequired to run that virtual machine.\n\n92\n00:06:05,570 --> 00:06:11,600\nNow I've rolled back to that\nprior to update snapshot.\n\n93\n00:06:11,600 --> 00:06:15,552\nAll right, so there we saw how we can\nwork with snapshots through PowerShell.\n\n94\n00:06:15,552 --> 00:06:20,898\nAll right, we were able to create\na snapshot, get a list of the available\n\n95\n00:06:20,898 --> 00:06:25,510\nsnapshots, and roll back to\na previously created snapshot.\n\n96\n00:06:25,510 --> 00:06:28,150\nSo I hope you guys enjoyed this segment.\n\n97\n00:06:28,150 --> 00:06:29,070\nStay tuned.\n\n98\n00:06:29,070 --> 00:06:33,050\nMore PowerShell coming your way.\n\n99\n00:06:33,050 --> 00:06:37,569\n[SOUND]\n\n",
          "vimeoId": "117191711"
        },
        {
          "description": "",
          "length": "945",
          "thumbnail": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-6-import_export_vms_retape-11415.png",
          "thumbnailMed": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-6-import_export_vms_retape-11415-med.jpg",
          "thumbnailSm": "https://itprotv-image-bucket.s3.amazonaws.com/powershell/powershell-6-6-import_export_vms_retape-11415-sm.jpg",
          "title": "Import Export VMs",
          "transcript": "1\n00:00:00,000 --> 00:00:05,022\n[SOUND] All right,\nin this segment we're gonna\n\n2\n00:00:05,022 --> 00:00:09,786\ntake a look at using\nPowerShell to import and\n\n3\n00:00:09,786 --> 00:00:15,214\nexport virtual machines\nfrom a Hyper-V server.\n\n4\n00:00:15,214 --> 00:00:19,327\nDuring the management of our Hyper-V\nservers we're gonna occasionally need to\n\n5\n00:00:19,327 --> 00:00:21,420\nexport those virtual machines.\n\n6\n00:00:21,420 --> 00:00:26,170\nCould be to create a backup of a virtual\nmachine or it could be to move a virtual\n\n7\n00:00:26,170 --> 00:00:29,740\nmachine from one Hyper-V server that\nmaybe we're decommissioning and\n\n8\n00:00:29,740 --> 00:00:32,140\nmove it from that server to a new server.\n\n9\n00:00:32,140 --> 00:00:35,242\nSo we need to be able to export these\nvirtual machines and then turn around and\n\n10\n00:00:35,242 --> 00:00:36,420\nimport them.\n\n11\n00:00:36,420 --> 00:00:40,970\nIf we had a problem with one we can\nimport that machine that we had exported.\n\n12\n00:00:40,970 --> 00:00:43,710\nOr, if we are, again,\nbringing up a new Hyper-V host,\n\n13\n00:00:43,710 --> 00:00:46,860\nwe could import those new virtual\nmachines onto that new Hyper-V host.\n\n14\n00:00:46,860 --> 00:00:49,550\nSo let's dive into PowerShell and\nsee how we can accomplish this.\n\n15\n00:00:50,660 --> 00:00:54,160\nFirst thing we'll need to do, is we need\nto export an existing virtual machine.\n\n16\n00:00:54,160 --> 00:00:56,657\nAnd the command is simply export-vm.\n\n17\n00:00:56,657 --> 00:00:57,350\nAll right?\n\n18\n00:00:57,350 --> 00:01:02,057\nNow we could do it where I\ndon't use any parameters.\n\n19\n00:01:02,057 --> 00:01:02,680\nRight?\n\n20\n00:01:02,680 --> 00:01:07,090\nMost of our PowerShell commands, we've\ngot a lot of parameters that we can use,\n\n21\n00:01:07,090 --> 00:01:09,700\nmost of them are optional,\nsome of them required.\n\n22\n00:01:09,700 --> 00:01:13,690\nThis particular command, the only thing\nI have to give it is a destination.\n\n23\n00:01:13,690 --> 00:01:16,510\nIf I don't specify a name of\nan individual virtual machine,\n\n24\n00:01:16,510 --> 00:01:19,830\nwhat it's gonna do is it's gonna\nexport all of the virtual machines.\n\n25\n00:01:19,830 --> 00:01:25,680\nSo in this case export-vm and\nthen D:\\ would end up dumping out all\n\n26\n00:01:25,680 --> 00:01:29,670\nthe virtual machines that existed on this\nHyper-V host to the root of the D drive.\n\n27\n00:01:29,670 --> 00:01:31,840\nAnd I would create a subfolder for\n\n28\n00:01:31,840 --> 00:01:34,940\neach one of those virtual\nmachines that it was exporting.\n\n29\n00:01:34,940 --> 00:01:37,810\nIn this case I just want to export\na particular virtual machine.\n\n30\n00:01:37,810 --> 00:01:42,100\nSo I am going to specify the name of\nthe machine that I'm trying to export.\n\n31\n00:01:42,100 --> 00:01:43,090\nThat's gonna be web01.\n\n32\n00:01:43,090 --> 00:01:47,470\nAnd then the path is\na little -path parameter.\n\n33\n00:01:47,470 --> 00:01:51,033\nAnd where I want to export\nthis virtual machine to.\n\n34\n00:01:51,033 --> 00:01:55,973\nSo export-vm, -name, web01, -path, and\n\n35\n00:01:55,973 --> 00:02:01,030\nthen the path or c:\\Exported, in my case.\n\n36\n00:02:01,030 --> 00:02:02,920\nI'm gonna hit Enter, and\n\n37\n00:02:02,920 --> 00:02:05,980\nit should begin the process of\nexporting that virtual machine.\n\n38\n00:02:05,980 --> 00:02:08,320\nNow while it's going through here,\none of the things I could have done,\n\n39\n00:02:08,320 --> 00:02:10,360\nthis process could take a little while.\n\n40\n00:02:10,360 --> 00:02:14,070\nThis particular machine,\nwe just built it in a previous segment, so\n\n41\n00:02:14,070 --> 00:02:16,500\nthere's really no data on the hard drives.\n\n42\n00:02:16,500 --> 00:02:17,890\nShouldn't take it very long.\n\n43\n00:02:17,890 --> 00:02:20,580\nBut in the real world,\nif you had a lot of drives attached, or\n\n44\n00:02:20,580 --> 00:02:24,340\nif those drives were larger,\nthis process could take a little while, so\n\n45\n00:02:24,340 --> 00:02:28,075\nthere is a parameter we can use -asjob.\n\n46\n00:02:28,075 --> 00:02:33,230\nIf I add a -asjob to this,\nit would run as a background process, and\n\n47\n00:02:33,230 --> 00:02:37,850\nI would be able to continue to work\nwhile this job was in progress.\n\n48\n00:02:37,850 --> 00:02:38,850\nSo we'll let this run for a minute.\n\n49\n00:02:38,850 --> 00:02:42,980\nWe'll let this machine get exported, and\nthen once it that has finished exporting,\n\n50\n00:02:42,980 --> 00:02:45,442\nwe'll go take a look at\nthe folder that it created.\n\n51\n00:02:45,442 --> 00:02:48,510\nIt's gonna export everything needed\nto run that virtual machine.\n\n52\n00:02:48,510 --> 00:02:52,350\nThat means the virtual machine\nconfiguration files themselves, the VHDs,\n\n53\n00:02:52,350 --> 00:02:56,740\nthe hard drives associated with it,\nif there's more then one hard drive,\n\n54\n00:02:56,740 --> 00:02:58,990\nit'll include all of those hard drives.\n\n55\n00:02:58,990 --> 00:03:02,620\nIt would also include any\ncheckpoints that we created.\n\n56\n00:03:02,620 --> 00:03:04,350\nThose would be exported along as well.\n\n57\n00:03:06,270 --> 00:03:10,360\nSo it exports everything I need\nto use that virtual machine.\n\n58\n00:03:10,360 --> 00:03:13,870\nNow one of the things that's new with\n2012 with this import and export process,\n\n59\n00:03:14,960 --> 00:03:19,640\nprior to 2012,\nif you could not import a virtual machine,\n\n60\n00:03:19,640 --> 00:03:24,580\nif it had not been exported through\nHyper-V in the first place,\n\n61\n00:03:24,580 --> 00:03:28,610\nnow it allows you to take any machine\nwhether it's been exported first, or\n\n62\n00:03:28,610 --> 00:03:30,795\nnot and import that virtual machine.\n\n63\n00:03:30,795 --> 00:03:32,015\nAnd there we go.\n\n64\n00:03:32,015 --> 00:03:33,730\nIt looks like my job is finished.\n\n65\n00:03:33,730 --> 00:03:40,050\nSo if I take a look in file explorer,\nI can see now in my C:\\Exported directory,\n\n66\n00:03:40,050 --> 00:03:44,270\nI have a folder called web01, and\nin there I've got my virtual machines.\n\n67\n00:03:44,270 --> 00:03:47,860\nThere's the actual virtual\nmachine configuration file.\n\n68\n00:03:47,860 --> 00:03:50,290\nI've got my virtual hard drives\nthat are associated with that.\n\n69\n00:03:50,290 --> 00:03:53,710\nNotice I've got three different\ndrives attached to that VM.\n\n70\n00:03:53,710 --> 00:03:58,010\nIt exported all three of those drives as\nwell as a couple of differencing disks\n\n71\n00:03:58,010 --> 00:03:58,680\nthat had been made.\n\n72\n00:03:58,680 --> 00:04:01,920\nSo a couple of snapshots that\nI made on a previous segment,\n\n73\n00:04:01,920 --> 00:04:03,870\nit exported those as well.\n\n74\n00:04:03,870 --> 00:04:07,370\nAnd then, the actual snapshot files.\n\n75\n00:04:07,370 --> 00:04:11,680\nWe had the configuration files for those\nsnapshots, the time stamp information,\n\n76\n00:04:11,680 --> 00:04:13,300\ninformation about the snapshot itself.\n\n77\n00:04:13,300 --> 00:04:16,340\nSo you've got the config file for\nthe snapshot and\n\n78\n00:04:16,340 --> 00:04:19,690\nthen you have the actual differencing\ndisks over here, the AVHDX files.\n\n79\n00:04:19,690 --> 00:04:20,230\nRight?\n\n80\n00:04:20,230 --> 00:04:27,020\nSo that's exporting a virtual machine\nusing PowerShell, pretty straightforward.\n\n81\n00:04:27,020 --> 00:04:29,590\nOnce I've got those exported,\nat some point,\n\n82\n00:04:29,590 --> 00:04:33,800\nI'm gonna wanna be able to import those\nvirtual machines back into Hyper-V,\n\n83\n00:04:33,800 --> 00:04:38,630\nwhether that's the same Hyper-V server or\na different HyperV server.\n\n84\n00:04:38,630 --> 00:04:43,270\nSo the command is simply\ngoing to be import-vm.\n\n85\n00:04:43,270 --> 00:04:48,290\nAs always, there are several\nparameters that we can use,\n\n86\n00:04:48,290 --> 00:04:54,330\nespecially with this import command, and\nI'll talk about a couple of them here.\n\n87\n00:04:54,330 --> 00:04:57,201\nPrimarily the one command that\nI really need is the -path.\n\n88\n00:04:57,201 --> 00:04:58,830\nRight?\nI have to tell it\n\n89\n00:04:58,830 --> 00:05:01,770\nwhere the virtual machine is\nthat I'm trying to import.\n\n90\n00:05:01,770 --> 00:05:05,360\nThere are some other parameters\nthat I could throw in there.\n\n91\n00:05:05,360 --> 00:05:06,710\nYou can throw in a computer name,\n\n92\n00:05:06,710 --> 00:05:12,073\nmaybe you're importing this\ninto a different Hyper-V host.\n\n93\n00:05:12,073 --> 00:05:14,435\nThe exported files are on this server, but\n\n94\n00:05:14,435 --> 00:05:17,320\nI wanna import them into\na different server on my network.\n\n95\n00:05:17,320 --> 00:05:20,400\nI can actually do a dash computer\nname to have that happen.\n\n96\n00:05:20,400 --> 00:05:23,920\nYou can choose whether or\nnot you want to move the files.\n\n97\n00:05:23,920 --> 00:05:27,090\nRight now, once I exported it,\nthe files, the hard drives,\n\n98\n00:05:27,090 --> 00:05:31,670\nthe configuration files, all those\nare located in that C:\\Exported folder.\n\n99\n00:05:31,670 --> 00:05:35,960\nI can allow it to register\nthat virtual machine in place.\n\n100\n00:05:35,960 --> 00:05:38,691\nIn other words,\nnot move the files themselves.\n\n101\n00:05:38,691 --> 00:05:41,144\nTypically, that's not what I want to do.\n\n102\n00:05:41,144 --> 00:05:42,690\nRight?\nBecause I exported it to that exported\n\n103\n00:05:42,690 --> 00:05:46,590\nfolder, I want to get it out of there and\nput it back in the default location.\n\n104\n00:05:46,590 --> 00:05:51,560\nIf I don't provide any information,\nthe default is to move those files, or\n\n105\n00:05:51,560 --> 00:05:56,520\ncopy I should say, those files back to\nthe default location for your Hyper-V.\n\n106\n00:05:56,520 --> 00:05:59,740\nSo if you took a look at your Hyper-V\nsettings, you can specify the default\n\n107\n00:05:59,740 --> 00:06:03,902\nlocation for the virtual machine\nconfig files as well as the VHDs, and\n\n108\n00:06:03,902 --> 00:06:08,630\nit's gonna use that information when\nit imports that virtual machine.\n\n109\n00:06:08,630 --> 00:06:11,340\nOr I could specify a different location.\n\n110\n00:06:11,340 --> 00:06:14,062\nI can actually tell it, hey, I wanna\nimport it, but I wanna store it here.\n\n111\n00:06:14,062 --> 00:06:15,260\nAll right?\n\n112\n00:06:15,260 --> 00:06:19,560\nSo I can leave it where it is, I can\ncopy it back to the default location, or\n\n113\n00:06:19,560 --> 00:06:23,000\nI can choose a different\nlocation when I import it.\n\n114\n00:06:23,000 --> 00:06:27,980\nI also have to worry about the ID that's\nassociated with that virtual machine.\n\n115\n00:06:27,980 --> 00:06:31,600\nBy default if I don't specify it's\ngoing to leave the machine ID.\n\n116\n00:06:31,600 --> 00:06:35,590\nSo it's going to be the same machine\nthat it was when I exported it.\n\n117\n00:06:35,590 --> 00:06:40,195\nI can actually generate a new\nID during the import process so\n\n118\n00:06:40,195 --> 00:06:42,900\nHyper-V will see it as\na different virtual machine.\n\n119\n00:06:42,900 --> 00:06:45,032\nIn other words I could import\nit more than once, and\n\n120\n00:06:45,032 --> 00:06:48,030\nI could give it a different ID each time.\n\n121\n00:06:48,030 --> 00:06:50,100\nNow, that doesn't handle\nthe Windows side of things.\n\n122\n00:06:50,100 --> 00:06:53,650\nWindows is not gonna be happy that you've\ngot two machines with the same name and\n\n123\n00:06:53,650 --> 00:06:54,930\nthe same configuration and all that.\n\n124\n00:06:54,930 --> 00:06:58,040\nYou still have to deal with that,\nbut as far as Hyper-V's concerned,\n\n125\n00:06:58,040 --> 00:07:00,777\nI could import that a second\ntime with a different ID.\n\n126\n00:07:00,777 --> 00:07:02,240\nAll right?\n\n127\n00:07:02,240 --> 00:07:03,530\nSo let's see how that process works.\n\n128\n00:07:03,530 --> 00:07:09,570\nSo I'm gonna do an import-vm, and\nthen I've got my path parameter.\n\n129\n00:07:09,570 --> 00:07:15,560\nI've gotta tell it where that machine is\nlocated, so I'm gonna do a C:\\ Exported.\n\n130\n00:07:15,560 --> 00:07:18,070\nAnd then in there,\nI've got a couple of machines.\n\n131\n00:07:18,070 --> 00:07:20,790\nI'm gonna try to bring\nin this ITProTV-DC2.\n\n132\n00:07:20,790 --> 00:07:24,250\nThis is one that I exported previously.\n\n133\n00:07:24,250 --> 00:07:27,230\nSo I found the folder for\nthat in the exported.\n\n134\n00:07:27,230 --> 00:07:28,650\nInside there, there's a code.\n\n135\n00:07:28,650 --> 00:07:31,085\nYou've got to tell it\nwhere the config file is.\n\n136\n00:07:31,085 --> 00:07:31,930\nRight?\n\n137\n00:07:31,930 --> 00:07:32,940\nWe saw just a minute ago,\n\n138\n00:07:32,940 --> 00:07:35,920\nwhen I exported that virtual machine\nit created several subfolders,\n\n139\n00:07:35,920 --> 00:07:40,920\none of the VM config files, one for\nthe VHD files, one for the snapshots.\n\n140\n00:07:40,920 --> 00:07:44,080\nWhen you import this, you actually\nhave to point it to the XML file,\n\n141\n00:07:44,080 --> 00:07:46,530\nor the VM config file.\n\n142\n00:07:46,530 --> 00:07:50,710\nSo that is gonna be inside that\nvirtual machines folder, and\n\n143\n00:07:50,710 --> 00:07:51,990\nthere's the name of that file.\n\n144\n00:07:51,990 --> 00:07:55,510\nIt's a big long GUID that's\nassigned to that virtual machine.\n\n145\n00:07:55,510 --> 00:08:02,620\nSo I've done my import virtual machine or\nImport-VM-Path, and I'm gonna say -copy.\n\n146\n00:08:02,620 --> 00:08:07,360\nSo that's gonna leave the exported machine\nwhere it is, but it's gonna copy these\n\n147\n00:08:07,360 --> 00:08:11,962\nfiles back into the default location for\nmy particular Hyper-V server.\n\n148\n00:08:11,962 --> 00:08:13,310\nAll right?\n\n149\n00:08:13,310 --> 00:08:14,510\nSo I should be able to hit Enter.\n\n150\n00:08:16,170 --> 00:08:18,160\nAnd, we will see what happens.\n\n151\n00:08:19,480 --> 00:08:23,580\nSo right now, it's examining the files,\nmaking sure that all the files necessary\n\n152\n00:08:23,580 --> 00:08:28,270\nto bring that virtual machine\nare in place, or that are readable.\n\n153\n00:08:28,270 --> 00:08:31,540\nMaking sure that here's one\nthat can really throw you for\n\n154\n00:08:31,540 --> 00:08:33,850\na loop, the network adaptors.\n\n155\n00:08:33,850 --> 00:08:35,180\nA couple of things you can do.\n\n156\n00:08:35,180 --> 00:08:37,850\nIf I try to import a virtual machine and\n\n157\n00:08:37,850 --> 00:08:42,525\nthe network adaptor that it was attached\nto when I exported it is not available.\n\n158\n00:08:42,525 --> 00:08:47,835\nLet's say I'm moving this from\nVM host 01 to VM host 02, and\n\n159\n00:08:47,835 --> 00:08:55,550\non VM host 01 I had a virtual switch\nnamed private LAN or something like that.\n\n160\n00:08:55,550 --> 00:08:59,060\nWell if I go to import that\nmachine on VM host O2 and\n\n161\n00:08:59,060 --> 00:09:03,310\nthere is no virtual switch called\nprivate LAN, it's gonna throw an error.\n\n162\n00:09:03,310 --> 00:09:06,650\nIt's not gonna let me continue cuz it's\nnot gonna be able to import the machine\n\n163\n00:09:06,650 --> 00:09:07,950\nand configure it properly.\n\n164\n00:09:09,280 --> 00:09:13,380\nSomething that is very easy to run\ninto especially if you had to rebuild\n\n165\n00:09:13,380 --> 00:09:16,550\nthe server and maybe you didn't recreate\nall the virtual switches first.\n\n166\n00:09:16,550 --> 00:09:19,970\nSo a couple of things you can do,\nfirst is recreate the switches.\n\n167\n00:09:19,970 --> 00:09:22,060\nRight?\nIf you've documented what virtual switches\n\n168\n00:09:22,060 --> 00:09:24,650\nyou had before you did\nthe export process and\n\n169\n00:09:24,650 --> 00:09:27,660\nyou know which ones it was attached to,\nthen recreate them.\n\n170\n00:09:27,660 --> 00:09:28,616\nGive them the same name.\n\n171\n00:09:28,616 --> 00:09:33,750\nThey don't even really have to be the same\ntype, internal, external or private.\n\n172\n00:09:33,750 --> 00:09:34,670\nIt's not looking at that.\n\n173\n00:09:34,670 --> 00:09:35,890\nIt's actually looking at the name, and\n\n174\n00:09:35,890 --> 00:09:39,210\nas long as it sees that name,\nit's gonna be fine.\n\n175\n00:09:39,210 --> 00:09:43,532\nSo recreate your virtual switches\nbefore you do your import process, or,\n\n176\n00:09:43,532 --> 00:09:47,585\ndisconnect the machine from\nthe networks before you export.\n\n177\n00:09:47,585 --> 00:09:49,760\nRight?\nGo into the settings or\n\n178\n00:09:49,760 --> 00:09:54,120\nuse PowerShell to detach that\nnetwork adapter, and then export it.\n\n179\n00:09:54,120 --> 00:09:56,020\nAnd then when you import it,\nit's not looking for\n\n180\n00:09:56,020 --> 00:09:59,370\nany particular network adapter, and\nyou can simply open up PowerShell and\n\n181\n00:09:59,370 --> 00:10:03,960\nattach it to one of your existing\nvirtual switches on that new VM host.\n\n182\n00:10:03,960 --> 00:10:05,050\nSo either way you wanna do it.\n\n183\n00:10:05,050 --> 00:10:09,410\nEither recreate the switches before you\nstart the import process on that new VM\n\n184\n00:10:09,410 --> 00:10:15,020\nhost, or detach the virtual machine from\nthe networks before you export it so\n\n185\n00:10:15,020 --> 00:10:18,760\nit's not looking for those networks\nwhen you go through that import process.\n\n186\n00:10:18,760 --> 00:10:19,570\nAll right?\n\n187\n00:10:19,570 --> 00:10:22,538\nSo this guy's running along, and\nagain, I didn't do it as a job.\n\n188\n00:10:22,538 --> 00:10:26,460\nSo I kinda have to wait for it to finish\nbefore I can really do anything else.\n\n189\n00:10:26,460 --> 00:10:30,010\nThere really isn't anything else to see\nother than it's gonna successfully import\n\n190\n00:10:30,010 --> 00:10:31,330\nthis VM.\n\n191\n00:10:31,330 --> 00:10:34,280\nThere are a couple parameter\ncommands that I do want to mention.\n\n192\n00:10:34,280 --> 00:10:36,940\nI want to, I'd like to show\nyou if this thing will finish,\n\n193\n00:10:36,940 --> 00:10:41,740\nbut the command is\nactually compare dash VM.\n\n194\n00:10:41,740 --> 00:10:44,620\nIf you ever have a problem\nimporting the virtual machine,\n\n195\n00:10:44,620 --> 00:10:47,430\nyou'll get a bunch of red\ntext on your screen here.\n\n196\n00:10:47,430 --> 00:10:50,821\nAnd it's not real specific\nas to what the problem was.\n\n197\n00:10:50,821 --> 00:10:55,820\nIt'll tell you that it failed\non the import process, but\n\n198\n00:10:55,820 --> 00:10:59,582\nit really doesn't tell you why it failed.\n\n199\n00:10:59,582 --> 00:11:03,352\nSo what you can do is you can turn\naround and run a compare dash VM.\n\n200\n00:11:03,352 --> 00:11:05,641\nAnd typically what I'll do,\nis I'll run it inside a variable.\n\n201\n00:11:05,641 --> 00:11:10,232\nIn other words, I'll assign the results\nof that command to a variable.\n\n202\n00:11:10,232 --> 00:11:14,671\nSo you can do something like dollar\nsign report equals compare dash VM, and\n\n203\n00:11:14,671 --> 00:11:19,110\nthen the path just like I did on that\nimport process to that XML file to import\n\n204\n00:11:19,110 --> 00:11:20,530\nthat virtual machine.\n\n205\n00:11:20,530 --> 00:11:24,350\nAnd it'll run through the process,\nbut it won't actually import it.\n\n206\n00:11:24,350 --> 00:11:28,250\nAnd you can then take that\ndollar sign reports variable and\n\n207\n00:11:28,250 --> 00:11:31,930\npull up some information, and\nyou can see what the actual error is.\n\n208\n00:11:31,930 --> 00:11:37,840\nFor example, if the network adapter, it\ncouldn't find a network named private LAN,\n\n209\n00:11:37,840 --> 00:11:41,080\nyou'll see that information in\nthe results of that command.\n\n210\n00:11:41,080 --> 00:11:42,051\nSo very handy and\n\n211\n00:11:42,051 --> 00:11:46,010\none to know because, like I said, normally\nwhen you import a virtual machine and\n\n212\n00:11:46,010 --> 00:11:48,880\nyou get that error, it really just does\nnot give you a lot of information.\n\n213\n00:11:48,880 --> 00:11:50,390\nThe information is there,\n\n214\n00:11:50,390 --> 00:11:52,910\nwe just have to use a different\ncommand to go get that information.\n\n215\n00:11:56,190 --> 00:11:56,900\nAll right?\nAll right, well,\n\n216\n00:11:56,900 --> 00:11:58,490\nthis is taking a little long.\n\n217\n00:11:58,490 --> 00:11:59,270\nIt's almost done.\n\n218\n00:11:59,270 --> 00:11:59,995\nWhat are we on.\n\n219\n00:11:59,995 --> 00:12:01,410\nWe're on.\n\n220\n00:12:01,410 --> 00:12:01,970\nI'm watching it.\n\n221\n00:12:01,970 --> 00:12:02,940\nYou can watch it go through here.\n\n222\n00:12:02,940 --> 00:12:04,720\nIt's doing one of the differencing drives,\nso\n\n223\n00:12:04,720 --> 00:12:07,710\nwhy don't we do a little\nTV timeout if we can.\n\n224\n00:12:07,710 --> 00:12:10,580\nAnd then when this finishes up,\nI'll come back.\n\n225\n00:12:10,580 --> 00:12:12,210\nI'll show you the results, and\n\n226\n00:12:12,210 --> 00:12:15,130\nthen I'll run through that\ncompare dash VM command as well.\n\n227\n00:12:15,130 --> 00:12:18,515\nSo, stay tuned, be right back.\n\n228\n00:12:18,515 --> 00:12:25,210\n[SOUND]\nAll right.\n\n229\n00:12:25,210 --> 00:12:27,370\nSo we gave that command\na little time to finish up.\n\n230\n00:12:27,370 --> 00:12:29,760\nNow we can take a look at the results.\n\n231\n00:12:29,760 --> 00:12:33,290\nBack here over on PowerShell we can\nsee that my command is finished, and\n\n232\n00:12:33,290 --> 00:12:34,810\nit tells me that it succeeded.\n\n233\n00:12:34,810 --> 00:12:39,370\nThe machine ITProTV-DC2 has\nbeen successfully imported.\n\n234\n00:12:39,370 --> 00:12:44,350\nCurrent state is off, so it's not running,\nbut its status is operating normally.\n\n235\n00:12:44,350 --> 00:12:47,490\nIf I do a little get dash vm command,\n\n236\n00:12:48,530 --> 00:12:53,200\nI can see there is my\nITProTV-DC2 listed in there, and\n\n237\n00:12:53,200 --> 00:12:56,960\nif I want to take a peek at the GUID\neven though this is a PowerShell show.\n\n238\n00:12:56,960 --> 00:12:57,481\nRight?\n\n239\n00:12:57,481 --> 00:13:01,040\nThere's ITProTV-DC2, and\nwe could start that machine up.\n\n240\n00:13:02,130 --> 00:13:03,260\nSo, there it is.\n\n241\n00:13:03,260 --> 00:13:06,520\nImporting a virtual machine\nthrough PowerShell.\n\n242\n00:13:06,520 --> 00:13:09,770\nNow the other command I wanted to run\nthrough before we wrap this thing up\n\n243\n00:13:09,770 --> 00:13:11,351\nis just the compare dash VM.\n\n244\n00:13:11,351 --> 00:13:15,240\nNot gonna be able to see a lot of results\nwith this one because I don't have any\n\n245\n00:13:15,240 --> 00:13:17,720\nmachines that are giving me errors, but\n\n246\n00:13:17,720 --> 00:13:21,660\nI wanna show you guys the command just\nin case you run into the problem.\n\n247\n00:13:21,660 --> 00:13:25,940\nSo the command, if I had gone to import\na virtual machine and I got a bunch of red\n\n248\n00:13:25,940 --> 00:13:30,080\ntext in my PowerShell, a bunch of errors,\nagain, they're not real specific, so\n\n249\n00:13:30,080 --> 00:13:36,994\nthe next thing I would do\nwould be a compare dash VM.\n\n250\n00:13:36,994 --> 00:13:39,020\nThe way I like to run this or\n\n251\n00:13:39,020 --> 00:13:44,050\nthe easiest way I find to run this is to\nstore the results of that in a variable.\n\n252\n00:13:44,050 --> 00:13:50,040\nSo we'll do a little report, $report =,\nand then I'm gonna do my Compare-VM.\n\n253\n00:13:50,040 --> 00:13:55,930\nAnd then the process of importing,\nthe -Path as C:\\Exported.\n\n254\n00:13:55,930 --> 00:13:59,850\nI've got a machine in there named web01,\n\n255\n00:14:02,050 --> 00:14:06,540\nand I'll go find his config files here\nfrom his virtual machine's directory.\n\n256\n00:14:09,080 --> 00:14:12,147\nAll right.\nAnd then normally I'd be doing a -copy to\n\n257\n00:14:12,147 --> 00:14:16,561\nbring that virtual machine in and\ncopy it over to the default location.\n\n258\n00:14:16,561 --> 00:14:20,840\nSo really I'm just, I'm doing the import\nVM command or parameters, but\n\n259\n00:14:20,840 --> 00:14:25,341\nI'm changing the verb over here to compare\ndash VM instead of import dash VM.\n\n260\n00:14:25,341 --> 00:14:29,955\nAnd then I'm storing the results of\nthis command nn a variable call report.\n\n261\n00:14:29,955 --> 00:14:30,970\nSo I run that,\n\n262\n00:14:30,970 --> 00:14:35,770\nand it takes a look at what would happen\nif I was to import that virtual machine.\n\n263\n00:14:36,970 --> 00:14:43,990\nAnd then what I can do is take\nthat $report.Incompatibilities.\n\n264\n00:14:43,990 --> 00:14:44,530\nAll right?\n\n265\n00:14:44,530 --> 00:14:47,970\nAnd we can pipe that out\ninto a little format table,\n\n266\n00:14:47,970 --> 00:14:53,180\ndo a little autosize on it or something\nlike that, and I would get my results.\n\n267\n00:14:53,180 --> 00:14:55,040\nNow in this case, there aren't any errors.\n\n268\n00:14:55,040 --> 00:14:56,698\nSo there's nothing really exciting to see.\n\n269\n00:14:56,698 --> 00:15:00,070\nThere's no information in that report, but\n\n270\n00:15:00,070 --> 00:15:03,890\nI wanted to show you that command cuz\nit can be a very handy one to have,\n\n271\n00:15:03,890 --> 00:15:07,250\nto be able to use if you're having\ntrouble importing a virtual machine.\n\n272\n00:15:08,940 --> 00:15:09,490\nAll right.\n\n273\n00:15:09,490 --> 00:15:13,025\nSo in this segment we've really,\nwe've taken a look at import.\n\n274\n00:15:13,025 --> 00:15:16,530\nWell we started really with exporting\na virtual machine out of Hyper-V.\n\n275\n00:15:16,530 --> 00:15:19,902\nThen we looked at importing\na virtual machine back into Hyper-V,\n\n276\n00:15:19,902 --> 00:15:23,870\nand we also took a look at a command that\nwe could use if we were having trouble\n\n277\n00:15:23,870 --> 00:15:25,250\nimporting that virtual machine.\n\n278\n00:15:25,250 --> 00:15:29,620\nIf we got some errors, how we could\nfigure out what was causing the problem,\n\n279\n00:15:29,620 --> 00:15:33,680\nwhat was preventing me from\nimporting that virtual machine.\n\n280\n00:15:33,680 --> 00:15:35,580\nSo I hope you guys enjoyed the show.\n\n281\n00:15:35,580 --> 00:15:41,185\nStay tuned,\nmore PowerShell coming your way.\n\n282\n00:15:41,185 --> 00:15:45,284\n[SOUND]\n\n",
          "vimeoId": "117191712"
        }
      ],
      "title": "Hyper-V"
    }
  ],
  "url": "powershell",
  "vLab": false
}
